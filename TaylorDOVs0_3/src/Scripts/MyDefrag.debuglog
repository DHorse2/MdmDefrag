# See the 'MyDefrag.log' file for information intended for endusers. This is the debug
# logfile. The contents is highly technical and not documented. See the 'Debug' setting
# or the '-d' commandline option to control the level of information in this file.
#
Version: MyDefrag v4.3.1 for X64
Date: 2021/12/14 15:29:55
Windows version: v6.2 build 9200 
Commandline: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts\DefragDevDiskYearly.MyD" 
Working Directory: G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts
Userid: david
InstallPath = C:\Program Files\MyDefrag v4.3.1\
15:29:55 Syntax error in script 'Settings.MyD' at line 348 column 25.

The command 'C' is invalid, only the following commands are valid at this point:

	)

15:29:55 Script:
  1. # MyDefrag settings file.
  2. #
  3. # English v4.3.0
  4. #
  5. # This script is automatically executed by the MyDefrag program on startup. It
  6. # is intended for settings that you want to use for all scripts. If you make
  7. # changes then make sure that your editor saves the file as a Unicode text file
  8. # (wide characters).
  9. 
 10. 
 11. # Debug setting. It is off by default (commented out). To activate it remove the
 12. # slashes.
 13. //Debug(0)              /* Disable the debug logfile. */
 14. //Debug(1)              /* Fatal errors.*/
 15. //Debug(7)              /* Same as 1 plus warning messages and basic information messages. */
 16. //Debug(47)             /* Same as 7 plus scripting and volume analysis information messages. */
 17. //Debug(175)            /* Same as 47 plus moving items information messages. */
 18. //Debug(431)            /* Same as 175 plus moving items high-detail information messages. */
 19. //Debug(447)            /* Same as 431 plus scripting high-detail information messages. */
 20. //Debug(495)            /* Same as 431 plus volume analysis high-detail information messages. */
 21. 
 22. 
 23. # Default settings. See the manual for detailed information about each setting.
 24. BatteryPower(ask)
 25. DiskmapFlip(yes)
 26. FileMoveChunkSize(1073741824)
 27. OtherInstances(ask)
 28. SetScreenSaver(off)
 29. SetScreenPowerSaver(off)
 30. ProcessPriority(Normal)
 31. Slowdown(100)
 32. StatusBar(all)
 33. WhenFinished(wait)
 34. WindowSize(restore)
 35. 
 36. # Do not show cdroms in the script chooser window:
 37. ExcludeVolumes(CDRom(yes) or not(CommandlineVolumes()))
 38. 
 39. 
 40. 
 41. 
 42. ##############################################################################
 43. # After this point only translations.
 44. ##############################################################################
 45. #
 46. # Arguments in messages begin with a percent-sign '%', followed by a number,
 47. # followed by "u" for an unsigned number or "s" for a string. The arguments may be
 48. # reorganised based on the number. For example:
 49. #      Message("I have found %1n files, containing %2n bytes.",
 50. #              "Ik heb %2n bytes gevonden in %1n bestanden.")
 51. #
 52. # Strings must be enclosed in single-quotes or double quotes, for example:
 53. #      "......"
 54. #      '......'
 55. # If enclosed by single-quotes then the string may not contain a single-quote.
 56. # If enclosed by double-quotes then the string may not contain a double-quote.
 57. #
 58. # The following comments are supported:
 59. # - Enclosed by '/*' and '*/' (nesting is allowed)
 60. # - Anything after '//', 'REM', '#', or '--'.
 61. 
 62. 
 63. 
 64. 
 65. Language("English")
 66. 
 67. # Script and disk selection window.
 68. Message("Select a script:",
 69.         "Select a script:")
 70. Message("Select 1 or more disks:",
 71.         "Select 1 or more disks:")
 72. Message("Run",
 73.         "Run")
 74. Message("Cancel",
 75.         "Cancel")
 76. Message("Disk",
 77.         "Disk")
 78. Message("Label",
 79.         "Label")
 80. Message("Size",
 81.         "Size")
 82. Message("Used",
 83.         "Used")
 84. Message("Free",
 85.         "Free")
 86. Message("Please choose 1 of the scripts in the list by clicking it, and then click the 'run' button.",
 87.         "Please choose 1 of the scripts in the list by clicking it, and then click the 'run' button.")
 88. Message("Please choose 1 of the disks in the list by clicking it, and then click the 'run' button.",
 89.         "Please choose 1 of the disks in the list by clicking it, and then click the 'run' button.")
 90. 
 91. # Menu items.
 92. Message("Run",
 93.         "Run")
 94. Message("Pause",
 95.         "Pause")
 96. Message("Continue",
 97.         "Continue")
 98. Message("Exit",
 99.         "Exit")
100. Message("View",
101.         "View")
102. Message("Diskmap",
103.         "Diskmap")
104. Message("Statistics",
105.         "Statistics")
106. Message("Zoom",
107.         "Zoom")
108. 
109. # Progress messages displayed above the diskmap.
110. Message("Processing",
111.         "Processing")
112. Message("Disk %1s",
113.         "Disk %1s")
114. Message("Zone %1u of %2u",
115.         "Zone %1u of %2u")
116. Message("Paused, press space to continue....",
117.         "Paused, press space to continue....")
118. Message("Finished.",
119.         "Finished.")
120. Message("%1u files, %2u directories.",
121.         "%1u files, %2u directories.")
122. Message("Moving %1u bytes to LCN=%2u.",
123.         "Moving %1u bytes to LCN=%2u.")
124. Message("Moving %1u bytes at offset=%2u to LCN=%3u.",
125.         "Moving %1u bytes at offset=%2u to LCN=%3u.")
126. Message("Loading list of unmovable files",
127.         "Loading list of unmovable files")
128. Message("Applying ExcludeFiles policy",
129.         "Applying ExcludeFiles policy")
130. Message("Analyzing the boot optimization file",
131.         "Analyzing the boot optimization file")
132. Message("Looking for: %1s",
133.         "Looking for: %1s")
134. Message("Reclaiming the NTFS reserved area",
135.         "Reclaiming the NTFS reserved area")
136. Message("Vacating free area",
137.         "Vacating free area")
138. Message("Analyze",
139.         "Analyze")
140. Message("Defragment",
141.         "Defragment")
142. Message("FastFill",
143.         "FastFill")
144. Message("ForcedFill",
145.         "ForcedFill")
146. Message("MoveDownFill",
147.         "MoveDownFill")
148. Message("SortBy",
149.         "SortBy")
150. Message("Running external program",
151.         "Running external program")
152. Message("Analyzing the program hints",
153.         "Analyzing the program hints")
154. Message("Move to end of disk",
155.         "Move to end of disk")
156. Message("Move up to zone",
157.         "Move up to zone")
158. 
159. # Information about the file under the cursor, displayed below the diskmap.
160. Message("LCN=%1u     Unmovable    Fragments=%2u, Bytes=%3u, BeginLCN=%4u",
161.         "LCN=%1u     Unmovable    Fragments=%2u, Bytes=%3u, BeginLCN=%4u")
162. Message("LCN=%1u     Unmovable    Bytes=%2u, BeginLCN=%3u",
163.         "LCN=%1u     Unmovable    Bytes=%2u, BeginLCN=%3u")
164. Message("LCN=%1u     Fragments=%2u, Bytes=%3u, BeginLCN=%4u",
165.         "LCN=%1u     Fragments=%2u, Bytes=%3u, BeginLCN=%4u")
166. Message("LCN=%1u     Bytes=%2u, BeginLCN=%3u",
167.         "LCN=%1u     Bytes=%2u, BeginLCN=%3u")
168. Message("LCN=%1u     NTFS reserved area",
169.         "LCN=%1u     NTFS reserved area")
170. Message("LCN=%1u     MFT locked clusters",
171.         "LCN=%1u     MFT locked clusters")
172. Message("LCN=%1u     Empty space",
173.         "LCN=%1u     Empty space")
174. 
175. # Pop-up window if another instance of MyDefrag is already running.
176. Message("Other instance found",
177.         "Other instance found")
178. Message("MyDefrag is already running. In special cases it is possible to run multiple instances, but usually not. What shall I do?",
179.         "MyDefrag is already running. In special cases it is possible to run multiple instances, but usually not. What shall I do?")
180. Message("Exit","Exit")
181. Message("Continue","Continue")
182. Message("Kill the other","Kill the other")
183. 
184. # Pop-up window if the computer is running on battery power.
185. Message("Running on battery power",
186.         "Running on battery power")
187. Message("Warning: the computer is running on battery power. Shall I continue?",
188.         "Warning: the computer is running on battery power. Shall I continue?")
189. Message("Stop MyDefrag","Stop MyDefrag")
190. Message("Continue","Continue")
191. 
192. # Scripting errors.
193. Message("Fatal error, cannot execute the script: %1s",
194.         "Fatal error, cannot execute the script: %1s")
195. Message("Fatal error, script not found: %1s",
196.         "Fatal error, script not found: %1s")
197. Message("Fatal error, could not load script: %1s",
198.         "Fatal error, could not load script: %1s")
199. 
200. # Other messages.
201. Message("Oeps! Memory full. MyDefrag cannot handle this disk, it has too many items.",
202.         "Oeps! Memory full. MyDefrag cannot handle this disk, it has too many items.")
203. Message("Sorry! Cannot write to the debug logfile: %1s",
204.         "Sorry! Cannot write to the debug logfile: %1s")
205. Message("The computer will reboot in 30 seconds. Please logoff immediately.",
206.         "The computer will reboot in 30 seconds. Please logoff immediately.")
207. Message("The computer will shutdown in 30 seconds. Please logoff immediately.",
208.         "The computer will shutdown in 30 seconds. Please logoff immediately.")
209. Message("The computer is too busy, I will now exit. For more information see the 'ExitIfTimeout' setting.",
210.         "The computer is too busy, I will now exit. For more information see the 'ExitIfTimeout' setting.")
211. 
212. 
213. 
214. 
215. # Logfile header:
216. Message("LogHeader","
217. Date:                       !Date! !Time!
218. Script:                     !ScriptTitle!
219. MyDefrag version:           !MyDefragVersion!
220. Commandline:                !Commandline!
221. Working directory:          !WorkingDirectory!
222. ")
223. 
224. 
225. 
226. # Logfile footer:
227. Message("LogFooter","
228. 
229. ###############################################################################
230. Finished:                   !Date! !Time!
231. Total running time:         !RunTime!
232. ")
233. 
234. 
235. 
236. # Logfile "before" statistics:
237. Message("LogBefore","
238. ###############################################################################
239. Processing volume:    !MountPoint!
240. ###############################################################################
241. 
242. Total disk space:     !VolumeSize! bytes (!VolumeSizeG! GigaBytes)
243. Volume type:          !VolumeType!
244. 
245. Before:
246.   Unfragmented items: !FILES202N! bytes !FILES200N! items
247.   Fragmented items:   !FILES212N! bytes !FILES210N! items
248.   Gaps:               !GAP10N! bytes !GAP00N! gaps
249.   Average gap:        !GAP13N! bytes
250.   Median gap:         !GAP14N! bytes
251.   Biggest gap:        !GAP15N! bytes
252.   Average end-begin distance: !AverageBeginEndDistance! clusters
253. ")
254. 
255. 
256. 
257. 
258. # Logfile "after" statistics:
259. Message("LogAfter","
260. After:
261.   Unfragmented items: !FILES202N! bytes !FILES200N! items
262.   Fragmented items:   !FILES212N! bytes !FILES210N! items
263.   Gaps:               !GAP10N! bytes !GAP00N! gaps
264.   Average gap:        !GAP13N! bytes
265.   Median gap:         !GAP14N! bytes
266.   Biggest gap:        !GAP15N! bytes
267.   Average end-begin distance: !AverageBeginEndDistance! clusters
268. 
269. 
270. These items could not be moved:
271. Fragments   Bytes             Clusters     Name
272. ----------- ----------------- -----------  ------------------------
273. !UnmovablesList!
274. ----------- ----------------- -----------  ------------------------
275. !UnmovablesTotalFragments! !UnmovablesTotalBytes! !UnmovablesTotalClusters!  Total
276. 
277. 
278. These items are fragmented:
279. Fragments   Bytes             Clusters     Name
280. ----------- ----------------- -----------  ------------------------
281. !FragmentedList!
282. ----------- ----------------- -----------  ------------------------
283. !FragmentedTotalFragments! !FragmentedTotalBytes! !FragmentedTotalClusters!  Total
284. 
285. 
286. The 25 largest items on disk:
287. Fragments   Bytes             Clusters     Name
288. ----------- ----------------- -----------  ------------------------
289. !LargestItemsList!
290. ----------- ----------------- -----------  ------------------------
291. !LargestItemsTotalFragments! !LargestItemsTotalBytes! !LargestItemsTotalClusters!  Total
292. 
293. 
294. ")
295. 
296. 
297. 
298. # Logfile statistics for AnalyzeOnly script:
299. Message("LogAnalyzeOnly","
300. ###############################################################################
301. Analyzing volume:   !MountPoint!
302. ###############################################################################
303. 
304. Total disk space:   !VolumeSize! bytes (!VolumeSizeG! GigaBytes)
305. Volume type:        !VolumeType!
306. 
307. Unfragmented items: !FILES202N! bytes !FILES200N! items
308. Fragmented items:   !FILES212N! bytes !FILES210N! items
309. Gaps:               !GAP10N! bytes !GAP00N! gaps
310. Average gap:        !GAP13N! bytes
311. Median gap:         !GAP14N! bytes
312. Biggest gap:        !GAP15N! bytes
313. Average end-begin distance: !AverageBeginEndDistance! clusters
314. 
315. 
316. These items are fragmented:
317. Fragments   Bytes             Clusters     Name
318. ----------- ----------------- -----------  ------------------------
319. !FragmentedList!
320. ----------- ----------------- -----------  ------------------------
321. !FragmentedTotalFragments! !FragmentedTotalBytes! !FragmentedTotalClusters!  Total
322. 
323. 
324. The 25 largest items on disk:
325. Fragments   Bytes             Clusters     Name
326. ----------- ----------------- -----------  ------------------------
327. !LargestItemsList!
328. ----------- ----------------- -----------  ------------------------
329. !LargestItemsTotalFragments! !LargestItemsTotalBytes! !LargestItemsTotalClusters!  Total
330. 
331. 
332. ")
333. 
334. 
335. 
336. 
337. # Text for the statistics window:
338. SetStatisticsWindowText("
339. Script Directory: !ScriptDirectory!
340. Command Line: !Command Line!
341. Process ID: !ProcessID!
342. Action: # File Action - All - Full -  SortByCreationDate
343. # File Action - ZoneDoActionSortByCreationDateFull
344. 	SortByCreationDate(Ascending)
345. 	
346. 
347. Mode: Full
348. Requested Volume: Name("C:")
349. 
350. 
351. Label:      !VolumeName!
352. Mountpoint: !MountPoint!
353. Total disk space:   !VolumeSize! bytes !VolumeSizeG! GigaBytes
354. Unfragmented items: !FILES202N! bytes !FILES200N! items
355. Fragmented items:   !FILES212N! bytes !FILES210N! items
356. Gaps:               !GAP10N! bytes !GAP00N! gaps
357. Average gap:        !GAP13N! bytes
358. Median gap:         !GAP14N! bytes
359. Biggest gap:        !GAP15N! bytes
360. 
361. Zone number:        !ZoneNumber!
362. Unfragmented items: !ZONE202N! bytes !ZONE200N! items
363. Fragmented items:   !ZONE212N! bytes !ZONE210N! items
364. ")
365. 
366. 
367. 
368. # Title and description for System Disk Daily script.
369. Message("System Disk Daily","System Disk Daily")
370. Message("System Disk Daily description","
371. Fast defragment and optimize the selected disk(s). This script is designed for
372. every day use on the system disk (the C: disk). It moves a minimum of data on the
373. harddisk and finishes very quickly, but will not defragment extremely large files
374. and will not fill all the gaps on the disk.
375. 
376. The script will first place the MFT and the directories at 30% into the data on
377. the disk. It will then defragment the files and fast-fill the gaps (consolidate free
378. space), ordering the files into the following zones starting at the beginning of 
379. the disk: the files used when booting, files used by the most used programs, regular
380. files, and the spacehogs. Between the zones it creates gaps for temporary files.
381. ")
382. 
383. 
384. 
385. # Title and description for System Disk Weekly script.
386. Message("System Disk Weekly","System Disk Weekly")
387. Message("System Disk Weekly description","
388. Defragment and optimize the selected disk(s). This script is designed for
389. the system disk (the C: disk), and is a compromise between the Daily and 
390. Monthly scripts. It will more thoroughly defragment files and fill gaps than
391. the Daily script, but will not sort files like the Monthly script.
392. 
393. The script will first place the MFT and the directories at 30% into the data on
394. the disk. It will then defragment the files and fill all the gaps (consolidate free
395. space), ordering the files into the following zones starting at the beginning of
396. the disk: the files used when booting, files used by the most used programs,
397. regular files, and the spacehogs. Between the zones it creates gaps for temporary
398. files.
399. ")
400. 
401. 
402. 
403. # Title and description for System Disk Monthly script.
404. Message("System Disk Monthly","System Disk Monthly")
405. Message("System Disk Monthly description","
406. Thoroughly defragment and optimize the selected disk(s). This script is designed
407. for occasional use on the system disk (the C: disk), for example once per month.
408. It will sort all the files by their full path, and will therefore take a long time
409. to finish.
410. 
411. The script will first place the MFT and the directories at 30% into the data on
412. the disk. It will then defragment and sort all the files by their full path, ordering
413. the files into the following zones starting at the beginning of the disk: the files
414. used when booting, files used by the most used programs, regular files, and the
415. spacehogs. Between the zones it creates gaps for temporary files.
416. ")
417. 
418. 
419. 
420. # Title and description for Data Disk Daily script.
421. Message("Data Disk Daily","Data Disk Daily")
422. Message("Data Disk Daily description","
423. Fast defragment and optimize the selected disk(s). This script is designed for
424. every day use on data disks (all disks except the C: disk). It moves a minimum
425. of data on the harddisk and finishes very quickly, but will not defragment 
426. extremely large files and will not fill all the gaps on the disk.
427. 
428. The script will place the MFT and the directories at the beginning of the disk,
429. followed by a gap, and then it will defragment all the files and fast-fill all
430. the gaps (consolidate empty space).
431. ")
432. 
433. 
434. 
435. # Title and description for Data Disk Weekly script.
436. Message("Data Disk Weekly","Data Disk Weekly")
437. Message("Data Disk Weekly description","
438. Defragment and optimize the selected disk(s). This script is designed for
439. data disks (all disks except the C: disk), and is a compromise between the
440. Daily and Monthly scripts. It will more thoroughly defragment files and fill
441. gaps than the Daily script, but will not sort files like the Monthly script.
442. 
443. The script will place the MFT and the directories at the beginning of the disk,
444. followed by a gap, and then it will defragment all the files and fill all the
445. gaps (consolidate empty space).
446. ")
447. 
448. 
449. 
450. # Title and description for Data Disk Monthly script.
451. Message("Data Disk Monthly","Data Disk Monthly")
452. Message("Data Disk Monthly description","
453. Thoroughly defragment and optimize the selected disk(s). This script is designed
454. for occasional use, for example once per month. It will sort all the files by
455. their full path, and will therefore take a long time to finish.
456. 
457. The script will place the MFT and the directories at the beginning of the disk,
458. followed by a gap, and then it will sort all the files by their full path. This
459. will also defragment all the files and fill all the gaps (consolidate empty space).
460. ")
461. 
462. 
463. 
464. # Title and description for Analyze Only script.
465. Message("Analyze only","Analyze only")
466. Message("Analyze only description","
467. Analyze the selected disk(s). The script will write a report to the
468. 'MyDefrag.log' file, and will automatically pause between disks
469. so you can view and interpret the diskmap.
470. ")
471. 
472. 
473. 
474. # Title and description for Consolidate free space script.
475. Message("Consolidate free space","Consolidate free space")
476. Message("Consolidate free space description","
477. Move files and directories to the beginning of the disk(s).
478. This can be useful on very full disks, to make room for manouvering big files.
479. The script will move everything to the beginning of the disk, beginning with files
480. at the end of the disk. It will fragment files to create parts that exactly fill
481. gaps.
482. ")
483. 
484. 
485. 
486. # Title and description for Defragment only script.
487. Message("Defragment only","Defragment only")
488. Message("Defragment only description","
489. Defragment all the files and directories on the selected disk(s).
490. The script will first defragment files for which it can
491. find a large enough gap, and then slowly defragment files that are bigger than
492. the largest gap by shuffling data.
493. 
494. Are you comparing with another defragmenter? Use this script. MyDefrag uses
495. wrap-around fragmentation, a concept unique to MyDefrag. The DefragmentOnly
496. script will turn this setting off and is the only script that is more or less
497. compatible with other defragmenters. For more information see the
498. 'IgnoreWrapAroundFragmentation' setting in the MyDefrag manual.
499. ")
500. 
501. 
502. 
503. # Title and description for Flash memory disks script.
504. Message("Flash memory disks","Flash memory disks")
505. Message("Flash memory disks description","
506. Defragment and consolidate free space on the selected disk(s).
507. This script is specially designed for Flash and SSD disks.
508. It will defragment all the fragmented files and make the free space
509. as large as possible by moving all files to the beginning of the disk.
510. 
511. Flash memory has a limited number of erase-write cycles. The script is specially
512. designed to move as little data as possible, but still uses up some of those
513. cycles. My advise is to use some discretion and not run this script every day,
514. but only occasionally, for example once per month.
515. ")
15:30:02 Syntax error in script 'G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts\DefragDevDiskYearly.MyD' at line 1605 column 16.

The command 'C' is invalid, only the following commands are valid at this point:

	)

15:31:55 Script:
  1. # MyDefrag v4.0 script: Development Volume Yearly defrag
  2. #
  3. # This script is part of the standard Mdm Volume configuration
  4. # Author: David G. Horsman (DBA MacroDM) (FOSS) 2019
  5. # based on MyDefrag distribution.
  6. 
  7. /* Development Volume Yearly*/
  8. SetVariable(RunDescription,"!DevWord! !DevWord! !YearlyWord!")
  9. SetVariable(RunStepDescription,"!RunDescription!")
 10. # Script: DisplaySetRun
 11. 
 12. SetVariable(RunStepDescription,			"!RunStepDescription! !DashWord! DefragDevDiskYearly")
 13. SetVariable(SeverStepDescription,		"")
 14. SetVariable(VolumeStepDescription,		"")
 15. SetVariable(ZoneStepDescription,		"")
 16. SetVariable(ZoneStepDescription,		"")
 17. 
 18. SetVariable(RunStepSummary,			"!RunStepSummary! !DashWord! DefragDevDiskYearly")
 19. SetVariable(SeverStepSummary,		"")
 20. SetVariable(VolumeStepSummary,		"")
 21. SetVariable(ZoneStepSummary,		"")
 22. SetVariable(ZoneStepSummary,		"")
 23. 
 24. 
 25. SetVariable(VolumeStatisticsDetail, 	"")
 26. 
 27. SetVariable(ZoneListByLine, 			"!RunWord! !StartWord!!PeriodWord!")
 28. SetVariable(ZoneStepByLine, 			"")
 29. 
 30. # Script: BannerSet
 31. 
 32. # NOTE: Can't round or truncate to integer precision. 
 33. # This internal fields like ZoneCount format really badly.
 34. #  for !RunTimeNow! does not work. None of the date functions do.
 35. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
 36. 
 37. SetVariable(HeadingTemp2,	ZoneCount + 0)
 38. 
 39. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
 40. 
 41. Title('!Heading!')
 42. 
 43. /* pause(1) */
 44. 
 45. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
 46. 
 47. 
 48. pause(2)
 49. 
 50. # Script: SettingsRun
 51. # This script is part of the standard  disk configuration
 52. # Author: David G. Horsman (DBA MacroDM) (C) 2019
 53. # based on MyDefrag distribution.
 54. 
 55. # Script: DisplaySetDateTimeRun
 56. 
 57. SetVariable(RunStartDate,				"2021-12-14")
 58. SetVariable(RunStartTime,				"15:29:55")
 59. SetVariable(RunDateTime,				"!RunStartDate! !RunStartTime!")
 60. # Xinclude "..\Display\BannerSet.MyDc"X
 61. /* pause(1) */
 62. SetVariable(RunId,		"C:\MyDefragLogs\!RunDescription! !RunDateTime!")
 63. SetVariable(Heading,	"Initializing...")
 64. WriteLogfile("!RunId!", "!ZoneStatisticsData!")
 65. /* ------------------------- */
 66. # Run Preprocessing Do Before.
 67. # Script: SettingsRu$ DoBefore
 68. # The structured naming convention uses a $ to show
 69. # order of execution in explorer name sorted views.
 70. #
 71. # Bad attempt at internationalization
 72.   # Script: SettingsRunLanguage
 73. # This would be better phrase based.
 74. 
 75. # Script SettingRunZoneStepDescription
 76. # The variable ZoneStepDescription get set to
 77. # the messages below according to the Zone File
 78. # step the defrag is on.
 79. 
 80. # Display fields you can set for your personal tastes / needs:
 81. 
 82. # ZONE. Process One Zone (the steps and messages displayed.
 83. 
 84. SetVariable(ZoneStepDescriptionZoneStart, 			"Zone started.")
 85. 
 86. # "Your Zone Pre (before)Processing."
 87. SetVariable(ZoneStepDescriptionYourZonePre, 		"!ZoneStepDescriptionZoneStart!") 		
 88. 
 89. SetVariable(ZoneStepDescriptionFileSelect,			"Selecting Files.")
 90. 
 91. # "Your Pre Sort File Actions."
 92. SetVariable(ZoneStepDescriptionYourFileActionsPre, 	"!ZoneStepDescriptionFileSelect!")
 93. 
 94. SetVariable(ZoneStepDescriptionFileActionStart, 	"File Actions started.")
 95. 
 96. # "Your Post Sort File Actions."
 97. SetVariable(ZoneStepDescriptionYourFileActionsPost, "!ZoneStepDescriptionFileActionStart!")
 98. 
 99. SetVariable(ZoneStepDescriptionFileActionEnd, 		"File Actions completed.")
100. 
101. # "Your Zone Post (after) Processing."
102. SetVariable(ZoneStepDescriptionYourZonePost, 		"!ZoneStepDescriptionFileActionEnd!") 		
103. 
104. SetVariable(ZoneStepDescriptionFileActionGap, 		"Calculating Gap.")
105. 
106. SetVariable(ZoneStepDescriptionFileActionGapDo,		"Processing Gap.")
107. 
108. SetVariable(ZoneStepDescriptionZoneReporting,		"Processing finished, reporting.")
109. 
110. SetVariable(ZoneStepDescriptionZoneEnd, 			"Zone finished.")
111. 
112. # Pattern: SetVariable(ZoneStepDescriptionXXX, 	"XXX xxxxxxxxx")
113. 
114. # Note: If you add custom script code in the PRE and POST areas then at that
115. # time you fill in the messages above as appropriate.
116. 
117. /* empty */
118. 
119. 
120. 
121. /* ------------------------- */
122. # Field Defaults
123. SetVariable(NotSetWord,							"NotSet")
124. 
125. SetVariable(VolumeStartDescription, 			"Volume started.")
126. SetVariable(ZoneStepDescriptionZoneStart, 		"!VolumeStartDescription!")
127. 
128. SetVariable(ServerNameDefault,					"ThisPc")
129. SetVariable(VolumeLabelDefault,					"!NotSet!")
130. /* ------------------------- */
131. # Words used in messages
132. #
133. # Process
134. SetVariable(GapWord,							"gap")
135. SetVariable(GapWordCaps,						"Gap")
136. SetVariable(MountpointWord,						"mountpoint")
137. SetVariable(StepWord,							"step")
138. SetVariable(StepWordCaps,						"Step")
139. SetVariable(ScriptWord,							"script")
140. SetVariable(ScriptWordCaps,						"Script")
141. SetVariable(VolWord,							"Vol")
142. SetVariable(VolumeWord,							"volume")
143. SetVariable(VolumeWordCaps,						"Volume")
144. SetVariable(ZoneWord,							"zone")
145. SetVariable(ZoneWordCaps,						"Zone")
146. SetVariable(ZonesWord,							"Zones")
147. 
148. # Date/Time
149. SetVariable(DateWord,							"Date")
150. SetVariable(ElapsedWord,						"Elapsed")
151. SetVariable(TimeWord,							"Time")
152. 
153. # Punctuation
154. SetVariable(AndWord,							"&")
155. SetVariable(BackslashWord,						"\")
156. SetVariable(ColonWord,							":")
157. SetVariable(DashWord,							"-")
158. SetVariable(DotDotDotWord,						"...")
159. SetVariable(ExclamationWord,					"!")
160. SetVariable(PercentSymbolWord,					"%")
161. SetVariable(PeriodWord,							".")
162. SetVariable(SemicolonWord,						";")
163. SetVariable(SlashWord,							"/")
164. 
165. # Volume Modes
166. SetVariable(ComplexWord,						"Complex")
167. SetVariable(FastWord,							"Fast")
168. SetVariable(FullWord,							"Full")
169. SetVariable(RegularWord,						"Regular")
170. 
171. # Volume Periodic Temporal
172. SetVariable(DailyWord,							"Daily")
173. SetVariable(FirstWord,							"First")
174. SetVariable(MonthlyWord,						"Monthly")
175. SetVariable(WeeklyWord,							"Weekly")
176. SetVariable(YearlyWord,							"Yearly")
177. 
178. # Volume and Zone Types
179. SetVariable(ArchWord,						"Arch")
180. SetVariable(ArchiveWord,					"Archive")
181. SetVariable(ArchivesWord,					"Archives")
182. SetVariable(BackupWord,						"Backup")
183. SetVariable(DataWord,						"Data")
184. SetVariable(DatabasesWord,					"Databases")
185. SetVariable(DevWord,						"Dev")
186. SetVariable(DevelopmentWord,				"Development")
187. SetVariable(ProgramsWord,					"Programs")
188. SetVariable(RegularWord,					"Regular")
189. SetVariable(SysWord,						"Sys")
190. SetVariable(SharesWord,						"Shares")
191. 
192. # Other
193. SetVariable(ActualWord,							"Actual")
194. SetVariable(AdjustedWord,						"adjusted")
195. SetVariable(AfterWord,							"after")
196. SetVariable(AlignWord,							"Align")
197. SetVariable(AllWord,							"All")
198. SetVariable(AnalyzeWord,						"Analyze")
199. SetVariable(AnalysisWord,						"Analysis")
200. SetVariable(AtWord,								"at")
201. SetVariable(AnyWord,							"any")
202. SetVariable(AvailableWord,						"available")
203. 
204. SetVariable(BeWord,								"be")
205. SetVariable(BeforeWord,							"before")
206. SetVariable(ByWord,								"by")
207. SetVariable(BytesWord,							"bytes")
208. SetVariable(BytesWordCaps,						"Bytes")
209. 
210. SetVariable(CategoryWord,						"Category")
211. SetVariable(ClustersWord,						"Clusters")
212. SetVariable(CodeWord,							"code")
213. SetVariable(CountsWord,							"Counts")
214. 
215. SetVariable(DesiredWord,						"desired")
216. SetVariable(DirectoryWord,						"Directory")
217. SetVariable(DoneWord,							"Done")
218. 
219. SetVariable(EndWord,							"end")
220. SetVariable(EndWordCaps,						"End")
221. SetVariable(EvenlyWord,							"evenyly")
222. 
223. SetVariable(FinishedWord,						"Finished")
224. SetVariable(FileWord,							"File")
225. SetVariable(FilesWord,							"Files")
226. SetVariable(FoldersWord,						"Folders")
227. SetVariable(FragmentedWord,						"Fragmented")
228. SetVariable(FragmentsWord,						"Fragments")
229. SetVariable(FreeWord,							"Free")
230. 
231. SetVariable(GigabytesWord,						"Gigabytes")
232. 
233. SetVariable(HalfWord,							"half")
234. 
235. SetVariable(InitializingWord,					"Initializing")
236. SetVariable(InsertedWord,						"inserted")
237. SetVariable(ItemsWord,							"items")
238. 
239. SetVariable(LocationWord,						"Location")
240. SetVariable(LocWord,							"Loc")
241. SetVariable(LogWord,							"log")
242. SetVariable(LogWordCaps,						"Log")
243. SetVariable(LowerWord,							"lower")
244. 
245. SetVariable(MegabytesWord,						"Megabytes")
246. SetVariable(MinWord,							"min")
247. SetVariable(MustWord,							"must")
248. SetVariable(MustWordCaps,						"Must")
249. 
250. SetVariable(NumberWord,							"number")
251. 
252. SetVariable(OfWord,								"of")
253. 
254. SetVariable(PendingWord,						"Pending")
255. SetVariable(PercentWord,						"Percent")
256. 
257. SetVariable(RemainingWord,						"remaining")
258. SetVariable(RequestedWord,						"requested")
259. SetVariable(RoundingWord,						"rounding")
260. SetVariable(RunWord,							"run")
261. SetVariable(RunWordCaps,						"Run")
262. 
263. SetVariable(SeeksWord,							"Seeks")
264. SetVariable(SelectWord,							"Select")
265. SetVariable(SettingsWord,						"Settings")
266. SetVariable(SizeWord,							"Size")
267. SetVariable(SortWord,							"Sort")
268. SetVariable(SortingWord,						"Sorting")
269. SetVariable(SpaceWord,							"Space")
270. SetVariable(StartWord,							"start")
271. SetVariable(StartWordCaps,						"Start")
272. SetVariable(StartedWord,						"Started")
273. SetVariable(StartingWord,						"Starting")
274. 
275. SetVariable(TheWord,							"the")
276. SetVariable(TheWordCaps,						"The")
277. SetVariable(ToWord,								"to")
278. SetVariable(TotalWord,							"Total")
279. 
280. SetVariable(UnfragmentedWord,					"Unfragmented")
281. SetVariable(UsedWord,							"Used")
282. 
283. SetVariable(YouWord,							"you")
284. SetVariable(YouWordCaps,						"You")
285. 
286. # VOLUME REPORT
287. # VOLUME SUMMARY
288. # CURRENT ZONE
289. # VOLUME DETAILS
290. # LARGE and UNMOVABLES
291. # GAPS
292. 
293. /* ------------------------- */
294. # Zone Processing Steps
295. SetVariable(ZoneStepDescriptionInitializing,	"!InitializingWord! !RunWord!!DotDotDotWord!")
296. 
297. # Present in the program settings script:
298. # Xinclude "..\Settings\SettingsRunLanguageEnglish.MyDc"X
299. #
300. # Do a run State Restore now that the script has been built.
301. 
302. RunProgram("..\Commands\DoStateRestore.bat")
303. 
304. # The user's current settings have been restored and
305. # the temporary settings used to build this script have
306. # been removed
307. /* ------------------------- */
308. SetVariable(SeverStepDescription,	"")
309. SetVariable(VolumeStepDescription,	"")
310. SetVariable(ZoneStepDescription,	"")
311. SetVariable(ZoneStepDescription,	"")
312. SetVariable(RunStepDescription,		"")
313. SetVariable(DateNow, 	DATETIME)
314. SetVariable(TimeNow, 	Time)
315. SetVariable(RunTimeNow, 	RunTime)
316. 
317. 
318. /* ------------------------- */
319. # Settings
320. # Script SettingsSysProcessPriority
321. 	# Options:
322. 	# High High CPU priority. It is not advised to use this for MyDefrag, because it will use nearly all available CPU time. 
323. 	# AboveNormal CPU priority above the Normal and below the High priorities. 
324. 	# Normal The standard CPU priority of all Windows programs. This is the default for MyDefrag. 
325. 	# BelowNormal CPU priority below the Normal and above the Low priorities.
326. 	# Low Low CPU priority. With this setting MyDefrag will only run when the system is idle. This is the default for the MyDefrag screensaver (Windows automatically runs all screensavers in this priority class). 
327. 	# Background Background processing priority. This setting will lower the resource (I/O) scheduling priority and the CPU priority to "Low". The result of this setting is that other programs will get faster access to the disks. This setting is not supported on Windows 2000/2003/XP. 
328. 
329. ProcessPriority(BelowNormal)
330. 
331. /* ProcessPriority(Normal) */
332. # ProcessPriority(ARGUMENT) 
333. # 
334. # where ARGUMENT is one of the following: High High CPU priority. It is not advised to use this for MyDefrag, because it will use nearly all available CPU time. 
335. # AboveNormal CPU priority above the Normal and below the High priorities 
336. # Normal The standard CPU priority of all Windows programs. This is the default for MyDefrag. 
337. # BelowNormal CPU priority below the Normal and above the Low priorities. 
338. # Low Low CPU priority. With this setting MyDefrag will only run when the system is idle. This is the default for the MyDefrag screensaver (Windows automatically runs all screensavers in this priority class). 
339. # Background Background processing priority. This setting will lower the resource (I/O) scheduling priority and the CPU priority to "Low". The result of this setting is that other programs will get faster access to the disks. This setting is not supported on Windows 2000/2003/XP. 
340. # 
341. 
342. # Script: SettingsSysExitIfTimeout
343. # Exit Timeout
344. # was 5 minutes (for old systems) (300)
345. # default is 120.
346. # 20211123 changed to 15 minutes (900)
347. #	this is to accomodate running at Idle priority.
348. #
349. ExitIfTimeout(900) 
350. #
351. /* ExitIfTimeout(300) // 5 minutes (for old systems), default 120. */
352. 
353. #
354. 
355. WindowSize(minimized) 
356. DiskmapFlip(no)
357. 
358. # Script: DisplayColors
359. # MyDefrag color palette.
360. 
361. # RGB Color pallets. (Red,Green,Blue).
362. 
363. # Basics:
364. 
365. # Red			255,	0,		0)			// Red
366. # Green			0,		255,	0)			// Green
367. # Blue			0,		0,		255)		// Blue
368. # Shades:
369. 
370. /* (White was left unused for the administrator to highlight things.) */
371. # White 		255,	255,	255)		// White
372. # Black			0,		0,		0)			// Black
373. # Grey 			240,	240,	240)		// Grey
374. 
375. # Bright colors and shades:
376. 
377. # Purple 		170,	89,		221)		// Purple
378. # Magenta		255, 	5, 		255)		// Magenta (pinkish)
379. 
380. # Pure Yellow 	255,	255,	0)			// Pure yellow
381. # Yellow 		229, 	229, 	0)			// Yellow
382. # Light Yellow 	255,	255,	224)		// Light Yellow
383. # Neon Yellow	237,	240,	11)			// Neon Yellow	
384. 
385. # Pure Red 		255, 	0, 		0)			// Red
386. # Red 			204, 	92, 	92)			// Red
387. # Light red		255,	115,	115)		// Light red
388. # Orange		255, 	165, 	0)			// Orange
389. 
390. # Pure Green	0, 		255, 	0)			// Pure Green (Lime)
391. # Green			0,		128,	0)			// Green
392. # Light Green	144,	228, 	144)		// Light Green
393. # Pale Green	152, 	251, 	152)		// Pale Green
394. 
395. # Dark blue		20,		87,		229)		// Dark blue
396. # Light Blue	175,	198,	247)		// Light Blue
397. # Bright Blue	0, 		223, 	255)		// Bright Blue
398. # Light sky blue 135, 	206, 	250)		// Light sky blue
399. # Deep sky blue	0, 		191, 	255)		// Deep sky blue
400. 
401. # Black			0,		0,		0)
402. # Grey			240,	240,	240)
403. 
404. # Window Colors
405. SetColor(Empty,										240,  	240, 	240)	// Grey
406. # ???
407. SetColor(Allocated,									45, 	72, 	128)	// Black
408. 
409. # Busy Colours
410. SetColor(BusyRead,									255,	54,		154)	// Neon
411. SetColor(BusyWrite,									212, 	0, 		106)	// Red Pinkish
412. 
413. #File Colors
414. SetFileColor(All,									0,		0,		0)		// Black
415. SetFileColor(Movable,								20,		87,		229)	// Dark blue
416. 
417. # Processed
418. SetFileColor(Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
419. SetFileColor(Processed and Fragmented,				170,	89,		221)	// Purple
420. 
421. # Fragmented and NotMovable
422. SetFileColor(Fragmented,							229, 	229, 	0)		// Yellow
423. SetFileColor(not(Movable),							255, 	165, 	0)		// Orange
424. 
425. # Light Green and Yellow
426. SetFileColor(Selected,								152,	251, 	152)	// Light Green
427. SetFileColor(Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
428. SetFileColor(Selected and not(Movable),				255,	115,	115)	// Light red
429. 
430. /* empty */
431. 
432. 
433. # Mark: 9
434. 
435. # Processes:
436. 	# This Process
437. SetVariable(RunProcessID,ProcessID)
438. 
439. 	# Kill other instances
440. 	# Kill other MyDefrag Instances.
441. 	# Oops! This commits suicide.
442. 	# 	RunProgram("..\pskill.exe", "-t MyDefrag.exe")
443. 	# Pause(10)
444. 	
445. 	# If another instance of MyDefrag is already running then exit.
446. 	# Oops again. I don't know if this cause the hidden instance
447. 	# to hang around after the run.
448. 	# Warning: <alt><Run><Exit> seems to hide the instance not end it.
449. 	# The task mananager may be needed. This is under investigation.
450. 
451. # OtherInstances
452. # 
453. # ask      Ask the user what to do. The user will be presented with a pop-up window with "exit", "continue", and "kill the other" buttons. The screensaver version of MyDefrag cannot popup the window and this selection will behave the same as "kill".  
454. # allow      MyDefrag will continue. 
455. # exit      MyDefrag will exit. 
456. # kill      MyDefrag will try to kill the other instance. 
457. #
458. OtherInstances(ask)
459. #
460. # OtherInstances
461. 	
462. # OtherInstances(exit)
463. 
464. #
465. 
466. 	# Debug Level
467. 
468. # Script: SettingsSysDebugLevel
469. /* 
470. 	1 Fatal error messages. 
471. 	2 Warning messages. 
472. 	4 Basic information messages. 
473. 	8 Scripting information messages. 
474. 	16 Scripting high-detail information messages. 
475. 	32 Volume analysis information messages. 
476. 	64 Volume analysis high-detail information messages. 
477. 	128 Moving items information messages. 
478. 	256 Moving items high-detail information messages. 
479. 	*/
480. # Examples:
481. //Debug(0)              /* Disable the debug logfile. */
482. //Debug(1)              /* Fatal errors.*/
483. //Debug(7)              /* Same as 1 plus warning messages and basic information messages. */
484. //Debug(31)             /* Options 1 - 16.*/
485. //Debug(47)             /* Same as 7 plus scripting and volume analysis information messages. */
486. //Debug(175)            /* Same as 47 plus moving items information messages. */
487. //Debug(431)            /* Same as 175 plus moving items high-detail information messages. */
488. //Debug(447)            /* Same as 431 plus scripting high-detail information messages. */
489. //Debug(495)            /* Same as 431 plus volume analysis high-detail information messages. */
490. #
491. Debug(16)
492. #
493. #
494. #
495. # Debug(x)
496. # 
497. 	
498. 	# StatusBar
499. 
500. StatusBar(Status Path MouseOver)
501. # Script: DisplayStatusBar
502. 
503. 	
504. 	# Power management
505. 
506. # Power management
507. # SetScreenPowerSaver(off)
508. # SetScreenPowerSaver(reset) 
509. # Not compatable with all vs of windows
510. #
511. 	/* SetScreenPowerSaver(off) */
512. 	# Power management
513. # SetScreenPowerSaver(off)
514. # SetScreenPowerSaver(reset) 
515. # Not compatable with all vs of windows
516. #
517. 	/* SetScreenPowerSaver(off) */
518. #
519. 
520. 
521. 	# Window State
522. 
523. # Script: SettingsSysWindowSize
524. #
525. # restore      Make the size and position of the MyDefrag window the same as the last time the program was run with this option. 
526. # minimized      Minimized. MyDefrag is only visible in the taskbar. 
527. # maximized      Maximized, using the entire screen. 
528. # invisible      Hide the MyDefrag window. 
529. # fixed      Change the size of the MyDefrag window to 600x400. 
530. #
531. WindowSize(restore)
532. #
533. # Script: SettingsYoursSysWindowSize
534. #
535. # WindowSize(restore)
536. #
537. 
538. #
539. 
540. /* ------------------------- */
541. # Script Directory Location:
542. 
543. SetVariable(ScriptDir,"..\")
544. 
545. /* SetVariable(ScriptDir,"..\") */
546. /* SetVariable(ScriptDir,"G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts") */
547. /* SetVariable(ScriptDir,"E:\Ide\MyDefrag\MyDefrag\MdmScriptMyDefragVs4_3_1\") */
548. 
549. 
550. 
551. /* ------------------------- */
552. # DISPLAY - What text is displayed in Titlebar, 
553. #			data fields and reports.
554. 
555. # Script SettingRunZoneStepDescription
556. # The variable ZoneStepDescription get set to
557. # the messages below according to the Zone File
558. # step the defrag is on.
559. 
560. # Display fields you can set for your personal tastes / needs:
561. 
562. # ZONE. Process One Zone (the steps and messages displayed.
563. 
564. SetVariable(ZoneStepDescriptionZoneStart, 			"Zone started.")
565. 
566. # "Your Zone Pre (before)Processing."
567. SetVariable(ZoneStepDescriptionYourZonePre, 		"!ZoneStepDescriptionZoneStart!") 		
568. 
569. SetVariable(ZoneStepDescriptionFileSelect,			"Selecting Files.")
570. 
571. # "Your Pre Sort File Actions."
572. SetVariable(ZoneStepDescriptionYourFileActionsPre, 	"!ZoneStepDescriptionFileSelect!")
573. 
574. SetVariable(ZoneStepDescriptionFileActionStart, 	"File Actions started.")
575. 
576. # "Your Post Sort File Actions."
577. SetVariable(ZoneStepDescriptionYourFileActionsPost, "!ZoneStepDescriptionFileActionStart!")
578. 
579. SetVariable(ZoneStepDescriptionFileActionEnd, 		"File Actions completed.")
580. 
581. # "Your Zone Post (after) Processing."
582. SetVariable(ZoneStepDescriptionYourZonePost, 		"!ZoneStepDescriptionFileActionEnd!") 		
583. 
584. SetVariable(ZoneStepDescriptionFileActionGap, 		"Calculating Gap.")
585. 
586. SetVariable(ZoneStepDescriptionFileActionGapDo,		"Processing Gap.")
587. 
588. SetVariable(ZoneStepDescriptionZoneReporting,		"Processing finished, reporting.")
589. 
590. SetVariable(ZoneStepDescriptionZoneEnd, 			"Zone finished.")
591. 
592. # Pattern: SetVariable(ZoneStepDescriptionXXX, 	"XXX xxxxxxxxx")
593. 
594. # Note: If you add custom script code in the PRE and POST areas then at that
595. # time you fill in the messages above as appropriate.
596. 
597. /* empty */
598. 
599. 
600. 
601. /* Progress Display */
602. SetVariable(ZoneListByLine, 	"!VolumeLabel! !VolumeStartDescription!")
603. SetVariable(ZoneStepByLine, 	"")
604. 
605. /* There is 6 digit decimal precision so by using */
606. /* 1Mb the full number is displayed in a much more */
607. /* readable form. */
608. 
609. # Sector 512, Cluster/Phy sector 4096
610. # ToDo Display shows Physical Sectors, not bytes or percent.
611. # ToDo Reporting needs adjustment.
612. 
613. /* ------------------------- */
614. # Use the map units.
615. SetVariable(DisplayUnitDivisor, 	1) 
616. // a guess -1. Much more readable but not using the same units as the map.
617. # SetVariable(DisplayUnitDivisor, 	4096) // avoid div 0
618. # SetVariable(DisplayUnitDivisor, 	2049) // a guess -1. (I checked later)
619. # SetVariable(DisplayUnitDivisor, 	1000000) // 1MB.
620. 
621. /* ------------------------- */
622. # SERVER INFORMATION
623. 
624. 	/* ServerName (IE. Computer name or number.) not used. */
625. 	/* System99 */
626. 		SetVariable(ServerName,"!ServerNameDefault!")
627. 
628. 		# Server Names
629. 
630. # ???
631. 
632. # IMPORTANT: ServerName NAME: 
633. 
634. 	# SetVariable(ServerName,"PcAny")
635. 
636. # IMPORTANT: ServerName NAME: 
637. 
638. 	# SetVariable(ServerName,"PcAny")
639.     /* System99 */
640. # SET
641. SetVariable(ServerName,"RavenPc")
642. 
643. 
644. 	
645. 	/* Descriptive Information so maybe */
646. 	/* VolumeNamePrefix (IE. Person or company initials) not used. */
647. 	/* "Xyz" */
648. 		SetVariable(VolumeNamePrefix,"ThisVolume")
649. 
650. 		#Script: SettingsYoursSysVolume
651. /* Descriptive Information so maybe */
652. /* VolumeNamePrefix (IE. Person or company initials) not used. */
653. /* "Xyz" */
654. 	SetVariable(VolumeNamePrefix,"VolThis")
655. 
656. 	#Script: SettingsYoursSysVolumeNamePrefix
657. /* Descriptive Information so maybe */
658. /* VolumeNamePrefix (IE. Person or company initials) not used. */
659. /* "Xyz" */
660. 	SetVariable(VolumeNamePrefix,"Vol")
661. 
662. /* Server name full is usually the server and computer combined. not used. */
663. 	SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
664. 
665. 
666. 	/* Server name full is usually the server and computer combined. not used. */
667. 
668. 		SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
669. 	
670. 	# Script: DisplaySetServer
671. # RunStepDescription
672. # (Volume)
673. SetVariable(SeverStepDescription, 	"!ServerNameFull!")
674. SetVariable(VolumeStepDescription, 	"")
675. SetVariable(ZoneStepDescription, 	"")
676. SetVariable(ZoneStepDescription, 	"")
677. SetVariable(DateNow, 	Date)
678. SetVariable(TimeNow, 	Time)
679. SetVariable(RunTimeNow, 	RunTime)
680. 
681. # Message ServerSummary
682. SetVariable(ServerSummary, '
683. Server Summary:
684.  Sever Name:        !SeverStepDescription!
685.     Command:	    "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts\DefragDevDiskYearly.MyD" 
686. MyDefrag Vs:    	MyDefrag v4.3.1 for X64
687. Executable Directory: C:\Program Files\MyDefrag v4.3.1
688. ScriptDirectory:    G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts
689. Run:
690. WindowsVersion:     v6.2 build 9200 
691.      ProcessID:     14392
692.    ScriptTitle:     DefragDevDiskYearly
693.           Date:     !DateNow! !TimeNow!
694.   Elapsed Time:     !RunTimeNow!
695. ')
696. 
697. 
698. # Script: BannerSet
699. 
700. # NOTE: Can't round or truncate to integer precision. 
701. # This internal fields like ZoneCount format really badly.
702. #  for !RunTimeNow! does not work. None of the date functions do.
703. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
704. 
705. SetVariable(HeadingTemp2,	ZoneCount + 0)
706. 
707. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
708. 
709. Title('!Heading!')
710. 
711. /* pause(1) */
712. 
713. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
714. 
715. 
716. /* pause(2) */
717. 
718. /* ------------------------- */
719. # VOLUMES
720. /* ------------------------- */
721. 
722. 	# Volume Do Current Clear
723. 
724. /* ------------------------- */
725. # Current Values.
726. 	SetVariable(VolumeLabel,		"NotSet")
727. 	SetVariable(VolumeMountpoint,	"NotSet")
728. 	SetVariable(VolumeDescription,	"")
729. 
730. 	SetVariable(VolumeCount, 0)
731. 	SetVariable(VolumeNoCurrent, 0)
732. 	SetVariable(VolumeNoAdjCurrent, 0)
733.   	SetVariable(VolumeCurrentAjust, 0) // not used
734. 
735. /* ------------------------- */
736. # OS Disk Usage.
737. 
738. /* Percentage of disk used by OS */
739. 
740. 	SetVariable(OsPer, 0.18)
741. 
742. 	     SetVariable(ZoneCountOs, 5)
743. 
744.        SetVariable(ZoneCountType, 0) // not used
745.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
746. 
747. 	    SetVariable(ZoneCountSys, 2)
748. 	    SetVariable(ZoneCountDev, 7)
749. 
750. 	   SetVariable(ZoneCountData, 0)
751. 	SetVariable(ZoneCountArchive, 0)
752. 	
753. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
754. 
755. /* ------------------------- */
756. # Volume Totals
757. 	# USED:
758. 	/* Current total volume space used */
759. 	SetVariable(VolumeZoneUsed, 			0)
760. 	/* percentage */
761. 	SetVariable(VolumeZoneUsedPer, 			0)
762. 
763. 	# FREE:
764. 	/* Current total of free space used */
765. 	SetVariable(VolumeFreeRequested, 		0)
766. 	/* percentage */
767. 	SetVariable(VolumeFreeRequestedPer, 	0)
768. 
769. 	/* Current total of free space used */
770. 	SetVariable(VolumeFreeUsed, 			0)
771. 	/* percentage */
772. 	SetVariable(VolumeFreeUsedPer, 			0)
773. 	
774. /* ------------------------- */
775. # Volume Free Space Proportional Used Space vs Volume Size.
776. 	/* We only want to use a ratio of the free space relative to the volume. */
777. 	/* We could just use percentages of the total free space as well. */
778. 
779. 	/* SetVariable(VolumeFreeAdj, 		1) */
780. 	
781. 	SetVariable(VolumeFreeAdj,				(VolumeFree * (VolumeUsed / VolumeSize)))
782. 
783. /* ------------------------- */
784. # ZONES
785. 
786. 	SetVariable(ZoneNoCurrent,			0)
787. 	SetVariable(ZoneNoCurrentAdjust,	0)
788. 	SetVariable(ZoneNoDisplay,			0) 
789. 
790. 	# Script: ZoneDoCurrentClear
791. 
792. SetVariable(ZoneTypeSelectCurrent, 		"")
793. SetVariable(ZoneStatisticsData, 		"")
794. SetVariable(ZoneStepByLine, 			"")
795. 
796. SetVariable(ZoneBeginCurrent, 			0)
797. SetVariable(ZoneBeginPerCurrent, 		0)
798. SetVariable(ZoneEndCurrent, 			0)
799. SetVariable(ZoneEndPerCurrent, 			0)
800. 
801. SetVariable(ZoneSizeCurrent,			0)
802. SetVariable(ZoneSizePerCurrent,			0)
803. 
804. SetVariable(ZoneGapRequestedCurrent,	0)
805. SetVariable(ZoneGapRoundedCurrent, 		0)
806. SetVariable(ZoneGapAdjustedCurrent, 	0)
807. SetVariable(ZoneGapAvailableCurrent, 	0)
808. SetVariable(ZoneGapCurrent,				0)
809. SetVariable(ZoneGapUsedCurrent, 		0)
810. 
811. SetVariable(ZoneGapActualCurrent, 		0)
812. SetVariable(ZoneGapActualPerCurrent, 	0)
813. 
814. SetVariable(ZoneSizeActual, 			0)
815. SetVariable(ZoneSizeActualCurrent,		0)
816. 
817. SetVariable(ZoneEndActual, 				0)
818. SetVariable(ZoneEndActualCurrent,		0)			
819. SetVariable(ZoneSizeActualPerCurrent, 	0)
820.       
821. SetVariable(ZoneFilesFolders,			0)
822. SetVariable(ZoneFilesFoldersPer,		0) 
823. 
824. SetVariable(ZoneFragments,				0)
825. SetVariable(ZoneFragmentsPer,			0) 
826. 		
827. SetVariable(ZoneEndActualCurrent, 		0)
828. SetVariable(ZoneEndActualPerCurrent, 	0)
829. 
830. # Gap Calculation Methodology:
831. 	# Requested
832. 	SetVariable(GapRequested, 			0) 
833. 	SetVariable(GapRequestedStd, 		0) 
834. 	SetVariable(GapRequestedMft, 		0) 
835. 	SetVariable(GapRequestedOs, 		0) 
836. 	SetVariable(GapRequestedOriginal, 	0) 
837. 	
838. 	# Gap Adjustments
839. 	SetVariable(GapRounded, 			0)
840. 	# SetVariable(GapAdjusted, 			0)
841. 	SetVariable(GapAvailable, 			0)
842. 	SetVariable(GapCurrent, 			0)
843. 	SetVariable(GapActual, 				0)
844. 	SetVariable(GapUsed, 				0)
845. 	
846. 	# Gap Adjustments
847. 	SetVariable(GapRoundedLoc, 			0)
848. 	# SetVariable(GapAdjustedLoc, 		0)
849. 	SetVariable(GapAvailableLoc, 		0)
850. 	SetVariable(GapCurrentLoc, 			0)
851. 	SetVariable(GapActualLoc,			0)
852. 	SetVariable(GapUsedLoc,				0)
853. 	
854. 	# Space usage
855. 	SetVariable(ZoneFreePerRequested, 	0)
856. 	SetVariable(ZoneFreePerUsed, 		0)
857. 
858. # Gap Size & Rounding
859. 	SetVariable(ZoneGapSizePer, 		0)
860. 	SetVariable(ZoneVolRoundUpPer, 		0)
861. 	
862. 	# Free Space
863. 	SetVariable(ZoneFreeUsedPer, 		0)
864. 	SetVariable(ZoneFreeRequestedPer, 	0)
865. 
866. 
867. 	SetVariable(ZoneLabel, "Volume")
868. 	SetVariable(ZoneDescription, "Analysis...")
869. 	# Script: BannerSet
870. 
871. # NOTE: Can't round or truncate to integer precision. 
872. # This internal fields like ZoneCount format really badly.
873. #  for !RunTimeNow! does not work. None of the date functions do.
874. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
875. 
876. SetVariable(HeadingTemp2,	ZoneCount + 0)
877. 
878. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
879. 
880. Title('!Heading!')
881. 
882. /* pause(1) */
883. 
884. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
885. 
886. 
887. 
888. 	
889. 	  
890. 	SetVariable(VolumeLabel,		"!VolumeLabelDefault!")
891. 	SetVariable(VolumeMountPoint,	"!VolumeLabelDefault!")
892. 	SetVariable(VolumeDescription,	"")
893. 	SetVariable(VolumeUsedTotal,	0)
894. 	Title("")
895. 
896. 	SetVariable(ZoneStepDescription, "!ZoneStepDescriptionInitializing!")
897. 	# Script: BannerSet
898. 
899. # NOTE: Can't round or truncate to integer precision. 
900. # This internal fields like ZoneCount format really badly.
901. #  for !RunTimeNow! does not work. None of the date functions do.
902. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
903. 
904. SetVariable(HeadingTemp2,	ZoneCount + 0)
905. 
906. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
907. 
908. Title('!Heading!')
909. 
910. /* pause(1) */
911. 
912. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
913. 
914. 
915. 
916. /* ------------------------- */
917. # VOLUME TYPES
918. 
919. 	# Volumes
920. 	# .
921. 	# Only those were fully implemented:
922. 	# Sys
923. 	# Dev
924. 	# .
925. 	# Common types of volumes:
926. 	# Data
927. 	# Archive
928. 	# .
929. 	# Other historical volumes:
930. 	# (Actual use cases in a small sw house)
931. 	# Test
932. 	# TestXxxxx
933. 	# Live
934. 	# Server
935. 	# Client
936. 	# ClientXxxxx
937. 	# SysUtils
938. 	# .
939. 	# Note that almost any Zone is a potential Volume Type
940. 
941. # IMPORTANT: VOLUME NAME: SET YOUR:
942. 	/* VOLUME NAMES IN SettingsYours\SettingsYoursVolumeNames.MyDc */
943. 	/* 		or    			*/
944. 	/* VOLUME NAME (one only for override) in SettingsYours\SettingsYoursVolume.MyDc */
945. 	/* 		or here also 	*/
946. 	SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
947. 	SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
948. 
949. 	/* SetVariable(VolumeSys,"C:") */
950. 	/* SetVariable(VolumeDev,"E:") */
951. 
952. 	/* These are for dedicated disks. */
953. 	/* So it means JUST Data or JUST Archives. */
954. 
955. 	SetVariable(VolumeData,"!VolumeNamePrefix!Data")
956. 	SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
957. 	
958. 	# IMPORTANT: VOLUME NAME: 
959. 
960. 	# SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
961. 	# SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
962. 	# SetVariable(VolumeData,"!VolumeNamePrefix!Data")
963. 	# SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
964. 
965. 	#    or this:
966. 	
967. 	
968. 	SetVariable(VolumeSys,"NotUsed")
969. 	SetVariable(VolumeDev,"C:")
970. 	SetVariable(VolumeData,"NotUsed")
971. 	SetVariable(VolumeArchive,"F:")
972. 
973. #Script: SettingsYoursSysVolume
974. # SetVariable(VolumeSys,"C:")
975. 
976. 
977. 
978. /* ------------------------- */
979. # OS Disk Usage.
980. /* Percentage of disk used by OS */
981. 
982. 	SetVariable(OsPer, 0.18)
983. 
984. 	     SetVariable(ZoneCountOs, 5)
985. 
986.        SetVariable(ZoneCountType, 0) // not used
987.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
988. 
989. 	    SetVariable(ZoneCountSys, 2)
990. 	    SetVariable(ZoneCountDev, 7)
991. 
992. 	   SetVariable(ZoneCountData, 0)
993. 	SetVariable(ZoneCountArchive, 0)
994. 	
995. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
996. 
997. /* ------------------------- */
998. # ZONE TYPES. 
999. /* ------------------------- */
1000. 	/* Type Labels, Descriptions, Gaps and Rounding. */
1001. 	/* Load the Zone Definitions */
1002. 	/* These are file categories basically */
1003. 	/* and are maintained in a single file */
1004. 	/* for ease of maintenance. Here: */
1005. 	
1006. 	/* ------------------------- */
1007. # ROUNDING factors:
1008. 
1009. /* HERE if you want to tweak how type the Gaps are if growth is slow. */
1010. /* HERE if your DISK IS VERY FULL */
1011. /* This is where you can tweak growth rounding if the Volume gets really full. */
1012. /* You don't have to use these, you can use actual percentages in the Zone section. */
1013. 
1014. /* Note: Volume and Gap Sizes are paired to a degree and */
1015. /* set relative to each other. */
1016. 	
1017. 	      SetVariable(VolumeRoundUpNone, 	1) // ??? 1? s/b 0?
1018. 	      SetVariable(VolumeRoundUpTiny, 	0.005)
1019. 	     SetVariable(VolumeRoundUpSmall, 	0.01)
1020. 	    SetVariable(VolumeRoundUpMedium, 	0.02)
1021. 	     SetVariable(VolumeRoundUpLarge, 	0.03)
1022. 	SetVariable(VolumeRoundUpExtraLarge, 	0.05)
1023. 	
1024. 	    SetVariable(VolumeRoundUpBlogBu, 	0.10)
1025. 	
1026. 	      SetVariable(ZoneGapSizeNone, 		0)
1027. 	      SetVariable(ZoneGapSizeTiny, 		0.005)
1028. 	     SetVariable(ZoneGapSizeSmall, 		0.01)
1029. 	    SetVariable(ZoneGapSizeMedium, 		0.05)
1030. 	     SetVariable(ZoneGapSizeLarge, 		0.10)
1031. 	SetVariable(ZoneGapSizeExtraLarge, 		0.15)
1032. 		
1033. 	    SetVariable(ZoneGapSizeBlobBu, 		0.10)
1034. 
1035. /* ------------------------- */
1036. # ZONE SETTINGS:
1037. /* ------------------------- */
1038. /* These are the Zone Names */
1039. /* Regular is at the end but otherwise */
1040. /* this is in the order they appear on disk */
1041. /* ------------------------- */
1042. # Round Up:
1043. /* This rounds up to even locations on the volume to keep */
1044. /* the location of data relatively stable during fluctuation. */
1045. 
1046. /* NOTE: For Volume specifice settings you would have to copy these */
1047. /* next two sections and use them in the SettingsYours\SettingsYours for each Volume. */
1048. /* You would need a copy of these two to use in a Reset function between Volumes. */
1049. /* ------------------------- */
1050. /* Your Zone Gap consumption of free space is as a percentage. */
1051. /* Clearly this can not exceed 100%. Keep it under 99%. */
1052. /* ------------------------- */
1053. 
1054. /* ------------------------- */
1055. # Os Programs.
1056. # Boot.
1057. SetVariable(ZoneLabelBoot, 					"Boot")
1058. SetVariable(ZoneDescriptionBoot, 				"!ZoneLabelBoot!")
1059. SetVariable(ZoneVolRoundUpBoot, 				"!VolumeRoundUpSmall!")
1060. SetVariable(ZoneGapSizeBoot, 					"!ZoneGapSizeTiny!")
1061. 
1062. # Boot Data.
1063. SetVariable(ZoneLabelBootData, 				"BootData")
1064. SetVariable(ZoneDescriptionBootData, 			"!ZoneLabelBootData!")
1065. SetVariable(ZoneVolRoundUpBootData, 			"!VolumeRoundUpSmall!")
1066. SetVariable(ZoneGapSizeBootData, 				"!ZoneGapSizeTiny!")
1067. 
1068. # Program Hints.
1069. SetVariable(ZoneLabelProgramHints,			"ProgramHints")
1070. SetVariable(ZoneDescriptionProgramHints, 		"!ZoneLabelProgramHints!")
1071. SetVariable(ZoneVolRoundUpProgramHints,			"!VolumeRoundUpSmall!")
1072. SetVariable(ZoneGapSizeProgramHints,	 		"!ZoneGapSizeTiny!")
1073. 
1074. # Program Hints Data.
1075. SetVariable(ZoneLabelProgramHintsData,		"ProgramHintsData")
1076. SetVariable(ZoneDescriptionProgramHintsData, 	"!ZoneLabelProgramHintsData!")
1077. SetVariable(ZoneVolRoundUpProgramHintsData,		"!VolumeRoundUpSmall!")
1078. SetVariable(ZoneGapSizeProgramHintsData, 		"!ZoneGapSizeTiny!")
1079. 
1080. # Programs. Program Files. (X86, 64)
1081. SetVariable(ZoneLabelPrograms,				"Programs")
1082. SetVariable(ZoneDescriptionPrograms, 			"!ZoneLabelPrograms!")
1083. SetVariable(ZoneVolRoundUpPrograms, 			"!VolumeRoundUpMedium!")
1084. SetVariable(ZoneGapSizePrograms, 				"!ZoneGapSizeSmall!")
1085. 
1086. # Programs Windows.
1087. SetVariable(ZoneLabelProgramsWindows,		"ProgramsWindows")
1088. SetVariable(ZoneDescriptionProgramsWindows, 	"!ZoneLabelProgramsWidows!")
1089. SetVariable(ZoneVolRoundUpProgramsWindows, 		"!VolumeRoundUpMedium!")
1090. SetVariable(ZoneGapSizeProgramsWindows, 		"!ZoneGapSizeSmall!")
1091. 
1092. # Programs Data
1093. SetVariable(ZoneLabelProgramsData,			"ProgramsData")
1094. SetVariable(ZoneDescriptionProgramsData, 		"!ZoneLabelProgramsData!")
1095. SetVariable(ZoneVolRoundUpProgramsData, 		"!VolumeRoundUpMedium!")
1096. SetVariable(ZoneGapSizeProgramsData, 			"!ZoneGapSizeSmall!")
1097. 
1098. # System Files - Pagefile, Hiberfile, Dumpfile, Memory.dmp etc.
1099. SetVariable(ZoneLabelPageHiberDump,			"PageHiberDump")
1100. SetVariable(ZoneDescriptionPageHiberDump, 		"!ZoneLabelPageHiberDump!")
1101. SetVariable(ZoneVolRoundUpPageHiberDump,		"!VolumeRoundUpSmall!")
1102. SetVariable(ZoneGapSizePageHiberDump, 			"!ZoneGapSizeTiny")
1103. 
1104. /* ------------------------- */
1105. # Os Mft & Directories.
1106. # MFT
1107. SetVariable(ZoneLabelMft,					"MFT")
1108. SetVariable(ZoneDescriptionMft, 				"!ZoneLabelMft!")
1109. SetVariable(ZoneVolRoundUpMft,					"!VolumeRoundUpTiny!")
1110. SetVariable(ZoneGapSizeMft, 					"!ZoneGapSizeTiny!")
1111. 
1112. # Dir Directories (not files)
1113. SetVariable(ZoneLabelDir,					"DIR")
1114. SetVariable(ZoneDescriptionDir, 				"!ZoneLabelDir!")
1115. SetVariable(ZoneVolRoundUpDir,		 			"!VolumeRoundUpLarge!")
1116. SetVariable(ZoneGapSizeDir,		 				"!ZoneGapSizeTiny!")
1117. 
1118. /* ------------------------- */
1119. # Standard Zones.
1120. # Integrated Development Environment (IDE)
1121. # Scripts, powershell, cmd, other.
1122. # This can be changed to your mission critical categories
1123. SetVariable(ZoneLabelIdeScripts, 			"IdeScripts")
1124. SetVariable(ZoneDescriptionIdeScripts, 			"!ZoneLabelIdeScripts!")
1125. SetVariable(ZoneVolRoundUpIdeScripts, 			"!VolumeRoundUpSmall!")
1126. SetVariable(ZoneGapSizeIdeScripts, 				"!ZoneGapSizeMedium!")
1127. 
1128. # Dir Development
1129. # This can be changed to your mission critical categories
1130. # ToDo
1131. SetVariable(ZoneLabelDevToDo, 				"DevToDo")
1132. SetVariable(ZoneDescriptionDevToDo, 			"!ZoneLabelDevToDo!")
1133. SetVariable(ZoneVolRoundUpDevToDo, 				"!VolumeRoundUpSmall!")
1134. SetVariable(ZoneGapSizeDevToDo, 				"!ZoneGapSizeMedium!")
1135. 
1136. # Corporate. Accounting, services and so on.
1137. SetVariable(ZoneLabelLinksCorp, 			"LinksCorp")
1138. SetVariable(ZoneDescriptionLinksCorp, 			"!ZoneLabelLinksCorp!")
1139. SetVariable(ZoneVolRoundUpLinksCorp, 			"!VolumeRoundUpSmall!")
1140. SetVariable(ZoneGapSizeLinksCorp, 				"!ZoneGapSizeMedium!")
1141. 
1142. # People and (Winodows) User data.
1143. SetVariable(ZoneLabelPeople, 				"People")
1144. SetVariable(ZoneDescriptionPeople, 				"!ZoneLabelPeople!")
1145. SetVariable(ZoneVolRoundUpPeople, 				"!VolumeRoundUpMedium!")
1146. SetVariable(ZoneGapSizePeople, 					"!ZoneGapSizeMedium!")
1147. 
1148. # Games. 
1149. # Gammers should move this to above the MFT
1150. SetVariable(ZoneLabelGames, 				"Games")
1151. SetVariable(ZoneDescriptionGames, 				"!ZoneLabelGames!")
1152. SetVariable(ZoneVolRoundUpGames, 				"!VolumeRoundUpSmall!")
1153. SetVariable(ZoneGapSizeGames, 					"!ZoneGapSizeMedium!")
1154. 
1155. # Shares. IE Music, Art, Video, Podcast and so on.
1156. SetVariable(ZoneLabelShares, 				"Shares")
1157. SetVariable(ZoneDescriptionShares, 				"!ZoneLabelShares!")
1158. SetVariable(ZoneVolRoundUpShares, 				"!VolumeRoundUpSmall!")
1159. SetVariable(ZoneGapSizeShares, 					"!ZoneGapSizeMedium!")
1160. 
1161. # System Other Data.
1162. SetVariable(ZoneLabelSystemOtherData, 		"SystemOtherData")
1163. SetVariable(ZoneDescriptionSystemOtherData, 	"!ZoneLabelSystemOtherData!")
1164. SetVariable(ZoneVolRoundUpSystemOtherData, 		"!VolumeRoundUpSmall!")
1165. SetVariable(ZoneGapSizeSystemOtherData, 		"!ZoneGapSizeMedium!")
1166. 
1167. # Reference, knowledge base, documentation.
1168. SetVariable(ZoneLabelReference, 			"Reference")
1169. SetVariable(ZoneDescriptionReference, 			"!ZoneLabelReference!")
1170. SetVariable(ZoneVolRoundUpReference, 			"!VolumeRoundUpMedium!")
1171. SetVariable(ZoneGapSizeReference, 				"!VolumeRoundUpBlogBu!")
1172. 
1173. # Regular Data - Low priorty stuff
1174. SetVariable(ZoneLabelRegular, 				"Regular")
1175. SetVariable(ZoneDescriptionRegular, 			"!ZoneLabelRegular!")
1176. SetVariable(ZoneVolRoundUpRegular, 				"!VolumeRoundUpMedium!")
1177. SetVariable(ZoneGapSizeRegular, 				"!ZoneGapSizeMedium!")
1178. 
1179. /* ------------------------- */
1180. # Common.
1181. # Blobs. Large files.
1182. SetVariable(ZoneLabelBlobs, 				"Blobs")
1183. SetVariable(ZoneDescriptionBlobs, 			"!ZoneLabelBlobs!")
1184. SetVariable(ZoneVolRoundUpBlobs, 				"!VolumeRoundUpMedium!")
1185. SetVariable(ZoneGapSizeBlobs, 					"!VolumeRoundUpBlogBu!")
1186. 
1187. # Archives
1188. SetVariable(ZoneLabelArchivesBu, 			"ArchivesBu")
1189. SetVariable(ZoneDescriptionArchivesBu, 			"!ZoneLabelArchivesBu!")
1190. SetVariable(ZoneVolRoundUpArchivesBu, 			"!VolumeRoundUpTiny!")
1191. SetVariable(ZoneGapSizeArchivesBu, 				"!ZoneGapSizeTiny!")
1192. 
1193. /* ------------------------- */
1194. # Unallocated.
1195. # Zone99. Unknown. Unassigned. 
1196. # Unallocated to any zone.
1197. # This indicates an error condition.
1198. # Critical data may be here but should
1199. # be caught by the zone select they belong to.
1200. 
1201. # Unallocated
1202. SetVariable(ZoneLabelUnallocated, 			"Unallocated")
1203. SetVariable(ZoneDescriptionUnallocated, 		"!ZoneLabelUnallocated!")
1204. SetVariable(ZoneVolRoundUpUnallocated, 			"!VolumeRoundUpTiny!")
1205. SetVariable(ZoneGapSizeUnallocated, 			"!ZoneGapSizeTiny!")
1206. 
1207. /* ------------------------- */
1208. /* ------------------------- */
1209. # VOLUME MFT Location.
1210. /* The Volume Location of the MFT as a percentage of the Volume. */
1211. 		
1212. 		SetVariable(MftVolumeRoundUp, 		"!VolumeRoundUpLarge!")
1213. 		SetVariable(MftVolumeGapSize, 		"!ZoneGapSizeTiny!")
1214. 		
1215. 		# MFT CALCULATION METHODS.
1216. 			# STANDARD Method.
1217. 			/* IMPORTANT: Standard method currently in use. */
1218. 			/* IE: The others below are ignored but instructive. */
1219. 			/* None of the following settings are used, hence zero. */
1220. 			SetVariable(MftPer, 			0)
1221. 			SetVariable(MftLocation, 		0)
1222. 			
1223. 			# MFT Method.
1224. 			/* Place files at X% (MftPerSys) into the data on the Volume. */
1225. 			/* This is really tied the ratio of executables to data and blobs. */
1226. 			# SetVariable(MftPer, 				0.30)
1227. 			# SetVariable(MftLocation, 			1000000000)
1228. 			# SetVariable(MftGapSize, 			"!ZoneGapSizeLarge!")
1229. 		
1230. 			# FIXED Method.
1231. 			# SetVariable(MftLocation, 			1000000000) // (IE. Yours)
1232. 			# SetVariable(MftPer, 				MftLocation / VolumeSize)
1233. 			
1234. 			# ORIGINAL Method.
1235. 			/* DEPRECIATED, not in use. */
1236. 			/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
1237. 			# SetVariable(MftPer, 				0.30)
1238. 		    # SetVariable(MftSize, 				0)
1239. 		
1240. 		# ROUNDING.	
1241. 		# SetVariable(MftLocation,				RoundUp(MftLocation, VolumeSize * MftVolumeRoundUp))
1242. 		
1243. 		# MFT ZONE.
1244. 		/* Zone Number (not used for locating MFT.) */
1245. 		SetVariable(MftZone, 					4) // Insert before this zone, info only.
1246. 		/* Zone 10 on the Dev Volume */
1247. 	
1248. 	/* ------------------------- */
1249. 	# VOLUME SPECIFIC MFT.
1250. 	/* Note: You may need to set Volume specific values for the MFT location, */
1251. 	/* On these volume types do not "push" the data above the MFT table? */
1252. 	/* You can use a standard gap instead. */
1253. 		
1254. 			/* The current Volume Type Mft Percentage */
1255. 		    # SetVariable(MftPer, 				0)
1256. 		    # SetVariable(MftSize, 				0)
1257. 		    # SetVariable(MftSizeDefault,		"                0)
1258. 		    # SetVariable(MftPerTypedDefault, 	"!MftPer!")
1259. 			# Volume Types:	
1260. 			#         SetVariable(MftPerSys, 	0.35)
1261. 			# 	    SetVariable(MftPerDev, 		0.10)
1262. 			# 	   SetVariable(MftPerData, 		0.35)
1263. 			# 	SetVariable(MftPerArchive, 		0.10)
1264. 	
1265. 	/* ------------------------- */
1266. 	# VOLUME DIR Location.
1267. 	/* The amount of Gap between Mft and Dir's, the Location of DIR. */
1268. 	
1269. 		/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
1270. 	
1271. 		SetVariable(DirVolumeRoundUp, 			"!VolumeRoundUpLarge!")
1272. 		SetVariable(DirVolumeGapSize, 			"!ZoneGapSizeLarge!")
1273. 		
1274. /* ------------------------- */
1275. # SETTINGS YOURS
1276. /* empty */
1277. 
1278. /* ------------------------- */
1279. 
1280. /* ------------------------- */
1281. # STATISTICS
1282. /* ------------------------- */
1283. 
1284. # Xinclude "..\StatisticsInitialization.MyDc"X ToDo
1285. 
1286. 
1287. /* ------------------------- */
1288. # GAPS
1289. 	# TEST (FAILED!!!) NO BOOLEAN LOGIC AVAILABLE.
1290. 	SetVariable(FlagDoNotVacate, 0)
1291.  
1292. /* ------------------------- */
1293. # ZONE
1294. 	SetVariable(ZoneNoCurrent, 			0)
1295. 	SetVariable(ZoneNoCurrentAdjust, 	0) 
1296. 	SetVariable(ZoneNoDisplay,			0) 
1297. 
1298. 	SetVariable(ZoneListByLine, 		"Volume !VolumeLabel! started.
1299. ")
1300. 	SetVariable(ZoneStepByLine, 		"!ZoneStepDescriptionInitializing!
1301. ")
1302. 	SetVariable(ZoneStatisticsDetail, 	"")
1303. 
1304. /* ------------------------- */
1305. # ZONE FILE STEP (ACTIONS)
1306. 	/* Nothing to set here */
1307. 
1308. /* ------------------------- */
1309. # BLOB SIZE
1310. 
1311. 	# Size 10MB
1312. 	SetVariable(BlobFileSize, 10000000)
1313. 
1314. /* ------------------------- */
1315. # SKIP BLOCK
1316.  
1317. /* (important for run efficiency.) */
1318. /* FILES: */
1319. /* Day Files:	10 */
1320. /* Weekly:		10 */
1321. /* Monthly:		500 */
1322. /* Yearly:		1M */
1323. 
1324. 	# 100 Files - moved most blocks 
1325. 	#  10 Files - 20211105 (error - not done) 
1326. 	# 10 Files - (20211106) - Current
1327. 	SetVariable(SkipBlockFilesDay,		1)
1328. 	# 5 Files - (20211201)
1329. 	SetVariable(SkipBlockFilesWeek,		5)
1330. 	# 100 - 10 20211201
1331. 	SetVariable(SkipBlockFilesMonth,	10) // 500
1332. 	SetVariable(SkipBlockFilesYear,		1000000)
1333. 
1334. 	/* Current: */
1335. 	SetVariable(SkipBlockFiles,"!SkipBlockFilesMonth!")
1336. 
1337. /* BYTES: */
1338. /* Day Bytes:	1MB */
1339. /* Week Bytes:	1MB */
1340. /* Month Bytes:	500MB */
1341. /* Year Bytes:	5GB */
1342. 
1343. 	 # 50 MB Moved most existing blocks 
1344. 	 # 5 MB 20211105 (not done)
1345. 	 # 1 MB 20211105 - Current
1346. 	 # 100K - 20211201
1347. 	SetVariable(SkipBlockBytesDay,		100000)
1348. 	SetVariable(SkipBlockBytesWeek,		100000)
1349. 	SetVariable(SkipBlockBytesMonth,	100000000)
1350. 	#  500000000 0.5GB
1351. 	SetVariable(SkipBlockBytesYear,		5000000000)
1352. 
1353. 	/* Current: */
1354. 	SetVariable(SkipBlockBytes,"!SkipBlockBytesMonth!")
1355. 
1356. /* ------------------------- */
1357. # ZONE LOCATION METHODS:
1358. 
1359. # No 1) Standard. You can ignore this section
1360. 	/* Gaps between zones are a percentage of */
1361. 	/* free space auto adjusted to pack the used */
1362. 	/* space closely together and for performance. */
1363. 	
1364. 	/* The calculation will clear the Gap */
1365. 	/* and RoundUp to the fixed value present */
1366. 	
1367. 	SetVariable(ZoneMethodStd, 1)
1368. 
1369. /* The following are NOT FULLY IMPLEMENTED OR TESTED */
1370. # No 2) Mft. Relative to its location.
1371. 	SetVariable(ZoneMethodMft, (0-1))
1372. 
1373. # No 3) Os. Percentages are AFTER OsMftDir Space Used.
1374. 	SetVariable(ZoneMethodOs, (0-1))
1375. 
1376. # No 4) Orginal Mft/Os 1-5.
1377. 	SetVariable(ZoneMethodOrginal, (0-1))
1378. 
1379. # No 5) FIXED ZONES if you used them.
1380. 	
1381. 	SetVariable(ZoneMethodFixed, (0-1))
1382. 	SetVariable(ZoneMethodFixedPer, (0-1))
1383. 
1384. 	/* Not recommended */
1385. 	/* However doing all calcs is informative regarding what */
1386. 	/* Types of Volume data (Zones) exist. */
1387. 	
1388. 	/* Your FIXED calculation method, this can be: */
1389. 	SetVariable(ZoneMethodFixedVariantPer, (0-1))
1390. 	
1391. 	/* 1) Percentage. */
1392. 		/* So when it is 1 or On. */
1393. 		/* Not great but easy to use. */
1394. 		 
1395. 	/* 2) Fixed volume location. */
1396. 		/* When 0 or Off it is a volume location. */
1397. 		/* You will have to change: */
1398. 		/* file item xxxxxxxxx??? */
1399. 	
1400. 	/* FIXED VALUES: */
1401. 		/* SetVariable(ZoneMethodFixed, 1) */
1402. 	
1403. 		# Setting the following to a percentage or number:
1404. 		/* OS */
1405. 	    SetVariable(ZoneOsBoot, 0) // 1
1406. 	    SetVariable(ZoneOsProgramHints, 0) // 2
1407. 	    SetVariable(ZoneOsPrograms, 0) // 3
1408. 	    
1409. 	    /* MFT */
1410. 	    SetVariable(ZoneMft, 0) // Volume dependent
1411. 	    SetVariable(ZoneMftDir, 0) // Volume dependent
1412. 	
1413. 		/* Volume Sys */
1414. 	    # Os 3
1415. 	    # Mft + 2
1416. 	    SetVariable(ZoneSysRegular, 0) // 5
1417. 	    SetVariable(ZoneDevSpaceHog, 0) // 6
1418. 	
1419. 		/* Volume Dev */
1420. 	    # Os 3
1421. 	    SetVariable(ZoneDevDevToDo, 0) // 4
1422. 	    SetVariable(ZoneDevIdeScripts, 0) // 5
1423. 	    SetVariable(ZoneDevLinksCorp, 0) // 6
1424. 	    SetVariable(ZoneDevPeople, 0) // 7
1425. 	    # Mft + 2
1426. 	    SetVariable(ZoneDevShares, 0) // 10
1427. 	    SetVariable(ZoneDevSystemOtherData, 0) // 11
1428. 	    SetVariable(ZoneDevReference, 0) // 12
1429. 	    SetVariable(ZoneDevBlobsArchives, 0) // 13
1430. 	
1431. 		/* Volume Archive not used currently */
1432. 		/* Volume Data not used currently */
1433. 
1434. /* ------------------------- */
1435. # LOGGING:
1436. /* ------------------------- */
1437. 
1438. 	# Log File Name:
1439. 	SetVariable(LogFileName,"Defrag !VolumeStepDescription! 2021-12-14_15:29:55")
1440. 	SetVariable(LogFileZoneName,"Defrag !VolumeStepDescription! !ZoneStepDescription! 2021-12-14_15:29:55")
1441. 	
1442. 	#SetVariable(LogFileName,"C:\MyDefragLogs\Defrag !VolumeStepDescription! 2021-12-14_15:29:55")
1443. 	#SetVariable(LogFileZoneName,"C:\MyDefragLogs\Defrag !VolumeStepDescription! !ZoneStepDescription! 2021-12-14_15:29:55")
1444. 	/* SetVariable(LogFileName,"..\ScriptsLogs\!MdmMyDefrag! 2021-12-14_15:29:55.log") */
1445. 	/* SetVariable(LogFileName,"!ScriptDir!ScriptsLogs\!MdmMyDefrag! 2021-12-14_15:29:55.log") */
1446. 	/* SetVariable(LogFileName,"Defrag2021-12-14_15:29:55.txt") */
1447. 	/* SetVariable(LogFileName,"$ z ScriptsLogs\Defrag2021-12-14_15:29:55.txt") */
1448. 	
1449. 	SetVariable(VolumeStatisticsSummary, "Not ready")
1450. 	SetVariable(VolumeStatisticsDetail, "Not ready")
1451. 
1452. /* ------------------------- */
1453. # OVERRIDES
1454. /* ------------------------- */
1455. 
1456. 	# AUTOMATIC SETTINGS Run overrides:
1457. 	# Script: ZoneDoActionInteractive
1458. 	# AUTOMATIC SETTINGS Run overrides:
1459. 	# Which are not used in interacte runs
1460. 	# Xinclude "..\Settings\SettingsAutomaticRun.MyDc"X
1461. 
1462. 
1463. 
1464. 	# YOUR SETTINGS Volume overrides:
1465. 	/* empty */
1466. 
1467. 
1468. /* ------------------------- */
1469. # Create Run Log:
1470. 
1471. /* Write the header to the logfile. */
1472. 	# Script: BannerSet
1473. 
1474. # NOTE: Can't round or truncate to integer precision. 
1475. # This internal fields like ZoneCount format really badly.
1476. #  for !RunTimeNow! does not work. None of the date functions do.
1477. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
1478. 
1479. SetVariable(HeadingTemp2,	ZoneCount + 0)
1480. 
1481. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
1482. 
1483. Title('!Heading!')
1484. 
1485. /* pause(1) */
1486. 
1487. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
1488. 
1489. 
1490. 
1491. 	WriteLogfile("!LogFileName!", "Log File: !LogFileName! Started.")
1492. 	# Script: BannerLog
1493. 
1494. AppendLogfile("!LogFileName!", "!Heading!")
1495. 
1496. 
1497. 	AppendLogfile("!LogFileName!", "!PeriodWord!")
1498. 
1499. /* ------------------------- */
1500. /* Script Information */
1501. 	AppendLogfile("!LogFileName!", "!Description! !StartedWord!: 2021-12-14 15:29:55")
1502. 	AppendLogfile("!LogFileName!", "!PeriodWord!")
1503. 	AppendLogfile("!LogFileName!", "!ScriptWordCaps!:")
1504. 	AppendLogfile("!LogFileName!", "DefragDevDiskYearly")
1505. 	AppendLogfile("!LogFileName!", "!PeriodWord!")
1506. 	AppendLogfile("!LogFileName!", "!ScriptWordCaps! !DirectoryWord!:")
1507. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1508. 	AppendLogfile("!LogFileName!", "!PeriodWord!")
1509. 	AppendLogfile("!LogFileName!", "!LogWord! !FileWord!:")
1510. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1511. 	AppendLogfile("!LogFileName!", "!PeriodWord!")
1512. 
1513. 
1514. /* SkipBlock Yearly: */
1515. SetVariable(SkipBlockFiles,"!SkipBlockFilesYear!")
1516. SetVariable(SkipBlockBytes,"!SkipBlockBytesYear!")
1517. 
1518. /* Dev */
1519. # Script: DefragVolumeDev # Defrag Development Volume
1520. 
1521. SetVariable(VolumeLabel,		"!VolumeDev!")
1522. SetVariable(VolumeLabelSelect,	'Name("C:")
1523. ')
1524. 
1525. SetVariable(VolumeDescription,	"!DevelopmentWord!")
1526. # Script: DisplaySetVolume
1527. 
1528. SetVariable(VolumeStatisticsSummary,	"")
1529. SetVariable(VolumeStatisticsDetail,	    "")
1530. 
1531. SetVariable(VolumeStepDescription, 	"!VolumeLabel! !DashWord! !VolumeDescription!")
1532. SetVariable(ZoneStepDescription,	"")
1533. SetVariable(ZoneStepDescription,	"")
1534. 
1535. SetVariable(DateNow, 	DATETIME)
1536. SetVariable(TimeNow, 	Time)
1537. SetVariable(RunTimeNow, 	RunTime)
1538. 
1539. 
1540. # Script: VolumeStatisticsDetailGet
1541. 
1542. # Script: VolumeStatisticsSummaryGet
1543. # Set Volume summary stats:
1544. 
1545. # Cluster, Sector, Block adjust for display.
1546. # Bytes per cluster is volume specific.
1547. 
1548. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster -1)	
1549. 
1550. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1551. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1552. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1553. 
1554. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1555. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1556. 
1557. # Set the display text:
1558. # Script: VolumeStatisticsSummaryDisplay
1559. 
1560. SetVariable(VolumeStatisticsSummary, "----------------------------------------------------------
1561. VOLUME SUMMARY: !VolumeLabel! !VolumeDescription!
1562. Volume mountpoint:          !MountPoint!
1563. Volume label:               !VolumeLabel!
1564. Volume name:                !VolumeName!
1565. Volume type:                !VolumeType!
1566. ----------------------------------------------------------
1567.           Volume Size:       !VolumeSize! (!VolumeSizeG! gigabytes)
1568.           Volume Used:       !VolumeUsed! (!VolumeUsedG! gigabytes)
1569.           Volume Free:       !VolumeFree! (!VolumeFreeG! gigabytes)
1570.          
1571.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1572.       Volume Free Adj:       !VolumeFreeAdj!
1573. 
1574.    Unfragmented Items:       !FILES200N!
1575.      Fragmented Items:       !FILES210N!
1576. 
1577.     Unfragmented Data:       !FILES202N! bytes
1578.       Fragmented Data:       !FILES212N! bytes
1579. 
1580.              All Gaps:       !GAP00N!
1581.              All gaps:       !GAP10N! bytes
1582.           Average gap:       !GAP13N! bytes
1583.            Median gap:       !GAP14N! bytes
1584.           Biggest gap:       !GAP15N! bytes
1585. 
1586.              MFT Zone:       !MftZone! 
1587.              Location:       !MftLocation! 
1588.                  Size:                       0 
1589.             Gap slack:       !MftGapSlack!
1590. ----------------------------------------------------------
1591. ") 
1592. 
1593. 
1594. 
1595. # No Calculations needed.
1596. 
1597. # Set the display text:
1598. # This currently includes the summary within it.
1599. # Script: VolumeStatisticsDetailDisplay
1600. 
1601. SetVariable(VolumeStatisticsDetail, "----------------------------------------------------------
1602. VOLUME DETAILS: !VolumeLabel! !VolumeDescription!
1603. ----------------------------------------------------------
1604. Script Directory: G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts
1605. Command Line: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts\DefragDevDiskYearly.MyD" 
1606. Process ID: 14392
1607. Action: # File Action - All - Full -  SortByCreationDate
1608. # File Action - ZoneDoActionSortByCreationDateFull
1609. 	SortByCreationDate(Ascending)
1610. 	
1611. 
1612. Mode: Full
1613. Requested Volume: Name("C:")
1614. 
1615. ----------------------------------------------------------
1616. MOUNT POINT:
1617. 
1618.     Volume mountpoint:          !MountPoint!
1619.     Volume type:                !VolumeType!
1620.     Bytes per cluster:          !BytesPerCluster! bytes
1621.     Average end-begin distance: !AverageBeginEndDistance! clusters
1622.                                 !AverageBeginEndDistanceP!% of volume size
1623. 
1624.     Divisor:    (!DisplayUnitDivisor!)
1625.     Curr:       (!DisplayUnitDivisorCurrent!) 
1626. ----------------------------------------------------------
1627. LARGE and UNMOVABLES:
1628. 
1629.     UnmovablesTotalBytes:	!UnmovablesTotalBytes!
1630. FragmentedTotalFragments:	!FragmentedTotalFragments!
1631. 
1632. The 25 largest items from the LargestItemsList:
1633. !LargestItemsList!
1634. ----------------------------------------------------------
1635. FRAGMENTS:
1636. 
1637.     Unfragmented Items: !FILES200N!
1638.       Fragmented Items: !FILES210N!
1639.      Unfragmented Data: !FILES202N! bytes
1640.        Fragmented Data: !FILES212N! bytes
1641.     Gaps:
1642.               All Gaps: !GAP00N!
1643.               All gaps: !GAP10N! bytes
1644.            Average gap: !GAP13N! bytes
1645.             Median gap: !GAP14N! bytes
1646.            Biggest gap: !GAP15N! bytes
1647. 
1648. ----------------------------------------------------------
1649. GAPS:
1650. ----------------------------------------------------------
1651.    ----------------------------------------------------------
1652.    Counts:
1653.                        Count      Percentage of all
1654.                 ----------------- -----------------
1655.    Small gaps   !GAP01N! !GAP01P!%
1656.    Big gaps     !GAP02N! !GAP02P!%
1657.                 ----------------- -----------------
1658.    All gaps     !GAP00N! !GAP00P!
1659. 
1660.    ----------------------------------------------------------
1661.    By size:
1662.                       Bytes          Gigabytes      Percentage of all
1663.                 ----------------- ----------------- -----------------
1664.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1665.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1666.                 ----------------- ----------------- -----------------
1667.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1668. 
1669.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1670.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1671.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1672.    ----------------------------------------------------------
1673. 
1674. ----------------------------------------------------------
1675. FILE STATISTICS:
1676. ----------------------------------------------------------
1677. ----------------------------------------------------------
1678. ITEM COUNT:
1679. ----------------------------------------------------------
1680. Number of files and folders:
1681. 
1682.               Unfragmented       Fragmented            All
1683.    ------- ----------------- ----------------- -----------------
1684.    Files   !FILES000N! !FILES010N! !FILES020N!
1685.    Folders !FILES100N! !FILES110N! !FILES120N!
1686.    ------- ----------------- ----------------- -----------------
1687.    All     !FILES200N! !FILES210N! !FILES220N!
1688. 
1689. ----------------------------------------------------------
1690. Percentage of total:
1691. 
1692.               Unfragmented       Fragmented            All
1693.    ------- ----------------- ----------------- -----------------
1694.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1695.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1696.    ------- ----------------- ----------------- -----------------
1697.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1698. 
1699. ----------------------------------------------------------
1700. OCCUPIED SIZE on disk:
1701. ----------------------------------------------------------
1702. Bytes:
1703.               Unfragmented       Fragmented            All
1704.    ------- ----------------- ----------------- -----------------
1705.    Files   !FILES002N! !FILES012N! !FILES022N!
1706.    Folders !FILES102N! !FILES112N! !FILES122N!
1707.    ------- ----------------- ----------------- -----------------
1708.    All     !FILES202N! !FILES212N! !FILES222N!
1709. 
1710. ----------------------------------------------------------
1711. Gigabytes:
1712.               Unfragmented       Fragmented            All
1713.    ------- ----------------- ----------------- -----------------
1714.    Files   !FILES002G! !FILES012G! !FILES022G!
1715.    Folders !FILES102G! !FILES112G! !FILES122G!
1716.    ------- ----------------- ----------------- -----------------
1717.    All     !FILES202G! !FILES212G! !FILES222G!
1718. 
1719. ----------------------------------------------------------
1720. Percentage:
1721.               Unfragmented       Fragmented            All
1722.    ------- ----------------- ----------------- -----------------
1723.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1724.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1725.    ------- ----------------- ----------------- -----------------
1726.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1727. 
1728. ----------------------------------------------------------
1729. USED SIZE:
1730. ----------------------------------------------------------
1731. Bytes:
1732.               Unfragmented       Fragmented            All
1733.    ------- ----------------- ----------------- -----------------
1734.    Files   !FILES001N! !FILES011N! !FILES021N!
1735.    Folders !FILES101N! !FILES111N! !FILES121N!
1736.    ------- ----------------- ----------------- -----------------
1737.    All     !FILES201N! !FILES211N! !FILES221N!
1738. 
1739. ----------------------------------------------------------
1740. Gigabytes:
1741.               Unfragmented       Fragmented            All
1742.    ------- ----------------- ----------------- -----------------
1743.    Files   !FILES001G! !FILES011G! !FILES021G!
1744.    Folders !FILES101G! !FILES111G! !FILES121G!
1745.    ------- ----------------- ----------------- -----------------
1746.    All     !FILES201G! !FILES211G! !FILES221G!
1747. 
1748. ----------------------------------------------------------
1749. Percentage:
1750.               Unfragmented       Fragmented            All
1751.    ------- ----------------- ----------------- -----------------
1752.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1753.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1754.    ------- ----------------- ----------------- -----------------
1755.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1756. 
1757. ----------------------------------------------------------
1758. Volume Detailed Statistics end.
1759. ----------------------------------------------------------
1760. ")
1761. 
1762. /* 
1763. */
1764. 
1765. 
1766. # Clear list of Zones processed
1767. # Zones processed
1768. SetVariable(ZoneListByLine, 		"!VolumeWordCaps! !VolumeLabel! !StartedWord! !DateNow! !TimeNow! !RunTimeNow!!ColonWord!
1769. ")
1770. 
1771. # Clear list of Steps processed within Zone
1772. # Zone processing steps
1773. SetVariable(ZoneStepByLine, 		"!PendingWord!!PeriodWord!
1774. ")
1775. 
1776. # Script: BannerDescriptionSet
1777. 
1778. # Script: BannerSet
1779. 
1780. # NOTE: Can't round or truncate to integer precision. 
1781. # This internal fields like ZoneCount format really badly.
1782. #  for !RunTimeNow! does not work. None of the date functions do.
1783. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
1784. 
1785. SetVariable(HeadingTemp2,	ZoneCount + 0)
1786. 
1787. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
1788. 
1789. Title('!Heading!')
1790. 
1791. /* pause(1) */
1792. 
1793. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
1794. 
1795. 
1796. # Script: BannerLog
1797. 
1798. AppendLogfile("!LogFileName!", "!Heading!")
1799. 
1800. 
1801. 
1802. pause(2)
1803. 
1804. # Precision issue: (!VolumeNoCurrent!!DashWord!!ZoneNoCurrent!!DashWord!!ZoneStepNoCurrent!) 
1805. 
1806. # Script: SettingsRunVolume
1807. 
1808. SetVariable(ZoneListByLine, "")
1809. SetVariable(ZoneStatisticsReport, "")
1810. 
1811. # This script is part of the standard disk configuration
1812. # Author: David G. Horsman (DBA MacroDM) (C) 2019
1813. # based on MyDefrag distribution.
1814. 
1815. /* Progress Display */
1816. SetVariable(ZoneListByLine, 	"Volume !VolumeLabel! start.
1817. ")
1818. SetVariable(ZoneStepByLine, 	"
1819. ")
1820. 
1821. # VOLUME INFORMATION
1822. 
1823. SetVariable(VolumeNoCurrent, VolumeNoCurrent + 1)
1824. SetVariable(VolumeNoAdjCurrent, VolumeNoCurrent + VolumeCurrentAjust) //ToDo check this
1825. 
1826. SetVariable(ZoneNoCurrent, 			0)
1827. SetVariable(ZoneNoCurrentAdjust, 	0) 
1828. SetVariable(ZoneNoDisplay,			0) 
1829. 
1830. SetVariable(ZoneListByLine, 		"Volume !VolumeLabel! started.
1831. ")
1832. SetVariable(ZoneStepByLine, 		"Initialize.
1833. ")
1834. SetVariable(ZoneStatisticsDetail, 	"")
1835. 
1836. SetVariable(ZoneStepNoCurrent, 0)
1837. 
1838. 
1839. # Script: ZoneDoCurrentClear
1840. 
1841. SetVariable(ZoneTypeSelectCurrent, 		"")
1842. SetVariable(ZoneStatisticsData, 		"")
1843. SetVariable(ZoneStepByLine, 			"")
1844. 
1845. SetVariable(ZoneBeginCurrent, 			0)
1846. SetVariable(ZoneBeginPerCurrent, 		0)
1847. SetVariable(ZoneEndCurrent, 			0)
1848. SetVariable(ZoneEndPerCurrent, 			0)
1849. 
1850. SetVariable(ZoneSizeCurrent,			0)
1851. SetVariable(ZoneSizePerCurrent,			0)
1852. 
1853. SetVariable(ZoneGapRequestedCurrent,	0)
1854. SetVariable(ZoneGapRoundedCurrent, 		0)
1855. SetVariable(ZoneGapAdjustedCurrent, 	0)
1856. SetVariable(ZoneGapAvailableCurrent, 	0)
1857. SetVariable(ZoneGapCurrent,				0)
1858. SetVariable(ZoneGapUsedCurrent, 		0)
1859. 
1860. SetVariable(ZoneGapActualCurrent, 		0)
1861. SetVariable(ZoneGapActualPerCurrent, 	0)
1862. 
1863. SetVariable(ZoneSizeActual, 			0)
1864. SetVariable(ZoneSizeActualCurrent,		0)
1865. 
1866. SetVariable(ZoneEndActual, 				0)
1867. SetVariable(ZoneEndActualCurrent,		0)			
1868. SetVariable(ZoneSizeActualPerCurrent, 	0)
1869.       
1870. SetVariable(ZoneFilesFolders,			0)
1871. SetVariable(ZoneFilesFoldersPer,		0) 
1872. 
1873. SetVariable(ZoneFragments,				0)
1874. SetVariable(ZoneFragmentsPer,			0) 
1875. 		
1876. SetVariable(ZoneEndActualCurrent, 		0)
1877. SetVariable(ZoneEndActualPerCurrent, 	0)
1878. 
1879. # Gap Calculation Methodology:
1880. 	# Requested
1881. 	SetVariable(GapRequested, 			0) 
1882. 	SetVariable(GapRequestedStd, 		0) 
1883. 	SetVariable(GapRequestedMft, 		0) 
1884. 	SetVariable(GapRequestedOs, 		0) 
1885. 	SetVariable(GapRequestedOriginal, 	0) 
1886. 	
1887. 	# Gap Adjustments
1888. 	SetVariable(GapRounded, 			0)
1889. 	# SetVariable(GapAdjusted, 			0)
1890. 	SetVariable(GapAvailable, 			0)
1891. 	SetVariable(GapCurrent, 			0)
1892. 	SetVariable(GapActual, 				0)
1893. 	SetVariable(GapUsed, 				0)
1894. 	
1895. 	# Gap Adjustments
1896. 	SetVariable(GapRoundedLoc, 			0)
1897. 	# SetVariable(GapAdjustedLoc, 		0)
1898. 	SetVariable(GapAvailableLoc, 		0)
1899. 	SetVariable(GapCurrentLoc, 			0)
1900. 	SetVariable(GapActualLoc,			0)
1901. 	SetVariable(GapUsedLoc,				0)
1902. 	
1903. 	# Space usage
1904. 	SetVariable(ZoneFreePerRequested, 	0)
1905. 	SetVariable(ZoneFreePerUsed, 		0)
1906. 
1907. # Gap Size & Rounding
1908. 	SetVariable(ZoneGapSizePer, 		0)
1909. 	SetVariable(ZoneVolRoundUpPer, 		0)
1910. 	
1911. 	# Free Space
1912. 	SetVariable(ZoneFreeUsedPer, 		0)
1913. 	SetVariable(ZoneFreeRequestedPer, 	0)
1914. 
1915. 
1916. # Script: BannerSet
1917. 
1918. # NOTE: Can't round or truncate to integer precision. 
1919. # This internal fields like ZoneCount format really badly.
1920. #  for !RunTimeNow! does not work. None of the date functions do.
1921. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
1922. 
1923. SetVariable(HeadingTemp2,	ZoneCount + 0)
1924. 
1925. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
1926. 
1927. Title('!Heading!')
1928. 
1929. /* pause(1) */
1930. 
1931. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
1932. 
1933. 
1934. 
1935. # OVERRIDES
1936. # YOUR SETTINGS Volume overrides:
1937. 
1938. #Script: SettingsYoursSysVolume
1939. # SetVariable(VolumeSys,"C:")
1940. 
1941. 
1942. # Script: DisplaySetVolume
1943. 
1944. SetVariable(VolumeStatisticsSummary,	"")
1945. SetVariable(VolumeStatisticsDetail,	    "")
1946. 
1947. SetVariable(VolumeStepDescription, 	"!VolumeLabel! !DashWord! !VolumeDescription!")
1948. SetVariable(ZoneStepDescription,	"")
1949. SetVariable(ZoneStepDescription,	"")
1950. 
1951. SetVariable(DateNow, 	DATETIME)
1952. SetVariable(TimeNow, 	Time)
1953. SetVariable(RunTimeNow, 	RunTime)
1954. 
1955. 
1956. # Script: VolumeStatisticsDetailGet
1957. 
1958. # Script: VolumeStatisticsSummaryGet
1959. # Set Volume summary stats:
1960. 
1961. # Cluster, Sector, Block adjust for display.
1962. # Bytes per cluster is volume specific.
1963. 
1964. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster -1)	
1965. 
1966. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1967. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1968. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1969. 
1970. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1971. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1972. 
1973. # Set the display text:
1974. # Script: VolumeStatisticsSummaryDisplay
1975. 
1976. SetVariable(VolumeStatisticsSummary, "----------------------------------------------------------
1977. VOLUME SUMMARY: !VolumeLabel! !VolumeDescription!
1978. Volume mountpoint:          !MountPoint!
1979. Volume label:               !VolumeLabel!
1980. Volume name:                !VolumeName!
1981. Volume type:                !VolumeType!
1982. ----------------------------------------------------------
1983.           Volume Size:       !VolumeSize! (!VolumeSizeG! gigabytes)
1984.           Volume Used:       !VolumeUsed! (!VolumeUsedG! gigabytes)
1985.           Volume Free:       !VolumeFree! (!VolumeFreeG! gigabytes)
1986.          
1987.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1988.       Volume Free Adj:       !VolumeFreeAdj!
1989. 
1990.    Unfragmented Items:       !FILES200N!
1991.      Fragmented Items:       !FILES210N!
1992. 
1993.     Unfragmented Data:       !FILES202N! bytes
1994.       Fragmented Data:       !FILES212N! bytes
1995. 
1996.              All Gaps:       !GAP00N!
1997.              All gaps:       !GAP10N! bytes
1998.           Average gap:       !GAP13N! bytes
1999.            Median gap:       !GAP14N! bytes
2000.           Biggest gap:       !GAP15N! bytes
2001. 
2002.              MFT Zone:       !MftZone! 
2003.              Location:       !MftLocation! 
2004.                  Size:                       0 
2005.             Gap slack:       !MftGapSlack!
2006. ----------------------------------------------------------
2007. ") 
2008. 
2009. 
2010. 
2011. # No Calculations needed.
2012. 
2013. # Set the display text:
2014. # This currently includes the summary within it.
2015. # Script: VolumeStatisticsDetailDisplay
2016. 
2017. SetVariable(VolumeStatisticsDetail, "----------------------------------------------------------
2018. VOLUME DETAILS: !VolumeLabel! !VolumeDescription!
2019. ----------------------------------------------------------
2020. Script Directory: G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts
2021. Command Line: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts\DefragDevDiskYearly.MyD" 
2022. Process ID: 14392
2023. Action: # File Action - All - Full -  SortByCreationDate
2024. # File Action - ZoneDoActionSortByCreationDateFull
2025. 	SortByCreationDate(Ascending)
2026. 	
2027. 
2028. Mode: Full
2029. Requested Volume: Name("C:")
2030. 
2031. ----------------------------------------------------------
2032. MOUNT POINT:
2033. 
2034.     Volume mountpoint:          !MountPoint!
2035.     Volume type:                !VolumeType!
2036.     Bytes per cluster:          !BytesPerCluster! bytes
2037.     Average end-begin distance: !AverageBeginEndDistance! clusters
2038.                                 !AverageBeginEndDistanceP!% of volume size
2039. 
2040.     Divisor:    (!DisplayUnitDivisor!)
2041.     Curr:       (!DisplayUnitDivisorCurrent!) 
2042. ----------------------------------------------------------
2043. LARGE and UNMOVABLES:
2044. 
2045.     UnmovablesTotalBytes:	!UnmovablesTotalBytes!
2046. FragmentedTotalFragments:	!FragmentedTotalFragments!
2047. 
2048. The 25 largest items from the LargestItemsList:
2049. !LargestItemsList!
2050. ----------------------------------------------------------
2051. FRAGMENTS:
2052. 
2053.     Unfragmented Items: !FILES200N!
2054.       Fragmented Items: !FILES210N!
2055.      Unfragmented Data: !FILES202N! bytes
2056.        Fragmented Data: !FILES212N! bytes
2057.     Gaps:
2058.               All Gaps: !GAP00N!
2059.               All gaps: !GAP10N! bytes
2060.            Average gap: !GAP13N! bytes
2061.             Median gap: !GAP14N! bytes
2062.            Biggest gap: !GAP15N! bytes
2063. 
2064. ----------------------------------------------------------
2065. GAPS:
2066. ----------------------------------------------------------
2067.    ----------------------------------------------------------
2068.    Counts:
2069.                        Count      Percentage of all
2070.                 ----------------- -----------------
2071.    Small gaps   !GAP01N! !GAP01P!%
2072.    Big gaps     !GAP02N! !GAP02P!%
2073.                 ----------------- -----------------
2074.    All gaps     !GAP00N! !GAP00P!
2075. 
2076.    ----------------------------------------------------------
2077.    By size:
2078.                       Bytes          Gigabytes      Percentage of all
2079.                 ----------------- ----------------- -----------------
2080.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
2081.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
2082.                 ----------------- ----------------- -----------------
2083.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
2084. 
2085.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
2086.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
2087.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
2088.    ----------------------------------------------------------
2089. 
2090. ----------------------------------------------------------
2091. FILE STATISTICS:
2092. ----------------------------------------------------------
2093. ----------------------------------------------------------
2094. ITEM COUNT:
2095. ----------------------------------------------------------
2096. Number of files and folders:
2097. 
2098.               Unfragmented       Fragmented            All
2099.    ------- ----------------- ----------------- -----------------
2100.    Files   !FILES000N! !FILES010N! !FILES020N!
2101.    Folders !FILES100N! !FILES110N! !FILES120N!
2102.    ------- ----------------- ----------------- -----------------
2103.    All     !FILES200N! !FILES210N! !FILES220N!
2104. 
2105. ----------------------------------------------------------
2106. Percentage of total:
2107. 
2108.               Unfragmented       Fragmented            All
2109.    ------- ----------------- ----------------- -----------------
2110.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
2111.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
2112.    ------- ----------------- ----------------- -----------------
2113.    All     !FILES200P!%!FILES210P!%!FILES220P!%
2114. 
2115. ----------------------------------------------------------
2116. OCCUPIED SIZE on disk:
2117. ----------------------------------------------------------
2118. Bytes:
2119.               Unfragmented       Fragmented            All
2120.    ------- ----------------- ----------------- -----------------
2121.    Files   !FILES002N! !FILES012N! !FILES022N!
2122.    Folders !FILES102N! !FILES112N! !FILES122N!
2123.    ------- ----------------- ----------------- -----------------
2124.    All     !FILES202N! !FILES212N! !FILES222N!
2125. 
2126. ----------------------------------------------------------
2127. Gigabytes:
2128.               Unfragmented       Fragmented            All
2129.    ------- ----------------- ----------------- -----------------
2130.    Files   !FILES002G! !FILES012G! !FILES022G!
2131.    Folders !FILES102G! !FILES112G! !FILES122G!
2132.    ------- ----------------- ----------------- -----------------
2133.    All     !FILES202G! !FILES212G! !FILES222G!
2134. 
2135. ----------------------------------------------------------
2136. Percentage:
2137.               Unfragmented       Fragmented            All
2138.    ------- ----------------- ----------------- -----------------
2139.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
2140.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
2141.    ------- ----------------- ----------------- -----------------
2142.    All     !FILES202P!%!FILES212P!%!FILES222P!%
2143. 
2144. ----------------------------------------------------------
2145. USED SIZE:
2146. ----------------------------------------------------------
2147. Bytes:
2148.               Unfragmented       Fragmented            All
2149.    ------- ----------------- ----------------- -----------------
2150.    Files   !FILES001N! !FILES011N! !FILES021N!
2151.    Folders !FILES101N! !FILES111N! !FILES121N!
2152.    ------- ----------------- ----------------- -----------------
2153.    All     !FILES201N! !FILES211N! !FILES221N!
2154. 
2155. ----------------------------------------------------------
2156. Gigabytes:
2157.               Unfragmented       Fragmented            All
2158.    ------- ----------------- ----------------- -----------------
2159.    Files   !FILES001G! !FILES011G! !FILES021G!
2160.    Folders !FILES101G! !FILES111G! !FILES121G!
2161.    ------- ----------------- ----------------- -----------------
2162.    All     !FILES201G! !FILES211G! !FILES221G!
2163. 
2164. ----------------------------------------------------------
2165. Percentage:
2166.               Unfragmented       Fragmented            All
2167.    ------- ----------------- ----------------- -----------------
2168.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
2169.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
2170.    ------- ----------------- ----------------- -----------------
2171.    All     !FILES201P!%!FILES211P!%!FILES221P!%
2172. 
2173. ----------------------------------------------------------
2174. Volume Detailed Statistics end.
2175. ----------------------------------------------------------
2176. ")
2177. 
2178. /* 
2179. */
2180. 
2181. 
2182. # Clear list of Zones processed
2183. # Zones processed
2184. SetVariable(ZoneListByLine, 		"!VolumeWordCaps! !VolumeLabel! !StartedWord! !DateNow! !TimeNow! !RunTimeNow!!ColonWord!
2185. ")
2186. 
2187. # Clear list of Steps processed within Zone
2188. # Zone processing steps
2189. SetVariable(ZoneStepByLine, 		"!PendingWord!!PeriodWord!
2190. ")
2191. 
2192. # Script: BannerDescriptionSet
2193. 
2194. # Script: BannerSet
2195. 
2196. # NOTE: Can't round or truncate to integer precision. 
2197. # This internal fields like ZoneCount format really badly.
2198. #  for !RunTimeNow! does not work. None of the date functions do.
2199. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2200. 
2201. SetVariable(HeadingTemp2,	ZoneCount + 0)
2202. 
2203. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
2204. 
2205. Title('!Heading!')
2206. 
2207. /* pause(1) */
2208. 
2209. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
2210. 
2211. 
2212. # Script: BannerLog
2213. 
2214. AppendLogfile("!LogFileName!", "!Heading!")
2215. 
2216. 
2217. 
2218. pause(2)
2219. 
2220. # Precision issue: (!VolumeNoCurrent!!DashWord!!ZoneNoCurrent!!DashWord!!ZoneStepNoCurrent!) 
2221. 
2222. # LOGGING:
2223. 	# Script: BannerDescriptionSet
2224. 
2225. # Script: BannerSet
2226. 
2227. # NOTE: Can't round or truncate to integer precision. 
2228. # This internal fields like ZoneCount format really badly.
2229. #  for !RunTimeNow! does not work. None of the date functions do.
2230. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2231. 
2232. SetVariable(HeadingTemp2,	ZoneCount + 0)
2233. 
2234. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
2235. 
2236. Title('!Heading!')
2237. 
2238. /* pause(1) */
2239. 
2240. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
2241. 
2242. 
2243. # Script: BannerLog
2244. 
2245. AppendLogfile("!LogFileName!", "!Heading!")
2246. 
2247. 
2248. 
2249. 
2250. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-12-14 15:29:55")
2251. 	AppendLogfile("!LogFileName!", "!PeriodWord!")
2252. 	AppendLogfile("!LogFileName!", "Script !DirectoryWord!:")
2253. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
2254. 	AppendLogfile("!LogFileName!", "!PeriodWord!")
2255. 	AppendLogfile("!LogFileName!", "Log File:")
2256. 	AppendLogfile("!LogFileName!", "!LogFileName!")
2257. 	AppendLogfile("!LogFileName!", "!PeriodWord!")
2258. 	/* AppendLogfile("!LogFileName!", "Log Header:") */
2259. 	/* AppendLogfile("!LogFileName!", "!LogHeader!") */
2260. 	/* AppendLogfile("!LogFileName!", "End of Log Header.") */
2261. 	AppendLogfile("!LogFileName!", "!PeriodWord!")
2262. 
2263. 	AppendLogfile("!LogFileName!", "MFT Percentage: !MftPer!")
2264. 	AppendLogfile("!LogFileName!", "MFT Volume RoundUp: !MftRoundUp!")
2265. 	AppendLogfile("!LogFileName!", "MFT Gap %: !MftAdjRoundUp!")
2266. 	AppendLogfile("!LogFileName!", "!PeriodWord!")
2267. 
2268. /* This file is where you override the above setting for */
2269. /* global settings. */
2270. /* There is a "SettingsYours\SettingsYours???.MyDc" for each volume type */
2271. /* so this is where you set the volume specific settings */
2272. /* or you can put them all in the file below. */
2273. 
2274. # Volume Preprocessing Do Before.
2275. /* empty */
2276. 
2277. 
2278. # BANNER:
2279. # Xinclude "..\Volume\VolumeSizeLog.MyDc"X
2280. 
2281. /* Missed: Zone Type ToDo: */
2282. /* Games Zone Type */
2283. /* Music Zone Type */
2284. /* Video Zone Type */
2285. 
2286. 
2287. 
2288. 
2289. SetVariable(MftZone,			"!ProgramsWord!")
2290. 
2291. /* empty */
2292. 
2293. 
2294. # Script: DefragAnyComplexVolume
2295. /* Complex Volume */
2296. # MyDefrag v4.0 script: Defrag Complex (Mixed or Any) Volume.
2297. 
2298. SetVariable(DateNow, 	DATETIME)
2299. SetVariable(TimeNow, 	Time)
2300. SetVariable(RunTimeNow, 	RunTime)
2301. 
2302. 
2303. SetVariable(MftZone, "!DevWord!")
2304. 
2305. # Script: VolumeStatisticsDetailGet
2306. 
2307. # Script: VolumeStatisticsSummaryGet
2308. # Set Volume summary stats:
2309. 
2310. # Cluster, Sector, Block adjust for display.
2311. # Bytes per cluster is volume specific.
2312. 
2313. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster -1)	
2314. 
2315. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
2316. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
2317. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2318. 
2319. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
2320. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2321. 
2322. # Set the display text:
2323. # Script: VolumeStatisticsSummaryDisplay
2324. 
2325. SetVariable(VolumeStatisticsSummary, "----------------------------------------------------------
2326. VOLUME SUMMARY: !VolumeLabel! !VolumeDescription!
2327. Volume mountpoint:          !MountPoint!
2328. Volume label:               !VolumeLabel!
2329. Volume name:                !VolumeName!
2330. Volume type:                !VolumeType!
2331. ----------------------------------------------------------
2332.           Volume Size:       !VolumeSize! (!VolumeSizeG! gigabytes)
2333.           Volume Used:       !VolumeUsed! (!VolumeUsedG! gigabytes)
2334.           Volume Free:       !VolumeFree! (!VolumeFreeG! gigabytes)
2335.          
2336.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
2337.       Volume Free Adj:       !VolumeFreeAdj!
2338. 
2339.    Unfragmented Items:       !FILES200N!
2340.      Fragmented Items:       !FILES210N!
2341. 
2342.     Unfragmented Data:       !FILES202N! bytes
2343.       Fragmented Data:       !FILES212N! bytes
2344. 
2345.              All Gaps:       !GAP00N!
2346.              All gaps:       !GAP10N! bytes
2347.           Average gap:       !GAP13N! bytes
2348.            Median gap:       !GAP14N! bytes
2349.           Biggest gap:       !GAP15N! bytes
2350. 
2351.              MFT Zone:       !MftZone! 
2352.              Location:       !MftLocation! 
2353.                  Size:                       0 
2354.             Gap slack:       !MftGapSlack!
2355. ----------------------------------------------------------
2356. ") 
2357. 
2358. 
2359. 
2360. # No Calculations needed.
2361. 
2362. # Set the display text:
2363. # This currently includes the summary within it.
2364. # Script: VolumeStatisticsDetailDisplay
2365. 
2366. SetVariable(VolumeStatisticsDetail, "----------------------------------------------------------
2367. VOLUME DETAILS: !VolumeLabel! !VolumeDescription!
2368. ----------------------------------------------------------
2369. Script Directory: G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts
2370. Command Line: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts\DefragDevDiskYearly.MyD" 
2371. Process ID: 14392
2372. Action: # File Action - All - Full -  SortByCreationDate
2373. # File Action - ZoneDoActionSortByCreationDateFull
2374. 	SortByCreationDate(Ascending)
2375. 	
2376. 
2377. Mode: Full
2378. Requested Volume: Name("C:")
2379. 
2380. ----------------------------------------------------------
2381. MOUNT POINT:
2382. 
2383.     Volume mountpoint:          !MountPoint!
2384.     Volume type:                !VolumeType!
2385.     Bytes per cluster:          !BytesPerCluster! bytes
2386.     Average end-begin distance: !AverageBeginEndDistance! clusters
2387.                                 !AverageBeginEndDistanceP!% of volume size
2388. 
2389.     Divisor:    (!DisplayUnitDivisor!)
2390.     Curr:       (!DisplayUnitDivisorCurrent!) 
2391. ----------------------------------------------------------
2392. LARGE and UNMOVABLES:
2393. 
2394.     UnmovablesTotalBytes:	!UnmovablesTotalBytes!
2395. FragmentedTotalFragments:	!FragmentedTotalFragments!
2396. 
2397. The 25 largest items from the LargestItemsList:
2398. !LargestItemsList!
2399. ----------------------------------------------------------
2400. FRAGMENTS:
2401. 
2402.     Unfragmented Items: !FILES200N!
2403.       Fragmented Items: !FILES210N!
2404.      Unfragmented Data: !FILES202N! bytes
2405.        Fragmented Data: !FILES212N! bytes
2406.     Gaps:
2407.               All Gaps: !GAP00N!
2408.               All gaps: !GAP10N! bytes
2409.            Average gap: !GAP13N! bytes
2410.             Median gap: !GAP14N! bytes
2411.            Biggest gap: !GAP15N! bytes
2412. 
2413. ----------------------------------------------------------
2414. GAPS:
2415. ----------------------------------------------------------
2416.    ----------------------------------------------------------
2417.    Counts:
2418.                        Count      Percentage of all
2419.                 ----------------- -----------------
2420.    Small gaps   !GAP01N! !GAP01P!%
2421.    Big gaps     !GAP02N! !GAP02P!%
2422.                 ----------------- -----------------
2423.    All gaps     !GAP00N! !GAP00P!
2424. 
2425.    ----------------------------------------------------------
2426.    By size:
2427.                       Bytes          Gigabytes      Percentage of all
2428.                 ----------------- ----------------- -----------------
2429.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
2430.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
2431.                 ----------------- ----------------- -----------------
2432.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
2433. 
2434.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
2435.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
2436.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
2437.    ----------------------------------------------------------
2438. 
2439. ----------------------------------------------------------
2440. FILE STATISTICS:
2441. ----------------------------------------------------------
2442. ----------------------------------------------------------
2443. ITEM COUNT:
2444. ----------------------------------------------------------
2445. Number of files and folders:
2446. 
2447.               Unfragmented       Fragmented            All
2448.    ------- ----------------- ----------------- -----------------
2449.    Files   !FILES000N! !FILES010N! !FILES020N!
2450.    Folders !FILES100N! !FILES110N! !FILES120N!
2451.    ------- ----------------- ----------------- -----------------
2452.    All     !FILES200N! !FILES210N! !FILES220N!
2453. 
2454. ----------------------------------------------------------
2455. Percentage of total:
2456. 
2457.               Unfragmented       Fragmented            All
2458.    ------- ----------------- ----------------- -----------------
2459.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
2460.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
2461.    ------- ----------------- ----------------- -----------------
2462.    All     !FILES200P!%!FILES210P!%!FILES220P!%
2463. 
2464. ----------------------------------------------------------
2465. OCCUPIED SIZE on disk:
2466. ----------------------------------------------------------
2467. Bytes:
2468.               Unfragmented       Fragmented            All
2469.    ------- ----------------- ----------------- -----------------
2470.    Files   !FILES002N! !FILES012N! !FILES022N!
2471.    Folders !FILES102N! !FILES112N! !FILES122N!
2472.    ------- ----------------- ----------------- -----------------
2473.    All     !FILES202N! !FILES212N! !FILES222N!
2474. 
2475. ----------------------------------------------------------
2476. Gigabytes:
2477.               Unfragmented       Fragmented            All
2478.    ------- ----------------- ----------------- -----------------
2479.    Files   !FILES002G! !FILES012G! !FILES022G!
2480.    Folders !FILES102G! !FILES112G! !FILES122G!
2481.    ------- ----------------- ----------------- -----------------
2482.    All     !FILES202G! !FILES212G! !FILES222G!
2483. 
2484. ----------------------------------------------------------
2485. Percentage:
2486.               Unfragmented       Fragmented            All
2487.    ------- ----------------- ----------------- -----------------
2488.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
2489.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
2490.    ------- ----------------- ----------------- -----------------
2491.    All     !FILES202P!%!FILES212P!%!FILES222P!%
2492. 
2493. ----------------------------------------------------------
2494. USED SIZE:
2495. ----------------------------------------------------------
2496. Bytes:
2497.               Unfragmented       Fragmented            All
2498.    ------- ----------------- ----------------- -----------------
2499.    Files   !FILES001N! !FILES011N! !FILES021N!
2500.    Folders !FILES101N! !FILES111N! !FILES121N!
2501.    ------- ----------------- ----------------- -----------------
2502.    All     !FILES201N! !FILES211N! !FILES221N!
2503. 
2504. ----------------------------------------------------------
2505. Gigabytes:
2506.               Unfragmented       Fragmented            All
2507.    ------- ----------------- ----------------- -----------------
2508.    Files   !FILES001G! !FILES011G! !FILES021G!
2509.    Folders !FILES101G! !FILES111G! !FILES121G!
2510.    ------- ----------------- ----------------- -----------------
2511.    All     !FILES201G! !FILES211G! !FILES221G!
2512. 
2513. ----------------------------------------------------------
2514. Percentage:
2515.               Unfragmented       Fragmented            All
2516.    ------- ----------------- ----------------- -----------------
2517.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
2518.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
2519.    ------- ----------------- ----------------- -----------------
2520.    All     !FILES201P!%!FILES211P!%!FILES221P!%
2521. 
2522. ----------------------------------------------------------
2523. Volume Detailed Statistics end.
2524. ----------------------------------------------------------
2525. ")
2526. 
2527. /* 
2528. */
2529. 
2530. SetStatisticsWindowText("!VolumeStatisticsSummary!")
2531. 
2532. # RunProgram("..\Commands\WriteDateTime.bat LastVolume")
2533. SetVariable(ZoneStepDescription,"!VolumeLabel! !VolumeDescription! !!StartedWord!!ColonWord! !DateNow! !TimeNow! !StartingWord! after !RunTimeNow!.")
2534. 
2535. # Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
2536. 
2537. SetVariable(ZoneStepDescription,'!ZoneStepDescription!
2538. Analyzing Volume.
2539. ')
2540. # Script: DisplaySetZoneStep
2541. # Increment
2542. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2543. 
2544. # Display this zone step
2545. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
2546. ')
2547. 
2548. # Script: BannerSet
2549. 
2550. # NOTE: Can't round or truncate to integer precision. 
2551. # This internal fields like ZoneCount format really badly.
2552. #  for !RunTimeNow! does not work. None of the date functions do.
2553. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2554. 
2555. SetVariable(HeadingTemp2,	ZoneCount + 0)
2556. 
2557. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
2558. 
2559. Title('!Heading!')
2560. 
2561. /* pause(1) */
2562. 
2563. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
2564. 
2565. 
2566. # Script: DisplaySetWindowText
2567. # Zone Footer Set Statistics Window Text
2568. 
2569. SetStatisticsWindowText("!Heading!
2570. ----------------------------------------------------------
2571. Zones Processed: 
2572. ----------------------------------------------------------
2573. !ZoneListByLine!
2574. ----------------------------------------------------------
2575. Zone Processing Step:
2576. !ZoneStepByLine!    
2577. ----------------------------------------------------------
2578. ----------------------------------------------------------
2579. CURRENT ZONE:
2580. !ZoneStatisticsReport!
2581. ----------------------------------------------------------
2582. ----------------------------------------------------------
2583. ----------------------------------------------------------
2584. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
2585. ----------------------------------------------------------
2586. !VolumeStatisticsSummary!
2587. !VolumeStatisticsDetail!
2588. ----------------------------------------------------------
2589. ----------------------------------------------------------
2590. Zone Detailed Report:
2591. ----------------------------------------------------------
2592. !ZoneStatisticsDetail!
2593. ----------------------------------------------------------
2594. ")
2595. 
2596. 
2597. 
2598. /* ------------------------- */
2599. /* ------------------------- */
2600. 	# (Label("!VolumeLabel!") or Name("!VolumeLabel!") 
2601. VolumeSelect
2602. 	(
2603. 	Name("C:")
2604. 
2605. 	 # or CommandlineVolumes()
2606. 	 )
2607. 	 and Writable(yes) 
2608. 	 and Mounted(yes)
2609. /* ------------------------- */
2610. VolumeActions
2611. /* ------------------------- */
2612. /* Volume Init */
2613. SetVariable(VolumeLabel,			MountPoint)
2614. # Script: VolumeStatisticsDetailGet
2615. 
2616. # Script: VolumeStatisticsSummaryGet
2617. # Set Volume summary stats:
2618. 
2619. # Cluster, Sector, Block adjust for display.
2620. # Bytes per cluster is volume specific.
2621. 
2622. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster -1)	
2623. 
2624. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
2625. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
2626. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2627. 
2628. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
2629. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2630. 
2631. # Set the display text:
2632. # Script: VolumeStatisticsSummaryDisplay
2633. 
2634. SetVariable(VolumeStatisticsSummary, "----------------------------------------------------------
2635. VOLUME SUMMARY: !VolumeLabel! !VolumeDescription!
2636. Volume mountpoint:          !MountPoint!
2637. Volume label:               !VolumeLabel!
2638. Volume name:                !VolumeName!
2639. Volume type:                !VolumeType!
2640. ----------------------------------------------------------
2641.           Volume Size:       !VolumeSize! (!VolumeSizeG! gigabytes)
2642.           Volume Used:       !VolumeUsed! (!VolumeUsedG! gigabytes)
2643.           Volume Free:       !VolumeFree! (!VolumeFreeG! gigabytes)
2644.          
2645.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
2646.       Volume Free Adj:       !VolumeFreeAdj!
2647. 
2648.    Unfragmented Items:       !FILES200N!
2649.      Fragmented Items:       !FILES210N!
2650. 
2651.     Unfragmented Data:       !FILES202N! bytes
2652.       Fragmented Data:       !FILES212N! bytes
2653. 
2654.              All Gaps:       !GAP00N!
2655.              All gaps:       !GAP10N! bytes
2656.           Average gap:       !GAP13N! bytes
2657.            Median gap:       !GAP14N! bytes
2658.           Biggest gap:       !GAP15N! bytes
2659. 
2660.              MFT Zone:       !MftZone! 
2661.              Location:       !MftLocation! 
2662.                  Size:                       0 
2663.             Gap slack:       !MftGapSlack!
2664. ----------------------------------------------------------
2665. ") 
2666. 
2667. 
2668. 
2669. # No Calculations needed.
2670. 
2671. # Set the display text:
2672. # This currently includes the summary within it.
2673. # Script: VolumeStatisticsDetailDisplay
2674. 
2675. SetVariable(VolumeStatisticsDetail, "----------------------------------------------------------
2676. VOLUME DETAILS: !VolumeLabel! !VolumeDescription!
2677. ----------------------------------------------------------
2678. Script Directory: G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts
2679. Command Line: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts\DefragDevDiskYearly.MyD" 
2680. Process ID: 14392
2681. Action: # File Action - All - Full -  SortByCreationDate
2682. # File Action - ZoneDoActionSortByCreationDateFull
2683. 	SortByCreationDate(Ascending)
2684. 	
2685. 
2686. Mode: Full
2687. Requested Volume: Name("C:")
2688. 
2689. ----------------------------------------------------------
2690. MOUNT POINT:
2691. 
2692.     Volume mountpoint:          !MountPoint!
2693.     Volume type:                !VolumeType!
2694.     Bytes per cluster:          !BytesPerCluster! bytes
2695.     Average end-begin distance: !AverageBeginEndDistance! clusters
2696.                                 !AverageBeginEndDistanceP!% of volume size
2697. 
2698.     Divisor:    (!DisplayUnitDivisor!)
2699.     Curr:       (!DisplayUnitDivisorCurrent!) 
2700. ----------------------------------------------------------
2701. LARGE and UNMOVABLES:
2702. 
2703.     UnmovablesTotalBytes:	!UnmovablesTotalBytes!
2704. FragmentedTotalFragments:	!FragmentedTotalFragments!
2705. 
2706. The 25 largest items from the LargestItemsList:
2707. !LargestItemsList!
2708. ----------------------------------------------------------
2709. FRAGMENTS:
2710. 
2711.     Unfragmented Items: !FILES200N!
2712.       Fragmented Items: !FILES210N!
2713.      Unfragmented Data: !FILES202N! bytes
2714.        Fragmented Data: !FILES212N! bytes
2715.     Gaps:
2716.               All Gaps: !GAP00N!
2717.               All gaps: !GAP10N! bytes
2718.            Average gap: !GAP13N! bytes
2719.             Median gap: !GAP14N! bytes
2720.            Biggest gap: !GAP15N! bytes
2721. 
2722. ----------------------------------------------------------
2723. GAPS:
2724. ----------------------------------------------------------
2725.    ----------------------------------------------------------
2726.    Counts:
2727.                        Count      Percentage of all
2728.                 ----------------- -----------------
2729.    Small gaps   !GAP01N! !GAP01P!%
2730.    Big gaps     !GAP02N! !GAP02P!%
2731.                 ----------------- -----------------
2732.    All gaps     !GAP00N! !GAP00P!
2733. 
2734.    ----------------------------------------------------------
2735.    By size:
2736.                       Bytes          Gigabytes      Percentage of all
2737.                 ----------------- ----------------- -----------------
2738.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
2739.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
2740.                 ----------------- ----------------- -----------------
2741.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
2742. 
2743.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
2744.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
2745.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
2746.    ----------------------------------------------------------
2747. 
2748. ----------------------------------------------------------
2749. FILE STATISTICS:
2750. ----------------------------------------------------------
2751. ----------------------------------------------------------
2752. ITEM COUNT:
2753. ----------------------------------------------------------
2754. Number of files and folders:
2755. 
2756.               Unfragmented       Fragmented            All
2757.    ------- ----------------- ----------------- -----------------
2758.    Files   !FILES000N! !FILES010N! !FILES020N!
2759.    Folders !FILES100N! !FILES110N! !FILES120N!
2760.    ------- ----------------- ----------------- -----------------
2761.    All     !FILES200N! !FILES210N! !FILES220N!
2762. 
2763. ----------------------------------------------------------
2764. Percentage of total:
2765. 
2766.               Unfragmented       Fragmented            All
2767.    ------- ----------------- ----------------- -----------------
2768.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
2769.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
2770.    ------- ----------------- ----------------- -----------------
2771.    All     !FILES200P!%!FILES210P!%!FILES220P!%
2772. 
2773. ----------------------------------------------------------
2774. OCCUPIED SIZE on disk:
2775. ----------------------------------------------------------
2776. Bytes:
2777.               Unfragmented       Fragmented            All
2778.    ------- ----------------- ----------------- -----------------
2779.    Files   !FILES002N! !FILES012N! !FILES022N!
2780.    Folders !FILES102N! !FILES112N! !FILES122N!
2781.    ------- ----------------- ----------------- -----------------
2782.    All     !FILES202N! !FILES212N! !FILES222N!
2783. 
2784. ----------------------------------------------------------
2785. Gigabytes:
2786.               Unfragmented       Fragmented            All
2787.    ------- ----------------- ----------------- -----------------
2788.    Files   !FILES002G! !FILES012G! !FILES022G!
2789.    Folders !FILES102G! !FILES112G! !FILES122G!
2790.    ------- ----------------- ----------------- -----------------
2791.    All     !FILES202G! !FILES212G! !FILES222G!
2792. 
2793. ----------------------------------------------------------
2794. Percentage:
2795.               Unfragmented       Fragmented            All
2796.    ------- ----------------- ----------------- -----------------
2797.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
2798.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
2799.    ------- ----------------- ----------------- -----------------
2800.    All     !FILES202P!%!FILES212P!%!FILES222P!%
2801. 
2802. ----------------------------------------------------------
2803. USED SIZE:
2804. ----------------------------------------------------------
2805. Bytes:
2806.               Unfragmented       Fragmented            All
2807.    ------- ----------------- ----------------- -----------------
2808.    Files   !FILES001N! !FILES011N! !FILES021N!
2809.    Folders !FILES101N! !FILES111N! !FILES121N!
2810.    ------- ----------------- ----------------- -----------------
2811.    All     !FILES201N! !FILES211N! !FILES221N!
2812. 
2813. ----------------------------------------------------------
2814. Gigabytes:
2815.               Unfragmented       Fragmented            All
2816.    ------- ----------------- ----------------- -----------------
2817.    Files   !FILES001G! !FILES011G! !FILES021G!
2818.    Folders !FILES101G! !FILES111G! !FILES121G!
2819.    ------- ----------------- ----------------- -----------------
2820.    All     !FILES201G! !FILES211G! !FILES221G!
2821. 
2822. ----------------------------------------------------------
2823. Percentage:
2824.               Unfragmented       Fragmented            All
2825.    ------- ----------------- ----------------- -----------------
2826.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
2827.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
2828.    ------- ----------------- ----------------- -----------------
2829.    All     !FILES201P!%!FILES211P!%!FILES221P!%
2830. 
2831. ----------------------------------------------------------
2832. Volume Detailed Statistics end.
2833. ----------------------------------------------------------
2834. ")
2835. 
2836. /* 
2837. */
2838. 
2839. SetStatisticsWindowText("!VolumeStatisticsSummary!")
2840. SetVariable(ZoneStepDescription,	"!VolumeStartDescription!")
2841. SetVariable(ZoneStepDescription,	"!AnalyzeWord!")
2842. # Script: DisplaySetZoneStep
2843. # Increment
2844. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2845. 
2846. # Display this zone step
2847. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
2848. ')
2849. 
2850. # Script: BannerSet
2851. 
2852. # NOTE: Can't round or truncate to integer precision. 
2853. # This internal fields like ZoneCount format really badly.
2854. #  for !RunTimeNow! does not work. None of the date functions do.
2855. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2856. 
2857. SetVariable(HeadingTemp2,	ZoneCount + 0)
2858. 
2859. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
2860. 
2861. Title('!Heading!')
2862. 
2863. /* pause(1) */
2864. 
2865. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
2866. 
2867. 
2868. # Script: DisplaySetWindowText
2869. # Zone Footer Set Statistics Window Text
2870. 
2871. SetStatisticsWindowText("!Heading!
2872. ----------------------------------------------------------
2873. Zones Processed: 
2874. ----------------------------------------------------------
2875. !ZoneListByLine!
2876. ----------------------------------------------------------
2877. Zone Processing Step:
2878. !ZoneStepByLine!    
2879. ----------------------------------------------------------
2880. ----------------------------------------------------------
2881. CURRENT ZONE:
2882. !ZoneStatisticsReport!
2883. ----------------------------------------------------------
2884. ----------------------------------------------------------
2885. ----------------------------------------------------------
2886. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
2887. ----------------------------------------------------------
2888. !VolumeStatisticsSummary!
2889. !VolumeStatisticsDetail!
2890. ----------------------------------------------------------
2891. ----------------------------------------------------------
2892. Zone Detailed Report:
2893. ----------------------------------------------------------
2894. !ZoneStatisticsDetail!
2895. ----------------------------------------------------------
2896. ")
2897. 
2898. 
2899. 
2900. 
2901. # Script: VolumeWhenStarted
2902. 
2903. SetVariable(VolumeFreeAdj, (VolumeFree * (VolumeUsed / VolumeSize)))
2904. 
2905. SetVariable(MftLocation, RoundUp(VolumeUsed * MftPerDev, VolumeSize * VolumeRoundUpLarge)) 
2906. 
2907. SetVariable(ZoneStatisticsReport, "")
2908. SetVariable(ZoneListByLine, 		"Volume !VolumeLabel! started.
2909. ")
2910. SetVariable(ZoneStepByLine, 		"Initialize.
2911. ")
2912. SetVariable(ZoneStatisticsDetail, 	"")
2913. 
2914. SetVariable(ZoneNoCurrent, 			0)
2915. SetVariable(ZoneNoCurrentAdjust, 	0) 
2916. SetVariable(ZoneNoDisplay,			0) 
2917. 
2918. SetVariable(DateNow, 	DATETIME)
2919. SetVariable(TimeNow, 	Time)
2920. SetVariable(RunTimeNow, 	RunTime)
2921. 
2922. 
2923. # Script: BannerSet
2924. 
2925. # NOTE: Can't round or truncate to integer precision. 
2926. # This internal fields like ZoneCount format really badly.
2927. #  for !RunTimeNow! does not work. None of the date functions do.
2928. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2929. 
2930. SetVariable(HeadingTemp2,	ZoneCount + 0)
2931. 
2932. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
2933. 
2934. Title('!Heading!')
2935. 
2936. /* pause(1) */
2937. 
2938. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
2939. 
2940. 
2941. # Script: BannerLog
2942. 
2943. AppendLogfile("!LogFileName!", "!Heading!")
2944. 
2945. 
2946. # Script: VolumeStatisticsDetailGet
2947. 
2948. # Script: VolumeStatisticsSummaryGet
2949. # Set Volume summary stats:
2950. 
2951. # Cluster, Sector, Block adjust for display.
2952. # Bytes per cluster is volume specific.
2953. 
2954. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster -1)	
2955. 
2956. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
2957. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
2958. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2959. 
2960. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
2961. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2962. 
2963. # Set the display text:
2964. # Script: VolumeStatisticsSummaryDisplay
2965. 
2966. SetVariable(VolumeStatisticsSummary, "----------------------------------------------------------
2967. VOLUME SUMMARY: !VolumeLabel! !VolumeDescription!
2968. Volume mountpoint:          !MountPoint!
2969. Volume label:               !VolumeLabel!
2970. Volume name:                !VolumeName!
2971. Volume type:                !VolumeType!
2972. ----------------------------------------------------------
2973.           Volume Size:       !VolumeSize! (!VolumeSizeG! gigabytes)
2974.           Volume Used:       !VolumeUsed! (!VolumeUsedG! gigabytes)
2975.           Volume Free:       !VolumeFree! (!VolumeFreeG! gigabytes)
2976.          
2977.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
2978.       Volume Free Adj:       !VolumeFreeAdj!
2979. 
2980.    Unfragmented Items:       !FILES200N!
2981.      Fragmented Items:       !FILES210N!
2982. 
2983.     Unfragmented Data:       !FILES202N! bytes
2984.       Fragmented Data:       !FILES212N! bytes
2985. 
2986.              All Gaps:       !GAP00N!
2987.              All gaps:       !GAP10N! bytes
2988.           Average gap:       !GAP13N! bytes
2989.            Median gap:       !GAP14N! bytes
2990.           Biggest gap:       !GAP15N! bytes
2991. 
2992.              MFT Zone:       !MftZone! 
2993.              Location:       !MftLocation! 
2994.                  Size:                       0 
2995.             Gap slack:       !MftGapSlack!
2996. ----------------------------------------------------------
2997. ") 
2998. 
2999. 
3000. 
3001. # No Calculations needed.
3002. 
3003. # Set the display text:
3004. # This currently includes the summary within it.
3005. # Script: VolumeStatisticsDetailDisplay
3006. 
3007. SetVariable(VolumeStatisticsDetail, "----------------------------------------------------------
3008. VOLUME DETAILS: !VolumeLabel! !VolumeDescription!
3009. ----------------------------------------------------------
3010. Script Directory: G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts
3011. Command Line: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts\DefragDevDiskYearly.MyD" 
3012. Process ID: 14392
3013. Action: # File Action - All - Full -  SortByCreationDate
3014. # File Action - ZoneDoActionSortByCreationDateFull
3015. 	SortByCreationDate(Ascending)
3016. 	
3017. 
3018. Mode: Full
3019. Requested Volume: Name("C:")
3020. 
3021. ----------------------------------------------------------
3022. MOUNT POINT:
3023. 
3024.     Volume mountpoint:          !MountPoint!
3025.     Volume type:                !VolumeType!
3026.     Bytes per cluster:          !BytesPerCluster! bytes
3027.     Average end-begin distance: !AverageBeginEndDistance! clusters
3028.                                 !AverageBeginEndDistanceP!% of volume size
3029. 
3030.     Divisor:    (!DisplayUnitDivisor!)
3031.     Curr:       (!DisplayUnitDivisorCurrent!) 
3032. ----------------------------------------------------------
3033. LARGE and UNMOVABLES:
3034. 
3035.     UnmovablesTotalBytes:	!UnmovablesTotalBytes!
3036. FragmentedTotalFragments:	!FragmentedTotalFragments!
3037. 
3038. The 25 largest items from the LargestItemsList:
3039. !LargestItemsList!
3040. ----------------------------------------------------------
3041. FRAGMENTS:
3042. 
3043.     Unfragmented Items: !FILES200N!
3044.       Fragmented Items: !FILES210N!
3045.      Unfragmented Data: !FILES202N! bytes
3046.        Fragmented Data: !FILES212N! bytes
3047.     Gaps:
3048.               All Gaps: !GAP00N!
3049.               All gaps: !GAP10N! bytes
3050.            Average gap: !GAP13N! bytes
3051.             Median gap: !GAP14N! bytes
3052.            Biggest gap: !GAP15N! bytes
3053. 
3054. ----------------------------------------------------------
3055. GAPS:
3056. ----------------------------------------------------------
3057.    ----------------------------------------------------------
3058.    Counts:
3059.                        Count      Percentage of all
3060.                 ----------------- -----------------
3061.    Small gaps   !GAP01N! !GAP01P!%
3062.    Big gaps     !GAP02N! !GAP02P!%
3063.                 ----------------- -----------------
3064.    All gaps     !GAP00N! !GAP00P!
3065. 
3066.    ----------------------------------------------------------
3067.    By size:
3068.                       Bytes          Gigabytes      Percentage of all
3069.                 ----------------- ----------------- -----------------
3070.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
3071.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
3072.                 ----------------- ----------------- -----------------
3073.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
3074. 
3075.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
3076.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
3077.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
3078.    ----------------------------------------------------------
3079. 
3080. ----------------------------------------------------------
3081. FILE STATISTICS:
3082. ----------------------------------------------------------
3083. ----------------------------------------------------------
3084. ITEM COUNT:
3085. ----------------------------------------------------------
3086. Number of files and folders:
3087. 
3088.               Unfragmented       Fragmented            All
3089.    ------- ----------------- ----------------- -----------------
3090.    Files   !FILES000N! !FILES010N! !FILES020N!
3091.    Folders !FILES100N! !FILES110N! !FILES120N!
3092.    ------- ----------------- ----------------- -----------------
3093.    All     !FILES200N! !FILES210N! !FILES220N!
3094. 
3095. ----------------------------------------------------------
3096. Percentage of total:
3097. 
3098.               Unfragmented       Fragmented            All
3099.    ------- ----------------- ----------------- -----------------
3100.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
3101.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
3102.    ------- ----------------- ----------------- -----------------
3103.    All     !FILES200P!%!FILES210P!%!FILES220P!%
3104. 
3105. ----------------------------------------------------------
3106. OCCUPIED SIZE on disk:
3107. ----------------------------------------------------------
3108. Bytes:
3109.               Unfragmented       Fragmented            All
3110.    ------- ----------------- ----------------- -----------------
3111.    Files   !FILES002N! !FILES012N! !FILES022N!
3112.    Folders !FILES102N! !FILES112N! !FILES122N!
3113.    ------- ----------------- ----------------- -----------------
3114.    All     !FILES202N! !FILES212N! !FILES222N!
3115. 
3116. ----------------------------------------------------------
3117. Gigabytes:
3118.               Unfragmented       Fragmented            All
3119.    ------- ----------------- ----------------- -----------------
3120.    Files   !FILES002G! !FILES012G! !FILES022G!
3121.    Folders !FILES102G! !FILES112G! !FILES122G!
3122.    ------- ----------------- ----------------- -----------------
3123.    All     !FILES202G! !FILES212G! !FILES222G!
3124. 
3125. ----------------------------------------------------------
3126. Percentage:
3127.               Unfragmented       Fragmented            All
3128.    ------- ----------------- ----------------- -----------------
3129.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
3130.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
3131.    ------- ----------------- ----------------- -----------------
3132.    All     !FILES202P!%!FILES212P!%!FILES222P!%
3133. 
3134. ----------------------------------------------------------
3135. USED SIZE:
3136. ----------------------------------------------------------
3137. Bytes:
3138.               Unfragmented       Fragmented            All
3139.    ------- ----------------- ----------------- -----------------
3140.    Files   !FILES001N! !FILES011N! !FILES021N!
3141.    Folders !FILES101N! !FILES111N! !FILES121N!
3142.    ------- ----------------- ----------------- -----------------
3143.    All     !FILES201N! !FILES211N! !FILES221N!
3144. 
3145. ----------------------------------------------------------
3146. Gigabytes:
3147.               Unfragmented       Fragmented            All
3148.    ------- ----------------- ----------------- -----------------
3149.    Files   !FILES001G! !FILES011G! !FILES021G!
3150.    Folders !FILES101G! !FILES111G! !FILES121G!
3151.    ------- ----------------- ----------------- -----------------
3152.    All     !FILES201G! !FILES211G! !FILES221G!
3153. 
3154. ----------------------------------------------------------
3155. Percentage:
3156.               Unfragmented       Fragmented            All
3157.    ------- ----------------- ----------------- -----------------
3158.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
3159.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
3160.    ------- ----------------- ----------------- -----------------
3161.    All     !FILES201P!%!FILES211P!%!FILES221P!%
3162. 
3163. ----------------------------------------------------------
3164. Volume Detailed Statistics end.
3165. ----------------------------------------------------------
3166. ")
3167. 
3168. /* 
3169. */
3170. 
3171. # Script: BannerLog
3172. 
3173. AppendLogfile("!LogFileName!", "!Heading!")
3174. 
3175. 
3176. 
3177. /* Write/display stats: */
3178. # Log:
3179. SetVariable(VolumeDescription,"")
3180. 
3181. SetVariable(VolumeDescriptionBlock,"")
3182. SetVariable(VolumeDescriptionBlock, "!VolumeDescriptionBlock!!!Heading! started.")
3183. SetVariable(VolumeDescriptionBlock, "!VolumeDescriptionBlock!
3184. !DateNow! !TimeNow!.")
3185. 
3186. SetVariable(VolumeDescriptionBlock, "!VolumeDescriptionBlock!
3187. .")
3188. SetVariable(VolumeDescriptionBlock, "!VolumeDescriptionBlock!
3189. .")
3190. 
3191. SetVariable(VolumeDescriptionBlock, "!VolumeDescriptionBlock!
3192. Volume: !VolumeLabel!")
3193. 
3194. SetVariable(VolumeDescriptionBlock, "!VolumeDescriptionBlock!
3195. .")
3196. 
3197. SetVariable(VolumeDescriptionBlock, "!VolumeDescriptionBlock!
3198. !VolumeStatisticsDetail!")
3199. SetVariable(VolumeDescriptionBlock, "!VolumeDescriptionBlock!
3200. .")
3201. 
3202. SetVariable(VolumeDescriptionBlock, "!VolumeDescriptionBlock!
3203. DefragDevDiskYearly started.")
3204. SetVariable(VolumeDescriptionBlock, "!VolumeDescriptionBlock!
3205. 2021-12-14 15:29:56.")
3206. SetVariable(VolumeDescriptionBlock, "!VolumeDescriptionBlock!
3207. .")
3208. 
3209. WriteLogfile("!LogFileName! Volume !VolumenName! !RunDescription! !DateNow! !TimeNow!","!VolumeDescriptionBlock!")
3210. AppendLogfile("!LogFileName!","!VolumeDescriptionBlock!")
3211. 
3212. # In program statistics window (view):
3213. SetStatisticsWindowText("!VolumeDescriptionBlock!")
3214. 
3215. 
3216. /* ------------------------- */
3217. /* 1 System Zones 1 - 7 */
3218. /* ------------------------- */
3219. 	# Script: DefragZoneGroupOs
3220. # Defrag Zones Os
3221. 	/* System Zones */
3222. 
3223. SetVariable(DateNow, 	DATETIME)
3224. SetVariable(TimeNow, 	Time)
3225. SetVariable(RunTimeNow, 	RunTime)
3226. 
3227. AppendLogfile("!LogFileName!", "!Description! Os Zones started: 2021-12-14 15:29:57")
3228. SetVariable(ZoneStepDescription,"System Zones.")
3229. AppendLogfile("!LogFileName!", "!PeriodWord!")
3230. AppendLogfile("!LogFileName!", "System Disk optimized layout for boot and executables. !DateNow! !TimeNow! !RunTimeNow!")
3231. /* Dgh 20190618 */
3232. /* ------------------------- */
3233. /* Defrag the Pagefile.sys on the next boot. */
3234. # PagedFrg - Page Defrag.
3235. 
3236. /* Defrag the Pagefile.sys on the next boot. */
3237. # RunProgram("..\Pagedfrg.exe","-o")
3238. 
3239. /* ------------------------- */
3240. AppendLogfile("!LogFileName!", "Place files at the beginning of the disk: !DateNow! !TimeNow! !RunTimeNow!")
3241. 
3242. 	MakeGap(0)
3243. /* ------------------------- */
3244. # Zone Boot Fixed and Data 
3245. # Os Group Zone 1 & 2
3246. # Script: DefragZoneTypeOsBoot
3247. /* ------------------------- */
3248. # Zone 1 Boot Fixed.
3249. 	# Script: DisplayColors - Zone Dark
3250. # Processed
3251. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
3252. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
3253. 
3254. # Light Green and Yellow
3255. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
3256. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
3257. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
3258. 
3259. 	SetVariable(ZoneLabel, 			"!ZoneLabelBoot!")
3260. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBoot!")
3261. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
3262. 	SetVariable(ZoneGapSize, 			"!ZoneGapSizeBoot!")
3263. 
3264. 	SetVariable(ZoneTypeSelect,'
3265. Boot:
3266. # Script: ZoneDo ZoneTypeSelectOsBoot
3267. # Boot start.
3268. ImportListFromBootOptimize()
3269. # Boot end.
3270. 
3271. and not(
3272. 	# Script: ZoneDo ZoneTypeSelectOsDataDynamic
3273. # Os Data Dynamic start.
3274. (
3275. # Os Data Dynamic start.
3276. (
3277.   FileName("*.dat*")
3278.   or FileName("*.db*")
3279.   or FileName("*.edb*")
3280.   or FileName("*.log*")
3281.   or FileName("DataStore.edb")
3282. )
3283. # Os Data Dynamic end.
3284. 
3285.   or 
3286. # Os PageHiberDump start.
3287. (
3288.   FileName("DataStore.edb")
3289.   or FileName("DUMP*.*")
3290.   or FileName("Hiberfil.sys")
3291.   or FileName("MEMORY.DMP")
3292.   or FileName("Pagefile.sys")
3293. )
3294. # Os PageHiberDump end.
3295. 
3296. # Os Data Dynamic
3297. )
3298. # Os Data Dynamic end.
3299. 
3300. 	)
3301. ')
3302. 
3303. 	# First 1st of 7 in Group OS
3304. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
3305. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
3306. 
3307. SetVariable(ZoneStepNoCurrent, 0)
3308. 
3309. 	/* ------------------------- */
3310. # Script: ZoneDoHeader
3311. 
3312. # Script: ZoneWhenStarted
3313. RunProgram("..\Commands\WriteDateTime.bat")
3314. 
3315. # Script: ZoneDoCurrentClear
3316. 
3317. SetVariable(ZoneTypeSelectCurrent, 		"")
3318. SetVariable(ZoneStatisticsData, 		"")
3319. SetVariable(ZoneStepByLine, 			"")
3320. 
3321. SetVariable(ZoneBeginCurrent, 			0)
3322. SetVariable(ZoneBeginPerCurrent, 		0)
3323. SetVariable(ZoneEndCurrent, 			0)
3324. SetVariable(ZoneEndPerCurrent, 			0)
3325. 
3326. SetVariable(ZoneSizeCurrent,			0)
3327. SetVariable(ZoneSizePerCurrent,			0)
3328. 
3329. SetVariable(ZoneGapRequestedCurrent,	0)
3330. SetVariable(ZoneGapRoundedCurrent, 		0)
3331. SetVariable(ZoneGapAdjustedCurrent, 	0)
3332. SetVariable(ZoneGapAvailableCurrent, 	0)
3333. SetVariable(ZoneGapCurrent,				0)
3334. SetVariable(ZoneGapUsedCurrent, 		0)
3335. 
3336. SetVariable(ZoneGapActualCurrent, 		0)
3337. SetVariable(ZoneGapActualPerCurrent, 	0)
3338. 
3339. SetVariable(ZoneSizeActual, 			0)
3340. SetVariable(ZoneSizeActualCurrent,		0)
3341. 
3342. SetVariable(ZoneEndActual, 				0)
3343. SetVariable(ZoneEndActualCurrent,		0)			
3344. SetVariable(ZoneSizeActualPerCurrent, 	0)
3345.       
3346. SetVariable(ZoneFilesFolders,			0)
3347. SetVariable(ZoneFilesFoldersPer,		0) 
3348. 
3349. SetVariable(ZoneFragments,				0)
3350. SetVariable(ZoneFragmentsPer,			0) 
3351. 		
3352. SetVariable(ZoneEndActualCurrent, 		0)
3353. SetVariable(ZoneEndActualPerCurrent, 	0)
3354. 
3355. # Gap Calculation Methodology:
3356. 	# Requested
3357. 	SetVariable(GapRequested, 			0) 
3358. 	SetVariable(GapRequestedStd, 		0) 
3359. 	SetVariable(GapRequestedMft, 		0) 
3360. 	SetVariable(GapRequestedOs, 		0) 
3361. 	SetVariable(GapRequestedOriginal, 	0) 
3362. 	
3363. 	# Gap Adjustments
3364. 	SetVariable(GapRounded, 			0)
3365. 	# SetVariable(GapAdjusted, 			0)
3366. 	SetVariable(GapAvailable, 			0)
3367. 	SetVariable(GapCurrent, 			0)
3368. 	SetVariable(GapActual, 				0)
3369. 	SetVariable(GapUsed, 				0)
3370. 	
3371. 	# Gap Adjustments
3372. 	SetVariable(GapRoundedLoc, 			0)
3373. 	# SetVariable(GapAdjustedLoc, 		0)
3374. 	SetVariable(GapAvailableLoc, 		0)
3375. 	SetVariable(GapCurrentLoc, 			0)
3376. 	SetVariable(GapActualLoc,			0)
3377. 	SetVariable(GapUsedLoc,				0)
3378. 	
3379. 	# Space usage
3380. 	SetVariable(ZoneFreePerRequested, 	0)
3381. 	SetVariable(ZoneFreePerUsed, 		0)
3382. 
3383. # Gap Size & Rounding
3384. 	SetVariable(ZoneGapSizePer, 		0)
3385. 	SetVariable(ZoneVolRoundUpPer, 		0)
3386. 	
3387. 	# Free Space
3388. 	SetVariable(ZoneFreeUsedPer, 		0)
3389. 	SetVariable(ZoneFreeRequestedPer, 	0)
3390. 
3391. # Script: DisplaySetZone
3392. 
3393. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
3394. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
3395. 
3396. # Message ZoneSummary
3397. # SetVariable(ZoneSummary, '
3398. # Zone Summary:
3399. # ')
3400. # Zone processing steps
3401. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
3402. # ')
3403. 
3404. # # Script: BannerDescriptionSet
3405. 
3406. # Script: BannerSet
3407. 
3408. # NOTE: Can't round or truncate to integer precision. 
3409. # This internal fields like ZoneCount format really badly.
3410. #  for !RunTimeNow! does not work. None of the date functions do.
3411. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3412. 
3413. SetVariable(HeadingTemp2,	ZoneCount + 0)
3414. 
3415. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3416. 
3417. Title('!Heading!')
3418. 
3419. /* pause(1) */
3420. 
3421. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3422. 
3423. 
3424. # Script: BannerLog
3425. 
3426. AppendLogfile("!LogFileName!", "!Heading!")
3427. 
3428. 
3429. 
3430. # pause(1)
3431. 
3432. 
3433. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
3434. # Script: DisplaySetZoneStep
3435. # Increment
3436. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3437. 
3438. # Display this zone step
3439. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
3440. ')
3441. 
3442. # Script: BannerSet
3443. 
3444. # NOTE: Can't round or truncate to integer precision. 
3445. # This internal fields like ZoneCount format really badly.
3446. #  for !RunTimeNow! does not work. None of the date functions do.
3447. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3448. 
3449. SetVariable(HeadingTemp2,	ZoneCount + 0)
3450. 
3451. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3452. 
3453. Title('!Heading!')
3454. 
3455. /* pause(1) */
3456. 
3457. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3458. 
3459. 
3460. # Script: DisplaySetWindowText
3461. # Zone Footer Set Statistics Window Text
3462. 
3463. SetStatisticsWindowText("!Heading!
3464. ----------------------------------------------------------
3465. Zones Processed: 
3466. ----------------------------------------------------------
3467. !ZoneListByLine!
3468. ----------------------------------------------------------
3469. Zone Processing Step:
3470. !ZoneStepByLine!    
3471. ----------------------------------------------------------
3472. ----------------------------------------------------------
3473. CURRENT ZONE:
3474. !ZoneStatisticsReport!
3475. ----------------------------------------------------------
3476. ----------------------------------------------------------
3477. ----------------------------------------------------------
3478. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
3479. ----------------------------------------------------------
3480. !VolumeStatisticsSummary!
3481. !VolumeStatisticsDetail!
3482. ----------------------------------------------------------
3483. ----------------------------------------------------------
3484. Zone Detailed Report:
3485. ----------------------------------------------------------
3486. !ZoneStatisticsDetail!
3487. ----------------------------------------------------------
3488. ")
3489. 
3490. 
3491. 
3492. 
3493. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
3494. 
3495. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
3496. # Script: DisplaySetZoneStep
3497. # Increment
3498. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3499. 
3500. # Display this zone step
3501. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
3502. ')
3503. 
3504. # Script: BannerSet
3505. 
3506. # NOTE: Can't round or truncate to integer precision. 
3507. # This internal fields like ZoneCount format really badly.
3508. #  for !RunTimeNow! does not work. None of the date functions do.
3509. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3510. 
3511. SetVariable(HeadingTemp2,	ZoneCount + 0)
3512. 
3513. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3514. 
3515. Title('!Heading!')
3516. 
3517. /* pause(1) */
3518. 
3519. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3520. 
3521. 
3522. # Script: DisplaySetWindowText
3523. # Zone Footer Set Statistics Window Text
3524. 
3525. SetStatisticsWindowText("!Heading!
3526. ----------------------------------------------------------
3527. Zones Processed: 
3528. ----------------------------------------------------------
3529. !ZoneListByLine!
3530. ----------------------------------------------------------
3531. Zone Processing Step:
3532. !ZoneStepByLine!    
3533. ----------------------------------------------------------
3534. ----------------------------------------------------------
3535. CURRENT ZONE:
3536. !ZoneStatisticsReport!
3537. ----------------------------------------------------------
3538. ----------------------------------------------------------
3539. ----------------------------------------------------------
3540. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
3541. ----------------------------------------------------------
3542. !VolumeStatisticsSummary!
3543. !VolumeStatisticsDetail!
3544. ----------------------------------------------------------
3545. ----------------------------------------------------------
3546. Zone Detailed Report:
3547. ----------------------------------------------------------
3548. !ZoneStatisticsDetail!
3549. ----------------------------------------------------------
3550. ")
3551. 
3552. 
3553. 
3554. 
3555. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
3556. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
3557. 
3558. # Script: BannerSet
3559. 
3560. # NOTE: Can't round or truncate to integer precision. 
3561. # This internal fields like ZoneCount format really badly.
3562. #  for !RunTimeNow! does not work. None of the date functions do.
3563. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3564. 
3565. SetVariable(HeadingTemp2,	ZoneCount + 0)
3566. 
3567. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3568. 
3569. Title('!Heading!')
3570. 
3571. /* pause(1) */
3572. 
3573. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3574. 
3575. 
3576. # Script: BannerLog
3577. 
3578. AppendLogfile("!LogFileName!", "!Heading!")
3579. 
3580. 
3581. 
3582. # LOGGING:
3583. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
3584. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
3585. 
3586. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
3587. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:29:57")
3588. # 2021-12-14 15:29:57 
3589. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:02 !ZoneLabel! !ZoneDescription!")
3590. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
3591. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:02 !ZoneLabel! !ZoneDescription!")
3592. 
3593. 
3594. # Add zone to list of zones:
3595. SetVariable(ZoneListByLine, "!ZoneListByLine!
3596. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
3597. # Script: DisplaySetWindowText
3598. # Zone Footer Set Statistics Window Text
3599. 
3600. SetStatisticsWindowText("!Heading!
3601. ----------------------------------------------------------
3602. Zones Processed: 
3603. ----------------------------------------------------------
3604. !ZoneListByLine!
3605. ----------------------------------------------------------
3606. Zone Processing Step:
3607. !ZoneStepByLine!    
3608. ----------------------------------------------------------
3609. ----------------------------------------------------------
3610. CURRENT ZONE:
3611. !ZoneStatisticsReport!
3612. ----------------------------------------------------------
3613. ----------------------------------------------------------
3614. ----------------------------------------------------------
3615. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
3616. ----------------------------------------------------------
3617. !VolumeStatisticsSummary!
3618. !VolumeStatisticsDetail!
3619. ----------------------------------------------------------
3620. ----------------------------------------------------------
3621. Zone Detailed Report:
3622. ----------------------------------------------------------
3623. !ZoneStatisticsDetail!
3624. ----------------------------------------------------------
3625. ")
3626. 
3627. 
3628. 
3629. 
3630. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
3631. # Script: DisplaySetZoneStep
3632. # Increment
3633. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3634. 
3635. # Display this zone step
3636. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
3637. ')
3638. 
3639. # Script: BannerSet
3640. 
3641. # NOTE: Can't round or truncate to integer precision. 
3642. # This internal fields like ZoneCount format really badly.
3643. #  for !RunTimeNow! does not work. None of the date functions do.
3644. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3645. 
3646. SetVariable(HeadingTemp2,	ZoneCount + 0)
3647. 
3648. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3649. 
3650. Title('!Heading!')
3651. 
3652. /* pause(1) */
3653. 
3654. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3655. 
3656. 
3657. # Script: DisplaySetWindowText
3658. # Zone Footer Set Statistics Window Text
3659. 
3660. SetStatisticsWindowText("!Heading!
3661. ----------------------------------------------------------
3662. Zones Processed: 
3663. ----------------------------------------------------------
3664. !ZoneListByLine!
3665. ----------------------------------------------------------
3666. Zone Processing Step:
3667. !ZoneStepByLine!    
3668. ----------------------------------------------------------
3669. ----------------------------------------------------------
3670. CURRENT ZONE:
3671. !ZoneStatisticsReport!
3672. ----------------------------------------------------------
3673. ----------------------------------------------------------
3674. ----------------------------------------------------------
3675. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
3676. ----------------------------------------------------------
3677. !VolumeStatisticsSummary!
3678. !VolumeStatisticsDetail!
3679. ----------------------------------------------------------
3680. ----------------------------------------------------------
3681. Zone Detailed Report:
3682. ----------------------------------------------------------
3683. !ZoneStatisticsDetail!
3684. ----------------------------------------------------------
3685. ")
3686. 
3687. 
3688. 
3689. 
3690. # your stuff HERE (X)... pre file select code.
3691. 
3692. /* --------------------------------- */
3693. 	FileSelect
3694. 
3695. 		# your stuff can't really go here (errors.)
3696. 		# maybe for some reason I don't know of...
3697. 	
3698. 		# Actions next...
3699. 	# Script: ZoneDo ZoneTypeSelectOsBoot
3700. # Boot start.
3701. ImportListFromBootOptimize()
3702. # Boot end.
3703. 
3704. 	and not(
3705. 		# Script: ZoneDo ZoneTypeSelectOsDataDynamic
3706. # Os Data Dynamic start.
3707. (
3708. # Os Data Dynamic start.
3709. (
3710.   FileName("*.dat*")
3711.   or FileName("*.db*")
3712.   or FileName("*.edb*")
3713.   or FileName("*.log*")
3714.   or FileName("DataStore.edb")
3715. )
3716. # Os Data Dynamic end.
3717. 
3718.   or 
3719. # Os PageHiberDump start.
3720. (
3721.   FileName("DataStore.edb")
3722.   or FileName("DUMP*.*")
3723.   or FileName("Hiberfil.sys")
3724.   or FileName("MEMORY.DMP")
3725.   or FileName("Pagefile.sys")
3726. )
3727. # Os PageHiberDump end.
3728. 
3729. # Os Data Dynamic
3730. )
3731. # Os Data Dynamic end.
3732. 
3733. 	)
3734. 
3735. 	FileActions
3736. 
3737. 			# Script: GapZoneCalc
3738. 	# Gap
3739. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
3740. 		# Script: DisplaySetZoneStep
3741. # Increment
3742. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3743. 
3744. # Display this zone step
3745. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
3746. ')
3747. 
3748. # Script: BannerSet
3749. 
3750. # NOTE: Can't round or truncate to integer precision. 
3751. # This internal fields like ZoneCount format really badly.
3752. #  for !RunTimeNow! does not work. None of the date functions do.
3753. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3754. 
3755. SetVariable(HeadingTemp2,	ZoneCount + 0)
3756. 
3757. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3758. 
3759. Title('!Heading!')
3760. 
3761. /* pause(1) */
3762. 
3763. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
3764. 
3765. 
3766. # Script: DisplaySetWindowText
3767. # Zone Footer Set Statistics Window Text
3768. 
3769. SetStatisticsWindowText("!Heading!
3770. ----------------------------------------------------------
3771. Zones Processed: 
3772. ----------------------------------------------------------
3773. !ZoneListByLine!
3774. ----------------------------------------------------------
3775. Zone Processing Step:
3776. !ZoneStepByLine!    
3777. ----------------------------------------------------------
3778. ----------------------------------------------------------
3779. CURRENT ZONE:
3780. !ZoneStatisticsReport!
3781. ----------------------------------------------------------
3782. ----------------------------------------------------------
3783. ----------------------------------------------------------
3784. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
3785. ----------------------------------------------------------
3786. !VolumeStatisticsSummary!
3787. !VolumeStatisticsDetail!
3788. ----------------------------------------------------------
3789. ----------------------------------------------------------
3790. Zone Detailed Report:
3791. ----------------------------------------------------------
3792. !ZoneStatisticsDetail!
3793. ----------------------------------------------------------
3794. ")
3795. 
3796. 
3797. 
3798. 	
3799. 	# ACTUAL GAP
3800. 		/* AddGap Variant. */
3801. 	  	# Script: GapZoneSet
3802. # Zone Do Gap
3803. # Gap Calculation Methods:
3804. 
3805. /* 1) Anything you need to add first. */
3806. /* empty */
3807. 
3808. /* ------------------------- */
3809. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
3810. 	# GapRequestedStd.
3811. 
3812. 		/* ------------------------- */
3813. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
3814. 
3815. 		# Gap Calculation Methods:
3816. 
3817. /* AddGap Variants */
3818. 
3819. 	/* Standard */
3820. 		# Gap Calculation Methods:
3821. 	/* AddGap Variants */
3822. 	/* Standard */
3823. 
3824. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
3825. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
3826. 
3827. 	SetVariable(GapRequested, GapRequestedStd)
3828. 	
3829. 
3830. 	/* MFT Low High Method */
3831. 		# Gap Calculation Methods:
3832. 	/* AddGap Variants */
3833. 	/* MFT Low High Method */
3834. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
3835. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
3836. 	SetVariable(GapRequested, GapRequestedMft)
3837. 	
3838. 
3839. 	/* OS Volume Type Method */
3840. 		# Gap Calculation Methods:
3841. 	/* AddGap Variants */
3842. 	/* OS Volume Type Method */
3843. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
3844. 	SetVariable(GapRequested, GapRequestedOs)
3845. 
3846. 
3847. 
3848. /* MakeGap Variants */
3849. 
3850. 	/* Original Os 1-3 + MFT 2 */
3851. 		# Gap Calculation Methods:
3852. 	/* MakeGap Variants */
3853. 	/* Original Os 1-3 + MFT 2 */
3854. 	/* plus MFT gap placed inline at the dividing zone. */
3855. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
3856. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
3857. 	SetVariable(GapRequested, GapRequestedOrig)
3858. 	
3859. 	
3860. /* Note: You could comment out the ones not in use */
3861. /* However having the data in the log is useful. */
3862. /* Therefore the following line is otherwise needed. */
3863. 
3864. /* Standard used */
3865. 
3866. SetVariable(GapRequested, GapRequestedStd)
3867. 
3868. # Gap Calculation Methods:
3869. 
3870. /* AddGap Variants */
3871. 	/* Standard */
3872. 	/* MFT Low High Method */
3873. 	/* OS Volume Type Method */
3874. 
3875. /* MakeGap Variants */
3876. 	/* Original Os 1-3 + MFT 2 */
3877. 
3878. /* Note: You could comment out the ones not in use */
3879. /* However having the data in the log is useful. */
3880. /* Therefore the following line is otherwise needed. */
3881. 
3882. /* Standard is used currently */
3883. 
3884. 
3885. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
3886. 
3887. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
3888. 
3889. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
3890. 
3891. /* ------------------------- */
3892. /* 3) SMALL ZONE ADJUSTMENT. */
3893. /* Gab cant be larger than half the Zone Size. */
3894. 
3895. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
3896. 	
3897. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
3898. 
3899. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
3900. 
3901. /* ------------------------- */
3902. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
3903. # Gap Adjustments.
3904. 
3905. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
3906. 	
3907. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
3908. 
3909. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
3910. 
3911. /* ------------------------- */
3912. # BYPASS THIS.
3913. 	/* This is definitely wrong. */
3914. 	/* The question is can we steal gap from the next zone */
3915. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
3916. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
3917. 		# Zone Overflow.
3918. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
3919. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
3920. 
3921. /* ------------------------- */
3922. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
3923. # Remaining free space available.
3924. 
3925. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
3926. 	
3927. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
3928. 
3929. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
3930. 
3931. /* ------------------------- */
3932. # CURRENT gap to use.
3933. 
3934. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
3935. 
3936. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
3937. 
3938. /* ------------------------- */
3939. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
3940. # Debugging.
3941. 
3942. 	SetVariable(GapUsed, GapCurrent) // for debugging
3943. 
3944. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
3945. 
3946. 		# Your code HERE
3947. 
3948. /* ------------------------- */
3949. /* 7) YOUR CODE. */
3950. # YOUR CODE HERE:
3951. 	# INPUT: GapCurrent or GapCurrentLoc
3952. 	# OUTPUT: GapUsed...
3953. 
3954. /* ------------------------- */
3955. # Gap Size.
3956. # Actual Size of Gap.
3957. 
3958. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
3959. 
3960. /* ------------------------- */
3961. 
3962. 	
3963. 	# Zone Statistics	
3964. 		# Script: ZoneStatisticsGet
3965. # Zone / Volume Statistics and Display
3966. 		
3967. 	# Accumulate Totals
3968.   	# Script: ZoneDoVolumeTotals
3969. 
3970. /* Current total space used (by Zones and Gaps) */
3971. 
3972. SetVariable(VolumeZoneUsed, GapUsed)
3973. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
3974. /* Percentage */
3975. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
3976. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
3977. 
3978. /* Current total of free space requested */
3979. 
3980. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
3981. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3982. /* Percent. */
3983. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
3984. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3985. 
3986. /* Current total of free space used */
3987. 
3988. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
3989. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
3990. /* Percent */
3991. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
3992. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
3993. 
3994. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
3995. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
3996. # Xinclude "..\DebugDisplayPause.MyDc"X
3997. 
3998. 
3999. 	# Current Values
4000. 	# Script: ZoneDoCurrentSet
4001. 
4002. # Cluster, Sector, Block adjust for display.
4003. 	# Bytes per cluster is volume specific.
4004. 
4005. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
4006. 
4007. # Current Zone values.
4008. 	# Begin, end and size.
4009. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
4010. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
4011. 
4012. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
4013. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
4014. 
4015. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
4016. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
4017. 
4018. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
4019. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
4020. 
4021. 	SetVariable(ZoneFragments,				"!ZONE210N!")
4022. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
4023. 		
4024. # Current Gap, Actual and Free Values
4025. 	# Gap
4026. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
4027. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
4028. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
4029. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
4030. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
4031. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
4032. 	
4033. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
4034. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
4035. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
4036. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
4037. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
4038. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
4039. 	
4040. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
4041. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
4042. 	
4043. 	# Actual Size and End
4044. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
4045. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
4046. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
4047. 	
4048. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
4049. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
4050. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
4051. 
4052. # Gap Size & Rounding
4053. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
4054. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
4055. 	
4056. 	# Free Space
4057. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
4058. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
4059. 
4060. 	# Script: ZoneStatisticsReportGet
4061. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
4062. 
4063. # Footer:
4064. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
4065. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
4066. #
4067. # Xinclude "..\Commands\DateTimeLastLong.txt"X
4068. #
4069. # What a mess this word based vs is. Try a phrase based version ToDo
4070. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
4071. ------------------
4072.    !SizeWord!!ColonWord!  
4073.    ------------------------
4074.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4075.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4076.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4077. 
4078.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4079.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
4080. 
4081.    !LocationWord!!ColonWord!
4082.    ------------------------
4083.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4084.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
4085.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4086.       
4087.    !GapWordCaps! !SettingsWord!!ColonWord!
4088.    ------------------------
4089.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
4090.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
4091.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4092.                  
4093.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
4094.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
4095.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
4096.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
4097.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
4098.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
4099.      
4100.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
4101.    ------------------------
4102.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4103.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4104.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4105. 
4106. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
4107. ----------------------------------------------------------
4108. ")
4109. #
4110. SetVariable(DateNow, 	DATETIME)
4111. SetVariable(TimeNow, 	Time)
4112. SetVariable(RunTimeNow, 	RunTime)
4113. 
4114. 
4115. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
4116. 
4117. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
4118. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
4119. 
4120. 	# Script: DisplaySetWindowText
4121. # Zone Footer Set Statistics Window Text
4122. 
4123. SetStatisticsWindowText("!Heading!
4124. ----------------------------------------------------------
4125. Zones Processed: 
4126. ----------------------------------------------------------
4127. !ZoneListByLine!
4128. ----------------------------------------------------------
4129. Zone Processing Step:
4130. !ZoneStepByLine!    
4131. ----------------------------------------------------------
4132. ----------------------------------------------------------
4133. CURRENT ZONE:
4134. !ZoneStatisticsReport!
4135. ----------------------------------------------------------
4136. ----------------------------------------------------------
4137. ----------------------------------------------------------
4138. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
4139. ----------------------------------------------------------
4140. !VolumeStatisticsSummary!
4141. !VolumeStatisticsDetail!
4142. ----------------------------------------------------------
4143. ----------------------------------------------------------
4144. Zone Detailed Report:
4145. ----------------------------------------------------------
4146. !ZoneStatisticsDetail!
4147. ----------------------------------------------------------
4148. ")
4149. 
4150. 
4151. 	
4152. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
4153. 
4154. 
4155. 	SetVariable(ZoneStatisticsData, 
4156. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
4157.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
4158.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
4159. 
4160. 
4161. 
4162.  		# Script: ZoneStatisticsDisplay
4163. 	
4164. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
4165. !ZoneStatisticsData!
4166. ')
4167. 
4168. 		# Script: ZoneStatisticsAdd
4169. # Append Zone to Details of each zone.
4170. 		
4171. 	# Add Zone Details to Report.	
4172. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
4173. !ZoneStatisticsReport!
4174. ')
4175. 
4176. 	
4177. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
4178. 		# Script: DisplaySetZoneStep
4179. # Increment
4180. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4181. 
4182. # Display this zone step
4183. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
4184. ')
4185. 
4186. # Script: BannerSet
4187. 
4188. # NOTE: Can't round or truncate to integer precision. 
4189. # This internal fields like ZoneCount format really badly.
4190. #  for !RunTimeNow! does not work. None of the date functions do.
4191. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4192. 
4193. SetVariable(HeadingTemp2,	ZoneCount + 0)
4194. 
4195. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4196. 
4197. Title('!Heading!')
4198. 
4199. /* pause(1) */
4200. 
4201. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4202. 
4203. 
4204. # Script: DisplaySetWindowText
4205. # Zone Footer Set Statistics Window Text
4206. 
4207. SetStatisticsWindowText("!Heading!
4208. ----------------------------------------------------------
4209. Zones Processed: 
4210. ----------------------------------------------------------
4211. !ZoneListByLine!
4212. ----------------------------------------------------------
4213. Zone Processing Step:
4214. !ZoneStepByLine!    
4215. ----------------------------------------------------------
4216. ----------------------------------------------------------
4217. CURRENT ZONE:
4218. !ZoneStatisticsReport!
4219. ----------------------------------------------------------
4220. ----------------------------------------------------------
4221. ----------------------------------------------------------
4222. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
4223. ----------------------------------------------------------
4224. !VolumeStatisticsSummary!
4225. !VolumeStatisticsDetail!
4226. ----------------------------------------------------------
4227. ----------------------------------------------------------
4228. Zone Detailed Report:
4229. ----------------------------------------------------------
4230. !ZoneStatisticsDetail!
4231. ----------------------------------------------------------
4232. ")
4233. 
4234. 
4235. 
4236. 
4237. 		# File Action - Os Boot - Regular -  SortByName.
4238. # File Action - SortByImportSequence.
4239. SortByImportSequence(Ascending ) 
4240. 	
4241. 	
4242. 
4243. 		SetVariable(ZoneStepDescription, 	"!ZoneStepDescriptionFileActionEnd!")
4244. 		# Script: DisplaySetZoneStep
4245. # Increment
4246. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4247. 
4248. # Display this zone step
4249. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
4250. ')
4251. 
4252. # Script: BannerSet
4253. 
4254. # NOTE: Can't round or truncate to integer precision. 
4255. # This internal fields like ZoneCount format really badly.
4256. #  for !RunTimeNow! does not work. None of the date functions do.
4257. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4258. 
4259. SetVariable(HeadingTemp2,	ZoneCount + 0)
4260. 
4261. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4262. 
4263. Title('!Heading!')
4264. 
4265. /* pause(1) */
4266. 
4267. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4268. 
4269. 
4270. # Script: DisplaySetWindowText
4271. # Zone Footer Set Statistics Window Text
4272. 
4273. SetStatisticsWindowText("!Heading!
4274. ----------------------------------------------------------
4275. Zones Processed: 
4276. ----------------------------------------------------------
4277. !ZoneListByLine!
4278. ----------------------------------------------------------
4279. Zone Processing Step:
4280. !ZoneStepByLine!    
4281. ----------------------------------------------------------
4282. ----------------------------------------------------------
4283. CURRENT ZONE:
4284. !ZoneStatisticsReport!
4285. ----------------------------------------------------------
4286. ----------------------------------------------------------
4287. ----------------------------------------------------------
4288. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
4289. ----------------------------------------------------------
4290. !VolumeStatisticsSummary!
4291. !VolumeStatisticsDetail!
4292. ----------------------------------------------------------
4293. ----------------------------------------------------------
4294. Zone Detailed Report:
4295. ----------------------------------------------------------
4296. !ZoneStatisticsDetail!
4297. ----------------------------------------------------------
4298. ")
4299. 
4300. 
4301. 
4302. 
4303. 	# Script: ZoneDoFooter
4304. 
4305. /* --------------------------------- */
4306. 	# File Select
4307. 		# Select Statments
4308. 	# File Actions 
4309. 		# Standard or OS File Actions.
4310. 		# Resume...
4311. 	
4312. 		# your stuff HERE (X)... post zone (file) file actions code.
4313. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
4314. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
4315. 			# (X)
4316. 		
4317. 			/* ??? Set window? */
4318. 	
4319. 		# ADD THE GAP
4320. 		# Script: GapZoneCommand
4321. # Vacate (good for diagnostics)
4322. # DoNotVacate - DO NOT Vacate (recommended)
4323. 
4324. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
4325. # Script: DisplaySetZoneStep
4326. # Increment
4327. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4328. 
4329. # Display this zone step
4330. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
4331. ')
4332. 
4333. # Script: BannerSet
4334. 
4335. # NOTE: Can't round or truncate to integer precision. 
4336. # This internal fields like ZoneCount format really badly.
4337. #  for !RunTimeNow! does not work. None of the date functions do.
4338. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4339. 
4340. SetVariable(HeadingTemp2,	ZoneCount + 0)
4341. 
4342. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4343. 
4344. Title('!Heading!')
4345. 
4346. /* pause(1) */
4347. 
4348. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4349. 
4350. 
4351. # Script: DisplaySetWindowText
4352. # Zone Footer Set Statistics Window Text
4353. 
4354. SetStatisticsWindowText("!Heading!
4355. ----------------------------------------------------------
4356. Zones Processed: 
4357. ----------------------------------------------------------
4358. !ZoneListByLine!
4359. ----------------------------------------------------------
4360. Zone Processing Step:
4361. !ZoneStepByLine!    
4362. ----------------------------------------------------------
4363. ----------------------------------------------------------
4364. CURRENT ZONE:
4365. !ZoneStatisticsReport!
4366. ----------------------------------------------------------
4367. ----------------------------------------------------------
4368. ----------------------------------------------------------
4369. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
4370. ----------------------------------------------------------
4371. !VolumeStatisticsSummary!
4372. !VolumeStatisticsDetail!
4373. ----------------------------------------------------------
4374. ----------------------------------------------------------
4375. Zone Detailed Report:
4376. ----------------------------------------------------------
4377. !ZoneStatisticsDetail!
4378. ----------------------------------------------------------
4379. ")
4380. 
4381. 
4382. 
4383. 
4384. # *** Moved to setting yours *** 
4385. # (to avoid doing it twice)
4386. # (ie the later wouldn't "overwrite" the former in the usual manner)
4387. 
4388. # Do one or the other:
4389. # DoNotVacate - DO NOT Vacate (recommended)
4390. 
4391. # Vacate
4392. /* AddGap(GapUsedLoc) */
4393. 
4394. # DO Not Vacate
4395. AddGap(GapUsedLoc, DoNotVacate) 
4396. 	
4397. 	
4398. 
4399. # Controlled via settings commands
4400. 
4401. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
4402. 
4403. # Vacate /* AddGap(GapUsed) */
4404. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
4405. 	
4406. 
4407. 		
4408. 	# 
4409. 	FileEnd
4410. /* --------------------------------- */
4411. # your stuff HERE (X)... post zone (file) code.
4412. 
4413. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
4414. # Script: DisplaySetZoneStep
4415. # Increment
4416. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4417. 
4418. # Display this zone step
4419. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
4420. ')
4421. 
4422. # Script: BannerSet
4423. 
4424. # NOTE: Can't round or truncate to integer precision. 
4425. # This internal fields like ZoneCount format really badly.
4426. #  for !RunTimeNow! does not work. None of the date functions do.
4427. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4428. 
4429. SetVariable(HeadingTemp2,	ZoneCount + 0)
4430. 
4431. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4432. 
4433. Title('!Heading!')
4434. 
4435. /* pause(1) */
4436. 
4437. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4438. 
4439. 
4440. # Script: DisplaySetWindowText
4441. # Zone Footer Set Statistics Window Text
4442. 
4443. SetStatisticsWindowText("!Heading!
4444. ----------------------------------------------------------
4445. Zones Processed: 
4446. ----------------------------------------------------------
4447. !ZoneListByLine!
4448. ----------------------------------------------------------
4449. Zone Processing Step:
4450. !ZoneStepByLine!    
4451. ----------------------------------------------------------
4452. ----------------------------------------------------------
4453. CURRENT ZONE:
4454. !ZoneStatisticsReport!
4455. ----------------------------------------------------------
4456. ----------------------------------------------------------
4457. ----------------------------------------------------------
4458. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
4459. ----------------------------------------------------------
4460. !VolumeStatisticsSummary!
4461. !VolumeStatisticsDetail!
4462. ----------------------------------------------------------
4463. ----------------------------------------------------------
4464. Zone Detailed Report:
4465. ----------------------------------------------------------
4466. !ZoneStatisticsDetail!
4467. ----------------------------------------------------------
4468. ")
4469. 
4470. 
4471. 
4472. 
4473. # Script: ZoneWhenFinished
4474. 
4475. # Add the zone to the zone details log:
4476. # This is temporarily disable until logging is fixed
4477. # It is performed during file action to preserve the correct (original) calculations.
4478. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
4479. 
4480. # Add the Select and ZoneSteps to the Zone
4481. # Script: ZoneStatisticsAdd
4482. # Append Zone to Details of each zone.
4483. 		
4484. 	# Add Zone Details to Report.	
4485. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
4486. ----------------------------------------------------------
4487. !ZoneStepByLine!
4488. ---------------------------
4489. !ZoneTypeSelectCurrent!               
4490. ---------------------------
4491. ----------------------------------------------------------
4492. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
4493. ----------------------------------------------------------
4494. ')
4495. 
4496. 
4497. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
4498. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
4499. # 2021-12-14 15:29:58
4500. RunProgram("..\Commands\WriteDateTime.bat LastZone")
4501. # Append Datetime to logs
4502. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
4503. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
4504. 
4505. AppendLogfile("!LogFileName!", "!PeriodWord!")
4506. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
4507. AppendLogfile("!LogFileName!", "!PeriodWord!")
4508. 
4509. # Script: DisplaySetWindowText
4510. # Zone Footer Set Statistics Window Text
4511. 
4512. SetStatisticsWindowText("!Heading!
4513. ----------------------------------------------------------
4514. Zones Processed: 
4515. ----------------------------------------------------------
4516. !ZoneListByLine!
4517. ----------------------------------------------------------
4518. Zone Processing Step:
4519. !ZoneStepByLine!    
4520. ----------------------------------------------------------
4521. ----------------------------------------------------------
4522. CURRENT ZONE:
4523. !ZoneStatisticsReport!
4524. ----------------------------------------------------------
4525. ----------------------------------------------------------
4526. ----------------------------------------------------------
4527. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
4528. ----------------------------------------------------------
4529. !VolumeStatisticsSummary!
4530. !VolumeStatisticsDetail!
4531. ----------------------------------------------------------
4532. ----------------------------------------------------------
4533. Zone Detailed Report:
4534. ----------------------------------------------------------
4535. !ZoneStatisticsDetail!
4536. ----------------------------------------------------------
4537. ")
4538. 
4539. 
4540. 
4541. /* pause() */
4542. /* pause() */
4543. 
4544. 
4545. 
4546. /* ------------------------- */
4547. 
4548. 
4549. /* ------------------------- */
4550. # Zone 2 Boot Data (Variable and other).
4551. 	# Script: DisplayColors - Zone Dark
4552. # Processed
4553. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
4554. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
4555. 
4556. # Light Green and Yellow
4557. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
4558. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
4559. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
4560. 
4561. 	SetVariable(ZoneLabel, 			"!ZoneLabelBootData!")
4562. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBootData!")
4563. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBootData!")
4564. 	SetVariable(ZoneGapSize, 			"!ZoneGapSizeBootData!")
4565. 
4566. 	SetVariable(ZoneTypeSelect,'
4567. Boot Data:
4568. # Script: ZoneDo ZoneTypeSelectOsBoot
4569. # Boot start.
4570. ImportListFromBootOptimize()
4571. # Boot end.
4572. 
4573. not(
4574.     # Os PageHiberDump start.
4575. (
4576.   FileName("DataStore.edb")
4577.   or FileName("DUMP*.*")
4578.   or FileName("Hiberfil.sys")
4579.   or FileName("MEMORY.DMP")
4580.   or FileName("Pagefile.sys")
4581. )
4582. # Os PageHiberDump end.
4583. 
4584. )
4585. ')
4586. 
4587. 	SetVariable(ZoneNoCurrentAdjust, ZoneNoCurrentAdjust + 1)
4588. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
4589. 
4590. SetVariable(ZoneStepNoCurrent, 0)
4591. 
4592. 	/* ------------------------- */
4593. # Script: ZoneDoHeader
4594. 
4595. # Script: ZoneWhenStarted
4596. RunProgram("..\Commands\WriteDateTime.bat")
4597. 
4598. # Script: ZoneDoCurrentClear
4599. 
4600. SetVariable(ZoneTypeSelectCurrent, 		"")
4601. SetVariable(ZoneStatisticsData, 		"")
4602. SetVariable(ZoneStepByLine, 			"")
4603. 
4604. SetVariable(ZoneBeginCurrent, 			0)
4605. SetVariable(ZoneBeginPerCurrent, 		0)
4606. SetVariable(ZoneEndCurrent, 			0)
4607. SetVariable(ZoneEndPerCurrent, 			0)
4608. 
4609. SetVariable(ZoneSizeCurrent,			0)
4610. SetVariable(ZoneSizePerCurrent,			0)
4611. 
4612. SetVariable(ZoneGapRequestedCurrent,	0)
4613. SetVariable(ZoneGapRoundedCurrent, 		0)
4614. SetVariable(ZoneGapAdjustedCurrent, 	0)
4615. SetVariable(ZoneGapAvailableCurrent, 	0)
4616. SetVariable(ZoneGapCurrent,				0)
4617. SetVariable(ZoneGapUsedCurrent, 		0)
4618. 
4619. SetVariable(ZoneGapActualCurrent, 		0)
4620. SetVariable(ZoneGapActualPerCurrent, 	0)
4621. 
4622. SetVariable(ZoneSizeActual, 			0)
4623. SetVariable(ZoneSizeActualCurrent,		0)
4624. 
4625. SetVariable(ZoneEndActual, 				0)
4626. SetVariable(ZoneEndActualCurrent,		0)			
4627. SetVariable(ZoneSizeActualPerCurrent, 	0)
4628.       
4629. SetVariable(ZoneFilesFolders,			0)
4630. SetVariable(ZoneFilesFoldersPer,		0) 
4631. 
4632. SetVariable(ZoneFragments,				0)
4633. SetVariable(ZoneFragmentsPer,			0) 
4634. 		
4635. SetVariable(ZoneEndActualCurrent, 		0)
4636. SetVariable(ZoneEndActualPerCurrent, 	0)
4637. 
4638. # Gap Calculation Methodology:
4639. 	# Requested
4640. 	SetVariable(GapRequested, 			0) 
4641. 	SetVariable(GapRequestedStd, 		0) 
4642. 	SetVariable(GapRequestedMft, 		0) 
4643. 	SetVariable(GapRequestedOs, 		0) 
4644. 	SetVariable(GapRequestedOriginal, 	0) 
4645. 	
4646. 	# Gap Adjustments
4647. 	SetVariable(GapRounded, 			0)
4648. 	# SetVariable(GapAdjusted, 			0)
4649. 	SetVariable(GapAvailable, 			0)
4650. 	SetVariable(GapCurrent, 			0)
4651. 	SetVariable(GapActual, 				0)
4652. 	SetVariable(GapUsed, 				0)
4653. 	
4654. 	# Gap Adjustments
4655. 	SetVariable(GapRoundedLoc, 			0)
4656. 	# SetVariable(GapAdjustedLoc, 		0)
4657. 	SetVariable(GapAvailableLoc, 		0)
4658. 	SetVariable(GapCurrentLoc, 			0)
4659. 	SetVariable(GapActualLoc,			0)
4660. 	SetVariable(GapUsedLoc,				0)
4661. 	
4662. 	# Space usage
4663. 	SetVariable(ZoneFreePerRequested, 	0)
4664. 	SetVariable(ZoneFreePerUsed, 		0)
4665. 
4666. # Gap Size & Rounding
4667. 	SetVariable(ZoneGapSizePer, 		0)
4668. 	SetVariable(ZoneVolRoundUpPer, 		0)
4669. 	
4670. 	# Free Space
4671. 	SetVariable(ZoneFreeUsedPer, 		0)
4672. 	SetVariable(ZoneFreeRequestedPer, 	0)
4673. 
4674. # Script: DisplaySetZone
4675. 
4676. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
4677. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
4678. 
4679. # Message ZoneSummary
4680. # SetVariable(ZoneSummary, '
4681. # Zone Summary:
4682. # ')
4683. # Zone processing steps
4684. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
4685. # ')
4686. 
4687. # # Script: BannerDescriptionSet
4688. 
4689. # Script: BannerSet
4690. 
4691. # NOTE: Can't round or truncate to integer precision. 
4692. # This internal fields like ZoneCount format really badly.
4693. #  for !RunTimeNow! does not work. None of the date functions do.
4694. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4695. 
4696. SetVariable(HeadingTemp2,	ZoneCount + 0)
4697. 
4698. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4699. 
4700. Title('!Heading!')
4701. 
4702. /* pause(1) */
4703. 
4704. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4705. 
4706. 
4707. # Script: BannerLog
4708. 
4709. AppendLogfile("!LogFileName!", "!Heading!")
4710. 
4711. 
4712. 
4713. # pause(1)
4714. 
4715. 
4716. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
4717. # Script: DisplaySetZoneStep
4718. # Increment
4719. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4720. 
4721. # Display this zone step
4722. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
4723. ')
4724. 
4725. # Script: BannerSet
4726. 
4727. # NOTE: Can't round or truncate to integer precision. 
4728. # This internal fields like ZoneCount format really badly.
4729. #  for !RunTimeNow! does not work. None of the date functions do.
4730. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4731. 
4732. SetVariable(HeadingTemp2,	ZoneCount + 0)
4733. 
4734. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4735. 
4736. Title('!Heading!')
4737. 
4738. /* pause(1) */
4739. 
4740. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4741. 
4742. 
4743. # Script: DisplaySetWindowText
4744. # Zone Footer Set Statistics Window Text
4745. 
4746. SetStatisticsWindowText("!Heading!
4747. ----------------------------------------------------------
4748. Zones Processed: 
4749. ----------------------------------------------------------
4750. !ZoneListByLine!
4751. ----------------------------------------------------------
4752. Zone Processing Step:
4753. !ZoneStepByLine!    
4754. ----------------------------------------------------------
4755. ----------------------------------------------------------
4756. CURRENT ZONE:
4757. !ZoneStatisticsReport!
4758. ----------------------------------------------------------
4759. ----------------------------------------------------------
4760. ----------------------------------------------------------
4761. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
4762. ----------------------------------------------------------
4763. !VolumeStatisticsSummary!
4764. !VolumeStatisticsDetail!
4765. ----------------------------------------------------------
4766. ----------------------------------------------------------
4767. Zone Detailed Report:
4768. ----------------------------------------------------------
4769. !ZoneStatisticsDetail!
4770. ----------------------------------------------------------
4771. ")
4772. 
4773. 
4774. 
4775. 
4776. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
4777. 
4778. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
4779. # Script: DisplaySetZoneStep
4780. # Increment
4781. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4782. 
4783. # Display this zone step
4784. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
4785. ')
4786. 
4787. # Script: BannerSet
4788. 
4789. # NOTE: Can't round or truncate to integer precision. 
4790. # This internal fields like ZoneCount format really badly.
4791. #  for !RunTimeNow! does not work. None of the date functions do.
4792. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4793. 
4794. SetVariable(HeadingTemp2,	ZoneCount + 0)
4795. 
4796. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4797. 
4798. Title('!Heading!')
4799. 
4800. /* pause(1) */
4801. 
4802. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4803. 
4804. 
4805. # Script: DisplaySetWindowText
4806. # Zone Footer Set Statistics Window Text
4807. 
4808. SetStatisticsWindowText("!Heading!
4809. ----------------------------------------------------------
4810. Zones Processed: 
4811. ----------------------------------------------------------
4812. !ZoneListByLine!
4813. ----------------------------------------------------------
4814. Zone Processing Step:
4815. !ZoneStepByLine!    
4816. ----------------------------------------------------------
4817. ----------------------------------------------------------
4818. CURRENT ZONE:
4819. !ZoneStatisticsReport!
4820. ----------------------------------------------------------
4821. ----------------------------------------------------------
4822. ----------------------------------------------------------
4823. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
4824. ----------------------------------------------------------
4825. !VolumeStatisticsSummary!
4826. !VolumeStatisticsDetail!
4827. ----------------------------------------------------------
4828. ----------------------------------------------------------
4829. Zone Detailed Report:
4830. ----------------------------------------------------------
4831. !ZoneStatisticsDetail!
4832. ----------------------------------------------------------
4833. ")
4834. 
4835. 
4836. 
4837. 
4838. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
4839. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
4840. 
4841. # Script: BannerSet
4842. 
4843. # NOTE: Can't round or truncate to integer precision. 
4844. # This internal fields like ZoneCount format really badly.
4845. #  for !RunTimeNow! does not work. None of the date functions do.
4846. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4847. 
4848. SetVariable(HeadingTemp2,	ZoneCount + 0)
4849. 
4850. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4851. 
4852. Title('!Heading!')
4853. 
4854. /* pause(1) */
4855. 
4856. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4857. 
4858. 
4859. # Script: BannerLog
4860. 
4861. AppendLogfile("!LogFileName!", "!Heading!")
4862. 
4863. 
4864. 
4865. # LOGGING:
4866. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
4867. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
4868. 
4869. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
4870. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:29:58")
4871. # 2021-12-14 15:29:58 
4872. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:03 !ZoneLabel! !ZoneDescription!")
4873. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
4874. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:03 !ZoneLabel! !ZoneDescription!")
4875. 
4876. 
4877. # Add zone to list of zones:
4878. SetVariable(ZoneListByLine, "!ZoneListByLine!
4879. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
4880. # Script: DisplaySetWindowText
4881. # Zone Footer Set Statistics Window Text
4882. 
4883. SetStatisticsWindowText("!Heading!
4884. ----------------------------------------------------------
4885. Zones Processed: 
4886. ----------------------------------------------------------
4887. !ZoneListByLine!
4888. ----------------------------------------------------------
4889. Zone Processing Step:
4890. !ZoneStepByLine!    
4891. ----------------------------------------------------------
4892. ----------------------------------------------------------
4893. CURRENT ZONE:
4894. !ZoneStatisticsReport!
4895. ----------------------------------------------------------
4896. ----------------------------------------------------------
4897. ----------------------------------------------------------
4898. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
4899. ----------------------------------------------------------
4900. !VolumeStatisticsSummary!
4901. !VolumeStatisticsDetail!
4902. ----------------------------------------------------------
4903. ----------------------------------------------------------
4904. Zone Detailed Report:
4905. ----------------------------------------------------------
4906. !ZoneStatisticsDetail!
4907. ----------------------------------------------------------
4908. ")
4909. 
4910. 
4911. 
4912. 
4913. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
4914. # Script: DisplaySetZoneStep
4915. # Increment
4916. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4917. 
4918. # Display this zone step
4919. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
4920. ')
4921. 
4922. # Script: BannerSet
4923. 
4924. # NOTE: Can't round or truncate to integer precision. 
4925. # This internal fields like ZoneCount format really badly.
4926. #  for !RunTimeNow! does not work. None of the date functions do.
4927. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4928. 
4929. SetVariable(HeadingTemp2,	ZoneCount + 0)
4930. 
4931. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4932. 
4933. Title('!Heading!')
4934. 
4935. /* pause(1) */
4936. 
4937. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
4938. 
4939. 
4940. # Script: DisplaySetWindowText
4941. # Zone Footer Set Statistics Window Text
4942. 
4943. SetStatisticsWindowText("!Heading!
4944. ----------------------------------------------------------
4945. Zones Processed: 
4946. ----------------------------------------------------------
4947. !ZoneListByLine!
4948. ----------------------------------------------------------
4949. Zone Processing Step:
4950. !ZoneStepByLine!    
4951. ----------------------------------------------------------
4952. ----------------------------------------------------------
4953. CURRENT ZONE:
4954. !ZoneStatisticsReport!
4955. ----------------------------------------------------------
4956. ----------------------------------------------------------
4957. ----------------------------------------------------------
4958. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
4959. ----------------------------------------------------------
4960. !VolumeStatisticsSummary!
4961. !VolumeStatisticsDetail!
4962. ----------------------------------------------------------
4963. ----------------------------------------------------------
4964. Zone Detailed Report:
4965. ----------------------------------------------------------
4966. !ZoneStatisticsDetail!
4967. ----------------------------------------------------------
4968. ")
4969. 
4970. 
4971. 
4972. 
4973. # your stuff HERE (X)... pre file select code.
4974. 
4975. /* --------------------------------- */
4976. 	FileSelect
4977. 
4978. 		# your stuff can't really go here (errors.)
4979. 		# maybe for some reason I don't know of...
4980. 	
4981. 		# Actions next...
4982. 	# Script: ZoneDo ZoneTypeSelectOsBoot
4983. # Boot start.
4984. ImportListFromBootOptimize()
4985. # Boot end.
4986. 
4987. 	and not(
4988. 		# Os PageHiberDump start.
4989. (
4990.   FileName("DataStore.edb")
4991.   or FileName("DUMP*.*")
4992.   or FileName("Hiberfil.sys")
4993.   or FileName("MEMORY.DMP")
4994.   or FileName("Pagefile.sys")
4995. )
4996. # Os PageHiberDump end.
4997. 
4998. 	)
4999. 
5000. 	FileActions
5001. 
5002. 			# Script: GapZoneCalc
5003. 	# Gap
5004. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
5005. 		# Script: DisplaySetZoneStep
5006. # Increment
5007. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5008. 
5009. # Display this zone step
5010. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
5011. ')
5012. 
5013. # Script: BannerSet
5014. 
5015. # NOTE: Can't round or truncate to integer precision. 
5016. # This internal fields like ZoneCount format really badly.
5017. #  for !RunTimeNow! does not work. None of the date functions do.
5018. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5019. 
5020. SetVariable(HeadingTemp2,	ZoneCount + 0)
5021. 
5022. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5023. 
5024. Title('!Heading!')
5025. 
5026. /* pause(1) */
5027. 
5028. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5029. 
5030. 
5031. # Script: DisplaySetWindowText
5032. # Zone Footer Set Statistics Window Text
5033. 
5034. SetStatisticsWindowText("!Heading!
5035. ----------------------------------------------------------
5036. Zones Processed: 
5037. ----------------------------------------------------------
5038. !ZoneListByLine!
5039. ----------------------------------------------------------
5040. Zone Processing Step:
5041. !ZoneStepByLine!    
5042. ----------------------------------------------------------
5043. ----------------------------------------------------------
5044. CURRENT ZONE:
5045. !ZoneStatisticsReport!
5046. ----------------------------------------------------------
5047. ----------------------------------------------------------
5048. ----------------------------------------------------------
5049. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
5050. ----------------------------------------------------------
5051. !VolumeStatisticsSummary!
5052. !VolumeStatisticsDetail!
5053. ----------------------------------------------------------
5054. ----------------------------------------------------------
5055. Zone Detailed Report:
5056. ----------------------------------------------------------
5057. !ZoneStatisticsDetail!
5058. ----------------------------------------------------------
5059. ")
5060. 
5061. 
5062. 
5063. 	
5064. 	# ACTUAL GAP
5065. 		/* AddGap Variant. */
5066. 	  	# Script: GapZoneSet
5067. # Zone Do Gap
5068. # Gap Calculation Methods:
5069. 
5070. /* 1) Anything you need to add first. */
5071. /* empty */
5072. 
5073. /* ------------------------- */
5074. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
5075. 	# GapRequestedStd.
5076. 
5077. 		/* ------------------------- */
5078. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
5079. 
5080. 		# Gap Calculation Methods:
5081. 
5082. /* AddGap Variants */
5083. 
5084. 	/* Standard */
5085. 		# Gap Calculation Methods:
5086. 	/* AddGap Variants */
5087. 	/* Standard */
5088. 
5089. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
5090. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
5091. 
5092. 	SetVariable(GapRequested, GapRequestedStd)
5093. 	
5094. 
5095. 	/* MFT Low High Method */
5096. 		# Gap Calculation Methods:
5097. 	/* AddGap Variants */
5098. 	/* MFT Low High Method */
5099. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
5100. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
5101. 	SetVariable(GapRequested, GapRequestedMft)
5102. 	
5103. 
5104. 	/* OS Volume Type Method */
5105. 		# Gap Calculation Methods:
5106. 	/* AddGap Variants */
5107. 	/* OS Volume Type Method */
5108. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
5109. 	SetVariable(GapRequested, GapRequestedOs)
5110. 
5111. 
5112. 
5113. /* MakeGap Variants */
5114. 
5115. 	/* Original Os 1-3 + MFT 2 */
5116. 		# Gap Calculation Methods:
5117. 	/* MakeGap Variants */
5118. 	/* Original Os 1-3 + MFT 2 */
5119. 	/* plus MFT gap placed inline at the dividing zone. */
5120. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
5121. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
5122. 	SetVariable(GapRequested, GapRequestedOrig)
5123. 	
5124. 	
5125. /* Note: You could comment out the ones not in use */
5126. /* However having the data in the log is useful. */
5127. /* Therefore the following line is otherwise needed. */
5128. 
5129. /* Standard used */
5130. 
5131. SetVariable(GapRequested, GapRequestedStd)
5132. 
5133. # Gap Calculation Methods:
5134. 
5135. /* AddGap Variants */
5136. 	/* Standard */
5137. 	/* MFT Low High Method */
5138. 	/* OS Volume Type Method */
5139. 
5140. /* MakeGap Variants */
5141. 	/* Original Os 1-3 + MFT 2 */
5142. 
5143. /* Note: You could comment out the ones not in use */
5144. /* However having the data in the log is useful. */
5145. /* Therefore the following line is otherwise needed. */
5146. 
5147. /* Standard is used currently */
5148. 
5149. 
5150. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
5151. 
5152. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
5153. 
5154. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
5155. 
5156. /* ------------------------- */
5157. /* 3) SMALL ZONE ADJUSTMENT. */
5158. /* Gab cant be larger than half the Zone Size. */
5159. 
5160. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
5161. 	
5162. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
5163. 
5164. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
5165. 
5166. /* ------------------------- */
5167. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
5168. # Gap Adjustments.
5169. 
5170. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
5171. 	
5172. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
5173. 
5174. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
5175. 
5176. /* ------------------------- */
5177. # BYPASS THIS.
5178. 	/* This is definitely wrong. */
5179. 	/* The question is can we steal gap from the next zone */
5180. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
5181. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
5182. 		# Zone Overflow.
5183. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
5184. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
5185. 
5186. /* ------------------------- */
5187. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
5188. # Remaining free space available.
5189. 
5190. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
5191. 	
5192. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
5193. 
5194. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
5195. 
5196. /* ------------------------- */
5197. # CURRENT gap to use.
5198. 
5199. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
5200. 
5201. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
5202. 
5203. /* ------------------------- */
5204. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
5205. # Debugging.
5206. 
5207. 	SetVariable(GapUsed, GapCurrent) // for debugging
5208. 
5209. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
5210. 
5211. 		# Your code HERE
5212. 
5213. /* ------------------------- */
5214. /* 7) YOUR CODE. */
5215. # YOUR CODE HERE:
5216. 	# INPUT: GapCurrent or GapCurrentLoc
5217. 	# OUTPUT: GapUsed...
5218. 
5219. /* ------------------------- */
5220. # Gap Size.
5221. # Actual Size of Gap.
5222. 
5223. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
5224. 
5225. /* ------------------------- */
5226. 
5227. 	
5228. 	# Zone Statistics	
5229. 		# Script: ZoneStatisticsGet
5230. # Zone / Volume Statistics and Display
5231. 		
5232. 	# Accumulate Totals
5233.   	# Script: ZoneDoVolumeTotals
5234. 
5235. /* Current total space used (by Zones and Gaps) */
5236. 
5237. SetVariable(VolumeZoneUsed, GapUsed)
5238. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
5239. /* Percentage */
5240. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
5241. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
5242. 
5243. /* Current total of free space requested */
5244. 
5245. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
5246. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5247. /* Percent. */
5248. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
5249. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5250. 
5251. /* Current total of free space used */
5252. 
5253. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
5254. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
5255. /* Percent */
5256. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
5257. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
5258. 
5259. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
5260. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
5261. # Xinclude "..\DebugDisplayPause.MyDc"X
5262. 
5263. 
5264. 	# Current Values
5265. 	# Script: ZoneDoCurrentSet
5266. 
5267. # Cluster, Sector, Block adjust for display.
5268. 	# Bytes per cluster is volume specific.
5269. 
5270. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
5271. 
5272. # Current Zone values.
5273. 	# Begin, end and size.
5274. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
5275. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
5276. 
5277. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
5278. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
5279. 
5280. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
5281. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
5282. 
5283. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
5284. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
5285. 
5286. 	SetVariable(ZoneFragments,				"!ZONE210N!")
5287. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
5288. 		
5289. # Current Gap, Actual and Free Values
5290. 	# Gap
5291. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
5292. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
5293. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
5294. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
5295. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
5296. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
5297. 	
5298. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
5299. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
5300. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
5301. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
5302. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
5303. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
5304. 	
5305. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
5306. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
5307. 	
5308. 	# Actual Size and End
5309. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
5310. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
5311. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
5312. 	
5313. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
5314. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
5315. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
5316. 
5317. # Gap Size & Rounding
5318. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
5319. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
5320. 	
5321. 	# Free Space
5322. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
5323. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
5324. 
5325. 	# Script: ZoneStatisticsReportGet
5326. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
5327. 
5328. # Footer:
5329. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
5330. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
5331. #
5332. # Xinclude "..\Commands\DateTimeLastLong.txt"X
5333. #
5334. # What a mess this word based vs is. Try a phrase based version ToDo
5335. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
5336. ------------------
5337.    !SizeWord!!ColonWord!  
5338.    ------------------------
5339.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5340.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5341.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5342. 
5343.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5344.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
5345. 
5346.    !LocationWord!!ColonWord!
5347.    ------------------------
5348.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5349.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
5350.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5351.       
5352.    !GapWordCaps! !SettingsWord!!ColonWord!
5353.    ------------------------
5354.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
5355.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
5356.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5357.                  
5358.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
5359.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
5360.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
5361.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
5362.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
5363.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
5364.      
5365.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
5366.    ------------------------
5367.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5368.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5369.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5370. 
5371. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
5372. ----------------------------------------------------------
5373. ")
5374. #
5375. SetVariable(DateNow, 	DATETIME)
5376. SetVariable(TimeNow, 	Time)
5377. SetVariable(RunTimeNow, 	RunTime)
5378. 
5379. 
5380. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
5381. 
5382. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
5383. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
5384. 
5385. 	# Script: DisplaySetWindowText
5386. # Zone Footer Set Statistics Window Text
5387. 
5388. SetStatisticsWindowText("!Heading!
5389. ----------------------------------------------------------
5390. Zones Processed: 
5391. ----------------------------------------------------------
5392. !ZoneListByLine!
5393. ----------------------------------------------------------
5394. Zone Processing Step:
5395. !ZoneStepByLine!    
5396. ----------------------------------------------------------
5397. ----------------------------------------------------------
5398. CURRENT ZONE:
5399. !ZoneStatisticsReport!
5400. ----------------------------------------------------------
5401. ----------------------------------------------------------
5402. ----------------------------------------------------------
5403. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
5404. ----------------------------------------------------------
5405. !VolumeStatisticsSummary!
5406. !VolumeStatisticsDetail!
5407. ----------------------------------------------------------
5408. ----------------------------------------------------------
5409. Zone Detailed Report:
5410. ----------------------------------------------------------
5411. !ZoneStatisticsDetail!
5412. ----------------------------------------------------------
5413. ")
5414. 
5415. 
5416. 	
5417. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
5418. 
5419. 
5420. 	SetVariable(ZoneStatisticsData, 
5421. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
5422.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
5423.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
5424. 
5425. 
5426. 
5427.  		# Script: ZoneStatisticsDisplay
5428. 	
5429. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
5430. !ZoneStatisticsData!
5431. ')
5432. 
5433. 		# Script: ZoneStatisticsAdd
5434. # Append Zone to Details of each zone.
5435. 		
5436. 	# Add Zone Details to Report.	
5437. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
5438. !ZoneStatisticsReport!
5439. ')
5440. 
5441. 	
5442. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
5443. 		# Script: DisplaySetZoneStep
5444. # Increment
5445. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5446. 
5447. # Display this zone step
5448. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
5449. ')
5450. 
5451. # Script: BannerSet
5452. 
5453. # NOTE: Can't round or truncate to integer precision. 
5454. # This internal fields like ZoneCount format really badly.
5455. #  for !RunTimeNow! does not work. None of the date functions do.
5456. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5457. 
5458. SetVariable(HeadingTemp2,	ZoneCount + 0)
5459. 
5460. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5461. 
5462. Title('!Heading!')
5463. 
5464. /* pause(1) */
5465. 
5466. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5467. 
5468. 
5469. # Script: DisplaySetWindowText
5470. # Zone Footer Set Statistics Window Text
5471. 
5472. SetStatisticsWindowText("!Heading!
5473. ----------------------------------------------------------
5474. Zones Processed: 
5475. ----------------------------------------------------------
5476. !ZoneListByLine!
5477. ----------------------------------------------------------
5478. Zone Processing Step:
5479. !ZoneStepByLine!    
5480. ----------------------------------------------------------
5481. ----------------------------------------------------------
5482. CURRENT ZONE:
5483. !ZoneStatisticsReport!
5484. ----------------------------------------------------------
5485. ----------------------------------------------------------
5486. ----------------------------------------------------------
5487. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
5488. ----------------------------------------------------------
5489. !VolumeStatisticsSummary!
5490. !VolumeStatisticsDetail!
5491. ----------------------------------------------------------
5492. ----------------------------------------------------------
5493. Zone Detailed Report:
5494. ----------------------------------------------------------
5495. !ZoneStatisticsDetail!
5496. ----------------------------------------------------------
5497. ")
5498. 
5499. 
5500. 
5501. 
5502. 		# File Action - Os Boot - Regular -  SortByName.
5503. # File Action - ZoneDoActionSortByCreationDateFull
5504. 	SortByCreationDate(Ascending)
5505. 	
5506. 	
5507. 	
5508. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
5509. 		# Script: DisplaySetZoneStep
5510. # Increment
5511. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5512. 
5513. # Display this zone step
5514. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
5515. ')
5516. 
5517. # Script: BannerSet
5518. 
5519. # NOTE: Can't round or truncate to integer precision. 
5520. # This internal fields like ZoneCount format really badly.
5521. #  for !RunTimeNow! does not work. None of the date functions do.
5522. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5523. 
5524. SetVariable(HeadingTemp2,	ZoneCount + 0)
5525. 
5526. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5527. 
5528. Title('!Heading!')
5529. 
5530. /* pause(1) */
5531. 
5532. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5533. 
5534. 
5535. # Script: DisplaySetWindowText
5536. # Zone Footer Set Statistics Window Text
5537. 
5538. SetStatisticsWindowText("!Heading!
5539. ----------------------------------------------------------
5540. Zones Processed: 
5541. ----------------------------------------------------------
5542. !ZoneListByLine!
5543. ----------------------------------------------------------
5544. Zone Processing Step:
5545. !ZoneStepByLine!    
5546. ----------------------------------------------------------
5547. ----------------------------------------------------------
5548. CURRENT ZONE:
5549. !ZoneStatisticsReport!
5550. ----------------------------------------------------------
5551. ----------------------------------------------------------
5552. ----------------------------------------------------------
5553. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
5554. ----------------------------------------------------------
5555. !VolumeStatisticsSummary!
5556. !VolumeStatisticsDetail!
5557. ----------------------------------------------------------
5558. ----------------------------------------------------------
5559. Zone Detailed Report:
5560. ----------------------------------------------------------
5561. !ZoneStatisticsDetail!
5562. ----------------------------------------------------------
5563. ")
5564. 
5565. 
5566. 
5567. 
5568. 		# Script: ZoneDoFooter
5569. 
5570. /* --------------------------------- */
5571. 	# File Select
5572. 		# Select Statments
5573. 	# File Actions 
5574. 		# Standard or OS File Actions.
5575. 		# Resume...
5576. 	
5577. 		# your stuff HERE (X)... post zone (file) file actions code.
5578. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
5579. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
5580. 			# (X)
5581. 		
5582. 			/* ??? Set window? */
5583. 	
5584. 		# ADD THE GAP
5585. 		# Script: GapZoneCommand
5586. # Vacate (good for diagnostics)
5587. # DoNotVacate - DO NOT Vacate (recommended)
5588. 
5589. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
5590. # Script: DisplaySetZoneStep
5591. # Increment
5592. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5593. 
5594. # Display this zone step
5595. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
5596. ')
5597. 
5598. # Script: BannerSet
5599. 
5600. # NOTE: Can't round or truncate to integer precision. 
5601. # This internal fields like ZoneCount format really badly.
5602. #  for !RunTimeNow! does not work. None of the date functions do.
5603. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5604. 
5605. SetVariable(HeadingTemp2,	ZoneCount + 0)
5606. 
5607. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5608. 
5609. Title('!Heading!')
5610. 
5611. /* pause(1) */
5612. 
5613. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5614. 
5615. 
5616. # Script: DisplaySetWindowText
5617. # Zone Footer Set Statistics Window Text
5618. 
5619. SetStatisticsWindowText("!Heading!
5620. ----------------------------------------------------------
5621. Zones Processed: 
5622. ----------------------------------------------------------
5623. !ZoneListByLine!
5624. ----------------------------------------------------------
5625. Zone Processing Step:
5626. !ZoneStepByLine!    
5627. ----------------------------------------------------------
5628. ----------------------------------------------------------
5629. CURRENT ZONE:
5630. !ZoneStatisticsReport!
5631. ----------------------------------------------------------
5632. ----------------------------------------------------------
5633. ----------------------------------------------------------
5634. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
5635. ----------------------------------------------------------
5636. !VolumeStatisticsSummary!
5637. !VolumeStatisticsDetail!
5638. ----------------------------------------------------------
5639. ----------------------------------------------------------
5640. Zone Detailed Report:
5641. ----------------------------------------------------------
5642. !ZoneStatisticsDetail!
5643. ----------------------------------------------------------
5644. ")
5645. 
5646. 
5647. 
5648. 
5649. # *** Moved to setting yours *** 
5650. # (to avoid doing it twice)
5651. # (ie the later wouldn't "overwrite" the former in the usual manner)
5652. 
5653. # Do one or the other:
5654. # DoNotVacate - DO NOT Vacate (recommended)
5655. 
5656. # Vacate
5657. /* AddGap(GapUsedLoc) */
5658. 
5659. # DO Not Vacate
5660. AddGap(GapUsedLoc, DoNotVacate) 
5661. 	
5662. 	
5663. 
5664. # Controlled via settings commands
5665. 
5666. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
5667. 
5668. # Vacate /* AddGap(GapUsed) */
5669. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
5670. 	
5671. 
5672. 		
5673. 	# 
5674. 	FileEnd
5675. /* --------------------------------- */
5676. # your stuff HERE (X)... post zone (file) code.
5677. 
5678. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
5679. # Script: DisplaySetZoneStep
5680. # Increment
5681. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5682. 
5683. # Display this zone step
5684. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
5685. ')
5686. 
5687. # Script: BannerSet
5688. 
5689. # NOTE: Can't round or truncate to integer precision. 
5690. # This internal fields like ZoneCount format really badly.
5691. #  for !RunTimeNow! does not work. None of the date functions do.
5692. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5693. 
5694. SetVariable(HeadingTemp2,	ZoneCount + 0)
5695. 
5696. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5697. 
5698. Title('!Heading!')
5699. 
5700. /* pause(1) */
5701. 
5702. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5703. 
5704. 
5705. # Script: DisplaySetWindowText
5706. # Zone Footer Set Statistics Window Text
5707. 
5708. SetStatisticsWindowText("!Heading!
5709. ----------------------------------------------------------
5710. Zones Processed: 
5711. ----------------------------------------------------------
5712. !ZoneListByLine!
5713. ----------------------------------------------------------
5714. Zone Processing Step:
5715. !ZoneStepByLine!    
5716. ----------------------------------------------------------
5717. ----------------------------------------------------------
5718. CURRENT ZONE:
5719. !ZoneStatisticsReport!
5720. ----------------------------------------------------------
5721. ----------------------------------------------------------
5722. ----------------------------------------------------------
5723. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
5724. ----------------------------------------------------------
5725. !VolumeStatisticsSummary!
5726. !VolumeStatisticsDetail!
5727. ----------------------------------------------------------
5728. ----------------------------------------------------------
5729. Zone Detailed Report:
5730. ----------------------------------------------------------
5731. !ZoneStatisticsDetail!
5732. ----------------------------------------------------------
5733. ")
5734. 
5735. 
5736. 
5737. 
5738. # Script: ZoneWhenFinished
5739. 
5740. # Add the zone to the zone details log:
5741. # This is temporarily disable until logging is fixed
5742. # It is performed during file action to preserve the correct (original) calculations.
5743. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
5744. 
5745. # Add the Select and ZoneSteps to the Zone
5746. # Script: ZoneStatisticsAdd
5747. # Append Zone to Details of each zone.
5748. 		
5749. 	# Add Zone Details to Report.	
5750. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
5751. ----------------------------------------------------------
5752. !ZoneStepByLine!
5753. ---------------------------
5754. !ZoneTypeSelectCurrent!               
5755. ---------------------------
5756. ----------------------------------------------------------
5757. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
5758. ----------------------------------------------------------
5759. ')
5760. 
5761. 
5762. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
5763. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
5764. # 2021-12-14 15:29:58
5765. RunProgram("..\Commands\WriteDateTime.bat LastZone")
5766. # Append Datetime to logs
5767. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
5768. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
5769. 
5770. AppendLogfile("!LogFileName!", "!PeriodWord!")
5771. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
5772. AppendLogfile("!LogFileName!", "!PeriodWord!")
5773. 
5774. # Script: DisplaySetWindowText
5775. # Zone Footer Set Statistics Window Text
5776. 
5777. SetStatisticsWindowText("!Heading!
5778. ----------------------------------------------------------
5779. Zones Processed: 
5780. ----------------------------------------------------------
5781. !ZoneListByLine!
5782. ----------------------------------------------------------
5783. Zone Processing Step:
5784. !ZoneStepByLine!    
5785. ----------------------------------------------------------
5786. ----------------------------------------------------------
5787. CURRENT ZONE:
5788. !ZoneStatisticsReport!
5789. ----------------------------------------------------------
5790. ----------------------------------------------------------
5791. ----------------------------------------------------------
5792. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
5793. ----------------------------------------------------------
5794. !VolumeStatisticsSummary!
5795. !VolumeStatisticsDetail!
5796. ----------------------------------------------------------
5797. ----------------------------------------------------------
5798. Zone Detailed Report:
5799. ----------------------------------------------------------
5800. !ZoneStatisticsDetail!
5801. ----------------------------------------------------------
5802. ")
5803. 
5804. 
5805. 
5806. /* pause() */
5807. /* pause() */
5808. 
5809. 
5810. 
5811. /* ------------------------- */
5812. 
5813. 
5814. /* ------------------------- */
5815. 
5816. 
5817. /* ------------------------- */
5818. # Zone ProgramHints Fixed and Data
5819. # Os Group Zone 3 & 4
5820. # Script: DefragZoneTypeOsProgramHints
5821. /* ------------------------- */
5822. # Zone 1 of 2 ProgramHints Fixed.
5823. 	# Script: DisplayColors - Zone Dark
5824. # Processed
5825. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
5826. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
5827. 
5828. # Light Green and Yellow
5829. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
5830. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
5831. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
5832. 
5833. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHints!")
5834. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHints!")
5835. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
5836. 	SetVariable(ZoneGapSize, 			"!ZoneGapSizeProgramHints!")
5837. 
5838. 	SetVariable(ZoneTypeSelect,		'
5839. Program Hints:
5840. # Script: ZoneDo ZoneTypeSelectOsProgramHints
5841. # ProgramHints start.
5842. ImportListFromProgramHints("*.pf")
5843. # ProgramHints end.
5844. 
5845. and not(
5846. 	# Script: ZoneDo ZoneTypeSelectOsDataDynamic
5847. # Os Data Dynamic start.
5848. (
5849. # Os Data Dynamic start.
5850. (
5851.   FileName("*.dat*")
5852.   or FileName("*.db*")
5853.   or FileName("*.edb*")
5854.   or FileName("*.log*")
5855.   or FileName("DataStore.edb")
5856. )
5857. # Os Data Dynamic end.
5858. 
5859.   or 
5860. # Os PageHiberDump start.
5861. (
5862.   FileName("DataStore.edb")
5863.   or FileName("DUMP*.*")
5864.   or FileName("Hiberfil.sys")
5865.   or FileName("MEMORY.DMP")
5866.   or FileName("Pagefile.sys")
5867. )
5868. # Os PageHiberDump end.
5869. 
5870. # Os Data Dynamic
5871. )
5872. # Os Data Dynamic end.
5873. 
5874. 	)
5875. ')
5876. 
5877. 	SetVariable(ZoneNoCurrentAdjust, ZoneNoCurrentAdjust + 1)
5878. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
5879. 
5880. SetVariable(ZoneStepNoCurrent, 0)
5881. 
5882. 	/* ------------------------- */
5883. # Script: ZoneDoHeader
5884. 
5885. # Script: ZoneWhenStarted
5886. RunProgram("..\Commands\WriteDateTime.bat")
5887. 
5888. # Script: ZoneDoCurrentClear
5889. 
5890. SetVariable(ZoneTypeSelectCurrent, 		"")
5891. SetVariable(ZoneStatisticsData, 		"")
5892. SetVariable(ZoneStepByLine, 			"")
5893. 
5894. SetVariable(ZoneBeginCurrent, 			0)
5895. SetVariable(ZoneBeginPerCurrent, 		0)
5896. SetVariable(ZoneEndCurrent, 			0)
5897. SetVariable(ZoneEndPerCurrent, 			0)
5898. 
5899. SetVariable(ZoneSizeCurrent,			0)
5900. SetVariable(ZoneSizePerCurrent,			0)
5901. 
5902. SetVariable(ZoneGapRequestedCurrent,	0)
5903. SetVariable(ZoneGapRoundedCurrent, 		0)
5904. SetVariable(ZoneGapAdjustedCurrent, 	0)
5905. SetVariable(ZoneGapAvailableCurrent, 	0)
5906. SetVariable(ZoneGapCurrent,				0)
5907. SetVariable(ZoneGapUsedCurrent, 		0)
5908. 
5909. SetVariable(ZoneGapActualCurrent, 		0)
5910. SetVariable(ZoneGapActualPerCurrent, 	0)
5911. 
5912. SetVariable(ZoneSizeActual, 			0)
5913. SetVariable(ZoneSizeActualCurrent,		0)
5914. 
5915. SetVariable(ZoneEndActual, 				0)
5916. SetVariable(ZoneEndActualCurrent,		0)			
5917. SetVariable(ZoneSizeActualPerCurrent, 	0)
5918.       
5919. SetVariable(ZoneFilesFolders,			0)
5920. SetVariable(ZoneFilesFoldersPer,		0) 
5921. 
5922. SetVariable(ZoneFragments,				0)
5923. SetVariable(ZoneFragmentsPer,			0) 
5924. 		
5925. SetVariable(ZoneEndActualCurrent, 		0)
5926. SetVariable(ZoneEndActualPerCurrent, 	0)
5927. 
5928. # Gap Calculation Methodology:
5929. 	# Requested
5930. 	SetVariable(GapRequested, 			0) 
5931. 	SetVariable(GapRequestedStd, 		0) 
5932. 	SetVariable(GapRequestedMft, 		0) 
5933. 	SetVariable(GapRequestedOs, 		0) 
5934. 	SetVariable(GapRequestedOriginal, 	0) 
5935. 	
5936. 	# Gap Adjustments
5937. 	SetVariable(GapRounded, 			0)
5938. 	# SetVariable(GapAdjusted, 			0)
5939. 	SetVariable(GapAvailable, 			0)
5940. 	SetVariable(GapCurrent, 			0)
5941. 	SetVariable(GapActual, 				0)
5942. 	SetVariable(GapUsed, 				0)
5943. 	
5944. 	# Gap Adjustments
5945. 	SetVariable(GapRoundedLoc, 			0)
5946. 	# SetVariable(GapAdjustedLoc, 		0)
5947. 	SetVariable(GapAvailableLoc, 		0)
5948. 	SetVariable(GapCurrentLoc, 			0)
5949. 	SetVariable(GapActualLoc,			0)
5950. 	SetVariable(GapUsedLoc,				0)
5951. 	
5952. 	# Space usage
5953. 	SetVariable(ZoneFreePerRequested, 	0)
5954. 	SetVariable(ZoneFreePerUsed, 		0)
5955. 
5956. # Gap Size & Rounding
5957. 	SetVariable(ZoneGapSizePer, 		0)
5958. 	SetVariable(ZoneVolRoundUpPer, 		0)
5959. 	
5960. 	# Free Space
5961. 	SetVariable(ZoneFreeUsedPer, 		0)
5962. 	SetVariable(ZoneFreeRequestedPer, 	0)
5963. 
5964. # Script: DisplaySetZone
5965. 
5966. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
5967. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
5968. 
5969. # Message ZoneSummary
5970. # SetVariable(ZoneSummary, '
5971. # Zone Summary:
5972. # ')
5973. # Zone processing steps
5974. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
5975. # ')
5976. 
5977. # # Script: BannerDescriptionSet
5978. 
5979. # Script: BannerSet
5980. 
5981. # NOTE: Can't round or truncate to integer precision. 
5982. # This internal fields like ZoneCount format really badly.
5983. #  for !RunTimeNow! does not work. None of the date functions do.
5984. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5985. 
5986. SetVariable(HeadingTemp2,	ZoneCount + 0)
5987. 
5988. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5989. 
5990. Title('!Heading!')
5991. 
5992. /* pause(1) */
5993. 
5994. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
5995. 
5996. 
5997. # Script: BannerLog
5998. 
5999. AppendLogfile("!LogFileName!", "!Heading!")
6000. 
6001. 
6002. 
6003. # pause(1)
6004. 
6005. 
6006. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
6007. # Script: DisplaySetZoneStep
6008. # Increment
6009. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6010. 
6011. # Display this zone step
6012. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
6013. ')
6014. 
6015. # Script: BannerSet
6016. 
6017. # NOTE: Can't round or truncate to integer precision. 
6018. # This internal fields like ZoneCount format really badly.
6019. #  for !RunTimeNow! does not work. None of the date functions do.
6020. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6021. 
6022. SetVariable(HeadingTemp2,	ZoneCount + 0)
6023. 
6024. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6025. 
6026. Title('!Heading!')
6027. 
6028. /* pause(1) */
6029. 
6030. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6031. 
6032. 
6033. # Script: DisplaySetWindowText
6034. # Zone Footer Set Statistics Window Text
6035. 
6036. SetStatisticsWindowText("!Heading!
6037. ----------------------------------------------------------
6038. Zones Processed: 
6039. ----------------------------------------------------------
6040. !ZoneListByLine!
6041. ----------------------------------------------------------
6042. Zone Processing Step:
6043. !ZoneStepByLine!    
6044. ----------------------------------------------------------
6045. ----------------------------------------------------------
6046. CURRENT ZONE:
6047. !ZoneStatisticsReport!
6048. ----------------------------------------------------------
6049. ----------------------------------------------------------
6050. ----------------------------------------------------------
6051. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
6052. ----------------------------------------------------------
6053. !VolumeStatisticsSummary!
6054. !VolumeStatisticsDetail!
6055. ----------------------------------------------------------
6056. ----------------------------------------------------------
6057. Zone Detailed Report:
6058. ----------------------------------------------------------
6059. !ZoneStatisticsDetail!
6060. ----------------------------------------------------------
6061. ")
6062. 
6063. 
6064. 
6065. 
6066. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
6067. 
6068. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
6069. # Script: DisplaySetZoneStep
6070. # Increment
6071. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6072. 
6073. # Display this zone step
6074. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
6075. ')
6076. 
6077. # Script: BannerSet
6078. 
6079. # NOTE: Can't round or truncate to integer precision. 
6080. # This internal fields like ZoneCount format really badly.
6081. #  for !RunTimeNow! does not work. None of the date functions do.
6082. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6083. 
6084. SetVariable(HeadingTemp2,	ZoneCount + 0)
6085. 
6086. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6087. 
6088. Title('!Heading!')
6089. 
6090. /* pause(1) */
6091. 
6092. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6093. 
6094. 
6095. # Script: DisplaySetWindowText
6096. # Zone Footer Set Statistics Window Text
6097. 
6098. SetStatisticsWindowText("!Heading!
6099. ----------------------------------------------------------
6100. Zones Processed: 
6101. ----------------------------------------------------------
6102. !ZoneListByLine!
6103. ----------------------------------------------------------
6104. Zone Processing Step:
6105. !ZoneStepByLine!    
6106. ----------------------------------------------------------
6107. ----------------------------------------------------------
6108. CURRENT ZONE:
6109. !ZoneStatisticsReport!
6110. ----------------------------------------------------------
6111. ----------------------------------------------------------
6112. ----------------------------------------------------------
6113. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
6114. ----------------------------------------------------------
6115. !VolumeStatisticsSummary!
6116. !VolumeStatisticsDetail!
6117. ----------------------------------------------------------
6118. ----------------------------------------------------------
6119. Zone Detailed Report:
6120. ----------------------------------------------------------
6121. !ZoneStatisticsDetail!
6122. ----------------------------------------------------------
6123. ")
6124. 
6125. 
6126. 
6127. 
6128. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
6129. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
6130. 
6131. # Script: BannerSet
6132. 
6133. # NOTE: Can't round or truncate to integer precision. 
6134. # This internal fields like ZoneCount format really badly.
6135. #  for !RunTimeNow! does not work. None of the date functions do.
6136. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6137. 
6138. SetVariable(HeadingTemp2,	ZoneCount + 0)
6139. 
6140. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6141. 
6142. Title('!Heading!')
6143. 
6144. /* pause(1) */
6145. 
6146. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6147. 
6148. 
6149. # Script: BannerLog
6150. 
6151. AppendLogfile("!LogFileName!", "!Heading!")
6152. 
6153. 
6154. 
6155. # LOGGING:
6156. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
6157. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
6158. 
6159. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
6160. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:29:58")
6161. # 2021-12-14 15:29:58 
6162. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:03 !ZoneLabel! !ZoneDescription!")
6163. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
6164. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:03 !ZoneLabel! !ZoneDescription!")
6165. 
6166. 
6167. # Add zone to list of zones:
6168. SetVariable(ZoneListByLine, "!ZoneListByLine!
6169. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
6170. # Script: DisplaySetWindowText
6171. # Zone Footer Set Statistics Window Text
6172. 
6173. SetStatisticsWindowText("!Heading!
6174. ----------------------------------------------------------
6175. Zones Processed: 
6176. ----------------------------------------------------------
6177. !ZoneListByLine!
6178. ----------------------------------------------------------
6179. Zone Processing Step:
6180. !ZoneStepByLine!    
6181. ----------------------------------------------------------
6182. ----------------------------------------------------------
6183. CURRENT ZONE:
6184. !ZoneStatisticsReport!
6185. ----------------------------------------------------------
6186. ----------------------------------------------------------
6187. ----------------------------------------------------------
6188. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
6189. ----------------------------------------------------------
6190. !VolumeStatisticsSummary!
6191. !VolumeStatisticsDetail!
6192. ----------------------------------------------------------
6193. ----------------------------------------------------------
6194. Zone Detailed Report:
6195. ----------------------------------------------------------
6196. !ZoneStatisticsDetail!
6197. ----------------------------------------------------------
6198. ")
6199. 
6200. 
6201. 
6202. 
6203. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
6204. # Script: DisplaySetZoneStep
6205. # Increment
6206. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6207. 
6208. # Display this zone step
6209. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
6210. ')
6211. 
6212. # Script: BannerSet
6213. 
6214. # NOTE: Can't round or truncate to integer precision. 
6215. # This internal fields like ZoneCount format really badly.
6216. #  for !RunTimeNow! does not work. None of the date functions do.
6217. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6218. 
6219. SetVariable(HeadingTemp2,	ZoneCount + 0)
6220. 
6221. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6222. 
6223. Title('!Heading!')
6224. 
6225. /* pause(1) */
6226. 
6227. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6228. 
6229. 
6230. # Script: DisplaySetWindowText
6231. # Zone Footer Set Statistics Window Text
6232. 
6233. SetStatisticsWindowText("!Heading!
6234. ----------------------------------------------------------
6235. Zones Processed: 
6236. ----------------------------------------------------------
6237. !ZoneListByLine!
6238. ----------------------------------------------------------
6239. Zone Processing Step:
6240. !ZoneStepByLine!    
6241. ----------------------------------------------------------
6242. ----------------------------------------------------------
6243. CURRENT ZONE:
6244. !ZoneStatisticsReport!
6245. ----------------------------------------------------------
6246. ----------------------------------------------------------
6247. ----------------------------------------------------------
6248. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
6249. ----------------------------------------------------------
6250. !VolumeStatisticsSummary!
6251. !VolumeStatisticsDetail!
6252. ----------------------------------------------------------
6253. ----------------------------------------------------------
6254. Zone Detailed Report:
6255. ----------------------------------------------------------
6256. !ZoneStatisticsDetail!
6257. ----------------------------------------------------------
6258. ")
6259. 
6260. 
6261. 
6262. 
6263. # your stuff HERE (X)... pre file select code.
6264. 
6265. /* --------------------------------- */
6266. 	FileSelect
6267. 
6268. 		# your stuff can't really go here (errors.)
6269. 		# maybe for some reason I don't know of...
6270. 	
6271. 		# Actions next...
6272. 	# Script: ZoneDo ZoneTypeSelectOsProgramHints
6273. # ProgramHints start.
6274. ImportListFromProgramHints("*.pf")
6275. # ProgramHints end.
6276. 
6277. 	and not(
6278. 		# Script: ZoneDo ZoneTypeSelectOsDataDynamic
6279. # Os Data Dynamic start.
6280. (
6281. # Os Data Dynamic start.
6282. (
6283.   FileName("*.dat*")
6284.   or FileName("*.db*")
6285.   or FileName("*.edb*")
6286.   or FileName("*.log*")
6287.   or FileName("DataStore.edb")
6288. )
6289. # Os Data Dynamic end.
6290. 
6291.   or 
6292. # Os PageHiberDump start.
6293. (
6294.   FileName("DataStore.edb")
6295.   or FileName("DUMP*.*")
6296.   or FileName("Hiberfil.sys")
6297.   or FileName("MEMORY.DMP")
6298.   or FileName("Pagefile.sys")
6299. )
6300. # Os PageHiberDump end.
6301. 
6302. # Os Data Dynamic
6303. )
6304. # Os Data Dynamic end.
6305. 
6306. 	)
6307. 
6308. 	FileActions
6309. 
6310. 			# Script: GapZoneCalc
6311. 	# Gap
6312. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
6313. 		# Script: DisplaySetZoneStep
6314. # Increment
6315. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6316. 
6317. # Display this zone step
6318. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
6319. ')
6320. 
6321. # Script: BannerSet
6322. 
6323. # NOTE: Can't round or truncate to integer precision. 
6324. # This internal fields like ZoneCount format really badly.
6325. #  for !RunTimeNow! does not work. None of the date functions do.
6326. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6327. 
6328. SetVariable(HeadingTemp2,	ZoneCount + 0)
6329. 
6330. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6331. 
6332. Title('!Heading!')
6333. 
6334. /* pause(1) */
6335. 
6336. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6337. 
6338. 
6339. # Script: DisplaySetWindowText
6340. # Zone Footer Set Statistics Window Text
6341. 
6342. SetStatisticsWindowText("!Heading!
6343. ----------------------------------------------------------
6344. Zones Processed: 
6345. ----------------------------------------------------------
6346. !ZoneListByLine!
6347. ----------------------------------------------------------
6348. Zone Processing Step:
6349. !ZoneStepByLine!    
6350. ----------------------------------------------------------
6351. ----------------------------------------------------------
6352. CURRENT ZONE:
6353. !ZoneStatisticsReport!
6354. ----------------------------------------------------------
6355. ----------------------------------------------------------
6356. ----------------------------------------------------------
6357. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
6358. ----------------------------------------------------------
6359. !VolumeStatisticsSummary!
6360. !VolumeStatisticsDetail!
6361. ----------------------------------------------------------
6362. ----------------------------------------------------------
6363. Zone Detailed Report:
6364. ----------------------------------------------------------
6365. !ZoneStatisticsDetail!
6366. ----------------------------------------------------------
6367. ")
6368. 
6369. 
6370. 
6371. 	
6372. 	# ACTUAL GAP
6373. 		/* AddGap Variant. */
6374. 	  	# Script: GapZoneSet
6375. # Zone Do Gap
6376. # Gap Calculation Methods:
6377. 
6378. /* 1) Anything you need to add first. */
6379. /* empty */
6380. 
6381. /* ------------------------- */
6382. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
6383. 	# GapRequestedStd.
6384. 
6385. 		/* ------------------------- */
6386. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
6387. 
6388. 		# Gap Calculation Methods:
6389. 
6390. /* AddGap Variants */
6391. 
6392. 	/* Standard */
6393. 		# Gap Calculation Methods:
6394. 	/* AddGap Variants */
6395. 	/* Standard */
6396. 
6397. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
6398. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
6399. 
6400. 	SetVariable(GapRequested, GapRequestedStd)
6401. 	
6402. 
6403. 	/* MFT Low High Method */
6404. 		# Gap Calculation Methods:
6405. 	/* AddGap Variants */
6406. 	/* MFT Low High Method */
6407. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
6408. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
6409. 	SetVariable(GapRequested, GapRequestedMft)
6410. 	
6411. 
6412. 	/* OS Volume Type Method */
6413. 		# Gap Calculation Methods:
6414. 	/* AddGap Variants */
6415. 	/* OS Volume Type Method */
6416. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
6417. 	SetVariable(GapRequested, GapRequestedOs)
6418. 
6419. 
6420. 
6421. /* MakeGap Variants */
6422. 
6423. 	/* Original Os 1-3 + MFT 2 */
6424. 		# Gap Calculation Methods:
6425. 	/* MakeGap Variants */
6426. 	/* Original Os 1-3 + MFT 2 */
6427. 	/* plus MFT gap placed inline at the dividing zone. */
6428. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
6429. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
6430. 	SetVariable(GapRequested, GapRequestedOrig)
6431. 	
6432. 	
6433. /* Note: You could comment out the ones not in use */
6434. /* However having the data in the log is useful. */
6435. /* Therefore the following line is otherwise needed. */
6436. 
6437. /* Standard used */
6438. 
6439. SetVariable(GapRequested, GapRequestedStd)
6440. 
6441. # Gap Calculation Methods:
6442. 
6443. /* AddGap Variants */
6444. 	/* Standard */
6445. 	/* MFT Low High Method */
6446. 	/* OS Volume Type Method */
6447. 
6448. /* MakeGap Variants */
6449. 	/* Original Os 1-3 + MFT 2 */
6450. 
6451. /* Note: You could comment out the ones not in use */
6452. /* However having the data in the log is useful. */
6453. /* Therefore the following line is otherwise needed. */
6454. 
6455. /* Standard is used currently */
6456. 
6457. 
6458. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
6459. 
6460. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
6461. 
6462. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
6463. 
6464. /* ------------------------- */
6465. /* 3) SMALL ZONE ADJUSTMENT. */
6466. /* Gab cant be larger than half the Zone Size. */
6467. 
6468. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
6469. 	
6470. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
6471. 
6472. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
6473. 
6474. /* ------------------------- */
6475. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
6476. # Gap Adjustments.
6477. 
6478. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
6479. 	
6480. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
6481. 
6482. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
6483. 
6484. /* ------------------------- */
6485. # BYPASS THIS.
6486. 	/* This is definitely wrong. */
6487. 	/* The question is can we steal gap from the next zone */
6488. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
6489. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
6490. 		# Zone Overflow.
6491. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
6492. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
6493. 
6494. /* ------------------------- */
6495. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
6496. # Remaining free space available.
6497. 
6498. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
6499. 	
6500. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
6501. 
6502. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
6503. 
6504. /* ------------------------- */
6505. # CURRENT gap to use.
6506. 
6507. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
6508. 
6509. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
6510. 
6511. /* ------------------------- */
6512. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
6513. # Debugging.
6514. 
6515. 	SetVariable(GapUsed, GapCurrent) // for debugging
6516. 
6517. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
6518. 
6519. 		# Your code HERE
6520. 
6521. /* ------------------------- */
6522. /* 7) YOUR CODE. */
6523. # YOUR CODE HERE:
6524. 	# INPUT: GapCurrent or GapCurrentLoc
6525. 	# OUTPUT: GapUsed...
6526. 
6527. /* ------------------------- */
6528. # Gap Size.
6529. # Actual Size of Gap.
6530. 
6531. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
6532. 
6533. /* ------------------------- */
6534. 
6535. 	
6536. 	# Zone Statistics	
6537. 		# Script: ZoneStatisticsGet
6538. # Zone / Volume Statistics and Display
6539. 		
6540. 	# Accumulate Totals
6541.   	# Script: ZoneDoVolumeTotals
6542. 
6543. /* Current total space used (by Zones and Gaps) */
6544. 
6545. SetVariable(VolumeZoneUsed, GapUsed)
6546. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
6547. /* Percentage */
6548. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
6549. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
6550. 
6551. /* Current total of free space requested */
6552. 
6553. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
6554. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6555. /* Percent. */
6556. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
6557. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6558. 
6559. /* Current total of free space used */
6560. 
6561. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
6562. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
6563. /* Percent */
6564. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
6565. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
6566. 
6567. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
6568. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
6569. # Xinclude "..\DebugDisplayPause.MyDc"X
6570. 
6571. 
6572. 	# Current Values
6573. 	# Script: ZoneDoCurrentSet
6574. 
6575. # Cluster, Sector, Block adjust for display.
6576. 	# Bytes per cluster is volume specific.
6577. 
6578. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
6579. 
6580. # Current Zone values.
6581. 	# Begin, end and size.
6582. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
6583. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
6584. 
6585. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
6586. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
6587. 
6588. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
6589. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
6590. 
6591. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
6592. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
6593. 
6594. 	SetVariable(ZoneFragments,				"!ZONE210N!")
6595. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
6596. 		
6597. # Current Gap, Actual and Free Values
6598. 	# Gap
6599. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
6600. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
6601. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
6602. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
6603. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
6604. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
6605. 	
6606. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
6607. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
6608. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
6609. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
6610. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
6611. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
6612. 	
6613. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
6614. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
6615. 	
6616. 	# Actual Size and End
6617. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
6618. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
6619. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
6620. 	
6621. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
6622. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
6623. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
6624. 
6625. # Gap Size & Rounding
6626. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
6627. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
6628. 	
6629. 	# Free Space
6630. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
6631. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
6632. 
6633. 	# Script: ZoneStatisticsReportGet
6634. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
6635. 
6636. # Footer:
6637. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
6638. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
6639. #
6640. # Xinclude "..\Commands\DateTimeLastLong.txt"X
6641. #
6642. # What a mess this word based vs is. Try a phrase based version ToDo
6643. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
6644. ------------------
6645.    !SizeWord!!ColonWord!  
6646.    ------------------------
6647.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6648.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6649.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6650. 
6651.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6652.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
6653. 
6654.    !LocationWord!!ColonWord!
6655.    ------------------------
6656.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6657.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
6658.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6659.       
6660.    !GapWordCaps! !SettingsWord!!ColonWord!
6661.    ------------------------
6662.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
6663.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
6664.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6665.                  
6666.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
6667.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
6668.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
6669.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
6670.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
6671.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
6672.      
6673.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
6674.    ------------------------
6675.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6676.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6677.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6678. 
6679. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
6680. ----------------------------------------------------------
6681. ")
6682. #
6683. SetVariable(DateNow, 	DATETIME)
6684. SetVariable(TimeNow, 	Time)
6685. SetVariable(RunTimeNow, 	RunTime)
6686. 
6687. 
6688. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
6689. 
6690. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
6691. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
6692. 
6693. 	# Script: DisplaySetWindowText
6694. # Zone Footer Set Statistics Window Text
6695. 
6696. SetStatisticsWindowText("!Heading!
6697. ----------------------------------------------------------
6698. Zones Processed: 
6699. ----------------------------------------------------------
6700. !ZoneListByLine!
6701. ----------------------------------------------------------
6702. Zone Processing Step:
6703. !ZoneStepByLine!    
6704. ----------------------------------------------------------
6705. ----------------------------------------------------------
6706. CURRENT ZONE:
6707. !ZoneStatisticsReport!
6708. ----------------------------------------------------------
6709. ----------------------------------------------------------
6710. ----------------------------------------------------------
6711. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
6712. ----------------------------------------------------------
6713. !VolumeStatisticsSummary!
6714. !VolumeStatisticsDetail!
6715. ----------------------------------------------------------
6716. ----------------------------------------------------------
6717. Zone Detailed Report:
6718. ----------------------------------------------------------
6719. !ZoneStatisticsDetail!
6720. ----------------------------------------------------------
6721. ")
6722. 
6723. 
6724. 	
6725. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
6726. 
6727. 
6728. 	SetVariable(ZoneStatisticsData, 
6729. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
6730.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
6731.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
6732. 
6733. 
6734. 
6735.  		# Script: ZoneStatisticsDisplay
6736. 	
6737. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
6738. !ZoneStatisticsData!
6739. ')
6740. 
6741. 		# Script: ZoneStatisticsAdd
6742. # Append Zone to Details of each zone.
6743. 		
6744. 	# Add Zone Details to Report.	
6745. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
6746. !ZoneStatisticsReport!
6747. ')
6748. 
6749. 	
6750. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
6751. 		# Script: DisplaySetZoneStep
6752. # Increment
6753. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6754. 
6755. # Display this zone step
6756. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
6757. ')
6758. 
6759. # Script: BannerSet
6760. 
6761. # NOTE: Can't round or truncate to integer precision. 
6762. # This internal fields like ZoneCount format really badly.
6763. #  for !RunTimeNow! does not work. None of the date functions do.
6764. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6765. 
6766. SetVariable(HeadingTemp2,	ZoneCount + 0)
6767. 
6768. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6769. 
6770. Title('!Heading!')
6771. 
6772. /* pause(1) */
6773. 
6774. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6775. 
6776. 
6777. # Script: DisplaySetWindowText
6778. # Zone Footer Set Statistics Window Text
6779. 
6780. SetStatisticsWindowText("!Heading!
6781. ----------------------------------------------------------
6782. Zones Processed: 
6783. ----------------------------------------------------------
6784. !ZoneListByLine!
6785. ----------------------------------------------------------
6786. Zone Processing Step:
6787. !ZoneStepByLine!    
6788. ----------------------------------------------------------
6789. ----------------------------------------------------------
6790. CURRENT ZONE:
6791. !ZoneStatisticsReport!
6792. ----------------------------------------------------------
6793. ----------------------------------------------------------
6794. ----------------------------------------------------------
6795. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
6796. ----------------------------------------------------------
6797. !VolumeStatisticsSummary!
6798. !VolumeStatisticsDetail!
6799. ----------------------------------------------------------
6800. ----------------------------------------------------------
6801. Zone Detailed Report:
6802. ----------------------------------------------------------
6803. !ZoneStatisticsDetail!
6804. ----------------------------------------------------------
6805. ")
6806. 
6807. 
6808. 
6809. 
6810. 		# File Action - Type Os Program Hints Fixed - Regular - ImportSeq.
6811. # File Action - ZoneDoActionSortByCreationDateFull
6812. 	SortByCreationDate(Ascending)
6813. 	
6814. 
6815. 
6816. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
6817. 		# Script: DisplaySetZoneStep
6818. # Increment
6819. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6820. 
6821. # Display this zone step
6822. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
6823. ')
6824. 
6825. # Script: BannerSet
6826. 
6827. # NOTE: Can't round or truncate to integer precision. 
6828. # This internal fields like ZoneCount format really badly.
6829. #  for !RunTimeNow! does not work. None of the date functions do.
6830. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6831. 
6832. SetVariable(HeadingTemp2,	ZoneCount + 0)
6833. 
6834. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6835. 
6836. Title('!Heading!')
6837. 
6838. /* pause(1) */
6839. 
6840. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6841. 
6842. 
6843. # Script: DisplaySetWindowText
6844. # Zone Footer Set Statistics Window Text
6845. 
6846. SetStatisticsWindowText("!Heading!
6847. ----------------------------------------------------------
6848. Zones Processed: 
6849. ----------------------------------------------------------
6850. !ZoneListByLine!
6851. ----------------------------------------------------------
6852. Zone Processing Step:
6853. !ZoneStepByLine!    
6854. ----------------------------------------------------------
6855. ----------------------------------------------------------
6856. CURRENT ZONE:
6857. !ZoneStatisticsReport!
6858. ----------------------------------------------------------
6859. ----------------------------------------------------------
6860. ----------------------------------------------------------
6861. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
6862. ----------------------------------------------------------
6863. !VolumeStatisticsSummary!
6864. !VolumeStatisticsDetail!
6865. ----------------------------------------------------------
6866. ----------------------------------------------------------
6867. Zone Detailed Report:
6868. ----------------------------------------------------------
6869. !ZoneStatisticsDetail!
6870. ----------------------------------------------------------
6871. ")
6872. 
6873. 
6874. 
6875. 
6876. 	# Script: ZoneDoFooter
6877. 
6878. /* --------------------------------- */
6879. 	# File Select
6880. 		# Select Statments
6881. 	# File Actions 
6882. 		# Standard or OS File Actions.
6883. 		# Resume...
6884. 	
6885. 		# your stuff HERE (X)... post zone (file) file actions code.
6886. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
6887. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
6888. 			# (X)
6889. 		
6890. 			/* ??? Set window? */
6891. 	
6892. 		# ADD THE GAP
6893. 		# Script: GapZoneCommand
6894. # Vacate (good for diagnostics)
6895. # DoNotVacate - DO NOT Vacate (recommended)
6896. 
6897. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
6898. # Script: DisplaySetZoneStep
6899. # Increment
6900. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6901. 
6902. # Display this zone step
6903. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
6904. ')
6905. 
6906. # Script: BannerSet
6907. 
6908. # NOTE: Can't round or truncate to integer precision. 
6909. # This internal fields like ZoneCount format really badly.
6910. #  for !RunTimeNow! does not work. None of the date functions do.
6911. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6912. 
6913. SetVariable(HeadingTemp2,	ZoneCount + 0)
6914. 
6915. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6916. 
6917. Title('!Heading!')
6918. 
6919. /* pause(1) */
6920. 
6921. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
6922. 
6923. 
6924. # Script: DisplaySetWindowText
6925. # Zone Footer Set Statistics Window Text
6926. 
6927. SetStatisticsWindowText("!Heading!
6928. ----------------------------------------------------------
6929. Zones Processed: 
6930. ----------------------------------------------------------
6931. !ZoneListByLine!
6932. ----------------------------------------------------------
6933. Zone Processing Step:
6934. !ZoneStepByLine!    
6935. ----------------------------------------------------------
6936. ----------------------------------------------------------
6937. CURRENT ZONE:
6938. !ZoneStatisticsReport!
6939. ----------------------------------------------------------
6940. ----------------------------------------------------------
6941. ----------------------------------------------------------
6942. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
6943. ----------------------------------------------------------
6944. !VolumeStatisticsSummary!
6945. !VolumeStatisticsDetail!
6946. ----------------------------------------------------------
6947. ----------------------------------------------------------
6948. Zone Detailed Report:
6949. ----------------------------------------------------------
6950. !ZoneStatisticsDetail!
6951. ----------------------------------------------------------
6952. ")
6953. 
6954. 
6955. 
6956. 
6957. # *** Moved to setting yours *** 
6958. # (to avoid doing it twice)
6959. # (ie the later wouldn't "overwrite" the former in the usual manner)
6960. 
6961. # Do one or the other:
6962. # DoNotVacate - DO NOT Vacate (recommended)
6963. 
6964. # Vacate
6965. /* AddGap(GapUsedLoc) */
6966. 
6967. # DO Not Vacate
6968. AddGap(GapUsedLoc, DoNotVacate) 
6969. 	
6970. 	
6971. 
6972. # Controlled via settings commands
6973. 
6974. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
6975. 
6976. # Vacate /* AddGap(GapUsed) */
6977. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
6978. 	
6979. 
6980. 		
6981. 	# 
6982. 	FileEnd
6983. /* --------------------------------- */
6984. # your stuff HERE (X)... post zone (file) code.
6985. 
6986. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
6987. # Script: DisplaySetZoneStep
6988. # Increment
6989. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6990. 
6991. # Display this zone step
6992. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
6993. ')
6994. 
6995. # Script: BannerSet
6996. 
6997. # NOTE: Can't round or truncate to integer precision. 
6998. # This internal fields like ZoneCount format really badly.
6999. #  for !RunTimeNow! does not work. None of the date functions do.
7000. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
7001. 
7002. SetVariable(HeadingTemp2,	ZoneCount + 0)
7003. 
7004. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7005. 
7006. Title('!Heading!')
7007. 
7008. /* pause(1) */
7009. 
7010. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7011. 
7012. 
7013. # Script: DisplaySetWindowText
7014. # Zone Footer Set Statistics Window Text
7015. 
7016. SetStatisticsWindowText("!Heading!
7017. ----------------------------------------------------------
7018. Zones Processed: 
7019. ----------------------------------------------------------
7020. !ZoneListByLine!
7021. ----------------------------------------------------------
7022. Zone Processing Step:
7023. !ZoneStepByLine!    
7024. ----------------------------------------------------------
7025. ----------------------------------------------------------
7026. CURRENT ZONE:
7027. !ZoneStatisticsReport!
7028. ----------------------------------------------------------
7029. ----------------------------------------------------------
7030. ----------------------------------------------------------
7031. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
7032. ----------------------------------------------------------
7033. !VolumeStatisticsSummary!
7034. !VolumeStatisticsDetail!
7035. ----------------------------------------------------------
7036. ----------------------------------------------------------
7037. Zone Detailed Report:
7038. ----------------------------------------------------------
7039. !ZoneStatisticsDetail!
7040. ----------------------------------------------------------
7041. ")
7042. 
7043. 
7044. 
7045. 
7046. # Script: ZoneWhenFinished
7047. 
7048. # Add the zone to the zone details log:
7049. # This is temporarily disable until logging is fixed
7050. # It is performed during file action to preserve the correct (original) calculations.
7051. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
7052. 
7053. # Add the Select and ZoneSteps to the Zone
7054. # Script: ZoneStatisticsAdd
7055. # Append Zone to Details of each zone.
7056. 		
7057. 	# Add Zone Details to Report.	
7058. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
7059. ----------------------------------------------------------
7060. !ZoneStepByLine!
7061. ---------------------------
7062. !ZoneTypeSelectCurrent!               
7063. ---------------------------
7064. ----------------------------------------------------------
7065. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
7066. ----------------------------------------------------------
7067. ')
7068. 
7069. 
7070. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
7071. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
7072. # 2021-12-14 15:29:59
7073. RunProgram("..\Commands\WriteDateTime.bat LastZone")
7074. # Append Datetime to logs
7075. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
7076. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
7077. 
7078. AppendLogfile("!LogFileName!", "!PeriodWord!")
7079. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
7080. AppendLogfile("!LogFileName!", "!PeriodWord!")
7081. 
7082. # Script: DisplaySetWindowText
7083. # Zone Footer Set Statistics Window Text
7084. 
7085. SetStatisticsWindowText("!Heading!
7086. ----------------------------------------------------------
7087. Zones Processed: 
7088. ----------------------------------------------------------
7089. !ZoneListByLine!
7090. ----------------------------------------------------------
7091. Zone Processing Step:
7092. !ZoneStepByLine!    
7093. ----------------------------------------------------------
7094. ----------------------------------------------------------
7095. CURRENT ZONE:
7096. !ZoneStatisticsReport!
7097. ----------------------------------------------------------
7098. ----------------------------------------------------------
7099. ----------------------------------------------------------
7100. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
7101. ----------------------------------------------------------
7102. !VolumeStatisticsSummary!
7103. !VolumeStatisticsDetail!
7104. ----------------------------------------------------------
7105. ----------------------------------------------------------
7106. Zone Detailed Report:
7107. ----------------------------------------------------------
7108. !ZoneStatisticsDetail!
7109. ----------------------------------------------------------
7110. ")
7111. 
7112. 
7113. 
7114. /* pause() */
7115. /* pause() */
7116. 
7117. 
7118. 
7119. /* ------------------------- */
7120. 
7121. 	
7122. /* ------------------------- */
7123. # Zone 2 of 2 ProgramHints Data.
7124. 	# Script: DisplayColors - Zone Dark
7125. # Processed
7126. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
7127. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
7128. 
7129. # Light Green and Yellow
7130. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
7131. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
7132. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
7133. 
7134. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHintsData!")
7135. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHintsData!")
7136. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
7137. 	SetVariable(ZoneGapSize, 			"!ZoneGapSizeProgramHints!")
7138. 
7139. 	SetVariable(ZoneTypeSelect,'
7140. Program Hints Data:
7141. # Script: ZoneDo ZoneTypeSelectOsProgramHints
7142. # ProgramHints start.
7143. ImportListFromProgramHints("*.pf")
7144. # ProgramHints end.
7145. 
7146. and not(
7147. 	# Script: ZoneDo ZoneTypeSelectOsDataDynamic
7148. # Os Data Dynamic start.
7149. (
7150. # Os Data Dynamic start.
7151. (
7152.   FileName("*.dat*")
7153.   or FileName("*.db*")
7154.   or FileName("*.edb*")
7155.   or FileName("*.log*")
7156.   or FileName("DataStore.edb")
7157. )
7158. # Os Data Dynamic end.
7159. 
7160.   or 
7161. # Os PageHiberDump start.
7162. (
7163.   FileName("DataStore.edb")
7164.   or FileName("DUMP*.*")
7165.   or FileName("Hiberfil.sys")
7166.   or FileName("MEMORY.DMP")
7167.   or FileName("Pagefile.sys")
7168. )
7169. # Os PageHiberDump end.
7170. 
7171. # Os Data Dynamic
7172. )
7173. # Os Data Dynamic end.
7174. 	)
7175. ')
7176. 
7177. 	SetVariable(ZoneNoCurrentAdjust, ZoneNoCurrentAdjust + 1)
7178. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
7179. 
7180. SetVariable(ZoneStepNoCurrent, 0)
7181. 
7182. 	/* ------------------------- */
7183. # Script: ZoneDoHeader
7184. 
7185. # Script: ZoneWhenStarted
7186. RunProgram("..\Commands\WriteDateTime.bat")
7187. 
7188. # Script: ZoneDoCurrentClear
7189. 
7190. SetVariable(ZoneTypeSelectCurrent, 		"")
7191. SetVariable(ZoneStatisticsData, 		"")
7192. SetVariable(ZoneStepByLine, 			"")
7193. 
7194. SetVariable(ZoneBeginCurrent, 			0)
7195. SetVariable(ZoneBeginPerCurrent, 		0)
7196. SetVariable(ZoneEndCurrent, 			0)
7197. SetVariable(ZoneEndPerCurrent, 			0)
7198. 
7199. SetVariable(ZoneSizeCurrent,			0)
7200. SetVariable(ZoneSizePerCurrent,			0)
7201. 
7202. SetVariable(ZoneGapRequestedCurrent,	0)
7203. SetVariable(ZoneGapRoundedCurrent, 		0)
7204. SetVariable(ZoneGapAdjustedCurrent, 	0)
7205. SetVariable(ZoneGapAvailableCurrent, 	0)
7206. SetVariable(ZoneGapCurrent,				0)
7207. SetVariable(ZoneGapUsedCurrent, 		0)
7208. 
7209. SetVariable(ZoneGapActualCurrent, 		0)
7210. SetVariable(ZoneGapActualPerCurrent, 	0)
7211. 
7212. SetVariable(ZoneSizeActual, 			0)
7213. SetVariable(ZoneSizeActualCurrent,		0)
7214. 
7215. SetVariable(ZoneEndActual, 				0)
7216. SetVariable(ZoneEndActualCurrent,		0)			
7217. SetVariable(ZoneSizeActualPerCurrent, 	0)
7218.       
7219. SetVariable(ZoneFilesFolders,			0)
7220. SetVariable(ZoneFilesFoldersPer,		0) 
7221. 
7222. SetVariable(ZoneFragments,				0)
7223. SetVariable(ZoneFragmentsPer,			0) 
7224. 		
7225. SetVariable(ZoneEndActualCurrent, 		0)
7226. SetVariable(ZoneEndActualPerCurrent, 	0)
7227. 
7228. # Gap Calculation Methodology:
7229. 	# Requested
7230. 	SetVariable(GapRequested, 			0) 
7231. 	SetVariable(GapRequestedStd, 		0) 
7232. 	SetVariable(GapRequestedMft, 		0) 
7233. 	SetVariable(GapRequestedOs, 		0) 
7234. 	SetVariable(GapRequestedOriginal, 	0) 
7235. 	
7236. 	# Gap Adjustments
7237. 	SetVariable(GapRounded, 			0)
7238. 	# SetVariable(GapAdjusted, 			0)
7239. 	SetVariable(GapAvailable, 			0)
7240. 	SetVariable(GapCurrent, 			0)
7241. 	SetVariable(GapActual, 				0)
7242. 	SetVariable(GapUsed, 				0)
7243. 	
7244. 	# Gap Adjustments
7245. 	SetVariable(GapRoundedLoc, 			0)
7246. 	# SetVariable(GapAdjustedLoc, 		0)
7247. 	SetVariable(GapAvailableLoc, 		0)
7248. 	SetVariable(GapCurrentLoc, 			0)
7249. 	SetVariable(GapActualLoc,			0)
7250. 	SetVariable(GapUsedLoc,				0)
7251. 	
7252. 	# Space usage
7253. 	SetVariable(ZoneFreePerRequested, 	0)
7254. 	SetVariable(ZoneFreePerUsed, 		0)
7255. 
7256. # Gap Size & Rounding
7257. 	SetVariable(ZoneGapSizePer, 		0)
7258. 	SetVariable(ZoneVolRoundUpPer, 		0)
7259. 	
7260. 	# Free Space
7261. 	SetVariable(ZoneFreeUsedPer, 		0)
7262. 	SetVariable(ZoneFreeRequestedPer, 	0)
7263. 
7264. # Script: DisplaySetZone
7265. 
7266. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
7267. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
7268. 
7269. # Message ZoneSummary
7270. # SetVariable(ZoneSummary, '
7271. # Zone Summary:
7272. # ')
7273. # Zone processing steps
7274. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
7275. # ')
7276. 
7277. # # Script: BannerDescriptionSet
7278. 
7279. # Script: BannerSet
7280. 
7281. # NOTE: Can't round or truncate to integer precision. 
7282. # This internal fields like ZoneCount format really badly.
7283. #  for !RunTimeNow! does not work. None of the date functions do.
7284. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
7285. 
7286. SetVariable(HeadingTemp2,	ZoneCount + 0)
7287. 
7288. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7289. 
7290. Title('!Heading!')
7291. 
7292. /* pause(1) */
7293. 
7294. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7295. 
7296. 
7297. # Script: BannerLog
7298. 
7299. AppendLogfile("!LogFileName!", "!Heading!")
7300. 
7301. 
7302. 
7303. # pause(1)
7304. 
7305. 
7306. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
7307. # Script: DisplaySetZoneStep
7308. # Increment
7309. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7310. 
7311. # Display this zone step
7312. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
7313. ')
7314. 
7315. # Script: BannerSet
7316. 
7317. # NOTE: Can't round or truncate to integer precision. 
7318. # This internal fields like ZoneCount format really badly.
7319. #  for !RunTimeNow! does not work. None of the date functions do.
7320. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
7321. 
7322. SetVariable(HeadingTemp2,	ZoneCount + 0)
7323. 
7324. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7325. 
7326. Title('!Heading!')
7327. 
7328. /* pause(1) */
7329. 
7330. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7331. 
7332. 
7333. # Script: DisplaySetWindowText
7334. # Zone Footer Set Statistics Window Text
7335. 
7336. SetStatisticsWindowText("!Heading!
7337. ----------------------------------------------------------
7338. Zones Processed: 
7339. ----------------------------------------------------------
7340. !ZoneListByLine!
7341. ----------------------------------------------------------
7342. Zone Processing Step:
7343. !ZoneStepByLine!    
7344. ----------------------------------------------------------
7345. ----------------------------------------------------------
7346. CURRENT ZONE:
7347. !ZoneStatisticsReport!
7348. ----------------------------------------------------------
7349. ----------------------------------------------------------
7350. ----------------------------------------------------------
7351. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
7352. ----------------------------------------------------------
7353. !VolumeStatisticsSummary!
7354. !VolumeStatisticsDetail!
7355. ----------------------------------------------------------
7356. ----------------------------------------------------------
7357. Zone Detailed Report:
7358. ----------------------------------------------------------
7359. !ZoneStatisticsDetail!
7360. ----------------------------------------------------------
7361. ")
7362. 
7363. 
7364. 
7365. 
7366. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
7367. 
7368. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
7369. # Script: DisplaySetZoneStep
7370. # Increment
7371. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7372. 
7373. # Display this zone step
7374. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
7375. ')
7376. 
7377. # Script: BannerSet
7378. 
7379. # NOTE: Can't round or truncate to integer precision. 
7380. # This internal fields like ZoneCount format really badly.
7381. #  for !RunTimeNow! does not work. None of the date functions do.
7382. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
7383. 
7384. SetVariable(HeadingTemp2,	ZoneCount + 0)
7385. 
7386. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7387. 
7388. Title('!Heading!')
7389. 
7390. /* pause(1) */
7391. 
7392. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7393. 
7394. 
7395. # Script: DisplaySetWindowText
7396. # Zone Footer Set Statistics Window Text
7397. 
7398. SetStatisticsWindowText("!Heading!
7399. ----------------------------------------------------------
7400. Zones Processed: 
7401. ----------------------------------------------------------
7402. !ZoneListByLine!
7403. ----------------------------------------------------------
7404. Zone Processing Step:
7405. !ZoneStepByLine!    
7406. ----------------------------------------------------------
7407. ----------------------------------------------------------
7408. CURRENT ZONE:
7409. !ZoneStatisticsReport!
7410. ----------------------------------------------------------
7411. ----------------------------------------------------------
7412. ----------------------------------------------------------
7413. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
7414. ----------------------------------------------------------
7415. !VolumeStatisticsSummary!
7416. !VolumeStatisticsDetail!
7417. ----------------------------------------------------------
7418. ----------------------------------------------------------
7419. Zone Detailed Report:
7420. ----------------------------------------------------------
7421. !ZoneStatisticsDetail!
7422. ----------------------------------------------------------
7423. ")
7424. 
7425. 
7426. 
7427. 
7428. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
7429. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
7430. 
7431. # Script: BannerSet
7432. 
7433. # NOTE: Can't round or truncate to integer precision. 
7434. # This internal fields like ZoneCount format really badly.
7435. #  for !RunTimeNow! does not work. None of the date functions do.
7436. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
7437. 
7438. SetVariable(HeadingTemp2,	ZoneCount + 0)
7439. 
7440. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7441. 
7442. Title('!Heading!')
7443. 
7444. /* pause(1) */
7445. 
7446. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7447. 
7448. 
7449. # Script: BannerLog
7450. 
7451. AppendLogfile("!LogFileName!", "!Heading!")
7452. 
7453. 
7454. 
7455. # LOGGING:
7456. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
7457. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
7458. 
7459. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
7460. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:29:59")
7461. # 2021-12-14 15:29:59 
7462. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:04 !ZoneLabel! !ZoneDescription!")
7463. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
7464. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:04 !ZoneLabel! !ZoneDescription!")
7465. 
7466. 
7467. # Add zone to list of zones:
7468. SetVariable(ZoneListByLine, "!ZoneListByLine!
7469. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
7470. # Script: DisplaySetWindowText
7471. # Zone Footer Set Statistics Window Text
7472. 
7473. SetStatisticsWindowText("!Heading!
7474. ----------------------------------------------------------
7475. Zones Processed: 
7476. ----------------------------------------------------------
7477. !ZoneListByLine!
7478. ----------------------------------------------------------
7479. Zone Processing Step:
7480. !ZoneStepByLine!    
7481. ----------------------------------------------------------
7482. ----------------------------------------------------------
7483. CURRENT ZONE:
7484. !ZoneStatisticsReport!
7485. ----------------------------------------------------------
7486. ----------------------------------------------------------
7487. ----------------------------------------------------------
7488. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
7489. ----------------------------------------------------------
7490. !VolumeStatisticsSummary!
7491. !VolumeStatisticsDetail!
7492. ----------------------------------------------------------
7493. ----------------------------------------------------------
7494. Zone Detailed Report:
7495. ----------------------------------------------------------
7496. !ZoneStatisticsDetail!
7497. ----------------------------------------------------------
7498. ")
7499. 
7500. 
7501. 
7502. 
7503. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
7504. # Script: DisplaySetZoneStep
7505. # Increment
7506. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7507. 
7508. # Display this zone step
7509. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
7510. ')
7511. 
7512. # Script: BannerSet
7513. 
7514. # NOTE: Can't round or truncate to integer precision. 
7515. # This internal fields like ZoneCount format really badly.
7516. #  for !RunTimeNow! does not work. None of the date functions do.
7517. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
7518. 
7519. SetVariable(HeadingTemp2,	ZoneCount + 0)
7520. 
7521. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7522. 
7523. Title('!Heading!')
7524. 
7525. /* pause(1) */
7526. 
7527. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7528. 
7529. 
7530. # Script: DisplaySetWindowText
7531. # Zone Footer Set Statistics Window Text
7532. 
7533. SetStatisticsWindowText("!Heading!
7534. ----------------------------------------------------------
7535. Zones Processed: 
7536. ----------------------------------------------------------
7537. !ZoneListByLine!
7538. ----------------------------------------------------------
7539. Zone Processing Step:
7540. !ZoneStepByLine!    
7541. ----------------------------------------------------------
7542. ----------------------------------------------------------
7543. CURRENT ZONE:
7544. !ZoneStatisticsReport!
7545. ----------------------------------------------------------
7546. ----------------------------------------------------------
7547. ----------------------------------------------------------
7548. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
7549. ----------------------------------------------------------
7550. !VolumeStatisticsSummary!
7551. !VolumeStatisticsDetail!
7552. ----------------------------------------------------------
7553. ----------------------------------------------------------
7554. Zone Detailed Report:
7555. ----------------------------------------------------------
7556. !ZoneStatisticsDetail!
7557. ----------------------------------------------------------
7558. ")
7559. 
7560. 
7561. 
7562. 
7563. # your stuff HERE (X)... pre file select code.
7564. 
7565. /* --------------------------------- */
7566. 	FileSelect
7567. 
7568. 		# your stuff can't really go here (errors.)
7569. 		# maybe for some reason I don't know of...
7570. 	
7571. 		# Actions next...
7572. 	# Script: ZoneDo ZoneTypeSelectOsProgramHints
7573. # ProgramHints start.
7574. ImportListFromProgramHints("*.pf")
7575. # ProgramHints end.
7576. 
7577. 	and not(
7578. 	# Script: ZoneDo ZoneTypeSelectOsDataDynamic
7579. # Os Data Dynamic start.
7580. (
7581. # Os Data Dynamic start.
7582. (
7583.   FileName("*.dat*")
7584.   or FileName("*.db*")
7585.   or FileName("*.edb*")
7586.   or FileName("*.log*")
7587.   or FileName("DataStore.edb")
7588. )
7589. # Os Data Dynamic end.
7590. 
7591.   or 
7592. # Os PageHiberDump start.
7593. (
7594.   FileName("DataStore.edb")
7595.   or FileName("DUMP*.*")
7596.   or FileName("Hiberfil.sys")
7597.   or FileName("MEMORY.DMP")
7598.   or FileName("Pagefile.sys")
7599. )
7600. # Os PageHiberDump end.
7601. 
7602. # Os Data Dynamic
7603. )
7604. # Os Data Dynamic end.
7605. 		)
7606. 		
7607. 	FileActions
7608. 
7609. 			# Script: GapZoneCalc
7610. 	# Gap
7611. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
7612. 		# Script: DisplaySetZoneStep
7613. # Increment
7614. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7615. 
7616. # Display this zone step
7617. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
7618. ')
7619. 
7620. # Script: BannerSet
7621. 
7622. # NOTE: Can't round or truncate to integer precision. 
7623. # This internal fields like ZoneCount format really badly.
7624. #  for !RunTimeNow! does not work. None of the date functions do.
7625. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
7626. 
7627. SetVariable(HeadingTemp2,	ZoneCount + 0)
7628. 
7629. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7630. 
7631. Title('!Heading!')
7632. 
7633. /* pause(1) */
7634. 
7635. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
7636. 
7637. 
7638. # Script: DisplaySetWindowText
7639. # Zone Footer Set Statistics Window Text
7640. 
7641. SetStatisticsWindowText("!Heading!
7642. ----------------------------------------------------------
7643. Zones Processed: 
7644. ----------------------------------------------------------
7645. !ZoneListByLine!
7646. ----------------------------------------------------------
7647. Zone Processing Step:
7648. !ZoneStepByLine!    
7649. ----------------------------------------------------------
7650. ----------------------------------------------------------
7651. CURRENT ZONE:
7652. !ZoneStatisticsReport!
7653. ----------------------------------------------------------
7654. ----------------------------------------------------------
7655. ----------------------------------------------------------
7656. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
7657. ----------------------------------------------------------
7658. !VolumeStatisticsSummary!
7659. !VolumeStatisticsDetail!
7660. ----------------------------------------------------------
7661. ----------------------------------------------------------
7662. Zone Detailed Report:
7663. ----------------------------------------------------------
7664. !ZoneStatisticsDetail!
7665. ----------------------------------------------------------
7666. ")
7667. 
7668. 
7669. 
7670. 	
7671. 	# ACTUAL GAP
7672. 		/* AddGap Variant. */
7673. 	  	# Script: GapZoneSet
7674. # Zone Do Gap
7675. # Gap Calculation Methods:
7676. 
7677. /* 1) Anything you need to add first. */
7678. /* empty */
7679. 
7680. /* ------------------------- */
7681. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
7682. 	# GapRequestedStd.
7683. 
7684. 		/* ------------------------- */
7685. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
7686. 
7687. 		# Gap Calculation Methods:
7688. 
7689. /* AddGap Variants */
7690. 
7691. 	/* Standard */
7692. 		# Gap Calculation Methods:
7693. 	/* AddGap Variants */
7694. 	/* Standard */
7695. 
7696. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
7697. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
7698. 
7699. 	SetVariable(GapRequested, GapRequestedStd)
7700. 	
7701. 
7702. 	/* MFT Low High Method */
7703. 		# Gap Calculation Methods:
7704. 	/* AddGap Variants */
7705. 	/* MFT Low High Method */
7706. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
7707. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
7708. 	SetVariable(GapRequested, GapRequestedMft)
7709. 	
7710. 
7711. 	/* OS Volume Type Method */
7712. 		# Gap Calculation Methods:
7713. 	/* AddGap Variants */
7714. 	/* OS Volume Type Method */
7715. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
7716. 	SetVariable(GapRequested, GapRequestedOs)
7717. 
7718. 
7719. 
7720. /* MakeGap Variants */
7721. 
7722. 	/* Original Os 1-3 + MFT 2 */
7723. 		# Gap Calculation Methods:
7724. 	/* MakeGap Variants */
7725. 	/* Original Os 1-3 + MFT 2 */
7726. 	/* plus MFT gap placed inline at the dividing zone. */
7727. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
7728. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
7729. 	SetVariable(GapRequested, GapRequestedOrig)
7730. 	
7731. 	
7732. /* Note: You could comment out the ones not in use */
7733. /* However having the data in the log is useful. */
7734. /* Therefore the following line is otherwise needed. */
7735. 
7736. /* Standard used */
7737. 
7738. SetVariable(GapRequested, GapRequestedStd)
7739. 
7740. # Gap Calculation Methods:
7741. 
7742. /* AddGap Variants */
7743. 	/* Standard */
7744. 	/* MFT Low High Method */
7745. 	/* OS Volume Type Method */
7746. 
7747. /* MakeGap Variants */
7748. 	/* Original Os 1-3 + MFT 2 */
7749. 
7750. /* Note: You could comment out the ones not in use */
7751. /* However having the data in the log is useful. */
7752. /* Therefore the following line is otherwise needed. */
7753. 
7754. /* Standard is used currently */
7755. 
7756. 
7757. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
7758. 
7759. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
7760. 
7761. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
7762. 
7763. /* ------------------------- */
7764. /* 3) SMALL ZONE ADJUSTMENT. */
7765. /* Gab cant be larger than half the Zone Size. */
7766. 
7767. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
7768. 	
7769. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
7770. 
7771. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
7772. 
7773. /* ------------------------- */
7774. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
7775. # Gap Adjustments.
7776. 
7777. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
7778. 	
7779. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
7780. 
7781. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
7782. 
7783. /* ------------------------- */
7784. # BYPASS THIS.
7785. 	/* This is definitely wrong. */
7786. 	/* The question is can we steal gap from the next zone */
7787. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
7788. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
7789. 		# Zone Overflow.
7790. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
7791. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
7792. 
7793. /* ------------------------- */
7794. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
7795. # Remaining free space available.
7796. 
7797. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
7798. 	
7799. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
7800. 
7801. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
7802. 
7803. /* ------------------------- */
7804. # CURRENT gap to use.
7805. 
7806. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
7807. 
7808. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
7809. 
7810. /* ------------------------- */
7811. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
7812. # Debugging.
7813. 
7814. 	SetVariable(GapUsed, GapCurrent) // for debugging
7815. 
7816. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
7817. 
7818. 		# Your code HERE
7819. 
7820. /* ------------------------- */
7821. /* 7) YOUR CODE. */
7822. # YOUR CODE HERE:
7823. 	# INPUT: GapCurrent or GapCurrentLoc
7824. 	# OUTPUT: GapUsed...
7825. 
7826. /* ------------------------- */
7827. # Gap Size.
7828. # Actual Size of Gap.
7829. 
7830. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
7831. 
7832. /* ------------------------- */
7833. 
7834. 	
7835. 	# Zone Statistics	
7836. 		# Script: ZoneStatisticsGet
7837. # Zone / Volume Statistics and Display
7838. 		
7839. 	# Accumulate Totals
7840.   	# Script: ZoneDoVolumeTotals
7841. 
7842. /* Current total space used (by Zones and Gaps) */
7843. 
7844. SetVariable(VolumeZoneUsed, GapUsed)
7845. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
7846. /* Percentage */
7847. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
7848. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
7849. 
7850. /* Current total of free space requested */
7851. 
7852. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
7853. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7854. /* Percent. */
7855. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
7856. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7857. 
7858. /* Current total of free space used */
7859. 
7860. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
7861. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
7862. /* Percent */
7863. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
7864. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
7865. 
7866. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
7867. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
7868. # Xinclude "..\DebugDisplayPause.MyDc"X
7869. 
7870. 
7871. 	# Current Values
7872. 	# Script: ZoneDoCurrentSet
7873. 
7874. # Cluster, Sector, Block adjust for display.
7875. 	# Bytes per cluster is volume specific.
7876. 
7877. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
7878. 
7879. # Current Zone values.
7880. 	# Begin, end and size.
7881. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
7882. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
7883. 
7884. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
7885. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
7886. 
7887. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
7888. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
7889. 
7890. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
7891. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
7892. 
7893. 	SetVariable(ZoneFragments,				"!ZONE210N!")
7894. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
7895. 		
7896. # Current Gap, Actual and Free Values
7897. 	# Gap
7898. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
7899. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
7900. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
7901. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
7902. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
7903. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
7904. 	
7905. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
7906. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
7907. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
7908. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
7909. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
7910. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
7911. 	
7912. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
7913. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
7914. 	
7915. 	# Actual Size and End
7916. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
7917. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
7918. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
7919. 	
7920. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
7921. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
7922. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
7923. 
7924. # Gap Size & Rounding
7925. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
7926. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
7927. 	
7928. 	# Free Space
7929. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
7930. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
7931. 
7932. 	# Script: ZoneStatisticsReportGet
7933. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
7934. 
7935. # Footer:
7936. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
7937. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
7938. #
7939. # Xinclude "..\Commands\DateTimeLastLong.txt"X
7940. #
7941. # What a mess this word based vs is. Try a phrase based version ToDo
7942. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
7943. ------------------
7944.    !SizeWord!!ColonWord!  
7945.    ------------------------
7946.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7947.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7948.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7949. 
7950.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7951.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
7952. 
7953.    !LocationWord!!ColonWord!
7954.    ------------------------
7955.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7956.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
7957.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7958.       
7959.    !GapWordCaps! !SettingsWord!!ColonWord!
7960.    ------------------------
7961.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
7962.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
7963.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7964.                  
7965.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
7966.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
7967.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
7968.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
7969.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
7970.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
7971.      
7972.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
7973.    ------------------------
7974.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7975.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7976.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7977. 
7978. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
7979. ----------------------------------------------------------
7980. ")
7981. #
7982. SetVariable(DateNow, 	DATETIME)
7983. SetVariable(TimeNow, 	Time)
7984. SetVariable(RunTimeNow, 	RunTime)
7985. 
7986. 
7987. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
7988. 
7989. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
7990. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
7991. 
7992. 	# Script: DisplaySetWindowText
7993. # Zone Footer Set Statistics Window Text
7994. 
7995. SetStatisticsWindowText("!Heading!
7996. ----------------------------------------------------------
7997. Zones Processed: 
7998. ----------------------------------------------------------
7999. !ZoneListByLine!
8000. ----------------------------------------------------------
8001. Zone Processing Step:
8002. !ZoneStepByLine!    
8003. ----------------------------------------------------------
8004. ----------------------------------------------------------
8005. CURRENT ZONE:
8006. !ZoneStatisticsReport!
8007. ----------------------------------------------------------
8008. ----------------------------------------------------------
8009. ----------------------------------------------------------
8010. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
8011. ----------------------------------------------------------
8012. !VolumeStatisticsSummary!
8013. !VolumeStatisticsDetail!
8014. ----------------------------------------------------------
8015. ----------------------------------------------------------
8016. Zone Detailed Report:
8017. ----------------------------------------------------------
8018. !ZoneStatisticsDetail!
8019. ----------------------------------------------------------
8020. ")
8021. 
8022. 
8023. 	
8024. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
8025. 
8026. 
8027. 	SetVariable(ZoneStatisticsData, 
8028. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
8029.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
8030.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
8031. 
8032. 
8033. 
8034.  		# Script: ZoneStatisticsDisplay
8035. 	
8036. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
8037. !ZoneStatisticsData!
8038. ')
8039. 
8040. 		# Script: ZoneStatisticsAdd
8041. # Append Zone to Details of each zone.
8042. 		
8043. 	# Add Zone Details to Report.	
8044. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
8045. !ZoneStatisticsReport!
8046. ')
8047. 
8048. 
8049. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
8050. 		# Script: DisplaySetZoneStep
8051. # Increment
8052. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8053. 
8054. # Display this zone step
8055. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
8056. ')
8057. 
8058. # Script: BannerSet
8059. 
8060. # NOTE: Can't round or truncate to integer precision. 
8061. # This internal fields like ZoneCount format really badly.
8062. #  for !RunTimeNow! does not work. None of the date functions do.
8063. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8064. 
8065. SetVariable(HeadingTemp2,	ZoneCount + 0)
8066. 
8067. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8068. 
8069. Title('!Heading!')
8070. 
8071. /* pause(1) */
8072. 
8073. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8074. 
8075. 
8076. # Script: DisplaySetWindowText
8077. # Zone Footer Set Statistics Window Text
8078. 
8079. SetStatisticsWindowText("!Heading!
8080. ----------------------------------------------------------
8081. Zones Processed: 
8082. ----------------------------------------------------------
8083. !ZoneListByLine!
8084. ----------------------------------------------------------
8085. Zone Processing Step:
8086. !ZoneStepByLine!    
8087. ----------------------------------------------------------
8088. ----------------------------------------------------------
8089. CURRENT ZONE:
8090. !ZoneStatisticsReport!
8091. ----------------------------------------------------------
8092. ----------------------------------------------------------
8093. ----------------------------------------------------------
8094. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
8095. ----------------------------------------------------------
8096. !VolumeStatisticsSummary!
8097. !VolumeStatisticsDetail!
8098. ----------------------------------------------------------
8099. ----------------------------------------------------------
8100. Zone Detailed Report:
8101. ----------------------------------------------------------
8102. !ZoneStatisticsDetail!
8103. ----------------------------------------------------------
8104. ")
8105. 
8106. 
8107. 
8108. 
8109. 		# File Action - Type Os Program Hints Data - Regular - ImportSeq.
8110. # File Action - SortByImportSequence.
8111. SortByImportSequence(Ascending ) 
8112. 	
8113. 	
8114. 	
8115. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
8116. 		# Script: DisplaySetZoneStep
8117. # Increment
8118. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8119. 
8120. # Display this zone step
8121. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
8122. ')
8123. 
8124. # Script: BannerSet
8125. 
8126. # NOTE: Can't round or truncate to integer precision. 
8127. # This internal fields like ZoneCount format really badly.
8128. #  for !RunTimeNow! does not work. None of the date functions do.
8129. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8130. 
8131. SetVariable(HeadingTemp2,	ZoneCount + 0)
8132. 
8133. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8134. 
8135. Title('!Heading!')
8136. 
8137. /* pause(1) */
8138. 
8139. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8140. 
8141. 
8142. # Script: DisplaySetWindowText
8143. # Zone Footer Set Statistics Window Text
8144. 
8145. SetStatisticsWindowText("!Heading!
8146. ----------------------------------------------------------
8147. Zones Processed: 
8148. ----------------------------------------------------------
8149. !ZoneListByLine!
8150. ----------------------------------------------------------
8151. Zone Processing Step:
8152. !ZoneStepByLine!    
8153. ----------------------------------------------------------
8154. ----------------------------------------------------------
8155. CURRENT ZONE:
8156. !ZoneStatisticsReport!
8157. ----------------------------------------------------------
8158. ----------------------------------------------------------
8159. ----------------------------------------------------------
8160. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
8161. ----------------------------------------------------------
8162. !VolumeStatisticsSummary!
8163. !VolumeStatisticsDetail!
8164. ----------------------------------------------------------
8165. ----------------------------------------------------------
8166. Zone Detailed Report:
8167. ----------------------------------------------------------
8168. !ZoneStatisticsDetail!
8169. ----------------------------------------------------------
8170. ")
8171. 
8172. 
8173. 
8174. 
8175. 	# Script: ZoneDoFooter
8176. 
8177. /* --------------------------------- */
8178. 	# File Select
8179. 		# Select Statments
8180. 	# File Actions 
8181. 		# Standard or OS File Actions.
8182. 		# Resume...
8183. 	
8184. 		# your stuff HERE (X)... post zone (file) file actions code.
8185. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
8186. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
8187. 			# (X)
8188. 		
8189. 			/* ??? Set window? */
8190. 	
8191. 		# ADD THE GAP
8192. 		# Script: GapZoneCommand
8193. # Vacate (good for diagnostics)
8194. # DoNotVacate - DO NOT Vacate (recommended)
8195. 
8196. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
8197. # Script: DisplaySetZoneStep
8198. # Increment
8199. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8200. 
8201. # Display this zone step
8202. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
8203. ')
8204. 
8205. # Script: BannerSet
8206. 
8207. # NOTE: Can't round or truncate to integer precision. 
8208. # This internal fields like ZoneCount format really badly.
8209. #  for !RunTimeNow! does not work. None of the date functions do.
8210. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8211. 
8212. SetVariable(HeadingTemp2,	ZoneCount + 0)
8213. 
8214. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8215. 
8216. Title('!Heading!')
8217. 
8218. /* pause(1) */
8219. 
8220. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8221. 
8222. 
8223. # Script: DisplaySetWindowText
8224. # Zone Footer Set Statistics Window Text
8225. 
8226. SetStatisticsWindowText("!Heading!
8227. ----------------------------------------------------------
8228. Zones Processed: 
8229. ----------------------------------------------------------
8230. !ZoneListByLine!
8231. ----------------------------------------------------------
8232. Zone Processing Step:
8233. !ZoneStepByLine!    
8234. ----------------------------------------------------------
8235. ----------------------------------------------------------
8236. CURRENT ZONE:
8237. !ZoneStatisticsReport!
8238. ----------------------------------------------------------
8239. ----------------------------------------------------------
8240. ----------------------------------------------------------
8241. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
8242. ----------------------------------------------------------
8243. !VolumeStatisticsSummary!
8244. !VolumeStatisticsDetail!
8245. ----------------------------------------------------------
8246. ----------------------------------------------------------
8247. Zone Detailed Report:
8248. ----------------------------------------------------------
8249. !ZoneStatisticsDetail!
8250. ----------------------------------------------------------
8251. ")
8252. 
8253. 
8254. 
8255. 
8256. # *** Moved to setting yours *** 
8257. # (to avoid doing it twice)
8258. # (ie the later wouldn't "overwrite" the former in the usual manner)
8259. 
8260. # Do one or the other:
8261. # DoNotVacate - DO NOT Vacate (recommended)
8262. 
8263. # Vacate
8264. /* AddGap(GapUsedLoc) */
8265. 
8266. # DO Not Vacate
8267. AddGap(GapUsedLoc, DoNotVacate) 
8268. 	
8269. 	
8270. 
8271. # Controlled via settings commands
8272. 
8273. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
8274. 
8275. # Vacate /* AddGap(GapUsed) */
8276. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
8277. 	
8278. 
8279. 		
8280. 	# 
8281. 	FileEnd
8282. /* --------------------------------- */
8283. # your stuff HERE (X)... post zone (file) code.
8284. 
8285. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
8286. # Script: DisplaySetZoneStep
8287. # Increment
8288. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8289. 
8290. # Display this zone step
8291. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
8292. ')
8293. 
8294. # Script: BannerSet
8295. 
8296. # NOTE: Can't round or truncate to integer precision. 
8297. # This internal fields like ZoneCount format really badly.
8298. #  for !RunTimeNow! does not work. None of the date functions do.
8299. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8300. 
8301. SetVariable(HeadingTemp2,	ZoneCount + 0)
8302. 
8303. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8304. 
8305. Title('!Heading!')
8306. 
8307. /* pause(1) */
8308. 
8309. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8310. 
8311. 
8312. # Script: DisplaySetWindowText
8313. # Zone Footer Set Statistics Window Text
8314. 
8315. SetStatisticsWindowText("!Heading!
8316. ----------------------------------------------------------
8317. Zones Processed: 
8318. ----------------------------------------------------------
8319. !ZoneListByLine!
8320. ----------------------------------------------------------
8321. Zone Processing Step:
8322. !ZoneStepByLine!    
8323. ----------------------------------------------------------
8324. ----------------------------------------------------------
8325. CURRENT ZONE:
8326. !ZoneStatisticsReport!
8327. ----------------------------------------------------------
8328. ----------------------------------------------------------
8329. ----------------------------------------------------------
8330. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
8331. ----------------------------------------------------------
8332. !VolumeStatisticsSummary!
8333. !VolumeStatisticsDetail!
8334. ----------------------------------------------------------
8335. ----------------------------------------------------------
8336. Zone Detailed Report:
8337. ----------------------------------------------------------
8338. !ZoneStatisticsDetail!
8339. ----------------------------------------------------------
8340. ")
8341. 
8342. 
8343. 
8344. 
8345. # Script: ZoneWhenFinished
8346. 
8347. # Add the zone to the zone details log:
8348. # This is temporarily disable until logging is fixed
8349. # It is performed during file action to preserve the correct (original) calculations.
8350. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
8351. 
8352. # Add the Select and ZoneSteps to the Zone
8353. # Script: ZoneStatisticsAdd
8354. # Append Zone to Details of each zone.
8355. 		
8356. 	# Add Zone Details to Report.	
8357. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
8358. ----------------------------------------------------------
8359. !ZoneStepByLine!
8360. ---------------------------
8361. !ZoneTypeSelectCurrent!               
8362. ---------------------------
8363. ----------------------------------------------------------
8364. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
8365. ----------------------------------------------------------
8366. ')
8367. 
8368. 
8369. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
8370. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
8371. # 2021-12-14 15:29:59
8372. RunProgram("..\Commands\WriteDateTime.bat LastZone")
8373. # Append Datetime to logs
8374. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
8375. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
8376. 
8377. AppendLogfile("!LogFileName!", "!PeriodWord!")
8378. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
8379. AppendLogfile("!LogFileName!", "!PeriodWord!")
8380. 
8381. # Script: DisplaySetWindowText
8382. # Zone Footer Set Statistics Window Text
8383. 
8384. SetStatisticsWindowText("!Heading!
8385. ----------------------------------------------------------
8386. Zones Processed: 
8387. ----------------------------------------------------------
8388. !ZoneListByLine!
8389. ----------------------------------------------------------
8390. Zone Processing Step:
8391. !ZoneStepByLine!    
8392. ----------------------------------------------------------
8393. ----------------------------------------------------------
8394. CURRENT ZONE:
8395. !ZoneStatisticsReport!
8396. ----------------------------------------------------------
8397. ----------------------------------------------------------
8398. ----------------------------------------------------------
8399. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
8400. ----------------------------------------------------------
8401. !VolumeStatisticsSummary!
8402. !VolumeStatisticsDetail!
8403. ----------------------------------------------------------
8404. ----------------------------------------------------------
8405. Zone Detailed Report:
8406. ----------------------------------------------------------
8407. !ZoneStatisticsDetail!
8408. ----------------------------------------------------------
8409. ")
8410. 
8411. 
8412. 
8413. /* pause() */
8414. /* pause() */
8415. 
8416. 
8417. 
8418. /* ------------------------- */
8419. 
8420. 	
8421. /* ------------------------- */
8422. 
8423. 
8424. /* ------------------------- */
8425. # Zone Programs Fixed size but not windows..
8426. # Os Group Zone 5d Fixed, 6l Fixed Windows, 7l Fixed Data
8427. # Script: DefragZoneTypeOsPrograms
8428. /* ------------------------- */
8429. # Zone Programs Fixed size but not windows.. - Zone 1 (5)
8430. 	# Script: DisplayColors - Zone Dark
8431. # Processed
8432. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
8433. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
8434. 
8435. # Light Green and Yellow
8436. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
8437. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
8438. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
8439. 
8440. 	SetVariable(ZoneLabel, 			"!ZoneLabelPrograms!")
8441. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPrograms!")
8442. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
8443. 	SetVariable(ZoneGapSize, 			"!ZoneGapSizePrograms!")
8444. 
8445. 	SetVariable(ZoneTypeSelect,		'
8446. Programs:
8447. # Script: ZoneDo ZoneTypeSelectOsPrograms
8448. # Programs start.
8449. # Mark: 1
8450. # NotBlobsArchivesBu start.
8451. # NOT!
8452. (not (
8453. # Blobs start.
8454. (
8455. # BlobsAndExceptions start.
8456. ( not(
8457.   FileName("*.bat")
8458.   or FileName("*.css")
8459.   or FileName("*.dll")
8460.   or FileName("*.exe")
8461.   or FileName("*.htm*")
8462.   or FileName("*.jar")
8463.   or FileName("*.js")
8464.   or FileName("*.script")
8465.   or FileName("*.wsf")
8466.   or (
8467. # Databases start.
8468. (
8469.   FileName("*.crypt*")
8470.   or FileName("*.db*")
8471.   or FileName("*.rdb*")
8472.   or FileName("*.dc*")
8473.   or FileName("*.dict*")
8474.   or FileName("*.?db*")
8475.   or FileName("*.?rdb*")
8476.   or FileName("*.md*")
8477.   or FileName("*.myd")
8478.   or FileName("*.ndf")
8479.   or FileName("*.ns?")
8480.   or FileName("*.pab")
8481.   or FileName("*.pst")
8482.   or FileName("*.sd?*")
8483.   or FileName("*.sq**")
8484.   or FileName("*.tmd")
8485.   or FileName("*.tps")
8486.   or FileName("*.tr*")
8487. )
8488. # Databases end.
8489. 
8490.     # BlobsAndExceptions
8491.     or 
8492. # Data start.
8493. (
8494.   DirectoryName("Data*")
8495.   or DirectoryName("Device*")
8496.   or DirectoryName("Export*")
8497.   or DirectoryName("Import*")
8498.   or DirectoryName("Log*")
8499.   or DirectoryName("*Log")
8500.   or DirectoryName("Maintenance*")
8501.   or DirectoryName("Rec*")
8502.   or DirectoryName("Sales*")
8503.   or DirectoryName("Search*")
8504.   or DirectoryName("User*")
8505. )
8506. # Data end.
8507. 
8508.     # BlobsAndExceptions
8509.   )
8510. ) )
8511. # BlobsAndExceptions end.
8512. 
8513. # Blobs
8514. ) and (
8515.   Size(BlobFileSize,0)
8516.   or (
8517.     FileName("*.arj")
8518.     or FileName("*.bup")
8519.     or FileName("*.bz2")
8520.     or FileName("*.chm")
8521.     or FileName("*.dvr-ms")
8522.     or FileName("*.gz")
8523.     or FileName("*.ifo")
8524.     or FileName("*.lzh")
8525.     or FileName("*.pdf")
8526.     or FileName("*.rpm")
8527.     or FileName("*.wmv")
8528.     or FileName("*.vob")
8529.     or FileName("*.z")
8530.   ) 
8531. )
8532. # Blobs end.
8533. 
8534. # NotBlobsArchivesBu
8535. or 
8536. # Archives start.
8537. (
8538.   DirectoryName("*Archive*")
8539.   or DirectoryName("*History*")
8540.   or DirectoryName("*Old")
8541.   or DirectoryName("* Old *")
8542.   or DirectoryName("Old *")
8543. 
8544.   or FileName("*.7z")
8545.   or FileName("*.cab")
8546.   or FileName("*.iso")
8547.   or FileName("*.msi")
8548.   or FileName("*.old")
8549.   or FileName("*.rar")
8550.   or FileName("*.tar")
8551.   or FileName("*.zip")
8552.   or
8553. # WinSysLow start.
8554. (
8555.   # Bad idea. This pushed lots of programs and data to archive.
8556.   # DirectoryName("$*")
8557.   # or DirectoryName("0*")
8558.   # or DirectoryName("1*")
8559.   # or DirectoryName("2*")
8560.   # or DirectoryName("3*")
8561.   # or DirectoryName("4*")
8562.   # or DirectoryName("5*")
8563.   # or DirectoryName("6*")
8564.   # or DirectoryName("7*")
8565.   # or DirectoryName("8*")
8566.   # or DirectoryName("9*")
8567.   # or 
8568.   DirectoryName("dllcache")
8569.   or DirectoryName("Downloaded Installations")
8570.   or DirectoryName("Ehome")
8571.   or DirectoryName("Fonts")
8572.   or DirectoryName("Help")
8573.   or DirectoryName("I386")
8574.   or DirectoryName("ie?updates")
8575.   or DirectoryName("Installer")
8576.   or DirectoryName("Installshield Installation Information")
8577.   or DirectoryName("IME")
8578.   or DirectoryName("*RECYCLE*")
8579.   or DirectoryName("ServicePackFiles")
8580.   or DirectoryName("SoftwareDistribution")
8581.   or DirectoryName("Speech")
8582.   or DirectoryName("Symbols")
8583.   or DirectoryName("System Volume Information")
8584.   or DirectoryName("windows.old")
8585. )
8586. # WinSysLow end.
8587. 
8588.   # Archives
8589. )
8590. # Archives end.
8591. 
8592. # NotBlobsArchivesBu
8593. or
8594. # Backups start.
8595. (
8596.   DirectoryName("*Backup*")
8597.   or DirectoryName("*Bu")
8598.   or DirectoryName("* Bu *")
8599.   or DirectoryName("Bu *")
8600. 
8601.   or FileName("*.bak")
8602.   or FileName("* - Copy*")
8603. )
8604. # Backups end.
8605. 
8606. or 
8607. FileName("ReferenceMarker.MyDx")
8608. # NotBlobsArchivesBu
8609. ) )
8610. # NotBlobsArchivesBu end.
8611. 
8612. # Mark: 2
8613. # Programs
8614. and (
8615. # Mark: 3
8616. # SystemDir start.
8617. (
8618.   DirectoryName("Boot*")
8619.   or DirectoryName("Device*")
8620.   or DirectoryName("DevSupport*")
8621.   or DirectoryName("Program*")
8622.   or DirectoryName("Security*")
8623.   or DirectoryName("SendTo*")
8624.   or DirectoryName("Sw*")
8625.   or DirectoryName("System*")
8626.   or DirectoryName("Toolbars")
8627.   or DirectoryName("Windows*")
8628. )
8629. # SystemDir end.
8630. 
8631. # Mark: 4
8632. # Programs
8633. )
8634. # Programs end.
8635. 
8636. and not(
8637. 	# Script: ZoneDo ZoneTypeSelectOsDataDynamic
8638. # Os Data Dynamic start.
8639. (
8640. # Os Data Dynamic start.
8641. (
8642.   FileName("*.dat*")
8643.   or FileName("*.db*")
8644.   or FileName("*.edb*")
8645.   or FileName("*.log*")
8646.   or FileName("DataStore.edb")
8647. )
8648. # Os Data Dynamic end.
8649. 
8650.   or 
8651. # Os PageHiberDump start.
8652. (
8653.   FileName("DataStore.edb")
8654.   or FileName("DUMP*.*")
8655.   or FileName("Hiberfil.sys")
8656.   or FileName("MEMORY.DMP")
8657.   or FileName("Pagefile.sys")
8658. )
8659. # Os PageHiberDump end.
8660. 
8661. # Os Data Dynamic
8662. )
8663. # Os Data Dynamic end.
8664. 
8665. 	or 
8666. 	DirectoryName("Windows*")
8667. 	)
8668. ')
8669. 
8670. 	SetVariable(ZoneNoCurrentAdjust, ZoneNoCurrentAdjust + 1)
8671. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
8672. 
8673. SetVariable(ZoneStepNoCurrent, 0)
8674. 
8675. 	/* ------------------------- */
8676. # Script: ZoneDoHeader
8677. 
8678. # Script: ZoneWhenStarted
8679. RunProgram("..\Commands\WriteDateTime.bat")
8680. 
8681. # Script: ZoneDoCurrentClear
8682. 
8683. SetVariable(ZoneTypeSelectCurrent, 		"")
8684. SetVariable(ZoneStatisticsData, 		"")
8685. SetVariable(ZoneStepByLine, 			"")
8686. 
8687. SetVariable(ZoneBeginCurrent, 			0)
8688. SetVariable(ZoneBeginPerCurrent, 		0)
8689. SetVariable(ZoneEndCurrent, 			0)
8690. SetVariable(ZoneEndPerCurrent, 			0)
8691. 
8692. SetVariable(ZoneSizeCurrent,			0)
8693. SetVariable(ZoneSizePerCurrent,			0)
8694. 
8695. SetVariable(ZoneGapRequestedCurrent,	0)
8696. SetVariable(ZoneGapRoundedCurrent, 		0)
8697. SetVariable(ZoneGapAdjustedCurrent, 	0)
8698. SetVariable(ZoneGapAvailableCurrent, 	0)
8699. SetVariable(ZoneGapCurrent,				0)
8700. SetVariable(ZoneGapUsedCurrent, 		0)
8701. 
8702. SetVariable(ZoneGapActualCurrent, 		0)
8703. SetVariable(ZoneGapActualPerCurrent, 	0)
8704. 
8705. SetVariable(ZoneSizeActual, 			0)
8706. SetVariable(ZoneSizeActualCurrent,		0)
8707. 
8708. SetVariable(ZoneEndActual, 				0)
8709. SetVariable(ZoneEndActualCurrent,		0)			
8710. SetVariable(ZoneSizeActualPerCurrent, 	0)
8711.       
8712. SetVariable(ZoneFilesFolders,			0)
8713. SetVariable(ZoneFilesFoldersPer,		0) 
8714. 
8715. SetVariable(ZoneFragments,				0)
8716. SetVariable(ZoneFragmentsPer,			0) 
8717. 		
8718. SetVariable(ZoneEndActualCurrent, 		0)
8719. SetVariable(ZoneEndActualPerCurrent, 	0)
8720. 
8721. # Gap Calculation Methodology:
8722. 	# Requested
8723. 	SetVariable(GapRequested, 			0) 
8724. 	SetVariable(GapRequestedStd, 		0) 
8725. 	SetVariable(GapRequestedMft, 		0) 
8726. 	SetVariable(GapRequestedOs, 		0) 
8727. 	SetVariable(GapRequestedOriginal, 	0) 
8728. 	
8729. 	# Gap Adjustments
8730. 	SetVariable(GapRounded, 			0)
8731. 	# SetVariable(GapAdjusted, 			0)
8732. 	SetVariable(GapAvailable, 			0)
8733. 	SetVariable(GapCurrent, 			0)
8734. 	SetVariable(GapActual, 				0)
8735. 	SetVariable(GapUsed, 				0)
8736. 	
8737. 	# Gap Adjustments
8738. 	SetVariable(GapRoundedLoc, 			0)
8739. 	# SetVariable(GapAdjustedLoc, 		0)
8740. 	SetVariable(GapAvailableLoc, 		0)
8741. 	SetVariable(GapCurrentLoc, 			0)
8742. 	SetVariable(GapActualLoc,			0)
8743. 	SetVariable(GapUsedLoc,				0)
8744. 	
8745. 	# Space usage
8746. 	SetVariable(ZoneFreePerRequested, 	0)
8747. 	SetVariable(ZoneFreePerUsed, 		0)
8748. 
8749. # Gap Size & Rounding
8750. 	SetVariable(ZoneGapSizePer, 		0)
8751. 	SetVariable(ZoneVolRoundUpPer, 		0)
8752. 	
8753. 	# Free Space
8754. 	SetVariable(ZoneFreeUsedPer, 		0)
8755. 	SetVariable(ZoneFreeRequestedPer, 	0)
8756. 
8757. # Script: DisplaySetZone
8758. 
8759. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
8760. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
8761. 
8762. # Message ZoneSummary
8763. # SetVariable(ZoneSummary, '
8764. # Zone Summary:
8765. # ')
8766. # Zone processing steps
8767. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
8768. # ')
8769. 
8770. # # Script: BannerDescriptionSet
8771. 
8772. # Script: BannerSet
8773. 
8774. # NOTE: Can't round or truncate to integer precision. 
8775. # This internal fields like ZoneCount format really badly.
8776. #  for !RunTimeNow! does not work. None of the date functions do.
8777. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8778. 
8779. SetVariable(HeadingTemp2,	ZoneCount + 0)
8780. 
8781. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8782. 
8783. Title('!Heading!')
8784. 
8785. /* pause(1) */
8786. 
8787. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8788. 
8789. 
8790. # Script: BannerLog
8791. 
8792. AppendLogfile("!LogFileName!", "!Heading!")
8793. 
8794. 
8795. 
8796. # pause(1)
8797. 
8798. 
8799. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
8800. # Script: DisplaySetZoneStep
8801. # Increment
8802. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8803. 
8804. # Display this zone step
8805. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
8806. ')
8807. 
8808. # Script: BannerSet
8809. 
8810. # NOTE: Can't round or truncate to integer precision. 
8811. # This internal fields like ZoneCount format really badly.
8812. #  for !RunTimeNow! does not work. None of the date functions do.
8813. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8814. 
8815. SetVariable(HeadingTemp2,	ZoneCount + 0)
8816. 
8817. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8818. 
8819. Title('!Heading!')
8820. 
8821. /* pause(1) */
8822. 
8823. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8824. 
8825. 
8826. # Script: DisplaySetWindowText
8827. # Zone Footer Set Statistics Window Text
8828. 
8829. SetStatisticsWindowText("!Heading!
8830. ----------------------------------------------------------
8831. Zones Processed: 
8832. ----------------------------------------------------------
8833. !ZoneListByLine!
8834. ----------------------------------------------------------
8835. Zone Processing Step:
8836. !ZoneStepByLine!    
8837. ----------------------------------------------------------
8838. ----------------------------------------------------------
8839. CURRENT ZONE:
8840. !ZoneStatisticsReport!
8841. ----------------------------------------------------------
8842. ----------------------------------------------------------
8843. ----------------------------------------------------------
8844. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
8845. ----------------------------------------------------------
8846. !VolumeStatisticsSummary!
8847. !VolumeStatisticsDetail!
8848. ----------------------------------------------------------
8849. ----------------------------------------------------------
8850. Zone Detailed Report:
8851. ----------------------------------------------------------
8852. !ZoneStatisticsDetail!
8853. ----------------------------------------------------------
8854. ")
8855. 
8856. 
8857. 
8858. 
8859. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
8860. 
8861. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
8862. # Script: DisplaySetZoneStep
8863. # Increment
8864. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8865. 
8866. # Display this zone step
8867. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
8868. ')
8869. 
8870. # Script: BannerSet
8871. 
8872. # NOTE: Can't round or truncate to integer precision. 
8873. # This internal fields like ZoneCount format really badly.
8874. #  for !RunTimeNow! does not work. None of the date functions do.
8875. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8876. 
8877. SetVariable(HeadingTemp2,	ZoneCount + 0)
8878. 
8879. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8880. 
8881. Title('!Heading!')
8882. 
8883. /* pause(1) */
8884. 
8885. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8886. 
8887. 
8888. # Script: DisplaySetWindowText
8889. # Zone Footer Set Statistics Window Text
8890. 
8891. SetStatisticsWindowText("!Heading!
8892. ----------------------------------------------------------
8893. Zones Processed: 
8894. ----------------------------------------------------------
8895. !ZoneListByLine!
8896. ----------------------------------------------------------
8897. Zone Processing Step:
8898. !ZoneStepByLine!    
8899. ----------------------------------------------------------
8900. ----------------------------------------------------------
8901. CURRENT ZONE:
8902. !ZoneStatisticsReport!
8903. ----------------------------------------------------------
8904. ----------------------------------------------------------
8905. ----------------------------------------------------------
8906. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
8907. ----------------------------------------------------------
8908. !VolumeStatisticsSummary!
8909. !VolumeStatisticsDetail!
8910. ----------------------------------------------------------
8911. ----------------------------------------------------------
8912. Zone Detailed Report:
8913. ----------------------------------------------------------
8914. !ZoneStatisticsDetail!
8915. ----------------------------------------------------------
8916. ")
8917. 
8918. 
8919. 
8920. 
8921. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
8922. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
8923. 
8924. # Script: BannerSet
8925. 
8926. # NOTE: Can't round or truncate to integer precision. 
8927. # This internal fields like ZoneCount format really badly.
8928. #  for !RunTimeNow! does not work. None of the date functions do.
8929. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8930. 
8931. SetVariable(HeadingTemp2,	ZoneCount + 0)
8932. 
8933. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8934. 
8935. Title('!Heading!')
8936. 
8937. /* pause(1) */
8938. 
8939. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
8940. 
8941. 
8942. # Script: BannerLog
8943. 
8944. AppendLogfile("!LogFileName!", "!Heading!")
8945. 
8946. 
8947. 
8948. # LOGGING:
8949. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
8950. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
8951. 
8952. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
8953. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:29:59")
8954. # 2021-12-14 15:29:59 
8955. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:04 !ZoneLabel! !ZoneDescription!")
8956. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
8957. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:04 !ZoneLabel! !ZoneDescription!")
8958. 
8959. 
8960. # Add zone to list of zones:
8961. SetVariable(ZoneListByLine, "!ZoneListByLine!
8962. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
8963. # Script: DisplaySetWindowText
8964. # Zone Footer Set Statistics Window Text
8965. 
8966. SetStatisticsWindowText("!Heading!
8967. ----------------------------------------------------------
8968. Zones Processed: 
8969. ----------------------------------------------------------
8970. !ZoneListByLine!
8971. ----------------------------------------------------------
8972. Zone Processing Step:
8973. !ZoneStepByLine!    
8974. ----------------------------------------------------------
8975. ----------------------------------------------------------
8976. CURRENT ZONE:
8977. !ZoneStatisticsReport!
8978. ----------------------------------------------------------
8979. ----------------------------------------------------------
8980. ----------------------------------------------------------
8981. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
8982. ----------------------------------------------------------
8983. !VolumeStatisticsSummary!
8984. !VolumeStatisticsDetail!
8985. ----------------------------------------------------------
8986. ----------------------------------------------------------
8987. Zone Detailed Report:
8988. ----------------------------------------------------------
8989. !ZoneStatisticsDetail!
8990. ----------------------------------------------------------
8991. ")
8992. 
8993. 
8994. 
8995. 
8996. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
8997. # Script: DisplaySetZoneStep
8998. # Increment
8999. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9000. 
9001. # Display this zone step
9002. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
9003. ')
9004. 
9005. # Script: BannerSet
9006. 
9007. # NOTE: Can't round or truncate to integer precision. 
9008. # This internal fields like ZoneCount format really badly.
9009. #  for !RunTimeNow! does not work. None of the date functions do.
9010. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
9011. 
9012. SetVariable(HeadingTemp2,	ZoneCount + 0)
9013. 
9014. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9015. 
9016. Title('!Heading!')
9017. 
9018. /* pause(1) */
9019. 
9020. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9021. 
9022. 
9023. # Script: DisplaySetWindowText
9024. # Zone Footer Set Statistics Window Text
9025. 
9026. SetStatisticsWindowText("!Heading!
9027. ----------------------------------------------------------
9028. Zones Processed: 
9029. ----------------------------------------------------------
9030. !ZoneListByLine!
9031. ----------------------------------------------------------
9032. Zone Processing Step:
9033. !ZoneStepByLine!    
9034. ----------------------------------------------------------
9035. ----------------------------------------------------------
9036. CURRENT ZONE:
9037. !ZoneStatisticsReport!
9038. ----------------------------------------------------------
9039. ----------------------------------------------------------
9040. ----------------------------------------------------------
9041. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
9042. ----------------------------------------------------------
9043. !VolumeStatisticsSummary!
9044. !VolumeStatisticsDetail!
9045. ----------------------------------------------------------
9046. ----------------------------------------------------------
9047. Zone Detailed Report:
9048. ----------------------------------------------------------
9049. !ZoneStatisticsDetail!
9050. ----------------------------------------------------------
9051. ")
9052. 
9053. 
9054. 
9055. 
9056. # your stuff HERE (X)... pre file select code.
9057. 
9058. /* --------------------------------- */
9059. 	FileSelect
9060. 
9061. 		# your stuff can't really go here (errors.)
9062. 		# maybe for some reason I don't know of...
9063. 	
9064. 		# Actions next...
9065. 	# Script: ZoneDo ZoneTypeSelectOsPrograms
9066. # Programs start.
9067. # Mark: 1
9068. # NotBlobsArchivesBu start.
9069. # NOT!
9070. (not (
9071. # Blobs start.
9072. (
9073. # BlobsAndExceptions start.
9074. ( not(
9075.   FileName("*.bat")
9076.   or FileName("*.css")
9077.   or FileName("*.dll")
9078.   or FileName("*.exe")
9079.   or FileName("*.htm*")
9080.   or FileName("*.jar")
9081.   or FileName("*.js")
9082.   or FileName("*.script")
9083.   or FileName("*.wsf")
9084.   or (
9085. # Databases start.
9086. (
9087.   FileName("*.crypt*")
9088.   or FileName("*.db*")
9089.   or FileName("*.rdb*")
9090.   or FileName("*.dc*")
9091.   or FileName("*.dict*")
9092.   or FileName("*.?db*")
9093.   or FileName("*.?rdb*")
9094.   or FileName("*.md*")
9095.   or FileName("*.myd")
9096.   or FileName("*.ndf")
9097.   or FileName("*.ns?")
9098.   or FileName("*.pab")
9099.   or FileName("*.pst")
9100.   or FileName("*.sd?*")
9101.   or FileName("*.sq**")
9102.   or FileName("*.tmd")
9103.   or FileName("*.tps")
9104.   or FileName("*.tr*")
9105. )
9106. # Databases end.
9107. 
9108.     # BlobsAndExceptions
9109.     or 
9110. # Data start.
9111. (
9112.   DirectoryName("Data*")
9113.   or DirectoryName("Device*")
9114.   or DirectoryName("Export*")
9115.   or DirectoryName("Import*")
9116.   or DirectoryName("Log*")
9117.   or DirectoryName("*Log")
9118.   or DirectoryName("Maintenance*")
9119.   or DirectoryName("Rec*")
9120.   or DirectoryName("Sales*")
9121.   or DirectoryName("Search*")
9122.   or DirectoryName("User*")
9123. )
9124. # Data end.
9125. 
9126.     # BlobsAndExceptions
9127.   )
9128. ) )
9129. # BlobsAndExceptions end.
9130. 
9131. # Blobs
9132. ) and (
9133.   Size(BlobFileSize,0)
9134.   or (
9135.     FileName("*.arj")
9136.     or FileName("*.bup")
9137.     or FileName("*.bz2")
9138.     or FileName("*.chm")
9139.     or FileName("*.dvr-ms")
9140.     or FileName("*.gz")
9141.     or FileName("*.ifo")
9142.     or FileName("*.lzh")
9143.     or FileName("*.pdf")
9144.     or FileName("*.rpm")
9145.     or FileName("*.wmv")
9146.     or FileName("*.vob")
9147.     or FileName("*.z")
9148.   ) 
9149. )
9150. # Blobs end.
9151. 
9152. # NotBlobsArchivesBu
9153. or 
9154. # Archives start.
9155. (
9156.   DirectoryName("*Archive*")
9157.   or DirectoryName("*History*")
9158.   or DirectoryName("*Old")
9159.   or DirectoryName("* Old *")
9160.   or DirectoryName("Old *")
9161. 
9162.   or FileName("*.7z")
9163.   or FileName("*.cab")
9164.   or FileName("*.iso")
9165.   or FileName("*.msi")
9166.   or FileName("*.old")
9167.   or FileName("*.rar")
9168.   or FileName("*.tar")
9169.   or FileName("*.zip")
9170.   or
9171. # WinSysLow start.
9172. (
9173.   # Bad idea. This pushed lots of programs and data to archive.
9174.   # DirectoryName("$*")
9175.   # or DirectoryName("0*")
9176.   # or DirectoryName("1*")
9177.   # or DirectoryName("2*")
9178.   # or DirectoryName("3*")
9179.   # or DirectoryName("4*")
9180.   # or DirectoryName("5*")
9181.   # or DirectoryName("6*")
9182.   # or DirectoryName("7*")
9183.   # or DirectoryName("8*")
9184.   # or DirectoryName("9*")
9185.   # or 
9186.   DirectoryName("dllcache")
9187.   or DirectoryName("Downloaded Installations")
9188.   or DirectoryName("Ehome")
9189.   or DirectoryName("Fonts")
9190.   or DirectoryName("Help")
9191.   or DirectoryName("I386")
9192.   or DirectoryName("ie?updates")
9193.   or DirectoryName("Installer")
9194.   or DirectoryName("Installshield Installation Information")
9195.   or DirectoryName("IME")
9196.   or DirectoryName("*RECYCLE*")
9197.   or DirectoryName("ServicePackFiles")
9198.   or DirectoryName("SoftwareDistribution")
9199.   or DirectoryName("Speech")
9200.   or DirectoryName("Symbols")
9201.   or DirectoryName("System Volume Information")
9202.   or DirectoryName("windows.old")
9203. )
9204. # WinSysLow end.
9205. 
9206.   # Archives
9207. )
9208. # Archives end.
9209. 
9210. # NotBlobsArchivesBu
9211. or
9212. # Backups start.
9213. (
9214.   DirectoryName("*Backup*")
9215.   or DirectoryName("*Bu")
9216.   or DirectoryName("* Bu *")
9217.   or DirectoryName("Bu *")
9218. 
9219.   or FileName("*.bak")
9220.   or FileName("* - Copy*")
9221. )
9222. # Backups end.
9223. 
9224. or 
9225. FileName("ReferenceMarker.MyDx")
9226. # NotBlobsArchivesBu
9227. ) )
9228. # NotBlobsArchivesBu end.
9229. 
9230. # Mark: 2
9231. # Programs
9232. and (
9233. # Mark: 3
9234. # SystemDir start.
9235. (
9236.   DirectoryName("Boot*")
9237.   or DirectoryName("Device*")
9238.   or DirectoryName("DevSupport*")
9239.   or DirectoryName("Program*")
9240.   or DirectoryName("Security*")
9241.   or DirectoryName("SendTo*")
9242.   or DirectoryName("Sw*")
9243.   or DirectoryName("System*")
9244.   or DirectoryName("Toolbars")
9245.   or DirectoryName("Windows*")
9246. )
9247. # SystemDir end.
9248. 
9249. # Mark: 4
9250. # Programs
9251. )
9252. # Programs end.
9253. 
9254. 	and not(
9255. 		# Script: ZoneDo ZoneTypeSelectOsDataDynamic
9256. # Os Data Dynamic start.
9257. (
9258. # Os Data Dynamic start.
9259. (
9260.   FileName("*.dat*")
9261.   or FileName("*.db*")
9262.   or FileName("*.edb*")
9263.   or FileName("*.log*")
9264.   or FileName("DataStore.edb")
9265. )
9266. # Os Data Dynamic end.
9267. 
9268.   or 
9269. # Os PageHiberDump start.
9270. (
9271.   FileName("DataStore.edb")
9272.   or FileName("DUMP*.*")
9273.   or FileName("Hiberfil.sys")
9274.   or FileName("MEMORY.DMP")
9275.   or FileName("Pagefile.sys")
9276. )
9277. # Os PageHiberDump end.
9278. 
9279. # Os Data Dynamic
9280. )
9281. # Os Data Dynamic end.
9282. 
9283. 		or 
9284. 			DirectoryName("Windows*")
9285. 	)
9286. 
9287. 	FileActions
9288. 
9289. 			# Script: GapZoneCalc
9290. 	# Gap
9291. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
9292. 		# Script: DisplaySetZoneStep
9293. # Increment
9294. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9295. 
9296. # Display this zone step
9297. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
9298. ')
9299. 
9300. # Script: BannerSet
9301. 
9302. # NOTE: Can't round or truncate to integer precision. 
9303. # This internal fields like ZoneCount format really badly.
9304. #  for !RunTimeNow! does not work. None of the date functions do.
9305. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
9306. 
9307. SetVariable(HeadingTemp2,	ZoneCount + 0)
9308. 
9309. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9310. 
9311. Title('!Heading!')
9312. 
9313. /* pause(1) */
9314. 
9315. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9316. 
9317. 
9318. # Script: DisplaySetWindowText
9319. # Zone Footer Set Statistics Window Text
9320. 
9321. SetStatisticsWindowText("!Heading!
9322. ----------------------------------------------------------
9323. Zones Processed: 
9324. ----------------------------------------------------------
9325. !ZoneListByLine!
9326. ----------------------------------------------------------
9327. Zone Processing Step:
9328. !ZoneStepByLine!    
9329. ----------------------------------------------------------
9330. ----------------------------------------------------------
9331. CURRENT ZONE:
9332. !ZoneStatisticsReport!
9333. ----------------------------------------------------------
9334. ----------------------------------------------------------
9335. ----------------------------------------------------------
9336. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
9337. ----------------------------------------------------------
9338. !VolumeStatisticsSummary!
9339. !VolumeStatisticsDetail!
9340. ----------------------------------------------------------
9341. ----------------------------------------------------------
9342. Zone Detailed Report:
9343. ----------------------------------------------------------
9344. !ZoneStatisticsDetail!
9345. ----------------------------------------------------------
9346. ")
9347. 
9348. 
9349. 
9350. 	
9351. 	# ACTUAL GAP
9352. 		/* AddGap Variant. */
9353. 	  	# Script: GapZoneSet
9354. # Zone Do Gap
9355. # Gap Calculation Methods:
9356. 
9357. /* 1) Anything you need to add first. */
9358. /* empty */
9359. 
9360. /* ------------------------- */
9361. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
9362. 	# GapRequestedStd.
9363. 
9364. 		/* ------------------------- */
9365. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
9366. 
9367. 		# Gap Calculation Methods:
9368. 
9369. /* AddGap Variants */
9370. 
9371. 	/* Standard */
9372. 		# Gap Calculation Methods:
9373. 	/* AddGap Variants */
9374. 	/* Standard */
9375. 
9376. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
9377. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
9378. 
9379. 	SetVariable(GapRequested, GapRequestedStd)
9380. 	
9381. 
9382. 	/* MFT Low High Method */
9383. 		# Gap Calculation Methods:
9384. 	/* AddGap Variants */
9385. 	/* MFT Low High Method */
9386. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
9387. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
9388. 	SetVariable(GapRequested, GapRequestedMft)
9389. 	
9390. 
9391. 	/* OS Volume Type Method */
9392. 		# Gap Calculation Methods:
9393. 	/* AddGap Variants */
9394. 	/* OS Volume Type Method */
9395. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
9396. 	SetVariable(GapRequested, GapRequestedOs)
9397. 
9398. 
9399. 
9400. /* MakeGap Variants */
9401. 
9402. 	/* Original Os 1-3 + MFT 2 */
9403. 		# Gap Calculation Methods:
9404. 	/* MakeGap Variants */
9405. 	/* Original Os 1-3 + MFT 2 */
9406. 	/* plus MFT gap placed inline at the dividing zone. */
9407. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
9408. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
9409. 	SetVariable(GapRequested, GapRequestedOrig)
9410. 	
9411. 	
9412. /* Note: You could comment out the ones not in use */
9413. /* However having the data in the log is useful. */
9414. /* Therefore the following line is otherwise needed. */
9415. 
9416. /* Standard used */
9417. 
9418. SetVariable(GapRequested, GapRequestedStd)
9419. 
9420. # Gap Calculation Methods:
9421. 
9422. /* AddGap Variants */
9423. 	/* Standard */
9424. 	/* MFT Low High Method */
9425. 	/* OS Volume Type Method */
9426. 
9427. /* MakeGap Variants */
9428. 	/* Original Os 1-3 + MFT 2 */
9429. 
9430. /* Note: You could comment out the ones not in use */
9431. /* However having the data in the log is useful. */
9432. /* Therefore the following line is otherwise needed. */
9433. 
9434. /* Standard is used currently */
9435. 
9436. 
9437. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
9438. 
9439. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
9440. 
9441. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
9442. 
9443. /* ------------------------- */
9444. /* 3) SMALL ZONE ADJUSTMENT. */
9445. /* Gab cant be larger than half the Zone Size. */
9446. 
9447. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
9448. 	
9449. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
9450. 
9451. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
9452. 
9453. /* ------------------------- */
9454. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
9455. # Gap Adjustments.
9456. 
9457. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
9458. 	
9459. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
9460. 
9461. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
9462. 
9463. /* ------------------------- */
9464. # BYPASS THIS.
9465. 	/* This is definitely wrong. */
9466. 	/* The question is can we steal gap from the next zone */
9467. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
9468. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
9469. 		# Zone Overflow.
9470. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
9471. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
9472. 
9473. /* ------------------------- */
9474. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
9475. # Remaining free space available.
9476. 
9477. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
9478. 	
9479. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
9480. 
9481. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
9482. 
9483. /* ------------------------- */
9484. # CURRENT gap to use.
9485. 
9486. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
9487. 
9488. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
9489. 
9490. /* ------------------------- */
9491. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
9492. # Debugging.
9493. 
9494. 	SetVariable(GapUsed, GapCurrent) // for debugging
9495. 
9496. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
9497. 
9498. 		# Your code HERE
9499. 
9500. /* ------------------------- */
9501. /* 7) YOUR CODE. */
9502. # YOUR CODE HERE:
9503. 	# INPUT: GapCurrent or GapCurrentLoc
9504. 	# OUTPUT: GapUsed...
9505. 
9506. /* ------------------------- */
9507. # Gap Size.
9508. # Actual Size of Gap.
9509. 
9510. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
9511. 
9512. /* ------------------------- */
9513. 
9514. 	
9515. 	# Zone Statistics	
9516. 		# Script: ZoneStatisticsGet
9517. # Zone / Volume Statistics and Display
9518. 		
9519. 	# Accumulate Totals
9520.   	# Script: ZoneDoVolumeTotals
9521. 
9522. /* Current total space used (by Zones and Gaps) */
9523. 
9524. SetVariable(VolumeZoneUsed, GapUsed)
9525. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
9526. /* Percentage */
9527. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
9528. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
9529. 
9530. /* Current total of free space requested */
9531. 
9532. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
9533. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
9534. /* Percent. */
9535. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
9536. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
9537. 
9538. /* Current total of free space used */
9539. 
9540. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
9541. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
9542. /* Percent */
9543. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
9544. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
9545. 
9546. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
9547. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
9548. # Xinclude "..\DebugDisplayPause.MyDc"X
9549. 
9550. 
9551. 	# Current Values
9552. 	# Script: ZoneDoCurrentSet
9553. 
9554. # Cluster, Sector, Block adjust for display.
9555. 	# Bytes per cluster is volume specific.
9556. 
9557. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
9558. 
9559. # Current Zone values.
9560. 	# Begin, end and size.
9561. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
9562. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
9563. 
9564. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
9565. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
9566. 
9567. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
9568. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
9569. 
9570. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
9571. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
9572. 
9573. 	SetVariable(ZoneFragments,				"!ZONE210N!")
9574. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
9575. 		
9576. # Current Gap, Actual and Free Values
9577. 	# Gap
9578. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
9579. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
9580. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
9581. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
9582. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
9583. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
9584. 	
9585. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
9586. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
9587. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
9588. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
9589. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
9590. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
9591. 	
9592. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
9593. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
9594. 	
9595. 	# Actual Size and End
9596. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
9597. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
9598. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
9599. 	
9600. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
9601. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
9602. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
9603. 
9604. # Gap Size & Rounding
9605. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
9606. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
9607. 	
9608. 	# Free Space
9609. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
9610. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
9611. 
9612. 	# Script: ZoneStatisticsReportGet
9613. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
9614. 
9615. # Footer:
9616. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
9617. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
9618. #
9619. # Xinclude "..\Commands\DateTimeLastLong.txt"X
9620. #
9621. # What a mess this word based vs is. Try a phrase based version ToDo
9622. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
9623. ------------------
9624.    !SizeWord!!ColonWord!  
9625.    ------------------------
9626.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9627.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9628.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9629. 
9630.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9631.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
9632. 
9633.    !LocationWord!!ColonWord!
9634.    ------------------------
9635.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9636.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
9637.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9638.       
9639.    !GapWordCaps! !SettingsWord!!ColonWord!
9640.    ------------------------
9641.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
9642.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
9643.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9644.                  
9645.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
9646.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
9647.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
9648.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
9649.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
9650.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
9651.      
9652.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
9653.    ------------------------
9654.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9655.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9656.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9657. 
9658. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
9659. ----------------------------------------------------------
9660. ")
9661. #
9662. SetVariable(DateNow, 	DATETIME)
9663. SetVariable(TimeNow, 	Time)
9664. SetVariable(RunTimeNow, 	RunTime)
9665. 
9666. 
9667. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
9668. 
9669. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
9670. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
9671. 
9672. 	# Script: DisplaySetWindowText
9673. # Zone Footer Set Statistics Window Text
9674. 
9675. SetStatisticsWindowText("!Heading!
9676. ----------------------------------------------------------
9677. Zones Processed: 
9678. ----------------------------------------------------------
9679. !ZoneListByLine!
9680. ----------------------------------------------------------
9681. Zone Processing Step:
9682. !ZoneStepByLine!    
9683. ----------------------------------------------------------
9684. ----------------------------------------------------------
9685. CURRENT ZONE:
9686. !ZoneStatisticsReport!
9687. ----------------------------------------------------------
9688. ----------------------------------------------------------
9689. ----------------------------------------------------------
9690. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
9691. ----------------------------------------------------------
9692. !VolumeStatisticsSummary!
9693. !VolumeStatisticsDetail!
9694. ----------------------------------------------------------
9695. ----------------------------------------------------------
9696. Zone Detailed Report:
9697. ----------------------------------------------------------
9698. !ZoneStatisticsDetail!
9699. ----------------------------------------------------------
9700. ")
9701. 
9702. 
9703. 	
9704. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
9705. 
9706. 
9707. 	SetVariable(ZoneStatisticsData, 
9708. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
9709.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
9710.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
9711. 
9712. 
9713. 
9714.  		# Script: ZoneStatisticsDisplay
9715. 	
9716. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
9717. !ZoneStatisticsData!
9718. ')
9719. 
9720. 		# Script: ZoneStatisticsAdd
9721. # Append Zone to Details of each zone.
9722. 		
9723. 	# Add Zone Details to Report.	
9724. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
9725. !ZoneStatisticsReport!
9726. ')
9727. 
9728. 	
9729. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
9730. 		# Script: DisplaySetZoneStep
9731. # Increment
9732. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9733. 
9734. # Display this zone step
9735. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
9736. ')
9737. 
9738. # Script: BannerSet
9739. 
9740. # NOTE: Can't round or truncate to integer precision. 
9741. # This internal fields like ZoneCount format really badly.
9742. #  for !RunTimeNow! does not work. None of the date functions do.
9743. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
9744. 
9745. SetVariable(HeadingTemp2,	ZoneCount + 0)
9746. 
9747. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9748. 
9749. Title('!Heading!')
9750. 
9751. /* pause(1) */
9752. 
9753. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9754. 
9755. 
9756. # Script: DisplaySetWindowText
9757. # Zone Footer Set Statistics Window Text
9758. 
9759. SetStatisticsWindowText("!Heading!
9760. ----------------------------------------------------------
9761. Zones Processed: 
9762. ----------------------------------------------------------
9763. !ZoneListByLine!
9764. ----------------------------------------------------------
9765. Zone Processing Step:
9766. !ZoneStepByLine!    
9767. ----------------------------------------------------------
9768. ----------------------------------------------------------
9769. CURRENT ZONE:
9770. !ZoneStatisticsReport!
9771. ----------------------------------------------------------
9772. ----------------------------------------------------------
9773. ----------------------------------------------------------
9774. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
9775. ----------------------------------------------------------
9776. !VolumeStatisticsSummary!
9777. !VolumeStatisticsDetail!
9778. ----------------------------------------------------------
9779. ----------------------------------------------------------
9780. Zone Detailed Report:
9781. ----------------------------------------------------------
9782. !ZoneStatisticsDetail!
9783. ----------------------------------------------------------
9784. ")
9785. 
9786. 
9787. 
9788. 
9789. 
9790. 		# File Action - Type Os Programs Fixed - Regular - MoveUpToZone.
9791. # File Action - ZoneDoActionSortByCreationDateFull
9792. 	SortByCreationDate(Ascending)
9793. 	
9794. 	
9795. 	
9796. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
9797. 		# Script: DisplaySetZoneStep
9798. # Increment
9799. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9800. 
9801. # Display this zone step
9802. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
9803. ')
9804. 
9805. # Script: BannerSet
9806. 
9807. # NOTE: Can't round or truncate to integer precision. 
9808. # This internal fields like ZoneCount format really badly.
9809. #  for !RunTimeNow! does not work. None of the date functions do.
9810. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
9811. 
9812. SetVariable(HeadingTemp2,	ZoneCount + 0)
9813. 
9814. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9815. 
9816. Title('!Heading!')
9817. 
9818. /* pause(1) */
9819. 
9820. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9821. 
9822. 
9823. # Script: DisplaySetWindowText
9824. # Zone Footer Set Statistics Window Text
9825. 
9826. SetStatisticsWindowText("!Heading!
9827. ----------------------------------------------------------
9828. Zones Processed: 
9829. ----------------------------------------------------------
9830. !ZoneListByLine!
9831. ----------------------------------------------------------
9832. Zone Processing Step:
9833. !ZoneStepByLine!    
9834. ----------------------------------------------------------
9835. ----------------------------------------------------------
9836. CURRENT ZONE:
9837. !ZoneStatisticsReport!
9838. ----------------------------------------------------------
9839. ----------------------------------------------------------
9840. ----------------------------------------------------------
9841. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
9842. ----------------------------------------------------------
9843. !VolumeStatisticsSummary!
9844. !VolumeStatisticsDetail!
9845. ----------------------------------------------------------
9846. ----------------------------------------------------------
9847. Zone Detailed Report:
9848. ----------------------------------------------------------
9849. !ZoneStatisticsDetail!
9850. ----------------------------------------------------------
9851. ")
9852. 
9853. 
9854. 
9855. 
9856. 	# Script: ZoneDoFooter
9857. 
9858. /* --------------------------------- */
9859. 	# File Select
9860. 		# Select Statments
9861. 	# File Actions 
9862. 		# Standard or OS File Actions.
9863. 		# Resume...
9864. 	
9865. 		# your stuff HERE (X)... post zone (file) file actions code.
9866. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
9867. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
9868. 			# (X)
9869. 		
9870. 			/* ??? Set window? */
9871. 	
9872. 		# ADD THE GAP
9873. 		# Script: GapZoneCommand
9874. # Vacate (good for diagnostics)
9875. # DoNotVacate - DO NOT Vacate (recommended)
9876. 
9877. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
9878. # Script: DisplaySetZoneStep
9879. # Increment
9880. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9881. 
9882. # Display this zone step
9883. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
9884. ')
9885. 
9886. # Script: BannerSet
9887. 
9888. # NOTE: Can't round or truncate to integer precision. 
9889. # This internal fields like ZoneCount format really badly.
9890. #  for !RunTimeNow! does not work. None of the date functions do.
9891. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
9892. 
9893. SetVariable(HeadingTemp2,	ZoneCount + 0)
9894. 
9895. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9896. 
9897. Title('!Heading!')
9898. 
9899. /* pause(1) */
9900. 
9901. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9902. 
9903. 
9904. # Script: DisplaySetWindowText
9905. # Zone Footer Set Statistics Window Text
9906. 
9907. SetStatisticsWindowText("!Heading!
9908. ----------------------------------------------------------
9909. Zones Processed: 
9910. ----------------------------------------------------------
9911. !ZoneListByLine!
9912. ----------------------------------------------------------
9913. Zone Processing Step:
9914. !ZoneStepByLine!    
9915. ----------------------------------------------------------
9916. ----------------------------------------------------------
9917. CURRENT ZONE:
9918. !ZoneStatisticsReport!
9919. ----------------------------------------------------------
9920. ----------------------------------------------------------
9921. ----------------------------------------------------------
9922. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
9923. ----------------------------------------------------------
9924. !VolumeStatisticsSummary!
9925. !VolumeStatisticsDetail!
9926. ----------------------------------------------------------
9927. ----------------------------------------------------------
9928. Zone Detailed Report:
9929. ----------------------------------------------------------
9930. !ZoneStatisticsDetail!
9931. ----------------------------------------------------------
9932. ")
9933. 
9934. 
9935. 
9936. 
9937. # *** Moved to setting yours *** 
9938. # (to avoid doing it twice)
9939. # (ie the later wouldn't "overwrite" the former in the usual manner)
9940. 
9941. # Do one or the other:
9942. # DoNotVacate - DO NOT Vacate (recommended)
9943. 
9944. # Vacate
9945. /* AddGap(GapUsedLoc) */
9946. 
9947. # DO Not Vacate
9948. AddGap(GapUsedLoc, DoNotVacate) 
9949. 	
9950. 	
9951. 
9952. # Controlled via settings commands
9953. 
9954. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
9955. 
9956. # Vacate /* AddGap(GapUsed) */
9957. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
9958. 	
9959. 
9960. 		
9961. 	# 
9962. 	FileEnd
9963. /* --------------------------------- */
9964. # your stuff HERE (X)... post zone (file) code.
9965. 
9966. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
9967. # Script: DisplaySetZoneStep
9968. # Increment
9969. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9970. 
9971. # Display this zone step
9972. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
9973. ')
9974. 
9975. # Script: BannerSet
9976. 
9977. # NOTE: Can't round or truncate to integer precision. 
9978. # This internal fields like ZoneCount format really badly.
9979. #  for !RunTimeNow! does not work. None of the date functions do.
9980. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
9981. 
9982. SetVariable(HeadingTemp2,	ZoneCount + 0)
9983. 
9984. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9985. 
9986. Title('!Heading!')
9987. 
9988. /* pause(1) */
9989. 
9990. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
9991. 
9992. 
9993. # Script: DisplaySetWindowText
9994. # Zone Footer Set Statistics Window Text
9995. 
9996. SetStatisticsWindowText("!Heading!
9997. ----------------------------------------------------------
9998. Zones Processed: 
9999. ----------------------------------------------------------
10000. !ZoneListByLine!
10001. ----------------------------------------------------------
10002. Zone Processing Step:
10003. !ZoneStepByLine!    
10004. ----------------------------------------------------------
10005. ----------------------------------------------------------
10006. CURRENT ZONE:
10007. !ZoneStatisticsReport!
10008. ----------------------------------------------------------
10009. ----------------------------------------------------------
10010. ----------------------------------------------------------
10011. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
10012. ----------------------------------------------------------
10013. !VolumeStatisticsSummary!
10014. !VolumeStatisticsDetail!
10015. ----------------------------------------------------------
10016. ----------------------------------------------------------
10017. Zone Detailed Report:
10018. ----------------------------------------------------------
10019. !ZoneStatisticsDetail!
10020. ----------------------------------------------------------
10021. ")
10022. 
10023. 
10024. 
10025. 
10026. # Script: ZoneWhenFinished
10027. 
10028. # Add the zone to the zone details log:
10029. # This is temporarily disable until logging is fixed
10030. # It is performed during file action to preserve the correct (original) calculations.
10031. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
10032. 
10033. # Add the Select and ZoneSteps to the Zone
10034. # Script: ZoneStatisticsAdd
10035. # Append Zone to Details of each zone.
10036. 		
10037. 	# Add Zone Details to Report.	
10038. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
10039. ----------------------------------------------------------
10040. !ZoneStepByLine!
10041. ---------------------------
10042. !ZoneTypeSelectCurrent!               
10043. ---------------------------
10044. ----------------------------------------------------------
10045. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
10046. ----------------------------------------------------------
10047. ')
10048. 
10049. 
10050. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
10051. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
10052. # 2021-12-14 15:29:59
10053. RunProgram("..\Commands\WriteDateTime.bat LastZone")
10054. # Append Datetime to logs
10055. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
10056. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
10057. 
10058. AppendLogfile("!LogFileName!", "!PeriodWord!")
10059. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
10060. AppendLogfile("!LogFileName!", "!PeriodWord!")
10061. 
10062. # Script: DisplaySetWindowText
10063. # Zone Footer Set Statistics Window Text
10064. 
10065. SetStatisticsWindowText("!Heading!
10066. ----------------------------------------------------------
10067. Zones Processed: 
10068. ----------------------------------------------------------
10069. !ZoneListByLine!
10070. ----------------------------------------------------------
10071. Zone Processing Step:
10072. !ZoneStepByLine!    
10073. ----------------------------------------------------------
10074. ----------------------------------------------------------
10075. CURRENT ZONE:
10076. !ZoneStatisticsReport!
10077. ----------------------------------------------------------
10078. ----------------------------------------------------------
10079. ----------------------------------------------------------
10080. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
10081. ----------------------------------------------------------
10082. !VolumeStatisticsSummary!
10083. !VolumeStatisticsDetail!
10084. ----------------------------------------------------------
10085. ----------------------------------------------------------
10086. Zone Detailed Report:
10087. ----------------------------------------------------------
10088. !ZoneStatisticsDetail!
10089. ----------------------------------------------------------
10090. ")
10091. 
10092. 
10093. 
10094. /* pause() */
10095. /* pause() */
10096. 
10097. 
10098. 
10099. /* ------------------------- */
10100. 
10101. 	
10102. /* ------------------------- */
10103. # Zone Programs Fixed size just Windows.  - Zone 2 (6)
10104. 	# Script: DisplayColors - Zone Dark
10105. # Processed
10106. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
10107. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
10108. 
10109. # Light Green and Yellow
10110. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
10111. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
10112. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
10113. 
10114. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsWindows!")
10115. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsWindows!")
10116. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramsWindows!")
10117. 	SetVariable(ZoneGapSize, 			"!ZoneGapSizeProgramsWindows!")
10118. 	SetVariable(ZoneTypeSelect,'
10119. Programs Windows folder:
10120. # Script: ZoneDo ZoneTypeSelectOsPrograms
10121. # Programs start.
10122. # Mark: 1
10123. # NotBlobsArchivesBu start.
10124. # NOT!
10125. (not (
10126. # Blobs start.
10127. (
10128. # BlobsAndExceptions start.
10129. ( not(
10130.   FileName("*.bat")
10131.   or FileName("*.css")
10132.   or FileName("*.dll")
10133.   or FileName("*.exe")
10134.   or FileName("*.htm*")
10135.   or FileName("*.jar")
10136.   or FileName("*.js")
10137.   or FileName("*.script")
10138.   or FileName("*.wsf")
10139.   or (
10140. # Databases start.
10141. (
10142.   FileName("*.crypt*")
10143.   or FileName("*.db*")
10144.   or FileName("*.rdb*")
10145.   or FileName("*.dc*")
10146.   or FileName("*.dict*")
10147.   or FileName("*.?db*")
10148.   or FileName("*.?rdb*")
10149.   or FileName("*.md*")
10150.   or FileName("*.myd")
10151.   or FileName("*.ndf")
10152.   or FileName("*.ns?")
10153.   or FileName("*.pab")
10154.   or FileName("*.pst")
10155.   or FileName("*.sd?*")
10156.   or FileName("*.sq**")
10157.   or FileName("*.tmd")
10158.   or FileName("*.tps")
10159.   or FileName("*.tr*")
10160. )
10161. # Databases end.
10162. 
10163.     # BlobsAndExceptions
10164.     or 
10165. # Data start.
10166. (
10167.   DirectoryName("Data*")
10168.   or DirectoryName("Device*")
10169.   or DirectoryName("Export*")
10170.   or DirectoryName("Import*")
10171.   or DirectoryName("Log*")
10172.   or DirectoryName("*Log")
10173.   or DirectoryName("Maintenance*")
10174.   or DirectoryName("Rec*")
10175.   or DirectoryName("Sales*")
10176.   or DirectoryName("Search*")
10177.   or DirectoryName("User*")
10178. )
10179. # Data end.
10180. 
10181.     # BlobsAndExceptions
10182.   )
10183. ) )
10184. # BlobsAndExceptions end.
10185. 
10186. # Blobs
10187. ) and (
10188.   Size(BlobFileSize,0)
10189.   or (
10190.     FileName("*.arj")
10191.     or FileName("*.bup")
10192.     or FileName("*.bz2")
10193.     or FileName("*.chm")
10194.     or FileName("*.dvr-ms")
10195.     or FileName("*.gz")
10196.     or FileName("*.ifo")
10197.     or FileName("*.lzh")
10198.     or FileName("*.pdf")
10199.     or FileName("*.rpm")
10200.     or FileName("*.wmv")
10201.     or FileName("*.vob")
10202.     or FileName("*.z")
10203.   ) 
10204. )
10205. # Blobs end.
10206. 
10207. # NotBlobsArchivesBu
10208. or 
10209. # Archives start.
10210. (
10211.   DirectoryName("*Archive*")
10212.   or DirectoryName("*History*")
10213.   or DirectoryName("*Old")
10214.   or DirectoryName("* Old *")
10215.   or DirectoryName("Old *")
10216. 
10217.   or FileName("*.7z")
10218.   or FileName("*.cab")
10219.   or FileName("*.iso")
10220.   or FileName("*.msi")
10221.   or FileName("*.old")
10222.   or FileName("*.rar")
10223.   or FileName("*.tar")
10224.   or FileName("*.zip")
10225.   or
10226. # WinSysLow start.
10227. (
10228.   # Bad idea. This pushed lots of programs and data to archive.
10229.   # DirectoryName("$*")
10230.   # or DirectoryName("0*")
10231.   # or DirectoryName("1*")
10232.   # or DirectoryName("2*")
10233.   # or DirectoryName("3*")
10234.   # or DirectoryName("4*")
10235.   # or DirectoryName("5*")
10236.   # or DirectoryName("6*")
10237.   # or DirectoryName("7*")
10238.   # or DirectoryName("8*")
10239.   # or DirectoryName("9*")
10240.   # or 
10241.   DirectoryName("dllcache")
10242.   or DirectoryName("Downloaded Installations")
10243.   or DirectoryName("Ehome")
10244.   or DirectoryName("Fonts")
10245.   or DirectoryName("Help")
10246.   or DirectoryName("I386")
10247.   or DirectoryName("ie?updates")
10248.   or DirectoryName("Installer")
10249.   or DirectoryName("Installshield Installation Information")
10250.   or DirectoryName("IME")
10251.   or DirectoryName("*RECYCLE*")
10252.   or DirectoryName("ServicePackFiles")
10253.   or DirectoryName("SoftwareDistribution")
10254.   or DirectoryName("Speech")
10255.   or DirectoryName("Symbols")
10256.   or DirectoryName("System Volume Information")
10257.   or DirectoryName("windows.old")
10258. )
10259. # WinSysLow end.
10260. 
10261.   # Archives
10262. )
10263. # Archives end.
10264. 
10265. # NotBlobsArchivesBu
10266. or
10267. # Backups start.
10268. (
10269.   DirectoryName("*Backup*")
10270.   or DirectoryName("*Bu")
10271.   or DirectoryName("* Bu *")
10272.   or DirectoryName("Bu *")
10273. 
10274.   or FileName("*.bak")
10275.   or FileName("* - Copy*")
10276. )
10277. # Backups end.
10278. 
10279. or 
10280. FileName("ReferenceMarker.MyDx")
10281. # NotBlobsArchivesBu
10282. ) )
10283. # NotBlobsArchivesBu end.
10284. 
10285. # Mark: 2
10286. # Programs
10287. and (
10288. # Mark: 3
10289. # SystemDir start.
10290. (
10291.   DirectoryName("Boot*")
10292.   or DirectoryName("Device*")
10293.   or DirectoryName("DevSupport*")
10294.   or DirectoryName("Program*")
10295.   or DirectoryName("Security*")
10296.   or DirectoryName("SendTo*")
10297.   or DirectoryName("Sw*")
10298.   or DirectoryName("System*")
10299.   or DirectoryName("Toolbars")
10300.   or DirectoryName("Windows*")
10301. )
10302. # SystemDir end.
10303. 
10304. # Mark: 4
10305. # Programs
10306. )
10307. # Programs end.
10308. 
10309. and not(
10310. 	# Script: ZoneDo ZoneTypeSelectOsDataDynamic
10311. # Os Data Dynamic start.
10312. (
10313. # Os Data Dynamic start.
10314. (
10315.   FileName("*.dat*")
10316.   or FileName("*.db*")
10317.   or FileName("*.edb*")
10318.   or FileName("*.log*")
10319.   or FileName("DataStore.edb")
10320. )
10321. # Os Data Dynamic end.
10322. 
10323.   or 
10324. # Os PageHiberDump start.
10325. (
10326.   FileName("DataStore.edb")
10327.   or FileName("DUMP*.*")
10328.   or FileName("Hiberfil.sys")
10329.   or FileName("MEMORY.DMP")
10330.   or FileName("Pagefile.sys")
10331. )
10332. # Os PageHiberDump end.
10333. 
10334. # Os Data Dynamic
10335. )
10336. # Os Data Dynamic end.
10337. 
10338. )
10339. ')
10340. 
10341. 	SetVariable(ZoneNoCurrentAdjust, ZoneNoCurrentAdjust + 1)
10342. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
10343. 
10344. SetVariable(ZoneStepNoCurrent, 0)
10345. 
10346. 	/* ------------------------- */
10347. # Script: ZoneDoHeader
10348. 
10349. # Script: ZoneWhenStarted
10350. RunProgram("..\Commands\WriteDateTime.bat")
10351. 
10352. # Script: ZoneDoCurrentClear
10353. 
10354. SetVariable(ZoneTypeSelectCurrent, 		"")
10355. SetVariable(ZoneStatisticsData, 		"")
10356. SetVariable(ZoneStepByLine, 			"")
10357. 
10358. SetVariable(ZoneBeginCurrent, 			0)
10359. SetVariable(ZoneBeginPerCurrent, 		0)
10360. SetVariable(ZoneEndCurrent, 			0)
10361. SetVariable(ZoneEndPerCurrent, 			0)
10362. 
10363. SetVariable(ZoneSizeCurrent,			0)
10364. SetVariable(ZoneSizePerCurrent,			0)
10365. 
10366. SetVariable(ZoneGapRequestedCurrent,	0)
10367. SetVariable(ZoneGapRoundedCurrent, 		0)
10368. SetVariable(ZoneGapAdjustedCurrent, 	0)
10369. SetVariable(ZoneGapAvailableCurrent, 	0)
10370. SetVariable(ZoneGapCurrent,				0)
10371. SetVariable(ZoneGapUsedCurrent, 		0)
10372. 
10373. SetVariable(ZoneGapActualCurrent, 		0)
10374. SetVariable(ZoneGapActualPerCurrent, 	0)
10375. 
10376. SetVariable(ZoneSizeActual, 			0)
10377. SetVariable(ZoneSizeActualCurrent,		0)
10378. 
10379. SetVariable(ZoneEndActual, 				0)
10380. SetVariable(ZoneEndActualCurrent,		0)			
10381. SetVariable(ZoneSizeActualPerCurrent, 	0)
10382.       
10383. SetVariable(ZoneFilesFolders,			0)
10384. SetVariable(ZoneFilesFoldersPer,		0) 
10385. 
10386. SetVariable(ZoneFragments,				0)
10387. SetVariable(ZoneFragmentsPer,			0) 
10388. 		
10389. SetVariable(ZoneEndActualCurrent, 		0)
10390. SetVariable(ZoneEndActualPerCurrent, 	0)
10391. 
10392. # Gap Calculation Methodology:
10393. 	# Requested
10394. 	SetVariable(GapRequested, 			0) 
10395. 	SetVariable(GapRequestedStd, 		0) 
10396. 	SetVariable(GapRequestedMft, 		0) 
10397. 	SetVariable(GapRequestedOs, 		0) 
10398. 	SetVariable(GapRequestedOriginal, 	0) 
10399. 	
10400. 	# Gap Adjustments
10401. 	SetVariable(GapRounded, 			0)
10402. 	# SetVariable(GapAdjusted, 			0)
10403. 	SetVariable(GapAvailable, 			0)
10404. 	SetVariable(GapCurrent, 			0)
10405. 	SetVariable(GapActual, 				0)
10406. 	SetVariable(GapUsed, 				0)
10407. 	
10408. 	# Gap Adjustments
10409. 	SetVariable(GapRoundedLoc, 			0)
10410. 	# SetVariable(GapAdjustedLoc, 		0)
10411. 	SetVariable(GapAvailableLoc, 		0)
10412. 	SetVariable(GapCurrentLoc, 			0)
10413. 	SetVariable(GapActualLoc,			0)
10414. 	SetVariable(GapUsedLoc,				0)
10415. 	
10416. 	# Space usage
10417. 	SetVariable(ZoneFreePerRequested, 	0)
10418. 	SetVariable(ZoneFreePerUsed, 		0)
10419. 
10420. # Gap Size & Rounding
10421. 	SetVariable(ZoneGapSizePer, 		0)
10422. 	SetVariable(ZoneVolRoundUpPer, 		0)
10423. 	
10424. 	# Free Space
10425. 	SetVariable(ZoneFreeUsedPer, 		0)
10426. 	SetVariable(ZoneFreeRequestedPer, 	0)
10427. 
10428. # Script: DisplaySetZone
10429. 
10430. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
10431. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
10432. 
10433. # Message ZoneSummary
10434. # SetVariable(ZoneSummary, '
10435. # Zone Summary:
10436. # ')
10437. # Zone processing steps
10438. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
10439. # ')
10440. 
10441. # # Script: BannerDescriptionSet
10442. 
10443. # Script: BannerSet
10444. 
10445. # NOTE: Can't round or truncate to integer precision. 
10446. # This internal fields like ZoneCount format really badly.
10447. #  for !RunTimeNow! does not work. None of the date functions do.
10448. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10449. 
10450. SetVariable(HeadingTemp2,	ZoneCount + 0)
10451. 
10452. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10453. 
10454. Title('!Heading!')
10455. 
10456. /* pause(1) */
10457. 
10458. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10459. 
10460. 
10461. # Script: BannerLog
10462. 
10463. AppendLogfile("!LogFileName!", "!Heading!")
10464. 
10465. 
10466. 
10467. # pause(1)
10468. 
10469. 
10470. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
10471. # Script: DisplaySetZoneStep
10472. # Increment
10473. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10474. 
10475. # Display this zone step
10476. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
10477. ')
10478. 
10479. # Script: BannerSet
10480. 
10481. # NOTE: Can't round or truncate to integer precision. 
10482. # This internal fields like ZoneCount format really badly.
10483. #  for !RunTimeNow! does not work. None of the date functions do.
10484. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10485. 
10486. SetVariable(HeadingTemp2,	ZoneCount + 0)
10487. 
10488. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10489. 
10490. Title('!Heading!')
10491. 
10492. /* pause(1) */
10493. 
10494. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10495. 
10496. 
10497. # Script: DisplaySetWindowText
10498. # Zone Footer Set Statistics Window Text
10499. 
10500. SetStatisticsWindowText("!Heading!
10501. ----------------------------------------------------------
10502. Zones Processed: 
10503. ----------------------------------------------------------
10504. !ZoneListByLine!
10505. ----------------------------------------------------------
10506. Zone Processing Step:
10507. !ZoneStepByLine!    
10508. ----------------------------------------------------------
10509. ----------------------------------------------------------
10510. CURRENT ZONE:
10511. !ZoneStatisticsReport!
10512. ----------------------------------------------------------
10513. ----------------------------------------------------------
10514. ----------------------------------------------------------
10515. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
10516. ----------------------------------------------------------
10517. !VolumeStatisticsSummary!
10518. !VolumeStatisticsDetail!
10519. ----------------------------------------------------------
10520. ----------------------------------------------------------
10521. Zone Detailed Report:
10522. ----------------------------------------------------------
10523. !ZoneStatisticsDetail!
10524. ----------------------------------------------------------
10525. ")
10526. 
10527. 
10528. 
10529. 
10530. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
10531. 
10532. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
10533. # Script: DisplaySetZoneStep
10534. # Increment
10535. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10536. 
10537. # Display this zone step
10538. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
10539. ')
10540. 
10541. # Script: BannerSet
10542. 
10543. # NOTE: Can't round or truncate to integer precision. 
10544. # This internal fields like ZoneCount format really badly.
10545. #  for !RunTimeNow! does not work. None of the date functions do.
10546. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10547. 
10548. SetVariable(HeadingTemp2,	ZoneCount + 0)
10549. 
10550. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10551. 
10552. Title('!Heading!')
10553. 
10554. /* pause(1) */
10555. 
10556. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10557. 
10558. 
10559. # Script: DisplaySetWindowText
10560. # Zone Footer Set Statistics Window Text
10561. 
10562. SetStatisticsWindowText("!Heading!
10563. ----------------------------------------------------------
10564. Zones Processed: 
10565. ----------------------------------------------------------
10566. !ZoneListByLine!
10567. ----------------------------------------------------------
10568. Zone Processing Step:
10569. !ZoneStepByLine!    
10570. ----------------------------------------------------------
10571. ----------------------------------------------------------
10572. CURRENT ZONE:
10573. !ZoneStatisticsReport!
10574. ----------------------------------------------------------
10575. ----------------------------------------------------------
10576. ----------------------------------------------------------
10577. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
10578. ----------------------------------------------------------
10579. !VolumeStatisticsSummary!
10580. !VolumeStatisticsDetail!
10581. ----------------------------------------------------------
10582. ----------------------------------------------------------
10583. Zone Detailed Report:
10584. ----------------------------------------------------------
10585. !ZoneStatisticsDetail!
10586. ----------------------------------------------------------
10587. ")
10588. 
10589. 
10590. 
10591. 
10592. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
10593. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
10594. 
10595. # Script: BannerSet
10596. 
10597. # NOTE: Can't round or truncate to integer precision. 
10598. # This internal fields like ZoneCount format really badly.
10599. #  for !RunTimeNow! does not work. None of the date functions do.
10600. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10601. 
10602. SetVariable(HeadingTemp2,	ZoneCount + 0)
10603. 
10604. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10605. 
10606. Title('!Heading!')
10607. 
10608. /* pause(1) */
10609. 
10610. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10611. 
10612. 
10613. # Script: BannerLog
10614. 
10615. AppendLogfile("!LogFileName!", "!Heading!")
10616. 
10617. 
10618. 
10619. # LOGGING:
10620. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
10621. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
10622. 
10623. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
10624. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:29:59")
10625. # 2021-12-14 15:29:59 
10626. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:04 !ZoneLabel! !ZoneDescription!")
10627. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
10628. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:04 !ZoneLabel! !ZoneDescription!")
10629. 
10630. 
10631. # Add zone to list of zones:
10632. SetVariable(ZoneListByLine, "!ZoneListByLine!
10633. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
10634. # Script: DisplaySetWindowText
10635. # Zone Footer Set Statistics Window Text
10636. 
10637. SetStatisticsWindowText("!Heading!
10638. ----------------------------------------------------------
10639. Zones Processed: 
10640. ----------------------------------------------------------
10641. !ZoneListByLine!
10642. ----------------------------------------------------------
10643. Zone Processing Step:
10644. !ZoneStepByLine!    
10645. ----------------------------------------------------------
10646. ----------------------------------------------------------
10647. CURRENT ZONE:
10648. !ZoneStatisticsReport!
10649. ----------------------------------------------------------
10650. ----------------------------------------------------------
10651. ----------------------------------------------------------
10652. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
10653. ----------------------------------------------------------
10654. !VolumeStatisticsSummary!
10655. !VolumeStatisticsDetail!
10656. ----------------------------------------------------------
10657. ----------------------------------------------------------
10658. Zone Detailed Report:
10659. ----------------------------------------------------------
10660. !ZoneStatisticsDetail!
10661. ----------------------------------------------------------
10662. ")
10663. 
10664. 
10665. 
10666. 
10667. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
10668. # Script: DisplaySetZoneStep
10669. # Increment
10670. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10671. 
10672. # Display this zone step
10673. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
10674. ')
10675. 
10676. # Script: BannerSet
10677. 
10678. # NOTE: Can't round or truncate to integer precision. 
10679. # This internal fields like ZoneCount format really badly.
10680. #  for !RunTimeNow! does not work. None of the date functions do.
10681. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10682. 
10683. SetVariable(HeadingTemp2,	ZoneCount + 0)
10684. 
10685. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10686. 
10687. Title('!Heading!')
10688. 
10689. /* pause(1) */
10690. 
10691. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10692. 
10693. 
10694. # Script: DisplaySetWindowText
10695. # Zone Footer Set Statistics Window Text
10696. 
10697. SetStatisticsWindowText("!Heading!
10698. ----------------------------------------------------------
10699. Zones Processed: 
10700. ----------------------------------------------------------
10701. !ZoneListByLine!
10702. ----------------------------------------------------------
10703. Zone Processing Step:
10704. !ZoneStepByLine!    
10705. ----------------------------------------------------------
10706. ----------------------------------------------------------
10707. CURRENT ZONE:
10708. !ZoneStatisticsReport!
10709. ----------------------------------------------------------
10710. ----------------------------------------------------------
10711. ----------------------------------------------------------
10712. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
10713. ----------------------------------------------------------
10714. !VolumeStatisticsSummary!
10715. !VolumeStatisticsDetail!
10716. ----------------------------------------------------------
10717. ----------------------------------------------------------
10718. Zone Detailed Report:
10719. ----------------------------------------------------------
10720. !ZoneStatisticsDetail!
10721. ----------------------------------------------------------
10722. ")
10723. 
10724. 
10725. 
10726. 
10727. # your stuff HERE (X)... pre file select code.
10728. 
10729. /* --------------------------------- */
10730. 	FileSelect
10731. 
10732. 		# your stuff can't really go here (errors.)
10733. 		# maybe for some reason I don't know of...
10734. 	
10735. 		# Actions next...
10736. 	# Script: ZoneDo ZoneTypeSelectOsPrograms
10737. # Programs start.
10738. # Mark: 1
10739. # NotBlobsArchivesBu start.
10740. # NOT!
10741. (not (
10742. # Blobs start.
10743. (
10744. # BlobsAndExceptions start.
10745. ( not(
10746.   FileName("*.bat")
10747.   or FileName("*.css")
10748.   or FileName("*.dll")
10749.   or FileName("*.exe")
10750.   or FileName("*.htm*")
10751.   or FileName("*.jar")
10752.   or FileName("*.js")
10753.   or FileName("*.script")
10754.   or FileName("*.wsf")
10755.   or (
10756. # Databases start.
10757. (
10758.   FileName("*.crypt*")
10759.   or FileName("*.db*")
10760.   or FileName("*.rdb*")
10761.   or FileName("*.dc*")
10762.   or FileName("*.dict*")
10763.   or FileName("*.?db*")
10764.   or FileName("*.?rdb*")
10765.   or FileName("*.md*")
10766.   or FileName("*.myd")
10767.   or FileName("*.ndf")
10768.   or FileName("*.ns?")
10769.   or FileName("*.pab")
10770.   or FileName("*.pst")
10771.   or FileName("*.sd?*")
10772.   or FileName("*.sq**")
10773.   or FileName("*.tmd")
10774.   or FileName("*.tps")
10775.   or FileName("*.tr*")
10776. )
10777. # Databases end.
10778. 
10779.     # BlobsAndExceptions
10780.     or 
10781. # Data start.
10782. (
10783.   DirectoryName("Data*")
10784.   or DirectoryName("Device*")
10785.   or DirectoryName("Export*")
10786.   or DirectoryName("Import*")
10787.   or DirectoryName("Log*")
10788.   or DirectoryName("*Log")
10789.   or DirectoryName("Maintenance*")
10790.   or DirectoryName("Rec*")
10791.   or DirectoryName("Sales*")
10792.   or DirectoryName("Search*")
10793.   or DirectoryName("User*")
10794. )
10795. # Data end.
10796. 
10797.     # BlobsAndExceptions
10798.   )
10799. ) )
10800. # BlobsAndExceptions end.
10801. 
10802. # Blobs
10803. ) and (
10804.   Size(BlobFileSize,0)
10805.   or (
10806.     FileName("*.arj")
10807.     or FileName("*.bup")
10808.     or FileName("*.bz2")
10809.     or FileName("*.chm")
10810.     or FileName("*.dvr-ms")
10811.     or FileName("*.gz")
10812.     or FileName("*.ifo")
10813.     or FileName("*.lzh")
10814.     or FileName("*.pdf")
10815.     or FileName("*.rpm")
10816.     or FileName("*.wmv")
10817.     or FileName("*.vob")
10818.     or FileName("*.z")
10819.   ) 
10820. )
10821. # Blobs end.
10822. 
10823. # NotBlobsArchivesBu
10824. or 
10825. # Archives start.
10826. (
10827.   DirectoryName("*Archive*")
10828.   or DirectoryName("*History*")
10829.   or DirectoryName("*Old")
10830.   or DirectoryName("* Old *")
10831.   or DirectoryName("Old *")
10832. 
10833.   or FileName("*.7z")
10834.   or FileName("*.cab")
10835.   or FileName("*.iso")
10836.   or FileName("*.msi")
10837.   or FileName("*.old")
10838.   or FileName("*.rar")
10839.   or FileName("*.tar")
10840.   or FileName("*.zip")
10841.   or
10842. # WinSysLow start.
10843. (
10844.   # Bad idea. This pushed lots of programs and data to archive.
10845.   # DirectoryName("$*")
10846.   # or DirectoryName("0*")
10847.   # or DirectoryName("1*")
10848.   # or DirectoryName("2*")
10849.   # or DirectoryName("3*")
10850.   # or DirectoryName("4*")
10851.   # or DirectoryName("5*")
10852.   # or DirectoryName("6*")
10853.   # or DirectoryName("7*")
10854.   # or DirectoryName("8*")
10855.   # or DirectoryName("9*")
10856.   # or 
10857.   DirectoryName("dllcache")
10858.   or DirectoryName("Downloaded Installations")
10859.   or DirectoryName("Ehome")
10860.   or DirectoryName("Fonts")
10861.   or DirectoryName("Help")
10862.   or DirectoryName("I386")
10863.   or DirectoryName("ie?updates")
10864.   or DirectoryName("Installer")
10865.   or DirectoryName("Installshield Installation Information")
10866.   or DirectoryName("IME")
10867.   or DirectoryName("*RECYCLE*")
10868.   or DirectoryName("ServicePackFiles")
10869.   or DirectoryName("SoftwareDistribution")
10870.   or DirectoryName("Speech")
10871.   or DirectoryName("Symbols")
10872.   or DirectoryName("System Volume Information")
10873.   or DirectoryName("windows.old")
10874. )
10875. # WinSysLow end.
10876. 
10877.   # Archives
10878. )
10879. # Archives end.
10880. 
10881. # NotBlobsArchivesBu
10882. or
10883. # Backups start.
10884. (
10885.   DirectoryName("*Backup*")
10886.   or DirectoryName("*Bu")
10887.   or DirectoryName("* Bu *")
10888.   or DirectoryName("Bu *")
10889. 
10890.   or FileName("*.bak")
10891.   or FileName("* - Copy*")
10892. )
10893. # Backups end.
10894. 
10895. or 
10896. FileName("ReferenceMarker.MyDx")
10897. # NotBlobsArchivesBu
10898. ) )
10899. # NotBlobsArchivesBu end.
10900. 
10901. # Mark: 2
10902. # Programs
10903. and (
10904. # Mark: 3
10905. # SystemDir start.
10906. (
10907.   DirectoryName("Boot*")
10908.   or DirectoryName("Device*")
10909.   or DirectoryName("DevSupport*")
10910.   or DirectoryName("Program*")
10911.   or DirectoryName("Security*")
10912.   or DirectoryName("SendTo*")
10913.   or DirectoryName("Sw*")
10914.   or DirectoryName("System*")
10915.   or DirectoryName("Toolbars")
10916.   or DirectoryName("Windows*")
10917. )
10918. # SystemDir end.
10919. 
10920. # Mark: 4
10921. # Programs
10922. )
10923. # Programs end.
10924. 
10925. 	and not(
10926. 		# Script: ZoneDo ZoneTypeSelectOsDataDynamic
10927. # Os Data Dynamic start.
10928. (
10929. # Os Data Dynamic start.
10930. (
10931.   FileName("*.dat*")
10932.   or FileName("*.db*")
10933.   or FileName("*.edb*")
10934.   or FileName("*.log*")
10935.   or FileName("DataStore.edb")
10936. )
10937. # Os Data Dynamic end.
10938. 
10939.   or 
10940. # Os PageHiberDump start.
10941. (
10942.   FileName("DataStore.edb")
10943.   or FileName("DUMP*.*")
10944.   or FileName("Hiberfil.sys")
10945.   or FileName("MEMORY.DMP")
10946.   or FileName("Pagefile.sys")
10947. )
10948. # Os PageHiberDump end.
10949. 
10950. # Os Data Dynamic
10951. )
10952. # Os Data Dynamic end.
10953. 
10954. 	)
10955. 
10956. 	FileActions
10957. 
10958. 			# Script: GapZoneCalc
10959. 	# Gap
10960. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
10961. 		# Script: DisplaySetZoneStep
10962. # Increment
10963. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10964. 
10965. # Display this zone step
10966. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
10967. ')
10968. 
10969. # Script: BannerSet
10970. 
10971. # NOTE: Can't round or truncate to integer precision. 
10972. # This internal fields like ZoneCount format really badly.
10973. #  for !RunTimeNow! does not work. None of the date functions do.
10974. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10975. 
10976. SetVariable(HeadingTemp2,	ZoneCount + 0)
10977. 
10978. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10979. 
10980. Title('!Heading!')
10981. 
10982. /* pause(1) */
10983. 
10984. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
10985. 
10986. 
10987. # Script: DisplaySetWindowText
10988. # Zone Footer Set Statistics Window Text
10989. 
10990. SetStatisticsWindowText("!Heading!
10991. ----------------------------------------------------------
10992. Zones Processed: 
10993. ----------------------------------------------------------
10994. !ZoneListByLine!
10995. ----------------------------------------------------------
10996. Zone Processing Step:
10997. !ZoneStepByLine!    
10998. ----------------------------------------------------------
10999. ----------------------------------------------------------
11000. CURRENT ZONE:
11001. !ZoneStatisticsReport!
11002. ----------------------------------------------------------
11003. ----------------------------------------------------------
11004. ----------------------------------------------------------
11005. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
11006. ----------------------------------------------------------
11007. !VolumeStatisticsSummary!
11008. !VolumeStatisticsDetail!
11009. ----------------------------------------------------------
11010. ----------------------------------------------------------
11011. Zone Detailed Report:
11012. ----------------------------------------------------------
11013. !ZoneStatisticsDetail!
11014. ----------------------------------------------------------
11015. ")
11016. 
11017. 
11018. 
11019. 	
11020. 	# ACTUAL GAP
11021. 		/* AddGap Variant. */
11022. 	  	# Script: GapZoneSet
11023. # Zone Do Gap
11024. # Gap Calculation Methods:
11025. 
11026. /* 1) Anything you need to add first. */
11027. /* empty */
11028. 
11029. /* ------------------------- */
11030. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
11031. 	# GapRequestedStd.
11032. 
11033. 		/* ------------------------- */
11034. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
11035. 
11036. 		# Gap Calculation Methods:
11037. 
11038. /* AddGap Variants */
11039. 
11040. 	/* Standard */
11041. 		# Gap Calculation Methods:
11042. 	/* AddGap Variants */
11043. 	/* Standard */
11044. 
11045. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
11046. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
11047. 
11048. 	SetVariable(GapRequested, GapRequestedStd)
11049. 	
11050. 
11051. 	/* MFT Low High Method */
11052. 		# Gap Calculation Methods:
11053. 	/* AddGap Variants */
11054. 	/* MFT Low High Method */
11055. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
11056. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
11057. 	SetVariable(GapRequested, GapRequestedMft)
11058. 	
11059. 
11060. 	/* OS Volume Type Method */
11061. 		# Gap Calculation Methods:
11062. 	/* AddGap Variants */
11063. 	/* OS Volume Type Method */
11064. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
11065. 	SetVariable(GapRequested, GapRequestedOs)
11066. 
11067. 
11068. 
11069. /* MakeGap Variants */
11070. 
11071. 	/* Original Os 1-3 + MFT 2 */
11072. 		# Gap Calculation Methods:
11073. 	/* MakeGap Variants */
11074. 	/* Original Os 1-3 + MFT 2 */
11075. 	/* plus MFT gap placed inline at the dividing zone. */
11076. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
11077. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
11078. 	SetVariable(GapRequested, GapRequestedOrig)
11079. 	
11080. 	
11081. /* Note: You could comment out the ones not in use */
11082. /* However having the data in the log is useful. */
11083. /* Therefore the following line is otherwise needed. */
11084. 
11085. /* Standard used */
11086. 
11087. SetVariable(GapRequested, GapRequestedStd)
11088. 
11089. # Gap Calculation Methods:
11090. 
11091. /* AddGap Variants */
11092. 	/* Standard */
11093. 	/* MFT Low High Method */
11094. 	/* OS Volume Type Method */
11095. 
11096. /* MakeGap Variants */
11097. 	/* Original Os 1-3 + MFT 2 */
11098. 
11099. /* Note: You could comment out the ones not in use */
11100. /* However having the data in the log is useful. */
11101. /* Therefore the following line is otherwise needed. */
11102. 
11103. /* Standard is used currently */
11104. 
11105. 
11106. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
11107. 
11108. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
11109. 
11110. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
11111. 
11112. /* ------------------------- */
11113. /* 3) SMALL ZONE ADJUSTMENT. */
11114. /* Gab cant be larger than half the Zone Size. */
11115. 
11116. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
11117. 	
11118. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
11119. 
11120. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
11121. 
11122. /* ------------------------- */
11123. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
11124. # Gap Adjustments.
11125. 
11126. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
11127. 	
11128. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
11129. 
11130. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
11131. 
11132. /* ------------------------- */
11133. # BYPASS THIS.
11134. 	/* This is definitely wrong. */
11135. 	/* The question is can we steal gap from the next zone */
11136. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
11137. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
11138. 		# Zone Overflow.
11139. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
11140. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
11141. 
11142. /* ------------------------- */
11143. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
11144. # Remaining free space available.
11145. 
11146. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
11147. 	
11148. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
11149. 
11150. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
11151. 
11152. /* ------------------------- */
11153. # CURRENT gap to use.
11154. 
11155. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
11156. 
11157. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
11158. 
11159. /* ------------------------- */
11160. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
11161. # Debugging.
11162. 
11163. 	SetVariable(GapUsed, GapCurrent) // for debugging
11164. 
11165. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
11166. 
11167. 		# Your code HERE
11168. 
11169. /* ------------------------- */
11170. /* 7) YOUR CODE. */
11171. # YOUR CODE HERE:
11172. 	# INPUT: GapCurrent or GapCurrentLoc
11173. 	# OUTPUT: GapUsed...
11174. 
11175. /* ------------------------- */
11176. # Gap Size.
11177. # Actual Size of Gap.
11178. 
11179. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
11180. 
11181. /* ------------------------- */
11182. 
11183. 	
11184. 	# Zone Statistics	
11185. 		# Script: ZoneStatisticsGet
11186. # Zone / Volume Statistics and Display
11187. 		
11188. 	# Accumulate Totals
11189.   	# Script: ZoneDoVolumeTotals
11190. 
11191. /* Current total space used (by Zones and Gaps) */
11192. 
11193. SetVariable(VolumeZoneUsed, GapUsed)
11194. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
11195. /* Percentage */
11196. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
11197. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
11198. 
11199. /* Current total of free space requested */
11200. 
11201. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
11202. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
11203. /* Percent. */
11204. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
11205. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
11206. 
11207. /* Current total of free space used */
11208. 
11209. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
11210. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
11211. /* Percent */
11212. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
11213. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
11214. 
11215. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
11216. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
11217. # Xinclude "..\DebugDisplayPause.MyDc"X
11218. 
11219. 
11220. 	# Current Values
11221. 	# Script: ZoneDoCurrentSet
11222. 
11223. # Cluster, Sector, Block adjust for display.
11224. 	# Bytes per cluster is volume specific.
11225. 
11226. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
11227. 
11228. # Current Zone values.
11229. 	# Begin, end and size.
11230. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
11231. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
11232. 
11233. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
11234. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
11235. 
11236. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
11237. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
11238. 
11239. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
11240. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
11241. 
11242. 	SetVariable(ZoneFragments,				"!ZONE210N!")
11243. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
11244. 		
11245. # Current Gap, Actual and Free Values
11246. 	# Gap
11247. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
11248. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
11249. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
11250. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
11251. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
11252. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
11253. 	
11254. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
11255. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
11256. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
11257. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
11258. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
11259. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
11260. 	
11261. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
11262. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
11263. 	
11264. 	# Actual Size and End
11265. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
11266. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
11267. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
11268. 	
11269. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
11270. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
11271. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
11272. 
11273. # Gap Size & Rounding
11274. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
11275. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
11276. 	
11277. 	# Free Space
11278. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
11279. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
11280. 
11281. 	# Script: ZoneStatisticsReportGet
11282. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
11283. 
11284. # Footer:
11285. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
11286. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
11287. #
11288. # Xinclude "..\Commands\DateTimeLastLong.txt"X
11289. #
11290. # What a mess this word based vs is. Try a phrase based version ToDo
11291. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
11292. ------------------
11293.    !SizeWord!!ColonWord!  
11294.    ------------------------
11295.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11296.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11297.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11298. 
11299.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11300.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
11301. 
11302.    !LocationWord!!ColonWord!
11303.    ------------------------
11304.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11305.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
11306.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11307.       
11308.    !GapWordCaps! !SettingsWord!!ColonWord!
11309.    ------------------------
11310.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
11311.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
11312.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11313.                  
11314.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
11315.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
11316.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
11317.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
11318.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
11319.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
11320.      
11321.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
11322.    ------------------------
11323.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11324.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11325.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11326. 
11327. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
11328. ----------------------------------------------------------
11329. ")
11330. #
11331. SetVariable(DateNow, 	DATETIME)
11332. SetVariable(TimeNow, 	Time)
11333. SetVariable(RunTimeNow, 	RunTime)
11334. 
11335. 
11336. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
11337. 
11338. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
11339. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
11340. 
11341. 	# Script: DisplaySetWindowText
11342. # Zone Footer Set Statistics Window Text
11343. 
11344. SetStatisticsWindowText("!Heading!
11345. ----------------------------------------------------------
11346. Zones Processed: 
11347. ----------------------------------------------------------
11348. !ZoneListByLine!
11349. ----------------------------------------------------------
11350. Zone Processing Step:
11351. !ZoneStepByLine!    
11352. ----------------------------------------------------------
11353. ----------------------------------------------------------
11354. CURRENT ZONE:
11355. !ZoneStatisticsReport!
11356. ----------------------------------------------------------
11357. ----------------------------------------------------------
11358. ----------------------------------------------------------
11359. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
11360. ----------------------------------------------------------
11361. !VolumeStatisticsSummary!
11362. !VolumeStatisticsDetail!
11363. ----------------------------------------------------------
11364. ----------------------------------------------------------
11365. Zone Detailed Report:
11366. ----------------------------------------------------------
11367. !ZoneStatisticsDetail!
11368. ----------------------------------------------------------
11369. ")
11370. 
11371. 
11372. 	
11373. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
11374. 
11375. 
11376. 	SetVariable(ZoneStatisticsData, 
11377. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
11378.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
11379.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
11380. 
11381. 
11382. 
11383.  		# Script: ZoneStatisticsDisplay
11384. 	
11385. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
11386. !ZoneStatisticsData!
11387. ')
11388. 
11389. 		# Script: ZoneStatisticsAdd
11390. # Append Zone to Details of each zone.
11391. 		
11392. 	# Add Zone Details to Report.	
11393. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
11394. !ZoneStatisticsReport!
11395. ')
11396. 
11397. 	
11398. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
11399. 		# Script: DisplaySetZoneStep
11400. # Increment
11401. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11402. 
11403. # Display this zone step
11404. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
11405. ')
11406. 
11407. # Script: BannerSet
11408. 
11409. # NOTE: Can't round or truncate to integer precision. 
11410. # This internal fields like ZoneCount format really badly.
11411. #  for !RunTimeNow! does not work. None of the date functions do.
11412. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
11413. 
11414. SetVariable(HeadingTemp2,	ZoneCount + 0)
11415. 
11416. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
11417. 
11418. Title('!Heading!')
11419. 
11420. /* pause(1) */
11421. 
11422. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
11423. 
11424. 
11425. # Script: DisplaySetWindowText
11426. # Zone Footer Set Statistics Window Text
11427. 
11428. SetStatisticsWindowText("!Heading!
11429. ----------------------------------------------------------
11430. Zones Processed: 
11431. ----------------------------------------------------------
11432. !ZoneListByLine!
11433. ----------------------------------------------------------
11434. Zone Processing Step:
11435. !ZoneStepByLine!    
11436. ----------------------------------------------------------
11437. ----------------------------------------------------------
11438. CURRENT ZONE:
11439. !ZoneStatisticsReport!
11440. ----------------------------------------------------------
11441. ----------------------------------------------------------
11442. ----------------------------------------------------------
11443. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
11444. ----------------------------------------------------------
11445. !VolumeStatisticsSummary!
11446. !VolumeStatisticsDetail!
11447. ----------------------------------------------------------
11448. ----------------------------------------------------------
11449. Zone Detailed Report:
11450. ----------------------------------------------------------
11451. !ZoneStatisticsDetail!
11452. ----------------------------------------------------------
11453. ")
11454. 
11455. 
11456. 
11457. 
11458. 		# File Action - Type Os Programs Fixed - Regular - MoveUpToZone.
11459. # File Action - ZoneDoActionSortByCreationDateFull
11460. 	SortByCreationDate(Ascending)
11461. 	
11462. 	
11463. 	
11464. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
11465. 		# Script: DisplaySetZoneStep
11466. # Increment
11467. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11468. 
11469. # Display this zone step
11470. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
11471. ')
11472. 
11473. # Script: BannerSet
11474. 
11475. # NOTE: Can't round or truncate to integer precision. 
11476. # This internal fields like ZoneCount format really badly.
11477. #  for !RunTimeNow! does not work. None of the date functions do.
11478. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
11479. 
11480. SetVariable(HeadingTemp2,	ZoneCount + 0)
11481. 
11482. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
11483. 
11484. Title('!Heading!')
11485. 
11486. /* pause(1) */
11487. 
11488. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
11489. 
11490. 
11491. # Script: DisplaySetWindowText
11492. # Zone Footer Set Statistics Window Text
11493. 
11494. SetStatisticsWindowText("!Heading!
11495. ----------------------------------------------------------
11496. Zones Processed: 
11497. ----------------------------------------------------------
11498. !ZoneListByLine!
11499. ----------------------------------------------------------
11500. Zone Processing Step:
11501. !ZoneStepByLine!    
11502. ----------------------------------------------------------
11503. ----------------------------------------------------------
11504. CURRENT ZONE:
11505. !ZoneStatisticsReport!
11506. ----------------------------------------------------------
11507. ----------------------------------------------------------
11508. ----------------------------------------------------------
11509. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
11510. ----------------------------------------------------------
11511. !VolumeStatisticsSummary!
11512. !VolumeStatisticsDetail!
11513. ----------------------------------------------------------
11514. ----------------------------------------------------------
11515. Zone Detailed Report:
11516. ----------------------------------------------------------
11517. !ZoneStatisticsDetail!
11518. ----------------------------------------------------------
11519. ")
11520. 
11521. 
11522. 
11523. 
11524. 	# Script: ZoneDoFooter
11525. 
11526. /* --------------------------------- */
11527. 	# File Select
11528. 		# Select Statments
11529. 	# File Actions 
11530. 		# Standard or OS File Actions.
11531. 		# Resume...
11532. 	
11533. 		# your stuff HERE (X)... post zone (file) file actions code.
11534. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
11535. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
11536. 			# (X)
11537. 		
11538. 			/* ??? Set window? */
11539. 	
11540. 		# ADD THE GAP
11541. 		# Script: GapZoneCommand
11542. # Vacate (good for diagnostics)
11543. # DoNotVacate - DO NOT Vacate (recommended)
11544. 
11545. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
11546. # Script: DisplaySetZoneStep
11547. # Increment
11548. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11549. 
11550. # Display this zone step
11551. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
11552. ')
11553. 
11554. # Script: BannerSet
11555. 
11556. # NOTE: Can't round or truncate to integer precision. 
11557. # This internal fields like ZoneCount format really badly.
11558. #  for !RunTimeNow! does not work. None of the date functions do.
11559. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
11560. 
11561. SetVariable(HeadingTemp2,	ZoneCount + 0)
11562. 
11563. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
11564. 
11565. Title('!Heading!')
11566. 
11567. /* pause(1) */
11568. 
11569. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
11570. 
11571. 
11572. # Script: DisplaySetWindowText
11573. # Zone Footer Set Statistics Window Text
11574. 
11575. SetStatisticsWindowText("!Heading!
11576. ----------------------------------------------------------
11577. Zones Processed: 
11578. ----------------------------------------------------------
11579. !ZoneListByLine!
11580. ----------------------------------------------------------
11581. Zone Processing Step:
11582. !ZoneStepByLine!    
11583. ----------------------------------------------------------
11584. ----------------------------------------------------------
11585. CURRENT ZONE:
11586. !ZoneStatisticsReport!
11587. ----------------------------------------------------------
11588. ----------------------------------------------------------
11589. ----------------------------------------------------------
11590. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
11591. ----------------------------------------------------------
11592. !VolumeStatisticsSummary!
11593. !VolumeStatisticsDetail!
11594. ----------------------------------------------------------
11595. ----------------------------------------------------------
11596. Zone Detailed Report:
11597. ----------------------------------------------------------
11598. !ZoneStatisticsDetail!
11599. ----------------------------------------------------------
11600. ")
11601. 
11602. 
11603. 
11604. 
11605. # *** Moved to setting yours *** 
11606. # (to avoid doing it twice)
11607. # (ie the later wouldn't "overwrite" the former in the usual manner)
11608. 
11609. # Do one or the other:
11610. # DoNotVacate - DO NOT Vacate (recommended)
11611. 
11612. # Vacate
11613. /* AddGap(GapUsedLoc) */
11614. 
11615. # DO Not Vacate
11616. AddGap(GapUsedLoc, DoNotVacate) 
11617. 	
11618. 	
11619. 
11620. # Controlled via settings commands
11621. 
11622. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
11623. 
11624. # Vacate /* AddGap(GapUsed) */
11625. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
11626. 	
11627. 
11628. 		
11629. 	# 
11630. 	FileEnd
11631. /* --------------------------------- */
11632. # your stuff HERE (X)... post zone (file) code.
11633. 
11634. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
11635. # Script: DisplaySetZoneStep
11636. # Increment
11637. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11638. 
11639. # Display this zone step
11640. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
11641. ')
11642. 
11643. # Script: BannerSet
11644. 
11645. # NOTE: Can't round or truncate to integer precision. 
11646. # This internal fields like ZoneCount format really badly.
11647. #  for !RunTimeNow! does not work. None of the date functions do.
11648. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
11649. 
11650. SetVariable(HeadingTemp2,	ZoneCount + 0)
11651. 
11652. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
11653. 
11654. Title('!Heading!')
11655. 
11656. /* pause(1) */
11657. 
11658. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
11659. 
11660. 
11661. # Script: DisplaySetWindowText
11662. # Zone Footer Set Statistics Window Text
11663. 
11664. SetStatisticsWindowText("!Heading!
11665. ----------------------------------------------------------
11666. Zones Processed: 
11667. ----------------------------------------------------------
11668. !ZoneListByLine!
11669. ----------------------------------------------------------
11670. Zone Processing Step:
11671. !ZoneStepByLine!    
11672. ----------------------------------------------------------
11673. ----------------------------------------------------------
11674. CURRENT ZONE:
11675. !ZoneStatisticsReport!
11676. ----------------------------------------------------------
11677. ----------------------------------------------------------
11678. ----------------------------------------------------------
11679. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
11680. ----------------------------------------------------------
11681. !VolumeStatisticsSummary!
11682. !VolumeStatisticsDetail!
11683. ----------------------------------------------------------
11684. ----------------------------------------------------------
11685. Zone Detailed Report:
11686. ----------------------------------------------------------
11687. !ZoneStatisticsDetail!
11688. ----------------------------------------------------------
11689. ")
11690. 
11691. 
11692. 
11693. 
11694. # Script: ZoneWhenFinished
11695. 
11696. # Add the zone to the zone details log:
11697. # This is temporarily disable until logging is fixed
11698. # It is performed during file action to preserve the correct (original) calculations.
11699. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
11700. 
11701. # Add the Select and ZoneSteps to the Zone
11702. # Script: ZoneStatisticsAdd
11703. # Append Zone to Details of each zone.
11704. 		
11705. 	# Add Zone Details to Report.	
11706. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
11707. ----------------------------------------------------------
11708. !ZoneStepByLine!
11709. ---------------------------
11710. !ZoneTypeSelectCurrent!               
11711. ---------------------------
11712. ----------------------------------------------------------
11713. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
11714. ----------------------------------------------------------
11715. ')
11716. 
11717. 
11718. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
11719. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
11720. # 2021-12-14 15:29:59
11721. RunProgram("..\Commands\WriteDateTime.bat LastZone")
11722. # Append Datetime to logs
11723. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
11724. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
11725. 
11726. AppendLogfile("!LogFileName!", "!PeriodWord!")
11727. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
11728. AppendLogfile("!LogFileName!", "!PeriodWord!")
11729. 
11730. # Script: DisplaySetWindowText
11731. # Zone Footer Set Statistics Window Text
11732. 
11733. SetStatisticsWindowText("!Heading!
11734. ----------------------------------------------------------
11735. Zones Processed: 
11736. ----------------------------------------------------------
11737. !ZoneListByLine!
11738. ----------------------------------------------------------
11739. Zone Processing Step:
11740. !ZoneStepByLine!    
11741. ----------------------------------------------------------
11742. ----------------------------------------------------------
11743. CURRENT ZONE:
11744. !ZoneStatisticsReport!
11745. ----------------------------------------------------------
11746. ----------------------------------------------------------
11747. ----------------------------------------------------------
11748. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
11749. ----------------------------------------------------------
11750. !VolumeStatisticsSummary!
11751. !VolumeStatisticsDetail!
11752. ----------------------------------------------------------
11753. ----------------------------------------------------------
11754. Zone Detailed Report:
11755. ----------------------------------------------------------
11756. !ZoneStatisticsDetail!
11757. ----------------------------------------------------------
11758. ")
11759. 
11760. 
11761. 
11762. /* pause() */
11763. /* pause() */
11764. 
11765. 
11766. 
11767. /* ------------------------- */
11768. 
11769. 	
11770. /* ------------------------- */
11771. # Zone Program Data. - Zone 3 (7)
11772. 	# Script: DisplayColors - Zone Dark
11773. # Processed
11774. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
11775. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
11776. 
11777. # Light Green and Yellow
11778. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
11779. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
11780. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
11781. 
11782. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsData!")
11783. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsData!")
11784. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramsData!")
11785. 	SetVariable(ZoneGapSize, 			"!ZoneGapSizeProgramsData!")
11786. 	SetVariable(ZoneTypeSelect,'
11787. # Program Data:
11788. # Script: ZoneDo ZoneTypeSelectOsPrograms
11789. # Programs start.
11790. # Mark: 1
11791. # NotBlobsArchivesBu start.
11792. # NOT!
11793. (not (
11794. # Blobs start.
11795. (
11796. # BlobsAndExceptions start.
11797. ( not(
11798.   FileName("*.bat")
11799.   or FileName("*.css")
11800.   or FileName("*.dll")
11801.   or FileName("*.exe")
11802.   or FileName("*.htm*")
11803.   or FileName("*.jar")
11804.   or FileName("*.js")
11805.   or FileName("*.script")
11806.   or FileName("*.wsf")
11807.   or (
11808. # Databases start.
11809. (
11810.   FileName("*.crypt*")
11811.   or FileName("*.db*")
11812.   or FileName("*.rdb*")
11813.   or FileName("*.dc*")
11814.   or FileName("*.dict*")
11815.   or FileName("*.?db*")
11816.   or FileName("*.?rdb*")
11817.   or FileName("*.md*")
11818.   or FileName("*.myd")
11819.   or FileName("*.ndf")
11820.   or FileName("*.ns?")
11821.   or FileName("*.pab")
11822.   or FileName("*.pst")
11823.   or FileName("*.sd?*")
11824.   or FileName("*.sq**")
11825.   or FileName("*.tmd")
11826.   or FileName("*.tps")
11827.   or FileName("*.tr*")
11828. )
11829. # Databases end.
11830. 
11831.     # BlobsAndExceptions
11832.     or 
11833. # Data start.
11834. (
11835.   DirectoryName("Data*")
11836.   or DirectoryName("Device*")
11837.   or DirectoryName("Export*")
11838.   or DirectoryName("Import*")
11839.   or DirectoryName("Log*")
11840.   or DirectoryName("*Log")
11841.   or DirectoryName("Maintenance*")
11842.   or DirectoryName("Rec*")
11843.   or DirectoryName("Sales*")
11844.   or DirectoryName("Search*")
11845.   or DirectoryName("User*")
11846. )
11847. # Data end.
11848. 
11849.     # BlobsAndExceptions
11850.   )
11851. ) )
11852. # BlobsAndExceptions end.
11853. 
11854. # Blobs
11855. ) and (
11856.   Size(BlobFileSize,0)
11857.   or (
11858.     FileName("*.arj")
11859.     or FileName("*.bup")
11860.     or FileName("*.bz2")
11861.     or FileName("*.chm")
11862.     or FileName("*.dvr-ms")
11863.     or FileName("*.gz")
11864.     or FileName("*.ifo")
11865.     or FileName("*.lzh")
11866.     or FileName("*.pdf")
11867.     or FileName("*.rpm")
11868.     or FileName("*.wmv")
11869.     or FileName("*.vob")
11870.     or FileName("*.z")
11871.   ) 
11872. )
11873. # Blobs end.
11874. 
11875. # NotBlobsArchivesBu
11876. or 
11877. # Archives start.
11878. (
11879.   DirectoryName("*Archive*")
11880.   or DirectoryName("*History*")
11881.   or DirectoryName("*Old")
11882.   or DirectoryName("* Old *")
11883.   or DirectoryName("Old *")
11884. 
11885.   or FileName("*.7z")
11886.   or FileName("*.cab")
11887.   or FileName("*.iso")
11888.   or FileName("*.msi")
11889.   or FileName("*.old")
11890.   or FileName("*.rar")
11891.   or FileName("*.tar")
11892.   or FileName("*.zip")
11893.   or
11894. # WinSysLow start.
11895. (
11896.   # Bad idea. This pushed lots of programs and data to archive.
11897.   # DirectoryName("$*")
11898.   # or DirectoryName("0*")
11899.   # or DirectoryName("1*")
11900.   # or DirectoryName("2*")
11901.   # or DirectoryName("3*")
11902.   # or DirectoryName("4*")
11903.   # or DirectoryName("5*")
11904.   # or DirectoryName("6*")
11905.   # or DirectoryName("7*")
11906.   # or DirectoryName("8*")
11907.   # or DirectoryName("9*")
11908.   # or 
11909.   DirectoryName("dllcache")
11910.   or DirectoryName("Downloaded Installations")
11911.   or DirectoryName("Ehome")
11912.   or DirectoryName("Fonts")
11913.   or DirectoryName("Help")
11914.   or DirectoryName("I386")
11915.   or DirectoryName("ie?updates")
11916.   or DirectoryName("Installer")
11917.   or DirectoryName("Installshield Installation Information")
11918.   or DirectoryName("IME")
11919.   or DirectoryName("*RECYCLE*")
11920.   or DirectoryName("ServicePackFiles")
11921.   or DirectoryName("SoftwareDistribution")
11922.   or DirectoryName("Speech")
11923.   or DirectoryName("Symbols")
11924.   or DirectoryName("System Volume Information")
11925.   or DirectoryName("windows.old")
11926. )
11927. # WinSysLow end.
11928. 
11929.   # Archives
11930. )
11931. # Archives end.
11932. 
11933. # NotBlobsArchivesBu
11934. or
11935. # Backups start.
11936. (
11937.   DirectoryName("*Backup*")
11938.   or DirectoryName("*Bu")
11939.   or DirectoryName("* Bu *")
11940.   or DirectoryName("Bu *")
11941. 
11942.   or FileName("*.bak")
11943.   or FileName("* - Copy*")
11944. )
11945. # Backups end.
11946. 
11947. or 
11948. FileName("ReferenceMarker.MyDx")
11949. # NotBlobsArchivesBu
11950. ) )
11951. # NotBlobsArchivesBu end.
11952. 
11953. # Mark: 2
11954. # Programs
11955. and (
11956. # Mark: 3
11957. # SystemDir start.
11958. (
11959.   DirectoryName("Boot*")
11960.   or DirectoryName("Device*")
11961.   or DirectoryName("DevSupport*")
11962.   or DirectoryName("Program*")
11963.   or DirectoryName("Security*")
11964.   or DirectoryName("SendTo*")
11965.   or DirectoryName("Sw*")
11966.   or DirectoryName("System*")
11967.   or DirectoryName("Toolbars")
11968.   or DirectoryName("Windows*")
11969. )
11970. # SystemDir end.
11971. 
11972. # Mark: 4
11973. # Programs
11974. )
11975. # Programs end.
11976. 
11977. not(
11978. # Os PageHiberDump start.
11979. (
11980.   FileName("DataStore.edb")
11981.   or FileName("DUMP*.*")
11982.   or FileName("Hiberfil.sys")
11983.   or FileName("MEMORY.DMP")
11984.   or FileName("Pagefile.sys")
11985. )
11986. # Os PageHiberDump end.
11987. 
11988. )
11989. ')
11990. 
11991. 	SetVariable(ZoneNoCurrentAdjust, ZoneNoCurrentAdjust + 1)
11992. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
11993. 
11994. SetVariable(ZoneStepNoCurrent, 0)
11995. 
11996. 	/* ------------------------- */
11997. # Script: ZoneDoHeader
11998. 
11999. # Script: ZoneWhenStarted
12000. RunProgram("..\Commands\WriteDateTime.bat")
12001. 
12002. # Script: ZoneDoCurrentClear
12003. 
12004. SetVariable(ZoneTypeSelectCurrent, 		"")
12005. SetVariable(ZoneStatisticsData, 		"")
12006. SetVariable(ZoneStepByLine, 			"")
12007. 
12008. SetVariable(ZoneBeginCurrent, 			0)
12009. SetVariable(ZoneBeginPerCurrent, 		0)
12010. SetVariable(ZoneEndCurrent, 			0)
12011. SetVariable(ZoneEndPerCurrent, 			0)
12012. 
12013. SetVariable(ZoneSizeCurrent,			0)
12014. SetVariable(ZoneSizePerCurrent,			0)
12015. 
12016. SetVariable(ZoneGapRequestedCurrent,	0)
12017. SetVariable(ZoneGapRoundedCurrent, 		0)
12018. SetVariable(ZoneGapAdjustedCurrent, 	0)
12019. SetVariable(ZoneGapAvailableCurrent, 	0)
12020. SetVariable(ZoneGapCurrent,				0)
12021. SetVariable(ZoneGapUsedCurrent, 		0)
12022. 
12023. SetVariable(ZoneGapActualCurrent, 		0)
12024. SetVariable(ZoneGapActualPerCurrent, 	0)
12025. 
12026. SetVariable(ZoneSizeActual, 			0)
12027. SetVariable(ZoneSizeActualCurrent,		0)
12028. 
12029. SetVariable(ZoneEndActual, 				0)
12030. SetVariable(ZoneEndActualCurrent,		0)			
12031. SetVariable(ZoneSizeActualPerCurrent, 	0)
12032.       
12033. SetVariable(ZoneFilesFolders,			0)
12034. SetVariable(ZoneFilesFoldersPer,		0) 
12035. 
12036. SetVariable(ZoneFragments,				0)
12037. SetVariable(ZoneFragmentsPer,			0) 
12038. 		
12039. SetVariable(ZoneEndActualCurrent, 		0)
12040. SetVariable(ZoneEndActualPerCurrent, 	0)
12041. 
12042. # Gap Calculation Methodology:
12043. 	# Requested
12044. 	SetVariable(GapRequested, 			0) 
12045. 	SetVariable(GapRequestedStd, 		0) 
12046. 	SetVariable(GapRequestedMft, 		0) 
12047. 	SetVariable(GapRequestedOs, 		0) 
12048. 	SetVariable(GapRequestedOriginal, 	0) 
12049. 	
12050. 	# Gap Adjustments
12051. 	SetVariable(GapRounded, 			0)
12052. 	# SetVariable(GapAdjusted, 			0)
12053. 	SetVariable(GapAvailable, 			0)
12054. 	SetVariable(GapCurrent, 			0)
12055. 	SetVariable(GapActual, 				0)
12056. 	SetVariable(GapUsed, 				0)
12057. 	
12058. 	# Gap Adjustments
12059. 	SetVariable(GapRoundedLoc, 			0)
12060. 	# SetVariable(GapAdjustedLoc, 		0)
12061. 	SetVariable(GapAvailableLoc, 		0)
12062. 	SetVariable(GapCurrentLoc, 			0)
12063. 	SetVariable(GapActualLoc,			0)
12064. 	SetVariable(GapUsedLoc,				0)
12065. 	
12066. 	# Space usage
12067. 	SetVariable(ZoneFreePerRequested, 	0)
12068. 	SetVariable(ZoneFreePerUsed, 		0)
12069. 
12070. # Gap Size & Rounding
12071. 	SetVariable(ZoneGapSizePer, 		0)
12072. 	SetVariable(ZoneVolRoundUpPer, 		0)
12073. 	
12074. 	# Free Space
12075. 	SetVariable(ZoneFreeUsedPer, 		0)
12076. 	SetVariable(ZoneFreeRequestedPer, 	0)
12077. 
12078. # Script: DisplaySetZone
12079. 
12080. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
12081. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
12082. 
12083. # Message ZoneSummary
12084. # SetVariable(ZoneSummary, '
12085. # Zone Summary:
12086. # ')
12087. # Zone processing steps
12088. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
12089. # ')
12090. 
12091. # # Script: BannerDescriptionSet
12092. 
12093. # Script: BannerSet
12094. 
12095. # NOTE: Can't round or truncate to integer precision. 
12096. # This internal fields like ZoneCount format really badly.
12097. #  for !RunTimeNow! does not work. None of the date functions do.
12098. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
12099. 
12100. SetVariable(HeadingTemp2,	ZoneCount + 0)
12101. 
12102. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12103. 
12104. Title('!Heading!')
12105. 
12106. /* pause(1) */
12107. 
12108. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12109. 
12110. 
12111. # Script: BannerLog
12112. 
12113. AppendLogfile("!LogFileName!", "!Heading!")
12114. 
12115. 
12116. 
12117. # pause(1)
12118. 
12119. 
12120. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
12121. # Script: DisplaySetZoneStep
12122. # Increment
12123. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12124. 
12125. # Display this zone step
12126. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
12127. ')
12128. 
12129. # Script: BannerSet
12130. 
12131. # NOTE: Can't round or truncate to integer precision. 
12132. # This internal fields like ZoneCount format really badly.
12133. #  for !RunTimeNow! does not work. None of the date functions do.
12134. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
12135. 
12136. SetVariable(HeadingTemp2,	ZoneCount + 0)
12137. 
12138. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12139. 
12140. Title('!Heading!')
12141. 
12142. /* pause(1) */
12143. 
12144. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12145. 
12146. 
12147. # Script: DisplaySetWindowText
12148. # Zone Footer Set Statistics Window Text
12149. 
12150. SetStatisticsWindowText("!Heading!
12151. ----------------------------------------------------------
12152. Zones Processed: 
12153. ----------------------------------------------------------
12154. !ZoneListByLine!
12155. ----------------------------------------------------------
12156. Zone Processing Step:
12157. !ZoneStepByLine!    
12158. ----------------------------------------------------------
12159. ----------------------------------------------------------
12160. CURRENT ZONE:
12161. !ZoneStatisticsReport!
12162. ----------------------------------------------------------
12163. ----------------------------------------------------------
12164. ----------------------------------------------------------
12165. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
12166. ----------------------------------------------------------
12167. !VolumeStatisticsSummary!
12168. !VolumeStatisticsDetail!
12169. ----------------------------------------------------------
12170. ----------------------------------------------------------
12171. Zone Detailed Report:
12172. ----------------------------------------------------------
12173. !ZoneStatisticsDetail!
12174. ----------------------------------------------------------
12175. ")
12176. 
12177. 
12178. 
12179. 
12180. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
12181. 
12182. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
12183. # Script: DisplaySetZoneStep
12184. # Increment
12185. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12186. 
12187. # Display this zone step
12188. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
12189. ')
12190. 
12191. # Script: BannerSet
12192. 
12193. # NOTE: Can't round or truncate to integer precision. 
12194. # This internal fields like ZoneCount format really badly.
12195. #  for !RunTimeNow! does not work. None of the date functions do.
12196. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
12197. 
12198. SetVariable(HeadingTemp2,	ZoneCount + 0)
12199. 
12200. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12201. 
12202. Title('!Heading!')
12203. 
12204. /* pause(1) */
12205. 
12206. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12207. 
12208. 
12209. # Script: DisplaySetWindowText
12210. # Zone Footer Set Statistics Window Text
12211. 
12212. SetStatisticsWindowText("!Heading!
12213. ----------------------------------------------------------
12214. Zones Processed: 
12215. ----------------------------------------------------------
12216. !ZoneListByLine!
12217. ----------------------------------------------------------
12218. Zone Processing Step:
12219. !ZoneStepByLine!    
12220. ----------------------------------------------------------
12221. ----------------------------------------------------------
12222. CURRENT ZONE:
12223. !ZoneStatisticsReport!
12224. ----------------------------------------------------------
12225. ----------------------------------------------------------
12226. ----------------------------------------------------------
12227. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
12228. ----------------------------------------------------------
12229. !VolumeStatisticsSummary!
12230. !VolumeStatisticsDetail!
12231. ----------------------------------------------------------
12232. ----------------------------------------------------------
12233. Zone Detailed Report:
12234. ----------------------------------------------------------
12235. !ZoneStatisticsDetail!
12236. ----------------------------------------------------------
12237. ")
12238. 
12239. 
12240. 
12241. 
12242. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
12243. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
12244. 
12245. # Script: BannerSet
12246. 
12247. # NOTE: Can't round or truncate to integer precision. 
12248. # This internal fields like ZoneCount format really badly.
12249. #  for !RunTimeNow! does not work. None of the date functions do.
12250. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
12251. 
12252. SetVariable(HeadingTemp2,	ZoneCount + 0)
12253. 
12254. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12255. 
12256. Title('!Heading!')
12257. 
12258. /* pause(1) */
12259. 
12260. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12261. 
12262. 
12263. # Script: BannerLog
12264. 
12265. AppendLogfile("!LogFileName!", "!Heading!")
12266. 
12267. 
12268. 
12269. # LOGGING:
12270. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
12271. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
12272. 
12273. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
12274. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:29:59")
12275. # 2021-12-14 15:29:59 
12276. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:04 !ZoneLabel! !ZoneDescription!")
12277. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
12278. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:04 !ZoneLabel! !ZoneDescription!")
12279. 
12280. 
12281. # Add zone to list of zones:
12282. SetVariable(ZoneListByLine, "!ZoneListByLine!
12283. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
12284. # Script: DisplaySetWindowText
12285. # Zone Footer Set Statistics Window Text
12286. 
12287. SetStatisticsWindowText("!Heading!
12288. ----------------------------------------------------------
12289. Zones Processed: 
12290. ----------------------------------------------------------
12291. !ZoneListByLine!
12292. ----------------------------------------------------------
12293. Zone Processing Step:
12294. !ZoneStepByLine!    
12295. ----------------------------------------------------------
12296. ----------------------------------------------------------
12297. CURRENT ZONE:
12298. !ZoneStatisticsReport!
12299. ----------------------------------------------------------
12300. ----------------------------------------------------------
12301. ----------------------------------------------------------
12302. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
12303. ----------------------------------------------------------
12304. !VolumeStatisticsSummary!
12305. !VolumeStatisticsDetail!
12306. ----------------------------------------------------------
12307. ----------------------------------------------------------
12308. Zone Detailed Report:
12309. ----------------------------------------------------------
12310. !ZoneStatisticsDetail!
12311. ----------------------------------------------------------
12312. ")
12313. 
12314. 
12315. 
12316. 
12317. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
12318. # Script: DisplaySetZoneStep
12319. # Increment
12320. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12321. 
12322. # Display this zone step
12323. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
12324. ')
12325. 
12326. # Script: BannerSet
12327. 
12328. # NOTE: Can't round or truncate to integer precision. 
12329. # This internal fields like ZoneCount format really badly.
12330. #  for !RunTimeNow! does not work. None of the date functions do.
12331. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
12332. 
12333. SetVariable(HeadingTemp2,	ZoneCount + 0)
12334. 
12335. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12336. 
12337. Title('!Heading!')
12338. 
12339. /* pause(1) */
12340. 
12341. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12342. 
12343. 
12344. # Script: DisplaySetWindowText
12345. # Zone Footer Set Statistics Window Text
12346. 
12347. SetStatisticsWindowText("!Heading!
12348. ----------------------------------------------------------
12349. Zones Processed: 
12350. ----------------------------------------------------------
12351. !ZoneListByLine!
12352. ----------------------------------------------------------
12353. Zone Processing Step:
12354. !ZoneStepByLine!    
12355. ----------------------------------------------------------
12356. ----------------------------------------------------------
12357. CURRENT ZONE:
12358. !ZoneStatisticsReport!
12359. ----------------------------------------------------------
12360. ----------------------------------------------------------
12361. ----------------------------------------------------------
12362. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
12363. ----------------------------------------------------------
12364. !VolumeStatisticsSummary!
12365. !VolumeStatisticsDetail!
12366. ----------------------------------------------------------
12367. ----------------------------------------------------------
12368. Zone Detailed Report:
12369. ----------------------------------------------------------
12370. !ZoneStatisticsDetail!
12371. ----------------------------------------------------------
12372. ")
12373. 
12374. 
12375. 
12376. 
12377. # your stuff HERE (X)... pre file select code.
12378. 
12379. /* --------------------------------- */
12380. 	FileSelect
12381. 
12382. 		# your stuff can't really go here (errors.)
12383. 		# maybe for some reason I don't know of...
12384. 	
12385. 		# Actions next...
12386. 	# Script: ZoneDo ZoneTypeSelectOsPrograms
12387. # Programs start.
12388. # Mark: 1
12389. # NotBlobsArchivesBu start.
12390. # NOT!
12391. (not (
12392. # Blobs start.
12393. (
12394. # BlobsAndExceptions start.
12395. ( not(
12396.   FileName("*.bat")
12397.   or FileName("*.css")
12398.   or FileName("*.dll")
12399.   or FileName("*.exe")
12400.   or FileName("*.htm*")
12401.   or FileName("*.jar")
12402.   or FileName("*.js")
12403.   or FileName("*.script")
12404.   or FileName("*.wsf")
12405.   or (
12406. # Databases start.
12407. (
12408.   FileName("*.crypt*")
12409.   or FileName("*.db*")
12410.   or FileName("*.rdb*")
12411.   or FileName("*.dc*")
12412.   or FileName("*.dict*")
12413.   or FileName("*.?db*")
12414.   or FileName("*.?rdb*")
12415.   or FileName("*.md*")
12416.   or FileName("*.myd")
12417.   or FileName("*.ndf")
12418.   or FileName("*.ns?")
12419.   or FileName("*.pab")
12420.   or FileName("*.pst")
12421.   or FileName("*.sd?*")
12422.   or FileName("*.sq**")
12423.   or FileName("*.tmd")
12424.   or FileName("*.tps")
12425.   or FileName("*.tr*")
12426. )
12427. # Databases end.
12428. 
12429.     # BlobsAndExceptions
12430.     or 
12431. # Data start.
12432. (
12433.   DirectoryName("Data*")
12434.   or DirectoryName("Device*")
12435.   or DirectoryName("Export*")
12436.   or DirectoryName("Import*")
12437.   or DirectoryName("Log*")
12438.   or DirectoryName("*Log")
12439.   or DirectoryName("Maintenance*")
12440.   or DirectoryName("Rec*")
12441.   or DirectoryName("Sales*")
12442.   or DirectoryName("Search*")
12443.   or DirectoryName("User*")
12444. )
12445. # Data end.
12446. 
12447.     # BlobsAndExceptions
12448.   )
12449. ) )
12450. # BlobsAndExceptions end.
12451. 
12452. # Blobs
12453. ) and (
12454.   Size(BlobFileSize,0)
12455.   or (
12456.     FileName("*.arj")
12457.     or FileName("*.bup")
12458.     or FileName("*.bz2")
12459.     or FileName("*.chm")
12460.     or FileName("*.dvr-ms")
12461.     or FileName("*.gz")
12462.     or FileName("*.ifo")
12463.     or FileName("*.lzh")
12464.     or FileName("*.pdf")
12465.     or FileName("*.rpm")
12466.     or FileName("*.wmv")
12467.     or FileName("*.vob")
12468.     or FileName("*.z")
12469.   ) 
12470. )
12471. # Blobs end.
12472. 
12473. # NotBlobsArchivesBu
12474. or 
12475. # Archives start.
12476. (
12477.   DirectoryName("*Archive*")
12478.   or DirectoryName("*History*")
12479.   or DirectoryName("*Old")
12480.   or DirectoryName("* Old *")
12481.   or DirectoryName("Old *")
12482. 
12483.   or FileName("*.7z")
12484.   or FileName("*.cab")
12485.   or FileName("*.iso")
12486.   or FileName("*.msi")
12487.   or FileName("*.old")
12488.   or FileName("*.rar")
12489.   or FileName("*.tar")
12490.   or FileName("*.zip")
12491.   or
12492. # WinSysLow start.
12493. (
12494.   # Bad idea. This pushed lots of programs and data to archive.
12495.   # DirectoryName("$*")
12496.   # or DirectoryName("0*")
12497.   # or DirectoryName("1*")
12498.   # or DirectoryName("2*")
12499.   # or DirectoryName("3*")
12500.   # or DirectoryName("4*")
12501.   # or DirectoryName("5*")
12502.   # or DirectoryName("6*")
12503.   # or DirectoryName("7*")
12504.   # or DirectoryName("8*")
12505.   # or DirectoryName("9*")
12506.   # or 
12507.   DirectoryName("dllcache")
12508.   or DirectoryName("Downloaded Installations")
12509.   or DirectoryName("Ehome")
12510.   or DirectoryName("Fonts")
12511.   or DirectoryName("Help")
12512.   or DirectoryName("I386")
12513.   or DirectoryName("ie?updates")
12514.   or DirectoryName("Installer")
12515.   or DirectoryName("Installshield Installation Information")
12516.   or DirectoryName("IME")
12517.   or DirectoryName("*RECYCLE*")
12518.   or DirectoryName("ServicePackFiles")
12519.   or DirectoryName("SoftwareDistribution")
12520.   or DirectoryName("Speech")
12521.   or DirectoryName("Symbols")
12522.   or DirectoryName("System Volume Information")
12523.   or DirectoryName("windows.old")
12524. )
12525. # WinSysLow end.
12526. 
12527.   # Archives
12528. )
12529. # Archives end.
12530. 
12531. # NotBlobsArchivesBu
12532. or
12533. # Backups start.
12534. (
12535.   DirectoryName("*Backup*")
12536.   or DirectoryName("*Bu")
12537.   or DirectoryName("* Bu *")
12538.   or DirectoryName("Bu *")
12539. 
12540.   or FileName("*.bak")
12541.   or FileName("* - Copy*")
12542. )
12543. # Backups end.
12544. 
12545. or 
12546. FileName("ReferenceMarker.MyDx")
12547. # NotBlobsArchivesBu
12548. ) )
12549. # NotBlobsArchivesBu end.
12550. 
12551. # Mark: 2
12552. # Programs
12553. and (
12554. # Mark: 3
12555. # SystemDir start.
12556. (
12557.   DirectoryName("Boot*")
12558.   or DirectoryName("Device*")
12559.   or DirectoryName("DevSupport*")
12560.   or DirectoryName("Program*")
12561.   or DirectoryName("Security*")
12562.   or DirectoryName("SendTo*")
12563.   or DirectoryName("Sw*")
12564.   or DirectoryName("System*")
12565.   or DirectoryName("Toolbars")
12566.   or DirectoryName("Windows*")
12567. )
12568. # SystemDir end.
12569. 
12570. # Mark: 4
12571. # Programs
12572. )
12573. # Programs end.
12574. 
12575. 	and not(
12576. 		# Os PageHiberDump start.
12577. (
12578.   FileName("DataStore.edb")
12579.   or FileName("DUMP*.*")
12580.   or FileName("Hiberfil.sys")
12581.   or FileName("MEMORY.DMP")
12582.   or FileName("Pagefile.sys")
12583. )
12584. # Os PageHiberDump end.
12585. 
12586. 	)
12587. 
12588. 	FileActions
12589. 
12590. 			# Script: GapZoneCalc
12591. 	# Gap
12592. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
12593. 		# Script: DisplaySetZoneStep
12594. # Increment
12595. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12596. 
12597. # Display this zone step
12598. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
12599. ')
12600. 
12601. # Script: BannerSet
12602. 
12603. # NOTE: Can't round or truncate to integer precision. 
12604. # This internal fields like ZoneCount format really badly.
12605. #  for !RunTimeNow! does not work. None of the date functions do.
12606. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
12607. 
12608. SetVariable(HeadingTemp2,	ZoneCount + 0)
12609. 
12610. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12611. 
12612. Title('!Heading!')
12613. 
12614. /* pause(1) */
12615. 
12616. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
12617. 
12618. 
12619. # Script: DisplaySetWindowText
12620. # Zone Footer Set Statistics Window Text
12621. 
12622. SetStatisticsWindowText("!Heading!
12623. ----------------------------------------------------------
12624. Zones Processed: 
12625. ----------------------------------------------------------
12626. !ZoneListByLine!
12627. ----------------------------------------------------------
12628. Zone Processing Step:
12629. !ZoneStepByLine!    
12630. ----------------------------------------------------------
12631. ----------------------------------------------------------
12632. CURRENT ZONE:
12633. !ZoneStatisticsReport!
12634. ----------------------------------------------------------
12635. ----------------------------------------------------------
12636. ----------------------------------------------------------
12637. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
12638. ----------------------------------------------------------
12639. !VolumeStatisticsSummary!
12640. !VolumeStatisticsDetail!
12641. ----------------------------------------------------------
12642. ----------------------------------------------------------
12643. Zone Detailed Report:
12644. ----------------------------------------------------------
12645. !ZoneStatisticsDetail!
12646. ----------------------------------------------------------
12647. ")
12648. 
12649. 
12650. 
12651. 	
12652. 	# ACTUAL GAP
12653. 		/* AddGap Variant. */
12654. 	  	# Script: GapZoneSet
12655. # Zone Do Gap
12656. # Gap Calculation Methods:
12657. 
12658. /* 1) Anything you need to add first. */
12659. /* empty */
12660. 
12661. /* ------------------------- */
12662. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
12663. 	# GapRequestedStd.
12664. 
12665. 		/* ------------------------- */
12666. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
12667. 
12668. 		# Gap Calculation Methods:
12669. 
12670. /* AddGap Variants */
12671. 
12672. 	/* Standard */
12673. 		# Gap Calculation Methods:
12674. 	/* AddGap Variants */
12675. 	/* Standard */
12676. 
12677. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
12678. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
12679. 
12680. 	SetVariable(GapRequested, GapRequestedStd)
12681. 	
12682. 
12683. 	/* MFT Low High Method */
12684. 		# Gap Calculation Methods:
12685. 	/* AddGap Variants */
12686. 	/* MFT Low High Method */
12687. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
12688. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
12689. 	SetVariable(GapRequested, GapRequestedMft)
12690. 	
12691. 
12692. 	/* OS Volume Type Method */
12693. 		# Gap Calculation Methods:
12694. 	/* AddGap Variants */
12695. 	/* OS Volume Type Method */
12696. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
12697. 	SetVariable(GapRequested, GapRequestedOs)
12698. 
12699. 
12700. 
12701. /* MakeGap Variants */
12702. 
12703. 	/* Original Os 1-3 + MFT 2 */
12704. 		# Gap Calculation Methods:
12705. 	/* MakeGap Variants */
12706. 	/* Original Os 1-3 + MFT 2 */
12707. 	/* plus MFT gap placed inline at the dividing zone. */
12708. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
12709. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
12710. 	SetVariable(GapRequested, GapRequestedOrig)
12711. 	
12712. 	
12713. /* Note: You could comment out the ones not in use */
12714. /* However having the data in the log is useful. */
12715. /* Therefore the following line is otherwise needed. */
12716. 
12717. /* Standard used */
12718. 
12719. SetVariable(GapRequested, GapRequestedStd)
12720. 
12721. # Gap Calculation Methods:
12722. 
12723. /* AddGap Variants */
12724. 	/* Standard */
12725. 	/* MFT Low High Method */
12726. 	/* OS Volume Type Method */
12727. 
12728. /* MakeGap Variants */
12729. 	/* Original Os 1-3 + MFT 2 */
12730. 
12731. /* Note: You could comment out the ones not in use */
12732. /* However having the data in the log is useful. */
12733. /* Therefore the following line is otherwise needed. */
12734. 
12735. /* Standard is used currently */
12736. 
12737. 
12738. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
12739. 
12740. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
12741. 
12742. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
12743. 
12744. /* ------------------------- */
12745. /* 3) SMALL ZONE ADJUSTMENT. */
12746. /* Gab cant be larger than half the Zone Size. */
12747. 
12748. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
12749. 	
12750. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
12751. 
12752. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
12753. 
12754. /* ------------------------- */
12755. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
12756. # Gap Adjustments.
12757. 
12758. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
12759. 	
12760. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
12761. 
12762. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
12763. 
12764. /* ------------------------- */
12765. # BYPASS THIS.
12766. 	/* This is definitely wrong. */
12767. 	/* The question is can we steal gap from the next zone */
12768. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
12769. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
12770. 		# Zone Overflow.
12771. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
12772. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
12773. 
12774. /* ------------------------- */
12775. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
12776. # Remaining free space available.
12777. 
12778. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
12779. 	
12780. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
12781. 
12782. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
12783. 
12784. /* ------------------------- */
12785. # CURRENT gap to use.
12786. 
12787. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
12788. 
12789. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
12790. 
12791. /* ------------------------- */
12792. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
12793. # Debugging.
12794. 
12795. 	SetVariable(GapUsed, GapCurrent) // for debugging
12796. 
12797. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
12798. 
12799. 		# Your code HERE
12800. 
12801. /* ------------------------- */
12802. /* 7) YOUR CODE. */
12803. # YOUR CODE HERE:
12804. 	# INPUT: GapCurrent or GapCurrentLoc
12805. 	# OUTPUT: GapUsed...
12806. 
12807. /* ------------------------- */
12808. # Gap Size.
12809. # Actual Size of Gap.
12810. 
12811. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
12812. 
12813. /* ------------------------- */
12814. 
12815. 	
12816. 	# Zone Statistics	
12817. 		# Script: ZoneStatisticsGet
12818. # Zone / Volume Statistics and Display
12819. 		
12820. 	# Accumulate Totals
12821.   	# Script: ZoneDoVolumeTotals
12822. 
12823. /* Current total space used (by Zones and Gaps) */
12824. 
12825. SetVariable(VolumeZoneUsed, GapUsed)
12826. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
12827. /* Percentage */
12828. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
12829. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
12830. 
12831. /* Current total of free space requested */
12832. 
12833. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
12834. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
12835. /* Percent. */
12836. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
12837. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
12838. 
12839. /* Current total of free space used */
12840. 
12841. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
12842. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
12843. /* Percent */
12844. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
12845. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
12846. 
12847. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
12848. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
12849. # Xinclude "..\DebugDisplayPause.MyDc"X
12850. 
12851. 
12852. 	# Current Values
12853. 	# Script: ZoneDoCurrentSet
12854. 
12855. # Cluster, Sector, Block adjust for display.
12856. 	# Bytes per cluster is volume specific.
12857. 
12858. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
12859. 
12860. # Current Zone values.
12861. 	# Begin, end and size.
12862. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
12863. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
12864. 
12865. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
12866. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
12867. 
12868. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
12869. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
12870. 
12871. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
12872. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
12873. 
12874. 	SetVariable(ZoneFragments,				"!ZONE210N!")
12875. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
12876. 		
12877. # Current Gap, Actual and Free Values
12878. 	# Gap
12879. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
12880. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
12881. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
12882. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
12883. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
12884. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
12885. 	
12886. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
12887. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
12888. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
12889. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
12890. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
12891. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
12892. 	
12893. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
12894. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
12895. 	
12896. 	# Actual Size and End
12897. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
12898. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
12899. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
12900. 	
12901. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
12902. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
12903. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
12904. 
12905. # Gap Size & Rounding
12906. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
12907. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
12908. 	
12909. 	# Free Space
12910. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
12911. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
12912. 
12913. 	# Script: ZoneStatisticsReportGet
12914. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
12915. 
12916. # Footer:
12917. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
12918. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
12919. #
12920. # Xinclude "..\Commands\DateTimeLastLong.txt"X
12921. #
12922. # What a mess this word based vs is. Try a phrase based version ToDo
12923. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
12924. ------------------
12925.    !SizeWord!!ColonWord!  
12926.    ------------------------
12927.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12928.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12929.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12930. 
12931.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12932.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
12933. 
12934.    !LocationWord!!ColonWord!
12935.    ------------------------
12936.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12937.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
12938.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12939.       
12940.    !GapWordCaps! !SettingsWord!!ColonWord!
12941.    ------------------------
12942.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
12943.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
12944.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12945.                  
12946.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
12947.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
12948.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
12949.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
12950.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
12951.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
12952.      
12953.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
12954.    ------------------------
12955.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12956.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12957.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12958. 
12959. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
12960. ----------------------------------------------------------
12961. ")
12962. #
12963. SetVariable(DateNow, 	DATETIME)
12964. SetVariable(TimeNow, 	Time)
12965. SetVariable(RunTimeNow, 	RunTime)
12966. 
12967. 
12968. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
12969. 
12970. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
12971. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
12972. 
12973. 	# Script: DisplaySetWindowText
12974. # Zone Footer Set Statistics Window Text
12975. 
12976. SetStatisticsWindowText("!Heading!
12977. ----------------------------------------------------------
12978. Zones Processed: 
12979. ----------------------------------------------------------
12980. !ZoneListByLine!
12981. ----------------------------------------------------------
12982. Zone Processing Step:
12983. !ZoneStepByLine!    
12984. ----------------------------------------------------------
12985. ----------------------------------------------------------
12986. CURRENT ZONE:
12987. !ZoneStatisticsReport!
12988. ----------------------------------------------------------
12989. ----------------------------------------------------------
12990. ----------------------------------------------------------
12991. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
12992. ----------------------------------------------------------
12993. !VolumeStatisticsSummary!
12994. !VolumeStatisticsDetail!
12995. ----------------------------------------------------------
12996. ----------------------------------------------------------
12997. Zone Detailed Report:
12998. ----------------------------------------------------------
12999. !ZoneStatisticsDetail!
13000. ----------------------------------------------------------
13001. ")
13002. 
13003. 
13004. 	
13005. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
13006. 
13007. 
13008. 	SetVariable(ZoneStatisticsData, 
13009. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
13010.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
13011.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
13012. 
13013. 
13014. 
13015.  		# Script: ZoneStatisticsDisplay
13016. 	
13017. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
13018. !ZoneStatisticsData!
13019. ')
13020. 
13021. 		# Script: ZoneStatisticsAdd
13022. # Append Zone to Details of each zone.
13023. 		
13024. 	# Add Zone Details to Report.	
13025. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
13026. !ZoneStatisticsReport!
13027. ')
13028. 
13029. 
13030. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
13031. 		# Script: DisplaySetZoneStep
13032. # Increment
13033. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13034. 
13035. # Display this zone step
13036. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
13037. ')
13038. 
13039. # Script: BannerSet
13040. 
13041. # NOTE: Can't round or truncate to integer precision. 
13042. # This internal fields like ZoneCount format really badly.
13043. #  for !RunTimeNow! does not work. None of the date functions do.
13044. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13045. 
13046. SetVariable(HeadingTemp2,	ZoneCount + 0)
13047. 
13048. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13049. 
13050. Title('!Heading!')
13051. 
13052. /* pause(1) */
13053. 
13054. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13055. 
13056. 
13057. # Script: DisplaySetWindowText
13058. # Zone Footer Set Statistics Window Text
13059. 
13060. SetStatisticsWindowText("!Heading!
13061. ----------------------------------------------------------
13062. Zones Processed: 
13063. ----------------------------------------------------------
13064. !ZoneListByLine!
13065. ----------------------------------------------------------
13066. Zone Processing Step:
13067. !ZoneStepByLine!    
13068. ----------------------------------------------------------
13069. ----------------------------------------------------------
13070. CURRENT ZONE:
13071. !ZoneStatisticsReport!
13072. ----------------------------------------------------------
13073. ----------------------------------------------------------
13074. ----------------------------------------------------------
13075. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
13076. ----------------------------------------------------------
13077. !VolumeStatisticsSummary!
13078. !VolumeStatisticsDetail!
13079. ----------------------------------------------------------
13080. ----------------------------------------------------------
13081. Zone Detailed Report:
13082. ----------------------------------------------------------
13083. !ZoneStatisticsDetail!
13084. ----------------------------------------------------------
13085. ")
13086. 
13087. 
13088. 
13089. 
13090. 		# File Action - Type Os Programs - Fast - MoveUpToZone.
13091. # File Action - SortByImportSequence with SkipBlock.
13092. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
13093. 	
13094. 	
13095. 	
13096. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
13097. 		# Script: DisplaySetZoneStep
13098. # Increment
13099. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13100. 
13101. # Display this zone step
13102. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
13103. ')
13104. 
13105. # Script: BannerSet
13106. 
13107. # NOTE: Can't round or truncate to integer precision. 
13108. # This internal fields like ZoneCount format really badly.
13109. #  for !RunTimeNow! does not work. None of the date functions do.
13110. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13111. 
13112. SetVariable(HeadingTemp2,	ZoneCount + 0)
13113. 
13114. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13115. 
13116. Title('!Heading!')
13117. 
13118. /* pause(1) */
13119. 
13120. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13121. 
13122. 
13123. # Script: DisplaySetWindowText
13124. # Zone Footer Set Statistics Window Text
13125. 
13126. SetStatisticsWindowText("!Heading!
13127. ----------------------------------------------------------
13128. Zones Processed: 
13129. ----------------------------------------------------------
13130. !ZoneListByLine!
13131. ----------------------------------------------------------
13132. Zone Processing Step:
13133. !ZoneStepByLine!    
13134. ----------------------------------------------------------
13135. ----------------------------------------------------------
13136. CURRENT ZONE:
13137. !ZoneStatisticsReport!
13138. ----------------------------------------------------------
13139. ----------------------------------------------------------
13140. ----------------------------------------------------------
13141. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
13142. ----------------------------------------------------------
13143. !VolumeStatisticsSummary!
13144. !VolumeStatisticsDetail!
13145. ----------------------------------------------------------
13146. ----------------------------------------------------------
13147. Zone Detailed Report:
13148. ----------------------------------------------------------
13149. !ZoneStatisticsDetail!
13150. ----------------------------------------------------------
13151. ")
13152. 
13153. 
13154. 
13155. 
13156. 	# Script: ZoneDoFooter
13157. 
13158. /* --------------------------------- */
13159. 	# File Select
13160. 		# Select Statments
13161. 	# File Actions 
13162. 		# Standard or OS File Actions.
13163. 		# Resume...
13164. 	
13165. 		# your stuff HERE (X)... post zone (file) file actions code.
13166. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
13167. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
13168. 			# (X)
13169. 		
13170. 			/* ??? Set window? */
13171. 	
13172. 		# ADD THE GAP
13173. 		# Script: GapZoneCommand
13174. # Vacate (good for diagnostics)
13175. # DoNotVacate - DO NOT Vacate (recommended)
13176. 
13177. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
13178. # Script: DisplaySetZoneStep
13179. # Increment
13180. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13181. 
13182. # Display this zone step
13183. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
13184. ')
13185. 
13186. # Script: BannerSet
13187. 
13188. # NOTE: Can't round or truncate to integer precision. 
13189. # This internal fields like ZoneCount format really badly.
13190. #  for !RunTimeNow! does not work. None of the date functions do.
13191. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13192. 
13193. SetVariable(HeadingTemp2,	ZoneCount + 0)
13194. 
13195. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13196. 
13197. Title('!Heading!')
13198. 
13199. /* pause(1) */
13200. 
13201. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13202. 
13203. 
13204. # Script: DisplaySetWindowText
13205. # Zone Footer Set Statistics Window Text
13206. 
13207. SetStatisticsWindowText("!Heading!
13208. ----------------------------------------------------------
13209. Zones Processed: 
13210. ----------------------------------------------------------
13211. !ZoneListByLine!
13212. ----------------------------------------------------------
13213. Zone Processing Step:
13214. !ZoneStepByLine!    
13215. ----------------------------------------------------------
13216. ----------------------------------------------------------
13217. CURRENT ZONE:
13218. !ZoneStatisticsReport!
13219. ----------------------------------------------------------
13220. ----------------------------------------------------------
13221. ----------------------------------------------------------
13222. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
13223. ----------------------------------------------------------
13224. !VolumeStatisticsSummary!
13225. !VolumeStatisticsDetail!
13226. ----------------------------------------------------------
13227. ----------------------------------------------------------
13228. Zone Detailed Report:
13229. ----------------------------------------------------------
13230. !ZoneStatisticsDetail!
13231. ----------------------------------------------------------
13232. ")
13233. 
13234. 
13235. 
13236. 
13237. # *** Moved to setting yours *** 
13238. # (to avoid doing it twice)
13239. # (ie the later wouldn't "overwrite" the former in the usual manner)
13240. 
13241. # Do one or the other:
13242. # DoNotVacate - DO NOT Vacate (recommended)
13243. 
13244. # Vacate
13245. /* AddGap(GapUsedLoc) */
13246. 
13247. # DO Not Vacate
13248. AddGap(GapUsedLoc, DoNotVacate) 
13249. 	
13250. 	
13251. 
13252. # Controlled via settings commands
13253. 
13254. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
13255. 
13256. # Vacate /* AddGap(GapUsed) */
13257. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
13258. 	
13259. 
13260. 		
13261. 	# 
13262. 	FileEnd
13263. /* --------------------------------- */
13264. # your stuff HERE (X)... post zone (file) code.
13265. 
13266. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
13267. # Script: DisplaySetZoneStep
13268. # Increment
13269. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13270. 
13271. # Display this zone step
13272. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
13273. ')
13274. 
13275. # Script: BannerSet
13276. 
13277. # NOTE: Can't round or truncate to integer precision. 
13278. # This internal fields like ZoneCount format really badly.
13279. #  for !RunTimeNow! does not work. None of the date functions do.
13280. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13281. 
13282. SetVariable(HeadingTemp2,	ZoneCount + 0)
13283. 
13284. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13285. 
13286. Title('!Heading!')
13287. 
13288. /* pause(1) */
13289. 
13290. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13291. 
13292. 
13293. # Script: DisplaySetWindowText
13294. # Zone Footer Set Statistics Window Text
13295. 
13296. SetStatisticsWindowText("!Heading!
13297. ----------------------------------------------------------
13298. Zones Processed: 
13299. ----------------------------------------------------------
13300. !ZoneListByLine!
13301. ----------------------------------------------------------
13302. Zone Processing Step:
13303. !ZoneStepByLine!    
13304. ----------------------------------------------------------
13305. ----------------------------------------------------------
13306. CURRENT ZONE:
13307. !ZoneStatisticsReport!
13308. ----------------------------------------------------------
13309. ----------------------------------------------------------
13310. ----------------------------------------------------------
13311. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
13312. ----------------------------------------------------------
13313. !VolumeStatisticsSummary!
13314. !VolumeStatisticsDetail!
13315. ----------------------------------------------------------
13316. ----------------------------------------------------------
13317. Zone Detailed Report:
13318. ----------------------------------------------------------
13319. !ZoneStatisticsDetail!
13320. ----------------------------------------------------------
13321. ")
13322. 
13323. 
13324. 
13325. 
13326. # Script: ZoneWhenFinished
13327. 
13328. # Add the zone to the zone details log:
13329. # This is temporarily disable until logging is fixed
13330. # It is performed during file action to preserve the correct (original) calculations.
13331. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
13332. 
13333. # Add the Select and ZoneSteps to the Zone
13334. # Script: ZoneStatisticsAdd
13335. # Append Zone to Details of each zone.
13336. 		
13337. 	# Add Zone Details to Report.	
13338. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
13339. ----------------------------------------------------------
13340. !ZoneStepByLine!
13341. ---------------------------
13342. !ZoneTypeSelectCurrent!               
13343. ---------------------------
13344. ----------------------------------------------------------
13345. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
13346. ----------------------------------------------------------
13347. ')
13348. 
13349. 
13350. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
13351. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
13352. # 2021-12-14 15:30:00
13353. RunProgram("..\Commands\WriteDateTime.bat LastZone")
13354. # Append Datetime to logs
13355. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
13356. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
13357. 
13358. AppendLogfile("!LogFileName!", "!PeriodWord!")
13359. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
13360. AppendLogfile("!LogFileName!", "!PeriodWord!")
13361. 
13362. # Script: DisplaySetWindowText
13363. # Zone Footer Set Statistics Window Text
13364. 
13365. SetStatisticsWindowText("!Heading!
13366. ----------------------------------------------------------
13367. Zones Processed: 
13368. ----------------------------------------------------------
13369. !ZoneListByLine!
13370. ----------------------------------------------------------
13371. Zone Processing Step:
13372. !ZoneStepByLine!    
13373. ----------------------------------------------------------
13374. ----------------------------------------------------------
13375. CURRENT ZONE:
13376. !ZoneStatisticsReport!
13377. ----------------------------------------------------------
13378. ----------------------------------------------------------
13379. ----------------------------------------------------------
13380. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
13381. ----------------------------------------------------------
13382. !VolumeStatisticsSummary!
13383. !VolumeStatisticsDetail!
13384. ----------------------------------------------------------
13385. ----------------------------------------------------------
13386. Zone Detailed Report:
13387. ----------------------------------------------------------
13388. !ZoneStatisticsDetail!
13389. ----------------------------------------------------------
13390. ")
13391. 
13392. 
13393. 
13394. /* pause() */
13395. /* pause() */
13396. 
13397. 
13398. 
13399. /* ------------------------- */
13400. 
13401. 	
13402. /* ------------------------- */
13403. 
13404. 
13405. /* ------------------------- */
13406. SetVariable(ZoneStepDescription,"System Zones completed.")
13407. # Script: DisplaySetZoneStep
13408. # Increment
13409. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13410. 
13411. # Display this zone step
13412. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
13413. ')
13414. 
13415. # Script: BannerSet
13416. 
13417. # NOTE: Can't round or truncate to integer precision. 
13418. # This internal fields like ZoneCount format really badly.
13419. #  for !RunTimeNow! does not work. None of the date functions do.
13420. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13421. 
13422. SetVariable(HeadingTemp2,	ZoneCount + 0)
13423. 
13424. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13425. 
13426. Title('!Heading!')
13427. 
13428. /* pause(1) */
13429. 
13430. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13431. 
13432. 
13433. # Script: DisplaySetWindowText
13434. # Zone Footer Set Statistics Window Text
13435. 
13436. SetStatisticsWindowText("!Heading!
13437. ----------------------------------------------------------
13438. Zones Processed: 
13439. ----------------------------------------------------------
13440. !ZoneListByLine!
13441. ----------------------------------------------------------
13442. Zone Processing Step:
13443. !ZoneStepByLine!    
13444. ----------------------------------------------------------
13445. ----------------------------------------------------------
13446. CURRENT ZONE:
13447. !ZoneStatisticsReport!
13448. ----------------------------------------------------------
13449. ----------------------------------------------------------
13450. ----------------------------------------------------------
13451. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
13452. ----------------------------------------------------------
13453. !VolumeStatisticsSummary!
13454. !VolumeStatisticsDetail!
13455. ----------------------------------------------------------
13456. ----------------------------------------------------------
13457. Zone Detailed Report:
13458. ----------------------------------------------------------
13459. !ZoneStatisticsDetail!
13460. ----------------------------------------------------------
13461. ")
13462. 
13463. 
13464. 
13465. 
13466. /* ------------------------- */
13467. /* Any Volume Regular Zones */
13468. /* ------------------------- */
13469. /* 2 Zone 8 IdeScripts Ide, Scripts, Support */
13470. # Script: DisplayColors - Zone Dark
13471. # Processed
13472. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
13473. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
13474. 
13475. # Light Green and Yellow
13476. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
13477. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
13478. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
13479. 
13480. # Script: DefragZoneTypeIdeScripts
13481. /* ------------------------- */
13482. /* Zone IdeScripts Ide, Scripts, Support */
13483. 
13484. SetVariable(ZoneLabel,			"!ZoneLabelIdeScripts!")
13485. SetVariable(ZoneDescription,		"!ZoneDescriptionIdeScripts!")
13486. SetVariable(ZoneVolRoundUp,			"!ZoneVolRoundUpIdeScripts!")
13487. SetVariable(ZoneGapSize,			"!ZoneGapSizeIdeScripts!")
13488. 
13489. SetVariable(ZoneTypeSelect,'
13490. IDE and Scripts:
13491. # Script: ZoneDo ZoneTypeSelectIdeScripts
13492. # IdeScripts start.
13493. # NotBlobsArchivesBu start.
13494. # NOT!
13495. (not (
13496. # Blobs start.
13497. (
13498. # BlobsAndExceptions start.
13499. ( not(
13500.   FileName("*.bat")
13501.   or FileName("*.css")
13502.   or FileName("*.dll")
13503.   or FileName("*.exe")
13504.   or FileName("*.htm*")
13505.   or FileName("*.jar")
13506.   or FileName("*.js")
13507.   or FileName("*.script")
13508.   or FileName("*.wsf")
13509.   or (
13510. # Databases start.
13511. (
13512.   FileName("*.crypt*")
13513.   or FileName("*.db*")
13514.   or FileName("*.rdb*")
13515.   or FileName("*.dc*")
13516.   or FileName("*.dict*")
13517.   or FileName("*.?db*")
13518.   or FileName("*.?rdb*")
13519.   or FileName("*.md*")
13520.   or FileName("*.myd")
13521.   or FileName("*.ndf")
13522.   or FileName("*.ns?")
13523.   or FileName("*.pab")
13524.   or FileName("*.pst")
13525.   or FileName("*.sd?*")
13526.   or FileName("*.sq**")
13527.   or FileName("*.tmd")
13528.   or FileName("*.tps")
13529.   or FileName("*.tr*")
13530. )
13531. # Databases end.
13532. 
13533.     # BlobsAndExceptions
13534.     or 
13535. # Data start.
13536. (
13537.   DirectoryName("Data*")
13538.   or DirectoryName("Device*")
13539.   or DirectoryName("Export*")
13540.   or DirectoryName("Import*")
13541.   or DirectoryName("Log*")
13542.   or DirectoryName("*Log")
13543.   or DirectoryName("Maintenance*")
13544.   or DirectoryName("Rec*")
13545.   or DirectoryName("Sales*")
13546.   or DirectoryName("Search*")
13547.   or DirectoryName("User*")
13548. )
13549. # Data end.
13550. 
13551.     # BlobsAndExceptions
13552.   )
13553. ) )
13554. # BlobsAndExceptions end.
13555. 
13556. # Blobs
13557. ) and (
13558.   Size(BlobFileSize,0)
13559.   or (
13560.     FileName("*.arj")
13561.     or FileName("*.bup")
13562.     or FileName("*.bz2")
13563.     or FileName("*.chm")
13564.     or FileName("*.dvr-ms")
13565.     or FileName("*.gz")
13566.     or FileName("*.ifo")
13567.     or FileName("*.lzh")
13568.     or FileName("*.pdf")
13569.     or FileName("*.rpm")
13570.     or FileName("*.wmv")
13571.     or FileName("*.vob")
13572.     or FileName("*.z")
13573.   ) 
13574. )
13575. # Blobs end.
13576. 
13577. # NotBlobsArchivesBu
13578. or 
13579. # Archives start.
13580. (
13581.   DirectoryName("*Archive*")
13582.   or DirectoryName("*History*")
13583.   or DirectoryName("*Old")
13584.   or DirectoryName("* Old *")
13585.   or DirectoryName("Old *")
13586. 
13587.   or FileName("*.7z")
13588.   or FileName("*.cab")
13589.   or FileName("*.iso")
13590.   or FileName("*.msi")
13591.   or FileName("*.old")
13592.   or FileName("*.rar")
13593.   or FileName("*.tar")
13594.   or FileName("*.zip")
13595.   or
13596. # WinSysLow start.
13597. (
13598.   # Bad idea. This pushed lots of programs and data to archive.
13599.   # DirectoryName("$*")
13600.   # or DirectoryName("0*")
13601.   # or DirectoryName("1*")
13602.   # or DirectoryName("2*")
13603.   # or DirectoryName("3*")
13604.   # or DirectoryName("4*")
13605.   # or DirectoryName("5*")
13606.   # or DirectoryName("6*")
13607.   # or DirectoryName("7*")
13608.   # or DirectoryName("8*")
13609.   # or DirectoryName("9*")
13610.   # or 
13611.   DirectoryName("dllcache")
13612.   or DirectoryName("Downloaded Installations")
13613.   or DirectoryName("Ehome")
13614.   or DirectoryName("Fonts")
13615.   or DirectoryName("Help")
13616.   or DirectoryName("I386")
13617.   or DirectoryName("ie?updates")
13618.   or DirectoryName("Installer")
13619.   or DirectoryName("Installshield Installation Information")
13620.   or DirectoryName("IME")
13621.   or DirectoryName("*RECYCLE*")
13622.   or DirectoryName("ServicePackFiles")
13623.   or DirectoryName("SoftwareDistribution")
13624.   or DirectoryName("Speech")
13625.   or DirectoryName("Symbols")
13626.   or DirectoryName("System Volume Information")
13627.   or DirectoryName("windows.old")
13628. )
13629. # WinSysLow end.
13630. 
13631.   # Archives
13632. )
13633. # Archives end.
13634. 
13635. # NotBlobsArchivesBu
13636. or
13637. # Backups start.
13638. (
13639.   DirectoryName("*Backup*")
13640.   or DirectoryName("*Bu")
13641.   or DirectoryName("* Bu *")
13642.   or DirectoryName("Bu *")
13643. 
13644.   or FileName("*.bak")
13645.   or FileName("* - Copy*")
13646. )
13647. # Backups end.
13648. 
13649. or 
13650. FileName("ReferenceMarker.MyDx")
13651. # NotBlobsArchivesBu
13652. ) )
13653. # NotBlobsArchivesBu end.
13654. 
13655. # IdeScripts
13656. and ( 
13657. # Ide start.
13658. (
13659.     DirectoryName("Ide*")
13660.     or DirectoryName("Java*")
13661.     or DirectoryName("Os")
13662. )
13663. # Ide end.
13664. 
13665. # IdeScripts
13666. or  
13667. # Scripts start.
13668. (
13669.   DirectoryName("*Script*")
13670. )
13671. # Scripts end.
13672. 
13673. # IdeScripts
13674. )
13675. # IdeScripts end.
13676. 
13677. ')
13678. 
13679. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
13680. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
13681. 
13682. SetVariable(ZoneStepNoCurrent, 0)
13683. 
13684. 	/* ------------------------- */
13685. # Script: ZoneDoHeader
13686. 
13687. # Script: ZoneWhenStarted
13688. RunProgram("..\Commands\WriteDateTime.bat")
13689. 
13690. # Script: ZoneDoCurrentClear
13691. 
13692. SetVariable(ZoneTypeSelectCurrent, 		"")
13693. SetVariable(ZoneStatisticsData, 		"")
13694. SetVariable(ZoneStepByLine, 			"")
13695. 
13696. SetVariable(ZoneBeginCurrent, 			0)
13697. SetVariable(ZoneBeginPerCurrent, 		0)
13698. SetVariable(ZoneEndCurrent, 			0)
13699. SetVariable(ZoneEndPerCurrent, 			0)
13700. 
13701. SetVariable(ZoneSizeCurrent,			0)
13702. SetVariable(ZoneSizePerCurrent,			0)
13703. 
13704. SetVariable(ZoneGapRequestedCurrent,	0)
13705. SetVariable(ZoneGapRoundedCurrent, 		0)
13706. SetVariable(ZoneGapAdjustedCurrent, 	0)
13707. SetVariable(ZoneGapAvailableCurrent, 	0)
13708. SetVariable(ZoneGapCurrent,				0)
13709. SetVariable(ZoneGapUsedCurrent, 		0)
13710. 
13711. SetVariable(ZoneGapActualCurrent, 		0)
13712. SetVariable(ZoneGapActualPerCurrent, 	0)
13713. 
13714. SetVariable(ZoneSizeActual, 			0)
13715. SetVariable(ZoneSizeActualCurrent,		0)
13716. 
13717. SetVariable(ZoneEndActual, 				0)
13718. SetVariable(ZoneEndActualCurrent,		0)			
13719. SetVariable(ZoneSizeActualPerCurrent, 	0)
13720.       
13721. SetVariable(ZoneFilesFolders,			0)
13722. SetVariable(ZoneFilesFoldersPer,		0) 
13723. 
13724. SetVariable(ZoneFragments,				0)
13725. SetVariable(ZoneFragmentsPer,			0) 
13726. 		
13727. SetVariable(ZoneEndActualCurrent, 		0)
13728. SetVariable(ZoneEndActualPerCurrent, 	0)
13729. 
13730. # Gap Calculation Methodology:
13731. 	# Requested
13732. 	SetVariable(GapRequested, 			0) 
13733. 	SetVariable(GapRequestedStd, 		0) 
13734. 	SetVariable(GapRequestedMft, 		0) 
13735. 	SetVariable(GapRequestedOs, 		0) 
13736. 	SetVariable(GapRequestedOriginal, 	0) 
13737. 	
13738. 	# Gap Adjustments
13739. 	SetVariable(GapRounded, 			0)
13740. 	# SetVariable(GapAdjusted, 			0)
13741. 	SetVariable(GapAvailable, 			0)
13742. 	SetVariable(GapCurrent, 			0)
13743. 	SetVariable(GapActual, 				0)
13744. 	SetVariable(GapUsed, 				0)
13745. 	
13746. 	# Gap Adjustments
13747. 	SetVariable(GapRoundedLoc, 			0)
13748. 	# SetVariable(GapAdjustedLoc, 		0)
13749. 	SetVariable(GapAvailableLoc, 		0)
13750. 	SetVariable(GapCurrentLoc, 			0)
13751. 	SetVariable(GapActualLoc,			0)
13752. 	SetVariable(GapUsedLoc,				0)
13753. 	
13754. 	# Space usage
13755. 	SetVariable(ZoneFreePerRequested, 	0)
13756. 	SetVariable(ZoneFreePerUsed, 		0)
13757. 
13758. # Gap Size & Rounding
13759. 	SetVariable(ZoneGapSizePer, 		0)
13760. 	SetVariable(ZoneVolRoundUpPer, 		0)
13761. 	
13762. 	# Free Space
13763. 	SetVariable(ZoneFreeUsedPer, 		0)
13764. 	SetVariable(ZoneFreeRequestedPer, 	0)
13765. 
13766. # Script: DisplaySetZone
13767. 
13768. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
13769. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
13770. 
13771. # Message ZoneSummary
13772. # SetVariable(ZoneSummary, '
13773. # Zone Summary:
13774. # ')
13775. # Zone processing steps
13776. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
13777. # ')
13778. 
13779. # # Script: BannerDescriptionSet
13780. 
13781. # Script: BannerSet
13782. 
13783. # NOTE: Can't round or truncate to integer precision. 
13784. # This internal fields like ZoneCount format really badly.
13785. #  for !RunTimeNow! does not work. None of the date functions do.
13786. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13787. 
13788. SetVariable(HeadingTemp2,	ZoneCount + 0)
13789. 
13790. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13791. 
13792. Title('!Heading!')
13793. 
13794. /* pause(1) */
13795. 
13796. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13797. 
13798. 
13799. # Script: BannerLog
13800. 
13801. AppendLogfile("!LogFileName!", "!Heading!")
13802. 
13803. 
13804. 
13805. # pause(1)
13806. 
13807. 
13808. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
13809. # Script: DisplaySetZoneStep
13810. # Increment
13811. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13812. 
13813. # Display this zone step
13814. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
13815. ')
13816. 
13817. # Script: BannerSet
13818. 
13819. # NOTE: Can't round or truncate to integer precision. 
13820. # This internal fields like ZoneCount format really badly.
13821. #  for !RunTimeNow! does not work. None of the date functions do.
13822. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13823. 
13824. SetVariable(HeadingTemp2,	ZoneCount + 0)
13825. 
13826. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13827. 
13828. Title('!Heading!')
13829. 
13830. /* pause(1) */
13831. 
13832. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13833. 
13834. 
13835. # Script: DisplaySetWindowText
13836. # Zone Footer Set Statistics Window Text
13837. 
13838. SetStatisticsWindowText("!Heading!
13839. ----------------------------------------------------------
13840. Zones Processed: 
13841. ----------------------------------------------------------
13842. !ZoneListByLine!
13843. ----------------------------------------------------------
13844. Zone Processing Step:
13845. !ZoneStepByLine!    
13846. ----------------------------------------------------------
13847. ----------------------------------------------------------
13848. CURRENT ZONE:
13849. !ZoneStatisticsReport!
13850. ----------------------------------------------------------
13851. ----------------------------------------------------------
13852. ----------------------------------------------------------
13853. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
13854. ----------------------------------------------------------
13855. !VolumeStatisticsSummary!
13856. !VolumeStatisticsDetail!
13857. ----------------------------------------------------------
13858. ----------------------------------------------------------
13859. Zone Detailed Report:
13860. ----------------------------------------------------------
13861. !ZoneStatisticsDetail!
13862. ----------------------------------------------------------
13863. ")
13864. 
13865. 
13866. 
13867. 
13868. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
13869. 
13870. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
13871. # Script: DisplaySetZoneStep
13872. # Increment
13873. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13874. 
13875. # Display this zone step
13876. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
13877. ')
13878. 
13879. # Script: BannerSet
13880. 
13881. # NOTE: Can't round or truncate to integer precision. 
13882. # This internal fields like ZoneCount format really badly.
13883. #  for !RunTimeNow! does not work. None of the date functions do.
13884. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13885. 
13886. SetVariable(HeadingTemp2,	ZoneCount + 0)
13887. 
13888. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13889. 
13890. Title('!Heading!')
13891. 
13892. /* pause(1) */
13893. 
13894. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13895. 
13896. 
13897. # Script: DisplaySetWindowText
13898. # Zone Footer Set Statistics Window Text
13899. 
13900. SetStatisticsWindowText("!Heading!
13901. ----------------------------------------------------------
13902. Zones Processed: 
13903. ----------------------------------------------------------
13904. !ZoneListByLine!
13905. ----------------------------------------------------------
13906. Zone Processing Step:
13907. !ZoneStepByLine!    
13908. ----------------------------------------------------------
13909. ----------------------------------------------------------
13910. CURRENT ZONE:
13911. !ZoneStatisticsReport!
13912. ----------------------------------------------------------
13913. ----------------------------------------------------------
13914. ----------------------------------------------------------
13915. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
13916. ----------------------------------------------------------
13917. !VolumeStatisticsSummary!
13918. !VolumeStatisticsDetail!
13919. ----------------------------------------------------------
13920. ----------------------------------------------------------
13921. Zone Detailed Report:
13922. ----------------------------------------------------------
13923. !ZoneStatisticsDetail!
13924. ----------------------------------------------------------
13925. ")
13926. 
13927. 
13928. 
13929. 
13930. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
13931. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
13932. 
13933. # Script: BannerSet
13934. 
13935. # NOTE: Can't round or truncate to integer precision. 
13936. # This internal fields like ZoneCount format really badly.
13937. #  for !RunTimeNow! does not work. None of the date functions do.
13938. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13939. 
13940. SetVariable(HeadingTemp2,	ZoneCount + 0)
13941. 
13942. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13943. 
13944. Title('!Heading!')
13945. 
13946. /* pause(1) */
13947. 
13948. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
13949. 
13950. 
13951. # Script: BannerLog
13952. 
13953. AppendLogfile("!LogFileName!", "!Heading!")
13954. 
13955. 
13956. 
13957. # LOGGING:
13958. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
13959. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
13960. 
13961. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
13962. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:00")
13963. # 2021-12-14 15:30:00 
13964. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:05 !ZoneLabel! !ZoneDescription!")
13965. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
13966. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:05 !ZoneLabel! !ZoneDescription!")
13967. 
13968. 
13969. # Add zone to list of zones:
13970. SetVariable(ZoneListByLine, "!ZoneListByLine!
13971. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
13972. # Script: DisplaySetWindowText
13973. # Zone Footer Set Statistics Window Text
13974. 
13975. SetStatisticsWindowText("!Heading!
13976. ----------------------------------------------------------
13977. Zones Processed: 
13978. ----------------------------------------------------------
13979. !ZoneListByLine!
13980. ----------------------------------------------------------
13981. Zone Processing Step:
13982. !ZoneStepByLine!    
13983. ----------------------------------------------------------
13984. ----------------------------------------------------------
13985. CURRENT ZONE:
13986. !ZoneStatisticsReport!
13987. ----------------------------------------------------------
13988. ----------------------------------------------------------
13989. ----------------------------------------------------------
13990. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
13991. ----------------------------------------------------------
13992. !VolumeStatisticsSummary!
13993. !VolumeStatisticsDetail!
13994. ----------------------------------------------------------
13995. ----------------------------------------------------------
13996. Zone Detailed Report:
13997. ----------------------------------------------------------
13998. !ZoneStatisticsDetail!
13999. ----------------------------------------------------------
14000. ")
14001. 
14002. 
14003. 
14004. 
14005. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
14006. # Script: DisplaySetZoneStep
14007. # Increment
14008. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14009. 
14010. # Display this zone step
14011. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
14012. ')
14013. 
14014. # Script: BannerSet
14015. 
14016. # NOTE: Can't round or truncate to integer precision. 
14017. # This internal fields like ZoneCount format really badly.
14018. #  for !RunTimeNow! does not work. None of the date functions do.
14019. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
14020. 
14021. SetVariable(HeadingTemp2,	ZoneCount + 0)
14022. 
14023. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14024. 
14025. Title('!Heading!')
14026. 
14027. /* pause(1) */
14028. 
14029. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14030. 
14031. 
14032. # Script: DisplaySetWindowText
14033. # Zone Footer Set Statistics Window Text
14034. 
14035. SetStatisticsWindowText("!Heading!
14036. ----------------------------------------------------------
14037. Zones Processed: 
14038. ----------------------------------------------------------
14039. !ZoneListByLine!
14040. ----------------------------------------------------------
14041. Zone Processing Step:
14042. !ZoneStepByLine!    
14043. ----------------------------------------------------------
14044. ----------------------------------------------------------
14045. CURRENT ZONE:
14046. !ZoneStatisticsReport!
14047. ----------------------------------------------------------
14048. ----------------------------------------------------------
14049. ----------------------------------------------------------
14050. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
14051. ----------------------------------------------------------
14052. !VolumeStatisticsSummary!
14053. !VolumeStatisticsDetail!
14054. ----------------------------------------------------------
14055. ----------------------------------------------------------
14056. Zone Detailed Report:
14057. ----------------------------------------------------------
14058. !ZoneStatisticsDetail!
14059. ----------------------------------------------------------
14060. ")
14061. 
14062. 
14063. 
14064. 
14065. # your stuff HERE (X)... pre file select code.
14066. 
14067. /* --------------------------------- */
14068. 	FileSelect
14069. 
14070. 		# your stuff can't really go here (errors.)
14071. 		# maybe for some reason I don't know of...
14072. 	
14073. 		# Actions next...
14074. 	# Script: ZoneDo ZoneTypeSelectIdeScripts
14075. # IdeScripts start.
14076. # NotBlobsArchivesBu start.
14077. # NOT!
14078. (not (
14079. # Blobs start.
14080. (
14081. # BlobsAndExceptions start.
14082. ( not(
14083.   FileName("*.bat")
14084.   or FileName("*.css")
14085.   or FileName("*.dll")
14086.   or FileName("*.exe")
14087.   or FileName("*.htm*")
14088.   or FileName("*.jar")
14089.   or FileName("*.js")
14090.   or FileName("*.script")
14091.   or FileName("*.wsf")
14092.   or (
14093. # Databases start.
14094. (
14095.   FileName("*.crypt*")
14096.   or FileName("*.db*")
14097.   or FileName("*.rdb*")
14098.   or FileName("*.dc*")
14099.   or FileName("*.dict*")
14100.   or FileName("*.?db*")
14101.   or FileName("*.?rdb*")
14102.   or FileName("*.md*")
14103.   or FileName("*.myd")
14104.   or FileName("*.ndf")
14105.   or FileName("*.ns?")
14106.   or FileName("*.pab")
14107.   or FileName("*.pst")
14108.   or FileName("*.sd?*")
14109.   or FileName("*.sq**")
14110.   or FileName("*.tmd")
14111.   or FileName("*.tps")
14112.   or FileName("*.tr*")
14113. )
14114. # Databases end.
14115. 
14116.     # BlobsAndExceptions
14117.     or 
14118. # Data start.
14119. (
14120.   DirectoryName("Data*")
14121.   or DirectoryName("Device*")
14122.   or DirectoryName("Export*")
14123.   or DirectoryName("Import*")
14124.   or DirectoryName("Log*")
14125.   or DirectoryName("*Log")
14126.   or DirectoryName("Maintenance*")
14127.   or DirectoryName("Rec*")
14128.   or DirectoryName("Sales*")
14129.   or DirectoryName("Search*")
14130.   or DirectoryName("User*")
14131. )
14132. # Data end.
14133. 
14134.     # BlobsAndExceptions
14135.   )
14136. ) )
14137. # BlobsAndExceptions end.
14138. 
14139. # Blobs
14140. ) and (
14141.   Size(BlobFileSize,0)
14142.   or (
14143.     FileName("*.arj")
14144.     or FileName("*.bup")
14145.     or FileName("*.bz2")
14146.     or FileName("*.chm")
14147.     or FileName("*.dvr-ms")
14148.     or FileName("*.gz")
14149.     or FileName("*.ifo")
14150.     or FileName("*.lzh")
14151.     or FileName("*.pdf")
14152.     or FileName("*.rpm")
14153.     or FileName("*.wmv")
14154.     or FileName("*.vob")
14155.     or FileName("*.z")
14156.   ) 
14157. )
14158. # Blobs end.
14159. 
14160. # NotBlobsArchivesBu
14161. or 
14162. # Archives start.
14163. (
14164.   DirectoryName("*Archive*")
14165.   or DirectoryName("*History*")
14166.   or DirectoryName("*Old")
14167.   or DirectoryName("* Old *")
14168.   or DirectoryName("Old *")
14169. 
14170.   or FileName("*.7z")
14171.   or FileName("*.cab")
14172.   or FileName("*.iso")
14173.   or FileName("*.msi")
14174.   or FileName("*.old")
14175.   or FileName("*.rar")
14176.   or FileName("*.tar")
14177.   or FileName("*.zip")
14178.   or
14179. # WinSysLow start.
14180. (
14181.   # Bad idea. This pushed lots of programs and data to archive.
14182.   # DirectoryName("$*")
14183.   # or DirectoryName("0*")
14184.   # or DirectoryName("1*")
14185.   # or DirectoryName("2*")
14186.   # or DirectoryName("3*")
14187.   # or DirectoryName("4*")
14188.   # or DirectoryName("5*")
14189.   # or DirectoryName("6*")
14190.   # or DirectoryName("7*")
14191.   # or DirectoryName("8*")
14192.   # or DirectoryName("9*")
14193.   # or 
14194.   DirectoryName("dllcache")
14195.   or DirectoryName("Downloaded Installations")
14196.   or DirectoryName("Ehome")
14197.   or DirectoryName("Fonts")
14198.   or DirectoryName("Help")
14199.   or DirectoryName("I386")
14200.   or DirectoryName("ie?updates")
14201.   or DirectoryName("Installer")
14202.   or DirectoryName("Installshield Installation Information")
14203.   or DirectoryName("IME")
14204.   or DirectoryName("*RECYCLE*")
14205.   or DirectoryName("ServicePackFiles")
14206.   or DirectoryName("SoftwareDistribution")
14207.   or DirectoryName("Speech")
14208.   or DirectoryName("Symbols")
14209.   or DirectoryName("System Volume Information")
14210.   or DirectoryName("windows.old")
14211. )
14212. # WinSysLow end.
14213. 
14214.   # Archives
14215. )
14216. # Archives end.
14217. 
14218. # NotBlobsArchivesBu
14219. or
14220. # Backups start.
14221. (
14222.   DirectoryName("*Backup*")
14223.   or DirectoryName("*Bu")
14224.   or DirectoryName("* Bu *")
14225.   or DirectoryName("Bu *")
14226. 
14227.   or FileName("*.bak")
14228.   or FileName("* - Copy*")
14229. )
14230. # Backups end.
14231. 
14232. or 
14233. FileName("ReferenceMarker.MyDx")
14234. # NotBlobsArchivesBu
14235. ) )
14236. # NotBlobsArchivesBu end.
14237. 
14238. # IdeScripts
14239. and ( 
14240. # Ide start.
14241. (
14242.     DirectoryName("Ide*")
14243.     or DirectoryName("Java*")
14244.     or DirectoryName("Os")
14245. )
14246. # Ide end.
14247. 
14248. # IdeScripts
14249. or  
14250. # Scripts start.
14251. (
14252.   DirectoryName("*Script*")
14253. )
14254. # Scripts end.
14255. 
14256. # IdeScripts
14257. )
14258. # IdeScripts end.
14259. 
14260. 	# Script: ZoneDoAction
14261. # Zone Do File Action - SortByName.
14262. 
14263. 	FileActions
14264. 
14265. 			# Script: GapZoneCalc
14266. 	# Gap
14267. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
14268. 		# Script: DisplaySetZoneStep
14269. # Increment
14270. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14271. 
14272. # Display this zone step
14273. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
14274. ')
14275. 
14276. # Script: BannerSet
14277. 
14278. # NOTE: Can't round or truncate to integer precision. 
14279. # This internal fields like ZoneCount format really badly.
14280. #  for !RunTimeNow! does not work. None of the date functions do.
14281. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
14282. 
14283. SetVariable(HeadingTemp2,	ZoneCount + 0)
14284. 
14285. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14286. 
14287. Title('!Heading!')
14288. 
14289. /* pause(1) */
14290. 
14291. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14292. 
14293. 
14294. # Script: DisplaySetWindowText
14295. # Zone Footer Set Statistics Window Text
14296. 
14297. SetStatisticsWindowText("!Heading!
14298. ----------------------------------------------------------
14299. Zones Processed: 
14300. ----------------------------------------------------------
14301. !ZoneListByLine!
14302. ----------------------------------------------------------
14303. Zone Processing Step:
14304. !ZoneStepByLine!    
14305. ----------------------------------------------------------
14306. ----------------------------------------------------------
14307. CURRENT ZONE:
14308. !ZoneStatisticsReport!
14309. ----------------------------------------------------------
14310. ----------------------------------------------------------
14311. ----------------------------------------------------------
14312. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
14313. ----------------------------------------------------------
14314. !VolumeStatisticsSummary!
14315. !VolumeStatisticsDetail!
14316. ----------------------------------------------------------
14317. ----------------------------------------------------------
14318. Zone Detailed Report:
14319. ----------------------------------------------------------
14320. !ZoneStatisticsDetail!
14321. ----------------------------------------------------------
14322. ")
14323. 
14324. 
14325. 
14326. 	
14327. 	# ACTUAL GAP
14328. 		/* AddGap Variant. */
14329. 	  	# Script: GapZoneSet
14330. # Zone Do Gap
14331. # Gap Calculation Methods:
14332. 
14333. /* 1) Anything you need to add first. */
14334. /* empty */
14335. 
14336. /* ------------------------- */
14337. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
14338. 	# GapRequestedStd.
14339. 
14340. 		/* ------------------------- */
14341. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
14342. 
14343. 		# Gap Calculation Methods:
14344. 
14345. /* AddGap Variants */
14346. 
14347. 	/* Standard */
14348. 		# Gap Calculation Methods:
14349. 	/* AddGap Variants */
14350. 	/* Standard */
14351. 
14352. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
14353. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
14354. 
14355. 	SetVariable(GapRequested, GapRequestedStd)
14356. 	
14357. 
14358. 	/* MFT Low High Method */
14359. 		# Gap Calculation Methods:
14360. 	/* AddGap Variants */
14361. 	/* MFT Low High Method */
14362. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
14363. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
14364. 	SetVariable(GapRequested, GapRequestedMft)
14365. 	
14366. 
14367. 	/* OS Volume Type Method */
14368. 		# Gap Calculation Methods:
14369. 	/* AddGap Variants */
14370. 	/* OS Volume Type Method */
14371. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
14372. 	SetVariable(GapRequested, GapRequestedOs)
14373. 
14374. 
14375. 
14376. /* MakeGap Variants */
14377. 
14378. 	/* Original Os 1-3 + MFT 2 */
14379. 		# Gap Calculation Methods:
14380. 	/* MakeGap Variants */
14381. 	/* Original Os 1-3 + MFT 2 */
14382. 	/* plus MFT gap placed inline at the dividing zone. */
14383. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
14384. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
14385. 	SetVariable(GapRequested, GapRequestedOrig)
14386. 	
14387. 	
14388. /* Note: You could comment out the ones not in use */
14389. /* However having the data in the log is useful. */
14390. /* Therefore the following line is otherwise needed. */
14391. 
14392. /* Standard used */
14393. 
14394. SetVariable(GapRequested, GapRequestedStd)
14395. 
14396. # Gap Calculation Methods:
14397. 
14398. /* AddGap Variants */
14399. 	/* Standard */
14400. 	/* MFT Low High Method */
14401. 	/* OS Volume Type Method */
14402. 
14403. /* MakeGap Variants */
14404. 	/* Original Os 1-3 + MFT 2 */
14405. 
14406. /* Note: You could comment out the ones not in use */
14407. /* However having the data in the log is useful. */
14408. /* Therefore the following line is otherwise needed. */
14409. 
14410. /* Standard is used currently */
14411. 
14412. 
14413. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
14414. 
14415. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
14416. 
14417. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
14418. 
14419. /* ------------------------- */
14420. /* 3) SMALL ZONE ADJUSTMENT. */
14421. /* Gab cant be larger than half the Zone Size. */
14422. 
14423. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
14424. 	
14425. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
14426. 
14427. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
14428. 
14429. /* ------------------------- */
14430. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
14431. # Gap Adjustments.
14432. 
14433. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
14434. 	
14435. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
14436. 
14437. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
14438. 
14439. /* ------------------------- */
14440. # BYPASS THIS.
14441. 	/* This is definitely wrong. */
14442. 	/* The question is can we steal gap from the next zone */
14443. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
14444. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
14445. 		# Zone Overflow.
14446. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
14447. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
14448. 
14449. /* ------------------------- */
14450. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
14451. # Remaining free space available.
14452. 
14453. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
14454. 	
14455. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
14456. 
14457. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
14458. 
14459. /* ------------------------- */
14460. # CURRENT gap to use.
14461. 
14462. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
14463. 
14464. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
14465. 
14466. /* ------------------------- */
14467. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
14468. # Debugging.
14469. 
14470. 	SetVariable(GapUsed, GapCurrent) // for debugging
14471. 
14472. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
14473. 
14474. 		# Your code HERE
14475. 
14476. /* ------------------------- */
14477. /* 7) YOUR CODE. */
14478. # YOUR CODE HERE:
14479. 	# INPUT: GapCurrent or GapCurrentLoc
14480. 	# OUTPUT: GapUsed...
14481. 
14482. /* ------------------------- */
14483. # Gap Size.
14484. # Actual Size of Gap.
14485. 
14486. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
14487. 
14488. /* ------------------------- */
14489. 
14490. 	
14491. 	# Zone Statistics	
14492. 		# Script: ZoneStatisticsGet
14493. # Zone / Volume Statistics and Display
14494. 		
14495. 	# Accumulate Totals
14496.   	# Script: ZoneDoVolumeTotals
14497. 
14498. /* Current total space used (by Zones and Gaps) */
14499. 
14500. SetVariable(VolumeZoneUsed, GapUsed)
14501. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
14502. /* Percentage */
14503. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
14504. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
14505. 
14506. /* Current total of free space requested */
14507. 
14508. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
14509. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
14510. /* Percent. */
14511. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
14512. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
14513. 
14514. /* Current total of free space used */
14515. 
14516. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
14517. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
14518. /* Percent */
14519. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
14520. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
14521. 
14522. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
14523. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
14524. # Xinclude "..\DebugDisplayPause.MyDc"X
14525. 
14526. 
14527. 	# Current Values
14528. 	# Script: ZoneDoCurrentSet
14529. 
14530. # Cluster, Sector, Block adjust for display.
14531. 	# Bytes per cluster is volume specific.
14532. 
14533. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
14534. 
14535. # Current Zone values.
14536. 	# Begin, end and size.
14537. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
14538. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
14539. 
14540. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
14541. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
14542. 
14543. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
14544. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
14545. 
14546. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
14547. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
14548. 
14549. 	SetVariable(ZoneFragments,				"!ZONE210N!")
14550. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
14551. 		
14552. # Current Gap, Actual and Free Values
14553. 	# Gap
14554. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
14555. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
14556. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
14557. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
14558. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
14559. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
14560. 	
14561. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
14562. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
14563. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
14564. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
14565. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
14566. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
14567. 	
14568. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
14569. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
14570. 	
14571. 	# Actual Size and End
14572. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
14573. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
14574. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
14575. 	
14576. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
14577. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
14578. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
14579. 
14580. # Gap Size & Rounding
14581. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
14582. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
14583. 	
14584. 	# Free Space
14585. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
14586. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
14587. 
14588. 	# Script: ZoneStatisticsReportGet
14589. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
14590. 
14591. # Footer:
14592. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
14593. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
14594. #
14595. # Xinclude "..\Commands\DateTimeLastLong.txt"X
14596. #
14597. # What a mess this word based vs is. Try a phrase based version ToDo
14598. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
14599. ------------------
14600.    !SizeWord!!ColonWord!  
14601.    ------------------------
14602.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14603.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14604.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14605. 
14606.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14607.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
14608. 
14609.    !LocationWord!!ColonWord!
14610.    ------------------------
14611.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14612.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
14613.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14614.       
14615.    !GapWordCaps! !SettingsWord!!ColonWord!
14616.    ------------------------
14617.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
14618.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
14619.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14620.                  
14621.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
14622.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
14623.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
14624.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
14625.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
14626.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
14627.      
14628.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
14629.    ------------------------
14630.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14631.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14632.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14633. 
14634. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
14635. ----------------------------------------------------------
14636. ")
14637. #
14638. SetVariable(DateNow, 	DATETIME)
14639. SetVariable(TimeNow, 	Time)
14640. SetVariable(RunTimeNow, 	RunTime)
14641. 
14642. 
14643. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
14644. 
14645. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
14646. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
14647. 
14648. 	# Script: DisplaySetWindowText
14649. # Zone Footer Set Statistics Window Text
14650. 
14651. SetStatisticsWindowText("!Heading!
14652. ----------------------------------------------------------
14653. Zones Processed: 
14654. ----------------------------------------------------------
14655. !ZoneListByLine!
14656. ----------------------------------------------------------
14657. Zone Processing Step:
14658. !ZoneStepByLine!    
14659. ----------------------------------------------------------
14660. ----------------------------------------------------------
14661. CURRENT ZONE:
14662. !ZoneStatisticsReport!
14663. ----------------------------------------------------------
14664. ----------------------------------------------------------
14665. ----------------------------------------------------------
14666. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
14667. ----------------------------------------------------------
14668. !VolumeStatisticsSummary!
14669. !VolumeStatisticsDetail!
14670. ----------------------------------------------------------
14671. ----------------------------------------------------------
14672. Zone Detailed Report:
14673. ----------------------------------------------------------
14674. !ZoneStatisticsDetail!
14675. ----------------------------------------------------------
14676. ")
14677. 
14678. 
14679. 	
14680. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
14681. 
14682. 
14683. 	SetVariable(ZoneStatisticsData, 
14684. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
14685.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
14686.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
14687. 
14688. 
14689. 
14690.  		# Script: ZoneStatisticsDisplay
14691. 	
14692. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
14693. !ZoneStatisticsData!
14694. ')
14695. 
14696. 		# Script: ZoneStatisticsAdd
14697. # Append Zone to Details of each zone.
14698. 		
14699. 	# Add Zone Details to Report.	
14700. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
14701. !ZoneStatisticsReport!
14702. ')
14703. 
14704. 	
14705. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
14706. 		# Script: DisplaySetZoneStep
14707. # Increment
14708. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14709. 
14710. # Display this zone step
14711. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
14712. ')
14713. 
14714. # Script: BannerSet
14715. 
14716. # NOTE: Can't round or truncate to integer precision. 
14717. # This internal fields like ZoneCount format really badly.
14718. #  for !RunTimeNow! does not work. None of the date functions do.
14719. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
14720. 
14721. SetVariable(HeadingTemp2,	ZoneCount + 0)
14722. 
14723. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14724. 
14725. Title('!Heading!')
14726. 
14727. /* pause(1) */
14728. 
14729. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14730. 
14731. 
14732. # Script: DisplaySetWindowText
14733. # Zone Footer Set Statistics Window Text
14734. 
14735. SetStatisticsWindowText("!Heading!
14736. ----------------------------------------------------------
14737. Zones Processed: 
14738. ----------------------------------------------------------
14739. !ZoneListByLine!
14740. ----------------------------------------------------------
14741. Zone Processing Step:
14742. !ZoneStepByLine!    
14743. ----------------------------------------------------------
14744. ----------------------------------------------------------
14745. CURRENT ZONE:
14746. !ZoneStatisticsReport!
14747. ----------------------------------------------------------
14748. ----------------------------------------------------------
14749. ----------------------------------------------------------
14750. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
14751. ----------------------------------------------------------
14752. !VolumeStatisticsSummary!
14753. !VolumeStatisticsDetail!
14754. ----------------------------------------------------------
14755. ----------------------------------------------------------
14756. Zone Detailed Report:
14757. ----------------------------------------------------------
14758. !ZoneStatisticsDetail!
14759. ----------------------------------------------------------
14760. ")
14761. 
14762. 
14763. 
14764. 
14765. 		# File Action - All - Full -  SortByCreationDate
14766. # File Action - ZoneDoActionSortByCreationDateFull
14767. 	SortByCreationDate(Ascending)
14768. 	
14769. 
14770. 
14771. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
14772. 		# Script: DisplaySetZoneStep
14773. # Increment
14774. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14775. 
14776. # Display this zone step
14777. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
14778. ')
14779. 
14780. # Script: BannerSet
14781. 
14782. # NOTE: Can't round or truncate to integer precision. 
14783. # This internal fields like ZoneCount format really badly.
14784. #  for !RunTimeNow! does not work. None of the date functions do.
14785. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
14786. 
14787. SetVariable(HeadingTemp2,	ZoneCount + 0)
14788. 
14789. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14790. 
14791. Title('!Heading!')
14792. 
14793. /* pause(1) */
14794. 
14795. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14796. 
14797. 
14798. # Script: DisplaySetWindowText
14799. # Zone Footer Set Statistics Window Text
14800. 
14801. SetStatisticsWindowText("!Heading!
14802. ----------------------------------------------------------
14803. Zones Processed: 
14804. ----------------------------------------------------------
14805. !ZoneListByLine!
14806. ----------------------------------------------------------
14807. Zone Processing Step:
14808. !ZoneStepByLine!    
14809. ----------------------------------------------------------
14810. ----------------------------------------------------------
14811. CURRENT ZONE:
14812. !ZoneStatisticsReport!
14813. ----------------------------------------------------------
14814. ----------------------------------------------------------
14815. ----------------------------------------------------------
14816. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
14817. ----------------------------------------------------------
14818. !VolumeStatisticsSummary!
14819. !VolumeStatisticsDetail!
14820. ----------------------------------------------------------
14821. ----------------------------------------------------------
14822. Zone Detailed Report:
14823. ----------------------------------------------------------
14824. !ZoneStatisticsDetail!
14825. ----------------------------------------------------------
14826. ")
14827. 
14828. 
14829. 
14830. 
14831. 	# Script: ZoneDoFooter
14832. 
14833. /* --------------------------------- */
14834. 	# File Select
14835. 		# Select Statments
14836. 	# File Actions 
14837. 		# Standard or OS File Actions.
14838. 		# Resume...
14839. 	
14840. 		# your stuff HERE (X)... post zone (file) file actions code.
14841. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
14842. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
14843. 			# (X)
14844. 		
14845. 			/* ??? Set window? */
14846. 	
14847. 		# ADD THE GAP
14848. 		# Script: GapZoneCommand
14849. # Vacate (good for diagnostics)
14850. # DoNotVacate - DO NOT Vacate (recommended)
14851. 
14852. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
14853. # Script: DisplaySetZoneStep
14854. # Increment
14855. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14856. 
14857. # Display this zone step
14858. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
14859. ')
14860. 
14861. # Script: BannerSet
14862. 
14863. # NOTE: Can't round or truncate to integer precision. 
14864. # This internal fields like ZoneCount format really badly.
14865. #  for !RunTimeNow! does not work. None of the date functions do.
14866. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
14867. 
14868. SetVariable(HeadingTemp2,	ZoneCount + 0)
14869. 
14870. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14871. 
14872. Title('!Heading!')
14873. 
14874. /* pause(1) */
14875. 
14876. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14877. 
14878. 
14879. # Script: DisplaySetWindowText
14880. # Zone Footer Set Statistics Window Text
14881. 
14882. SetStatisticsWindowText("!Heading!
14883. ----------------------------------------------------------
14884. Zones Processed: 
14885. ----------------------------------------------------------
14886. !ZoneListByLine!
14887. ----------------------------------------------------------
14888. Zone Processing Step:
14889. !ZoneStepByLine!    
14890. ----------------------------------------------------------
14891. ----------------------------------------------------------
14892. CURRENT ZONE:
14893. !ZoneStatisticsReport!
14894. ----------------------------------------------------------
14895. ----------------------------------------------------------
14896. ----------------------------------------------------------
14897. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
14898. ----------------------------------------------------------
14899. !VolumeStatisticsSummary!
14900. !VolumeStatisticsDetail!
14901. ----------------------------------------------------------
14902. ----------------------------------------------------------
14903. Zone Detailed Report:
14904. ----------------------------------------------------------
14905. !ZoneStatisticsDetail!
14906. ----------------------------------------------------------
14907. ")
14908. 
14909. 
14910. 
14911. 
14912. # *** Moved to setting yours *** 
14913. # (to avoid doing it twice)
14914. # (ie the later wouldn't "overwrite" the former in the usual manner)
14915. 
14916. # Do one or the other:
14917. # DoNotVacate - DO NOT Vacate (recommended)
14918. 
14919. # Vacate
14920. /* AddGap(GapUsedLoc) */
14921. 
14922. # DO Not Vacate
14923. AddGap(GapUsedLoc, DoNotVacate) 
14924. 	
14925. 	
14926. 
14927. # Controlled via settings commands
14928. 
14929. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
14930. 
14931. # Vacate /* AddGap(GapUsed) */
14932. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
14933. 	
14934. 
14935. 		
14936. 	# 
14937. 	FileEnd
14938. /* --------------------------------- */
14939. # your stuff HERE (X)... post zone (file) code.
14940. 
14941. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
14942. # Script: DisplaySetZoneStep
14943. # Increment
14944. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14945. 
14946. # Display this zone step
14947. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
14948. ')
14949. 
14950. # Script: BannerSet
14951. 
14952. # NOTE: Can't round or truncate to integer precision. 
14953. # This internal fields like ZoneCount format really badly.
14954. #  for !RunTimeNow! does not work. None of the date functions do.
14955. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
14956. 
14957. SetVariable(HeadingTemp2,	ZoneCount + 0)
14958. 
14959. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14960. 
14961. Title('!Heading!')
14962. 
14963. /* pause(1) */
14964. 
14965. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
14966. 
14967. 
14968. # Script: DisplaySetWindowText
14969. # Zone Footer Set Statistics Window Text
14970. 
14971. SetStatisticsWindowText("!Heading!
14972. ----------------------------------------------------------
14973. Zones Processed: 
14974. ----------------------------------------------------------
14975. !ZoneListByLine!
14976. ----------------------------------------------------------
14977. Zone Processing Step:
14978. !ZoneStepByLine!    
14979. ----------------------------------------------------------
14980. ----------------------------------------------------------
14981. CURRENT ZONE:
14982. !ZoneStatisticsReport!
14983. ----------------------------------------------------------
14984. ----------------------------------------------------------
14985. ----------------------------------------------------------
14986. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
14987. ----------------------------------------------------------
14988. !VolumeStatisticsSummary!
14989. !VolumeStatisticsDetail!
14990. ----------------------------------------------------------
14991. ----------------------------------------------------------
14992. Zone Detailed Report:
14993. ----------------------------------------------------------
14994. !ZoneStatisticsDetail!
14995. ----------------------------------------------------------
14996. ")
14997. 
14998. 
14999. 
15000. 
15001. # Script: ZoneWhenFinished
15002. 
15003. # Add the zone to the zone details log:
15004. # This is temporarily disable until logging is fixed
15005. # It is performed during file action to preserve the correct (original) calculations.
15006. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
15007. 
15008. # Add the Select and ZoneSteps to the Zone
15009. # Script: ZoneStatisticsAdd
15010. # Append Zone to Details of each zone.
15011. 		
15012. 	# Add Zone Details to Report.	
15013. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
15014. ----------------------------------------------------------
15015. !ZoneStepByLine!
15016. ---------------------------
15017. !ZoneTypeSelectCurrent!               
15018. ---------------------------
15019. ----------------------------------------------------------
15020. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
15021. ----------------------------------------------------------
15022. ')
15023. 
15024. 
15025. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
15026. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
15027. # 2021-12-14 15:30:00
15028. RunProgram("..\Commands\WriteDateTime.bat LastZone")
15029. # Append Datetime to logs
15030. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
15031. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
15032. 
15033. AppendLogfile("!LogFileName!", "!PeriodWord!")
15034. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
15035. AppendLogfile("!LogFileName!", "!PeriodWord!")
15036. 
15037. # Script: DisplaySetWindowText
15038. # Zone Footer Set Statistics Window Text
15039. 
15040. SetStatisticsWindowText("!Heading!
15041. ----------------------------------------------------------
15042. Zones Processed: 
15043. ----------------------------------------------------------
15044. !ZoneListByLine!
15045. ----------------------------------------------------------
15046. Zone Processing Step:
15047. !ZoneStepByLine!    
15048. ----------------------------------------------------------
15049. ----------------------------------------------------------
15050. CURRENT ZONE:
15051. !ZoneStatisticsReport!
15052. ----------------------------------------------------------
15053. ----------------------------------------------------------
15054. ----------------------------------------------------------
15055. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
15056. ----------------------------------------------------------
15057. !VolumeStatisticsSummary!
15058. !VolumeStatisticsDetail!
15059. ----------------------------------------------------------
15060. ----------------------------------------------------------
15061. Zone Detailed Report:
15062. ----------------------------------------------------------
15063. !ZoneStatisticsDetail!
15064. ----------------------------------------------------------
15065. ")
15066. 
15067. 
15068. 
15069. /* pause() */
15070. /* pause() */
15071. 
15072. 
15073. 
15074. /* ------------------------- */
15075. 
15076. 
15077. /* ------------------------- */
15078. 
15079. /* ------------------------- */
15080. /* 3 Zone 9 DevToDo */
15081. # Script: DisplayColors - Zone Dark
15082. # Processed
15083. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
15084. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
15085. 
15086. # Light Green and Yellow
15087. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
15088. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
15089. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
15090. 
15091. # Script: DefragZoneTypeDevToDo
15092. /* ------------------------- */
15093. /* Zone DevToDo */
15094. 
15095. SetVariable(ZoneLabel,			"!ZoneLabelDevToDo!")
15096. SetVariable(ZoneDescription,		"!ZoneDescriptionDevToDo!")
15097. SetVariable(ZoneVolRoundUp,			"!ZoneVolRoundUpDevToDo!")
15098. SetVariable(ZoneGapSize,			"!ZoneGapSizeDevToDo!")
15099. 
15100. SetVariable(ZoneTypeSelect,'
15101. Development and ToDo:
15102. # Script: ZoneDo ZoneTypeSelectDevToDo
15103. # DevToDo start.
15104. # NotBlobsArchivesBu start.
15105. # NOT!
15106. (not (
15107. # Blobs start.
15108. (
15109. # BlobsAndExceptions start.
15110. ( not(
15111.   FileName("*.bat")
15112.   or FileName("*.css")
15113.   or FileName("*.dll")
15114.   or FileName("*.exe")
15115.   or FileName("*.htm*")
15116.   or FileName("*.jar")
15117.   or FileName("*.js")
15118.   or FileName("*.script")
15119.   or FileName("*.wsf")
15120.   or (
15121. # Databases start.
15122. (
15123.   FileName("*.crypt*")
15124.   or FileName("*.db*")
15125.   or FileName("*.rdb*")
15126.   or FileName("*.dc*")
15127.   or FileName("*.dict*")
15128.   or FileName("*.?db*")
15129.   or FileName("*.?rdb*")
15130.   or FileName("*.md*")
15131.   or FileName("*.myd")
15132.   or FileName("*.ndf")
15133.   or FileName("*.ns?")
15134.   or FileName("*.pab")
15135.   or FileName("*.pst")
15136.   or FileName("*.sd?*")
15137.   or FileName("*.sq**")
15138.   or FileName("*.tmd")
15139.   or FileName("*.tps")
15140.   or FileName("*.tr*")
15141. )
15142. # Databases end.
15143. 
15144.     # BlobsAndExceptions
15145.     or 
15146. # Data start.
15147. (
15148.   DirectoryName("Data*")
15149.   or DirectoryName("Device*")
15150.   or DirectoryName("Export*")
15151.   or DirectoryName("Import*")
15152.   or DirectoryName("Log*")
15153.   or DirectoryName("*Log")
15154.   or DirectoryName("Maintenance*")
15155.   or DirectoryName("Rec*")
15156.   or DirectoryName("Sales*")
15157.   or DirectoryName("Search*")
15158.   or DirectoryName("User*")
15159. )
15160. # Data end.
15161. 
15162.     # BlobsAndExceptions
15163.   )
15164. ) )
15165. # BlobsAndExceptions end.
15166. 
15167. # Blobs
15168. ) and (
15169.   Size(BlobFileSize,0)
15170.   or (
15171.     FileName("*.arj")
15172.     or FileName("*.bup")
15173.     or FileName("*.bz2")
15174.     or FileName("*.chm")
15175.     or FileName("*.dvr-ms")
15176.     or FileName("*.gz")
15177.     or FileName("*.ifo")
15178.     or FileName("*.lzh")
15179.     or FileName("*.pdf")
15180.     or FileName("*.rpm")
15181.     or FileName("*.wmv")
15182.     or FileName("*.vob")
15183.     or FileName("*.z")
15184.   ) 
15185. )
15186. # Blobs end.
15187. 
15188. # NotBlobsArchivesBu
15189. or 
15190. # Archives start.
15191. (
15192.   DirectoryName("*Archive*")
15193.   or DirectoryName("*History*")
15194.   or DirectoryName("*Old")
15195.   or DirectoryName("* Old *")
15196.   or DirectoryName("Old *")
15197. 
15198.   or FileName("*.7z")
15199.   or FileName("*.cab")
15200.   or FileName("*.iso")
15201.   or FileName("*.msi")
15202.   or FileName("*.old")
15203.   or FileName("*.rar")
15204.   or FileName("*.tar")
15205.   or FileName("*.zip")
15206.   or
15207. # WinSysLow start.
15208. (
15209.   # Bad idea. This pushed lots of programs and data to archive.
15210.   # DirectoryName("$*")
15211.   # or DirectoryName("0*")
15212.   # or DirectoryName("1*")
15213.   # or DirectoryName("2*")
15214.   # or DirectoryName("3*")
15215.   # or DirectoryName("4*")
15216.   # or DirectoryName("5*")
15217.   # or DirectoryName("6*")
15218.   # or DirectoryName("7*")
15219.   # or DirectoryName("8*")
15220.   # or DirectoryName("9*")
15221.   # or 
15222.   DirectoryName("dllcache")
15223.   or DirectoryName("Downloaded Installations")
15224.   or DirectoryName("Ehome")
15225.   or DirectoryName("Fonts")
15226.   or DirectoryName("Help")
15227.   or DirectoryName("I386")
15228.   or DirectoryName("ie?updates")
15229.   or DirectoryName("Installer")
15230.   or DirectoryName("Installshield Installation Information")
15231.   or DirectoryName("IME")
15232.   or DirectoryName("*RECYCLE*")
15233.   or DirectoryName("ServicePackFiles")
15234.   or DirectoryName("SoftwareDistribution")
15235.   or DirectoryName("Speech")
15236.   or DirectoryName("Symbols")
15237.   or DirectoryName("System Volume Information")
15238.   or DirectoryName("windows.old")
15239. )
15240. # WinSysLow end.
15241. 
15242.   # Archives
15243. )
15244. # Archives end.
15245. 
15246. # NotBlobsArchivesBu
15247. or
15248. # Backups start.
15249. (
15250.   DirectoryName("*Backup*")
15251.   or DirectoryName("*Bu")
15252.   or DirectoryName("* Bu *")
15253.   or DirectoryName("Bu *")
15254. 
15255.   or FileName("*.bak")
15256.   or FileName("* - Copy*")
15257. )
15258. # Backups end.
15259. 
15260. or 
15261. FileName("ReferenceMarker.MyDx")
15262. # NotBlobsArchivesBu
15263. ) )
15264. # NotBlobsArchivesBu end.
15265. 
15266. # DevToDo
15267. and ( 
15268. # Dev start.
15269. (
15270.   DirectoryName("*Dev") 
15271.   or DirectoryName("Dev *") 
15272.   or DirectoryName("*Development*") 
15273.   or DirectoryName("DsVs*") 
15274.   or DirectoryName("Srt*") 
15275. )
15276. # Dev end.
15277. 
15278. # DevToDo
15279. or 
15280. # ToDo start.
15281. (
15282.   DirectoryName("*ToDo*")
15283. )
15284. # ToDo end.
15285. 
15286. # DevToDo
15287. )
15288. # DevToDo end.
15289. 
15290. ')
15291. 
15292. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
15293. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
15294. 
15295. SetVariable(ZoneStepNoCurrent, 0)
15296. 
15297. 	/* ------------------------- */
15298. # Script: ZoneDoHeader
15299. 
15300. # Script: ZoneWhenStarted
15301. RunProgram("..\Commands\WriteDateTime.bat")
15302. 
15303. # Script: ZoneDoCurrentClear
15304. 
15305. SetVariable(ZoneTypeSelectCurrent, 		"")
15306. SetVariable(ZoneStatisticsData, 		"")
15307. SetVariable(ZoneStepByLine, 			"")
15308. 
15309. SetVariable(ZoneBeginCurrent, 			0)
15310. SetVariable(ZoneBeginPerCurrent, 		0)
15311. SetVariable(ZoneEndCurrent, 			0)
15312. SetVariable(ZoneEndPerCurrent, 			0)
15313. 
15314. SetVariable(ZoneSizeCurrent,			0)
15315. SetVariable(ZoneSizePerCurrent,			0)
15316. 
15317. SetVariable(ZoneGapRequestedCurrent,	0)
15318. SetVariable(ZoneGapRoundedCurrent, 		0)
15319. SetVariable(ZoneGapAdjustedCurrent, 	0)
15320. SetVariable(ZoneGapAvailableCurrent, 	0)
15321. SetVariable(ZoneGapCurrent,				0)
15322. SetVariable(ZoneGapUsedCurrent, 		0)
15323. 
15324. SetVariable(ZoneGapActualCurrent, 		0)
15325. SetVariable(ZoneGapActualPerCurrent, 	0)
15326. 
15327. SetVariable(ZoneSizeActual, 			0)
15328. SetVariable(ZoneSizeActualCurrent,		0)
15329. 
15330. SetVariable(ZoneEndActual, 				0)
15331. SetVariable(ZoneEndActualCurrent,		0)			
15332. SetVariable(ZoneSizeActualPerCurrent, 	0)
15333.       
15334. SetVariable(ZoneFilesFolders,			0)
15335. SetVariable(ZoneFilesFoldersPer,		0) 
15336. 
15337. SetVariable(ZoneFragments,				0)
15338. SetVariable(ZoneFragmentsPer,			0) 
15339. 		
15340. SetVariable(ZoneEndActualCurrent, 		0)
15341. SetVariable(ZoneEndActualPerCurrent, 	0)
15342. 
15343. # Gap Calculation Methodology:
15344. 	# Requested
15345. 	SetVariable(GapRequested, 			0) 
15346. 	SetVariable(GapRequestedStd, 		0) 
15347. 	SetVariable(GapRequestedMft, 		0) 
15348. 	SetVariable(GapRequestedOs, 		0) 
15349. 	SetVariable(GapRequestedOriginal, 	0) 
15350. 	
15351. 	# Gap Adjustments
15352. 	SetVariable(GapRounded, 			0)
15353. 	# SetVariable(GapAdjusted, 			0)
15354. 	SetVariable(GapAvailable, 			0)
15355. 	SetVariable(GapCurrent, 			0)
15356. 	SetVariable(GapActual, 				0)
15357. 	SetVariable(GapUsed, 				0)
15358. 	
15359. 	# Gap Adjustments
15360. 	SetVariable(GapRoundedLoc, 			0)
15361. 	# SetVariable(GapAdjustedLoc, 		0)
15362. 	SetVariable(GapAvailableLoc, 		0)
15363. 	SetVariable(GapCurrentLoc, 			0)
15364. 	SetVariable(GapActualLoc,			0)
15365. 	SetVariable(GapUsedLoc,				0)
15366. 	
15367. 	# Space usage
15368. 	SetVariable(ZoneFreePerRequested, 	0)
15369. 	SetVariable(ZoneFreePerUsed, 		0)
15370. 
15371. # Gap Size & Rounding
15372. 	SetVariable(ZoneGapSizePer, 		0)
15373. 	SetVariable(ZoneVolRoundUpPer, 		0)
15374. 	
15375. 	# Free Space
15376. 	SetVariable(ZoneFreeUsedPer, 		0)
15377. 	SetVariable(ZoneFreeRequestedPer, 	0)
15378. 
15379. # Script: DisplaySetZone
15380. 
15381. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
15382. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
15383. 
15384. # Message ZoneSummary
15385. # SetVariable(ZoneSummary, '
15386. # Zone Summary:
15387. # ')
15388. # Zone processing steps
15389. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
15390. # ')
15391. 
15392. # # Script: BannerDescriptionSet
15393. 
15394. # Script: BannerSet
15395. 
15396. # NOTE: Can't round or truncate to integer precision. 
15397. # This internal fields like ZoneCount format really badly.
15398. #  for !RunTimeNow! does not work. None of the date functions do.
15399. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
15400. 
15401. SetVariable(HeadingTemp2,	ZoneCount + 0)
15402. 
15403. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15404. 
15405. Title('!Heading!')
15406. 
15407. /* pause(1) */
15408. 
15409. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15410. 
15411. 
15412. # Script: BannerLog
15413. 
15414. AppendLogfile("!LogFileName!", "!Heading!")
15415. 
15416. 
15417. 
15418. # pause(1)
15419. 
15420. 
15421. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
15422. # Script: DisplaySetZoneStep
15423. # Increment
15424. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15425. 
15426. # Display this zone step
15427. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
15428. ')
15429. 
15430. # Script: BannerSet
15431. 
15432. # NOTE: Can't round or truncate to integer precision. 
15433. # This internal fields like ZoneCount format really badly.
15434. #  for !RunTimeNow! does not work. None of the date functions do.
15435. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
15436. 
15437. SetVariable(HeadingTemp2,	ZoneCount + 0)
15438. 
15439. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15440. 
15441. Title('!Heading!')
15442. 
15443. /* pause(1) */
15444. 
15445. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15446. 
15447. 
15448. # Script: DisplaySetWindowText
15449. # Zone Footer Set Statistics Window Text
15450. 
15451. SetStatisticsWindowText("!Heading!
15452. ----------------------------------------------------------
15453. Zones Processed: 
15454. ----------------------------------------------------------
15455. !ZoneListByLine!
15456. ----------------------------------------------------------
15457. Zone Processing Step:
15458. !ZoneStepByLine!    
15459. ----------------------------------------------------------
15460. ----------------------------------------------------------
15461. CURRENT ZONE:
15462. !ZoneStatisticsReport!
15463. ----------------------------------------------------------
15464. ----------------------------------------------------------
15465. ----------------------------------------------------------
15466. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
15467. ----------------------------------------------------------
15468. !VolumeStatisticsSummary!
15469. !VolumeStatisticsDetail!
15470. ----------------------------------------------------------
15471. ----------------------------------------------------------
15472. Zone Detailed Report:
15473. ----------------------------------------------------------
15474. !ZoneStatisticsDetail!
15475. ----------------------------------------------------------
15476. ")
15477. 
15478. 
15479. 
15480. 
15481. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
15482. 
15483. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
15484. # Script: DisplaySetZoneStep
15485. # Increment
15486. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15487. 
15488. # Display this zone step
15489. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
15490. ')
15491. 
15492. # Script: BannerSet
15493. 
15494. # NOTE: Can't round or truncate to integer precision. 
15495. # This internal fields like ZoneCount format really badly.
15496. #  for !RunTimeNow! does not work. None of the date functions do.
15497. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
15498. 
15499. SetVariable(HeadingTemp2,	ZoneCount + 0)
15500. 
15501. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15502. 
15503. Title('!Heading!')
15504. 
15505. /* pause(1) */
15506. 
15507. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15508. 
15509. 
15510. # Script: DisplaySetWindowText
15511. # Zone Footer Set Statistics Window Text
15512. 
15513. SetStatisticsWindowText("!Heading!
15514. ----------------------------------------------------------
15515. Zones Processed: 
15516. ----------------------------------------------------------
15517. !ZoneListByLine!
15518. ----------------------------------------------------------
15519. Zone Processing Step:
15520. !ZoneStepByLine!    
15521. ----------------------------------------------------------
15522. ----------------------------------------------------------
15523. CURRENT ZONE:
15524. !ZoneStatisticsReport!
15525. ----------------------------------------------------------
15526. ----------------------------------------------------------
15527. ----------------------------------------------------------
15528. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
15529. ----------------------------------------------------------
15530. !VolumeStatisticsSummary!
15531. !VolumeStatisticsDetail!
15532. ----------------------------------------------------------
15533. ----------------------------------------------------------
15534. Zone Detailed Report:
15535. ----------------------------------------------------------
15536. !ZoneStatisticsDetail!
15537. ----------------------------------------------------------
15538. ")
15539. 
15540. 
15541. 
15542. 
15543. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
15544. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
15545. 
15546. # Script: BannerSet
15547. 
15548. # NOTE: Can't round or truncate to integer precision. 
15549. # This internal fields like ZoneCount format really badly.
15550. #  for !RunTimeNow! does not work. None of the date functions do.
15551. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
15552. 
15553. SetVariable(HeadingTemp2,	ZoneCount + 0)
15554. 
15555. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15556. 
15557. Title('!Heading!')
15558. 
15559. /* pause(1) */
15560. 
15561. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15562. 
15563. 
15564. # Script: BannerLog
15565. 
15566. AppendLogfile("!LogFileName!", "!Heading!")
15567. 
15568. 
15569. 
15570. # LOGGING:
15571. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
15572. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
15573. 
15574. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
15575. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:00")
15576. # 2021-12-14 15:30:00 
15577. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:05 !ZoneLabel! !ZoneDescription!")
15578. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
15579. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:05 !ZoneLabel! !ZoneDescription!")
15580. 
15581. 
15582. # Add zone to list of zones:
15583. SetVariable(ZoneListByLine, "!ZoneListByLine!
15584. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
15585. # Script: DisplaySetWindowText
15586. # Zone Footer Set Statistics Window Text
15587. 
15588. SetStatisticsWindowText("!Heading!
15589. ----------------------------------------------------------
15590. Zones Processed: 
15591. ----------------------------------------------------------
15592. !ZoneListByLine!
15593. ----------------------------------------------------------
15594. Zone Processing Step:
15595. !ZoneStepByLine!    
15596. ----------------------------------------------------------
15597. ----------------------------------------------------------
15598. CURRENT ZONE:
15599. !ZoneStatisticsReport!
15600. ----------------------------------------------------------
15601. ----------------------------------------------------------
15602. ----------------------------------------------------------
15603. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
15604. ----------------------------------------------------------
15605. !VolumeStatisticsSummary!
15606. !VolumeStatisticsDetail!
15607. ----------------------------------------------------------
15608. ----------------------------------------------------------
15609. Zone Detailed Report:
15610. ----------------------------------------------------------
15611. !ZoneStatisticsDetail!
15612. ----------------------------------------------------------
15613. ")
15614. 
15615. 
15616. 
15617. 
15618. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
15619. # Script: DisplaySetZoneStep
15620. # Increment
15621. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15622. 
15623. # Display this zone step
15624. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
15625. ')
15626. 
15627. # Script: BannerSet
15628. 
15629. # NOTE: Can't round or truncate to integer precision. 
15630. # This internal fields like ZoneCount format really badly.
15631. #  for !RunTimeNow! does not work. None of the date functions do.
15632. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
15633. 
15634. SetVariable(HeadingTemp2,	ZoneCount + 0)
15635. 
15636. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15637. 
15638. Title('!Heading!')
15639. 
15640. /* pause(1) */
15641. 
15642. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15643. 
15644. 
15645. # Script: DisplaySetWindowText
15646. # Zone Footer Set Statistics Window Text
15647. 
15648. SetStatisticsWindowText("!Heading!
15649. ----------------------------------------------------------
15650. Zones Processed: 
15651. ----------------------------------------------------------
15652. !ZoneListByLine!
15653. ----------------------------------------------------------
15654. Zone Processing Step:
15655. !ZoneStepByLine!    
15656. ----------------------------------------------------------
15657. ----------------------------------------------------------
15658. CURRENT ZONE:
15659. !ZoneStatisticsReport!
15660. ----------------------------------------------------------
15661. ----------------------------------------------------------
15662. ----------------------------------------------------------
15663. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
15664. ----------------------------------------------------------
15665. !VolumeStatisticsSummary!
15666. !VolumeStatisticsDetail!
15667. ----------------------------------------------------------
15668. ----------------------------------------------------------
15669. Zone Detailed Report:
15670. ----------------------------------------------------------
15671. !ZoneStatisticsDetail!
15672. ----------------------------------------------------------
15673. ")
15674. 
15675. 
15676. 
15677. 
15678. # your stuff HERE (X)... pre file select code.
15679. 
15680. /* --------------------------------- */
15681. 	FileSelect
15682. 
15683. 		# your stuff can't really go here (errors.)
15684. 		# maybe for some reason I don't know of...
15685. 	
15686. 		# Actions next...
15687. 	# Script: ZoneDo ZoneTypeSelectDevToDo
15688. # DevToDo start.
15689. # NotBlobsArchivesBu start.
15690. # NOT!
15691. (not (
15692. # Blobs start.
15693. (
15694. # BlobsAndExceptions start.
15695. ( not(
15696.   FileName("*.bat")
15697.   or FileName("*.css")
15698.   or FileName("*.dll")
15699.   or FileName("*.exe")
15700.   or FileName("*.htm*")
15701.   or FileName("*.jar")
15702.   or FileName("*.js")
15703.   or FileName("*.script")
15704.   or FileName("*.wsf")
15705.   or (
15706. # Databases start.
15707. (
15708.   FileName("*.crypt*")
15709.   or FileName("*.db*")
15710.   or FileName("*.rdb*")
15711.   or FileName("*.dc*")
15712.   or FileName("*.dict*")
15713.   or FileName("*.?db*")
15714.   or FileName("*.?rdb*")
15715.   or FileName("*.md*")
15716.   or FileName("*.myd")
15717.   or FileName("*.ndf")
15718.   or FileName("*.ns?")
15719.   or FileName("*.pab")
15720.   or FileName("*.pst")
15721.   or FileName("*.sd?*")
15722.   or FileName("*.sq**")
15723.   or FileName("*.tmd")
15724.   or FileName("*.tps")
15725.   or FileName("*.tr*")
15726. )
15727. # Databases end.
15728. 
15729.     # BlobsAndExceptions
15730.     or 
15731. # Data start.
15732. (
15733.   DirectoryName("Data*")
15734.   or DirectoryName("Device*")
15735.   or DirectoryName("Export*")
15736.   or DirectoryName("Import*")
15737.   or DirectoryName("Log*")
15738.   or DirectoryName("*Log")
15739.   or DirectoryName("Maintenance*")
15740.   or DirectoryName("Rec*")
15741.   or DirectoryName("Sales*")
15742.   or DirectoryName("Search*")
15743.   or DirectoryName("User*")
15744. )
15745. # Data end.
15746. 
15747.     # BlobsAndExceptions
15748.   )
15749. ) )
15750. # BlobsAndExceptions end.
15751. 
15752. # Blobs
15753. ) and (
15754.   Size(BlobFileSize,0)
15755.   or (
15756.     FileName("*.arj")
15757.     or FileName("*.bup")
15758.     or FileName("*.bz2")
15759.     or FileName("*.chm")
15760.     or FileName("*.dvr-ms")
15761.     or FileName("*.gz")
15762.     or FileName("*.ifo")
15763.     or FileName("*.lzh")
15764.     or FileName("*.pdf")
15765.     or FileName("*.rpm")
15766.     or FileName("*.wmv")
15767.     or FileName("*.vob")
15768.     or FileName("*.z")
15769.   ) 
15770. )
15771. # Blobs end.
15772. 
15773. # NotBlobsArchivesBu
15774. or 
15775. # Archives start.
15776. (
15777.   DirectoryName("*Archive*")
15778.   or DirectoryName("*History*")
15779.   or DirectoryName("*Old")
15780.   or DirectoryName("* Old *")
15781.   or DirectoryName("Old *")
15782. 
15783.   or FileName("*.7z")
15784.   or FileName("*.cab")
15785.   or FileName("*.iso")
15786.   or FileName("*.msi")
15787.   or FileName("*.old")
15788.   or FileName("*.rar")
15789.   or FileName("*.tar")
15790.   or FileName("*.zip")
15791.   or
15792. # WinSysLow start.
15793. (
15794.   # Bad idea. This pushed lots of programs and data to archive.
15795.   # DirectoryName("$*")
15796.   # or DirectoryName("0*")
15797.   # or DirectoryName("1*")
15798.   # or DirectoryName("2*")
15799.   # or DirectoryName("3*")
15800.   # or DirectoryName("4*")
15801.   # or DirectoryName("5*")
15802.   # or DirectoryName("6*")
15803.   # or DirectoryName("7*")
15804.   # or DirectoryName("8*")
15805.   # or DirectoryName("9*")
15806.   # or 
15807.   DirectoryName("dllcache")
15808.   or DirectoryName("Downloaded Installations")
15809.   or DirectoryName("Ehome")
15810.   or DirectoryName("Fonts")
15811.   or DirectoryName("Help")
15812.   or DirectoryName("I386")
15813.   or DirectoryName("ie?updates")
15814.   or DirectoryName("Installer")
15815.   or DirectoryName("Installshield Installation Information")
15816.   or DirectoryName("IME")
15817.   or DirectoryName("*RECYCLE*")
15818.   or DirectoryName("ServicePackFiles")
15819.   or DirectoryName("SoftwareDistribution")
15820.   or DirectoryName("Speech")
15821.   or DirectoryName("Symbols")
15822.   or DirectoryName("System Volume Information")
15823.   or DirectoryName("windows.old")
15824. )
15825. # WinSysLow end.
15826. 
15827.   # Archives
15828. )
15829. # Archives end.
15830. 
15831. # NotBlobsArchivesBu
15832. or
15833. # Backups start.
15834. (
15835.   DirectoryName("*Backup*")
15836.   or DirectoryName("*Bu")
15837.   or DirectoryName("* Bu *")
15838.   or DirectoryName("Bu *")
15839. 
15840.   or FileName("*.bak")
15841.   or FileName("* - Copy*")
15842. )
15843. # Backups end.
15844. 
15845. or 
15846. FileName("ReferenceMarker.MyDx")
15847. # NotBlobsArchivesBu
15848. ) )
15849. # NotBlobsArchivesBu end.
15850. 
15851. # DevToDo
15852. and ( 
15853. # Dev start.
15854. (
15855.   DirectoryName("*Dev") 
15856.   or DirectoryName("Dev *") 
15857.   or DirectoryName("*Development*") 
15858.   or DirectoryName("DsVs*") 
15859.   or DirectoryName("Srt*") 
15860. )
15861. # Dev end.
15862. 
15863. # DevToDo
15864. or 
15865. # ToDo start.
15866. (
15867.   DirectoryName("*ToDo*")
15868. )
15869. # ToDo end.
15870. 
15871. # DevToDo
15872. )
15873. # DevToDo end.
15874. 
15875. 	# Script: ZoneDoAction
15876. # Zone Do File Action - SortByName.
15877. 
15878. 	FileActions
15879. 
15880. 			# Script: GapZoneCalc
15881. 	# Gap
15882. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
15883. 		# Script: DisplaySetZoneStep
15884. # Increment
15885. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15886. 
15887. # Display this zone step
15888. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
15889. ')
15890. 
15891. # Script: BannerSet
15892. 
15893. # NOTE: Can't round or truncate to integer precision. 
15894. # This internal fields like ZoneCount format really badly.
15895. #  for !RunTimeNow! does not work. None of the date functions do.
15896. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
15897. 
15898. SetVariable(HeadingTemp2,	ZoneCount + 0)
15899. 
15900. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15901. 
15902. Title('!Heading!')
15903. 
15904. /* pause(1) */
15905. 
15906. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
15907. 
15908. 
15909. # Script: DisplaySetWindowText
15910. # Zone Footer Set Statistics Window Text
15911. 
15912. SetStatisticsWindowText("!Heading!
15913. ----------------------------------------------------------
15914. Zones Processed: 
15915. ----------------------------------------------------------
15916. !ZoneListByLine!
15917. ----------------------------------------------------------
15918. Zone Processing Step:
15919. !ZoneStepByLine!    
15920. ----------------------------------------------------------
15921. ----------------------------------------------------------
15922. CURRENT ZONE:
15923. !ZoneStatisticsReport!
15924. ----------------------------------------------------------
15925. ----------------------------------------------------------
15926. ----------------------------------------------------------
15927. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
15928. ----------------------------------------------------------
15929. !VolumeStatisticsSummary!
15930. !VolumeStatisticsDetail!
15931. ----------------------------------------------------------
15932. ----------------------------------------------------------
15933. Zone Detailed Report:
15934. ----------------------------------------------------------
15935. !ZoneStatisticsDetail!
15936. ----------------------------------------------------------
15937. ")
15938. 
15939. 
15940. 
15941. 	
15942. 	# ACTUAL GAP
15943. 		/* AddGap Variant. */
15944. 	  	# Script: GapZoneSet
15945. # Zone Do Gap
15946. # Gap Calculation Methods:
15947. 
15948. /* 1) Anything you need to add first. */
15949. /* empty */
15950. 
15951. /* ------------------------- */
15952. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
15953. 	# GapRequestedStd.
15954. 
15955. 		/* ------------------------- */
15956. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
15957. 
15958. 		# Gap Calculation Methods:
15959. 
15960. /* AddGap Variants */
15961. 
15962. 	/* Standard */
15963. 		# Gap Calculation Methods:
15964. 	/* AddGap Variants */
15965. 	/* Standard */
15966. 
15967. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
15968. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
15969. 
15970. 	SetVariable(GapRequested, GapRequestedStd)
15971. 	
15972. 
15973. 	/* MFT Low High Method */
15974. 		# Gap Calculation Methods:
15975. 	/* AddGap Variants */
15976. 	/* MFT Low High Method */
15977. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
15978. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
15979. 	SetVariable(GapRequested, GapRequestedMft)
15980. 	
15981. 
15982. 	/* OS Volume Type Method */
15983. 		# Gap Calculation Methods:
15984. 	/* AddGap Variants */
15985. 	/* OS Volume Type Method */
15986. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
15987. 	SetVariable(GapRequested, GapRequestedOs)
15988. 
15989. 
15990. 
15991. /* MakeGap Variants */
15992. 
15993. 	/* Original Os 1-3 + MFT 2 */
15994. 		# Gap Calculation Methods:
15995. 	/* MakeGap Variants */
15996. 	/* Original Os 1-3 + MFT 2 */
15997. 	/* plus MFT gap placed inline at the dividing zone. */
15998. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
15999. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
16000. 	SetVariable(GapRequested, GapRequestedOrig)
16001. 	
16002. 	
16003. /* Note: You could comment out the ones not in use */
16004. /* However having the data in the log is useful. */
16005. /* Therefore the following line is otherwise needed. */
16006. 
16007. /* Standard used */
16008. 
16009. SetVariable(GapRequested, GapRequestedStd)
16010. 
16011. # Gap Calculation Methods:
16012. 
16013. /* AddGap Variants */
16014. 	/* Standard */
16015. 	/* MFT Low High Method */
16016. 	/* OS Volume Type Method */
16017. 
16018. /* MakeGap Variants */
16019. 	/* Original Os 1-3 + MFT 2 */
16020. 
16021. /* Note: You could comment out the ones not in use */
16022. /* However having the data in the log is useful. */
16023. /* Therefore the following line is otherwise needed. */
16024. 
16025. /* Standard is used currently */
16026. 
16027. 
16028. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
16029. 
16030. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
16031. 
16032. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
16033. 
16034. /* ------------------------- */
16035. /* 3) SMALL ZONE ADJUSTMENT. */
16036. /* Gab cant be larger than half the Zone Size. */
16037. 
16038. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
16039. 	
16040. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
16041. 
16042. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
16043. 
16044. /* ------------------------- */
16045. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
16046. # Gap Adjustments.
16047. 
16048. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
16049. 	
16050. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
16051. 
16052. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
16053. 
16054. /* ------------------------- */
16055. # BYPASS THIS.
16056. 	/* This is definitely wrong. */
16057. 	/* The question is can we steal gap from the next zone */
16058. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
16059. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
16060. 		# Zone Overflow.
16061. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
16062. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
16063. 
16064. /* ------------------------- */
16065. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
16066. # Remaining free space available.
16067. 
16068. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
16069. 	
16070. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
16071. 
16072. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
16073. 
16074. /* ------------------------- */
16075. # CURRENT gap to use.
16076. 
16077. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
16078. 
16079. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
16080. 
16081. /* ------------------------- */
16082. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
16083. # Debugging.
16084. 
16085. 	SetVariable(GapUsed, GapCurrent) // for debugging
16086. 
16087. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
16088. 
16089. 		# Your code HERE
16090. 
16091. /* ------------------------- */
16092. /* 7) YOUR CODE. */
16093. # YOUR CODE HERE:
16094. 	# INPUT: GapCurrent or GapCurrentLoc
16095. 	# OUTPUT: GapUsed...
16096. 
16097. /* ------------------------- */
16098. # Gap Size.
16099. # Actual Size of Gap.
16100. 
16101. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
16102. 
16103. /* ------------------------- */
16104. 
16105. 	
16106. 	# Zone Statistics	
16107. 		# Script: ZoneStatisticsGet
16108. # Zone / Volume Statistics and Display
16109. 		
16110. 	# Accumulate Totals
16111.   	# Script: ZoneDoVolumeTotals
16112. 
16113. /* Current total space used (by Zones and Gaps) */
16114. 
16115. SetVariable(VolumeZoneUsed, GapUsed)
16116. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
16117. /* Percentage */
16118. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
16119. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
16120. 
16121. /* Current total of free space requested */
16122. 
16123. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
16124. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16125. /* Percent. */
16126. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
16127. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16128. 
16129. /* Current total of free space used */
16130. 
16131. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
16132. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
16133. /* Percent */
16134. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
16135. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
16136. 
16137. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
16138. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
16139. # Xinclude "..\DebugDisplayPause.MyDc"X
16140. 
16141. 
16142. 	# Current Values
16143. 	# Script: ZoneDoCurrentSet
16144. 
16145. # Cluster, Sector, Block adjust for display.
16146. 	# Bytes per cluster is volume specific.
16147. 
16148. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
16149. 
16150. # Current Zone values.
16151. 	# Begin, end and size.
16152. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
16153. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
16154. 
16155. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
16156. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
16157. 
16158. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
16159. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
16160. 
16161. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
16162. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
16163. 
16164. 	SetVariable(ZoneFragments,				"!ZONE210N!")
16165. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
16166. 		
16167. # Current Gap, Actual and Free Values
16168. 	# Gap
16169. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
16170. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
16171. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
16172. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
16173. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
16174. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
16175. 	
16176. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
16177. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
16178. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
16179. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
16180. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
16181. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
16182. 	
16183. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
16184. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
16185. 	
16186. 	# Actual Size and End
16187. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
16188. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
16189. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
16190. 	
16191. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
16192. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
16193. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
16194. 
16195. # Gap Size & Rounding
16196. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
16197. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
16198. 	
16199. 	# Free Space
16200. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
16201. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
16202. 
16203. 	# Script: ZoneStatisticsReportGet
16204. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
16205. 
16206. # Footer:
16207. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
16208. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
16209. #
16210. # Xinclude "..\Commands\DateTimeLastLong.txt"X
16211. #
16212. # What a mess this word based vs is. Try a phrase based version ToDo
16213. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
16214. ------------------
16215.    !SizeWord!!ColonWord!  
16216.    ------------------------
16217.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16218.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16219.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16220. 
16221.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16222.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
16223. 
16224.    !LocationWord!!ColonWord!
16225.    ------------------------
16226.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16227.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
16228.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16229.       
16230.    !GapWordCaps! !SettingsWord!!ColonWord!
16231.    ------------------------
16232.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
16233.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
16234.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16235.                  
16236.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
16237.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
16238.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
16239.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
16240.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
16241.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
16242.      
16243.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
16244.    ------------------------
16245.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16246.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16247.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16248. 
16249. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
16250. ----------------------------------------------------------
16251. ")
16252. #
16253. SetVariable(DateNow, 	DATETIME)
16254. SetVariable(TimeNow, 	Time)
16255. SetVariable(RunTimeNow, 	RunTime)
16256. 
16257. 
16258. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
16259. 
16260. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
16261. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
16262. 
16263. 	# Script: DisplaySetWindowText
16264. # Zone Footer Set Statistics Window Text
16265. 
16266. SetStatisticsWindowText("!Heading!
16267. ----------------------------------------------------------
16268. Zones Processed: 
16269. ----------------------------------------------------------
16270. !ZoneListByLine!
16271. ----------------------------------------------------------
16272. Zone Processing Step:
16273. !ZoneStepByLine!    
16274. ----------------------------------------------------------
16275. ----------------------------------------------------------
16276. CURRENT ZONE:
16277. !ZoneStatisticsReport!
16278. ----------------------------------------------------------
16279. ----------------------------------------------------------
16280. ----------------------------------------------------------
16281. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
16282. ----------------------------------------------------------
16283. !VolumeStatisticsSummary!
16284. !VolumeStatisticsDetail!
16285. ----------------------------------------------------------
16286. ----------------------------------------------------------
16287. Zone Detailed Report:
16288. ----------------------------------------------------------
16289. !ZoneStatisticsDetail!
16290. ----------------------------------------------------------
16291. ")
16292. 
16293. 
16294. 	
16295. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
16296. 
16297. 
16298. 	SetVariable(ZoneStatisticsData, 
16299. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
16300.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
16301.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
16302. 
16303. 
16304. 
16305.  		# Script: ZoneStatisticsDisplay
16306. 	
16307. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
16308. !ZoneStatisticsData!
16309. ')
16310. 
16311. 		# Script: ZoneStatisticsAdd
16312. # Append Zone to Details of each zone.
16313. 		
16314. 	# Add Zone Details to Report.	
16315. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
16316. !ZoneStatisticsReport!
16317. ')
16318. 
16319. 	
16320. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
16321. 		# Script: DisplaySetZoneStep
16322. # Increment
16323. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16324. 
16325. # Display this zone step
16326. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
16327. ')
16328. 
16329. # Script: BannerSet
16330. 
16331. # NOTE: Can't round or truncate to integer precision. 
16332. # This internal fields like ZoneCount format really badly.
16333. #  for !RunTimeNow! does not work. None of the date functions do.
16334. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16335. 
16336. SetVariable(HeadingTemp2,	ZoneCount + 0)
16337. 
16338. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16339. 
16340. Title('!Heading!')
16341. 
16342. /* pause(1) */
16343. 
16344. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16345. 
16346. 
16347. # Script: DisplaySetWindowText
16348. # Zone Footer Set Statistics Window Text
16349. 
16350. SetStatisticsWindowText("!Heading!
16351. ----------------------------------------------------------
16352. Zones Processed: 
16353. ----------------------------------------------------------
16354. !ZoneListByLine!
16355. ----------------------------------------------------------
16356. Zone Processing Step:
16357. !ZoneStepByLine!    
16358. ----------------------------------------------------------
16359. ----------------------------------------------------------
16360. CURRENT ZONE:
16361. !ZoneStatisticsReport!
16362. ----------------------------------------------------------
16363. ----------------------------------------------------------
16364. ----------------------------------------------------------
16365. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
16366. ----------------------------------------------------------
16367. !VolumeStatisticsSummary!
16368. !VolumeStatisticsDetail!
16369. ----------------------------------------------------------
16370. ----------------------------------------------------------
16371. Zone Detailed Report:
16372. ----------------------------------------------------------
16373. !ZoneStatisticsDetail!
16374. ----------------------------------------------------------
16375. ")
16376. 
16377. 
16378. 
16379. 
16380. 		# File Action - All - Full -  SortByCreationDate
16381. # File Action - ZoneDoActionSortByCreationDateFull
16382. 	SortByCreationDate(Ascending)
16383. 	
16384. 
16385. 
16386. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
16387. 		# Script: DisplaySetZoneStep
16388. # Increment
16389. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16390. 
16391. # Display this zone step
16392. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
16393. ')
16394. 
16395. # Script: BannerSet
16396. 
16397. # NOTE: Can't round or truncate to integer precision. 
16398. # This internal fields like ZoneCount format really badly.
16399. #  for !RunTimeNow! does not work. None of the date functions do.
16400. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16401. 
16402. SetVariable(HeadingTemp2,	ZoneCount + 0)
16403. 
16404. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16405. 
16406. Title('!Heading!')
16407. 
16408. /* pause(1) */
16409. 
16410. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16411. 
16412. 
16413. # Script: DisplaySetWindowText
16414. # Zone Footer Set Statistics Window Text
16415. 
16416. SetStatisticsWindowText("!Heading!
16417. ----------------------------------------------------------
16418. Zones Processed: 
16419. ----------------------------------------------------------
16420. !ZoneListByLine!
16421. ----------------------------------------------------------
16422. Zone Processing Step:
16423. !ZoneStepByLine!    
16424. ----------------------------------------------------------
16425. ----------------------------------------------------------
16426. CURRENT ZONE:
16427. !ZoneStatisticsReport!
16428. ----------------------------------------------------------
16429. ----------------------------------------------------------
16430. ----------------------------------------------------------
16431. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
16432. ----------------------------------------------------------
16433. !VolumeStatisticsSummary!
16434. !VolumeStatisticsDetail!
16435. ----------------------------------------------------------
16436. ----------------------------------------------------------
16437. Zone Detailed Report:
16438. ----------------------------------------------------------
16439. !ZoneStatisticsDetail!
16440. ----------------------------------------------------------
16441. ")
16442. 
16443. 
16444. 
16445. 
16446. 	# Script: ZoneDoFooter
16447. 
16448. /* --------------------------------- */
16449. 	# File Select
16450. 		# Select Statments
16451. 	# File Actions 
16452. 		# Standard or OS File Actions.
16453. 		# Resume...
16454. 	
16455. 		# your stuff HERE (X)... post zone (file) file actions code.
16456. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
16457. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
16458. 			# (X)
16459. 		
16460. 			/* ??? Set window? */
16461. 	
16462. 		# ADD THE GAP
16463. 		# Script: GapZoneCommand
16464. # Vacate (good for diagnostics)
16465. # DoNotVacate - DO NOT Vacate (recommended)
16466. 
16467. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
16468. # Script: DisplaySetZoneStep
16469. # Increment
16470. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16471. 
16472. # Display this zone step
16473. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
16474. ')
16475. 
16476. # Script: BannerSet
16477. 
16478. # NOTE: Can't round or truncate to integer precision. 
16479. # This internal fields like ZoneCount format really badly.
16480. #  for !RunTimeNow! does not work. None of the date functions do.
16481. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16482. 
16483. SetVariable(HeadingTemp2,	ZoneCount + 0)
16484. 
16485. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16486. 
16487. Title('!Heading!')
16488. 
16489. /* pause(1) */
16490. 
16491. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16492. 
16493. 
16494. # Script: DisplaySetWindowText
16495. # Zone Footer Set Statistics Window Text
16496. 
16497. SetStatisticsWindowText("!Heading!
16498. ----------------------------------------------------------
16499. Zones Processed: 
16500. ----------------------------------------------------------
16501. !ZoneListByLine!
16502. ----------------------------------------------------------
16503. Zone Processing Step:
16504. !ZoneStepByLine!    
16505. ----------------------------------------------------------
16506. ----------------------------------------------------------
16507. CURRENT ZONE:
16508. !ZoneStatisticsReport!
16509. ----------------------------------------------------------
16510. ----------------------------------------------------------
16511. ----------------------------------------------------------
16512. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
16513. ----------------------------------------------------------
16514. !VolumeStatisticsSummary!
16515. !VolumeStatisticsDetail!
16516. ----------------------------------------------------------
16517. ----------------------------------------------------------
16518. Zone Detailed Report:
16519. ----------------------------------------------------------
16520. !ZoneStatisticsDetail!
16521. ----------------------------------------------------------
16522. ")
16523. 
16524. 
16525. 
16526. 
16527. # *** Moved to setting yours *** 
16528. # (to avoid doing it twice)
16529. # (ie the later wouldn't "overwrite" the former in the usual manner)
16530. 
16531. # Do one or the other:
16532. # DoNotVacate - DO NOT Vacate (recommended)
16533. 
16534. # Vacate
16535. /* AddGap(GapUsedLoc) */
16536. 
16537. # DO Not Vacate
16538. AddGap(GapUsedLoc, DoNotVacate) 
16539. 	
16540. 	
16541. 
16542. # Controlled via settings commands
16543. 
16544. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
16545. 
16546. # Vacate /* AddGap(GapUsed) */
16547. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
16548. 	
16549. 
16550. 		
16551. 	# 
16552. 	FileEnd
16553. /* --------------------------------- */
16554. # your stuff HERE (X)... post zone (file) code.
16555. 
16556. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
16557. # Script: DisplaySetZoneStep
16558. # Increment
16559. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16560. 
16561. # Display this zone step
16562. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
16563. ')
16564. 
16565. # Script: BannerSet
16566. 
16567. # NOTE: Can't round or truncate to integer precision. 
16568. # This internal fields like ZoneCount format really badly.
16569. #  for !RunTimeNow! does not work. None of the date functions do.
16570. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16571. 
16572. SetVariable(HeadingTemp2,	ZoneCount + 0)
16573. 
16574. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16575. 
16576. Title('!Heading!')
16577. 
16578. /* pause(1) */
16579. 
16580. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16581. 
16582. 
16583. # Script: DisplaySetWindowText
16584. # Zone Footer Set Statistics Window Text
16585. 
16586. SetStatisticsWindowText("!Heading!
16587. ----------------------------------------------------------
16588. Zones Processed: 
16589. ----------------------------------------------------------
16590. !ZoneListByLine!
16591. ----------------------------------------------------------
16592. Zone Processing Step:
16593. !ZoneStepByLine!    
16594. ----------------------------------------------------------
16595. ----------------------------------------------------------
16596. CURRENT ZONE:
16597. !ZoneStatisticsReport!
16598. ----------------------------------------------------------
16599. ----------------------------------------------------------
16600. ----------------------------------------------------------
16601. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
16602. ----------------------------------------------------------
16603. !VolumeStatisticsSummary!
16604. !VolumeStatisticsDetail!
16605. ----------------------------------------------------------
16606. ----------------------------------------------------------
16607. Zone Detailed Report:
16608. ----------------------------------------------------------
16609. !ZoneStatisticsDetail!
16610. ----------------------------------------------------------
16611. ")
16612. 
16613. 
16614. 
16615. 
16616. # Script: ZoneWhenFinished
16617. 
16618. # Add the zone to the zone details log:
16619. # This is temporarily disable until logging is fixed
16620. # It is performed during file action to preserve the correct (original) calculations.
16621. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
16622. 
16623. # Add the Select and ZoneSteps to the Zone
16624. # Script: ZoneStatisticsAdd
16625. # Append Zone to Details of each zone.
16626. 		
16627. 	# Add Zone Details to Report.	
16628. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
16629. ----------------------------------------------------------
16630. !ZoneStepByLine!
16631. ---------------------------
16632. !ZoneTypeSelectCurrent!               
16633. ---------------------------
16634. ----------------------------------------------------------
16635. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
16636. ----------------------------------------------------------
16637. ')
16638. 
16639. 
16640. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
16641. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
16642. # 2021-12-14 15:30:00
16643. RunProgram("..\Commands\WriteDateTime.bat LastZone")
16644. # Append Datetime to logs
16645. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
16646. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
16647. 
16648. AppendLogfile("!LogFileName!", "!PeriodWord!")
16649. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
16650. AppendLogfile("!LogFileName!", "!PeriodWord!")
16651. 
16652. # Script: DisplaySetWindowText
16653. # Zone Footer Set Statistics Window Text
16654. 
16655. SetStatisticsWindowText("!Heading!
16656. ----------------------------------------------------------
16657. Zones Processed: 
16658. ----------------------------------------------------------
16659. !ZoneListByLine!
16660. ----------------------------------------------------------
16661. Zone Processing Step:
16662. !ZoneStepByLine!    
16663. ----------------------------------------------------------
16664. ----------------------------------------------------------
16665. CURRENT ZONE:
16666. !ZoneStatisticsReport!
16667. ----------------------------------------------------------
16668. ----------------------------------------------------------
16669. ----------------------------------------------------------
16670. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
16671. ----------------------------------------------------------
16672. !VolumeStatisticsSummary!
16673. !VolumeStatisticsDetail!
16674. ----------------------------------------------------------
16675. ----------------------------------------------------------
16676. Zone Detailed Report:
16677. ----------------------------------------------------------
16678. !ZoneStatisticsDetail!
16679. ----------------------------------------------------------
16680. ")
16681. 
16682. 
16683. 
16684. /* pause() */
16685. /* pause() */
16686. 
16687. 
16688. 
16689. /* ------------------------- */
16690. 
16691. 
16692. /* ------------------------- */
16693. 
16694. /* ------------------------- */
16695. // 4 MFT & Dir
16696. // Was zone 4 & 5
16697. // added hyberfile and moved to 12 & 13, 14
16698. // 202111 moved back to lower location 
16699. // (now) 10, 11, 12 - due to Unzoned Multimedia placement
16700. // IE. Music, Photo album and video.
16701. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
16702. /* Process MFT & Dir's HERE. */
16703. 	SetVariable(ZoneStepDescription,"Calculating Gap for MFT and DIR.")
16704. # Script: BannerDescriptionSet
16705. 
16706. # Script: BannerSet
16707. 
16708. # NOTE: Can't round or truncate to integer precision. 
16709. # This internal fields like ZoneCount format really badly.
16710. #  for !RunTimeNow! does not work. None of the date functions do.
16711. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16712. 
16713. SetVariable(HeadingTemp2,	ZoneCount + 0)
16714. 
16715. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16716. 
16717. Title('!Heading!')
16718. 
16719. /* pause(1) */
16720. 
16721. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16722. 
16723. 
16724. # Script: BannerLog
16725. 
16726. AppendLogfile("!LogFileName!", "!Heading!")
16727. 
16728. 
16729. 
16730. 
16731. SetVariable(DateNow, 	DATETIME)
16732. SetVariable(TimeNow, 	Time)
16733. SetVariable(RunTimeNow, 	RunTime)
16734. 
16735. SetVariable(MftReport, "!MftReport!MftLocation: !MftLocation! !DateNow! !TimeNow! !RunTimeNow!")
16736. # SetVariable(MftSize,                 0)
16737. SetVariable(MftReport, "!MftReport!MftSize:                 0
16738. ")
16739. 
16740. SetVariable(MftGapSlack, MftLocation - VolumeUsedTotal)
16741. SetVariable(MftReport, "!MftReport!MftGapSlack: !MftGapSlack!
16742. ")
16743. 
16744. SetVariable(MftGapSlackPerUsed, MftGapSlack / VolumeFreeAdj)
16745. SetVariable(MftReport, "!MftReport!MftGapSlackPerUsed: !MftGapSlackPerUsed!
16746. ")
16747. 
16748. SetVariable(MftReport, "!MftReport!VolumeUsed !BeforeWord!!ColonWord! !VolumeUsedTotal!
16749. ")
16750. SetVariable(VolumeUsedTotal, MftLocation)
16751. SetVariable(MftReport, "!MftReport!VolumeUsed !AtWord! !LocationWord!!ColonWord! !VolumeUsedTotal!
16752. ")
16753. 
16754. SetVariable(VolumeFreePerUsed, VolumeFreePerUsed + (MftGapSlack / VolumeFree))
16755. SetVariable(MftReport, "!MftReport!VolumeFreePerUsed: !VolumeFreePerUsed!
16756. ")
16757. 
16758. /* ------------------------- */
16759. #  MFT
16760. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
16761. 
16762. # Script: DefragZoneTypeOsMft
16763. /* ------------------------- */
16764. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
16765.   
16766. SetVariable(ZoneLabel,				"MFT") // "4" 
16767. SetVariable(ZoneDescription, 		"MFT - Master File Table")
16768. /* and some other special NTFS files. */
16769. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpMft!")
16770. SetVariable(ZoneGapSize, 			"!ZoneGapSizeMft!")
16771. 
16772. SetVariable(ZoneTypeSelect,			'
16773. MFT Master File Table:
16774. # Script: ZoneDo ZoneTypeSelectOsMFT
16775. # MFT start.
16776. SelectNtfsSystemFiles(yes)
16777. # MFT end.
16778. ')
16779. 
16780. 	# First 1st of 2 in Group MftDir
16781. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
16782. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
16783. 
16784. SetVariable(ZoneStepNoCurrent, 0)
16785. 
16786. 	/* ------------------------- */
16787. # Script: ZoneDoHeader
16788. 
16789. # Script: ZoneWhenStarted
16790. RunProgram("..\Commands\WriteDateTime.bat")
16791. 
16792. # Script: ZoneDoCurrentClear
16793. 
16794. SetVariable(ZoneTypeSelectCurrent, 		"")
16795. SetVariable(ZoneStatisticsData, 		"")
16796. SetVariable(ZoneStepByLine, 			"")
16797. 
16798. SetVariable(ZoneBeginCurrent, 			0)
16799. SetVariable(ZoneBeginPerCurrent, 		0)
16800. SetVariable(ZoneEndCurrent, 			0)
16801. SetVariable(ZoneEndPerCurrent, 			0)
16802. 
16803. SetVariable(ZoneSizeCurrent,			0)
16804. SetVariable(ZoneSizePerCurrent,			0)
16805. 
16806. SetVariable(ZoneGapRequestedCurrent,	0)
16807. SetVariable(ZoneGapRoundedCurrent, 		0)
16808. SetVariable(ZoneGapAdjustedCurrent, 	0)
16809. SetVariable(ZoneGapAvailableCurrent, 	0)
16810. SetVariable(ZoneGapCurrent,				0)
16811. SetVariable(ZoneGapUsedCurrent, 		0)
16812. 
16813. SetVariable(ZoneGapActualCurrent, 		0)
16814. SetVariable(ZoneGapActualPerCurrent, 	0)
16815. 
16816. SetVariable(ZoneSizeActual, 			0)
16817. SetVariable(ZoneSizeActualCurrent,		0)
16818. 
16819. SetVariable(ZoneEndActual, 				0)
16820. SetVariable(ZoneEndActualCurrent,		0)			
16821. SetVariable(ZoneSizeActualPerCurrent, 	0)
16822.       
16823. SetVariable(ZoneFilesFolders,			0)
16824. SetVariable(ZoneFilesFoldersPer,		0) 
16825. 
16826. SetVariable(ZoneFragments,				0)
16827. SetVariable(ZoneFragmentsPer,			0) 
16828. 		
16829. SetVariable(ZoneEndActualCurrent, 		0)
16830. SetVariable(ZoneEndActualPerCurrent, 	0)
16831. 
16832. # Gap Calculation Methodology:
16833. 	# Requested
16834. 	SetVariable(GapRequested, 			0) 
16835. 	SetVariable(GapRequestedStd, 		0) 
16836. 	SetVariable(GapRequestedMft, 		0) 
16837. 	SetVariable(GapRequestedOs, 		0) 
16838. 	SetVariable(GapRequestedOriginal, 	0) 
16839. 	
16840. 	# Gap Adjustments
16841. 	SetVariable(GapRounded, 			0)
16842. 	# SetVariable(GapAdjusted, 			0)
16843. 	SetVariable(GapAvailable, 			0)
16844. 	SetVariable(GapCurrent, 			0)
16845. 	SetVariable(GapActual, 				0)
16846. 	SetVariable(GapUsed, 				0)
16847. 	
16848. 	# Gap Adjustments
16849. 	SetVariable(GapRoundedLoc, 			0)
16850. 	# SetVariable(GapAdjustedLoc, 		0)
16851. 	SetVariable(GapAvailableLoc, 		0)
16852. 	SetVariable(GapCurrentLoc, 			0)
16853. 	SetVariable(GapActualLoc,			0)
16854. 	SetVariable(GapUsedLoc,				0)
16855. 	
16856. 	# Space usage
16857. 	SetVariable(ZoneFreePerRequested, 	0)
16858. 	SetVariable(ZoneFreePerUsed, 		0)
16859. 
16860. # Gap Size & Rounding
16861. 	SetVariable(ZoneGapSizePer, 		0)
16862. 	SetVariable(ZoneVolRoundUpPer, 		0)
16863. 	
16864. 	# Free Space
16865. 	SetVariable(ZoneFreeUsedPer, 		0)
16866. 	SetVariable(ZoneFreeRequestedPer, 	0)
16867. 
16868. # Script: DisplaySetZone
16869. 
16870. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
16871. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
16872. 
16873. # Message ZoneSummary
16874. # SetVariable(ZoneSummary, '
16875. # Zone Summary:
16876. # ')
16877. # Zone processing steps
16878. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
16879. # ')
16880. 
16881. # # Script: BannerDescriptionSet
16882. 
16883. # Script: BannerSet
16884. 
16885. # NOTE: Can't round or truncate to integer precision. 
16886. # This internal fields like ZoneCount format really badly.
16887. #  for !RunTimeNow! does not work. None of the date functions do.
16888. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16889. 
16890. SetVariable(HeadingTemp2,	ZoneCount + 0)
16891. 
16892. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16893. 
16894. Title('!Heading!')
16895. 
16896. /* pause(1) */
16897. 
16898. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16899. 
16900. 
16901. # Script: BannerLog
16902. 
16903. AppendLogfile("!LogFileName!", "!Heading!")
16904. 
16905. 
16906. 
16907. # pause(1)
16908. 
16909. 
16910. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
16911. # Script: DisplaySetZoneStep
16912. # Increment
16913. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16914. 
16915. # Display this zone step
16916. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
16917. ')
16918. 
16919. # Script: BannerSet
16920. 
16921. # NOTE: Can't round or truncate to integer precision. 
16922. # This internal fields like ZoneCount format really badly.
16923. #  for !RunTimeNow! does not work. None of the date functions do.
16924. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16925. 
16926. SetVariable(HeadingTemp2,	ZoneCount + 0)
16927. 
16928. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16929. 
16930. Title('!Heading!')
16931. 
16932. /* pause(1) */
16933. 
16934. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16935. 
16936. 
16937. # Script: DisplaySetWindowText
16938. # Zone Footer Set Statistics Window Text
16939. 
16940. SetStatisticsWindowText("!Heading!
16941. ----------------------------------------------------------
16942. Zones Processed: 
16943. ----------------------------------------------------------
16944. !ZoneListByLine!
16945. ----------------------------------------------------------
16946. Zone Processing Step:
16947. !ZoneStepByLine!    
16948. ----------------------------------------------------------
16949. ----------------------------------------------------------
16950. CURRENT ZONE:
16951. !ZoneStatisticsReport!
16952. ----------------------------------------------------------
16953. ----------------------------------------------------------
16954. ----------------------------------------------------------
16955. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
16956. ----------------------------------------------------------
16957. !VolumeStatisticsSummary!
16958. !VolumeStatisticsDetail!
16959. ----------------------------------------------------------
16960. ----------------------------------------------------------
16961. Zone Detailed Report:
16962. ----------------------------------------------------------
16963. !ZoneStatisticsDetail!
16964. ----------------------------------------------------------
16965. ")
16966. 
16967. 
16968. 
16969. 
16970. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
16971. 
16972. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
16973. # Script: DisplaySetZoneStep
16974. # Increment
16975. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16976. 
16977. # Display this zone step
16978. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
16979. ')
16980. 
16981. # Script: BannerSet
16982. 
16983. # NOTE: Can't round or truncate to integer precision. 
16984. # This internal fields like ZoneCount format really badly.
16985. #  for !RunTimeNow! does not work. None of the date functions do.
16986. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16987. 
16988. SetVariable(HeadingTemp2,	ZoneCount + 0)
16989. 
16990. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16991. 
16992. Title('!Heading!')
16993. 
16994. /* pause(1) */
16995. 
16996. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
16997. 
16998. 
16999. # Script: DisplaySetWindowText
17000. # Zone Footer Set Statistics Window Text
17001. 
17002. SetStatisticsWindowText("!Heading!
17003. ----------------------------------------------------------
17004. Zones Processed: 
17005. ----------------------------------------------------------
17006. !ZoneListByLine!
17007. ----------------------------------------------------------
17008. Zone Processing Step:
17009. !ZoneStepByLine!    
17010. ----------------------------------------------------------
17011. ----------------------------------------------------------
17012. CURRENT ZONE:
17013. !ZoneStatisticsReport!
17014. ----------------------------------------------------------
17015. ----------------------------------------------------------
17016. ----------------------------------------------------------
17017. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
17018. ----------------------------------------------------------
17019. !VolumeStatisticsSummary!
17020. !VolumeStatisticsDetail!
17021. ----------------------------------------------------------
17022. ----------------------------------------------------------
17023. Zone Detailed Report:
17024. ----------------------------------------------------------
17025. !ZoneStatisticsDetail!
17026. ----------------------------------------------------------
17027. ")
17028. 
17029. 
17030. 
17031. 
17032. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
17033. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
17034. 
17035. # Script: BannerSet
17036. 
17037. # NOTE: Can't round or truncate to integer precision. 
17038. # This internal fields like ZoneCount format really badly.
17039. #  for !RunTimeNow! does not work. None of the date functions do.
17040. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17041. 
17042. SetVariable(HeadingTemp2,	ZoneCount + 0)
17043. 
17044. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17045. 
17046. Title('!Heading!')
17047. 
17048. /* pause(1) */
17049. 
17050. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17051. 
17052. 
17053. # Script: BannerLog
17054. 
17055. AppendLogfile("!LogFileName!", "!Heading!")
17056. 
17057. 
17058. 
17059. # LOGGING:
17060. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
17061. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
17062. 
17063. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
17064. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:00")
17065. # 2021-12-14 15:30:00 
17066. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:05 !ZoneLabel! !ZoneDescription!")
17067. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
17068. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:05 !ZoneLabel! !ZoneDescription!")
17069. 
17070. 
17071. # Add zone to list of zones:
17072. SetVariable(ZoneListByLine, "!ZoneListByLine!
17073. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
17074. # Script: DisplaySetWindowText
17075. # Zone Footer Set Statistics Window Text
17076. 
17077. SetStatisticsWindowText("!Heading!
17078. ----------------------------------------------------------
17079. Zones Processed: 
17080. ----------------------------------------------------------
17081. !ZoneListByLine!
17082. ----------------------------------------------------------
17083. Zone Processing Step:
17084. !ZoneStepByLine!    
17085. ----------------------------------------------------------
17086. ----------------------------------------------------------
17087. CURRENT ZONE:
17088. !ZoneStatisticsReport!
17089. ----------------------------------------------------------
17090. ----------------------------------------------------------
17091. ----------------------------------------------------------
17092. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
17093. ----------------------------------------------------------
17094. !VolumeStatisticsSummary!
17095. !VolumeStatisticsDetail!
17096. ----------------------------------------------------------
17097. ----------------------------------------------------------
17098. Zone Detailed Report:
17099. ----------------------------------------------------------
17100. !ZoneStatisticsDetail!
17101. ----------------------------------------------------------
17102. ")
17103. 
17104. 
17105. 
17106. 
17107. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
17108. # Script: DisplaySetZoneStep
17109. # Increment
17110. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17111. 
17112. # Display this zone step
17113. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
17114. ')
17115. 
17116. # Script: BannerSet
17117. 
17118. # NOTE: Can't round or truncate to integer precision. 
17119. # This internal fields like ZoneCount format really badly.
17120. #  for !RunTimeNow! does not work. None of the date functions do.
17121. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17122. 
17123. SetVariable(HeadingTemp2,	ZoneCount + 0)
17124. 
17125. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17126. 
17127. Title('!Heading!')
17128. 
17129. /* pause(1) */
17130. 
17131. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17132. 
17133. 
17134. # Script: DisplaySetWindowText
17135. # Zone Footer Set Statistics Window Text
17136. 
17137. SetStatisticsWindowText("!Heading!
17138. ----------------------------------------------------------
17139. Zones Processed: 
17140. ----------------------------------------------------------
17141. !ZoneListByLine!
17142. ----------------------------------------------------------
17143. Zone Processing Step:
17144. !ZoneStepByLine!    
17145. ----------------------------------------------------------
17146. ----------------------------------------------------------
17147. CURRENT ZONE:
17148. !ZoneStatisticsReport!
17149. ----------------------------------------------------------
17150. ----------------------------------------------------------
17151. ----------------------------------------------------------
17152. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
17153. ----------------------------------------------------------
17154. !VolumeStatisticsSummary!
17155. !VolumeStatisticsDetail!
17156. ----------------------------------------------------------
17157. ----------------------------------------------------------
17158. Zone Detailed Report:
17159. ----------------------------------------------------------
17160. !ZoneStatisticsDetail!
17161. ----------------------------------------------------------
17162. ")
17163. 
17164. 
17165. 
17166. 
17167. # your stuff HERE (X)... pre file select code.
17168. 
17169. /* --------------------------------- */
17170. 	FileSelect
17171. 
17172. 		# your stuff can't really go here (errors.)
17173. 		# maybe for some reason I don't know of...
17174. 	
17175. 		# Actions next...
17176. 	# Script: ZoneDo ZoneTypeSelectOsMFT
17177. # MFT start.
17178. SelectNtfsSystemFiles(yes)
17179. # MFT end.
17180. 	
17181. 	FileActions
17182. 
17183. 			# Script: GapZoneCalc
17184. 	# Gap
17185. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
17186. 		# Script: DisplaySetZoneStep
17187. # Increment
17188. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17189. 
17190. # Display this zone step
17191. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
17192. ')
17193. 
17194. # Script: BannerSet
17195. 
17196. # NOTE: Can't round or truncate to integer precision. 
17197. # This internal fields like ZoneCount format really badly.
17198. #  for !RunTimeNow! does not work. None of the date functions do.
17199. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17200. 
17201. SetVariable(HeadingTemp2,	ZoneCount + 0)
17202. 
17203. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17204. 
17205. Title('!Heading!')
17206. 
17207. /* pause(1) */
17208. 
17209. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17210. 
17211. 
17212. # Script: DisplaySetWindowText
17213. # Zone Footer Set Statistics Window Text
17214. 
17215. SetStatisticsWindowText("!Heading!
17216. ----------------------------------------------------------
17217. Zones Processed: 
17218. ----------------------------------------------------------
17219. !ZoneListByLine!
17220. ----------------------------------------------------------
17221. Zone Processing Step:
17222. !ZoneStepByLine!    
17223. ----------------------------------------------------------
17224. ----------------------------------------------------------
17225. CURRENT ZONE:
17226. !ZoneStatisticsReport!
17227. ----------------------------------------------------------
17228. ----------------------------------------------------------
17229. ----------------------------------------------------------
17230. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
17231. ----------------------------------------------------------
17232. !VolumeStatisticsSummary!
17233. !VolumeStatisticsDetail!
17234. ----------------------------------------------------------
17235. ----------------------------------------------------------
17236. Zone Detailed Report:
17237. ----------------------------------------------------------
17238. !ZoneStatisticsDetail!
17239. ----------------------------------------------------------
17240. ")
17241. 
17242. 
17243. 
17244. 	
17245. 	# ACTUAL GAP
17246. 		/* AddGap Variant. */
17247. 	  	# Script: GapZoneSet
17248. # Zone Do Gap
17249. # Gap Calculation Methods:
17250. 
17251. /* 1) Anything you need to add first. */
17252. /* empty */
17253. 
17254. /* ------------------------- */
17255. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
17256. 	# GapRequestedStd.
17257. 
17258. 		/* ------------------------- */
17259. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
17260. 
17261. 		# Gap Calculation Methods:
17262. 
17263. /* AddGap Variants */
17264. 
17265. 	/* Standard */
17266. 		# Gap Calculation Methods:
17267. 	/* AddGap Variants */
17268. 	/* Standard */
17269. 
17270. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
17271. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
17272. 
17273. 	SetVariable(GapRequested, GapRequestedStd)
17274. 	
17275. 
17276. 	/* MFT Low High Method */
17277. 		# Gap Calculation Methods:
17278. 	/* AddGap Variants */
17279. 	/* MFT Low High Method */
17280. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
17281. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
17282. 	SetVariable(GapRequested, GapRequestedMft)
17283. 	
17284. 
17285. 	/* OS Volume Type Method */
17286. 		# Gap Calculation Methods:
17287. 	/* AddGap Variants */
17288. 	/* OS Volume Type Method */
17289. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
17290. 	SetVariable(GapRequested, GapRequestedOs)
17291. 
17292. 
17293. 
17294. /* MakeGap Variants */
17295. 
17296. 	/* Original Os 1-3 + MFT 2 */
17297. 		# Gap Calculation Methods:
17298. 	/* MakeGap Variants */
17299. 	/* Original Os 1-3 + MFT 2 */
17300. 	/* plus MFT gap placed inline at the dividing zone. */
17301. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
17302. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
17303. 	SetVariable(GapRequested, GapRequestedOrig)
17304. 	
17305. 	
17306. /* Note: You could comment out the ones not in use */
17307. /* However having the data in the log is useful. */
17308. /* Therefore the following line is otherwise needed. */
17309. 
17310. /* Standard used */
17311. 
17312. SetVariable(GapRequested, GapRequestedStd)
17313. 
17314. # Gap Calculation Methods:
17315. 
17316. /* AddGap Variants */
17317. 	/* Standard */
17318. 	/* MFT Low High Method */
17319. 	/* OS Volume Type Method */
17320. 
17321. /* MakeGap Variants */
17322. 	/* Original Os 1-3 + MFT 2 */
17323. 
17324. /* Note: You could comment out the ones not in use */
17325. /* However having the data in the log is useful. */
17326. /* Therefore the following line is otherwise needed. */
17327. 
17328. /* Standard is used currently */
17329. 
17330. 
17331. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
17332. 
17333. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
17334. 
17335. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
17336. 
17337. /* ------------------------- */
17338. /* 3) SMALL ZONE ADJUSTMENT. */
17339. /* Gab cant be larger than half the Zone Size. */
17340. 
17341. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
17342. 	
17343. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
17344. 
17345. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
17346. 
17347. /* ------------------------- */
17348. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
17349. # Gap Adjustments.
17350. 
17351. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
17352. 	
17353. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
17354. 
17355. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
17356. 
17357. /* ------------------------- */
17358. # BYPASS THIS.
17359. 	/* This is definitely wrong. */
17360. 	/* The question is can we steal gap from the next zone */
17361. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
17362. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
17363. 		# Zone Overflow.
17364. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
17365. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
17366. 
17367. /* ------------------------- */
17368. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
17369. # Remaining free space available.
17370. 
17371. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
17372. 	
17373. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
17374. 
17375. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
17376. 
17377. /* ------------------------- */
17378. # CURRENT gap to use.
17379. 
17380. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
17381. 
17382. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
17383. 
17384. /* ------------------------- */
17385. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
17386. # Debugging.
17387. 
17388. 	SetVariable(GapUsed, GapCurrent) // for debugging
17389. 
17390. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
17391. 
17392. 		# Your code HERE
17393. 
17394. /* ------------------------- */
17395. /* 7) YOUR CODE. */
17396. # YOUR CODE HERE:
17397. 	# INPUT: GapCurrent or GapCurrentLoc
17398. 	# OUTPUT: GapUsed...
17399. 
17400. /* ------------------------- */
17401. # Gap Size.
17402. # Actual Size of Gap.
17403. 
17404. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
17405. 
17406. /* ------------------------- */
17407. 
17408. 	
17409. 	# Zone Statistics	
17410. 		# Script: ZoneStatisticsGet
17411. # Zone / Volume Statistics and Display
17412. 		
17413. 	# Accumulate Totals
17414.   	# Script: ZoneDoVolumeTotals
17415. 
17416. /* Current total space used (by Zones and Gaps) */
17417. 
17418. SetVariable(VolumeZoneUsed, GapUsed)
17419. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
17420. /* Percentage */
17421. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
17422. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
17423. 
17424. /* Current total of free space requested */
17425. 
17426. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
17427. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17428. /* Percent. */
17429. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
17430. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17431. 
17432. /* Current total of free space used */
17433. 
17434. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
17435. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
17436. /* Percent */
17437. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
17438. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
17439. 
17440. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
17441. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
17442. # Xinclude "..\DebugDisplayPause.MyDc"X
17443. 
17444. 
17445. 	# Current Values
17446. 	# Script: ZoneDoCurrentSet
17447. 
17448. # Cluster, Sector, Block adjust for display.
17449. 	# Bytes per cluster is volume specific.
17450. 
17451. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
17452. 
17453. # Current Zone values.
17454. 	# Begin, end and size.
17455. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
17456. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
17457. 
17458. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
17459. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
17460. 
17461. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
17462. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
17463. 
17464. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
17465. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
17466. 
17467. 	SetVariable(ZoneFragments,				"!ZONE210N!")
17468. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
17469. 		
17470. # Current Gap, Actual and Free Values
17471. 	# Gap
17472. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
17473. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
17474. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
17475. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
17476. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
17477. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
17478. 	
17479. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
17480. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
17481. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
17482. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
17483. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
17484. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
17485. 	
17486. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
17487. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
17488. 	
17489. 	# Actual Size and End
17490. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
17491. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
17492. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
17493. 	
17494. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
17495. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
17496. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
17497. 
17498. # Gap Size & Rounding
17499. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
17500. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
17501. 	
17502. 	# Free Space
17503. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
17504. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
17505. 
17506. 	# Script: ZoneStatisticsReportGet
17507. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
17508. 
17509. # Footer:
17510. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
17511. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
17512. #
17513. # Xinclude "..\Commands\DateTimeLastLong.txt"X
17514. #
17515. # What a mess this word based vs is. Try a phrase based version ToDo
17516. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
17517. ------------------
17518.    !SizeWord!!ColonWord!  
17519.    ------------------------
17520.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17521.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17522.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17523. 
17524.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17525.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
17526. 
17527.    !LocationWord!!ColonWord!
17528.    ------------------------
17529.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17530.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
17531.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17532.       
17533.    !GapWordCaps! !SettingsWord!!ColonWord!
17534.    ------------------------
17535.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
17536.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
17537.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17538.                  
17539.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
17540.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
17541.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
17542.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
17543.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
17544.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
17545.      
17546.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
17547.    ------------------------
17548.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17549.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17550.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17551. 
17552. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
17553. ----------------------------------------------------------
17554. ")
17555. #
17556. SetVariable(DateNow, 	DATETIME)
17557. SetVariable(TimeNow, 	Time)
17558. SetVariable(RunTimeNow, 	RunTime)
17559. 
17560. 
17561. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
17562. 
17563. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
17564. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
17565. 
17566. 	# Script: DisplaySetWindowText
17567. # Zone Footer Set Statistics Window Text
17568. 
17569. SetStatisticsWindowText("!Heading!
17570. ----------------------------------------------------------
17571. Zones Processed: 
17572. ----------------------------------------------------------
17573. !ZoneListByLine!
17574. ----------------------------------------------------------
17575. Zone Processing Step:
17576. !ZoneStepByLine!    
17577. ----------------------------------------------------------
17578. ----------------------------------------------------------
17579. CURRENT ZONE:
17580. !ZoneStatisticsReport!
17581. ----------------------------------------------------------
17582. ----------------------------------------------------------
17583. ----------------------------------------------------------
17584. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
17585. ----------------------------------------------------------
17586. !VolumeStatisticsSummary!
17587. !VolumeStatisticsDetail!
17588. ----------------------------------------------------------
17589. ----------------------------------------------------------
17590. Zone Detailed Report:
17591. ----------------------------------------------------------
17592. !ZoneStatisticsDetail!
17593. ----------------------------------------------------------
17594. ")
17595. 
17596. 
17597. 	
17598. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
17599. 
17600. 
17601. 	SetVariable(ZoneStatisticsData, 
17602. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
17603.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
17604.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
17605. 
17606. 
17607. 
17608.  		# Script: ZoneStatisticsDisplay
17609. 	
17610. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
17611. !ZoneStatisticsData!
17612. ')
17613. 
17614. 		# Script: ZoneStatisticsAdd
17615. # Append Zone to Details of each zone.
17616. 		
17617. 	# Add Zone Details to Report.	
17618. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
17619. !ZoneStatisticsReport!
17620. ')
17621. 
17622. 
17623. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
17624. 		# Script: DisplaySetZoneStep
17625. # Increment
17626. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17627. 
17628. # Display this zone step
17629. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
17630. ')
17631. 
17632. # Script: BannerSet
17633. 
17634. # NOTE: Can't round or truncate to integer precision. 
17635. # This internal fields like ZoneCount format really badly.
17636. #  for !RunTimeNow! does not work. None of the date functions do.
17637. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17638. 
17639. SetVariable(HeadingTemp2,	ZoneCount + 0)
17640. 
17641. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17642. 
17643. Title('!Heading!')
17644. 
17645. /* pause(1) */
17646. 
17647. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17648. 
17649. 
17650. # Script: DisplaySetWindowText
17651. # Zone Footer Set Statistics Window Text
17652. 
17653. SetStatisticsWindowText("!Heading!
17654. ----------------------------------------------------------
17655. Zones Processed: 
17656. ----------------------------------------------------------
17657. !ZoneListByLine!
17658. ----------------------------------------------------------
17659. Zone Processing Step:
17660. !ZoneStepByLine!    
17661. ----------------------------------------------------------
17662. ----------------------------------------------------------
17663. CURRENT ZONE:
17664. !ZoneStatisticsReport!
17665. ----------------------------------------------------------
17666. ----------------------------------------------------------
17667. ----------------------------------------------------------
17668. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
17669. ----------------------------------------------------------
17670. !VolumeStatisticsSummary!
17671. !VolumeStatisticsDetail!
17672. ----------------------------------------------------------
17673. ----------------------------------------------------------
17674. Zone Detailed Report:
17675. ----------------------------------------------------------
17676. !ZoneStatisticsDetail!
17677. ----------------------------------------------------------
17678. ")
17679. 
17680. 
17681. 
17682. 
17683. 		SetVariable(MftZone,	ZoneCurrent) 
17684. 
17685. 		# File Action - Type Os MFT - Regular - PlaceNtfsSystemFiles.
17686. PlaceNtfsSystemFiles(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes), MftSize * 0.1)
17687. 	
17688. 
17689.   		# SetVariable(MftSize,	ZoneSize) 
17690. 
17691. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
17692. 
17693. 		# Script: DisplaySetZoneStep
17694. # Increment
17695. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17696. 
17697. # Display this zone step
17698. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
17699. ')
17700. 
17701. # Script: BannerSet
17702. 
17703. # NOTE: Can't round or truncate to integer precision. 
17704. # This internal fields like ZoneCount format really badly.
17705. #  for !RunTimeNow! does not work. None of the date functions do.
17706. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17707. 
17708. SetVariable(HeadingTemp2,	ZoneCount + 0)
17709. 
17710. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17711. 
17712. Title('!Heading!')
17713. 
17714. /* pause(1) */
17715. 
17716. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17717. 
17718. 
17719. # Script: DisplaySetWindowText
17720. # Zone Footer Set Statistics Window Text
17721. 
17722. SetStatisticsWindowText("!Heading!
17723. ----------------------------------------------------------
17724. Zones Processed: 
17725. ----------------------------------------------------------
17726. !ZoneListByLine!
17727. ----------------------------------------------------------
17728. Zone Processing Step:
17729. !ZoneStepByLine!    
17730. ----------------------------------------------------------
17731. ----------------------------------------------------------
17732. CURRENT ZONE:
17733. !ZoneStatisticsReport!
17734. ----------------------------------------------------------
17735. ----------------------------------------------------------
17736. ----------------------------------------------------------
17737. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
17738. ----------------------------------------------------------
17739. !VolumeStatisticsSummary!
17740. !VolumeStatisticsDetail!
17741. ----------------------------------------------------------
17742. ----------------------------------------------------------
17743. Zone Detailed Report:
17744. ----------------------------------------------------------
17745. !ZoneStatisticsDetail!
17746. ----------------------------------------------------------
17747. ")
17748. 
17749. 
17750. 
17751. 
17752.   	# Script: ZoneDoFooter
17753. 
17754. /* --------------------------------- */
17755. 	# File Select
17756. 		# Select Statments
17757. 	# File Actions 
17758. 		# Standard or OS File Actions.
17759. 		# Resume...
17760. 	
17761. 		# your stuff HERE (X)... post zone (file) file actions code.
17762. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
17763. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
17764. 			# (X)
17765. 		
17766. 			/* ??? Set window? */
17767. 	
17768. 		# ADD THE GAP
17769. 		# Script: GapZoneCommand
17770. # Vacate (good for diagnostics)
17771. # DoNotVacate - DO NOT Vacate (recommended)
17772. 
17773. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
17774. # Script: DisplaySetZoneStep
17775. # Increment
17776. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17777. 
17778. # Display this zone step
17779. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
17780. ')
17781. 
17782. # Script: BannerSet
17783. 
17784. # NOTE: Can't round or truncate to integer precision. 
17785. # This internal fields like ZoneCount format really badly.
17786. #  for !RunTimeNow! does not work. None of the date functions do.
17787. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17788. 
17789. SetVariable(HeadingTemp2,	ZoneCount + 0)
17790. 
17791. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17792. 
17793. Title('!Heading!')
17794. 
17795. /* pause(1) */
17796. 
17797. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17798. 
17799. 
17800. # Script: DisplaySetWindowText
17801. # Zone Footer Set Statistics Window Text
17802. 
17803. SetStatisticsWindowText("!Heading!
17804. ----------------------------------------------------------
17805. Zones Processed: 
17806. ----------------------------------------------------------
17807. !ZoneListByLine!
17808. ----------------------------------------------------------
17809. Zone Processing Step:
17810. !ZoneStepByLine!    
17811. ----------------------------------------------------------
17812. ----------------------------------------------------------
17813. CURRENT ZONE:
17814. !ZoneStatisticsReport!
17815. ----------------------------------------------------------
17816. ----------------------------------------------------------
17817. ----------------------------------------------------------
17818. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
17819. ----------------------------------------------------------
17820. !VolumeStatisticsSummary!
17821. !VolumeStatisticsDetail!
17822. ----------------------------------------------------------
17823. ----------------------------------------------------------
17824. Zone Detailed Report:
17825. ----------------------------------------------------------
17826. !ZoneStatisticsDetail!
17827. ----------------------------------------------------------
17828. ")
17829. 
17830. 
17831. 
17832. 
17833. # *** Moved to setting yours *** 
17834. # (to avoid doing it twice)
17835. # (ie the later wouldn't "overwrite" the former in the usual manner)
17836. 
17837. # Do one or the other:
17838. # DoNotVacate - DO NOT Vacate (recommended)
17839. 
17840. # Vacate
17841. /* AddGap(GapUsedLoc) */
17842. 
17843. # DO Not Vacate
17844. AddGap(GapUsedLoc, DoNotVacate) 
17845. 	
17846. 	
17847. 
17848. # Controlled via settings commands
17849. 
17850. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
17851. 
17852. # Vacate /* AddGap(GapUsed) */
17853. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
17854. 	
17855. 
17856. 		
17857. 	# 
17858. 	FileEnd
17859. /* --------------------------------- */
17860. # your stuff HERE (X)... post zone (file) code.
17861. 
17862. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
17863. # Script: DisplaySetZoneStep
17864. # Increment
17865. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17866. 
17867. # Display this zone step
17868. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
17869. ')
17870. 
17871. # Script: BannerSet
17872. 
17873. # NOTE: Can't round or truncate to integer precision. 
17874. # This internal fields like ZoneCount format really badly.
17875. #  for !RunTimeNow! does not work. None of the date functions do.
17876. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17877. 
17878. SetVariable(HeadingTemp2,	ZoneCount + 0)
17879. 
17880. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17881. 
17882. Title('!Heading!')
17883. 
17884. /* pause(1) */
17885. 
17886. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
17887. 
17888. 
17889. # Script: DisplaySetWindowText
17890. # Zone Footer Set Statistics Window Text
17891. 
17892. SetStatisticsWindowText("!Heading!
17893. ----------------------------------------------------------
17894. Zones Processed: 
17895. ----------------------------------------------------------
17896. !ZoneListByLine!
17897. ----------------------------------------------------------
17898. Zone Processing Step:
17899. !ZoneStepByLine!    
17900. ----------------------------------------------------------
17901. ----------------------------------------------------------
17902. CURRENT ZONE:
17903. !ZoneStatisticsReport!
17904. ----------------------------------------------------------
17905. ----------------------------------------------------------
17906. ----------------------------------------------------------
17907. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
17908. ----------------------------------------------------------
17909. !VolumeStatisticsSummary!
17910. !VolumeStatisticsDetail!
17911. ----------------------------------------------------------
17912. ----------------------------------------------------------
17913. Zone Detailed Report:
17914. ----------------------------------------------------------
17915. !ZoneStatisticsDetail!
17916. ----------------------------------------------------------
17917. ")
17918. 
17919. 
17920. 
17921. 
17922. # Script: ZoneWhenFinished
17923. 
17924. # Add the zone to the zone details log:
17925. # This is temporarily disable until logging is fixed
17926. # It is performed during file action to preserve the correct (original) calculations.
17927. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
17928. 
17929. # Add the Select and ZoneSteps to the Zone
17930. # Script: ZoneStatisticsAdd
17931. # Append Zone to Details of each zone.
17932. 		
17933. 	# Add Zone Details to Report.	
17934. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
17935. ----------------------------------------------------------
17936. !ZoneStepByLine!
17937. ---------------------------
17938. !ZoneTypeSelectCurrent!               
17939. ---------------------------
17940. ----------------------------------------------------------
17941. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
17942. ----------------------------------------------------------
17943. ')
17944. 
17945. 
17946. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
17947. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
17948. # 2021-12-14 15:30:00
17949. RunProgram("..\Commands\WriteDateTime.bat LastZone")
17950. # Append Datetime to logs
17951. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
17952. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
17953. 
17954. AppendLogfile("!LogFileName!", "!PeriodWord!")
17955. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
17956. AppendLogfile("!LogFileName!", "!PeriodWord!")
17957. 
17958. # Script: DisplaySetWindowText
17959. # Zone Footer Set Statistics Window Text
17960. 
17961. SetStatisticsWindowText("!Heading!
17962. ----------------------------------------------------------
17963. Zones Processed: 
17964. ----------------------------------------------------------
17965. !ZoneListByLine!
17966. ----------------------------------------------------------
17967. Zone Processing Step:
17968. !ZoneStepByLine!    
17969. ----------------------------------------------------------
17970. ----------------------------------------------------------
17971. CURRENT ZONE:
17972. !ZoneStatisticsReport!
17973. ----------------------------------------------------------
17974. ----------------------------------------------------------
17975. ----------------------------------------------------------
17976. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
17977. ----------------------------------------------------------
17978. !VolumeStatisticsSummary!
17979. !VolumeStatisticsDetail!
17980. ----------------------------------------------------------
17981. ----------------------------------------------------------
17982. Zone Detailed Report:
17983. ----------------------------------------------------------
17984. !ZoneStatisticsDetail!
17985. ----------------------------------------------------------
17986. ")
17987. 
17988. 
17989. 
17990. /* pause() */
17991. /* pause() */
17992. 
17993. 
17994. 
17995. /* ------------------------- */
17996. 
17997. /* ------------------------- */
17998. 
17999.   
18000. /* ------------------------- */
18001. # DIR
18002. 
18003. # Script: DefragZoneTypeOsDir
18004. /* ------------------------- */
18005. SetVariable(ZoneLabel,				"DIR") // "5"
18006. SetVariable(ZoneDescription, 		"Directories.")
18007. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpDir!")
18008. SetVariable(ZoneGapSize, 			"!ZoneGapSizeDir!")
18009. 
18010. SetVariable(ZoneTypeSelect,'
18011. Directories:
18012. # Script: ZoneDo ZoneTypeSelectOsDIR
18013. # DIR start.
18014. Directory(yes)
18015. # DIR end.
18016. 
18017. ')
18018. 
18019. 	SetVariable(ZoneNoCurrentAdjust, ZoneNoCurrentAdjust + 1)
18020. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
18021. 
18022. SetVariable(ZoneStepNoCurrent, 0)
18023. 
18024. 	/* ------------------------- */
18025. # Script: ZoneDoHeader
18026. 
18027. # Script: ZoneWhenStarted
18028. RunProgram("..\Commands\WriteDateTime.bat")
18029. 
18030. # Script: ZoneDoCurrentClear
18031. 
18032. SetVariable(ZoneTypeSelectCurrent, 		"")
18033. SetVariable(ZoneStatisticsData, 		"")
18034. SetVariable(ZoneStepByLine, 			"")
18035. 
18036. SetVariable(ZoneBeginCurrent, 			0)
18037. SetVariable(ZoneBeginPerCurrent, 		0)
18038. SetVariable(ZoneEndCurrent, 			0)
18039. SetVariable(ZoneEndPerCurrent, 			0)
18040. 
18041. SetVariable(ZoneSizeCurrent,			0)
18042. SetVariable(ZoneSizePerCurrent,			0)
18043. 
18044. SetVariable(ZoneGapRequestedCurrent,	0)
18045. SetVariable(ZoneGapRoundedCurrent, 		0)
18046. SetVariable(ZoneGapAdjustedCurrent, 	0)
18047. SetVariable(ZoneGapAvailableCurrent, 	0)
18048. SetVariable(ZoneGapCurrent,				0)
18049. SetVariable(ZoneGapUsedCurrent, 		0)
18050. 
18051. SetVariable(ZoneGapActualCurrent, 		0)
18052. SetVariable(ZoneGapActualPerCurrent, 	0)
18053. 
18054. SetVariable(ZoneSizeActual, 			0)
18055. SetVariable(ZoneSizeActualCurrent,		0)
18056. 
18057. SetVariable(ZoneEndActual, 				0)
18058. SetVariable(ZoneEndActualCurrent,		0)			
18059. SetVariable(ZoneSizeActualPerCurrent, 	0)
18060.       
18061. SetVariable(ZoneFilesFolders,			0)
18062. SetVariable(ZoneFilesFoldersPer,		0) 
18063. 
18064. SetVariable(ZoneFragments,				0)
18065. SetVariable(ZoneFragmentsPer,			0) 
18066. 		
18067. SetVariable(ZoneEndActualCurrent, 		0)
18068. SetVariable(ZoneEndActualPerCurrent, 	0)
18069. 
18070. # Gap Calculation Methodology:
18071. 	# Requested
18072. 	SetVariable(GapRequested, 			0) 
18073. 	SetVariable(GapRequestedStd, 		0) 
18074. 	SetVariable(GapRequestedMft, 		0) 
18075. 	SetVariable(GapRequestedOs, 		0) 
18076. 	SetVariable(GapRequestedOriginal, 	0) 
18077. 	
18078. 	# Gap Adjustments
18079. 	SetVariable(GapRounded, 			0)
18080. 	# SetVariable(GapAdjusted, 			0)
18081. 	SetVariable(GapAvailable, 			0)
18082. 	SetVariable(GapCurrent, 			0)
18083. 	SetVariable(GapActual, 				0)
18084. 	SetVariable(GapUsed, 				0)
18085. 	
18086. 	# Gap Adjustments
18087. 	SetVariable(GapRoundedLoc, 			0)
18088. 	# SetVariable(GapAdjustedLoc, 		0)
18089. 	SetVariable(GapAvailableLoc, 		0)
18090. 	SetVariable(GapCurrentLoc, 			0)
18091. 	SetVariable(GapActualLoc,			0)
18092. 	SetVariable(GapUsedLoc,				0)
18093. 	
18094. 	# Space usage
18095. 	SetVariable(ZoneFreePerRequested, 	0)
18096. 	SetVariable(ZoneFreePerUsed, 		0)
18097. 
18098. # Gap Size & Rounding
18099. 	SetVariable(ZoneGapSizePer, 		0)
18100. 	SetVariable(ZoneVolRoundUpPer, 		0)
18101. 	
18102. 	# Free Space
18103. 	SetVariable(ZoneFreeUsedPer, 		0)
18104. 	SetVariable(ZoneFreeRequestedPer, 	0)
18105. 
18106. # Script: DisplaySetZone
18107. 
18108. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
18109. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
18110. 
18111. # Message ZoneSummary
18112. # SetVariable(ZoneSummary, '
18113. # Zone Summary:
18114. # ')
18115. # Zone processing steps
18116. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
18117. # ')
18118. 
18119. # # Script: BannerDescriptionSet
18120. 
18121. # Script: BannerSet
18122. 
18123. # NOTE: Can't round or truncate to integer precision. 
18124. # This internal fields like ZoneCount format really badly.
18125. #  for !RunTimeNow! does not work. None of the date functions do.
18126. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18127. 
18128. SetVariable(HeadingTemp2,	ZoneCount + 0)
18129. 
18130. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18131. 
18132. Title('!Heading!')
18133. 
18134. /* pause(1) */
18135. 
18136. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18137. 
18138. 
18139. # Script: BannerLog
18140. 
18141. AppendLogfile("!LogFileName!", "!Heading!")
18142. 
18143. 
18144. 
18145. # pause(1)
18146. 
18147. 
18148. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
18149. # Script: DisplaySetZoneStep
18150. # Increment
18151. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18152. 
18153. # Display this zone step
18154. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
18155. ')
18156. 
18157. # Script: BannerSet
18158. 
18159. # NOTE: Can't round or truncate to integer precision. 
18160. # This internal fields like ZoneCount format really badly.
18161. #  for !RunTimeNow! does not work. None of the date functions do.
18162. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18163. 
18164. SetVariable(HeadingTemp2,	ZoneCount + 0)
18165. 
18166. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18167. 
18168. Title('!Heading!')
18169. 
18170. /* pause(1) */
18171. 
18172. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18173. 
18174. 
18175. # Script: DisplaySetWindowText
18176. # Zone Footer Set Statistics Window Text
18177. 
18178. SetStatisticsWindowText("!Heading!
18179. ----------------------------------------------------------
18180. Zones Processed: 
18181. ----------------------------------------------------------
18182. !ZoneListByLine!
18183. ----------------------------------------------------------
18184. Zone Processing Step:
18185. !ZoneStepByLine!    
18186. ----------------------------------------------------------
18187. ----------------------------------------------------------
18188. CURRENT ZONE:
18189. !ZoneStatisticsReport!
18190. ----------------------------------------------------------
18191. ----------------------------------------------------------
18192. ----------------------------------------------------------
18193. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
18194. ----------------------------------------------------------
18195. !VolumeStatisticsSummary!
18196. !VolumeStatisticsDetail!
18197. ----------------------------------------------------------
18198. ----------------------------------------------------------
18199. Zone Detailed Report:
18200. ----------------------------------------------------------
18201. !ZoneStatisticsDetail!
18202. ----------------------------------------------------------
18203. ")
18204. 
18205. 
18206. 
18207. 
18208. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
18209. 
18210. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
18211. # Script: DisplaySetZoneStep
18212. # Increment
18213. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18214. 
18215. # Display this zone step
18216. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
18217. ')
18218. 
18219. # Script: BannerSet
18220. 
18221. # NOTE: Can't round or truncate to integer precision. 
18222. # This internal fields like ZoneCount format really badly.
18223. #  for !RunTimeNow! does not work. None of the date functions do.
18224. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18225. 
18226. SetVariable(HeadingTemp2,	ZoneCount + 0)
18227. 
18228. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18229. 
18230. Title('!Heading!')
18231. 
18232. /* pause(1) */
18233. 
18234. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18235. 
18236. 
18237. # Script: DisplaySetWindowText
18238. # Zone Footer Set Statistics Window Text
18239. 
18240. SetStatisticsWindowText("!Heading!
18241. ----------------------------------------------------------
18242. Zones Processed: 
18243. ----------------------------------------------------------
18244. !ZoneListByLine!
18245. ----------------------------------------------------------
18246. Zone Processing Step:
18247. !ZoneStepByLine!    
18248. ----------------------------------------------------------
18249. ----------------------------------------------------------
18250. CURRENT ZONE:
18251. !ZoneStatisticsReport!
18252. ----------------------------------------------------------
18253. ----------------------------------------------------------
18254. ----------------------------------------------------------
18255. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
18256. ----------------------------------------------------------
18257. !VolumeStatisticsSummary!
18258. !VolumeStatisticsDetail!
18259. ----------------------------------------------------------
18260. ----------------------------------------------------------
18261. Zone Detailed Report:
18262. ----------------------------------------------------------
18263. !ZoneStatisticsDetail!
18264. ----------------------------------------------------------
18265. ")
18266. 
18267. 
18268. 
18269. 
18270. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
18271. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
18272. 
18273. # Script: BannerSet
18274. 
18275. # NOTE: Can't round or truncate to integer precision. 
18276. # This internal fields like ZoneCount format really badly.
18277. #  for !RunTimeNow! does not work. None of the date functions do.
18278. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18279. 
18280. SetVariable(HeadingTemp2,	ZoneCount + 0)
18281. 
18282. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18283. 
18284. Title('!Heading!')
18285. 
18286. /* pause(1) */
18287. 
18288. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18289. 
18290. 
18291. # Script: BannerLog
18292. 
18293. AppendLogfile("!LogFileName!", "!Heading!")
18294. 
18295. 
18296. 
18297. # LOGGING:
18298. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
18299. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
18300. 
18301. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
18302. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:00")
18303. # 2021-12-14 15:30:00 
18304. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:05 !ZoneLabel! !ZoneDescription!")
18305. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
18306. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:05 !ZoneLabel! !ZoneDescription!")
18307. 
18308. 
18309. # Add zone to list of zones:
18310. SetVariable(ZoneListByLine, "!ZoneListByLine!
18311. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
18312. # Script: DisplaySetWindowText
18313. # Zone Footer Set Statistics Window Text
18314. 
18315. SetStatisticsWindowText("!Heading!
18316. ----------------------------------------------------------
18317. Zones Processed: 
18318. ----------------------------------------------------------
18319. !ZoneListByLine!
18320. ----------------------------------------------------------
18321. Zone Processing Step:
18322. !ZoneStepByLine!    
18323. ----------------------------------------------------------
18324. ----------------------------------------------------------
18325. CURRENT ZONE:
18326. !ZoneStatisticsReport!
18327. ----------------------------------------------------------
18328. ----------------------------------------------------------
18329. ----------------------------------------------------------
18330. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
18331. ----------------------------------------------------------
18332. !VolumeStatisticsSummary!
18333. !VolumeStatisticsDetail!
18334. ----------------------------------------------------------
18335. ----------------------------------------------------------
18336. Zone Detailed Report:
18337. ----------------------------------------------------------
18338. !ZoneStatisticsDetail!
18339. ----------------------------------------------------------
18340. ")
18341. 
18342. 
18343. 
18344. 
18345. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
18346. # Script: DisplaySetZoneStep
18347. # Increment
18348. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18349. 
18350. # Display this zone step
18351. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
18352. ')
18353. 
18354. # Script: BannerSet
18355. 
18356. # NOTE: Can't round or truncate to integer precision. 
18357. # This internal fields like ZoneCount format really badly.
18358. #  for !RunTimeNow! does not work. None of the date functions do.
18359. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18360. 
18361. SetVariable(HeadingTemp2,	ZoneCount + 0)
18362. 
18363. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18364. 
18365. Title('!Heading!')
18366. 
18367. /* pause(1) */
18368. 
18369. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18370. 
18371. 
18372. # Script: DisplaySetWindowText
18373. # Zone Footer Set Statistics Window Text
18374. 
18375. SetStatisticsWindowText("!Heading!
18376. ----------------------------------------------------------
18377. Zones Processed: 
18378. ----------------------------------------------------------
18379. !ZoneListByLine!
18380. ----------------------------------------------------------
18381. Zone Processing Step:
18382. !ZoneStepByLine!    
18383. ----------------------------------------------------------
18384. ----------------------------------------------------------
18385. CURRENT ZONE:
18386. !ZoneStatisticsReport!
18387. ----------------------------------------------------------
18388. ----------------------------------------------------------
18389. ----------------------------------------------------------
18390. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
18391. ----------------------------------------------------------
18392. !VolumeStatisticsSummary!
18393. !VolumeStatisticsDetail!
18394. ----------------------------------------------------------
18395. ----------------------------------------------------------
18396. Zone Detailed Report:
18397. ----------------------------------------------------------
18398. !ZoneStatisticsDetail!
18399. ----------------------------------------------------------
18400. ")
18401. 
18402. 
18403. 
18404. 
18405. # your stuff HERE (X)... pre file select code.
18406. 
18407. /* --------------------------------- */
18408. 	FileSelect
18409. 
18410. 		# your stuff can't really go here (errors.)
18411. 		# maybe for some reason I don't know of...
18412. 	
18413. 		# Actions next...
18414. 	# Script: ZoneDo ZoneTypeSelectOsDIR
18415. # DIR start.
18416. Directory(yes)
18417. # DIR end.
18418. 
18419. 
18420. 	FileActions
18421. 
18422. 			# Script: GapZoneCalc
18423. 	# Gap
18424. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
18425. 		# Script: DisplaySetZoneStep
18426. # Increment
18427. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18428. 
18429. # Display this zone step
18430. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
18431. ')
18432. 
18433. # Script: BannerSet
18434. 
18435. # NOTE: Can't round or truncate to integer precision. 
18436. # This internal fields like ZoneCount format really badly.
18437. #  for !RunTimeNow! does not work. None of the date functions do.
18438. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18439. 
18440. SetVariable(HeadingTemp2,	ZoneCount + 0)
18441. 
18442. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18443. 
18444. Title('!Heading!')
18445. 
18446. /* pause(1) */
18447. 
18448. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18449. 
18450. 
18451. # Script: DisplaySetWindowText
18452. # Zone Footer Set Statistics Window Text
18453. 
18454. SetStatisticsWindowText("!Heading!
18455. ----------------------------------------------------------
18456. Zones Processed: 
18457. ----------------------------------------------------------
18458. !ZoneListByLine!
18459. ----------------------------------------------------------
18460. Zone Processing Step:
18461. !ZoneStepByLine!    
18462. ----------------------------------------------------------
18463. ----------------------------------------------------------
18464. CURRENT ZONE:
18465. !ZoneStatisticsReport!
18466. ----------------------------------------------------------
18467. ----------------------------------------------------------
18468. ----------------------------------------------------------
18469. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
18470. ----------------------------------------------------------
18471. !VolumeStatisticsSummary!
18472. !VolumeStatisticsDetail!
18473. ----------------------------------------------------------
18474. ----------------------------------------------------------
18475. Zone Detailed Report:
18476. ----------------------------------------------------------
18477. !ZoneStatisticsDetail!
18478. ----------------------------------------------------------
18479. ")
18480. 
18481. 
18482. 
18483. 	
18484. 	# ACTUAL GAP
18485. 		/* AddGap Variant. */
18486. 	  	# Script: GapZoneSet
18487. # Zone Do Gap
18488. # Gap Calculation Methods:
18489. 
18490. /* 1) Anything you need to add first. */
18491. /* empty */
18492. 
18493. /* ------------------------- */
18494. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
18495. 	# GapRequestedStd.
18496. 
18497. 		/* ------------------------- */
18498. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
18499. 
18500. 		# Gap Calculation Methods:
18501. 
18502. /* AddGap Variants */
18503. 
18504. 	/* Standard */
18505. 		# Gap Calculation Methods:
18506. 	/* AddGap Variants */
18507. 	/* Standard */
18508. 
18509. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
18510. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
18511. 
18512. 	SetVariable(GapRequested, GapRequestedStd)
18513. 	
18514. 
18515. 	/* MFT Low High Method */
18516. 		# Gap Calculation Methods:
18517. 	/* AddGap Variants */
18518. 	/* MFT Low High Method */
18519. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
18520. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
18521. 	SetVariable(GapRequested, GapRequestedMft)
18522. 	
18523. 
18524. 	/* OS Volume Type Method */
18525. 		# Gap Calculation Methods:
18526. 	/* AddGap Variants */
18527. 	/* OS Volume Type Method */
18528. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
18529. 	SetVariable(GapRequested, GapRequestedOs)
18530. 
18531. 
18532. 
18533. /* MakeGap Variants */
18534. 
18535. 	/* Original Os 1-3 + MFT 2 */
18536. 		# Gap Calculation Methods:
18537. 	/* MakeGap Variants */
18538. 	/* Original Os 1-3 + MFT 2 */
18539. 	/* plus MFT gap placed inline at the dividing zone. */
18540. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
18541. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
18542. 	SetVariable(GapRequested, GapRequestedOrig)
18543. 	
18544. 	
18545. /* Note: You could comment out the ones not in use */
18546. /* However having the data in the log is useful. */
18547. /* Therefore the following line is otherwise needed. */
18548. 
18549. /* Standard used */
18550. 
18551. SetVariable(GapRequested, GapRequestedStd)
18552. 
18553. # Gap Calculation Methods:
18554. 
18555. /* AddGap Variants */
18556. 	/* Standard */
18557. 	/* MFT Low High Method */
18558. 	/* OS Volume Type Method */
18559. 
18560. /* MakeGap Variants */
18561. 	/* Original Os 1-3 + MFT 2 */
18562. 
18563. /* Note: You could comment out the ones not in use */
18564. /* However having the data in the log is useful. */
18565. /* Therefore the following line is otherwise needed. */
18566. 
18567. /* Standard is used currently */
18568. 
18569. 
18570. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
18571. 
18572. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
18573. 
18574. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
18575. 
18576. /* ------------------------- */
18577. /* 3) SMALL ZONE ADJUSTMENT. */
18578. /* Gab cant be larger than half the Zone Size. */
18579. 
18580. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
18581. 	
18582. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
18583. 
18584. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
18585. 
18586. /* ------------------------- */
18587. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
18588. # Gap Adjustments.
18589. 
18590. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
18591. 	
18592. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
18593. 
18594. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
18595. 
18596. /* ------------------------- */
18597. # BYPASS THIS.
18598. 	/* This is definitely wrong. */
18599. 	/* The question is can we steal gap from the next zone */
18600. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
18601. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
18602. 		# Zone Overflow.
18603. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
18604. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
18605. 
18606. /* ------------------------- */
18607. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
18608. # Remaining free space available.
18609. 
18610. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
18611. 	
18612. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
18613. 
18614. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
18615. 
18616. /* ------------------------- */
18617. # CURRENT gap to use.
18618. 
18619. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
18620. 
18621. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
18622. 
18623. /* ------------------------- */
18624. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
18625. # Debugging.
18626. 
18627. 	SetVariable(GapUsed, GapCurrent) // for debugging
18628. 
18629. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
18630. 
18631. 		# Your code HERE
18632. 
18633. /* ------------------------- */
18634. /* 7) YOUR CODE. */
18635. # YOUR CODE HERE:
18636. 	# INPUT: GapCurrent or GapCurrentLoc
18637. 	# OUTPUT: GapUsed...
18638. 
18639. /* ------------------------- */
18640. # Gap Size.
18641. # Actual Size of Gap.
18642. 
18643. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
18644. 
18645. /* ------------------------- */
18646. 
18647. 	
18648. 	# Zone Statistics	
18649. 		# Script: ZoneStatisticsGet
18650. # Zone / Volume Statistics and Display
18651. 		
18652. 	# Accumulate Totals
18653.   	# Script: ZoneDoVolumeTotals
18654. 
18655. /* Current total space used (by Zones and Gaps) */
18656. 
18657. SetVariable(VolumeZoneUsed, GapUsed)
18658. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
18659. /* Percentage */
18660. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
18661. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
18662. 
18663. /* Current total of free space requested */
18664. 
18665. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
18666. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18667. /* Percent. */
18668. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
18669. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18670. 
18671. /* Current total of free space used */
18672. 
18673. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
18674. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
18675. /* Percent */
18676. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
18677. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
18678. 
18679. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
18680. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
18681. # Xinclude "..\DebugDisplayPause.MyDc"X
18682. 
18683. 
18684. 	# Current Values
18685. 	# Script: ZoneDoCurrentSet
18686. 
18687. # Cluster, Sector, Block adjust for display.
18688. 	# Bytes per cluster is volume specific.
18689. 
18690. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
18691. 
18692. # Current Zone values.
18693. 	# Begin, end and size.
18694. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
18695. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
18696. 
18697. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
18698. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
18699. 
18700. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
18701. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
18702. 
18703. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
18704. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
18705. 
18706. 	SetVariable(ZoneFragments,				"!ZONE210N!")
18707. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
18708. 		
18709. # Current Gap, Actual and Free Values
18710. 	# Gap
18711. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
18712. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
18713. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
18714. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
18715. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
18716. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
18717. 	
18718. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
18719. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
18720. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
18721. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
18722. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
18723. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
18724. 	
18725. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
18726. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
18727. 	
18728. 	# Actual Size and End
18729. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
18730. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
18731. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
18732. 	
18733. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
18734. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
18735. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
18736. 
18737. # Gap Size & Rounding
18738. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
18739. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
18740. 	
18741. 	# Free Space
18742. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
18743. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
18744. 
18745. 	# Script: ZoneStatisticsReportGet
18746. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
18747. 
18748. # Footer:
18749. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
18750. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
18751. #
18752. # Xinclude "..\Commands\DateTimeLastLong.txt"X
18753. #
18754. # What a mess this word based vs is. Try a phrase based version ToDo
18755. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
18756. ------------------
18757.    !SizeWord!!ColonWord!  
18758.    ------------------------
18759.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18760.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18761.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18762. 
18763.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18764.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
18765. 
18766.    !LocationWord!!ColonWord!
18767.    ------------------------
18768.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18769.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
18770.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18771.       
18772.    !GapWordCaps! !SettingsWord!!ColonWord!
18773.    ------------------------
18774.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
18775.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
18776.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18777.                  
18778.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
18779.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
18780.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
18781.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
18782.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
18783.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
18784.      
18785.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
18786.    ------------------------
18787.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18788.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18789.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18790. 
18791. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
18792. ----------------------------------------------------------
18793. ")
18794. #
18795. SetVariable(DateNow, 	DATETIME)
18796. SetVariable(TimeNow, 	Time)
18797. SetVariable(RunTimeNow, 	RunTime)
18798. 
18799. 
18800. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
18801. 
18802. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
18803. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
18804. 
18805. 	# Script: DisplaySetWindowText
18806. # Zone Footer Set Statistics Window Text
18807. 
18808. SetStatisticsWindowText("!Heading!
18809. ----------------------------------------------------------
18810. Zones Processed: 
18811. ----------------------------------------------------------
18812. !ZoneListByLine!
18813. ----------------------------------------------------------
18814. Zone Processing Step:
18815. !ZoneStepByLine!    
18816. ----------------------------------------------------------
18817. ----------------------------------------------------------
18818. CURRENT ZONE:
18819. !ZoneStatisticsReport!
18820. ----------------------------------------------------------
18821. ----------------------------------------------------------
18822. ----------------------------------------------------------
18823. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
18824. ----------------------------------------------------------
18825. !VolumeStatisticsSummary!
18826. !VolumeStatisticsDetail!
18827. ----------------------------------------------------------
18828. ----------------------------------------------------------
18829. Zone Detailed Report:
18830. ----------------------------------------------------------
18831. !ZoneStatisticsDetail!
18832. ----------------------------------------------------------
18833. ")
18834. 
18835. 
18836. 	
18837. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
18838. 
18839. 
18840. 	SetVariable(ZoneStatisticsData, 
18841. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
18842.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
18843.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
18844. 
18845. 
18846. 
18847.  		# Script: ZoneStatisticsDisplay
18848. 	
18849. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
18850. !ZoneStatisticsData!
18851. ')
18852. 
18853. 		# Script: ZoneStatisticsAdd
18854. # Append Zone to Details of each zone.
18855. 		
18856. 	# Add Zone Details to Report.	
18857. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
18858. !ZoneStatisticsReport!
18859. ')
18860. 
18861. 
18862. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
18863. 		# Script: DisplaySetZoneStep
18864. # Increment
18865. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18866. 
18867. # Display this zone step
18868. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
18869. ')
18870. 
18871. # Script: BannerSet
18872. 
18873. # NOTE: Can't round or truncate to integer precision. 
18874. # This internal fields like ZoneCount format really badly.
18875. #  for !RunTimeNow! does not work. None of the date functions do.
18876. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18877. 
18878. SetVariable(HeadingTemp2,	ZoneCount + 0)
18879. 
18880. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18881. 
18882. Title('!Heading!')
18883. 
18884. /* pause(1) */
18885. 
18886. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18887. 
18888. 
18889. # Script: DisplaySetWindowText
18890. # Zone Footer Set Statistics Window Text
18891. 
18892. SetStatisticsWindowText("!Heading!
18893. ----------------------------------------------------------
18894. Zones Processed: 
18895. ----------------------------------------------------------
18896. !ZoneListByLine!
18897. ----------------------------------------------------------
18898. Zone Processing Step:
18899. !ZoneStepByLine!    
18900. ----------------------------------------------------------
18901. ----------------------------------------------------------
18902. CURRENT ZONE:
18903. !ZoneStatisticsReport!
18904. ----------------------------------------------------------
18905. ----------------------------------------------------------
18906. ----------------------------------------------------------
18907. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
18908. ----------------------------------------------------------
18909. !VolumeStatisticsSummary!
18910. !VolumeStatisticsDetail!
18911. ----------------------------------------------------------
18912. ----------------------------------------------------------
18913. Zone Detailed Report:
18914. ----------------------------------------------------------
18915. !ZoneStatisticsDetail!
18916. ----------------------------------------------------------
18917. ")
18918. 
18919. 
18920. 
18921. 
18922. 		# File Action - Type Os Dir - Regular -  SortByName.
18923. # File Action - ZoneDoActionSortByCreationDateFull
18924. 	SortByCreationDate(Ascending)
18925. 	
18926. 
18927. 
18928. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
18929. 		# Script: DisplaySetZoneStep
18930. # Increment
18931. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18932. 
18933. # Display this zone step
18934. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
18935. ')
18936. 
18937. # Script: BannerSet
18938. 
18939. # NOTE: Can't round or truncate to integer precision. 
18940. # This internal fields like ZoneCount format really badly.
18941. #  for !RunTimeNow! does not work. None of the date functions do.
18942. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18943. 
18944. SetVariable(HeadingTemp2,	ZoneCount + 0)
18945. 
18946. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18947. 
18948. Title('!Heading!')
18949. 
18950. /* pause(1) */
18951. 
18952. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
18953. 
18954. 
18955. # Script: DisplaySetWindowText
18956. # Zone Footer Set Statistics Window Text
18957. 
18958. SetStatisticsWindowText("!Heading!
18959. ----------------------------------------------------------
18960. Zones Processed: 
18961. ----------------------------------------------------------
18962. !ZoneListByLine!
18963. ----------------------------------------------------------
18964. Zone Processing Step:
18965. !ZoneStepByLine!    
18966. ----------------------------------------------------------
18967. ----------------------------------------------------------
18968. CURRENT ZONE:
18969. !ZoneStatisticsReport!
18970. ----------------------------------------------------------
18971. ----------------------------------------------------------
18972. ----------------------------------------------------------
18973. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
18974. ----------------------------------------------------------
18975. !VolumeStatisticsSummary!
18976. !VolumeStatisticsDetail!
18977. ----------------------------------------------------------
18978. ----------------------------------------------------------
18979. Zone Detailed Report:
18980. ----------------------------------------------------------
18981. !ZoneStatisticsDetail!
18982. ----------------------------------------------------------
18983. ")
18984. 
18985. 
18986. 
18987. 	# Script: ZoneDoFooter
18988. 
18989. /* --------------------------------- */
18990. 	# File Select
18991. 		# Select Statments
18992. 	# File Actions 
18993. 		# Standard or OS File Actions.
18994. 		# Resume...
18995. 	
18996. 		# your stuff HERE (X)... post zone (file) file actions code.
18997. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
18998. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
18999. 			# (X)
19000. 		
19001. 			/* ??? Set window? */
19002. 	
19003. 		# ADD THE GAP
19004. 		# Script: GapZoneCommand
19005. # Vacate (good for diagnostics)
19006. # DoNotVacate - DO NOT Vacate (recommended)
19007. 
19008. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
19009. # Script: DisplaySetZoneStep
19010. # Increment
19011. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19012. 
19013. # Display this zone step
19014. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
19015. ')
19016. 
19017. # Script: BannerSet
19018. 
19019. # NOTE: Can't round or truncate to integer precision. 
19020. # This internal fields like ZoneCount format really badly.
19021. #  for !RunTimeNow! does not work. None of the date functions do.
19022. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19023. 
19024. SetVariable(HeadingTemp2,	ZoneCount + 0)
19025. 
19026. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19027. 
19028. Title('!Heading!')
19029. 
19030. /* pause(1) */
19031. 
19032. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19033. 
19034. 
19035. # Script: DisplaySetWindowText
19036. # Zone Footer Set Statistics Window Text
19037. 
19038. SetStatisticsWindowText("!Heading!
19039. ----------------------------------------------------------
19040. Zones Processed: 
19041. ----------------------------------------------------------
19042. !ZoneListByLine!
19043. ----------------------------------------------------------
19044. Zone Processing Step:
19045. !ZoneStepByLine!    
19046. ----------------------------------------------------------
19047. ----------------------------------------------------------
19048. CURRENT ZONE:
19049. !ZoneStatisticsReport!
19050. ----------------------------------------------------------
19051. ----------------------------------------------------------
19052. ----------------------------------------------------------
19053. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
19054. ----------------------------------------------------------
19055. !VolumeStatisticsSummary!
19056. !VolumeStatisticsDetail!
19057. ----------------------------------------------------------
19058. ----------------------------------------------------------
19059. Zone Detailed Report:
19060. ----------------------------------------------------------
19061. !ZoneStatisticsDetail!
19062. ----------------------------------------------------------
19063. ")
19064. 
19065. 
19066. 
19067. 
19068. # *** Moved to setting yours *** 
19069. # (to avoid doing it twice)
19070. # (ie the later wouldn't "overwrite" the former in the usual manner)
19071. 
19072. # Do one or the other:
19073. # DoNotVacate - DO NOT Vacate (recommended)
19074. 
19075. # Vacate
19076. /* AddGap(GapUsedLoc) */
19077. 
19078. # DO Not Vacate
19079. AddGap(GapUsedLoc, DoNotVacate) 
19080. 	
19081. 	
19082. 
19083. # Controlled via settings commands
19084. 
19085. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
19086. 
19087. # Vacate /* AddGap(GapUsed) */
19088. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
19089. 	
19090. 
19091. 		
19092. 	# 
19093. 	FileEnd
19094. /* --------------------------------- */
19095. # your stuff HERE (X)... post zone (file) code.
19096. 
19097. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
19098. # Script: DisplaySetZoneStep
19099. # Increment
19100. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19101. 
19102. # Display this zone step
19103. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
19104. ')
19105. 
19106. # Script: BannerSet
19107. 
19108. # NOTE: Can't round or truncate to integer precision. 
19109. # This internal fields like ZoneCount format really badly.
19110. #  for !RunTimeNow! does not work. None of the date functions do.
19111. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19112. 
19113. SetVariable(HeadingTemp2,	ZoneCount + 0)
19114. 
19115. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19116. 
19117. Title('!Heading!')
19118. 
19119. /* pause(1) */
19120. 
19121. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19122. 
19123. 
19124. # Script: DisplaySetWindowText
19125. # Zone Footer Set Statistics Window Text
19126. 
19127. SetStatisticsWindowText("!Heading!
19128. ----------------------------------------------------------
19129. Zones Processed: 
19130. ----------------------------------------------------------
19131. !ZoneListByLine!
19132. ----------------------------------------------------------
19133. Zone Processing Step:
19134. !ZoneStepByLine!    
19135. ----------------------------------------------------------
19136. ----------------------------------------------------------
19137. CURRENT ZONE:
19138. !ZoneStatisticsReport!
19139. ----------------------------------------------------------
19140. ----------------------------------------------------------
19141. ----------------------------------------------------------
19142. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
19143. ----------------------------------------------------------
19144. !VolumeStatisticsSummary!
19145. !VolumeStatisticsDetail!
19146. ----------------------------------------------------------
19147. ----------------------------------------------------------
19148. Zone Detailed Report:
19149. ----------------------------------------------------------
19150. !ZoneStatisticsDetail!
19151. ----------------------------------------------------------
19152. ")
19153. 
19154. 
19155. 
19156. 
19157. # Script: ZoneWhenFinished
19158. 
19159. # Add the zone to the zone details log:
19160. # This is temporarily disable until logging is fixed
19161. # It is performed during file action to preserve the correct (original) calculations.
19162. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
19163. 
19164. # Add the Select and ZoneSteps to the Zone
19165. # Script: ZoneStatisticsAdd
19166. # Append Zone to Details of each zone.
19167. 		
19168. 	# Add Zone Details to Report.	
19169. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
19170. ----------------------------------------------------------
19171. !ZoneStepByLine!
19172. ---------------------------
19173. !ZoneTypeSelectCurrent!               
19174. ---------------------------
19175. ----------------------------------------------------------
19176. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
19177. ----------------------------------------------------------
19178. ')
19179. 
19180. 
19181. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
19182. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
19183. # 2021-12-14 15:30:01
19184. RunProgram("..\Commands\WriteDateTime.bat LastZone")
19185. # Append Datetime to logs
19186. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
19187. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
19188. 
19189. AppendLogfile("!LogFileName!", "!PeriodWord!")
19190. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
19191. AppendLogfile("!LogFileName!", "!PeriodWord!")
19192. 
19193. # Script: DisplaySetWindowText
19194. # Zone Footer Set Statistics Window Text
19195. 
19196. SetStatisticsWindowText("!Heading!
19197. ----------------------------------------------------------
19198. Zones Processed: 
19199. ----------------------------------------------------------
19200. !ZoneListByLine!
19201. ----------------------------------------------------------
19202. Zone Processing Step:
19203. !ZoneStepByLine!    
19204. ----------------------------------------------------------
19205. ----------------------------------------------------------
19206. CURRENT ZONE:
19207. !ZoneStatisticsReport!
19208. ----------------------------------------------------------
19209. ----------------------------------------------------------
19210. ----------------------------------------------------------
19211. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
19212. ----------------------------------------------------------
19213. !VolumeStatisticsSummary!
19214. !VolumeStatisticsDetail!
19215. ----------------------------------------------------------
19216. ----------------------------------------------------------
19217. Zone Detailed Report:
19218. ----------------------------------------------------------
19219. !ZoneStatisticsDetail!
19220. ----------------------------------------------------------
19221. ")
19222. 
19223. 
19224. 
19225. /* pause() */
19226. /* pause() */
19227. 
19228. 
19229. 
19230. /* ------------------------- */
19231. 
19232. 
19233. /* Mft Method: MFT GAP HERE. */
19234. /* For fixed zone locations */
19235. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! 
19236. Location: !MftLocation! 
19237.  Mft Gap: !MftGapSize!
19238.  ")
19239. /* MakeGap(MftGap, DoNotVacate) */
19240. /* ------------------------- */
19241. 
19242. 
19243. /* ------------------------- */
19244. /* Mft Method: MFT GAP HERE. */
19245. /* For fixed zone locations */
19246. WriteLogfile("!LogFileName! Volume !VolumenName! MftReport", "!MftReport!
19247. Mft Zone: !MftZone! 
19248. Location: !MftLocation! 
19249.   MftGap: !MftGapSize! !DateNow! !TimeNow! !RunTimeNow!
19250. ")
19251. /* MakeGap(MftGap, DoNotVacate) */
19252.   
19253. /* ------------------------- */
19254. # PageHiberDump
19255. 
19256. # You cannot move Pagefile or Hiberfil generally speaking.
19257. # This might work in safe mode with preparation.
19258. # Zone PageHiberDump.
19259. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
19260. 
19261. # Script: DefragZoneTypeOsPageHiberDump
19262. /* ------------------------- */
19263. # PageHiberDump
19264. # You cannot move Pagefile or Hiberfil generally speaking.
19265. # This might work in safe mode with preparation.
19266. # Zone PageHiberDump.
19267. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
19268. 
19269. 	SetVariable(ZoneLabel, 			"!ZoneLabelPageHiberDump!")
19270. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPageHiberDump!")
19271. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPageHiberDump!")
19272. 	SetVariable(ZoneGapSize, 			"!ZoneGapSizePageHiberDump!")
19273. 
19274. 	SetVariable(ZoneTypeSelect,	'
19275. Program Page, Hiber and Dump files:
19276. # Script: ZoneDo ZoneTypeSelectOsPageHiberDump
19277. # PageHiberDump start.
19278. (
19279. # Os PageHiberDump start.
19280. (
19281.   FileName("DataStore.edb")
19282.   or FileName("DUMP*.*")
19283.   or FileName("Hiberfil.sys")
19284.   or FileName("MEMORY.DMP")
19285.   or FileName("Pagefile.sys")
19286. )
19287. # Os PageHiberDump end.
19288. 
19289. )
19290. # PageHiberDump end.
19291. 
19292. ')
19293. 
19294. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
19295. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
19296. 
19297. SetVariable(ZoneStepNoCurrent, 0)
19298. 
19299. 	/* ------------------------- */
19300. # Script: ZoneDoHeader
19301. 
19302. # Script: ZoneWhenStarted
19303. RunProgram("..\Commands\WriteDateTime.bat")
19304. 
19305. # Script: ZoneDoCurrentClear
19306. 
19307. SetVariable(ZoneTypeSelectCurrent, 		"")
19308. SetVariable(ZoneStatisticsData, 		"")
19309. SetVariable(ZoneStepByLine, 			"")
19310. 
19311. SetVariable(ZoneBeginCurrent, 			0)
19312. SetVariable(ZoneBeginPerCurrent, 		0)
19313. SetVariable(ZoneEndCurrent, 			0)
19314. SetVariable(ZoneEndPerCurrent, 			0)
19315. 
19316. SetVariable(ZoneSizeCurrent,			0)
19317. SetVariable(ZoneSizePerCurrent,			0)
19318. 
19319. SetVariable(ZoneGapRequestedCurrent,	0)
19320. SetVariable(ZoneGapRoundedCurrent, 		0)
19321. SetVariable(ZoneGapAdjustedCurrent, 	0)
19322. SetVariable(ZoneGapAvailableCurrent, 	0)
19323. SetVariable(ZoneGapCurrent,				0)
19324. SetVariable(ZoneGapUsedCurrent, 		0)
19325. 
19326. SetVariable(ZoneGapActualCurrent, 		0)
19327. SetVariable(ZoneGapActualPerCurrent, 	0)
19328. 
19329. SetVariable(ZoneSizeActual, 			0)
19330. SetVariable(ZoneSizeActualCurrent,		0)
19331. 
19332. SetVariable(ZoneEndActual, 				0)
19333. SetVariable(ZoneEndActualCurrent,		0)			
19334. SetVariable(ZoneSizeActualPerCurrent, 	0)
19335.       
19336. SetVariable(ZoneFilesFolders,			0)
19337. SetVariable(ZoneFilesFoldersPer,		0) 
19338. 
19339. SetVariable(ZoneFragments,				0)
19340. SetVariable(ZoneFragmentsPer,			0) 
19341. 		
19342. SetVariable(ZoneEndActualCurrent, 		0)
19343. SetVariable(ZoneEndActualPerCurrent, 	0)
19344. 
19345. # Gap Calculation Methodology:
19346. 	# Requested
19347. 	SetVariable(GapRequested, 			0) 
19348. 	SetVariable(GapRequestedStd, 		0) 
19349. 	SetVariable(GapRequestedMft, 		0) 
19350. 	SetVariable(GapRequestedOs, 		0) 
19351. 	SetVariable(GapRequestedOriginal, 	0) 
19352. 	
19353. 	# Gap Adjustments
19354. 	SetVariable(GapRounded, 			0)
19355. 	# SetVariable(GapAdjusted, 			0)
19356. 	SetVariable(GapAvailable, 			0)
19357. 	SetVariable(GapCurrent, 			0)
19358. 	SetVariable(GapActual, 				0)
19359. 	SetVariable(GapUsed, 				0)
19360. 	
19361. 	# Gap Adjustments
19362. 	SetVariable(GapRoundedLoc, 			0)
19363. 	# SetVariable(GapAdjustedLoc, 		0)
19364. 	SetVariable(GapAvailableLoc, 		0)
19365. 	SetVariable(GapCurrentLoc, 			0)
19366. 	SetVariable(GapActualLoc,			0)
19367. 	SetVariable(GapUsedLoc,				0)
19368. 	
19369. 	# Space usage
19370. 	SetVariable(ZoneFreePerRequested, 	0)
19371. 	SetVariable(ZoneFreePerUsed, 		0)
19372. 
19373. # Gap Size & Rounding
19374. 	SetVariable(ZoneGapSizePer, 		0)
19375. 	SetVariable(ZoneVolRoundUpPer, 		0)
19376. 	
19377. 	# Free Space
19378. 	SetVariable(ZoneFreeUsedPer, 		0)
19379. 	SetVariable(ZoneFreeRequestedPer, 	0)
19380. 
19381. # Script: DisplaySetZone
19382. 
19383. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
19384. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
19385. 
19386. # Message ZoneSummary
19387. # SetVariable(ZoneSummary, '
19388. # Zone Summary:
19389. # ')
19390. # Zone processing steps
19391. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
19392. # ')
19393. 
19394. # # Script: BannerDescriptionSet
19395. 
19396. # Script: BannerSet
19397. 
19398. # NOTE: Can't round or truncate to integer precision. 
19399. # This internal fields like ZoneCount format really badly.
19400. #  for !RunTimeNow! does not work. None of the date functions do.
19401. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19402. 
19403. SetVariable(HeadingTemp2,	ZoneCount + 0)
19404. 
19405. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19406. 
19407. Title('!Heading!')
19408. 
19409. /* pause(1) */
19410. 
19411. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19412. 
19413. 
19414. # Script: BannerLog
19415. 
19416. AppendLogfile("!LogFileName!", "!Heading!")
19417. 
19418. 
19419. 
19420. # pause(1)
19421. 
19422. 
19423. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
19424. # Script: DisplaySetZoneStep
19425. # Increment
19426. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19427. 
19428. # Display this zone step
19429. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
19430. ')
19431. 
19432. # Script: BannerSet
19433. 
19434. # NOTE: Can't round or truncate to integer precision. 
19435. # This internal fields like ZoneCount format really badly.
19436. #  for !RunTimeNow! does not work. None of the date functions do.
19437. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19438. 
19439. SetVariable(HeadingTemp2,	ZoneCount + 0)
19440. 
19441. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19442. 
19443. Title('!Heading!')
19444. 
19445. /* pause(1) */
19446. 
19447. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19448. 
19449. 
19450. # Script: DisplaySetWindowText
19451. # Zone Footer Set Statistics Window Text
19452. 
19453. SetStatisticsWindowText("!Heading!
19454. ----------------------------------------------------------
19455. Zones Processed: 
19456. ----------------------------------------------------------
19457. !ZoneListByLine!
19458. ----------------------------------------------------------
19459. Zone Processing Step:
19460. !ZoneStepByLine!    
19461. ----------------------------------------------------------
19462. ----------------------------------------------------------
19463. CURRENT ZONE:
19464. !ZoneStatisticsReport!
19465. ----------------------------------------------------------
19466. ----------------------------------------------------------
19467. ----------------------------------------------------------
19468. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
19469. ----------------------------------------------------------
19470. !VolumeStatisticsSummary!
19471. !VolumeStatisticsDetail!
19472. ----------------------------------------------------------
19473. ----------------------------------------------------------
19474. Zone Detailed Report:
19475. ----------------------------------------------------------
19476. !ZoneStatisticsDetail!
19477. ----------------------------------------------------------
19478. ")
19479. 
19480. 
19481. 
19482. 
19483. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
19484. 
19485. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
19486. # Script: DisplaySetZoneStep
19487. # Increment
19488. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19489. 
19490. # Display this zone step
19491. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
19492. ')
19493. 
19494. # Script: BannerSet
19495. 
19496. # NOTE: Can't round or truncate to integer precision. 
19497. # This internal fields like ZoneCount format really badly.
19498. #  for !RunTimeNow! does not work. None of the date functions do.
19499. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19500. 
19501. SetVariable(HeadingTemp2,	ZoneCount + 0)
19502. 
19503. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19504. 
19505. Title('!Heading!')
19506. 
19507. /* pause(1) */
19508. 
19509. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19510. 
19511. 
19512. # Script: DisplaySetWindowText
19513. # Zone Footer Set Statistics Window Text
19514. 
19515. SetStatisticsWindowText("!Heading!
19516. ----------------------------------------------------------
19517. Zones Processed: 
19518. ----------------------------------------------------------
19519. !ZoneListByLine!
19520. ----------------------------------------------------------
19521. Zone Processing Step:
19522. !ZoneStepByLine!    
19523. ----------------------------------------------------------
19524. ----------------------------------------------------------
19525. CURRENT ZONE:
19526. !ZoneStatisticsReport!
19527. ----------------------------------------------------------
19528. ----------------------------------------------------------
19529. ----------------------------------------------------------
19530. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
19531. ----------------------------------------------------------
19532. !VolumeStatisticsSummary!
19533. !VolumeStatisticsDetail!
19534. ----------------------------------------------------------
19535. ----------------------------------------------------------
19536. Zone Detailed Report:
19537. ----------------------------------------------------------
19538. !ZoneStatisticsDetail!
19539. ----------------------------------------------------------
19540. ")
19541. 
19542. 
19543. 
19544. 
19545. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
19546. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
19547. 
19548. # Script: BannerSet
19549. 
19550. # NOTE: Can't round or truncate to integer precision. 
19551. # This internal fields like ZoneCount format really badly.
19552. #  for !RunTimeNow! does not work. None of the date functions do.
19553. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19554. 
19555. SetVariable(HeadingTemp2,	ZoneCount + 0)
19556. 
19557. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19558. 
19559. Title('!Heading!')
19560. 
19561. /* pause(1) */
19562. 
19563. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19564. 
19565. 
19566. # Script: BannerLog
19567. 
19568. AppendLogfile("!LogFileName!", "!Heading!")
19569. 
19570. 
19571. 
19572. # LOGGING:
19573. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
19574. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
19575. 
19576. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
19577. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:01")
19578. # 2021-12-14 15:30:01 
19579. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:06 !ZoneLabel! !ZoneDescription!")
19580. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
19581. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:06 !ZoneLabel! !ZoneDescription!")
19582. 
19583. 
19584. # Add zone to list of zones:
19585. SetVariable(ZoneListByLine, "!ZoneListByLine!
19586. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
19587. # Script: DisplaySetWindowText
19588. # Zone Footer Set Statistics Window Text
19589. 
19590. SetStatisticsWindowText("!Heading!
19591. ----------------------------------------------------------
19592. Zones Processed: 
19593. ----------------------------------------------------------
19594. !ZoneListByLine!
19595. ----------------------------------------------------------
19596. Zone Processing Step:
19597. !ZoneStepByLine!    
19598. ----------------------------------------------------------
19599. ----------------------------------------------------------
19600. CURRENT ZONE:
19601. !ZoneStatisticsReport!
19602. ----------------------------------------------------------
19603. ----------------------------------------------------------
19604. ----------------------------------------------------------
19605. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
19606. ----------------------------------------------------------
19607. !VolumeStatisticsSummary!
19608. !VolumeStatisticsDetail!
19609. ----------------------------------------------------------
19610. ----------------------------------------------------------
19611. Zone Detailed Report:
19612. ----------------------------------------------------------
19613. !ZoneStatisticsDetail!
19614. ----------------------------------------------------------
19615. ")
19616. 
19617. 
19618. 
19619. 
19620. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
19621. # Script: DisplaySetZoneStep
19622. # Increment
19623. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19624. 
19625. # Display this zone step
19626. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
19627. ')
19628. 
19629. # Script: BannerSet
19630. 
19631. # NOTE: Can't round or truncate to integer precision. 
19632. # This internal fields like ZoneCount format really badly.
19633. #  for !RunTimeNow! does not work. None of the date functions do.
19634. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19635. 
19636. SetVariable(HeadingTemp2,	ZoneCount + 0)
19637. 
19638. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19639. 
19640. Title('!Heading!')
19641. 
19642. /* pause(1) */
19643. 
19644. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19645. 
19646. 
19647. # Script: DisplaySetWindowText
19648. # Zone Footer Set Statistics Window Text
19649. 
19650. SetStatisticsWindowText("!Heading!
19651. ----------------------------------------------------------
19652. Zones Processed: 
19653. ----------------------------------------------------------
19654. !ZoneListByLine!
19655. ----------------------------------------------------------
19656. Zone Processing Step:
19657. !ZoneStepByLine!    
19658. ----------------------------------------------------------
19659. ----------------------------------------------------------
19660. CURRENT ZONE:
19661. !ZoneStatisticsReport!
19662. ----------------------------------------------------------
19663. ----------------------------------------------------------
19664. ----------------------------------------------------------
19665. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
19666. ----------------------------------------------------------
19667. !VolumeStatisticsSummary!
19668. !VolumeStatisticsDetail!
19669. ----------------------------------------------------------
19670. ----------------------------------------------------------
19671. Zone Detailed Report:
19672. ----------------------------------------------------------
19673. !ZoneStatisticsDetail!
19674. ----------------------------------------------------------
19675. ")
19676. 
19677. 
19678. 
19679. 
19680. # your stuff HERE (X)... pre file select code.
19681. 
19682. /* --------------------------------- */
19683. 	FileSelect
19684. 
19685. 		# your stuff can't really go here (errors.)
19686. 		# maybe for some reason I don't know of...
19687. 	
19688. 		# Actions next...
19689. 	# Script: ZoneDo ZoneTypeSelectOsPageHiberDump
19690. # PageHiberDump start.
19691. (
19692. # Os PageHiberDump start.
19693. (
19694.   FileName("DataStore.edb")
19695.   or FileName("DUMP*.*")
19696.   or FileName("Hiberfil.sys")
19697.   or FileName("MEMORY.DMP")
19698.   or FileName("Pagefile.sys")
19699. )
19700. # Os PageHiberDump end.
19701. 
19702. )
19703. # PageHiberDump end.
19704. 
19705. 		
19706. 	FileActions
19707. 
19708. 			# Script: GapZoneCalc
19709. 	# Gap
19710. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
19711. 		# Script: DisplaySetZoneStep
19712. # Increment
19713. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19714. 
19715. # Display this zone step
19716. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
19717. ')
19718. 
19719. # Script: BannerSet
19720. 
19721. # NOTE: Can't round or truncate to integer precision. 
19722. # This internal fields like ZoneCount format really badly.
19723. #  for !RunTimeNow! does not work. None of the date functions do.
19724. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19725. 
19726. SetVariable(HeadingTemp2,	ZoneCount + 0)
19727. 
19728. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19729. 
19730. Title('!Heading!')
19731. 
19732. /* pause(1) */
19733. 
19734. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
19735. 
19736. 
19737. # Script: DisplaySetWindowText
19738. # Zone Footer Set Statistics Window Text
19739. 
19740. SetStatisticsWindowText("!Heading!
19741. ----------------------------------------------------------
19742. Zones Processed: 
19743. ----------------------------------------------------------
19744. !ZoneListByLine!
19745. ----------------------------------------------------------
19746. Zone Processing Step:
19747. !ZoneStepByLine!    
19748. ----------------------------------------------------------
19749. ----------------------------------------------------------
19750. CURRENT ZONE:
19751. !ZoneStatisticsReport!
19752. ----------------------------------------------------------
19753. ----------------------------------------------------------
19754. ----------------------------------------------------------
19755. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
19756. ----------------------------------------------------------
19757. !VolumeStatisticsSummary!
19758. !VolumeStatisticsDetail!
19759. ----------------------------------------------------------
19760. ----------------------------------------------------------
19761. Zone Detailed Report:
19762. ----------------------------------------------------------
19763. !ZoneStatisticsDetail!
19764. ----------------------------------------------------------
19765. ")
19766. 
19767. 
19768. 
19769. 	
19770. 	# ACTUAL GAP
19771. 		/* AddGap Variant. */
19772. 	  	# Script: GapZoneSet
19773. # Zone Do Gap
19774. # Gap Calculation Methods:
19775. 
19776. /* 1) Anything you need to add first. */
19777. /* empty */
19778. 
19779. /* ------------------------- */
19780. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
19781. 	# GapRequestedStd.
19782. 
19783. 		/* ------------------------- */
19784. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
19785. 
19786. 		# Gap Calculation Methods:
19787. 
19788. /* AddGap Variants */
19789. 
19790. 	/* Standard */
19791. 		# Gap Calculation Methods:
19792. 	/* AddGap Variants */
19793. 	/* Standard */
19794. 
19795. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
19796. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
19797. 
19798. 	SetVariable(GapRequested, GapRequestedStd)
19799. 	
19800. 
19801. 	/* MFT Low High Method */
19802. 		# Gap Calculation Methods:
19803. 	/* AddGap Variants */
19804. 	/* MFT Low High Method */
19805. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
19806. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
19807. 	SetVariable(GapRequested, GapRequestedMft)
19808. 	
19809. 
19810. 	/* OS Volume Type Method */
19811. 		# Gap Calculation Methods:
19812. 	/* AddGap Variants */
19813. 	/* OS Volume Type Method */
19814. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
19815. 	SetVariable(GapRequested, GapRequestedOs)
19816. 
19817. 
19818. 
19819. /* MakeGap Variants */
19820. 
19821. 	/* Original Os 1-3 + MFT 2 */
19822. 		# Gap Calculation Methods:
19823. 	/* MakeGap Variants */
19824. 	/* Original Os 1-3 + MFT 2 */
19825. 	/* plus MFT gap placed inline at the dividing zone. */
19826. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
19827. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
19828. 	SetVariable(GapRequested, GapRequestedOrig)
19829. 	
19830. 	
19831. /* Note: You could comment out the ones not in use */
19832. /* However having the data in the log is useful. */
19833. /* Therefore the following line is otherwise needed. */
19834. 
19835. /* Standard used */
19836. 
19837. SetVariable(GapRequested, GapRequestedStd)
19838. 
19839. # Gap Calculation Methods:
19840. 
19841. /* AddGap Variants */
19842. 	/* Standard */
19843. 	/* MFT Low High Method */
19844. 	/* OS Volume Type Method */
19845. 
19846. /* MakeGap Variants */
19847. 	/* Original Os 1-3 + MFT 2 */
19848. 
19849. /* Note: You could comment out the ones not in use */
19850. /* However having the data in the log is useful. */
19851. /* Therefore the following line is otherwise needed. */
19852. 
19853. /* Standard is used currently */
19854. 
19855. 
19856. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
19857. 
19858. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
19859. 
19860. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
19861. 
19862. /* ------------------------- */
19863. /* 3) SMALL ZONE ADJUSTMENT. */
19864. /* Gab cant be larger than half the Zone Size. */
19865. 
19866. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
19867. 	
19868. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
19869. 
19870. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
19871. 
19872. /* ------------------------- */
19873. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
19874. # Gap Adjustments.
19875. 
19876. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
19877. 	
19878. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
19879. 
19880. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
19881. 
19882. /* ------------------------- */
19883. # BYPASS THIS.
19884. 	/* This is definitely wrong. */
19885. 	/* The question is can we steal gap from the next zone */
19886. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
19887. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
19888. 		# Zone Overflow.
19889. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
19890. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
19891. 
19892. /* ------------------------- */
19893. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
19894. # Remaining free space available.
19895. 
19896. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
19897. 	
19898. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
19899. 
19900. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
19901. 
19902. /* ------------------------- */
19903. # CURRENT gap to use.
19904. 
19905. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
19906. 
19907. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
19908. 
19909. /* ------------------------- */
19910. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
19911. # Debugging.
19912. 
19913. 	SetVariable(GapUsed, GapCurrent) // for debugging
19914. 
19915. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
19916. 
19917. 		# Your code HERE
19918. 
19919. /* ------------------------- */
19920. /* 7) YOUR CODE. */
19921. # YOUR CODE HERE:
19922. 	# INPUT: GapCurrent or GapCurrentLoc
19923. 	# OUTPUT: GapUsed...
19924. 
19925. /* ------------------------- */
19926. # Gap Size.
19927. # Actual Size of Gap.
19928. 
19929. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
19930. 
19931. /* ------------------------- */
19932. 
19933. 	
19934. 	# Zone Statistics	
19935. 		# Script: ZoneStatisticsGet
19936. # Zone / Volume Statistics and Display
19937. 		
19938. 	# Accumulate Totals
19939.   	# Script: ZoneDoVolumeTotals
19940. 
19941. /* Current total space used (by Zones and Gaps) */
19942. 
19943. SetVariable(VolumeZoneUsed, GapUsed)
19944. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
19945. /* Percentage */
19946. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
19947. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
19948. 
19949. /* Current total of free space requested */
19950. 
19951. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
19952. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
19953. /* Percent. */
19954. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
19955. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
19956. 
19957. /* Current total of free space used */
19958. 
19959. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
19960. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
19961. /* Percent */
19962. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
19963. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
19964. 
19965. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
19966. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
19967. # Xinclude "..\DebugDisplayPause.MyDc"X
19968. 
19969. 
19970. 	# Current Values
19971. 	# Script: ZoneDoCurrentSet
19972. 
19973. # Cluster, Sector, Block adjust for display.
19974. 	# Bytes per cluster is volume specific.
19975. 
19976. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
19977. 
19978. # Current Zone values.
19979. 	# Begin, end and size.
19980. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
19981. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
19982. 
19983. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
19984. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
19985. 
19986. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
19987. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
19988. 
19989. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
19990. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
19991. 
19992. 	SetVariable(ZoneFragments,				"!ZONE210N!")
19993. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
19994. 		
19995. # Current Gap, Actual and Free Values
19996. 	# Gap
19997. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
19998. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
19999. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
20000. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
20001. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
20002. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
20003. 	
20004. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
20005. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
20006. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
20007. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
20008. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
20009. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
20010. 	
20011. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
20012. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
20013. 	
20014. 	# Actual Size and End
20015. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
20016. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
20017. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
20018. 	
20019. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
20020. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
20021. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
20022. 
20023. # Gap Size & Rounding
20024. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
20025. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
20026. 	
20027. 	# Free Space
20028. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
20029. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
20030. 
20031. 	# Script: ZoneStatisticsReportGet
20032. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
20033. 
20034. # Footer:
20035. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
20036. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
20037. #
20038. # Xinclude "..\Commands\DateTimeLastLong.txt"X
20039. #
20040. # What a mess this word based vs is. Try a phrase based version ToDo
20041. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
20042. ------------------
20043.    !SizeWord!!ColonWord!  
20044.    ------------------------
20045.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20046.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20047.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20048. 
20049.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20050.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
20051. 
20052.    !LocationWord!!ColonWord!
20053.    ------------------------
20054.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20055.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
20056.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20057.       
20058.    !GapWordCaps! !SettingsWord!!ColonWord!
20059.    ------------------------
20060.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
20061.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
20062.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20063.                  
20064.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
20065.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
20066.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
20067.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
20068.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
20069.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
20070.      
20071.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
20072.    ------------------------
20073.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20074.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20075.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20076. 
20077. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
20078. ----------------------------------------------------------
20079. ")
20080. #
20081. SetVariable(DateNow, 	DATETIME)
20082. SetVariable(TimeNow, 	Time)
20083. SetVariable(RunTimeNow, 	RunTime)
20084. 
20085. 
20086. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
20087. 
20088. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
20089. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
20090. 
20091. 	# Script: DisplaySetWindowText
20092. # Zone Footer Set Statistics Window Text
20093. 
20094. SetStatisticsWindowText("!Heading!
20095. ----------------------------------------------------------
20096. Zones Processed: 
20097. ----------------------------------------------------------
20098. !ZoneListByLine!
20099. ----------------------------------------------------------
20100. Zone Processing Step:
20101. !ZoneStepByLine!    
20102. ----------------------------------------------------------
20103. ----------------------------------------------------------
20104. CURRENT ZONE:
20105. !ZoneStatisticsReport!
20106. ----------------------------------------------------------
20107. ----------------------------------------------------------
20108. ----------------------------------------------------------
20109. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
20110. ----------------------------------------------------------
20111. !VolumeStatisticsSummary!
20112. !VolumeStatisticsDetail!
20113. ----------------------------------------------------------
20114. ----------------------------------------------------------
20115. Zone Detailed Report:
20116. ----------------------------------------------------------
20117. !ZoneStatisticsDetail!
20118. ----------------------------------------------------------
20119. ")
20120. 
20121. 
20122. 	
20123. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
20124. 
20125. 
20126. 	SetVariable(ZoneStatisticsData, 
20127. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
20128.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
20129.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
20130. 
20131. 
20132. 
20133.  		# Script: ZoneStatisticsDisplay
20134. 	
20135. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
20136. !ZoneStatisticsData!
20137. ')
20138. 
20139. 		# Script: ZoneStatisticsAdd
20140. # Append Zone to Details of each zone.
20141. 		
20142. 	# Add Zone Details to Report.	
20143. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
20144. !ZoneStatisticsReport!
20145. ')
20146. 
20147. 
20148. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
20149. 		# Script: DisplaySetZoneStep
20150. # Increment
20151. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20152. 
20153. # Display this zone step
20154. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
20155. ')
20156. 
20157. # Script: BannerSet
20158. 
20159. # NOTE: Can't round or truncate to integer precision. 
20160. # This internal fields like ZoneCount format really badly.
20161. #  for !RunTimeNow! does not work. None of the date functions do.
20162. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20163. 
20164. SetVariable(HeadingTemp2,	ZoneCount + 0)
20165. 
20166. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20167. 
20168. Title('!Heading!')
20169. 
20170. /* pause(1) */
20171. 
20172. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20173. 
20174. 
20175. # Script: DisplaySetWindowText
20176. # Zone Footer Set Statistics Window Text
20177. 
20178. SetStatisticsWindowText("!Heading!
20179. ----------------------------------------------------------
20180. Zones Processed: 
20181. ----------------------------------------------------------
20182. !ZoneListByLine!
20183. ----------------------------------------------------------
20184. Zone Processing Step:
20185. !ZoneStepByLine!    
20186. ----------------------------------------------------------
20187. ----------------------------------------------------------
20188. CURRENT ZONE:
20189. !ZoneStatisticsReport!
20190. ----------------------------------------------------------
20191. ----------------------------------------------------------
20192. ----------------------------------------------------------
20193. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
20194. ----------------------------------------------------------
20195. !VolumeStatisticsSummary!
20196. !VolumeStatisticsDetail!
20197. ----------------------------------------------------------
20198. ----------------------------------------------------------
20199. Zone Detailed Report:
20200. ----------------------------------------------------------
20201. !ZoneStatisticsDetail!
20202. ----------------------------------------------------------
20203. ")
20204. 
20205. 
20206. 
20207. 
20208. 		# File Action - Type Page Hiber Dump - Regular - SortByImportSequenceSkip.
20209. # File Action - SortByImportSequence.
20210. SortByImportSequence(Ascending ) 
20211. 	
20212. 	
20213. 
20214. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
20215. 	# Script: DisplaySetZoneStep
20216. # Increment
20217. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20218. 
20219. # Display this zone step
20220. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
20221. ')
20222. 
20223. # Script: BannerSet
20224. 
20225. # NOTE: Can't round or truncate to integer precision. 
20226. # This internal fields like ZoneCount format really badly.
20227. #  for !RunTimeNow! does not work. None of the date functions do.
20228. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20229. 
20230. SetVariable(HeadingTemp2,	ZoneCount + 0)
20231. 
20232. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20233. 
20234. Title('!Heading!')
20235. 
20236. /* pause(1) */
20237. 
20238. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20239. 
20240. 
20241. # Script: DisplaySetWindowText
20242. # Zone Footer Set Statistics Window Text
20243. 
20244. SetStatisticsWindowText("!Heading!
20245. ----------------------------------------------------------
20246. Zones Processed: 
20247. ----------------------------------------------------------
20248. !ZoneListByLine!
20249. ----------------------------------------------------------
20250. Zone Processing Step:
20251. !ZoneStepByLine!    
20252. ----------------------------------------------------------
20253. ----------------------------------------------------------
20254. CURRENT ZONE:
20255. !ZoneStatisticsReport!
20256. ----------------------------------------------------------
20257. ----------------------------------------------------------
20258. ----------------------------------------------------------
20259. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
20260. ----------------------------------------------------------
20261. !VolumeStatisticsSummary!
20262. !VolumeStatisticsDetail!
20263. ----------------------------------------------------------
20264. ----------------------------------------------------------
20265. Zone Detailed Report:
20266. ----------------------------------------------------------
20267. !ZoneStatisticsDetail!
20268. ----------------------------------------------------------
20269. ")
20270. 
20271. 
20272. 
20273. 
20274. 	# Script: ZoneDoFooter
20275. 
20276. /* --------------------------------- */
20277. 	# File Select
20278. 		# Select Statments
20279. 	# File Actions 
20280. 		# Standard or OS File Actions.
20281. 		# Resume...
20282. 	
20283. 		# your stuff HERE (X)... post zone (file) file actions code.
20284. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
20285. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
20286. 			# (X)
20287. 		
20288. 			/* ??? Set window? */
20289. 	
20290. 		# ADD THE GAP
20291. 		# Script: GapZoneCommand
20292. # Vacate (good for diagnostics)
20293. # DoNotVacate - DO NOT Vacate (recommended)
20294. 
20295. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
20296. # Script: DisplaySetZoneStep
20297. # Increment
20298. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20299. 
20300. # Display this zone step
20301. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
20302. ')
20303. 
20304. # Script: BannerSet
20305. 
20306. # NOTE: Can't round or truncate to integer precision. 
20307. # This internal fields like ZoneCount format really badly.
20308. #  for !RunTimeNow! does not work. None of the date functions do.
20309. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20310. 
20311. SetVariable(HeadingTemp2,	ZoneCount + 0)
20312. 
20313. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20314. 
20315. Title('!Heading!')
20316. 
20317. /* pause(1) */
20318. 
20319. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20320. 
20321. 
20322. # Script: DisplaySetWindowText
20323. # Zone Footer Set Statistics Window Text
20324. 
20325. SetStatisticsWindowText("!Heading!
20326. ----------------------------------------------------------
20327. Zones Processed: 
20328. ----------------------------------------------------------
20329. !ZoneListByLine!
20330. ----------------------------------------------------------
20331. Zone Processing Step:
20332. !ZoneStepByLine!    
20333. ----------------------------------------------------------
20334. ----------------------------------------------------------
20335. CURRENT ZONE:
20336. !ZoneStatisticsReport!
20337. ----------------------------------------------------------
20338. ----------------------------------------------------------
20339. ----------------------------------------------------------
20340. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
20341. ----------------------------------------------------------
20342. !VolumeStatisticsSummary!
20343. !VolumeStatisticsDetail!
20344. ----------------------------------------------------------
20345. ----------------------------------------------------------
20346. Zone Detailed Report:
20347. ----------------------------------------------------------
20348. !ZoneStatisticsDetail!
20349. ----------------------------------------------------------
20350. ")
20351. 
20352. 
20353. 
20354. 
20355. # *** Moved to setting yours *** 
20356. # (to avoid doing it twice)
20357. # (ie the later wouldn't "overwrite" the former in the usual manner)
20358. 
20359. # Do one or the other:
20360. # DoNotVacate - DO NOT Vacate (recommended)
20361. 
20362. # Vacate
20363. /* AddGap(GapUsedLoc) */
20364. 
20365. # DO Not Vacate
20366. AddGap(GapUsedLoc, DoNotVacate) 
20367. 	
20368. 	
20369. 
20370. # Controlled via settings commands
20371. 
20372. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
20373. 
20374. # Vacate /* AddGap(GapUsed) */
20375. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
20376. 	
20377. 
20378. 		
20379. 	# 
20380. 	FileEnd
20381. /* --------------------------------- */
20382. # your stuff HERE (X)... post zone (file) code.
20383. 
20384. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
20385. # Script: DisplaySetZoneStep
20386. # Increment
20387. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20388. 
20389. # Display this zone step
20390. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
20391. ')
20392. 
20393. # Script: BannerSet
20394. 
20395. # NOTE: Can't round or truncate to integer precision. 
20396. # This internal fields like ZoneCount format really badly.
20397. #  for !RunTimeNow! does not work. None of the date functions do.
20398. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20399. 
20400. SetVariable(HeadingTemp2,	ZoneCount + 0)
20401. 
20402. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20403. 
20404. Title('!Heading!')
20405. 
20406. /* pause(1) */
20407. 
20408. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20409. 
20410. 
20411. # Script: DisplaySetWindowText
20412. # Zone Footer Set Statistics Window Text
20413. 
20414. SetStatisticsWindowText("!Heading!
20415. ----------------------------------------------------------
20416. Zones Processed: 
20417. ----------------------------------------------------------
20418. !ZoneListByLine!
20419. ----------------------------------------------------------
20420. Zone Processing Step:
20421. !ZoneStepByLine!    
20422. ----------------------------------------------------------
20423. ----------------------------------------------------------
20424. CURRENT ZONE:
20425. !ZoneStatisticsReport!
20426. ----------------------------------------------------------
20427. ----------------------------------------------------------
20428. ----------------------------------------------------------
20429. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
20430. ----------------------------------------------------------
20431. !VolumeStatisticsSummary!
20432. !VolumeStatisticsDetail!
20433. ----------------------------------------------------------
20434. ----------------------------------------------------------
20435. Zone Detailed Report:
20436. ----------------------------------------------------------
20437. !ZoneStatisticsDetail!
20438. ----------------------------------------------------------
20439. ")
20440. 
20441. 
20442. 
20443. 
20444. # Script: ZoneWhenFinished
20445. 
20446. # Add the zone to the zone details log:
20447. # This is temporarily disable until logging is fixed
20448. # It is performed during file action to preserve the correct (original) calculations.
20449. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
20450. 
20451. # Add the Select and ZoneSteps to the Zone
20452. # Script: ZoneStatisticsAdd
20453. # Append Zone to Details of each zone.
20454. 		
20455. 	# Add Zone Details to Report.	
20456. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
20457. ----------------------------------------------------------
20458. !ZoneStepByLine!
20459. ---------------------------
20460. !ZoneTypeSelectCurrent!               
20461. ---------------------------
20462. ----------------------------------------------------------
20463. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
20464. ----------------------------------------------------------
20465. ')
20466. 
20467. 
20468. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
20469. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
20470. # 2021-12-14 15:30:01
20471. RunProgram("..\Commands\WriteDateTime.bat LastZone")
20472. # Append Datetime to logs
20473. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
20474. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
20475. 
20476. AppendLogfile("!LogFileName!", "!PeriodWord!")
20477. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
20478. AppendLogfile("!LogFileName!", "!PeriodWord!")
20479. 
20480. # Script: DisplaySetWindowText
20481. # Zone Footer Set Statistics Window Text
20482. 
20483. SetStatisticsWindowText("!Heading!
20484. ----------------------------------------------------------
20485. Zones Processed: 
20486. ----------------------------------------------------------
20487. !ZoneListByLine!
20488. ----------------------------------------------------------
20489. Zone Processing Step:
20490. !ZoneStepByLine!    
20491. ----------------------------------------------------------
20492. ----------------------------------------------------------
20493. CURRENT ZONE:
20494. !ZoneStatisticsReport!
20495. ----------------------------------------------------------
20496. ----------------------------------------------------------
20497. ----------------------------------------------------------
20498. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
20499. ----------------------------------------------------------
20500. !VolumeStatisticsSummary!
20501. !VolumeStatisticsDetail!
20502. ----------------------------------------------------------
20503. ----------------------------------------------------------
20504. Zone Detailed Report:
20505. ----------------------------------------------------------
20506. !ZoneStatisticsDetail!
20507. ----------------------------------------------------------
20508. ")
20509. 
20510. 
20511. 
20512. /* pause() */
20513. /* pause() */
20514. 
20515. 
20516. 
20517. /* ------------------------- */
20518. 
20519. 
20520. /* ------------------------- */
20521.   
20522. AppendLogfile("!LogFileName!","!MftReport!")
20523. 
20524. /* ------------------------- */
20525. 
20526. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
20527. /* ------------------------- */
20528. /* ------------------------- */
20529. /* 5 Zone 13 LinksCorp Links and Corp */
20530. # Script: DisplayColors - Zone Dark
20531. # Processed
20532. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
20533. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
20534. 
20535. # Light Green and Yellow
20536. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
20537. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
20538. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
20539. 
20540. # Script: DefragZoneTypeLinksCorp
20541. /* ------------------------- */
20542. /* Zone LinksCorp Links and Corp */
20543. SetVariable(ZoneLabel,			"!ZoneLabelLinksCorp!")
20544. SetVariable(ZoneDescription,		"!ZoneDescriptionLinksCorp!")
20545. SetVariable(ZoneVolRoundUp,			"!ZoneVolRoundUpLinksCorp!")
20546. SetVariable(ZoneGapSize,			"!ZoneGapSizeLinksCorp!")
20547. 
20548. SetVariable(ZoneTypeSelect,'
20549. Links and Corporate:
20550. # Script: ZoneDo ZoneTypeSelectLinksCorp
20551. # LinksCorp start.
20552. # NotBlobsArchivesBu start.
20553. # NOT!
20554. (not (
20555. # Blobs start.
20556. (
20557. # BlobsAndExceptions start.
20558. ( not(
20559.   FileName("*.bat")
20560.   or FileName("*.css")
20561.   or FileName("*.dll")
20562.   or FileName("*.exe")
20563.   or FileName("*.htm*")
20564.   or FileName("*.jar")
20565.   or FileName("*.js")
20566.   or FileName("*.script")
20567.   or FileName("*.wsf")
20568.   or (
20569. # Databases start.
20570. (
20571.   FileName("*.crypt*")
20572.   or FileName("*.db*")
20573.   or FileName("*.rdb*")
20574.   or FileName("*.dc*")
20575.   or FileName("*.dict*")
20576.   or FileName("*.?db*")
20577.   or FileName("*.?rdb*")
20578.   or FileName("*.md*")
20579.   or FileName("*.myd")
20580.   or FileName("*.ndf")
20581.   or FileName("*.ns?")
20582.   or FileName("*.pab")
20583.   or FileName("*.pst")
20584.   or FileName("*.sd?*")
20585.   or FileName("*.sq**")
20586.   or FileName("*.tmd")
20587.   or FileName("*.tps")
20588.   or FileName("*.tr*")
20589. )
20590. # Databases end.
20591. 
20592.     # BlobsAndExceptions
20593.     or 
20594. # Data start.
20595. (
20596.   DirectoryName("Data*")
20597.   or DirectoryName("Device*")
20598.   or DirectoryName("Export*")
20599.   or DirectoryName("Import*")
20600.   or DirectoryName("Log*")
20601.   or DirectoryName("*Log")
20602.   or DirectoryName("Maintenance*")
20603.   or DirectoryName("Rec*")
20604.   or DirectoryName("Sales*")
20605.   or DirectoryName("Search*")
20606.   or DirectoryName("User*")
20607. )
20608. # Data end.
20609. 
20610.     # BlobsAndExceptions
20611.   )
20612. ) )
20613. # BlobsAndExceptions end.
20614. 
20615. # Blobs
20616. ) and (
20617.   Size(BlobFileSize,0)
20618.   or (
20619.     FileName("*.arj")
20620.     or FileName("*.bup")
20621.     or FileName("*.bz2")
20622.     or FileName("*.chm")
20623.     or FileName("*.dvr-ms")
20624.     or FileName("*.gz")
20625.     or FileName("*.ifo")
20626.     or FileName("*.lzh")
20627.     or FileName("*.pdf")
20628.     or FileName("*.rpm")
20629.     or FileName("*.wmv")
20630.     or FileName("*.vob")
20631.     or FileName("*.z")
20632.   ) 
20633. )
20634. # Blobs end.
20635. 
20636. # NotBlobsArchivesBu
20637. or 
20638. # Archives start.
20639. (
20640.   DirectoryName("*Archive*")
20641.   or DirectoryName("*History*")
20642.   or DirectoryName("*Old")
20643.   or DirectoryName("* Old *")
20644.   or DirectoryName("Old *")
20645. 
20646.   or FileName("*.7z")
20647.   or FileName("*.cab")
20648.   or FileName("*.iso")
20649.   or FileName("*.msi")
20650.   or FileName("*.old")
20651.   or FileName("*.rar")
20652.   or FileName("*.tar")
20653.   or FileName("*.zip")
20654.   or
20655. # WinSysLow start.
20656. (
20657.   # Bad idea. This pushed lots of programs and data to archive.
20658.   # DirectoryName("$*")
20659.   # or DirectoryName("0*")
20660.   # or DirectoryName("1*")
20661.   # or DirectoryName("2*")
20662.   # or DirectoryName("3*")
20663.   # or DirectoryName("4*")
20664.   # or DirectoryName("5*")
20665.   # or DirectoryName("6*")
20666.   # or DirectoryName("7*")
20667.   # or DirectoryName("8*")
20668.   # or DirectoryName("9*")
20669.   # or 
20670.   DirectoryName("dllcache")
20671.   or DirectoryName("Downloaded Installations")
20672.   or DirectoryName("Ehome")
20673.   or DirectoryName("Fonts")
20674.   or DirectoryName("Help")
20675.   or DirectoryName("I386")
20676.   or DirectoryName("ie?updates")
20677.   or DirectoryName("Installer")
20678.   or DirectoryName("Installshield Installation Information")
20679.   or DirectoryName("IME")
20680.   or DirectoryName("*RECYCLE*")
20681.   or DirectoryName("ServicePackFiles")
20682.   or DirectoryName("SoftwareDistribution")
20683.   or DirectoryName("Speech")
20684.   or DirectoryName("Symbols")
20685.   or DirectoryName("System Volume Information")
20686.   or DirectoryName("windows.old")
20687. )
20688. # WinSysLow end.
20689. 
20690.   # Archives
20691. )
20692. # Archives end.
20693. 
20694. # NotBlobsArchivesBu
20695. or
20696. # Backups start.
20697. (
20698.   DirectoryName("*Backup*")
20699.   or DirectoryName("*Bu")
20700.   or DirectoryName("* Bu *")
20701.   or DirectoryName("Bu *")
20702. 
20703.   or FileName("*.bak")
20704.   or FileName("* - Copy*")
20705. )
20706. # Backups end.
20707. 
20708. or 
20709. FileName("ReferenceMarker.MyDx")
20710. # NotBlobsArchivesBu
20711. ) )
20712. # NotBlobsArchivesBu end.
20713. 
20714. # LinksCorp
20715. and ( 
20716. # Corp start.
20717. (
20718.     DirectoryName("*Corp*") or
20719.     DirectoryName("*Mdm*")
20720. )
20721. # Corp end.
20722. 
20723. # LinksCorp
20724. or 
20725. # Links start.
20726. (
20727.     DirectoryName("*Favorites*") or
20728.     DirectoryName("*Job*") or
20729.     DirectoryName("*Links*")
20730. )
20731. # Links end.
20732. 
20733. # LinksCorp
20734. or 
20735. # Support start.
20736. (
20737.   DirectoryName("*Logs*") or
20738.   DirectoryName("*Support*") or
20739.   DirectoryName("*Maintenance*")
20740. )
20741. # Support end.
20742. 
20743. # LinksCorp
20744. )
20745. # LinksCorp end.
20746. 
20747. ')
20748. 
20749. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
20750. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
20751. 
20752. SetVariable(ZoneStepNoCurrent, 0)
20753. 
20754. 	/* ------------------------- */
20755. # Script: ZoneDoHeader
20756. 
20757. # Script: ZoneWhenStarted
20758. RunProgram("..\Commands\WriteDateTime.bat")
20759. 
20760. # Script: ZoneDoCurrentClear
20761. 
20762. SetVariable(ZoneTypeSelectCurrent, 		"")
20763. SetVariable(ZoneStatisticsData, 		"")
20764. SetVariable(ZoneStepByLine, 			"")
20765. 
20766. SetVariable(ZoneBeginCurrent, 			0)
20767. SetVariable(ZoneBeginPerCurrent, 		0)
20768. SetVariable(ZoneEndCurrent, 			0)
20769. SetVariable(ZoneEndPerCurrent, 			0)
20770. 
20771. SetVariable(ZoneSizeCurrent,			0)
20772. SetVariable(ZoneSizePerCurrent,			0)
20773. 
20774. SetVariable(ZoneGapRequestedCurrent,	0)
20775. SetVariable(ZoneGapRoundedCurrent, 		0)
20776. SetVariable(ZoneGapAdjustedCurrent, 	0)
20777. SetVariable(ZoneGapAvailableCurrent, 	0)
20778. SetVariable(ZoneGapCurrent,				0)
20779. SetVariable(ZoneGapUsedCurrent, 		0)
20780. 
20781. SetVariable(ZoneGapActualCurrent, 		0)
20782. SetVariable(ZoneGapActualPerCurrent, 	0)
20783. 
20784. SetVariable(ZoneSizeActual, 			0)
20785. SetVariable(ZoneSizeActualCurrent,		0)
20786. 
20787. SetVariable(ZoneEndActual, 				0)
20788. SetVariable(ZoneEndActualCurrent,		0)			
20789. SetVariable(ZoneSizeActualPerCurrent, 	0)
20790.       
20791. SetVariable(ZoneFilesFolders,			0)
20792. SetVariable(ZoneFilesFoldersPer,		0) 
20793. 
20794. SetVariable(ZoneFragments,				0)
20795. SetVariable(ZoneFragmentsPer,			0) 
20796. 		
20797. SetVariable(ZoneEndActualCurrent, 		0)
20798. SetVariable(ZoneEndActualPerCurrent, 	0)
20799. 
20800. # Gap Calculation Methodology:
20801. 	# Requested
20802. 	SetVariable(GapRequested, 			0) 
20803. 	SetVariable(GapRequestedStd, 		0) 
20804. 	SetVariable(GapRequestedMft, 		0) 
20805. 	SetVariable(GapRequestedOs, 		0) 
20806. 	SetVariable(GapRequestedOriginal, 	0) 
20807. 	
20808. 	# Gap Adjustments
20809. 	SetVariable(GapRounded, 			0)
20810. 	# SetVariable(GapAdjusted, 			0)
20811. 	SetVariable(GapAvailable, 			0)
20812. 	SetVariable(GapCurrent, 			0)
20813. 	SetVariable(GapActual, 				0)
20814. 	SetVariable(GapUsed, 				0)
20815. 	
20816. 	# Gap Adjustments
20817. 	SetVariable(GapRoundedLoc, 			0)
20818. 	# SetVariable(GapAdjustedLoc, 		0)
20819. 	SetVariable(GapAvailableLoc, 		0)
20820. 	SetVariable(GapCurrentLoc, 			0)
20821. 	SetVariable(GapActualLoc,			0)
20822. 	SetVariable(GapUsedLoc,				0)
20823. 	
20824. 	# Space usage
20825. 	SetVariable(ZoneFreePerRequested, 	0)
20826. 	SetVariable(ZoneFreePerUsed, 		0)
20827. 
20828. # Gap Size & Rounding
20829. 	SetVariable(ZoneGapSizePer, 		0)
20830. 	SetVariable(ZoneVolRoundUpPer, 		0)
20831. 	
20832. 	# Free Space
20833. 	SetVariable(ZoneFreeUsedPer, 		0)
20834. 	SetVariable(ZoneFreeRequestedPer, 	0)
20835. 
20836. # Script: DisplaySetZone
20837. 
20838. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
20839. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
20840. 
20841. # Message ZoneSummary
20842. # SetVariable(ZoneSummary, '
20843. # Zone Summary:
20844. # ')
20845. # Zone processing steps
20846. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
20847. # ')
20848. 
20849. # # Script: BannerDescriptionSet
20850. 
20851. # Script: BannerSet
20852. 
20853. # NOTE: Can't round or truncate to integer precision. 
20854. # This internal fields like ZoneCount format really badly.
20855. #  for !RunTimeNow! does not work. None of the date functions do.
20856. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20857. 
20858. SetVariable(HeadingTemp2,	ZoneCount + 0)
20859. 
20860. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20861. 
20862. Title('!Heading!')
20863. 
20864. /* pause(1) */
20865. 
20866. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20867. 
20868. 
20869. # Script: BannerLog
20870. 
20871. AppendLogfile("!LogFileName!", "!Heading!")
20872. 
20873. 
20874. 
20875. # pause(1)
20876. 
20877. 
20878. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
20879. # Script: DisplaySetZoneStep
20880. # Increment
20881. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20882. 
20883. # Display this zone step
20884. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
20885. ')
20886. 
20887. # Script: BannerSet
20888. 
20889. # NOTE: Can't round or truncate to integer precision. 
20890. # This internal fields like ZoneCount format really badly.
20891. #  for !RunTimeNow! does not work. None of the date functions do.
20892. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20893. 
20894. SetVariable(HeadingTemp2,	ZoneCount + 0)
20895. 
20896. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20897. 
20898. Title('!Heading!')
20899. 
20900. /* pause(1) */
20901. 
20902. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20903. 
20904. 
20905. # Script: DisplaySetWindowText
20906. # Zone Footer Set Statistics Window Text
20907. 
20908. SetStatisticsWindowText("!Heading!
20909. ----------------------------------------------------------
20910. Zones Processed: 
20911. ----------------------------------------------------------
20912. !ZoneListByLine!
20913. ----------------------------------------------------------
20914. Zone Processing Step:
20915. !ZoneStepByLine!    
20916. ----------------------------------------------------------
20917. ----------------------------------------------------------
20918. CURRENT ZONE:
20919. !ZoneStatisticsReport!
20920. ----------------------------------------------------------
20921. ----------------------------------------------------------
20922. ----------------------------------------------------------
20923. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
20924. ----------------------------------------------------------
20925. !VolumeStatisticsSummary!
20926. !VolumeStatisticsDetail!
20927. ----------------------------------------------------------
20928. ----------------------------------------------------------
20929. Zone Detailed Report:
20930. ----------------------------------------------------------
20931. !ZoneStatisticsDetail!
20932. ----------------------------------------------------------
20933. ")
20934. 
20935. 
20936. 
20937. 
20938. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
20939. 
20940. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
20941. # Script: DisplaySetZoneStep
20942. # Increment
20943. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20944. 
20945. # Display this zone step
20946. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
20947. ')
20948. 
20949. # Script: BannerSet
20950. 
20951. # NOTE: Can't round or truncate to integer precision. 
20952. # This internal fields like ZoneCount format really badly.
20953. #  for !RunTimeNow! does not work. None of the date functions do.
20954. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20955. 
20956. SetVariable(HeadingTemp2,	ZoneCount + 0)
20957. 
20958. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20959. 
20960. Title('!Heading!')
20961. 
20962. /* pause(1) */
20963. 
20964. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
20965. 
20966. 
20967. # Script: DisplaySetWindowText
20968. # Zone Footer Set Statistics Window Text
20969. 
20970. SetStatisticsWindowText("!Heading!
20971. ----------------------------------------------------------
20972. Zones Processed: 
20973. ----------------------------------------------------------
20974. !ZoneListByLine!
20975. ----------------------------------------------------------
20976. Zone Processing Step:
20977. !ZoneStepByLine!    
20978. ----------------------------------------------------------
20979. ----------------------------------------------------------
20980. CURRENT ZONE:
20981. !ZoneStatisticsReport!
20982. ----------------------------------------------------------
20983. ----------------------------------------------------------
20984. ----------------------------------------------------------
20985. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
20986. ----------------------------------------------------------
20987. !VolumeStatisticsSummary!
20988. !VolumeStatisticsDetail!
20989. ----------------------------------------------------------
20990. ----------------------------------------------------------
20991. Zone Detailed Report:
20992. ----------------------------------------------------------
20993. !ZoneStatisticsDetail!
20994. ----------------------------------------------------------
20995. ")
20996. 
20997. 
20998. 
20999. 
21000. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
21001. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
21002. 
21003. # Script: BannerSet
21004. 
21005. # NOTE: Can't round or truncate to integer precision. 
21006. # This internal fields like ZoneCount format really badly.
21007. #  for !RunTimeNow! does not work. None of the date functions do.
21008. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21009. 
21010. SetVariable(HeadingTemp2,	ZoneCount + 0)
21011. 
21012. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21013. 
21014. Title('!Heading!')
21015. 
21016. /* pause(1) */
21017. 
21018. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21019. 
21020. 
21021. # Script: BannerLog
21022. 
21023. AppendLogfile("!LogFileName!", "!Heading!")
21024. 
21025. 
21026. 
21027. # LOGGING:
21028. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
21029. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
21030. 
21031. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
21032. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:01")
21033. # 2021-12-14 15:30:01 
21034. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:06 !ZoneLabel! !ZoneDescription!")
21035. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
21036. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:06 !ZoneLabel! !ZoneDescription!")
21037. 
21038. 
21039. # Add zone to list of zones:
21040. SetVariable(ZoneListByLine, "!ZoneListByLine!
21041. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
21042. # Script: DisplaySetWindowText
21043. # Zone Footer Set Statistics Window Text
21044. 
21045. SetStatisticsWindowText("!Heading!
21046. ----------------------------------------------------------
21047. Zones Processed: 
21048. ----------------------------------------------------------
21049. !ZoneListByLine!
21050. ----------------------------------------------------------
21051. Zone Processing Step:
21052. !ZoneStepByLine!    
21053. ----------------------------------------------------------
21054. ----------------------------------------------------------
21055. CURRENT ZONE:
21056. !ZoneStatisticsReport!
21057. ----------------------------------------------------------
21058. ----------------------------------------------------------
21059. ----------------------------------------------------------
21060. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
21061. ----------------------------------------------------------
21062. !VolumeStatisticsSummary!
21063. !VolumeStatisticsDetail!
21064. ----------------------------------------------------------
21065. ----------------------------------------------------------
21066. Zone Detailed Report:
21067. ----------------------------------------------------------
21068. !ZoneStatisticsDetail!
21069. ----------------------------------------------------------
21070. ")
21071. 
21072. 
21073. 
21074. 
21075. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
21076. # Script: DisplaySetZoneStep
21077. # Increment
21078. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21079. 
21080. # Display this zone step
21081. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
21082. ')
21083. 
21084. # Script: BannerSet
21085. 
21086. # NOTE: Can't round or truncate to integer precision. 
21087. # This internal fields like ZoneCount format really badly.
21088. #  for !RunTimeNow! does not work. None of the date functions do.
21089. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21090. 
21091. SetVariable(HeadingTemp2,	ZoneCount + 0)
21092. 
21093. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21094. 
21095. Title('!Heading!')
21096. 
21097. /* pause(1) */
21098. 
21099. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21100. 
21101. 
21102. # Script: DisplaySetWindowText
21103. # Zone Footer Set Statistics Window Text
21104. 
21105. SetStatisticsWindowText("!Heading!
21106. ----------------------------------------------------------
21107. Zones Processed: 
21108. ----------------------------------------------------------
21109. !ZoneListByLine!
21110. ----------------------------------------------------------
21111. Zone Processing Step:
21112. !ZoneStepByLine!    
21113. ----------------------------------------------------------
21114. ----------------------------------------------------------
21115. CURRENT ZONE:
21116. !ZoneStatisticsReport!
21117. ----------------------------------------------------------
21118. ----------------------------------------------------------
21119. ----------------------------------------------------------
21120. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
21121. ----------------------------------------------------------
21122. !VolumeStatisticsSummary!
21123. !VolumeStatisticsDetail!
21124. ----------------------------------------------------------
21125. ----------------------------------------------------------
21126. Zone Detailed Report:
21127. ----------------------------------------------------------
21128. !ZoneStatisticsDetail!
21129. ----------------------------------------------------------
21130. ")
21131. 
21132. 
21133. 
21134. 
21135. # your stuff HERE (X)... pre file select code.
21136. 
21137. /* --------------------------------- */
21138. 	FileSelect
21139. 
21140. 		# your stuff can't really go here (errors.)
21141. 		# maybe for some reason I don't know of...
21142. 	
21143. 		# Actions next...
21144. 	# Script: ZoneDo ZoneTypeSelectLinksCorp
21145. # LinksCorp start.
21146. # NotBlobsArchivesBu start.
21147. # NOT!
21148. (not (
21149. # Blobs start.
21150. (
21151. # BlobsAndExceptions start.
21152. ( not(
21153.   FileName("*.bat")
21154.   or FileName("*.css")
21155.   or FileName("*.dll")
21156.   or FileName("*.exe")
21157.   or FileName("*.htm*")
21158.   or FileName("*.jar")
21159.   or FileName("*.js")
21160.   or FileName("*.script")
21161.   or FileName("*.wsf")
21162.   or (
21163. # Databases start.
21164. (
21165.   FileName("*.crypt*")
21166.   or FileName("*.db*")
21167.   or FileName("*.rdb*")
21168.   or FileName("*.dc*")
21169.   or FileName("*.dict*")
21170.   or FileName("*.?db*")
21171.   or FileName("*.?rdb*")
21172.   or FileName("*.md*")
21173.   or FileName("*.myd")
21174.   or FileName("*.ndf")
21175.   or FileName("*.ns?")
21176.   or FileName("*.pab")
21177.   or FileName("*.pst")
21178.   or FileName("*.sd?*")
21179.   or FileName("*.sq**")
21180.   or FileName("*.tmd")
21181.   or FileName("*.tps")
21182.   or FileName("*.tr*")
21183. )
21184. # Databases end.
21185. 
21186.     # BlobsAndExceptions
21187.     or 
21188. # Data start.
21189. (
21190.   DirectoryName("Data*")
21191.   or DirectoryName("Device*")
21192.   or DirectoryName("Export*")
21193.   or DirectoryName("Import*")
21194.   or DirectoryName("Log*")
21195.   or DirectoryName("*Log")
21196.   or DirectoryName("Maintenance*")
21197.   or DirectoryName("Rec*")
21198.   or DirectoryName("Sales*")
21199.   or DirectoryName("Search*")
21200.   or DirectoryName("User*")
21201. )
21202. # Data end.
21203. 
21204.     # BlobsAndExceptions
21205.   )
21206. ) )
21207. # BlobsAndExceptions end.
21208. 
21209. # Blobs
21210. ) and (
21211.   Size(BlobFileSize,0)
21212.   or (
21213.     FileName("*.arj")
21214.     or FileName("*.bup")
21215.     or FileName("*.bz2")
21216.     or FileName("*.chm")
21217.     or FileName("*.dvr-ms")
21218.     or FileName("*.gz")
21219.     or FileName("*.ifo")
21220.     or FileName("*.lzh")
21221.     or FileName("*.pdf")
21222.     or FileName("*.rpm")
21223.     or FileName("*.wmv")
21224.     or FileName("*.vob")
21225.     or FileName("*.z")
21226.   ) 
21227. )
21228. # Blobs end.
21229. 
21230. # NotBlobsArchivesBu
21231. or 
21232. # Archives start.
21233. (
21234.   DirectoryName("*Archive*")
21235.   or DirectoryName("*History*")
21236.   or DirectoryName("*Old")
21237.   or DirectoryName("* Old *")
21238.   or DirectoryName("Old *")
21239. 
21240.   or FileName("*.7z")
21241.   or FileName("*.cab")
21242.   or FileName("*.iso")
21243.   or FileName("*.msi")
21244.   or FileName("*.old")
21245.   or FileName("*.rar")
21246.   or FileName("*.tar")
21247.   or FileName("*.zip")
21248.   or
21249. # WinSysLow start.
21250. (
21251.   # Bad idea. This pushed lots of programs and data to archive.
21252.   # DirectoryName("$*")
21253.   # or DirectoryName("0*")
21254.   # or DirectoryName("1*")
21255.   # or DirectoryName("2*")
21256.   # or DirectoryName("3*")
21257.   # or DirectoryName("4*")
21258.   # or DirectoryName("5*")
21259.   # or DirectoryName("6*")
21260.   # or DirectoryName("7*")
21261.   # or DirectoryName("8*")
21262.   # or DirectoryName("9*")
21263.   # or 
21264.   DirectoryName("dllcache")
21265.   or DirectoryName("Downloaded Installations")
21266.   or DirectoryName("Ehome")
21267.   or DirectoryName("Fonts")
21268.   or DirectoryName("Help")
21269.   or DirectoryName("I386")
21270.   or DirectoryName("ie?updates")
21271.   or DirectoryName("Installer")
21272.   or DirectoryName("Installshield Installation Information")
21273.   or DirectoryName("IME")
21274.   or DirectoryName("*RECYCLE*")
21275.   or DirectoryName("ServicePackFiles")
21276.   or DirectoryName("SoftwareDistribution")
21277.   or DirectoryName("Speech")
21278.   or DirectoryName("Symbols")
21279.   or DirectoryName("System Volume Information")
21280.   or DirectoryName("windows.old")
21281. )
21282. # WinSysLow end.
21283. 
21284.   # Archives
21285. )
21286. # Archives end.
21287. 
21288. # NotBlobsArchivesBu
21289. or
21290. # Backups start.
21291. (
21292.   DirectoryName("*Backup*")
21293.   or DirectoryName("*Bu")
21294.   or DirectoryName("* Bu *")
21295.   or DirectoryName("Bu *")
21296. 
21297.   or FileName("*.bak")
21298.   or FileName("* - Copy*")
21299. )
21300. # Backups end.
21301. 
21302. or 
21303. FileName("ReferenceMarker.MyDx")
21304. # NotBlobsArchivesBu
21305. ) )
21306. # NotBlobsArchivesBu end.
21307. 
21308. # LinksCorp
21309. and ( 
21310. # Corp start.
21311. (
21312.     DirectoryName("*Corp*") or
21313.     DirectoryName("*Mdm*")
21314. )
21315. # Corp end.
21316. 
21317. # LinksCorp
21318. or 
21319. # Links start.
21320. (
21321.     DirectoryName("*Favorites*") or
21322.     DirectoryName("*Job*") or
21323.     DirectoryName("*Links*")
21324. )
21325. # Links end.
21326. 
21327. # LinksCorp
21328. or 
21329. # Support start.
21330. (
21331.   DirectoryName("*Logs*") or
21332.   DirectoryName("*Support*") or
21333.   DirectoryName("*Maintenance*")
21334. )
21335. # Support end.
21336. 
21337. # LinksCorp
21338. )
21339. # LinksCorp end.
21340. 
21341. 	# Script: ZoneDoAction
21342. # Zone Do File Action - SortByName.
21343. 
21344. 	FileActions
21345. 
21346. 			# Script: GapZoneCalc
21347. 	# Gap
21348. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
21349. 		# Script: DisplaySetZoneStep
21350. # Increment
21351. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21352. 
21353. # Display this zone step
21354. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
21355. ')
21356. 
21357. # Script: BannerSet
21358. 
21359. # NOTE: Can't round or truncate to integer precision. 
21360. # This internal fields like ZoneCount format really badly.
21361. #  for !RunTimeNow! does not work. None of the date functions do.
21362. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21363. 
21364. SetVariable(HeadingTemp2,	ZoneCount + 0)
21365. 
21366. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21367. 
21368. Title('!Heading!')
21369. 
21370. /* pause(1) */
21371. 
21372. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21373. 
21374. 
21375. # Script: DisplaySetWindowText
21376. # Zone Footer Set Statistics Window Text
21377. 
21378. SetStatisticsWindowText("!Heading!
21379. ----------------------------------------------------------
21380. Zones Processed: 
21381. ----------------------------------------------------------
21382. !ZoneListByLine!
21383. ----------------------------------------------------------
21384. Zone Processing Step:
21385. !ZoneStepByLine!    
21386. ----------------------------------------------------------
21387. ----------------------------------------------------------
21388. CURRENT ZONE:
21389. !ZoneStatisticsReport!
21390. ----------------------------------------------------------
21391. ----------------------------------------------------------
21392. ----------------------------------------------------------
21393. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
21394. ----------------------------------------------------------
21395. !VolumeStatisticsSummary!
21396. !VolumeStatisticsDetail!
21397. ----------------------------------------------------------
21398. ----------------------------------------------------------
21399. Zone Detailed Report:
21400. ----------------------------------------------------------
21401. !ZoneStatisticsDetail!
21402. ----------------------------------------------------------
21403. ")
21404. 
21405. 
21406. 
21407. 	
21408. 	# ACTUAL GAP
21409. 		/* AddGap Variant. */
21410. 	  	# Script: GapZoneSet
21411. # Zone Do Gap
21412. # Gap Calculation Methods:
21413. 
21414. /* 1) Anything you need to add first. */
21415. /* empty */
21416. 
21417. /* ------------------------- */
21418. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
21419. 	# GapRequestedStd.
21420. 
21421. 		/* ------------------------- */
21422. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
21423. 
21424. 		# Gap Calculation Methods:
21425. 
21426. /* AddGap Variants */
21427. 
21428. 	/* Standard */
21429. 		# Gap Calculation Methods:
21430. 	/* AddGap Variants */
21431. 	/* Standard */
21432. 
21433. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
21434. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
21435. 
21436. 	SetVariable(GapRequested, GapRequestedStd)
21437. 	
21438. 
21439. 	/* MFT Low High Method */
21440. 		# Gap Calculation Methods:
21441. 	/* AddGap Variants */
21442. 	/* MFT Low High Method */
21443. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
21444. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
21445. 	SetVariable(GapRequested, GapRequestedMft)
21446. 	
21447. 
21448. 	/* OS Volume Type Method */
21449. 		# Gap Calculation Methods:
21450. 	/* AddGap Variants */
21451. 	/* OS Volume Type Method */
21452. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
21453. 	SetVariable(GapRequested, GapRequestedOs)
21454. 
21455. 
21456. 
21457. /* MakeGap Variants */
21458. 
21459. 	/* Original Os 1-3 + MFT 2 */
21460. 		# Gap Calculation Methods:
21461. 	/* MakeGap Variants */
21462. 	/* Original Os 1-3 + MFT 2 */
21463. 	/* plus MFT gap placed inline at the dividing zone. */
21464. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
21465. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
21466. 	SetVariable(GapRequested, GapRequestedOrig)
21467. 	
21468. 	
21469. /* Note: You could comment out the ones not in use */
21470. /* However having the data in the log is useful. */
21471. /* Therefore the following line is otherwise needed. */
21472. 
21473. /* Standard used */
21474. 
21475. SetVariable(GapRequested, GapRequestedStd)
21476. 
21477. # Gap Calculation Methods:
21478. 
21479. /* AddGap Variants */
21480. 	/* Standard */
21481. 	/* MFT Low High Method */
21482. 	/* OS Volume Type Method */
21483. 
21484. /* MakeGap Variants */
21485. 	/* Original Os 1-3 + MFT 2 */
21486. 
21487. /* Note: You could comment out the ones not in use */
21488. /* However having the data in the log is useful. */
21489. /* Therefore the following line is otherwise needed. */
21490. 
21491. /* Standard is used currently */
21492. 
21493. 
21494. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
21495. 
21496. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
21497. 
21498. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
21499. 
21500. /* ------------------------- */
21501. /* 3) SMALL ZONE ADJUSTMENT. */
21502. /* Gab cant be larger than half the Zone Size. */
21503. 
21504. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
21505. 	
21506. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
21507. 
21508. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
21509. 
21510. /* ------------------------- */
21511. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
21512. # Gap Adjustments.
21513. 
21514. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
21515. 	
21516. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
21517. 
21518. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
21519. 
21520. /* ------------------------- */
21521. # BYPASS THIS.
21522. 	/* This is definitely wrong. */
21523. 	/* The question is can we steal gap from the next zone */
21524. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
21525. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
21526. 		# Zone Overflow.
21527. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
21528. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
21529. 
21530. /* ------------------------- */
21531. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
21532. # Remaining free space available.
21533. 
21534. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
21535. 	
21536. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
21537. 
21538. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
21539. 
21540. /* ------------------------- */
21541. # CURRENT gap to use.
21542. 
21543. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
21544. 
21545. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
21546. 
21547. /* ------------------------- */
21548. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
21549. # Debugging.
21550. 
21551. 	SetVariable(GapUsed, GapCurrent) // for debugging
21552. 
21553. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
21554. 
21555. 		# Your code HERE
21556. 
21557. /* ------------------------- */
21558. /* 7) YOUR CODE. */
21559. # YOUR CODE HERE:
21560. 	# INPUT: GapCurrent or GapCurrentLoc
21561. 	# OUTPUT: GapUsed...
21562. 
21563. /* ------------------------- */
21564. # Gap Size.
21565. # Actual Size of Gap.
21566. 
21567. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
21568. 
21569. /* ------------------------- */
21570. 
21571. 	
21572. 	# Zone Statistics	
21573. 		# Script: ZoneStatisticsGet
21574. # Zone / Volume Statistics and Display
21575. 		
21576. 	# Accumulate Totals
21577.   	# Script: ZoneDoVolumeTotals
21578. 
21579. /* Current total space used (by Zones and Gaps) */
21580. 
21581. SetVariable(VolumeZoneUsed, GapUsed)
21582. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
21583. /* Percentage */
21584. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
21585. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
21586. 
21587. /* Current total of free space requested */
21588. 
21589. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
21590. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
21591. /* Percent. */
21592. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
21593. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
21594. 
21595. /* Current total of free space used */
21596. 
21597. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
21598. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
21599. /* Percent */
21600. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
21601. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
21602. 
21603. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
21604. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
21605. # Xinclude "..\DebugDisplayPause.MyDc"X
21606. 
21607. 
21608. 	# Current Values
21609. 	# Script: ZoneDoCurrentSet
21610. 
21611. # Cluster, Sector, Block adjust for display.
21612. 	# Bytes per cluster is volume specific.
21613. 
21614. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
21615. 
21616. # Current Zone values.
21617. 	# Begin, end and size.
21618. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
21619. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
21620. 
21621. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
21622. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
21623. 
21624. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
21625. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
21626. 
21627. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
21628. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
21629. 
21630. 	SetVariable(ZoneFragments,				"!ZONE210N!")
21631. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
21632. 		
21633. # Current Gap, Actual and Free Values
21634. 	# Gap
21635. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
21636. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
21637. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
21638. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
21639. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
21640. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
21641. 	
21642. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
21643. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
21644. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
21645. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
21646. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
21647. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
21648. 	
21649. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
21650. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
21651. 	
21652. 	# Actual Size and End
21653. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
21654. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
21655. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
21656. 	
21657. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
21658. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
21659. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
21660. 
21661. # Gap Size & Rounding
21662. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
21663. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
21664. 	
21665. 	# Free Space
21666. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
21667. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
21668. 
21669. 	# Script: ZoneStatisticsReportGet
21670. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
21671. 
21672. # Footer:
21673. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
21674. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
21675. #
21676. # Xinclude "..\Commands\DateTimeLastLong.txt"X
21677. #
21678. # What a mess this word based vs is. Try a phrase based version ToDo
21679. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
21680. ------------------
21681.    !SizeWord!!ColonWord!  
21682.    ------------------------
21683.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21684.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21685.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21686. 
21687.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21688.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
21689. 
21690.    !LocationWord!!ColonWord!
21691.    ------------------------
21692.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21693.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
21694.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21695.       
21696.    !GapWordCaps! !SettingsWord!!ColonWord!
21697.    ------------------------
21698.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
21699.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
21700.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21701.                  
21702.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
21703.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
21704.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
21705.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
21706.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
21707.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
21708.      
21709.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
21710.    ------------------------
21711.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21712.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21713.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21714. 
21715. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
21716. ----------------------------------------------------------
21717. ")
21718. #
21719. SetVariable(DateNow, 	DATETIME)
21720. SetVariable(TimeNow, 	Time)
21721. SetVariable(RunTimeNow, 	RunTime)
21722. 
21723. 
21724. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
21725. 
21726. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
21727. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
21728. 
21729. 	# Script: DisplaySetWindowText
21730. # Zone Footer Set Statistics Window Text
21731. 
21732. SetStatisticsWindowText("!Heading!
21733. ----------------------------------------------------------
21734. Zones Processed: 
21735. ----------------------------------------------------------
21736. !ZoneListByLine!
21737. ----------------------------------------------------------
21738. Zone Processing Step:
21739. !ZoneStepByLine!    
21740. ----------------------------------------------------------
21741. ----------------------------------------------------------
21742. CURRENT ZONE:
21743. !ZoneStatisticsReport!
21744. ----------------------------------------------------------
21745. ----------------------------------------------------------
21746. ----------------------------------------------------------
21747. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
21748. ----------------------------------------------------------
21749. !VolumeStatisticsSummary!
21750. !VolumeStatisticsDetail!
21751. ----------------------------------------------------------
21752. ----------------------------------------------------------
21753. Zone Detailed Report:
21754. ----------------------------------------------------------
21755. !ZoneStatisticsDetail!
21756. ----------------------------------------------------------
21757. ")
21758. 
21759. 
21760. 	
21761. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
21762. 
21763. 
21764. 	SetVariable(ZoneStatisticsData, 
21765. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
21766.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
21767.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
21768. 
21769. 
21770. 
21771.  		# Script: ZoneStatisticsDisplay
21772. 	
21773. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
21774. !ZoneStatisticsData!
21775. ')
21776. 
21777. 		# Script: ZoneStatisticsAdd
21778. # Append Zone to Details of each zone.
21779. 		
21780. 	# Add Zone Details to Report.	
21781. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
21782. !ZoneStatisticsReport!
21783. ')
21784. 
21785. 	
21786. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
21787. 		# Script: DisplaySetZoneStep
21788. # Increment
21789. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21790. 
21791. # Display this zone step
21792. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
21793. ')
21794. 
21795. # Script: BannerSet
21796. 
21797. # NOTE: Can't round or truncate to integer precision. 
21798. # This internal fields like ZoneCount format really badly.
21799. #  for !RunTimeNow! does not work. None of the date functions do.
21800. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21801. 
21802. SetVariable(HeadingTemp2,	ZoneCount + 0)
21803. 
21804. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21805. 
21806. Title('!Heading!')
21807. 
21808. /* pause(1) */
21809. 
21810. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21811. 
21812. 
21813. # Script: DisplaySetWindowText
21814. # Zone Footer Set Statistics Window Text
21815. 
21816. SetStatisticsWindowText("!Heading!
21817. ----------------------------------------------------------
21818. Zones Processed: 
21819. ----------------------------------------------------------
21820. !ZoneListByLine!
21821. ----------------------------------------------------------
21822. Zone Processing Step:
21823. !ZoneStepByLine!    
21824. ----------------------------------------------------------
21825. ----------------------------------------------------------
21826. CURRENT ZONE:
21827. !ZoneStatisticsReport!
21828. ----------------------------------------------------------
21829. ----------------------------------------------------------
21830. ----------------------------------------------------------
21831. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
21832. ----------------------------------------------------------
21833. !VolumeStatisticsSummary!
21834. !VolumeStatisticsDetail!
21835. ----------------------------------------------------------
21836. ----------------------------------------------------------
21837. Zone Detailed Report:
21838. ----------------------------------------------------------
21839. !ZoneStatisticsDetail!
21840. ----------------------------------------------------------
21841. ")
21842. 
21843. 
21844. 
21845. 
21846. 		# File Action - All - Full -  SortByCreationDate
21847. # File Action - ZoneDoActionSortByCreationDateFull
21848. 	SortByCreationDate(Ascending)
21849. 	
21850. 
21851. 
21852. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
21853. 		# Script: DisplaySetZoneStep
21854. # Increment
21855. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21856. 
21857. # Display this zone step
21858. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
21859. ')
21860. 
21861. # Script: BannerSet
21862. 
21863. # NOTE: Can't round or truncate to integer precision. 
21864. # This internal fields like ZoneCount format really badly.
21865. #  for !RunTimeNow! does not work. None of the date functions do.
21866. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21867. 
21868. SetVariable(HeadingTemp2,	ZoneCount + 0)
21869. 
21870. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21871. 
21872. Title('!Heading!')
21873. 
21874. /* pause(1) */
21875. 
21876. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21877. 
21878. 
21879. # Script: DisplaySetWindowText
21880. # Zone Footer Set Statistics Window Text
21881. 
21882. SetStatisticsWindowText("!Heading!
21883. ----------------------------------------------------------
21884. Zones Processed: 
21885. ----------------------------------------------------------
21886. !ZoneListByLine!
21887. ----------------------------------------------------------
21888. Zone Processing Step:
21889. !ZoneStepByLine!    
21890. ----------------------------------------------------------
21891. ----------------------------------------------------------
21892. CURRENT ZONE:
21893. !ZoneStatisticsReport!
21894. ----------------------------------------------------------
21895. ----------------------------------------------------------
21896. ----------------------------------------------------------
21897. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
21898. ----------------------------------------------------------
21899. !VolumeStatisticsSummary!
21900. !VolumeStatisticsDetail!
21901. ----------------------------------------------------------
21902. ----------------------------------------------------------
21903. Zone Detailed Report:
21904. ----------------------------------------------------------
21905. !ZoneStatisticsDetail!
21906. ----------------------------------------------------------
21907. ")
21908. 
21909. 
21910. 
21911. 
21912. 	# Script: ZoneDoFooter
21913. 
21914. /* --------------------------------- */
21915. 	# File Select
21916. 		# Select Statments
21917. 	# File Actions 
21918. 		# Standard or OS File Actions.
21919. 		# Resume...
21920. 	
21921. 		# your stuff HERE (X)... post zone (file) file actions code.
21922. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
21923. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
21924. 			# (X)
21925. 		
21926. 			/* ??? Set window? */
21927. 	
21928. 		# ADD THE GAP
21929. 		# Script: GapZoneCommand
21930. # Vacate (good for diagnostics)
21931. # DoNotVacate - DO NOT Vacate (recommended)
21932. 
21933. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
21934. # Script: DisplaySetZoneStep
21935. # Increment
21936. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21937. 
21938. # Display this zone step
21939. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
21940. ')
21941. 
21942. # Script: BannerSet
21943. 
21944. # NOTE: Can't round or truncate to integer precision. 
21945. # This internal fields like ZoneCount format really badly.
21946. #  for !RunTimeNow! does not work. None of the date functions do.
21947. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21948. 
21949. SetVariable(HeadingTemp2,	ZoneCount + 0)
21950. 
21951. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21952. 
21953. Title('!Heading!')
21954. 
21955. /* pause(1) */
21956. 
21957. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
21958. 
21959. 
21960. # Script: DisplaySetWindowText
21961. # Zone Footer Set Statistics Window Text
21962. 
21963. SetStatisticsWindowText("!Heading!
21964. ----------------------------------------------------------
21965. Zones Processed: 
21966. ----------------------------------------------------------
21967. !ZoneListByLine!
21968. ----------------------------------------------------------
21969. Zone Processing Step:
21970. !ZoneStepByLine!    
21971. ----------------------------------------------------------
21972. ----------------------------------------------------------
21973. CURRENT ZONE:
21974. !ZoneStatisticsReport!
21975. ----------------------------------------------------------
21976. ----------------------------------------------------------
21977. ----------------------------------------------------------
21978. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
21979. ----------------------------------------------------------
21980. !VolumeStatisticsSummary!
21981. !VolumeStatisticsDetail!
21982. ----------------------------------------------------------
21983. ----------------------------------------------------------
21984. Zone Detailed Report:
21985. ----------------------------------------------------------
21986. !ZoneStatisticsDetail!
21987. ----------------------------------------------------------
21988. ")
21989. 
21990. 
21991. 
21992. 
21993. # *** Moved to setting yours *** 
21994. # (to avoid doing it twice)
21995. # (ie the later wouldn't "overwrite" the former in the usual manner)
21996. 
21997. # Do one or the other:
21998. # DoNotVacate - DO NOT Vacate (recommended)
21999. 
22000. # Vacate
22001. /* AddGap(GapUsedLoc) */
22002. 
22003. # DO Not Vacate
22004. AddGap(GapUsedLoc, DoNotVacate) 
22005. 	
22006. 	
22007. 
22008. # Controlled via settings commands
22009. 
22010. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
22011. 
22012. # Vacate /* AddGap(GapUsed) */
22013. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
22014. 	
22015. 
22016. 		
22017. 	# 
22018. 	FileEnd
22019. /* --------------------------------- */
22020. # your stuff HERE (X)... post zone (file) code.
22021. 
22022. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
22023. # Script: DisplaySetZoneStep
22024. # Increment
22025. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22026. 
22027. # Display this zone step
22028. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
22029. ')
22030. 
22031. # Script: BannerSet
22032. 
22033. # NOTE: Can't round or truncate to integer precision. 
22034. # This internal fields like ZoneCount format really badly.
22035. #  for !RunTimeNow! does not work. None of the date functions do.
22036. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22037. 
22038. SetVariable(HeadingTemp2,	ZoneCount + 0)
22039. 
22040. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22041. 
22042. Title('!Heading!')
22043. 
22044. /* pause(1) */
22045. 
22046. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22047. 
22048. 
22049. # Script: DisplaySetWindowText
22050. # Zone Footer Set Statistics Window Text
22051. 
22052. SetStatisticsWindowText("!Heading!
22053. ----------------------------------------------------------
22054. Zones Processed: 
22055. ----------------------------------------------------------
22056. !ZoneListByLine!
22057. ----------------------------------------------------------
22058. Zone Processing Step:
22059. !ZoneStepByLine!    
22060. ----------------------------------------------------------
22061. ----------------------------------------------------------
22062. CURRENT ZONE:
22063. !ZoneStatisticsReport!
22064. ----------------------------------------------------------
22065. ----------------------------------------------------------
22066. ----------------------------------------------------------
22067. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
22068. ----------------------------------------------------------
22069. !VolumeStatisticsSummary!
22070. !VolumeStatisticsDetail!
22071. ----------------------------------------------------------
22072. ----------------------------------------------------------
22073. Zone Detailed Report:
22074. ----------------------------------------------------------
22075. !ZoneStatisticsDetail!
22076. ----------------------------------------------------------
22077. ")
22078. 
22079. 
22080. 
22081. 
22082. # Script: ZoneWhenFinished
22083. 
22084. # Add the zone to the zone details log:
22085. # This is temporarily disable until logging is fixed
22086. # It is performed during file action to preserve the correct (original) calculations.
22087. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
22088. 
22089. # Add the Select and ZoneSteps to the Zone
22090. # Script: ZoneStatisticsAdd
22091. # Append Zone to Details of each zone.
22092. 		
22093. 	# Add Zone Details to Report.	
22094. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
22095. ----------------------------------------------------------
22096. !ZoneStepByLine!
22097. ---------------------------
22098. !ZoneTypeSelectCurrent!               
22099. ---------------------------
22100. ----------------------------------------------------------
22101. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
22102. ----------------------------------------------------------
22103. ')
22104. 
22105. 
22106. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
22107. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
22108. # 2021-12-14 15:30:01
22109. RunProgram("..\Commands\WriteDateTime.bat LastZone")
22110. # Append Datetime to logs
22111. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
22112. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
22113. 
22114. AppendLogfile("!LogFileName!", "!PeriodWord!")
22115. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
22116. AppendLogfile("!LogFileName!", "!PeriodWord!")
22117. 
22118. # Script: DisplaySetWindowText
22119. # Zone Footer Set Statistics Window Text
22120. 
22121. SetStatisticsWindowText("!Heading!
22122. ----------------------------------------------------------
22123. Zones Processed: 
22124. ----------------------------------------------------------
22125. !ZoneListByLine!
22126. ----------------------------------------------------------
22127. Zone Processing Step:
22128. !ZoneStepByLine!    
22129. ----------------------------------------------------------
22130. ----------------------------------------------------------
22131. CURRENT ZONE:
22132. !ZoneStatisticsReport!
22133. ----------------------------------------------------------
22134. ----------------------------------------------------------
22135. ----------------------------------------------------------
22136. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
22137. ----------------------------------------------------------
22138. !VolumeStatisticsSummary!
22139. !VolumeStatisticsDetail!
22140. ----------------------------------------------------------
22141. ----------------------------------------------------------
22142. Zone Detailed Report:
22143. ----------------------------------------------------------
22144. !ZoneStatisticsDetail!
22145. ----------------------------------------------------------
22146. ")
22147. 
22148. 
22149. 
22150. /* pause() */
22151. /* pause() */
22152. 
22153. 
22154. 
22155. /* ------------------------- */
22156. 
22157. 
22158. /* ------------------------- */
22159. 
22160. /* ------------------------- */
22161. /* 6 Zone 14 People */
22162. # Script: DisplayColors - Zone Dark
22163. # Processed
22164. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
22165. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
22166. 
22167. # Light Green and Yellow
22168. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
22169. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
22170. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
22171. 
22172. # Script: DefragZoneTypePeople
22173. /* ------------------------- */
22174. /* Zone People */
22175. SetVariable(ZoneLabel,			"!ZoneLabelPeople!")
22176. SetVariable(ZoneDescription,		"!ZoneDescriptionPeople!")
22177. SetVariable(ZoneVolRoundUp,			"!ZoneVolRoundUpPeople!")
22178. SetVariable(ZoneGapSize,			"!ZoneGapSizePeople!")
22179. 
22180. SetVariable(ZoneTypeSelect,'
22181. # People and Users:
22182. # Script: ZoneDo ZoneTypeSelectPeople
22183. # People start.
22184. # NotBlobsArchivesBu start.
22185. # NOT!
22186. (not (
22187. # Blobs start.
22188. (
22189. # BlobsAndExceptions start.
22190. ( not(
22191.   FileName("*.bat")
22192.   or FileName("*.css")
22193.   or FileName("*.dll")
22194.   or FileName("*.exe")
22195.   or FileName("*.htm*")
22196.   or FileName("*.jar")
22197.   or FileName("*.js")
22198.   or FileName("*.script")
22199.   or FileName("*.wsf")
22200.   or (
22201. # Databases start.
22202. (
22203.   FileName("*.crypt*")
22204.   or FileName("*.db*")
22205.   or FileName("*.rdb*")
22206.   or FileName("*.dc*")
22207.   or FileName("*.dict*")
22208.   or FileName("*.?db*")
22209.   or FileName("*.?rdb*")
22210.   or FileName("*.md*")
22211.   or FileName("*.myd")
22212.   or FileName("*.ndf")
22213.   or FileName("*.ns?")
22214.   or FileName("*.pab")
22215.   or FileName("*.pst")
22216.   or FileName("*.sd?*")
22217.   or FileName("*.sq**")
22218.   or FileName("*.tmd")
22219.   or FileName("*.tps")
22220.   or FileName("*.tr*")
22221. )
22222. # Databases end.
22223. 
22224.     # BlobsAndExceptions
22225.     or 
22226. # Data start.
22227. (
22228.   DirectoryName("Data*")
22229.   or DirectoryName("Device*")
22230.   or DirectoryName("Export*")
22231.   or DirectoryName("Import*")
22232.   or DirectoryName("Log*")
22233.   or DirectoryName("*Log")
22234.   or DirectoryName("Maintenance*")
22235.   or DirectoryName("Rec*")
22236.   or DirectoryName("Sales*")
22237.   or DirectoryName("Search*")
22238.   or DirectoryName("User*")
22239. )
22240. # Data end.
22241. 
22242.     # BlobsAndExceptions
22243.   )
22244. ) )
22245. # BlobsAndExceptions end.
22246. 
22247. # Blobs
22248. ) and (
22249.   Size(BlobFileSize,0)
22250.   or (
22251.     FileName("*.arj")
22252.     or FileName("*.bup")
22253.     or FileName("*.bz2")
22254.     or FileName("*.chm")
22255.     or FileName("*.dvr-ms")
22256.     or FileName("*.gz")
22257.     or FileName("*.ifo")
22258.     or FileName("*.lzh")
22259.     or FileName("*.pdf")
22260.     or FileName("*.rpm")
22261.     or FileName("*.wmv")
22262.     or FileName("*.vob")
22263.     or FileName("*.z")
22264.   ) 
22265. )
22266. # Blobs end.
22267. 
22268. # NotBlobsArchivesBu
22269. or 
22270. # Archives start.
22271. (
22272.   DirectoryName("*Archive*")
22273.   or DirectoryName("*History*")
22274.   or DirectoryName("*Old")
22275.   or DirectoryName("* Old *")
22276.   or DirectoryName("Old *")
22277. 
22278.   or FileName("*.7z")
22279.   or FileName("*.cab")
22280.   or FileName("*.iso")
22281.   or FileName("*.msi")
22282.   or FileName("*.old")
22283.   or FileName("*.rar")
22284.   or FileName("*.tar")
22285.   or FileName("*.zip")
22286.   or
22287. # WinSysLow start.
22288. (
22289.   # Bad idea. This pushed lots of programs and data to archive.
22290.   # DirectoryName("$*")
22291.   # or DirectoryName("0*")
22292.   # or DirectoryName("1*")
22293.   # or DirectoryName("2*")
22294.   # or DirectoryName("3*")
22295.   # or DirectoryName("4*")
22296.   # or DirectoryName("5*")
22297.   # or DirectoryName("6*")
22298.   # or DirectoryName("7*")
22299.   # or DirectoryName("8*")
22300.   # or DirectoryName("9*")
22301.   # or 
22302.   DirectoryName("dllcache")
22303.   or DirectoryName("Downloaded Installations")
22304.   or DirectoryName("Ehome")
22305.   or DirectoryName("Fonts")
22306.   or DirectoryName("Help")
22307.   or DirectoryName("I386")
22308.   or DirectoryName("ie?updates")
22309.   or DirectoryName("Installer")
22310.   or DirectoryName("Installshield Installation Information")
22311.   or DirectoryName("IME")
22312.   or DirectoryName("*RECYCLE*")
22313.   or DirectoryName("ServicePackFiles")
22314.   or DirectoryName("SoftwareDistribution")
22315.   or DirectoryName("Speech")
22316.   or DirectoryName("Symbols")
22317.   or DirectoryName("System Volume Information")
22318.   or DirectoryName("windows.old")
22319. )
22320. # WinSysLow end.
22321. 
22322.   # Archives
22323. )
22324. # Archives end.
22325. 
22326. # NotBlobsArchivesBu
22327. or
22328. # Backups start.
22329. (
22330.   DirectoryName("*Backup*")
22331.   or DirectoryName("*Bu")
22332.   or DirectoryName("* Bu *")
22333.   or DirectoryName("Bu *")
22334. 
22335.   or FileName("*.bak")
22336.   or FileName("* - Copy*")
22337. )
22338. # Backups end.
22339. 
22340. or 
22341. FileName("ReferenceMarker.MyDx")
22342. # NotBlobsArchivesBu
22343. ) )
22344. # NotBlobsArchivesBu end.
22345. 
22346. # People
22347. and (
22348. # People start.
22349. (
22350.   DirectoryName("*Capture*")
22351.   or DirectoryName("*Document*")
22352.   or DirectoryName("*Download*")
22353.   or DirectoryName("*Kids*")
22354.   or DirectoryName("Mail*")
22355.   or DirectoryName("*Mail")
22356.   or DirectoryName("My*")
22357.   or DirectoryName("*Person*")
22358.   or DirectoryName("Private*")
22359.   or DirectoryName("Users")
22360.   
22361.   # Individual People HERE:
22362.   or DirectoryName("Dgh*")
22363. )
22364. # People end.
22365. 
22366. # People
22367. )
22368. # People end.
22369. 
22370. ')
22371. 
22372. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
22373. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
22374. 
22375. SetVariable(ZoneStepNoCurrent, 0)
22376. 
22377. 	/* ------------------------- */
22378. # Script: ZoneDoHeader
22379. 
22380. # Script: ZoneWhenStarted
22381. RunProgram("..\Commands\WriteDateTime.bat")
22382. 
22383. # Script: ZoneDoCurrentClear
22384. 
22385. SetVariable(ZoneTypeSelectCurrent, 		"")
22386. SetVariable(ZoneStatisticsData, 		"")
22387. SetVariable(ZoneStepByLine, 			"")
22388. 
22389. SetVariable(ZoneBeginCurrent, 			0)
22390. SetVariable(ZoneBeginPerCurrent, 		0)
22391. SetVariable(ZoneEndCurrent, 			0)
22392. SetVariable(ZoneEndPerCurrent, 			0)
22393. 
22394. SetVariable(ZoneSizeCurrent,			0)
22395. SetVariable(ZoneSizePerCurrent,			0)
22396. 
22397. SetVariable(ZoneGapRequestedCurrent,	0)
22398. SetVariable(ZoneGapRoundedCurrent, 		0)
22399. SetVariable(ZoneGapAdjustedCurrent, 	0)
22400. SetVariable(ZoneGapAvailableCurrent, 	0)
22401. SetVariable(ZoneGapCurrent,				0)
22402. SetVariable(ZoneGapUsedCurrent, 		0)
22403. 
22404. SetVariable(ZoneGapActualCurrent, 		0)
22405. SetVariable(ZoneGapActualPerCurrent, 	0)
22406. 
22407. SetVariable(ZoneSizeActual, 			0)
22408. SetVariable(ZoneSizeActualCurrent,		0)
22409. 
22410. SetVariable(ZoneEndActual, 				0)
22411. SetVariable(ZoneEndActualCurrent,		0)			
22412. SetVariable(ZoneSizeActualPerCurrent, 	0)
22413.       
22414. SetVariable(ZoneFilesFolders,			0)
22415. SetVariable(ZoneFilesFoldersPer,		0) 
22416. 
22417. SetVariable(ZoneFragments,				0)
22418. SetVariable(ZoneFragmentsPer,			0) 
22419. 		
22420. SetVariable(ZoneEndActualCurrent, 		0)
22421. SetVariable(ZoneEndActualPerCurrent, 	0)
22422. 
22423. # Gap Calculation Methodology:
22424. 	# Requested
22425. 	SetVariable(GapRequested, 			0) 
22426. 	SetVariable(GapRequestedStd, 		0) 
22427. 	SetVariable(GapRequestedMft, 		0) 
22428. 	SetVariable(GapRequestedOs, 		0) 
22429. 	SetVariable(GapRequestedOriginal, 	0) 
22430. 	
22431. 	# Gap Adjustments
22432. 	SetVariable(GapRounded, 			0)
22433. 	# SetVariable(GapAdjusted, 			0)
22434. 	SetVariable(GapAvailable, 			0)
22435. 	SetVariable(GapCurrent, 			0)
22436. 	SetVariable(GapActual, 				0)
22437. 	SetVariable(GapUsed, 				0)
22438. 	
22439. 	# Gap Adjustments
22440. 	SetVariable(GapRoundedLoc, 			0)
22441. 	# SetVariable(GapAdjustedLoc, 		0)
22442. 	SetVariable(GapAvailableLoc, 		0)
22443. 	SetVariable(GapCurrentLoc, 			0)
22444. 	SetVariable(GapActualLoc,			0)
22445. 	SetVariable(GapUsedLoc,				0)
22446. 	
22447. 	# Space usage
22448. 	SetVariable(ZoneFreePerRequested, 	0)
22449. 	SetVariable(ZoneFreePerUsed, 		0)
22450. 
22451. # Gap Size & Rounding
22452. 	SetVariable(ZoneGapSizePer, 		0)
22453. 	SetVariable(ZoneVolRoundUpPer, 		0)
22454. 	
22455. 	# Free Space
22456. 	SetVariable(ZoneFreeUsedPer, 		0)
22457. 	SetVariable(ZoneFreeRequestedPer, 	0)
22458. 
22459. # Script: DisplaySetZone
22460. 
22461. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
22462. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
22463. 
22464. # Message ZoneSummary
22465. # SetVariable(ZoneSummary, '
22466. # Zone Summary:
22467. # ')
22468. # Zone processing steps
22469. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
22470. # ')
22471. 
22472. # # Script: BannerDescriptionSet
22473. 
22474. # Script: BannerSet
22475. 
22476. # NOTE: Can't round or truncate to integer precision. 
22477. # This internal fields like ZoneCount format really badly.
22478. #  for !RunTimeNow! does not work. None of the date functions do.
22479. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22480. 
22481. SetVariable(HeadingTemp2,	ZoneCount + 0)
22482. 
22483. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22484. 
22485. Title('!Heading!')
22486. 
22487. /* pause(1) */
22488. 
22489. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22490. 
22491. 
22492. # Script: BannerLog
22493. 
22494. AppendLogfile("!LogFileName!", "!Heading!")
22495. 
22496. 
22497. 
22498. # pause(1)
22499. 
22500. 
22501. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
22502. # Script: DisplaySetZoneStep
22503. # Increment
22504. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22505. 
22506. # Display this zone step
22507. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
22508. ')
22509. 
22510. # Script: BannerSet
22511. 
22512. # NOTE: Can't round or truncate to integer precision. 
22513. # This internal fields like ZoneCount format really badly.
22514. #  for !RunTimeNow! does not work. None of the date functions do.
22515. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22516. 
22517. SetVariable(HeadingTemp2,	ZoneCount + 0)
22518. 
22519. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22520. 
22521. Title('!Heading!')
22522. 
22523. /* pause(1) */
22524. 
22525. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22526. 
22527. 
22528. # Script: DisplaySetWindowText
22529. # Zone Footer Set Statistics Window Text
22530. 
22531. SetStatisticsWindowText("!Heading!
22532. ----------------------------------------------------------
22533. Zones Processed: 
22534. ----------------------------------------------------------
22535. !ZoneListByLine!
22536. ----------------------------------------------------------
22537. Zone Processing Step:
22538. !ZoneStepByLine!    
22539. ----------------------------------------------------------
22540. ----------------------------------------------------------
22541. CURRENT ZONE:
22542. !ZoneStatisticsReport!
22543. ----------------------------------------------------------
22544. ----------------------------------------------------------
22545. ----------------------------------------------------------
22546. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
22547. ----------------------------------------------------------
22548. !VolumeStatisticsSummary!
22549. !VolumeStatisticsDetail!
22550. ----------------------------------------------------------
22551. ----------------------------------------------------------
22552. Zone Detailed Report:
22553. ----------------------------------------------------------
22554. !ZoneStatisticsDetail!
22555. ----------------------------------------------------------
22556. ")
22557. 
22558. 
22559. 
22560. 
22561. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
22562. 
22563. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
22564. # Script: DisplaySetZoneStep
22565. # Increment
22566. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22567. 
22568. # Display this zone step
22569. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
22570. ')
22571. 
22572. # Script: BannerSet
22573. 
22574. # NOTE: Can't round or truncate to integer precision. 
22575. # This internal fields like ZoneCount format really badly.
22576. #  for !RunTimeNow! does not work. None of the date functions do.
22577. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22578. 
22579. SetVariable(HeadingTemp2,	ZoneCount + 0)
22580. 
22581. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22582. 
22583. Title('!Heading!')
22584. 
22585. /* pause(1) */
22586. 
22587. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22588. 
22589. 
22590. # Script: DisplaySetWindowText
22591. # Zone Footer Set Statistics Window Text
22592. 
22593. SetStatisticsWindowText("!Heading!
22594. ----------------------------------------------------------
22595. Zones Processed: 
22596. ----------------------------------------------------------
22597. !ZoneListByLine!
22598. ----------------------------------------------------------
22599. Zone Processing Step:
22600. !ZoneStepByLine!    
22601. ----------------------------------------------------------
22602. ----------------------------------------------------------
22603. CURRENT ZONE:
22604. !ZoneStatisticsReport!
22605. ----------------------------------------------------------
22606. ----------------------------------------------------------
22607. ----------------------------------------------------------
22608. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
22609. ----------------------------------------------------------
22610. !VolumeStatisticsSummary!
22611. !VolumeStatisticsDetail!
22612. ----------------------------------------------------------
22613. ----------------------------------------------------------
22614. Zone Detailed Report:
22615. ----------------------------------------------------------
22616. !ZoneStatisticsDetail!
22617. ----------------------------------------------------------
22618. ")
22619. 
22620. 
22621. 
22622. 
22623. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
22624. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
22625. 
22626. # Script: BannerSet
22627. 
22628. # NOTE: Can't round or truncate to integer precision. 
22629. # This internal fields like ZoneCount format really badly.
22630. #  for !RunTimeNow! does not work. None of the date functions do.
22631. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22632. 
22633. SetVariable(HeadingTemp2,	ZoneCount + 0)
22634. 
22635. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22636. 
22637. Title('!Heading!')
22638. 
22639. /* pause(1) */
22640. 
22641. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22642. 
22643. 
22644. # Script: BannerLog
22645. 
22646. AppendLogfile("!LogFileName!", "!Heading!")
22647. 
22648. 
22649. 
22650. # LOGGING:
22651. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
22652. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
22653. 
22654. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
22655. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:01")
22656. # 2021-12-14 15:30:01 
22657. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:06 !ZoneLabel! !ZoneDescription!")
22658. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
22659. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:06 !ZoneLabel! !ZoneDescription!")
22660. 
22661. 
22662. # Add zone to list of zones:
22663. SetVariable(ZoneListByLine, "!ZoneListByLine!
22664. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
22665. # Script: DisplaySetWindowText
22666. # Zone Footer Set Statistics Window Text
22667. 
22668. SetStatisticsWindowText("!Heading!
22669. ----------------------------------------------------------
22670. Zones Processed: 
22671. ----------------------------------------------------------
22672. !ZoneListByLine!
22673. ----------------------------------------------------------
22674. Zone Processing Step:
22675. !ZoneStepByLine!    
22676. ----------------------------------------------------------
22677. ----------------------------------------------------------
22678. CURRENT ZONE:
22679. !ZoneStatisticsReport!
22680. ----------------------------------------------------------
22681. ----------------------------------------------------------
22682. ----------------------------------------------------------
22683. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
22684. ----------------------------------------------------------
22685. !VolumeStatisticsSummary!
22686. !VolumeStatisticsDetail!
22687. ----------------------------------------------------------
22688. ----------------------------------------------------------
22689. Zone Detailed Report:
22690. ----------------------------------------------------------
22691. !ZoneStatisticsDetail!
22692. ----------------------------------------------------------
22693. ")
22694. 
22695. 
22696. 
22697. 
22698. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
22699. # Script: DisplaySetZoneStep
22700. # Increment
22701. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22702. 
22703. # Display this zone step
22704. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
22705. ')
22706. 
22707. # Script: BannerSet
22708. 
22709. # NOTE: Can't round or truncate to integer precision. 
22710. # This internal fields like ZoneCount format really badly.
22711. #  for !RunTimeNow! does not work. None of the date functions do.
22712. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22713. 
22714. SetVariable(HeadingTemp2,	ZoneCount + 0)
22715. 
22716. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22717. 
22718. Title('!Heading!')
22719. 
22720. /* pause(1) */
22721. 
22722. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22723. 
22724. 
22725. # Script: DisplaySetWindowText
22726. # Zone Footer Set Statistics Window Text
22727. 
22728. SetStatisticsWindowText("!Heading!
22729. ----------------------------------------------------------
22730. Zones Processed: 
22731. ----------------------------------------------------------
22732. !ZoneListByLine!
22733. ----------------------------------------------------------
22734. Zone Processing Step:
22735. !ZoneStepByLine!    
22736. ----------------------------------------------------------
22737. ----------------------------------------------------------
22738. CURRENT ZONE:
22739. !ZoneStatisticsReport!
22740. ----------------------------------------------------------
22741. ----------------------------------------------------------
22742. ----------------------------------------------------------
22743. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
22744. ----------------------------------------------------------
22745. !VolumeStatisticsSummary!
22746. !VolumeStatisticsDetail!
22747. ----------------------------------------------------------
22748. ----------------------------------------------------------
22749. Zone Detailed Report:
22750. ----------------------------------------------------------
22751. !ZoneStatisticsDetail!
22752. ----------------------------------------------------------
22753. ")
22754. 
22755. 
22756. 
22757. 
22758. # your stuff HERE (X)... pre file select code.
22759. 
22760. /* --------------------------------- */
22761. 	FileSelect
22762. 
22763. 		# your stuff can't really go here (errors.)
22764. 		# maybe for some reason I don't know of...
22765. 	
22766. 		# Actions next...
22767. 	# Script: ZoneDo ZoneTypeSelectPeople
22768. # People start.
22769. # NotBlobsArchivesBu start.
22770. # NOT!
22771. (not (
22772. # Blobs start.
22773. (
22774. # BlobsAndExceptions start.
22775. ( not(
22776.   FileName("*.bat")
22777.   or FileName("*.css")
22778.   or FileName("*.dll")
22779.   or FileName("*.exe")
22780.   or FileName("*.htm*")
22781.   or FileName("*.jar")
22782.   or FileName("*.js")
22783.   or FileName("*.script")
22784.   or FileName("*.wsf")
22785.   or (
22786. # Databases start.
22787. (
22788.   FileName("*.crypt*")
22789.   or FileName("*.db*")
22790.   or FileName("*.rdb*")
22791.   or FileName("*.dc*")
22792.   or FileName("*.dict*")
22793.   or FileName("*.?db*")
22794.   or FileName("*.?rdb*")
22795.   or FileName("*.md*")
22796.   or FileName("*.myd")
22797.   or FileName("*.ndf")
22798.   or FileName("*.ns?")
22799.   or FileName("*.pab")
22800.   or FileName("*.pst")
22801.   or FileName("*.sd?*")
22802.   or FileName("*.sq**")
22803.   or FileName("*.tmd")
22804.   or FileName("*.tps")
22805.   or FileName("*.tr*")
22806. )
22807. # Databases end.
22808. 
22809.     # BlobsAndExceptions
22810.     or 
22811. # Data start.
22812. (
22813.   DirectoryName("Data*")
22814.   or DirectoryName("Device*")
22815.   or DirectoryName("Export*")
22816.   or DirectoryName("Import*")
22817.   or DirectoryName("Log*")
22818.   or DirectoryName("*Log")
22819.   or DirectoryName("Maintenance*")
22820.   or DirectoryName("Rec*")
22821.   or DirectoryName("Sales*")
22822.   or DirectoryName("Search*")
22823.   or DirectoryName("User*")
22824. )
22825. # Data end.
22826. 
22827.     # BlobsAndExceptions
22828.   )
22829. ) )
22830. # BlobsAndExceptions end.
22831. 
22832. # Blobs
22833. ) and (
22834.   Size(BlobFileSize,0)
22835.   or (
22836.     FileName("*.arj")
22837.     or FileName("*.bup")
22838.     or FileName("*.bz2")
22839.     or FileName("*.chm")
22840.     or FileName("*.dvr-ms")
22841.     or FileName("*.gz")
22842.     or FileName("*.ifo")
22843.     or FileName("*.lzh")
22844.     or FileName("*.pdf")
22845.     or FileName("*.rpm")
22846.     or FileName("*.wmv")
22847.     or FileName("*.vob")
22848.     or FileName("*.z")
22849.   ) 
22850. )
22851. # Blobs end.
22852. 
22853. # NotBlobsArchivesBu
22854. or 
22855. # Archives start.
22856. (
22857.   DirectoryName("*Archive*")
22858.   or DirectoryName("*History*")
22859.   or DirectoryName("*Old")
22860.   or DirectoryName("* Old *")
22861.   or DirectoryName("Old *")
22862. 
22863.   or FileName("*.7z")
22864.   or FileName("*.cab")
22865.   or FileName("*.iso")
22866.   or FileName("*.msi")
22867.   or FileName("*.old")
22868.   or FileName("*.rar")
22869.   or FileName("*.tar")
22870.   or FileName("*.zip")
22871.   or
22872. # WinSysLow start.
22873. (
22874.   # Bad idea. This pushed lots of programs and data to archive.
22875.   # DirectoryName("$*")
22876.   # or DirectoryName("0*")
22877.   # or DirectoryName("1*")
22878.   # or DirectoryName("2*")
22879.   # or DirectoryName("3*")
22880.   # or DirectoryName("4*")
22881.   # or DirectoryName("5*")
22882.   # or DirectoryName("6*")
22883.   # or DirectoryName("7*")
22884.   # or DirectoryName("8*")
22885.   # or DirectoryName("9*")
22886.   # or 
22887.   DirectoryName("dllcache")
22888.   or DirectoryName("Downloaded Installations")
22889.   or DirectoryName("Ehome")
22890.   or DirectoryName("Fonts")
22891.   or DirectoryName("Help")
22892.   or DirectoryName("I386")
22893.   or DirectoryName("ie?updates")
22894.   or DirectoryName("Installer")
22895.   or DirectoryName("Installshield Installation Information")
22896.   or DirectoryName("IME")
22897.   or DirectoryName("*RECYCLE*")
22898.   or DirectoryName("ServicePackFiles")
22899.   or DirectoryName("SoftwareDistribution")
22900.   or DirectoryName("Speech")
22901.   or DirectoryName("Symbols")
22902.   or DirectoryName("System Volume Information")
22903.   or DirectoryName("windows.old")
22904. )
22905. # WinSysLow end.
22906. 
22907.   # Archives
22908. )
22909. # Archives end.
22910. 
22911. # NotBlobsArchivesBu
22912. or
22913. # Backups start.
22914. (
22915.   DirectoryName("*Backup*")
22916.   or DirectoryName("*Bu")
22917.   or DirectoryName("* Bu *")
22918.   or DirectoryName("Bu *")
22919. 
22920.   or FileName("*.bak")
22921.   or FileName("* - Copy*")
22922. )
22923. # Backups end.
22924. 
22925. or 
22926. FileName("ReferenceMarker.MyDx")
22927. # NotBlobsArchivesBu
22928. ) )
22929. # NotBlobsArchivesBu end.
22930. 
22931. # People
22932. and (
22933. # People start.
22934. (
22935.   DirectoryName("*Capture*")
22936.   or DirectoryName("*Document*")
22937.   or DirectoryName("*Download*")
22938.   or DirectoryName("*Kids*")
22939.   or DirectoryName("Mail*")
22940.   or DirectoryName("*Mail")
22941.   or DirectoryName("My*")
22942.   or DirectoryName("*Person*")
22943.   or DirectoryName("Private*")
22944.   or DirectoryName("Users")
22945.   
22946.   # Individual People HERE:
22947.   or DirectoryName("Dgh*")
22948. )
22949. # People end.
22950. 
22951. # People
22952. )
22953. # People end.
22954. 
22955. 	# Script: ZoneDoAction
22956. # Zone Do File Action - SortByName.
22957. 
22958. 	FileActions
22959. 
22960. 			# Script: GapZoneCalc
22961. 	# Gap
22962. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
22963. 		# Script: DisplaySetZoneStep
22964. # Increment
22965. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22966. 
22967. # Display this zone step
22968. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
22969. ')
22970. 
22971. # Script: BannerSet
22972. 
22973. # NOTE: Can't round or truncate to integer precision. 
22974. # This internal fields like ZoneCount format really badly.
22975. #  for !RunTimeNow! does not work. None of the date functions do.
22976. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22977. 
22978. SetVariable(HeadingTemp2,	ZoneCount + 0)
22979. 
22980. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22981. 
22982. Title('!Heading!')
22983. 
22984. /* pause(1) */
22985. 
22986. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
22987. 
22988. 
22989. # Script: DisplaySetWindowText
22990. # Zone Footer Set Statistics Window Text
22991. 
22992. SetStatisticsWindowText("!Heading!
22993. ----------------------------------------------------------
22994. Zones Processed: 
22995. ----------------------------------------------------------
22996. !ZoneListByLine!
22997. ----------------------------------------------------------
22998. Zone Processing Step:
22999. !ZoneStepByLine!    
23000. ----------------------------------------------------------
23001. ----------------------------------------------------------
23002. CURRENT ZONE:
23003. !ZoneStatisticsReport!
23004. ----------------------------------------------------------
23005. ----------------------------------------------------------
23006. ----------------------------------------------------------
23007. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
23008. ----------------------------------------------------------
23009. !VolumeStatisticsSummary!
23010. !VolumeStatisticsDetail!
23011. ----------------------------------------------------------
23012. ----------------------------------------------------------
23013. Zone Detailed Report:
23014. ----------------------------------------------------------
23015. !ZoneStatisticsDetail!
23016. ----------------------------------------------------------
23017. ")
23018. 
23019. 
23020. 
23021. 	
23022. 	# ACTUAL GAP
23023. 		/* AddGap Variant. */
23024. 	  	# Script: GapZoneSet
23025. # Zone Do Gap
23026. # Gap Calculation Methods:
23027. 
23028. /* 1) Anything you need to add first. */
23029. /* empty */
23030. 
23031. /* ------------------------- */
23032. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
23033. 	# GapRequestedStd.
23034. 
23035. 		/* ------------------------- */
23036. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
23037. 
23038. 		# Gap Calculation Methods:
23039. 
23040. /* AddGap Variants */
23041. 
23042. 	/* Standard */
23043. 		# Gap Calculation Methods:
23044. 	/* AddGap Variants */
23045. 	/* Standard */
23046. 
23047. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
23048. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
23049. 
23050. 	SetVariable(GapRequested, GapRequestedStd)
23051. 	
23052. 
23053. 	/* MFT Low High Method */
23054. 		# Gap Calculation Methods:
23055. 	/* AddGap Variants */
23056. 	/* MFT Low High Method */
23057. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
23058. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
23059. 	SetVariable(GapRequested, GapRequestedMft)
23060. 	
23061. 
23062. 	/* OS Volume Type Method */
23063. 		# Gap Calculation Methods:
23064. 	/* AddGap Variants */
23065. 	/* OS Volume Type Method */
23066. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
23067. 	SetVariable(GapRequested, GapRequestedOs)
23068. 
23069. 
23070. 
23071. /* MakeGap Variants */
23072. 
23073. 	/* Original Os 1-3 + MFT 2 */
23074. 		# Gap Calculation Methods:
23075. 	/* MakeGap Variants */
23076. 	/* Original Os 1-3 + MFT 2 */
23077. 	/* plus MFT gap placed inline at the dividing zone. */
23078. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
23079. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
23080. 	SetVariable(GapRequested, GapRequestedOrig)
23081. 	
23082. 	
23083. /* Note: You could comment out the ones not in use */
23084. /* However having the data in the log is useful. */
23085. /* Therefore the following line is otherwise needed. */
23086. 
23087. /* Standard used */
23088. 
23089. SetVariable(GapRequested, GapRequestedStd)
23090. 
23091. # Gap Calculation Methods:
23092. 
23093. /* AddGap Variants */
23094. 	/* Standard */
23095. 	/* MFT Low High Method */
23096. 	/* OS Volume Type Method */
23097. 
23098. /* MakeGap Variants */
23099. 	/* Original Os 1-3 + MFT 2 */
23100. 
23101. /* Note: You could comment out the ones not in use */
23102. /* However having the data in the log is useful. */
23103. /* Therefore the following line is otherwise needed. */
23104. 
23105. /* Standard is used currently */
23106. 
23107. 
23108. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
23109. 
23110. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
23111. 
23112. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
23113. 
23114. /* ------------------------- */
23115. /* 3) SMALL ZONE ADJUSTMENT. */
23116. /* Gab cant be larger than half the Zone Size. */
23117. 
23118. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
23119. 	
23120. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
23121. 
23122. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
23123. 
23124. /* ------------------------- */
23125. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
23126. # Gap Adjustments.
23127. 
23128. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
23129. 	
23130. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
23131. 
23132. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
23133. 
23134. /* ------------------------- */
23135. # BYPASS THIS.
23136. 	/* This is definitely wrong. */
23137. 	/* The question is can we steal gap from the next zone */
23138. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
23139. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
23140. 		# Zone Overflow.
23141. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
23142. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
23143. 
23144. /* ------------------------- */
23145. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
23146. # Remaining free space available.
23147. 
23148. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
23149. 	
23150. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
23151. 
23152. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
23153. 
23154. /* ------------------------- */
23155. # CURRENT gap to use.
23156. 
23157. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
23158. 
23159. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
23160. 
23161. /* ------------------------- */
23162. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
23163. # Debugging.
23164. 
23165. 	SetVariable(GapUsed, GapCurrent) // for debugging
23166. 
23167. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
23168. 
23169. 		# Your code HERE
23170. 
23171. /* ------------------------- */
23172. /* 7) YOUR CODE. */
23173. # YOUR CODE HERE:
23174. 	# INPUT: GapCurrent or GapCurrentLoc
23175. 	# OUTPUT: GapUsed...
23176. 
23177. /* ------------------------- */
23178. # Gap Size.
23179. # Actual Size of Gap.
23180. 
23181. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
23182. 
23183. /* ------------------------- */
23184. 
23185. 	
23186. 	# Zone Statistics	
23187. 		# Script: ZoneStatisticsGet
23188. # Zone / Volume Statistics and Display
23189. 		
23190. 	# Accumulate Totals
23191.   	# Script: ZoneDoVolumeTotals
23192. 
23193. /* Current total space used (by Zones and Gaps) */
23194. 
23195. SetVariable(VolumeZoneUsed, GapUsed)
23196. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
23197. /* Percentage */
23198. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
23199. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
23200. 
23201. /* Current total of free space requested */
23202. 
23203. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
23204. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
23205. /* Percent. */
23206. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
23207. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
23208. 
23209. /* Current total of free space used */
23210. 
23211. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
23212. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
23213. /* Percent */
23214. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
23215. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
23216. 
23217. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
23218. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
23219. # Xinclude "..\DebugDisplayPause.MyDc"X
23220. 
23221. 
23222. 	# Current Values
23223. 	# Script: ZoneDoCurrentSet
23224. 
23225. # Cluster, Sector, Block adjust for display.
23226. 	# Bytes per cluster is volume specific.
23227. 
23228. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
23229. 
23230. # Current Zone values.
23231. 	# Begin, end and size.
23232. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
23233. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
23234. 
23235. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
23236. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
23237. 
23238. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
23239. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
23240. 
23241. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
23242. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
23243. 
23244. 	SetVariable(ZoneFragments,				"!ZONE210N!")
23245. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
23246. 		
23247. # Current Gap, Actual and Free Values
23248. 	# Gap
23249. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
23250. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
23251. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
23252. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
23253. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
23254. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
23255. 	
23256. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
23257. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
23258. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
23259. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
23260. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
23261. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
23262. 	
23263. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
23264. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
23265. 	
23266. 	# Actual Size and End
23267. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
23268. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
23269. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
23270. 	
23271. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
23272. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
23273. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
23274. 
23275. # Gap Size & Rounding
23276. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
23277. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
23278. 	
23279. 	# Free Space
23280. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
23281. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
23282. 
23283. 	# Script: ZoneStatisticsReportGet
23284. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
23285. 
23286. # Footer:
23287. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
23288. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
23289. #
23290. # Xinclude "..\Commands\DateTimeLastLong.txt"X
23291. #
23292. # What a mess this word based vs is. Try a phrase based version ToDo
23293. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
23294. ------------------
23295.    !SizeWord!!ColonWord!  
23296.    ------------------------
23297.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23298.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23299.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23300. 
23301.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23302.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
23303. 
23304.    !LocationWord!!ColonWord!
23305.    ------------------------
23306.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23307.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
23308.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23309.       
23310.    !GapWordCaps! !SettingsWord!!ColonWord!
23311.    ------------------------
23312.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
23313.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
23314.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23315.                  
23316.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
23317.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
23318.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
23319.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
23320.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
23321.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
23322.      
23323.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
23324.    ------------------------
23325.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23326.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23327.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23328. 
23329. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
23330. ----------------------------------------------------------
23331. ")
23332. #
23333. SetVariable(DateNow, 	DATETIME)
23334. SetVariable(TimeNow, 	Time)
23335. SetVariable(RunTimeNow, 	RunTime)
23336. 
23337. 
23338. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
23339. 
23340. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
23341. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
23342. 
23343. 	# Script: DisplaySetWindowText
23344. # Zone Footer Set Statistics Window Text
23345. 
23346. SetStatisticsWindowText("!Heading!
23347. ----------------------------------------------------------
23348. Zones Processed: 
23349. ----------------------------------------------------------
23350. !ZoneListByLine!
23351. ----------------------------------------------------------
23352. Zone Processing Step:
23353. !ZoneStepByLine!    
23354. ----------------------------------------------------------
23355. ----------------------------------------------------------
23356. CURRENT ZONE:
23357. !ZoneStatisticsReport!
23358. ----------------------------------------------------------
23359. ----------------------------------------------------------
23360. ----------------------------------------------------------
23361. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
23362. ----------------------------------------------------------
23363. !VolumeStatisticsSummary!
23364. !VolumeStatisticsDetail!
23365. ----------------------------------------------------------
23366. ----------------------------------------------------------
23367. Zone Detailed Report:
23368. ----------------------------------------------------------
23369. !ZoneStatisticsDetail!
23370. ----------------------------------------------------------
23371. ")
23372. 
23373. 
23374. 	
23375. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
23376. 
23377. 
23378. 	SetVariable(ZoneStatisticsData, 
23379. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
23380.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
23381.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
23382. 
23383. 
23384. 
23385.  		# Script: ZoneStatisticsDisplay
23386. 	
23387. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
23388. !ZoneStatisticsData!
23389. ')
23390. 
23391. 		# Script: ZoneStatisticsAdd
23392. # Append Zone to Details of each zone.
23393. 		
23394. 	# Add Zone Details to Report.	
23395. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
23396. !ZoneStatisticsReport!
23397. ')
23398. 
23399. 	
23400. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
23401. 		# Script: DisplaySetZoneStep
23402. # Increment
23403. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23404. 
23405. # Display this zone step
23406. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
23407. ')
23408. 
23409. # Script: BannerSet
23410. 
23411. # NOTE: Can't round or truncate to integer precision. 
23412. # This internal fields like ZoneCount format really badly.
23413. #  for !RunTimeNow! does not work. None of the date functions do.
23414. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
23415. 
23416. SetVariable(HeadingTemp2,	ZoneCount + 0)
23417. 
23418. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
23419. 
23420. Title('!Heading!')
23421. 
23422. /* pause(1) */
23423. 
23424. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
23425. 
23426. 
23427. # Script: DisplaySetWindowText
23428. # Zone Footer Set Statistics Window Text
23429. 
23430. SetStatisticsWindowText("!Heading!
23431. ----------------------------------------------------------
23432. Zones Processed: 
23433. ----------------------------------------------------------
23434. !ZoneListByLine!
23435. ----------------------------------------------------------
23436. Zone Processing Step:
23437. !ZoneStepByLine!    
23438. ----------------------------------------------------------
23439. ----------------------------------------------------------
23440. CURRENT ZONE:
23441. !ZoneStatisticsReport!
23442. ----------------------------------------------------------
23443. ----------------------------------------------------------
23444. ----------------------------------------------------------
23445. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
23446. ----------------------------------------------------------
23447. !VolumeStatisticsSummary!
23448. !VolumeStatisticsDetail!
23449. ----------------------------------------------------------
23450. ----------------------------------------------------------
23451. Zone Detailed Report:
23452. ----------------------------------------------------------
23453. !ZoneStatisticsDetail!
23454. ----------------------------------------------------------
23455. ")
23456. 
23457. 
23458. 
23459. 
23460. 		# File Action - All - Full -  SortByCreationDate
23461. # File Action - ZoneDoActionSortByCreationDateFull
23462. 	SortByCreationDate(Ascending)
23463. 	
23464. 
23465. 
23466. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
23467. 		# Script: DisplaySetZoneStep
23468. # Increment
23469. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23470. 
23471. # Display this zone step
23472. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
23473. ')
23474. 
23475. # Script: BannerSet
23476. 
23477. # NOTE: Can't round or truncate to integer precision. 
23478. # This internal fields like ZoneCount format really badly.
23479. #  for !RunTimeNow! does not work. None of the date functions do.
23480. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
23481. 
23482. SetVariable(HeadingTemp2,	ZoneCount + 0)
23483. 
23484. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
23485. 
23486. Title('!Heading!')
23487. 
23488. /* pause(1) */
23489. 
23490. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
23491. 
23492. 
23493. # Script: DisplaySetWindowText
23494. # Zone Footer Set Statistics Window Text
23495. 
23496. SetStatisticsWindowText("!Heading!
23497. ----------------------------------------------------------
23498. Zones Processed: 
23499. ----------------------------------------------------------
23500. !ZoneListByLine!
23501. ----------------------------------------------------------
23502. Zone Processing Step:
23503. !ZoneStepByLine!    
23504. ----------------------------------------------------------
23505. ----------------------------------------------------------
23506. CURRENT ZONE:
23507. !ZoneStatisticsReport!
23508. ----------------------------------------------------------
23509. ----------------------------------------------------------
23510. ----------------------------------------------------------
23511. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
23512. ----------------------------------------------------------
23513. !VolumeStatisticsSummary!
23514. !VolumeStatisticsDetail!
23515. ----------------------------------------------------------
23516. ----------------------------------------------------------
23517. Zone Detailed Report:
23518. ----------------------------------------------------------
23519. !ZoneStatisticsDetail!
23520. ----------------------------------------------------------
23521. ")
23522. 
23523. 
23524. 
23525. 
23526. 	# Script: ZoneDoFooter
23527. 
23528. /* --------------------------------- */
23529. 	# File Select
23530. 		# Select Statments
23531. 	# File Actions 
23532. 		# Standard or OS File Actions.
23533. 		# Resume...
23534. 	
23535. 		# your stuff HERE (X)... post zone (file) file actions code.
23536. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
23537. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
23538. 			# (X)
23539. 		
23540. 			/* ??? Set window? */
23541. 	
23542. 		# ADD THE GAP
23543. 		# Script: GapZoneCommand
23544. # Vacate (good for diagnostics)
23545. # DoNotVacate - DO NOT Vacate (recommended)
23546. 
23547. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
23548. # Script: DisplaySetZoneStep
23549. # Increment
23550. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23551. 
23552. # Display this zone step
23553. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
23554. ')
23555. 
23556. # Script: BannerSet
23557. 
23558. # NOTE: Can't round or truncate to integer precision. 
23559. # This internal fields like ZoneCount format really badly.
23560. #  for !RunTimeNow! does not work. None of the date functions do.
23561. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
23562. 
23563. SetVariable(HeadingTemp2,	ZoneCount + 0)
23564. 
23565. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
23566. 
23567. Title('!Heading!')
23568. 
23569. /* pause(1) */
23570. 
23571. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
23572. 
23573. 
23574. # Script: DisplaySetWindowText
23575. # Zone Footer Set Statistics Window Text
23576. 
23577. SetStatisticsWindowText("!Heading!
23578. ----------------------------------------------------------
23579. Zones Processed: 
23580. ----------------------------------------------------------
23581. !ZoneListByLine!
23582. ----------------------------------------------------------
23583. Zone Processing Step:
23584. !ZoneStepByLine!    
23585. ----------------------------------------------------------
23586. ----------------------------------------------------------
23587. CURRENT ZONE:
23588. !ZoneStatisticsReport!
23589. ----------------------------------------------------------
23590. ----------------------------------------------------------
23591. ----------------------------------------------------------
23592. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
23593. ----------------------------------------------------------
23594. !VolumeStatisticsSummary!
23595. !VolumeStatisticsDetail!
23596. ----------------------------------------------------------
23597. ----------------------------------------------------------
23598. Zone Detailed Report:
23599. ----------------------------------------------------------
23600. !ZoneStatisticsDetail!
23601. ----------------------------------------------------------
23602. ")
23603. 
23604. 
23605. 
23606. 
23607. # *** Moved to setting yours *** 
23608. # (to avoid doing it twice)
23609. # (ie the later wouldn't "overwrite" the former in the usual manner)
23610. 
23611. # Do one or the other:
23612. # DoNotVacate - DO NOT Vacate (recommended)
23613. 
23614. # Vacate
23615. /* AddGap(GapUsedLoc) */
23616. 
23617. # DO Not Vacate
23618. AddGap(GapUsedLoc, DoNotVacate) 
23619. 	
23620. 	
23621. 
23622. # Controlled via settings commands
23623. 
23624. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
23625. 
23626. # Vacate /* AddGap(GapUsed) */
23627. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
23628. 	
23629. 
23630. 		
23631. 	# 
23632. 	FileEnd
23633. /* --------------------------------- */
23634. # your stuff HERE (X)... post zone (file) code.
23635. 
23636. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
23637. # Script: DisplaySetZoneStep
23638. # Increment
23639. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23640. 
23641. # Display this zone step
23642. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
23643. ')
23644. 
23645. # Script: BannerSet
23646. 
23647. # NOTE: Can't round or truncate to integer precision. 
23648. # This internal fields like ZoneCount format really badly.
23649. #  for !RunTimeNow! does not work. None of the date functions do.
23650. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
23651. 
23652. SetVariable(HeadingTemp2,	ZoneCount + 0)
23653. 
23654. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
23655. 
23656. Title('!Heading!')
23657. 
23658. /* pause(1) */
23659. 
23660. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
23661. 
23662. 
23663. # Script: DisplaySetWindowText
23664. # Zone Footer Set Statistics Window Text
23665. 
23666. SetStatisticsWindowText("!Heading!
23667. ----------------------------------------------------------
23668. Zones Processed: 
23669. ----------------------------------------------------------
23670. !ZoneListByLine!
23671. ----------------------------------------------------------
23672. Zone Processing Step:
23673. !ZoneStepByLine!    
23674. ----------------------------------------------------------
23675. ----------------------------------------------------------
23676. CURRENT ZONE:
23677. !ZoneStatisticsReport!
23678. ----------------------------------------------------------
23679. ----------------------------------------------------------
23680. ----------------------------------------------------------
23681. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
23682. ----------------------------------------------------------
23683. !VolumeStatisticsSummary!
23684. !VolumeStatisticsDetail!
23685. ----------------------------------------------------------
23686. ----------------------------------------------------------
23687. Zone Detailed Report:
23688. ----------------------------------------------------------
23689. !ZoneStatisticsDetail!
23690. ----------------------------------------------------------
23691. ")
23692. 
23693. 
23694. 
23695. 
23696. # Script: ZoneWhenFinished
23697. 
23698. # Add the zone to the zone details log:
23699. # This is temporarily disable until logging is fixed
23700. # It is performed during file action to preserve the correct (original) calculations.
23701. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
23702. 
23703. # Add the Select and ZoneSteps to the Zone
23704. # Script: ZoneStatisticsAdd
23705. # Append Zone to Details of each zone.
23706. 		
23707. 	# Add Zone Details to Report.	
23708. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
23709. ----------------------------------------------------------
23710. !ZoneStepByLine!
23711. ---------------------------
23712. !ZoneTypeSelectCurrent!               
23713. ---------------------------
23714. ----------------------------------------------------------
23715. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
23716. ----------------------------------------------------------
23717. ')
23718. 
23719. 
23720. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
23721. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
23722. # 2021-12-14 15:30:01
23723. RunProgram("..\Commands\WriteDateTime.bat LastZone")
23724. # Append Datetime to logs
23725. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
23726. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
23727. 
23728. AppendLogfile("!LogFileName!", "!PeriodWord!")
23729. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
23730. AppendLogfile("!LogFileName!", "!PeriodWord!")
23731. 
23732. # Script: DisplaySetWindowText
23733. # Zone Footer Set Statistics Window Text
23734. 
23735. SetStatisticsWindowText("!Heading!
23736. ----------------------------------------------------------
23737. Zones Processed: 
23738. ----------------------------------------------------------
23739. !ZoneListByLine!
23740. ----------------------------------------------------------
23741. Zone Processing Step:
23742. !ZoneStepByLine!    
23743. ----------------------------------------------------------
23744. ----------------------------------------------------------
23745. CURRENT ZONE:
23746. !ZoneStatisticsReport!
23747. ----------------------------------------------------------
23748. ----------------------------------------------------------
23749. ----------------------------------------------------------
23750. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
23751. ----------------------------------------------------------
23752. !VolumeStatisticsSummary!
23753. !VolumeStatisticsDetail!
23754. ----------------------------------------------------------
23755. ----------------------------------------------------------
23756. Zone Detailed Report:
23757. ----------------------------------------------------------
23758. !ZoneStatisticsDetail!
23759. ----------------------------------------------------------
23760. ")
23761. 
23762. 
23763. 
23764. /* pause() */
23765. /* pause() */
23766. 
23767. 
23768. 
23769. /* ------------------------- */
23770. 
23771. 
23772. /* ------------------------- */
23773. 
23774. /* ------------------------- */
23775. // Way too high due to Unzoned Multimedia scerios.
23776. // "4" & "5" now 12 & 13
23777. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
23778. /* Process MFT & Dir's HERE. */
23779. # Xinclude "..\Defrag\DefragZoneGroupMftDir.MyDc"X
23780. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
23781. /* ------------------------- */
23782. /* 7 Zone 15 Games */
23783. # Script: DisplayColors - Zone Dark
23784. # Processed
23785. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
23786. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
23787. 
23788. # Light Green and Yellow
23789. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
23790. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
23791. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
23792. 
23793. # Script: DefragZoneTypeGames
23794. /* ------------------------- */
23795. /* Zone Games */
23796. SetVariable(ZoneLabel, "!ZoneLabelGames!")
23797. SetVariable(ZoneDescription, "!ZoneDescriptionGames!")
23798. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpGames!")
23799. SetVariable(ZoneGapSize, "!ZoneGapSizeGames!")
23800. 
23801. SetVariable(ZoneTypeSelect,'
23802. Games:
23803. # Script: ZoneDo ZoneTypeSelectGames
23804. # Games start.
23805. # NotBlobsArchivesBu start.
23806. # NOT!
23807. (not (
23808. # Blobs start.
23809. (
23810. # BlobsAndExceptions start.
23811. ( not(
23812.   FileName("*.bat")
23813.   or FileName("*.css")
23814.   or FileName("*.dll")
23815.   or FileName("*.exe")
23816.   or FileName("*.htm*")
23817.   or FileName("*.jar")
23818.   or FileName("*.js")
23819.   or FileName("*.script")
23820.   or FileName("*.wsf")
23821.   or (
23822. # Databases start.
23823. (
23824.   FileName("*.crypt*")
23825.   or FileName("*.db*")
23826.   or FileName("*.rdb*")
23827.   or FileName("*.dc*")
23828.   or FileName("*.dict*")
23829.   or FileName("*.?db*")
23830.   or FileName("*.?rdb*")
23831.   or FileName("*.md*")
23832.   or FileName("*.myd")
23833.   or FileName("*.ndf")
23834.   or FileName("*.ns?")
23835.   or FileName("*.pab")
23836.   or FileName("*.pst")
23837.   or FileName("*.sd?*")
23838.   or FileName("*.sq**")
23839.   or FileName("*.tmd")
23840.   or FileName("*.tps")
23841.   or FileName("*.tr*")
23842. )
23843. # Databases end.
23844. 
23845.     # BlobsAndExceptions
23846.     or 
23847. # Data start.
23848. (
23849.   DirectoryName("Data*")
23850.   or DirectoryName("Device*")
23851.   or DirectoryName("Export*")
23852.   or DirectoryName("Import*")
23853.   or DirectoryName("Log*")
23854.   or DirectoryName("*Log")
23855.   or DirectoryName("Maintenance*")
23856.   or DirectoryName("Rec*")
23857.   or DirectoryName("Sales*")
23858.   or DirectoryName("Search*")
23859.   or DirectoryName("User*")
23860. )
23861. # Data end.
23862. 
23863.     # BlobsAndExceptions
23864.   )
23865. ) )
23866. # BlobsAndExceptions end.
23867. 
23868. # Blobs
23869. ) and (
23870.   Size(BlobFileSize,0)
23871.   or (
23872.     FileName("*.arj")
23873.     or FileName("*.bup")
23874.     or FileName("*.bz2")
23875.     or FileName("*.chm")
23876.     or FileName("*.dvr-ms")
23877.     or FileName("*.gz")
23878.     or FileName("*.ifo")
23879.     or FileName("*.lzh")
23880.     or FileName("*.pdf")
23881.     or FileName("*.rpm")
23882.     or FileName("*.wmv")
23883.     or FileName("*.vob")
23884.     or FileName("*.z")
23885.   ) 
23886. )
23887. # Blobs end.
23888. 
23889. # NotBlobsArchivesBu
23890. or 
23891. # Archives start.
23892. (
23893.   DirectoryName("*Archive*")
23894.   or DirectoryName("*History*")
23895.   or DirectoryName("*Old")
23896.   or DirectoryName("* Old *")
23897.   or DirectoryName("Old *")
23898. 
23899.   or FileName("*.7z")
23900.   or FileName("*.cab")
23901.   or FileName("*.iso")
23902.   or FileName("*.msi")
23903.   or FileName("*.old")
23904.   or FileName("*.rar")
23905.   or FileName("*.tar")
23906.   or FileName("*.zip")
23907.   or
23908. # WinSysLow start.
23909. (
23910.   # Bad idea. This pushed lots of programs and data to archive.
23911.   # DirectoryName("$*")
23912.   # or DirectoryName("0*")
23913.   # or DirectoryName("1*")
23914.   # or DirectoryName("2*")
23915.   # or DirectoryName("3*")
23916.   # or DirectoryName("4*")
23917.   # or DirectoryName("5*")
23918.   # or DirectoryName("6*")
23919.   # or DirectoryName("7*")
23920.   # or DirectoryName("8*")
23921.   # or DirectoryName("9*")
23922.   # or 
23923.   DirectoryName("dllcache")
23924.   or DirectoryName("Downloaded Installations")
23925.   or DirectoryName("Ehome")
23926.   or DirectoryName("Fonts")
23927.   or DirectoryName("Help")
23928.   or DirectoryName("I386")
23929.   or DirectoryName("ie?updates")
23930.   or DirectoryName("Installer")
23931.   or DirectoryName("Installshield Installation Information")
23932.   or DirectoryName("IME")
23933.   or DirectoryName("*RECYCLE*")
23934.   or DirectoryName("ServicePackFiles")
23935.   or DirectoryName("SoftwareDistribution")
23936.   or DirectoryName("Speech")
23937.   or DirectoryName("Symbols")
23938.   or DirectoryName("System Volume Information")
23939.   or DirectoryName("windows.old")
23940. )
23941. # WinSysLow end.
23942. 
23943.   # Archives
23944. )
23945. # Archives end.
23946. 
23947. # NotBlobsArchivesBu
23948. or
23949. # Backups start.
23950. (
23951.   DirectoryName("*Backup*")
23952.   or DirectoryName("*Bu")
23953.   or DirectoryName("* Bu *")
23954.   or DirectoryName("Bu *")
23955. 
23956.   or FileName("*.bak")
23957.   or FileName("* - Copy*")
23958. )
23959. # Backups end.
23960. 
23961. or 
23962. FileName("ReferenceMarker.MyDx")
23963. # NotBlobsArchivesBu
23964. ) )
23965. # NotBlobsArchivesBu end.
23966. 
23967. # People
23968. and (
23969. # Games start.
23970. (
23971.   DirectoryName("Game*")
23972.   or DirectoryName("Epic*")
23973.   or DirectoryName("*XBox*")
23974.   or DirectoryName("*PS2*")
23975. )
23976. # Games end.
23977. 
23978. # People
23979. )
23980. # People end.
23981. 
23982. ')
23983. 
23984. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
23985. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
23986. 
23987. SetVariable(ZoneStepNoCurrent, 0)
23988. 
23989. 	/* ------------------------- */
23990. # Script: ZoneDoHeader
23991. 
23992. # Script: ZoneWhenStarted
23993. RunProgram("..\Commands\WriteDateTime.bat")
23994. 
23995. # Script: ZoneDoCurrentClear
23996. 
23997. SetVariable(ZoneTypeSelectCurrent, 		"")
23998. SetVariable(ZoneStatisticsData, 		"")
23999. SetVariable(ZoneStepByLine, 			"")
24000. 
24001. SetVariable(ZoneBeginCurrent, 			0)
24002. SetVariable(ZoneBeginPerCurrent, 		0)
24003. SetVariable(ZoneEndCurrent, 			0)
24004. SetVariable(ZoneEndPerCurrent, 			0)
24005. 
24006. SetVariable(ZoneSizeCurrent,			0)
24007. SetVariable(ZoneSizePerCurrent,			0)
24008. 
24009. SetVariable(ZoneGapRequestedCurrent,	0)
24010. SetVariable(ZoneGapRoundedCurrent, 		0)
24011. SetVariable(ZoneGapAdjustedCurrent, 	0)
24012. SetVariable(ZoneGapAvailableCurrent, 	0)
24013. SetVariable(ZoneGapCurrent,				0)
24014. SetVariable(ZoneGapUsedCurrent, 		0)
24015. 
24016. SetVariable(ZoneGapActualCurrent, 		0)
24017. SetVariable(ZoneGapActualPerCurrent, 	0)
24018. 
24019. SetVariable(ZoneSizeActual, 			0)
24020. SetVariable(ZoneSizeActualCurrent,		0)
24021. 
24022. SetVariable(ZoneEndActual, 				0)
24023. SetVariable(ZoneEndActualCurrent,		0)			
24024. SetVariable(ZoneSizeActualPerCurrent, 	0)
24025.       
24026. SetVariable(ZoneFilesFolders,			0)
24027. SetVariable(ZoneFilesFoldersPer,		0) 
24028. 
24029. SetVariable(ZoneFragments,				0)
24030. SetVariable(ZoneFragmentsPer,			0) 
24031. 		
24032. SetVariable(ZoneEndActualCurrent, 		0)
24033. SetVariable(ZoneEndActualPerCurrent, 	0)
24034. 
24035. # Gap Calculation Methodology:
24036. 	# Requested
24037. 	SetVariable(GapRequested, 			0) 
24038. 	SetVariable(GapRequestedStd, 		0) 
24039. 	SetVariable(GapRequestedMft, 		0) 
24040. 	SetVariable(GapRequestedOs, 		0) 
24041. 	SetVariable(GapRequestedOriginal, 	0) 
24042. 	
24043. 	# Gap Adjustments
24044. 	SetVariable(GapRounded, 			0)
24045. 	# SetVariable(GapAdjusted, 			0)
24046. 	SetVariable(GapAvailable, 			0)
24047. 	SetVariable(GapCurrent, 			0)
24048. 	SetVariable(GapActual, 				0)
24049. 	SetVariable(GapUsed, 				0)
24050. 	
24051. 	# Gap Adjustments
24052. 	SetVariable(GapRoundedLoc, 			0)
24053. 	# SetVariable(GapAdjustedLoc, 		0)
24054. 	SetVariable(GapAvailableLoc, 		0)
24055. 	SetVariable(GapCurrentLoc, 			0)
24056. 	SetVariable(GapActualLoc,			0)
24057. 	SetVariable(GapUsedLoc,				0)
24058. 	
24059. 	# Space usage
24060. 	SetVariable(ZoneFreePerRequested, 	0)
24061. 	SetVariable(ZoneFreePerUsed, 		0)
24062. 
24063. # Gap Size & Rounding
24064. 	SetVariable(ZoneGapSizePer, 		0)
24065. 	SetVariable(ZoneVolRoundUpPer, 		0)
24066. 	
24067. 	# Free Space
24068. 	SetVariable(ZoneFreeUsedPer, 		0)
24069. 	SetVariable(ZoneFreeRequestedPer, 	0)
24070. 
24071. # Script: DisplaySetZone
24072. 
24073. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
24074. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
24075. 
24076. # Message ZoneSummary
24077. # SetVariable(ZoneSummary, '
24078. # Zone Summary:
24079. # ')
24080. # Zone processing steps
24081. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
24082. # ')
24083. 
24084. # # Script: BannerDescriptionSet
24085. 
24086. # Script: BannerSet
24087. 
24088. # NOTE: Can't round or truncate to integer precision. 
24089. # This internal fields like ZoneCount format really badly.
24090. #  for !RunTimeNow! does not work. None of the date functions do.
24091. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
24092. 
24093. SetVariable(HeadingTemp2,	ZoneCount + 0)
24094. 
24095. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24096. 
24097. Title('!Heading!')
24098. 
24099. /* pause(1) */
24100. 
24101. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24102. 
24103. 
24104. # Script: BannerLog
24105. 
24106. AppendLogfile("!LogFileName!", "!Heading!")
24107. 
24108. 
24109. 
24110. # pause(1)
24111. 
24112. 
24113. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
24114. # Script: DisplaySetZoneStep
24115. # Increment
24116. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24117. 
24118. # Display this zone step
24119. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
24120. ')
24121. 
24122. # Script: BannerSet
24123. 
24124. # NOTE: Can't round or truncate to integer precision. 
24125. # This internal fields like ZoneCount format really badly.
24126. #  for !RunTimeNow! does not work. None of the date functions do.
24127. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
24128. 
24129. SetVariable(HeadingTemp2,	ZoneCount + 0)
24130. 
24131. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24132. 
24133. Title('!Heading!')
24134. 
24135. /* pause(1) */
24136. 
24137. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24138. 
24139. 
24140. # Script: DisplaySetWindowText
24141. # Zone Footer Set Statistics Window Text
24142. 
24143. SetStatisticsWindowText("!Heading!
24144. ----------------------------------------------------------
24145. Zones Processed: 
24146. ----------------------------------------------------------
24147. !ZoneListByLine!
24148. ----------------------------------------------------------
24149. Zone Processing Step:
24150. !ZoneStepByLine!    
24151. ----------------------------------------------------------
24152. ----------------------------------------------------------
24153. CURRENT ZONE:
24154. !ZoneStatisticsReport!
24155. ----------------------------------------------------------
24156. ----------------------------------------------------------
24157. ----------------------------------------------------------
24158. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
24159. ----------------------------------------------------------
24160. !VolumeStatisticsSummary!
24161. !VolumeStatisticsDetail!
24162. ----------------------------------------------------------
24163. ----------------------------------------------------------
24164. Zone Detailed Report:
24165. ----------------------------------------------------------
24166. !ZoneStatisticsDetail!
24167. ----------------------------------------------------------
24168. ")
24169. 
24170. 
24171. 
24172. 
24173. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
24174. 
24175. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
24176. # Script: DisplaySetZoneStep
24177. # Increment
24178. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24179. 
24180. # Display this zone step
24181. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
24182. ')
24183. 
24184. # Script: BannerSet
24185. 
24186. # NOTE: Can't round or truncate to integer precision. 
24187. # This internal fields like ZoneCount format really badly.
24188. #  for !RunTimeNow! does not work. None of the date functions do.
24189. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
24190. 
24191. SetVariable(HeadingTemp2,	ZoneCount + 0)
24192. 
24193. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24194. 
24195. Title('!Heading!')
24196. 
24197. /* pause(1) */
24198. 
24199. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24200. 
24201. 
24202. # Script: DisplaySetWindowText
24203. # Zone Footer Set Statistics Window Text
24204. 
24205. SetStatisticsWindowText("!Heading!
24206. ----------------------------------------------------------
24207. Zones Processed: 
24208. ----------------------------------------------------------
24209. !ZoneListByLine!
24210. ----------------------------------------------------------
24211. Zone Processing Step:
24212. !ZoneStepByLine!    
24213. ----------------------------------------------------------
24214. ----------------------------------------------------------
24215. CURRENT ZONE:
24216. !ZoneStatisticsReport!
24217. ----------------------------------------------------------
24218. ----------------------------------------------------------
24219. ----------------------------------------------------------
24220. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
24221. ----------------------------------------------------------
24222. !VolumeStatisticsSummary!
24223. !VolumeStatisticsDetail!
24224. ----------------------------------------------------------
24225. ----------------------------------------------------------
24226. Zone Detailed Report:
24227. ----------------------------------------------------------
24228. !ZoneStatisticsDetail!
24229. ----------------------------------------------------------
24230. ")
24231. 
24232. 
24233. 
24234. 
24235. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
24236. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
24237. 
24238. # Script: BannerSet
24239. 
24240. # NOTE: Can't round or truncate to integer precision. 
24241. # This internal fields like ZoneCount format really badly.
24242. #  for !RunTimeNow! does not work. None of the date functions do.
24243. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
24244. 
24245. SetVariable(HeadingTemp2,	ZoneCount + 0)
24246. 
24247. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24248. 
24249. Title('!Heading!')
24250. 
24251. /* pause(1) */
24252. 
24253. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24254. 
24255. 
24256. # Script: BannerLog
24257. 
24258. AppendLogfile("!LogFileName!", "!Heading!")
24259. 
24260. 
24261. 
24262. # LOGGING:
24263. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
24264. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
24265. 
24266. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
24267. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:01")
24268. # 2021-12-14 15:30:01 
24269. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:06 !ZoneLabel! !ZoneDescription!")
24270. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
24271. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:06 !ZoneLabel! !ZoneDescription!")
24272. 
24273. 
24274. # Add zone to list of zones:
24275. SetVariable(ZoneListByLine, "!ZoneListByLine!
24276. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
24277. # Script: DisplaySetWindowText
24278. # Zone Footer Set Statistics Window Text
24279. 
24280. SetStatisticsWindowText("!Heading!
24281. ----------------------------------------------------------
24282. Zones Processed: 
24283. ----------------------------------------------------------
24284. !ZoneListByLine!
24285. ----------------------------------------------------------
24286. Zone Processing Step:
24287. !ZoneStepByLine!    
24288. ----------------------------------------------------------
24289. ----------------------------------------------------------
24290. CURRENT ZONE:
24291. !ZoneStatisticsReport!
24292. ----------------------------------------------------------
24293. ----------------------------------------------------------
24294. ----------------------------------------------------------
24295. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
24296. ----------------------------------------------------------
24297. !VolumeStatisticsSummary!
24298. !VolumeStatisticsDetail!
24299. ----------------------------------------------------------
24300. ----------------------------------------------------------
24301. Zone Detailed Report:
24302. ----------------------------------------------------------
24303. !ZoneStatisticsDetail!
24304. ----------------------------------------------------------
24305. ")
24306. 
24307. 
24308. 
24309. 
24310. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
24311. # Script: DisplaySetZoneStep
24312. # Increment
24313. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24314. 
24315. # Display this zone step
24316. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
24317. ')
24318. 
24319. # Script: BannerSet
24320. 
24321. # NOTE: Can't round or truncate to integer precision. 
24322. # This internal fields like ZoneCount format really badly.
24323. #  for !RunTimeNow! does not work. None of the date functions do.
24324. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
24325. 
24326. SetVariable(HeadingTemp2,	ZoneCount + 0)
24327. 
24328. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24329. 
24330. Title('!Heading!')
24331. 
24332. /* pause(1) */
24333. 
24334. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24335. 
24336. 
24337. # Script: DisplaySetWindowText
24338. # Zone Footer Set Statistics Window Text
24339. 
24340. SetStatisticsWindowText("!Heading!
24341. ----------------------------------------------------------
24342. Zones Processed: 
24343. ----------------------------------------------------------
24344. !ZoneListByLine!
24345. ----------------------------------------------------------
24346. Zone Processing Step:
24347. !ZoneStepByLine!    
24348. ----------------------------------------------------------
24349. ----------------------------------------------------------
24350. CURRENT ZONE:
24351. !ZoneStatisticsReport!
24352. ----------------------------------------------------------
24353. ----------------------------------------------------------
24354. ----------------------------------------------------------
24355. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
24356. ----------------------------------------------------------
24357. !VolumeStatisticsSummary!
24358. !VolumeStatisticsDetail!
24359. ----------------------------------------------------------
24360. ----------------------------------------------------------
24361. Zone Detailed Report:
24362. ----------------------------------------------------------
24363. !ZoneStatisticsDetail!
24364. ----------------------------------------------------------
24365. ")
24366. 
24367. 
24368. 
24369. 
24370. # your stuff HERE (X)... pre file select code.
24371. 
24372. /* --------------------------------- */
24373. 	FileSelect
24374. 
24375. 		# your stuff can't really go here (errors.)
24376. 		# maybe for some reason I don't know of...
24377. 	
24378. 		# Actions next...
24379. 	# Script: ZoneDo ZoneTypeSelectGames
24380. # Games start.
24381. # NotBlobsArchivesBu start.
24382. # NOT!
24383. (not (
24384. # Blobs start.
24385. (
24386. # BlobsAndExceptions start.
24387. ( not(
24388.   FileName("*.bat")
24389.   or FileName("*.css")
24390.   or FileName("*.dll")
24391.   or FileName("*.exe")
24392.   or FileName("*.htm*")
24393.   or FileName("*.jar")
24394.   or FileName("*.js")
24395.   or FileName("*.script")
24396.   or FileName("*.wsf")
24397.   or (
24398. # Databases start.
24399. (
24400.   FileName("*.crypt*")
24401.   or FileName("*.db*")
24402.   or FileName("*.rdb*")
24403.   or FileName("*.dc*")
24404.   or FileName("*.dict*")
24405.   or FileName("*.?db*")
24406.   or FileName("*.?rdb*")
24407.   or FileName("*.md*")
24408.   or FileName("*.myd")
24409.   or FileName("*.ndf")
24410.   or FileName("*.ns?")
24411.   or FileName("*.pab")
24412.   or FileName("*.pst")
24413.   or FileName("*.sd?*")
24414.   or FileName("*.sq**")
24415.   or FileName("*.tmd")
24416.   or FileName("*.tps")
24417.   or FileName("*.tr*")
24418. )
24419. # Databases end.
24420. 
24421.     # BlobsAndExceptions
24422.     or 
24423. # Data start.
24424. (
24425.   DirectoryName("Data*")
24426.   or DirectoryName("Device*")
24427.   or DirectoryName("Export*")
24428.   or DirectoryName("Import*")
24429.   or DirectoryName("Log*")
24430.   or DirectoryName("*Log")
24431.   or DirectoryName("Maintenance*")
24432.   or DirectoryName("Rec*")
24433.   or DirectoryName("Sales*")
24434.   or DirectoryName("Search*")
24435.   or DirectoryName("User*")
24436. )
24437. # Data end.
24438. 
24439.     # BlobsAndExceptions
24440.   )
24441. ) )
24442. # BlobsAndExceptions end.
24443. 
24444. # Blobs
24445. ) and (
24446.   Size(BlobFileSize,0)
24447.   or (
24448.     FileName("*.arj")
24449.     or FileName("*.bup")
24450.     or FileName("*.bz2")
24451.     or FileName("*.chm")
24452.     or FileName("*.dvr-ms")
24453.     or FileName("*.gz")
24454.     or FileName("*.ifo")
24455.     or FileName("*.lzh")
24456.     or FileName("*.pdf")
24457.     or FileName("*.rpm")
24458.     or FileName("*.wmv")
24459.     or FileName("*.vob")
24460.     or FileName("*.z")
24461.   ) 
24462. )
24463. # Blobs end.
24464. 
24465. # NotBlobsArchivesBu
24466. or 
24467. # Archives start.
24468. (
24469.   DirectoryName("*Archive*")
24470.   or DirectoryName("*History*")
24471.   or DirectoryName("*Old")
24472.   or DirectoryName("* Old *")
24473.   or DirectoryName("Old *")
24474. 
24475.   or FileName("*.7z")
24476.   or FileName("*.cab")
24477.   or FileName("*.iso")
24478.   or FileName("*.msi")
24479.   or FileName("*.old")
24480.   or FileName("*.rar")
24481.   or FileName("*.tar")
24482.   or FileName("*.zip")
24483.   or
24484. # WinSysLow start.
24485. (
24486.   # Bad idea. This pushed lots of programs and data to archive.
24487.   # DirectoryName("$*")
24488.   # or DirectoryName("0*")
24489.   # or DirectoryName("1*")
24490.   # or DirectoryName("2*")
24491.   # or DirectoryName("3*")
24492.   # or DirectoryName("4*")
24493.   # or DirectoryName("5*")
24494.   # or DirectoryName("6*")
24495.   # or DirectoryName("7*")
24496.   # or DirectoryName("8*")
24497.   # or DirectoryName("9*")
24498.   # or 
24499.   DirectoryName("dllcache")
24500.   or DirectoryName("Downloaded Installations")
24501.   or DirectoryName("Ehome")
24502.   or DirectoryName("Fonts")
24503.   or DirectoryName("Help")
24504.   or DirectoryName("I386")
24505.   or DirectoryName("ie?updates")
24506.   or DirectoryName("Installer")
24507.   or DirectoryName("Installshield Installation Information")
24508.   or DirectoryName("IME")
24509.   or DirectoryName("*RECYCLE*")
24510.   or DirectoryName("ServicePackFiles")
24511.   or DirectoryName("SoftwareDistribution")
24512.   or DirectoryName("Speech")
24513.   or DirectoryName("Symbols")
24514.   or DirectoryName("System Volume Information")
24515.   or DirectoryName("windows.old")
24516. )
24517. # WinSysLow end.
24518. 
24519.   # Archives
24520. )
24521. # Archives end.
24522. 
24523. # NotBlobsArchivesBu
24524. or
24525. # Backups start.
24526. (
24527.   DirectoryName("*Backup*")
24528.   or DirectoryName("*Bu")
24529.   or DirectoryName("* Bu *")
24530.   or DirectoryName("Bu *")
24531. 
24532.   or FileName("*.bak")
24533.   or FileName("* - Copy*")
24534. )
24535. # Backups end.
24536. 
24537. or 
24538. FileName("ReferenceMarker.MyDx")
24539. # NotBlobsArchivesBu
24540. ) )
24541. # NotBlobsArchivesBu end.
24542. 
24543. # People
24544. and (
24545. # Games start.
24546. (
24547.   DirectoryName("Game*")
24548.   or DirectoryName("Epic*")
24549.   or DirectoryName("*XBox*")
24550.   or DirectoryName("*PS2*")
24551. )
24552. # Games end.
24553. 
24554. # People
24555. )
24556. # People end.
24557. 
24558. 	# Script: ZoneDoAction
24559. # Zone Do File Action - SortByName.
24560. 
24561. 	FileActions
24562. 
24563. 			# Script: GapZoneCalc
24564. 	# Gap
24565. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
24566. 		# Script: DisplaySetZoneStep
24567. # Increment
24568. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24569. 
24570. # Display this zone step
24571. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
24572. ')
24573. 
24574. # Script: BannerSet
24575. 
24576. # NOTE: Can't round or truncate to integer precision. 
24577. # This internal fields like ZoneCount format really badly.
24578. #  for !RunTimeNow! does not work. None of the date functions do.
24579. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
24580. 
24581. SetVariable(HeadingTemp2,	ZoneCount + 0)
24582. 
24583. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24584. 
24585. Title('!Heading!')
24586. 
24587. /* pause(1) */
24588. 
24589. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
24590. 
24591. 
24592. # Script: DisplaySetWindowText
24593. # Zone Footer Set Statistics Window Text
24594. 
24595. SetStatisticsWindowText("!Heading!
24596. ----------------------------------------------------------
24597. Zones Processed: 
24598. ----------------------------------------------------------
24599. !ZoneListByLine!
24600. ----------------------------------------------------------
24601. Zone Processing Step:
24602. !ZoneStepByLine!    
24603. ----------------------------------------------------------
24604. ----------------------------------------------------------
24605. CURRENT ZONE:
24606. !ZoneStatisticsReport!
24607. ----------------------------------------------------------
24608. ----------------------------------------------------------
24609. ----------------------------------------------------------
24610. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
24611. ----------------------------------------------------------
24612. !VolumeStatisticsSummary!
24613. !VolumeStatisticsDetail!
24614. ----------------------------------------------------------
24615. ----------------------------------------------------------
24616. Zone Detailed Report:
24617. ----------------------------------------------------------
24618. !ZoneStatisticsDetail!
24619. ----------------------------------------------------------
24620. ")
24621. 
24622. 
24623. 
24624. 	
24625. 	# ACTUAL GAP
24626. 		/* AddGap Variant. */
24627. 	  	# Script: GapZoneSet
24628. # Zone Do Gap
24629. # Gap Calculation Methods:
24630. 
24631. /* 1) Anything you need to add first. */
24632. /* empty */
24633. 
24634. /* ------------------------- */
24635. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
24636. 	# GapRequestedStd.
24637. 
24638. 		/* ------------------------- */
24639. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
24640. 
24641. 		# Gap Calculation Methods:
24642. 
24643. /* AddGap Variants */
24644. 
24645. 	/* Standard */
24646. 		# Gap Calculation Methods:
24647. 	/* AddGap Variants */
24648. 	/* Standard */
24649. 
24650. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
24651. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
24652. 
24653. 	SetVariable(GapRequested, GapRequestedStd)
24654. 	
24655. 
24656. 	/* MFT Low High Method */
24657. 		# Gap Calculation Methods:
24658. 	/* AddGap Variants */
24659. 	/* MFT Low High Method */
24660. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
24661. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
24662. 	SetVariable(GapRequested, GapRequestedMft)
24663. 	
24664. 
24665. 	/* OS Volume Type Method */
24666. 		# Gap Calculation Methods:
24667. 	/* AddGap Variants */
24668. 	/* OS Volume Type Method */
24669. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
24670. 	SetVariable(GapRequested, GapRequestedOs)
24671. 
24672. 
24673. 
24674. /* MakeGap Variants */
24675. 
24676. 	/* Original Os 1-3 + MFT 2 */
24677. 		# Gap Calculation Methods:
24678. 	/* MakeGap Variants */
24679. 	/* Original Os 1-3 + MFT 2 */
24680. 	/* plus MFT gap placed inline at the dividing zone. */
24681. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
24682. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
24683. 	SetVariable(GapRequested, GapRequestedOrig)
24684. 	
24685. 	
24686. /* Note: You could comment out the ones not in use */
24687. /* However having the data in the log is useful. */
24688. /* Therefore the following line is otherwise needed. */
24689. 
24690. /* Standard used */
24691. 
24692. SetVariable(GapRequested, GapRequestedStd)
24693. 
24694. # Gap Calculation Methods:
24695. 
24696. /* AddGap Variants */
24697. 	/* Standard */
24698. 	/* MFT Low High Method */
24699. 	/* OS Volume Type Method */
24700. 
24701. /* MakeGap Variants */
24702. 	/* Original Os 1-3 + MFT 2 */
24703. 
24704. /* Note: You could comment out the ones not in use */
24705. /* However having the data in the log is useful. */
24706. /* Therefore the following line is otherwise needed. */
24707. 
24708. /* Standard is used currently */
24709. 
24710. 
24711. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
24712. 
24713. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
24714. 
24715. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
24716. 
24717. /* ------------------------- */
24718. /* 3) SMALL ZONE ADJUSTMENT. */
24719. /* Gab cant be larger than half the Zone Size. */
24720. 
24721. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
24722. 	
24723. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
24724. 
24725. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
24726. 
24727. /* ------------------------- */
24728. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
24729. # Gap Adjustments.
24730. 
24731. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
24732. 	
24733. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
24734. 
24735. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
24736. 
24737. /* ------------------------- */
24738. # BYPASS THIS.
24739. 	/* This is definitely wrong. */
24740. 	/* The question is can we steal gap from the next zone */
24741. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
24742. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
24743. 		# Zone Overflow.
24744. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
24745. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
24746. 
24747. /* ------------------------- */
24748. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
24749. # Remaining free space available.
24750. 
24751. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
24752. 	
24753. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
24754. 
24755. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
24756. 
24757. /* ------------------------- */
24758. # CURRENT gap to use.
24759. 
24760. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
24761. 
24762. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
24763. 
24764. /* ------------------------- */
24765. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
24766. # Debugging.
24767. 
24768. 	SetVariable(GapUsed, GapCurrent) // for debugging
24769. 
24770. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
24771. 
24772. 		# Your code HERE
24773. 
24774. /* ------------------------- */
24775. /* 7) YOUR CODE. */
24776. # YOUR CODE HERE:
24777. 	# INPUT: GapCurrent or GapCurrentLoc
24778. 	# OUTPUT: GapUsed...
24779. 
24780. /* ------------------------- */
24781. # Gap Size.
24782. # Actual Size of Gap.
24783. 
24784. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
24785. 
24786. /* ------------------------- */
24787. 
24788. 	
24789. 	# Zone Statistics	
24790. 		# Script: ZoneStatisticsGet
24791. # Zone / Volume Statistics and Display
24792. 		
24793. 	# Accumulate Totals
24794.   	# Script: ZoneDoVolumeTotals
24795. 
24796. /* Current total space used (by Zones and Gaps) */
24797. 
24798. SetVariable(VolumeZoneUsed, GapUsed)
24799. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
24800. /* Percentage */
24801. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
24802. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
24803. 
24804. /* Current total of free space requested */
24805. 
24806. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
24807. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
24808. /* Percent. */
24809. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
24810. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
24811. 
24812. /* Current total of free space used */
24813. 
24814. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
24815. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
24816. /* Percent */
24817. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
24818. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
24819. 
24820. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
24821. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
24822. # Xinclude "..\DebugDisplayPause.MyDc"X
24823. 
24824. 
24825. 	# Current Values
24826. 	# Script: ZoneDoCurrentSet
24827. 
24828. # Cluster, Sector, Block adjust for display.
24829. 	# Bytes per cluster is volume specific.
24830. 
24831. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
24832. 
24833. # Current Zone values.
24834. 	# Begin, end and size.
24835. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
24836. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
24837. 
24838. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
24839. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
24840. 
24841. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
24842. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
24843. 
24844. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
24845. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
24846. 
24847. 	SetVariable(ZoneFragments,				"!ZONE210N!")
24848. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
24849. 		
24850. # Current Gap, Actual and Free Values
24851. 	# Gap
24852. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
24853. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
24854. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
24855. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
24856. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
24857. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
24858. 	
24859. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
24860. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
24861. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
24862. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
24863. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
24864. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
24865. 	
24866. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
24867. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
24868. 	
24869. 	# Actual Size and End
24870. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
24871. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
24872. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
24873. 	
24874. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
24875. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
24876. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
24877. 
24878. # Gap Size & Rounding
24879. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
24880. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
24881. 	
24882. 	# Free Space
24883. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
24884. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
24885. 
24886. 	# Script: ZoneStatisticsReportGet
24887. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
24888. 
24889. # Footer:
24890. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
24891. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
24892. #
24893. # Xinclude "..\Commands\DateTimeLastLong.txt"X
24894. #
24895. # What a mess this word based vs is. Try a phrase based version ToDo
24896. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
24897. ------------------
24898.    !SizeWord!!ColonWord!  
24899.    ------------------------
24900.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24901.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24902.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24903. 
24904.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24905.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
24906. 
24907.    !LocationWord!!ColonWord!
24908.    ------------------------
24909.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24910.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
24911.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24912.       
24913.    !GapWordCaps! !SettingsWord!!ColonWord!
24914.    ------------------------
24915.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
24916.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
24917.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24918.                  
24919.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
24920.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
24921.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
24922.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
24923.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
24924.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
24925.      
24926.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
24927.    ------------------------
24928.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24929.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24930.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24931. 
24932. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
24933. ----------------------------------------------------------
24934. ")
24935. #
24936. SetVariable(DateNow, 	DATETIME)
24937. SetVariable(TimeNow, 	Time)
24938. SetVariable(RunTimeNow, 	RunTime)
24939. 
24940. 
24941. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
24942. 
24943. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
24944. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
24945. 
24946. 	# Script: DisplaySetWindowText
24947. # Zone Footer Set Statistics Window Text
24948. 
24949. SetStatisticsWindowText("!Heading!
24950. ----------------------------------------------------------
24951. Zones Processed: 
24952. ----------------------------------------------------------
24953. !ZoneListByLine!
24954. ----------------------------------------------------------
24955. Zone Processing Step:
24956. !ZoneStepByLine!    
24957. ----------------------------------------------------------
24958. ----------------------------------------------------------
24959. CURRENT ZONE:
24960. !ZoneStatisticsReport!
24961. ----------------------------------------------------------
24962. ----------------------------------------------------------
24963. ----------------------------------------------------------
24964. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
24965. ----------------------------------------------------------
24966. !VolumeStatisticsSummary!
24967. !VolumeStatisticsDetail!
24968. ----------------------------------------------------------
24969. ----------------------------------------------------------
24970. Zone Detailed Report:
24971. ----------------------------------------------------------
24972. !ZoneStatisticsDetail!
24973. ----------------------------------------------------------
24974. ")
24975. 
24976. 
24977. 	
24978. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
24979. 
24980. 
24981. 	SetVariable(ZoneStatisticsData, 
24982. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
24983.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
24984.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
24985. 
24986. 
24987. 
24988.  		# Script: ZoneStatisticsDisplay
24989. 	
24990. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
24991. !ZoneStatisticsData!
24992. ')
24993. 
24994. 		# Script: ZoneStatisticsAdd
24995. # Append Zone to Details of each zone.
24996. 		
24997. 	# Add Zone Details to Report.	
24998. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
24999. !ZoneStatisticsReport!
25000. ')
25001. 
25002. 	
25003. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
25004. 		# Script: DisplaySetZoneStep
25005. # Increment
25006. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25007. 
25008. # Display this zone step
25009. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
25010. ')
25011. 
25012. # Script: BannerSet
25013. 
25014. # NOTE: Can't round or truncate to integer precision. 
25015. # This internal fields like ZoneCount format really badly.
25016. #  for !RunTimeNow! does not work. None of the date functions do.
25017. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25018. 
25019. SetVariable(HeadingTemp2,	ZoneCount + 0)
25020. 
25021. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25022. 
25023. Title('!Heading!')
25024. 
25025. /* pause(1) */
25026. 
25027. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25028. 
25029. 
25030. # Script: DisplaySetWindowText
25031. # Zone Footer Set Statistics Window Text
25032. 
25033. SetStatisticsWindowText("!Heading!
25034. ----------------------------------------------------------
25035. Zones Processed: 
25036. ----------------------------------------------------------
25037. !ZoneListByLine!
25038. ----------------------------------------------------------
25039. Zone Processing Step:
25040. !ZoneStepByLine!    
25041. ----------------------------------------------------------
25042. ----------------------------------------------------------
25043. CURRENT ZONE:
25044. !ZoneStatisticsReport!
25045. ----------------------------------------------------------
25046. ----------------------------------------------------------
25047. ----------------------------------------------------------
25048. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
25049. ----------------------------------------------------------
25050. !VolumeStatisticsSummary!
25051. !VolumeStatisticsDetail!
25052. ----------------------------------------------------------
25053. ----------------------------------------------------------
25054. Zone Detailed Report:
25055. ----------------------------------------------------------
25056. !ZoneStatisticsDetail!
25057. ----------------------------------------------------------
25058. ")
25059. 
25060. 
25061. 
25062. 
25063. 		# File Action - All - Full -  SortByCreationDate
25064. # File Action - ZoneDoActionSortByCreationDateFull
25065. 	SortByCreationDate(Ascending)
25066. 	
25067. 
25068. 
25069. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
25070. 		# Script: DisplaySetZoneStep
25071. # Increment
25072. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25073. 
25074. # Display this zone step
25075. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
25076. ')
25077. 
25078. # Script: BannerSet
25079. 
25080. # NOTE: Can't round or truncate to integer precision. 
25081. # This internal fields like ZoneCount format really badly.
25082. #  for !RunTimeNow! does not work. None of the date functions do.
25083. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25084. 
25085. SetVariable(HeadingTemp2,	ZoneCount + 0)
25086. 
25087. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25088. 
25089. Title('!Heading!')
25090. 
25091. /* pause(1) */
25092. 
25093. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25094. 
25095. 
25096. # Script: DisplaySetWindowText
25097. # Zone Footer Set Statistics Window Text
25098. 
25099. SetStatisticsWindowText("!Heading!
25100. ----------------------------------------------------------
25101. Zones Processed: 
25102. ----------------------------------------------------------
25103. !ZoneListByLine!
25104. ----------------------------------------------------------
25105. Zone Processing Step:
25106. !ZoneStepByLine!    
25107. ----------------------------------------------------------
25108. ----------------------------------------------------------
25109. CURRENT ZONE:
25110. !ZoneStatisticsReport!
25111. ----------------------------------------------------------
25112. ----------------------------------------------------------
25113. ----------------------------------------------------------
25114. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
25115. ----------------------------------------------------------
25116. !VolumeStatisticsSummary!
25117. !VolumeStatisticsDetail!
25118. ----------------------------------------------------------
25119. ----------------------------------------------------------
25120. Zone Detailed Report:
25121. ----------------------------------------------------------
25122. !ZoneStatisticsDetail!
25123. ----------------------------------------------------------
25124. ")
25125. 
25126. 
25127. 
25128. 
25129. 	# Script: ZoneDoFooter
25130. 
25131. /* --------------------------------- */
25132. 	# File Select
25133. 		# Select Statments
25134. 	# File Actions 
25135. 		# Standard or OS File Actions.
25136. 		# Resume...
25137. 	
25138. 		# your stuff HERE (X)... post zone (file) file actions code.
25139. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
25140. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
25141. 			# (X)
25142. 		
25143. 			/* ??? Set window? */
25144. 	
25145. 		# ADD THE GAP
25146. 		# Script: GapZoneCommand
25147. # Vacate (good for diagnostics)
25148. # DoNotVacate - DO NOT Vacate (recommended)
25149. 
25150. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
25151. # Script: DisplaySetZoneStep
25152. # Increment
25153. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25154. 
25155. # Display this zone step
25156. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
25157. ')
25158. 
25159. # Script: BannerSet
25160. 
25161. # NOTE: Can't round or truncate to integer precision. 
25162. # This internal fields like ZoneCount format really badly.
25163. #  for !RunTimeNow! does not work. None of the date functions do.
25164. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25165. 
25166. SetVariable(HeadingTemp2,	ZoneCount + 0)
25167. 
25168. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25169. 
25170. Title('!Heading!')
25171. 
25172. /* pause(1) */
25173. 
25174. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25175. 
25176. 
25177. # Script: DisplaySetWindowText
25178. # Zone Footer Set Statistics Window Text
25179. 
25180. SetStatisticsWindowText("!Heading!
25181. ----------------------------------------------------------
25182. Zones Processed: 
25183. ----------------------------------------------------------
25184. !ZoneListByLine!
25185. ----------------------------------------------------------
25186. Zone Processing Step:
25187. !ZoneStepByLine!    
25188. ----------------------------------------------------------
25189. ----------------------------------------------------------
25190. CURRENT ZONE:
25191. !ZoneStatisticsReport!
25192. ----------------------------------------------------------
25193. ----------------------------------------------------------
25194. ----------------------------------------------------------
25195. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
25196. ----------------------------------------------------------
25197. !VolumeStatisticsSummary!
25198. !VolumeStatisticsDetail!
25199. ----------------------------------------------------------
25200. ----------------------------------------------------------
25201. Zone Detailed Report:
25202. ----------------------------------------------------------
25203. !ZoneStatisticsDetail!
25204. ----------------------------------------------------------
25205. ")
25206. 
25207. 
25208. 
25209. 
25210. # *** Moved to setting yours *** 
25211. # (to avoid doing it twice)
25212. # (ie the later wouldn't "overwrite" the former in the usual manner)
25213. 
25214. # Do one or the other:
25215. # DoNotVacate - DO NOT Vacate (recommended)
25216. 
25217. # Vacate
25218. /* AddGap(GapUsedLoc) */
25219. 
25220. # DO Not Vacate
25221. AddGap(GapUsedLoc, DoNotVacate) 
25222. 	
25223. 	
25224. 
25225. # Controlled via settings commands
25226. 
25227. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
25228. 
25229. # Vacate /* AddGap(GapUsed) */
25230. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
25231. 	
25232. 
25233. 		
25234. 	# 
25235. 	FileEnd
25236. /* --------------------------------- */
25237. # your stuff HERE (X)... post zone (file) code.
25238. 
25239. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
25240. # Script: DisplaySetZoneStep
25241. # Increment
25242. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25243. 
25244. # Display this zone step
25245. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
25246. ')
25247. 
25248. # Script: BannerSet
25249. 
25250. # NOTE: Can't round or truncate to integer precision. 
25251. # This internal fields like ZoneCount format really badly.
25252. #  for !RunTimeNow! does not work. None of the date functions do.
25253. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25254. 
25255. SetVariable(HeadingTemp2,	ZoneCount + 0)
25256. 
25257. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25258. 
25259. Title('!Heading!')
25260. 
25261. /* pause(1) */
25262. 
25263. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25264. 
25265. 
25266. # Script: DisplaySetWindowText
25267. # Zone Footer Set Statistics Window Text
25268. 
25269. SetStatisticsWindowText("!Heading!
25270. ----------------------------------------------------------
25271. Zones Processed: 
25272. ----------------------------------------------------------
25273. !ZoneListByLine!
25274. ----------------------------------------------------------
25275. Zone Processing Step:
25276. !ZoneStepByLine!    
25277. ----------------------------------------------------------
25278. ----------------------------------------------------------
25279. CURRENT ZONE:
25280. !ZoneStatisticsReport!
25281. ----------------------------------------------------------
25282. ----------------------------------------------------------
25283. ----------------------------------------------------------
25284. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
25285. ----------------------------------------------------------
25286. !VolumeStatisticsSummary!
25287. !VolumeStatisticsDetail!
25288. ----------------------------------------------------------
25289. ----------------------------------------------------------
25290. Zone Detailed Report:
25291. ----------------------------------------------------------
25292. !ZoneStatisticsDetail!
25293. ----------------------------------------------------------
25294. ")
25295. 
25296. 
25297. 
25298. 
25299. # Script: ZoneWhenFinished
25300. 
25301. # Add the zone to the zone details log:
25302. # This is temporarily disable until logging is fixed
25303. # It is performed during file action to preserve the correct (original) calculations.
25304. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
25305. 
25306. # Add the Select and ZoneSteps to the Zone
25307. # Script: ZoneStatisticsAdd
25308. # Append Zone to Details of each zone.
25309. 		
25310. 	# Add Zone Details to Report.	
25311. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
25312. ----------------------------------------------------------
25313. !ZoneStepByLine!
25314. ---------------------------
25315. !ZoneTypeSelectCurrent!               
25316. ---------------------------
25317. ----------------------------------------------------------
25318. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
25319. ----------------------------------------------------------
25320. ')
25321. 
25322. 
25323. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
25324. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
25325. # 2021-12-14 15:30:01
25326. RunProgram("..\Commands\WriteDateTime.bat LastZone")
25327. # Append Datetime to logs
25328. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
25329. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
25330. 
25331. AppendLogfile("!LogFileName!", "!PeriodWord!")
25332. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
25333. AppendLogfile("!LogFileName!", "!PeriodWord!")
25334. 
25335. # Script: DisplaySetWindowText
25336. # Zone Footer Set Statistics Window Text
25337. 
25338. SetStatisticsWindowText("!Heading!
25339. ----------------------------------------------------------
25340. Zones Processed: 
25341. ----------------------------------------------------------
25342. !ZoneListByLine!
25343. ----------------------------------------------------------
25344. Zone Processing Step:
25345. !ZoneStepByLine!    
25346. ----------------------------------------------------------
25347. ----------------------------------------------------------
25348. CURRENT ZONE:
25349. !ZoneStatisticsReport!
25350. ----------------------------------------------------------
25351. ----------------------------------------------------------
25352. ----------------------------------------------------------
25353. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
25354. ----------------------------------------------------------
25355. !VolumeStatisticsSummary!
25356. !VolumeStatisticsDetail!
25357. ----------------------------------------------------------
25358. ----------------------------------------------------------
25359. Zone Detailed Report:
25360. ----------------------------------------------------------
25361. !ZoneStatisticsDetail!
25362. ----------------------------------------------------------
25363. ")
25364. 
25365. 
25366. 
25367. /* pause() */
25368. /* pause() */
25369. 
25370. 
25371. 
25372. /* ------------------------- */
25373. 
25374. 
25375. /* ------------------------- */
25376. 
25377. /* ------------------------- */
25378. /* 8 Zone 16 Shares */
25379. # Script: DisplayColors - Zone Dark
25380. # Processed
25381. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
25382. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
25383. 
25384. # Light Green and Yellow
25385. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
25386. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
25387. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
25388. 
25389. # Script: DefragZoneTypeShares
25390. /* ------------------------- */
25391. /* Zone Shares */
25392. SetVariable(ZoneLabel,			"!ZoneLabelShares!")
25393. SetVariable(ZoneDescription,		"!ZoneDescriptionShares!")
25394. SetVariable(ZoneVolRoundUp,			"!ZoneVolRoundUpShares!")
25395. SetVariable(ZoneGapSize,			 "!ZoneGapSizeShares!")
25396. 
25397. SetVariable(ZoneTypeSelect,'
25398. Shares:
25399. # Script: ZoneDo ZoneTypeSelectShares
25400. # Shares start.
25401. # NotBlobsArchivesBu start.
25402. # NOT!
25403. (not (
25404. # Blobs start.
25405. (
25406. # BlobsAndExceptions start.
25407. ( not(
25408.   FileName("*.bat")
25409.   or FileName("*.css")
25410.   or FileName("*.dll")
25411.   or FileName("*.exe")
25412.   or FileName("*.htm*")
25413.   or FileName("*.jar")
25414.   or FileName("*.js")
25415.   or FileName("*.script")
25416.   or FileName("*.wsf")
25417.   or (
25418. # Databases start.
25419. (
25420.   FileName("*.crypt*")
25421.   or FileName("*.db*")
25422.   or FileName("*.rdb*")
25423.   or FileName("*.dc*")
25424.   or FileName("*.dict*")
25425.   or FileName("*.?db*")
25426.   or FileName("*.?rdb*")
25427.   or FileName("*.md*")
25428.   or FileName("*.myd")
25429.   or FileName("*.ndf")
25430.   or FileName("*.ns?")
25431.   or FileName("*.pab")
25432.   or FileName("*.pst")
25433.   or FileName("*.sd?*")
25434.   or FileName("*.sq**")
25435.   or FileName("*.tmd")
25436.   or FileName("*.tps")
25437.   or FileName("*.tr*")
25438. )
25439. # Databases end.
25440. 
25441.     # BlobsAndExceptions
25442.     or 
25443. # Data start.
25444. (
25445.   DirectoryName("Data*")
25446.   or DirectoryName("Device*")
25447.   or DirectoryName("Export*")
25448.   or DirectoryName("Import*")
25449.   or DirectoryName("Log*")
25450.   or DirectoryName("*Log")
25451.   or DirectoryName("Maintenance*")
25452.   or DirectoryName("Rec*")
25453.   or DirectoryName("Sales*")
25454.   or DirectoryName("Search*")
25455.   or DirectoryName("User*")
25456. )
25457. # Data end.
25458. 
25459.     # BlobsAndExceptions
25460.   )
25461. ) )
25462. # BlobsAndExceptions end.
25463. 
25464. # Blobs
25465. ) and (
25466.   Size(BlobFileSize,0)
25467.   or (
25468.     FileName("*.arj")
25469.     or FileName("*.bup")
25470.     or FileName("*.bz2")
25471.     or FileName("*.chm")
25472.     or FileName("*.dvr-ms")
25473.     or FileName("*.gz")
25474.     or FileName("*.ifo")
25475.     or FileName("*.lzh")
25476.     or FileName("*.pdf")
25477.     or FileName("*.rpm")
25478.     or FileName("*.wmv")
25479.     or FileName("*.vob")
25480.     or FileName("*.z")
25481.   ) 
25482. )
25483. # Blobs end.
25484. 
25485. # NotBlobsArchivesBu
25486. or 
25487. # Archives start.
25488. (
25489.   DirectoryName("*Archive*")
25490.   or DirectoryName("*History*")
25491.   or DirectoryName("*Old")
25492.   or DirectoryName("* Old *")
25493.   or DirectoryName("Old *")
25494. 
25495.   or FileName("*.7z")
25496.   or FileName("*.cab")
25497.   or FileName("*.iso")
25498.   or FileName("*.msi")
25499.   or FileName("*.old")
25500.   or FileName("*.rar")
25501.   or FileName("*.tar")
25502.   or FileName("*.zip")
25503.   or
25504. # WinSysLow start.
25505. (
25506.   # Bad idea. This pushed lots of programs and data to archive.
25507.   # DirectoryName("$*")
25508.   # or DirectoryName("0*")
25509.   # or DirectoryName("1*")
25510.   # or DirectoryName("2*")
25511.   # or DirectoryName("3*")
25512.   # or DirectoryName("4*")
25513.   # or DirectoryName("5*")
25514.   # or DirectoryName("6*")
25515.   # or DirectoryName("7*")
25516.   # or DirectoryName("8*")
25517.   # or DirectoryName("9*")
25518.   # or 
25519.   DirectoryName("dllcache")
25520.   or DirectoryName("Downloaded Installations")
25521.   or DirectoryName("Ehome")
25522.   or DirectoryName("Fonts")
25523.   or DirectoryName("Help")
25524.   or DirectoryName("I386")
25525.   or DirectoryName("ie?updates")
25526.   or DirectoryName("Installer")
25527.   or DirectoryName("Installshield Installation Information")
25528.   or DirectoryName("IME")
25529.   or DirectoryName("*RECYCLE*")
25530.   or DirectoryName("ServicePackFiles")
25531.   or DirectoryName("SoftwareDistribution")
25532.   or DirectoryName("Speech")
25533.   or DirectoryName("Symbols")
25534.   or DirectoryName("System Volume Information")
25535.   or DirectoryName("windows.old")
25536. )
25537. # WinSysLow end.
25538. 
25539.   # Archives
25540. )
25541. # Archives end.
25542. 
25543. # NotBlobsArchivesBu
25544. or
25545. # Backups start.
25546. (
25547.   DirectoryName("*Backup*")
25548.   or DirectoryName("*Bu")
25549.   or DirectoryName("* Bu *")
25550.   or DirectoryName("Bu *")
25551. 
25552.   or FileName("*.bak")
25553.   or FileName("* - Copy*")
25554. )
25555. # Backups end.
25556. 
25557. or 
25558. FileName("ReferenceMarker.MyDx")
25559. # NotBlobsArchivesBu
25560. ) )
25561. # NotBlobsArchivesBu end.
25562. 
25563. # Shares
25564. and (
25565. # Share start.
25566. (
25567.   DirectoryName("*Common*")
25568.   or DirectoryName("Media*")
25569.   or DirectoryName("Multimedia*")
25570.   or DirectoryName("*Public*")
25571.   or DirectoryName("*Share*")
25572. )
25573. # Share end.
25574. 
25575. # Shares
25576. or 
25577. # Family start.
25578. (
25579.     DirectoryName("*Family*")
25580. )
25581. # Family end.
25582. 
25583. # Shares
25584. )
25585. # Shares end.
25586. 
25587. ')
25588. 
25589. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
25590. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
25591. 
25592. SetVariable(ZoneStepNoCurrent, 0)
25593. 
25594. 	/* ------------------------- */
25595. # Script: ZoneDoHeader
25596. 
25597. # Script: ZoneWhenStarted
25598. RunProgram("..\Commands\WriteDateTime.bat")
25599. 
25600. # Script: ZoneDoCurrentClear
25601. 
25602. SetVariable(ZoneTypeSelectCurrent, 		"")
25603. SetVariable(ZoneStatisticsData, 		"")
25604. SetVariable(ZoneStepByLine, 			"")
25605. 
25606. SetVariable(ZoneBeginCurrent, 			0)
25607. SetVariable(ZoneBeginPerCurrent, 		0)
25608. SetVariable(ZoneEndCurrent, 			0)
25609. SetVariable(ZoneEndPerCurrent, 			0)
25610. 
25611. SetVariable(ZoneSizeCurrent,			0)
25612. SetVariable(ZoneSizePerCurrent,			0)
25613. 
25614. SetVariable(ZoneGapRequestedCurrent,	0)
25615. SetVariable(ZoneGapRoundedCurrent, 		0)
25616. SetVariable(ZoneGapAdjustedCurrent, 	0)
25617. SetVariable(ZoneGapAvailableCurrent, 	0)
25618. SetVariable(ZoneGapCurrent,				0)
25619. SetVariable(ZoneGapUsedCurrent, 		0)
25620. 
25621. SetVariable(ZoneGapActualCurrent, 		0)
25622. SetVariable(ZoneGapActualPerCurrent, 	0)
25623. 
25624. SetVariable(ZoneSizeActual, 			0)
25625. SetVariable(ZoneSizeActualCurrent,		0)
25626. 
25627. SetVariable(ZoneEndActual, 				0)
25628. SetVariable(ZoneEndActualCurrent,		0)			
25629. SetVariable(ZoneSizeActualPerCurrent, 	0)
25630.       
25631. SetVariable(ZoneFilesFolders,			0)
25632. SetVariable(ZoneFilesFoldersPer,		0) 
25633. 
25634. SetVariable(ZoneFragments,				0)
25635. SetVariable(ZoneFragmentsPer,			0) 
25636. 		
25637. SetVariable(ZoneEndActualCurrent, 		0)
25638. SetVariable(ZoneEndActualPerCurrent, 	0)
25639. 
25640. # Gap Calculation Methodology:
25641. 	# Requested
25642. 	SetVariable(GapRequested, 			0) 
25643. 	SetVariable(GapRequestedStd, 		0) 
25644. 	SetVariable(GapRequestedMft, 		0) 
25645. 	SetVariable(GapRequestedOs, 		0) 
25646. 	SetVariable(GapRequestedOriginal, 	0) 
25647. 	
25648. 	# Gap Adjustments
25649. 	SetVariable(GapRounded, 			0)
25650. 	# SetVariable(GapAdjusted, 			0)
25651. 	SetVariable(GapAvailable, 			0)
25652. 	SetVariable(GapCurrent, 			0)
25653. 	SetVariable(GapActual, 				0)
25654. 	SetVariable(GapUsed, 				0)
25655. 	
25656. 	# Gap Adjustments
25657. 	SetVariable(GapRoundedLoc, 			0)
25658. 	# SetVariable(GapAdjustedLoc, 		0)
25659. 	SetVariable(GapAvailableLoc, 		0)
25660. 	SetVariable(GapCurrentLoc, 			0)
25661. 	SetVariable(GapActualLoc,			0)
25662. 	SetVariable(GapUsedLoc,				0)
25663. 	
25664. 	# Space usage
25665. 	SetVariable(ZoneFreePerRequested, 	0)
25666. 	SetVariable(ZoneFreePerUsed, 		0)
25667. 
25668. # Gap Size & Rounding
25669. 	SetVariable(ZoneGapSizePer, 		0)
25670. 	SetVariable(ZoneVolRoundUpPer, 		0)
25671. 	
25672. 	# Free Space
25673. 	SetVariable(ZoneFreeUsedPer, 		0)
25674. 	SetVariable(ZoneFreeRequestedPer, 	0)
25675. 
25676. # Script: DisplaySetZone
25677. 
25678. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
25679. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
25680. 
25681. # Message ZoneSummary
25682. # SetVariable(ZoneSummary, '
25683. # Zone Summary:
25684. # ')
25685. # Zone processing steps
25686. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
25687. # ')
25688. 
25689. # # Script: BannerDescriptionSet
25690. 
25691. # Script: BannerSet
25692. 
25693. # NOTE: Can't round or truncate to integer precision. 
25694. # This internal fields like ZoneCount format really badly.
25695. #  for !RunTimeNow! does not work. None of the date functions do.
25696. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25697. 
25698. SetVariable(HeadingTemp2,	ZoneCount + 0)
25699. 
25700. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25701. 
25702. Title('!Heading!')
25703. 
25704. /* pause(1) */
25705. 
25706. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25707. 
25708. 
25709. # Script: BannerLog
25710. 
25711. AppendLogfile("!LogFileName!", "!Heading!")
25712. 
25713. 
25714. 
25715. # pause(1)
25716. 
25717. 
25718. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
25719. # Script: DisplaySetZoneStep
25720. # Increment
25721. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25722. 
25723. # Display this zone step
25724. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
25725. ')
25726. 
25727. # Script: BannerSet
25728. 
25729. # NOTE: Can't round or truncate to integer precision. 
25730. # This internal fields like ZoneCount format really badly.
25731. #  for !RunTimeNow! does not work. None of the date functions do.
25732. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25733. 
25734. SetVariable(HeadingTemp2,	ZoneCount + 0)
25735. 
25736. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25737. 
25738. Title('!Heading!')
25739. 
25740. /* pause(1) */
25741. 
25742. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25743. 
25744. 
25745. # Script: DisplaySetWindowText
25746. # Zone Footer Set Statistics Window Text
25747. 
25748. SetStatisticsWindowText("!Heading!
25749. ----------------------------------------------------------
25750. Zones Processed: 
25751. ----------------------------------------------------------
25752. !ZoneListByLine!
25753. ----------------------------------------------------------
25754. Zone Processing Step:
25755. !ZoneStepByLine!    
25756. ----------------------------------------------------------
25757. ----------------------------------------------------------
25758. CURRENT ZONE:
25759. !ZoneStatisticsReport!
25760. ----------------------------------------------------------
25761. ----------------------------------------------------------
25762. ----------------------------------------------------------
25763. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
25764. ----------------------------------------------------------
25765. !VolumeStatisticsSummary!
25766. !VolumeStatisticsDetail!
25767. ----------------------------------------------------------
25768. ----------------------------------------------------------
25769. Zone Detailed Report:
25770. ----------------------------------------------------------
25771. !ZoneStatisticsDetail!
25772. ----------------------------------------------------------
25773. ")
25774. 
25775. 
25776. 
25777. 
25778. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
25779. 
25780. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
25781. # Script: DisplaySetZoneStep
25782. # Increment
25783. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25784. 
25785. # Display this zone step
25786. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
25787. ')
25788. 
25789. # Script: BannerSet
25790. 
25791. # NOTE: Can't round or truncate to integer precision. 
25792. # This internal fields like ZoneCount format really badly.
25793. #  for !RunTimeNow! does not work. None of the date functions do.
25794. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25795. 
25796. SetVariable(HeadingTemp2,	ZoneCount + 0)
25797. 
25798. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25799. 
25800. Title('!Heading!')
25801. 
25802. /* pause(1) */
25803. 
25804. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25805. 
25806. 
25807. # Script: DisplaySetWindowText
25808. # Zone Footer Set Statistics Window Text
25809. 
25810. SetStatisticsWindowText("!Heading!
25811. ----------------------------------------------------------
25812. Zones Processed: 
25813. ----------------------------------------------------------
25814. !ZoneListByLine!
25815. ----------------------------------------------------------
25816. Zone Processing Step:
25817. !ZoneStepByLine!    
25818. ----------------------------------------------------------
25819. ----------------------------------------------------------
25820. CURRENT ZONE:
25821. !ZoneStatisticsReport!
25822. ----------------------------------------------------------
25823. ----------------------------------------------------------
25824. ----------------------------------------------------------
25825. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
25826. ----------------------------------------------------------
25827. !VolumeStatisticsSummary!
25828. !VolumeStatisticsDetail!
25829. ----------------------------------------------------------
25830. ----------------------------------------------------------
25831. Zone Detailed Report:
25832. ----------------------------------------------------------
25833. !ZoneStatisticsDetail!
25834. ----------------------------------------------------------
25835. ")
25836. 
25837. 
25838. 
25839. 
25840. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
25841. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
25842. 
25843. # Script: BannerSet
25844. 
25845. # NOTE: Can't round or truncate to integer precision. 
25846. # This internal fields like ZoneCount format really badly.
25847. #  for !RunTimeNow! does not work. None of the date functions do.
25848. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25849. 
25850. SetVariable(HeadingTemp2,	ZoneCount + 0)
25851. 
25852. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25853. 
25854. Title('!Heading!')
25855. 
25856. /* pause(1) */
25857. 
25858. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25859. 
25860. 
25861. # Script: BannerLog
25862. 
25863. AppendLogfile("!LogFileName!", "!Heading!")
25864. 
25865. 
25866. 
25867. # LOGGING:
25868. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
25869. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
25870. 
25871. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
25872. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:01")
25873. # 2021-12-14 15:30:01 
25874. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:06 !ZoneLabel! !ZoneDescription!")
25875. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
25876. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:06 !ZoneLabel! !ZoneDescription!")
25877. 
25878. 
25879. # Add zone to list of zones:
25880. SetVariable(ZoneListByLine, "!ZoneListByLine!
25881. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
25882. # Script: DisplaySetWindowText
25883. # Zone Footer Set Statistics Window Text
25884. 
25885. SetStatisticsWindowText("!Heading!
25886. ----------------------------------------------------------
25887. Zones Processed: 
25888. ----------------------------------------------------------
25889. !ZoneListByLine!
25890. ----------------------------------------------------------
25891. Zone Processing Step:
25892. !ZoneStepByLine!    
25893. ----------------------------------------------------------
25894. ----------------------------------------------------------
25895. CURRENT ZONE:
25896. !ZoneStatisticsReport!
25897. ----------------------------------------------------------
25898. ----------------------------------------------------------
25899. ----------------------------------------------------------
25900. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
25901. ----------------------------------------------------------
25902. !VolumeStatisticsSummary!
25903. !VolumeStatisticsDetail!
25904. ----------------------------------------------------------
25905. ----------------------------------------------------------
25906. Zone Detailed Report:
25907. ----------------------------------------------------------
25908. !ZoneStatisticsDetail!
25909. ----------------------------------------------------------
25910. ")
25911. 
25912. 
25913. 
25914. 
25915. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
25916. # Script: DisplaySetZoneStep
25917. # Increment
25918. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25919. 
25920. # Display this zone step
25921. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
25922. ')
25923. 
25924. # Script: BannerSet
25925. 
25926. # NOTE: Can't round or truncate to integer precision. 
25927. # This internal fields like ZoneCount format really badly.
25928. #  for !RunTimeNow! does not work. None of the date functions do.
25929. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25930. 
25931. SetVariable(HeadingTemp2,	ZoneCount + 0)
25932. 
25933. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25934. 
25935. Title('!Heading!')
25936. 
25937. /* pause(1) */
25938. 
25939. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
25940. 
25941. 
25942. # Script: DisplaySetWindowText
25943. # Zone Footer Set Statistics Window Text
25944. 
25945. SetStatisticsWindowText("!Heading!
25946. ----------------------------------------------------------
25947. Zones Processed: 
25948. ----------------------------------------------------------
25949. !ZoneListByLine!
25950. ----------------------------------------------------------
25951. Zone Processing Step:
25952. !ZoneStepByLine!    
25953. ----------------------------------------------------------
25954. ----------------------------------------------------------
25955. CURRENT ZONE:
25956. !ZoneStatisticsReport!
25957. ----------------------------------------------------------
25958. ----------------------------------------------------------
25959. ----------------------------------------------------------
25960. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
25961. ----------------------------------------------------------
25962. !VolumeStatisticsSummary!
25963. !VolumeStatisticsDetail!
25964. ----------------------------------------------------------
25965. ----------------------------------------------------------
25966. Zone Detailed Report:
25967. ----------------------------------------------------------
25968. !ZoneStatisticsDetail!
25969. ----------------------------------------------------------
25970. ")
25971. 
25972. 
25973. 
25974. 
25975. # your stuff HERE (X)... pre file select code.
25976. 
25977. /* --------------------------------- */
25978. 	FileSelect
25979. 
25980. 		# your stuff can't really go here (errors.)
25981. 		# maybe for some reason I don't know of...
25982. 	
25983. 		# Actions next...
25984. 	# Script: ZoneDo ZoneTypeSelectShares
25985. # Shares start.
25986. # NotBlobsArchivesBu start.
25987. # NOT!
25988. (not (
25989. # Blobs start.
25990. (
25991. # BlobsAndExceptions start.
25992. ( not(
25993.   FileName("*.bat")
25994.   or FileName("*.css")
25995.   or FileName("*.dll")
25996.   or FileName("*.exe")
25997.   or FileName("*.htm*")
25998.   or FileName("*.jar")
25999.   or FileName("*.js")
26000.   or FileName("*.script")
26001.   or FileName("*.wsf")
26002.   or (
26003. # Databases start.
26004. (
26005.   FileName("*.crypt*")
26006.   or FileName("*.db*")
26007.   or FileName("*.rdb*")
26008.   or FileName("*.dc*")
26009.   or FileName("*.dict*")
26010.   or FileName("*.?db*")
26011.   or FileName("*.?rdb*")
26012.   or FileName("*.md*")
26013.   or FileName("*.myd")
26014.   or FileName("*.ndf")
26015.   or FileName("*.ns?")
26016.   or FileName("*.pab")
26017.   or FileName("*.pst")
26018.   or FileName("*.sd?*")
26019.   or FileName("*.sq**")
26020.   or FileName("*.tmd")
26021.   or FileName("*.tps")
26022.   or FileName("*.tr*")
26023. )
26024. # Databases end.
26025. 
26026.     # BlobsAndExceptions
26027.     or 
26028. # Data start.
26029. (
26030.   DirectoryName("Data*")
26031.   or DirectoryName("Device*")
26032.   or DirectoryName("Export*")
26033.   or DirectoryName("Import*")
26034.   or DirectoryName("Log*")
26035.   or DirectoryName("*Log")
26036.   or DirectoryName("Maintenance*")
26037.   or DirectoryName("Rec*")
26038.   or DirectoryName("Sales*")
26039.   or DirectoryName("Search*")
26040.   or DirectoryName("User*")
26041. )
26042. # Data end.
26043. 
26044.     # BlobsAndExceptions
26045.   )
26046. ) )
26047. # BlobsAndExceptions end.
26048. 
26049. # Blobs
26050. ) and (
26051.   Size(BlobFileSize,0)
26052.   or (
26053.     FileName("*.arj")
26054.     or FileName("*.bup")
26055.     or FileName("*.bz2")
26056.     or FileName("*.chm")
26057.     or FileName("*.dvr-ms")
26058.     or FileName("*.gz")
26059.     or FileName("*.ifo")
26060.     or FileName("*.lzh")
26061.     or FileName("*.pdf")
26062.     or FileName("*.rpm")
26063.     or FileName("*.wmv")
26064.     or FileName("*.vob")
26065.     or FileName("*.z")
26066.   ) 
26067. )
26068. # Blobs end.
26069. 
26070. # NotBlobsArchivesBu
26071. or 
26072. # Archives start.
26073. (
26074.   DirectoryName("*Archive*")
26075.   or DirectoryName("*History*")
26076.   or DirectoryName("*Old")
26077.   or DirectoryName("* Old *")
26078.   or DirectoryName("Old *")
26079. 
26080.   or FileName("*.7z")
26081.   or FileName("*.cab")
26082.   or FileName("*.iso")
26083.   or FileName("*.msi")
26084.   or FileName("*.old")
26085.   or FileName("*.rar")
26086.   or FileName("*.tar")
26087.   or FileName("*.zip")
26088.   or
26089. # WinSysLow start.
26090. (
26091.   # Bad idea. This pushed lots of programs and data to archive.
26092.   # DirectoryName("$*")
26093.   # or DirectoryName("0*")
26094.   # or DirectoryName("1*")
26095.   # or DirectoryName("2*")
26096.   # or DirectoryName("3*")
26097.   # or DirectoryName("4*")
26098.   # or DirectoryName("5*")
26099.   # or DirectoryName("6*")
26100.   # or DirectoryName("7*")
26101.   # or DirectoryName("8*")
26102.   # or DirectoryName("9*")
26103.   # or 
26104.   DirectoryName("dllcache")
26105.   or DirectoryName("Downloaded Installations")
26106.   or DirectoryName("Ehome")
26107.   or DirectoryName("Fonts")
26108.   or DirectoryName("Help")
26109.   or DirectoryName("I386")
26110.   or DirectoryName("ie?updates")
26111.   or DirectoryName("Installer")
26112.   or DirectoryName("Installshield Installation Information")
26113.   or DirectoryName("IME")
26114.   or DirectoryName("*RECYCLE*")
26115.   or DirectoryName("ServicePackFiles")
26116.   or DirectoryName("SoftwareDistribution")
26117.   or DirectoryName("Speech")
26118.   or DirectoryName("Symbols")
26119.   or DirectoryName("System Volume Information")
26120.   or DirectoryName("windows.old")
26121. )
26122. # WinSysLow end.
26123. 
26124.   # Archives
26125. )
26126. # Archives end.
26127. 
26128. # NotBlobsArchivesBu
26129. or
26130. # Backups start.
26131. (
26132.   DirectoryName("*Backup*")
26133.   or DirectoryName("*Bu")
26134.   or DirectoryName("* Bu *")
26135.   or DirectoryName("Bu *")
26136. 
26137.   or FileName("*.bak")
26138.   or FileName("* - Copy*")
26139. )
26140. # Backups end.
26141. 
26142. or 
26143. FileName("ReferenceMarker.MyDx")
26144. # NotBlobsArchivesBu
26145. ) )
26146. # NotBlobsArchivesBu end.
26147. 
26148. # Shares
26149. and (
26150. # Share start.
26151. (
26152.   DirectoryName("*Common*")
26153.   or DirectoryName("Media*")
26154.   or DirectoryName("Multimedia*")
26155.   or DirectoryName("*Public*")
26156.   or DirectoryName("*Share*")
26157. )
26158. # Share end.
26159. 
26160. # Shares
26161. or 
26162. # Family start.
26163. (
26164.     DirectoryName("*Family*")
26165. )
26166. # Family end.
26167. 
26168. # Shares
26169. )
26170. # Shares end.
26171. 
26172. 	# Script: ZoneDoAction
26173. # Zone Do File Action - SortByName.
26174. 
26175. 	FileActions
26176. 
26177. 			# Script: GapZoneCalc
26178. 	# Gap
26179. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
26180. 		# Script: DisplaySetZoneStep
26181. # Increment
26182. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26183. 
26184. # Display this zone step
26185. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
26186. ')
26187. 
26188. # Script: BannerSet
26189. 
26190. # NOTE: Can't round or truncate to integer precision. 
26191. # This internal fields like ZoneCount format really badly.
26192. #  for !RunTimeNow! does not work. None of the date functions do.
26193. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26194. 
26195. SetVariable(HeadingTemp2,	ZoneCount + 0)
26196. 
26197. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
26198. 
26199. Title('!Heading!')
26200. 
26201. /* pause(1) */
26202. 
26203. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
26204. 
26205. 
26206. # Script: DisplaySetWindowText
26207. # Zone Footer Set Statistics Window Text
26208. 
26209. SetStatisticsWindowText("!Heading!
26210. ----------------------------------------------------------
26211. Zones Processed: 
26212. ----------------------------------------------------------
26213. !ZoneListByLine!
26214. ----------------------------------------------------------
26215. Zone Processing Step:
26216. !ZoneStepByLine!    
26217. ----------------------------------------------------------
26218. ----------------------------------------------------------
26219. CURRENT ZONE:
26220. !ZoneStatisticsReport!
26221. ----------------------------------------------------------
26222. ----------------------------------------------------------
26223. ----------------------------------------------------------
26224. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
26225. ----------------------------------------------------------
26226. !VolumeStatisticsSummary!
26227. !VolumeStatisticsDetail!
26228. ----------------------------------------------------------
26229. ----------------------------------------------------------
26230. Zone Detailed Report:
26231. ----------------------------------------------------------
26232. !ZoneStatisticsDetail!
26233. ----------------------------------------------------------
26234. ")
26235. 
26236. 
26237. 
26238. 	
26239. 	# ACTUAL GAP
26240. 		/* AddGap Variant. */
26241. 	  	# Script: GapZoneSet
26242. # Zone Do Gap
26243. # Gap Calculation Methods:
26244. 
26245. /* 1) Anything you need to add first. */
26246. /* empty */
26247. 
26248. /* ------------------------- */
26249. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
26250. 	# GapRequestedStd.
26251. 
26252. 		/* ------------------------- */
26253. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
26254. 
26255. 		# Gap Calculation Methods:
26256. 
26257. /* AddGap Variants */
26258. 
26259. 	/* Standard */
26260. 		# Gap Calculation Methods:
26261. 	/* AddGap Variants */
26262. 	/* Standard */
26263. 
26264. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
26265. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
26266. 
26267. 	SetVariable(GapRequested, GapRequestedStd)
26268. 	
26269. 
26270. 	/* MFT Low High Method */
26271. 		# Gap Calculation Methods:
26272. 	/* AddGap Variants */
26273. 	/* MFT Low High Method */
26274. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
26275. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
26276. 	SetVariable(GapRequested, GapRequestedMft)
26277. 	
26278. 
26279. 	/* OS Volume Type Method */
26280. 		# Gap Calculation Methods:
26281. 	/* AddGap Variants */
26282. 	/* OS Volume Type Method */
26283. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
26284. 	SetVariable(GapRequested, GapRequestedOs)
26285. 
26286. 
26287. 
26288. /* MakeGap Variants */
26289. 
26290. 	/* Original Os 1-3 + MFT 2 */
26291. 		# Gap Calculation Methods:
26292. 	/* MakeGap Variants */
26293. 	/* Original Os 1-3 + MFT 2 */
26294. 	/* plus MFT gap placed inline at the dividing zone. */
26295. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
26296. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
26297. 	SetVariable(GapRequested, GapRequestedOrig)
26298. 	
26299. 	
26300. /* Note: You could comment out the ones not in use */
26301. /* However having the data in the log is useful. */
26302. /* Therefore the following line is otherwise needed. */
26303. 
26304. /* Standard used */
26305. 
26306. SetVariable(GapRequested, GapRequestedStd)
26307. 
26308. # Gap Calculation Methods:
26309. 
26310. /* AddGap Variants */
26311. 	/* Standard */
26312. 	/* MFT Low High Method */
26313. 	/* OS Volume Type Method */
26314. 
26315. /* MakeGap Variants */
26316. 	/* Original Os 1-3 + MFT 2 */
26317. 
26318. /* Note: You could comment out the ones not in use */
26319. /* However having the data in the log is useful. */
26320. /* Therefore the following line is otherwise needed. */
26321. 
26322. /* Standard is used currently */
26323. 
26324. 
26325. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
26326. 
26327. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
26328. 
26329. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
26330. 
26331. /* ------------------------- */
26332. /* 3) SMALL ZONE ADJUSTMENT. */
26333. /* Gab cant be larger than half the Zone Size. */
26334. 
26335. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
26336. 	
26337. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
26338. 
26339. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
26340. 
26341. /* ------------------------- */
26342. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
26343. # Gap Adjustments.
26344. 
26345. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
26346. 	
26347. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
26348. 
26349. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
26350. 
26351. /* ------------------------- */
26352. # BYPASS THIS.
26353. 	/* This is definitely wrong. */
26354. 	/* The question is can we steal gap from the next zone */
26355. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
26356. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
26357. 		# Zone Overflow.
26358. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
26359. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
26360. 
26361. /* ------------------------- */
26362. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
26363. # Remaining free space available.
26364. 
26365. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
26366. 	
26367. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
26368. 
26369. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
26370. 
26371. /* ------------------------- */
26372. # CURRENT gap to use.
26373. 
26374. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
26375. 
26376. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
26377. 
26378. /* ------------------------- */
26379. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
26380. # Debugging.
26381. 
26382. 	SetVariable(GapUsed, GapCurrent) // for debugging
26383. 
26384. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
26385. 
26386. 		# Your code HERE
26387. 
26388. /* ------------------------- */
26389. /* 7) YOUR CODE. */
26390. # YOUR CODE HERE:
26391. 	# INPUT: GapCurrent or GapCurrentLoc
26392. 	# OUTPUT: GapUsed...
26393. 
26394. /* ------------------------- */
26395. # Gap Size.
26396. # Actual Size of Gap.
26397. 
26398. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
26399. 
26400. /* ------------------------- */
26401. 
26402. 	
26403. 	# Zone Statistics	
26404. 		# Script: ZoneStatisticsGet
26405. # Zone / Volume Statistics and Display
26406. 		
26407. 	# Accumulate Totals
26408.   	# Script: ZoneDoVolumeTotals
26409. 
26410. /* Current total space used (by Zones and Gaps) */
26411. 
26412. SetVariable(VolumeZoneUsed, GapUsed)
26413. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
26414. /* Percentage */
26415. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
26416. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
26417. 
26418. /* Current total of free space requested */
26419. 
26420. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
26421. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
26422. /* Percent. */
26423. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
26424. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
26425. 
26426. /* Current total of free space used */
26427. 
26428. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
26429. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
26430. /* Percent */
26431. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
26432. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
26433. 
26434. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
26435. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
26436. # Xinclude "..\DebugDisplayPause.MyDc"X
26437. 
26438. 
26439. 	# Current Values
26440. 	# Script: ZoneDoCurrentSet
26441. 
26442. # Cluster, Sector, Block adjust for display.
26443. 	# Bytes per cluster is volume specific.
26444. 
26445. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
26446. 
26447. # Current Zone values.
26448. 	# Begin, end and size.
26449. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
26450. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
26451. 
26452. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
26453. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
26454. 
26455. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
26456. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
26457. 
26458. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
26459. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
26460. 
26461. 	SetVariable(ZoneFragments,				"!ZONE210N!")
26462. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
26463. 		
26464. # Current Gap, Actual and Free Values
26465. 	# Gap
26466. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
26467. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
26468. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
26469. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
26470. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
26471. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
26472. 	
26473. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
26474. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
26475. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
26476. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
26477. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
26478. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
26479. 	
26480. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
26481. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
26482. 	
26483. 	# Actual Size and End
26484. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
26485. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
26486. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
26487. 	
26488. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
26489. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
26490. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
26491. 
26492. # Gap Size & Rounding
26493. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
26494. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
26495. 	
26496. 	# Free Space
26497. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
26498. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
26499. 
26500. 	# Script: ZoneStatisticsReportGet
26501. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
26502. 
26503. # Footer:
26504. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
26505. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
26506. #
26507. # Xinclude "..\Commands\DateTimeLastLong.txt"X
26508. #
26509. # What a mess this word based vs is. Try a phrase based version ToDo
26510. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
26511. ------------------
26512.    !SizeWord!!ColonWord!  
26513.    ------------------------
26514.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
26515.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
26516.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
26517. 
26518.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
26519.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
26520. 
26521.    !LocationWord!!ColonWord!
26522.    ------------------------
26523.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
26524.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
26525.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
26526.       
26527.    !GapWordCaps! !SettingsWord!!ColonWord!
26528.    ------------------------
26529.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
26530.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
26531.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
26532.                  
26533.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
26534.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
26535.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
26536.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
26537.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
26538.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
26539.      
26540.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
26541.    ------------------------
26542.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
26543.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
26544.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
26545. 
26546. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
26547. ----------------------------------------------------------
26548. ")
26549. #
26550. SetVariable(DateNow, 	DATETIME)
26551. SetVariable(TimeNow, 	Time)
26552. SetVariable(RunTimeNow, 	RunTime)
26553. 
26554. 
26555. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
26556. 
26557. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
26558. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
26559. 
26560. 	# Script: DisplaySetWindowText
26561. # Zone Footer Set Statistics Window Text
26562. 
26563. SetStatisticsWindowText("!Heading!
26564. ----------------------------------------------------------
26565. Zones Processed: 
26566. ----------------------------------------------------------
26567. !ZoneListByLine!
26568. ----------------------------------------------------------
26569. Zone Processing Step:
26570. !ZoneStepByLine!    
26571. ----------------------------------------------------------
26572. ----------------------------------------------------------
26573. CURRENT ZONE:
26574. !ZoneStatisticsReport!
26575. ----------------------------------------------------------
26576. ----------------------------------------------------------
26577. ----------------------------------------------------------
26578. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
26579. ----------------------------------------------------------
26580. !VolumeStatisticsSummary!
26581. !VolumeStatisticsDetail!
26582. ----------------------------------------------------------
26583. ----------------------------------------------------------
26584. Zone Detailed Report:
26585. ----------------------------------------------------------
26586. !ZoneStatisticsDetail!
26587. ----------------------------------------------------------
26588. ")
26589. 
26590. 
26591. 	
26592. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
26593. 
26594. 
26595. 	SetVariable(ZoneStatisticsData, 
26596. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
26597.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
26598.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
26599. 
26600. 
26601. 
26602.  		# Script: ZoneStatisticsDisplay
26603. 	
26604. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
26605. !ZoneStatisticsData!
26606. ')
26607. 
26608. 		# Script: ZoneStatisticsAdd
26609. # Append Zone to Details of each zone.
26610. 		
26611. 	# Add Zone Details to Report.	
26612. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
26613. !ZoneStatisticsReport!
26614. ')
26615. 
26616. 	
26617. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
26618. 		# Script: DisplaySetZoneStep
26619. # Increment
26620. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26621. 
26622. # Display this zone step
26623. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
26624. ')
26625. 
26626. # Script: BannerSet
26627. 
26628. # NOTE: Can't round or truncate to integer precision. 
26629. # This internal fields like ZoneCount format really badly.
26630. #  for !RunTimeNow! does not work. None of the date functions do.
26631. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26632. 
26633. SetVariable(HeadingTemp2,	ZoneCount + 0)
26634. 
26635. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
26636. 
26637. Title('!Heading!')
26638. 
26639. /* pause(1) */
26640. 
26641. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
26642. 
26643. 
26644. # Script: DisplaySetWindowText
26645. # Zone Footer Set Statistics Window Text
26646. 
26647. SetStatisticsWindowText("!Heading!
26648. ----------------------------------------------------------
26649. Zones Processed: 
26650. ----------------------------------------------------------
26651. !ZoneListByLine!
26652. ----------------------------------------------------------
26653. Zone Processing Step:
26654. !ZoneStepByLine!    
26655. ----------------------------------------------------------
26656. ----------------------------------------------------------
26657. CURRENT ZONE:
26658. !ZoneStatisticsReport!
26659. ----------------------------------------------------------
26660. ----------------------------------------------------------
26661. ----------------------------------------------------------
26662. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
26663. ----------------------------------------------------------
26664. !VolumeStatisticsSummary!
26665. !VolumeStatisticsDetail!
26666. ----------------------------------------------------------
26667. ----------------------------------------------------------
26668. Zone Detailed Report:
26669. ----------------------------------------------------------
26670. !ZoneStatisticsDetail!
26671. ----------------------------------------------------------
26672. ")
26673. 
26674. 
26675. 
26676. 
26677. 		# File Action - All - Full -  SortByCreationDate
26678. # File Action - ZoneDoActionSortByCreationDateFull
26679. 	SortByCreationDate(Ascending)
26680. 	
26681. 
26682. 
26683. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
26684. 		# Script: DisplaySetZoneStep
26685. # Increment
26686. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26687. 
26688. # Display this zone step
26689. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
26690. ')
26691. 
26692. # Script: BannerSet
26693. 
26694. # NOTE: Can't round or truncate to integer precision. 
26695. # This internal fields like ZoneCount format really badly.
26696. #  for !RunTimeNow! does not work. None of the date functions do.
26697. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26698. 
26699. SetVariable(HeadingTemp2,	ZoneCount + 0)
26700. 
26701. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
26702. 
26703. Title('!Heading!')
26704. 
26705. /* pause(1) */
26706. 
26707. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
26708. 
26709. 
26710. # Script: DisplaySetWindowText
26711. # Zone Footer Set Statistics Window Text
26712. 
26713. SetStatisticsWindowText("!Heading!
26714. ----------------------------------------------------------
26715. Zones Processed: 
26716. ----------------------------------------------------------
26717. !ZoneListByLine!
26718. ----------------------------------------------------------
26719. Zone Processing Step:
26720. !ZoneStepByLine!    
26721. ----------------------------------------------------------
26722. ----------------------------------------------------------
26723. CURRENT ZONE:
26724. !ZoneStatisticsReport!
26725. ----------------------------------------------------------
26726. ----------------------------------------------------------
26727. ----------------------------------------------------------
26728. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
26729. ----------------------------------------------------------
26730. !VolumeStatisticsSummary!
26731. !VolumeStatisticsDetail!
26732. ----------------------------------------------------------
26733. ----------------------------------------------------------
26734. Zone Detailed Report:
26735. ----------------------------------------------------------
26736. !ZoneStatisticsDetail!
26737. ----------------------------------------------------------
26738. ")
26739. 
26740. 
26741. 
26742. 
26743. 	# Script: ZoneDoFooter
26744. 
26745. /* --------------------------------- */
26746. 	# File Select
26747. 		# Select Statments
26748. 	# File Actions 
26749. 		# Standard or OS File Actions.
26750. 		# Resume...
26751. 	
26752. 		# your stuff HERE (X)... post zone (file) file actions code.
26753. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
26754. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
26755. 			# (X)
26756. 		
26757. 			/* ??? Set window? */
26758. 	
26759. 		# ADD THE GAP
26760. 		# Script: GapZoneCommand
26761. # Vacate (good for diagnostics)
26762. # DoNotVacate - DO NOT Vacate (recommended)
26763. 
26764. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
26765. # Script: DisplaySetZoneStep
26766. # Increment
26767. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26768. 
26769. # Display this zone step
26770. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
26771. ')
26772. 
26773. # Script: BannerSet
26774. 
26775. # NOTE: Can't round or truncate to integer precision. 
26776. # This internal fields like ZoneCount format really badly.
26777. #  for !RunTimeNow! does not work. None of the date functions do.
26778. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26779. 
26780. SetVariable(HeadingTemp2,	ZoneCount + 0)
26781. 
26782. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
26783. 
26784. Title('!Heading!')
26785. 
26786. /* pause(1) */
26787. 
26788. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
26789. 
26790. 
26791. # Script: DisplaySetWindowText
26792. # Zone Footer Set Statistics Window Text
26793. 
26794. SetStatisticsWindowText("!Heading!
26795. ----------------------------------------------------------
26796. Zones Processed: 
26797. ----------------------------------------------------------
26798. !ZoneListByLine!
26799. ----------------------------------------------------------
26800. Zone Processing Step:
26801. !ZoneStepByLine!    
26802. ----------------------------------------------------------
26803. ----------------------------------------------------------
26804. CURRENT ZONE:
26805. !ZoneStatisticsReport!
26806. ----------------------------------------------------------
26807. ----------------------------------------------------------
26808. ----------------------------------------------------------
26809. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
26810. ----------------------------------------------------------
26811. !VolumeStatisticsSummary!
26812. !VolumeStatisticsDetail!
26813. ----------------------------------------------------------
26814. ----------------------------------------------------------
26815. Zone Detailed Report:
26816. ----------------------------------------------------------
26817. !ZoneStatisticsDetail!
26818. ----------------------------------------------------------
26819. ")
26820. 
26821. 
26822. 
26823. 
26824. # *** Moved to setting yours *** 
26825. # (to avoid doing it twice)
26826. # (ie the later wouldn't "overwrite" the former in the usual manner)
26827. 
26828. # Do one or the other:
26829. # DoNotVacate - DO NOT Vacate (recommended)
26830. 
26831. # Vacate
26832. /* AddGap(GapUsedLoc) */
26833. 
26834. # DO Not Vacate
26835. AddGap(GapUsedLoc, DoNotVacate) 
26836. 	
26837. 	
26838. 
26839. # Controlled via settings commands
26840. 
26841. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
26842. 
26843. # Vacate /* AddGap(GapUsed) */
26844. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
26845. 	
26846. 
26847. 		
26848. 	# 
26849. 	FileEnd
26850. /* --------------------------------- */
26851. # your stuff HERE (X)... post zone (file) code.
26852. 
26853. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
26854. # Script: DisplaySetZoneStep
26855. # Increment
26856. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26857. 
26858. # Display this zone step
26859. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
26860. ')
26861. 
26862. # Script: BannerSet
26863. 
26864. # NOTE: Can't round or truncate to integer precision. 
26865. # This internal fields like ZoneCount format really badly.
26866. #  for !RunTimeNow! does not work. None of the date functions do.
26867. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26868. 
26869. SetVariable(HeadingTemp2,	ZoneCount + 0)
26870. 
26871. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
26872. 
26873. Title('!Heading!')
26874. 
26875. /* pause(1) */
26876. 
26877. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
26878. 
26879. 
26880. # Script: DisplaySetWindowText
26881. # Zone Footer Set Statistics Window Text
26882. 
26883. SetStatisticsWindowText("!Heading!
26884. ----------------------------------------------------------
26885. Zones Processed: 
26886. ----------------------------------------------------------
26887. !ZoneListByLine!
26888. ----------------------------------------------------------
26889. Zone Processing Step:
26890. !ZoneStepByLine!    
26891. ----------------------------------------------------------
26892. ----------------------------------------------------------
26893. CURRENT ZONE:
26894. !ZoneStatisticsReport!
26895. ----------------------------------------------------------
26896. ----------------------------------------------------------
26897. ----------------------------------------------------------
26898. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
26899. ----------------------------------------------------------
26900. !VolumeStatisticsSummary!
26901. !VolumeStatisticsDetail!
26902. ----------------------------------------------------------
26903. ----------------------------------------------------------
26904. Zone Detailed Report:
26905. ----------------------------------------------------------
26906. !ZoneStatisticsDetail!
26907. ----------------------------------------------------------
26908. ")
26909. 
26910. 
26911. 
26912. 
26913. # Script: ZoneWhenFinished
26914. 
26915. # Add the zone to the zone details log:
26916. # This is temporarily disable until logging is fixed
26917. # It is performed during file action to preserve the correct (original) calculations.
26918. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
26919. 
26920. # Add the Select and ZoneSteps to the Zone
26921. # Script: ZoneStatisticsAdd
26922. # Append Zone to Details of each zone.
26923. 		
26924. 	# Add Zone Details to Report.	
26925. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
26926. ----------------------------------------------------------
26927. !ZoneStepByLine!
26928. ---------------------------
26929. !ZoneTypeSelectCurrent!               
26930. ---------------------------
26931. ----------------------------------------------------------
26932. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
26933. ----------------------------------------------------------
26934. ')
26935. 
26936. 
26937. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
26938. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
26939. # 2021-12-14 15:30:01
26940. RunProgram("..\Commands\WriteDateTime.bat LastZone")
26941. # Append Datetime to logs
26942. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
26943. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
26944. 
26945. AppendLogfile("!LogFileName!", "!PeriodWord!")
26946. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
26947. AppendLogfile("!LogFileName!", "!PeriodWord!")
26948. 
26949. # Script: DisplaySetWindowText
26950. # Zone Footer Set Statistics Window Text
26951. 
26952. SetStatisticsWindowText("!Heading!
26953. ----------------------------------------------------------
26954. Zones Processed: 
26955. ----------------------------------------------------------
26956. !ZoneListByLine!
26957. ----------------------------------------------------------
26958. Zone Processing Step:
26959. !ZoneStepByLine!    
26960. ----------------------------------------------------------
26961. ----------------------------------------------------------
26962. CURRENT ZONE:
26963. !ZoneStatisticsReport!
26964. ----------------------------------------------------------
26965. ----------------------------------------------------------
26966. ----------------------------------------------------------
26967. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
26968. ----------------------------------------------------------
26969. !VolumeStatisticsSummary!
26970. !VolumeStatisticsDetail!
26971. ----------------------------------------------------------
26972. ----------------------------------------------------------
26973. Zone Detailed Report:
26974. ----------------------------------------------------------
26975. !ZoneStatisticsDetail!
26976. ----------------------------------------------------------
26977. ")
26978. 
26979. 
26980. 
26981. /* pause() */
26982. /* pause() */
26983. 
26984. 
26985. 
26986. /* ------------------------- */
26987. 
26988. 
26989. /* ------------------------- */
26990. 
26991. /* ------------------------- */
26992. /* 9 Zone 17 SystemOtherData System Other and Data */
26993. # Script: DisplayColors - Zone Dark
26994. # Processed
26995. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
26996. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
26997. 
26998. # Light Green and Yellow
26999. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
27000. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
27001. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
27002. 
27003. # Script: DefragZoneTypeSystemOtherData
27004. /* ------------------------- */
27005. /* Zone SystemOtherData System Other and Data */
27006. SetVariable(ZoneLabel,		"!ZoneLabelSystemOtherData!")
27007. SetVariable(ZoneDescription,	"!ZoneDescriptionSystemOtherData!")
27008. SetVariable(ZoneVolRoundUp,		"!ZoneVolRoundUpSystemOtherData!")
27009. SetVariable(ZoneGapSize,		"!ZoneGapSizeSystemOtherData!")
27010. 
27011. SetVariable(ZoneTypeSelect,'
27012. System Other Data:
27013. # Script: ZoneDo ZoneTypeSelectSystemOtherData
27014. # SystemOtherData start.
27015. # NotBlobsArchivesBu start.
27016. # NOT!
27017. (not (
27018. # Blobs start.
27019. (
27020. # BlobsAndExceptions start.
27021. ( not(
27022.   FileName("*.bat")
27023.   or FileName("*.css")
27024.   or FileName("*.dll")
27025.   or FileName("*.exe")
27026.   or FileName("*.htm*")
27027.   or FileName("*.jar")
27028.   or FileName("*.js")
27029.   or FileName("*.script")
27030.   or FileName("*.wsf")
27031.   or (
27032. # Databases start.
27033. (
27034.   FileName("*.crypt*")
27035.   or FileName("*.db*")
27036.   or FileName("*.rdb*")
27037.   or FileName("*.dc*")
27038.   or FileName("*.dict*")
27039.   or FileName("*.?db*")
27040.   or FileName("*.?rdb*")
27041.   or FileName("*.md*")
27042.   or FileName("*.myd")
27043.   or FileName("*.ndf")
27044.   or FileName("*.ns?")
27045.   or FileName("*.pab")
27046.   or FileName("*.pst")
27047.   or FileName("*.sd?*")
27048.   or FileName("*.sq**")
27049.   or FileName("*.tmd")
27050.   or FileName("*.tps")
27051.   or FileName("*.tr*")
27052. )
27053. # Databases end.
27054. 
27055.     # BlobsAndExceptions
27056.     or 
27057. # Data start.
27058. (
27059.   DirectoryName("Data*")
27060.   or DirectoryName("Device*")
27061.   or DirectoryName("Export*")
27062.   or DirectoryName("Import*")
27063.   or DirectoryName("Log*")
27064.   or DirectoryName("*Log")
27065.   or DirectoryName("Maintenance*")
27066.   or DirectoryName("Rec*")
27067.   or DirectoryName("Sales*")
27068.   or DirectoryName("Search*")
27069.   or DirectoryName("User*")
27070. )
27071. # Data end.
27072. 
27073.     # BlobsAndExceptions
27074.   )
27075. ) )
27076. # BlobsAndExceptions end.
27077. 
27078. # Blobs
27079. ) and (
27080.   Size(BlobFileSize,0)
27081.   or (
27082.     FileName("*.arj")
27083.     or FileName("*.bup")
27084.     or FileName("*.bz2")
27085.     or FileName("*.chm")
27086.     or FileName("*.dvr-ms")
27087.     or FileName("*.gz")
27088.     or FileName("*.ifo")
27089.     or FileName("*.lzh")
27090.     or FileName("*.pdf")
27091.     or FileName("*.rpm")
27092.     or FileName("*.wmv")
27093.     or FileName("*.vob")
27094.     or FileName("*.z")
27095.   ) 
27096. )
27097. # Blobs end.
27098. 
27099. # NotBlobsArchivesBu
27100. or 
27101. # Archives start.
27102. (
27103.   DirectoryName("*Archive*")
27104.   or DirectoryName("*History*")
27105.   or DirectoryName("*Old")
27106.   or DirectoryName("* Old *")
27107.   or DirectoryName("Old *")
27108. 
27109.   or FileName("*.7z")
27110.   or FileName("*.cab")
27111.   or FileName("*.iso")
27112.   or FileName("*.msi")
27113.   or FileName("*.old")
27114.   or FileName("*.rar")
27115.   or FileName("*.tar")
27116.   or FileName("*.zip")
27117.   or
27118. # WinSysLow start.
27119. (
27120.   # Bad idea. This pushed lots of programs and data to archive.
27121.   # DirectoryName("$*")
27122.   # or DirectoryName("0*")
27123.   # or DirectoryName("1*")
27124.   # or DirectoryName("2*")
27125.   # or DirectoryName("3*")
27126.   # or DirectoryName("4*")
27127.   # or DirectoryName("5*")
27128.   # or DirectoryName("6*")
27129.   # or DirectoryName("7*")
27130.   # or DirectoryName("8*")
27131.   # or DirectoryName("9*")
27132.   # or 
27133.   DirectoryName("dllcache")
27134.   or DirectoryName("Downloaded Installations")
27135.   or DirectoryName("Ehome")
27136.   or DirectoryName("Fonts")
27137.   or DirectoryName("Help")
27138.   or DirectoryName("I386")
27139.   or DirectoryName("ie?updates")
27140.   or DirectoryName("Installer")
27141.   or DirectoryName("Installshield Installation Information")
27142.   or DirectoryName("IME")
27143.   or DirectoryName("*RECYCLE*")
27144.   or DirectoryName("ServicePackFiles")
27145.   or DirectoryName("SoftwareDistribution")
27146.   or DirectoryName("Speech")
27147.   or DirectoryName("Symbols")
27148.   or DirectoryName("System Volume Information")
27149.   or DirectoryName("windows.old")
27150. )
27151. # WinSysLow end.
27152. 
27153.   # Archives
27154. )
27155. # Archives end.
27156. 
27157. # NotBlobsArchivesBu
27158. or
27159. # Backups start.
27160. (
27161.   DirectoryName("*Backup*")
27162.   or DirectoryName("*Bu")
27163.   or DirectoryName("* Bu *")
27164.   or DirectoryName("Bu *")
27165. 
27166.   or FileName("*.bak")
27167.   or FileName("* - Copy*")
27168. )
27169. # Backups end.
27170. 
27171. or 
27172. FileName("ReferenceMarker.MyDx")
27173. # NotBlobsArchivesBu
27174. ) )
27175. # NotBlobsArchivesBu end.
27176. 
27177. # SystemOtherData
27178. and ( 
27179. # Data start.
27180. (
27181.   DirectoryName("Data*")
27182.   or DirectoryName("Device*")
27183.   or DirectoryName("Export*")
27184.   or DirectoryName("Import*")
27185.   or DirectoryName("Log*")
27186.   or DirectoryName("*Log")
27187.   or DirectoryName("Maintenance*")
27188.   or DirectoryName("Rec*")
27189.   or DirectoryName("Sales*")
27190.   or DirectoryName("Search*")
27191.   or DirectoryName("User*")
27192. )
27193. # Data end.
27194.  
27195. # SystemOtherData
27196. or  
27197. # Databases start.
27198. (
27199.   FileName("*.crypt*")
27200.   or FileName("*.db*")
27201.   or FileName("*.rdb*")
27202.   or FileName("*.dc*")
27203.   or FileName("*.dict*")
27204.   or FileName("*.?db*")
27205.   or FileName("*.?rdb*")
27206.   or FileName("*.md*")
27207.   or FileName("*.myd")
27208.   or FileName("*.ndf")
27209.   or FileName("*.ns?")
27210.   or FileName("*.pab")
27211.   or FileName("*.pst")
27212.   or FileName("*.sd?*")
27213.   or FileName("*.sq**")
27214.   or FileName("*.tmd")
27215.   or FileName("*.tps")
27216.   or FileName("*.tr*")
27217. )
27218. # Databases end.
27219. 
27220. # SystemOtherData
27221. )
27222. # SystemOtherData end.
27223. 
27224. ')
27225. 
27226. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
27227. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
27228. 
27229. SetVariable(ZoneStepNoCurrent, 0)
27230. 
27231. 	/* ------------------------- */
27232. # Script: ZoneDoHeader
27233. 
27234. # Script: ZoneWhenStarted
27235. RunProgram("..\Commands\WriteDateTime.bat")
27236. 
27237. # Script: ZoneDoCurrentClear
27238. 
27239. SetVariable(ZoneTypeSelectCurrent, 		"")
27240. SetVariable(ZoneStatisticsData, 		"")
27241. SetVariable(ZoneStepByLine, 			"")
27242. 
27243. SetVariable(ZoneBeginCurrent, 			0)
27244. SetVariable(ZoneBeginPerCurrent, 		0)
27245. SetVariable(ZoneEndCurrent, 			0)
27246. SetVariable(ZoneEndPerCurrent, 			0)
27247. 
27248. SetVariable(ZoneSizeCurrent,			0)
27249. SetVariable(ZoneSizePerCurrent,			0)
27250. 
27251. SetVariable(ZoneGapRequestedCurrent,	0)
27252. SetVariable(ZoneGapRoundedCurrent, 		0)
27253. SetVariable(ZoneGapAdjustedCurrent, 	0)
27254. SetVariable(ZoneGapAvailableCurrent, 	0)
27255. SetVariable(ZoneGapCurrent,				0)
27256. SetVariable(ZoneGapUsedCurrent, 		0)
27257. 
27258. SetVariable(ZoneGapActualCurrent, 		0)
27259. SetVariable(ZoneGapActualPerCurrent, 	0)
27260. 
27261. SetVariable(ZoneSizeActual, 			0)
27262. SetVariable(ZoneSizeActualCurrent,		0)
27263. 
27264. SetVariable(ZoneEndActual, 				0)
27265. SetVariable(ZoneEndActualCurrent,		0)			
27266. SetVariable(ZoneSizeActualPerCurrent, 	0)
27267.       
27268. SetVariable(ZoneFilesFolders,			0)
27269. SetVariable(ZoneFilesFoldersPer,		0) 
27270. 
27271. SetVariable(ZoneFragments,				0)
27272. SetVariable(ZoneFragmentsPer,			0) 
27273. 		
27274. SetVariable(ZoneEndActualCurrent, 		0)
27275. SetVariable(ZoneEndActualPerCurrent, 	0)
27276. 
27277. # Gap Calculation Methodology:
27278. 	# Requested
27279. 	SetVariable(GapRequested, 			0) 
27280. 	SetVariable(GapRequestedStd, 		0) 
27281. 	SetVariable(GapRequestedMft, 		0) 
27282. 	SetVariable(GapRequestedOs, 		0) 
27283. 	SetVariable(GapRequestedOriginal, 	0) 
27284. 	
27285. 	# Gap Adjustments
27286. 	SetVariable(GapRounded, 			0)
27287. 	# SetVariable(GapAdjusted, 			0)
27288. 	SetVariable(GapAvailable, 			0)
27289. 	SetVariable(GapCurrent, 			0)
27290. 	SetVariable(GapActual, 				0)
27291. 	SetVariable(GapUsed, 				0)
27292. 	
27293. 	# Gap Adjustments
27294. 	SetVariable(GapRoundedLoc, 			0)
27295. 	# SetVariable(GapAdjustedLoc, 		0)
27296. 	SetVariable(GapAvailableLoc, 		0)
27297. 	SetVariable(GapCurrentLoc, 			0)
27298. 	SetVariable(GapActualLoc,			0)
27299. 	SetVariable(GapUsedLoc,				0)
27300. 	
27301. 	# Space usage
27302. 	SetVariable(ZoneFreePerRequested, 	0)
27303. 	SetVariable(ZoneFreePerUsed, 		0)
27304. 
27305. # Gap Size & Rounding
27306. 	SetVariable(ZoneGapSizePer, 		0)
27307. 	SetVariable(ZoneVolRoundUpPer, 		0)
27308. 	
27309. 	# Free Space
27310. 	SetVariable(ZoneFreeUsedPer, 		0)
27311. 	SetVariable(ZoneFreeRequestedPer, 	0)
27312. 
27313. # Script: DisplaySetZone
27314. 
27315. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
27316. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
27317. 
27318. # Message ZoneSummary
27319. # SetVariable(ZoneSummary, '
27320. # Zone Summary:
27321. # ')
27322. # Zone processing steps
27323. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
27324. # ')
27325. 
27326. # # Script: BannerDescriptionSet
27327. 
27328. # Script: BannerSet
27329. 
27330. # NOTE: Can't round or truncate to integer precision. 
27331. # This internal fields like ZoneCount format really badly.
27332. #  for !RunTimeNow! does not work. None of the date functions do.
27333. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
27334. 
27335. SetVariable(HeadingTemp2,	ZoneCount + 0)
27336. 
27337. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27338. 
27339. Title('!Heading!')
27340. 
27341. /* pause(1) */
27342. 
27343. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27344. 
27345. 
27346. # Script: BannerLog
27347. 
27348. AppendLogfile("!LogFileName!", "!Heading!")
27349. 
27350. 
27351. 
27352. # pause(1)
27353. 
27354. 
27355. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
27356. # Script: DisplaySetZoneStep
27357. # Increment
27358. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27359. 
27360. # Display this zone step
27361. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
27362. ')
27363. 
27364. # Script: BannerSet
27365. 
27366. # NOTE: Can't round or truncate to integer precision. 
27367. # This internal fields like ZoneCount format really badly.
27368. #  for !RunTimeNow! does not work. None of the date functions do.
27369. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
27370. 
27371. SetVariable(HeadingTemp2,	ZoneCount + 0)
27372. 
27373. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27374. 
27375. Title('!Heading!')
27376. 
27377. /* pause(1) */
27378. 
27379. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27380. 
27381. 
27382. # Script: DisplaySetWindowText
27383. # Zone Footer Set Statistics Window Text
27384. 
27385. SetStatisticsWindowText("!Heading!
27386. ----------------------------------------------------------
27387. Zones Processed: 
27388. ----------------------------------------------------------
27389. !ZoneListByLine!
27390. ----------------------------------------------------------
27391. Zone Processing Step:
27392. !ZoneStepByLine!    
27393. ----------------------------------------------------------
27394. ----------------------------------------------------------
27395. CURRENT ZONE:
27396. !ZoneStatisticsReport!
27397. ----------------------------------------------------------
27398. ----------------------------------------------------------
27399. ----------------------------------------------------------
27400. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
27401. ----------------------------------------------------------
27402. !VolumeStatisticsSummary!
27403. !VolumeStatisticsDetail!
27404. ----------------------------------------------------------
27405. ----------------------------------------------------------
27406. Zone Detailed Report:
27407. ----------------------------------------------------------
27408. !ZoneStatisticsDetail!
27409. ----------------------------------------------------------
27410. ")
27411. 
27412. 
27413. 
27414. 
27415. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
27416. 
27417. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
27418. # Script: DisplaySetZoneStep
27419. # Increment
27420. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27421. 
27422. # Display this zone step
27423. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
27424. ')
27425. 
27426. # Script: BannerSet
27427. 
27428. # NOTE: Can't round or truncate to integer precision. 
27429. # This internal fields like ZoneCount format really badly.
27430. #  for !RunTimeNow! does not work. None of the date functions do.
27431. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
27432. 
27433. SetVariable(HeadingTemp2,	ZoneCount + 0)
27434. 
27435. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27436. 
27437. Title('!Heading!')
27438. 
27439. /* pause(1) */
27440. 
27441. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27442. 
27443. 
27444. # Script: DisplaySetWindowText
27445. # Zone Footer Set Statistics Window Text
27446. 
27447. SetStatisticsWindowText("!Heading!
27448. ----------------------------------------------------------
27449. Zones Processed: 
27450. ----------------------------------------------------------
27451. !ZoneListByLine!
27452. ----------------------------------------------------------
27453. Zone Processing Step:
27454. !ZoneStepByLine!    
27455. ----------------------------------------------------------
27456. ----------------------------------------------------------
27457. CURRENT ZONE:
27458. !ZoneStatisticsReport!
27459. ----------------------------------------------------------
27460. ----------------------------------------------------------
27461. ----------------------------------------------------------
27462. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
27463. ----------------------------------------------------------
27464. !VolumeStatisticsSummary!
27465. !VolumeStatisticsDetail!
27466. ----------------------------------------------------------
27467. ----------------------------------------------------------
27468. Zone Detailed Report:
27469. ----------------------------------------------------------
27470. !ZoneStatisticsDetail!
27471. ----------------------------------------------------------
27472. ")
27473. 
27474. 
27475. 
27476. 
27477. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
27478. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
27479. 
27480. # Script: BannerSet
27481. 
27482. # NOTE: Can't round or truncate to integer precision. 
27483. # This internal fields like ZoneCount format really badly.
27484. #  for !RunTimeNow! does not work. None of the date functions do.
27485. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
27486. 
27487. SetVariable(HeadingTemp2,	ZoneCount + 0)
27488. 
27489. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27490. 
27491. Title('!Heading!')
27492. 
27493. /* pause(1) */
27494. 
27495. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27496. 
27497. 
27498. # Script: BannerLog
27499. 
27500. AppendLogfile("!LogFileName!", "!Heading!")
27501. 
27502. 
27503. 
27504. # LOGGING:
27505. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
27506. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
27507. 
27508. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
27509. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:01")
27510. # 2021-12-14 15:30:01 
27511. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:06 !ZoneLabel! !ZoneDescription!")
27512. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
27513. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:06 !ZoneLabel! !ZoneDescription!")
27514. 
27515. 
27516. # Add zone to list of zones:
27517. SetVariable(ZoneListByLine, "!ZoneListByLine!
27518. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
27519. # Script: DisplaySetWindowText
27520. # Zone Footer Set Statistics Window Text
27521. 
27522. SetStatisticsWindowText("!Heading!
27523. ----------------------------------------------------------
27524. Zones Processed: 
27525. ----------------------------------------------------------
27526. !ZoneListByLine!
27527. ----------------------------------------------------------
27528. Zone Processing Step:
27529. !ZoneStepByLine!    
27530. ----------------------------------------------------------
27531. ----------------------------------------------------------
27532. CURRENT ZONE:
27533. !ZoneStatisticsReport!
27534. ----------------------------------------------------------
27535. ----------------------------------------------------------
27536. ----------------------------------------------------------
27537. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
27538. ----------------------------------------------------------
27539. !VolumeStatisticsSummary!
27540. !VolumeStatisticsDetail!
27541. ----------------------------------------------------------
27542. ----------------------------------------------------------
27543. Zone Detailed Report:
27544. ----------------------------------------------------------
27545. !ZoneStatisticsDetail!
27546. ----------------------------------------------------------
27547. ")
27548. 
27549. 
27550. 
27551. 
27552. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
27553. # Script: DisplaySetZoneStep
27554. # Increment
27555. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27556. 
27557. # Display this zone step
27558. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
27559. ')
27560. 
27561. # Script: BannerSet
27562. 
27563. # NOTE: Can't round or truncate to integer precision. 
27564. # This internal fields like ZoneCount format really badly.
27565. #  for !RunTimeNow! does not work. None of the date functions do.
27566. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
27567. 
27568. SetVariable(HeadingTemp2,	ZoneCount + 0)
27569. 
27570. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27571. 
27572. Title('!Heading!')
27573. 
27574. /* pause(1) */
27575. 
27576. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27577. 
27578. 
27579. # Script: DisplaySetWindowText
27580. # Zone Footer Set Statistics Window Text
27581. 
27582. SetStatisticsWindowText("!Heading!
27583. ----------------------------------------------------------
27584. Zones Processed: 
27585. ----------------------------------------------------------
27586. !ZoneListByLine!
27587. ----------------------------------------------------------
27588. Zone Processing Step:
27589. !ZoneStepByLine!    
27590. ----------------------------------------------------------
27591. ----------------------------------------------------------
27592. CURRENT ZONE:
27593. !ZoneStatisticsReport!
27594. ----------------------------------------------------------
27595. ----------------------------------------------------------
27596. ----------------------------------------------------------
27597. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
27598. ----------------------------------------------------------
27599. !VolumeStatisticsSummary!
27600. !VolumeStatisticsDetail!
27601. ----------------------------------------------------------
27602. ----------------------------------------------------------
27603. Zone Detailed Report:
27604. ----------------------------------------------------------
27605. !ZoneStatisticsDetail!
27606. ----------------------------------------------------------
27607. ")
27608. 
27609. 
27610. 
27611. 
27612. # your stuff HERE (X)... pre file select code.
27613. 
27614. /* --------------------------------- */
27615. 	FileSelect
27616. 
27617. 		# your stuff can't really go here (errors.)
27618. 		# maybe for some reason I don't know of...
27619. 	
27620. 		# Actions next...
27621. 	# Script: ZoneDo ZoneTypeSelectSystemOtherData
27622. # SystemOtherData start.
27623. # NotBlobsArchivesBu start.
27624. # NOT!
27625. (not (
27626. # Blobs start.
27627. (
27628. # BlobsAndExceptions start.
27629. ( not(
27630.   FileName("*.bat")
27631.   or FileName("*.css")
27632.   or FileName("*.dll")
27633.   or FileName("*.exe")
27634.   or FileName("*.htm*")
27635.   or FileName("*.jar")
27636.   or FileName("*.js")
27637.   or FileName("*.script")
27638.   or FileName("*.wsf")
27639.   or (
27640. # Databases start.
27641. (
27642.   FileName("*.crypt*")
27643.   or FileName("*.db*")
27644.   or FileName("*.rdb*")
27645.   or FileName("*.dc*")
27646.   or FileName("*.dict*")
27647.   or FileName("*.?db*")
27648.   or FileName("*.?rdb*")
27649.   or FileName("*.md*")
27650.   or FileName("*.myd")
27651.   or FileName("*.ndf")
27652.   or FileName("*.ns?")
27653.   or FileName("*.pab")
27654.   or FileName("*.pst")
27655.   or FileName("*.sd?*")
27656.   or FileName("*.sq**")
27657.   or FileName("*.tmd")
27658.   or FileName("*.tps")
27659.   or FileName("*.tr*")
27660. )
27661. # Databases end.
27662. 
27663.     # BlobsAndExceptions
27664.     or 
27665. # Data start.
27666. (
27667.   DirectoryName("Data*")
27668.   or DirectoryName("Device*")
27669.   or DirectoryName("Export*")
27670.   or DirectoryName("Import*")
27671.   or DirectoryName("Log*")
27672.   or DirectoryName("*Log")
27673.   or DirectoryName("Maintenance*")
27674.   or DirectoryName("Rec*")
27675.   or DirectoryName("Sales*")
27676.   or DirectoryName("Search*")
27677.   or DirectoryName("User*")
27678. )
27679. # Data end.
27680. 
27681.     # BlobsAndExceptions
27682.   )
27683. ) )
27684. # BlobsAndExceptions end.
27685. 
27686. # Blobs
27687. ) and (
27688.   Size(BlobFileSize,0)
27689.   or (
27690.     FileName("*.arj")
27691.     or FileName("*.bup")
27692.     or FileName("*.bz2")
27693.     or FileName("*.chm")
27694.     or FileName("*.dvr-ms")
27695.     or FileName("*.gz")
27696.     or FileName("*.ifo")
27697.     or FileName("*.lzh")
27698.     or FileName("*.pdf")
27699.     or FileName("*.rpm")
27700.     or FileName("*.wmv")
27701.     or FileName("*.vob")
27702.     or FileName("*.z")
27703.   ) 
27704. )
27705. # Blobs end.
27706. 
27707. # NotBlobsArchivesBu
27708. or 
27709. # Archives start.
27710. (
27711.   DirectoryName("*Archive*")
27712.   or DirectoryName("*History*")
27713.   or DirectoryName("*Old")
27714.   or DirectoryName("* Old *")
27715.   or DirectoryName("Old *")
27716. 
27717.   or FileName("*.7z")
27718.   or FileName("*.cab")
27719.   or FileName("*.iso")
27720.   or FileName("*.msi")
27721.   or FileName("*.old")
27722.   or FileName("*.rar")
27723.   or FileName("*.tar")
27724.   or FileName("*.zip")
27725.   or
27726. # WinSysLow start.
27727. (
27728.   # Bad idea. This pushed lots of programs and data to archive.
27729.   # DirectoryName("$*")
27730.   # or DirectoryName("0*")
27731.   # or DirectoryName("1*")
27732.   # or DirectoryName("2*")
27733.   # or DirectoryName("3*")
27734.   # or DirectoryName("4*")
27735.   # or DirectoryName("5*")
27736.   # or DirectoryName("6*")
27737.   # or DirectoryName("7*")
27738.   # or DirectoryName("8*")
27739.   # or DirectoryName("9*")
27740.   # or 
27741.   DirectoryName("dllcache")
27742.   or DirectoryName("Downloaded Installations")
27743.   or DirectoryName("Ehome")
27744.   or DirectoryName("Fonts")
27745.   or DirectoryName("Help")
27746.   or DirectoryName("I386")
27747.   or DirectoryName("ie?updates")
27748.   or DirectoryName("Installer")
27749.   or DirectoryName("Installshield Installation Information")
27750.   or DirectoryName("IME")
27751.   or DirectoryName("*RECYCLE*")
27752.   or DirectoryName("ServicePackFiles")
27753.   or DirectoryName("SoftwareDistribution")
27754.   or DirectoryName("Speech")
27755.   or DirectoryName("Symbols")
27756.   or DirectoryName("System Volume Information")
27757.   or DirectoryName("windows.old")
27758. )
27759. # WinSysLow end.
27760. 
27761.   # Archives
27762. )
27763. # Archives end.
27764. 
27765. # NotBlobsArchivesBu
27766. or
27767. # Backups start.
27768. (
27769.   DirectoryName("*Backup*")
27770.   or DirectoryName("*Bu")
27771.   or DirectoryName("* Bu *")
27772.   or DirectoryName("Bu *")
27773. 
27774.   or FileName("*.bak")
27775.   or FileName("* - Copy*")
27776. )
27777. # Backups end.
27778. 
27779. or 
27780. FileName("ReferenceMarker.MyDx")
27781. # NotBlobsArchivesBu
27782. ) )
27783. # NotBlobsArchivesBu end.
27784. 
27785. # SystemOtherData
27786. and ( 
27787. # Data start.
27788. (
27789.   DirectoryName("Data*")
27790.   or DirectoryName("Device*")
27791.   or DirectoryName("Export*")
27792.   or DirectoryName("Import*")
27793.   or DirectoryName("Log*")
27794.   or DirectoryName("*Log")
27795.   or DirectoryName("Maintenance*")
27796.   or DirectoryName("Rec*")
27797.   or DirectoryName("Sales*")
27798.   or DirectoryName("Search*")
27799.   or DirectoryName("User*")
27800. )
27801. # Data end.
27802.  
27803. # SystemOtherData
27804. or  
27805. # Databases start.
27806. (
27807.   FileName("*.crypt*")
27808.   or FileName("*.db*")
27809.   or FileName("*.rdb*")
27810.   or FileName("*.dc*")
27811.   or FileName("*.dict*")
27812.   or FileName("*.?db*")
27813.   or FileName("*.?rdb*")
27814.   or FileName("*.md*")
27815.   or FileName("*.myd")
27816.   or FileName("*.ndf")
27817.   or FileName("*.ns?")
27818.   or FileName("*.pab")
27819.   or FileName("*.pst")
27820.   or FileName("*.sd?*")
27821.   or FileName("*.sq**")
27822.   or FileName("*.tmd")
27823.   or FileName("*.tps")
27824.   or FileName("*.tr*")
27825. )
27826. # Databases end.
27827. 
27828. # SystemOtherData
27829. )
27830. # SystemOtherData end.
27831. 
27832. 	# Script: ZoneDoAction
27833. # Zone Do File Action - SortByName.
27834. 
27835. 	FileActions
27836. 
27837. 			# Script: GapZoneCalc
27838. 	# Gap
27839. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
27840. 		# Script: DisplaySetZoneStep
27841. # Increment
27842. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27843. 
27844. # Display this zone step
27845. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
27846. ')
27847. 
27848. # Script: BannerSet
27849. 
27850. # NOTE: Can't round or truncate to integer precision. 
27851. # This internal fields like ZoneCount format really badly.
27852. #  for !RunTimeNow! does not work. None of the date functions do.
27853. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
27854. 
27855. SetVariable(HeadingTemp2,	ZoneCount + 0)
27856. 
27857. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27858. 
27859. Title('!Heading!')
27860. 
27861. /* pause(1) */
27862. 
27863. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
27864. 
27865. 
27866. # Script: DisplaySetWindowText
27867. # Zone Footer Set Statistics Window Text
27868. 
27869. SetStatisticsWindowText("!Heading!
27870. ----------------------------------------------------------
27871. Zones Processed: 
27872. ----------------------------------------------------------
27873. !ZoneListByLine!
27874. ----------------------------------------------------------
27875. Zone Processing Step:
27876. !ZoneStepByLine!    
27877. ----------------------------------------------------------
27878. ----------------------------------------------------------
27879. CURRENT ZONE:
27880. !ZoneStatisticsReport!
27881. ----------------------------------------------------------
27882. ----------------------------------------------------------
27883. ----------------------------------------------------------
27884. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
27885. ----------------------------------------------------------
27886. !VolumeStatisticsSummary!
27887. !VolumeStatisticsDetail!
27888. ----------------------------------------------------------
27889. ----------------------------------------------------------
27890. Zone Detailed Report:
27891. ----------------------------------------------------------
27892. !ZoneStatisticsDetail!
27893. ----------------------------------------------------------
27894. ")
27895. 
27896. 
27897. 
27898. 	
27899. 	# ACTUAL GAP
27900. 		/* AddGap Variant. */
27901. 	  	# Script: GapZoneSet
27902. # Zone Do Gap
27903. # Gap Calculation Methods:
27904. 
27905. /* 1) Anything you need to add first. */
27906. /* empty */
27907. 
27908. /* ------------------------- */
27909. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
27910. 	# GapRequestedStd.
27911. 
27912. 		/* ------------------------- */
27913. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
27914. 
27915. 		# Gap Calculation Methods:
27916. 
27917. /* AddGap Variants */
27918. 
27919. 	/* Standard */
27920. 		# Gap Calculation Methods:
27921. 	/* AddGap Variants */
27922. 	/* Standard */
27923. 
27924. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
27925. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
27926. 
27927. 	SetVariable(GapRequested, GapRequestedStd)
27928. 	
27929. 
27930. 	/* MFT Low High Method */
27931. 		# Gap Calculation Methods:
27932. 	/* AddGap Variants */
27933. 	/* MFT Low High Method */
27934. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
27935. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
27936. 	SetVariable(GapRequested, GapRequestedMft)
27937. 	
27938. 
27939. 	/* OS Volume Type Method */
27940. 		# Gap Calculation Methods:
27941. 	/* AddGap Variants */
27942. 	/* OS Volume Type Method */
27943. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
27944. 	SetVariable(GapRequested, GapRequestedOs)
27945. 
27946. 
27947. 
27948. /* MakeGap Variants */
27949. 
27950. 	/* Original Os 1-3 + MFT 2 */
27951. 		# Gap Calculation Methods:
27952. 	/* MakeGap Variants */
27953. 	/* Original Os 1-3 + MFT 2 */
27954. 	/* plus MFT gap placed inline at the dividing zone. */
27955. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
27956. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
27957. 	SetVariable(GapRequested, GapRequestedOrig)
27958. 	
27959. 	
27960. /* Note: You could comment out the ones not in use */
27961. /* However having the data in the log is useful. */
27962. /* Therefore the following line is otherwise needed. */
27963. 
27964. /* Standard used */
27965. 
27966. SetVariable(GapRequested, GapRequestedStd)
27967. 
27968. # Gap Calculation Methods:
27969. 
27970. /* AddGap Variants */
27971. 	/* Standard */
27972. 	/* MFT Low High Method */
27973. 	/* OS Volume Type Method */
27974. 
27975. /* MakeGap Variants */
27976. 	/* Original Os 1-3 + MFT 2 */
27977. 
27978. /* Note: You could comment out the ones not in use */
27979. /* However having the data in the log is useful. */
27980. /* Therefore the following line is otherwise needed. */
27981. 
27982. /* Standard is used currently */
27983. 
27984. 
27985. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
27986. 
27987. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
27988. 
27989. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
27990. 
27991. /* ------------------------- */
27992. /* 3) SMALL ZONE ADJUSTMENT. */
27993. /* Gab cant be larger than half the Zone Size. */
27994. 
27995. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
27996. 	
27997. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
27998. 
27999. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
28000. 
28001. /* ------------------------- */
28002. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
28003. # Gap Adjustments.
28004. 
28005. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
28006. 	
28007. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
28008. 
28009. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
28010. 
28011. /* ------------------------- */
28012. # BYPASS THIS.
28013. 	/* This is definitely wrong. */
28014. 	/* The question is can we steal gap from the next zone */
28015. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
28016. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
28017. 		# Zone Overflow.
28018. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
28019. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
28020. 
28021. /* ------------------------- */
28022. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
28023. # Remaining free space available.
28024. 
28025. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
28026. 	
28027. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
28028. 
28029. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
28030. 
28031. /* ------------------------- */
28032. # CURRENT gap to use.
28033. 
28034. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
28035. 
28036. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
28037. 
28038. /* ------------------------- */
28039. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
28040. # Debugging.
28041. 
28042. 	SetVariable(GapUsed, GapCurrent) // for debugging
28043. 
28044. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
28045. 
28046. 		# Your code HERE
28047. 
28048. /* ------------------------- */
28049. /* 7) YOUR CODE. */
28050. # YOUR CODE HERE:
28051. 	# INPUT: GapCurrent or GapCurrentLoc
28052. 	# OUTPUT: GapUsed...
28053. 
28054. /* ------------------------- */
28055. # Gap Size.
28056. # Actual Size of Gap.
28057. 
28058. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
28059. 
28060. /* ------------------------- */
28061. 
28062. 	
28063. 	# Zone Statistics	
28064. 		# Script: ZoneStatisticsGet
28065. # Zone / Volume Statistics and Display
28066. 		
28067. 	# Accumulate Totals
28068.   	# Script: ZoneDoVolumeTotals
28069. 
28070. /* Current total space used (by Zones and Gaps) */
28071. 
28072. SetVariable(VolumeZoneUsed, GapUsed)
28073. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
28074. /* Percentage */
28075. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
28076. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
28077. 
28078. /* Current total of free space requested */
28079. 
28080. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
28081. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
28082. /* Percent. */
28083. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
28084. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
28085. 
28086. /* Current total of free space used */
28087. 
28088. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
28089. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
28090. /* Percent */
28091. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
28092. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
28093. 
28094. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
28095. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
28096. # Xinclude "..\DebugDisplayPause.MyDc"X
28097. 
28098. 
28099. 	# Current Values
28100. 	# Script: ZoneDoCurrentSet
28101. 
28102. # Cluster, Sector, Block adjust for display.
28103. 	# Bytes per cluster is volume specific.
28104. 
28105. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
28106. 
28107. # Current Zone values.
28108. 	# Begin, end and size.
28109. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
28110. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
28111. 
28112. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
28113. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
28114. 
28115. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
28116. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
28117. 
28118. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
28119. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
28120. 
28121. 	SetVariable(ZoneFragments,				"!ZONE210N!")
28122. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
28123. 		
28124. # Current Gap, Actual and Free Values
28125. 	# Gap
28126. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
28127. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
28128. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
28129. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
28130. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
28131. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
28132. 	
28133. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
28134. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
28135. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
28136. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
28137. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
28138. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
28139. 	
28140. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
28141. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
28142. 	
28143. 	# Actual Size and End
28144. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
28145. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
28146. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
28147. 	
28148. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
28149. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
28150. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
28151. 
28152. # Gap Size & Rounding
28153. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
28154. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
28155. 	
28156. 	# Free Space
28157. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
28158. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
28159. 
28160. 	# Script: ZoneStatisticsReportGet
28161. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
28162. 
28163. # Footer:
28164. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
28165. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
28166. #
28167. # Xinclude "..\Commands\DateTimeLastLong.txt"X
28168. #
28169. # What a mess this word based vs is. Try a phrase based version ToDo
28170. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
28171. ------------------
28172.    !SizeWord!!ColonWord!  
28173.    ------------------------
28174.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
28175.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
28176.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
28177. 
28178.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
28179.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
28180. 
28181.    !LocationWord!!ColonWord!
28182.    ------------------------
28183.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
28184.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
28185.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
28186.       
28187.    !GapWordCaps! !SettingsWord!!ColonWord!
28188.    ------------------------
28189.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
28190.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
28191.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
28192.                  
28193.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
28194.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
28195.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
28196.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
28197.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
28198.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
28199.      
28200.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
28201.    ------------------------
28202.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
28203.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
28204.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
28205. 
28206. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
28207. ----------------------------------------------------------
28208. ")
28209. #
28210. SetVariable(DateNow, 	DATETIME)
28211. SetVariable(TimeNow, 	Time)
28212. SetVariable(RunTimeNow, 	RunTime)
28213. 
28214. 
28215. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
28216. 
28217. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
28218. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
28219. 
28220. 	# Script: DisplaySetWindowText
28221. # Zone Footer Set Statistics Window Text
28222. 
28223. SetStatisticsWindowText("!Heading!
28224. ----------------------------------------------------------
28225. Zones Processed: 
28226. ----------------------------------------------------------
28227. !ZoneListByLine!
28228. ----------------------------------------------------------
28229. Zone Processing Step:
28230. !ZoneStepByLine!    
28231. ----------------------------------------------------------
28232. ----------------------------------------------------------
28233. CURRENT ZONE:
28234. !ZoneStatisticsReport!
28235. ----------------------------------------------------------
28236. ----------------------------------------------------------
28237. ----------------------------------------------------------
28238. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
28239. ----------------------------------------------------------
28240. !VolumeStatisticsSummary!
28241. !VolumeStatisticsDetail!
28242. ----------------------------------------------------------
28243. ----------------------------------------------------------
28244. Zone Detailed Report:
28245. ----------------------------------------------------------
28246. !ZoneStatisticsDetail!
28247. ----------------------------------------------------------
28248. ")
28249. 
28250. 
28251. 	
28252. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
28253. 
28254. 
28255. 	SetVariable(ZoneStatisticsData, 
28256. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
28257.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
28258.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
28259. 
28260. 
28261. 
28262.  		# Script: ZoneStatisticsDisplay
28263. 	
28264. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
28265. !ZoneStatisticsData!
28266. ')
28267. 
28268. 		# Script: ZoneStatisticsAdd
28269. # Append Zone to Details of each zone.
28270. 		
28271. 	# Add Zone Details to Report.	
28272. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
28273. !ZoneStatisticsReport!
28274. ')
28275. 
28276. 	
28277. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
28278. 		# Script: DisplaySetZoneStep
28279. # Increment
28280. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
28281. 
28282. # Display this zone step
28283. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
28284. ')
28285. 
28286. # Script: BannerSet
28287. 
28288. # NOTE: Can't round or truncate to integer precision. 
28289. # This internal fields like ZoneCount format really badly.
28290. #  for !RunTimeNow! does not work. None of the date functions do.
28291. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
28292. 
28293. SetVariable(HeadingTemp2,	ZoneCount + 0)
28294. 
28295. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
28296. 
28297. Title('!Heading!')
28298. 
28299. /* pause(1) */
28300. 
28301. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
28302. 
28303. 
28304. # Script: DisplaySetWindowText
28305. # Zone Footer Set Statistics Window Text
28306. 
28307. SetStatisticsWindowText("!Heading!
28308. ----------------------------------------------------------
28309. Zones Processed: 
28310. ----------------------------------------------------------
28311. !ZoneListByLine!
28312. ----------------------------------------------------------
28313. Zone Processing Step:
28314. !ZoneStepByLine!    
28315. ----------------------------------------------------------
28316. ----------------------------------------------------------
28317. CURRENT ZONE:
28318. !ZoneStatisticsReport!
28319. ----------------------------------------------------------
28320. ----------------------------------------------------------
28321. ----------------------------------------------------------
28322. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
28323. ----------------------------------------------------------
28324. !VolumeStatisticsSummary!
28325. !VolumeStatisticsDetail!
28326. ----------------------------------------------------------
28327. ----------------------------------------------------------
28328. Zone Detailed Report:
28329. ----------------------------------------------------------
28330. !ZoneStatisticsDetail!
28331. ----------------------------------------------------------
28332. ")
28333. 
28334. 
28335. 
28336. 
28337. 		# File Action - All - Full -  SortByCreationDate
28338. # File Action - ZoneDoActionSortByCreationDateFull
28339. 	SortByCreationDate(Ascending)
28340. 	
28341. 
28342. 
28343. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
28344. 		# Script: DisplaySetZoneStep
28345. # Increment
28346. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
28347. 
28348. # Display this zone step
28349. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
28350. ')
28351. 
28352. # Script: BannerSet
28353. 
28354. # NOTE: Can't round or truncate to integer precision. 
28355. # This internal fields like ZoneCount format really badly.
28356. #  for !RunTimeNow! does not work. None of the date functions do.
28357. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
28358. 
28359. SetVariable(HeadingTemp2,	ZoneCount + 0)
28360. 
28361. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
28362. 
28363. Title('!Heading!')
28364. 
28365. /* pause(1) */
28366. 
28367. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
28368. 
28369. 
28370. # Script: DisplaySetWindowText
28371. # Zone Footer Set Statistics Window Text
28372. 
28373. SetStatisticsWindowText("!Heading!
28374. ----------------------------------------------------------
28375. Zones Processed: 
28376. ----------------------------------------------------------
28377. !ZoneListByLine!
28378. ----------------------------------------------------------
28379. Zone Processing Step:
28380. !ZoneStepByLine!    
28381. ----------------------------------------------------------
28382. ----------------------------------------------------------
28383. CURRENT ZONE:
28384. !ZoneStatisticsReport!
28385. ----------------------------------------------------------
28386. ----------------------------------------------------------
28387. ----------------------------------------------------------
28388. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
28389. ----------------------------------------------------------
28390. !VolumeStatisticsSummary!
28391. !VolumeStatisticsDetail!
28392. ----------------------------------------------------------
28393. ----------------------------------------------------------
28394. Zone Detailed Report:
28395. ----------------------------------------------------------
28396. !ZoneStatisticsDetail!
28397. ----------------------------------------------------------
28398. ")
28399. 
28400. 
28401. 
28402. 
28403. 	# Script: ZoneDoFooter
28404. 
28405. /* --------------------------------- */
28406. 	# File Select
28407. 		# Select Statments
28408. 	# File Actions 
28409. 		# Standard or OS File Actions.
28410. 		# Resume...
28411. 	
28412. 		# your stuff HERE (X)... post zone (file) file actions code.
28413. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
28414. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
28415. 			# (X)
28416. 		
28417. 			/* ??? Set window? */
28418. 	
28419. 		# ADD THE GAP
28420. 		# Script: GapZoneCommand
28421. # Vacate (good for diagnostics)
28422. # DoNotVacate - DO NOT Vacate (recommended)
28423. 
28424. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
28425. # Script: DisplaySetZoneStep
28426. # Increment
28427. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
28428. 
28429. # Display this zone step
28430. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
28431. ')
28432. 
28433. # Script: BannerSet
28434. 
28435. # NOTE: Can't round or truncate to integer precision. 
28436. # This internal fields like ZoneCount format really badly.
28437. #  for !RunTimeNow! does not work. None of the date functions do.
28438. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
28439. 
28440. SetVariable(HeadingTemp2,	ZoneCount + 0)
28441. 
28442. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
28443. 
28444. Title('!Heading!')
28445. 
28446. /* pause(1) */
28447. 
28448. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
28449. 
28450. 
28451. # Script: DisplaySetWindowText
28452. # Zone Footer Set Statistics Window Text
28453. 
28454. SetStatisticsWindowText("!Heading!
28455. ----------------------------------------------------------
28456. Zones Processed: 
28457. ----------------------------------------------------------
28458. !ZoneListByLine!
28459. ----------------------------------------------------------
28460. Zone Processing Step:
28461. !ZoneStepByLine!    
28462. ----------------------------------------------------------
28463. ----------------------------------------------------------
28464. CURRENT ZONE:
28465. !ZoneStatisticsReport!
28466. ----------------------------------------------------------
28467. ----------------------------------------------------------
28468. ----------------------------------------------------------
28469. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
28470. ----------------------------------------------------------
28471. !VolumeStatisticsSummary!
28472. !VolumeStatisticsDetail!
28473. ----------------------------------------------------------
28474. ----------------------------------------------------------
28475. Zone Detailed Report:
28476. ----------------------------------------------------------
28477. !ZoneStatisticsDetail!
28478. ----------------------------------------------------------
28479. ")
28480. 
28481. 
28482. 
28483. 
28484. # *** Moved to setting yours *** 
28485. # (to avoid doing it twice)
28486. # (ie the later wouldn't "overwrite" the former in the usual manner)
28487. 
28488. # Do one or the other:
28489. # DoNotVacate - DO NOT Vacate (recommended)
28490. 
28491. # Vacate
28492. /* AddGap(GapUsedLoc) */
28493. 
28494. # DO Not Vacate
28495. AddGap(GapUsedLoc, DoNotVacate) 
28496. 	
28497. 	
28498. 
28499. # Controlled via settings commands
28500. 
28501. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
28502. 
28503. # Vacate /* AddGap(GapUsed) */
28504. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
28505. 	
28506. 
28507. 		
28508. 	# 
28509. 	FileEnd
28510. /* --------------------------------- */
28511. # your stuff HERE (X)... post zone (file) code.
28512. 
28513. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
28514. # Script: DisplaySetZoneStep
28515. # Increment
28516. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
28517. 
28518. # Display this zone step
28519. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
28520. ')
28521. 
28522. # Script: BannerSet
28523. 
28524. # NOTE: Can't round or truncate to integer precision. 
28525. # This internal fields like ZoneCount format really badly.
28526. #  for !RunTimeNow! does not work. None of the date functions do.
28527. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
28528. 
28529. SetVariable(HeadingTemp2,	ZoneCount + 0)
28530. 
28531. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
28532. 
28533. Title('!Heading!')
28534. 
28535. /* pause(1) */
28536. 
28537. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
28538. 
28539. 
28540. # Script: DisplaySetWindowText
28541. # Zone Footer Set Statistics Window Text
28542. 
28543. SetStatisticsWindowText("!Heading!
28544. ----------------------------------------------------------
28545. Zones Processed: 
28546. ----------------------------------------------------------
28547. !ZoneListByLine!
28548. ----------------------------------------------------------
28549. Zone Processing Step:
28550. !ZoneStepByLine!    
28551. ----------------------------------------------------------
28552. ----------------------------------------------------------
28553. CURRENT ZONE:
28554. !ZoneStatisticsReport!
28555. ----------------------------------------------------------
28556. ----------------------------------------------------------
28557. ----------------------------------------------------------
28558. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
28559. ----------------------------------------------------------
28560. !VolumeStatisticsSummary!
28561. !VolumeStatisticsDetail!
28562. ----------------------------------------------------------
28563. ----------------------------------------------------------
28564. Zone Detailed Report:
28565. ----------------------------------------------------------
28566. !ZoneStatisticsDetail!
28567. ----------------------------------------------------------
28568. ")
28569. 
28570. 
28571. 
28572. 
28573. # Script: ZoneWhenFinished
28574. 
28575. # Add the zone to the zone details log:
28576. # This is temporarily disable until logging is fixed
28577. # It is performed during file action to preserve the correct (original) calculations.
28578. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
28579. 
28580. # Add the Select and ZoneSteps to the Zone
28581. # Script: ZoneStatisticsAdd
28582. # Append Zone to Details of each zone.
28583. 		
28584. 	# Add Zone Details to Report.	
28585. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
28586. ----------------------------------------------------------
28587. !ZoneStepByLine!
28588. ---------------------------
28589. !ZoneTypeSelectCurrent!               
28590. ---------------------------
28591. ----------------------------------------------------------
28592. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
28593. ----------------------------------------------------------
28594. ')
28595. 
28596. 
28597. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
28598. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
28599. # 2021-12-14 15:30:02
28600. RunProgram("..\Commands\WriteDateTime.bat LastZone")
28601. # Append Datetime to logs
28602. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
28603. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
28604. 
28605. AppendLogfile("!LogFileName!", "!PeriodWord!")
28606. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
28607. AppendLogfile("!LogFileName!", "!PeriodWord!")
28608. 
28609. # Script: DisplaySetWindowText
28610. # Zone Footer Set Statistics Window Text
28611. 
28612. SetStatisticsWindowText("!Heading!
28613. ----------------------------------------------------------
28614. Zones Processed: 
28615. ----------------------------------------------------------
28616. !ZoneListByLine!
28617. ----------------------------------------------------------
28618. Zone Processing Step:
28619. !ZoneStepByLine!    
28620. ----------------------------------------------------------
28621. ----------------------------------------------------------
28622. CURRENT ZONE:
28623. !ZoneStatisticsReport!
28624. ----------------------------------------------------------
28625. ----------------------------------------------------------
28626. ----------------------------------------------------------
28627. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
28628. ----------------------------------------------------------
28629. !VolumeStatisticsSummary!
28630. !VolumeStatisticsDetail!
28631. ----------------------------------------------------------
28632. ----------------------------------------------------------
28633. Zone Detailed Report:
28634. ----------------------------------------------------------
28635. !ZoneStatisticsDetail!
28636. ----------------------------------------------------------
28637. ")
28638. 
28639. 
28640. 
28641. /* pause() */
28642. /* pause() */
28643. 
28644. 
28645. 
28646. /* ------------------------- */
28647. 
28648. 
28649. /* ------------------------- */
28650. 
28651. /* ------------------------- */
28652. /* 10 Zone 18 Reference & World */
28653. # Script: DisplayColors - Zone Dark
28654. # Processed
28655. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
28656. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
28657. 
28658. # Light Green and Yellow
28659. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
28660. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
28661. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
28662. 
28663. # Script: DefragZoneTypeReference
28664. /* ------------------------- */
28665. /* Zone Reference & World */
28666. SetVariable(ZoneLabel,			"!ZoneLabelReference!")
28667. SetVariable(ZoneDescription,		"!ZoneDescriptionReference!")
28668. SetVariable(ZoneVolRoundUp,			"!ZoneVolRoundUpReference!")
28669. SetVariable(ZoneGapSize,			 "!ZoneGapSizeReference!")
28670. 
28671. SetVariable(ZoneTypeSelect,'
28672. # Reference:
28673. # Script: ZoneDo ZoneTypeSelectReference
28674. # Reference start.
28675. # Xinclude "..\FileSelectCategory\SelNotBlobsArchivesBu.MyDs"X
28676. # NotBlobsArchivesBu start.
28677. (not (
28678. # Blobs start.
28679. (
28680. # BlobsAndExceptions start.
28681. ( not(
28682.   FileName("*.bat")
28683.   or FileName("*.css")
28684.   or FileName("*.dll")
28685.   or FileName("*.exe")
28686.   or FileName("*.htm*")
28687.   or FileName("*.jar")
28688.   or FileName("*.js")
28689.   or FileName("*.script")
28690.   or FileName("*.wsf")
28691.   or (
28692. # Databases start.
28693. (
28694.   FileName("*.crypt*")
28695.   or FileName("*.db*")
28696.   or FileName("*.rdb*")
28697.   or FileName("*.dc*")
28698.   or FileName("*.dict*")
28699.   or FileName("*.?db*")
28700.   or FileName("*.?rdb*")
28701.   or FileName("*.md*")
28702.   or FileName("*.myd")
28703.   or FileName("*.ndf")
28704.   or FileName("*.ns?")
28705.   or FileName("*.pab")
28706.   or FileName("*.pst")
28707.   or FileName("*.sd?*")
28708.   or FileName("*.sq**")
28709.   or FileName("*.tmd")
28710.   or FileName("*.tps")
28711.   or FileName("*.tr*")
28712. )
28713. # Databases end.
28714. 
28715.     # BlobsAndExceptions
28716.     or 
28717. # Data start.
28718. (
28719.   DirectoryName("Data*")
28720.   or DirectoryName("Device*")
28721.   or DirectoryName("Export*")
28722.   or DirectoryName("Import*")
28723.   or DirectoryName("Log*")
28724.   or DirectoryName("*Log")
28725.   or DirectoryName("Maintenance*")
28726.   or DirectoryName("Rec*")
28727.   or DirectoryName("Sales*")
28728.   or DirectoryName("Search*")
28729.   or DirectoryName("User*")
28730. )
28731. # Data end.
28732. 
28733.     # BlobsAndExceptions
28734.   )
28735. ) )
28736. # BlobsAndExceptions end.
28737. 
28738. # Blobs
28739. ) and (
28740.   Size(BlobFileSize,0)
28741.   or (
28742.     FileName("*.arj")
28743.     or FileName("*.bup")
28744.     or FileName("*.bz2")
28745.     or FileName("*.chm")
28746.     or FileName("*.dvr-ms")
28747.     or FileName("*.gz")
28748.     or FileName("*.ifo")
28749.     or FileName("*.lzh")
28750.     or FileName("*.pdf")
28751.     or FileName("*.rpm")
28752.     or FileName("*.wmv")
28753.     or FileName("*.vob")
28754.     or FileName("*.z")
28755.   ) 
28756. )
28757. # Blobs end.
28758. 
28759. # NotBlobsArchivesBu
28760. or 
28761. # Archives start.
28762. (
28763.   DirectoryName("*Archive*")
28764.   or DirectoryName("*History*")
28765.   or DirectoryName("*Old")
28766.   or DirectoryName("* Old *")
28767.   or DirectoryName("Old *")
28768. 
28769.   or FileName("*.7z")
28770.   or FileName("*.cab")
28771.   or FileName("*.iso")
28772.   or FileName("*.msi")
28773.   or FileName("*.old")
28774.   or FileName("*.rar")
28775.   or FileName("*.tar")
28776.   or FileName("*.zip")
28777.   or
28778. # WinSysLow start.
28779. (
28780.   # Bad idea. This pushed lots of programs and data to archive.
28781.   # DirectoryName("$*")
28782.   # or DirectoryName("0*")
28783.   # or DirectoryName("1*")
28784.   # or DirectoryName("2*")
28785.   # or DirectoryName("3*")
28786.   # or DirectoryName("4*")
28787.   # or DirectoryName("5*")
28788.   # or DirectoryName("6*")
28789.   # or DirectoryName("7*")
28790.   # or DirectoryName("8*")
28791.   # or DirectoryName("9*")
28792.   # or 
28793.   DirectoryName("dllcache")
28794.   or DirectoryName("Downloaded Installations")
28795.   or DirectoryName("Ehome")
28796.   or DirectoryName("Fonts")
28797.   or DirectoryName("Help")
28798.   or DirectoryName("I386")
28799.   or DirectoryName("ie?updates")
28800.   or DirectoryName("Installer")
28801.   or DirectoryName("Installshield Installation Information")
28802.   or DirectoryName("IME")
28803.   or DirectoryName("*RECYCLE*")
28804.   or DirectoryName("ServicePackFiles")
28805.   or DirectoryName("SoftwareDistribution")
28806.   or DirectoryName("Speech")
28807.   or DirectoryName("Symbols")
28808.   or DirectoryName("System Volume Information")
28809.   or DirectoryName("windows.old")
28810. )
28811. # WinSysLow end.
28812. 
28813.   # Archives
28814. )
28815. # Archives end.
28816. 
28817. # NotBlobsArchivesBu
28818. or
28819. # Backups start.
28820. (
28821.   DirectoryName("*Backup*")
28822.   or DirectoryName("*Bu")
28823.   or DirectoryName("* Bu *")
28824.   or DirectoryName("Bu *")
28825. 
28826.   or FileName("*.bak")
28827.   or FileName("* - Copy*")
28828. )
28829. # Backups end.
28830. 
28831. # The following has to be ignored in the reference zone:
28832. # or 
28833. # FileName("ReferenceMarker.MyDx")
28834. # NotBlobsArchivesBu
28835. ) )
28836. # NotBlobsArchivesBu end.
28837. #
28838. # Reference
28839. and (
28840. # Reference start.
28841. (
28842.   DirectoryName("World*") or
28843.   DirectoryName("Education*") or
28844.   DirectoryName("Entertainment*") or
28845.   DirectoryName("Food*") or
28846.   DirectoryName("Geography*") or
28847.   DirectoryName("Help*") or
28848.   DirectoryName("Humo*") or
28849.   DirectoryName("Internet*") or
28850.   DirectoryName("Legal*") or
28851.   DirectoryName("Linquistics*") or
28852.   DirectoryName("Media*") or
28853.   DirectoryName("Multimedia*") or
28854.   DirectoryName("Reference*") or
28855.   DirectoryName("Sales*") or
28856.   DirectoryName("Science*") or
28857.   DirectoryName("Social*") or
28858.   DirectoryName("Technology*")
28859.   or FileName("ReferenceMarker.MyDx")
28860. )
28861. # Reference end.
28862. 
28863. # Reference
28864. )
28865. # Reference end.
28866. 
28867. ')
28868. 
28869. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
28870. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
28871. 
28872. SetVariable(ZoneStepNoCurrent, 0)
28873. 
28874. 	/* ------------------------- */
28875. # Script: ZoneDoHeader
28876. 
28877. # Script: ZoneWhenStarted
28878. RunProgram("..\Commands\WriteDateTime.bat")
28879. 
28880. # Script: ZoneDoCurrentClear
28881. 
28882. SetVariable(ZoneTypeSelectCurrent, 		"")
28883. SetVariable(ZoneStatisticsData, 		"")
28884. SetVariable(ZoneStepByLine, 			"")
28885. 
28886. SetVariable(ZoneBeginCurrent, 			0)
28887. SetVariable(ZoneBeginPerCurrent, 		0)
28888. SetVariable(ZoneEndCurrent, 			0)
28889. SetVariable(ZoneEndPerCurrent, 			0)
28890. 
28891. SetVariable(ZoneSizeCurrent,			0)
28892. SetVariable(ZoneSizePerCurrent,			0)
28893. 
28894. SetVariable(ZoneGapRequestedCurrent,	0)
28895. SetVariable(ZoneGapRoundedCurrent, 		0)
28896. SetVariable(ZoneGapAdjustedCurrent, 	0)
28897. SetVariable(ZoneGapAvailableCurrent, 	0)
28898. SetVariable(ZoneGapCurrent,				0)
28899. SetVariable(ZoneGapUsedCurrent, 		0)
28900. 
28901. SetVariable(ZoneGapActualCurrent, 		0)
28902. SetVariable(ZoneGapActualPerCurrent, 	0)
28903. 
28904. SetVariable(ZoneSizeActual, 			0)
28905. SetVariable(ZoneSizeActualCurrent,		0)
28906. 
28907. SetVariable(ZoneEndActual, 				0)
28908. SetVariable(ZoneEndActualCurrent,		0)			
28909. SetVariable(ZoneSizeActualPerCurrent, 	0)
28910.       
28911. SetVariable(ZoneFilesFolders,			0)
28912. SetVariable(ZoneFilesFoldersPer,		0) 
28913. 
28914. SetVariable(ZoneFragments,				0)
28915. SetVariable(ZoneFragmentsPer,			0) 
28916. 		
28917. SetVariable(ZoneEndActualCurrent, 		0)
28918. SetVariable(ZoneEndActualPerCurrent, 	0)
28919. 
28920. # Gap Calculation Methodology:
28921. 	# Requested
28922. 	SetVariable(GapRequested, 			0) 
28923. 	SetVariable(GapRequestedStd, 		0) 
28924. 	SetVariable(GapRequestedMft, 		0) 
28925. 	SetVariable(GapRequestedOs, 		0) 
28926. 	SetVariable(GapRequestedOriginal, 	0) 
28927. 	
28928. 	# Gap Adjustments
28929. 	SetVariable(GapRounded, 			0)
28930. 	# SetVariable(GapAdjusted, 			0)
28931. 	SetVariable(GapAvailable, 			0)
28932. 	SetVariable(GapCurrent, 			0)
28933. 	SetVariable(GapActual, 				0)
28934. 	SetVariable(GapUsed, 				0)
28935. 	
28936. 	# Gap Adjustments
28937. 	SetVariable(GapRoundedLoc, 			0)
28938. 	# SetVariable(GapAdjustedLoc, 		0)
28939. 	SetVariable(GapAvailableLoc, 		0)
28940. 	SetVariable(GapCurrentLoc, 			0)
28941. 	SetVariable(GapActualLoc,			0)
28942. 	SetVariable(GapUsedLoc,				0)
28943. 	
28944. 	# Space usage
28945. 	SetVariable(ZoneFreePerRequested, 	0)
28946. 	SetVariable(ZoneFreePerUsed, 		0)
28947. 
28948. # Gap Size & Rounding
28949. 	SetVariable(ZoneGapSizePer, 		0)
28950. 	SetVariable(ZoneVolRoundUpPer, 		0)
28951. 	
28952. 	# Free Space
28953. 	SetVariable(ZoneFreeUsedPer, 		0)
28954. 	SetVariable(ZoneFreeRequestedPer, 	0)
28955. 
28956. # Script: DisplaySetZone
28957. 
28958. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
28959. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
28960. 
28961. # Message ZoneSummary
28962. # SetVariable(ZoneSummary, '
28963. # Zone Summary:
28964. # ')
28965. # Zone processing steps
28966. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
28967. # ')
28968. 
28969. # # Script: BannerDescriptionSet
28970. 
28971. # Script: BannerSet
28972. 
28973. # NOTE: Can't round or truncate to integer precision. 
28974. # This internal fields like ZoneCount format really badly.
28975. #  for !RunTimeNow! does not work. None of the date functions do.
28976. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
28977. 
28978. SetVariable(HeadingTemp2,	ZoneCount + 0)
28979. 
28980. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
28981. 
28982. Title('!Heading!')
28983. 
28984. /* pause(1) */
28985. 
28986. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
28987. 
28988. 
28989. # Script: BannerLog
28990. 
28991. AppendLogfile("!LogFileName!", "!Heading!")
28992. 
28993. 
28994. 
28995. # pause(1)
28996. 
28997. 
28998. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
28999. # Script: DisplaySetZoneStep
29000. # Increment
29001. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29002. 
29003. # Display this zone step
29004. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
29005. ')
29006. 
29007. # Script: BannerSet
29008. 
29009. # NOTE: Can't round or truncate to integer precision. 
29010. # This internal fields like ZoneCount format really badly.
29011. #  for !RunTimeNow! does not work. None of the date functions do.
29012. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29013. 
29014. SetVariable(HeadingTemp2,	ZoneCount + 0)
29015. 
29016. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29017. 
29018. Title('!Heading!')
29019. 
29020. /* pause(1) */
29021. 
29022. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29023. 
29024. 
29025. # Script: DisplaySetWindowText
29026. # Zone Footer Set Statistics Window Text
29027. 
29028. SetStatisticsWindowText("!Heading!
29029. ----------------------------------------------------------
29030. Zones Processed: 
29031. ----------------------------------------------------------
29032. !ZoneListByLine!
29033. ----------------------------------------------------------
29034. Zone Processing Step:
29035. !ZoneStepByLine!    
29036. ----------------------------------------------------------
29037. ----------------------------------------------------------
29038. CURRENT ZONE:
29039. !ZoneStatisticsReport!
29040. ----------------------------------------------------------
29041. ----------------------------------------------------------
29042. ----------------------------------------------------------
29043. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
29044. ----------------------------------------------------------
29045. !VolumeStatisticsSummary!
29046. !VolumeStatisticsDetail!
29047. ----------------------------------------------------------
29048. ----------------------------------------------------------
29049. Zone Detailed Report:
29050. ----------------------------------------------------------
29051. !ZoneStatisticsDetail!
29052. ----------------------------------------------------------
29053. ")
29054. 
29055. 
29056. 
29057. 
29058. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
29059. 
29060. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
29061. # Script: DisplaySetZoneStep
29062. # Increment
29063. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29064. 
29065. # Display this zone step
29066. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
29067. ')
29068. 
29069. # Script: BannerSet
29070. 
29071. # NOTE: Can't round or truncate to integer precision. 
29072. # This internal fields like ZoneCount format really badly.
29073. #  for !RunTimeNow! does not work. None of the date functions do.
29074. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29075. 
29076. SetVariable(HeadingTemp2,	ZoneCount + 0)
29077. 
29078. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29079. 
29080. Title('!Heading!')
29081. 
29082. /* pause(1) */
29083. 
29084. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29085. 
29086. 
29087. # Script: DisplaySetWindowText
29088. # Zone Footer Set Statistics Window Text
29089. 
29090. SetStatisticsWindowText("!Heading!
29091. ----------------------------------------------------------
29092. Zones Processed: 
29093. ----------------------------------------------------------
29094. !ZoneListByLine!
29095. ----------------------------------------------------------
29096. Zone Processing Step:
29097. !ZoneStepByLine!    
29098. ----------------------------------------------------------
29099. ----------------------------------------------------------
29100. CURRENT ZONE:
29101. !ZoneStatisticsReport!
29102. ----------------------------------------------------------
29103. ----------------------------------------------------------
29104. ----------------------------------------------------------
29105. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
29106. ----------------------------------------------------------
29107. !VolumeStatisticsSummary!
29108. !VolumeStatisticsDetail!
29109. ----------------------------------------------------------
29110. ----------------------------------------------------------
29111. Zone Detailed Report:
29112. ----------------------------------------------------------
29113. !ZoneStatisticsDetail!
29114. ----------------------------------------------------------
29115. ")
29116. 
29117. 
29118. 
29119. 
29120. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
29121. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
29122. 
29123. # Script: BannerSet
29124. 
29125. # NOTE: Can't round or truncate to integer precision. 
29126. # This internal fields like ZoneCount format really badly.
29127. #  for !RunTimeNow! does not work. None of the date functions do.
29128. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29129. 
29130. SetVariable(HeadingTemp2,	ZoneCount + 0)
29131. 
29132. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29133. 
29134. Title('!Heading!')
29135. 
29136. /* pause(1) */
29137. 
29138. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29139. 
29140. 
29141. # Script: BannerLog
29142. 
29143. AppendLogfile("!LogFileName!", "!Heading!")
29144. 
29145. 
29146. 
29147. # LOGGING:
29148. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
29149. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
29150. 
29151. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
29152. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:02")
29153. # 2021-12-14 15:30:02 
29154. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:07 !ZoneLabel! !ZoneDescription!")
29155. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
29156. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:07 !ZoneLabel! !ZoneDescription!")
29157. 
29158. 
29159. # Add zone to list of zones:
29160. SetVariable(ZoneListByLine, "!ZoneListByLine!
29161. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
29162. # Script: DisplaySetWindowText
29163. # Zone Footer Set Statistics Window Text
29164. 
29165. SetStatisticsWindowText("!Heading!
29166. ----------------------------------------------------------
29167. Zones Processed: 
29168. ----------------------------------------------------------
29169. !ZoneListByLine!
29170. ----------------------------------------------------------
29171. Zone Processing Step:
29172. !ZoneStepByLine!    
29173. ----------------------------------------------------------
29174. ----------------------------------------------------------
29175. CURRENT ZONE:
29176. !ZoneStatisticsReport!
29177. ----------------------------------------------------------
29178. ----------------------------------------------------------
29179. ----------------------------------------------------------
29180. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
29181. ----------------------------------------------------------
29182. !VolumeStatisticsSummary!
29183. !VolumeStatisticsDetail!
29184. ----------------------------------------------------------
29185. ----------------------------------------------------------
29186. Zone Detailed Report:
29187. ----------------------------------------------------------
29188. !ZoneStatisticsDetail!
29189. ----------------------------------------------------------
29190. ")
29191. 
29192. 
29193. 
29194. 
29195. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
29196. # Script: DisplaySetZoneStep
29197. # Increment
29198. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29199. 
29200. # Display this zone step
29201. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
29202. ')
29203. 
29204. # Script: BannerSet
29205. 
29206. # NOTE: Can't round or truncate to integer precision. 
29207. # This internal fields like ZoneCount format really badly.
29208. #  for !RunTimeNow! does not work. None of the date functions do.
29209. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29210. 
29211. SetVariable(HeadingTemp2,	ZoneCount + 0)
29212. 
29213. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29214. 
29215. Title('!Heading!')
29216. 
29217. /* pause(1) */
29218. 
29219. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29220. 
29221. 
29222. # Script: DisplaySetWindowText
29223. # Zone Footer Set Statistics Window Text
29224. 
29225. SetStatisticsWindowText("!Heading!
29226. ----------------------------------------------------------
29227. Zones Processed: 
29228. ----------------------------------------------------------
29229. !ZoneListByLine!
29230. ----------------------------------------------------------
29231. Zone Processing Step:
29232. !ZoneStepByLine!    
29233. ----------------------------------------------------------
29234. ----------------------------------------------------------
29235. CURRENT ZONE:
29236. !ZoneStatisticsReport!
29237. ----------------------------------------------------------
29238. ----------------------------------------------------------
29239. ----------------------------------------------------------
29240. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
29241. ----------------------------------------------------------
29242. !VolumeStatisticsSummary!
29243. !VolumeStatisticsDetail!
29244. ----------------------------------------------------------
29245. ----------------------------------------------------------
29246. Zone Detailed Report:
29247. ----------------------------------------------------------
29248. !ZoneStatisticsDetail!
29249. ----------------------------------------------------------
29250. ")
29251. 
29252. 
29253. 
29254. 
29255. # your stuff HERE (X)... pre file select code.
29256. 
29257. /* --------------------------------- */
29258. 	FileSelect
29259. 
29260. 		# your stuff can't really go here (errors.)
29261. 		# maybe for some reason I don't know of...
29262. 	
29263. 		# Actions next...
29264. 	# Script: ZoneDo ZoneTypeSelectReference
29265. # Reference start.
29266. # Xinclude "..\FileSelectCategory\SelNotBlobsArchivesBu.MyDs"X
29267. # NotBlobsArchivesBu start.
29268. (not (
29269. # Blobs start.
29270. (
29271. # BlobsAndExceptions start.
29272. ( not(
29273.   FileName("*.bat")
29274.   or FileName("*.css")
29275.   or FileName("*.dll")
29276.   or FileName("*.exe")
29277.   or FileName("*.htm*")
29278.   or FileName("*.jar")
29279.   or FileName("*.js")
29280.   or FileName("*.script")
29281.   or FileName("*.wsf")
29282.   or (
29283. # Databases start.
29284. (
29285.   FileName("*.crypt*")
29286.   or FileName("*.db*")
29287.   or FileName("*.rdb*")
29288.   or FileName("*.dc*")
29289.   or FileName("*.dict*")
29290.   or FileName("*.?db*")
29291.   or FileName("*.?rdb*")
29292.   or FileName("*.md*")
29293.   or FileName("*.myd")
29294.   or FileName("*.ndf")
29295.   or FileName("*.ns?")
29296.   or FileName("*.pab")
29297.   or FileName("*.pst")
29298.   or FileName("*.sd?*")
29299.   or FileName("*.sq**")
29300.   or FileName("*.tmd")
29301.   or FileName("*.tps")
29302.   or FileName("*.tr*")
29303. )
29304. # Databases end.
29305. 
29306.     # BlobsAndExceptions
29307.     or 
29308. # Data start.
29309. (
29310.   DirectoryName("Data*")
29311.   or DirectoryName("Device*")
29312.   or DirectoryName("Export*")
29313.   or DirectoryName("Import*")
29314.   or DirectoryName("Log*")
29315.   or DirectoryName("*Log")
29316.   or DirectoryName("Maintenance*")
29317.   or DirectoryName("Rec*")
29318.   or DirectoryName("Sales*")
29319.   or DirectoryName("Search*")
29320.   or DirectoryName("User*")
29321. )
29322. # Data end.
29323. 
29324.     # BlobsAndExceptions
29325.   )
29326. ) )
29327. # BlobsAndExceptions end.
29328. 
29329. # Blobs
29330. ) and (
29331.   Size(BlobFileSize,0)
29332.   or (
29333.     FileName("*.arj")
29334.     or FileName("*.bup")
29335.     or FileName("*.bz2")
29336.     or FileName("*.chm")
29337.     or FileName("*.dvr-ms")
29338.     or FileName("*.gz")
29339.     or FileName("*.ifo")
29340.     or FileName("*.lzh")
29341.     or FileName("*.pdf")
29342.     or FileName("*.rpm")
29343.     or FileName("*.wmv")
29344.     or FileName("*.vob")
29345.     or FileName("*.z")
29346.   ) 
29347. )
29348. # Blobs end.
29349. 
29350. # NotBlobsArchivesBu
29351. or 
29352. # Archives start.
29353. (
29354.   DirectoryName("*Archive*")
29355.   or DirectoryName("*History*")
29356.   or DirectoryName("*Old")
29357.   or DirectoryName("* Old *")
29358.   or DirectoryName("Old *")
29359. 
29360.   or FileName("*.7z")
29361.   or FileName("*.cab")
29362.   or FileName("*.iso")
29363.   or FileName("*.msi")
29364.   or FileName("*.old")
29365.   or FileName("*.rar")
29366.   or FileName("*.tar")
29367.   or FileName("*.zip")
29368.   or
29369. # WinSysLow start.
29370. (
29371.   # Bad idea. This pushed lots of programs and data to archive.
29372.   # DirectoryName("$*")
29373.   # or DirectoryName("0*")
29374.   # or DirectoryName("1*")
29375.   # or DirectoryName("2*")
29376.   # or DirectoryName("3*")
29377.   # or DirectoryName("4*")
29378.   # or DirectoryName("5*")
29379.   # or DirectoryName("6*")
29380.   # or DirectoryName("7*")
29381.   # or DirectoryName("8*")
29382.   # or DirectoryName("9*")
29383.   # or 
29384.   DirectoryName("dllcache")
29385.   or DirectoryName("Downloaded Installations")
29386.   or DirectoryName("Ehome")
29387.   or DirectoryName("Fonts")
29388.   or DirectoryName("Help")
29389.   or DirectoryName("I386")
29390.   or DirectoryName("ie?updates")
29391.   or DirectoryName("Installer")
29392.   or DirectoryName("Installshield Installation Information")
29393.   or DirectoryName("IME")
29394.   or DirectoryName("*RECYCLE*")
29395.   or DirectoryName("ServicePackFiles")
29396.   or DirectoryName("SoftwareDistribution")
29397.   or DirectoryName("Speech")
29398.   or DirectoryName("Symbols")
29399.   or DirectoryName("System Volume Information")
29400.   or DirectoryName("windows.old")
29401. )
29402. # WinSysLow end.
29403. 
29404.   # Archives
29405. )
29406. # Archives end.
29407. 
29408. # NotBlobsArchivesBu
29409. or
29410. # Backups start.
29411. (
29412.   DirectoryName("*Backup*")
29413.   or DirectoryName("*Bu")
29414.   or DirectoryName("* Bu *")
29415.   or DirectoryName("Bu *")
29416. 
29417.   or FileName("*.bak")
29418.   or FileName("* - Copy*")
29419. )
29420. # Backups end.
29421. 
29422. # The following has to be ignored in the reference zone:
29423. # or 
29424. # FileName("ReferenceMarker.MyDx")
29425. # NotBlobsArchivesBu
29426. ) )
29427. # NotBlobsArchivesBu end.
29428. #
29429. # Reference
29430. and (
29431. # Reference start.
29432. (
29433.   DirectoryName("World*") or
29434.   DirectoryName("Education*") or
29435.   DirectoryName("Entertainment*") or
29436.   DirectoryName("Food*") or
29437.   DirectoryName("Geography*") or
29438.   DirectoryName("Help*") or
29439.   DirectoryName("Humo*") or
29440.   DirectoryName("Internet*") or
29441.   DirectoryName("Legal*") or
29442.   DirectoryName("Linquistics*") or
29443.   DirectoryName("Media*") or
29444.   DirectoryName("Multimedia*") or
29445.   DirectoryName("Reference*") or
29446.   DirectoryName("Sales*") or
29447.   DirectoryName("Science*") or
29448.   DirectoryName("Social*") or
29449.   DirectoryName("Technology*")
29450.   or FileName("ReferenceMarker.MyDx")
29451. )
29452. # Reference end.
29453. 
29454. # Reference
29455. )
29456. # Reference end.
29457. 
29458. 	# Script: ZoneDoAction
29459. # Zone Do File Action - SortByName.
29460. 
29461. 	FileActions
29462. 
29463. 			# Script: GapZoneCalc
29464. 	# Gap
29465. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
29466. 		# Script: DisplaySetZoneStep
29467. # Increment
29468. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29469. 
29470. # Display this zone step
29471. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
29472. ')
29473. 
29474. # Script: BannerSet
29475. 
29476. # NOTE: Can't round or truncate to integer precision. 
29477. # This internal fields like ZoneCount format really badly.
29478. #  for !RunTimeNow! does not work. None of the date functions do.
29479. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29480. 
29481. SetVariable(HeadingTemp2,	ZoneCount + 0)
29482. 
29483. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29484. 
29485. Title('!Heading!')
29486. 
29487. /* pause(1) */
29488. 
29489. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29490. 
29491. 
29492. # Script: DisplaySetWindowText
29493. # Zone Footer Set Statistics Window Text
29494. 
29495. SetStatisticsWindowText("!Heading!
29496. ----------------------------------------------------------
29497. Zones Processed: 
29498. ----------------------------------------------------------
29499. !ZoneListByLine!
29500. ----------------------------------------------------------
29501. Zone Processing Step:
29502. !ZoneStepByLine!    
29503. ----------------------------------------------------------
29504. ----------------------------------------------------------
29505. CURRENT ZONE:
29506. !ZoneStatisticsReport!
29507. ----------------------------------------------------------
29508. ----------------------------------------------------------
29509. ----------------------------------------------------------
29510. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
29511. ----------------------------------------------------------
29512. !VolumeStatisticsSummary!
29513. !VolumeStatisticsDetail!
29514. ----------------------------------------------------------
29515. ----------------------------------------------------------
29516. Zone Detailed Report:
29517. ----------------------------------------------------------
29518. !ZoneStatisticsDetail!
29519. ----------------------------------------------------------
29520. ")
29521. 
29522. 
29523. 
29524. 	
29525. 	# ACTUAL GAP
29526. 		/* AddGap Variant. */
29527. 	  	# Script: GapZoneSet
29528. # Zone Do Gap
29529. # Gap Calculation Methods:
29530. 
29531. /* 1) Anything you need to add first. */
29532. /* empty */
29533. 
29534. /* ------------------------- */
29535. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
29536. 	# GapRequestedStd.
29537. 
29538. 		/* ------------------------- */
29539. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
29540. 
29541. 		# Gap Calculation Methods:
29542. 
29543. /* AddGap Variants */
29544. 
29545. 	/* Standard */
29546. 		# Gap Calculation Methods:
29547. 	/* AddGap Variants */
29548. 	/* Standard */
29549. 
29550. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
29551. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
29552. 
29553. 	SetVariable(GapRequested, GapRequestedStd)
29554. 	
29555. 
29556. 	/* MFT Low High Method */
29557. 		# Gap Calculation Methods:
29558. 	/* AddGap Variants */
29559. 	/* MFT Low High Method */
29560. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
29561. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
29562. 	SetVariable(GapRequested, GapRequestedMft)
29563. 	
29564. 
29565. 	/* OS Volume Type Method */
29566. 		# Gap Calculation Methods:
29567. 	/* AddGap Variants */
29568. 	/* OS Volume Type Method */
29569. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
29570. 	SetVariable(GapRequested, GapRequestedOs)
29571. 
29572. 
29573. 
29574. /* MakeGap Variants */
29575. 
29576. 	/* Original Os 1-3 + MFT 2 */
29577. 		# Gap Calculation Methods:
29578. 	/* MakeGap Variants */
29579. 	/* Original Os 1-3 + MFT 2 */
29580. 	/* plus MFT gap placed inline at the dividing zone. */
29581. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
29582. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
29583. 	SetVariable(GapRequested, GapRequestedOrig)
29584. 	
29585. 	
29586. /* Note: You could comment out the ones not in use */
29587. /* However having the data in the log is useful. */
29588. /* Therefore the following line is otherwise needed. */
29589. 
29590. /* Standard used */
29591. 
29592. SetVariable(GapRequested, GapRequestedStd)
29593. 
29594. # Gap Calculation Methods:
29595. 
29596. /* AddGap Variants */
29597. 	/* Standard */
29598. 	/* MFT Low High Method */
29599. 	/* OS Volume Type Method */
29600. 
29601. /* MakeGap Variants */
29602. 	/* Original Os 1-3 + MFT 2 */
29603. 
29604. /* Note: You could comment out the ones not in use */
29605. /* However having the data in the log is useful. */
29606. /* Therefore the following line is otherwise needed. */
29607. 
29608. /* Standard is used currently */
29609. 
29610. 
29611. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
29612. 
29613. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
29614. 
29615. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
29616. 
29617. /* ------------------------- */
29618. /* 3) SMALL ZONE ADJUSTMENT. */
29619. /* Gab cant be larger than half the Zone Size. */
29620. 
29621. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
29622. 	
29623. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
29624. 
29625. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
29626. 
29627. /* ------------------------- */
29628. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
29629. # Gap Adjustments.
29630. 
29631. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
29632. 	
29633. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
29634. 
29635. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
29636. 
29637. /* ------------------------- */
29638. # BYPASS THIS.
29639. 	/* This is definitely wrong. */
29640. 	/* The question is can we steal gap from the next zone */
29641. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
29642. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
29643. 		# Zone Overflow.
29644. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
29645. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
29646. 
29647. /* ------------------------- */
29648. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
29649. # Remaining free space available.
29650. 
29651. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
29652. 	
29653. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
29654. 
29655. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
29656. 
29657. /* ------------------------- */
29658. # CURRENT gap to use.
29659. 
29660. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
29661. 
29662. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
29663. 
29664. /* ------------------------- */
29665. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
29666. # Debugging.
29667. 
29668. 	SetVariable(GapUsed, GapCurrent) // for debugging
29669. 
29670. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
29671. 
29672. 		# Your code HERE
29673. 
29674. /* ------------------------- */
29675. /* 7) YOUR CODE. */
29676. # YOUR CODE HERE:
29677. 	# INPUT: GapCurrent or GapCurrentLoc
29678. 	# OUTPUT: GapUsed...
29679. 
29680. /* ------------------------- */
29681. # Gap Size.
29682. # Actual Size of Gap.
29683. 
29684. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
29685. 
29686. /* ------------------------- */
29687. 
29688. 	
29689. 	# Zone Statistics	
29690. 		# Script: ZoneStatisticsGet
29691. # Zone / Volume Statistics and Display
29692. 		
29693. 	# Accumulate Totals
29694.   	# Script: ZoneDoVolumeTotals
29695. 
29696. /* Current total space used (by Zones and Gaps) */
29697. 
29698. SetVariable(VolumeZoneUsed, GapUsed)
29699. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
29700. /* Percentage */
29701. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
29702. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
29703. 
29704. /* Current total of free space requested */
29705. 
29706. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
29707. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
29708. /* Percent. */
29709. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
29710. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
29711. 
29712. /* Current total of free space used */
29713. 
29714. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
29715. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
29716. /* Percent */
29717. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
29718. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
29719. 
29720. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
29721. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
29722. # Xinclude "..\DebugDisplayPause.MyDc"X
29723. 
29724. 
29725. 	# Current Values
29726. 	# Script: ZoneDoCurrentSet
29727. 
29728. # Cluster, Sector, Block adjust for display.
29729. 	# Bytes per cluster is volume specific.
29730. 
29731. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
29732. 
29733. # Current Zone values.
29734. 	# Begin, end and size.
29735. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
29736. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
29737. 
29738. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
29739. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
29740. 
29741. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
29742. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
29743. 
29744. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
29745. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
29746. 
29747. 	SetVariable(ZoneFragments,				"!ZONE210N!")
29748. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
29749. 		
29750. # Current Gap, Actual and Free Values
29751. 	# Gap
29752. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
29753. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
29754. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
29755. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
29756. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
29757. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
29758. 	
29759. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
29760. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
29761. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
29762. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
29763. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
29764. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
29765. 	
29766. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
29767. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
29768. 	
29769. 	# Actual Size and End
29770. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
29771. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
29772. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
29773. 	
29774. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
29775. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
29776. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
29777. 
29778. # Gap Size & Rounding
29779. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
29780. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
29781. 	
29782. 	# Free Space
29783. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
29784. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
29785. 
29786. 	# Script: ZoneStatisticsReportGet
29787. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
29788. 
29789. # Footer:
29790. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
29791. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
29792. #
29793. # Xinclude "..\Commands\DateTimeLastLong.txt"X
29794. #
29795. # What a mess this word based vs is. Try a phrase based version ToDo
29796. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
29797. ------------------
29798.    !SizeWord!!ColonWord!  
29799.    ------------------------
29800.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
29801.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
29802.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
29803. 
29804.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
29805.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
29806. 
29807.    !LocationWord!!ColonWord!
29808.    ------------------------
29809.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
29810.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
29811.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
29812.       
29813.    !GapWordCaps! !SettingsWord!!ColonWord!
29814.    ------------------------
29815.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
29816.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
29817.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
29818.                  
29819.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
29820.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
29821.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
29822.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
29823.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
29824.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
29825.      
29826.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
29827.    ------------------------
29828.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
29829.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
29830.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
29831. 
29832. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
29833. ----------------------------------------------------------
29834. ")
29835. #
29836. SetVariable(DateNow, 	DATETIME)
29837. SetVariable(TimeNow, 	Time)
29838. SetVariable(RunTimeNow, 	RunTime)
29839. 
29840. 
29841. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
29842. 
29843. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
29844. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
29845. 
29846. 	# Script: DisplaySetWindowText
29847. # Zone Footer Set Statistics Window Text
29848. 
29849. SetStatisticsWindowText("!Heading!
29850. ----------------------------------------------------------
29851. Zones Processed: 
29852. ----------------------------------------------------------
29853. !ZoneListByLine!
29854. ----------------------------------------------------------
29855. Zone Processing Step:
29856. !ZoneStepByLine!    
29857. ----------------------------------------------------------
29858. ----------------------------------------------------------
29859. CURRENT ZONE:
29860. !ZoneStatisticsReport!
29861. ----------------------------------------------------------
29862. ----------------------------------------------------------
29863. ----------------------------------------------------------
29864. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
29865. ----------------------------------------------------------
29866. !VolumeStatisticsSummary!
29867. !VolumeStatisticsDetail!
29868. ----------------------------------------------------------
29869. ----------------------------------------------------------
29870. Zone Detailed Report:
29871. ----------------------------------------------------------
29872. !ZoneStatisticsDetail!
29873. ----------------------------------------------------------
29874. ")
29875. 
29876. 
29877. 	
29878. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
29879. 
29880. 
29881. 	SetVariable(ZoneStatisticsData, 
29882. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
29883.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
29884.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
29885. 
29886. 
29887. 
29888.  		# Script: ZoneStatisticsDisplay
29889. 	
29890. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
29891. !ZoneStatisticsData!
29892. ')
29893. 
29894. 		# Script: ZoneStatisticsAdd
29895. # Append Zone to Details of each zone.
29896. 		
29897. 	# Add Zone Details to Report.	
29898. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
29899. !ZoneStatisticsReport!
29900. ')
29901. 
29902. 	
29903. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
29904. 		# Script: DisplaySetZoneStep
29905. # Increment
29906. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29907. 
29908. # Display this zone step
29909. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
29910. ')
29911. 
29912. # Script: BannerSet
29913. 
29914. # NOTE: Can't round or truncate to integer precision. 
29915. # This internal fields like ZoneCount format really badly.
29916. #  for !RunTimeNow! does not work. None of the date functions do.
29917. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29918. 
29919. SetVariable(HeadingTemp2,	ZoneCount + 0)
29920. 
29921. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29922. 
29923. Title('!Heading!')
29924. 
29925. /* pause(1) */
29926. 
29927. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29928. 
29929. 
29930. # Script: DisplaySetWindowText
29931. # Zone Footer Set Statistics Window Text
29932. 
29933. SetStatisticsWindowText("!Heading!
29934. ----------------------------------------------------------
29935. Zones Processed: 
29936. ----------------------------------------------------------
29937. !ZoneListByLine!
29938. ----------------------------------------------------------
29939. Zone Processing Step:
29940. !ZoneStepByLine!    
29941. ----------------------------------------------------------
29942. ----------------------------------------------------------
29943. CURRENT ZONE:
29944. !ZoneStatisticsReport!
29945. ----------------------------------------------------------
29946. ----------------------------------------------------------
29947. ----------------------------------------------------------
29948. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
29949. ----------------------------------------------------------
29950. !VolumeStatisticsSummary!
29951. !VolumeStatisticsDetail!
29952. ----------------------------------------------------------
29953. ----------------------------------------------------------
29954. Zone Detailed Report:
29955. ----------------------------------------------------------
29956. !ZoneStatisticsDetail!
29957. ----------------------------------------------------------
29958. ")
29959. 
29960. 
29961. 
29962. 
29963. 		# File Action - All - Full -  SortByCreationDate
29964. # File Action - ZoneDoActionSortByCreationDateFull
29965. 	SortByCreationDate(Ascending)
29966. 	
29967. 
29968. 
29969. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
29970. 		# Script: DisplaySetZoneStep
29971. # Increment
29972. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29973. 
29974. # Display this zone step
29975. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
29976. ')
29977. 
29978. # Script: BannerSet
29979. 
29980. # NOTE: Can't round or truncate to integer precision. 
29981. # This internal fields like ZoneCount format really badly.
29982. #  for !RunTimeNow! does not work. None of the date functions do.
29983. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29984. 
29985. SetVariable(HeadingTemp2,	ZoneCount + 0)
29986. 
29987. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29988. 
29989. Title('!Heading!')
29990. 
29991. /* pause(1) */
29992. 
29993. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
29994. 
29995. 
29996. # Script: DisplaySetWindowText
29997. # Zone Footer Set Statistics Window Text
29998. 
29999. SetStatisticsWindowText("!Heading!
30000. ----------------------------------------------------------
30001. Zones Processed: 
30002. ----------------------------------------------------------
30003. !ZoneListByLine!
30004. ----------------------------------------------------------
30005. Zone Processing Step:
30006. !ZoneStepByLine!    
30007. ----------------------------------------------------------
30008. ----------------------------------------------------------
30009. CURRENT ZONE:
30010. !ZoneStatisticsReport!
30011. ----------------------------------------------------------
30012. ----------------------------------------------------------
30013. ----------------------------------------------------------
30014. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
30015. ----------------------------------------------------------
30016. !VolumeStatisticsSummary!
30017. !VolumeStatisticsDetail!
30018. ----------------------------------------------------------
30019. ----------------------------------------------------------
30020. Zone Detailed Report:
30021. ----------------------------------------------------------
30022. !ZoneStatisticsDetail!
30023. ----------------------------------------------------------
30024. ")
30025. 
30026. 
30027. 
30028. 
30029. 	# Script: ZoneDoFooter
30030. 
30031. /* --------------------------------- */
30032. 	# File Select
30033. 		# Select Statments
30034. 	# File Actions 
30035. 		# Standard or OS File Actions.
30036. 		# Resume...
30037. 	
30038. 		# your stuff HERE (X)... post zone (file) file actions code.
30039. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
30040. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
30041. 			# (X)
30042. 		
30043. 			/* ??? Set window? */
30044. 	
30045. 		# ADD THE GAP
30046. 		# Script: GapZoneCommand
30047. # Vacate (good for diagnostics)
30048. # DoNotVacate - DO NOT Vacate (recommended)
30049. 
30050. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
30051. # Script: DisplaySetZoneStep
30052. # Increment
30053. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
30054. 
30055. # Display this zone step
30056. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
30057. ')
30058. 
30059. # Script: BannerSet
30060. 
30061. # NOTE: Can't round or truncate to integer precision. 
30062. # This internal fields like ZoneCount format really badly.
30063. #  for !RunTimeNow! does not work. None of the date functions do.
30064. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30065. 
30066. SetVariable(HeadingTemp2,	ZoneCount + 0)
30067. 
30068. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30069. 
30070. Title('!Heading!')
30071. 
30072. /* pause(1) */
30073. 
30074. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30075. 
30076. 
30077. # Script: DisplaySetWindowText
30078. # Zone Footer Set Statistics Window Text
30079. 
30080. SetStatisticsWindowText("!Heading!
30081. ----------------------------------------------------------
30082. Zones Processed: 
30083. ----------------------------------------------------------
30084. !ZoneListByLine!
30085. ----------------------------------------------------------
30086. Zone Processing Step:
30087. !ZoneStepByLine!    
30088. ----------------------------------------------------------
30089. ----------------------------------------------------------
30090. CURRENT ZONE:
30091. !ZoneStatisticsReport!
30092. ----------------------------------------------------------
30093. ----------------------------------------------------------
30094. ----------------------------------------------------------
30095. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
30096. ----------------------------------------------------------
30097. !VolumeStatisticsSummary!
30098. !VolumeStatisticsDetail!
30099. ----------------------------------------------------------
30100. ----------------------------------------------------------
30101. Zone Detailed Report:
30102. ----------------------------------------------------------
30103. !ZoneStatisticsDetail!
30104. ----------------------------------------------------------
30105. ")
30106. 
30107. 
30108. 
30109. 
30110. # *** Moved to setting yours *** 
30111. # (to avoid doing it twice)
30112. # (ie the later wouldn't "overwrite" the former in the usual manner)
30113. 
30114. # Do one or the other:
30115. # DoNotVacate - DO NOT Vacate (recommended)
30116. 
30117. # Vacate
30118. /* AddGap(GapUsedLoc) */
30119. 
30120. # DO Not Vacate
30121. AddGap(GapUsedLoc, DoNotVacate) 
30122. 	
30123. 	
30124. 
30125. # Controlled via settings commands
30126. 
30127. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
30128. 
30129. # Vacate /* AddGap(GapUsed) */
30130. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
30131. 	
30132. 
30133. 		
30134. 	# 
30135. 	FileEnd
30136. /* --------------------------------- */
30137. # your stuff HERE (X)... post zone (file) code.
30138. 
30139. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
30140. # Script: DisplaySetZoneStep
30141. # Increment
30142. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
30143. 
30144. # Display this zone step
30145. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
30146. ')
30147. 
30148. # Script: BannerSet
30149. 
30150. # NOTE: Can't round or truncate to integer precision. 
30151. # This internal fields like ZoneCount format really badly.
30152. #  for !RunTimeNow! does not work. None of the date functions do.
30153. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30154. 
30155. SetVariable(HeadingTemp2,	ZoneCount + 0)
30156. 
30157. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30158. 
30159. Title('!Heading!')
30160. 
30161. /* pause(1) */
30162. 
30163. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30164. 
30165. 
30166. # Script: DisplaySetWindowText
30167. # Zone Footer Set Statistics Window Text
30168. 
30169. SetStatisticsWindowText("!Heading!
30170. ----------------------------------------------------------
30171. Zones Processed: 
30172. ----------------------------------------------------------
30173. !ZoneListByLine!
30174. ----------------------------------------------------------
30175. Zone Processing Step:
30176. !ZoneStepByLine!    
30177. ----------------------------------------------------------
30178. ----------------------------------------------------------
30179. CURRENT ZONE:
30180. !ZoneStatisticsReport!
30181. ----------------------------------------------------------
30182. ----------------------------------------------------------
30183. ----------------------------------------------------------
30184. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
30185. ----------------------------------------------------------
30186. !VolumeStatisticsSummary!
30187. !VolumeStatisticsDetail!
30188. ----------------------------------------------------------
30189. ----------------------------------------------------------
30190. Zone Detailed Report:
30191. ----------------------------------------------------------
30192. !ZoneStatisticsDetail!
30193. ----------------------------------------------------------
30194. ")
30195. 
30196. 
30197. 
30198. 
30199. # Script: ZoneWhenFinished
30200. 
30201. # Add the zone to the zone details log:
30202. # This is temporarily disable until logging is fixed
30203. # It is performed during file action to preserve the correct (original) calculations.
30204. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
30205. 
30206. # Add the Select and ZoneSteps to the Zone
30207. # Script: ZoneStatisticsAdd
30208. # Append Zone to Details of each zone.
30209. 		
30210. 	# Add Zone Details to Report.	
30211. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
30212. ----------------------------------------------------------
30213. !ZoneStepByLine!
30214. ---------------------------
30215. !ZoneTypeSelectCurrent!               
30216. ---------------------------
30217. ----------------------------------------------------------
30218. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
30219. ----------------------------------------------------------
30220. ')
30221. 
30222. 
30223. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
30224. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
30225. # 2021-12-14 15:30:02
30226. RunProgram("..\Commands\WriteDateTime.bat LastZone")
30227. # Append Datetime to logs
30228. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
30229. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
30230. 
30231. AppendLogfile("!LogFileName!", "!PeriodWord!")
30232. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
30233. AppendLogfile("!LogFileName!", "!PeriodWord!")
30234. 
30235. # Script: DisplaySetWindowText
30236. # Zone Footer Set Statistics Window Text
30237. 
30238. SetStatisticsWindowText("!Heading!
30239. ----------------------------------------------------------
30240. Zones Processed: 
30241. ----------------------------------------------------------
30242. !ZoneListByLine!
30243. ----------------------------------------------------------
30244. Zone Processing Step:
30245. !ZoneStepByLine!    
30246. ----------------------------------------------------------
30247. ----------------------------------------------------------
30248. CURRENT ZONE:
30249. !ZoneStatisticsReport!
30250. ----------------------------------------------------------
30251. ----------------------------------------------------------
30252. ----------------------------------------------------------
30253. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
30254. ----------------------------------------------------------
30255. !VolumeStatisticsSummary!
30256. !VolumeStatisticsDetail!
30257. ----------------------------------------------------------
30258. ----------------------------------------------------------
30259. Zone Detailed Report:
30260. ----------------------------------------------------------
30261. !ZoneStatisticsDetail!
30262. ----------------------------------------------------------
30263. ")
30264. 
30265. 
30266. 
30267. /* pause() */
30268. /* pause() */
30269. 
30270. 
30271. 
30272. /* ------------------------- */
30273. 
30274. 
30275. /* ------------------------- */
30276. 
30277. /* ------------------------- */
30278. /* Zone **** Music */
30279. /* ------------------------- */
30280. /* Zone **** Video */
30281. /* ------------------------- */
30282. /* 11 Zone 19 Blobs (BLOBS) */
30283. # Script: DisplayColors - Zone Dark
30284. # Processed
30285. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
30286. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
30287. 
30288. # Light Green and Yellow
30289. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
30290. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
30291. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
30292. 
30293. # Script: DefragZoneTypeBlobs
30294. /* ------------------------- */
30295. /* Zone Blobs (BLOBS) */
30296. SetVariable(ZoneLabel,			"!ZoneLabelBlobs!")
30297. SetVariable(ZoneDescription,		"!ZoneDescriptionBlobs!")
30298. SetVariable(ZoneVolRoundUp,			"!ZoneVolRoundUpBlobs!")
30299. SetVariable(ZoneGapSize,			"!ZoneGapSizeBlobs!")
30300. 
30301. SetVariable(ZoneTypeSelect,'
30302. Blobs:
30303. # Script: ZoneDo ZoneTypeSelectBlobs
30304. # Blobs start.
30305. # NotBlobsArchivesBu start.
30306. (not (
30307. # Archives start.
30308. (
30309.   DirectoryName("*Archive*")
30310.   or DirectoryName("*History*")
30311.   or DirectoryName("*Old")
30312.   or DirectoryName("* Old *")
30313.   or DirectoryName("Old *")
30314. 
30315.   or FileName("*.7z")
30316.   or FileName("*.cab")
30317.   or FileName("*.iso")
30318.   or FileName("*.msi")
30319.   or FileName("*.old")
30320.   or FileName("*.rar")
30321.   or FileName("*.tar")
30322.   or FileName("*.zip")
30323.   or
30324. # WinSysLow start.
30325. (
30326.   # Bad idea. This pushed lots of programs and data to archive.
30327.   # DirectoryName("$*")
30328.   # or DirectoryName("0*")
30329.   # or DirectoryName("1*")
30330.   # or DirectoryName("2*")
30331.   # or DirectoryName("3*")
30332.   # or DirectoryName("4*")
30333.   # or DirectoryName("5*")
30334.   # or DirectoryName("6*")
30335.   # or DirectoryName("7*")
30336.   # or DirectoryName("8*")
30337.   # or DirectoryName("9*")
30338.   # or 
30339.   DirectoryName("dllcache")
30340.   or DirectoryName("Downloaded Installations")
30341.   or DirectoryName("Ehome")
30342.   or DirectoryName("Fonts")
30343.   or DirectoryName("Help")
30344.   or DirectoryName("I386")
30345.   or DirectoryName("ie?updates")
30346.   or DirectoryName("Installer")
30347.   or DirectoryName("Installshield Installation Information")
30348.   or DirectoryName("IME")
30349.   or DirectoryName("*RECYCLE*")
30350.   or DirectoryName("ServicePackFiles")
30351.   or DirectoryName("SoftwareDistribution")
30352.   or DirectoryName("Speech")
30353.   or DirectoryName("Symbols")
30354.   or DirectoryName("System Volume Information")
30355.   or DirectoryName("windows.old")
30356. )
30357. # WinSysLow end.
30358. 
30359.   # Archives
30360. )
30361. # Archives end.
30362. 
30363. # NotBlobsArchivesBu
30364. or
30365. # Backups start.
30366. (
30367.   DirectoryName("*Backup*")
30368.   or DirectoryName("*Bu")
30369.   or DirectoryName("* Bu *")
30370.   or DirectoryName("Bu *")
30371. 
30372.   or FileName("*.bak")
30373.   or FileName("* - Copy*")
30374. )
30375. # Backups end.
30376. 
30377. # NotBlobsArchivesBu
30378. ) )
30379. # NotBlobsArchivesBu end.
30380. 
30381. # Blobs
30382. and ( 
30383. # Blobs start.
30384. (
30385. # BlobsAndExceptions start.
30386. ( not(
30387.   FileName("*.bat")
30388.   or FileName("*.css")
30389.   or FileName("*.dll")
30390.   or FileName("*.exe")
30391.   or FileName("*.htm*")
30392.   or FileName("*.jar")
30393.   or FileName("*.js")
30394.   or FileName("*.script")
30395.   or FileName("*.wsf")
30396.   or (
30397. # Databases start.
30398. (
30399.   FileName("*.crypt*")
30400.   or FileName("*.db*")
30401.   or FileName("*.rdb*")
30402.   or FileName("*.dc*")
30403.   or FileName("*.dict*")
30404.   or FileName("*.?db*")
30405.   or FileName("*.?rdb*")
30406.   or FileName("*.md*")
30407.   or FileName("*.myd")
30408.   or FileName("*.ndf")
30409.   or FileName("*.ns?")
30410.   or FileName("*.pab")
30411.   or FileName("*.pst")
30412.   or FileName("*.sd?*")
30413.   or FileName("*.sq**")
30414.   or FileName("*.tmd")
30415.   or FileName("*.tps")
30416.   or FileName("*.tr*")
30417. )
30418. # Databases end.
30419. 
30420.     # BlobsAndExceptions
30421.     or 
30422. # Data start.
30423. (
30424.   DirectoryName("Data*")
30425.   or DirectoryName("Device*")
30426.   or DirectoryName("Export*")
30427.   or DirectoryName("Import*")
30428.   or DirectoryName("Log*")
30429.   or DirectoryName("*Log")
30430.   or DirectoryName("Maintenance*")
30431.   or DirectoryName("Rec*")
30432.   or DirectoryName("Sales*")
30433.   or DirectoryName("Search*")
30434.   or DirectoryName("User*")
30435. )
30436. # Data end.
30437. 
30438.     # BlobsAndExceptions
30439.   )
30440. ) )
30441. # BlobsAndExceptions end.
30442. 
30443. # Blobs
30444. ) and (
30445.   Size(BlobFileSize,0)
30446.   or (
30447.     FileName("*.arj")
30448.     or FileName("*.bup")
30449.     or FileName("*.bz2")
30450.     or FileName("*.chm")
30451.     or FileName("*.dvr-ms")
30452.     or FileName("*.gz")
30453.     or FileName("*.ifo")
30454.     or FileName("*.lzh")
30455.     or FileName("*.pdf")
30456.     or FileName("*.rpm")
30457.     or FileName("*.wmv")
30458.     or FileName("*.vob")
30459.     or FileName("*.z")
30460.   ) 
30461. )
30462. # Blobs end.
30463. 
30464. # Blobs
30465. ) 
30466. and not  
30467. FileName("ReferenceMarker.MyDx")
30468. # NotBlobsArchivesBu
30469. # Blobs end.
30470. 
30471. ')
30472. 
30473. /* Note: This should be all Blob Files but not archives and backups */
30474. /* It does not matter in my case because given the sorting the */
30475. /* "z Archive", "z Bu" and "z Backup" directories sort to the end. */
30476. 
30477. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
30478. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
30479. 
30480. SetVariable(ZoneStepNoCurrent, 0)
30481. 
30482. 	/* ------------------------- */
30483. # Script: ZoneDoHeader
30484. 
30485. # Script: ZoneWhenStarted
30486. RunProgram("..\Commands\WriteDateTime.bat")
30487. 
30488. # Script: ZoneDoCurrentClear
30489. 
30490. SetVariable(ZoneTypeSelectCurrent, 		"")
30491. SetVariable(ZoneStatisticsData, 		"")
30492. SetVariable(ZoneStepByLine, 			"")
30493. 
30494. SetVariable(ZoneBeginCurrent, 			0)
30495. SetVariable(ZoneBeginPerCurrent, 		0)
30496. SetVariable(ZoneEndCurrent, 			0)
30497. SetVariable(ZoneEndPerCurrent, 			0)
30498. 
30499. SetVariable(ZoneSizeCurrent,			0)
30500. SetVariable(ZoneSizePerCurrent,			0)
30501. 
30502. SetVariable(ZoneGapRequestedCurrent,	0)
30503. SetVariable(ZoneGapRoundedCurrent, 		0)
30504. SetVariable(ZoneGapAdjustedCurrent, 	0)
30505. SetVariable(ZoneGapAvailableCurrent, 	0)
30506. SetVariable(ZoneGapCurrent,				0)
30507. SetVariable(ZoneGapUsedCurrent, 		0)
30508. 
30509. SetVariable(ZoneGapActualCurrent, 		0)
30510. SetVariable(ZoneGapActualPerCurrent, 	0)
30511. 
30512. SetVariable(ZoneSizeActual, 			0)
30513. SetVariable(ZoneSizeActualCurrent,		0)
30514. 
30515. SetVariable(ZoneEndActual, 				0)
30516. SetVariable(ZoneEndActualCurrent,		0)			
30517. SetVariable(ZoneSizeActualPerCurrent, 	0)
30518.       
30519. SetVariable(ZoneFilesFolders,			0)
30520. SetVariable(ZoneFilesFoldersPer,		0) 
30521. 
30522. SetVariable(ZoneFragments,				0)
30523. SetVariable(ZoneFragmentsPer,			0) 
30524. 		
30525. SetVariable(ZoneEndActualCurrent, 		0)
30526. SetVariable(ZoneEndActualPerCurrent, 	0)
30527. 
30528. # Gap Calculation Methodology:
30529. 	# Requested
30530. 	SetVariable(GapRequested, 			0) 
30531. 	SetVariable(GapRequestedStd, 		0) 
30532. 	SetVariable(GapRequestedMft, 		0) 
30533. 	SetVariable(GapRequestedOs, 		0) 
30534. 	SetVariable(GapRequestedOriginal, 	0) 
30535. 	
30536. 	# Gap Adjustments
30537. 	SetVariable(GapRounded, 			0)
30538. 	# SetVariable(GapAdjusted, 			0)
30539. 	SetVariable(GapAvailable, 			0)
30540. 	SetVariable(GapCurrent, 			0)
30541. 	SetVariable(GapActual, 				0)
30542. 	SetVariable(GapUsed, 				0)
30543. 	
30544. 	# Gap Adjustments
30545. 	SetVariable(GapRoundedLoc, 			0)
30546. 	# SetVariable(GapAdjustedLoc, 		0)
30547. 	SetVariable(GapAvailableLoc, 		0)
30548. 	SetVariable(GapCurrentLoc, 			0)
30549. 	SetVariable(GapActualLoc,			0)
30550. 	SetVariable(GapUsedLoc,				0)
30551. 	
30552. 	# Space usage
30553. 	SetVariable(ZoneFreePerRequested, 	0)
30554. 	SetVariable(ZoneFreePerUsed, 		0)
30555. 
30556. # Gap Size & Rounding
30557. 	SetVariable(ZoneGapSizePer, 		0)
30558. 	SetVariable(ZoneVolRoundUpPer, 		0)
30559. 	
30560. 	# Free Space
30561. 	SetVariable(ZoneFreeUsedPer, 		0)
30562. 	SetVariable(ZoneFreeRequestedPer, 	0)
30563. 
30564. # Script: DisplaySetZone
30565. 
30566. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
30567. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
30568. 
30569. # Message ZoneSummary
30570. # SetVariable(ZoneSummary, '
30571. # Zone Summary:
30572. # ')
30573. # Zone processing steps
30574. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
30575. # ')
30576. 
30577. # # Script: BannerDescriptionSet
30578. 
30579. # Script: BannerSet
30580. 
30581. # NOTE: Can't round or truncate to integer precision. 
30582. # This internal fields like ZoneCount format really badly.
30583. #  for !RunTimeNow! does not work. None of the date functions do.
30584. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30585. 
30586. SetVariable(HeadingTemp2,	ZoneCount + 0)
30587. 
30588. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30589. 
30590. Title('!Heading!')
30591. 
30592. /* pause(1) */
30593. 
30594. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30595. 
30596. 
30597. # Script: BannerLog
30598. 
30599. AppendLogfile("!LogFileName!", "!Heading!")
30600. 
30601. 
30602. 
30603. # pause(1)
30604. 
30605. 
30606. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
30607. # Script: DisplaySetZoneStep
30608. # Increment
30609. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
30610. 
30611. # Display this zone step
30612. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
30613. ')
30614. 
30615. # Script: BannerSet
30616. 
30617. # NOTE: Can't round or truncate to integer precision. 
30618. # This internal fields like ZoneCount format really badly.
30619. #  for !RunTimeNow! does not work. None of the date functions do.
30620. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30621. 
30622. SetVariable(HeadingTemp2,	ZoneCount + 0)
30623. 
30624. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30625. 
30626. Title('!Heading!')
30627. 
30628. /* pause(1) */
30629. 
30630. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30631. 
30632. 
30633. # Script: DisplaySetWindowText
30634. # Zone Footer Set Statistics Window Text
30635. 
30636. SetStatisticsWindowText("!Heading!
30637. ----------------------------------------------------------
30638. Zones Processed: 
30639. ----------------------------------------------------------
30640. !ZoneListByLine!
30641. ----------------------------------------------------------
30642. Zone Processing Step:
30643. !ZoneStepByLine!    
30644. ----------------------------------------------------------
30645. ----------------------------------------------------------
30646. CURRENT ZONE:
30647. !ZoneStatisticsReport!
30648. ----------------------------------------------------------
30649. ----------------------------------------------------------
30650. ----------------------------------------------------------
30651. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
30652. ----------------------------------------------------------
30653. !VolumeStatisticsSummary!
30654. !VolumeStatisticsDetail!
30655. ----------------------------------------------------------
30656. ----------------------------------------------------------
30657. Zone Detailed Report:
30658. ----------------------------------------------------------
30659. !ZoneStatisticsDetail!
30660. ----------------------------------------------------------
30661. ")
30662. 
30663. 
30664. 
30665. 
30666. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
30667. 
30668. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
30669. # Script: DisplaySetZoneStep
30670. # Increment
30671. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
30672. 
30673. # Display this zone step
30674. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
30675. ')
30676. 
30677. # Script: BannerSet
30678. 
30679. # NOTE: Can't round or truncate to integer precision. 
30680. # This internal fields like ZoneCount format really badly.
30681. #  for !RunTimeNow! does not work. None of the date functions do.
30682. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30683. 
30684. SetVariable(HeadingTemp2,	ZoneCount + 0)
30685. 
30686. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30687. 
30688. Title('!Heading!')
30689. 
30690. /* pause(1) */
30691. 
30692. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30693. 
30694. 
30695. # Script: DisplaySetWindowText
30696. # Zone Footer Set Statistics Window Text
30697. 
30698. SetStatisticsWindowText("!Heading!
30699. ----------------------------------------------------------
30700. Zones Processed: 
30701. ----------------------------------------------------------
30702. !ZoneListByLine!
30703. ----------------------------------------------------------
30704. Zone Processing Step:
30705. !ZoneStepByLine!    
30706. ----------------------------------------------------------
30707. ----------------------------------------------------------
30708. CURRENT ZONE:
30709. !ZoneStatisticsReport!
30710. ----------------------------------------------------------
30711. ----------------------------------------------------------
30712. ----------------------------------------------------------
30713. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
30714. ----------------------------------------------------------
30715. !VolumeStatisticsSummary!
30716. !VolumeStatisticsDetail!
30717. ----------------------------------------------------------
30718. ----------------------------------------------------------
30719. Zone Detailed Report:
30720. ----------------------------------------------------------
30721. !ZoneStatisticsDetail!
30722. ----------------------------------------------------------
30723. ")
30724. 
30725. 
30726. 
30727. 
30728. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
30729. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
30730. 
30731. # Script: BannerSet
30732. 
30733. # NOTE: Can't round or truncate to integer precision. 
30734. # This internal fields like ZoneCount format really badly.
30735. #  for !RunTimeNow! does not work. None of the date functions do.
30736. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30737. 
30738. SetVariable(HeadingTemp2,	ZoneCount + 0)
30739. 
30740. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30741. 
30742. Title('!Heading!')
30743. 
30744. /* pause(1) */
30745. 
30746. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30747. 
30748. 
30749. # Script: BannerLog
30750. 
30751. AppendLogfile("!LogFileName!", "!Heading!")
30752. 
30753. 
30754. 
30755. # LOGGING:
30756. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
30757. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
30758. 
30759. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
30760. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:02")
30761. # 2021-12-14 15:30:02 
30762. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:07 !ZoneLabel! !ZoneDescription!")
30763. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
30764. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:07 !ZoneLabel! !ZoneDescription!")
30765. 
30766. 
30767. # Add zone to list of zones:
30768. SetVariable(ZoneListByLine, "!ZoneListByLine!
30769. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
30770. # Script: DisplaySetWindowText
30771. # Zone Footer Set Statistics Window Text
30772. 
30773. SetStatisticsWindowText("!Heading!
30774. ----------------------------------------------------------
30775. Zones Processed: 
30776. ----------------------------------------------------------
30777. !ZoneListByLine!
30778. ----------------------------------------------------------
30779. Zone Processing Step:
30780. !ZoneStepByLine!    
30781. ----------------------------------------------------------
30782. ----------------------------------------------------------
30783. CURRENT ZONE:
30784. !ZoneStatisticsReport!
30785. ----------------------------------------------------------
30786. ----------------------------------------------------------
30787. ----------------------------------------------------------
30788. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
30789. ----------------------------------------------------------
30790. !VolumeStatisticsSummary!
30791. !VolumeStatisticsDetail!
30792. ----------------------------------------------------------
30793. ----------------------------------------------------------
30794. Zone Detailed Report:
30795. ----------------------------------------------------------
30796. !ZoneStatisticsDetail!
30797. ----------------------------------------------------------
30798. ")
30799. 
30800. 
30801. 
30802. 
30803. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
30804. # Script: DisplaySetZoneStep
30805. # Increment
30806. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
30807. 
30808. # Display this zone step
30809. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
30810. ')
30811. 
30812. # Script: BannerSet
30813. 
30814. # NOTE: Can't round or truncate to integer precision. 
30815. # This internal fields like ZoneCount format really badly.
30816. #  for !RunTimeNow! does not work. None of the date functions do.
30817. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30818. 
30819. SetVariable(HeadingTemp2,	ZoneCount + 0)
30820. 
30821. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30822. 
30823. Title('!Heading!')
30824. 
30825. /* pause(1) */
30826. 
30827. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
30828. 
30829. 
30830. # Script: DisplaySetWindowText
30831. # Zone Footer Set Statistics Window Text
30832. 
30833. SetStatisticsWindowText("!Heading!
30834. ----------------------------------------------------------
30835. Zones Processed: 
30836. ----------------------------------------------------------
30837. !ZoneListByLine!
30838. ----------------------------------------------------------
30839. Zone Processing Step:
30840. !ZoneStepByLine!    
30841. ----------------------------------------------------------
30842. ----------------------------------------------------------
30843. CURRENT ZONE:
30844. !ZoneStatisticsReport!
30845. ----------------------------------------------------------
30846. ----------------------------------------------------------
30847. ----------------------------------------------------------
30848. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
30849. ----------------------------------------------------------
30850. !VolumeStatisticsSummary!
30851. !VolumeStatisticsDetail!
30852. ----------------------------------------------------------
30853. ----------------------------------------------------------
30854. Zone Detailed Report:
30855. ----------------------------------------------------------
30856. !ZoneStatisticsDetail!
30857. ----------------------------------------------------------
30858. ")
30859. 
30860. 
30861. 
30862. 
30863. # your stuff HERE (X)... pre file select code.
30864. 
30865. /* --------------------------------- */
30866. 	FileSelect
30867. 
30868. 		# your stuff can't really go here (errors.)
30869. 		# maybe for some reason I don't know of...
30870. 	
30871. 		# Actions next...
30872. 	# Script: ZoneDo ZoneTypeSelectBlobs
30873. # Blobs start.
30874. # NotBlobsArchivesBu start.
30875. (not (
30876. # Archives start.
30877. (
30878.   DirectoryName("*Archive*")
30879.   or DirectoryName("*History*")
30880.   or DirectoryName("*Old")
30881.   or DirectoryName("* Old *")
30882.   or DirectoryName("Old *")
30883. 
30884.   or FileName("*.7z")
30885.   or FileName("*.cab")
30886.   or FileName("*.iso")
30887.   or FileName("*.msi")
30888.   or FileName("*.old")
30889.   or FileName("*.rar")
30890.   or FileName("*.tar")
30891.   or FileName("*.zip")
30892.   or
30893. # WinSysLow start.
30894. (
30895.   # Bad idea. This pushed lots of programs and data to archive.
30896.   # DirectoryName("$*")
30897.   # or DirectoryName("0*")
30898.   # or DirectoryName("1*")
30899.   # or DirectoryName("2*")
30900.   # or DirectoryName("3*")
30901.   # or DirectoryName("4*")
30902.   # or DirectoryName("5*")
30903.   # or DirectoryName("6*")
30904.   # or DirectoryName("7*")
30905.   # or DirectoryName("8*")
30906.   # or DirectoryName("9*")
30907.   # or 
30908.   DirectoryName("dllcache")
30909.   or DirectoryName("Downloaded Installations")
30910.   or DirectoryName("Ehome")
30911.   or DirectoryName("Fonts")
30912.   or DirectoryName("Help")
30913.   or DirectoryName("I386")
30914.   or DirectoryName("ie?updates")
30915.   or DirectoryName("Installer")
30916.   or DirectoryName("Installshield Installation Information")
30917.   or DirectoryName("IME")
30918.   or DirectoryName("*RECYCLE*")
30919.   or DirectoryName("ServicePackFiles")
30920.   or DirectoryName("SoftwareDistribution")
30921.   or DirectoryName("Speech")
30922.   or DirectoryName("Symbols")
30923.   or DirectoryName("System Volume Information")
30924.   or DirectoryName("windows.old")
30925. )
30926. # WinSysLow end.
30927. 
30928.   # Archives
30929. )
30930. # Archives end.
30931. 
30932. # NotBlobsArchivesBu
30933. or
30934. # Backups start.
30935. (
30936.   DirectoryName("*Backup*")
30937.   or DirectoryName("*Bu")
30938.   or DirectoryName("* Bu *")
30939.   or DirectoryName("Bu *")
30940. 
30941.   or FileName("*.bak")
30942.   or FileName("* - Copy*")
30943. )
30944. # Backups end.
30945. 
30946. # NotBlobsArchivesBu
30947. ) )
30948. # NotBlobsArchivesBu end.
30949. 
30950. # Blobs
30951. and ( 
30952. # Blobs start.
30953. (
30954. # BlobsAndExceptions start.
30955. ( not(
30956.   FileName("*.bat")
30957.   or FileName("*.css")
30958.   or FileName("*.dll")
30959.   or FileName("*.exe")
30960.   or FileName("*.htm*")
30961.   or FileName("*.jar")
30962.   or FileName("*.js")
30963.   or FileName("*.script")
30964.   or FileName("*.wsf")
30965.   or (
30966. # Databases start.
30967. (
30968.   FileName("*.crypt*")
30969.   or FileName("*.db*")
30970.   or FileName("*.rdb*")
30971.   or FileName("*.dc*")
30972.   or FileName("*.dict*")
30973.   or FileName("*.?db*")
30974.   or FileName("*.?rdb*")
30975.   or FileName("*.md*")
30976.   or FileName("*.myd")
30977.   or FileName("*.ndf")
30978.   or FileName("*.ns?")
30979.   or FileName("*.pab")
30980.   or FileName("*.pst")
30981.   or FileName("*.sd?*")
30982.   or FileName("*.sq**")
30983.   or FileName("*.tmd")
30984.   or FileName("*.tps")
30985.   or FileName("*.tr*")
30986. )
30987. # Databases end.
30988. 
30989.     # BlobsAndExceptions
30990.     or 
30991. # Data start.
30992. (
30993.   DirectoryName("Data*")
30994.   or DirectoryName("Device*")
30995.   or DirectoryName("Export*")
30996.   or DirectoryName("Import*")
30997.   or DirectoryName("Log*")
30998.   or DirectoryName("*Log")
30999.   or DirectoryName("Maintenance*")
31000.   or DirectoryName("Rec*")
31001.   or DirectoryName("Sales*")
31002.   or DirectoryName("Search*")
31003.   or DirectoryName("User*")
31004. )
31005. # Data end.
31006. 
31007.     # BlobsAndExceptions
31008.   )
31009. ) )
31010. # BlobsAndExceptions end.
31011. 
31012. # Blobs
31013. ) and (
31014.   Size(BlobFileSize,0)
31015.   or (
31016.     FileName("*.arj")
31017.     or FileName("*.bup")
31018.     or FileName("*.bz2")
31019.     or FileName("*.chm")
31020.     or FileName("*.dvr-ms")
31021.     or FileName("*.gz")
31022.     or FileName("*.ifo")
31023.     or FileName("*.lzh")
31024.     or FileName("*.pdf")
31025.     or FileName("*.rpm")
31026.     or FileName("*.wmv")
31027.     or FileName("*.vob")
31028.     or FileName("*.z")
31029.   ) 
31030. )
31031. # Blobs end.
31032. 
31033. # Blobs
31034. ) 
31035. and not  
31036. FileName("ReferenceMarker.MyDx")
31037. # NotBlobsArchivesBu
31038. # Blobs end.
31039. 
31040. 
31041. 	# Xinclude "..\Zone\ZoneDoAction.MyDc"X
31042. 
31043. 	FileActions
31044. 
31045. 			# Script: GapZoneCalc
31046. 	# Gap
31047. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
31048. 		# Script: DisplaySetZoneStep
31049. # Increment
31050. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
31051. 
31052. # Display this zone step
31053. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
31054. ')
31055. 
31056. # Script: BannerSet
31057. 
31058. # NOTE: Can't round or truncate to integer precision. 
31059. # This internal fields like ZoneCount format really badly.
31060. #  for !RunTimeNow! does not work. None of the date functions do.
31061. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
31062. 
31063. SetVariable(HeadingTemp2,	ZoneCount + 0)
31064. 
31065. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
31066. 
31067. Title('!Heading!')
31068. 
31069. /* pause(1) */
31070. 
31071. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
31072. 
31073. 
31074. # Script: DisplaySetWindowText
31075. # Zone Footer Set Statistics Window Text
31076. 
31077. SetStatisticsWindowText("!Heading!
31078. ----------------------------------------------------------
31079. Zones Processed: 
31080. ----------------------------------------------------------
31081. !ZoneListByLine!
31082. ----------------------------------------------------------
31083. Zone Processing Step:
31084. !ZoneStepByLine!    
31085. ----------------------------------------------------------
31086. ----------------------------------------------------------
31087. CURRENT ZONE:
31088. !ZoneStatisticsReport!
31089. ----------------------------------------------------------
31090. ----------------------------------------------------------
31091. ----------------------------------------------------------
31092. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
31093. ----------------------------------------------------------
31094. !VolumeStatisticsSummary!
31095. !VolumeStatisticsDetail!
31096. ----------------------------------------------------------
31097. ----------------------------------------------------------
31098. Zone Detailed Report:
31099. ----------------------------------------------------------
31100. !ZoneStatisticsDetail!
31101. ----------------------------------------------------------
31102. ")
31103. 
31104. 
31105. 
31106. 	
31107. 	# ACTUAL GAP
31108. 		/* AddGap Variant. */
31109. 	  	# Script: GapZoneSet
31110. # Zone Do Gap
31111. # Gap Calculation Methods:
31112. 
31113. /* 1) Anything you need to add first. */
31114. /* empty */
31115. 
31116. /* ------------------------- */
31117. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
31118. 	# GapRequestedStd.
31119. 
31120. 		/* ------------------------- */
31121. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
31122. 
31123. 		# Gap Calculation Methods:
31124. 
31125. /* AddGap Variants */
31126. 
31127. 	/* Standard */
31128. 		# Gap Calculation Methods:
31129. 	/* AddGap Variants */
31130. 	/* Standard */
31131. 
31132. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
31133. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
31134. 
31135. 	SetVariable(GapRequested, GapRequestedStd)
31136. 	
31137. 
31138. 	/* MFT Low High Method */
31139. 		# Gap Calculation Methods:
31140. 	/* AddGap Variants */
31141. 	/* MFT Low High Method */
31142. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
31143. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
31144. 	SetVariable(GapRequested, GapRequestedMft)
31145. 	
31146. 
31147. 	/* OS Volume Type Method */
31148. 		# Gap Calculation Methods:
31149. 	/* AddGap Variants */
31150. 	/* OS Volume Type Method */
31151. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
31152. 	SetVariable(GapRequested, GapRequestedOs)
31153. 
31154. 
31155. 
31156. /* MakeGap Variants */
31157. 
31158. 	/* Original Os 1-3 + MFT 2 */
31159. 		# Gap Calculation Methods:
31160. 	/* MakeGap Variants */
31161. 	/* Original Os 1-3 + MFT 2 */
31162. 	/* plus MFT gap placed inline at the dividing zone. */
31163. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
31164. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
31165. 	SetVariable(GapRequested, GapRequestedOrig)
31166. 	
31167. 	
31168. /* Note: You could comment out the ones not in use */
31169. /* However having the data in the log is useful. */
31170. /* Therefore the following line is otherwise needed. */
31171. 
31172. /* Standard used */
31173. 
31174. SetVariable(GapRequested, GapRequestedStd)
31175. 
31176. # Gap Calculation Methods:
31177. 
31178. /* AddGap Variants */
31179. 	/* Standard */
31180. 	/* MFT Low High Method */
31181. 	/* OS Volume Type Method */
31182. 
31183. /* MakeGap Variants */
31184. 	/* Original Os 1-3 + MFT 2 */
31185. 
31186. /* Note: You could comment out the ones not in use */
31187. /* However having the data in the log is useful. */
31188. /* Therefore the following line is otherwise needed. */
31189. 
31190. /* Standard is used currently */
31191. 
31192. 
31193. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
31194. 
31195. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
31196. 
31197. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
31198. 
31199. /* ------------------------- */
31200. /* 3) SMALL ZONE ADJUSTMENT. */
31201. /* Gab cant be larger than half the Zone Size. */
31202. 
31203. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
31204. 	
31205. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
31206. 
31207. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
31208. 
31209. /* ------------------------- */
31210. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
31211. # Gap Adjustments.
31212. 
31213. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
31214. 	
31215. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
31216. 
31217. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
31218. 
31219. /* ------------------------- */
31220. # BYPASS THIS.
31221. 	/* This is definitely wrong. */
31222. 	/* The question is can we steal gap from the next zone */
31223. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
31224. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
31225. 		# Zone Overflow.
31226. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
31227. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
31228. 
31229. /* ------------------------- */
31230. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
31231. # Remaining free space available.
31232. 
31233. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
31234. 	
31235. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
31236. 
31237. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
31238. 
31239. /* ------------------------- */
31240. # CURRENT gap to use.
31241. 
31242. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
31243. 
31244. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
31245. 
31246. /* ------------------------- */
31247. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
31248. # Debugging.
31249. 
31250. 	SetVariable(GapUsed, GapCurrent) // for debugging
31251. 
31252. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
31253. 
31254. 		# Your code HERE
31255. 
31256. /* ------------------------- */
31257. /* 7) YOUR CODE. */
31258. # YOUR CODE HERE:
31259. 	# INPUT: GapCurrent or GapCurrentLoc
31260. 	# OUTPUT: GapUsed...
31261. 
31262. /* ------------------------- */
31263. # Gap Size.
31264. # Actual Size of Gap.
31265. 
31266. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
31267. 
31268. /* ------------------------- */
31269. 
31270. 	
31271. 	# Zone Statistics	
31272. 		# Script: ZoneStatisticsGet
31273. # Zone / Volume Statistics and Display
31274. 		
31275. 	# Accumulate Totals
31276.   	# Script: ZoneDoVolumeTotals
31277. 
31278. /* Current total space used (by Zones and Gaps) */
31279. 
31280. SetVariable(VolumeZoneUsed, GapUsed)
31281. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
31282. /* Percentage */
31283. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
31284. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
31285. 
31286. /* Current total of free space requested */
31287. 
31288. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
31289. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
31290. /* Percent. */
31291. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
31292. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
31293. 
31294. /* Current total of free space used */
31295. 
31296. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
31297. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
31298. /* Percent */
31299. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
31300. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
31301. 
31302. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
31303. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
31304. # Xinclude "..\DebugDisplayPause.MyDc"X
31305. 
31306. 
31307. 	# Current Values
31308. 	# Script: ZoneDoCurrentSet
31309. 
31310. # Cluster, Sector, Block adjust for display.
31311. 	# Bytes per cluster is volume specific.
31312. 
31313. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
31314. 
31315. # Current Zone values.
31316. 	# Begin, end and size.
31317. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
31318. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
31319. 
31320. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
31321. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
31322. 
31323. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
31324. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
31325. 
31326. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
31327. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
31328. 
31329. 	SetVariable(ZoneFragments,				"!ZONE210N!")
31330. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
31331. 		
31332. # Current Gap, Actual and Free Values
31333. 	# Gap
31334. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
31335. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
31336. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
31337. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
31338. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
31339. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
31340. 	
31341. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
31342. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
31343. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
31344. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
31345. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
31346. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
31347. 	
31348. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
31349. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
31350. 	
31351. 	# Actual Size and End
31352. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
31353. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
31354. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
31355. 	
31356. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
31357. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
31358. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
31359. 
31360. # Gap Size & Rounding
31361. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
31362. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
31363. 	
31364. 	# Free Space
31365. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
31366. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
31367. 
31368. 	# Script: ZoneStatisticsReportGet
31369. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
31370. 
31371. # Footer:
31372. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
31373. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
31374. #
31375. # Xinclude "..\Commands\DateTimeLastLong.txt"X
31376. #
31377. # What a mess this word based vs is. Try a phrase based version ToDo
31378. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
31379. ------------------
31380.    !SizeWord!!ColonWord!  
31381.    ------------------------
31382.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
31383.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
31384.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
31385. 
31386.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
31387.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
31388. 
31389.    !LocationWord!!ColonWord!
31390.    ------------------------
31391.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
31392.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
31393.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
31394.       
31395.    !GapWordCaps! !SettingsWord!!ColonWord!
31396.    ------------------------
31397.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
31398.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
31399.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
31400.                  
31401.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
31402.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
31403.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
31404.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
31405.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
31406.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
31407.      
31408.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
31409.    ------------------------
31410.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
31411.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
31412.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
31413. 
31414. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
31415. ----------------------------------------------------------
31416. ")
31417. #
31418. SetVariable(DateNow, 	DATETIME)
31419. SetVariable(TimeNow, 	Time)
31420. SetVariable(RunTimeNow, 	RunTime)
31421. 
31422. 
31423. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
31424. 
31425. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
31426. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
31427. 
31428. 	# Script: DisplaySetWindowText
31429. # Zone Footer Set Statistics Window Text
31430. 
31431. SetStatisticsWindowText("!Heading!
31432. ----------------------------------------------------------
31433. Zones Processed: 
31434. ----------------------------------------------------------
31435. !ZoneListByLine!
31436. ----------------------------------------------------------
31437. Zone Processing Step:
31438. !ZoneStepByLine!    
31439. ----------------------------------------------------------
31440. ----------------------------------------------------------
31441. CURRENT ZONE:
31442. !ZoneStatisticsReport!
31443. ----------------------------------------------------------
31444. ----------------------------------------------------------
31445. ----------------------------------------------------------
31446. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
31447. ----------------------------------------------------------
31448. !VolumeStatisticsSummary!
31449. !VolumeStatisticsDetail!
31450. ----------------------------------------------------------
31451. ----------------------------------------------------------
31452. Zone Detailed Report:
31453. ----------------------------------------------------------
31454. !ZoneStatisticsDetail!
31455. ----------------------------------------------------------
31456. ")
31457. 
31458. 
31459. 	
31460. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
31461. 
31462. 
31463. 	SetVariable(ZoneStatisticsData, 
31464. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
31465.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
31466.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
31467. 
31468. 
31469. 
31470.  		# Script: ZoneStatisticsDisplay
31471. 	
31472. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
31473. !ZoneStatisticsData!
31474. ')
31475. 
31476. 		# Script: ZoneStatisticsAdd
31477. # Append Zone to Details of each zone.
31478. 		
31479. 	# Add Zone Details to Report.	
31480. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
31481. !ZoneStatisticsReport!
31482. ')
31483. 
31484. 
31485. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
31486. 		# Script: DisplaySetZoneStep
31487. # Increment
31488. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
31489. 
31490. # Display this zone step
31491. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
31492. ')
31493. 
31494. # Script: BannerSet
31495. 
31496. # NOTE: Can't round or truncate to integer precision. 
31497. # This internal fields like ZoneCount format really badly.
31498. #  for !RunTimeNow! does not work. None of the date functions do.
31499. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
31500. 
31501. SetVariable(HeadingTemp2,	ZoneCount + 0)
31502. 
31503. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
31504. 
31505. Title('!Heading!')
31506. 
31507. /* pause(1) */
31508. 
31509. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
31510. 
31511. 
31512. # Script: DisplaySetWindowText
31513. # Zone Footer Set Statistics Window Text
31514. 
31515. SetStatisticsWindowText("!Heading!
31516. ----------------------------------------------------------
31517. Zones Processed: 
31518. ----------------------------------------------------------
31519. !ZoneListByLine!
31520. ----------------------------------------------------------
31521. Zone Processing Step:
31522. !ZoneStepByLine!    
31523. ----------------------------------------------------------
31524. ----------------------------------------------------------
31525. CURRENT ZONE:
31526. !ZoneStatisticsReport!
31527. ----------------------------------------------------------
31528. ----------------------------------------------------------
31529. ----------------------------------------------------------
31530. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
31531. ----------------------------------------------------------
31532. !VolumeStatisticsSummary!
31533. !VolumeStatisticsDetail!
31534. ----------------------------------------------------------
31535. ----------------------------------------------------------
31536. Zone Detailed Report:
31537. ----------------------------------------------------------
31538. !ZoneStatisticsDetail!
31539. ----------------------------------------------------------
31540. ")
31541. 
31542. 
31543. 
31544. 	
31545. 		# File Action - Blobs - Full -  SortByCreationDate
31546. # File Action - ZoneDoActionSortByCreationDateFull
31547. 	SortByCreationDate(Ascending)
31548. 	
31549. 
31550. 
31551. 		SetVariable(ZoneStepDescription, 	"!ZoneStepDescriptionFileActionEnd!")
31552. 		# Script: DisplaySetZoneStep
31553. # Increment
31554. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
31555. 
31556. # Display this zone step
31557. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
31558. ')
31559. 
31560. # Script: BannerSet
31561. 
31562. # NOTE: Can't round or truncate to integer precision. 
31563. # This internal fields like ZoneCount format really badly.
31564. #  for !RunTimeNow! does not work. None of the date functions do.
31565. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
31566. 
31567. SetVariable(HeadingTemp2,	ZoneCount + 0)
31568. 
31569. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
31570. 
31571. Title('!Heading!')
31572. 
31573. /* pause(1) */
31574. 
31575. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
31576. 
31577. 
31578. # Script: DisplaySetWindowText
31579. # Zone Footer Set Statistics Window Text
31580. 
31581. SetStatisticsWindowText("!Heading!
31582. ----------------------------------------------------------
31583. Zones Processed: 
31584. ----------------------------------------------------------
31585. !ZoneListByLine!
31586. ----------------------------------------------------------
31587. Zone Processing Step:
31588. !ZoneStepByLine!    
31589. ----------------------------------------------------------
31590. ----------------------------------------------------------
31591. CURRENT ZONE:
31592. !ZoneStatisticsReport!
31593. ----------------------------------------------------------
31594. ----------------------------------------------------------
31595. ----------------------------------------------------------
31596. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
31597. ----------------------------------------------------------
31598. !VolumeStatisticsSummary!
31599. !VolumeStatisticsDetail!
31600. ----------------------------------------------------------
31601. ----------------------------------------------------------
31602. Zone Detailed Report:
31603. ----------------------------------------------------------
31604. !ZoneStatisticsDetail!
31605. ----------------------------------------------------------
31606. ")
31607. 
31608. 
31609. 
31610. 
31611. 	# Script: ZoneDoFooter
31612. 
31613. /* --------------------------------- */
31614. 	# File Select
31615. 		# Select Statments
31616. 	# File Actions 
31617. 		# Standard or OS File Actions.
31618. 		# Resume...
31619. 	
31620. 		# your stuff HERE (X)... post zone (file) file actions code.
31621. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
31622. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
31623. 			# (X)
31624. 		
31625. 			/* ??? Set window? */
31626. 	
31627. 		# ADD THE GAP
31628. 		# Script: GapZoneCommand
31629. # Vacate (good for diagnostics)
31630. # DoNotVacate - DO NOT Vacate (recommended)
31631. 
31632. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
31633. # Script: DisplaySetZoneStep
31634. # Increment
31635. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
31636. 
31637. # Display this zone step
31638. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
31639. ')
31640. 
31641. # Script: BannerSet
31642. 
31643. # NOTE: Can't round or truncate to integer precision. 
31644. # This internal fields like ZoneCount format really badly.
31645. #  for !RunTimeNow! does not work. None of the date functions do.
31646. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
31647. 
31648. SetVariable(HeadingTemp2,	ZoneCount + 0)
31649. 
31650. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
31651. 
31652. Title('!Heading!')
31653. 
31654. /* pause(1) */
31655. 
31656. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
31657. 
31658. 
31659. # Script: DisplaySetWindowText
31660. # Zone Footer Set Statistics Window Text
31661. 
31662. SetStatisticsWindowText("!Heading!
31663. ----------------------------------------------------------
31664. Zones Processed: 
31665. ----------------------------------------------------------
31666. !ZoneListByLine!
31667. ----------------------------------------------------------
31668. Zone Processing Step:
31669. !ZoneStepByLine!    
31670. ----------------------------------------------------------
31671. ----------------------------------------------------------
31672. CURRENT ZONE:
31673. !ZoneStatisticsReport!
31674. ----------------------------------------------------------
31675. ----------------------------------------------------------
31676. ----------------------------------------------------------
31677. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
31678. ----------------------------------------------------------
31679. !VolumeStatisticsSummary!
31680. !VolumeStatisticsDetail!
31681. ----------------------------------------------------------
31682. ----------------------------------------------------------
31683. Zone Detailed Report:
31684. ----------------------------------------------------------
31685. !ZoneStatisticsDetail!
31686. ----------------------------------------------------------
31687. ")
31688. 
31689. 
31690. 
31691. 
31692. # *** Moved to setting yours *** 
31693. # (to avoid doing it twice)
31694. # (ie the later wouldn't "overwrite" the former in the usual manner)
31695. 
31696. # Do one or the other:
31697. # DoNotVacate - DO NOT Vacate (recommended)
31698. 
31699. # Vacate
31700. /* AddGap(GapUsedLoc) */
31701. 
31702. # DO Not Vacate
31703. AddGap(GapUsedLoc, DoNotVacate) 
31704. 	
31705. 	
31706. 
31707. # Controlled via settings commands
31708. 
31709. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
31710. 
31711. # Vacate /* AddGap(GapUsed) */
31712. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
31713. 	
31714. 
31715. 		
31716. 	# 
31717. 	FileEnd
31718. /* --------------------------------- */
31719. # your stuff HERE (X)... post zone (file) code.
31720. 
31721. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
31722. # Script: DisplaySetZoneStep
31723. # Increment
31724. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
31725. 
31726. # Display this zone step
31727. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
31728. ')
31729. 
31730. # Script: BannerSet
31731. 
31732. # NOTE: Can't round or truncate to integer precision. 
31733. # This internal fields like ZoneCount format really badly.
31734. #  for !RunTimeNow! does not work. None of the date functions do.
31735. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
31736. 
31737. SetVariable(HeadingTemp2,	ZoneCount + 0)
31738. 
31739. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
31740. 
31741. Title('!Heading!')
31742. 
31743. /* pause(1) */
31744. 
31745. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
31746. 
31747. 
31748. # Script: DisplaySetWindowText
31749. # Zone Footer Set Statistics Window Text
31750. 
31751. SetStatisticsWindowText("!Heading!
31752. ----------------------------------------------------------
31753. Zones Processed: 
31754. ----------------------------------------------------------
31755. !ZoneListByLine!
31756. ----------------------------------------------------------
31757. Zone Processing Step:
31758. !ZoneStepByLine!    
31759. ----------------------------------------------------------
31760. ----------------------------------------------------------
31761. CURRENT ZONE:
31762. !ZoneStatisticsReport!
31763. ----------------------------------------------------------
31764. ----------------------------------------------------------
31765. ----------------------------------------------------------
31766. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
31767. ----------------------------------------------------------
31768. !VolumeStatisticsSummary!
31769. !VolumeStatisticsDetail!
31770. ----------------------------------------------------------
31771. ----------------------------------------------------------
31772. Zone Detailed Report:
31773. ----------------------------------------------------------
31774. !ZoneStatisticsDetail!
31775. ----------------------------------------------------------
31776. ")
31777. 
31778. 
31779. 
31780. 
31781. # Script: ZoneWhenFinished
31782. 
31783. # Add the zone to the zone details log:
31784. # This is temporarily disable until logging is fixed
31785. # It is performed during file action to preserve the correct (original) calculations.
31786. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
31787. 
31788. # Add the Select and ZoneSteps to the Zone
31789. # Script: ZoneStatisticsAdd
31790. # Append Zone to Details of each zone.
31791. 		
31792. 	# Add Zone Details to Report.	
31793. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
31794. ----------------------------------------------------------
31795. !ZoneStepByLine!
31796. ---------------------------
31797. !ZoneTypeSelectCurrent!               
31798. ---------------------------
31799. ----------------------------------------------------------
31800. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
31801. ----------------------------------------------------------
31802. ')
31803. 
31804. 
31805. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
31806. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
31807. # 2021-12-14 15:30:02
31808. RunProgram("..\Commands\WriteDateTime.bat LastZone")
31809. # Append Datetime to logs
31810. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
31811. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
31812. 
31813. AppendLogfile("!LogFileName!", "!PeriodWord!")
31814. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
31815. AppendLogfile("!LogFileName!", "!PeriodWord!")
31816. 
31817. # Script: DisplaySetWindowText
31818. # Zone Footer Set Statistics Window Text
31819. 
31820. SetStatisticsWindowText("!Heading!
31821. ----------------------------------------------------------
31822. Zones Processed: 
31823. ----------------------------------------------------------
31824. !ZoneListByLine!
31825. ----------------------------------------------------------
31826. Zone Processing Step:
31827. !ZoneStepByLine!    
31828. ----------------------------------------------------------
31829. ----------------------------------------------------------
31830. CURRENT ZONE:
31831. !ZoneStatisticsReport!
31832. ----------------------------------------------------------
31833. ----------------------------------------------------------
31834. ----------------------------------------------------------
31835. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
31836. ----------------------------------------------------------
31837. !VolumeStatisticsSummary!
31838. !VolumeStatisticsDetail!
31839. ----------------------------------------------------------
31840. ----------------------------------------------------------
31841. Zone Detailed Report:
31842. ----------------------------------------------------------
31843. !ZoneStatisticsDetail!
31844. ----------------------------------------------------------
31845. ")
31846. 
31847. 
31848. 
31849. /* pause() */
31850. /* pause() */
31851. 
31852. 
31853. 
31854. /* ------------------------- */
31855. 
31856. 
31857. /* ------------------------- */
31858. 
31859. /* ------------------------- */
31860. /* 12 Zone 20 ArchivesBu (All) Archives and Backups */
31861. # Script: DisplayColors - Zone Dark
31862. # Processed
31863. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
31864. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
31865. 
31866. # Light Green and Yellow
31867. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
31868. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
31869. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
31870. 
31871. # Script: DefragZoneTypeArchivesBu
31872. /* ------------------------- */
31873. /* Zone ArchivesBu (All) Archives and Backups*/
31874. 
31875. SetVariable(ZoneLabel, "!ZoneLabelArchivesBu!")
31876. SetVariable(ZoneDescription, "!ZoneDescriptionArchivesBu!")
31877. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpArchivesBu!")
31878. SetVariable(ZoneGapSize, "!ZoneGapSizeArchivesBu!")
31879. 
31880. SetVariable(ZoneTypeSelect,'
31881. Archives and Backups:
31882. # Script: ZoneDo ZoneTypeSelectArchivesBu
31883. # ArchivesBu start.
31884. ( ( 
31885. # ArchivesBu
31886. # Archives start.
31887. (
31888.   DirectoryName("*Archive*")
31889.   or DirectoryName("*History*")
31890.   or DirectoryName("*Old")
31891.   or DirectoryName("* Old *")
31892.   or DirectoryName("Old *")
31893. 
31894.   or FileName("*.7z")
31895.   or FileName("*.cab")
31896.   or FileName("*.iso")
31897.   or FileName("*.msi")
31898.   or FileName("*.old")
31899.   or FileName("*.rar")
31900.   or FileName("*.tar")
31901.   or FileName("*.zip")
31902.   or
31903. # WinSysLow start.
31904. (
31905.   # Bad idea. This pushed lots of programs and data to archive.
31906.   # DirectoryName("$*")
31907.   # or DirectoryName("0*")
31908.   # or DirectoryName("1*")
31909.   # or DirectoryName("2*")
31910.   # or DirectoryName("3*")
31911.   # or DirectoryName("4*")
31912.   # or DirectoryName("5*")
31913.   # or DirectoryName("6*")
31914.   # or DirectoryName("7*")
31915.   # or DirectoryName("8*")
31916.   # or DirectoryName("9*")
31917.   # or 
31918.   DirectoryName("dllcache")
31919.   or DirectoryName("Downloaded Installations")
31920.   or DirectoryName("Ehome")
31921.   or DirectoryName("Fonts")
31922.   or DirectoryName("Help")
31923.   or DirectoryName("I386")
31924.   or DirectoryName("ie?updates")
31925.   or DirectoryName("Installer")
31926.   or DirectoryName("Installshield Installation Information")
31927.   or DirectoryName("IME")
31928.   or DirectoryName("*RECYCLE*")
31929.   or DirectoryName("ServicePackFiles")
31930.   or DirectoryName("SoftwareDistribution")
31931.   or DirectoryName("Speech")
31932.   or DirectoryName("Symbols")
31933.   or DirectoryName("System Volume Information")
31934.   or DirectoryName("windows.old")
31935. )
31936. # WinSysLow end.
31937. 
31938.   # Archives
31939. )
31940. # Archives end.
31941. 
31942. # Bu Backups
31943. or
31944. # Backups start.
31945. (
31946.   DirectoryName("*Backup*")
31947.   or DirectoryName("*Bu")
31948.   or DirectoryName("* Bu *")
31949.   or DirectoryName("Bu *")
31950. 
31951.   or FileName("*.bak")
31952.   or FileName("* - Copy*")
31953. )
31954. # Backups end.
31955. 
31956. )
31957. and not  
31958. FileName("ReferenceMarker.MyDx")
31959. )
31960. # ArchivesBu end.
31961. 
31962. ')
31963. 
31964. /* Note: This should be all Blob archives and backups */
31965. /* The sorting the "z Archive", "z Bu" and "z Backup" directories */
31966. /* sort to the very end of the Volume. */
31967. 
31968. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
31969. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
31970. 
31971. SetVariable(ZoneStepNoCurrent, 0)
31972. 
31973. 	/* ------------------------- */
31974. # Script: ZoneDoHeader
31975. 
31976. # Script: ZoneWhenStarted
31977. RunProgram("..\Commands\WriteDateTime.bat")
31978. 
31979. # Script: ZoneDoCurrentClear
31980. 
31981. SetVariable(ZoneTypeSelectCurrent, 		"")
31982. SetVariable(ZoneStatisticsData, 		"")
31983. SetVariable(ZoneStepByLine, 			"")
31984. 
31985. SetVariable(ZoneBeginCurrent, 			0)
31986. SetVariable(ZoneBeginPerCurrent, 		0)
31987. SetVariable(ZoneEndCurrent, 			0)
31988. SetVariable(ZoneEndPerCurrent, 			0)
31989. 
31990. SetVariable(ZoneSizeCurrent,			0)
31991. SetVariable(ZoneSizePerCurrent,			0)
31992. 
31993. SetVariable(ZoneGapRequestedCurrent,	0)
31994. SetVariable(ZoneGapRoundedCurrent, 		0)
31995. SetVariable(ZoneGapAdjustedCurrent, 	0)
31996. SetVariable(ZoneGapAvailableCurrent, 	0)
31997. SetVariable(ZoneGapCurrent,				0)
31998. SetVariable(ZoneGapUsedCurrent, 		0)
31999. 
32000. SetVariable(ZoneGapActualCurrent, 		0)
32001. SetVariable(ZoneGapActualPerCurrent, 	0)
32002. 
32003. SetVariable(ZoneSizeActual, 			0)
32004. SetVariable(ZoneSizeActualCurrent,		0)
32005. 
32006. SetVariable(ZoneEndActual, 				0)
32007. SetVariable(ZoneEndActualCurrent,		0)			
32008. SetVariable(ZoneSizeActualPerCurrent, 	0)
32009.       
32010. SetVariable(ZoneFilesFolders,			0)
32011. SetVariable(ZoneFilesFoldersPer,		0) 
32012. 
32013. SetVariable(ZoneFragments,				0)
32014. SetVariable(ZoneFragmentsPer,			0) 
32015. 		
32016. SetVariable(ZoneEndActualCurrent, 		0)
32017. SetVariable(ZoneEndActualPerCurrent, 	0)
32018. 
32019. # Gap Calculation Methodology:
32020. 	# Requested
32021. 	SetVariable(GapRequested, 			0) 
32022. 	SetVariable(GapRequestedStd, 		0) 
32023. 	SetVariable(GapRequestedMft, 		0) 
32024. 	SetVariable(GapRequestedOs, 		0) 
32025. 	SetVariable(GapRequestedOriginal, 	0) 
32026. 	
32027. 	# Gap Adjustments
32028. 	SetVariable(GapRounded, 			0)
32029. 	# SetVariable(GapAdjusted, 			0)
32030. 	SetVariable(GapAvailable, 			0)
32031. 	SetVariable(GapCurrent, 			0)
32032. 	SetVariable(GapActual, 				0)
32033. 	SetVariable(GapUsed, 				0)
32034. 	
32035. 	# Gap Adjustments
32036. 	SetVariable(GapRoundedLoc, 			0)
32037. 	# SetVariable(GapAdjustedLoc, 		0)
32038. 	SetVariable(GapAvailableLoc, 		0)
32039. 	SetVariable(GapCurrentLoc, 			0)
32040. 	SetVariable(GapActualLoc,			0)
32041. 	SetVariable(GapUsedLoc,				0)
32042. 	
32043. 	# Space usage
32044. 	SetVariable(ZoneFreePerRequested, 	0)
32045. 	SetVariable(ZoneFreePerUsed, 		0)
32046. 
32047. # Gap Size & Rounding
32048. 	SetVariable(ZoneGapSizePer, 		0)
32049. 	SetVariable(ZoneVolRoundUpPer, 		0)
32050. 	
32051. 	# Free Space
32052. 	SetVariable(ZoneFreeUsedPer, 		0)
32053. 	SetVariable(ZoneFreeRequestedPer, 	0)
32054. 
32055. # Script: DisplaySetZone
32056. 
32057. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
32058. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
32059. 
32060. # Message ZoneSummary
32061. # SetVariable(ZoneSummary, '
32062. # Zone Summary:
32063. # ')
32064. # Zone processing steps
32065. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
32066. # ')
32067. 
32068. # # Script: BannerDescriptionSet
32069. 
32070. # Script: BannerSet
32071. 
32072. # NOTE: Can't round or truncate to integer precision. 
32073. # This internal fields like ZoneCount format really badly.
32074. #  for !RunTimeNow! does not work. None of the date functions do.
32075. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
32076. 
32077. SetVariable(HeadingTemp2,	ZoneCount + 0)
32078. 
32079. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32080. 
32081. Title('!Heading!')
32082. 
32083. /* pause(1) */
32084. 
32085. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32086. 
32087. 
32088. # Script: BannerLog
32089. 
32090. AppendLogfile("!LogFileName!", "!Heading!")
32091. 
32092. 
32093. 
32094. # pause(1)
32095. 
32096. 
32097. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
32098. # Script: DisplaySetZoneStep
32099. # Increment
32100. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
32101. 
32102. # Display this zone step
32103. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
32104. ')
32105. 
32106. # Script: BannerSet
32107. 
32108. # NOTE: Can't round or truncate to integer precision. 
32109. # This internal fields like ZoneCount format really badly.
32110. #  for !RunTimeNow! does not work. None of the date functions do.
32111. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
32112. 
32113. SetVariable(HeadingTemp2,	ZoneCount + 0)
32114. 
32115. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32116. 
32117. Title('!Heading!')
32118. 
32119. /* pause(1) */
32120. 
32121. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32122. 
32123. 
32124. # Script: DisplaySetWindowText
32125. # Zone Footer Set Statistics Window Text
32126. 
32127. SetStatisticsWindowText("!Heading!
32128. ----------------------------------------------------------
32129. Zones Processed: 
32130. ----------------------------------------------------------
32131. !ZoneListByLine!
32132. ----------------------------------------------------------
32133. Zone Processing Step:
32134. !ZoneStepByLine!    
32135. ----------------------------------------------------------
32136. ----------------------------------------------------------
32137. CURRENT ZONE:
32138. !ZoneStatisticsReport!
32139. ----------------------------------------------------------
32140. ----------------------------------------------------------
32141. ----------------------------------------------------------
32142. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
32143. ----------------------------------------------------------
32144. !VolumeStatisticsSummary!
32145. !VolumeStatisticsDetail!
32146. ----------------------------------------------------------
32147. ----------------------------------------------------------
32148. Zone Detailed Report:
32149. ----------------------------------------------------------
32150. !ZoneStatisticsDetail!
32151. ----------------------------------------------------------
32152. ")
32153. 
32154. 
32155. 
32156. 
32157. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
32158. 
32159. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
32160. # Script: DisplaySetZoneStep
32161. # Increment
32162. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
32163. 
32164. # Display this zone step
32165. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
32166. ')
32167. 
32168. # Script: BannerSet
32169. 
32170. # NOTE: Can't round or truncate to integer precision. 
32171. # This internal fields like ZoneCount format really badly.
32172. #  for !RunTimeNow! does not work. None of the date functions do.
32173. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
32174. 
32175. SetVariable(HeadingTemp2,	ZoneCount + 0)
32176. 
32177. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32178. 
32179. Title('!Heading!')
32180. 
32181. /* pause(1) */
32182. 
32183. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32184. 
32185. 
32186. # Script: DisplaySetWindowText
32187. # Zone Footer Set Statistics Window Text
32188. 
32189. SetStatisticsWindowText("!Heading!
32190. ----------------------------------------------------------
32191. Zones Processed: 
32192. ----------------------------------------------------------
32193. !ZoneListByLine!
32194. ----------------------------------------------------------
32195. Zone Processing Step:
32196. !ZoneStepByLine!    
32197. ----------------------------------------------------------
32198. ----------------------------------------------------------
32199. CURRENT ZONE:
32200. !ZoneStatisticsReport!
32201. ----------------------------------------------------------
32202. ----------------------------------------------------------
32203. ----------------------------------------------------------
32204. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
32205. ----------------------------------------------------------
32206. !VolumeStatisticsSummary!
32207. !VolumeStatisticsDetail!
32208. ----------------------------------------------------------
32209. ----------------------------------------------------------
32210. Zone Detailed Report:
32211. ----------------------------------------------------------
32212. !ZoneStatisticsDetail!
32213. ----------------------------------------------------------
32214. ")
32215. 
32216. 
32217. 
32218. 
32219. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
32220. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
32221. 
32222. # Script: BannerSet
32223. 
32224. # NOTE: Can't round or truncate to integer precision. 
32225. # This internal fields like ZoneCount format really badly.
32226. #  for !RunTimeNow! does not work. None of the date functions do.
32227. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
32228. 
32229. SetVariable(HeadingTemp2,	ZoneCount + 0)
32230. 
32231. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32232. 
32233. Title('!Heading!')
32234. 
32235. /* pause(1) */
32236. 
32237. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32238. 
32239. 
32240. # Script: BannerLog
32241. 
32242. AppendLogfile("!LogFileName!", "!Heading!")
32243. 
32244. 
32245. 
32246. # LOGGING:
32247. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
32248. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
32249. 
32250. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
32251. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:02")
32252. # 2021-12-14 15:30:02 
32253. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:07 !ZoneLabel! !ZoneDescription!")
32254. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
32255. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:07 !ZoneLabel! !ZoneDescription!")
32256. 
32257. 
32258. # Add zone to list of zones:
32259. SetVariable(ZoneListByLine, "!ZoneListByLine!
32260. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
32261. # Script: DisplaySetWindowText
32262. # Zone Footer Set Statistics Window Text
32263. 
32264. SetStatisticsWindowText("!Heading!
32265. ----------------------------------------------------------
32266. Zones Processed: 
32267. ----------------------------------------------------------
32268. !ZoneListByLine!
32269. ----------------------------------------------------------
32270. Zone Processing Step:
32271. !ZoneStepByLine!    
32272. ----------------------------------------------------------
32273. ----------------------------------------------------------
32274. CURRENT ZONE:
32275. !ZoneStatisticsReport!
32276. ----------------------------------------------------------
32277. ----------------------------------------------------------
32278. ----------------------------------------------------------
32279. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
32280. ----------------------------------------------------------
32281. !VolumeStatisticsSummary!
32282. !VolumeStatisticsDetail!
32283. ----------------------------------------------------------
32284. ----------------------------------------------------------
32285. Zone Detailed Report:
32286. ----------------------------------------------------------
32287. !ZoneStatisticsDetail!
32288. ----------------------------------------------------------
32289. ")
32290. 
32291. 
32292. 
32293. 
32294. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
32295. # Script: DisplaySetZoneStep
32296. # Increment
32297. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
32298. 
32299. # Display this zone step
32300. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
32301. ')
32302. 
32303. # Script: BannerSet
32304. 
32305. # NOTE: Can't round or truncate to integer precision. 
32306. # This internal fields like ZoneCount format really badly.
32307. #  for !RunTimeNow! does not work. None of the date functions do.
32308. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
32309. 
32310. SetVariable(HeadingTemp2,	ZoneCount + 0)
32311. 
32312. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32313. 
32314. Title('!Heading!')
32315. 
32316. /* pause(1) */
32317. 
32318. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32319. 
32320. 
32321. # Script: DisplaySetWindowText
32322. # Zone Footer Set Statistics Window Text
32323. 
32324. SetStatisticsWindowText("!Heading!
32325. ----------------------------------------------------------
32326. Zones Processed: 
32327. ----------------------------------------------------------
32328. !ZoneListByLine!
32329. ----------------------------------------------------------
32330. Zone Processing Step:
32331. !ZoneStepByLine!    
32332. ----------------------------------------------------------
32333. ----------------------------------------------------------
32334. CURRENT ZONE:
32335. !ZoneStatisticsReport!
32336. ----------------------------------------------------------
32337. ----------------------------------------------------------
32338. ----------------------------------------------------------
32339. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
32340. ----------------------------------------------------------
32341. !VolumeStatisticsSummary!
32342. !VolumeStatisticsDetail!
32343. ----------------------------------------------------------
32344. ----------------------------------------------------------
32345. Zone Detailed Report:
32346. ----------------------------------------------------------
32347. !ZoneStatisticsDetail!
32348. ----------------------------------------------------------
32349. ")
32350. 
32351. 
32352. 
32353. 
32354. # your stuff HERE (X)... pre file select code.
32355. 
32356. /* --------------------------------- */
32357. 	FileSelect
32358. 
32359. 		# your stuff can't really go here (errors.)
32360. 		# maybe for some reason I don't know of...
32361. 	
32362. 		# Actions next...
32363. 	# Script: ZoneDo ZoneTypeSelectArchivesBu
32364. # ArchivesBu start.
32365. ( ( 
32366. # ArchivesBu
32367. # Archives start.
32368. (
32369.   DirectoryName("*Archive*")
32370.   or DirectoryName("*History*")
32371.   or DirectoryName("*Old")
32372.   or DirectoryName("* Old *")
32373.   or DirectoryName("Old *")
32374. 
32375.   or FileName("*.7z")
32376.   or FileName("*.cab")
32377.   or FileName("*.iso")
32378.   or FileName("*.msi")
32379.   or FileName("*.old")
32380.   or FileName("*.rar")
32381.   or FileName("*.tar")
32382.   or FileName("*.zip")
32383.   or
32384. # WinSysLow start.
32385. (
32386.   # Bad idea. This pushed lots of programs and data to archive.
32387.   # DirectoryName("$*")
32388.   # or DirectoryName("0*")
32389.   # or DirectoryName("1*")
32390.   # or DirectoryName("2*")
32391.   # or DirectoryName("3*")
32392.   # or DirectoryName("4*")
32393.   # or DirectoryName("5*")
32394.   # or DirectoryName("6*")
32395.   # or DirectoryName("7*")
32396.   # or DirectoryName("8*")
32397.   # or DirectoryName("9*")
32398.   # or 
32399.   DirectoryName("dllcache")
32400.   or DirectoryName("Downloaded Installations")
32401.   or DirectoryName("Ehome")
32402.   or DirectoryName("Fonts")
32403.   or DirectoryName("Help")
32404.   or DirectoryName("I386")
32405.   or DirectoryName("ie?updates")
32406.   or DirectoryName("Installer")
32407.   or DirectoryName("Installshield Installation Information")
32408.   or DirectoryName("IME")
32409.   or DirectoryName("*RECYCLE*")
32410.   or DirectoryName("ServicePackFiles")
32411.   or DirectoryName("SoftwareDistribution")
32412.   or DirectoryName("Speech")
32413.   or DirectoryName("Symbols")
32414.   or DirectoryName("System Volume Information")
32415.   or DirectoryName("windows.old")
32416. )
32417. # WinSysLow end.
32418. 
32419.   # Archives
32420. )
32421. # Archives end.
32422. 
32423. # Bu Backups
32424. or
32425. # Backups start.
32426. (
32427.   DirectoryName("*Backup*")
32428.   or DirectoryName("*Bu")
32429.   or DirectoryName("* Bu *")
32430.   or DirectoryName("Bu *")
32431. 
32432.   or FileName("*.bak")
32433.   or FileName("* - Copy*")
32434. )
32435. # Backups end.
32436. 
32437. )
32438. and not  
32439. FileName("ReferenceMarker.MyDx")
32440. )
32441. # ArchivesBu end.
32442. 
32443. 	# Script: ZoneDoAction
32444. # Zone Do File Action - SortByName.
32445. 
32446. 	FileActions
32447. 
32448. 			# Script: GapZoneCalc
32449. 	# Gap
32450. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
32451. 		# Script: DisplaySetZoneStep
32452. # Increment
32453. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
32454. 
32455. # Display this zone step
32456. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
32457. ')
32458. 
32459. # Script: BannerSet
32460. 
32461. # NOTE: Can't round or truncate to integer precision. 
32462. # This internal fields like ZoneCount format really badly.
32463. #  for !RunTimeNow! does not work. None of the date functions do.
32464. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
32465. 
32466. SetVariable(HeadingTemp2,	ZoneCount + 0)
32467. 
32468. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32469. 
32470. Title('!Heading!')
32471. 
32472. /* pause(1) */
32473. 
32474. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32475. 
32476. 
32477. # Script: DisplaySetWindowText
32478. # Zone Footer Set Statistics Window Text
32479. 
32480. SetStatisticsWindowText("!Heading!
32481. ----------------------------------------------------------
32482. Zones Processed: 
32483. ----------------------------------------------------------
32484. !ZoneListByLine!
32485. ----------------------------------------------------------
32486. Zone Processing Step:
32487. !ZoneStepByLine!    
32488. ----------------------------------------------------------
32489. ----------------------------------------------------------
32490. CURRENT ZONE:
32491. !ZoneStatisticsReport!
32492. ----------------------------------------------------------
32493. ----------------------------------------------------------
32494. ----------------------------------------------------------
32495. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
32496. ----------------------------------------------------------
32497. !VolumeStatisticsSummary!
32498. !VolumeStatisticsDetail!
32499. ----------------------------------------------------------
32500. ----------------------------------------------------------
32501. Zone Detailed Report:
32502. ----------------------------------------------------------
32503. !ZoneStatisticsDetail!
32504. ----------------------------------------------------------
32505. ")
32506. 
32507. 
32508. 
32509. 	
32510. 	# ACTUAL GAP
32511. 		/* AddGap Variant. */
32512. 	  	# Script: GapZoneSet
32513. # Zone Do Gap
32514. # Gap Calculation Methods:
32515. 
32516. /* 1) Anything you need to add first. */
32517. /* empty */
32518. 
32519. /* ------------------------- */
32520. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
32521. 	# GapRequestedStd.
32522. 
32523. 		/* ------------------------- */
32524. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
32525. 
32526. 		# Gap Calculation Methods:
32527. 
32528. /* AddGap Variants */
32529. 
32530. 	/* Standard */
32531. 		# Gap Calculation Methods:
32532. 	/* AddGap Variants */
32533. 	/* Standard */
32534. 
32535. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
32536. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
32537. 
32538. 	SetVariable(GapRequested, GapRequestedStd)
32539. 	
32540. 
32541. 	/* MFT Low High Method */
32542. 		# Gap Calculation Methods:
32543. 	/* AddGap Variants */
32544. 	/* MFT Low High Method */
32545. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
32546. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
32547. 	SetVariable(GapRequested, GapRequestedMft)
32548. 	
32549. 
32550. 	/* OS Volume Type Method */
32551. 		# Gap Calculation Methods:
32552. 	/* AddGap Variants */
32553. 	/* OS Volume Type Method */
32554. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
32555. 	SetVariable(GapRequested, GapRequestedOs)
32556. 
32557. 
32558. 
32559. /* MakeGap Variants */
32560. 
32561. 	/* Original Os 1-3 + MFT 2 */
32562. 		# Gap Calculation Methods:
32563. 	/* MakeGap Variants */
32564. 	/* Original Os 1-3 + MFT 2 */
32565. 	/* plus MFT gap placed inline at the dividing zone. */
32566. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
32567. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
32568. 	SetVariable(GapRequested, GapRequestedOrig)
32569. 	
32570. 	
32571. /* Note: You could comment out the ones not in use */
32572. /* However having the data in the log is useful. */
32573. /* Therefore the following line is otherwise needed. */
32574. 
32575. /* Standard used */
32576. 
32577. SetVariable(GapRequested, GapRequestedStd)
32578. 
32579. # Gap Calculation Methods:
32580. 
32581. /* AddGap Variants */
32582. 	/* Standard */
32583. 	/* MFT Low High Method */
32584. 	/* OS Volume Type Method */
32585. 
32586. /* MakeGap Variants */
32587. 	/* Original Os 1-3 + MFT 2 */
32588. 
32589. /* Note: You could comment out the ones not in use */
32590. /* However having the data in the log is useful. */
32591. /* Therefore the following line is otherwise needed. */
32592. 
32593. /* Standard is used currently */
32594. 
32595. 
32596. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
32597. 
32598. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
32599. 
32600. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
32601. 
32602. /* ------------------------- */
32603. /* 3) SMALL ZONE ADJUSTMENT. */
32604. /* Gab cant be larger than half the Zone Size. */
32605. 
32606. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
32607. 	
32608. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
32609. 
32610. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
32611. 
32612. /* ------------------------- */
32613. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
32614. # Gap Adjustments.
32615. 
32616. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
32617. 	
32618. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
32619. 
32620. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
32621. 
32622. /* ------------------------- */
32623. # BYPASS THIS.
32624. 	/* This is definitely wrong. */
32625. 	/* The question is can we steal gap from the next zone */
32626. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
32627. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
32628. 		# Zone Overflow.
32629. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
32630. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
32631. 
32632. /* ------------------------- */
32633. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
32634. # Remaining free space available.
32635. 
32636. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
32637. 	
32638. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
32639. 
32640. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
32641. 
32642. /* ------------------------- */
32643. # CURRENT gap to use.
32644. 
32645. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
32646. 
32647. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
32648. 
32649. /* ------------------------- */
32650. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
32651. # Debugging.
32652. 
32653. 	SetVariable(GapUsed, GapCurrent) // for debugging
32654. 
32655. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
32656. 
32657. 		# Your code HERE
32658. 
32659. /* ------------------------- */
32660. /* 7) YOUR CODE. */
32661. # YOUR CODE HERE:
32662. 	# INPUT: GapCurrent or GapCurrentLoc
32663. 	# OUTPUT: GapUsed...
32664. 
32665. /* ------------------------- */
32666. # Gap Size.
32667. # Actual Size of Gap.
32668. 
32669. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
32670. 
32671. /* ------------------------- */
32672. 
32673. 	
32674. 	# Zone Statistics	
32675. 		# Script: ZoneStatisticsGet
32676. # Zone / Volume Statistics and Display
32677. 		
32678. 	# Accumulate Totals
32679.   	# Script: ZoneDoVolumeTotals
32680. 
32681. /* Current total space used (by Zones and Gaps) */
32682. 
32683. SetVariable(VolumeZoneUsed, GapUsed)
32684. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
32685. /* Percentage */
32686. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
32687. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
32688. 
32689. /* Current total of free space requested */
32690. 
32691. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
32692. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
32693. /* Percent. */
32694. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
32695. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
32696. 
32697. /* Current total of free space used */
32698. 
32699. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
32700. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
32701. /* Percent */
32702. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
32703. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
32704. 
32705. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
32706. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
32707. # Xinclude "..\DebugDisplayPause.MyDc"X
32708. 
32709. 
32710. 	# Current Values
32711. 	# Script: ZoneDoCurrentSet
32712. 
32713. # Cluster, Sector, Block adjust for display.
32714. 	# Bytes per cluster is volume specific.
32715. 
32716. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
32717. 
32718. # Current Zone values.
32719. 	# Begin, end and size.
32720. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
32721. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
32722. 
32723. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
32724. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
32725. 
32726. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
32727. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
32728. 
32729. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
32730. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
32731. 
32732. 	SetVariable(ZoneFragments,				"!ZONE210N!")
32733. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
32734. 		
32735. # Current Gap, Actual and Free Values
32736. 	# Gap
32737. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
32738. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
32739. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
32740. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
32741. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
32742. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
32743. 	
32744. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
32745. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
32746. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
32747. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
32748. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
32749. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
32750. 	
32751. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
32752. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
32753. 	
32754. 	# Actual Size and End
32755. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
32756. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
32757. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
32758. 	
32759. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
32760. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
32761. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
32762. 
32763. # Gap Size & Rounding
32764. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
32765. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
32766. 	
32767. 	# Free Space
32768. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
32769. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
32770. 
32771. 	# Script: ZoneStatisticsReportGet
32772. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
32773. 
32774. # Footer:
32775. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
32776. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
32777. #
32778. # Xinclude "..\Commands\DateTimeLastLong.txt"X
32779. #
32780. # What a mess this word based vs is. Try a phrase based version ToDo
32781. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
32782. ------------------
32783.    !SizeWord!!ColonWord!  
32784.    ------------------------
32785.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
32786.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
32787.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
32788. 
32789.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
32790.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
32791. 
32792.    !LocationWord!!ColonWord!
32793.    ------------------------
32794.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
32795.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
32796.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
32797.       
32798.    !GapWordCaps! !SettingsWord!!ColonWord!
32799.    ------------------------
32800.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
32801.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
32802.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
32803.                  
32804.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
32805.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
32806.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
32807.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
32808.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
32809.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
32810.      
32811.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
32812.    ------------------------
32813.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
32814.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
32815.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
32816. 
32817. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
32818. ----------------------------------------------------------
32819. ")
32820. #
32821. SetVariable(DateNow, 	DATETIME)
32822. SetVariable(TimeNow, 	Time)
32823. SetVariable(RunTimeNow, 	RunTime)
32824. 
32825. 
32826. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
32827. 
32828. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
32829. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
32830. 
32831. 	# Script: DisplaySetWindowText
32832. # Zone Footer Set Statistics Window Text
32833. 
32834. SetStatisticsWindowText("!Heading!
32835. ----------------------------------------------------------
32836. Zones Processed: 
32837. ----------------------------------------------------------
32838. !ZoneListByLine!
32839. ----------------------------------------------------------
32840. Zone Processing Step:
32841. !ZoneStepByLine!    
32842. ----------------------------------------------------------
32843. ----------------------------------------------------------
32844. CURRENT ZONE:
32845. !ZoneStatisticsReport!
32846. ----------------------------------------------------------
32847. ----------------------------------------------------------
32848. ----------------------------------------------------------
32849. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
32850. ----------------------------------------------------------
32851. !VolumeStatisticsSummary!
32852. !VolumeStatisticsDetail!
32853. ----------------------------------------------------------
32854. ----------------------------------------------------------
32855. Zone Detailed Report:
32856. ----------------------------------------------------------
32857. !ZoneStatisticsDetail!
32858. ----------------------------------------------------------
32859. ")
32860. 
32861. 
32862. 	
32863. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
32864. 
32865. 
32866. 	SetVariable(ZoneStatisticsData, 
32867. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
32868.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
32869.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
32870. 
32871. 
32872. 
32873.  		# Script: ZoneStatisticsDisplay
32874. 	
32875. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
32876. !ZoneStatisticsData!
32877. ')
32878. 
32879. 		# Script: ZoneStatisticsAdd
32880. # Append Zone to Details of each zone.
32881. 		
32882. 	# Add Zone Details to Report.	
32883. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
32884. !ZoneStatisticsReport!
32885. ')
32886. 
32887. 	
32888. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
32889. 		# Script: DisplaySetZoneStep
32890. # Increment
32891. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
32892. 
32893. # Display this zone step
32894. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
32895. ')
32896. 
32897. # Script: BannerSet
32898. 
32899. # NOTE: Can't round or truncate to integer precision. 
32900. # This internal fields like ZoneCount format really badly.
32901. #  for !RunTimeNow! does not work. None of the date functions do.
32902. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
32903. 
32904. SetVariable(HeadingTemp2,	ZoneCount + 0)
32905. 
32906. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32907. 
32908. Title('!Heading!')
32909. 
32910. /* pause(1) */
32911. 
32912. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32913. 
32914. 
32915. # Script: DisplaySetWindowText
32916. # Zone Footer Set Statistics Window Text
32917. 
32918. SetStatisticsWindowText("!Heading!
32919. ----------------------------------------------------------
32920. Zones Processed: 
32921. ----------------------------------------------------------
32922. !ZoneListByLine!
32923. ----------------------------------------------------------
32924. Zone Processing Step:
32925. !ZoneStepByLine!    
32926. ----------------------------------------------------------
32927. ----------------------------------------------------------
32928. CURRENT ZONE:
32929. !ZoneStatisticsReport!
32930. ----------------------------------------------------------
32931. ----------------------------------------------------------
32932. ----------------------------------------------------------
32933. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
32934. ----------------------------------------------------------
32935. !VolumeStatisticsSummary!
32936. !VolumeStatisticsDetail!
32937. ----------------------------------------------------------
32938. ----------------------------------------------------------
32939. Zone Detailed Report:
32940. ----------------------------------------------------------
32941. !ZoneStatisticsDetail!
32942. ----------------------------------------------------------
32943. ")
32944. 
32945. 
32946. 
32947. 
32948. 		# File Action - All - Full -  SortByCreationDate
32949. # File Action - ZoneDoActionSortByCreationDateFull
32950. 	SortByCreationDate(Ascending)
32951. 	
32952. 
32953. 
32954. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
32955. 		# Script: DisplaySetZoneStep
32956. # Increment
32957. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
32958. 
32959. # Display this zone step
32960. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
32961. ')
32962. 
32963. # Script: BannerSet
32964. 
32965. # NOTE: Can't round or truncate to integer precision. 
32966. # This internal fields like ZoneCount format really badly.
32967. #  for !RunTimeNow! does not work. None of the date functions do.
32968. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
32969. 
32970. SetVariable(HeadingTemp2,	ZoneCount + 0)
32971. 
32972. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32973. 
32974. Title('!Heading!')
32975. 
32976. /* pause(1) */
32977. 
32978. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
32979. 
32980. 
32981. # Script: DisplaySetWindowText
32982. # Zone Footer Set Statistics Window Text
32983. 
32984. SetStatisticsWindowText("!Heading!
32985. ----------------------------------------------------------
32986. Zones Processed: 
32987. ----------------------------------------------------------
32988. !ZoneListByLine!
32989. ----------------------------------------------------------
32990. Zone Processing Step:
32991. !ZoneStepByLine!    
32992. ----------------------------------------------------------
32993. ----------------------------------------------------------
32994. CURRENT ZONE:
32995. !ZoneStatisticsReport!
32996. ----------------------------------------------------------
32997. ----------------------------------------------------------
32998. ----------------------------------------------------------
32999. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
33000. ----------------------------------------------------------
33001. !VolumeStatisticsSummary!
33002. !VolumeStatisticsDetail!
33003. ----------------------------------------------------------
33004. ----------------------------------------------------------
33005. Zone Detailed Report:
33006. ----------------------------------------------------------
33007. !ZoneStatisticsDetail!
33008. ----------------------------------------------------------
33009. ")
33010. 
33011. 
33012. 
33013. 
33014. 	# Script: ZoneDoFooter
33015. 
33016. /* --------------------------------- */
33017. 	# File Select
33018. 		# Select Statments
33019. 	# File Actions 
33020. 		# Standard or OS File Actions.
33021. 		# Resume...
33022. 	
33023. 		# your stuff HERE (X)... post zone (file) file actions code.
33024. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
33025. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
33026. 			# (X)
33027. 		
33028. 			/* ??? Set window? */
33029. 	
33030. 		# ADD THE GAP
33031. 		# Script: GapZoneCommand
33032. # Vacate (good for diagnostics)
33033. # DoNotVacate - DO NOT Vacate (recommended)
33034. 
33035. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
33036. # Script: DisplaySetZoneStep
33037. # Increment
33038. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
33039. 
33040. # Display this zone step
33041. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
33042. ')
33043. 
33044. # Script: BannerSet
33045. 
33046. # NOTE: Can't round or truncate to integer precision. 
33047. # This internal fields like ZoneCount format really badly.
33048. #  for !RunTimeNow! does not work. None of the date functions do.
33049. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
33050. 
33051. SetVariable(HeadingTemp2,	ZoneCount + 0)
33052. 
33053. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33054. 
33055. Title('!Heading!')
33056. 
33057. /* pause(1) */
33058. 
33059. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33060. 
33061. 
33062. # Script: DisplaySetWindowText
33063. # Zone Footer Set Statistics Window Text
33064. 
33065. SetStatisticsWindowText("!Heading!
33066. ----------------------------------------------------------
33067. Zones Processed: 
33068. ----------------------------------------------------------
33069. !ZoneListByLine!
33070. ----------------------------------------------------------
33071. Zone Processing Step:
33072. !ZoneStepByLine!    
33073. ----------------------------------------------------------
33074. ----------------------------------------------------------
33075. CURRENT ZONE:
33076. !ZoneStatisticsReport!
33077. ----------------------------------------------------------
33078. ----------------------------------------------------------
33079. ----------------------------------------------------------
33080. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
33081. ----------------------------------------------------------
33082. !VolumeStatisticsSummary!
33083. !VolumeStatisticsDetail!
33084. ----------------------------------------------------------
33085. ----------------------------------------------------------
33086. Zone Detailed Report:
33087. ----------------------------------------------------------
33088. !ZoneStatisticsDetail!
33089. ----------------------------------------------------------
33090. ")
33091. 
33092. 
33093. 
33094. 
33095. # *** Moved to setting yours *** 
33096. # (to avoid doing it twice)
33097. # (ie the later wouldn't "overwrite" the former in the usual manner)
33098. 
33099. # Do one or the other:
33100. # DoNotVacate - DO NOT Vacate (recommended)
33101. 
33102. # Vacate
33103. /* AddGap(GapUsedLoc) */
33104. 
33105. # DO Not Vacate
33106. AddGap(GapUsedLoc, DoNotVacate) 
33107. 	
33108. 	
33109. 
33110. # Controlled via settings commands
33111. 
33112. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
33113. 
33114. # Vacate /* AddGap(GapUsed) */
33115. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
33116. 	
33117. 
33118. 		
33119. 	# 
33120. 	FileEnd
33121. /* --------------------------------- */
33122. # your stuff HERE (X)... post zone (file) code.
33123. 
33124. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
33125. # Script: DisplaySetZoneStep
33126. # Increment
33127. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
33128. 
33129. # Display this zone step
33130. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
33131. ')
33132. 
33133. # Script: BannerSet
33134. 
33135. # NOTE: Can't round or truncate to integer precision. 
33136. # This internal fields like ZoneCount format really badly.
33137. #  for !RunTimeNow! does not work. None of the date functions do.
33138. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
33139. 
33140. SetVariable(HeadingTemp2,	ZoneCount + 0)
33141. 
33142. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33143. 
33144. Title('!Heading!')
33145. 
33146. /* pause(1) */
33147. 
33148. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33149. 
33150. 
33151. # Script: DisplaySetWindowText
33152. # Zone Footer Set Statistics Window Text
33153. 
33154. SetStatisticsWindowText("!Heading!
33155. ----------------------------------------------------------
33156. Zones Processed: 
33157. ----------------------------------------------------------
33158. !ZoneListByLine!
33159. ----------------------------------------------------------
33160. Zone Processing Step:
33161. !ZoneStepByLine!    
33162. ----------------------------------------------------------
33163. ----------------------------------------------------------
33164. CURRENT ZONE:
33165. !ZoneStatisticsReport!
33166. ----------------------------------------------------------
33167. ----------------------------------------------------------
33168. ----------------------------------------------------------
33169. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
33170. ----------------------------------------------------------
33171. !VolumeStatisticsSummary!
33172. !VolumeStatisticsDetail!
33173. ----------------------------------------------------------
33174. ----------------------------------------------------------
33175. Zone Detailed Report:
33176. ----------------------------------------------------------
33177. !ZoneStatisticsDetail!
33178. ----------------------------------------------------------
33179. ")
33180. 
33181. 
33182. 
33183. 
33184. # Script: ZoneWhenFinished
33185. 
33186. # Add the zone to the zone details log:
33187. # This is temporarily disable until logging is fixed
33188. # It is performed during file action to preserve the correct (original) calculations.
33189. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
33190. 
33191. # Add the Select and ZoneSteps to the Zone
33192. # Script: ZoneStatisticsAdd
33193. # Append Zone to Details of each zone.
33194. 		
33195. 	# Add Zone Details to Report.	
33196. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
33197. ----------------------------------------------------------
33198. !ZoneStepByLine!
33199. ---------------------------
33200. !ZoneTypeSelectCurrent!               
33201. ---------------------------
33202. ----------------------------------------------------------
33203. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
33204. ----------------------------------------------------------
33205. ')
33206. 
33207. 
33208. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
33209. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
33210. # 2021-12-14 15:30:02
33211. RunProgram("..\Commands\WriteDateTime.bat LastZone")
33212. # Append Datetime to logs
33213. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
33214. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
33215. 
33216. AppendLogfile("!LogFileName!", "!PeriodWord!")
33217. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
33218. AppendLogfile("!LogFileName!", "!PeriodWord!")
33219. 
33220. # Script: DisplaySetWindowText
33221. # Zone Footer Set Statistics Window Text
33222. 
33223. SetStatisticsWindowText("!Heading!
33224. ----------------------------------------------------------
33225. Zones Processed: 
33226. ----------------------------------------------------------
33227. !ZoneListByLine!
33228. ----------------------------------------------------------
33229. Zone Processing Step:
33230. !ZoneStepByLine!    
33231. ----------------------------------------------------------
33232. ----------------------------------------------------------
33233. CURRENT ZONE:
33234. !ZoneStatisticsReport!
33235. ----------------------------------------------------------
33236. ----------------------------------------------------------
33237. ----------------------------------------------------------
33238. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
33239. ----------------------------------------------------------
33240. !VolumeStatisticsSummary!
33241. !VolumeStatisticsDetail!
33242. ----------------------------------------------------------
33243. ----------------------------------------------------------
33244. Zone Detailed Report:
33245. ----------------------------------------------------------
33246. !ZoneStatisticsDetail!
33247. ----------------------------------------------------------
33248. ")
33249. 
33250. 
33251. 
33252. /* pause() */
33253. /* pause() */
33254. 
33255. 
33256. 
33257. /* ------------------------- */
33258. 
33259. 
33260. /* ------------------------- */
33261. 
33262. /* ------------------------- */
33263. /* ------------------------- */
33264. /* 13 (99) Zone 21 Unallocated (All) Directories and Files */
33265. # Script: DisplayColors - Zone Dark
33266. # Processed
33267. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
33268. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
33269. 
33270. # Light Green and Yellow
33271. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
33272. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
33273. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
33274. 
33275. # Script: DefragZoneTypeArchivesBu
33276. /* ------------------------- */
33277. /* Zone ArchivesBu (All) Archives and Backups*/
33278. 
33279. SetVariable(ZoneLabel, "!ZoneLabelArchivesBu!")
33280. SetVariable(ZoneDescription, "!ZoneDescriptionArchivesBu!")
33281. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpArchivesBu!")
33282. SetVariable(ZoneGapSize, "!ZoneGapSizeArchivesBu!")
33283. 
33284. SetVariable(ZoneTypeSelect,'
33285. Archives and Backups:
33286. # Script: ZoneDo ZoneTypeSelectArchivesBu
33287. # ArchivesBu start.
33288. ( ( 
33289. # ArchivesBu
33290. # Archives start.
33291. (
33292.   DirectoryName("*Archive*")
33293.   or DirectoryName("*History*")
33294.   or DirectoryName("*Old")
33295.   or DirectoryName("* Old *")
33296.   or DirectoryName("Old *")
33297. 
33298.   or FileName("*.7z")
33299.   or FileName("*.cab")
33300.   or FileName("*.iso")
33301.   or FileName("*.msi")
33302.   or FileName("*.old")
33303.   or FileName("*.rar")
33304.   or FileName("*.tar")
33305.   or FileName("*.zip")
33306.   or
33307. # WinSysLow start.
33308. (
33309.   # Bad idea. This pushed lots of programs and data to archive.
33310.   # DirectoryName("$*")
33311.   # or DirectoryName("0*")
33312.   # or DirectoryName("1*")
33313.   # or DirectoryName("2*")
33314.   # or DirectoryName("3*")
33315.   # or DirectoryName("4*")
33316.   # or DirectoryName("5*")
33317.   # or DirectoryName("6*")
33318.   # or DirectoryName("7*")
33319.   # or DirectoryName("8*")
33320.   # or DirectoryName("9*")
33321.   # or 
33322.   DirectoryName("dllcache")
33323.   or DirectoryName("Downloaded Installations")
33324.   or DirectoryName("Ehome")
33325.   or DirectoryName("Fonts")
33326.   or DirectoryName("Help")
33327.   or DirectoryName("I386")
33328.   or DirectoryName("ie?updates")
33329.   or DirectoryName("Installer")
33330.   or DirectoryName("Installshield Installation Information")
33331.   or DirectoryName("IME")
33332.   or DirectoryName("*RECYCLE*")
33333.   or DirectoryName("ServicePackFiles")
33334.   or DirectoryName("SoftwareDistribution")
33335.   or DirectoryName("Speech")
33336.   or DirectoryName("Symbols")
33337.   or DirectoryName("System Volume Information")
33338.   or DirectoryName("windows.old")
33339. )
33340. # WinSysLow end.
33341. 
33342.   # Archives
33343. )
33344. # Archives end.
33345. 
33346. # Bu Backups
33347. or
33348. # Backups start.
33349. (
33350.   DirectoryName("*Backup*")
33351.   or DirectoryName("*Bu")
33352.   or DirectoryName("* Bu *")
33353.   or DirectoryName("Bu *")
33354. 
33355.   or FileName("*.bak")
33356.   or FileName("* - Copy*")
33357. )
33358. # Backups end.
33359. 
33360. )
33361. and not  
33362. FileName("ReferenceMarker.MyDx")
33363. )
33364. # ArchivesBu end.
33365. 
33366. ')
33367. 
33368. /* Note: This should be all Blob archives and backups */
33369. /* The sorting the "z Archive", "z Bu" and "z Backup" directories */
33370. /* sort to the very end of the Volume. */
33371. 
33372. 	SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
33373. SetVariable(ZoneNoDisplay, ZoneNoCurrent + ZoneNoCurrentAdjust)
33374. 
33375. SetVariable(ZoneStepNoCurrent, 0)
33376. 
33377. 	/* ------------------------- */
33378. # Script: ZoneDoHeader
33379. 
33380. # Script: ZoneWhenStarted
33381. RunProgram("..\Commands\WriteDateTime.bat")
33382. 
33383. # Script: ZoneDoCurrentClear
33384. 
33385. SetVariable(ZoneTypeSelectCurrent, 		"")
33386. SetVariable(ZoneStatisticsData, 		"")
33387. SetVariable(ZoneStepByLine, 			"")
33388. 
33389. SetVariable(ZoneBeginCurrent, 			0)
33390. SetVariable(ZoneBeginPerCurrent, 		0)
33391. SetVariable(ZoneEndCurrent, 			0)
33392. SetVariable(ZoneEndPerCurrent, 			0)
33393. 
33394. SetVariable(ZoneSizeCurrent,			0)
33395. SetVariable(ZoneSizePerCurrent,			0)
33396. 
33397. SetVariable(ZoneGapRequestedCurrent,	0)
33398. SetVariable(ZoneGapRoundedCurrent, 		0)
33399. SetVariable(ZoneGapAdjustedCurrent, 	0)
33400. SetVariable(ZoneGapAvailableCurrent, 	0)
33401. SetVariable(ZoneGapCurrent,				0)
33402. SetVariable(ZoneGapUsedCurrent, 		0)
33403. 
33404. SetVariable(ZoneGapActualCurrent, 		0)
33405. SetVariable(ZoneGapActualPerCurrent, 	0)
33406. 
33407. SetVariable(ZoneSizeActual, 			0)
33408. SetVariable(ZoneSizeActualCurrent,		0)
33409. 
33410. SetVariable(ZoneEndActual, 				0)
33411. SetVariable(ZoneEndActualCurrent,		0)			
33412. SetVariable(ZoneSizeActualPerCurrent, 	0)
33413.       
33414. SetVariable(ZoneFilesFolders,			0)
33415. SetVariable(ZoneFilesFoldersPer,		0) 
33416. 
33417. SetVariable(ZoneFragments,				0)
33418. SetVariable(ZoneFragmentsPer,			0) 
33419. 		
33420. SetVariable(ZoneEndActualCurrent, 		0)
33421. SetVariable(ZoneEndActualPerCurrent, 	0)
33422. 
33423. # Gap Calculation Methodology:
33424. 	# Requested
33425. 	SetVariable(GapRequested, 			0) 
33426. 	SetVariable(GapRequestedStd, 		0) 
33427. 	SetVariable(GapRequestedMft, 		0) 
33428. 	SetVariable(GapRequestedOs, 		0) 
33429. 	SetVariable(GapRequestedOriginal, 	0) 
33430. 	
33431. 	# Gap Adjustments
33432. 	SetVariable(GapRounded, 			0)
33433. 	# SetVariable(GapAdjusted, 			0)
33434. 	SetVariable(GapAvailable, 			0)
33435. 	SetVariable(GapCurrent, 			0)
33436. 	SetVariable(GapActual, 				0)
33437. 	SetVariable(GapUsed, 				0)
33438. 	
33439. 	# Gap Adjustments
33440. 	SetVariable(GapRoundedLoc, 			0)
33441. 	# SetVariable(GapAdjustedLoc, 		0)
33442. 	SetVariable(GapAvailableLoc, 		0)
33443. 	SetVariable(GapCurrentLoc, 			0)
33444. 	SetVariable(GapActualLoc,			0)
33445. 	SetVariable(GapUsedLoc,				0)
33446. 	
33447. 	# Space usage
33448. 	SetVariable(ZoneFreePerRequested, 	0)
33449. 	SetVariable(ZoneFreePerUsed, 		0)
33450. 
33451. # Gap Size & Rounding
33452. 	SetVariable(ZoneGapSizePer, 		0)
33453. 	SetVariable(ZoneVolRoundUpPer, 		0)
33454. 	
33455. 	# Free Space
33456. 	SetVariable(ZoneFreeUsedPer, 		0)
33457. 	SetVariable(ZoneFreeRequestedPer, 	0)
33458. 
33459. # Script: DisplaySetZone
33460. 
33461. SetVariable(ZoneId,					"!ZoneLabel! !DashWord! !ZoneDescription!")
33462. SetVariable(ZoneStepDescription,	"!ZoneLabel! !DashWord! !ZoneDescription!")
33463. 
33464. # Message ZoneSummary
33465. # SetVariable(ZoneSummary, '
33466. # Zone Summary:
33467. # ')
33468. # Zone processing steps
33469. # SetVariable(ZoneStepByLine, 'Zone !ZoneLabel! !StartedWord!!PeiordWord!
33470. # ')
33471. 
33472. # # Script: BannerDescriptionSet
33473. 
33474. # Script: BannerSet
33475. 
33476. # NOTE: Can't round or truncate to integer precision. 
33477. # This internal fields like ZoneCount format really badly.
33478. #  for !RunTimeNow! does not work. None of the date functions do.
33479. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
33480. 
33481. SetVariable(HeadingTemp2,	ZoneCount + 0)
33482. 
33483. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33484. 
33485. Title('!Heading!')
33486. 
33487. /* pause(1) */
33488. 
33489. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33490. 
33491. 
33492. # Script: BannerLog
33493. 
33494. AppendLogfile("!LogFileName!", "!Heading!")
33495. 
33496. 
33497. 
33498. # pause(1)
33499. 
33500. 
33501. SetVariable(ZoneStepDescription,		"!ZoneStepDescriptionZoneStart!")
33502. # Script: DisplaySetZoneStep
33503. # Increment
33504. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
33505. 
33506. # Display this zone step
33507. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
33508. ')
33509. 
33510. # Script: BannerSet
33511. 
33512. # NOTE: Can't round or truncate to integer precision. 
33513. # This internal fields like ZoneCount format really badly.
33514. #  for !RunTimeNow! does not work. None of the date functions do.
33515. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
33516. 
33517. SetVariable(HeadingTemp2,	ZoneCount + 0)
33518. 
33519. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33520. 
33521. Title('!Heading!')
33522. 
33523. /* pause(1) */
33524. 
33525. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33526. 
33527. 
33528. # Script: DisplaySetWindowText
33529. # Zone Footer Set Statistics Window Text
33530. 
33531. SetStatisticsWindowText("!Heading!
33532. ----------------------------------------------------------
33533. Zones Processed: 
33534. ----------------------------------------------------------
33535. !ZoneListByLine!
33536. ----------------------------------------------------------
33537. Zone Processing Step:
33538. !ZoneStepByLine!    
33539. ----------------------------------------------------------
33540. ----------------------------------------------------------
33541. CURRENT ZONE:
33542. !ZoneStatisticsReport!
33543. ----------------------------------------------------------
33544. ----------------------------------------------------------
33545. ----------------------------------------------------------
33546. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
33547. ----------------------------------------------------------
33548. !VolumeStatisticsSummary!
33549. !VolumeStatisticsDetail!
33550. ----------------------------------------------------------
33551. ----------------------------------------------------------
33552. Zone Detailed Report:
33553. ----------------------------------------------------------
33554. !ZoneStatisticsDetail!
33555. ----------------------------------------------------------
33556. ")
33557. 
33558. 
33559. 
33560. 
33561. SetVariable(ZoneTypeSelectCurrent,		"!ZoneTypeSelect!")
33562. 
33563. SetVariable(ZoneStepDescription, "ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
33564. # Script: DisplaySetZoneStep
33565. # Increment
33566. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
33567. 
33568. # Display this zone step
33569. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
33570. ')
33571. 
33572. # Script: BannerSet
33573. 
33574. # NOTE: Can't round or truncate to integer precision. 
33575. # This internal fields like ZoneCount format really badly.
33576. #  for !RunTimeNow! does not work. None of the date functions do.
33577. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
33578. 
33579. SetVariable(HeadingTemp2,	ZoneCount + 0)
33580. 
33581. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33582. 
33583. Title('!Heading!')
33584. 
33585. /* pause(1) */
33586. 
33587. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33588. 
33589. 
33590. # Script: DisplaySetWindowText
33591. # Zone Footer Set Statistics Window Text
33592. 
33593. SetStatisticsWindowText("!Heading!
33594. ----------------------------------------------------------
33595. Zones Processed: 
33596. ----------------------------------------------------------
33597. !ZoneListByLine!
33598. ----------------------------------------------------------
33599. Zone Processing Step:
33600. !ZoneStepByLine!    
33601. ----------------------------------------------------------
33602. ----------------------------------------------------------
33603. CURRENT ZONE:
33604. !ZoneStatisticsReport!
33605. ----------------------------------------------------------
33606. ----------------------------------------------------------
33607. ----------------------------------------------------------
33608. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
33609. ----------------------------------------------------------
33610. !VolumeStatisticsSummary!
33611. !VolumeStatisticsDetail!
33612. ----------------------------------------------------------
33613. ----------------------------------------------------------
33614. Zone Detailed Report:
33615. ----------------------------------------------------------
33616. !ZoneStatisticsDetail!
33617. ----------------------------------------------------------
33618. ")
33619. 
33620. 
33621. 
33622. 
33623. # Xinclude "..\Zone\ZoneStatisticsReportGet.MyDc"X
33624. SetVariable(ZoneStatisticsReport,		"!ZoneStepDescription!") // ZoneStart
33625. 
33626. # Script: BannerSet
33627. 
33628. # NOTE: Can't round or truncate to integer precision. 
33629. # This internal fields like ZoneCount format really badly.
33630. #  for !RunTimeNow! does not work. None of the date functions do.
33631. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
33632. 
33633. SetVariable(HeadingTemp2,	ZoneCount + 0)
33634. 
33635. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33636. 
33637. Title('!Heading!')
33638. 
33639. /* pause(1) */
33640. 
33641. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33642. 
33643. 
33644. # Script: BannerLog
33645. 
33646. AppendLogfile("!LogFileName!", "!Heading!")
33647. 
33648. 
33649. 
33650. # LOGGING:
33651. AppendLogfile("!LogFileName!",			"Zone !ZoneNumber! (!ZoneNoCurrent! + !ZoneNoCurrentAdjust!) of !ZoneCount!.")
33652. AppendLogfile("!LogFileName!",			"Zone !ZoneCurrentDescription!:")
33653. 
33654. # RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
33655. # AppendLogfile("!LogFileName!", "***DATE TEST*** Time: 2021-12-14 15:30:02")
33656. # 2021-12-14 15:30:02 
33657. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:07 !ZoneLabel! !ZoneDescription!")
33658. # Xinclude "..\Display\DisplaySetDateTimeCurrent.MyDc"X
33659. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:07 !ZoneLabel! !ZoneDescription!")
33660. 
33661. 
33662. # Add zone to list of zones:
33663. SetVariable(ZoneListByLine, "!ZoneListByLine!
33664. Zone: !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !DateNow! !TimeNow! !RunTimeNow! !ZoneLabel! !ZoneDescription!")
33665. # Script: DisplaySetWindowText
33666. # Zone Footer Set Statistics Window Text
33667. 
33668. SetStatisticsWindowText("!Heading!
33669. ----------------------------------------------------------
33670. Zones Processed: 
33671. ----------------------------------------------------------
33672. !ZoneListByLine!
33673. ----------------------------------------------------------
33674. Zone Processing Step:
33675. !ZoneStepByLine!    
33676. ----------------------------------------------------------
33677. ----------------------------------------------------------
33678. CURRENT ZONE:
33679. !ZoneStatisticsReport!
33680. ----------------------------------------------------------
33681. ----------------------------------------------------------
33682. ----------------------------------------------------------
33683. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
33684. ----------------------------------------------------------
33685. !VolumeStatisticsSummary!
33686. !VolumeStatisticsDetail!
33687. ----------------------------------------------------------
33688. ----------------------------------------------------------
33689. Zone Detailed Report:
33690. ----------------------------------------------------------
33691. !ZoneStatisticsDetail!
33692. ----------------------------------------------------------
33693. ")
33694. 
33695. 
33696. 
33697. 
33698. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileSelect!")
33699. # Script: DisplaySetZoneStep
33700. # Increment
33701. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
33702. 
33703. # Display this zone step
33704. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
33705. ')
33706. 
33707. # Script: BannerSet
33708. 
33709. # NOTE: Can't round or truncate to integer precision. 
33710. # This internal fields like ZoneCount format really badly.
33711. #  for !RunTimeNow! does not work. None of the date functions do.
33712. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
33713. 
33714. SetVariable(HeadingTemp2,	ZoneCount + 0)
33715. 
33716. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33717. 
33718. Title('!Heading!')
33719. 
33720. /* pause(1) */
33721. 
33722. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33723. 
33724. 
33725. # Script: DisplaySetWindowText
33726. # Zone Footer Set Statistics Window Text
33727. 
33728. SetStatisticsWindowText("!Heading!
33729. ----------------------------------------------------------
33730. Zones Processed: 
33731. ----------------------------------------------------------
33732. !ZoneListByLine!
33733. ----------------------------------------------------------
33734. Zone Processing Step:
33735. !ZoneStepByLine!    
33736. ----------------------------------------------------------
33737. ----------------------------------------------------------
33738. CURRENT ZONE:
33739. !ZoneStatisticsReport!
33740. ----------------------------------------------------------
33741. ----------------------------------------------------------
33742. ----------------------------------------------------------
33743. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
33744. ----------------------------------------------------------
33745. !VolumeStatisticsSummary!
33746. !VolumeStatisticsDetail!
33747. ----------------------------------------------------------
33748. ----------------------------------------------------------
33749. Zone Detailed Report:
33750. ----------------------------------------------------------
33751. !ZoneStatisticsDetail!
33752. ----------------------------------------------------------
33753. ")
33754. 
33755. 
33756. 
33757. 
33758. # your stuff HERE (X)... pre file select code.
33759. 
33760. /* --------------------------------- */
33761. 	FileSelect
33762. 
33763. 		# your stuff can't really go here (errors.)
33764. 		# maybe for some reason I don't know of...
33765. 	
33766. 		# Actions next...
33767. 	# Script: ZoneDo ZoneTypeSelectArchivesBu
33768. # ArchivesBu start.
33769. ( ( 
33770. # ArchivesBu
33771. # Archives start.
33772. (
33773.   DirectoryName("*Archive*")
33774.   or DirectoryName("*History*")
33775.   or DirectoryName("*Old")
33776.   or DirectoryName("* Old *")
33777.   or DirectoryName("Old *")
33778. 
33779.   or FileName("*.7z")
33780.   or FileName("*.cab")
33781.   or FileName("*.iso")
33782.   or FileName("*.msi")
33783.   or FileName("*.old")
33784.   or FileName("*.rar")
33785.   or FileName("*.tar")
33786.   or FileName("*.zip")
33787.   or
33788. # WinSysLow start.
33789. (
33790.   # Bad idea. This pushed lots of programs and data to archive.
33791.   # DirectoryName("$*")
33792.   # or DirectoryName("0*")
33793.   # or DirectoryName("1*")
33794.   # or DirectoryName("2*")
33795.   # or DirectoryName("3*")
33796.   # or DirectoryName("4*")
33797.   # or DirectoryName("5*")
33798.   # or DirectoryName("6*")
33799.   # or DirectoryName("7*")
33800.   # or DirectoryName("8*")
33801.   # or DirectoryName("9*")
33802.   # or 
33803.   DirectoryName("dllcache")
33804.   or DirectoryName("Downloaded Installations")
33805.   or DirectoryName("Ehome")
33806.   or DirectoryName("Fonts")
33807.   or DirectoryName("Help")
33808.   or DirectoryName("I386")
33809.   or DirectoryName("ie?updates")
33810.   or DirectoryName("Installer")
33811.   or DirectoryName("Installshield Installation Information")
33812.   or DirectoryName("IME")
33813.   or DirectoryName("*RECYCLE*")
33814.   or DirectoryName("ServicePackFiles")
33815.   or DirectoryName("SoftwareDistribution")
33816.   or DirectoryName("Speech")
33817.   or DirectoryName("Symbols")
33818.   or DirectoryName("System Volume Information")
33819.   or DirectoryName("windows.old")
33820. )
33821. # WinSysLow end.
33822. 
33823.   # Archives
33824. )
33825. # Archives end.
33826. 
33827. # Bu Backups
33828. or
33829. # Backups start.
33830. (
33831.   DirectoryName("*Backup*")
33832.   or DirectoryName("*Bu")
33833.   or DirectoryName("* Bu *")
33834.   or DirectoryName("Bu *")
33835. 
33836.   or FileName("*.bak")
33837.   or FileName("* - Copy*")
33838. )
33839. # Backups end.
33840. 
33841. )
33842. and not  
33843. FileName("ReferenceMarker.MyDx")
33844. )
33845. # ArchivesBu end.
33846. 
33847. 	# Script: ZoneDoAction
33848. # Zone Do File Action - SortByName.
33849. 
33850. 	FileActions
33851. 
33852. 			# Script: GapZoneCalc
33853. 	# Gap
33854. 		SetVariable(ZoneStepDescription,"!ZoneStepDescriptionFileActionGap!")
33855. 		# Script: DisplaySetZoneStep
33856. # Increment
33857. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
33858. 
33859. # Display this zone step
33860. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
33861. ')
33862. 
33863. # Script: BannerSet
33864. 
33865. # NOTE: Can't round or truncate to integer precision. 
33866. # This internal fields like ZoneCount format really badly.
33867. #  for !RunTimeNow! does not work. None of the date functions do.
33868. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
33869. 
33870. SetVariable(HeadingTemp2,	ZoneCount + 0)
33871. 
33872. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33873. 
33874. Title('!Heading!')
33875. 
33876. /* pause(1) */
33877. 
33878. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
33879. 
33880. 
33881. # Script: DisplaySetWindowText
33882. # Zone Footer Set Statistics Window Text
33883. 
33884. SetStatisticsWindowText("!Heading!
33885. ----------------------------------------------------------
33886. Zones Processed: 
33887. ----------------------------------------------------------
33888. !ZoneListByLine!
33889. ----------------------------------------------------------
33890. Zone Processing Step:
33891. !ZoneStepByLine!    
33892. ----------------------------------------------------------
33893. ----------------------------------------------------------
33894. CURRENT ZONE:
33895. !ZoneStatisticsReport!
33896. ----------------------------------------------------------
33897. ----------------------------------------------------------
33898. ----------------------------------------------------------
33899. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
33900. ----------------------------------------------------------
33901. !VolumeStatisticsSummary!
33902. !VolumeStatisticsDetail!
33903. ----------------------------------------------------------
33904. ----------------------------------------------------------
33905. Zone Detailed Report:
33906. ----------------------------------------------------------
33907. !ZoneStatisticsDetail!
33908. ----------------------------------------------------------
33909. ")
33910. 
33911. 
33912. 
33913. 	
33914. 	# ACTUAL GAP
33915. 		/* AddGap Variant. */
33916. 	  	# Script: GapZoneSet
33917. # Zone Do Gap
33918. # Gap Calculation Methods:
33919. 
33920. /* 1) Anything you need to add first. */
33921. /* empty */
33922. 
33923. /* ------------------------- */
33924. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
33925. 	# GapRequestedStd.
33926. 
33927. 		/* ------------------------- */
33928. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
33929. 
33930. 		# Gap Calculation Methods:
33931. 
33932. /* AddGap Variants */
33933. 
33934. 	/* Standard */
33935. 		# Gap Calculation Methods:
33936. 	/* AddGap Variants */
33937. 	/* Standard */
33938. 
33939. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
33940. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
33941. 
33942. 	SetVariable(GapRequested, GapRequestedStd)
33943. 	
33944. 
33945. 	/* MFT Low High Method */
33946. 		# Gap Calculation Methods:
33947. 	/* AddGap Variants */
33948. 	/* MFT Low High Method */
33949. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
33950. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
33951. 	SetVariable(GapRequested, GapRequestedMft)
33952. 	
33953. 
33954. 	/* OS Volume Type Method */
33955. 		# Gap Calculation Methods:
33956. 	/* AddGap Variants */
33957. 	/* OS Volume Type Method */
33958. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
33959. 	SetVariable(GapRequested, GapRequestedOs)
33960. 
33961. 
33962. 
33963. /* MakeGap Variants */
33964. 
33965. 	/* Original Os 1-3 + MFT 2 */
33966. 		# Gap Calculation Methods:
33967. 	/* MakeGap Variants */
33968. 	/* Original Os 1-3 + MFT 2 */
33969. 	/* plus MFT gap placed inline at the dividing zone. */
33970. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
33971. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
33972. 	SetVariable(GapRequested, GapRequestedOrig)
33973. 	
33974. 	
33975. /* Note: You could comment out the ones not in use */
33976. /* However having the data in the log is useful. */
33977. /* Therefore the following line is otherwise needed. */
33978. 
33979. /* Standard used */
33980. 
33981. SetVariable(GapRequested, GapRequestedStd)
33982. 
33983. # Gap Calculation Methods:
33984. 
33985. /* AddGap Variants */
33986. 	/* Standard */
33987. 	/* MFT Low High Method */
33988. 	/* OS Volume Type Method */
33989. 
33990. /* MakeGap Variants */
33991. 	/* Original Os 1-3 + MFT 2 */
33992. 
33993. /* Note: You could comment out the ones not in use */
33994. /* However having the data in the log is useful. */
33995. /* Therefore the following line is otherwise needed. */
33996. 
33997. /* Standard is used currently */
33998. 
33999. 
34000. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
34001. 
34002. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
34003. 
34004. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
34005. 
34006. /* ------------------------- */
34007. /* 3) SMALL ZONE ADJUSTMENT. */
34008. /* Gab cant be larger than half the Zone Size. */
34009. 
34010. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
34011. 	
34012. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
34013. 
34014. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
34015. 
34016. /* ------------------------- */
34017. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
34018. # Gap Adjustments.
34019. 
34020. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
34021. 	
34022. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
34023. 
34024. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
34025. 
34026. /* ------------------------- */
34027. # BYPASS THIS.
34028. 	/* This is definitely wrong. */
34029. 	/* The question is can we steal gap from the next zone */
34030. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
34031. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
34032. 		# Zone Overflow.
34033. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
34034. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
34035. 
34036. /* ------------------------- */
34037. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
34038. # Remaining free space available.
34039. 
34040. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
34041. 	
34042. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
34043. 
34044. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
34045. 
34046. /* ------------------------- */
34047. # CURRENT gap to use.
34048. 
34049. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
34050. 
34051. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
34052. 
34053. /* ------------------------- */
34054. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
34055. # Debugging.
34056. 
34057. 	SetVariable(GapUsed, GapCurrent) // for debugging
34058. 
34059. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
34060. 
34061. 		# Your code HERE
34062. 
34063. /* ------------------------- */
34064. /* 7) YOUR CODE. */
34065. # YOUR CODE HERE:
34066. 	# INPUT: GapCurrent or GapCurrentLoc
34067. 	# OUTPUT: GapUsed...
34068. 
34069. /* ------------------------- */
34070. # Gap Size.
34071. # Actual Size of Gap.
34072. 
34073. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
34074. 
34075. /* ------------------------- */
34076. 
34077. 	
34078. 	# Zone Statistics	
34079. 		# Script: ZoneStatisticsGet
34080. # Zone / Volume Statistics and Display
34081. 		
34082. 	# Accumulate Totals
34083.   	# Script: ZoneDoVolumeTotals
34084. 
34085. /* Current total space used (by Zones and Gaps) */
34086. 
34087. SetVariable(VolumeZoneUsed, GapUsed)
34088. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
34089. /* Percentage */
34090. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
34091. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
34092. 
34093. /* Current total of free space requested */
34094. 
34095. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
34096. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
34097. /* Percent. */
34098. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
34099. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
34100. 
34101. /* Current total of free space used */
34102. 
34103. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
34104. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
34105. /* Percent */
34106. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
34107. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
34108. 
34109. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
34110. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
34111. # Xinclude "..\DebugDisplayPause.MyDc"X
34112. 
34113. 
34114. 	# Current Values
34115. 	# Script: ZoneDoCurrentSet
34116. 
34117. # Cluster, Sector, Block adjust for display.
34118. 	# Bytes per cluster is volume specific.
34119. 
34120. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster - 1)	
34121. 
34122. # Current Zone values.
34123. 	# Begin, end and size.
34124. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
34125. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
34126. 
34127. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
34128. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
34129. 
34130. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
34131. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
34132. 
34133. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
34134. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
34135. 
34136. 	SetVariable(ZoneFragments,				"!ZONE210N!")
34137. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
34138. 		
34139. # Current Gap, Actual and Free Values
34140. 	# Gap
34141. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
34142. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
34143. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
34144. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
34145. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
34146. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
34147. 	
34148. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
34149. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
34150. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
34151. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
34152. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
34153. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
34154. 	
34155. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
34156. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
34157. 	
34158. 	# Actual Size and End
34159. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
34160. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
34161. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
34162. 	
34163. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
34164. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
34165. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
34166. 
34167. # Gap Size & Rounding
34168. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
34169. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
34170. 	
34171. 	# Free Space
34172. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
34173. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
34174. 
34175. 	# Script: ZoneStatisticsReportGet
34176. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
34177. 
34178. # Footer:
34179. SetVariable(ZoneStatisticsReport1, "----------------------------------------------------------
34180. ZONE!ColonWord! !ZoneNoDisplay! (!ZoneNoCurrent!, !ZoneNoCurrentAdjust!) !ZoneLabel! !ZoneDescription! ")
34181. #
34182. # Xinclude "..\Commands\DateTimeLastLong.txt"X
34183. #
34184. # What a mess this word based vs is. Try a phrase based version ToDo
34185. SetVariable(ZoneStatisticsReport2, "Statistics Report!ColonWord!
34186. ------------------
34187.    !SizeWord!!ColonWord!  
34188.    ------------------------
34189.                 Files!ColonWord! !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
34190.                   Gap!ColonWord! !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
34191.                 Total!ColonWord! !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
34192. 
34193.         !FilesWord!!SlashWord!!FoldersWord!!ColonWord! !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
34194.             !FragmentsWord!!ColonWord! !ZoneFragments! (!ZoneFragmentsPer!%) 
34195. 
34196.    !LocationWord!!ColonWord!
34197.    ------------------------
34198.            !ZoneWordCaps! !StartWord!!ColonWord! !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
34199.             !FilesWord! !EndWord!!ColonWord! !ZoneEndCurrent!
34200.              !ZoneWordCaps! !EndWord!!ColonWord! !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
34201.       
34202.    !GapWordCaps! !SettingsWord!!ColonWord!
34203.    ------------------------
34204.          !GapWordCaps! !RequestedWord!!ColonWord! !ZoneGapSizePer!%
34205.        !VolumeWordCaps! !RoundingWord!!ColonWord! !ZoneVolRoundUpPer!%
34206.             !ActualWord! !GapWordCaps!!ColonWord! !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
34207.                  
34208.                !TheWordCaps! !DesiredWord! !MinWord! !GapWordCaps! !SizeWord!!PeriodWord! (GapRequested)!ColonWord! !ZoneGapRequestedCurrent!  (!LocWord!) !ZoneGapRequestedLocCurrent!
34209.               !MustWordCaps! !BeWord! !HalfWord! !TheWord! !ZoneWordCaps! !SizeWord!!PeriodWord! (GapAdjusted)!ColonWord! !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
34210.                !AlignWord! !ToWord! !TheWord! !VolumeWordCaps! !EvenlyWord!!PeriodWord! (GapRounded)!ColonWord! !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
34211.           !TheWordCaps! !RemainingWord! !SpaceWord! !AvailableWord!!PeriodWord! (GapAvailable)!ColonWord! !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
34212.       !TheWordCaps! !LowerWord! !OfWord! !AdjustedWord! !AndWord! !AvailableWord!!PeriodWord! (GapCurrent)!ColonWord! !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
34213.     (GapCurrent) !AfterWord! !AnyWord! !CodeWord! !YouWord! !InsertedWord!!PeriodWord! (GapUsed)!ColonWord! !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
34214.      
34215.    !FreeWord! !SpaceWord! !AfterWord! !ZoneWordCaps!!ColonWord!
34216.    ------------------------
34217.               !TotalWord! !RequestedWord!!ColonWord! !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
34218.                    !TotalWord! !UsedWord!!ColonWord! !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
34219.          !VolumeWordCaps! !UsedWord! !ByWord! !ZonesWord!!ColonWord! !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
34220. 
34221. !DirectoryWord! !AndWord! !FilesWord! !SelectWord!!ColonWord!
34222. ----------------------------------------------------------
34223. ")
34224. #
34225. SetVariable(DateNow, 	DATETIME)
34226. SetVariable(TimeNow, 	Time)
34227. SetVariable(RunTimeNow, 	RunTime)
34228. 
34229. 
34230. SetVariable(ZoneStatisticsReport, "!ZoneStatisticsReport1! !DateNow! !TimeNow! !RunTimeNow! !ZoneStatisticsReport2!")
34231. 
34232. # WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!", "!ZoneStatisticsReport!")
34233. # AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
34234. 
34235. 	# Script: DisplaySetWindowText
34236. # Zone Footer Set Statistics Window Text
34237. 
34238. SetStatisticsWindowText("!Heading!
34239. ----------------------------------------------------------
34240. Zones Processed: 
34241. ----------------------------------------------------------
34242. !ZoneListByLine!
34243. ----------------------------------------------------------
34244. Zone Processing Step:
34245. !ZoneStepByLine!    
34246. ----------------------------------------------------------
34247. ----------------------------------------------------------
34248. CURRENT ZONE:
34249. !ZoneStatisticsReport!
34250. ----------------------------------------------------------
34251. ----------------------------------------------------------
34252. ----------------------------------------------------------
34253. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
34254. ----------------------------------------------------------
34255. !VolumeStatisticsSummary!
34256. !VolumeStatisticsDetail!
34257. ----------------------------------------------------------
34258. ----------------------------------------------------------
34259. Zone Detailed Report:
34260. ----------------------------------------------------------
34261. !ZoneStatisticsDetail!
34262. ----------------------------------------------------------
34263. ")
34264. 
34265. 
34266. 	
34267. 	SetVariable(ZoneEndCurrentGapped,		ZoneBeginCurrent + ZoneSizeActualCurrent)
34268. 
34269. 
34270. 	SetVariable(ZoneStatisticsData, 
34271. "     s-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
34272.      z [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / act end !ZoneEndCurrentGapped!]
34273.      g < used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!>")
34274. 
34275. 
34276. 
34277.  		# Script: ZoneStatisticsDisplay
34278. 	
34279. 	SetVariable(ZoneListByLine, '!ZoneListByLine!
34280. !ZoneStatisticsData!
34281. ')
34282. 
34283. 		# Script: ZoneStatisticsAdd
34284. # Append Zone to Details of each zone.
34285. 		
34286. 	# Add Zone Details to Report.	
34287. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
34288. !ZoneStatisticsReport!
34289. ')
34290. 
34291. 	
34292. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionStart!")
34293. 		# Script: DisplaySetZoneStep
34294. # Increment
34295. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
34296. 
34297. # Display this zone step
34298. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
34299. ')
34300. 
34301. # Script: BannerSet
34302. 
34303. # NOTE: Can't round or truncate to integer precision. 
34304. # This internal fields like ZoneCount format really badly.
34305. #  for !RunTimeNow! does not work. None of the date functions do.
34306. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
34307. 
34308. SetVariable(HeadingTemp2,	ZoneCount + 0)
34309. 
34310. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
34311. 
34312. Title('!Heading!')
34313. 
34314. /* pause(1) */
34315. 
34316. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
34317. 
34318. 
34319. # Script: DisplaySetWindowText
34320. # Zone Footer Set Statistics Window Text
34321. 
34322. SetStatisticsWindowText("!Heading!
34323. ----------------------------------------------------------
34324. Zones Processed: 
34325. ----------------------------------------------------------
34326. !ZoneListByLine!
34327. ----------------------------------------------------------
34328. Zone Processing Step:
34329. !ZoneStepByLine!    
34330. ----------------------------------------------------------
34331. ----------------------------------------------------------
34332. CURRENT ZONE:
34333. !ZoneStatisticsReport!
34334. ----------------------------------------------------------
34335. ----------------------------------------------------------
34336. ----------------------------------------------------------
34337. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
34338. ----------------------------------------------------------
34339. !VolumeStatisticsSummary!
34340. !VolumeStatisticsDetail!
34341. ----------------------------------------------------------
34342. ----------------------------------------------------------
34343. Zone Detailed Report:
34344. ----------------------------------------------------------
34345. !ZoneStatisticsDetail!
34346. ----------------------------------------------------------
34347. ")
34348. 
34349. 
34350. 
34351. 
34352. 		# File Action - All - Full -  SortByCreationDate
34353. # File Action - ZoneDoActionSortByCreationDateFull
34354. 	SortByCreationDate(Ascending)
34355. 	
34356. 
34357. 
34358. 		SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionEnd!")
34359. 		# Script: DisplaySetZoneStep
34360. # Increment
34361. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
34362. 
34363. # Display this zone step
34364. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
34365. ')
34366. 
34367. # Script: BannerSet
34368. 
34369. # NOTE: Can't round or truncate to integer precision. 
34370. # This internal fields like ZoneCount format really badly.
34371. #  for !RunTimeNow! does not work. None of the date functions do.
34372. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
34373. 
34374. SetVariable(HeadingTemp2,	ZoneCount + 0)
34375. 
34376. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
34377. 
34378. Title('!Heading!')
34379. 
34380. /* pause(1) */
34381. 
34382. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
34383. 
34384. 
34385. # Script: DisplaySetWindowText
34386. # Zone Footer Set Statistics Window Text
34387. 
34388. SetStatisticsWindowText("!Heading!
34389. ----------------------------------------------------------
34390. Zones Processed: 
34391. ----------------------------------------------------------
34392. !ZoneListByLine!
34393. ----------------------------------------------------------
34394. Zone Processing Step:
34395. !ZoneStepByLine!    
34396. ----------------------------------------------------------
34397. ----------------------------------------------------------
34398. CURRENT ZONE:
34399. !ZoneStatisticsReport!
34400. ----------------------------------------------------------
34401. ----------------------------------------------------------
34402. ----------------------------------------------------------
34403. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
34404. ----------------------------------------------------------
34405. !VolumeStatisticsSummary!
34406. !VolumeStatisticsDetail!
34407. ----------------------------------------------------------
34408. ----------------------------------------------------------
34409. Zone Detailed Report:
34410. ----------------------------------------------------------
34411. !ZoneStatisticsDetail!
34412. ----------------------------------------------------------
34413. ")
34414. 
34415. 
34416. 
34417. 
34418. 	# Script: ZoneDoFooter
34419. 
34420. /* --------------------------------- */
34421. 	# File Select
34422. 		# Select Statments
34423. 	# File Actions 
34424. 		# Standard or OS File Actions.
34425. 		# Resume...
34426. 	
34427. 		# your stuff HERE (X)... post zone (file) file actions code.
34428. 			# SetVariable(ZoneStepDescription, "!ZoneStepDescriptionYourFileActionsPre!")
34429. 			# Xinclude "..\Display\DisplaySetZoneStep.MyDc"X
34430. 			# (X)
34431. 		
34432. 			/* ??? Set window? */
34433. 	
34434. 		# ADD THE GAP
34435. 		# Script: GapZoneCommand
34436. # Vacate (good for diagnostics)
34437. # DoNotVacate - DO NOT Vacate (recommended)
34438. 
34439. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionFileActionGapDo!")
34440. # Script: DisplaySetZoneStep
34441. # Increment
34442. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
34443. 
34444. # Display this zone step
34445. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
34446. ')
34447. 
34448. # Script: BannerSet
34449. 
34450. # NOTE: Can't round or truncate to integer precision. 
34451. # This internal fields like ZoneCount format really badly.
34452. #  for !RunTimeNow! does not work. None of the date functions do.
34453. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
34454. 
34455. SetVariable(HeadingTemp2,	ZoneCount + 0)
34456. 
34457. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
34458. 
34459. Title('!Heading!')
34460. 
34461. /* pause(1) */
34462. 
34463. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
34464. 
34465. 
34466. # Script: DisplaySetWindowText
34467. # Zone Footer Set Statistics Window Text
34468. 
34469. SetStatisticsWindowText("!Heading!
34470. ----------------------------------------------------------
34471. Zones Processed: 
34472. ----------------------------------------------------------
34473. !ZoneListByLine!
34474. ----------------------------------------------------------
34475. Zone Processing Step:
34476. !ZoneStepByLine!    
34477. ----------------------------------------------------------
34478. ----------------------------------------------------------
34479. CURRENT ZONE:
34480. !ZoneStatisticsReport!
34481. ----------------------------------------------------------
34482. ----------------------------------------------------------
34483. ----------------------------------------------------------
34484. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
34485. ----------------------------------------------------------
34486. !VolumeStatisticsSummary!
34487. !VolumeStatisticsDetail!
34488. ----------------------------------------------------------
34489. ----------------------------------------------------------
34490. Zone Detailed Report:
34491. ----------------------------------------------------------
34492. !ZoneStatisticsDetail!
34493. ----------------------------------------------------------
34494. ")
34495. 
34496. 
34497. 
34498. 
34499. # *** Moved to setting yours *** 
34500. # (to avoid doing it twice)
34501. # (ie the later wouldn't "overwrite" the former in the usual manner)
34502. 
34503. # Do one or the other:
34504. # DoNotVacate - DO NOT Vacate (recommended)
34505. 
34506. # Vacate
34507. /* AddGap(GapUsedLoc) */
34508. 
34509. # DO Not Vacate
34510. AddGap(GapUsedLoc, DoNotVacate) 
34511. 	
34512. 	
34513. 
34514. # Controlled via settings commands
34515. 
34516. # Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X
34517. 
34518. # Vacate /* AddGap(GapUsed) */
34519. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
34520. 	
34521. 
34522. 		
34523. 	# 
34524. 	FileEnd
34525. /* --------------------------------- */
34526. # your stuff HERE (X)... post zone (file) code.
34527. 
34528. SetVariable(ZoneStepDescription, "!ZoneStepDescriptionZoneReporting!")
34529. # Script: DisplaySetZoneStep
34530. # Increment
34531. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
34532. 
34533. # Display this zone step
34534. SetVariable(ZoneStepByLine, '!ZoneStepByLine!!ZoneStepNoCurrent! !ZoneStepDescription!
34535. ')
34536. 
34537. # Script: BannerSet
34538. 
34539. # NOTE: Can't round or truncate to integer precision. 
34540. # This internal fields like ZoneCount format really badly.
34541. #  for !RunTimeNow! does not work. None of the date functions do.
34542. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
34543. 
34544. SetVariable(HeadingTemp2,	ZoneCount + 0)
34545. 
34546. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
34547. 
34548. Title('!Heading!')
34549. 
34550. /* pause(1) */
34551. 
34552. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
34553. 
34554. 
34555. # Script: DisplaySetWindowText
34556. # Zone Footer Set Statistics Window Text
34557. 
34558. SetStatisticsWindowText("!Heading!
34559. ----------------------------------------------------------
34560. Zones Processed: 
34561. ----------------------------------------------------------
34562. !ZoneListByLine!
34563. ----------------------------------------------------------
34564. Zone Processing Step:
34565. !ZoneStepByLine!    
34566. ----------------------------------------------------------
34567. ----------------------------------------------------------
34568. CURRENT ZONE:
34569. !ZoneStatisticsReport!
34570. ----------------------------------------------------------
34571. ----------------------------------------------------------
34572. ----------------------------------------------------------
34573. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
34574. ----------------------------------------------------------
34575. !VolumeStatisticsSummary!
34576. !VolumeStatisticsDetail!
34577. ----------------------------------------------------------
34578. ----------------------------------------------------------
34579. Zone Detailed Report:
34580. ----------------------------------------------------------
34581. !ZoneStatisticsDetail!
34582. ----------------------------------------------------------
34583. ")
34584. 
34585. 
34586. 
34587. 
34588. # Script: ZoneWhenFinished
34589. 
34590. # Add the zone to the zone details log:
34591. # This is temporarily disable until logging is fixed
34592. # It is performed during file action to preserve the correct (original) calculations.
34593. # Xinclude "..\Zone\ZoneStatisticsAdd.MyDc"X
34594. 
34595. # Add the Select and ZoneSteps to the Zone
34596. # Script: ZoneStatisticsAdd
34597. # Append Zone to Details of each zone.
34598. 		
34599. 	# Add Zone Details to Report.	
34600. 	SetVariable(ZoneStatisticsDetail, 	'!ZoneStatisticsDetail!
34601. ----------------------------------------------------------
34602. !ZoneStepByLine!
34603. ---------------------------
34604. !ZoneTypeSelectCurrent!               
34605. ---------------------------
34606. ----------------------------------------------------------
34607. !EndWordCaps! !OfWord! !ZoneWordCaps!!PeriodWord!
34608. ----------------------------------------------------------
34609. ')
34610. 
34611. 
34612. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneStatisticsReport1!")
34613. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneStatisticsReport2!")
34614. # 2021-12-14 15:30:02
34615. RunProgram("..\Commands\WriteDateTime.bat LastZone")
34616. # Append Datetime to logs
34617. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone.txt'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
34618. RunProgram("copy","'!LogFileName!'+'DateTimeLastZone.txt'", "!LogFileName!","/Y")
34619. 
34620. AppendLogfile("!LogFileName!", "!PeriodWord!")
34621. AppendLogfile("!LogFileName!", "!ZoneStatisticsReport!")
34622. AppendLogfile("!LogFileName!", "!PeriodWord!")
34623. 
34624. # Script: DisplaySetWindowText
34625. # Zone Footer Set Statistics Window Text
34626. 
34627. SetStatisticsWindowText("!Heading!
34628. ----------------------------------------------------------
34629. Zones Processed: 
34630. ----------------------------------------------------------
34631. !ZoneListByLine!
34632. ----------------------------------------------------------
34633. Zone Processing Step:
34634. !ZoneStepByLine!    
34635. ----------------------------------------------------------
34636. ----------------------------------------------------------
34637. CURRENT ZONE:
34638. !ZoneStatisticsReport!
34639. ----------------------------------------------------------
34640. ----------------------------------------------------------
34641. ----------------------------------------------------------
34642. VOLUME REPORT: !VolumeLabel! !VolumeDescription!
34643. ----------------------------------------------------------
34644. !VolumeStatisticsSummary!
34645. !VolumeStatisticsDetail!
34646. ----------------------------------------------------------
34647. ----------------------------------------------------------
34648. Zone Detailed Report:
34649. ----------------------------------------------------------
34650. !ZoneStatisticsDetail!
34651. ----------------------------------------------------------
34652. ")
34653. 
34654. 
34655. 
34656. /* pause() */
34657. /* pause() */
34658. 
34659. 
34660. 
34661. /* ------------------------- */
34662. 
34663. 
34664. /* ------------------------- */
34665. 
34666. /* ------------------------- */
34667. /* Volume End */
34668. # Script: VolumeWhenFinished
34669. 
34670. /* Write the "after" statistics to the logfile. */
34671. 
34672. # Script: BannerSet
34673. 
34674. # NOTE: Can't round or truncate to integer precision. 
34675. # This internal fields like ZoneCount format really badly.
34676. #  for !RunTimeNow! does not work. None of the date functions do.
34677. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
34678. 
34679. SetVariable(HeadingTemp2,	ZoneCount + 0)
34680. 
34681. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
34682. 
34683. Title('!Heading!')
34684. 
34685. /* pause(1) */
34686. 
34687. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
34688. 
34689. 
34690. # Script: BannerLog
34691. 
34692. AppendLogfile("!LogFileName!", "!Heading!")
34693. 
34694. 
34695. 
34696. # Script: VolumeFooterGet
34697. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
34698. 
34699. # Script: VolumeStatisticsSummaryGet
34700. # Set Volume summary stats:
34701. 
34702. # Cluster, Sector, Block adjust for display.
34703. # Bytes per cluster is volume specific.
34704. 
34705. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster -1)	
34706. 
34707. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
34708. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
34709. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
34710. 
34711. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
34712. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
34713. 
34714. # Set the display text:
34715. # Script: VolumeStatisticsSummaryDisplay
34716. 
34717. SetVariable(VolumeStatisticsSummary, "----------------------------------------------------------
34718. VOLUME SUMMARY: !VolumeLabel! !VolumeDescription!
34719. Volume mountpoint:          !MountPoint!
34720. Volume label:               !VolumeLabel!
34721. Volume name:                !VolumeName!
34722. Volume type:                !VolumeType!
34723. ----------------------------------------------------------
34724.           Volume Size:       !VolumeSize! (!VolumeSizeG! gigabytes)
34725.           Volume Used:       !VolumeUsed! (!VolumeUsedG! gigabytes)
34726.           Volume Free:       !VolumeFree! (!VolumeFreeG! gigabytes)
34727.          
34728.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
34729.       Volume Free Adj:       !VolumeFreeAdj!
34730. 
34731.    Unfragmented Items:       !FILES200N!
34732.      Fragmented Items:       !FILES210N!
34733. 
34734.     Unfragmented Data:       !FILES202N! bytes
34735.       Fragmented Data:       !FILES212N! bytes
34736. 
34737.              All Gaps:       !GAP00N!
34738.              All gaps:       !GAP10N! bytes
34739.           Average gap:       !GAP13N! bytes
34740.            Median gap:       !GAP14N! bytes
34741.           Biggest gap:       !GAP15N! bytes
34742. 
34743.              MFT Zone:       !MftZone! 
34744.              Location:       !MftLocation! 
34745.                  Size:                       0 
34746.             Gap slack:       !MftGapSlack!
34747. ----------------------------------------------------------
34748. ") 
34749. 
34750. 
34751. 
34752. SetVariable(VolumeFooter, "!VolumeStatisticsSummary!")
34753. 
34754. 
34755. # Script: VolumeSizeLog
34756. AppendLogfile("!LogFileName!", "!PeriodWord!")
34757. AppendLogfile("!LogFileName!", "      Volume Size: !VolumeSize!")
34758. AppendLogfile("!LogFileName!", "      Volume Used: !VolumeUsed!")
34759. AppendLogfile("!LogFileName!", "Volume Used Total: !VolumeUsedTotal!")
34760. AppendLogfile("!LogFileName!", "      Volume Free: !VolumeFree!")
34761. AppendLogfile("!LogFileName!", "  Volume Free Adj: !VolumeFreeAdj!")
34762. AppendLogfile("!LogFileName!", "!PeriodWord!")
34763. AppendLogfile("!LogFileName!", "MFT Zone: !MftZone! Location: !MftLocation! Size:                 0 Gap: !MftGapSize!")
34764. AppendLogfile("!LogFileName!", "!PeriodWord!")
34765. 
34766. 
34767. /* Write/display stats: */
34768. 
34769. # Log:  
34770. 
34771. # Script: VolumeStatisticsDetailGet
34772. 
34773. # Script: VolumeStatisticsSummaryGet
34774. # Set Volume summary stats:
34775. 
34776. # Cluster, Sector, Block adjust for display.
34777. # Bytes per cluster is volume specific.
34778. 
34779. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster -1)	
34780. 
34781. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
34782. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
34783. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
34784. 
34785. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
34786. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
34787. 
34788. # Set the display text:
34789. # Script: VolumeStatisticsSummaryDisplay
34790. 
34791. SetVariable(VolumeStatisticsSummary, "----------------------------------------------------------
34792. VOLUME SUMMARY: !VolumeLabel! !VolumeDescription!
34793. Volume mountpoint:          !MountPoint!
34794. Volume label:               !VolumeLabel!
34795. Volume name:                !VolumeName!
34796. Volume type:                !VolumeType!
34797. ----------------------------------------------------------
34798.           Volume Size:       !VolumeSize! (!VolumeSizeG! gigabytes)
34799.           Volume Used:       !VolumeUsed! (!VolumeUsedG! gigabytes)
34800.           Volume Free:       !VolumeFree! (!VolumeFreeG! gigabytes)
34801.          
34802.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
34803.       Volume Free Adj:       !VolumeFreeAdj!
34804. 
34805.    Unfragmented Items:       !FILES200N!
34806.      Fragmented Items:       !FILES210N!
34807. 
34808.     Unfragmented Data:       !FILES202N! bytes
34809.       Fragmented Data:       !FILES212N! bytes
34810. 
34811.              All Gaps:       !GAP00N!
34812.              All gaps:       !GAP10N! bytes
34813.           Average gap:       !GAP13N! bytes
34814.            Median gap:       !GAP14N! bytes
34815.           Biggest gap:       !GAP15N! bytes
34816. 
34817.              MFT Zone:       !MftZone! 
34818.              Location:       !MftLocation! 
34819.                  Size:                       0 
34820.             Gap slack:       !MftGapSlack!
34821. ----------------------------------------------------------
34822. ") 
34823. 
34824. 
34825. 
34826. # No Calculations needed.
34827. 
34828. # Set the display text:
34829. # This currently includes the summary within it.
34830. # Script: VolumeStatisticsDetailDisplay
34831. 
34832. SetVariable(VolumeStatisticsDetail, "----------------------------------------------------------
34833. VOLUME DETAILS: !VolumeLabel! !VolumeDescription!
34834. ----------------------------------------------------------
34835. Script Directory: G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts
34836. Command Line: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_3\src\Scripts\DefragDevDiskYearly.MyD" 
34837. Process ID: 14392
34838. Action: # File Action - All - Full -  SortByCreationDate
34839. # File Action - ZoneDoActionSortByCreationDateFull
34840. 	SortByCreationDate(Ascending)
34841. 	
34842. 
34843. Mode: Full
34844. Requested Volume: Name("C:")
34845. 
34846. ----------------------------------------------------------
34847. MOUNT POINT:
34848. 
34849.     Volume mountpoint:          !MountPoint!
34850.     Volume type:                !VolumeType!
34851.     Bytes per cluster:          !BytesPerCluster! bytes
34852.     Average end-begin distance: !AverageBeginEndDistance! clusters
34853.                                 !AverageBeginEndDistanceP!% of volume size
34854. 
34855.     Divisor:    (!DisplayUnitDivisor!)
34856.     Curr:       (!DisplayUnitDivisorCurrent!) 
34857. ----------------------------------------------------------
34858. LARGE and UNMOVABLES:
34859. 
34860.     UnmovablesTotalBytes:	!UnmovablesTotalBytes!
34861. FragmentedTotalFragments:	!FragmentedTotalFragments!
34862. 
34863. The 25 largest items from the LargestItemsList:
34864. !LargestItemsList!
34865. ----------------------------------------------------------
34866. FRAGMENTS:
34867. 
34868.     Unfragmented Items: !FILES200N!
34869.       Fragmented Items: !FILES210N!
34870.      Unfragmented Data: !FILES202N! bytes
34871.        Fragmented Data: !FILES212N! bytes
34872.     Gaps:
34873.               All Gaps: !GAP00N!
34874.               All gaps: !GAP10N! bytes
34875.            Average gap: !GAP13N! bytes
34876.             Median gap: !GAP14N! bytes
34877.            Biggest gap: !GAP15N! bytes
34878. 
34879. ----------------------------------------------------------
34880. GAPS:
34881. ----------------------------------------------------------
34882.    ----------------------------------------------------------
34883.    Counts:
34884.                        Count      Percentage of all
34885.                 ----------------- -----------------
34886.    Small gaps   !GAP01N! !GAP01P!%
34887.    Big gaps     !GAP02N! !GAP02P!%
34888.                 ----------------- -----------------
34889.    All gaps     !GAP00N! !GAP00P!
34890. 
34891.    ----------------------------------------------------------
34892.    By size:
34893.                       Bytes          Gigabytes      Percentage of all
34894.                 ----------------- ----------------- -----------------
34895.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
34896.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
34897.                 ----------------- ----------------- -----------------
34898.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
34899. 
34900.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
34901.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
34902.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
34903.    ----------------------------------------------------------
34904. 
34905. ----------------------------------------------------------
34906. FILE STATISTICS:
34907. ----------------------------------------------------------
34908. ----------------------------------------------------------
34909. ITEM COUNT:
34910. ----------------------------------------------------------
34911. Number of files and folders:
34912. 
34913.               Unfragmented       Fragmented            All
34914.    ------- ----------------- ----------------- -----------------
34915.    Files   !FILES000N! !FILES010N! !FILES020N!
34916.    Folders !FILES100N! !FILES110N! !FILES120N!
34917.    ------- ----------------- ----------------- -----------------
34918.    All     !FILES200N! !FILES210N! !FILES220N!
34919. 
34920. ----------------------------------------------------------
34921. Percentage of total:
34922. 
34923.               Unfragmented       Fragmented            All
34924.    ------- ----------------- ----------------- -----------------
34925.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
34926.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
34927.    ------- ----------------- ----------------- -----------------
34928.    All     !FILES200P!%!FILES210P!%!FILES220P!%
34929. 
34930. ----------------------------------------------------------
34931. OCCUPIED SIZE on disk:
34932. ----------------------------------------------------------
34933. Bytes:
34934.               Unfragmented       Fragmented            All
34935.    ------- ----------------- ----------------- -----------------
34936.    Files   !FILES002N! !FILES012N! !FILES022N!
34937.    Folders !FILES102N! !FILES112N! !FILES122N!
34938.    ------- ----------------- ----------------- -----------------
34939.    All     !FILES202N! !FILES212N! !FILES222N!
34940. 
34941. ----------------------------------------------------------
34942. Gigabytes:
34943.               Unfragmented       Fragmented            All
34944.    ------- ----------------- ----------------- -----------------
34945.    Files   !FILES002G! !FILES012G! !FILES022G!
34946.    Folders !FILES102G! !FILES112G! !FILES122G!
34947.    ------- ----------------- ----------------- -----------------
34948.    All     !FILES202G! !FILES212G! !FILES222G!
34949. 
34950. ----------------------------------------------------------
34951. Percentage:
34952.               Unfragmented       Fragmented            All
34953.    ------- ----------------- ----------------- -----------------
34954.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
34955.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
34956.    ------- ----------------- ----------------- -----------------
34957.    All     !FILES202P!%!FILES212P!%!FILES222P!%
34958. 
34959. ----------------------------------------------------------
34960. USED SIZE:
34961. ----------------------------------------------------------
34962. Bytes:
34963.               Unfragmented       Fragmented            All
34964.    ------- ----------------- ----------------- -----------------
34965.    Files   !FILES001N! !FILES011N! !FILES021N!
34966.    Folders !FILES101N! !FILES111N! !FILES121N!
34967.    ------- ----------------- ----------------- -----------------
34968.    All     !FILES201N! !FILES211N! !FILES221N!
34969. 
34970. ----------------------------------------------------------
34971. Gigabytes:
34972.               Unfragmented       Fragmented            All
34973.    ------- ----------------- ----------------- -----------------
34974.    Files   !FILES001G! !FILES011G! !FILES021G!
34975.    Folders !FILES101G! !FILES111G! !FILES121G!
34976.    ------- ----------------- ----------------- -----------------
34977.    All     !FILES201G! !FILES211G! !FILES221G!
34978. 
34979. ----------------------------------------------------------
34980. Percentage:
34981.               Unfragmented       Fragmented            All
34982.    ------- ----------------- ----------------- -----------------
34983.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
34984.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
34985.    ------- ----------------- ----------------- -----------------
34986.    All     !FILES201P!%!FILES211P!%!FILES221P!%
34987. 
34988. ----------------------------------------------------------
34989. Volume Detailed Statistics end.
34990. ----------------------------------------------------------
34991. ")
34992. 
34993. /* 
34994. */
34995. 
34996. # Update display
34997. SetVariable(ZoneStatisticsReport, '
34998. 
34999. ZONE PROCESSING COMPLETE - Finished.
35000. 
35001. ')
35002. SetVariable(ZoneStatisticsDetail, '!ZoneStatisticsDetail!!ZoneStatisticsReport!')
35003. 
35004. # Write to log
35005. # VolumeStatisticsSummary
35006. SetVariable(VolumeFooter,     "!VolumeStatisticsSummary!")
35007. #
35008. # SetVariable(VolumeFooter,     "!VolumeStatisticsSummary1!!VolumeStatisticsSummary2!")
35009. 
35010. SetVariable(VolumeKeyCurr, "!LogFileName! !VolumeCurrentDescription!")
35011. 
35012. WriteLogfile("!VolumeKeyCurr!", "!VolumeFooter!")
35013. 
35014. # WriteLogfile("!VolumeKeyCurr! part1", "!VolumeFooter1!")
35015. # WriteLogfile("!VolumeKeyCurr! part2", "!VolumeFooter2!")
35016. # RunProgram("..\Commands\WriteDateTime.bat LastVolume")
35017. 
35018. RunProgram("Echo","!VolumeFooter1! > !VolumeKeyCurr!.log")
35019. RunProgram("Type","DateTimeLastVolume.txt",">>","!VolumeKeyCurr!.log")
35020. RunProgram("Echo","!VolumeFooter2!",">>","!VolumeKeyCurr!.log")
35021. # ,"/Y")
35022. # RunProgram("Echo",
35023. 
35024. # SetVariable(LogFileBlock,	"")
35025. # SetVariable(LogFileBlock,	"!LogFileBlock!
35026. # SetVariable(LogFileBlock,	"!LogFileBlock!XXX")
35027. 
35028. SetVariable(LogFileBlock,	"!LogFileBlock!
35029. .")
35030. SetVariable(LogFileBlock,	"!LogFileBlock!!VolumeStatisticsDetail!
35031. ")
35032. SetVariable(LogFileBlock,	"!LogFileBlock!
35033. .")
35034. SetVariable(LogFileBlock,	"!LogFileBlock!Volume End.
35035. ")	
35036. 
35037. # SetStatisticsWindowText("!VolumeStatisticsDetail!")
35038. 
35039. /* pause() */
35040. /* pause() */
35041. 
35042.   
35043. 
35044. VolumeEnd
35045. 
35046. /* ------------------------- */
35047. AppendLogfile("!LogFileName!", "!PeriodWord!")
35048. SetVariable(DateNow, 	DATETIME)
35049. SetVariable(TimeNow, 	Time)
35050. SetVariable(RunTimeNow, 	RunTime)
35051. 
35052. SetVariable(ZoneStepDescription,"!Description! !ComplexWord! !VolumeWordCaps! !EndWord!!ColonWord! !DateNow! !TimeNow! !RunTimeNow!.")
35053. # Script: BannerDescriptionSet
35054. 
35055. # Script: BannerSet
35056. 
35057. # NOTE: Can't round or truncate to integer precision. 
35058. # This internal fields like ZoneCount format really badly.
35059. #  for !RunTimeNow! does not work. None of the date functions do.
35060. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
35061. 
35062. SetVariable(HeadingTemp2,	ZoneCount + 0)
35063. 
35064. SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNoDisplay! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust!) of !HeadingTemp2!  ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
35065. 
35066. Title('!Heading!')
35067. 
35068. /* pause(1) */
35069. 
35070. # Last SetVariable(Heading, '!RunDescription! Full ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !ZoneStepDescription! ||Zone: !ZoneNumber! of !ZoneCount! (!ZoneNoCurrent!,!ZoneNoCurrentAdjust! or !ZoneNoDisplay!) ||Server: !SeverStepDescription! !DashWord! !RunStepDescription! started on !RunDateTime! for !RunTimeNow! ||VolumeUsed: !VolumeZoneUsed! of !VolumeSize!')
35071. 
35072. 
35073. # Script: BannerLog
35074. 
35075. AppendLogfile("!LogFileName!", "!Heading!")
35076. 
35077. 
35078. 
35079. AppendLogfile("!LogFileName!", "!PeriodWord!")
35080. 
35081. /* ------------------------- */
35082. # End. ;-) (Return to caller lovely nubes, only MyD's get executed.)
35083. 
35084. 
