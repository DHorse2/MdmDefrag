# See the 'MyDefrag.log' file for information intended for endusers. This is the debug
# logfile. The contents is highly technical and not documented. See the 'Debug' setting
# or the '-d' commandline option to control the level of information in this file.
#
Version: MyDefrag v4.3.1 for X64
Date: 2021/11/09 20:22:47
Windows version: v6.2 build 9200 
Commandline: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily\DefragDevDiskDaily.MyD" 
Working Directory: G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily
Userid: david
InstallPath = C:\Program Files\MyDefrag v4.3.1\
20:22:47 Comment error in script 'G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily\DefragDevDiskDaily.MyD' at line 11910 column 1.

The comment has no end, it was started but not finished.
20:23:58 Script:
  1. # MyDefrag v4.0 script: Development Volume Daily defrag
  2. #
  3. # This script is part of the standard Mdm Volume configuration
  4. # Author: David G. Horsman (DBA MacroDM) (C) 2019
  5. # based on MyDefrag distribution.
  6. 
  7. /* Development Volume Daily*/
  8. SetVariable(RunStepDescription,"Dev Vol Daily")
  9. # Script: DisplaySetRun
 10. 
 11. SetVariable(RunStepDescription,			"!RunStepDescription! - DefragDevDiskDaily")
 12. SetVariable(SeverStepDescription,		"")
 13. SetVariable(VolumeStepDescription,		"")
 14. SetVariable(ZoneStepDescription,		"")
 15. SetVariable(FileStepDescription,		"")
 16. 
 17. SetVariable(VolumeStatisticsDetail, 	"")
 18. 
 19. SetVariable(ZoneListByLine, 			"Run start.")
 20. SetVariable(ZoneStepByLine, 			"")
 21. 
 22. # Script: BannerSet
 23. 
 24. # Script: DisplaySetDateTimeRun
 25. 
 26. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
 27. /* Xinclude "..\Display\BannerSet.MyDc"X */
 28. /* pause(1) */
 29. 
 30. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
 31. 
 32. Title('!Heading!')
 33. /* pause(1) */
 34. 
 35. /* NOTE: Can't round or truncate to integer precision. */
 36. 
 37. pause(2)
 38. 
 39. # This script is part of the standard  disk configuration
 40. # Author: David G. Horsman (DBA MacroDM) (C) 2019
 41. # based on MyDefrag distribution.
 42. 
 43. SetVariable(Heading,"Initializing...")
 44. 
 45. ProcessPriority(Normal)
 46. /* ProcessPriority(Normal) */
 47. 
 48. 
 49. 
 50. ExitIfTimeout(300) // 5 minutes (for old systems), default 120.
 51. /* ExitIfTimeout(300) // 5 minutes (for old systems), default 120. */
 52. 
 53. 
 54. 
 55. # Script: DisplayColors
 56. # MyDefrag color palette.
 57. 
 58. # RGB Color pallets. (Red,Green,Blue).
 59. 
 60. # Basics:
 61. 
 62. # Red			255,	0,		0)			// Red
 63. # Green			0,		255,	0)			// Green
 64. # Blue			0,		0,		255)		// Blue
 65. # Shades:
 66. 
 67. /* (White was left unused for the administrator to highlight things.) */
 68. # White 		255,	255,	255)		// White
 69. # Black			0,		0,		0)			// Black
 70. # Grey 			240,	240,	240)		// Grey
 71. 
 72. # Bright colors and shades:
 73. 
 74. # Purple 		170,	89,		221)		// Purple
 75. # Magenta		255, 	5, 		255)		// Magenta (pinkish)
 76. 
 77. # Pure Yellow 	255,	255,	0)			// Pure yellow
 78. # Yellow 		229, 	229, 	0)			// Yellow
 79. # Light Yellow 	255,	255,	224)		// Light Yellow
 80. 
 81. # Pure Red 		255, 	0, 		0)			// Red
 82. # Red 			204, 	92, 	92)			// Red
 83. # Light red		255,	115,	115)		// Light red
 84. # Orange		255, 	165, 	0)			// Orange
 85. 
 86. # Pure Green	0, 		255, 	0)			// Pure Green (Lime)
 87. # Green			0,		128,	0)			// Green
 88. # Light Green	144,	228, 	144)		// Light Green
 89. # Pale Green	152, 	251, 	152)		// Pale Green
 90. 
 91. # Dark blue		20,		87,		229)		// Dark blue
 92. # Light Blue	175,	198,	247)		// Light Blue
 93. # Bright Blue	0, 		223, 	255)		// Bright Blue
 94. # Light sky blue 135, 	206, 	250)		// Light sky blue
 95. # Deep sky blue	0, 		191, 	255)		// Deep sky blue
 96. 
 97. # Black			0,		0,		0)
 98. # Grey			240,	240,	240)
 99. 
100. # Window Colors
101. SetColor(Empty,										240,  	240, 	240)	// Grey
102. # ???
103. SetColor(Allocated,									45, 	72, 	128)	// Black
104. 
105. # Busy Colours
106. SetColor(BusyRead,									0, 		0, 		0)		// Black
107. SetColor(BusyWrite,									255, 	0, 		0)		// Red
108. 
109. #File Colors
110. SetFileColor(All,									0,		0,		0)		// Black
111. SetFileColor(Movable,								20,		87,		229)	// Dark blue
112. 
113. # Processed
114. SetFileColor(Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
115. SetFileColor(Processed and Fragmented,				170,	89,		221)	// Purple
116. 
117. # Fragmented and NotMovable
118. SetFileColor(Fragmented,							229, 	229, 	0)		// Yellow
119. SetFileColor(not(Movable),							255, 	165, 	0)		// Orange
120. 
121. # Light Green and Yellow
122. SetFileColor(Selected,								152,	251, 	152)	// Light Green
123. SetFileColor(Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
124. SetFileColor(Selected and not(Movable),				255,	115,	115)	// Light red
125. 
126. /* empty */
127. 
128. 
129. 
130. # Processes:
131. 	# This Process
132. 	SetVariable(RunProcessID,ProcessID)
133. 
134. 	# Kill other instances
135. 	/* Kill other MyDefrag Instances. */
136. 	/* Oops! This commits suicide. */
137. 	/* 	RunProgram("..\pskill.exe", "-t MyDefrag.exe") */
138. 	/* Pause(10) */
139. 	
140. 	/* If another instance of MyDefrag is already running then exit. */
141. 	/* Oops again. I don't know if this cause the hidden instance */
142. 	/* to hang around after the run. */
143. 	/* Warning: <alt><Run><Exit> seems to hide the instance not end it. */
144. 	/* The task mananager may be needed. This is under investigation. */
145. 
146. 	# OtherInstances
147. 	
148. OtherInstances(exit)
149. 
150. # OtherInstances
151. 	
152. # OtherInstances(exit)
153. 
154. 
155. 
156. 	# StatusBar
157. 	StatusBar(Status Path MouseOver)
158. 	# Script: DisplayStatusBar
159. # OtherInstances
160. 	
161. # OtherInstances(exit)
162. 
163. 	
164. 	# Power management
165. 	/* SetScreenPowerSaver(off) */
166. 	# Power management
167. 
168. 	/* SetScreenPowerSaver(off) */
169. 
170. 	# Power management
171. 
172. 	/* SetScreenPowerSaver(off) */
173. 
174. 
175. 
176. 
177. /* ---------------------------------------------------------- */
178. # Script Directory Location:
179. SetVariable(ScriptDir,"..\")
180. 
181. /* SetVariable(ScriptDir,"..\") */
182. /* SetVariable(ScriptDir,"G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily") */
183. /* SetVariable(ScriptDir,"E:\Ide\MyDefrag\MyDefrag\MdmScriptMyDefragVs4_3_1\") */
184. 
185. 
186. 
187. /* ---------------------------------------------------------- */
188. # DISPLAY - What text is displayed in Titlebar, data fields and reports.
189. 
190. 
191. /* The variable FileStepDescription get set to */
192. /* the messages below according to the Zone File */
193. /* step the defrag is on. */
194. 
195. /* The titlebar is organized in these areas: */
196. 
197. /* SwProductVs. */
198. /* Volume description. */
199. /* Zone description. */
200. /* File Processing Step (here.) */
201. /* Server and Script names. */
202. /* Run Date, Time and Elapsed (Bug) */
203. 
204. /* Shown in the Title / Banner / App Heading */
205. 
206. SetVariable(SeverStepDescription,	"")
207. SetVariable(VolumeStepDescription,	"")
208. SetVariable(ZoneStepDescription,	"")
209. SetVariable(FileStepDescription,	"")
210. SetVariable(RunStepDescription,		"")
211. 
212. # Display fields you can set for your personal tastes / needs:
213. 
214. /* ---------------------------------------------------------- */
215. # ZONE. Process One Zone (the steps and messages displayed. */
216. 
217. SetVariable(FileStepDescriptionZoneStart, 			"Zone started.")
218. 
219. /* "Your Zone Pre (before)Processing." */
220. SetVariable(FileStepDescriptionYourZonePre, 		"!FileStepDescriptionZoneStart!") 		
221. 
222. SetVariable(FileStepDescriptionFileSelect,			"Selecting Files.")
223. 
224. /* "Your Pre Sort File Actions." */
225. SetVariable(FileStepDescriptionYourFileActionsPre, 	"!FileStepDescriptionFileSelect!")
226. 
227. SetVariable(FileStepDescriptionFileActionStart, 	"File Actions started.")
228. 
229. /* "Your Post Sort File Actions." */
230. SetVariable(FileStepDescriptionYourFileActionsPost, "!FileStepDescriptionFileActionStart!")
231. 
232. SetVariable(FileStepDescriptionFileActionEnd, 		"File Actions completed.")
233. 
234. /* "Your Zone Post (after) Processing." */
235. SetVariable(FileStepDescriptionYourZonePost, 		"!FileStepDescriptionFileActionEnd!") 		
236. 
237. SetVariable(FileStepDescriptionFileActionGap, 		"Calculating Gap.")
238. 
239. SetVariable(FileStepDescriptionZoneEnd, 			"Zone finished.")
240. 
241. /* Pattern: SetVariable(FileStepDescriptionXXX, 	"FileStepDescriptionXXX") */
242. 
243. /* Note: If you add custom script code in the PRE and POST areas then at that */
244. /* time you fill in the messages above as appropriate. */
245. 
246. /* empty */
247. 
248. /* ---------------------------------------------------------- */
249. # Regarding Volume Names/Labels
250. 
251. /* FYI. The Volume names / drive letters need to be correct for your system. */
252. /* It is repeated here for infomation about fields used above. */
253. /* Set your values in "SettingsYours\SettingsYoursVolumeNames.MyDc" */
254. 
255. 	/* SetVariable(VolumeSys,"!VolumeNamePrefix!Sys") */
256. 	/* SetVariable(VolumeDev,"!VolumeNamePrefix!Dev") */
257. 	/* SetVariable(VolumeData,"!VolumeNamePrefix!Data") */
258. 	/* SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive") */
259. 
260. 	/*		or just */
261. 			
262. 	/* SetVariable(VolumeSys,"C:") */
263. 	/* SetVariable(VolumeDev,"E:") */
264. 
265. /* ---------------------------------------------------------- */
266. # BANNER DEFINITION
267. /* SetVariable(Heading, "Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! || !FileStepDescription! ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskDaily on 2021-11-09 20:22:41 0:00:00") */
268. 
269. # How to build them: (documentation)
270. 
271. /* Here is how is one pattern not used: */
272. /* SetVariable(Heading, "|") */
273. /* SetVariable(Heading, "!Heading! Vol: !VolumeStepDescription!") */
274. /* SetVariable(Heading, "!Heading! Zone: !ZoneStepDescription!") */
275. /* SetVariable(Heading, "!Heading! !FileStepDescription!") */
276. /* SetVariable(Heading, "!Heading!  ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskDaily") */
277. /* SetVariable(Heading, " on 2021-11-09 20:22:41 0:00:00") */
278. /* SetVariable(Heading, "!Heading!|") // spacers. */
279. 
280. /* A typical banner field list: */
281. # Appearing in Title('Vol: !
282. # VolumeCurrent
283. # ! Zone: !
284. # ZoneCurrentDescription
285. # ! !
286. # ZoneCurrent
287. # ! of !
288. # ZoneCount
289. # ! || Free: Vol: !
290. # VolumeFreePerUsed
291. # !% Zone: !
292. # ZoneFreePerUsed
293. # !% || Script: !
294. # ScriptTitle
295. # ! System: !
296. # VolumeNamePrefix
297. # ! !
298. # ServerNameFull
299. # ! !
300. # Date
301. # ! !
302. # Time
303. # ! !
304. # RunTime
305. # !')
306. /* . */
307. 
308. 
309. /* Progress Display */
310. SetVariable(ZoneListByLine, 	"Volume start.")
311. SetVariable(ZoneStepByLine, 	"")
312. 
313. /* There is 6 digit decimal precision so by using */
314. /* 1Mb the full number is displayed in a much more */
315. /* readable form. */
316. 
317. SetVariable(DisplayUnitDivisor, 	1000000) // 1MB.
318. 
319. /* ---------------------------------------------------------- */
320. # SERVER INFORMATION
321. 
322. 	/* ServerName (IE. Computer name or number.) not used. */
323. 	/* System99 */
324. 		# SetVariable(ServerName,"Pc15")
325. 
326. 		# Server Names
327. 
328. # ???
329. 
330. # IMPORTANT: ServerName NAME: 
331. 
332. 	# SetVariable(ServerName,"PcAny")
333. 
334. # IMPORTANT: ServerName NAME: 
335. 
336. 	# SetVariable(ServerName,"PcAny")
337.     /* System99 */
338. # SET
339. SetVariable(ServerName,"RavenPc")
340. 
341. 
342. 	
343. 	/* Descriptive Information so maybe */
344. 	/* VolumeNamePrefix (IE. Person or company initials) not used. */
345. 	/* "Xyz" */
346. 		# SetVariable(VolumeNamePrefix,"Mdm")
347. 
348. 		# VolumeNamePrefix
349. 
350. /* Descriptive Information so maybe */
351. /* VolumeNamePrefix (IE. Person or company initials) not used. */
352. /* "Xyz" */
353. 	SetVariable(VolumeNamePrefix,"VolThis")
354. 
355. 	
356. /* Descriptive Information so maybe */
357. /* VolumeNamePrefix (IE. Person or company initials) not used. */
358. /* "Xyz" */
359. 	SetVariable(VolumeNamePrefix,"Vol")
360. 
361. /* Server name full is usually the server and computer combined. not used. */
362. 	SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
363. 
364. 
365. 	/* Server name full is usually the server and computer combined. not used. */
366. 
367. 		SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
368. 	
369. 	# Script: DisplaySetServer
370. # (Volume)
371. SetVariable(SeverStepDescription, 	"!ServerNameFull!")
372. SetVariable(VolumeStepDescription, 	"")
373. SetVariable(ZoneStepDescription, 	"")
374. SetVariable(FileStepDescription, 	"")
375. # Script: BannerSet
376. 
377. # Script: DisplaySetDateTimeRun
378. 
379. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
380. /* Xinclude "..\Display\BannerSet.MyDc"X */
381. /* pause(1) */
382. 
383. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
384. 
385. Title('!Heading!')
386. /* pause(1) */
387. 
388. /* NOTE: Can't round or truncate to integer precision. */
389. 
390. /* pause(2) */
391. 
392. /* ---------------------------------------------------------- */
393. # VOLUMES
394. /* ---------------------------------------------------------- */
395. 
396. 	# Volume Do Current Clear
397. 
398. /* ---------------------------------------------------------- */
399. # Current Values.
400. 	SetVariable(VolumeLabel, "NotSet")
401. 	SetVariable(VolumeDescription, "")
402. 
403. 	SetVariable(VolumeCount, 0)
404. 	SetVariable(VolumeNoCurrent, 0)
405. 	SetVariable(VolumeNoAdjCurrent, 0)
406.   	SetVariable(VolumeCurrentAjust, 0) // not used
407. 
408. /* ---------------------------------------------------------- */
409. # OS Disk Usage.
410. 
411. /* Percentage of disk used by OS */
412. 
413. 	SetVariable(OsPer, 0.18)
414. 
415. 	     SetVariable(ZoneCountOs, 5)
416. 
417.        SetVariable(ZoneCountType, 0) // not used
418.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
419. 
420. 	    SetVariable(ZoneCountSys, 2)
421. 	    SetVariable(ZoneCountDev, 7)
422. 
423. 	   SetVariable(ZoneCountData, 0)
424. 	SetVariable(ZoneCountArchive, 0)
425. 	
426. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
427. 
428. /* ---------------------------------------------------------- */
429. # Volume Totals
430. 	# USED:
431. 	/* Current total volume space used */
432. 	SetVariable(VolumeZoneUsed, 			0)
433. 	/* percentage */
434. 	SetVariable(VolumeZoneUsedPer, 			0)
435. 
436. 	# FREE:
437. 	/* Current total of free space used */
438. 	SetVariable(VolumeFreeRequested, 		0)
439. 	/* percentage */
440. 	SetVariable(VolumeFreeRequestedPer, 	0)
441. 
442. 	/* Current total of free space used */
443. 	SetVariable(VolumeFreeUsed, 			0)
444. 	/* percentage */
445. 	SetVariable(VolumeFreeUsedPer, 			0)
446. 	
447. /* ---------------------------------------------------------- */
448. # Volume Free Space Proportional Used Space vs Volume Size.
449. 	/* We only want to use a ratio of the free space relative to the volume. */
450. 	/* We could just use percentages of the total free space as well. */
451. 
452. 	/* SetVariable(VolumeFreeAdj, 		1) */
453. 	
454. 	SetVariable(VolumeFreeAdj,				(VolumeFree * (VolumeUsed / VolumeSize)))
455. 
456. /* ---------------------------------------------------------- */
457. # ZONES
458. 
459. 	SetVariable(ZoneNoCurrent, 0)
460. 	SetVariable(ZoneNoAdjCurrent, 0)
461. 	SetVariable(ZoneCurrentAjust, 0)
462. 
463. 	# Script: ZoneDoCurrentClear
464. 
465. SetVariable(ZoneTypeSelectCurrent, 		"")
466. 
467. SetVariable(ZoneBeginCurrent, 			0)
468. SetVariable(ZoneBeginPerCurrent, 		0)
469. SetVariable(ZoneEndCurrent, 			0)
470. SetVariable(ZoneEndPerCurrent, 			0)
471. 
472. SetVariable(ZoneSizeCurrent,			0)
473. SetVariable(ZoneSizePerCurrent,			0)
474. 
475. SetVariable(ZoneGapRequestedCurrent,	0)
476. SetVariable(ZoneGapRoundedCurrent, 		0)
477. SetVariable(ZoneGapAdjustedCurrent, 	0)
478. SetVariable(ZoneGapAvailableCurrent, 	0)
479. SetVariable(ZoneGapCurrent,				0)
480. SetVariable(ZoneGapUsedCurrent, 		0)
481. 
482. SetVariable(ZoneGapActualCurrent, 		0)
483. SetVariable(ZoneGapActualPerCurrent, 	0)
484. 
485. SetVariable(ZoneSizeActual, 			0)
486. SetVariable(ZoneSizeActualCurrent,		0)
487. 
488. SetVariable(ZoneEndActual, 				0)
489. SetVariable(ZoneEndActualCurrent,		0)			
490. SetVariable(ZoneSizeActualPerCurrent, 	0)
491.       
492. SetVariable(ZoneFilesFolders,			0)
493. SetVariable(ZoneFilesFoldersPer,		0) 
494. 
495. SetVariable(ZoneFragments,				0)
496. SetVariable(ZoneFragmentsPer,			0) 
497. 		
498. SetVariable(ZoneEndActualCurrent, 		0)
499. SetVariable(ZoneEndActualPerCurrent, 	0)
500. 
501. # Gap Calculation Methodology:
502. 	# Requested
503. 	SetVariable(GapRequested, 			0) 
504. 	SetVariable(GapRequestedStd, 		0) 
505. 	SetVariable(GapRequestedMft, 		0) 
506. 	SetVariable(GapRequestedOs, 		0) 
507. 	SetVariable(GapRequestedOriginal, 	0) 
508. 	
509. 	# Gap Adjustments
510. 	SetVariable(GapRounded, 			0)
511. 	# SetVariable(GapAdjusted, 			0)
512. 	SetVariable(GapAvailable, 			0)
513. 	SetVariable(GapCurrent, 			0)
514. 	SetVariable(GapActual, 				0)
515. 	SetVariable(GapUsed, 				0)
516. 	
517. 	# Gap Adjustments
518. 	SetVariable(GapRoundedLoc, 			0)
519. 	# SetVariable(GapAdjustedLoc, 		0)
520. 	SetVariable(GapAvailableLoc, 		0)
521. 	SetVariable(GapCurrentLoc, 			0)
522. 	SetVariable(GapActualLoc,			0)
523. 	SetVariable(GapUsedLoc,				0)
524. 	
525. 	# Space usage
526. 	SetVariable(ZoneFreePerRequested, 	0)
527. 	SetVariable(ZoneFreePerUsed, 		0)
528. 
529. # Gap Size & Rounding
530. 	SetVariable(ZoneGapSizePer, 		0)
531. 	SetVariable(ZoneVolRoundUpPer, 		0)
532. 	
533. 	# Free Space
534. 	SetVariable(ZoneFreeUsedPer, 		0)
535. 	SetVariable(ZoneFreeRequestedPer, 	0)
536. 
537. 
538. 	SetVariable(ZoneLabel, "Volume")
539. 	SetVariable(ZoneDescription, "Analysis...")
540. 	# Script: BannerSet
541. 
542. # Script: DisplaySetDateTimeRun
543. 
544. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
545. /* Xinclude "..\Display\BannerSet.MyDc"X */
546. /* pause(1) */
547. 
548. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
549. 
550. Title('!Heading!')
551. /* pause(1) */
552. 
553. /* NOTE: Can't round or truncate to integer precision. */
554. 
555. 
556. 	
557. 	  
558. 	SetVariable(VolumeLabel, "NotSet")
559. 	SetVariable(VolumeDescription, "")
560. 
561. 	SetVariable(FileStepDescription,"Initializing run...")
562. 	# Script: BannerSet
563. 
564. # Script: DisplaySetDateTimeRun
565. 
566. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
567. /* Xinclude "..\Display\BannerSet.MyDc"X */
568. /* pause(1) */
569. 
570. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
571. 
572. Title('!Heading!')
573. /* pause(1) */
574. 
575. /* NOTE: Can't round or truncate to integer precision. */
576. 
577. 
578. /* ---------------------------------------------------------- */
579. # VOLUME TYPES
580. 
581. 	/* Volumes */
582. 	/* . */
583. 	/* Only those were fully implemented: */
584. 	/* Sys */
585. 	/* Dev */
586. 	/* . */
587. 	/* Common types of volumes: */
588. 	/* Data */
589. 	/* Archive */
590. 	/* . */
591. 	/* Other historical volumes: */
592. 	/* Test */
593. 	/* Live */
594. 	/* Server */
595. 	/* Client */
596. 	/* SysUtils */
597. 	/* . */
598. 
599. # IMPORTANT: VOLUME NAME: SET YOUR:
600. 	/* VOLUME NAMES IN SettingsYours\SettingsYoursVolumeNames.MyDc */
601. 	/* 		or    			*/
602. 	/* VOLUME NAME (one only for override) in SettingsYours\SettingsYoursVolume.MyDc */
603. 	/* 		or here also 	*/
604. 	SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
605. 	SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
606. 
607. 	/* SetVariable(VolumeSys,"C:") */
608. 	/* SetVariable(VolumeDev,"E:") */
609. 
610. 	/* These are for dedicated disks. */
611. 	/* So it means JUST Data or JUST Archives. */
612. 
613. 	SetVariable(VolumeData,"!VolumeNamePrefix!Data")
614. 	SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
615. 	
616. 	# IMPORTANT: VOLUME NAME: 
617. 
618. 	# SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
619. 	# SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
620. 	# SetVariable(VolumeData,"!VolumeNamePrefix!Data")
621. 	# SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
622. 
623. 	#    or this:
624. 	
625. 	
626. 	SetVariable(VolumeSys,"C:")
627. 	SetVariable(VolumeDev,"C:")
628. 	SetVariable(VolumeData,"C:")
629. 	SetVariable(VolumeArchive,"C:")
630. 
631. 
632. # SET
633. # SetVariable(VolumeSys,"C:")
634. 
635. 
636. 
637. /* ---------------------------------------------------------- */
638. # OS Disk Usage.
639. /* Percentage of disk used by OS */
640. 
641. 	SetVariable(OsPer, 0.18)
642. 
643. 	     SetVariable(ZoneCountOs, 5)
644. 
645.        SetVariable(ZoneCountType, 0) // not used
646.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
647. 
648. 	    SetVariable(ZoneCountSys, 2)
649. 	    SetVariable(ZoneCountDev, 7)
650. 
651. 	   SetVariable(ZoneCountData, 0)
652. 	SetVariable(ZoneCountArchive, 0)
653. 	
654. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
655. 
656. /* ---------------------------------------------------------- */
657. # ZONE TYPES. 
658. /* ---------------------------------------------------------- */
659. 	/* Type Labels, Descriptions, Gaps and Rounding. */
660. 	/* Load the Zone Definitions */
661. 	/* These are file categories basically */
662. 	/* and are maintained in a single file */
663. 	/* for ease of maintenance. Here: */
664. 	
665. 	/* ---------------------------------------------------------- */
666. # ROUNDING factors:
667. 
668. /* HERE if you want to tweak how type the Gaps are if growth is slow. */
669. /* HERE if your DISK IS VERY FULL */
670. /* This is where you can tweak growth rounding if the Volume gets really full. */
671. /* You don't have to use these, you can use actual percentages in the Zone section. */
672. 
673. /* Note: Volume and Gap Sizes are paired to a degree and */
674. /* set relative to each other. */
675. 	
676. 	      SetVariable(VolumeRoundUpNone, 	1)
677. 	      SetVariable(VolumeRoundUpTiny, 	0.005)
678. 	     SetVariable(VolumeRoundUpSmall, 	0.01)
679. 	    SetVariable(VolumeRoundUpMedium, 	0.02)
680. 	     SetVariable(VolumeRoundUpLarge, 	0.03)
681. 	SetVariable(VolumeRoundUpExtraLarge, 	0.05)
682. 	
683. 	    SetVariable(VolumeRoundUpBlogBu, 	0.10)
684. 	
685. 	      SetVariable(ZoneGapSizeNone, 		0)
686. 	      SetVariable(ZoneGapSizeTiny, 		0.005)
687. 	     SetVariable(ZoneGapSizeSmall, 		0.01)
688. 	    SetVariable(ZoneGapSizeMedium, 		0.05)
689. 	     SetVariable(ZoneGapSizeLarge, 		0.10)
690. 	SetVariable(ZoneGapSizeExtraLarge, 		0.15)
691. 		
692. 	    SetVariable(ZoneGapSizeBlobBu, 		0.10)
693. 
694. /* ---------------------------------------------------------- */
695. # ZONE SETTINGS:
696. /* ---------------------------------------------------------- */
697. /* These are the Zone Names */
698. /* Regular is at the end but otherwise */
699. /* this is in the order they appear on disk */
700. 
701. # Os Programs.
702. SetVariable(ZoneLabelBoot, 				"Boot")
703. SetVariable(ZoneLabelBootData, 				"BootData")
704. SetVariable(ZoneLabelProgramHints,			"ProgramHints")
705. SetVariable(ZoneLabelProgramHintsData,			"ProgramHintsData")
706. SetVariable(ZoneLabelPrograms,				"Programs")
707. SetVariable(ZoneLabelProgramsWindows,			"ProgramsWindows")
708. SetVariable(ZoneLabelProgramsData,			"ProgramsData")
709. # Moved to after Mft & Dir.
710. SetVariable(ZoneLabelPageHiperDump,			"PageHiperDump")
711. 
712. # Os Mft & Directories.
713. SetVariable(ZoneLabelMft,				"MFT")
714. SetVariable(ZoneLabelDir,				"DIR")
715. 
716. # Standard Zones.
717. SetVariable(ZoneLabelIdeScripts, 			"IdeScripts")
718. SetVariable(ZoneLabelDevToDo, 				"DevToDo")
719. SetVariable(ZoneLabelLinksCorp, 			"LinksCorp")
720. SetVariable(ZoneLabelPeople, 				"People")
721. # MFT.
722. # DIR.
723. # Games. 
724. SetVariable(ZoneLabelGames, 				"Games")
725. SetVariable(ZoneLabelShares, 				"Shares")
726. SetVariable(ZoneLabelSystemOtherData, 			"SystemOtherData")
727. SetVariable(ZoneLabelReference, 			"Reference")
728. 
729. 
730. # Sys.
731. # People.
732. # OS, Mft, Dir.
733. # Games.
734. SetVariable(ZoneLabelRegular, 				"Regular")
735. 
736. # Common.
737. SetVariable(ZoneLabelSpaceHogs, 			"SpaceHogs")
738. SetVariable(ZoneLabelArchivesBu, 			"ArchivesBu")
739. 
740. /* ---------------------------------------------------------- */
741. /* Use however you like */
742. 
743. # Os Programs.
744. SetVariable(ZoneDescriptionBoot, 			"!ZoneLabelBoot!")
745. SetVariable(ZoneDescriptionBootData, 			"!ZoneLabelBootData!")
746. SetVariable(ZoneDescriptionProgramHints, 		"!ZoneLabelProgramHints!")
747. SetVariable(ZoneDescriptionProgramHintsData, 		"!ZoneLabelProgramHintsData!")
748. SetVariable(ZoneDescriptionPrograms, 			"!ZoneLabelPrograms!")
749. SetVariable(ZoneDescriptionProgramsWindows, 		"!ZoneLabelProgramsWidows!")
750. SetVariable(ZoneDescriptionProgramsData, 		"!ZoneLabelProgramsData!")
751. SetVariable(ZoneDescriptionPageHiperDump, 		"!ZoneLabelPageHiperDump!")
752. 
753. # Os Mft & Directories.
754. SetVariable(ZoneDescriptionMft, 			"!ZoneLabelMft!")
755. SetVariable(ZoneDescriptionDir, 			"!ZoneLabelDir!")
756. 
757. # Standard Zones:
758. SetVariable(ZoneDescriptionIdeScripts, 			"!ZoneLabelIdeScripts!")
759. SetVariable(ZoneDescriptionDevToDo, 			"!ZoneLabelDevToDo!")
760. SetVariable(ZoneDescriptionLinksCorp, 			"!ZoneLabelLinksCorp!")
761. SetVariable(ZoneDescriptionPeople, 			"!ZoneLabelPeople!")
762. # MFT.
763. # DIR.
764. # Games. 
765. SetVariable(ZoneDescriptionGames, 			"!ZoneLabelGames!")
766. SetVariable(ZoneDescriptionShares, 			"!ZoneLabelShares!")
767. SetVariable(ZoneDescriptionSystemOtherData, 		"!ZoneLabelSystemOtherData!")
768. SetVariable(ZoneDescriptionReference, 			"!ZoneLabelReference!")
769. 
770. # Sys.
771. # People.
772. # OS, Mft, Dir.
773. SetVariable(ZoneDescriptionRegular, 			"!ZoneLabelRegular!")
774. 
775. SetVariable(ZoneDescriptionSpaceHogs, 			"!ZoneLabelSpaceHogs!")
776. SetVariable(ZoneDescriptionArchivesBu, 			"!ZoneLabelArchivesBu!")
777. 
778. /* ---------------------------------------------------------- */
779. /* This rounds up to even locations on the volume to keep */
780. /* the location of data relatively stable during fluctuation. */
781. 
782. /* NOTE: For Volume specifice settings you would have to copy these */
783. /* next two sections and use them in the SettingsYours\SettingsYours for each Volume. */
784. /* You would need a copy of these two to use in a Reset function between Volumes. */
785. 
786. # Os Programs.
787. SetVariable(ZoneVolRoundUpBoot, 		"!VolumeRoundUpSmall!")
788. SetVariable(ZoneVolRoundUpProgramHints, 	"!VolumeRoundUpSmall!")
789. SetVariable(ZoneVolRoundUpPrograms, 		"!VolumeRoundUpMedium!")
790. SetVariable(ZoneVolRoundUpPageHiperDump,	"!VolumeRoundUpSmall!")
791. 
792. # Os Mft & Directories.
793. SetVariable(ZoneVolRoundUpMft,			"!VolumeRoundUpTiny!")
794. SetVariable(ZoneVolRoundUpDir,		 	"!VolumeRoundUpLarge!")
795. 
796. # Standard Zones.
797. SetVariable(ZoneVolRoundUpIdeScripts, 		"!VolumeRoundUpSmall!")
798. SetVariable(ZoneVolRoundUpDevToDo, 		"!VolumeRoundUpSmall!")
799. SetVariable(ZoneVolRoundUpLinksCorp, 		"!VolumeRoundUpSmall!")
800. SetVariable(ZoneVolRoundUpPeople, 		"!VolumeRoundUpMedium!")
801. # MFT.
802. # DIR.
803. # Games. 
804. # ToDo.............
805. SetVariable(ZoneVolRoundUpGames, 		"!VolumeRoundUpSmall!")
806. SetVariable(ZoneVolRoundUpShares, 		"!VolumeRoundUpSmall!")
807. SetVariable(ZoneVolRoundUpSystemOtherData, 	"!VolumeRoundUpSmall!")
808. SetVariable(ZoneVolRoundUpReference, 		"!VolumeRoundUpMedium!")
809. 
810. # Sys.
811. # People.
812. # OS, Mft, Dir.
813. # Games.
814. SetVariable(ZoneVolRoundUpRegular, 		"!VolumeRoundUpMedium!")
815. 
816. # Common.
817. SetVariable(ZoneVolRoundUpSpaceHogs, 		"!VolumeRoundUpMedium!")
818. SetVariable(ZoneVolRoundUpArchivesBu, 		"!VolumeRoundUpTiny!")
819. 
820. /* ---------------------------------------------------------- */
821. /* Your Zone Gap consumption of free space as a percentage. */
822. /* Clearly this can not exceed 100%. Keep it under 99%. */
823. 
824. # Os Programs.
825. SetVariable(ZoneGapSizeBoot, 				"!ZoneGapSizeTiny!")
826. SetVariable(ZoneGapSizeProgramHints,	 		"!ZoneGapSizeTiny!")
827. SetVariable(ZoneGapSizePrograms, 			"!ZoneGapSizeSmall!")
828. SetVariable(ZoneGapSizePageHiperDump, 			"!ZoneGapSizeSmall!")
829. 
830. # Mft & Directories.
831. SetVariable(ZoneGapSizeMft, 				"!ZoneGapSizeTiny!")
832. SetVariable(ZoneGapSizeDir,		 		"!ZoneGapSizeTiny!")
833. 
834. # Standard Zones.
835. SetVariable(ZoneGapSizeIdeScripts, 			"!ZoneGapSizeMedium!")
836. SetVariable(ZoneGapSizeDevToDo, 			"!ZoneGapSizeMedium!")
837. SetVariable(ZoneGapSizeLinksCorp, 			"!ZoneGapSizeMedium!")
838. SetVariable(ZoneGapSizePeople, 				"!ZoneGapSizeMedium!")
839. # MFT.
840. # DIR.
841. # Games. 
842. # ToDo.............
843. SetVariable(ZoneGapSizeGames, 				"!ZoneGapSizeMedium!")
844. SetVariable(ZoneGapSizeShares, 				"!ZoneGapSizeMedium!")
845. SetVariable(ZoneGapSizeSystemOtherData, 		"!ZoneGapSizeMedium!")
846. SetVariable(ZoneGapSizeReference, 			"!ZoneGapSizeSmall!")
847. 
848. # Sys.
849. # People.
850. # OS, Mft, Dir.
851. # Games.
852. SetVariable(ZoneGapSizeRegular, 			"!ZoneGapSizeMedium!")
853. 
854. # Common.
855. SetVariable(ZoneGapSizeSpaceHogs, 			"!ZoneGapSizeMedium!")
856. SetVariable(ZoneGapSizeArchivesBu, 			"!ZoneGapSizeTiny!")
857. 
858. /* ---------------------------------------------------------- */
859. # ZONE CALCULATION METHODS:
860. # OS ZONE SETTINGS:
861. /* ---------------------------------------------------------- */
862. 
863. 	/* ---------------------------------------------------------- */
864. 	# VOLUME MFT Location.
865. 	/* The Volume Location of the MFT as a percentage of the Volume. */
866. 		
867. 		SetVariable(MftVolumeRoundUp, 		"!VolumeRoundUpLarge!")
868. 		SetVariable(MftVolumeGapSize, 		"!ZoneGapSizeTiny!")
869. 		
870. 		# MFT CALCULATION METHODS.
871. 			# STANDARD Method.
872. 			/* IMPORTANT: Standard method currently in use. */
873. 			/* IE: The others below are ignored but instructive. */
874. 			/* None of the following settings are used, hence zero. */
875. 			SetVariable(MftPer, 			0)
876. 			SetVariable(MftLocation, 		0)
877. 			
878. 			# MFT Method.
879. 			/* Place files at X% (MftPerSys) into the data on the Volume. */
880. 			/* This is really tied the ratio of executables to data and blobs. */
881. 			# SetVariable(MftPer, 			0.30)
882. 			# SetVariable(MftLocation, 		1000000000)
883. 			# SetVariable(MftGapSize, 		"!ZoneGapSizeLarge!")
884. 		
885. 			# FIXED Method.
886. 			# SetVariable(MftLocation, 		1000000000) // (IE. Yours)
887. 			# SetVariable(MftPer, 			MftLocation / VolumeSize)
888. 			
889. 			# ORIGINAL Method.
890. 			/* DEPRECIATED, not in use. */
891. 			/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
892. 			# SetVariable(MftPer, 			0.30)
893. 		
894. 		# ROUNDING.	
895. 		# SetVariable(MftLocation,			RoundUp(MftLocation, VolumeSize * MftVolumeRoundUp))
896. 		
897. 		# MFT ZONE.
898. 		/* Zone Number (not used for locating MFT.) */
899. 		SetVariable(MftZone, 				4) // Insert before this zone, info only.
900. 		/* Zone 10 on the Dev Volume */
901. 	
902. 	/* ---------------------------------------------------------- */
903. 	# VOLUME SPECIFIC MFT.
904. 	/* Note: You may need to set Volume specific values for the MFT location, */
905. 	/* On these volume types do not "push" the data above the MFT table? */
906. 	/* You can use a standard gap instead. */
907. 		
908. 			/* The current Volume Type Mft Percentage */
909. 		    # SetVariable(MftPer, 				0)
910. 		    # SetVariable(MftPerTypedDefault, 			"!MftPer!")
911. 			# Volume Types:	
912. 			#         SetVariable(MftPerSys, 		0.35)
913. 			# 	    SetVariable(MftPerDev, 		0.10)
914. 			# 	   SetVariable(MftPerData, 		0.35)
915. 			# 	SetVariable(MftPerArchive, 		0.10)
916. 	
917. 	/* ---------------------------------------------------------- */
918. 	# VOLUME DIR Location.
919. 	/* The amount of Gap between Mft and Dir's, the Location of DIR. */
920. 	
921. 		/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
922. 	
923. 		SetVariable(DirVolumeRoundUp, 		"!VolumeRoundUpLarge!")
924. 		SetVariable(DirVolumeGapSize, 		"!ZoneGapSizeLarge!")
925. 		
926. /* ---------------------------------------------------------- */
927. # SETTINGS YOURS
928. /* empty */
929. 
930. /* ---------------------------------------------------------- */
931. 
932. /* ---------------------------------------------------------- */
933. # STATISTICS
934. /* ---------------------------------------------------------- */
935. 
936. /* Xinclude "..\StatisticsInitialization.MyDc"X ToDo */
937. 
938. 
939. /* ---------------------------------------------------------- */
940. # GAPS
941. 	# TEST (FAILED!!!) NO BOOLEAN LOGIC AVAILABLE.
942. 	SetVariable(FlagDoNotVacate, 0)
943.  
944. /* ---------------------------------------------------------- */
945. # ZONE
946. 	SetVariable(ZoneNoCurrent, 		0)
947. 	SetVariable(ZoneNoAdjCurrent, 	0) 
948. 	SetVariable(ZoneCurrentAjust,	0)
949. 
950. 	SetVariable(ZoneListByLine, 		"Volume started.
951. ")
952. 	SetVariable(ZoneStepByLine, 		"Initialize.
953. ")
954. 	SetVariable(ZoneStatisticsDetail, 	"")
955. 
956. /* ---------------------------------------------------------- */
957. # ZONE FILE STEP (ACTIONS)
958. 	/* Nothing to set here */
959. 
960. /* ---------------------------------------------------------- */
961. # BLOB SIZE
962. 
963. 	# Size 10MB
964. 	SetVariable(BlobFileSize, 10000000)
965. 
966. /* ---------------------------------------------------------- */
967. # SKIP BLOCK
968.  
969. /* (important for run efficiency.) */
970. /* FILES: */
971. /* Day Files: 100 */
972. /* Monthly: 500 */
973. /* Yearly: 1M */
974. 
975. 	/* 100 Files - moved most blocks */
976. 	 /* 10 Files - 20211105 (error - not done) */ 
977. 	 /* 10 Files - (20211106) - Current */
978. 	 /* 5 Files - (2021????) - */
979. 	SetVariable(SkipBlockFilesDay, 10)
980. 
981. 	SetVariable(SkipBlockFilesMonth, 500)
982. 	SetVariable(SkipBlockFilesYear, 1000000)
983. 
984. 	/* Current: */
985. 	SetVariable(SkipBlockFiles,"!SkipBlockFilesMonth!")
986. 
987. /* BYTES: */
988. /* Day Bytes: 50MB */
989. /* Month Bytes: 500MB */
990. /* Year Bytes: 5GB */
991. 
992. 	 /* 50 MB Moved most existing blocks */
993. 	 /* 5 MB 20211105 (not done) */ 
994. 	 /* 1 MB 20211105 - Current */
995. 	SetVariable(SkipBlockBytesDay, 1000000)
996. 	/* SetVariable(SkipBlockBytesDay, 50000000) */
997. 
998. 	SetVariable(SkipBlockBytesMonth, 500000000)
999. 	SetVariable(SkipBlockBytesYear, 5000000000)
1000. 
1001. 	/* Current: */
1002. 	SetVariable(SkipBlockBytes,"!SkipBlockBytesMonth!")
1003. 
1004. /* ---------------------------------------------------------- */
1005. # ZONE LOCATION METHODS:
1006. 
1007. # No 1) Standard. You can ignore this section
1008. 	/* Gaps between zones are a percentage of */
1009. 	/* free space auto adjusted to pack the used */
1010. 	/* space closely together and for performance. */
1011. 	
1012. 	/* The calculation will clear the Gap */
1013. 	/* and RoundUp to the fixed value present */
1014. 	
1015. 	SetVariable(ZoneMethodStd, 1)
1016. 
1017. /* The following are NOT FULLY IMPLEMENTED OR TESTED */
1018. # No 2) Mft. Relative to its location.
1019. 	SetVariable(ZoneMethodMft, (0-1))
1020. 
1021. # No 3) Os. Percentages are AFTER OsMftDir Space Used.
1022. 	SetVariable(ZoneMethodOs, (0-1))
1023. 
1024. # No 4) Orginal Mft/Os 1-5.
1025. 	SetVariable(ZoneMethodOrginal, (0-1))
1026. 
1027. # No 5) FIXED ZONES if you used them.
1028. 	
1029. 	SetVariable(ZoneMethodFixed, (0-1))
1030. 	SetVariable(ZoneMethodFixedPer, (0-1))
1031. 
1032. 	/* Not recommended */
1033. 	/* However doing all calcs is informative regarding what */
1034. 	/* Types of Volume data (Zones) exist. */
1035. 	
1036. 	/* Your FIXED calculation method, this can be: */
1037. 	SetVariable(ZoneMethodFixedVariantPer, (0-1))
1038. 	
1039. 	/* 1) Percentage. */
1040. 		/* So when it is 1 or On. */
1041. 		/* Not great but easy to use. */
1042. 		 
1043. 	/* 2) Fixed volume location. */
1044. 		/* When 0 or Off it is a volume location. */
1045. 		/* You will have to change: */
1046. 		/* file item xxxxxxxxx??? */
1047. 	
1048. 	/* FIXED VALUES: */
1049. 		/* SetVariable(ZoneMethodFixed, 1) */
1050. 	
1051. 		# Setting the following to a percentage or number:
1052. 		/* OS */
1053. 	    SetVariable(ZoneOsBoot, 0) // 1
1054. 	    SetVariable(ZoneOsProgramHints, 0) // 2
1055. 	    SetVariable(ZoneOsPrograms, 0) // 3
1056. 	    
1057. 	    /* MFT */
1058. 	    SetVariable(ZoneMft, 0) // Volume dependent
1059. 	    SetVariable(ZoneMftDir, 0) // Volume dependent
1060. 	
1061. 		/* Volume Sys */
1062. 	    # Os 3
1063. 	    # Mft + 2
1064. 	    SetVariable(ZoneSysRegular, 0) // 5
1065. 	    SetVariable(ZoneDevSpaceHog, 0) // 6
1066. 	
1067. 		/* Volume Dev */
1068. 	    # Os 3
1069. 	    SetVariable(ZoneDevDevToDo, 0) // 4
1070. 	    SetVariable(ZoneDevIdeScripts, 0) // 5
1071. 	    SetVariable(ZoneDevLinksCorp, 0) // 6
1072. 	    SetVariable(ZoneDevPeople, 0) // 7
1073. 	    # Mft + 2
1074. 	    SetVariable(ZoneDevShares, 0) // 10
1075. 	    SetVariable(ZoneDevSystemOtherData, 0) // 11
1076. 	    SetVariable(ZoneDevReference, 0) // 12
1077. 	    SetVariable(ZoneDevSpaceHogsArchives, 0) // 13
1078. 	
1079. 		/* Volume Archive not used currently */
1080. 		/* Volume Data not used currently */
1081. 
1082. /* ---------------------------------------------------------- */
1083. # LOGGING:
1084. /* ---------------------------------------------------------- */
1085. 
1086. 	# Log File Name:
1087. 	SetVariable(LogFileName,"Defrag !MdmMyDefrag! 2021-11-09_20:22:41.log")
1088. 	/* SetVariable(LogFileName,"..\Logs\!MdmMyDefrag! 2021-11-09_20:22:41.log") */
1089. 	/* SetVariable(LogFileName,"!ScriptDir!Logs\!MdmMyDefrag! 2021-11-09_20:22:41.log") */
1090. 	/* SetVariable(LogFileName,"Defrag2021-11-09_20:22:41.txt") */
1091. 	/* SetVariable(LogFileName,"$ z Logs\Defrag2021-11-09_20:22:41.txt") */
1092. 	
1093. 	SetVariable(VolumeStatisticsSummary, "Not ready")
1094. 	SetVariable(VolumeStatisticsDetailed, "Not ready")
1095. 
1096. /* ---------------------------------------------------------- */
1097. # OVERRIDES
1098. /* ---------------------------------------------------------- */
1099. 
1100. 	# YOUR SETTINGS Volume overrides:
1101. 	/* empty */
1102. 
1103. 
1104. /* ---------------------------------------------------------- */
1105. # Create Run Log:
1106. 
1107. /* Write the header to the logfile. */
1108. 	# Script: BannerSet
1109. 
1110. # Script: DisplaySetDateTimeRun
1111. 
1112. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
1113. /* Xinclude "..\Display\BannerSet.MyDc"X */
1114. /* pause(1) */
1115. 
1116. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1117. 
1118. Title('!Heading!')
1119. /* pause(1) */
1120. 
1121. /* NOTE: Can't round or truncate to integer precision. */
1122. 
1123. 
1124. 	WriteLogfile("!LogFileName!", "Started.")
1125. 	AppendLogfile("!LogFileName!", ".")
1126. 	# Script: BannerLog
1127. 
1128. AppendLogfile("!LogFileName!", "!Title!")
1129. 
1130. 
1131. 	AppendLogfile("!LogFileName!", ".")
1132. 
1133. /* ---------------------------------------------------------- */
1134. /* Script Information */
1135. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-11-09 20:22:41")
1136. 	AppendLogfile("!LogFileName!", ".")
1137. 	AppendLogfile("!LogFileName!", "Script:")
1138. 	AppendLogfile("!LogFileName!", "DefragDevDiskDaily")
1139. 	AppendLogfile("!LogFileName!", ".")
1140. 	AppendLogfile("!LogFileName!", "Script Directory:")
1141. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1142. 	AppendLogfile("!LogFileName!", ".")
1143. 	AppendLogfile("!LogFileName!", "Log File:")
1144. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1145. 	AppendLogfile("!LogFileName!", ".")
1146. 
1147. /* ---------------------------------------------------------- */
1148. # Run Preprocessing Do Before.
1149. /* empty */
1150. 
1151. 
1152. 
1153. /* SkipBlock Daily: */
1154. SetVariable(SkipBlockFiles,"!SkipBlockFilesDay!")
1155. SetVariable(SkipBlockBytes,"!SkipBlockBytesDay!")
1156. 
1157. # Defrag Development Volume
1158. 
1159. SetVariable(VolumeLabel,"!VolumeDev!")
1160. SetVariable(VolumeDescription,"Development")
1161. # Script: DisplaySetVolume
1162. 
1163. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1164. SetVariable(ZoneStepDescription,	"")
1165. SetVariable(FileStepDescription,	"")
1166. 
1167. SetVariable(ZoneListByLine, 		"Volume started 2021-11-09 20:22:41 0:00:00:
1168. ")
1169. SetVariable(ZoneStepByLine, 		"Pending.")
1170. 
1171. # Script: BannerDescriptionSet
1172. 
1173. # Script: BannerSet
1174. 
1175. # Script: DisplaySetDateTimeRun
1176. 
1177. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
1178. /* Xinclude "..\Display\BannerSet.MyDc"X */
1179. /* pause(1) */
1180. 
1181. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1182. 
1183. Title('!Heading!')
1184. /* pause(1) */
1185. 
1186. /* NOTE: Can't round or truncate to integer precision. */
1187. 
1188. # Script: BannerLog
1189. 
1190. AppendLogfile("!LogFileName!", "!Title!")
1191. 
1192. 
1193. 
1194. pause(2)
1195. 
1196. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1197. 
1198. SetVariable(ZoneListByLine, "")
1199. SetVariable(ZoneFooter, "")
1200. 
1201. # This script is part of the standard disk configuration
1202. # Author: David G. Horsman (DBA MacroDM) (C) 2019
1203. # based on MyDefrag distribution.
1204. 
1205. /* Progress Display */
1206. SetVariable(ZoneListByLine, 	"Volume start.
1207. ")
1208. SetVariable(ZoneStepByLine, 	"
1209. ")
1210. 
1211. # VOLUME INFORMATION
1212. 
1213. SetVariable(VolumeNoCurrent, VolumeNoCurrent + 1)
1214. SetVariable(VolumeNoAdjCurrent, VolumeNoCurrent + VolumeCurrentAjust)
1215. 
1216. SetVariable(ZoneNoCurrent, 		0)
1217. SetVariable(ZoneNoAdjCurrent, 	0) 
1218. SetVariable(ZoneCurrentAjust,	0)
1219. 
1220. SetVariable(ZoneListByLine, 		"Volume started.
1221. ")
1222. SetVariable(ZoneStepByLine, 		"Initialize.
1223. ")
1224. SetVariable(ZoneStatisticsDetail, 	"")
1225. 
1226. SetVariable(ZoneStepNoCurrent, 0)
1227. 
1228. 
1229. # Script: ZoneDoCurrentClear
1230. 
1231. SetVariable(ZoneTypeSelectCurrent, 		"")
1232. 
1233. SetVariable(ZoneBeginCurrent, 			0)
1234. SetVariable(ZoneBeginPerCurrent, 		0)
1235. SetVariable(ZoneEndCurrent, 			0)
1236. SetVariable(ZoneEndPerCurrent, 			0)
1237. 
1238. SetVariable(ZoneSizeCurrent,			0)
1239. SetVariable(ZoneSizePerCurrent,			0)
1240. 
1241. SetVariable(ZoneGapRequestedCurrent,	0)
1242. SetVariable(ZoneGapRoundedCurrent, 		0)
1243. SetVariable(ZoneGapAdjustedCurrent, 	0)
1244. SetVariable(ZoneGapAvailableCurrent, 	0)
1245. SetVariable(ZoneGapCurrent,				0)
1246. SetVariable(ZoneGapUsedCurrent, 		0)
1247. 
1248. SetVariable(ZoneGapActualCurrent, 		0)
1249. SetVariable(ZoneGapActualPerCurrent, 	0)
1250. 
1251. SetVariable(ZoneSizeActual, 			0)
1252. SetVariable(ZoneSizeActualCurrent,		0)
1253. 
1254. SetVariable(ZoneEndActual, 				0)
1255. SetVariable(ZoneEndActualCurrent,		0)			
1256. SetVariable(ZoneSizeActualPerCurrent, 	0)
1257.       
1258. SetVariable(ZoneFilesFolders,			0)
1259. SetVariable(ZoneFilesFoldersPer,		0) 
1260. 
1261. SetVariable(ZoneFragments,				0)
1262. SetVariable(ZoneFragmentsPer,			0) 
1263. 		
1264. SetVariable(ZoneEndActualCurrent, 		0)
1265. SetVariable(ZoneEndActualPerCurrent, 	0)
1266. 
1267. # Gap Calculation Methodology:
1268. 	# Requested
1269. 	SetVariable(GapRequested, 			0) 
1270. 	SetVariable(GapRequestedStd, 		0) 
1271. 	SetVariable(GapRequestedMft, 		0) 
1272. 	SetVariable(GapRequestedOs, 		0) 
1273. 	SetVariable(GapRequestedOriginal, 	0) 
1274. 	
1275. 	# Gap Adjustments
1276. 	SetVariable(GapRounded, 			0)
1277. 	# SetVariable(GapAdjusted, 			0)
1278. 	SetVariable(GapAvailable, 			0)
1279. 	SetVariable(GapCurrent, 			0)
1280. 	SetVariable(GapActual, 				0)
1281. 	SetVariable(GapUsed, 				0)
1282. 	
1283. 	# Gap Adjustments
1284. 	SetVariable(GapRoundedLoc, 			0)
1285. 	# SetVariable(GapAdjustedLoc, 		0)
1286. 	SetVariable(GapAvailableLoc, 		0)
1287. 	SetVariable(GapCurrentLoc, 			0)
1288. 	SetVariable(GapActualLoc,			0)
1289. 	SetVariable(GapUsedLoc,				0)
1290. 	
1291. 	# Space usage
1292. 	SetVariable(ZoneFreePerRequested, 	0)
1293. 	SetVariable(ZoneFreePerUsed, 		0)
1294. 
1295. # Gap Size & Rounding
1296. 	SetVariable(ZoneGapSizePer, 		0)
1297. 	SetVariable(ZoneVolRoundUpPer, 		0)
1298. 	
1299. 	# Free Space
1300. 	SetVariable(ZoneFreeUsedPer, 		0)
1301. 	SetVariable(ZoneFreeRequestedPer, 	0)
1302. 
1303. 
1304. # Script: BannerSet
1305. 
1306. # Script: DisplaySetDateTimeRun
1307. 
1308. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
1309. /* Xinclude "..\Display\BannerSet.MyDc"X */
1310. /* pause(1) */
1311. 
1312. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1313. 
1314. Title('!Heading!')
1315. /* pause(1) */
1316. 
1317. /* NOTE: Can't round or truncate to integer precision. */
1318. 
1319. 
1320. # OVERRIDES
1321. # YOUR SETTINGS Volume overrides:
1322. 
1323. 
1324. # SET
1325. # SetVariable(VolumeSys,"C:")
1326. 
1327. 
1328. # Script: DisplaySetVolume
1329. 
1330. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1331. SetVariable(ZoneStepDescription,	"")
1332. SetVariable(FileStepDescription,	"")
1333. 
1334. SetVariable(ZoneListByLine, 		"Volume started 2021-11-09 20:22:41 0:00:00:
1335. ")
1336. SetVariable(ZoneStepByLine, 		"Pending.")
1337. 
1338. # Script: BannerDescriptionSet
1339. 
1340. # Script: BannerSet
1341. 
1342. # Script: DisplaySetDateTimeRun
1343. 
1344. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
1345. /* Xinclude "..\Display\BannerSet.MyDc"X */
1346. /* pause(1) */
1347. 
1348. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1349. 
1350. Title('!Heading!')
1351. /* pause(1) */
1352. 
1353. /* NOTE: Can't round or truncate to integer precision. */
1354. 
1355. # Script: BannerLog
1356. 
1357. AppendLogfile("!LogFileName!", "!Title!")
1358. 
1359. 
1360. 
1361. pause(2)
1362. 
1363. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1364. 
1365. # LOGGING:
1366. 	# Script: BannerDescriptionSet
1367. 
1368. # Script: BannerSet
1369. 
1370. # Script: DisplaySetDateTimeRun
1371. 
1372. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
1373. /* Xinclude "..\Display\BannerSet.MyDc"X */
1374. /* pause(1) */
1375. 
1376. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1377. 
1378. Title('!Heading!')
1379. /* pause(1) */
1380. 
1381. /* NOTE: Can't round or truncate to integer precision. */
1382. 
1383. # Script: BannerLog
1384. 
1385. AppendLogfile("!LogFileName!", "!Title!")
1386. 
1387. 
1388. 
1389. 
1390. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-11-09 20:22:41")
1391. 	AppendLogfile("!LogFileName!", ".")
1392. 	AppendLogfile("!LogFileName!", "Script Directory:")
1393. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1394. 	AppendLogfile("!LogFileName!", ".")
1395. 	AppendLogfile("!LogFileName!", "Log File:")
1396. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1397. 	AppendLogfile("!LogFileName!", ".")
1398. 	/* AppendLogfile("!LogFileName!", "Log Header:") */
1399. 	/* AppendLogfile("!LogFileName!", "!LogHeader!") */
1400. 	/* AppendLogfile("!LogFileName!", "End of Log Header.") */
1401. 	AppendLogfile("!LogFileName!", ".")
1402. 
1403. 	AppendLogfile("!LogFileName!", "MFT Percentage: !MftPer!")
1404. 	AppendLogfile("!LogFileName!", "MFT Volume RoundUp: !MftRoundUp!")
1405. 	AppendLogfile("!LogFileName!", "MFT Gap %: !MftAdjRoundUp!")
1406. 	AppendLogfile("!LogFileName!", ".")
1407. 
1408. /* This file is where you override the above setting for */
1409. /* global settings. */
1410. /* There is a "SettingsYours\SettingsYours???.MyDc" for each volume type */
1411. /* so this is where you set the volume specific settings */
1412. /* or you can put them all in the file below. */
1413. 
1414. # Volume Preprocessing Do Before.
1415. /* empty */
1416. 
1417. 
1418. # BANNER:
1419. /* Xinclude "..\Display\VolumeSizeLog.MyDc"X */
1420. 
1421. /* Missed: ToDo: */
1422. /* Games Zone Type */
1423. 
1424. 
1425. 
1426. 
1427. SetVariable(MftZone, "Shares")
1428. 
1429. /* empty */
1430. 
1431. 
1432. # Script: DefragAnyComplexVolume
1433. /* Complex Volume */
1434. # MyDefrag v4.0 script: Defrag Complex (Mixed or Any) Volume.
1435. 
1436. # Script: VolumeStatisticsDetailGet
1437. 
1438. # Set Volume summary stats:
1439. 
1440. # Cluster, Sector, Block adjust for display.
1441. # Bytes per cluster is volume specific.
1442. 
1443. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1444. 
1445. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1446. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1447. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1448. 
1449. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1450. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1451. 
1452. # Set the display text:
1453. # Script: VolumeStatisticsSummaryDisplay
1454. 
1455. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1456. SUMMARY: !VolumeLabel! !VolumeDescription!
1457.   
1458.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1459.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1460.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1461.          
1462.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1463.       Volume Free Adj:       !VolumeFreeAdj!
1464.     Bytes per cluster:       !BytesPerCluster! bytes
1465. 
1466.    Unfragmented Items:       !FILES200N!
1467.      Fragmented Items:       !FILES210N!
1468. 
1469.     Unfragmented Data:       !FILES202N! bytes
1470.       Fragmented Data:       !FILES212N! bytes
1471. 
1472.              All Gaps:       !GAP00N!
1473.              All gaps:       !GAP10N! bytes
1474.           Average gap:       !GAP13N! bytes
1475.            Median gap:       !GAP14N! bytes
1476.           Biggest gap:       !GAP15N! bytes
1477. ----------------------------------------------------------
1478. ") 
1479. 
1480. 
1481. 
1482. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1483. VOLUME: !VolumeLabel! !VolumeDescription!
1484. ----------------------------------------------------------
1485. !VolumeStatisticsSummary!
1486. ----------------------------------------------------------
1487. DETAILS: !VolumeLabel! !VolumeDescription!
1488. ----------------------------------------------------------
1489. 
1490. SUMMARY:
1491. 
1492. Volume label/name:          !VolumeLabel!
1493. Volume mountpoint:          !MountPoint!
1494. Volume name:                !VolumeName!
1495. Volume type:                !VolumeType!
1496. 
1497. Total disk space:           !VolumeSize! bytes
1498.                             !VolumeSizeG! gigabytes
1499. 
1500. Bytes per cluster:          !BytesPerCluster! bytes
1501. Average end-begin distance: !AverageBeginEndDistance! clusters
1502.                             !AverageBeginEndDistanceP!% of volume size
1503. 
1504. ----------------------------------------------------------
1505. FRAGMENTS:
1506. 
1507. Unfragmented Items: !FILES200N!
1508.   Fragmented Items: !FILES210N!
1509.  Unfragmented Data: !FILES202N! bytes
1510.    Fragmented Data: !FILES212N! bytes
1511. Gaps:
1512.           All Gaps: !GAP00N!
1513.           All gaps: !GAP10N! bytes
1514.        Average gap: !GAP13N! bytes
1515.         Median gap: !GAP14N! bytes
1516.        Biggest gap: !GAP15N! bytes
1517. 
1518. ----------------------------------------------------------
1519. GAPS:
1520. 
1521.    ----------------------------------------------------------
1522.    Counts:
1523.                        Count      Percentage of all
1524.                 ----------------- -----------------
1525.    Small gaps   !GAP01N! !GAP01P!%
1526.    Big gaps     !GAP02N! !GAP02P!%
1527.                 ----------------- -----------------
1528.    All gaps     !GAP00N! !GAP00P!
1529. 
1530.    ----------------------------------------------------------
1531.    By size:
1532.                       Bytes          Gigabytes      Percentage of all
1533.                 ----------------- ----------------- -----------------
1534.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1535.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1536.                 ----------------- ----------------- -----------------
1537.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1538. 
1539.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1540.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1541.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1542.    ----------------------------------------------------------
1543. 
1544. ----------------------------------------------------------
1545. FILE STATISTICS:
1546. ----------------------------------------------------------
1547. 
1548. ----------------------------------------------------------
1549. ITEM COUNT:
1550. ----------------------------------------------------------
1551. Number of files and folders:
1552. 
1553.               Unfragmented       Fragmented            All
1554.    ------- ----------------- ----------------- -----------------
1555.    Files   !FILES000N! !FILES010N! !FILES020N!
1556.    Folders !FILES100N! !FILES110N! !FILES120N!
1557.    ------- ----------------- ----------------- -----------------
1558.    All     !FILES200N! !FILES210N! !FILES220N!
1559. 
1560. ----------------------------------------------------------
1561. Percentage of total:
1562. 
1563.               Unfragmented       Fragmented            All
1564.    ------- ----------------- ----------------- -----------------
1565.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1566.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1567.    ------- ----------------- ----------------- -----------------
1568.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1569. 
1570. ----------------------------------------------------------
1571. OCCUPIED SIZE on disk:
1572. ----------------------------------------------------------
1573. Bytes:
1574.               Unfragmented       Fragmented            All
1575.    ------- ----------------- ----------------- -----------------
1576.    Files   !FILES002N! !FILES012N! !FILES022N!
1577.    Folders !FILES102N! !FILES112N! !FILES122N!
1578.    ------- ----------------- ----------------- -----------------
1579.    All     !FILES202N! !FILES212N! !FILES222N!
1580. 
1581. ----------------------------------------------------------
1582. Gigabytes:
1583.               Unfragmented       Fragmented            All
1584.    ------- ----------------- ----------------- -----------------
1585.    Files   !FILES002G! !FILES012G! !FILES022G!
1586.    Folders !FILES102G! !FILES112G! !FILES122G!
1587.    ------- ----------------- ----------------- -----------------
1588.    All     !FILES202G! !FILES212G! !FILES222G!
1589. 
1590. ----------------------------------------------------------
1591. Percentage:
1592.               Unfragmented       Fragmented            All
1593.    ------- ----------------- ----------------- -----------------
1594.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1595.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1596.    ------- ----------------- ----------------- -----------------
1597.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1598. 
1599. ----------------------------------------------------------
1600. USED SIZE:
1601. ----------------------------------------------------------
1602. Bytes:
1603.               Unfragmented       Fragmented            All
1604.    ------- ----------------- ----------------- -----------------
1605.    Files   !FILES001N! !FILES011N! !FILES021N!
1606.    Folders !FILES101N! !FILES111N! !FILES121N!
1607.    ------- ----------------- ----------------- -----------------
1608.    All     !FILES201N! !FILES211N! !FILES221N!
1609. 
1610. ----------------------------------------------------------
1611. Gigabytes:
1612.               Unfragmented       Fragmented            All
1613.    ------- ----------------- ----------------- -----------------
1614.    Files   !FILES001G! !FILES011G! !FILES021G!
1615.    Folders !FILES101G! !FILES111G! !FILES121G!
1616.    ------- ----------------- ----------------- -----------------
1617.    All     !FILES201G! !FILES211G! !FILES221G!
1618. 
1619. ----------------------------------------------------------
1620. Percentage:
1621.               Unfragmented       Fragmented            All
1622.    ------- ----------------- ----------------- -----------------
1623.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1624.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1625.    ------- ----------------- ----------------- -----------------
1626.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1627. 
1628. ----------------------------------------------------------
1629. Volume Detailed Statistics end.
1630. ----------------------------------------------------------
1631. ") 
1632. 
1633. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1634. 
1635. SetVariable(FileStepDescription,"!VolumeLabel! !VolumeDescription! started: 2021-11-09 20:22:41.")
1636. # Script: DisplaySetFileStep
1637. 
1638. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1639. 
1640. /* add message and move to a new line. */
1641. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1642. ")
1643. 
1644. /* display the line. (hopefully.) */
1645. # Zone Footer Set Statistics Window Text
1646. 
1647. SetStatisticsWindowText("----------------------------------------------------------
1648. Zones Processed: 
1649. ----------------------------------------------------------
1650. !ZoneListByLine!
1651. ----------------------------------------------------------
1652. Zone Processing Step:
1653. !ZoneStepByLine!    
1654. ----------------------------------------------------------
1655. Current Zone:
1656. !ZoneFooter!
1657. ----------------------------------------------------------
1658. Volume Statistics:
1659. !VolumeStatisticsDetail!
1660. ----------------------------------------------------------
1661. Zone Detailed Report:
1662. ----------------------------------------------------------
1663. !ZoneStatisticsDetail!
1664. ----------------------------------------------------------
1665. ")
1666. 
1667. 
1668. 
1669. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1670. 
1671. # Script: BannerSet
1672. 
1673. # Script: DisplaySetDateTimeRun
1674. 
1675. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
1676. /* Xinclude "..\Display\BannerSet.MyDc"X */
1677. /* pause(1) */
1678. 
1679. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1680. 
1681. Title('!Heading!')
1682. /* pause(1) */
1683. 
1684. /* NOTE: Can't round or truncate to integer precision. */
1685. 
1686. pause(1)
1687. 
1688. SetVariable(FileStepDescription,"Analyzing Volume")
1689. # Script: DisplaySetFileStep
1690. 
1691. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1692. 
1693. /* add message and move to a new line. */
1694. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1695. ")
1696. 
1697. /* display the line. (hopefully.) */
1698. # Zone Footer Set Statistics Window Text
1699. 
1700. SetStatisticsWindowText("----------------------------------------------------------
1701. Zones Processed: 
1702. ----------------------------------------------------------
1703. !ZoneListByLine!
1704. ----------------------------------------------------------
1705. Zone Processing Step:
1706. !ZoneStepByLine!    
1707. ----------------------------------------------------------
1708. Current Zone:
1709. !ZoneFooter!
1710. ----------------------------------------------------------
1711. Volume Statistics:
1712. !VolumeStatisticsDetail!
1713. ----------------------------------------------------------
1714. Zone Detailed Report:
1715. ----------------------------------------------------------
1716. !ZoneStatisticsDetail!
1717. ----------------------------------------------------------
1718. ")
1719. 
1720. 
1721. 
1722. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1723. 
1724. # Script: BannerSet
1725. 
1726. # Script: DisplaySetDateTimeRun
1727. 
1728. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
1729. /* Xinclude "..\Display\BannerSet.MyDc"X */
1730. /* pause(1) */
1731. 
1732. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1733. 
1734. Title('!Heading!')
1735. /* pause(1) */
1736. 
1737. /* NOTE: Can't round or truncate to integer precision. */
1738. 
1739. pause(1)
1740. 
1741. /* ---------------------------------------------------------- */
1742. VolumeSelect
1743. 
1744. 	Label("!VolumeLabel!") or Name("!VolumeLabel!")
1745. 
1746. /* ---------------------------------------------------------- */
1747. VolumeActions
1748. 
1749. /* ---------------------------------------------------------- */
1750. /* Volume Init */
1751. # Script: VolumeStatisticsDetailGet
1752. 
1753. # Set Volume summary stats:
1754. 
1755. # Cluster, Sector, Block adjust for display.
1756. # Bytes per cluster is volume specific.
1757. 
1758. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1759. 
1760. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1761. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1762. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1763. 
1764. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1765. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1766. 
1767. # Set the display text:
1768. # Script: VolumeStatisticsSummaryDisplay
1769. 
1770. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1771. SUMMARY: !VolumeLabel! !VolumeDescription!
1772.   
1773.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1774.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1775.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1776.          
1777.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1778.       Volume Free Adj:       !VolumeFreeAdj!
1779.     Bytes per cluster:       !BytesPerCluster! bytes
1780. 
1781.    Unfragmented Items:       !FILES200N!
1782.      Fragmented Items:       !FILES210N!
1783. 
1784.     Unfragmented Data:       !FILES202N! bytes
1785.       Fragmented Data:       !FILES212N! bytes
1786. 
1787.              All Gaps:       !GAP00N!
1788.              All gaps:       !GAP10N! bytes
1789.           Average gap:       !GAP13N! bytes
1790.            Median gap:       !GAP14N! bytes
1791.           Biggest gap:       !GAP15N! bytes
1792. ----------------------------------------------------------
1793. ") 
1794. 
1795. 
1796. 
1797. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1798. VOLUME: !VolumeLabel! !VolumeDescription!
1799. ----------------------------------------------------------
1800. !VolumeStatisticsSummary!
1801. ----------------------------------------------------------
1802. DETAILS: !VolumeLabel! !VolumeDescription!
1803. ----------------------------------------------------------
1804. 
1805. SUMMARY:
1806. 
1807. Volume label/name:          !VolumeLabel!
1808. Volume mountpoint:          !MountPoint!
1809. Volume name:                !VolumeName!
1810. Volume type:                !VolumeType!
1811. 
1812. Total disk space:           !VolumeSize! bytes
1813.                             !VolumeSizeG! gigabytes
1814. 
1815. Bytes per cluster:          !BytesPerCluster! bytes
1816. Average end-begin distance: !AverageBeginEndDistance! clusters
1817.                             !AverageBeginEndDistanceP!% of volume size
1818. 
1819. ----------------------------------------------------------
1820. FRAGMENTS:
1821. 
1822. Unfragmented Items: !FILES200N!
1823.   Fragmented Items: !FILES210N!
1824.  Unfragmented Data: !FILES202N! bytes
1825.    Fragmented Data: !FILES212N! bytes
1826. Gaps:
1827.           All Gaps: !GAP00N!
1828.           All gaps: !GAP10N! bytes
1829.        Average gap: !GAP13N! bytes
1830.         Median gap: !GAP14N! bytes
1831.        Biggest gap: !GAP15N! bytes
1832. 
1833. ----------------------------------------------------------
1834. GAPS:
1835. 
1836.    ----------------------------------------------------------
1837.    Counts:
1838.                        Count      Percentage of all
1839.                 ----------------- -----------------
1840.    Small gaps   !GAP01N! !GAP01P!%
1841.    Big gaps     !GAP02N! !GAP02P!%
1842.                 ----------------- -----------------
1843.    All gaps     !GAP00N! !GAP00P!
1844. 
1845.    ----------------------------------------------------------
1846.    By size:
1847.                       Bytes          Gigabytes      Percentage of all
1848.                 ----------------- ----------------- -----------------
1849.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1850.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1851.                 ----------------- ----------------- -----------------
1852.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1853. 
1854.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1855.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1856.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1857.    ----------------------------------------------------------
1858. 
1859. ----------------------------------------------------------
1860. FILE STATISTICS:
1861. ----------------------------------------------------------
1862. 
1863. ----------------------------------------------------------
1864. ITEM COUNT:
1865. ----------------------------------------------------------
1866. Number of files and folders:
1867. 
1868.               Unfragmented       Fragmented            All
1869.    ------- ----------------- ----------------- -----------------
1870.    Files   !FILES000N! !FILES010N! !FILES020N!
1871.    Folders !FILES100N! !FILES110N! !FILES120N!
1872.    ------- ----------------- ----------------- -----------------
1873.    All     !FILES200N! !FILES210N! !FILES220N!
1874. 
1875. ----------------------------------------------------------
1876. Percentage of total:
1877. 
1878.               Unfragmented       Fragmented            All
1879.    ------- ----------------- ----------------- -----------------
1880.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1881.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1882.    ------- ----------------- ----------------- -----------------
1883.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1884. 
1885. ----------------------------------------------------------
1886. OCCUPIED SIZE on disk:
1887. ----------------------------------------------------------
1888. Bytes:
1889.               Unfragmented       Fragmented            All
1890.    ------- ----------------- ----------------- -----------------
1891.    Files   !FILES002N! !FILES012N! !FILES022N!
1892.    Folders !FILES102N! !FILES112N! !FILES122N!
1893.    ------- ----------------- ----------------- -----------------
1894.    All     !FILES202N! !FILES212N! !FILES222N!
1895. 
1896. ----------------------------------------------------------
1897. Gigabytes:
1898.               Unfragmented       Fragmented            All
1899.    ------- ----------------- ----------------- -----------------
1900.    Files   !FILES002G! !FILES012G! !FILES022G!
1901.    Folders !FILES102G! !FILES112G! !FILES122G!
1902.    ------- ----------------- ----------------- -----------------
1903.    All     !FILES202G! !FILES212G! !FILES222G!
1904. 
1905. ----------------------------------------------------------
1906. Percentage:
1907.               Unfragmented       Fragmented            All
1908.    ------- ----------------- ----------------- -----------------
1909.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1910.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1911.    ------- ----------------- ----------------- -----------------
1912.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1913. 
1914. ----------------------------------------------------------
1915. USED SIZE:
1916. ----------------------------------------------------------
1917. Bytes:
1918.               Unfragmented       Fragmented            All
1919.    ------- ----------------- ----------------- -----------------
1920.    Files   !FILES001N! !FILES011N! !FILES021N!
1921.    Folders !FILES101N! !FILES111N! !FILES121N!
1922.    ------- ----------------- ----------------- -----------------
1923.    All     !FILES201N! !FILES211N! !FILES221N!
1924. 
1925. ----------------------------------------------------------
1926. Gigabytes:
1927.               Unfragmented       Fragmented            All
1928.    ------- ----------------- ----------------- -----------------
1929.    Files   !FILES001G! !FILES011G! !FILES021G!
1930.    Folders !FILES101G! !FILES111G! !FILES121G!
1931.    ------- ----------------- ----------------- -----------------
1932.    All     !FILES201G! !FILES211G! !FILES221G!
1933. 
1934. ----------------------------------------------------------
1935. Percentage:
1936.               Unfragmented       Fragmented            All
1937.    ------- ----------------- ----------------- -----------------
1938.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1939.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1940.    ------- ----------------- ----------------- -----------------
1941.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1942. 
1943. ----------------------------------------------------------
1944. Volume Detailed Statistics end.
1945. ----------------------------------------------------------
1946. ") 
1947. 
1948. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1949. 
1950. SetVariable(FileStepDescription,"Volume started.")
1951. # Script: DisplaySetFileStep
1952. 
1953. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1954. 
1955. /* add message and move to a new line. */
1956. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1957. ")
1958. 
1959. /* display the line. (hopefully.) */
1960. # Zone Footer Set Statistics Window Text
1961. 
1962. SetStatisticsWindowText("----------------------------------------------------------
1963. Zones Processed: 
1964. ----------------------------------------------------------
1965. !ZoneListByLine!
1966. ----------------------------------------------------------
1967. Zone Processing Step:
1968. !ZoneStepByLine!    
1969. ----------------------------------------------------------
1970. Current Zone:
1971. !ZoneFooter!
1972. ----------------------------------------------------------
1973. Volume Statistics:
1974. !VolumeStatisticsDetail!
1975. ----------------------------------------------------------
1976. Zone Detailed Report:
1977. ----------------------------------------------------------
1978. !ZoneStatisticsDetail!
1979. ----------------------------------------------------------
1980. ")
1981. 
1982. 
1983. 
1984. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1985. 
1986. # Script: BannerSet
1987. 
1988. # Script: DisplaySetDateTimeRun
1989. 
1990. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
1991. /* Xinclude "..\Display\BannerSet.MyDc"X */
1992. /* pause(1) */
1993. 
1994. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1995. 
1996. Title('!Heading!')
1997. /* pause(1) */
1998. 
1999. /* NOTE: Can't round or truncate to integer precision. */
2000. 
2001. pause(1)
2002. 
2003. # Script: VolumeWhenStarted
2004. 
2005. SetVariable(VolumeFreeAdj, (VolumeFree * (VolumeUsed / VolumeSize)))
2006. 
2007. SetVariable(MftLocation, RoundUp(VolumeUsed * MftPerDev, VolumeSize * VolumeRoundUpLarge)) 
2008. 
2009. SetVariable(ZoneListByLine, 		"Volume started.
2010. ")
2011. SetVariable(ZoneStepByLine, 		"Initialize.
2012. ")
2013. SetVariable(ZoneStatisticsDetail, 	"")
2014. 
2015. SetVariable(ZoneNoCurrent, 		0)
2016. SetVariable(ZoneNoAdjCurrent, 	0) 
2017. SetVariable(ZoneCurrentAjust,	0)
2018. 
2019. # Script: BannerSet
2020. 
2021. # Script: DisplaySetDateTimeRun
2022. 
2023. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:41 0:00:00")
2024. /* Xinclude "..\Display\BannerSet.MyDc"X */
2025. /* pause(1) */
2026. 
2027. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2028. 
2029. Title('!Heading!')
2030. /* pause(1) */
2031. 
2032. /* NOTE: Can't round or truncate to integer precision. */
2033. 
2034. # Script: BannerLog
2035. 
2036. AppendLogfile("!LogFileName!", "!Title!")
2037. 
2038. 
2039. # Script: VolumeStatisticsDetailGet
2040. 
2041. # Set Volume summary stats:
2042. 
2043. # Cluster, Sector, Block adjust for display.
2044. # Bytes per cluster is volume specific.
2045. 
2046. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
2047. 
2048. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
2049. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
2050. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2051. 
2052. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
2053. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2054. 
2055. # Set the display text:
2056. # Script: VolumeStatisticsSummaryDisplay
2057. 
2058. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
2059. SUMMARY: !VolumeLabel! !VolumeDescription!
2060.   
2061.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
2062.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
2063.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
2064.          
2065.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
2066.       Volume Free Adj:       !VolumeFreeAdj!
2067.     Bytes per cluster:       !BytesPerCluster! bytes
2068. 
2069.    Unfragmented Items:       !FILES200N!
2070.      Fragmented Items:       !FILES210N!
2071. 
2072.     Unfragmented Data:       !FILES202N! bytes
2073.       Fragmented Data:       !FILES212N! bytes
2074. 
2075.              All Gaps:       !GAP00N!
2076.              All gaps:       !GAP10N! bytes
2077.           Average gap:       !GAP13N! bytes
2078.            Median gap:       !GAP14N! bytes
2079.           Biggest gap:       !GAP15N! bytes
2080. ----------------------------------------------------------
2081. ") 
2082. 
2083. 
2084. 
2085. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
2086. VOLUME: !VolumeLabel! !VolumeDescription!
2087. ----------------------------------------------------------
2088. !VolumeStatisticsSummary!
2089. ----------------------------------------------------------
2090. DETAILS: !VolumeLabel! !VolumeDescription!
2091. ----------------------------------------------------------
2092. 
2093. SUMMARY:
2094. 
2095. Volume label/name:          !VolumeLabel!
2096. Volume mountpoint:          !MountPoint!
2097. Volume name:                !VolumeName!
2098. Volume type:                !VolumeType!
2099. 
2100. Total disk space:           !VolumeSize! bytes
2101.                             !VolumeSizeG! gigabytes
2102. 
2103. Bytes per cluster:          !BytesPerCluster! bytes
2104. Average end-begin distance: !AverageBeginEndDistance! clusters
2105.                             !AverageBeginEndDistanceP!% of volume size
2106. 
2107. ----------------------------------------------------------
2108. FRAGMENTS:
2109. 
2110. Unfragmented Items: !FILES200N!
2111.   Fragmented Items: !FILES210N!
2112.  Unfragmented Data: !FILES202N! bytes
2113.    Fragmented Data: !FILES212N! bytes
2114. Gaps:
2115.           All Gaps: !GAP00N!
2116.           All gaps: !GAP10N! bytes
2117.        Average gap: !GAP13N! bytes
2118.         Median gap: !GAP14N! bytes
2119.        Biggest gap: !GAP15N! bytes
2120. 
2121. ----------------------------------------------------------
2122. GAPS:
2123. 
2124.    ----------------------------------------------------------
2125.    Counts:
2126.                        Count      Percentage of all
2127.                 ----------------- -----------------
2128.    Small gaps   !GAP01N! !GAP01P!%
2129.    Big gaps     !GAP02N! !GAP02P!%
2130.                 ----------------- -----------------
2131.    All gaps     !GAP00N! !GAP00P!
2132. 
2133.    ----------------------------------------------------------
2134.    By size:
2135.                       Bytes          Gigabytes      Percentage of all
2136.                 ----------------- ----------------- -----------------
2137.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
2138.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
2139.                 ----------------- ----------------- -----------------
2140.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
2141. 
2142.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
2143.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
2144.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
2145.    ----------------------------------------------------------
2146. 
2147. ----------------------------------------------------------
2148. FILE STATISTICS:
2149. ----------------------------------------------------------
2150. 
2151. ----------------------------------------------------------
2152. ITEM COUNT:
2153. ----------------------------------------------------------
2154. Number of files and folders:
2155. 
2156.               Unfragmented       Fragmented            All
2157.    ------- ----------------- ----------------- -----------------
2158.    Files   !FILES000N! !FILES010N! !FILES020N!
2159.    Folders !FILES100N! !FILES110N! !FILES120N!
2160.    ------- ----------------- ----------------- -----------------
2161.    All     !FILES200N! !FILES210N! !FILES220N!
2162. 
2163. ----------------------------------------------------------
2164. Percentage of total:
2165. 
2166.               Unfragmented       Fragmented            All
2167.    ------- ----------------- ----------------- -----------------
2168.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
2169.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
2170.    ------- ----------------- ----------------- -----------------
2171.    All     !FILES200P!%!FILES210P!%!FILES220P!%
2172. 
2173. ----------------------------------------------------------
2174. OCCUPIED SIZE on disk:
2175. ----------------------------------------------------------
2176. Bytes:
2177.               Unfragmented       Fragmented            All
2178.    ------- ----------------- ----------------- -----------------
2179.    Files   !FILES002N! !FILES012N! !FILES022N!
2180.    Folders !FILES102N! !FILES112N! !FILES122N!
2181.    ------- ----------------- ----------------- -----------------
2182.    All     !FILES202N! !FILES212N! !FILES222N!
2183. 
2184. ----------------------------------------------------------
2185. Gigabytes:
2186.               Unfragmented       Fragmented            All
2187.    ------- ----------------- ----------------- -----------------
2188.    Files   !FILES002G! !FILES012G! !FILES022G!
2189.    Folders !FILES102G! !FILES112G! !FILES122G!
2190.    ------- ----------------- ----------------- -----------------
2191.    All     !FILES202G! !FILES212G! !FILES222G!
2192. 
2193. ----------------------------------------------------------
2194. Percentage:
2195.               Unfragmented       Fragmented            All
2196.    ------- ----------------- ----------------- -----------------
2197.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
2198.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
2199.    ------- ----------------- ----------------- -----------------
2200.    All     !FILES202P!%!FILES212P!%!FILES222P!%
2201. 
2202. ----------------------------------------------------------
2203. USED SIZE:
2204. ----------------------------------------------------------
2205. Bytes:
2206.               Unfragmented       Fragmented            All
2207.    ------- ----------------- ----------------- -----------------
2208.    Files   !FILES001N! !FILES011N! !FILES021N!
2209.    Folders !FILES101N! !FILES111N! !FILES121N!
2210.    ------- ----------------- ----------------- -----------------
2211.    All     !FILES201N! !FILES211N! !FILES221N!
2212. 
2213. ----------------------------------------------------------
2214. Gigabytes:
2215.               Unfragmented       Fragmented            All
2216.    ------- ----------------- ----------------- -----------------
2217.    Files   !FILES001G! !FILES011G! !FILES021G!
2218.    Folders !FILES101G! !FILES111G! !FILES121G!
2219.    ------- ----------------- ----------------- -----------------
2220.    All     !FILES201G! !FILES211G! !FILES221G!
2221. 
2222. ----------------------------------------------------------
2223. Percentage:
2224.               Unfragmented       Fragmented            All
2225.    ------- ----------------- ----------------- -----------------
2226.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
2227.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
2228.    ------- ----------------- ----------------- -----------------
2229.    All     !FILES201P!%!FILES211P!%!FILES221P!%
2230. 
2231. ----------------------------------------------------------
2232. Volume Detailed Statistics end.
2233. ----------------------------------------------------------
2234. ") 
2235. 
2236. # Script: BannerLog
2237. 
2238. AppendLogfile("!LogFileName!", "!Title!")
2239. 
2240. 
2241. 
2242. /* Write/display stats: */
2243. # Log:
2244. AppendLogfile("!LogFileName!", "!Title! started.")
2245. AppendLogfile("!LogFileName!", "2021-11-09 20:22:41.")
2246. AppendLogfile("!LogFileName!",".")
2247. AppendLogfile("!LogFileName!", ".")
2248. AppendLogfile("!LogFileName!", "Volume: !VolumeLabel!")
2249. AppendLogfile("!LogFileName!",".")
2250. AppendLogfile("!LogFileName!","!VolumeStatisticsDetail!")
2251. AppendLogfile("!LogFileName!",".")
2252. AppendLogfile("!LogFileName!", "!Title! started.")
2253. AppendLogfile("!LogFileName!", "2021-11-09 20:22:41.")
2254. AppendLogfile("!LogFileName!",".")
2255. 
2256. # In program statistics window (view):
2257. SetStatisticsWindowText("!VolumeStatisticsDetail!")
2258. 
2259. 
2260. /* ---------------------------------------------------------- */
2261. /* System Zones */
2262. /* ---------------------------------------------------------- */
2263. 
2264. 	# Script: DefragZoneGroupOs
2265. # Defrag Zones Os
2266. 	/* System Zones */
2267. 
2268. AppendLogfile("!LogFileName!", "!Description! Os Zones started: 2021-11-09 20:22:42")
2269. SetVariable(FileStepDescription,"System Zones.")
2270. # Script: BannerSet
2271. 
2272. # Script: DisplaySetDateTimeRun
2273. 
2274. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
2275. /* Xinclude "..\Display\BannerSet.MyDc"X */
2276. /* pause(1) */
2277. 
2278. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2279. 
2280. Title('!Heading!')
2281. /* pause(1) */
2282. 
2283. /* NOTE: Can't round or truncate to integer precision. */
2284. 
2285. # Script: BannerLog
2286. 
2287. AppendLogfile("!LogFileName!", "!Title!")
2288. 
2289. 
2290. AppendLogfile("!LogFileName!",".")
2291. 
2292. AppendLogfile("!LogFileName!", "System Disk optimized layout for boot and executables. 2021-11-09 20:22:42")
2293. /* Dgh 20190618 */
2294. 
2295. /* ---------------------------------------------------------- */
2296. /* Defrag the Pagefile.sys on the next boot. */
2297. 
2298. # PagedFrg - Page Defrag.
2299. 
2300. /* Defrag the Pagefile.sys on the next boot. */
2301. # RunProgram("..\Pagedfrg.exe","-o")
2302. 
2303. 
2304. /* ---------------------------------------------------------- */
2305. AppendLogfile("!LogFileName!", "Place files at the beginning of the disk: 2021-11-09 20:22:42")
2306. 
2307. 	MakeGap(0)
2308. 
2309. /* ---------------------------------------------------------- */
2310. # Zone Boot Fixed.
2311. # Script: DefragZoneTypeOsBoot
2312. /* ---------------------------------------------------------- */
2313. # Zone Boot Fixed.
2314. 	SetVariable(ZoneLabel, 			"!ZoneLabelBoot!")
2315. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBoot!")
2316. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
2317. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
2318. 	SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectOsBoot
2319. # Boot start.
2320. ImportListFromBootOptimize()
2321. # Boot end.
2322. ')
2323. 
2324. 		# Script: ZoneDoHeader
2325. 
2326. # Script: ZoneWhenStarted
2327. 
2328. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
2329. # Script: DisplaySetZone
2330. 
2331. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
2332. SetVariable(FileStepDescription,	"")
2333. 
2334. SetVariable(ZoneStepByLine, 			"Zone started.
2335. ")
2336. 
2337. # Script: BannerDescriptionSet
2338. 
2339. # Script: BannerSet
2340. 
2341. # Script: DisplaySetDateTimeRun
2342. 
2343. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
2344. /* Xinclude "..\Display\BannerSet.MyDc"X */
2345. /* pause(1) */
2346. 
2347. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2348. 
2349. Title('!Heading!')
2350. /* pause(1) */
2351. 
2352. /* NOTE: Can't round or truncate to integer precision. */
2353. 
2354. # Script: BannerLog
2355. 
2356. AppendLogfile("!LogFileName!", "!Title!")
2357. 
2358. 
2359. 
2360. pause(1)
2361. 
2362. 
2363. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
2364. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
2365. 
2366. SetVariable(ZoneStepNoCurrent, 0)
2367. 
2368. 
2369. # Script: ZoneDoCurrentClear
2370. 
2371. SetVariable(ZoneTypeSelectCurrent, 		"")
2372. 
2373. SetVariable(ZoneBeginCurrent, 			0)
2374. SetVariable(ZoneBeginPerCurrent, 		0)
2375. SetVariable(ZoneEndCurrent, 			0)
2376. SetVariable(ZoneEndPerCurrent, 			0)
2377. 
2378. SetVariable(ZoneSizeCurrent,			0)
2379. SetVariable(ZoneSizePerCurrent,			0)
2380. 
2381. SetVariable(ZoneGapRequestedCurrent,	0)
2382. SetVariable(ZoneGapRoundedCurrent, 		0)
2383. SetVariable(ZoneGapAdjustedCurrent, 	0)
2384. SetVariable(ZoneGapAvailableCurrent, 	0)
2385. SetVariable(ZoneGapCurrent,				0)
2386. SetVariable(ZoneGapUsedCurrent, 		0)
2387. 
2388. SetVariable(ZoneGapActualCurrent, 		0)
2389. SetVariable(ZoneGapActualPerCurrent, 	0)
2390. 
2391. SetVariable(ZoneSizeActual, 			0)
2392. SetVariable(ZoneSizeActualCurrent,		0)
2393. 
2394. SetVariable(ZoneEndActual, 				0)
2395. SetVariable(ZoneEndActualCurrent,		0)			
2396. SetVariable(ZoneSizeActualPerCurrent, 	0)
2397.       
2398. SetVariable(ZoneFilesFolders,			0)
2399. SetVariable(ZoneFilesFoldersPer,		0) 
2400. 
2401. SetVariable(ZoneFragments,				0)
2402. SetVariable(ZoneFragmentsPer,			0) 
2403. 		
2404. SetVariable(ZoneEndActualCurrent, 		0)
2405. SetVariable(ZoneEndActualPerCurrent, 	0)
2406. 
2407. # Gap Calculation Methodology:
2408. 	# Requested
2409. 	SetVariable(GapRequested, 			0) 
2410. 	SetVariable(GapRequestedStd, 		0) 
2411. 	SetVariable(GapRequestedMft, 		0) 
2412. 	SetVariable(GapRequestedOs, 		0) 
2413. 	SetVariable(GapRequestedOriginal, 	0) 
2414. 	
2415. 	# Gap Adjustments
2416. 	SetVariable(GapRounded, 			0)
2417. 	# SetVariable(GapAdjusted, 			0)
2418. 	SetVariable(GapAvailable, 			0)
2419. 	SetVariable(GapCurrent, 			0)
2420. 	SetVariable(GapActual, 				0)
2421. 	SetVariable(GapUsed, 				0)
2422. 	
2423. 	# Gap Adjustments
2424. 	SetVariable(GapRoundedLoc, 			0)
2425. 	# SetVariable(GapAdjustedLoc, 		0)
2426. 	SetVariable(GapAvailableLoc, 		0)
2427. 	SetVariable(GapCurrentLoc, 			0)
2428. 	SetVariable(GapActualLoc,			0)
2429. 	SetVariable(GapUsedLoc,				0)
2430. 	
2431. 	# Space usage
2432. 	SetVariable(ZoneFreePerRequested, 	0)
2433. 	SetVariable(ZoneFreePerUsed, 		0)
2434. 
2435. # Gap Size & Rounding
2436. 	SetVariable(ZoneGapSizePer, 		0)
2437. 	SetVariable(ZoneVolRoundUpPer, 		0)
2438. 	
2439. 	# Free Space
2440. 	SetVariable(ZoneFreeUsedPer, 		0)
2441. 	SetVariable(ZoneFreeRequestedPer, 	0)
2442. 
2443. 
2444. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
2445. 
2446. # Footer:
2447. SetVariable(ZoneFooter, "----------------------------------------------------------
2448. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:42
2449. 
2450. Statistics Report:
2451. ------------------
2452.    Size:  
2453.    ------------------------
2454.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2455.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2456.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2457. 
2458.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2459.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2460. 
2461.    Location:
2462.    ------------------------
2463.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2464.              Files End: !ZoneEndCurrent!
2465.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2466.       
2467.    Gap Settings:
2468.    ------------------------
2469.          Gap Requested: !ZoneGapSizePer!%
2470.       Volume Rounding: !ZoneVolRoundUpPer!%
2471.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2472.                  
2473.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
2474.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
2475.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
2476.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
2477.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
2478.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
2479.      
2480.    Free Space after Zone:
2481.    ------------------------
2482.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
2483.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
2484.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
2485. 
2486. Directory and Files Select:
2487. ---------------------------
2488. !ZoneTypeSelectCurrent!               
2489. ---------------------------
2490. ----------------------------------------------------------
2491. ")
2492. 
2493. # Script: BannerSet
2494. 
2495. # Script: DisplaySetDateTimeRun
2496. 
2497. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
2498. /* Xinclude "..\Display\BannerSet.MyDc"X */
2499. /* pause(1) */
2500. 
2501. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2502. 
2503. Title('!Heading!')
2504. /* pause(1) */
2505. 
2506. /* NOTE: Can't round or truncate to integer precision. */
2507. 
2508. # Script: BannerLog
2509. 
2510. AppendLogfile("!LogFileName!", "!Title!")
2511. 
2512. 
2513. 
2514. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
2515. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
2516. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:42")
2517. 
2518. SetVariable(ZoneListByLine, "!ZoneListByLine!
2519. Zone: !ZoneNoCurrent! 2021-11-09 20:22:42 0:00:01 !ZoneLabel! !ZoneDescription!")
2520. 
2521. 
2522. /* Fixed Zone Position Handling */
2523. /* Literal number: */
2524. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
2525. /* Percentage of disk: */
2526. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
2527. /* Gap */
2528. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
2529. 
2530. /* ---------------------------------------------------------- */
2531. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
2532. # Script: DisplaySetFileStep
2533. 
2534. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2535. 
2536. /* add message and move to a new line. */
2537. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2538. ")
2539. 
2540. /* display the line. (hopefully.) */
2541. # Zone Footer Set Statistics Window Text
2542. 
2543. SetStatisticsWindowText("----------------------------------------------------------
2544. Zones Processed: 
2545. ----------------------------------------------------------
2546. !ZoneListByLine!
2547. ----------------------------------------------------------
2548. Zone Processing Step:
2549. !ZoneStepByLine!    
2550. ----------------------------------------------------------
2551. Current Zone:
2552. !ZoneFooter!
2553. ----------------------------------------------------------
2554. Volume Statistics:
2555. !VolumeStatisticsDetail!
2556. ----------------------------------------------------------
2557. Zone Detailed Report:
2558. ----------------------------------------------------------
2559. !ZoneStatisticsDetail!
2560. ----------------------------------------------------------
2561. ")
2562. 
2563. 
2564. 
2565. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2566. 
2567. # Script: BannerSet
2568. 
2569. # Script: DisplaySetDateTimeRun
2570. 
2571. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
2572. /* Xinclude "..\Display\BannerSet.MyDc"X */
2573. /* pause(1) */
2574. 
2575. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2576. 
2577. Title('!Heading!')
2578. /* pause(1) */
2579. 
2580. /* NOTE: Can't round or truncate to integer precision. */
2581. 
2582. pause(1)
2583. 
2584. # your stuff HERE (X)... pre file select code.
2585. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
2586. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
2587. 	# (X)
2588. 
2589. FileSelect
2590. 
2591. 	# your stuff can't really go here (errors.)
2592. 	# maybe for some reason I don't know of...
2593. 	
2594. 	# Actions next...
2595. 		# Script: ZoneDo ZoneTypeSelectOsBoot
2596. # Boot start.
2597. ImportListFromBootOptimize()
2598. # Boot end.
2599. 
2600. 		and not(
2601. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
2602. # Os Data Dynamic start.
2603. (
2604. # Os Data Dynamic start.
2605. (
2606.   FileName("*.dat*")
2607.   or FileName("*.db*")
2608.   or FileName("*.edb*")
2609.   or FileName("*.log*")
2610.   or FileName("DataStore.edb")
2611. )
2612. # Os Data Dynamic end.
2613. 
2614.   or 
2615. # Os PageHiberDump start.
2616. (
2617.   FileName("DataStore.edb")
2618.   or FileName("DUMP*.*")
2619.   or FileName("Hiberfil.sys")
2620.   or FileName("MEMORY.DMP")
2621.   or FileName("Pagefile.sys")
2622. )
2623. # Os PageHiberDump end.
2624. 
2625. # Os Data Dynamic
2626. )
2627. # Os Data Dynamic end.
2628. 
2629. 		)
2630. 
2631. 		FileActions
2632. 		  		/* ---------------------------------------------------------- */
2633. 	# Gap
2634. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
2635. 		# Script: DisplaySetFileStep
2636. 
2637. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2638. 
2639. /* add message and move to a new line. */
2640. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2641. ")
2642. 
2643. /* display the line. (hopefully.) */
2644. # Zone Footer Set Statistics Window Text
2645. 
2646. SetStatisticsWindowText("----------------------------------------------------------
2647. Zones Processed: 
2648. ----------------------------------------------------------
2649. !ZoneListByLine!
2650. ----------------------------------------------------------
2651. Zone Processing Step:
2652. !ZoneStepByLine!    
2653. ----------------------------------------------------------
2654. Current Zone:
2655. !ZoneFooter!
2656. ----------------------------------------------------------
2657. Volume Statistics:
2658. !VolumeStatisticsDetail!
2659. ----------------------------------------------------------
2660. Zone Detailed Report:
2661. ----------------------------------------------------------
2662. !ZoneStatisticsDetail!
2663. ----------------------------------------------------------
2664. ")
2665. 
2666. 
2667. 
2668. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2669. 
2670. # Script: BannerSet
2671. 
2672. # Script: DisplaySetDateTimeRun
2673. 
2674. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
2675. /* Xinclude "..\Display\BannerSet.MyDc"X */
2676. /* pause(1) */
2677. 
2678. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2679. 
2680. Title('!Heading!')
2681. /* pause(1) */
2682. 
2683. /* NOTE: Can't round or truncate to integer precision. */
2684. 
2685. pause(1)
2686. 	
2687. 	# ACTUAL GAP
2688. 		/* AddGap Variant. */
2689. 	  	# Zone Do Gap
2690. # Gap Calculation Methods:
2691. 
2692. /* 1) Anything you need to add first. */
2693. /* empty */
2694. 
2695. /* ---------------------------------------------------------- */
2696. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
2697. 	# GapRequestedStd.
2698. 
2699. 		/* ---------------------------------------------------------- */
2700. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
2701. 
2702. 		# Gap Calculation Methods:
2703. 
2704. /* AddGap Variants */
2705. 
2706. 	/* Standard */
2707. 		# Gap Calculation Methods:
2708. 	/* AddGap Variants */
2709. 	/* Standard */
2710. 
2711. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
2712. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
2713. 
2714. 	SetVariable(GapRequested, GapRequestedStd)
2715. 	
2716. 
2717. 	/* MFT Low High Method */
2718. 		# Gap Calculation Methods:
2719. 	/* AddGap Variants */
2720. 	/* MFT Low High Method */
2721. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
2722. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
2723. 	SetVariable(GapRequested, GapRequestedMft)
2724. 	
2725. 
2726. 	/* OS Volume Type Method */
2727. 		# Gap Calculation Methods:
2728. 	/* AddGap Variants */
2729. 	/* OS Volume Type Method */
2730. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
2731. 	SetVariable(GapRequested, GapRequestedOs)
2732. 
2733. 
2734. 
2735. /* MakeGap Variants */
2736. 
2737. 	/* Original Os 1-3 + MFT 2 */
2738. 		# Gap Calculation Methods:
2739. 	/* MakeGap Variants */
2740. 	/* Original Os 1-3 + MFT 2 */
2741. 	/* plus MFT gap placed inline at the dividing zone. */
2742. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
2743. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
2744. 	SetVariable(GapRequested, GapRequestedOrig)
2745. 	
2746. 	
2747. /* Note: You could comment out the ones not in use */
2748. /* However having the data in the log is useful. */
2749. /* Therefore the following line is otherwise needed. */
2750. 
2751. /* Standard used */
2752. 
2753. SetVariable(GapRequested, GapRequestedStd)
2754. 
2755. # Gap Calculation Methods:
2756. 
2757. /* AddGap Variants */
2758. 	/* Standard */
2759. 	/* MFT Low High Method */
2760. 	/* OS Volume Type Method */
2761. 
2762. /* MakeGap Variants */
2763. 	/* Original Os 1-3 + MFT 2 */
2764. 
2765. /* Note: You could comment out the ones not in use */
2766. /* However having the data in the log is useful. */
2767. /* Therefore the following line is otherwise needed. */
2768. 
2769. /* Standard is used currently */
2770. 
2771. 
2772. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
2773. 
2774. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
2775. 
2776. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
2777. 
2778. /* ---------------------------------------------------------- */
2779. /* 3) SMALL ZONE ADJUSTMENT. */
2780. /* Gab cant be larger than half the Zone Size. */
2781. 
2782. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
2783. 	
2784. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
2785. 
2786. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
2787. 
2788. /* ---------------------------------------------------------- */
2789. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
2790. # Gap Adjustments.
2791. 
2792. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
2793. 	
2794. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
2795. 
2796. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
2797. 
2798. /* ---------------------------------------------------------- */
2799. # BYPASS THIS.
2800. 	/* This is definitely wrong. */
2801. 	/* The question is can we steal gap from the next zone */
2802. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
2803. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
2804. 		# Zone Overflow.
2805. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
2806. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
2807. 
2808. /* ---------------------------------------------------------- */
2809. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
2810. # Remaining free space available.
2811. 
2812. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
2813. 	
2814. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
2815. 
2816. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
2817. 
2818. /* ---------------------------------------------------------- */
2819. # CURRENT gap to use.
2820. 
2821. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
2822. 
2823. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
2824. 
2825. /* ---------------------------------------------------------- */
2826. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
2827. # Debugging.
2828. 
2829. 	SetVariable(GapUsed, GapCurrent) // for debugging
2830. 
2831. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
2832. 
2833. 		# Your code HERE
2834. 
2835. /* ---------------------------------------------------------- */
2836. /* 7) YOUR CODE. */
2837. # YOUR CODE HERE:
2838. 	# INPUT: GapCurrent or GapCurrentLoc
2839. 	# OUTPUT: GapUsed...
2840. 
2841. /* ---------------------------------------------------------- */
2842. # Gap Size.
2843. # Actual Size of Gap.
2844. 
2845. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
2846. 
2847. /* ---------------------------------------------------------- */
2848. /* xxxxxxxxxxxxxxxxxxxxxx */
2849. # ADD THE GAP
2850. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
2851. /* xxxxxxxxxxxxxxxxxxxxxx */
2852. 
2853. 	
2854. 	# Zone Statistics	
2855. 	# Script: ZoneDoStatistics
2856. # Zone / Volume Statistics and Display
2857. 		
2858. 	# Accumulate Totals
2859.   	# Script: ZoneDoVolumeTotals
2860. 
2861. /* Current total space used (by Zones and Gaps) */
2862. 
2863. SetVariable(VolumeZoneUsed, GapUsed)
2864. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
2865. /* Percentage */
2866. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
2867. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
2868. 
2869. /* Current total of free space requested */
2870. 
2871. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
2872. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2873. /* Percent. */
2874. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
2875. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2876. 
2877. /* Current total of free space used */
2878. 
2879. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
2880. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
2881. /* Percent */
2882. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
2883. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
2884. 
2885. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
2886. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
2887. /* Xinclude "..\DebugDisplayPause.MyDc"X */
2888. 
2889. 
2890. 	# Current Values
2891. 	# Script: ZoneDoCurrentSet
2892. 
2893. # Cluster, Sector, Block adjust for display.
2894. 	# Bytes per cluster is volume specific.
2895. 
2896. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
2897. 
2898. # Current Zone values.
2899. 	# Begin, end and size.
2900. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
2901. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
2902. 
2903. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
2904. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
2905. 
2906. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
2907. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
2908. 
2909. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
2910. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
2911. 
2912. 	SetVariable(ZoneFragments,				"!ZONE210N!")
2913. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
2914. 		
2915. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
2916. /* identical code to here: (separation not needed. TEST.) */	
2917. 
2918. # Current Gap, Actual and Free Values
2919. 	# Gap
2920. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
2921. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
2922. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
2923. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
2924. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
2925. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
2926. 	
2927. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
2928. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
2929. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
2930. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
2931. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
2932. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
2933. 	
2934. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
2935. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
2936. 	
2937. 	# Actual Size and End
2938. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
2939. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
2940. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
2941. 	
2942. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
2943. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
2944. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
2945. 
2946. # Gap Size & Rounding
2947. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
2948. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
2949. 	
2950. 	# Free Space
2951. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
2952. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
2953. 
2954. 	# Footer:
2955. SetVariable(ZoneFooter, "----------------------------------------------------------
2956. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:42
2957. 
2958. Statistics Report:
2959. ------------------
2960.    Size:  
2961.    ------------------------
2962.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2963.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2964.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2965. 
2966.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2967.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2968. 
2969.    Location:
2970.    ------------------------
2971.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2972.              Files End: !ZoneEndCurrent!
2973.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2974.       
2975.    Gap Settings:
2976.    ------------------------
2977.          Gap Requested: !ZoneGapSizePer!%
2978.       Volume Rounding: !ZoneVolRoundUpPer!%
2979.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2980.                  
2981.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
2982.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
2983.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
2984.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
2985.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
2986.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
2987.      
2988.    Free Space after Zone:
2989.    ------------------------
2990.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
2991.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
2992.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
2993. 
2994. Directory and Files Select:
2995. ---------------------------
2996. !ZoneTypeSelectCurrent!               
2997. ---------------------------
2998. ----------------------------------------------------------
2999. ")
3000. 	# Zone Footer Set Statistics Window Text
3001. 
3002. SetStatisticsWindowText("----------------------------------------------------------
3003. Zones Processed: 
3004. ----------------------------------------------------------
3005. !ZoneListByLine!
3006. ----------------------------------------------------------
3007. Zone Processing Step:
3008. !ZoneStepByLine!    
3009. ----------------------------------------------------------
3010. Current Zone:
3011. !ZoneFooter!
3012. ----------------------------------------------------------
3013. Volume Statistics:
3014. !VolumeStatisticsDetail!
3015. ----------------------------------------------------------
3016. Zone Detailed Report:
3017. ----------------------------------------------------------
3018. !ZoneStatisticsDetail!
3019. ----------------------------------------------------------
3020. ")
3021. 
3022. 
3023. 	
3024.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
3025. 
3026. 	# Add Zone to list of zones for display.
3027. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
3028. 	# ??? Free Stats?
3029. 	# Footer:
3030. SetVariable(ZoneFooter, "----------------------------------------------------------
3031. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:42
3032. 
3033. Statistics Report:
3034. ------------------
3035.    Size:  
3036.    ------------------------
3037.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3038.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3039.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3040. 
3041.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3042.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3043. 
3044.    Location:
3045.    ------------------------
3046.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3047.              Files End: !ZoneEndCurrent!
3048.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3049.       
3050.    Gap Settings:
3051.    ------------------------
3052.          Gap Requested: !ZoneGapSizePer!%
3053.       Volume Rounding: !ZoneVolRoundUpPer!%
3054.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3055.                  
3056.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
3057.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
3058.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
3059.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
3060.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
3061.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
3062.      
3063.    Free Space after Zone:
3064.    ------------------------
3065.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3066.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3067.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3068. 
3069. Directory and Files Select:
3070. ---------------------------
3071. !ZoneTypeSelectCurrent!               
3072. ---------------------------
3073. ----------------------------------------------------------
3074. ")
3075. 
3076. 	# Add Zone Details to Report.	
3077. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
3078. !ZoneFooter!")
3079. 
3080. 
3081. 	
3082. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionStart!")
3083. 			# Script: DisplaySetFileStep
3084. 
3085. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3086. 
3087. /* add message and move to a new line. */
3088. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3089. ")
3090. 
3091. /* display the line. (hopefully.) */
3092. # Zone Footer Set Statistics Window Text
3093. 
3094. SetStatisticsWindowText("----------------------------------------------------------
3095. Zones Processed: 
3096. ----------------------------------------------------------
3097. !ZoneListByLine!
3098. ----------------------------------------------------------
3099. Zone Processing Step:
3100. !ZoneStepByLine!    
3101. ----------------------------------------------------------
3102. Current Zone:
3103. !ZoneFooter!
3104. ----------------------------------------------------------
3105. Volume Statistics:
3106. !VolumeStatisticsDetail!
3107. ----------------------------------------------------------
3108. Zone Detailed Report:
3109. ----------------------------------------------------------
3110. !ZoneStatisticsDetail!
3111. ----------------------------------------------------------
3112. ")
3113. 
3114. 
3115. 
3116. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3117. 
3118. # Script: BannerSet
3119. 
3120. # Script: DisplaySetDateTimeRun
3121. 
3122. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
3123. /* Xinclude "..\Display\BannerSet.MyDc"X */
3124. /* pause(1) */
3125. 
3126. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3127. 
3128. Title('!Heading!')
3129. /* pause(1) */
3130. 
3131. /* NOTE: Can't round or truncate to integer precision. */
3132. 
3133. pause(1)
3134. 	
3135. 			# File Action - Os Boot -  SortByName.
3136. # File Action - SortByName.
3137. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
3138. 	
3139. 	
3140. 
3141. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionEnd!")
3142. 			# Script: DisplaySetFileStep
3143. 
3144. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3145. 
3146. /* add message and move to a new line. */
3147. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3148. ")
3149. 
3150. /* display the line. (hopefully.) */
3151. # Zone Footer Set Statistics Window Text
3152. 
3153. SetStatisticsWindowText("----------------------------------------------------------
3154. Zones Processed: 
3155. ----------------------------------------------------------
3156. !ZoneListByLine!
3157. ----------------------------------------------------------
3158. Zone Processing Step:
3159. !ZoneStepByLine!    
3160. ----------------------------------------------------------
3161. Current Zone:
3162. !ZoneFooter!
3163. ----------------------------------------------------------
3164. Volume Statistics:
3165. !VolumeStatisticsDetail!
3166. ----------------------------------------------------------
3167. Zone Detailed Report:
3168. ----------------------------------------------------------
3169. !ZoneStatisticsDetail!
3170. ----------------------------------------------------------
3171. ")
3172. 
3173. 
3174. 
3175. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3176. 
3177. # Script: BannerSet
3178. 
3179. # Script: DisplaySetDateTimeRun
3180. 
3181. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
3182. /* Xinclude "..\Display\BannerSet.MyDc"X */
3183. /* pause(1) */
3184. 
3185. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3186. 
3187. Title('!Heading!')
3188. /* pause(1) */
3189. 
3190. /* NOTE: Can't round or truncate to integer precision. */
3191. 
3192. pause(1)
3193. 
3194. 		# Script: ZoneDoFooter
3195. 
3196. /* ---------------------------------------------------------- */
3197. # File Select
3198. 	# Select Statments
3199. # File Actions 
3200. 	# Standard or OS File Actions.
3201. 	# Resume...
3202. 	
3203. 	# your stuff HERE (X)... post zone (file) file actions code.
3204. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
3205. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3206. 		# (X)
3207. 		
3208. 		/* ??? Set window? */
3209. 	
3210. 	# ADD THE GAP
3211. 		
3212. # Vacate (good for diagnostics)
3213. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
3214. 
3215. # DoNotVacate - DO NOT Vacate (recommended)
3216. 
3217. # Vacate
3218. /* AddGap(GapUsedLoc) */
3219. 
3220. # DO Not Vacate
3221. AddGap(GapUsedLoc, DoNotVacate) 
3222. 	
3223. 	
3224. /* ---------------------------------------------------------- */
3225. # (failed) TEST for boolean logic.
3226. 
3227. /* It should work in the gap calculations for turning options */
3228. /* on and off but it will NOT work here. */
3229. 
3230. /* Boolean setting X or FlagX. */
3231. /* Where X will be on or off: */
3232. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
3233. /*      For ON:  (X  *  FlagAny) */
3234. 
3235. /* 1) Failed, zero gap overrode the previous one. */
3236. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
3237. /* AddGap(GapUsedTemp) */ 
3238. 
3239. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
3240. /* AddGap(GapUsedTemp, DoNotVacate) */ 
3241. 
3242. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
3243. 
3244. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
3245. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
3246. /* AddGap(GapUsedTemp) */ 
3247. 
3248. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
3249. /* AddGap(GapUsedTemp, DoNotVacate) */ 
3250. 
3251. /* ---------------------------------------------------------- */
3252. 
3253. # Vacate
3254. /* AddGap(GapUsed) */
3255. 
3256. # DO NOT Vacate (recommended)
3257. /* AddGap(GapUsed, DoNotVacate) */ 
3258. 	
3259. 
3260. 		
3261. # 
3262. FileEnd
3263. /* ---------------------------------------------------------- */
3264. 
3265. # your stuff HERE (X)... post zone (file) code.
3266. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
3267. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3268. 	# (X)
3269. 
3270. SetVariable(FileStepDescription,"Zone finished, reporting.")
3271. # Script: DisplaySetFileStep
3272. 
3273. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3274. 
3275. /* add message and move to a new line. */
3276. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3277. ")
3278. 
3279. /* display the line. (hopefully.) */
3280. # Zone Footer Set Statistics Window Text
3281. 
3282. SetStatisticsWindowText("----------------------------------------------------------
3283. Zones Processed: 
3284. ----------------------------------------------------------
3285. !ZoneListByLine!
3286. ----------------------------------------------------------
3287. Zone Processing Step:
3288. !ZoneStepByLine!    
3289. ----------------------------------------------------------
3290. Current Zone:
3291. !ZoneFooter!
3292. ----------------------------------------------------------
3293. Volume Statistics:
3294. !VolumeStatisticsDetail!
3295. ----------------------------------------------------------
3296. Zone Detailed Report:
3297. ----------------------------------------------------------
3298. !ZoneStatisticsDetail!
3299. ----------------------------------------------------------
3300. ")
3301. 
3302. 
3303. 
3304. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3305. 
3306. # Script: BannerSet
3307. 
3308. # Script: DisplaySetDateTimeRun
3309. 
3310. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
3311. /* Xinclude "..\Display\BannerSet.MyDc"X */
3312. /* pause(1) */
3313. 
3314. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3315. 
3316. Title('!Heading!')
3317. /* pause(1) */
3318. 
3319. /* NOTE: Can't round or truncate to integer precision. */
3320. 
3321. pause(1)
3322. 
3323. # Script: ZoneWhenFinished
3324. 
3325. # Script: BannerSet
3326. 
3327. # Script: DisplaySetDateTimeRun
3328. 
3329. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
3330. /* Xinclude "..\Display\BannerSet.MyDc"X */
3331. /* pause(1) */
3332. 
3333. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3334. 
3335. Title('!Heading!')
3336. /* pause(1) */
3337. 
3338. /* NOTE: Can't round or truncate to integer precision. */
3339. 
3340. # Script: BannerLog
3341. 
3342. AppendLogfile("!LogFileName!", "!Title!")
3343. 
3344. 
3345. 
3346. # Zone Statistics	
3347. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
3348. 
3349. # Footer:
3350. SetVariable(ZoneFooter, "----------------------------------------------------------
3351. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:42
3352. 
3353. Statistics Report:
3354. ------------------
3355.    Size:  
3356.    ------------------------
3357.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3358.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3359.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3360. 
3361.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3362.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3363. 
3364.    Location:
3365.    ------------------------
3366.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3367.              Files End: !ZoneEndCurrent!
3368.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3369.       
3370.    Gap Settings:
3371.    ------------------------
3372.          Gap Requested: !ZoneGapSizePer!%
3373.       Volume Rounding: !ZoneVolRoundUpPer!%
3374.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3375.                  
3376.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
3377.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
3378.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
3379.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
3380.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
3381.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
3382.      
3383.    Free Space after Zone:
3384.    ------------------------
3385.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3386.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3387.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3388. 
3389. Directory and Files Select:
3390. ---------------------------
3391. !ZoneTypeSelectCurrent!               
3392. ---------------------------
3393. ----------------------------------------------------------
3394. ")
3395. 
3396. AppendLogfile("!LogFileName!", ".")
3397. AppendLogfile("!LogFileName!", "!ZoneFooter!")
3398. AppendLogfile("!LogFileName!", ".")
3399. 
3400. # Zone Footer Set Statistics Window Text
3401. 
3402. SetStatisticsWindowText("----------------------------------------------------------
3403. Zones Processed: 
3404. ----------------------------------------------------------
3405. !ZoneListByLine!
3406. ----------------------------------------------------------
3407. Zone Processing Step:
3408. !ZoneStepByLine!    
3409. ----------------------------------------------------------
3410. Current Zone:
3411. !ZoneFooter!
3412. ----------------------------------------------------------
3413. Volume Statistics:
3414. !VolumeStatisticsDetail!
3415. ----------------------------------------------------------
3416. Zone Detailed Report:
3417. ----------------------------------------------------------
3418. !ZoneStatisticsDetail!
3419. ----------------------------------------------------------
3420. ")
3421. 
3422. 
3423. 
3424. /* pause() */
3425. /* pause() */
3426. 
3427. 
3428. 
3429. 
3430. /* ---------------------------------------------------------- */
3431. # Zone Boot Data (Variable and other).
3432. 	SetVariable(ZoneLabel, 			"!ZoneLabelBootData!")
3433. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBootData!")
3434. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
3435. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
3436. 	SetVariable(ZoneTypeSelect,'
3437.                 # Boot - Data files.
3438.                 not(
3439.                      # Os PageHiberDump start.
3440. (
3441.   FileName("DataStore.edb")
3442.   or FileName("DUMP*.*")
3443.   or FileName("Hiberfil.sys")
3444.   or FileName("MEMORY.DMP")
3445.   or FileName("Pagefile.sys")
3446. )
3447. # Os PageHiberDump end.
3448. 
3449.                 )
3450. ')
3451. 
3452. 		# Script: ZoneDoHeader
3453. 
3454. # Script: ZoneWhenStarted
3455. 
3456. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
3457. # Script: DisplaySetZone
3458. 
3459. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
3460. SetVariable(FileStepDescription,	"")
3461. 
3462. SetVariable(ZoneStepByLine, 			"Zone started.
3463. ")
3464. 
3465. # Script: BannerDescriptionSet
3466. 
3467. # Script: BannerSet
3468. 
3469. # Script: DisplaySetDateTimeRun
3470. 
3471. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
3472. /* Xinclude "..\Display\BannerSet.MyDc"X */
3473. /* pause(1) */
3474. 
3475. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3476. 
3477. Title('!Heading!')
3478. /* pause(1) */
3479. 
3480. /* NOTE: Can't round or truncate to integer precision. */
3481. 
3482. # Script: BannerLog
3483. 
3484. AppendLogfile("!LogFileName!", "!Title!")
3485. 
3486. 
3487. 
3488. pause(1)
3489. 
3490. 
3491. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
3492. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
3493. 
3494. SetVariable(ZoneStepNoCurrent, 0)
3495. 
3496. 
3497. # Script: ZoneDoCurrentClear
3498. 
3499. SetVariable(ZoneTypeSelectCurrent, 		"")
3500. 
3501. SetVariable(ZoneBeginCurrent, 			0)
3502. SetVariable(ZoneBeginPerCurrent, 		0)
3503. SetVariable(ZoneEndCurrent, 			0)
3504. SetVariable(ZoneEndPerCurrent, 			0)
3505. 
3506. SetVariable(ZoneSizeCurrent,			0)
3507. SetVariable(ZoneSizePerCurrent,			0)
3508. 
3509. SetVariable(ZoneGapRequestedCurrent,	0)
3510. SetVariable(ZoneGapRoundedCurrent, 		0)
3511. SetVariable(ZoneGapAdjustedCurrent, 	0)
3512. SetVariable(ZoneGapAvailableCurrent, 	0)
3513. SetVariable(ZoneGapCurrent,				0)
3514. SetVariable(ZoneGapUsedCurrent, 		0)
3515. 
3516. SetVariable(ZoneGapActualCurrent, 		0)
3517. SetVariable(ZoneGapActualPerCurrent, 	0)
3518. 
3519. SetVariable(ZoneSizeActual, 			0)
3520. SetVariable(ZoneSizeActualCurrent,		0)
3521. 
3522. SetVariable(ZoneEndActual, 				0)
3523. SetVariable(ZoneEndActualCurrent,		0)			
3524. SetVariable(ZoneSizeActualPerCurrent, 	0)
3525.       
3526. SetVariable(ZoneFilesFolders,			0)
3527. SetVariable(ZoneFilesFoldersPer,		0) 
3528. 
3529. SetVariable(ZoneFragments,				0)
3530. SetVariable(ZoneFragmentsPer,			0) 
3531. 		
3532. SetVariable(ZoneEndActualCurrent, 		0)
3533. SetVariable(ZoneEndActualPerCurrent, 	0)
3534. 
3535. # Gap Calculation Methodology:
3536. 	# Requested
3537. 	SetVariable(GapRequested, 			0) 
3538. 	SetVariable(GapRequestedStd, 		0) 
3539. 	SetVariable(GapRequestedMft, 		0) 
3540. 	SetVariable(GapRequestedOs, 		0) 
3541. 	SetVariable(GapRequestedOriginal, 	0) 
3542. 	
3543. 	# Gap Adjustments
3544. 	SetVariable(GapRounded, 			0)
3545. 	# SetVariable(GapAdjusted, 			0)
3546. 	SetVariable(GapAvailable, 			0)
3547. 	SetVariable(GapCurrent, 			0)
3548. 	SetVariable(GapActual, 				0)
3549. 	SetVariable(GapUsed, 				0)
3550. 	
3551. 	# Gap Adjustments
3552. 	SetVariable(GapRoundedLoc, 			0)
3553. 	# SetVariable(GapAdjustedLoc, 		0)
3554. 	SetVariable(GapAvailableLoc, 		0)
3555. 	SetVariable(GapCurrentLoc, 			0)
3556. 	SetVariable(GapActualLoc,			0)
3557. 	SetVariable(GapUsedLoc,				0)
3558. 	
3559. 	# Space usage
3560. 	SetVariable(ZoneFreePerRequested, 	0)
3561. 	SetVariable(ZoneFreePerUsed, 		0)
3562. 
3563. # Gap Size & Rounding
3564. 	SetVariable(ZoneGapSizePer, 		0)
3565. 	SetVariable(ZoneVolRoundUpPer, 		0)
3566. 	
3567. 	# Free Space
3568. 	SetVariable(ZoneFreeUsedPer, 		0)
3569. 	SetVariable(ZoneFreeRequestedPer, 	0)
3570. 
3571. 
3572. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
3573. 
3574. # Footer:
3575. SetVariable(ZoneFooter, "----------------------------------------------------------
3576. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:42
3577. 
3578. Statistics Report:
3579. ------------------
3580.    Size:  
3581.    ------------------------
3582.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3583.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3584.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3585. 
3586.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3587.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3588. 
3589.    Location:
3590.    ------------------------
3591.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3592.              Files End: !ZoneEndCurrent!
3593.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3594.       
3595.    Gap Settings:
3596.    ------------------------
3597.          Gap Requested: !ZoneGapSizePer!%
3598.       Volume Rounding: !ZoneVolRoundUpPer!%
3599.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3600.                  
3601.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
3602.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
3603.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
3604.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
3605.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
3606.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
3607.      
3608.    Free Space after Zone:
3609.    ------------------------
3610.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3611.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3612.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3613. 
3614. Directory and Files Select:
3615. ---------------------------
3616. !ZoneTypeSelectCurrent!               
3617. ---------------------------
3618. ----------------------------------------------------------
3619. ")
3620. 
3621. # Script: BannerSet
3622. 
3623. # Script: DisplaySetDateTimeRun
3624. 
3625. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
3626. /* Xinclude "..\Display\BannerSet.MyDc"X */
3627. /* pause(1) */
3628. 
3629. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3630. 
3631. Title('!Heading!')
3632. /* pause(1) */
3633. 
3634. /* NOTE: Can't round or truncate to integer precision. */
3635. 
3636. # Script: BannerLog
3637. 
3638. AppendLogfile("!LogFileName!", "!Title!")
3639. 
3640. 
3641. 
3642. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
3643. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
3644. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:42")
3645. 
3646. SetVariable(ZoneListByLine, "!ZoneListByLine!
3647. Zone: !ZoneNoCurrent! 2021-11-09 20:22:42 0:00:01 !ZoneLabel! !ZoneDescription!")
3648. 
3649. 
3650. /* Fixed Zone Position Handling */
3651. /* Literal number: */
3652. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
3653. /* Percentage of disk: */
3654. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
3655. /* Gap */
3656. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
3657. 
3658. /* ---------------------------------------------------------- */
3659. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
3660. # Script: DisplaySetFileStep
3661. 
3662. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3663. 
3664. /* add message and move to a new line. */
3665. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3666. ")
3667. 
3668. /* display the line. (hopefully.) */
3669. # Zone Footer Set Statistics Window Text
3670. 
3671. SetStatisticsWindowText("----------------------------------------------------------
3672. Zones Processed: 
3673. ----------------------------------------------------------
3674. !ZoneListByLine!
3675. ----------------------------------------------------------
3676. Zone Processing Step:
3677. !ZoneStepByLine!    
3678. ----------------------------------------------------------
3679. Current Zone:
3680. !ZoneFooter!
3681. ----------------------------------------------------------
3682. Volume Statistics:
3683. !VolumeStatisticsDetail!
3684. ----------------------------------------------------------
3685. Zone Detailed Report:
3686. ----------------------------------------------------------
3687. !ZoneStatisticsDetail!
3688. ----------------------------------------------------------
3689. ")
3690. 
3691. 
3692. 
3693. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3694. 
3695. # Script: BannerSet
3696. 
3697. # Script: DisplaySetDateTimeRun
3698. 
3699. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
3700. /* Xinclude "..\Display\BannerSet.MyDc"X */
3701. /* pause(1) */
3702. 
3703. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3704. 
3705. Title('!Heading!')
3706. /* pause(1) */
3707. 
3708. /* NOTE: Can't round or truncate to integer precision. */
3709. 
3710. pause(1)
3711. 
3712. # your stuff HERE (X)... pre file select code.
3713. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
3714. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3715. 	# (X)
3716. 
3717. FileSelect
3718. 
3719. 	# your stuff can't really go here (errors.)
3720. 	# maybe for some reason I don't know of...
3721. 	
3722. 	# Actions next...
3723. 		# Script: ZoneDo ZoneTypeSelectOsBoot
3724. # Boot start.
3725. ImportListFromBootOptimize()
3726. # Boot end.
3727. 
3728. 		and not(
3729. 			# Os PageHiberDump start.
3730. (
3731.   FileName("DataStore.edb")
3732.   or FileName("DUMP*.*")
3733.   or FileName("Hiberfil.sys")
3734.   or FileName("MEMORY.DMP")
3735.   or FileName("Pagefile.sys")
3736. )
3737. # Os PageHiberDump end.
3738. 
3739. 		)
3740. 
3741. 	FileActions
3742. 		  		/* ---------------------------------------------------------- */
3743. 	# Gap
3744. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
3745. 		# Script: DisplaySetFileStep
3746. 
3747. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3748. 
3749. /* add message and move to a new line. */
3750. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3751. ")
3752. 
3753. /* display the line. (hopefully.) */
3754. # Zone Footer Set Statistics Window Text
3755. 
3756. SetStatisticsWindowText("----------------------------------------------------------
3757. Zones Processed: 
3758. ----------------------------------------------------------
3759. !ZoneListByLine!
3760. ----------------------------------------------------------
3761. Zone Processing Step:
3762. !ZoneStepByLine!    
3763. ----------------------------------------------------------
3764. Current Zone:
3765. !ZoneFooter!
3766. ----------------------------------------------------------
3767. Volume Statistics:
3768. !VolumeStatisticsDetail!
3769. ----------------------------------------------------------
3770. Zone Detailed Report:
3771. ----------------------------------------------------------
3772. !ZoneStatisticsDetail!
3773. ----------------------------------------------------------
3774. ")
3775. 
3776. 
3777. 
3778. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3779. 
3780. # Script: BannerSet
3781. 
3782. # Script: DisplaySetDateTimeRun
3783. 
3784. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
3785. /* Xinclude "..\Display\BannerSet.MyDc"X */
3786. /* pause(1) */
3787. 
3788. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3789. 
3790. Title('!Heading!')
3791. /* pause(1) */
3792. 
3793. /* NOTE: Can't round or truncate to integer precision. */
3794. 
3795. pause(1)
3796. 	
3797. 	# ACTUAL GAP
3798. 		/* AddGap Variant. */
3799. 	  	# Zone Do Gap
3800. # Gap Calculation Methods:
3801. 
3802. /* 1) Anything you need to add first. */
3803. /* empty */
3804. 
3805. /* ---------------------------------------------------------- */
3806. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
3807. 	# GapRequestedStd.
3808. 
3809. 		/* ---------------------------------------------------------- */
3810. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
3811. 
3812. 		# Gap Calculation Methods:
3813. 
3814. /* AddGap Variants */
3815. 
3816. 	/* Standard */
3817. 		# Gap Calculation Methods:
3818. 	/* AddGap Variants */
3819. 	/* Standard */
3820. 
3821. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
3822. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
3823. 
3824. 	SetVariable(GapRequested, GapRequestedStd)
3825. 	
3826. 
3827. 	/* MFT Low High Method */
3828. 		# Gap Calculation Methods:
3829. 	/* AddGap Variants */
3830. 	/* MFT Low High Method */
3831. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
3832. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
3833. 	SetVariable(GapRequested, GapRequestedMft)
3834. 	
3835. 
3836. 	/* OS Volume Type Method */
3837. 		# Gap Calculation Methods:
3838. 	/* AddGap Variants */
3839. 	/* OS Volume Type Method */
3840. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
3841. 	SetVariable(GapRequested, GapRequestedOs)
3842. 
3843. 
3844. 
3845. /* MakeGap Variants */
3846. 
3847. 	/* Original Os 1-3 + MFT 2 */
3848. 		# Gap Calculation Methods:
3849. 	/* MakeGap Variants */
3850. 	/* Original Os 1-3 + MFT 2 */
3851. 	/* plus MFT gap placed inline at the dividing zone. */
3852. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
3853. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
3854. 	SetVariable(GapRequested, GapRequestedOrig)
3855. 	
3856. 	
3857. /* Note: You could comment out the ones not in use */
3858. /* However having the data in the log is useful. */
3859. /* Therefore the following line is otherwise needed. */
3860. 
3861. /* Standard used */
3862. 
3863. SetVariable(GapRequested, GapRequestedStd)
3864. 
3865. # Gap Calculation Methods:
3866. 
3867. /* AddGap Variants */
3868. 	/* Standard */
3869. 	/* MFT Low High Method */
3870. 	/* OS Volume Type Method */
3871. 
3872. /* MakeGap Variants */
3873. 	/* Original Os 1-3 + MFT 2 */
3874. 
3875. /* Note: You could comment out the ones not in use */
3876. /* However having the data in the log is useful. */
3877. /* Therefore the following line is otherwise needed. */
3878. 
3879. /* Standard is used currently */
3880. 
3881. 
3882. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
3883. 
3884. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
3885. 
3886. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
3887. 
3888. /* ---------------------------------------------------------- */
3889. /* 3) SMALL ZONE ADJUSTMENT. */
3890. /* Gab cant be larger than half the Zone Size. */
3891. 
3892. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
3893. 	
3894. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
3895. 
3896. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
3897. 
3898. /* ---------------------------------------------------------- */
3899. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
3900. # Gap Adjustments.
3901. 
3902. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
3903. 	
3904. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
3905. 
3906. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
3907. 
3908. /* ---------------------------------------------------------- */
3909. # BYPASS THIS.
3910. 	/* This is definitely wrong. */
3911. 	/* The question is can we steal gap from the next zone */
3912. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
3913. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
3914. 		# Zone Overflow.
3915. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
3916. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
3917. 
3918. /* ---------------------------------------------------------- */
3919. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
3920. # Remaining free space available.
3921. 
3922. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
3923. 	
3924. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
3925. 
3926. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
3927. 
3928. /* ---------------------------------------------------------- */
3929. # CURRENT gap to use.
3930. 
3931. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
3932. 
3933. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
3934. 
3935. /* ---------------------------------------------------------- */
3936. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
3937. # Debugging.
3938. 
3939. 	SetVariable(GapUsed, GapCurrent) // for debugging
3940. 
3941. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
3942. 
3943. 		# Your code HERE
3944. 
3945. /* ---------------------------------------------------------- */
3946. /* 7) YOUR CODE. */
3947. # YOUR CODE HERE:
3948. 	# INPUT: GapCurrent or GapCurrentLoc
3949. 	# OUTPUT: GapUsed...
3950. 
3951. /* ---------------------------------------------------------- */
3952. # Gap Size.
3953. # Actual Size of Gap.
3954. 
3955. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
3956. 
3957. /* ---------------------------------------------------------- */
3958. /* xxxxxxxxxxxxxxxxxxxxxx */
3959. # ADD THE GAP
3960. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
3961. /* xxxxxxxxxxxxxxxxxxxxxx */
3962. 
3963. 	
3964. 	# Zone Statistics	
3965. 	# Script: ZoneDoStatistics
3966. # Zone / Volume Statistics and Display
3967. 		
3968. 	# Accumulate Totals
3969.   	# Script: ZoneDoVolumeTotals
3970. 
3971. /* Current total space used (by Zones and Gaps) */
3972. 
3973. SetVariable(VolumeZoneUsed, GapUsed)
3974. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
3975. /* Percentage */
3976. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
3977. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
3978. 
3979. /* Current total of free space requested */
3980. 
3981. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
3982. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3983. /* Percent. */
3984. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
3985. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3986. 
3987. /* Current total of free space used */
3988. 
3989. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
3990. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
3991. /* Percent */
3992. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
3993. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
3994. 
3995. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
3996. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
3997. /* Xinclude "..\DebugDisplayPause.MyDc"X */
3998. 
3999. 
4000. 	# Current Values
4001. 	# Script: ZoneDoCurrentSet
4002. 
4003. # Cluster, Sector, Block adjust for display.
4004. 	# Bytes per cluster is volume specific.
4005. 
4006. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
4007. 
4008. # Current Zone values.
4009. 	# Begin, end and size.
4010. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
4011. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
4012. 
4013. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
4014. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
4015. 
4016. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
4017. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
4018. 
4019. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
4020. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
4021. 
4022. 	SetVariable(ZoneFragments,				"!ZONE210N!")
4023. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
4024. 		
4025. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
4026. /* identical code to here: (separation not needed. TEST.) */	
4027. 
4028. # Current Gap, Actual and Free Values
4029. 	# Gap
4030. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
4031. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
4032. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
4033. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
4034. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
4035. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
4036. 	
4037. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
4038. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
4039. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
4040. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
4041. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
4042. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
4043. 	
4044. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
4045. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
4046. 	
4047. 	# Actual Size and End
4048. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
4049. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
4050. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
4051. 	
4052. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
4053. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
4054. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
4055. 
4056. # Gap Size & Rounding
4057. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
4058. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
4059. 	
4060. 	# Free Space
4061. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
4062. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
4063. 
4064. 	# Footer:
4065. SetVariable(ZoneFooter, "----------------------------------------------------------
4066. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:42
4067. 
4068. Statistics Report:
4069. ------------------
4070.    Size:  
4071.    ------------------------
4072.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4073.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4074.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4075. 
4076.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4077.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4078. 
4079.    Location:
4080.    ------------------------
4081.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4082.              Files End: !ZoneEndCurrent!
4083.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4084.       
4085.    Gap Settings:
4086.    ------------------------
4087.          Gap Requested: !ZoneGapSizePer!%
4088.       Volume Rounding: !ZoneVolRoundUpPer!%
4089.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4090.                  
4091.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4092.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4093.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4094.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4095.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4096.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4097.      
4098.    Free Space after Zone:
4099.    ------------------------
4100.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4101.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4102.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4103. 
4104. Directory and Files Select:
4105. ---------------------------
4106. !ZoneTypeSelectCurrent!               
4107. ---------------------------
4108. ----------------------------------------------------------
4109. ")
4110. 	# Zone Footer Set Statistics Window Text
4111. 
4112. SetStatisticsWindowText("----------------------------------------------------------
4113. Zones Processed: 
4114. ----------------------------------------------------------
4115. !ZoneListByLine!
4116. ----------------------------------------------------------
4117. Zone Processing Step:
4118. !ZoneStepByLine!    
4119. ----------------------------------------------------------
4120. Current Zone:
4121. !ZoneFooter!
4122. ----------------------------------------------------------
4123. Volume Statistics:
4124. !VolumeStatisticsDetail!
4125. ----------------------------------------------------------
4126. Zone Detailed Report:
4127. ----------------------------------------------------------
4128. !ZoneStatisticsDetail!
4129. ----------------------------------------------------------
4130. ")
4131. 
4132. 
4133. 	
4134.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
4135. 
4136. 	# Add Zone to list of zones for display.
4137. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
4138. 	# ??? Free Stats?
4139. 	# Footer:
4140. SetVariable(ZoneFooter, "----------------------------------------------------------
4141. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:42
4142. 
4143. Statistics Report:
4144. ------------------
4145.    Size:  
4146.    ------------------------
4147.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4148.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4149.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4150. 
4151.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4152.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4153. 
4154.    Location:
4155.    ------------------------
4156.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4157.              Files End: !ZoneEndCurrent!
4158.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4159.       
4160.    Gap Settings:
4161.    ------------------------
4162.          Gap Requested: !ZoneGapSizePer!%
4163.       Volume Rounding: !ZoneVolRoundUpPer!%
4164.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4165.                  
4166.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4167.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4168.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4169.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4170.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4171.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4172.      
4173.    Free Space after Zone:
4174.    ------------------------
4175.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4176.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4177.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4178. 
4179. Directory and Files Select:
4180. ---------------------------
4181. !ZoneTypeSelectCurrent!               
4182. ---------------------------
4183. ----------------------------------------------------------
4184. ")
4185. 
4186. 	# Add Zone Details to Report.	
4187. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
4188. !ZoneFooter!")
4189. 
4190. 
4191. 	
4192. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
4193. 			# Script: DisplaySetFileStep
4194. 
4195. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4196. 
4197. /* add message and move to a new line. */
4198. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4199. ")
4200. 
4201. /* display the line. (hopefully.) */
4202. # Zone Footer Set Statistics Window Text
4203. 
4204. SetStatisticsWindowText("----------------------------------------------------------
4205. Zones Processed: 
4206. ----------------------------------------------------------
4207. !ZoneListByLine!
4208. ----------------------------------------------------------
4209. Zone Processing Step:
4210. !ZoneStepByLine!    
4211. ----------------------------------------------------------
4212. Current Zone:
4213. !ZoneFooter!
4214. ----------------------------------------------------------
4215. Volume Statistics:
4216. !VolumeStatisticsDetail!
4217. ----------------------------------------------------------
4218. Zone Detailed Report:
4219. ----------------------------------------------------------
4220. !ZoneStatisticsDetail!
4221. ----------------------------------------------------------
4222. ")
4223. 
4224. 
4225. 
4226. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4227. 
4228. # Script: BannerSet
4229. 
4230. # Script: DisplaySetDateTimeRun
4231. 
4232. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
4233. /* Xinclude "..\Display\BannerSet.MyDc"X */
4234. /* pause(1) */
4235. 
4236. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4237. 
4238. Title('!Heading!')
4239. /* pause(1) */
4240. 
4241. /* NOTE: Can't round or truncate to integer precision. */
4242. 
4243. pause(1)
4244. 
4245. 			# File Action - Os Boot -  SortByName.
4246. # File Action - SortByName.
4247. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
4248. 	
4249. 	
4250. 	
4251. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
4252. 			# Script: DisplaySetFileStep
4253. 
4254. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4255. 
4256. /* add message and move to a new line. */
4257. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4258. ")
4259. 
4260. /* display the line. (hopefully.) */
4261. # Zone Footer Set Statistics Window Text
4262. 
4263. SetStatisticsWindowText("----------------------------------------------------------
4264. Zones Processed: 
4265. ----------------------------------------------------------
4266. !ZoneListByLine!
4267. ----------------------------------------------------------
4268. Zone Processing Step:
4269. !ZoneStepByLine!    
4270. ----------------------------------------------------------
4271. Current Zone:
4272. !ZoneFooter!
4273. ----------------------------------------------------------
4274. Volume Statistics:
4275. !VolumeStatisticsDetail!
4276. ----------------------------------------------------------
4277. Zone Detailed Report:
4278. ----------------------------------------------------------
4279. !ZoneStatisticsDetail!
4280. ----------------------------------------------------------
4281. ")
4282. 
4283. 
4284. 
4285. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4286. 
4287. # Script: BannerSet
4288. 
4289. # Script: DisplaySetDateTimeRun
4290. 
4291. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:42 0:00:01")
4292. /* Xinclude "..\Display\BannerSet.MyDc"X */
4293. /* pause(1) */
4294. 
4295. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4296. 
4297. Title('!Heading!')
4298. /* pause(1) */
4299. 
4300. /* NOTE: Can't round or truncate to integer precision. */
4301. 
4302. pause(1)
4303. 
4304. 		# Script: ZoneDoFooter
4305. 
4306. /* ---------------------------------------------------------- */
4307. # File Select
4308. 	# Select Statments
4309. # File Actions 
4310. 	# Standard or OS File Actions.
4311. 	# Resume...
4312. 	
4313. 	# your stuff HERE (X)... post zone (file) file actions code.
4314. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
4315. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4316. 		# (X)
4317. 		
4318. 		/* ??? Set window? */
4319. 	
4320. 	# ADD THE GAP
4321. 		
4322. # Vacate (good for diagnostics)
4323. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
4324. 
4325. # DoNotVacate - DO NOT Vacate (recommended)
4326. 
4327. # Vacate
4328. /* AddGap(GapUsedLoc) */
4329. 
4330. # DO Not Vacate
4331. AddGap(GapUsedLoc, DoNotVacate) 
4332. 	
4333. 	
4334. /* ---------------------------------------------------------- */
4335. # (failed) TEST for boolean logic.
4336. 
4337. /* It should work in the gap calculations for turning options */
4338. /* on and off but it will NOT work here. */
4339. 
4340. /* Boolean setting X or FlagX. */
4341. /* Where X will be on or off: */
4342. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
4343. /*      For ON:  (X  *  FlagAny) */
4344. 
4345. /* 1) Failed, zero gap overrode the previous one. */
4346. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
4347. /* AddGap(GapUsedTemp) */ 
4348. 
4349. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
4350. /* AddGap(GapUsedTemp, DoNotVacate) */ 
4351. 
4352. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
4353. 
4354. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
4355. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
4356. /* AddGap(GapUsedTemp) */ 
4357. 
4358. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
4359. /* AddGap(GapUsedTemp, DoNotVacate) */ 
4360. 
4361. /* ---------------------------------------------------------- */
4362. 
4363. # Vacate
4364. /* AddGap(GapUsed) */
4365. 
4366. # DO NOT Vacate (recommended)
4367. /* AddGap(GapUsed, DoNotVacate) */ 
4368. 	
4369. 
4370. 		
4371. # 
4372. FileEnd
4373. /* ---------------------------------------------------------- */
4374. 
4375. # your stuff HERE (X)... post zone (file) code.
4376. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
4377. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4378. 	# (X)
4379. 
4380. SetVariable(FileStepDescription,"Zone finished, reporting.")
4381. # Script: DisplaySetFileStep
4382. 
4383. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4384. 
4385. /* add message and move to a new line. */
4386. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4387. ")
4388. 
4389. /* display the line. (hopefully.) */
4390. # Zone Footer Set Statistics Window Text
4391. 
4392. SetStatisticsWindowText("----------------------------------------------------------
4393. Zones Processed: 
4394. ----------------------------------------------------------
4395. !ZoneListByLine!
4396. ----------------------------------------------------------
4397. Zone Processing Step:
4398. !ZoneStepByLine!    
4399. ----------------------------------------------------------
4400. Current Zone:
4401. !ZoneFooter!
4402. ----------------------------------------------------------
4403. Volume Statistics:
4404. !VolumeStatisticsDetail!
4405. ----------------------------------------------------------
4406. Zone Detailed Report:
4407. ----------------------------------------------------------
4408. !ZoneStatisticsDetail!
4409. ----------------------------------------------------------
4410. ")
4411. 
4412. 
4413. 
4414. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4415. 
4416. # Script: BannerSet
4417. 
4418. # Script: DisplaySetDateTimeRun
4419. 
4420. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
4421. /* Xinclude "..\Display\BannerSet.MyDc"X */
4422. /* pause(1) */
4423. 
4424. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4425. 
4426. Title('!Heading!')
4427. /* pause(1) */
4428. 
4429. /* NOTE: Can't round or truncate to integer precision. */
4430. 
4431. pause(1)
4432. 
4433. # Script: ZoneWhenFinished
4434. 
4435. # Script: BannerSet
4436. 
4437. # Script: DisplaySetDateTimeRun
4438. 
4439. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
4440. /* Xinclude "..\Display\BannerSet.MyDc"X */
4441. /* pause(1) */
4442. 
4443. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4444. 
4445. Title('!Heading!')
4446. /* pause(1) */
4447. 
4448. /* NOTE: Can't round or truncate to integer precision. */
4449. 
4450. # Script: BannerLog
4451. 
4452. AppendLogfile("!LogFileName!", "!Title!")
4453. 
4454. 
4455. 
4456. # Zone Statistics	
4457. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
4458. 
4459. # Footer:
4460. SetVariable(ZoneFooter, "----------------------------------------------------------
4461. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
4462. 
4463. Statistics Report:
4464. ------------------
4465.    Size:  
4466.    ------------------------
4467.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4468.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4469.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4470. 
4471.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4472.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4473. 
4474.    Location:
4475.    ------------------------
4476.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4477.              Files End: !ZoneEndCurrent!
4478.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4479.       
4480.    Gap Settings:
4481.    ------------------------
4482.          Gap Requested: !ZoneGapSizePer!%
4483.       Volume Rounding: !ZoneVolRoundUpPer!%
4484.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4485.                  
4486.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4487.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4488.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4489.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4490.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4491.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4492.      
4493.    Free Space after Zone:
4494.    ------------------------
4495.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4496.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4497.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4498. 
4499. Directory and Files Select:
4500. ---------------------------
4501. !ZoneTypeSelectCurrent!               
4502. ---------------------------
4503. ----------------------------------------------------------
4504. ")
4505. 
4506. AppendLogfile("!LogFileName!", ".")
4507. AppendLogfile("!LogFileName!", "!ZoneFooter!")
4508. AppendLogfile("!LogFileName!", ".")
4509. 
4510. # Zone Footer Set Statistics Window Text
4511. 
4512. SetStatisticsWindowText("----------------------------------------------------------
4513. Zones Processed: 
4514. ----------------------------------------------------------
4515. !ZoneListByLine!
4516. ----------------------------------------------------------
4517. Zone Processing Step:
4518. !ZoneStepByLine!    
4519. ----------------------------------------------------------
4520. Current Zone:
4521. !ZoneFooter!
4522. ----------------------------------------------------------
4523. Volume Statistics:
4524. !VolumeStatisticsDetail!
4525. ----------------------------------------------------------
4526. Zone Detailed Report:
4527. ----------------------------------------------------------
4528. !ZoneStatisticsDetail!
4529. ----------------------------------------------------------
4530. ")
4531. 
4532. 
4533. 
4534. /* pause() */
4535. /* pause() */
4536. 
4537. 
4538. 
4539. 
4540. /* ---------------------------------------------------------- */
4541. 
4542. 
4543. /* ---------------------------------------------------------- */
4544. # Zone ProgramHints Fixed.
4545. # Script: DefragZoneTypeOsProgramHints
4546. /* ---------------------------------------------------------- */
4547. # Zone ProgramHints Fixed.
4548. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHints!")
4549. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHints!")
4550. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
4551. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHints!")
4552. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsProgramHints
4553. # ProgramHints start.
4554. ImportListFromProgramHints("*.pf")
4555. # ProgramHints end.
4556. ')
4557. 
4558. 		# Script: ZoneDoHeader
4559. 
4560. # Script: ZoneWhenStarted
4561. 
4562. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
4563. # Script: DisplaySetZone
4564. 
4565. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
4566. SetVariable(FileStepDescription,	"")
4567. 
4568. SetVariable(ZoneStepByLine, 			"Zone started.
4569. ")
4570. 
4571. # Script: BannerDescriptionSet
4572. 
4573. # Script: BannerSet
4574. 
4575. # Script: DisplaySetDateTimeRun
4576. 
4577. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
4578. /* Xinclude "..\Display\BannerSet.MyDc"X */
4579. /* pause(1) */
4580. 
4581. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4582. 
4583. Title('!Heading!')
4584. /* pause(1) */
4585. 
4586. /* NOTE: Can't round or truncate to integer precision. */
4587. 
4588. # Script: BannerLog
4589. 
4590. AppendLogfile("!LogFileName!", "!Title!")
4591. 
4592. 
4593. 
4594. pause(1)
4595. 
4596. 
4597. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
4598. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
4599. 
4600. SetVariable(ZoneStepNoCurrent, 0)
4601. 
4602. 
4603. # Script: ZoneDoCurrentClear
4604. 
4605. SetVariable(ZoneTypeSelectCurrent, 		"")
4606. 
4607. SetVariable(ZoneBeginCurrent, 			0)
4608. SetVariable(ZoneBeginPerCurrent, 		0)
4609. SetVariable(ZoneEndCurrent, 			0)
4610. SetVariable(ZoneEndPerCurrent, 			0)
4611. 
4612. SetVariable(ZoneSizeCurrent,			0)
4613. SetVariable(ZoneSizePerCurrent,			0)
4614. 
4615. SetVariable(ZoneGapRequestedCurrent,	0)
4616. SetVariable(ZoneGapRoundedCurrent, 		0)
4617. SetVariable(ZoneGapAdjustedCurrent, 	0)
4618. SetVariable(ZoneGapAvailableCurrent, 	0)
4619. SetVariable(ZoneGapCurrent,				0)
4620. SetVariable(ZoneGapUsedCurrent, 		0)
4621. 
4622. SetVariable(ZoneGapActualCurrent, 		0)
4623. SetVariable(ZoneGapActualPerCurrent, 	0)
4624. 
4625. SetVariable(ZoneSizeActual, 			0)
4626. SetVariable(ZoneSizeActualCurrent,		0)
4627. 
4628. SetVariable(ZoneEndActual, 				0)
4629. SetVariable(ZoneEndActualCurrent,		0)			
4630. SetVariable(ZoneSizeActualPerCurrent, 	0)
4631.       
4632. SetVariable(ZoneFilesFolders,			0)
4633. SetVariable(ZoneFilesFoldersPer,		0) 
4634. 
4635. SetVariable(ZoneFragments,				0)
4636. SetVariable(ZoneFragmentsPer,			0) 
4637. 		
4638. SetVariable(ZoneEndActualCurrent, 		0)
4639. SetVariable(ZoneEndActualPerCurrent, 	0)
4640. 
4641. # Gap Calculation Methodology:
4642. 	# Requested
4643. 	SetVariable(GapRequested, 			0) 
4644. 	SetVariable(GapRequestedStd, 		0) 
4645. 	SetVariable(GapRequestedMft, 		0) 
4646. 	SetVariable(GapRequestedOs, 		0) 
4647. 	SetVariable(GapRequestedOriginal, 	0) 
4648. 	
4649. 	# Gap Adjustments
4650. 	SetVariable(GapRounded, 			0)
4651. 	# SetVariable(GapAdjusted, 			0)
4652. 	SetVariable(GapAvailable, 			0)
4653. 	SetVariable(GapCurrent, 			0)
4654. 	SetVariable(GapActual, 				0)
4655. 	SetVariable(GapUsed, 				0)
4656. 	
4657. 	# Gap Adjustments
4658. 	SetVariable(GapRoundedLoc, 			0)
4659. 	# SetVariable(GapAdjustedLoc, 		0)
4660. 	SetVariable(GapAvailableLoc, 		0)
4661. 	SetVariable(GapCurrentLoc, 			0)
4662. 	SetVariable(GapActualLoc,			0)
4663. 	SetVariable(GapUsedLoc,				0)
4664. 	
4665. 	# Space usage
4666. 	SetVariable(ZoneFreePerRequested, 	0)
4667. 	SetVariable(ZoneFreePerUsed, 		0)
4668. 
4669. # Gap Size & Rounding
4670. 	SetVariable(ZoneGapSizePer, 		0)
4671. 	SetVariable(ZoneVolRoundUpPer, 		0)
4672. 	
4673. 	# Free Space
4674. 	SetVariable(ZoneFreeUsedPer, 		0)
4675. 	SetVariable(ZoneFreeRequestedPer, 	0)
4676. 
4677. 
4678. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
4679. 
4680. # Footer:
4681. SetVariable(ZoneFooter, "----------------------------------------------------------
4682. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
4683. 
4684. Statistics Report:
4685. ------------------
4686.    Size:  
4687.    ------------------------
4688.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4689.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4690.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4691. 
4692.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4693.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4694. 
4695.    Location:
4696.    ------------------------
4697.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4698.              Files End: !ZoneEndCurrent!
4699.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4700.       
4701.    Gap Settings:
4702.    ------------------------
4703.          Gap Requested: !ZoneGapSizePer!%
4704.       Volume Rounding: !ZoneVolRoundUpPer!%
4705.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4706.                  
4707.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4708.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4709.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4710.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4711.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4712.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4713.      
4714.    Free Space after Zone:
4715.    ------------------------
4716.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4717.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4718.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4719. 
4720. Directory and Files Select:
4721. ---------------------------
4722. !ZoneTypeSelectCurrent!               
4723. ---------------------------
4724. ----------------------------------------------------------
4725. ")
4726. 
4727. # Script: BannerSet
4728. 
4729. # Script: DisplaySetDateTimeRun
4730. 
4731. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
4732. /* Xinclude "..\Display\BannerSet.MyDc"X */
4733. /* pause(1) */
4734. 
4735. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4736. 
4737. Title('!Heading!')
4738. /* pause(1) */
4739. 
4740. /* NOTE: Can't round or truncate to integer precision. */
4741. 
4742. # Script: BannerLog
4743. 
4744. AppendLogfile("!LogFileName!", "!Title!")
4745. 
4746. 
4747. 
4748. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
4749. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
4750. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:43")
4751. 
4752. SetVariable(ZoneListByLine, "!ZoneListByLine!
4753. Zone: !ZoneNoCurrent! 2021-11-09 20:22:43 0:00:02 !ZoneLabel! !ZoneDescription!")
4754. 
4755. 
4756. /* Fixed Zone Position Handling */
4757. /* Literal number: */
4758. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
4759. /* Percentage of disk: */
4760. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
4761. /* Gap */
4762. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
4763. 
4764. /* ---------------------------------------------------------- */
4765. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
4766. # Script: DisplaySetFileStep
4767. 
4768. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4769. 
4770. /* add message and move to a new line. */
4771. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4772. ")
4773. 
4774. /* display the line. (hopefully.) */
4775. # Zone Footer Set Statistics Window Text
4776. 
4777. SetStatisticsWindowText("----------------------------------------------------------
4778. Zones Processed: 
4779. ----------------------------------------------------------
4780. !ZoneListByLine!
4781. ----------------------------------------------------------
4782. Zone Processing Step:
4783. !ZoneStepByLine!    
4784. ----------------------------------------------------------
4785. Current Zone:
4786. !ZoneFooter!
4787. ----------------------------------------------------------
4788. Volume Statistics:
4789. !VolumeStatisticsDetail!
4790. ----------------------------------------------------------
4791. Zone Detailed Report:
4792. ----------------------------------------------------------
4793. !ZoneStatisticsDetail!
4794. ----------------------------------------------------------
4795. ")
4796. 
4797. 
4798. 
4799. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4800. 
4801. # Script: BannerSet
4802. 
4803. # Script: DisplaySetDateTimeRun
4804. 
4805. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
4806. /* Xinclude "..\Display\BannerSet.MyDc"X */
4807. /* pause(1) */
4808. 
4809. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4810. 
4811. Title('!Heading!')
4812. /* pause(1) */
4813. 
4814. /* NOTE: Can't round or truncate to integer precision. */
4815. 
4816. pause(1)
4817. 
4818. # your stuff HERE (X)... pre file select code.
4819. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
4820. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4821. 	# (X)
4822. 
4823. FileSelect
4824. 
4825. 	# your stuff can't really go here (errors.)
4826. 	# maybe for some reason I don't know of...
4827. 	
4828. 	# Actions next...
4829. 		# Script: ZoneDo ZoneTypeSelectOsProgramHints
4830. # ProgramHints start.
4831. ImportListFromProgramHints("*.pf")
4832. # ProgramHints end.
4833. 
4834. 		and not(
4835. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
4836. # Os Data Dynamic start.
4837. (
4838. # Os Data Dynamic start.
4839. (
4840.   FileName("*.dat*")
4841.   or FileName("*.db*")
4842.   or FileName("*.edb*")
4843.   or FileName("*.log*")
4844.   or FileName("DataStore.edb")
4845. )
4846. # Os Data Dynamic end.
4847. 
4848.   or 
4849. # Os PageHiberDump start.
4850. (
4851.   FileName("DataStore.edb")
4852.   or FileName("DUMP*.*")
4853.   or FileName("Hiberfil.sys")
4854.   or FileName("MEMORY.DMP")
4855.   or FileName("Pagefile.sys")
4856. )
4857. # Os PageHiberDump end.
4858. 
4859. # Os Data Dynamic
4860. )
4861. # Os Data Dynamic end.
4862. 
4863. 		)
4864. 
4865. 		FileActions
4866. 		  		/* ---------------------------------------------------------- */
4867. 	# Gap
4868. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
4869. 		# Script: DisplaySetFileStep
4870. 
4871. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4872. 
4873. /* add message and move to a new line. */
4874. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4875. ")
4876. 
4877. /* display the line. (hopefully.) */
4878. # Zone Footer Set Statistics Window Text
4879. 
4880. SetStatisticsWindowText("----------------------------------------------------------
4881. Zones Processed: 
4882. ----------------------------------------------------------
4883. !ZoneListByLine!
4884. ----------------------------------------------------------
4885. Zone Processing Step:
4886. !ZoneStepByLine!    
4887. ----------------------------------------------------------
4888. Current Zone:
4889. !ZoneFooter!
4890. ----------------------------------------------------------
4891. Volume Statistics:
4892. !VolumeStatisticsDetail!
4893. ----------------------------------------------------------
4894. Zone Detailed Report:
4895. ----------------------------------------------------------
4896. !ZoneStatisticsDetail!
4897. ----------------------------------------------------------
4898. ")
4899. 
4900. 
4901. 
4902. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4903. 
4904. # Script: BannerSet
4905. 
4906. # Script: DisplaySetDateTimeRun
4907. 
4908. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
4909. /* Xinclude "..\Display\BannerSet.MyDc"X */
4910. /* pause(1) */
4911. 
4912. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4913. 
4914. Title('!Heading!')
4915. /* pause(1) */
4916. 
4917. /* NOTE: Can't round or truncate to integer precision. */
4918. 
4919. pause(1)
4920. 	
4921. 	# ACTUAL GAP
4922. 		/* AddGap Variant. */
4923. 	  	# Zone Do Gap
4924. # Gap Calculation Methods:
4925. 
4926. /* 1) Anything you need to add first. */
4927. /* empty */
4928. 
4929. /* ---------------------------------------------------------- */
4930. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
4931. 	# GapRequestedStd.
4932. 
4933. 		/* ---------------------------------------------------------- */
4934. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
4935. 
4936. 		# Gap Calculation Methods:
4937. 
4938. /* AddGap Variants */
4939. 
4940. 	/* Standard */
4941. 		# Gap Calculation Methods:
4942. 	/* AddGap Variants */
4943. 	/* Standard */
4944. 
4945. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
4946. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
4947. 
4948. 	SetVariable(GapRequested, GapRequestedStd)
4949. 	
4950. 
4951. 	/* MFT Low High Method */
4952. 		# Gap Calculation Methods:
4953. 	/* AddGap Variants */
4954. 	/* MFT Low High Method */
4955. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
4956. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
4957. 	SetVariable(GapRequested, GapRequestedMft)
4958. 	
4959. 
4960. 	/* OS Volume Type Method */
4961. 		# Gap Calculation Methods:
4962. 	/* AddGap Variants */
4963. 	/* OS Volume Type Method */
4964. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
4965. 	SetVariable(GapRequested, GapRequestedOs)
4966. 
4967. 
4968. 
4969. /* MakeGap Variants */
4970. 
4971. 	/* Original Os 1-3 + MFT 2 */
4972. 		# Gap Calculation Methods:
4973. 	/* MakeGap Variants */
4974. 	/* Original Os 1-3 + MFT 2 */
4975. 	/* plus MFT gap placed inline at the dividing zone. */
4976. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
4977. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
4978. 	SetVariable(GapRequested, GapRequestedOrig)
4979. 	
4980. 	
4981. /* Note: You could comment out the ones not in use */
4982. /* However having the data in the log is useful. */
4983. /* Therefore the following line is otherwise needed. */
4984. 
4985. /* Standard used */
4986. 
4987. SetVariable(GapRequested, GapRequestedStd)
4988. 
4989. # Gap Calculation Methods:
4990. 
4991. /* AddGap Variants */
4992. 	/* Standard */
4993. 	/* MFT Low High Method */
4994. 	/* OS Volume Type Method */
4995. 
4996. /* MakeGap Variants */
4997. 	/* Original Os 1-3 + MFT 2 */
4998. 
4999. /* Note: You could comment out the ones not in use */
5000. /* However having the data in the log is useful. */
5001. /* Therefore the following line is otherwise needed. */
5002. 
5003. /* Standard is used currently */
5004. 
5005. 
5006. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
5007. 
5008. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
5009. 
5010. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
5011. 
5012. /* ---------------------------------------------------------- */
5013. /* 3) SMALL ZONE ADJUSTMENT. */
5014. /* Gab cant be larger than half the Zone Size. */
5015. 
5016. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
5017. 	
5018. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
5019. 
5020. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
5021. 
5022. /* ---------------------------------------------------------- */
5023. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
5024. # Gap Adjustments.
5025. 
5026. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
5027. 	
5028. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
5029. 
5030. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
5031. 
5032. /* ---------------------------------------------------------- */
5033. # BYPASS THIS.
5034. 	/* This is definitely wrong. */
5035. 	/* The question is can we steal gap from the next zone */
5036. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
5037. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
5038. 		# Zone Overflow.
5039. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
5040. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
5041. 
5042. /* ---------------------------------------------------------- */
5043. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
5044. # Remaining free space available.
5045. 
5046. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
5047. 	
5048. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
5049. 
5050. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
5051. 
5052. /* ---------------------------------------------------------- */
5053. # CURRENT gap to use.
5054. 
5055. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
5056. 
5057. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
5058. 
5059. /* ---------------------------------------------------------- */
5060. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
5061. # Debugging.
5062. 
5063. 	SetVariable(GapUsed, GapCurrent) // for debugging
5064. 
5065. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
5066. 
5067. 		# Your code HERE
5068. 
5069. /* ---------------------------------------------------------- */
5070. /* 7) YOUR CODE. */
5071. # YOUR CODE HERE:
5072. 	# INPUT: GapCurrent or GapCurrentLoc
5073. 	# OUTPUT: GapUsed...
5074. 
5075. /* ---------------------------------------------------------- */
5076. # Gap Size.
5077. # Actual Size of Gap.
5078. 
5079. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
5080. 
5081. /* ---------------------------------------------------------- */
5082. /* xxxxxxxxxxxxxxxxxxxxxx */
5083. # ADD THE GAP
5084. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
5085. /* xxxxxxxxxxxxxxxxxxxxxx */
5086. 
5087. 	
5088. 	# Zone Statistics	
5089. 	# Script: ZoneDoStatistics
5090. # Zone / Volume Statistics and Display
5091. 		
5092. 	# Accumulate Totals
5093.   	# Script: ZoneDoVolumeTotals
5094. 
5095. /* Current total space used (by Zones and Gaps) */
5096. 
5097. SetVariable(VolumeZoneUsed, GapUsed)
5098. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
5099. /* Percentage */
5100. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
5101. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
5102. 
5103. /* Current total of free space requested */
5104. 
5105. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
5106. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5107. /* Percent. */
5108. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
5109. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5110. 
5111. /* Current total of free space used */
5112. 
5113. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
5114. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
5115. /* Percent */
5116. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
5117. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
5118. 
5119. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
5120. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
5121. /* Xinclude "..\DebugDisplayPause.MyDc"X */
5122. 
5123. 
5124. 	# Current Values
5125. 	# Script: ZoneDoCurrentSet
5126. 
5127. # Cluster, Sector, Block adjust for display.
5128. 	# Bytes per cluster is volume specific.
5129. 
5130. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
5131. 
5132. # Current Zone values.
5133. 	# Begin, end and size.
5134. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
5135. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
5136. 
5137. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
5138. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
5139. 
5140. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
5141. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
5142. 
5143. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
5144. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
5145. 
5146. 	SetVariable(ZoneFragments,				"!ZONE210N!")
5147. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
5148. 		
5149. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
5150. /* identical code to here: (separation not needed. TEST.) */	
5151. 
5152. # Current Gap, Actual and Free Values
5153. 	# Gap
5154. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
5155. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
5156. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
5157. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
5158. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
5159. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
5160. 	
5161. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
5162. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
5163. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
5164. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
5165. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
5166. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
5167. 	
5168. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
5169. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
5170. 	
5171. 	# Actual Size and End
5172. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
5173. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
5174. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
5175. 	
5176. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
5177. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
5178. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
5179. 
5180. # Gap Size & Rounding
5181. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
5182. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
5183. 	
5184. 	# Free Space
5185. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
5186. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
5187. 
5188. 	# Footer:
5189. SetVariable(ZoneFooter, "----------------------------------------------------------
5190. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
5191. 
5192. Statistics Report:
5193. ------------------
5194.    Size:  
5195.    ------------------------
5196.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5197.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5198.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5199. 
5200.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5201.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5202. 
5203.    Location:
5204.    ------------------------
5205.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5206.              Files End: !ZoneEndCurrent!
5207.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5208.       
5209.    Gap Settings:
5210.    ------------------------
5211.          Gap Requested: !ZoneGapSizePer!%
5212.       Volume Rounding: !ZoneVolRoundUpPer!%
5213.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5214.                  
5215.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5216.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5217.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5218.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5219.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5220.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5221.      
5222.    Free Space after Zone:
5223.    ------------------------
5224.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5225.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5226.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5227. 
5228. Directory and Files Select:
5229. ---------------------------
5230. !ZoneTypeSelectCurrent!               
5231. ---------------------------
5232. ----------------------------------------------------------
5233. ")
5234. 	# Zone Footer Set Statistics Window Text
5235. 
5236. SetStatisticsWindowText("----------------------------------------------------------
5237. Zones Processed: 
5238. ----------------------------------------------------------
5239. !ZoneListByLine!
5240. ----------------------------------------------------------
5241. Zone Processing Step:
5242. !ZoneStepByLine!    
5243. ----------------------------------------------------------
5244. Current Zone:
5245. !ZoneFooter!
5246. ----------------------------------------------------------
5247. Volume Statistics:
5248. !VolumeStatisticsDetail!
5249. ----------------------------------------------------------
5250. Zone Detailed Report:
5251. ----------------------------------------------------------
5252. !ZoneStatisticsDetail!
5253. ----------------------------------------------------------
5254. ")
5255. 
5256. 
5257. 	
5258.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
5259. 
5260. 	# Add Zone to list of zones for display.
5261. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
5262. 	# ??? Free Stats?
5263. 	# Footer:
5264. SetVariable(ZoneFooter, "----------------------------------------------------------
5265. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
5266. 
5267. Statistics Report:
5268. ------------------
5269.    Size:  
5270.    ------------------------
5271.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5272.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5273.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5274. 
5275.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5276.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5277. 
5278.    Location:
5279.    ------------------------
5280.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5281.              Files End: !ZoneEndCurrent!
5282.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5283.       
5284.    Gap Settings:
5285.    ------------------------
5286.          Gap Requested: !ZoneGapSizePer!%
5287.       Volume Rounding: !ZoneVolRoundUpPer!%
5288.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5289.                  
5290.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5291.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5292.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5293.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5294.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5295.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5296.      
5297.    Free Space after Zone:
5298.    ------------------------
5299.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5300.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5301.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5302. 
5303. Directory and Files Select:
5304. ---------------------------
5305. !ZoneTypeSelectCurrent!               
5306. ---------------------------
5307. ----------------------------------------------------------
5308. ")
5309. 
5310. 	# Add Zone Details to Report.	
5311. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
5312. !ZoneFooter!")
5313. 
5314. 
5315. 		
5316. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
5317. 			# Script: DisplaySetFileStep
5318. 
5319. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5320. 
5321. /* add message and move to a new line. */
5322. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5323. ")
5324. 
5325. /* display the line. (hopefully.) */
5326. # Zone Footer Set Statistics Window Text
5327. 
5328. SetStatisticsWindowText("----------------------------------------------------------
5329. Zones Processed: 
5330. ----------------------------------------------------------
5331. !ZoneListByLine!
5332. ----------------------------------------------------------
5333. Zone Processing Step:
5334. !ZoneStepByLine!    
5335. ----------------------------------------------------------
5336. Current Zone:
5337. !ZoneFooter!
5338. ----------------------------------------------------------
5339. Volume Statistics:
5340. !VolumeStatisticsDetail!
5341. ----------------------------------------------------------
5342. Zone Detailed Report:
5343. ----------------------------------------------------------
5344. !ZoneStatisticsDetail!
5345. ----------------------------------------------------------
5346. ")
5347. 
5348. 
5349. 
5350. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5351. 
5352. # Script: BannerSet
5353. 
5354. # Script: DisplaySetDateTimeRun
5355. 
5356. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
5357. /* Xinclude "..\Display\BannerSet.MyDc"X */
5358. /* pause(1) */
5359. 
5360. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5361. 
5362. Title('!Heading!')
5363. /* pause(1) */
5364. 
5365. /* NOTE: Can't round or truncate to integer precision. */
5366. 
5367. pause(1)
5368. 	
5369. 			# File Action - Type Os Program Hints Fixed - Regular - ImportSeq.
5370. # File Action - SortByImportSequence.
5371. SortByImportSequence(Ascending ) 
5372. 	
5373. 	
5374. 
5375. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
5376. 			# Script: DisplaySetFileStep
5377. 
5378. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5379. 
5380. /* add message and move to a new line. */
5381. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5382. ")
5383. 
5384. /* display the line. (hopefully.) */
5385. # Zone Footer Set Statistics Window Text
5386. 
5387. SetStatisticsWindowText("----------------------------------------------------------
5388. Zones Processed: 
5389. ----------------------------------------------------------
5390. !ZoneListByLine!
5391. ----------------------------------------------------------
5392. Zone Processing Step:
5393. !ZoneStepByLine!    
5394. ----------------------------------------------------------
5395. Current Zone:
5396. !ZoneFooter!
5397. ----------------------------------------------------------
5398. Volume Statistics:
5399. !VolumeStatisticsDetail!
5400. ----------------------------------------------------------
5401. Zone Detailed Report:
5402. ----------------------------------------------------------
5403. !ZoneStatisticsDetail!
5404. ----------------------------------------------------------
5405. ")
5406. 
5407. 
5408. 
5409. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5410. 
5411. # Script: BannerSet
5412. 
5413. # Script: DisplaySetDateTimeRun
5414. 
5415. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
5416. /* Xinclude "..\Display\BannerSet.MyDc"X */
5417. /* pause(1) */
5418. 
5419. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5420. 
5421. Title('!Heading!')
5422. /* pause(1) */
5423. 
5424. /* NOTE: Can't round or truncate to integer precision. */
5425. 
5426. pause(1)
5427. 
5428. 		# Script: ZoneDoFooter
5429. 
5430. /* ---------------------------------------------------------- */
5431. # File Select
5432. 	# Select Statments
5433. # File Actions 
5434. 	# Standard or OS File Actions.
5435. 	# Resume...
5436. 	
5437. 	# your stuff HERE (X)... post zone (file) file actions code.
5438. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
5439. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5440. 		# (X)
5441. 		
5442. 		/* ??? Set window? */
5443. 	
5444. 	# ADD THE GAP
5445. 		
5446. # Vacate (good for diagnostics)
5447. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
5448. 
5449. # DoNotVacate - DO NOT Vacate (recommended)
5450. 
5451. # Vacate
5452. /* AddGap(GapUsedLoc) */
5453. 
5454. # DO Not Vacate
5455. AddGap(GapUsedLoc, DoNotVacate) 
5456. 	
5457. 	
5458. /* ---------------------------------------------------------- */
5459. # (failed) TEST for boolean logic.
5460. 
5461. /* It should work in the gap calculations for turning options */
5462. /* on and off but it will NOT work here. */
5463. 
5464. /* Boolean setting X or FlagX. */
5465. /* Where X will be on or off: */
5466. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
5467. /*      For ON:  (X  *  FlagAny) */
5468. 
5469. /* 1) Failed, zero gap overrode the previous one. */
5470. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
5471. /* AddGap(GapUsedTemp) */ 
5472. 
5473. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
5474. /* AddGap(GapUsedTemp, DoNotVacate) */ 
5475. 
5476. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
5477. 
5478. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
5479. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
5480. /* AddGap(GapUsedTemp) */ 
5481. 
5482. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
5483. /* AddGap(GapUsedTemp, DoNotVacate) */ 
5484. 
5485. /* ---------------------------------------------------------- */
5486. 
5487. # Vacate
5488. /* AddGap(GapUsed) */
5489. 
5490. # DO NOT Vacate (recommended)
5491. /* AddGap(GapUsed, DoNotVacate) */ 
5492. 	
5493. 
5494. 		
5495. # 
5496. FileEnd
5497. /* ---------------------------------------------------------- */
5498. 
5499. # your stuff HERE (X)... post zone (file) code.
5500. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
5501. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5502. 	# (X)
5503. 
5504. SetVariable(FileStepDescription,"Zone finished, reporting.")
5505. # Script: DisplaySetFileStep
5506. 
5507. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5508. 
5509. /* add message and move to a new line. */
5510. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5511. ")
5512. 
5513. /* display the line. (hopefully.) */
5514. # Zone Footer Set Statistics Window Text
5515. 
5516. SetStatisticsWindowText("----------------------------------------------------------
5517. Zones Processed: 
5518. ----------------------------------------------------------
5519. !ZoneListByLine!
5520. ----------------------------------------------------------
5521. Zone Processing Step:
5522. !ZoneStepByLine!    
5523. ----------------------------------------------------------
5524. Current Zone:
5525. !ZoneFooter!
5526. ----------------------------------------------------------
5527. Volume Statistics:
5528. !VolumeStatisticsDetail!
5529. ----------------------------------------------------------
5530. Zone Detailed Report:
5531. ----------------------------------------------------------
5532. !ZoneStatisticsDetail!
5533. ----------------------------------------------------------
5534. ")
5535. 
5536. 
5537. 
5538. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5539. 
5540. # Script: BannerSet
5541. 
5542. # Script: DisplaySetDateTimeRun
5543. 
5544. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
5545. /* Xinclude "..\Display\BannerSet.MyDc"X */
5546. /* pause(1) */
5547. 
5548. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5549. 
5550. Title('!Heading!')
5551. /* pause(1) */
5552. 
5553. /* NOTE: Can't round or truncate to integer precision. */
5554. 
5555. pause(1)
5556. 
5557. # Script: ZoneWhenFinished
5558. 
5559. # Script: BannerSet
5560. 
5561. # Script: DisplaySetDateTimeRun
5562. 
5563. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
5564. /* Xinclude "..\Display\BannerSet.MyDc"X */
5565. /* pause(1) */
5566. 
5567. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5568. 
5569. Title('!Heading!')
5570. /* pause(1) */
5571. 
5572. /* NOTE: Can't round or truncate to integer precision. */
5573. 
5574. # Script: BannerLog
5575. 
5576. AppendLogfile("!LogFileName!", "!Title!")
5577. 
5578. 
5579. 
5580. # Zone Statistics	
5581. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
5582. 
5583. # Footer:
5584. SetVariable(ZoneFooter, "----------------------------------------------------------
5585. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
5586. 
5587. Statistics Report:
5588. ------------------
5589.    Size:  
5590.    ------------------------
5591.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5592.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5593.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5594. 
5595.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5596.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5597. 
5598.    Location:
5599.    ------------------------
5600.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5601.              Files End: !ZoneEndCurrent!
5602.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5603.       
5604.    Gap Settings:
5605.    ------------------------
5606.          Gap Requested: !ZoneGapSizePer!%
5607.       Volume Rounding: !ZoneVolRoundUpPer!%
5608.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5609.                  
5610.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5611.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5612.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5613.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5614.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5615.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5616.      
5617.    Free Space after Zone:
5618.    ------------------------
5619.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5620.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5621.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5622. 
5623. Directory and Files Select:
5624. ---------------------------
5625. !ZoneTypeSelectCurrent!               
5626. ---------------------------
5627. ----------------------------------------------------------
5628. ")
5629. 
5630. AppendLogfile("!LogFileName!", ".")
5631. AppendLogfile("!LogFileName!", "!ZoneFooter!")
5632. AppendLogfile("!LogFileName!", ".")
5633. 
5634. # Zone Footer Set Statistics Window Text
5635. 
5636. SetStatisticsWindowText("----------------------------------------------------------
5637. Zones Processed: 
5638. ----------------------------------------------------------
5639. !ZoneListByLine!
5640. ----------------------------------------------------------
5641. Zone Processing Step:
5642. !ZoneStepByLine!    
5643. ----------------------------------------------------------
5644. Current Zone:
5645. !ZoneFooter!
5646. ----------------------------------------------------------
5647. Volume Statistics:
5648. !VolumeStatisticsDetail!
5649. ----------------------------------------------------------
5650. Zone Detailed Report:
5651. ----------------------------------------------------------
5652. !ZoneStatisticsDetail!
5653. ----------------------------------------------------------
5654. ")
5655. 
5656. 
5657. 
5658. /* pause() */
5659. /* pause() */
5660. 
5661. 
5662. 
5663. 	
5664. /* ---------------------------------------------------------- */
5665. # Zone ProgramHints Data.
5666. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHintsData!")
5667. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHintsData!")
5668. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
5669. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHints!")
5670. 	SetVariable(ZoneTypeSelect,'
5671.                 # ProgramHints - Data files.
5672.                 not(
5673.                      # Os PageHiberDump start.
5674. (
5675.   FileName("DataStore.edb")
5676.   or FileName("DUMP*.*")
5677.   or FileName("Hiberfil.sys")
5678.   or FileName("MEMORY.DMP")
5679.   or FileName("Pagefile.sys")
5680. )
5681. # Os PageHiberDump end.
5682. 
5683.                 )
5684. ')
5685. 
5686. 		# Script: ZoneDoHeader
5687. 
5688. # Script: ZoneWhenStarted
5689. 
5690. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
5691. # Script: DisplaySetZone
5692. 
5693. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
5694. SetVariable(FileStepDescription,	"")
5695. 
5696. SetVariable(ZoneStepByLine, 			"Zone started.
5697. ")
5698. 
5699. # Script: BannerDescriptionSet
5700. 
5701. # Script: BannerSet
5702. 
5703. # Script: DisplaySetDateTimeRun
5704. 
5705. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
5706. /* Xinclude "..\Display\BannerSet.MyDc"X */
5707. /* pause(1) */
5708. 
5709. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5710. 
5711. Title('!Heading!')
5712. /* pause(1) */
5713. 
5714. /* NOTE: Can't round or truncate to integer precision. */
5715. 
5716. # Script: BannerLog
5717. 
5718. AppendLogfile("!LogFileName!", "!Title!")
5719. 
5720. 
5721. 
5722. pause(1)
5723. 
5724. 
5725. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
5726. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
5727. 
5728. SetVariable(ZoneStepNoCurrent, 0)
5729. 
5730. 
5731. # Script: ZoneDoCurrentClear
5732. 
5733. SetVariable(ZoneTypeSelectCurrent, 		"")
5734. 
5735. SetVariable(ZoneBeginCurrent, 			0)
5736. SetVariable(ZoneBeginPerCurrent, 		0)
5737. SetVariable(ZoneEndCurrent, 			0)
5738. SetVariable(ZoneEndPerCurrent, 			0)
5739. 
5740. SetVariable(ZoneSizeCurrent,			0)
5741. SetVariable(ZoneSizePerCurrent,			0)
5742. 
5743. SetVariable(ZoneGapRequestedCurrent,	0)
5744. SetVariable(ZoneGapRoundedCurrent, 		0)
5745. SetVariable(ZoneGapAdjustedCurrent, 	0)
5746. SetVariable(ZoneGapAvailableCurrent, 	0)
5747. SetVariable(ZoneGapCurrent,				0)
5748. SetVariable(ZoneGapUsedCurrent, 		0)
5749. 
5750. SetVariable(ZoneGapActualCurrent, 		0)
5751. SetVariable(ZoneGapActualPerCurrent, 	0)
5752. 
5753. SetVariable(ZoneSizeActual, 			0)
5754. SetVariable(ZoneSizeActualCurrent,		0)
5755. 
5756. SetVariable(ZoneEndActual, 				0)
5757. SetVariable(ZoneEndActualCurrent,		0)			
5758. SetVariable(ZoneSizeActualPerCurrent, 	0)
5759.       
5760. SetVariable(ZoneFilesFolders,			0)
5761. SetVariable(ZoneFilesFoldersPer,		0) 
5762. 
5763. SetVariable(ZoneFragments,				0)
5764. SetVariable(ZoneFragmentsPer,			0) 
5765. 		
5766. SetVariable(ZoneEndActualCurrent, 		0)
5767. SetVariable(ZoneEndActualPerCurrent, 	0)
5768. 
5769. # Gap Calculation Methodology:
5770. 	# Requested
5771. 	SetVariable(GapRequested, 			0) 
5772. 	SetVariable(GapRequestedStd, 		0) 
5773. 	SetVariable(GapRequestedMft, 		0) 
5774. 	SetVariable(GapRequestedOs, 		0) 
5775. 	SetVariable(GapRequestedOriginal, 	0) 
5776. 	
5777. 	# Gap Adjustments
5778. 	SetVariable(GapRounded, 			0)
5779. 	# SetVariable(GapAdjusted, 			0)
5780. 	SetVariable(GapAvailable, 			0)
5781. 	SetVariable(GapCurrent, 			0)
5782. 	SetVariable(GapActual, 				0)
5783. 	SetVariable(GapUsed, 				0)
5784. 	
5785. 	# Gap Adjustments
5786. 	SetVariable(GapRoundedLoc, 			0)
5787. 	# SetVariable(GapAdjustedLoc, 		0)
5788. 	SetVariable(GapAvailableLoc, 		0)
5789. 	SetVariable(GapCurrentLoc, 			0)
5790. 	SetVariable(GapActualLoc,			0)
5791. 	SetVariable(GapUsedLoc,				0)
5792. 	
5793. 	# Space usage
5794. 	SetVariable(ZoneFreePerRequested, 	0)
5795. 	SetVariable(ZoneFreePerUsed, 		0)
5796. 
5797. # Gap Size & Rounding
5798. 	SetVariable(ZoneGapSizePer, 		0)
5799. 	SetVariable(ZoneVolRoundUpPer, 		0)
5800. 	
5801. 	# Free Space
5802. 	SetVariable(ZoneFreeUsedPer, 		0)
5803. 	SetVariable(ZoneFreeRequestedPer, 	0)
5804. 
5805. 
5806. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
5807. 
5808. # Footer:
5809. SetVariable(ZoneFooter, "----------------------------------------------------------
5810. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
5811. 
5812. Statistics Report:
5813. ------------------
5814.    Size:  
5815.    ------------------------
5816.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5817.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5818.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5819. 
5820.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5821.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5822. 
5823.    Location:
5824.    ------------------------
5825.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5826.              Files End: !ZoneEndCurrent!
5827.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5828.       
5829.    Gap Settings:
5830.    ------------------------
5831.          Gap Requested: !ZoneGapSizePer!%
5832.       Volume Rounding: !ZoneVolRoundUpPer!%
5833.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5834.                  
5835.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5836.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5837.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5838.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5839.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5840.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5841.      
5842.    Free Space after Zone:
5843.    ------------------------
5844.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5845.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5846.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5847. 
5848. Directory and Files Select:
5849. ---------------------------
5850. !ZoneTypeSelectCurrent!               
5851. ---------------------------
5852. ----------------------------------------------------------
5853. ")
5854. 
5855. # Script: BannerSet
5856. 
5857. # Script: DisplaySetDateTimeRun
5858. 
5859. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
5860. /* Xinclude "..\Display\BannerSet.MyDc"X */
5861. /* pause(1) */
5862. 
5863. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5864. 
5865. Title('!Heading!')
5866. /* pause(1) */
5867. 
5868. /* NOTE: Can't round or truncate to integer precision. */
5869. 
5870. # Script: BannerLog
5871. 
5872. AppendLogfile("!LogFileName!", "!Title!")
5873. 
5874. 
5875. 
5876. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
5877. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
5878. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:43")
5879. 
5880. SetVariable(ZoneListByLine, "!ZoneListByLine!
5881. Zone: !ZoneNoCurrent! 2021-11-09 20:22:43 0:00:02 !ZoneLabel! !ZoneDescription!")
5882. 
5883. 
5884. /* Fixed Zone Position Handling */
5885. /* Literal number: */
5886. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
5887. /* Percentage of disk: */
5888. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
5889. /* Gap */
5890. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
5891. 
5892. /* ---------------------------------------------------------- */
5893. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
5894. # Script: DisplaySetFileStep
5895. 
5896. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5897. 
5898. /* add message and move to a new line. */
5899. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5900. ")
5901. 
5902. /* display the line. (hopefully.) */
5903. # Zone Footer Set Statistics Window Text
5904. 
5905. SetStatisticsWindowText("----------------------------------------------------------
5906. Zones Processed: 
5907. ----------------------------------------------------------
5908. !ZoneListByLine!
5909. ----------------------------------------------------------
5910. Zone Processing Step:
5911. !ZoneStepByLine!    
5912. ----------------------------------------------------------
5913. Current Zone:
5914. !ZoneFooter!
5915. ----------------------------------------------------------
5916. Volume Statistics:
5917. !VolumeStatisticsDetail!
5918. ----------------------------------------------------------
5919. Zone Detailed Report:
5920. ----------------------------------------------------------
5921. !ZoneStatisticsDetail!
5922. ----------------------------------------------------------
5923. ")
5924. 
5925. 
5926. 
5927. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5928. 
5929. # Script: BannerSet
5930. 
5931. # Script: DisplaySetDateTimeRun
5932. 
5933. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
5934. /* Xinclude "..\Display\BannerSet.MyDc"X */
5935. /* pause(1) */
5936. 
5937. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5938. 
5939. Title('!Heading!')
5940. /* pause(1) */
5941. 
5942. /* NOTE: Can't round or truncate to integer precision. */
5943. 
5944. pause(1)
5945. 
5946. # your stuff HERE (X)... pre file select code.
5947. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
5948. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5949. 	# (X)
5950. 
5951. FileSelect
5952. 
5953. 	# your stuff can't really go here (errors.)
5954. 	# maybe for some reason I don't know of...
5955. 	
5956. 	# Actions next...
5957. 		# Script: ZoneDo ZoneTypeSelectOsProgramHints
5958. # ProgramHints start.
5959. ImportListFromProgramHints("*.pf")
5960. # ProgramHints end.
5961. 
5962. 		and not(
5963. 			# Os PageHiberDump start.
5964. (
5965.   FileName("DataStore.edb")
5966.   or FileName("DUMP*.*")
5967.   or FileName("Hiberfil.sys")
5968.   or FileName("MEMORY.DMP")
5969.   or FileName("Pagefile.sys")
5970. )
5971. # Os PageHiberDump end.
5972. 
5973. 		)
5974. 		
5975. 		FileActions
5976. 		  		/* ---------------------------------------------------------- */
5977. 	# Gap
5978. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
5979. 		# Script: DisplaySetFileStep
5980. 
5981. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5982. 
5983. /* add message and move to a new line. */
5984. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5985. ")
5986. 
5987. /* display the line. (hopefully.) */
5988. # Zone Footer Set Statistics Window Text
5989. 
5990. SetStatisticsWindowText("----------------------------------------------------------
5991. Zones Processed: 
5992. ----------------------------------------------------------
5993. !ZoneListByLine!
5994. ----------------------------------------------------------
5995. Zone Processing Step:
5996. !ZoneStepByLine!    
5997. ----------------------------------------------------------
5998. Current Zone:
5999. !ZoneFooter!
6000. ----------------------------------------------------------
6001. Volume Statistics:
6002. !VolumeStatisticsDetail!
6003. ----------------------------------------------------------
6004. Zone Detailed Report:
6005. ----------------------------------------------------------
6006. !ZoneStatisticsDetail!
6007. ----------------------------------------------------------
6008. ")
6009. 
6010. 
6011. 
6012. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6013. 
6014. # Script: BannerSet
6015. 
6016. # Script: DisplaySetDateTimeRun
6017. 
6018. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
6019. /* Xinclude "..\Display\BannerSet.MyDc"X */
6020. /* pause(1) */
6021. 
6022. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6023. 
6024. Title('!Heading!')
6025. /* pause(1) */
6026. 
6027. /* NOTE: Can't round or truncate to integer precision. */
6028. 
6029. pause(1)
6030. 	
6031. 	# ACTUAL GAP
6032. 		/* AddGap Variant. */
6033. 	  	# Zone Do Gap
6034. # Gap Calculation Methods:
6035. 
6036. /* 1) Anything you need to add first. */
6037. /* empty */
6038. 
6039. /* ---------------------------------------------------------- */
6040. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
6041. 	# GapRequestedStd.
6042. 
6043. 		/* ---------------------------------------------------------- */
6044. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
6045. 
6046. 		# Gap Calculation Methods:
6047. 
6048. /* AddGap Variants */
6049. 
6050. 	/* Standard */
6051. 		# Gap Calculation Methods:
6052. 	/* AddGap Variants */
6053. 	/* Standard */
6054. 
6055. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
6056. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
6057. 
6058. 	SetVariable(GapRequested, GapRequestedStd)
6059. 	
6060. 
6061. 	/* MFT Low High Method */
6062. 		# Gap Calculation Methods:
6063. 	/* AddGap Variants */
6064. 	/* MFT Low High Method */
6065. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
6066. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
6067. 	SetVariable(GapRequested, GapRequestedMft)
6068. 	
6069. 
6070. 	/* OS Volume Type Method */
6071. 		# Gap Calculation Methods:
6072. 	/* AddGap Variants */
6073. 	/* OS Volume Type Method */
6074. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
6075. 	SetVariable(GapRequested, GapRequestedOs)
6076. 
6077. 
6078. 
6079. /* MakeGap Variants */
6080. 
6081. 	/* Original Os 1-3 + MFT 2 */
6082. 		# Gap Calculation Methods:
6083. 	/* MakeGap Variants */
6084. 	/* Original Os 1-3 + MFT 2 */
6085. 	/* plus MFT gap placed inline at the dividing zone. */
6086. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
6087. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
6088. 	SetVariable(GapRequested, GapRequestedOrig)
6089. 	
6090. 	
6091. /* Note: You could comment out the ones not in use */
6092. /* However having the data in the log is useful. */
6093. /* Therefore the following line is otherwise needed. */
6094. 
6095. /* Standard used */
6096. 
6097. SetVariable(GapRequested, GapRequestedStd)
6098. 
6099. # Gap Calculation Methods:
6100. 
6101. /* AddGap Variants */
6102. 	/* Standard */
6103. 	/* MFT Low High Method */
6104. 	/* OS Volume Type Method */
6105. 
6106. /* MakeGap Variants */
6107. 	/* Original Os 1-3 + MFT 2 */
6108. 
6109. /* Note: You could comment out the ones not in use */
6110. /* However having the data in the log is useful. */
6111. /* Therefore the following line is otherwise needed. */
6112. 
6113. /* Standard is used currently */
6114. 
6115. 
6116. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
6117. 
6118. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
6119. 
6120. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
6121. 
6122. /* ---------------------------------------------------------- */
6123. /* 3) SMALL ZONE ADJUSTMENT. */
6124. /* Gab cant be larger than half the Zone Size. */
6125. 
6126. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
6127. 	
6128. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
6129. 
6130. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
6131. 
6132. /* ---------------------------------------------------------- */
6133. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
6134. # Gap Adjustments.
6135. 
6136. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
6137. 	
6138. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
6139. 
6140. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
6141. 
6142. /* ---------------------------------------------------------- */
6143. # BYPASS THIS.
6144. 	/* This is definitely wrong. */
6145. 	/* The question is can we steal gap from the next zone */
6146. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
6147. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
6148. 		# Zone Overflow.
6149. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
6150. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
6151. 
6152. /* ---------------------------------------------------------- */
6153. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
6154. # Remaining free space available.
6155. 
6156. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
6157. 	
6158. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
6159. 
6160. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
6161. 
6162. /* ---------------------------------------------------------- */
6163. # CURRENT gap to use.
6164. 
6165. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
6166. 
6167. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
6168. 
6169. /* ---------------------------------------------------------- */
6170. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
6171. # Debugging.
6172. 
6173. 	SetVariable(GapUsed, GapCurrent) // for debugging
6174. 
6175. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
6176. 
6177. 		# Your code HERE
6178. 
6179. /* ---------------------------------------------------------- */
6180. /* 7) YOUR CODE. */
6181. # YOUR CODE HERE:
6182. 	# INPUT: GapCurrent or GapCurrentLoc
6183. 	# OUTPUT: GapUsed...
6184. 
6185. /* ---------------------------------------------------------- */
6186. # Gap Size.
6187. # Actual Size of Gap.
6188. 
6189. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
6190. 
6191. /* ---------------------------------------------------------- */
6192. /* xxxxxxxxxxxxxxxxxxxxxx */
6193. # ADD THE GAP
6194. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
6195. /* xxxxxxxxxxxxxxxxxxxxxx */
6196. 
6197. 	
6198. 	# Zone Statistics	
6199. 	# Script: ZoneDoStatistics
6200. # Zone / Volume Statistics and Display
6201. 		
6202. 	# Accumulate Totals
6203.   	# Script: ZoneDoVolumeTotals
6204. 
6205. /* Current total space used (by Zones and Gaps) */
6206. 
6207. SetVariable(VolumeZoneUsed, GapUsed)
6208. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
6209. /* Percentage */
6210. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
6211. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
6212. 
6213. /* Current total of free space requested */
6214. 
6215. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
6216. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6217. /* Percent. */
6218. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
6219. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6220. 
6221. /* Current total of free space used */
6222. 
6223. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
6224. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
6225. /* Percent */
6226. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
6227. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
6228. 
6229. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
6230. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
6231. /* Xinclude "..\DebugDisplayPause.MyDc"X */
6232. 
6233. 
6234. 	# Current Values
6235. 	# Script: ZoneDoCurrentSet
6236. 
6237. # Cluster, Sector, Block adjust for display.
6238. 	# Bytes per cluster is volume specific.
6239. 
6240. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
6241. 
6242. # Current Zone values.
6243. 	# Begin, end and size.
6244. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
6245. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
6246. 
6247. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
6248. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
6249. 
6250. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
6251. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
6252. 
6253. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
6254. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
6255. 
6256. 	SetVariable(ZoneFragments,				"!ZONE210N!")
6257. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
6258. 		
6259. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
6260. /* identical code to here: (separation not needed. TEST.) */	
6261. 
6262. # Current Gap, Actual and Free Values
6263. 	# Gap
6264. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
6265. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
6266. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
6267. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
6268. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
6269. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
6270. 	
6271. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
6272. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
6273. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
6274. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
6275. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
6276. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
6277. 	
6278. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
6279. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
6280. 	
6281. 	# Actual Size and End
6282. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
6283. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
6284. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
6285. 	
6286. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
6287. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
6288. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
6289. 
6290. # Gap Size & Rounding
6291. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
6292. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
6293. 	
6294. 	# Free Space
6295. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
6296. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
6297. 
6298. 	# Footer:
6299. SetVariable(ZoneFooter, "----------------------------------------------------------
6300. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
6301. 
6302. Statistics Report:
6303. ------------------
6304.    Size:  
6305.    ------------------------
6306.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6307.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6308.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6309. 
6310.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6311.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6312. 
6313.    Location:
6314.    ------------------------
6315.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6316.              Files End: !ZoneEndCurrent!
6317.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6318.       
6319.    Gap Settings:
6320.    ------------------------
6321.          Gap Requested: !ZoneGapSizePer!%
6322.       Volume Rounding: !ZoneVolRoundUpPer!%
6323.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6324.                  
6325.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6326.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6327.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6328.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6329.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6330.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6331.      
6332.    Free Space after Zone:
6333.    ------------------------
6334.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6335.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6336.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6337. 
6338. Directory and Files Select:
6339. ---------------------------
6340. !ZoneTypeSelectCurrent!               
6341. ---------------------------
6342. ----------------------------------------------------------
6343. ")
6344. 	# Zone Footer Set Statistics Window Text
6345. 
6346. SetStatisticsWindowText("----------------------------------------------------------
6347. Zones Processed: 
6348. ----------------------------------------------------------
6349. !ZoneListByLine!
6350. ----------------------------------------------------------
6351. Zone Processing Step:
6352. !ZoneStepByLine!    
6353. ----------------------------------------------------------
6354. Current Zone:
6355. !ZoneFooter!
6356. ----------------------------------------------------------
6357. Volume Statistics:
6358. !VolumeStatisticsDetail!
6359. ----------------------------------------------------------
6360. Zone Detailed Report:
6361. ----------------------------------------------------------
6362. !ZoneStatisticsDetail!
6363. ----------------------------------------------------------
6364. ")
6365. 
6366. 
6367. 	
6368.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
6369. 
6370. 	# Add Zone to list of zones for display.
6371. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
6372. 	# ??? Free Stats?
6373. 	# Footer:
6374. SetVariable(ZoneFooter, "----------------------------------------------------------
6375. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
6376. 
6377. Statistics Report:
6378. ------------------
6379.    Size:  
6380.    ------------------------
6381.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6382.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6383.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6384. 
6385.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6386.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6387. 
6388.    Location:
6389.    ------------------------
6390.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6391.              Files End: !ZoneEndCurrent!
6392.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6393.       
6394.    Gap Settings:
6395.    ------------------------
6396.          Gap Requested: !ZoneGapSizePer!%
6397.       Volume Rounding: !ZoneVolRoundUpPer!%
6398.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6399.                  
6400.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6401.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6402.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6403.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6404.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6405.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6406.      
6407.    Free Space after Zone:
6408.    ------------------------
6409.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6410.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6411.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6412. 
6413. Directory and Files Select:
6414. ---------------------------
6415. !ZoneTypeSelectCurrent!               
6416. ---------------------------
6417. ----------------------------------------------------------
6418. ")
6419. 
6420. 	# Add Zone Details to Report.	
6421. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
6422. !ZoneFooter!")
6423. 
6424. 
6425. 	
6426. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
6427. 			# Script: DisplaySetFileStep
6428. 
6429. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6430. 
6431. /* add message and move to a new line. */
6432. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6433. ")
6434. 
6435. /* display the line. (hopefully.) */
6436. # Zone Footer Set Statistics Window Text
6437. 
6438. SetStatisticsWindowText("----------------------------------------------------------
6439. Zones Processed: 
6440. ----------------------------------------------------------
6441. !ZoneListByLine!
6442. ----------------------------------------------------------
6443. Zone Processing Step:
6444. !ZoneStepByLine!    
6445. ----------------------------------------------------------
6446. Current Zone:
6447. !ZoneFooter!
6448. ----------------------------------------------------------
6449. Volume Statistics:
6450. !VolumeStatisticsDetail!
6451. ----------------------------------------------------------
6452. Zone Detailed Report:
6453. ----------------------------------------------------------
6454. !ZoneStatisticsDetail!
6455. ----------------------------------------------------------
6456. ")
6457. 
6458. 
6459. 
6460. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6461. 
6462. # Script: BannerSet
6463. 
6464. # Script: DisplaySetDateTimeRun
6465. 
6466. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
6467. /* Xinclude "..\Display\BannerSet.MyDc"X */
6468. /* pause(1) */
6469. 
6470. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6471. 
6472. Title('!Heading!')
6473. /* pause(1) */
6474. 
6475. /* NOTE: Can't round or truncate to integer precision. */
6476. 
6477. pause(1)
6478. 
6479. 			# File Action - Type Os Program Hints Data - Regular - ImportSeq.
6480. # File Action - SortByImportSequence.
6481. SortByImportSequence(Ascending ) 
6482. 	
6483. 	
6484. 	
6485. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
6486. 			# Script: DisplaySetFileStep
6487. 
6488. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6489. 
6490. /* add message and move to a new line. */
6491. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6492. ")
6493. 
6494. /* display the line. (hopefully.) */
6495. # Zone Footer Set Statistics Window Text
6496. 
6497. SetStatisticsWindowText("----------------------------------------------------------
6498. Zones Processed: 
6499. ----------------------------------------------------------
6500. !ZoneListByLine!
6501. ----------------------------------------------------------
6502. Zone Processing Step:
6503. !ZoneStepByLine!    
6504. ----------------------------------------------------------
6505. Current Zone:
6506. !ZoneFooter!
6507. ----------------------------------------------------------
6508. Volume Statistics:
6509. !VolumeStatisticsDetail!
6510. ----------------------------------------------------------
6511. Zone Detailed Report:
6512. ----------------------------------------------------------
6513. !ZoneStatisticsDetail!
6514. ----------------------------------------------------------
6515. ")
6516. 
6517. 
6518. 
6519. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6520. 
6521. # Script: BannerSet
6522. 
6523. # Script: DisplaySetDateTimeRun
6524. 
6525. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
6526. /* Xinclude "..\Display\BannerSet.MyDc"X */
6527. /* pause(1) */
6528. 
6529. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6530. 
6531. Title('!Heading!')
6532. /* pause(1) */
6533. 
6534. /* NOTE: Can't round or truncate to integer precision. */
6535. 
6536. pause(1)
6537. 
6538. 		# Script: ZoneDoFooter
6539. 
6540. /* ---------------------------------------------------------- */
6541. # File Select
6542. 	# Select Statments
6543. # File Actions 
6544. 	# Standard or OS File Actions.
6545. 	# Resume...
6546. 	
6547. 	# your stuff HERE (X)... post zone (file) file actions code.
6548. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
6549. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
6550. 		# (X)
6551. 		
6552. 		/* ??? Set window? */
6553. 	
6554. 	# ADD THE GAP
6555. 		
6556. # Vacate (good for diagnostics)
6557. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
6558. 
6559. # DoNotVacate - DO NOT Vacate (recommended)
6560. 
6561. # Vacate
6562. /* AddGap(GapUsedLoc) */
6563. 
6564. # DO Not Vacate
6565. AddGap(GapUsedLoc, DoNotVacate) 
6566. 	
6567. 	
6568. /* ---------------------------------------------------------- */
6569. # (failed) TEST for boolean logic.
6570. 
6571. /* It should work in the gap calculations for turning options */
6572. /* on and off but it will NOT work here. */
6573. 
6574. /* Boolean setting X or FlagX. */
6575. /* Where X will be on or off: */
6576. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
6577. /*      For ON:  (X  *  FlagAny) */
6578. 
6579. /* 1) Failed, zero gap overrode the previous one. */
6580. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
6581. /* AddGap(GapUsedTemp) */ 
6582. 
6583. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
6584. /* AddGap(GapUsedTemp, DoNotVacate) */ 
6585. 
6586. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
6587. 
6588. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
6589. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
6590. /* AddGap(GapUsedTemp) */ 
6591. 
6592. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
6593. /* AddGap(GapUsedTemp, DoNotVacate) */ 
6594. 
6595. /* ---------------------------------------------------------- */
6596. 
6597. # Vacate
6598. /* AddGap(GapUsed) */
6599. 
6600. # DO NOT Vacate (recommended)
6601. /* AddGap(GapUsed, DoNotVacate) */ 
6602. 	
6603. 
6604. 		
6605. # 
6606. FileEnd
6607. /* ---------------------------------------------------------- */
6608. 
6609. # your stuff HERE (X)... post zone (file) code.
6610. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
6611. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
6612. 	# (X)
6613. 
6614. SetVariable(FileStepDescription,"Zone finished, reporting.")
6615. # Script: DisplaySetFileStep
6616. 
6617. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6618. 
6619. /* add message and move to a new line. */
6620. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6621. ")
6622. 
6623. /* display the line. (hopefully.) */
6624. # Zone Footer Set Statistics Window Text
6625. 
6626. SetStatisticsWindowText("----------------------------------------------------------
6627. Zones Processed: 
6628. ----------------------------------------------------------
6629. !ZoneListByLine!
6630. ----------------------------------------------------------
6631. Zone Processing Step:
6632. !ZoneStepByLine!    
6633. ----------------------------------------------------------
6634. Current Zone:
6635. !ZoneFooter!
6636. ----------------------------------------------------------
6637. Volume Statistics:
6638. !VolumeStatisticsDetail!
6639. ----------------------------------------------------------
6640. Zone Detailed Report:
6641. ----------------------------------------------------------
6642. !ZoneStatisticsDetail!
6643. ----------------------------------------------------------
6644. ")
6645. 
6646. 
6647. 
6648. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6649. 
6650. # Script: BannerSet
6651. 
6652. # Script: DisplaySetDateTimeRun
6653. 
6654. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
6655. /* Xinclude "..\Display\BannerSet.MyDc"X */
6656. /* pause(1) */
6657. 
6658. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6659. 
6660. Title('!Heading!')
6661. /* pause(1) */
6662. 
6663. /* NOTE: Can't round or truncate to integer precision. */
6664. 
6665. pause(1)
6666. 
6667. # Script: ZoneWhenFinished
6668. 
6669. # Script: BannerSet
6670. 
6671. # Script: DisplaySetDateTimeRun
6672. 
6673. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
6674. /* Xinclude "..\Display\BannerSet.MyDc"X */
6675. /* pause(1) */
6676. 
6677. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6678. 
6679. Title('!Heading!')
6680. /* pause(1) */
6681. 
6682. /* NOTE: Can't round or truncate to integer precision. */
6683. 
6684. # Script: BannerLog
6685. 
6686. AppendLogfile("!LogFileName!", "!Title!")
6687. 
6688. 
6689. 
6690. # Zone Statistics	
6691. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
6692. 
6693. # Footer:
6694. SetVariable(ZoneFooter, "----------------------------------------------------------
6695. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
6696. 
6697. Statistics Report:
6698. ------------------
6699.    Size:  
6700.    ------------------------
6701.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6702.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6703.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6704. 
6705.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6706.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6707. 
6708.    Location:
6709.    ------------------------
6710.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6711.              Files End: !ZoneEndCurrent!
6712.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6713.       
6714.    Gap Settings:
6715.    ------------------------
6716.          Gap Requested: !ZoneGapSizePer!%
6717.       Volume Rounding: !ZoneVolRoundUpPer!%
6718.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6719.                  
6720.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6721.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6722.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6723.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6724.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6725.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6726.      
6727.    Free Space after Zone:
6728.    ------------------------
6729.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6730.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6731.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6732. 
6733. Directory and Files Select:
6734. ---------------------------
6735. !ZoneTypeSelectCurrent!               
6736. ---------------------------
6737. ----------------------------------------------------------
6738. ")
6739. 
6740. AppendLogfile("!LogFileName!", ".")
6741. AppendLogfile("!LogFileName!", "!ZoneFooter!")
6742. AppendLogfile("!LogFileName!", ".")
6743. 
6744. # Zone Footer Set Statistics Window Text
6745. 
6746. SetStatisticsWindowText("----------------------------------------------------------
6747. Zones Processed: 
6748. ----------------------------------------------------------
6749. !ZoneListByLine!
6750. ----------------------------------------------------------
6751. Zone Processing Step:
6752. !ZoneStepByLine!    
6753. ----------------------------------------------------------
6754. Current Zone:
6755. !ZoneFooter!
6756. ----------------------------------------------------------
6757. Volume Statistics:
6758. !VolumeStatisticsDetail!
6759. ----------------------------------------------------------
6760. Zone Detailed Report:
6761. ----------------------------------------------------------
6762. !ZoneStatisticsDetail!
6763. ----------------------------------------------------------
6764. ")
6765. 
6766. 
6767. 
6768. /* pause() */
6769. /* pause() */
6770. 
6771. 
6772. 
6773. 	
6774. /* ---------------------------------------------------------- */
6775. 
6776. 
6777. /* ---------------------------------------------------------- */
6778. # Zone Programs Fixed size but not windows..
6779. # Script: DefragZoneTypeOsPrograms
6780. /* ---------------------------------------------------------- */
6781. # Zone Programs Fixed size but not windows..
6782. 	SetVariable(ZoneLabel, 			"!ZoneLabelPrograms!")
6783. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPrograms!")
6784. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
6785. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
6786. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsPrograms
6787. # Programs start.
6788. # NotBlobsArchivesBu start.
6789. (not (
6790. # Blobs start.
6791. (
6792. # BlobsAndExceptions start.
6793. ( not(
6794.   FileName("*.bat")
6795.   or FileName("*.css")
6796.   or FileName("*.dll")
6797.   or FileName("*.exe")
6798.   or FileName("*.htm*")
6799.   or FileName("*.jar")
6800.   or FileName("*.js")
6801.   or FileName("*.script")
6802.   or FileName("*.wsf")
6803.   or (
6804. # Databases start.
6805. (
6806.   FileName("*.crypt*")
6807.   or FileName("*.db*")
6808.   or FileName("*.rdb*")
6809.   or FileName("*.dc*")
6810.   or FileName("*.dict*")
6811.   or FileName("*.?db*")
6812.   or FileName("*.?rdb*")
6813.   or FileName("*.md*")
6814.   or FileName("*.myd")
6815.   or FileName("*.ndf")
6816.   or FileName("*.ns?")
6817.   or FileName("*.pab")
6818.   or FileName("*.pst")
6819.   or FileName("*.sd?*")
6820.   or FileName("*.sq**")
6821.   or FileName("*.tmd")
6822.   or FileName("*.tps")
6823.   or FileName("*.tr*")
6824. )
6825. # Databases end.
6826. 
6827.     # BlobsAndExceptions
6828.     or 
6829. # Data start.
6830. (
6831.   DirectoryName("Data*")
6832.   or DirectoryName("Device*")
6833.   or DirectoryName("Export*")
6834.   or DirectoryName("Import*")
6835.   or DirectoryName("Log*")
6836.   or DirectoryName("*Log")
6837.   or DirectoryName("Maintenance*")
6838.   or DirectoryName("Rec*")
6839.   or DirectoryName("Sales*")
6840.   or DirectoryName("Search*")
6841.   or DirectoryName("User*")
6842. )
6843. # Data end.
6844. 
6845.     # BlobsAndExceptions
6846.   )
6847. ) )
6848. # BlobsAndExceptions end.
6849. 
6850. # Blobs
6851. ) and (
6852.   Size(BlobFileSize,0)
6853.   or (
6854.     FileName("*.arj")
6855.     or FileName("*.bup")
6856.     or FileName("*.bz2")
6857.     or FileName("*.chm")
6858.     or FileName("*.dvr-ms")
6859.     or FileName("*.gz")
6860.     or FileName("*.ifo")
6861.     or FileName("*.lzh")
6862.     or FileName("*.pdf")
6863.     or FileName("*.rpm")
6864.     or FileName("*.wmv")
6865.     or FileName("*.vob")
6866.     or FileName("*.z")
6867.   ) 
6868. )
6869. # Blobs end.
6870. 
6871. # NotBlobsArchivesBu
6872. or 
6873. # Archives start.
6874. (
6875.   DirectoryName("*Archive*")
6876.   or DirectoryName("*History*")
6877.   or DirectoryName("*Old")
6878.   or DirectoryName("* Old *")
6879.   or DirectoryName("Old *")
6880. 
6881.   or FileName("*.7z")
6882.   or FileName("*.cab")
6883.   or FileName("*.iso")
6884.   or FileName("*.msi")
6885.   or FileName("*.old")
6886.   or FileName("*.rar")
6887.   or FileName("*.tar")
6888.   or FileName("*.zip")
6889.   or
6890. # WinSysLow start.
6891. (
6892.   DirectoryName("$*")
6893.   or DirectoryName("0*")
6894.   or DirectoryName("1*")
6895.   or DirectoryName("2*")
6896.   or DirectoryName("3*")
6897.   or DirectoryName("4*")
6898.   or DirectoryName("5*")
6899.   or DirectoryName("6*")
6900.   or DirectoryName("7*")
6901.   or DirectoryName("8*")
6902.   or DirectoryName("9*")
6903. 
6904.   or DirectoryName("dllcache")
6905.   or DirectoryName("Downloaded Installations")
6906.   or DirectoryName("Ehome")
6907.   or DirectoryName("Fonts")
6908.   or DirectoryName("Help")
6909.   or DirectoryName("I386")
6910.   or DirectoryName("ie?updates")
6911.   or DirectoryName("Installer")
6912.   or DirectoryName("Installshield Installation Information")
6913.   or DirectoryName("IME")
6914.   or DirectoryName("*RECYCLE*")
6915.   or DirectoryName("ServicePackFiles")
6916.   or DirectoryName("SoftwareDistribution")
6917.   or DirectoryName("Speech")
6918.   or DirectoryName("Symbols")
6919.   or DirectoryName("System Volume Information")
6920.   or DirectoryName("windows.old")
6921. )
6922. # WinSysLow end.
6923. 
6924.   # Archives
6925. )
6926. # Archives end.
6927. 
6928. # NotBlobsArchivesBu
6929. or
6930. # Backups start.
6931. (
6932.   DirectoryName("*Backup*")
6933.   or DirectoryName("*Bu")
6934.   or DirectoryName("* Bu *")
6935.   or DirectoryName("Bu *")
6936. 
6937.   or FileName("*.bak")
6938.   or FileName("* - Copy*")
6939. )
6940. # Backups end.
6941. 
6942. # NotBlobsArchivesBu
6943. ) )
6944. # NotBlobsArchivesBu end.
6945. 
6946. # Programs
6947. and (
6948. # SystemDir start.
6949. (
6950.   DirectoryName("Boot*")
6951.   or DirectoryName("Device*")
6952.   or DirectoryName("DevSupport*")
6953.   or DirectoryName("Program*")
6954.   or DirectoryName("Security*")
6955.   or DirectoryName("SendTo*")
6956.   or DirectoryName("Sw*")
6957.   or DirectoryName("System*")
6958.   or DirectoryName("Toolbars")
6959.   or DirectoryName("Windows*")
6960. )
6961. # SystemDir end.
6962. 
6963. # Programs
6964. )
6965. # Programs end.
6966. 
6967.                 and not(
6968.                      # Script: ZoneDo ZoneTypeSelectOsDataDynamic
6969. # Os Data Dynamic start.
6970. (
6971. # Os Data Dynamic start.
6972. (
6973.   FileName("*.dat*")
6974.   or FileName("*.db*")
6975.   or FileName("*.edb*")
6976.   or FileName("*.log*")
6977.   or FileName("DataStore.edb")
6978. )
6979. # Os Data Dynamic end.
6980. 
6981.   or 
6982. # Os PageHiberDump start.
6983. (
6984.   FileName("DataStore.edb")
6985.   or FileName("DUMP*.*")
6986.   or FileName("Hiberfil.sys")
6987.   or FileName("MEMORY.DMP")
6988.   or FileName("Pagefile.sys")
6989. )
6990. # Os PageHiberDump end.
6991. 
6992. # Os Data Dynamic
6993. )
6994. # Os Data Dynamic end.
6995. 
6996.                      or 
6997.                      DirectoryName("Windows*")
6998.                 )
6999. ')
7000. 
7001. 		# Script: ZoneDoHeader
7002. 
7003. # Script: ZoneWhenStarted
7004. 
7005. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
7006. # Script: DisplaySetZone
7007. 
7008. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
7009. SetVariable(FileStepDescription,	"")
7010. 
7011. SetVariable(ZoneStepByLine, 			"Zone started.
7012. ")
7013. 
7014. # Script: BannerDescriptionSet
7015. 
7016. # Script: BannerSet
7017. 
7018. # Script: DisplaySetDateTimeRun
7019. 
7020. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
7021. /* Xinclude "..\Display\BannerSet.MyDc"X */
7022. /* pause(1) */
7023. 
7024. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7025. 
7026. Title('!Heading!')
7027. /* pause(1) */
7028. 
7029. /* NOTE: Can't round or truncate to integer precision. */
7030. 
7031. # Script: BannerLog
7032. 
7033. AppendLogfile("!LogFileName!", "!Title!")
7034. 
7035. 
7036. 
7037. pause(1)
7038. 
7039. 
7040. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
7041. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
7042. 
7043. SetVariable(ZoneStepNoCurrent, 0)
7044. 
7045. 
7046. # Script: ZoneDoCurrentClear
7047. 
7048. SetVariable(ZoneTypeSelectCurrent, 		"")
7049. 
7050. SetVariable(ZoneBeginCurrent, 			0)
7051. SetVariable(ZoneBeginPerCurrent, 		0)
7052. SetVariable(ZoneEndCurrent, 			0)
7053. SetVariable(ZoneEndPerCurrent, 			0)
7054. 
7055. SetVariable(ZoneSizeCurrent,			0)
7056. SetVariable(ZoneSizePerCurrent,			0)
7057. 
7058. SetVariable(ZoneGapRequestedCurrent,	0)
7059. SetVariable(ZoneGapRoundedCurrent, 		0)
7060. SetVariable(ZoneGapAdjustedCurrent, 	0)
7061. SetVariable(ZoneGapAvailableCurrent, 	0)
7062. SetVariable(ZoneGapCurrent,				0)
7063. SetVariable(ZoneGapUsedCurrent, 		0)
7064. 
7065. SetVariable(ZoneGapActualCurrent, 		0)
7066. SetVariable(ZoneGapActualPerCurrent, 	0)
7067. 
7068. SetVariable(ZoneSizeActual, 			0)
7069. SetVariable(ZoneSizeActualCurrent,		0)
7070. 
7071. SetVariable(ZoneEndActual, 				0)
7072. SetVariable(ZoneEndActualCurrent,		0)			
7073. SetVariable(ZoneSizeActualPerCurrent, 	0)
7074.       
7075. SetVariable(ZoneFilesFolders,			0)
7076. SetVariable(ZoneFilesFoldersPer,		0) 
7077. 
7078. SetVariable(ZoneFragments,				0)
7079. SetVariable(ZoneFragmentsPer,			0) 
7080. 		
7081. SetVariable(ZoneEndActualCurrent, 		0)
7082. SetVariable(ZoneEndActualPerCurrent, 	0)
7083. 
7084. # Gap Calculation Methodology:
7085. 	# Requested
7086. 	SetVariable(GapRequested, 			0) 
7087. 	SetVariable(GapRequestedStd, 		0) 
7088. 	SetVariable(GapRequestedMft, 		0) 
7089. 	SetVariable(GapRequestedOs, 		0) 
7090. 	SetVariable(GapRequestedOriginal, 	0) 
7091. 	
7092. 	# Gap Adjustments
7093. 	SetVariable(GapRounded, 			0)
7094. 	# SetVariable(GapAdjusted, 			0)
7095. 	SetVariable(GapAvailable, 			0)
7096. 	SetVariable(GapCurrent, 			0)
7097. 	SetVariable(GapActual, 				0)
7098. 	SetVariable(GapUsed, 				0)
7099. 	
7100. 	# Gap Adjustments
7101. 	SetVariable(GapRoundedLoc, 			0)
7102. 	# SetVariable(GapAdjustedLoc, 		0)
7103. 	SetVariable(GapAvailableLoc, 		0)
7104. 	SetVariable(GapCurrentLoc, 			0)
7105. 	SetVariable(GapActualLoc,			0)
7106. 	SetVariable(GapUsedLoc,				0)
7107. 	
7108. 	# Space usage
7109. 	SetVariable(ZoneFreePerRequested, 	0)
7110. 	SetVariable(ZoneFreePerUsed, 		0)
7111. 
7112. # Gap Size & Rounding
7113. 	SetVariable(ZoneGapSizePer, 		0)
7114. 	SetVariable(ZoneVolRoundUpPer, 		0)
7115. 	
7116. 	# Free Space
7117. 	SetVariable(ZoneFreeUsedPer, 		0)
7118. 	SetVariable(ZoneFreeRequestedPer, 	0)
7119. 
7120. 
7121. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
7122. 
7123. # Footer:
7124. SetVariable(ZoneFooter, "----------------------------------------------------------
7125. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
7126. 
7127. Statistics Report:
7128. ------------------
7129.    Size:  
7130.    ------------------------
7131.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7132.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7133.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7134. 
7135.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7136.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7137. 
7138.    Location:
7139.    ------------------------
7140.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7141.              Files End: !ZoneEndCurrent!
7142.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7143.       
7144.    Gap Settings:
7145.    ------------------------
7146.          Gap Requested: !ZoneGapSizePer!%
7147.       Volume Rounding: !ZoneVolRoundUpPer!%
7148.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7149.                  
7150.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7151.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7152.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7153.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7154.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7155.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7156.      
7157.    Free Space after Zone:
7158.    ------------------------
7159.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7160.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7161.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7162. 
7163. Directory and Files Select:
7164. ---------------------------
7165. !ZoneTypeSelectCurrent!               
7166. ---------------------------
7167. ----------------------------------------------------------
7168. ")
7169. 
7170. # Script: BannerSet
7171. 
7172. # Script: DisplaySetDateTimeRun
7173. 
7174. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
7175. /* Xinclude "..\Display\BannerSet.MyDc"X */
7176. /* pause(1) */
7177. 
7178. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7179. 
7180. Title('!Heading!')
7181. /* pause(1) */
7182. 
7183. /* NOTE: Can't round or truncate to integer precision. */
7184. 
7185. # Script: BannerLog
7186. 
7187. AppendLogfile("!LogFileName!", "!Title!")
7188. 
7189. 
7190. 
7191. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
7192. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
7193. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:43")
7194. 
7195. SetVariable(ZoneListByLine, "!ZoneListByLine!
7196. Zone: !ZoneNoCurrent! 2021-11-09 20:22:43 0:00:02 !ZoneLabel! !ZoneDescription!")
7197. 
7198. 
7199. /* Fixed Zone Position Handling */
7200. /* Literal number: */
7201. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
7202. /* Percentage of disk: */
7203. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
7204. /* Gap */
7205. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
7206. 
7207. /* ---------------------------------------------------------- */
7208. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
7209. # Script: DisplaySetFileStep
7210. 
7211. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7212. 
7213. /* add message and move to a new line. */
7214. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7215. ")
7216. 
7217. /* display the line. (hopefully.) */
7218. # Zone Footer Set Statistics Window Text
7219. 
7220. SetStatisticsWindowText("----------------------------------------------------------
7221. Zones Processed: 
7222. ----------------------------------------------------------
7223. !ZoneListByLine!
7224. ----------------------------------------------------------
7225. Zone Processing Step:
7226. !ZoneStepByLine!    
7227. ----------------------------------------------------------
7228. Current Zone:
7229. !ZoneFooter!
7230. ----------------------------------------------------------
7231. Volume Statistics:
7232. !VolumeStatisticsDetail!
7233. ----------------------------------------------------------
7234. Zone Detailed Report:
7235. ----------------------------------------------------------
7236. !ZoneStatisticsDetail!
7237. ----------------------------------------------------------
7238. ")
7239. 
7240. 
7241. 
7242. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7243. 
7244. # Script: BannerSet
7245. 
7246. # Script: DisplaySetDateTimeRun
7247. 
7248. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
7249. /* Xinclude "..\Display\BannerSet.MyDc"X */
7250. /* pause(1) */
7251. 
7252. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7253. 
7254. Title('!Heading!')
7255. /* pause(1) */
7256. 
7257. /* NOTE: Can't round or truncate to integer precision. */
7258. 
7259. pause(1)
7260. 
7261. # your stuff HERE (X)... pre file select code.
7262. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
7263. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
7264. 	# (X)
7265. 
7266. FileSelect
7267. 
7268. 	# your stuff can't really go here (errors.)
7269. 	# maybe for some reason I don't know of...
7270. 	
7271. 	# Actions next...
7272. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
7273. # Programs start.
7274. # NotBlobsArchivesBu start.
7275. (not (
7276. # Blobs start.
7277. (
7278. # BlobsAndExceptions start.
7279. ( not(
7280.   FileName("*.bat")
7281.   or FileName("*.css")
7282.   or FileName("*.dll")
7283.   or FileName("*.exe")
7284.   or FileName("*.htm*")
7285.   or FileName("*.jar")
7286.   or FileName("*.js")
7287.   or FileName("*.script")
7288.   or FileName("*.wsf")
7289.   or (
7290. # Databases start.
7291. (
7292.   FileName("*.crypt*")
7293.   or FileName("*.db*")
7294.   or FileName("*.rdb*")
7295.   or FileName("*.dc*")
7296.   or FileName("*.dict*")
7297.   or FileName("*.?db*")
7298.   or FileName("*.?rdb*")
7299.   or FileName("*.md*")
7300.   or FileName("*.myd")
7301.   or FileName("*.ndf")
7302.   or FileName("*.ns?")
7303.   or FileName("*.pab")
7304.   or FileName("*.pst")
7305.   or FileName("*.sd?*")
7306.   or FileName("*.sq**")
7307.   or FileName("*.tmd")
7308.   or FileName("*.tps")
7309.   or FileName("*.tr*")
7310. )
7311. # Databases end.
7312. 
7313.     # BlobsAndExceptions
7314.     or 
7315. # Data start.
7316. (
7317.   DirectoryName("Data*")
7318.   or DirectoryName("Device*")
7319.   or DirectoryName("Export*")
7320.   or DirectoryName("Import*")
7321.   or DirectoryName("Log*")
7322.   or DirectoryName("*Log")
7323.   or DirectoryName("Maintenance*")
7324.   or DirectoryName("Rec*")
7325.   or DirectoryName("Sales*")
7326.   or DirectoryName("Search*")
7327.   or DirectoryName("User*")
7328. )
7329. # Data end.
7330. 
7331.     # BlobsAndExceptions
7332.   )
7333. ) )
7334. # BlobsAndExceptions end.
7335. 
7336. # Blobs
7337. ) and (
7338.   Size(BlobFileSize,0)
7339.   or (
7340.     FileName("*.arj")
7341.     or FileName("*.bup")
7342.     or FileName("*.bz2")
7343.     or FileName("*.chm")
7344.     or FileName("*.dvr-ms")
7345.     or FileName("*.gz")
7346.     or FileName("*.ifo")
7347.     or FileName("*.lzh")
7348.     or FileName("*.pdf")
7349.     or FileName("*.rpm")
7350.     or FileName("*.wmv")
7351.     or FileName("*.vob")
7352.     or FileName("*.z")
7353.   ) 
7354. )
7355. # Blobs end.
7356. 
7357. # NotBlobsArchivesBu
7358. or 
7359. # Archives start.
7360. (
7361.   DirectoryName("*Archive*")
7362.   or DirectoryName("*History*")
7363.   or DirectoryName("*Old")
7364.   or DirectoryName("* Old *")
7365.   or DirectoryName("Old *")
7366. 
7367.   or FileName("*.7z")
7368.   or FileName("*.cab")
7369.   or FileName("*.iso")
7370.   or FileName("*.msi")
7371.   or FileName("*.old")
7372.   or FileName("*.rar")
7373.   or FileName("*.tar")
7374.   or FileName("*.zip")
7375.   or
7376. # WinSysLow start.
7377. (
7378.   DirectoryName("$*")
7379.   or DirectoryName("0*")
7380.   or DirectoryName("1*")
7381.   or DirectoryName("2*")
7382.   or DirectoryName("3*")
7383.   or DirectoryName("4*")
7384.   or DirectoryName("5*")
7385.   or DirectoryName("6*")
7386.   or DirectoryName("7*")
7387.   or DirectoryName("8*")
7388.   or DirectoryName("9*")
7389. 
7390.   or DirectoryName("dllcache")
7391.   or DirectoryName("Downloaded Installations")
7392.   or DirectoryName("Ehome")
7393.   or DirectoryName("Fonts")
7394.   or DirectoryName("Help")
7395.   or DirectoryName("I386")
7396.   or DirectoryName("ie?updates")
7397.   or DirectoryName("Installer")
7398.   or DirectoryName("Installshield Installation Information")
7399.   or DirectoryName("IME")
7400.   or DirectoryName("*RECYCLE*")
7401.   or DirectoryName("ServicePackFiles")
7402.   or DirectoryName("SoftwareDistribution")
7403.   or DirectoryName("Speech")
7404.   or DirectoryName("Symbols")
7405.   or DirectoryName("System Volume Information")
7406.   or DirectoryName("windows.old")
7407. )
7408. # WinSysLow end.
7409. 
7410.   # Archives
7411. )
7412. # Archives end.
7413. 
7414. # NotBlobsArchivesBu
7415. or
7416. # Backups start.
7417. (
7418.   DirectoryName("*Backup*")
7419.   or DirectoryName("*Bu")
7420.   or DirectoryName("* Bu *")
7421.   or DirectoryName("Bu *")
7422. 
7423.   or FileName("*.bak")
7424.   or FileName("* - Copy*")
7425. )
7426. # Backups end.
7427. 
7428. # NotBlobsArchivesBu
7429. ) )
7430. # NotBlobsArchivesBu end.
7431. 
7432. # Programs
7433. and (
7434. # SystemDir start.
7435. (
7436.   DirectoryName("Boot*")
7437.   or DirectoryName("Device*")
7438.   or DirectoryName("DevSupport*")
7439.   or DirectoryName("Program*")
7440.   or DirectoryName("Security*")
7441.   or DirectoryName("SendTo*")
7442.   or DirectoryName("Sw*")
7443.   or DirectoryName("System*")
7444.   or DirectoryName("Toolbars")
7445.   or DirectoryName("Windows*")
7446. )
7447. # SystemDir end.
7448. 
7449. # Programs
7450. )
7451. # Programs end.
7452. 
7453. 		and not(
7454. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
7455. # Os Data Dynamic start.
7456. (
7457. # Os Data Dynamic start.
7458. (
7459.   FileName("*.dat*")
7460.   or FileName("*.db*")
7461.   or FileName("*.edb*")
7462.   or FileName("*.log*")
7463.   or FileName("DataStore.edb")
7464. )
7465. # Os Data Dynamic end.
7466. 
7467.   or 
7468. # Os PageHiberDump start.
7469. (
7470.   FileName("DataStore.edb")
7471.   or FileName("DUMP*.*")
7472.   or FileName("Hiberfil.sys")
7473.   or FileName("MEMORY.DMP")
7474.   or FileName("Pagefile.sys")
7475. )
7476. # Os PageHiberDump end.
7477. 
7478. # Os Data Dynamic
7479. )
7480. # Os Data Dynamic end.
7481. 
7482. 			or 
7483. 				DirectoryName("Windows*")
7484. 		)
7485. 		FileActions
7486. 		  		/* ---------------------------------------------------------- */
7487. 	# Gap
7488. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
7489. 		# Script: DisplaySetFileStep
7490. 
7491. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7492. 
7493. /* add message and move to a new line. */
7494. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7495. ")
7496. 
7497. /* display the line. (hopefully.) */
7498. # Zone Footer Set Statistics Window Text
7499. 
7500. SetStatisticsWindowText("----------------------------------------------------------
7501. Zones Processed: 
7502. ----------------------------------------------------------
7503. !ZoneListByLine!
7504. ----------------------------------------------------------
7505. Zone Processing Step:
7506. !ZoneStepByLine!    
7507. ----------------------------------------------------------
7508. Current Zone:
7509. !ZoneFooter!
7510. ----------------------------------------------------------
7511. Volume Statistics:
7512. !VolumeStatisticsDetail!
7513. ----------------------------------------------------------
7514. Zone Detailed Report:
7515. ----------------------------------------------------------
7516. !ZoneStatisticsDetail!
7517. ----------------------------------------------------------
7518. ")
7519. 
7520. 
7521. 
7522. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7523. 
7524. # Script: BannerSet
7525. 
7526. # Script: DisplaySetDateTimeRun
7527. 
7528. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
7529. /* Xinclude "..\Display\BannerSet.MyDc"X */
7530. /* pause(1) */
7531. 
7532. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7533. 
7534. Title('!Heading!')
7535. /* pause(1) */
7536. 
7537. /* NOTE: Can't round or truncate to integer precision. */
7538. 
7539. pause(1)
7540. 	
7541. 	# ACTUAL GAP
7542. 		/* AddGap Variant. */
7543. 	  	# Zone Do Gap
7544. # Gap Calculation Methods:
7545. 
7546. /* 1) Anything you need to add first. */
7547. /* empty */
7548. 
7549. /* ---------------------------------------------------------- */
7550. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
7551. 	# GapRequestedStd.
7552. 
7553. 		/* ---------------------------------------------------------- */
7554. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
7555. 
7556. 		# Gap Calculation Methods:
7557. 
7558. /* AddGap Variants */
7559. 
7560. 	/* Standard */
7561. 		# Gap Calculation Methods:
7562. 	/* AddGap Variants */
7563. 	/* Standard */
7564. 
7565. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
7566. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
7567. 
7568. 	SetVariable(GapRequested, GapRequestedStd)
7569. 	
7570. 
7571. 	/* MFT Low High Method */
7572. 		# Gap Calculation Methods:
7573. 	/* AddGap Variants */
7574. 	/* MFT Low High Method */
7575. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
7576. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
7577. 	SetVariable(GapRequested, GapRequestedMft)
7578. 	
7579. 
7580. 	/* OS Volume Type Method */
7581. 		# Gap Calculation Methods:
7582. 	/* AddGap Variants */
7583. 	/* OS Volume Type Method */
7584. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
7585. 	SetVariable(GapRequested, GapRequestedOs)
7586. 
7587. 
7588. 
7589. /* MakeGap Variants */
7590. 
7591. 	/* Original Os 1-3 + MFT 2 */
7592. 		# Gap Calculation Methods:
7593. 	/* MakeGap Variants */
7594. 	/* Original Os 1-3 + MFT 2 */
7595. 	/* plus MFT gap placed inline at the dividing zone. */
7596. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
7597. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
7598. 	SetVariable(GapRequested, GapRequestedOrig)
7599. 	
7600. 	
7601. /* Note: You could comment out the ones not in use */
7602. /* However having the data in the log is useful. */
7603. /* Therefore the following line is otherwise needed. */
7604. 
7605. /* Standard used */
7606. 
7607. SetVariable(GapRequested, GapRequestedStd)
7608. 
7609. # Gap Calculation Methods:
7610. 
7611. /* AddGap Variants */
7612. 	/* Standard */
7613. 	/* MFT Low High Method */
7614. 	/* OS Volume Type Method */
7615. 
7616. /* MakeGap Variants */
7617. 	/* Original Os 1-3 + MFT 2 */
7618. 
7619. /* Note: You could comment out the ones not in use */
7620. /* However having the data in the log is useful. */
7621. /* Therefore the following line is otherwise needed. */
7622. 
7623. /* Standard is used currently */
7624. 
7625. 
7626. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
7627. 
7628. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
7629. 
7630. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
7631. 
7632. /* ---------------------------------------------------------- */
7633. /* 3) SMALL ZONE ADJUSTMENT. */
7634. /* Gab cant be larger than half the Zone Size. */
7635. 
7636. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
7637. 	
7638. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
7639. 
7640. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
7641. 
7642. /* ---------------------------------------------------------- */
7643. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
7644. # Gap Adjustments.
7645. 
7646. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
7647. 	
7648. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
7649. 
7650. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
7651. 
7652. /* ---------------------------------------------------------- */
7653. # BYPASS THIS.
7654. 	/* This is definitely wrong. */
7655. 	/* The question is can we steal gap from the next zone */
7656. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
7657. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
7658. 		# Zone Overflow.
7659. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
7660. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
7661. 
7662. /* ---------------------------------------------------------- */
7663. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
7664. # Remaining free space available.
7665. 
7666. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
7667. 	
7668. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
7669. 
7670. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
7671. 
7672. /* ---------------------------------------------------------- */
7673. # CURRENT gap to use.
7674. 
7675. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
7676. 
7677. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
7678. 
7679. /* ---------------------------------------------------------- */
7680. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
7681. # Debugging.
7682. 
7683. 	SetVariable(GapUsed, GapCurrent) // for debugging
7684. 
7685. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
7686. 
7687. 		# Your code HERE
7688. 
7689. /* ---------------------------------------------------------- */
7690. /* 7) YOUR CODE. */
7691. # YOUR CODE HERE:
7692. 	# INPUT: GapCurrent or GapCurrentLoc
7693. 	# OUTPUT: GapUsed...
7694. 
7695. /* ---------------------------------------------------------- */
7696. # Gap Size.
7697. # Actual Size of Gap.
7698. 
7699. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
7700. 
7701. /* ---------------------------------------------------------- */
7702. /* xxxxxxxxxxxxxxxxxxxxxx */
7703. # ADD THE GAP
7704. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
7705. /* xxxxxxxxxxxxxxxxxxxxxx */
7706. 
7707. 	
7708. 	# Zone Statistics	
7709. 	# Script: ZoneDoStatistics
7710. # Zone / Volume Statistics and Display
7711. 		
7712. 	# Accumulate Totals
7713.   	# Script: ZoneDoVolumeTotals
7714. 
7715. /* Current total space used (by Zones and Gaps) */
7716. 
7717. SetVariable(VolumeZoneUsed, GapUsed)
7718. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
7719. /* Percentage */
7720. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
7721. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
7722. 
7723. /* Current total of free space requested */
7724. 
7725. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
7726. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7727. /* Percent. */
7728. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
7729. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7730. 
7731. /* Current total of free space used */
7732. 
7733. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
7734. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
7735. /* Percent */
7736. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
7737. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
7738. 
7739. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
7740. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
7741. /* Xinclude "..\DebugDisplayPause.MyDc"X */
7742. 
7743. 
7744. 	# Current Values
7745. 	# Script: ZoneDoCurrentSet
7746. 
7747. # Cluster, Sector, Block adjust for display.
7748. 	# Bytes per cluster is volume specific.
7749. 
7750. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
7751. 
7752. # Current Zone values.
7753. 	# Begin, end and size.
7754. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
7755. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
7756. 
7757. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
7758. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
7759. 
7760. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
7761. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
7762. 
7763. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
7764. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
7765. 
7766. 	SetVariable(ZoneFragments,				"!ZONE210N!")
7767. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
7768. 		
7769. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
7770. /* identical code to here: (separation not needed. TEST.) */	
7771. 
7772. # Current Gap, Actual and Free Values
7773. 	# Gap
7774. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
7775. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
7776. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
7777. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
7778. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
7779. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
7780. 	
7781. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
7782. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
7783. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
7784. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
7785. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
7786. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
7787. 	
7788. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
7789. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
7790. 	
7791. 	# Actual Size and End
7792. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
7793. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
7794. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
7795. 	
7796. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
7797. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
7798. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
7799. 
7800. # Gap Size & Rounding
7801. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
7802. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
7803. 	
7804. 	# Free Space
7805. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
7806. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
7807. 
7808. 	# Footer:
7809. SetVariable(ZoneFooter, "----------------------------------------------------------
7810. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
7811. 
7812. Statistics Report:
7813. ------------------
7814.    Size:  
7815.    ------------------------
7816.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7817.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7818.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7819. 
7820.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7821.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7822. 
7823.    Location:
7824.    ------------------------
7825.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7826.              Files End: !ZoneEndCurrent!
7827.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7828.       
7829.    Gap Settings:
7830.    ------------------------
7831.          Gap Requested: !ZoneGapSizePer!%
7832.       Volume Rounding: !ZoneVolRoundUpPer!%
7833.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7834.                  
7835.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7836.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7837.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7838.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7839.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7840.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7841.      
7842.    Free Space after Zone:
7843.    ------------------------
7844.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7845.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7846.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7847. 
7848. Directory and Files Select:
7849. ---------------------------
7850. !ZoneTypeSelectCurrent!               
7851. ---------------------------
7852. ----------------------------------------------------------
7853. ")
7854. 	# Zone Footer Set Statistics Window Text
7855. 
7856. SetStatisticsWindowText("----------------------------------------------------------
7857. Zones Processed: 
7858. ----------------------------------------------------------
7859. !ZoneListByLine!
7860. ----------------------------------------------------------
7861. Zone Processing Step:
7862. !ZoneStepByLine!    
7863. ----------------------------------------------------------
7864. Current Zone:
7865. !ZoneFooter!
7866. ----------------------------------------------------------
7867. Volume Statistics:
7868. !VolumeStatisticsDetail!
7869. ----------------------------------------------------------
7870. Zone Detailed Report:
7871. ----------------------------------------------------------
7872. !ZoneStatisticsDetail!
7873. ----------------------------------------------------------
7874. ")
7875. 
7876. 
7877. 	
7878.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
7879. 
7880. 	# Add Zone to list of zones for display.
7881. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
7882. 	# ??? Free Stats?
7883. 	# Footer:
7884. SetVariable(ZoneFooter, "----------------------------------------------------------
7885. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
7886. 
7887. Statistics Report:
7888. ------------------
7889.    Size:  
7890.    ------------------------
7891.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7892.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7893.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7894. 
7895.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7896.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7897. 
7898.    Location:
7899.    ------------------------
7900.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7901.              Files End: !ZoneEndCurrent!
7902.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7903.       
7904.    Gap Settings:
7905.    ------------------------
7906.          Gap Requested: !ZoneGapSizePer!%
7907.       Volume Rounding: !ZoneVolRoundUpPer!%
7908.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7909.                  
7910.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7911.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7912.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7913.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7914.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7915.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7916.      
7917.    Free Space after Zone:
7918.    ------------------------
7919.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7920.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7921.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7922. 
7923. Directory and Files Select:
7924. ---------------------------
7925. !ZoneTypeSelectCurrent!               
7926. ---------------------------
7927. ----------------------------------------------------------
7928. ")
7929. 
7930. 	# Add Zone Details to Report.	
7931. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
7932. !ZoneFooter!")
7933. 
7934. 
7935. 	
7936. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
7937. 			# Script: DisplaySetFileStep
7938. 
7939. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7940. 
7941. /* add message and move to a new line. */
7942. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7943. ")
7944. 
7945. /* display the line. (hopefully.) */
7946. # Zone Footer Set Statistics Window Text
7947. 
7948. SetStatisticsWindowText("----------------------------------------------------------
7949. Zones Processed: 
7950. ----------------------------------------------------------
7951. !ZoneListByLine!
7952. ----------------------------------------------------------
7953. Zone Processing Step:
7954. !ZoneStepByLine!    
7955. ----------------------------------------------------------
7956. Current Zone:
7957. !ZoneFooter!
7958. ----------------------------------------------------------
7959. Volume Statistics:
7960. !VolumeStatisticsDetail!
7961. ----------------------------------------------------------
7962. Zone Detailed Report:
7963. ----------------------------------------------------------
7964. !ZoneStatisticsDetail!
7965. ----------------------------------------------------------
7966. ")
7967. 
7968. 
7969. 
7970. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7971. 
7972. # Script: BannerSet
7973. 
7974. # Script: DisplaySetDateTimeRun
7975. 
7976. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
7977. /* Xinclude "..\Display\BannerSet.MyDc"X */
7978. /* pause(1) */
7979. 
7980. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7981. 
7982. Title('!Heading!')
7983. /* pause(1) */
7984. 
7985. /* NOTE: Can't round or truncate to integer precision. */
7986. 
7987. pause(1)
7988. 
7989. 			# File Action - SortByImportSequence with SkipBlock.
7990. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
7991. 	
7992. 	
7993. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
7994. 			# Script: DisplaySetFileStep
7995. 
7996. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7997. 
7998. /* add message and move to a new line. */
7999. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8000. ")
8001. 
8002. /* display the line. (hopefully.) */
8003. # Zone Footer Set Statistics Window Text
8004. 
8005. SetStatisticsWindowText("----------------------------------------------------------
8006. Zones Processed: 
8007. ----------------------------------------------------------
8008. !ZoneListByLine!
8009. ----------------------------------------------------------
8010. Zone Processing Step:
8011. !ZoneStepByLine!    
8012. ----------------------------------------------------------
8013. Current Zone:
8014. !ZoneFooter!
8015. ----------------------------------------------------------
8016. Volume Statistics:
8017. !VolumeStatisticsDetail!
8018. ----------------------------------------------------------
8019. Zone Detailed Report:
8020. ----------------------------------------------------------
8021. !ZoneStatisticsDetail!
8022. ----------------------------------------------------------
8023. ")
8024. 
8025. 
8026. 
8027. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8028. 
8029. # Script: BannerSet
8030. 
8031. # Script: DisplaySetDateTimeRun
8032. 
8033. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
8034. /* Xinclude "..\Display\BannerSet.MyDc"X */
8035. /* pause(1) */
8036. 
8037. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8038. 
8039. Title('!Heading!')
8040. /* pause(1) */
8041. 
8042. /* NOTE: Can't round or truncate to integer precision. */
8043. 
8044. pause(1)
8045. 
8046. 		# Script: ZoneDoFooter
8047. 
8048. /* ---------------------------------------------------------- */
8049. # File Select
8050. 	# Select Statments
8051. # File Actions 
8052. 	# Standard or OS File Actions.
8053. 	# Resume...
8054. 	
8055. 	# your stuff HERE (X)... post zone (file) file actions code.
8056. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
8057. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8058. 		# (X)
8059. 		
8060. 		/* ??? Set window? */
8061. 	
8062. 	# ADD THE GAP
8063. 		
8064. # Vacate (good for diagnostics)
8065. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
8066. 
8067. # DoNotVacate - DO NOT Vacate (recommended)
8068. 
8069. # Vacate
8070. /* AddGap(GapUsedLoc) */
8071. 
8072. # DO Not Vacate
8073. AddGap(GapUsedLoc, DoNotVacate) 
8074. 	
8075. 	
8076. /* ---------------------------------------------------------- */
8077. # (failed) TEST for boolean logic.
8078. 
8079. /* It should work in the gap calculations for turning options */
8080. /* on and off but it will NOT work here. */
8081. 
8082. /* Boolean setting X or FlagX. */
8083. /* Where X will be on or off: */
8084. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
8085. /*      For ON:  (X  *  FlagAny) */
8086. 
8087. /* 1) Failed, zero gap overrode the previous one. */
8088. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
8089. /* AddGap(GapUsedTemp) */ 
8090. 
8091. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
8092. /* AddGap(GapUsedTemp, DoNotVacate) */ 
8093. 
8094. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
8095. 
8096. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
8097. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
8098. /* AddGap(GapUsedTemp) */ 
8099. 
8100. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
8101. /* AddGap(GapUsedTemp, DoNotVacate) */ 
8102. 
8103. /* ---------------------------------------------------------- */
8104. 
8105. # Vacate
8106. /* AddGap(GapUsed) */
8107. 
8108. # DO NOT Vacate (recommended)
8109. /* AddGap(GapUsed, DoNotVacate) */ 
8110. 	
8111. 
8112. 		
8113. # 
8114. FileEnd
8115. /* ---------------------------------------------------------- */
8116. 
8117. # your stuff HERE (X)... post zone (file) code.
8118. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
8119. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8120. 	# (X)
8121. 
8122. SetVariable(FileStepDescription,"Zone finished, reporting.")
8123. # Script: DisplaySetFileStep
8124. 
8125. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8126. 
8127. /* add message and move to a new line. */
8128. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8129. ")
8130. 
8131. /* display the line. (hopefully.) */
8132. # Zone Footer Set Statistics Window Text
8133. 
8134. SetStatisticsWindowText("----------------------------------------------------------
8135. Zones Processed: 
8136. ----------------------------------------------------------
8137. !ZoneListByLine!
8138. ----------------------------------------------------------
8139. Zone Processing Step:
8140. !ZoneStepByLine!    
8141. ----------------------------------------------------------
8142. Current Zone:
8143. !ZoneFooter!
8144. ----------------------------------------------------------
8145. Volume Statistics:
8146. !VolumeStatisticsDetail!
8147. ----------------------------------------------------------
8148. Zone Detailed Report:
8149. ----------------------------------------------------------
8150. !ZoneStatisticsDetail!
8151. ----------------------------------------------------------
8152. ")
8153. 
8154. 
8155. 
8156. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8157. 
8158. # Script: BannerSet
8159. 
8160. # Script: DisplaySetDateTimeRun
8161. 
8162. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
8163. /* Xinclude "..\Display\BannerSet.MyDc"X */
8164. /* pause(1) */
8165. 
8166. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8167. 
8168. Title('!Heading!')
8169. /* pause(1) */
8170. 
8171. /* NOTE: Can't round or truncate to integer precision. */
8172. 
8173. pause(1)
8174. 
8175. # Script: ZoneWhenFinished
8176. 
8177. # Script: BannerSet
8178. 
8179. # Script: DisplaySetDateTimeRun
8180. 
8181. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:43 0:00:02")
8182. /* Xinclude "..\Display\BannerSet.MyDc"X */
8183. /* pause(1) */
8184. 
8185. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8186. 
8187. Title('!Heading!')
8188. /* pause(1) */
8189. 
8190. /* NOTE: Can't round or truncate to integer precision. */
8191. 
8192. # Script: BannerLog
8193. 
8194. AppendLogfile("!LogFileName!", "!Title!")
8195. 
8196. 
8197. 
8198. # Zone Statistics	
8199. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
8200. 
8201. # Footer:
8202. SetVariable(ZoneFooter, "----------------------------------------------------------
8203. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:43
8204. 
8205. Statistics Report:
8206. ------------------
8207.    Size:  
8208.    ------------------------
8209.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8210.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8211.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8212. 
8213.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8214.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8215. 
8216.    Location:
8217.    ------------------------
8218.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8219.              Files End: !ZoneEndCurrent!
8220.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8221.       
8222.    Gap Settings:
8223.    ------------------------
8224.          Gap Requested: !ZoneGapSizePer!%
8225.       Volume Rounding: !ZoneVolRoundUpPer!%
8226.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8227.                  
8228.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
8229.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
8230.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
8231.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
8232.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
8233.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
8234.      
8235.    Free Space after Zone:
8236.    ------------------------
8237.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8238.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8239.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8240. 
8241. Directory and Files Select:
8242. ---------------------------
8243. !ZoneTypeSelectCurrent!               
8244. ---------------------------
8245. ----------------------------------------------------------
8246. ")
8247. 
8248. AppendLogfile("!LogFileName!", ".")
8249. AppendLogfile("!LogFileName!", "!ZoneFooter!")
8250. AppendLogfile("!LogFileName!", ".")
8251. 
8252. # Zone Footer Set Statistics Window Text
8253. 
8254. SetStatisticsWindowText("----------------------------------------------------------
8255. Zones Processed: 
8256. ----------------------------------------------------------
8257. !ZoneListByLine!
8258. ----------------------------------------------------------
8259. Zone Processing Step:
8260. !ZoneStepByLine!    
8261. ----------------------------------------------------------
8262. Current Zone:
8263. !ZoneFooter!
8264. ----------------------------------------------------------
8265. Volume Statistics:
8266. !VolumeStatisticsDetail!
8267. ----------------------------------------------------------
8268. Zone Detailed Report:
8269. ----------------------------------------------------------
8270. !ZoneStatisticsDetail!
8271. ----------------------------------------------------------
8272. ")
8273. 
8274. 
8275. 
8276. /* pause() */
8277. /* pause() */
8278. 
8279. 
8280. 
8281. 	
8282. /* ---------------------------------------------------------- */
8283. # Zone Programs Fixed size just Windows.
8284. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsWindows!")
8285. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsWindows!")
8286. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
8287. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
8288. 	SetVariable(ZoneTypeSelect,'
8289.                 # Programs - Windows folder.
8290. 				# Script: ZoneDo ZoneTypeSelectOsPrograms
8291. # Programs start.
8292. # NotBlobsArchivesBu start.
8293. (not (
8294. # Blobs start.
8295. (
8296. # BlobsAndExceptions start.
8297. ( not(
8298.   FileName("*.bat")
8299.   or FileName("*.css")
8300.   or FileName("*.dll")
8301.   or FileName("*.exe")
8302.   or FileName("*.htm*")
8303.   or FileName("*.jar")
8304.   or FileName("*.js")
8305.   or FileName("*.script")
8306.   or FileName("*.wsf")
8307.   or (
8308. # Databases start.
8309. (
8310.   FileName("*.crypt*")
8311.   or FileName("*.db*")
8312.   or FileName("*.rdb*")
8313.   or FileName("*.dc*")
8314.   or FileName("*.dict*")
8315.   or FileName("*.?db*")
8316.   or FileName("*.?rdb*")
8317.   or FileName("*.md*")
8318.   or FileName("*.myd")
8319.   or FileName("*.ndf")
8320.   or FileName("*.ns?")
8321.   or FileName("*.pab")
8322.   or FileName("*.pst")
8323.   or FileName("*.sd?*")
8324.   or FileName("*.sq**")
8325.   or FileName("*.tmd")
8326.   or FileName("*.tps")
8327.   or FileName("*.tr*")
8328. )
8329. # Databases end.
8330. 
8331.     # BlobsAndExceptions
8332.     or 
8333. # Data start.
8334. (
8335.   DirectoryName("Data*")
8336.   or DirectoryName("Device*")
8337.   or DirectoryName("Export*")
8338.   or DirectoryName("Import*")
8339.   or DirectoryName("Log*")
8340.   or DirectoryName("*Log")
8341.   or DirectoryName("Maintenance*")
8342.   or DirectoryName("Rec*")
8343.   or DirectoryName("Sales*")
8344.   or DirectoryName("Search*")
8345.   or DirectoryName("User*")
8346. )
8347. # Data end.
8348. 
8349.     # BlobsAndExceptions
8350.   )
8351. ) )
8352. # BlobsAndExceptions end.
8353. 
8354. # Blobs
8355. ) and (
8356.   Size(BlobFileSize,0)
8357.   or (
8358.     FileName("*.arj")
8359.     or FileName("*.bup")
8360.     or FileName("*.bz2")
8361.     or FileName("*.chm")
8362.     or FileName("*.dvr-ms")
8363.     or FileName("*.gz")
8364.     or FileName("*.ifo")
8365.     or FileName("*.lzh")
8366.     or FileName("*.pdf")
8367.     or FileName("*.rpm")
8368.     or FileName("*.wmv")
8369.     or FileName("*.vob")
8370.     or FileName("*.z")
8371.   ) 
8372. )
8373. # Blobs end.
8374. 
8375. # NotBlobsArchivesBu
8376. or 
8377. # Archives start.
8378. (
8379.   DirectoryName("*Archive*")
8380.   or DirectoryName("*History*")
8381.   or DirectoryName("*Old")
8382.   or DirectoryName("* Old *")
8383.   or DirectoryName("Old *")
8384. 
8385.   or FileName("*.7z")
8386.   or FileName("*.cab")
8387.   or FileName("*.iso")
8388.   or FileName("*.msi")
8389.   or FileName("*.old")
8390.   or FileName("*.rar")
8391.   or FileName("*.tar")
8392.   or FileName("*.zip")
8393.   or
8394. # WinSysLow start.
8395. (
8396.   DirectoryName("$*")
8397.   or DirectoryName("0*")
8398.   or DirectoryName("1*")
8399.   or DirectoryName("2*")
8400.   or DirectoryName("3*")
8401.   or DirectoryName("4*")
8402.   or DirectoryName("5*")
8403.   or DirectoryName("6*")
8404.   or DirectoryName("7*")
8405.   or DirectoryName("8*")
8406.   or DirectoryName("9*")
8407. 
8408.   or DirectoryName("dllcache")
8409.   or DirectoryName("Downloaded Installations")
8410.   or DirectoryName("Ehome")
8411.   or DirectoryName("Fonts")
8412.   or DirectoryName("Help")
8413.   or DirectoryName("I386")
8414.   or DirectoryName("ie?updates")
8415.   or DirectoryName("Installer")
8416.   or DirectoryName("Installshield Installation Information")
8417.   or DirectoryName("IME")
8418.   or DirectoryName("*RECYCLE*")
8419.   or DirectoryName("ServicePackFiles")
8420.   or DirectoryName("SoftwareDistribution")
8421.   or DirectoryName("Speech")
8422.   or DirectoryName("Symbols")
8423.   or DirectoryName("System Volume Information")
8424.   or DirectoryName("windows.old")
8425. )
8426. # WinSysLow end.
8427. 
8428.   # Archives
8429. )
8430. # Archives end.
8431. 
8432. # NotBlobsArchivesBu
8433. or
8434. # Backups start.
8435. (
8436.   DirectoryName("*Backup*")
8437.   or DirectoryName("*Bu")
8438.   or DirectoryName("* Bu *")
8439.   or DirectoryName("Bu *")
8440. 
8441.   or FileName("*.bak")
8442.   or FileName("* - Copy*")
8443. )
8444. # Backups end.
8445. 
8446. # NotBlobsArchivesBu
8447. ) )
8448. # NotBlobsArchivesBu end.
8449. 
8450. # Programs
8451. and (
8452. # SystemDir start.
8453. (
8454.   DirectoryName("Boot*")
8455.   or DirectoryName("Device*")
8456.   or DirectoryName("DevSupport*")
8457.   or DirectoryName("Program*")
8458.   or DirectoryName("Security*")
8459.   or DirectoryName("SendTo*")
8460.   or DirectoryName("Sw*")
8461.   or DirectoryName("System*")
8462.   or DirectoryName("Toolbars")
8463.   or DirectoryName("Windows*")
8464. )
8465. # SystemDir end.
8466. 
8467. # Programs
8468. )
8469. # Programs end.
8470. 
8471.                 and not(
8472.                 # Script: ZoneDo ZoneTypeSelectOsDataDynamic
8473. # Os Data Dynamic start.
8474. (
8475. # Os Data Dynamic start.
8476. (
8477.   FileName("*.dat*")
8478.   or FileName("*.db*")
8479.   or FileName("*.edb*")
8480.   or FileName("*.log*")
8481.   or FileName("DataStore.edb")
8482. )
8483. # Os Data Dynamic end.
8484. 
8485.   or 
8486. # Os PageHiberDump start.
8487. (
8488.   FileName("DataStore.edb")
8489.   or FileName("DUMP*.*")
8490.   or FileName("Hiberfil.sys")
8491.   or FileName("MEMORY.DMP")
8492.   or FileName("Pagefile.sys")
8493. )
8494. # Os PageHiberDump end.
8495. 
8496. # Os Data Dynamic
8497. )
8498. # Os Data Dynamic end.
8499. 
8500.                 )
8501. ')
8502. 
8503. 		# Script: ZoneDoHeader
8504. 
8505. # Script: ZoneWhenStarted
8506. 
8507. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
8508. # Script: DisplaySetZone
8509. 
8510. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
8511. SetVariable(FileStepDescription,	"")
8512. 
8513. SetVariable(ZoneStepByLine, 			"Zone started.
8514. ")
8515. 
8516. # Script: BannerDescriptionSet
8517. 
8518. # Script: BannerSet
8519. 
8520. # Script: DisplaySetDateTimeRun
8521. 
8522. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
8523. /* Xinclude "..\Display\BannerSet.MyDc"X */
8524. /* pause(1) */
8525. 
8526. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8527. 
8528. Title('!Heading!')
8529. /* pause(1) */
8530. 
8531. /* NOTE: Can't round or truncate to integer precision. */
8532. 
8533. # Script: BannerLog
8534. 
8535. AppendLogfile("!LogFileName!", "!Title!")
8536. 
8537. 
8538. 
8539. pause(1)
8540. 
8541. 
8542. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
8543. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
8544. 
8545. SetVariable(ZoneStepNoCurrent, 0)
8546. 
8547. 
8548. # Script: ZoneDoCurrentClear
8549. 
8550. SetVariable(ZoneTypeSelectCurrent, 		"")
8551. 
8552. SetVariable(ZoneBeginCurrent, 			0)
8553. SetVariable(ZoneBeginPerCurrent, 		0)
8554. SetVariable(ZoneEndCurrent, 			0)
8555. SetVariable(ZoneEndPerCurrent, 			0)
8556. 
8557. SetVariable(ZoneSizeCurrent,			0)
8558. SetVariable(ZoneSizePerCurrent,			0)
8559. 
8560. SetVariable(ZoneGapRequestedCurrent,	0)
8561. SetVariable(ZoneGapRoundedCurrent, 		0)
8562. SetVariable(ZoneGapAdjustedCurrent, 	0)
8563. SetVariable(ZoneGapAvailableCurrent, 	0)
8564. SetVariable(ZoneGapCurrent,				0)
8565. SetVariable(ZoneGapUsedCurrent, 		0)
8566. 
8567. SetVariable(ZoneGapActualCurrent, 		0)
8568. SetVariable(ZoneGapActualPerCurrent, 	0)
8569. 
8570. SetVariable(ZoneSizeActual, 			0)
8571. SetVariable(ZoneSizeActualCurrent,		0)
8572. 
8573. SetVariable(ZoneEndActual, 				0)
8574. SetVariable(ZoneEndActualCurrent,		0)			
8575. SetVariable(ZoneSizeActualPerCurrent, 	0)
8576.       
8577. SetVariable(ZoneFilesFolders,			0)
8578. SetVariable(ZoneFilesFoldersPer,		0) 
8579. 
8580. SetVariable(ZoneFragments,				0)
8581. SetVariable(ZoneFragmentsPer,			0) 
8582. 		
8583. SetVariable(ZoneEndActualCurrent, 		0)
8584. SetVariable(ZoneEndActualPerCurrent, 	0)
8585. 
8586. # Gap Calculation Methodology:
8587. 	# Requested
8588. 	SetVariable(GapRequested, 			0) 
8589. 	SetVariable(GapRequestedStd, 		0) 
8590. 	SetVariable(GapRequestedMft, 		0) 
8591. 	SetVariable(GapRequestedOs, 		0) 
8592. 	SetVariable(GapRequestedOriginal, 	0) 
8593. 	
8594. 	# Gap Adjustments
8595. 	SetVariable(GapRounded, 			0)
8596. 	# SetVariable(GapAdjusted, 			0)
8597. 	SetVariable(GapAvailable, 			0)
8598. 	SetVariable(GapCurrent, 			0)
8599. 	SetVariable(GapActual, 				0)
8600. 	SetVariable(GapUsed, 				0)
8601. 	
8602. 	# Gap Adjustments
8603. 	SetVariable(GapRoundedLoc, 			0)
8604. 	# SetVariable(GapAdjustedLoc, 		0)
8605. 	SetVariable(GapAvailableLoc, 		0)
8606. 	SetVariable(GapCurrentLoc, 			0)
8607. 	SetVariable(GapActualLoc,			0)
8608. 	SetVariable(GapUsedLoc,				0)
8609. 	
8610. 	# Space usage
8611. 	SetVariable(ZoneFreePerRequested, 	0)
8612. 	SetVariable(ZoneFreePerUsed, 		0)
8613. 
8614. # Gap Size & Rounding
8615. 	SetVariable(ZoneGapSizePer, 		0)
8616. 	SetVariable(ZoneVolRoundUpPer, 		0)
8617. 	
8618. 	# Free Space
8619. 	SetVariable(ZoneFreeUsedPer, 		0)
8620. 	SetVariable(ZoneFreeRequestedPer, 	0)
8621. 
8622. 
8623. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
8624. 
8625. # Footer:
8626. SetVariable(ZoneFooter, "----------------------------------------------------------
8627. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
8628. 
8629. Statistics Report:
8630. ------------------
8631.    Size:  
8632.    ------------------------
8633.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8634.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8635.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8636. 
8637.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8638.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8639. 
8640.    Location:
8641.    ------------------------
8642.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8643.              Files End: !ZoneEndCurrent!
8644.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8645.       
8646.    Gap Settings:
8647.    ------------------------
8648.          Gap Requested: !ZoneGapSizePer!%
8649.       Volume Rounding: !ZoneVolRoundUpPer!%
8650.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8651.                  
8652.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
8653.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
8654.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
8655.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
8656.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
8657.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
8658.      
8659.    Free Space after Zone:
8660.    ------------------------
8661.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8662.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8663.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8664. 
8665. Directory and Files Select:
8666. ---------------------------
8667. !ZoneTypeSelectCurrent!               
8668. ---------------------------
8669. ----------------------------------------------------------
8670. ")
8671. 
8672. # Script: BannerSet
8673. 
8674. # Script: DisplaySetDateTimeRun
8675. 
8676. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
8677. /* Xinclude "..\Display\BannerSet.MyDc"X */
8678. /* pause(1) */
8679. 
8680. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8681. 
8682. Title('!Heading!')
8683. /* pause(1) */
8684. 
8685. /* NOTE: Can't round or truncate to integer precision. */
8686. 
8687. # Script: BannerLog
8688. 
8689. AppendLogfile("!LogFileName!", "!Title!")
8690. 
8691. 
8692. 
8693. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
8694. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
8695. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:44")
8696. 
8697. SetVariable(ZoneListByLine, "!ZoneListByLine!
8698. Zone: !ZoneNoCurrent! 2021-11-09 20:22:44 0:00:03 !ZoneLabel! !ZoneDescription!")
8699. 
8700. 
8701. /* Fixed Zone Position Handling */
8702. /* Literal number: */
8703. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
8704. /* Percentage of disk: */
8705. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
8706. /* Gap */
8707. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
8708. 
8709. /* ---------------------------------------------------------- */
8710. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
8711. # Script: DisplaySetFileStep
8712. 
8713. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8714. 
8715. /* add message and move to a new line. */
8716. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8717. ")
8718. 
8719. /* display the line. (hopefully.) */
8720. # Zone Footer Set Statistics Window Text
8721. 
8722. SetStatisticsWindowText("----------------------------------------------------------
8723. Zones Processed: 
8724. ----------------------------------------------------------
8725. !ZoneListByLine!
8726. ----------------------------------------------------------
8727. Zone Processing Step:
8728. !ZoneStepByLine!    
8729. ----------------------------------------------------------
8730. Current Zone:
8731. !ZoneFooter!
8732. ----------------------------------------------------------
8733. Volume Statistics:
8734. !VolumeStatisticsDetail!
8735. ----------------------------------------------------------
8736. Zone Detailed Report:
8737. ----------------------------------------------------------
8738. !ZoneStatisticsDetail!
8739. ----------------------------------------------------------
8740. ")
8741. 
8742. 
8743. 
8744. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8745. 
8746. # Script: BannerSet
8747. 
8748. # Script: DisplaySetDateTimeRun
8749. 
8750. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
8751. /* Xinclude "..\Display\BannerSet.MyDc"X */
8752. /* pause(1) */
8753. 
8754. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8755. 
8756. Title('!Heading!')
8757. /* pause(1) */
8758. 
8759. /* NOTE: Can't round or truncate to integer precision. */
8760. 
8761. pause(1)
8762. 
8763. # your stuff HERE (X)... pre file select code.
8764. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
8765. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8766. 	# (X)
8767. 
8768. FileSelect
8769. 
8770. 	# your stuff can't really go here (errors.)
8771. 	# maybe for some reason I don't know of...
8772. 	
8773. 	# Actions next...
8774. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
8775. # Programs start.
8776. # NotBlobsArchivesBu start.
8777. (not (
8778. # Blobs start.
8779. (
8780. # BlobsAndExceptions start.
8781. ( not(
8782.   FileName("*.bat")
8783.   or FileName("*.css")
8784.   or FileName("*.dll")
8785.   or FileName("*.exe")
8786.   or FileName("*.htm*")
8787.   or FileName("*.jar")
8788.   or FileName("*.js")
8789.   or FileName("*.script")
8790.   or FileName("*.wsf")
8791.   or (
8792. # Databases start.
8793. (
8794.   FileName("*.crypt*")
8795.   or FileName("*.db*")
8796.   or FileName("*.rdb*")
8797.   or FileName("*.dc*")
8798.   or FileName("*.dict*")
8799.   or FileName("*.?db*")
8800.   or FileName("*.?rdb*")
8801.   or FileName("*.md*")
8802.   or FileName("*.myd")
8803.   or FileName("*.ndf")
8804.   or FileName("*.ns?")
8805.   or FileName("*.pab")
8806.   or FileName("*.pst")
8807.   or FileName("*.sd?*")
8808.   or FileName("*.sq**")
8809.   or FileName("*.tmd")
8810.   or FileName("*.tps")
8811.   or FileName("*.tr*")
8812. )
8813. # Databases end.
8814. 
8815.     # BlobsAndExceptions
8816.     or 
8817. # Data start.
8818. (
8819.   DirectoryName("Data*")
8820.   or DirectoryName("Device*")
8821.   or DirectoryName("Export*")
8822.   or DirectoryName("Import*")
8823.   or DirectoryName("Log*")
8824.   or DirectoryName("*Log")
8825.   or DirectoryName("Maintenance*")
8826.   or DirectoryName("Rec*")
8827.   or DirectoryName("Sales*")
8828.   or DirectoryName("Search*")
8829.   or DirectoryName("User*")
8830. )
8831. # Data end.
8832. 
8833.     # BlobsAndExceptions
8834.   )
8835. ) )
8836. # BlobsAndExceptions end.
8837. 
8838. # Blobs
8839. ) and (
8840.   Size(BlobFileSize,0)
8841.   or (
8842.     FileName("*.arj")
8843.     or FileName("*.bup")
8844.     or FileName("*.bz2")
8845.     or FileName("*.chm")
8846.     or FileName("*.dvr-ms")
8847.     or FileName("*.gz")
8848.     or FileName("*.ifo")
8849.     or FileName("*.lzh")
8850.     or FileName("*.pdf")
8851.     or FileName("*.rpm")
8852.     or FileName("*.wmv")
8853.     or FileName("*.vob")
8854.     or FileName("*.z")
8855.   ) 
8856. )
8857. # Blobs end.
8858. 
8859. # NotBlobsArchivesBu
8860. or 
8861. # Archives start.
8862. (
8863.   DirectoryName("*Archive*")
8864.   or DirectoryName("*History*")
8865.   or DirectoryName("*Old")
8866.   or DirectoryName("* Old *")
8867.   or DirectoryName("Old *")
8868. 
8869.   or FileName("*.7z")
8870.   or FileName("*.cab")
8871.   or FileName("*.iso")
8872.   or FileName("*.msi")
8873.   or FileName("*.old")
8874.   or FileName("*.rar")
8875.   or FileName("*.tar")
8876.   or FileName("*.zip")
8877.   or
8878. # WinSysLow start.
8879. (
8880.   DirectoryName("$*")
8881.   or DirectoryName("0*")
8882.   or DirectoryName("1*")
8883.   or DirectoryName("2*")
8884.   or DirectoryName("3*")
8885.   or DirectoryName("4*")
8886.   or DirectoryName("5*")
8887.   or DirectoryName("6*")
8888.   or DirectoryName("7*")
8889.   or DirectoryName("8*")
8890.   or DirectoryName("9*")
8891. 
8892.   or DirectoryName("dllcache")
8893.   or DirectoryName("Downloaded Installations")
8894.   or DirectoryName("Ehome")
8895.   or DirectoryName("Fonts")
8896.   or DirectoryName("Help")
8897.   or DirectoryName("I386")
8898.   or DirectoryName("ie?updates")
8899.   or DirectoryName("Installer")
8900.   or DirectoryName("Installshield Installation Information")
8901.   or DirectoryName("IME")
8902.   or DirectoryName("*RECYCLE*")
8903.   or DirectoryName("ServicePackFiles")
8904.   or DirectoryName("SoftwareDistribution")
8905.   or DirectoryName("Speech")
8906.   or DirectoryName("Symbols")
8907.   or DirectoryName("System Volume Information")
8908.   or DirectoryName("windows.old")
8909. )
8910. # WinSysLow end.
8911. 
8912.   # Archives
8913. )
8914. # Archives end.
8915. 
8916. # NotBlobsArchivesBu
8917. or
8918. # Backups start.
8919. (
8920.   DirectoryName("*Backup*")
8921.   or DirectoryName("*Bu")
8922.   or DirectoryName("* Bu *")
8923.   or DirectoryName("Bu *")
8924. 
8925.   or FileName("*.bak")
8926.   or FileName("* - Copy*")
8927. )
8928. # Backups end.
8929. 
8930. # NotBlobsArchivesBu
8931. ) )
8932. # NotBlobsArchivesBu end.
8933. 
8934. # Programs
8935. and (
8936. # SystemDir start.
8937. (
8938.   DirectoryName("Boot*")
8939.   or DirectoryName("Device*")
8940.   or DirectoryName("DevSupport*")
8941.   or DirectoryName("Program*")
8942.   or DirectoryName("Security*")
8943.   or DirectoryName("SendTo*")
8944.   or DirectoryName("Sw*")
8945.   or DirectoryName("System*")
8946.   or DirectoryName("Toolbars")
8947.   or DirectoryName("Windows*")
8948. )
8949. # SystemDir end.
8950. 
8951. # Programs
8952. )
8953. # Programs end.
8954. 
8955. 		and not(
8956. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
8957. # Os Data Dynamic start.
8958. (
8959. # Os Data Dynamic start.
8960. (
8961.   FileName("*.dat*")
8962.   or FileName("*.db*")
8963.   or FileName("*.edb*")
8964.   or FileName("*.log*")
8965.   or FileName("DataStore.edb")
8966. )
8967. # Os Data Dynamic end.
8968. 
8969.   or 
8970. # Os PageHiberDump start.
8971. (
8972.   FileName("DataStore.edb")
8973.   or FileName("DUMP*.*")
8974.   or FileName("Hiberfil.sys")
8975.   or FileName("MEMORY.DMP")
8976.   or FileName("Pagefile.sys")
8977. )
8978. # Os PageHiberDump end.
8979. 
8980. # Os Data Dynamic
8981. )
8982. # Os Data Dynamic end.
8983. 
8984. 		)
8985. 
8986. 		FileActions
8987. 		  		/* ---------------------------------------------------------- */
8988. 	# Gap
8989. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
8990. 		# Script: DisplaySetFileStep
8991. 
8992. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8993. 
8994. /* add message and move to a new line. */
8995. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8996. ")
8997. 
8998. /* display the line. (hopefully.) */
8999. # Zone Footer Set Statistics Window Text
9000. 
9001. SetStatisticsWindowText("----------------------------------------------------------
9002. Zones Processed: 
9003. ----------------------------------------------------------
9004. !ZoneListByLine!
9005. ----------------------------------------------------------
9006. Zone Processing Step:
9007. !ZoneStepByLine!    
9008. ----------------------------------------------------------
9009. Current Zone:
9010. !ZoneFooter!
9011. ----------------------------------------------------------
9012. Volume Statistics:
9013. !VolumeStatisticsDetail!
9014. ----------------------------------------------------------
9015. Zone Detailed Report:
9016. ----------------------------------------------------------
9017. !ZoneStatisticsDetail!
9018. ----------------------------------------------------------
9019. ")
9020. 
9021. 
9022. 
9023. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9024. 
9025. # Script: BannerSet
9026. 
9027. # Script: DisplaySetDateTimeRun
9028. 
9029. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
9030. /* Xinclude "..\Display\BannerSet.MyDc"X */
9031. /* pause(1) */
9032. 
9033. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9034. 
9035. Title('!Heading!')
9036. /* pause(1) */
9037. 
9038. /* NOTE: Can't round or truncate to integer precision. */
9039. 
9040. pause(1)
9041. 	
9042. 	# ACTUAL GAP
9043. 		/* AddGap Variant. */
9044. 	  	# Zone Do Gap
9045. # Gap Calculation Methods:
9046. 
9047. /* 1) Anything you need to add first. */
9048. /* empty */
9049. 
9050. /* ---------------------------------------------------------- */
9051. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
9052. 	# GapRequestedStd.
9053. 
9054. 		/* ---------------------------------------------------------- */
9055. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
9056. 
9057. 		# Gap Calculation Methods:
9058. 
9059. /* AddGap Variants */
9060. 
9061. 	/* Standard */
9062. 		# Gap Calculation Methods:
9063. 	/* AddGap Variants */
9064. 	/* Standard */
9065. 
9066. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
9067. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
9068. 
9069. 	SetVariable(GapRequested, GapRequestedStd)
9070. 	
9071. 
9072. 	/* MFT Low High Method */
9073. 		# Gap Calculation Methods:
9074. 	/* AddGap Variants */
9075. 	/* MFT Low High Method */
9076. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
9077. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
9078. 	SetVariable(GapRequested, GapRequestedMft)
9079. 	
9080. 
9081. 	/* OS Volume Type Method */
9082. 		# Gap Calculation Methods:
9083. 	/* AddGap Variants */
9084. 	/* OS Volume Type Method */
9085. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
9086. 	SetVariable(GapRequested, GapRequestedOs)
9087. 
9088. 
9089. 
9090. /* MakeGap Variants */
9091. 
9092. 	/* Original Os 1-3 + MFT 2 */
9093. 		# Gap Calculation Methods:
9094. 	/* MakeGap Variants */
9095. 	/* Original Os 1-3 + MFT 2 */
9096. 	/* plus MFT gap placed inline at the dividing zone. */
9097. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
9098. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
9099. 	SetVariable(GapRequested, GapRequestedOrig)
9100. 	
9101. 	
9102. /* Note: You could comment out the ones not in use */
9103. /* However having the data in the log is useful. */
9104. /* Therefore the following line is otherwise needed. */
9105. 
9106. /* Standard used */
9107. 
9108. SetVariable(GapRequested, GapRequestedStd)
9109. 
9110. # Gap Calculation Methods:
9111. 
9112. /* AddGap Variants */
9113. 	/* Standard */
9114. 	/* MFT Low High Method */
9115. 	/* OS Volume Type Method */
9116. 
9117. /* MakeGap Variants */
9118. 	/* Original Os 1-3 + MFT 2 */
9119. 
9120. /* Note: You could comment out the ones not in use */
9121. /* However having the data in the log is useful. */
9122. /* Therefore the following line is otherwise needed. */
9123. 
9124. /* Standard is used currently */
9125. 
9126. 
9127. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
9128. 
9129. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
9130. 
9131. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
9132. 
9133. /* ---------------------------------------------------------- */
9134. /* 3) SMALL ZONE ADJUSTMENT. */
9135. /* Gab cant be larger than half the Zone Size. */
9136. 
9137. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
9138. 	
9139. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
9140. 
9141. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
9142. 
9143. /* ---------------------------------------------------------- */
9144. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
9145. # Gap Adjustments.
9146. 
9147. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
9148. 	
9149. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
9150. 
9151. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
9152. 
9153. /* ---------------------------------------------------------- */
9154. # BYPASS THIS.
9155. 	/* This is definitely wrong. */
9156. 	/* The question is can we steal gap from the next zone */
9157. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
9158. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
9159. 		# Zone Overflow.
9160. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
9161. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
9162. 
9163. /* ---------------------------------------------------------- */
9164. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
9165. # Remaining free space available.
9166. 
9167. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
9168. 	
9169. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
9170. 
9171. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
9172. 
9173. /* ---------------------------------------------------------- */
9174. # CURRENT gap to use.
9175. 
9176. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
9177. 
9178. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
9179. 
9180. /* ---------------------------------------------------------- */
9181. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
9182. # Debugging.
9183. 
9184. 	SetVariable(GapUsed, GapCurrent) // for debugging
9185. 
9186. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
9187. 
9188. 		# Your code HERE
9189. 
9190. /* ---------------------------------------------------------- */
9191. /* 7) YOUR CODE. */
9192. # YOUR CODE HERE:
9193. 	# INPUT: GapCurrent or GapCurrentLoc
9194. 	# OUTPUT: GapUsed...
9195. 
9196. /* ---------------------------------------------------------- */
9197. # Gap Size.
9198. # Actual Size of Gap.
9199. 
9200. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
9201. 
9202. /* ---------------------------------------------------------- */
9203. /* xxxxxxxxxxxxxxxxxxxxxx */
9204. # ADD THE GAP
9205. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
9206. /* xxxxxxxxxxxxxxxxxxxxxx */
9207. 
9208. 	
9209. 	# Zone Statistics	
9210. 	# Script: ZoneDoStatistics
9211. # Zone / Volume Statistics and Display
9212. 		
9213. 	# Accumulate Totals
9214.   	# Script: ZoneDoVolumeTotals
9215. 
9216. /* Current total space used (by Zones and Gaps) */
9217. 
9218. SetVariable(VolumeZoneUsed, GapUsed)
9219. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
9220. /* Percentage */
9221. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
9222. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
9223. 
9224. /* Current total of free space requested */
9225. 
9226. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
9227. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
9228. /* Percent. */
9229. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
9230. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
9231. 
9232. /* Current total of free space used */
9233. 
9234. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
9235. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
9236. /* Percent */
9237. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
9238. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
9239. 
9240. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
9241. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
9242. /* Xinclude "..\DebugDisplayPause.MyDc"X */
9243. 
9244. 
9245. 	# Current Values
9246. 	# Script: ZoneDoCurrentSet
9247. 
9248. # Cluster, Sector, Block adjust for display.
9249. 	# Bytes per cluster is volume specific.
9250. 
9251. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
9252. 
9253. # Current Zone values.
9254. 	# Begin, end and size.
9255. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
9256. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
9257. 
9258. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
9259. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
9260. 
9261. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
9262. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
9263. 
9264. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
9265. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
9266. 
9267. 	SetVariable(ZoneFragments,				"!ZONE210N!")
9268. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
9269. 		
9270. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
9271. /* identical code to here: (separation not needed. TEST.) */	
9272. 
9273. # Current Gap, Actual and Free Values
9274. 	# Gap
9275. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
9276. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
9277. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
9278. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
9279. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
9280. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
9281. 	
9282. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
9283. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
9284. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
9285. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
9286. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
9287. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
9288. 	
9289. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
9290. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
9291. 	
9292. 	# Actual Size and End
9293. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
9294. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
9295. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
9296. 	
9297. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
9298. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
9299. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
9300. 
9301. # Gap Size & Rounding
9302. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
9303. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
9304. 	
9305. 	# Free Space
9306. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
9307. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
9308. 
9309. 	# Footer:
9310. SetVariable(ZoneFooter, "----------------------------------------------------------
9311. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
9312. 
9313. Statistics Report:
9314. ------------------
9315.    Size:  
9316.    ------------------------
9317.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9318.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9319.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9320. 
9321.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9322.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9323. 
9324.    Location:
9325.    ------------------------
9326.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9327.              Files End: !ZoneEndCurrent!
9328.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9329.       
9330.    Gap Settings:
9331.    ------------------------
9332.          Gap Requested: !ZoneGapSizePer!%
9333.       Volume Rounding: !ZoneVolRoundUpPer!%
9334.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9335.                  
9336.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9337.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9338.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9339.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9340.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9341.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9342.      
9343.    Free Space after Zone:
9344.    ------------------------
9345.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9346.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9347.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9348. 
9349. Directory and Files Select:
9350. ---------------------------
9351. !ZoneTypeSelectCurrent!               
9352. ---------------------------
9353. ----------------------------------------------------------
9354. ")
9355. 	# Zone Footer Set Statistics Window Text
9356. 
9357. SetStatisticsWindowText("----------------------------------------------------------
9358. Zones Processed: 
9359. ----------------------------------------------------------
9360. !ZoneListByLine!
9361. ----------------------------------------------------------
9362. Zone Processing Step:
9363. !ZoneStepByLine!    
9364. ----------------------------------------------------------
9365. Current Zone:
9366. !ZoneFooter!
9367. ----------------------------------------------------------
9368. Volume Statistics:
9369. !VolumeStatisticsDetail!
9370. ----------------------------------------------------------
9371. Zone Detailed Report:
9372. ----------------------------------------------------------
9373. !ZoneStatisticsDetail!
9374. ----------------------------------------------------------
9375. ")
9376. 
9377. 
9378. 	
9379.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
9380. 
9381. 	# Add Zone to list of zones for display.
9382. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
9383. 	# ??? Free Stats?
9384. 	# Footer:
9385. SetVariable(ZoneFooter, "----------------------------------------------------------
9386. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
9387. 
9388. Statistics Report:
9389. ------------------
9390.    Size:  
9391.    ------------------------
9392.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9393.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9394.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9395. 
9396.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9397.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9398. 
9399.    Location:
9400.    ------------------------
9401.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9402.              Files End: !ZoneEndCurrent!
9403.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9404.       
9405.    Gap Settings:
9406.    ------------------------
9407.          Gap Requested: !ZoneGapSizePer!%
9408.       Volume Rounding: !ZoneVolRoundUpPer!%
9409.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9410.                  
9411.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9412.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9413.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9414.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9415.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9416.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9417.      
9418.    Free Space after Zone:
9419.    ------------------------
9420.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9421.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9422.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9423. 
9424. Directory and Files Select:
9425. ---------------------------
9426. !ZoneTypeSelectCurrent!               
9427. ---------------------------
9428. ----------------------------------------------------------
9429. ")
9430. 
9431. 	# Add Zone Details to Report.	
9432. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
9433. !ZoneFooter!")
9434. 
9435. 
9436. 	
9437. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
9438. 			# Script: DisplaySetFileStep
9439. 
9440. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9441. 
9442. /* add message and move to a new line. */
9443. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9444. ")
9445. 
9446. /* display the line. (hopefully.) */
9447. # Zone Footer Set Statistics Window Text
9448. 
9449. SetStatisticsWindowText("----------------------------------------------------------
9450. Zones Processed: 
9451. ----------------------------------------------------------
9452. !ZoneListByLine!
9453. ----------------------------------------------------------
9454. Zone Processing Step:
9455. !ZoneStepByLine!    
9456. ----------------------------------------------------------
9457. Current Zone:
9458. !ZoneFooter!
9459. ----------------------------------------------------------
9460. Volume Statistics:
9461. !VolumeStatisticsDetail!
9462. ----------------------------------------------------------
9463. Zone Detailed Report:
9464. ----------------------------------------------------------
9465. !ZoneStatisticsDetail!
9466. ----------------------------------------------------------
9467. ")
9468. 
9469. 
9470. 
9471. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9472. 
9473. # Script: BannerSet
9474. 
9475. # Script: DisplaySetDateTimeRun
9476. 
9477. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
9478. /* Xinclude "..\Display\BannerSet.MyDc"X */
9479. /* pause(1) */
9480. 
9481. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9482. 
9483. Title('!Heading!')
9484. /* pause(1) */
9485. 
9486. /* NOTE: Can't round or truncate to integer precision. */
9487. 
9488. pause(1)
9489. 
9490. 			# File Action - Type Os Programs - Fast - MoveUpToZone.
9491. # File Action - SortByImportSequence with SkipBlock.
9492. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
9493. 	
9494. 	
9495. 	
9496. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
9497. 			# Script: DisplaySetFileStep
9498. 
9499. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9500. 
9501. /* add message and move to a new line. */
9502. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9503. ")
9504. 
9505. /* display the line. (hopefully.) */
9506. # Zone Footer Set Statistics Window Text
9507. 
9508. SetStatisticsWindowText("----------------------------------------------------------
9509. Zones Processed: 
9510. ----------------------------------------------------------
9511. !ZoneListByLine!
9512. ----------------------------------------------------------
9513. Zone Processing Step:
9514. !ZoneStepByLine!    
9515. ----------------------------------------------------------
9516. Current Zone:
9517. !ZoneFooter!
9518. ----------------------------------------------------------
9519. Volume Statistics:
9520. !VolumeStatisticsDetail!
9521. ----------------------------------------------------------
9522. Zone Detailed Report:
9523. ----------------------------------------------------------
9524. !ZoneStatisticsDetail!
9525. ----------------------------------------------------------
9526. ")
9527. 
9528. 
9529. 
9530. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9531. 
9532. # Script: BannerSet
9533. 
9534. # Script: DisplaySetDateTimeRun
9535. 
9536. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
9537. /* Xinclude "..\Display\BannerSet.MyDc"X */
9538. /* pause(1) */
9539. 
9540. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9541. 
9542. Title('!Heading!')
9543. /* pause(1) */
9544. 
9545. /* NOTE: Can't round or truncate to integer precision. */
9546. 
9547. pause(1)
9548. 
9549. 		# Script: ZoneDoFooter
9550. 
9551. /* ---------------------------------------------------------- */
9552. # File Select
9553. 	# Select Statments
9554. # File Actions 
9555. 	# Standard or OS File Actions.
9556. 	# Resume...
9557. 	
9558. 	# your stuff HERE (X)... post zone (file) file actions code.
9559. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
9560. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9561. 		# (X)
9562. 		
9563. 		/* ??? Set window? */
9564. 	
9565. 	# ADD THE GAP
9566. 		
9567. # Vacate (good for diagnostics)
9568. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
9569. 
9570. # DoNotVacate - DO NOT Vacate (recommended)
9571. 
9572. # Vacate
9573. /* AddGap(GapUsedLoc) */
9574. 
9575. # DO Not Vacate
9576. AddGap(GapUsedLoc, DoNotVacate) 
9577. 	
9578. 	
9579. /* ---------------------------------------------------------- */
9580. # (failed) TEST for boolean logic.
9581. 
9582. /* It should work in the gap calculations for turning options */
9583. /* on and off but it will NOT work here. */
9584. 
9585. /* Boolean setting X or FlagX. */
9586. /* Where X will be on or off: */
9587. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
9588. /*      For ON:  (X  *  FlagAny) */
9589. 
9590. /* 1) Failed, zero gap overrode the previous one. */
9591. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
9592. /* AddGap(GapUsedTemp) */ 
9593. 
9594. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
9595. /* AddGap(GapUsedTemp, DoNotVacate) */ 
9596. 
9597. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
9598. 
9599. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
9600. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
9601. /* AddGap(GapUsedTemp) */ 
9602. 
9603. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
9604. /* AddGap(GapUsedTemp, DoNotVacate) */ 
9605. 
9606. /* ---------------------------------------------------------- */
9607. 
9608. # Vacate
9609. /* AddGap(GapUsed) */
9610. 
9611. # DO NOT Vacate (recommended)
9612. /* AddGap(GapUsed, DoNotVacate) */ 
9613. 	
9614. 
9615. 		
9616. # 
9617. FileEnd
9618. /* ---------------------------------------------------------- */
9619. 
9620. # your stuff HERE (X)... post zone (file) code.
9621. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
9622. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9623. 	# (X)
9624. 
9625. SetVariable(FileStepDescription,"Zone finished, reporting.")
9626. # Script: DisplaySetFileStep
9627. 
9628. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9629. 
9630. /* add message and move to a new line. */
9631. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9632. ")
9633. 
9634. /* display the line. (hopefully.) */
9635. # Zone Footer Set Statistics Window Text
9636. 
9637. SetStatisticsWindowText("----------------------------------------------------------
9638. Zones Processed: 
9639. ----------------------------------------------------------
9640. !ZoneListByLine!
9641. ----------------------------------------------------------
9642. Zone Processing Step:
9643. !ZoneStepByLine!    
9644. ----------------------------------------------------------
9645. Current Zone:
9646. !ZoneFooter!
9647. ----------------------------------------------------------
9648. Volume Statistics:
9649. !VolumeStatisticsDetail!
9650. ----------------------------------------------------------
9651. Zone Detailed Report:
9652. ----------------------------------------------------------
9653. !ZoneStatisticsDetail!
9654. ----------------------------------------------------------
9655. ")
9656. 
9657. 
9658. 
9659. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9660. 
9661. # Script: BannerSet
9662. 
9663. # Script: DisplaySetDateTimeRun
9664. 
9665. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
9666. /* Xinclude "..\Display\BannerSet.MyDc"X */
9667. /* pause(1) */
9668. 
9669. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9670. 
9671. Title('!Heading!')
9672. /* pause(1) */
9673. 
9674. /* NOTE: Can't round or truncate to integer precision. */
9675. 
9676. pause(1)
9677. 
9678. # Script: ZoneWhenFinished
9679. 
9680. # Script: BannerSet
9681. 
9682. # Script: DisplaySetDateTimeRun
9683. 
9684. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
9685. /* Xinclude "..\Display\BannerSet.MyDc"X */
9686. /* pause(1) */
9687. 
9688. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9689. 
9690. Title('!Heading!')
9691. /* pause(1) */
9692. 
9693. /* NOTE: Can't round or truncate to integer precision. */
9694. 
9695. # Script: BannerLog
9696. 
9697. AppendLogfile("!LogFileName!", "!Title!")
9698. 
9699. 
9700. 
9701. # Zone Statistics	
9702. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
9703. 
9704. # Footer:
9705. SetVariable(ZoneFooter, "----------------------------------------------------------
9706. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
9707. 
9708. Statistics Report:
9709. ------------------
9710.    Size:  
9711.    ------------------------
9712.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9713.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9714.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9715. 
9716.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9717.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9718. 
9719.    Location:
9720.    ------------------------
9721.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9722.              Files End: !ZoneEndCurrent!
9723.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9724.       
9725.    Gap Settings:
9726.    ------------------------
9727.          Gap Requested: !ZoneGapSizePer!%
9728.       Volume Rounding: !ZoneVolRoundUpPer!%
9729.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9730.                  
9731.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9732.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9733.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9734.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9735.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9736.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9737.      
9738.    Free Space after Zone:
9739.    ------------------------
9740.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9741.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9742.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9743. 
9744. Directory and Files Select:
9745. ---------------------------
9746. !ZoneTypeSelectCurrent!               
9747. ---------------------------
9748. ----------------------------------------------------------
9749. ")
9750. 
9751. AppendLogfile("!LogFileName!", ".")
9752. AppendLogfile("!LogFileName!", "!ZoneFooter!")
9753. AppendLogfile("!LogFileName!", ".")
9754. 
9755. # Zone Footer Set Statistics Window Text
9756. 
9757. SetStatisticsWindowText("----------------------------------------------------------
9758. Zones Processed: 
9759. ----------------------------------------------------------
9760. !ZoneListByLine!
9761. ----------------------------------------------------------
9762. Zone Processing Step:
9763. !ZoneStepByLine!    
9764. ----------------------------------------------------------
9765. Current Zone:
9766. !ZoneFooter!
9767. ----------------------------------------------------------
9768. Volume Statistics:
9769. !VolumeStatisticsDetail!
9770. ----------------------------------------------------------
9771. Zone Detailed Report:
9772. ----------------------------------------------------------
9773. !ZoneStatisticsDetail!
9774. ----------------------------------------------------------
9775. ")
9776. 
9777. 
9778. 
9779. /* pause() */
9780. /* pause() */
9781. 
9782. 
9783. 
9784. 	
9785. /* ---------------------------------------------------------- */
9786. # Zone Program Data.
9787. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsData!")
9788. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsData!")
9789. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
9790. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
9791. 	SetVariable(ZoneTypeSelect,'
9792.                 # Programs - Data files.
9793.                 not(
9794.                 # Os PageHiberDump start.
9795. (
9796.   FileName("DataStore.edb")
9797.   or FileName("DUMP*.*")
9798.   or FileName("Hiberfil.sys")
9799.   or FileName("MEMORY.DMP")
9800.   or FileName("Pagefile.sys")
9801. )
9802. # Os PageHiberDump end.
9803. 
9804.                 )
9805. ')
9806. 
9807. 		# Script: ZoneDoHeader
9808. 
9809. # Script: ZoneWhenStarted
9810. 
9811. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
9812. # Script: DisplaySetZone
9813. 
9814. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
9815. SetVariable(FileStepDescription,	"")
9816. 
9817. SetVariable(ZoneStepByLine, 			"Zone started.
9818. ")
9819. 
9820. # Script: BannerDescriptionSet
9821. 
9822. # Script: BannerSet
9823. 
9824. # Script: DisplaySetDateTimeRun
9825. 
9826. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
9827. /* Xinclude "..\Display\BannerSet.MyDc"X */
9828. /* pause(1) */
9829. 
9830. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9831. 
9832. Title('!Heading!')
9833. /* pause(1) */
9834. 
9835. /* NOTE: Can't round or truncate to integer precision. */
9836. 
9837. # Script: BannerLog
9838. 
9839. AppendLogfile("!LogFileName!", "!Title!")
9840. 
9841. 
9842. 
9843. pause(1)
9844. 
9845. 
9846. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
9847. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
9848. 
9849. SetVariable(ZoneStepNoCurrent, 0)
9850. 
9851. 
9852. # Script: ZoneDoCurrentClear
9853. 
9854. SetVariable(ZoneTypeSelectCurrent, 		"")
9855. 
9856. SetVariable(ZoneBeginCurrent, 			0)
9857. SetVariable(ZoneBeginPerCurrent, 		0)
9858. SetVariable(ZoneEndCurrent, 			0)
9859. SetVariable(ZoneEndPerCurrent, 			0)
9860. 
9861. SetVariable(ZoneSizeCurrent,			0)
9862. SetVariable(ZoneSizePerCurrent,			0)
9863. 
9864. SetVariable(ZoneGapRequestedCurrent,	0)
9865. SetVariable(ZoneGapRoundedCurrent, 		0)
9866. SetVariable(ZoneGapAdjustedCurrent, 	0)
9867. SetVariable(ZoneGapAvailableCurrent, 	0)
9868. SetVariable(ZoneGapCurrent,				0)
9869. SetVariable(ZoneGapUsedCurrent, 		0)
9870. 
9871. SetVariable(ZoneGapActualCurrent, 		0)
9872. SetVariable(ZoneGapActualPerCurrent, 	0)
9873. 
9874. SetVariable(ZoneSizeActual, 			0)
9875. SetVariable(ZoneSizeActualCurrent,		0)
9876. 
9877. SetVariable(ZoneEndActual, 				0)
9878. SetVariable(ZoneEndActualCurrent,		0)			
9879. SetVariable(ZoneSizeActualPerCurrent, 	0)
9880.       
9881. SetVariable(ZoneFilesFolders,			0)
9882. SetVariable(ZoneFilesFoldersPer,		0) 
9883. 
9884. SetVariable(ZoneFragments,				0)
9885. SetVariable(ZoneFragmentsPer,			0) 
9886. 		
9887. SetVariable(ZoneEndActualCurrent, 		0)
9888. SetVariable(ZoneEndActualPerCurrent, 	0)
9889. 
9890. # Gap Calculation Methodology:
9891. 	# Requested
9892. 	SetVariable(GapRequested, 			0) 
9893. 	SetVariable(GapRequestedStd, 		0) 
9894. 	SetVariable(GapRequestedMft, 		0) 
9895. 	SetVariable(GapRequestedOs, 		0) 
9896. 	SetVariable(GapRequestedOriginal, 	0) 
9897. 	
9898. 	# Gap Adjustments
9899. 	SetVariable(GapRounded, 			0)
9900. 	# SetVariable(GapAdjusted, 			0)
9901. 	SetVariable(GapAvailable, 			0)
9902. 	SetVariable(GapCurrent, 			0)
9903. 	SetVariable(GapActual, 				0)
9904. 	SetVariable(GapUsed, 				0)
9905. 	
9906. 	# Gap Adjustments
9907. 	SetVariable(GapRoundedLoc, 			0)
9908. 	# SetVariable(GapAdjustedLoc, 		0)
9909. 	SetVariable(GapAvailableLoc, 		0)
9910. 	SetVariable(GapCurrentLoc, 			0)
9911. 	SetVariable(GapActualLoc,			0)
9912. 	SetVariable(GapUsedLoc,				0)
9913. 	
9914. 	# Space usage
9915. 	SetVariable(ZoneFreePerRequested, 	0)
9916. 	SetVariable(ZoneFreePerUsed, 		0)
9917. 
9918. # Gap Size & Rounding
9919. 	SetVariable(ZoneGapSizePer, 		0)
9920. 	SetVariable(ZoneVolRoundUpPer, 		0)
9921. 	
9922. 	# Free Space
9923. 	SetVariable(ZoneFreeUsedPer, 		0)
9924. 	SetVariable(ZoneFreeRequestedPer, 	0)
9925. 
9926. 
9927. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
9928. 
9929. # Footer:
9930. SetVariable(ZoneFooter, "----------------------------------------------------------
9931. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
9932. 
9933. Statistics Report:
9934. ------------------
9935.    Size:  
9936.    ------------------------
9937.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9938.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9939.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9940. 
9941.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9942.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9943. 
9944.    Location:
9945.    ------------------------
9946.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9947.              Files End: !ZoneEndCurrent!
9948.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9949.       
9950.    Gap Settings:
9951.    ------------------------
9952.          Gap Requested: !ZoneGapSizePer!%
9953.       Volume Rounding: !ZoneVolRoundUpPer!%
9954.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9955.                  
9956.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9957.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9958.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9959.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9960.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9961.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9962.      
9963.    Free Space after Zone:
9964.    ------------------------
9965.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9966.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9967.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9968. 
9969. Directory and Files Select:
9970. ---------------------------
9971. !ZoneTypeSelectCurrent!               
9972. ---------------------------
9973. ----------------------------------------------------------
9974. ")
9975. 
9976. # Script: BannerSet
9977. 
9978. # Script: DisplaySetDateTimeRun
9979. 
9980. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
9981. /* Xinclude "..\Display\BannerSet.MyDc"X */
9982. /* pause(1) */
9983. 
9984. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9985. 
9986. Title('!Heading!')
9987. /* pause(1) */
9988. 
9989. /* NOTE: Can't round or truncate to integer precision. */
9990. 
9991. # Script: BannerLog
9992. 
9993. AppendLogfile("!LogFileName!", "!Title!")
9994. 
9995. 
9996. 
9997. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
9998. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
9999. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:44")
10000. 
10001. SetVariable(ZoneListByLine, "!ZoneListByLine!
10002. Zone: !ZoneNoCurrent! 2021-11-09 20:22:44 0:00:03 !ZoneLabel! !ZoneDescription!")
10003. 
10004. 
10005. /* Fixed Zone Position Handling */
10006. /* Literal number: */
10007. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
10008. /* Percentage of disk: */
10009. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
10010. /* Gap */
10011. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
10012. 
10013. /* ---------------------------------------------------------- */
10014. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
10015. # Script: DisplaySetFileStep
10016. 
10017. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10018. 
10019. /* add message and move to a new line. */
10020. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10021. ")
10022. 
10023. /* display the line. (hopefully.) */
10024. # Zone Footer Set Statistics Window Text
10025. 
10026. SetStatisticsWindowText("----------------------------------------------------------
10027. Zones Processed: 
10028. ----------------------------------------------------------
10029. !ZoneListByLine!
10030. ----------------------------------------------------------
10031. Zone Processing Step:
10032. !ZoneStepByLine!    
10033. ----------------------------------------------------------
10034. Current Zone:
10035. !ZoneFooter!
10036. ----------------------------------------------------------
10037. Volume Statistics:
10038. !VolumeStatisticsDetail!
10039. ----------------------------------------------------------
10040. Zone Detailed Report:
10041. ----------------------------------------------------------
10042. !ZoneStatisticsDetail!
10043. ----------------------------------------------------------
10044. ")
10045. 
10046. 
10047. 
10048. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10049. 
10050. # Script: BannerSet
10051. 
10052. # Script: DisplaySetDateTimeRun
10053. 
10054. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
10055. /* Xinclude "..\Display\BannerSet.MyDc"X */
10056. /* pause(1) */
10057. 
10058. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10059. 
10060. Title('!Heading!')
10061. /* pause(1) */
10062. 
10063. /* NOTE: Can't round or truncate to integer precision. */
10064. 
10065. pause(1)
10066. 
10067. # your stuff HERE (X)... pre file select code.
10068. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
10069. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
10070. 	# (X)
10071. 
10072. FileSelect
10073. 
10074. 	# your stuff can't really go here (errors.)
10075. 	# maybe for some reason I don't know of...
10076. 	
10077. 	# Actions next...
10078. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
10079. # Programs start.
10080. # NotBlobsArchivesBu start.
10081. (not (
10082. # Blobs start.
10083. (
10084. # BlobsAndExceptions start.
10085. ( not(
10086.   FileName("*.bat")
10087.   or FileName("*.css")
10088.   or FileName("*.dll")
10089.   or FileName("*.exe")
10090.   or FileName("*.htm*")
10091.   or FileName("*.jar")
10092.   or FileName("*.js")
10093.   or FileName("*.script")
10094.   or FileName("*.wsf")
10095.   or (
10096. # Databases start.
10097. (
10098.   FileName("*.crypt*")
10099.   or FileName("*.db*")
10100.   or FileName("*.rdb*")
10101.   or FileName("*.dc*")
10102.   or FileName("*.dict*")
10103.   or FileName("*.?db*")
10104.   or FileName("*.?rdb*")
10105.   or FileName("*.md*")
10106.   or FileName("*.myd")
10107.   or FileName("*.ndf")
10108.   or FileName("*.ns?")
10109.   or FileName("*.pab")
10110.   or FileName("*.pst")
10111.   or FileName("*.sd?*")
10112.   or FileName("*.sq**")
10113.   or FileName("*.tmd")
10114.   or FileName("*.tps")
10115.   or FileName("*.tr*")
10116. )
10117. # Databases end.
10118. 
10119.     # BlobsAndExceptions
10120.     or 
10121. # Data start.
10122. (
10123.   DirectoryName("Data*")
10124.   or DirectoryName("Device*")
10125.   or DirectoryName("Export*")
10126.   or DirectoryName("Import*")
10127.   or DirectoryName("Log*")
10128.   or DirectoryName("*Log")
10129.   or DirectoryName("Maintenance*")
10130.   or DirectoryName("Rec*")
10131.   or DirectoryName("Sales*")
10132.   or DirectoryName("Search*")
10133.   or DirectoryName("User*")
10134. )
10135. # Data end.
10136. 
10137.     # BlobsAndExceptions
10138.   )
10139. ) )
10140. # BlobsAndExceptions end.
10141. 
10142. # Blobs
10143. ) and (
10144.   Size(BlobFileSize,0)
10145.   or (
10146.     FileName("*.arj")
10147.     or FileName("*.bup")
10148.     or FileName("*.bz2")
10149.     or FileName("*.chm")
10150.     or FileName("*.dvr-ms")
10151.     or FileName("*.gz")
10152.     or FileName("*.ifo")
10153.     or FileName("*.lzh")
10154.     or FileName("*.pdf")
10155.     or FileName("*.rpm")
10156.     or FileName("*.wmv")
10157.     or FileName("*.vob")
10158.     or FileName("*.z")
10159.   ) 
10160. )
10161. # Blobs end.
10162. 
10163. # NotBlobsArchivesBu
10164. or 
10165. # Archives start.
10166. (
10167.   DirectoryName("*Archive*")
10168.   or DirectoryName("*History*")
10169.   or DirectoryName("*Old")
10170.   or DirectoryName("* Old *")
10171.   or DirectoryName("Old *")
10172. 
10173.   or FileName("*.7z")
10174.   or FileName("*.cab")
10175.   or FileName("*.iso")
10176.   or FileName("*.msi")
10177.   or FileName("*.old")
10178.   or FileName("*.rar")
10179.   or FileName("*.tar")
10180.   or FileName("*.zip")
10181.   or
10182. # WinSysLow start.
10183. (
10184.   DirectoryName("$*")
10185.   or DirectoryName("0*")
10186.   or DirectoryName("1*")
10187.   or DirectoryName("2*")
10188.   or DirectoryName("3*")
10189.   or DirectoryName("4*")
10190.   or DirectoryName("5*")
10191.   or DirectoryName("6*")
10192.   or DirectoryName("7*")
10193.   or DirectoryName("8*")
10194.   or DirectoryName("9*")
10195. 
10196.   or DirectoryName("dllcache")
10197.   or DirectoryName("Downloaded Installations")
10198.   or DirectoryName("Ehome")
10199.   or DirectoryName("Fonts")
10200.   or DirectoryName("Help")
10201.   or DirectoryName("I386")
10202.   or DirectoryName("ie?updates")
10203.   or DirectoryName("Installer")
10204.   or DirectoryName("Installshield Installation Information")
10205.   or DirectoryName("IME")
10206.   or DirectoryName("*RECYCLE*")
10207.   or DirectoryName("ServicePackFiles")
10208.   or DirectoryName("SoftwareDistribution")
10209.   or DirectoryName("Speech")
10210.   or DirectoryName("Symbols")
10211.   or DirectoryName("System Volume Information")
10212.   or DirectoryName("windows.old")
10213. )
10214. # WinSysLow end.
10215. 
10216.   # Archives
10217. )
10218. # Archives end.
10219. 
10220. # NotBlobsArchivesBu
10221. or
10222. # Backups start.
10223. (
10224.   DirectoryName("*Backup*")
10225.   or DirectoryName("*Bu")
10226.   or DirectoryName("* Bu *")
10227.   or DirectoryName("Bu *")
10228. 
10229.   or FileName("*.bak")
10230.   or FileName("* - Copy*")
10231. )
10232. # Backups end.
10233. 
10234. # NotBlobsArchivesBu
10235. ) )
10236. # NotBlobsArchivesBu end.
10237. 
10238. # Programs
10239. and (
10240. # SystemDir start.
10241. (
10242.   DirectoryName("Boot*")
10243.   or DirectoryName("Device*")
10244.   or DirectoryName("DevSupport*")
10245.   or DirectoryName("Program*")
10246.   or DirectoryName("Security*")
10247.   or DirectoryName("SendTo*")
10248.   or DirectoryName("Sw*")
10249.   or DirectoryName("System*")
10250.   or DirectoryName("Toolbars")
10251.   or DirectoryName("Windows*")
10252. )
10253. # SystemDir end.
10254. 
10255. # Programs
10256. )
10257. # Programs end.
10258. 
10259. 		and not(
10260. 			# Os PageHiberDump start.
10261. (
10262.   FileName("DataStore.edb")
10263.   or FileName("DUMP*.*")
10264.   or FileName("Hiberfil.sys")
10265.   or FileName("MEMORY.DMP")
10266.   or FileName("Pagefile.sys")
10267. )
10268. # Os PageHiberDump end.
10269. 
10270. 		)
10271. 
10272. 		FileActions
10273. 		  		/* ---------------------------------------------------------- */
10274. 	# Gap
10275. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
10276. 		# Script: DisplaySetFileStep
10277. 
10278. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10279. 
10280. /* add message and move to a new line. */
10281. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10282. ")
10283. 
10284. /* display the line. (hopefully.) */
10285. # Zone Footer Set Statistics Window Text
10286. 
10287. SetStatisticsWindowText("----------------------------------------------------------
10288. Zones Processed: 
10289. ----------------------------------------------------------
10290. !ZoneListByLine!
10291. ----------------------------------------------------------
10292. Zone Processing Step:
10293. !ZoneStepByLine!    
10294. ----------------------------------------------------------
10295. Current Zone:
10296. !ZoneFooter!
10297. ----------------------------------------------------------
10298. Volume Statistics:
10299. !VolumeStatisticsDetail!
10300. ----------------------------------------------------------
10301. Zone Detailed Report:
10302. ----------------------------------------------------------
10303. !ZoneStatisticsDetail!
10304. ----------------------------------------------------------
10305. ")
10306. 
10307. 
10308. 
10309. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10310. 
10311. # Script: BannerSet
10312. 
10313. # Script: DisplaySetDateTimeRun
10314. 
10315. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
10316. /* Xinclude "..\Display\BannerSet.MyDc"X */
10317. /* pause(1) */
10318. 
10319. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10320. 
10321. Title('!Heading!')
10322. /* pause(1) */
10323. 
10324. /* NOTE: Can't round or truncate to integer precision. */
10325. 
10326. pause(1)
10327. 	
10328. 	# ACTUAL GAP
10329. 		/* AddGap Variant. */
10330. 	  	# Zone Do Gap
10331. # Gap Calculation Methods:
10332. 
10333. /* 1) Anything you need to add first. */
10334. /* empty */
10335. 
10336. /* ---------------------------------------------------------- */
10337. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
10338. 	# GapRequestedStd.
10339. 
10340. 		/* ---------------------------------------------------------- */
10341. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
10342. 
10343. 		# Gap Calculation Methods:
10344. 
10345. /* AddGap Variants */
10346. 
10347. 	/* Standard */
10348. 		# Gap Calculation Methods:
10349. 	/* AddGap Variants */
10350. 	/* Standard */
10351. 
10352. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
10353. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
10354. 
10355. 	SetVariable(GapRequested, GapRequestedStd)
10356. 	
10357. 
10358. 	/* MFT Low High Method */
10359. 		# Gap Calculation Methods:
10360. 	/* AddGap Variants */
10361. 	/* MFT Low High Method */
10362. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
10363. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
10364. 	SetVariable(GapRequested, GapRequestedMft)
10365. 	
10366. 
10367. 	/* OS Volume Type Method */
10368. 		# Gap Calculation Methods:
10369. 	/* AddGap Variants */
10370. 	/* OS Volume Type Method */
10371. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
10372. 	SetVariable(GapRequested, GapRequestedOs)
10373. 
10374. 
10375. 
10376. /* MakeGap Variants */
10377. 
10378. 	/* Original Os 1-3 + MFT 2 */
10379. 		# Gap Calculation Methods:
10380. 	/* MakeGap Variants */
10381. 	/* Original Os 1-3 + MFT 2 */
10382. 	/* plus MFT gap placed inline at the dividing zone. */
10383. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
10384. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
10385. 	SetVariable(GapRequested, GapRequestedOrig)
10386. 	
10387. 	
10388. /* Note: You could comment out the ones not in use */
10389. /* However having the data in the log is useful. */
10390. /* Therefore the following line is otherwise needed. */
10391. 
10392. /* Standard used */
10393. 
10394. SetVariable(GapRequested, GapRequestedStd)
10395. 
10396. # Gap Calculation Methods:
10397. 
10398. /* AddGap Variants */
10399. 	/* Standard */
10400. 	/* MFT Low High Method */
10401. 	/* OS Volume Type Method */
10402. 
10403. /* MakeGap Variants */
10404. 	/* Original Os 1-3 + MFT 2 */
10405. 
10406. /* Note: You could comment out the ones not in use */
10407. /* However having the data in the log is useful. */
10408. /* Therefore the following line is otherwise needed. */
10409. 
10410. /* Standard is used currently */
10411. 
10412. 
10413. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
10414. 
10415. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
10416. 
10417. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
10418. 
10419. /* ---------------------------------------------------------- */
10420. /* 3) SMALL ZONE ADJUSTMENT. */
10421. /* Gab cant be larger than half the Zone Size. */
10422. 
10423. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
10424. 	
10425. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
10426. 
10427. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
10428. 
10429. /* ---------------------------------------------------------- */
10430. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
10431. # Gap Adjustments.
10432. 
10433. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
10434. 	
10435. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
10436. 
10437. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
10438. 
10439. /* ---------------------------------------------------------- */
10440. # BYPASS THIS.
10441. 	/* This is definitely wrong. */
10442. 	/* The question is can we steal gap from the next zone */
10443. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
10444. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
10445. 		# Zone Overflow.
10446. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
10447. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
10448. 
10449. /* ---------------------------------------------------------- */
10450. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
10451. # Remaining free space available.
10452. 
10453. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
10454. 	
10455. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
10456. 
10457. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
10458. 
10459. /* ---------------------------------------------------------- */
10460. # CURRENT gap to use.
10461. 
10462. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
10463. 
10464. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
10465. 
10466. /* ---------------------------------------------------------- */
10467. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
10468. # Debugging.
10469. 
10470. 	SetVariable(GapUsed, GapCurrent) // for debugging
10471. 
10472. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
10473. 
10474. 		# Your code HERE
10475. 
10476. /* ---------------------------------------------------------- */
10477. /* 7) YOUR CODE. */
10478. # YOUR CODE HERE:
10479. 	# INPUT: GapCurrent or GapCurrentLoc
10480. 	# OUTPUT: GapUsed...
10481. 
10482. /* ---------------------------------------------------------- */
10483. # Gap Size.
10484. # Actual Size of Gap.
10485. 
10486. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
10487. 
10488. /* ---------------------------------------------------------- */
10489. /* xxxxxxxxxxxxxxxxxxxxxx */
10490. # ADD THE GAP
10491. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
10492. /* xxxxxxxxxxxxxxxxxxxxxx */
10493. 
10494. 	
10495. 	# Zone Statistics	
10496. 	# Script: ZoneDoStatistics
10497. # Zone / Volume Statistics and Display
10498. 		
10499. 	# Accumulate Totals
10500.   	# Script: ZoneDoVolumeTotals
10501. 
10502. /* Current total space used (by Zones and Gaps) */
10503. 
10504. SetVariable(VolumeZoneUsed, GapUsed)
10505. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
10506. /* Percentage */
10507. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
10508. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
10509. 
10510. /* Current total of free space requested */
10511. 
10512. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
10513. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10514. /* Percent. */
10515. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
10516. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10517. 
10518. /* Current total of free space used */
10519. 
10520. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
10521. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
10522. /* Percent */
10523. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
10524. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
10525. 
10526. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
10527. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
10528. /* Xinclude "..\DebugDisplayPause.MyDc"X */
10529. 
10530. 
10531. 	# Current Values
10532. 	# Script: ZoneDoCurrentSet
10533. 
10534. # Cluster, Sector, Block adjust for display.
10535. 	# Bytes per cluster is volume specific.
10536. 
10537. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
10538. 
10539. # Current Zone values.
10540. 	# Begin, end and size.
10541. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
10542. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
10543. 
10544. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
10545. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
10546. 
10547. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
10548. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
10549. 
10550. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
10551. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
10552. 
10553. 	SetVariable(ZoneFragments,				"!ZONE210N!")
10554. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
10555. 		
10556. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
10557. /* identical code to here: (separation not needed. TEST.) */	
10558. 
10559. # Current Gap, Actual and Free Values
10560. 	# Gap
10561. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
10562. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
10563. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
10564. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
10565. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
10566. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
10567. 	
10568. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
10569. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
10570. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
10571. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
10572. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
10573. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
10574. 	
10575. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
10576. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
10577. 	
10578. 	# Actual Size and End
10579. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
10580. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
10581. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
10582. 	
10583. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
10584. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
10585. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
10586. 
10587. # Gap Size & Rounding
10588. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
10589. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
10590. 	
10591. 	# Free Space
10592. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
10593. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
10594. 
10595. 	# Footer:
10596. SetVariable(ZoneFooter, "----------------------------------------------------------
10597. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
10598. 
10599. Statistics Report:
10600. ------------------
10601.    Size:  
10602.    ------------------------
10603.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10604.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10605.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10606. 
10607.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10608.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10609. 
10610.    Location:
10611.    ------------------------
10612.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10613.              Files End: !ZoneEndCurrent!
10614.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10615.       
10616.    Gap Settings:
10617.    ------------------------
10618.          Gap Requested: !ZoneGapSizePer!%
10619.       Volume Rounding: !ZoneVolRoundUpPer!%
10620.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10621.                  
10622.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
10623.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
10624.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
10625.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
10626.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
10627.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
10628.      
10629.    Free Space after Zone:
10630.    ------------------------
10631.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10632.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10633.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10634. 
10635. Directory and Files Select:
10636. ---------------------------
10637. !ZoneTypeSelectCurrent!               
10638. ---------------------------
10639. ----------------------------------------------------------
10640. ")
10641. 	# Zone Footer Set Statistics Window Text
10642. 
10643. SetStatisticsWindowText("----------------------------------------------------------
10644. Zones Processed: 
10645. ----------------------------------------------------------
10646. !ZoneListByLine!
10647. ----------------------------------------------------------
10648. Zone Processing Step:
10649. !ZoneStepByLine!    
10650. ----------------------------------------------------------
10651. Current Zone:
10652. !ZoneFooter!
10653. ----------------------------------------------------------
10654. Volume Statistics:
10655. !VolumeStatisticsDetail!
10656. ----------------------------------------------------------
10657. Zone Detailed Report:
10658. ----------------------------------------------------------
10659. !ZoneStatisticsDetail!
10660. ----------------------------------------------------------
10661. ")
10662. 
10663. 
10664. 	
10665.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
10666. 
10667. 	# Add Zone to list of zones for display.
10668. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
10669. 	# ??? Free Stats?
10670. 	# Footer:
10671. SetVariable(ZoneFooter, "----------------------------------------------------------
10672. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
10673. 
10674. Statistics Report:
10675. ------------------
10676.    Size:  
10677.    ------------------------
10678.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10679.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10680.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10681. 
10682.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10683.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10684. 
10685.    Location:
10686.    ------------------------
10687.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10688.              Files End: !ZoneEndCurrent!
10689.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10690.       
10691.    Gap Settings:
10692.    ------------------------
10693.          Gap Requested: !ZoneGapSizePer!%
10694.       Volume Rounding: !ZoneVolRoundUpPer!%
10695.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10696.                  
10697.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
10698.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
10699.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
10700.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
10701.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
10702.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
10703.      
10704.    Free Space after Zone:
10705.    ------------------------
10706.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10707.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10708.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10709. 
10710. Directory and Files Select:
10711. ---------------------------
10712. !ZoneTypeSelectCurrent!               
10713. ---------------------------
10714. ----------------------------------------------------------
10715. ")
10716. 
10717. 	# Add Zone Details to Report.	
10718. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
10719. !ZoneFooter!")
10720. 
10721. 
10722. 	
10723. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
10724. 			# Script: DisplaySetFileStep
10725. 
10726. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10727. 
10728. /* add message and move to a new line. */
10729. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10730. ")
10731. 
10732. /* display the line. (hopefully.) */
10733. # Zone Footer Set Statistics Window Text
10734. 
10735. SetStatisticsWindowText("----------------------------------------------------------
10736. Zones Processed: 
10737. ----------------------------------------------------------
10738. !ZoneListByLine!
10739. ----------------------------------------------------------
10740. Zone Processing Step:
10741. !ZoneStepByLine!    
10742. ----------------------------------------------------------
10743. Current Zone:
10744. !ZoneFooter!
10745. ----------------------------------------------------------
10746. Volume Statistics:
10747. !VolumeStatisticsDetail!
10748. ----------------------------------------------------------
10749. Zone Detailed Report:
10750. ----------------------------------------------------------
10751. !ZoneStatisticsDetail!
10752. ----------------------------------------------------------
10753. ")
10754. 
10755. 
10756. 
10757. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10758. 
10759. # Script: BannerSet
10760. 
10761. # Script: DisplaySetDateTimeRun
10762. 
10763. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
10764. /* Xinclude "..\Display\BannerSet.MyDc"X */
10765. /* pause(1) */
10766. 
10767. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10768. 
10769. Title('!Heading!')
10770. /* pause(1) */
10771. 
10772. /* NOTE: Can't round or truncate to integer precision. */
10773. 
10774. pause(1)
10775. 
10776. 			# File Action - Type Os Programs - Fast - MoveUpToZone.
10777. # File Action - SortByImportSequence with SkipBlock.
10778. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
10779. 	
10780. 	
10781. 	
10782. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
10783. 			# Script: DisplaySetFileStep
10784. 
10785. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10786. 
10787. /* add message and move to a new line. */
10788. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10789. ")
10790. 
10791. /* display the line. (hopefully.) */
10792. # Zone Footer Set Statistics Window Text
10793. 
10794. SetStatisticsWindowText("----------------------------------------------------------
10795. Zones Processed: 
10796. ----------------------------------------------------------
10797. !ZoneListByLine!
10798. ----------------------------------------------------------
10799. Zone Processing Step:
10800. !ZoneStepByLine!    
10801. ----------------------------------------------------------
10802. Current Zone:
10803. !ZoneFooter!
10804. ----------------------------------------------------------
10805. Volume Statistics:
10806. !VolumeStatisticsDetail!
10807. ----------------------------------------------------------
10808. Zone Detailed Report:
10809. ----------------------------------------------------------
10810. !ZoneStatisticsDetail!
10811. ----------------------------------------------------------
10812. ")
10813. 
10814. 
10815. 
10816. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10817. 
10818. # Script: BannerSet
10819. 
10820. # Script: DisplaySetDateTimeRun
10821. 
10822. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
10823. /* Xinclude "..\Display\BannerSet.MyDc"X */
10824. /* pause(1) */
10825. 
10826. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10827. 
10828. Title('!Heading!')
10829. /* pause(1) */
10830. 
10831. /* NOTE: Can't round or truncate to integer precision. */
10832. 
10833. pause(1)
10834. 
10835. 		# Script: ZoneDoFooter
10836. 
10837. /* ---------------------------------------------------------- */
10838. # File Select
10839. 	# Select Statments
10840. # File Actions 
10841. 	# Standard or OS File Actions.
10842. 	# Resume...
10843. 	
10844. 	# your stuff HERE (X)... post zone (file) file actions code.
10845. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
10846. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
10847. 		# (X)
10848. 		
10849. 		/* ??? Set window? */
10850. 	
10851. 	# ADD THE GAP
10852. 		
10853. # Vacate (good for diagnostics)
10854. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
10855. 
10856. # DoNotVacate - DO NOT Vacate (recommended)
10857. 
10858. # Vacate
10859. /* AddGap(GapUsedLoc) */
10860. 
10861. # DO Not Vacate
10862. AddGap(GapUsedLoc, DoNotVacate) 
10863. 	
10864. 	
10865. /* ---------------------------------------------------------- */
10866. # (failed) TEST for boolean logic.
10867. 
10868. /* It should work in the gap calculations for turning options */
10869. /* on and off but it will NOT work here. */
10870. 
10871. /* Boolean setting X or FlagX. */
10872. /* Where X will be on or off: */
10873. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
10874. /*      For ON:  (X  *  FlagAny) */
10875. 
10876. /* 1) Failed, zero gap overrode the previous one. */
10877. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
10878. /* AddGap(GapUsedTemp) */ 
10879. 
10880. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
10881. /* AddGap(GapUsedTemp, DoNotVacate) */ 
10882. 
10883. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
10884. 
10885. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
10886. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
10887. /* AddGap(GapUsedTemp) */ 
10888. 
10889. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
10890. /* AddGap(GapUsedTemp, DoNotVacate) */ 
10891. 
10892. /* ---------------------------------------------------------- */
10893. 
10894. # Vacate
10895. /* AddGap(GapUsed) */
10896. 
10897. # DO NOT Vacate (recommended)
10898. /* AddGap(GapUsed, DoNotVacate) */ 
10899. 	
10900. 
10901. 		
10902. # 
10903. FileEnd
10904. /* ---------------------------------------------------------- */
10905. 
10906. # your stuff HERE (X)... post zone (file) code.
10907. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
10908. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
10909. 	# (X)
10910. 
10911. SetVariable(FileStepDescription,"Zone finished, reporting.")
10912. # Script: DisplaySetFileStep
10913. 
10914. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10915. 
10916. /* add message and move to a new line. */
10917. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10918. ")
10919. 
10920. /* display the line. (hopefully.) */
10921. # Zone Footer Set Statistics Window Text
10922. 
10923. SetStatisticsWindowText("----------------------------------------------------------
10924. Zones Processed: 
10925. ----------------------------------------------------------
10926. !ZoneListByLine!
10927. ----------------------------------------------------------
10928. Zone Processing Step:
10929. !ZoneStepByLine!    
10930. ----------------------------------------------------------
10931. Current Zone:
10932. !ZoneFooter!
10933. ----------------------------------------------------------
10934. Volume Statistics:
10935. !VolumeStatisticsDetail!
10936. ----------------------------------------------------------
10937. Zone Detailed Report:
10938. ----------------------------------------------------------
10939. !ZoneStatisticsDetail!
10940. ----------------------------------------------------------
10941. ")
10942. 
10943. 
10944. 
10945. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10946. 
10947. # Script: BannerSet
10948. 
10949. # Script: DisplaySetDateTimeRun
10950. 
10951. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
10952. /* Xinclude "..\Display\BannerSet.MyDc"X */
10953. /* pause(1) */
10954. 
10955. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10956. 
10957. Title('!Heading!')
10958. /* pause(1) */
10959. 
10960. /* NOTE: Can't round or truncate to integer precision. */
10961. 
10962. pause(1)
10963. 
10964. # Script: ZoneWhenFinished
10965. 
10966. # Script: BannerSet
10967. 
10968. # Script: DisplaySetDateTimeRun
10969. 
10970. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
10971. /* Xinclude "..\Display\BannerSet.MyDc"X */
10972. /* pause(1) */
10973. 
10974. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10975. 
10976. Title('!Heading!')
10977. /* pause(1) */
10978. 
10979. /* NOTE: Can't round or truncate to integer precision. */
10980. 
10981. # Script: BannerLog
10982. 
10983. AppendLogfile("!LogFileName!", "!Title!")
10984. 
10985. 
10986. 
10987. # Zone Statistics	
10988. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
10989. 
10990. # Footer:
10991. SetVariable(ZoneFooter, "----------------------------------------------------------
10992. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
10993. 
10994. Statistics Report:
10995. ------------------
10996.    Size:  
10997.    ------------------------
10998.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10999.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11000.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11001. 
11002.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11003.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11004. 
11005.    Location:
11006.    ------------------------
11007.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11008.              Files End: !ZoneEndCurrent!
11009.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11010.       
11011.    Gap Settings:
11012.    ------------------------
11013.          Gap Requested: !ZoneGapSizePer!%
11014.       Volume Rounding: !ZoneVolRoundUpPer!%
11015.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11016.                  
11017.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
11018.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
11019.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
11020.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
11021.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
11022.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
11023.      
11024.    Free Space after Zone:
11025.    ------------------------
11026.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11027.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11028.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11029. 
11030. Directory and Files Select:
11031. ---------------------------
11032. !ZoneTypeSelectCurrent!               
11033. ---------------------------
11034. ----------------------------------------------------------
11035. ")
11036. 
11037. AppendLogfile("!LogFileName!", ".")
11038. AppendLogfile("!LogFileName!", "!ZoneFooter!")
11039. AppendLogfile("!LogFileName!", ".")
11040. 
11041. # Zone Footer Set Statistics Window Text
11042. 
11043. SetStatisticsWindowText("----------------------------------------------------------
11044. Zones Processed: 
11045. ----------------------------------------------------------
11046. !ZoneListByLine!
11047. ----------------------------------------------------------
11048. Zone Processing Step:
11049. !ZoneStepByLine!    
11050. ----------------------------------------------------------
11051. Current Zone:
11052. !ZoneFooter!
11053. ----------------------------------------------------------
11054. Volume Statistics:
11055. !VolumeStatisticsDetail!
11056. ----------------------------------------------------------
11057. Zone Detailed Report:
11058. ----------------------------------------------------------
11059. !ZoneStatisticsDetail!
11060. ----------------------------------------------------------
11061. ")
11062. 
11063. 
11064. 
11065. /* pause() */
11066. /* pause() */
11067. 
11068. 
11069. 
11070. 	
11071. /* ---------------------------------------------------------- */
11072. 
11073. 
11074. /* ---------------------------------------------------------- */
11075. /* OLD: ToDo */
11076. 	/* Zone 1 and 2 originally */
11077. 	/* Originally the MFT and DIRs were processed first. */
11078. 	/* Zone 4 and 5 normally */
11079. 	/* The MakeGap call is put between which ever zones you want */
11080. 	/* So the actual zone number is unknown */
11081. 	/* SetVariable(ZoneCurrent,"4, 5") */
11082. 	/* MakeGap(RoundUp(VolumeUsed * (!MftPer! + 0.15), VolumeSize * ZoneVolRoundUpLarge), DoNotVacate) */
11083. 
11084. /* ---------------------------------------------------------- */
11085. SetVariable(FileStepDescription,"System Zones completed.")
11086. # Script: DisplaySetFileStep
11087. 
11088. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11089. 
11090. /* add message and move to a new line. */
11091. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11092. ")
11093. 
11094. /* display the line. (hopefully.) */
11095. # Zone Footer Set Statistics Window Text
11096. 
11097. SetStatisticsWindowText("----------------------------------------------------------
11098. Zones Processed: 
11099. ----------------------------------------------------------
11100. !ZoneListByLine!
11101. ----------------------------------------------------------
11102. Zone Processing Step:
11103. !ZoneStepByLine!    
11104. ----------------------------------------------------------
11105. Current Zone:
11106. !ZoneFooter!
11107. ----------------------------------------------------------
11108. Volume Statistics:
11109. !VolumeStatisticsDetail!
11110. ----------------------------------------------------------
11111. Zone Detailed Report:
11112. ----------------------------------------------------------
11113. !ZoneStatisticsDetail!
11114. ----------------------------------------------------------
11115. ")
11116. 
11117. 
11118. 
11119. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11120. 
11121. # Script: BannerSet
11122. 
11123. # Script: DisplaySetDateTimeRun
11124. 
11125. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
11126. /* Xinclude "..\Display\BannerSet.MyDc"X */
11127. /* pause(1) */
11128. 
11129. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11130. 
11131. Title('!Heading!')
11132. /* pause(1) */
11133. 
11134. /* NOTE: Can't round or truncate to integer precision. */
11135. 
11136. pause(1)
11137. 
11138. 
11139. /* ---------------------------------------------------------- */
11140. /* Any Volume Regular Zones */
11141. /* ---------------------------------------------------------- */
11142. 
11143. /* ---------------------------------------------------------- */
11144. /* Zone IdeScripts Ide, Scripts, Support */
11145. # Script: DefragZoneTypeIdeScripts
11146. /* ---------------------------------------------------------- */
11147. /* Zone IdeScripts Ide, Scripts, Support */
11148. 
11149. SetVariable(ZoneLabel, "!ZoneLabelIdeScripts!")
11150. SetVariable(ZoneDescription, "!ZoneDescriptionIdeScripts!")
11151. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpIdeScripts!")
11152. SetVariable(ZoneGapSize, "!ZoneGapSizeIdeScripts!")
11153. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectIdeScripts
11154. # IdeScripts start.
11155. # NotBlobsArchivesBu start.
11156. (not (
11157. # Blobs start.
11158. (
11159. # BlobsAndExceptions start.
11160. ( not(
11161.   FileName("*.bat")
11162.   or FileName("*.css")
11163.   or FileName("*.dll")
11164.   or FileName("*.exe")
11165.   or FileName("*.htm*")
11166.   or FileName("*.jar")
11167.   or FileName("*.js")
11168.   or FileName("*.script")
11169.   or FileName("*.wsf")
11170.   or (
11171. # Databases start.
11172. (
11173.   FileName("*.crypt*")
11174.   or FileName("*.db*")
11175.   or FileName("*.rdb*")
11176.   or FileName("*.dc*")
11177.   or FileName("*.dict*")
11178.   or FileName("*.?db*")
11179.   or FileName("*.?rdb*")
11180.   or FileName("*.md*")
11181.   or FileName("*.myd")
11182.   or FileName("*.ndf")
11183.   or FileName("*.ns?")
11184.   or FileName("*.pab")
11185.   or FileName("*.pst")
11186.   or FileName("*.sd?*")
11187.   or FileName("*.sq**")
11188.   or FileName("*.tmd")
11189.   or FileName("*.tps")
11190.   or FileName("*.tr*")
11191. )
11192. # Databases end.
11193. 
11194.     # BlobsAndExceptions
11195.     or 
11196. # Data start.
11197. (
11198.   DirectoryName("Data*")
11199.   or DirectoryName("Device*")
11200.   or DirectoryName("Export*")
11201.   or DirectoryName("Import*")
11202.   or DirectoryName("Log*")
11203.   or DirectoryName("*Log")
11204.   or DirectoryName("Maintenance*")
11205.   or DirectoryName("Rec*")
11206.   or DirectoryName("Sales*")
11207.   or DirectoryName("Search*")
11208.   or DirectoryName("User*")
11209. )
11210. # Data end.
11211. 
11212.     # BlobsAndExceptions
11213.   )
11214. ) )
11215. # BlobsAndExceptions end.
11216. 
11217. # Blobs
11218. ) and (
11219.   Size(BlobFileSize,0)
11220.   or (
11221.     FileName("*.arj")
11222.     or FileName("*.bup")
11223.     or FileName("*.bz2")
11224.     or FileName("*.chm")
11225.     or FileName("*.dvr-ms")
11226.     or FileName("*.gz")
11227.     or FileName("*.ifo")
11228.     or FileName("*.lzh")
11229.     or FileName("*.pdf")
11230.     or FileName("*.rpm")
11231.     or FileName("*.wmv")
11232.     or FileName("*.vob")
11233.     or FileName("*.z")
11234.   ) 
11235. )
11236. # Blobs end.
11237. 
11238. # NotBlobsArchivesBu
11239. or 
11240. # Archives start.
11241. (
11242.   DirectoryName("*Archive*")
11243.   or DirectoryName("*History*")
11244.   or DirectoryName("*Old")
11245.   or DirectoryName("* Old *")
11246.   or DirectoryName("Old *")
11247. 
11248.   or FileName("*.7z")
11249.   or FileName("*.cab")
11250.   or FileName("*.iso")
11251.   or FileName("*.msi")
11252.   or FileName("*.old")
11253.   or FileName("*.rar")
11254.   or FileName("*.tar")
11255.   or FileName("*.zip")
11256.   or
11257. # WinSysLow start.
11258. (
11259.   DirectoryName("$*")
11260.   or DirectoryName("0*")
11261.   or DirectoryName("1*")
11262.   or DirectoryName("2*")
11263.   or DirectoryName("3*")
11264.   or DirectoryName("4*")
11265.   or DirectoryName("5*")
11266.   or DirectoryName("6*")
11267.   or DirectoryName("7*")
11268.   or DirectoryName("8*")
11269.   or DirectoryName("9*")
11270. 
11271.   or DirectoryName("dllcache")
11272.   or DirectoryName("Downloaded Installations")
11273.   or DirectoryName("Ehome")
11274.   or DirectoryName("Fonts")
11275.   or DirectoryName("Help")
11276.   or DirectoryName("I386")
11277.   or DirectoryName("ie?updates")
11278.   or DirectoryName("Installer")
11279.   or DirectoryName("Installshield Installation Information")
11280.   or DirectoryName("IME")
11281.   or DirectoryName("*RECYCLE*")
11282.   or DirectoryName("ServicePackFiles")
11283.   or DirectoryName("SoftwareDistribution")
11284.   or DirectoryName("Speech")
11285.   or DirectoryName("Symbols")
11286.   or DirectoryName("System Volume Information")
11287.   or DirectoryName("windows.old")
11288. )
11289. # WinSysLow end.
11290. 
11291.   # Archives
11292. )
11293. # Archives end.
11294. 
11295. # NotBlobsArchivesBu
11296. or
11297. # Backups start.
11298. (
11299.   DirectoryName("*Backup*")
11300.   or DirectoryName("*Bu")
11301.   or DirectoryName("* Bu *")
11302.   or DirectoryName("Bu *")
11303. 
11304.   or FileName("*.bak")
11305.   or FileName("* - Copy*")
11306. )
11307. # Backups end.
11308. 
11309. # NotBlobsArchivesBu
11310. ) )
11311. # NotBlobsArchivesBu end.
11312. 
11313. # IdeScripts
11314. and ( 
11315. # Ide start.
11316. (
11317.     DirectoryName("Ide*")
11318.     or DirectoryName("Java*")
11319.     or DirectoryName("Os")
11320. )
11321. # Ide end.
11322. 
11323. # IdeScripts
11324. or  
11325. # Scripts start.
11326. (
11327.   DirectoryName("*Script*")
11328. )
11329. # Scripts end.
11330. 
11331. # IdeScripts
11332. )
11333. # IdeScripts end.
11334. ')
11335. 
11336. 	# Script: ZoneDoHeader
11337. 
11338. # Script: ZoneWhenStarted
11339. 
11340. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
11341. # Script: DisplaySetZone
11342. 
11343. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
11344. SetVariable(FileStepDescription,	"")
11345. 
11346. SetVariable(ZoneStepByLine, 			"Zone started.
11347. ")
11348. 
11349. # Script: BannerDescriptionSet
11350. 
11351. # Script: BannerSet
11352. 
11353. # Script: DisplaySetDateTimeRun
11354. 
11355. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
11356. /* Xinclude "..\Display\BannerSet.MyDc"X */
11357. /* pause(1) */
11358. 
11359. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11360. 
11361. Title('!Heading!')
11362. /* pause(1) */
11363. 
11364. /* NOTE: Can't round or truncate to integer precision. */
11365. 
11366. # Script: BannerLog
11367. 
11368. AppendLogfile("!LogFileName!", "!Title!")
11369. 
11370. 
11371. 
11372. pause(1)
11373. 
11374. 
11375. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
11376. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
11377. 
11378. SetVariable(ZoneStepNoCurrent, 0)
11379. 
11380. 
11381. # Script: ZoneDoCurrentClear
11382. 
11383. SetVariable(ZoneTypeSelectCurrent, 		"")
11384. 
11385. SetVariable(ZoneBeginCurrent, 			0)
11386. SetVariable(ZoneBeginPerCurrent, 		0)
11387. SetVariable(ZoneEndCurrent, 			0)
11388. SetVariable(ZoneEndPerCurrent, 			0)
11389. 
11390. SetVariable(ZoneSizeCurrent,			0)
11391. SetVariable(ZoneSizePerCurrent,			0)
11392. 
11393. SetVariable(ZoneGapRequestedCurrent,	0)
11394. SetVariable(ZoneGapRoundedCurrent, 		0)
11395. SetVariable(ZoneGapAdjustedCurrent, 	0)
11396. SetVariable(ZoneGapAvailableCurrent, 	0)
11397. SetVariable(ZoneGapCurrent,				0)
11398. SetVariable(ZoneGapUsedCurrent, 		0)
11399. 
11400. SetVariable(ZoneGapActualCurrent, 		0)
11401. SetVariable(ZoneGapActualPerCurrent, 	0)
11402. 
11403. SetVariable(ZoneSizeActual, 			0)
11404. SetVariable(ZoneSizeActualCurrent,		0)
11405. 
11406. SetVariable(ZoneEndActual, 				0)
11407. SetVariable(ZoneEndActualCurrent,		0)			
11408. SetVariable(ZoneSizeActualPerCurrent, 	0)
11409.       
11410. SetVariable(ZoneFilesFolders,			0)
11411. SetVariable(ZoneFilesFoldersPer,		0) 
11412. 
11413. SetVariable(ZoneFragments,				0)
11414. SetVariable(ZoneFragmentsPer,			0) 
11415. 		
11416. SetVariable(ZoneEndActualCurrent, 		0)
11417. SetVariable(ZoneEndActualPerCurrent, 	0)
11418. 
11419. # Gap Calculation Methodology:
11420. 	# Requested
11421. 	SetVariable(GapRequested, 			0) 
11422. 	SetVariable(GapRequestedStd, 		0) 
11423. 	SetVariable(GapRequestedMft, 		0) 
11424. 	SetVariable(GapRequestedOs, 		0) 
11425. 	SetVariable(GapRequestedOriginal, 	0) 
11426. 	
11427. 	# Gap Adjustments
11428. 	SetVariable(GapRounded, 			0)
11429. 	# SetVariable(GapAdjusted, 			0)
11430. 	SetVariable(GapAvailable, 			0)
11431. 	SetVariable(GapCurrent, 			0)
11432. 	SetVariable(GapActual, 				0)
11433. 	SetVariable(GapUsed, 				0)
11434. 	
11435. 	# Gap Adjustments
11436. 	SetVariable(GapRoundedLoc, 			0)
11437. 	# SetVariable(GapAdjustedLoc, 		0)
11438. 	SetVariable(GapAvailableLoc, 		0)
11439. 	SetVariable(GapCurrentLoc, 			0)
11440. 	SetVariable(GapActualLoc,			0)
11441. 	SetVariable(GapUsedLoc,				0)
11442. 	
11443. 	# Space usage
11444. 	SetVariable(ZoneFreePerRequested, 	0)
11445. 	SetVariable(ZoneFreePerUsed, 		0)
11446. 
11447. # Gap Size & Rounding
11448. 	SetVariable(ZoneGapSizePer, 		0)
11449. 	SetVariable(ZoneVolRoundUpPer, 		0)
11450. 	
11451. 	# Free Space
11452. 	SetVariable(ZoneFreeUsedPer, 		0)
11453. 	SetVariable(ZoneFreeRequestedPer, 	0)
11454. 
11455. 
11456. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
11457. 
11458. # Footer:
11459. SetVariable(ZoneFooter, "----------------------------------------------------------
11460. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
11461. 
11462. Statistics Report:
11463. ------------------
11464.    Size:  
11465.    ------------------------
11466.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11467.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11468.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11469. 
11470.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11471.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11472. 
11473.    Location:
11474.    ------------------------
11475.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11476.              Files End: !ZoneEndCurrent!
11477.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11478.       
11479.    Gap Settings:
11480.    ------------------------
11481.          Gap Requested: !ZoneGapSizePer!%
11482.       Volume Rounding: !ZoneVolRoundUpPer!%
11483.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11484.                  
11485.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
11486.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
11487.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
11488.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
11489.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
11490.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
11491.      
11492.    Free Space after Zone:
11493.    ------------------------
11494.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11495.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11496.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11497. 
11498. Directory and Files Select:
11499. ---------------------------
11500. !ZoneTypeSelectCurrent!               
11501. ---------------------------
11502. ----------------------------------------------------------
11503. ")
11504. 
11505. # Script: BannerSet
11506. 
11507. # Script: DisplaySetDateTimeRun
11508. 
11509. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
11510. /* Xinclude "..\Display\BannerSet.MyDc"X */
11511. /* pause(1) */
11512. 
11513. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11514. 
11515. Title('!Heading!')
11516. /* pause(1) */
11517. 
11518. /* NOTE: Can't round or truncate to integer precision. */
11519. 
11520. # Script: BannerLog
11521. 
11522. AppendLogfile("!LogFileName!", "!Title!")
11523. 
11524. 
11525. 
11526. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
11527. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
11528. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:44")
11529. 
11530. SetVariable(ZoneListByLine, "!ZoneListByLine!
11531. Zone: !ZoneNoCurrent! 2021-11-09 20:22:44 0:00:03 !ZoneLabel! !ZoneDescription!")
11532. 
11533. 
11534. /* Fixed Zone Position Handling */
11535. /* Literal number: */
11536. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
11537. /* Percentage of disk: */
11538. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
11539. /* Gap */
11540. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
11541. 
11542. /* ---------------------------------------------------------- */
11543. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
11544. # Script: DisplaySetFileStep
11545. 
11546. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11547. 
11548. /* add message and move to a new line. */
11549. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11550. ")
11551. 
11552. /* display the line. (hopefully.) */
11553. # Zone Footer Set Statistics Window Text
11554. 
11555. SetStatisticsWindowText("----------------------------------------------------------
11556. Zones Processed: 
11557. ----------------------------------------------------------
11558. !ZoneListByLine!
11559. ----------------------------------------------------------
11560. Zone Processing Step:
11561. !ZoneStepByLine!    
11562. ----------------------------------------------------------
11563. Current Zone:
11564. !ZoneFooter!
11565. ----------------------------------------------------------
11566. Volume Statistics:
11567. !VolumeStatisticsDetail!
11568. ----------------------------------------------------------
11569. Zone Detailed Report:
11570. ----------------------------------------------------------
11571. !ZoneStatisticsDetail!
11572. ----------------------------------------------------------
11573. ")
11574. 
11575. 
11576. 
11577. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11578. 
11579. # Script: BannerSet
11580. 
11581. # Script: DisplaySetDateTimeRun
11582. 
11583. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
11584. /* Xinclude "..\Display\BannerSet.MyDc"X */
11585. /* pause(1) */
11586. 
11587. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11588. 
11589. Title('!Heading!')
11590. /* pause(1) */
11591. 
11592. /* NOTE: Can't round or truncate to integer precision. */
11593. 
11594. pause(1)
11595. 
11596. # your stuff HERE (X)... pre file select code.
11597. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
11598. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
11599. 	# (X)
11600. 
11601. FileSelect
11602. 
11603. 	# your stuff can't really go here (errors.)
11604. 	# maybe for some reason I don't know of...
11605. 	
11606. 	# Actions next...
11607. 	# Script: ZoneDo ZoneTypeSelectIdeScripts
11608. # IdeScripts start.
11609. # NotBlobsArchivesBu start.
11610. (not (
11611. # Blobs start.
11612. (
11613. # BlobsAndExceptions start.
11614. ( not(
11615.   FileName("*.bat")
11616.   or FileName("*.css")
11617.   or FileName("*.dll")
11618.   or FileName("*.exe")
11619.   or FileName("*.htm*")
11620.   or FileName("*.jar")
11621.   or FileName("*.js")
11622.   or FileName("*.script")
11623.   or FileName("*.wsf")
11624.   or (
11625. # Databases start.
11626. (
11627.   FileName("*.crypt*")
11628.   or FileName("*.db*")
11629.   or FileName("*.rdb*")
11630.   or FileName("*.dc*")
11631.   or FileName("*.dict*")
11632.   or FileName("*.?db*")
11633.   or FileName("*.?rdb*")
11634.   or FileName("*.md*")
11635.   or FileName("*.myd")
11636.   or FileName("*.ndf")
11637.   or FileName("*.ns?")
11638.   or FileName("*.pab")
11639.   or FileName("*.pst")
11640.   or FileName("*.sd?*")
11641.   or FileName("*.sq**")
11642.   or FileName("*.tmd")
11643.   or FileName("*.tps")
11644.   or FileName("*.tr*")
11645. )
11646. # Databases end.
11647. 
11648.     # BlobsAndExceptions
11649.     or 
11650. # Data start.
11651. (
11652.   DirectoryName("Data*")
11653.   or DirectoryName("Device*")
11654.   or DirectoryName("Export*")
11655.   or DirectoryName("Import*")
11656.   or DirectoryName("Log*")
11657.   or DirectoryName("*Log")
11658.   or DirectoryName("Maintenance*")
11659.   or DirectoryName("Rec*")
11660.   or DirectoryName("Sales*")
11661.   or DirectoryName("Search*")
11662.   or DirectoryName("User*")
11663. )
11664. # Data end.
11665. 
11666.     # BlobsAndExceptions
11667.   )
11668. ) )
11669. # BlobsAndExceptions end.
11670. 
11671. # Blobs
11672. ) and (
11673.   Size(BlobFileSize,0)
11674.   or (
11675.     FileName("*.arj")
11676.     or FileName("*.bup")
11677.     or FileName("*.bz2")
11678.     or FileName("*.chm")
11679.     or FileName("*.dvr-ms")
11680.     or FileName("*.gz")
11681.     or FileName("*.ifo")
11682.     or FileName("*.lzh")
11683.     or FileName("*.pdf")
11684.     or FileName("*.rpm")
11685.     or FileName("*.wmv")
11686.     or FileName("*.vob")
11687.     or FileName("*.z")
11688.   ) 
11689. )
11690. # Blobs end.
11691. 
11692. # NotBlobsArchivesBu
11693. or 
11694. # Archives start.
11695. (
11696.   DirectoryName("*Archive*")
11697.   or DirectoryName("*History*")
11698.   or DirectoryName("*Old")
11699.   or DirectoryName("* Old *")
11700.   or DirectoryName("Old *")
11701. 
11702.   or FileName("*.7z")
11703.   or FileName("*.cab")
11704.   or FileName("*.iso")
11705.   or FileName("*.msi")
11706.   or FileName("*.old")
11707.   or FileName("*.rar")
11708.   or FileName("*.tar")
11709.   or FileName("*.zip")
11710.   or
11711. # WinSysLow start.
11712. (
11713.   DirectoryName("$*")
11714.   or DirectoryName("0*")
11715.   or DirectoryName("1*")
11716.   or DirectoryName("2*")
11717.   or DirectoryName("3*")
11718.   or DirectoryName("4*")
11719.   or DirectoryName("5*")
11720.   or DirectoryName("6*")
11721.   or DirectoryName("7*")
11722.   or DirectoryName("8*")
11723.   or DirectoryName("9*")
11724. 
11725.   or DirectoryName("dllcache")
11726.   or DirectoryName("Downloaded Installations")
11727.   or DirectoryName("Ehome")
11728.   or DirectoryName("Fonts")
11729.   or DirectoryName("Help")
11730.   or DirectoryName("I386")
11731.   or DirectoryName("ie?updates")
11732.   or DirectoryName("Installer")
11733.   or DirectoryName("Installshield Installation Information")
11734.   or DirectoryName("IME")
11735.   or DirectoryName("*RECYCLE*")
11736.   or DirectoryName("ServicePackFiles")
11737.   or DirectoryName("SoftwareDistribution")
11738.   or DirectoryName("Speech")
11739.   or DirectoryName("Symbols")
11740.   or DirectoryName("System Volume Information")
11741.   or DirectoryName("windows.old")
11742. )
11743. # WinSysLow end.
11744. 
11745.   # Archives
11746. )
11747. # Archives end.
11748. 
11749. # NotBlobsArchivesBu
11750. or
11751. # Backups start.
11752. (
11753.   DirectoryName("*Backup*")
11754.   or DirectoryName("*Bu")
11755.   or DirectoryName("* Bu *")
11756.   or DirectoryName("Bu *")
11757. 
11758.   or FileName("*.bak")
11759.   or FileName("* - Copy*")
11760. )
11761. # Backups end.
11762. 
11763. # NotBlobsArchivesBu
11764. ) )
11765. # NotBlobsArchivesBu end.
11766. 
11767. # IdeScripts
11768. and ( 
11769. # Ide start.
11770. (
11771.     DirectoryName("Ide*")
11772.     or DirectoryName("Java*")
11773.     or DirectoryName("Os")
11774. )
11775. # Ide end.
11776. 
11777. # IdeScripts
11778. or  
11779. # Scripts start.
11780. (
11781.   DirectoryName("*Script*")
11782. )
11783. # Scripts end.
11784. 
11785. # IdeScripts
11786. )
11787. # IdeScripts end.
11788. 
11789. 	# Script: ZoneDoAction
11790. # Zone Do File Action - SortByName.
11791. 
11792. FileActions
11793. 
11794. 	# Footer:
11795. SetVariable(ZoneFooter, "----------------------------------------------------------
11796. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
11797. 
11798. Statistics Report:
11799. ------------------
11800.    Size:  
11801.    ------------------------
11802.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11803.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11804.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11805. 
11806.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11807.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11808. 
11809.    Location:
11810.    ------------------------
11811.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11812.              Files End: !ZoneEndCurrent!
11813.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11814.       
11815.    Gap Settings:
11816.    ------------------------
11817.          Gap Requested: !ZoneGapSizePer!%
11818.       Volume Rounding: !ZoneVolRoundUpPer!%
11819.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11820.                  
11821.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
11822.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
11823.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
11824.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
11825.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
11826.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
11827.      
11828.    Free Space after Zone:
11829.    ------------------------
11830.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11831.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11832.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11833. 
11834. Directory and Files Select:
11835. ---------------------------
11836. !ZoneTypeSelectCurrent!               
11837. ---------------------------
11838. ----------------------------------------------------------
11839. ")
11840. 	SetStatisticsWindowText("!ZoneFooter!")
11841. 	
11842. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
11843. 	# Script: DisplaySetFileStep
11844. 
11845. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11846. 
11847. /* add message and move to a new line. */
11848. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11849. ")
11850. 
11851. /* display the line. (hopefully.) */
11852. # Zone Footer Set Statistics Window Text
11853. 
11854. SetStatisticsWindowText("----------------------------------------------------------
11855. Zones Processed: 
11856. ----------------------------------------------------------
11857. !ZoneListByLine!
11858. ----------------------------------------------------------
11859. Zone Processing Step:
11860. !ZoneStepByLine!    
11861. ----------------------------------------------------------
11862. Current Zone:
11863. !ZoneFooter!
11864. ----------------------------------------------------------
11865. Volume Statistics:
11866. !VolumeStatisticsDetail!
11867. ----------------------------------------------------------
11868. Zone Detailed Report:
11869. ----------------------------------------------------------
11870. !ZoneStatisticsDetail!
11871. ----------------------------------------------------------
11872. ")
11873. 
11874. 
11875. 
11876. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11877. 
11878. # Script: BannerSet
11879. 
11880. # Script: DisplaySetDateTimeRun
11881. 
11882. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
11883. /* Xinclude "..\Display\BannerSet.MyDc"X */
11884. /* pause(1) */
11885. 
11886. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11887. 
11888. Title('!Heading!')
11889. /* pause(1) */
11890. 
11891. /* NOTE: Can't round or truncate to integer precision. */
11892. 
11893. pause(1)
11894. 
11895. # Commands:
11896. 
11897. /* Moves to Zone or above it. */
11898. # MoveUpToZone()
11899. 
11900. # Defrag
11901. 
11902. # Defragment(OPTIONS)
11903. 
11904. /* Shuffles files around trying to make a big enough gap for fragmented files. */
11905. # Defragment()
11906. 
11907. /* Only does files where a gap will fit it. */
11908. # Defragment(Fast)
11909. 
11910. /* Skips fragmented files larger than the Chunck Size.
11911. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
11912. # Defragment(Chunk Size)
11913. 
11914. /* Moves down to zone and packs zone to beginning if there are gaps. */
11915. /* Can be similar in performance to doing a SortBy. */
11916. # MoveDownFill()
11917. 
11918. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
11919. 
11920. 
11921. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
11922. 	# Script: DisplaySetFileStep
11923. 
11924. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11925. 
11926. /* add message and move to a new line. */
11927. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11928. ")
11929. 
11930. /* display the line. (hopefully.) */
11931. # Zone Footer Set Statistics Window Text
11932. 
11933. SetStatisticsWindowText("----------------------------------------------------------
11934. Zones Processed: 
11935. ----------------------------------------------------------
11936. !ZoneListByLine!
11937. ----------------------------------------------------------
11938. Zone Processing Step:
11939. !ZoneStepByLine!    
11940. ----------------------------------------------------------
11941. Current Zone:
11942. !ZoneFooter!
11943. ----------------------------------------------------------
11944. Volume Statistics:
11945. !VolumeStatisticsDetail!
11946. ----------------------------------------------------------
11947. Zone Detailed Report:
11948. ----------------------------------------------------------
11949. !ZoneStatisticsDetail!
11950. ----------------------------------------------------------
11951. ")
11952. 
11953. 
11954. 
11955. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11956. 
11957. # Script: BannerSet
11958. 
11959. # Script: DisplaySetDateTimeRun
11960. 
11961. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
11962. /* Xinclude "..\Display\BannerSet.MyDc"X */
11963. /* pause(1) */
11964. 
11965. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11966. 
11967. Title('!Heading!')
11968. /* pause(1) */
11969. 
11970. /* NOTE: Can't round or truncate to integer precision. */
11971. 
11972. pause(1)
11973. 
11974. 	# Script: ZoneDoFooter
11975. 
11976. /* ---------------------------------------------------------- */
11977. # File Select
11978. 	# Select Statments
11979. # File Actions 
11980. 	# Standard or OS File Actions.
11981. 	# Resume...
11982. 	
11983. 	# your stuff HERE (X)... post zone (file) file actions code.
11984. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
11985. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
11986. 		# (X)
11987. 		
11988. 		/* ??? Set window? */
11989. 	
11990. 	# ADD THE GAP
11991. 		
11992. # Vacate (good for diagnostics)
11993. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
11994. 
11995. # DoNotVacate - DO NOT Vacate (recommended)
11996. 
11997. # Vacate
11998. /* AddGap(GapUsedLoc) */
11999. 
12000. # DO Not Vacate
12001. AddGap(GapUsedLoc, DoNotVacate) 
12002. 	
12003. 	
12004. /* ---------------------------------------------------------- */
12005. # (failed) TEST for boolean logic.
12006. 
12007. /* It should work in the gap calculations for turning options */
12008. /* on and off but it will NOT work here. */
12009. 
12010. /* Boolean setting X or FlagX. */
12011. /* Where X will be on or off: */
12012. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
12013. /*      For ON:  (X  *  FlagAny) */
12014. 
12015. /* 1) Failed, zero gap overrode the previous one. */
12016. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
12017. /* AddGap(GapUsedTemp) */ 
12018. 
12019. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
12020. /* AddGap(GapUsedTemp, DoNotVacate) */ 
12021. 
12022. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
12023. 
12024. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
12025. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
12026. /* AddGap(GapUsedTemp) */ 
12027. 
12028. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
12029. /* AddGap(GapUsedTemp, DoNotVacate) */ 
12030. 
12031. /* ---------------------------------------------------------- */
12032. 
12033. # Vacate
12034. /* AddGap(GapUsed) */
12035. 
12036. # DO NOT Vacate (recommended)
12037. /* AddGap(GapUsed, DoNotVacate) */ 
12038. 	
12039. 
12040. 		
12041. # 
12042. FileEnd
12043. /* ---------------------------------------------------------- */
12044. 
12045. # your stuff HERE (X)... post zone (file) code.
12046. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
12047. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12048. 	# (X)
12049. 
12050. SetVariable(FileStepDescription,"Zone finished, reporting.")
12051. # Script: DisplaySetFileStep
12052. 
12053. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12054. 
12055. /* add message and move to a new line. */
12056. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12057. ")
12058. 
12059. /* display the line. (hopefully.) */
12060. # Zone Footer Set Statistics Window Text
12061. 
12062. SetStatisticsWindowText("----------------------------------------------------------
12063. Zones Processed: 
12064. ----------------------------------------------------------
12065. !ZoneListByLine!
12066. ----------------------------------------------------------
12067. Zone Processing Step:
12068. !ZoneStepByLine!    
12069. ----------------------------------------------------------
12070. Current Zone:
12071. !ZoneFooter!
12072. ----------------------------------------------------------
12073. Volume Statistics:
12074. !VolumeStatisticsDetail!
12075. ----------------------------------------------------------
12076. Zone Detailed Report:
12077. ----------------------------------------------------------
12078. !ZoneStatisticsDetail!
12079. ----------------------------------------------------------
12080. ")
12081. 
12082. 
12083. 
12084. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12085. 
12086. # Script: BannerSet
12087. 
12088. # Script: DisplaySetDateTimeRun
12089. 
12090. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
12091. /* Xinclude "..\Display\BannerSet.MyDc"X */
12092. /* pause(1) */
12093. 
12094. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12095. 
12096. Title('!Heading!')
12097. /* pause(1) */
12098. 
12099. /* NOTE: Can't round or truncate to integer precision. */
12100. 
12101. pause(1)
12102. 
12103. # Script: ZoneWhenFinished
12104. 
12105. # Script: BannerSet
12106. 
12107. # Script: DisplaySetDateTimeRun
12108. 
12109. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
12110. /* Xinclude "..\Display\BannerSet.MyDc"X */
12111. /* pause(1) */
12112. 
12113. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12114. 
12115. Title('!Heading!')
12116. /* pause(1) */
12117. 
12118. /* NOTE: Can't round or truncate to integer precision. */
12119. 
12120. # Script: BannerLog
12121. 
12122. AppendLogfile("!LogFileName!", "!Title!")
12123. 
12124. 
12125. 
12126. # Zone Statistics	
12127. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
12128. 
12129. # Footer:
12130. SetVariable(ZoneFooter, "----------------------------------------------------------
12131. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
12132. 
12133. Statistics Report:
12134. ------------------
12135.    Size:  
12136.    ------------------------
12137.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12138.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12139.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12140. 
12141.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12142.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12143. 
12144.    Location:
12145.    ------------------------
12146.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12147.              Files End: !ZoneEndCurrent!
12148.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12149.       
12150.    Gap Settings:
12151.    ------------------------
12152.          Gap Requested: !ZoneGapSizePer!%
12153.       Volume Rounding: !ZoneVolRoundUpPer!%
12154.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12155.                  
12156.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
12157.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
12158.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
12159.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
12160.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
12161.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
12162.      
12163.    Free Space after Zone:
12164.    ------------------------
12165.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12166.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12167.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12168. 
12169. Directory and Files Select:
12170. ---------------------------
12171. !ZoneTypeSelectCurrent!               
12172. ---------------------------
12173. ----------------------------------------------------------
12174. ")
12175. 
12176. AppendLogfile("!LogFileName!", ".")
12177. AppendLogfile("!LogFileName!", "!ZoneFooter!")
12178. AppendLogfile("!LogFileName!", ".")
12179. 
12180. # Zone Footer Set Statistics Window Text
12181. 
12182. SetStatisticsWindowText("----------------------------------------------------------
12183. Zones Processed: 
12184. ----------------------------------------------------------
12185. !ZoneListByLine!
12186. ----------------------------------------------------------
12187. Zone Processing Step:
12188. !ZoneStepByLine!    
12189. ----------------------------------------------------------
12190. Current Zone:
12191. !ZoneFooter!
12192. ----------------------------------------------------------
12193. Volume Statistics:
12194. !VolumeStatisticsDetail!
12195. ----------------------------------------------------------
12196. Zone Detailed Report:
12197. ----------------------------------------------------------
12198. !ZoneStatisticsDetail!
12199. ----------------------------------------------------------
12200. ")
12201. 
12202. 
12203. 
12204. /* pause() */
12205. /* pause() */
12206. 
12207. 
12208. 
12209. 
12210. /* ---------------------------------------------------------- */
12211. 
12212. /* ---------------------------------------------------------- */
12213. /* Zone DevToDo */
12214. # Script: DefragZoneTypeDevToDo
12215. /* ---------------------------------------------------------- */
12216. /* Zone DevToDo */
12217. 
12218. SetVariable(ZoneLabel, "!ZoneLabelDevToDo!")
12219. SetVariable(ZoneDescription, "!ZoneDescriptionDevToDo!")
12220. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpDevToDo!")
12221. SetVariable(ZoneGapSize, "!ZoneGapSizeDevToDo!")
12222. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectDevToDo
12223. # DevToDo start.
12224. # NotBlobsArchivesBu start.
12225. (not (
12226. # Blobs start.
12227. (
12228. # BlobsAndExceptions start.
12229. ( not(
12230.   FileName("*.bat")
12231.   or FileName("*.css")
12232.   or FileName("*.dll")
12233.   or FileName("*.exe")
12234.   or FileName("*.htm*")
12235.   or FileName("*.jar")
12236.   or FileName("*.js")
12237.   or FileName("*.script")
12238.   or FileName("*.wsf")
12239.   or (
12240. # Databases start.
12241. (
12242.   FileName("*.crypt*")
12243.   or FileName("*.db*")
12244.   or FileName("*.rdb*")
12245.   or FileName("*.dc*")
12246.   or FileName("*.dict*")
12247.   or FileName("*.?db*")
12248.   or FileName("*.?rdb*")
12249.   or FileName("*.md*")
12250.   or FileName("*.myd")
12251.   or FileName("*.ndf")
12252.   or FileName("*.ns?")
12253.   or FileName("*.pab")
12254.   or FileName("*.pst")
12255.   or FileName("*.sd?*")
12256.   or FileName("*.sq**")
12257.   or FileName("*.tmd")
12258.   or FileName("*.tps")
12259.   or FileName("*.tr*")
12260. )
12261. # Databases end.
12262. 
12263.     # BlobsAndExceptions
12264.     or 
12265. # Data start.
12266. (
12267.   DirectoryName("Data*")
12268.   or DirectoryName("Device*")
12269.   or DirectoryName("Export*")
12270.   or DirectoryName("Import*")
12271.   or DirectoryName("Log*")
12272.   or DirectoryName("*Log")
12273.   or DirectoryName("Maintenance*")
12274.   or DirectoryName("Rec*")
12275.   or DirectoryName("Sales*")
12276.   or DirectoryName("Search*")
12277.   or DirectoryName("User*")
12278. )
12279. # Data end.
12280. 
12281.     # BlobsAndExceptions
12282.   )
12283. ) )
12284. # BlobsAndExceptions end.
12285. 
12286. # Blobs
12287. ) and (
12288.   Size(BlobFileSize,0)
12289.   or (
12290.     FileName("*.arj")
12291.     or FileName("*.bup")
12292.     or FileName("*.bz2")
12293.     or FileName("*.chm")
12294.     or FileName("*.dvr-ms")
12295.     or FileName("*.gz")
12296.     or FileName("*.ifo")
12297.     or FileName("*.lzh")
12298.     or FileName("*.pdf")
12299.     or FileName("*.rpm")
12300.     or FileName("*.wmv")
12301.     or FileName("*.vob")
12302.     or FileName("*.z")
12303.   ) 
12304. )
12305. # Blobs end.
12306. 
12307. # NotBlobsArchivesBu
12308. or 
12309. # Archives start.
12310. (
12311.   DirectoryName("*Archive*")
12312.   or DirectoryName("*History*")
12313.   or DirectoryName("*Old")
12314.   or DirectoryName("* Old *")
12315.   or DirectoryName("Old *")
12316. 
12317.   or FileName("*.7z")
12318.   or FileName("*.cab")
12319.   or FileName("*.iso")
12320.   or FileName("*.msi")
12321.   or FileName("*.old")
12322.   or FileName("*.rar")
12323.   or FileName("*.tar")
12324.   or FileName("*.zip")
12325.   or
12326. # WinSysLow start.
12327. (
12328.   DirectoryName("$*")
12329.   or DirectoryName("0*")
12330.   or DirectoryName("1*")
12331.   or DirectoryName("2*")
12332.   or DirectoryName("3*")
12333.   or DirectoryName("4*")
12334.   or DirectoryName("5*")
12335.   or DirectoryName("6*")
12336.   or DirectoryName("7*")
12337.   or DirectoryName("8*")
12338.   or DirectoryName("9*")
12339. 
12340.   or DirectoryName("dllcache")
12341.   or DirectoryName("Downloaded Installations")
12342.   or DirectoryName("Ehome")
12343.   or DirectoryName("Fonts")
12344.   or DirectoryName("Help")
12345.   or DirectoryName("I386")
12346.   or DirectoryName("ie?updates")
12347.   or DirectoryName("Installer")
12348.   or DirectoryName("Installshield Installation Information")
12349.   or DirectoryName("IME")
12350.   or DirectoryName("*RECYCLE*")
12351.   or DirectoryName("ServicePackFiles")
12352.   or DirectoryName("SoftwareDistribution")
12353.   or DirectoryName("Speech")
12354.   or DirectoryName("Symbols")
12355.   or DirectoryName("System Volume Information")
12356.   or DirectoryName("windows.old")
12357. )
12358. # WinSysLow end.
12359. 
12360.   # Archives
12361. )
12362. # Archives end.
12363. 
12364. # NotBlobsArchivesBu
12365. or
12366. # Backups start.
12367. (
12368.   DirectoryName("*Backup*")
12369.   or DirectoryName("*Bu")
12370.   or DirectoryName("* Bu *")
12371.   or DirectoryName("Bu *")
12372. 
12373.   or FileName("*.bak")
12374.   or FileName("* - Copy*")
12375. )
12376. # Backups end.
12377. 
12378. # NotBlobsArchivesBu
12379. ) )
12380. # NotBlobsArchivesBu end.
12381. 
12382. # DevToDo
12383. and ( 
12384. # Dev start.
12385. (
12386.   DirectoryName("*Dev") 
12387.   or DirectoryName("Dev *") 
12388.   or DirectoryName("*Development*") 
12389.   or DirectoryName("DsVs*") 
12390.   or DirectoryName("Srt*") 
12391. )
12392. # Dev end.
12393. 
12394. # DevToDo
12395. or 
12396. # ToDo start.
12397. (
12398.   DirectoryName("*ToDo*")
12399. )
12400. # ToDo end.
12401. 
12402. # DevToDo
12403. )
12404. # DevToDo end.
12405. ')
12406. 
12407. 	# Script: ZoneDoHeader
12408. 
12409. # Script: ZoneWhenStarted
12410. 
12411. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
12412. # Script: DisplaySetZone
12413. 
12414. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
12415. SetVariable(FileStepDescription,	"")
12416. 
12417. SetVariable(ZoneStepByLine, 			"Zone started.
12418. ")
12419. 
12420. # Script: BannerDescriptionSet
12421. 
12422. # Script: BannerSet
12423. 
12424. # Script: DisplaySetDateTimeRun
12425. 
12426. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
12427. /* Xinclude "..\Display\BannerSet.MyDc"X */
12428. /* pause(1) */
12429. 
12430. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12431. 
12432. Title('!Heading!')
12433. /* pause(1) */
12434. 
12435. /* NOTE: Can't round or truncate to integer precision. */
12436. 
12437. # Script: BannerLog
12438. 
12439. AppendLogfile("!LogFileName!", "!Title!")
12440. 
12441. 
12442. 
12443. pause(1)
12444. 
12445. 
12446. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
12447. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
12448. 
12449. SetVariable(ZoneStepNoCurrent, 0)
12450. 
12451. 
12452. # Script: ZoneDoCurrentClear
12453. 
12454. SetVariable(ZoneTypeSelectCurrent, 		"")
12455. 
12456. SetVariable(ZoneBeginCurrent, 			0)
12457. SetVariable(ZoneBeginPerCurrent, 		0)
12458. SetVariable(ZoneEndCurrent, 			0)
12459. SetVariable(ZoneEndPerCurrent, 			0)
12460. 
12461. SetVariable(ZoneSizeCurrent,			0)
12462. SetVariable(ZoneSizePerCurrent,			0)
12463. 
12464. SetVariable(ZoneGapRequestedCurrent,	0)
12465. SetVariable(ZoneGapRoundedCurrent, 		0)
12466. SetVariable(ZoneGapAdjustedCurrent, 	0)
12467. SetVariable(ZoneGapAvailableCurrent, 	0)
12468. SetVariable(ZoneGapCurrent,				0)
12469. SetVariable(ZoneGapUsedCurrent, 		0)
12470. 
12471. SetVariable(ZoneGapActualCurrent, 		0)
12472. SetVariable(ZoneGapActualPerCurrent, 	0)
12473. 
12474. SetVariable(ZoneSizeActual, 			0)
12475. SetVariable(ZoneSizeActualCurrent,		0)
12476. 
12477. SetVariable(ZoneEndActual, 				0)
12478. SetVariable(ZoneEndActualCurrent,		0)			
12479. SetVariable(ZoneSizeActualPerCurrent, 	0)
12480.       
12481. SetVariable(ZoneFilesFolders,			0)
12482. SetVariable(ZoneFilesFoldersPer,		0) 
12483. 
12484. SetVariable(ZoneFragments,				0)
12485. SetVariable(ZoneFragmentsPer,			0) 
12486. 		
12487. SetVariable(ZoneEndActualCurrent, 		0)
12488. SetVariable(ZoneEndActualPerCurrent, 	0)
12489. 
12490. # Gap Calculation Methodology:
12491. 	# Requested
12492. 	SetVariable(GapRequested, 			0) 
12493. 	SetVariable(GapRequestedStd, 		0) 
12494. 	SetVariable(GapRequestedMft, 		0) 
12495. 	SetVariable(GapRequestedOs, 		0) 
12496. 	SetVariable(GapRequestedOriginal, 	0) 
12497. 	
12498. 	# Gap Adjustments
12499. 	SetVariable(GapRounded, 			0)
12500. 	# SetVariable(GapAdjusted, 			0)
12501. 	SetVariable(GapAvailable, 			0)
12502. 	SetVariable(GapCurrent, 			0)
12503. 	SetVariable(GapActual, 				0)
12504. 	SetVariable(GapUsed, 				0)
12505. 	
12506. 	# Gap Adjustments
12507. 	SetVariable(GapRoundedLoc, 			0)
12508. 	# SetVariable(GapAdjustedLoc, 		0)
12509. 	SetVariable(GapAvailableLoc, 		0)
12510. 	SetVariable(GapCurrentLoc, 			0)
12511. 	SetVariable(GapActualLoc,			0)
12512. 	SetVariable(GapUsedLoc,				0)
12513. 	
12514. 	# Space usage
12515. 	SetVariable(ZoneFreePerRequested, 	0)
12516. 	SetVariable(ZoneFreePerUsed, 		0)
12517. 
12518. # Gap Size & Rounding
12519. 	SetVariable(ZoneGapSizePer, 		0)
12520. 	SetVariable(ZoneVolRoundUpPer, 		0)
12521. 	
12522. 	# Free Space
12523. 	SetVariable(ZoneFreeUsedPer, 		0)
12524. 	SetVariable(ZoneFreeRequestedPer, 	0)
12525. 
12526. 
12527. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
12528. 
12529. # Footer:
12530. SetVariable(ZoneFooter, "----------------------------------------------------------
12531. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:44
12532. 
12533. Statistics Report:
12534. ------------------
12535.    Size:  
12536.    ------------------------
12537.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12538.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12539.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12540. 
12541.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12542.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12543. 
12544.    Location:
12545.    ------------------------
12546.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12547.              Files End: !ZoneEndCurrent!
12548.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12549.       
12550.    Gap Settings:
12551.    ------------------------
12552.          Gap Requested: !ZoneGapSizePer!%
12553.       Volume Rounding: !ZoneVolRoundUpPer!%
12554.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12555.                  
12556.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
12557.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
12558.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
12559.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
12560.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
12561.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
12562.      
12563.    Free Space after Zone:
12564.    ------------------------
12565.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12566.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12567.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12568. 
12569. Directory and Files Select:
12570. ---------------------------
12571. !ZoneTypeSelectCurrent!               
12572. ---------------------------
12573. ----------------------------------------------------------
12574. ")
12575. 
12576. # Script: BannerSet
12577. 
12578. # Script: DisplaySetDateTimeRun
12579. 
12580. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
12581. /* Xinclude "..\Display\BannerSet.MyDc"X */
12582. /* pause(1) */
12583. 
12584. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12585. 
12586. Title('!Heading!')
12587. /* pause(1) */
12588. 
12589. /* NOTE: Can't round or truncate to integer precision. */
12590. 
12591. # Script: BannerLog
12592. 
12593. AppendLogfile("!LogFileName!", "!Title!")
12594. 
12595. 
12596. 
12597. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
12598. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
12599. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:44")
12600. 
12601. SetVariable(ZoneListByLine, "!ZoneListByLine!
12602. Zone: !ZoneNoCurrent! 2021-11-09 20:22:44 0:00:03 !ZoneLabel! !ZoneDescription!")
12603. 
12604. 
12605. /* Fixed Zone Position Handling */
12606. /* Literal number: */
12607. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
12608. /* Percentage of disk: */
12609. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
12610. /* Gap */
12611. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
12612. 
12613. /* ---------------------------------------------------------- */
12614. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
12615. # Script: DisplaySetFileStep
12616. 
12617. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12618. 
12619. /* add message and move to a new line. */
12620. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12621. ")
12622. 
12623. /* display the line. (hopefully.) */
12624. # Zone Footer Set Statistics Window Text
12625. 
12626. SetStatisticsWindowText("----------------------------------------------------------
12627. Zones Processed: 
12628. ----------------------------------------------------------
12629. !ZoneListByLine!
12630. ----------------------------------------------------------
12631. Zone Processing Step:
12632. !ZoneStepByLine!    
12633. ----------------------------------------------------------
12634. Current Zone:
12635. !ZoneFooter!
12636. ----------------------------------------------------------
12637. Volume Statistics:
12638. !VolumeStatisticsDetail!
12639. ----------------------------------------------------------
12640. Zone Detailed Report:
12641. ----------------------------------------------------------
12642. !ZoneStatisticsDetail!
12643. ----------------------------------------------------------
12644. ")
12645. 
12646. 
12647. 
12648. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12649. 
12650. # Script: BannerSet
12651. 
12652. # Script: DisplaySetDateTimeRun
12653. 
12654. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:44 0:00:03")
12655. /* Xinclude "..\Display\BannerSet.MyDc"X */
12656. /* pause(1) */
12657. 
12658. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12659. 
12660. Title('!Heading!')
12661. /* pause(1) */
12662. 
12663. /* NOTE: Can't round or truncate to integer precision. */
12664. 
12665. pause(1)
12666. 
12667. # your stuff HERE (X)... pre file select code.
12668. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
12669. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12670. 	# (X)
12671. 
12672. FileSelect
12673. 
12674. 	# your stuff can't really go here (errors.)
12675. 	# maybe for some reason I don't know of...
12676. 	
12677. 	# Actions next...
12678. 	# Script: ZoneDo ZoneTypeSelectDevToDo
12679. # DevToDo start.
12680. # NotBlobsArchivesBu start.
12681. (not (
12682. # Blobs start.
12683. (
12684. # BlobsAndExceptions start.
12685. ( not(
12686.   FileName("*.bat")
12687.   or FileName("*.css")
12688.   or FileName("*.dll")
12689.   or FileName("*.exe")
12690.   or FileName("*.htm*")
12691.   or FileName("*.jar")
12692.   or FileName("*.js")
12693.   or FileName("*.script")
12694.   or FileName("*.wsf")
12695.   or (
12696. # Databases start.
12697. (
12698.   FileName("*.crypt*")
12699.   or FileName("*.db*")
12700.   or FileName("*.rdb*")
12701.   or FileName("*.dc*")
12702.   or FileName("*.dict*")
12703.   or FileName("*.?db*")
12704.   or FileName("*.?rdb*")
12705.   or FileName("*.md*")
12706.   or FileName("*.myd")
12707.   or FileName("*.ndf")
12708.   or FileName("*.ns?")
12709.   or FileName("*.pab")
12710.   or FileName("*.pst")
12711.   or FileName("*.sd?*")
12712.   or FileName("*.sq**")
12713.   or FileName("*.tmd")
12714.   or FileName("*.tps")
12715.   or FileName("*.tr*")
12716. )
12717. # Databases end.
12718. 
12719.     # BlobsAndExceptions
12720.     or 
12721. # Data start.
12722. (
12723.   DirectoryName("Data*")
12724.   or DirectoryName("Device*")
12725.   or DirectoryName("Export*")
12726.   or DirectoryName("Import*")
12727.   or DirectoryName("Log*")
12728.   or DirectoryName("*Log")
12729.   or DirectoryName("Maintenance*")
12730.   or DirectoryName("Rec*")
12731.   or DirectoryName("Sales*")
12732.   or DirectoryName("Search*")
12733.   or DirectoryName("User*")
12734. )
12735. # Data end.
12736. 
12737.     # BlobsAndExceptions
12738.   )
12739. ) )
12740. # BlobsAndExceptions end.
12741. 
12742. # Blobs
12743. ) and (
12744.   Size(BlobFileSize,0)
12745.   or (
12746.     FileName("*.arj")
12747.     or FileName("*.bup")
12748.     or FileName("*.bz2")
12749.     or FileName("*.chm")
12750.     or FileName("*.dvr-ms")
12751.     or FileName("*.gz")
12752.     or FileName("*.ifo")
12753.     or FileName("*.lzh")
12754.     or FileName("*.pdf")
12755.     or FileName("*.rpm")
12756.     or FileName("*.wmv")
12757.     or FileName("*.vob")
12758.     or FileName("*.z")
12759.   ) 
12760. )
12761. # Blobs end.
12762. 
12763. # NotBlobsArchivesBu
12764. or 
12765. # Archives start.
12766. (
12767.   DirectoryName("*Archive*")
12768.   or DirectoryName("*History*")
12769.   or DirectoryName("*Old")
12770.   or DirectoryName("* Old *")
12771.   or DirectoryName("Old *")
12772. 
12773.   or FileName("*.7z")
12774.   or FileName("*.cab")
12775.   or FileName("*.iso")
12776.   or FileName("*.msi")
12777.   or FileName("*.old")
12778.   or FileName("*.rar")
12779.   or FileName("*.tar")
12780.   or FileName("*.zip")
12781.   or
12782. # WinSysLow start.
12783. (
12784.   DirectoryName("$*")
12785.   or DirectoryName("0*")
12786.   or DirectoryName("1*")
12787.   or DirectoryName("2*")
12788.   or DirectoryName("3*")
12789.   or DirectoryName("4*")
12790.   or DirectoryName("5*")
12791.   or DirectoryName("6*")
12792.   or DirectoryName("7*")
12793.   or DirectoryName("8*")
12794.   or DirectoryName("9*")
12795. 
12796.   or DirectoryName("dllcache")
12797.   or DirectoryName("Downloaded Installations")
12798.   or DirectoryName("Ehome")
12799.   or DirectoryName("Fonts")
12800.   or DirectoryName("Help")
12801.   or DirectoryName("I386")
12802.   or DirectoryName("ie?updates")
12803.   or DirectoryName("Installer")
12804.   or DirectoryName("Installshield Installation Information")
12805.   or DirectoryName("IME")
12806.   or DirectoryName("*RECYCLE*")
12807.   or DirectoryName("ServicePackFiles")
12808.   or DirectoryName("SoftwareDistribution")
12809.   or DirectoryName("Speech")
12810.   or DirectoryName("Symbols")
12811.   or DirectoryName("System Volume Information")
12812.   or DirectoryName("windows.old")
12813. )
12814. # WinSysLow end.
12815. 
12816.   # Archives
12817. )
12818. # Archives end.
12819. 
12820. # NotBlobsArchivesBu
12821. or
12822. # Backups start.
12823. (
12824.   DirectoryName("*Backup*")
12825.   or DirectoryName("*Bu")
12826.   or DirectoryName("* Bu *")
12827.   or DirectoryName("Bu *")
12828. 
12829.   or FileName("*.bak")
12830.   or FileName("* - Copy*")
12831. )
12832. # Backups end.
12833. 
12834. # NotBlobsArchivesBu
12835. ) )
12836. # NotBlobsArchivesBu end.
12837. 
12838. # DevToDo
12839. and ( 
12840. # Dev start.
12841. (
12842.   DirectoryName("*Dev") 
12843.   or DirectoryName("Dev *") 
12844.   or DirectoryName("*Development*") 
12845.   or DirectoryName("DsVs*") 
12846.   or DirectoryName("Srt*") 
12847. )
12848. # Dev end.
12849. 
12850. # DevToDo
12851. or 
12852. # ToDo start.
12853. (
12854.   DirectoryName("*ToDo*")
12855. )
12856. # ToDo end.
12857. 
12858. # DevToDo
12859. )
12860. # DevToDo end.
12861. 
12862. 	# Script: ZoneDoAction
12863. # Zone Do File Action - SortByName.
12864. 
12865. FileActions
12866. 
12867. 	# Footer:
12868. SetVariable(ZoneFooter, "----------------------------------------------------------
12869. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
12870. 
12871. Statistics Report:
12872. ------------------
12873.    Size:  
12874.    ------------------------
12875.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12876.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12877.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12878. 
12879.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12880.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12881. 
12882.    Location:
12883.    ------------------------
12884.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12885.              Files End: !ZoneEndCurrent!
12886.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12887.       
12888.    Gap Settings:
12889.    ------------------------
12890.          Gap Requested: !ZoneGapSizePer!%
12891.       Volume Rounding: !ZoneVolRoundUpPer!%
12892.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12893.                  
12894.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
12895.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
12896.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
12897.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
12898.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
12899.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
12900.      
12901.    Free Space after Zone:
12902.    ------------------------
12903.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12904.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12905.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12906. 
12907. Directory and Files Select:
12908. ---------------------------
12909. !ZoneTypeSelectCurrent!               
12910. ---------------------------
12911. ----------------------------------------------------------
12912. ")
12913. 	SetStatisticsWindowText("!ZoneFooter!")
12914. 	
12915. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
12916. 	# Script: DisplaySetFileStep
12917. 
12918. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12919. 
12920. /* add message and move to a new line. */
12921. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12922. ")
12923. 
12924. /* display the line. (hopefully.) */
12925. # Zone Footer Set Statistics Window Text
12926. 
12927. SetStatisticsWindowText("----------------------------------------------------------
12928. Zones Processed: 
12929. ----------------------------------------------------------
12930. !ZoneListByLine!
12931. ----------------------------------------------------------
12932. Zone Processing Step:
12933. !ZoneStepByLine!    
12934. ----------------------------------------------------------
12935. Current Zone:
12936. !ZoneFooter!
12937. ----------------------------------------------------------
12938. Volume Statistics:
12939. !VolumeStatisticsDetail!
12940. ----------------------------------------------------------
12941. Zone Detailed Report:
12942. ----------------------------------------------------------
12943. !ZoneStatisticsDetail!
12944. ----------------------------------------------------------
12945. ")
12946. 
12947. 
12948. 
12949. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12950. 
12951. # Script: BannerSet
12952. 
12953. # Script: DisplaySetDateTimeRun
12954. 
12955. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
12956. /* Xinclude "..\Display\BannerSet.MyDc"X */
12957. /* pause(1) */
12958. 
12959. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12960. 
12961. Title('!Heading!')
12962. /* pause(1) */
12963. 
12964. /* NOTE: Can't round or truncate to integer precision. */
12965. 
12966. pause(1)
12967. 
12968. # Commands:
12969. 
12970. /* Moves to Zone or above it. */
12971. # MoveUpToZone()
12972. 
12973. # Defrag
12974. 
12975. # Defragment(OPTIONS)
12976. 
12977. /* Shuffles files around trying to make a big enough gap for fragmented files. */
12978. # Defragment()
12979. 
12980. /* Only does files where a gap will fit it. */
12981. # Defragment(Fast)
12982. 
12983. /* Skips fragmented files larger than the Chunck Size.
12984. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
12985. # Defragment(Chunk Size)
12986. 
12987. /* Moves down to zone and packs zone to beginning if there are gaps. */
12988. /* Can be similar in performance to doing a SortBy. */
12989. # MoveDownFill()
12990. 
12991. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
12992. 
12993. 
12994. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
12995. 	# Script: DisplaySetFileStep
12996. 
12997. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12998. 
12999. /* add message and move to a new line. */
13000. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13001. ")
13002. 
13003. /* display the line. (hopefully.) */
13004. # Zone Footer Set Statistics Window Text
13005. 
13006. SetStatisticsWindowText("----------------------------------------------------------
13007. Zones Processed: 
13008. ----------------------------------------------------------
13009. !ZoneListByLine!
13010. ----------------------------------------------------------
13011. Zone Processing Step:
13012. !ZoneStepByLine!    
13013. ----------------------------------------------------------
13014. Current Zone:
13015. !ZoneFooter!
13016. ----------------------------------------------------------
13017. Volume Statistics:
13018. !VolumeStatisticsDetail!
13019. ----------------------------------------------------------
13020. Zone Detailed Report:
13021. ----------------------------------------------------------
13022. !ZoneStatisticsDetail!
13023. ----------------------------------------------------------
13024. ")
13025. 
13026. 
13027. 
13028. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13029. 
13030. # Script: BannerSet
13031. 
13032. # Script: DisplaySetDateTimeRun
13033. 
13034. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
13035. /* Xinclude "..\Display\BannerSet.MyDc"X */
13036. /* pause(1) */
13037. 
13038. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13039. 
13040. Title('!Heading!')
13041. /* pause(1) */
13042. 
13043. /* NOTE: Can't round or truncate to integer precision. */
13044. 
13045. pause(1)
13046. 
13047. 	# Script: ZoneDoFooter
13048. 
13049. /* ---------------------------------------------------------- */
13050. # File Select
13051. 	# Select Statments
13052. # File Actions 
13053. 	# Standard or OS File Actions.
13054. 	# Resume...
13055. 	
13056. 	# your stuff HERE (X)... post zone (file) file actions code.
13057. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
13058. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13059. 		# (X)
13060. 		
13061. 		/* ??? Set window? */
13062. 	
13063. 	# ADD THE GAP
13064. 		
13065. # Vacate (good for diagnostics)
13066. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
13067. 
13068. # DoNotVacate - DO NOT Vacate (recommended)
13069. 
13070. # Vacate
13071. /* AddGap(GapUsedLoc) */
13072. 
13073. # DO Not Vacate
13074. AddGap(GapUsedLoc, DoNotVacate) 
13075. 	
13076. 	
13077. /* ---------------------------------------------------------- */
13078. # (failed) TEST for boolean logic.
13079. 
13080. /* It should work in the gap calculations for turning options */
13081. /* on and off but it will NOT work here. */
13082. 
13083. /* Boolean setting X or FlagX. */
13084. /* Where X will be on or off: */
13085. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
13086. /*      For ON:  (X  *  FlagAny) */
13087. 
13088. /* 1) Failed, zero gap overrode the previous one. */
13089. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
13090. /* AddGap(GapUsedTemp) */ 
13091. 
13092. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
13093. /* AddGap(GapUsedTemp, DoNotVacate) */ 
13094. 
13095. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
13096. 
13097. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
13098. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
13099. /* AddGap(GapUsedTemp) */ 
13100. 
13101. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
13102. /* AddGap(GapUsedTemp, DoNotVacate) */ 
13103. 
13104. /* ---------------------------------------------------------- */
13105. 
13106. # Vacate
13107. /* AddGap(GapUsed) */
13108. 
13109. # DO NOT Vacate (recommended)
13110. /* AddGap(GapUsed, DoNotVacate) */ 
13111. 	
13112. 
13113. 		
13114. # 
13115. FileEnd
13116. /* ---------------------------------------------------------- */
13117. 
13118. # your stuff HERE (X)... post zone (file) code.
13119. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
13120. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13121. 	# (X)
13122. 
13123. SetVariable(FileStepDescription,"Zone finished, reporting.")
13124. # Script: DisplaySetFileStep
13125. 
13126. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13127. 
13128. /* add message and move to a new line. */
13129. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13130. ")
13131. 
13132. /* display the line. (hopefully.) */
13133. # Zone Footer Set Statistics Window Text
13134. 
13135. SetStatisticsWindowText("----------------------------------------------------------
13136. Zones Processed: 
13137. ----------------------------------------------------------
13138. !ZoneListByLine!
13139. ----------------------------------------------------------
13140. Zone Processing Step:
13141. !ZoneStepByLine!    
13142. ----------------------------------------------------------
13143. Current Zone:
13144. !ZoneFooter!
13145. ----------------------------------------------------------
13146. Volume Statistics:
13147. !VolumeStatisticsDetail!
13148. ----------------------------------------------------------
13149. Zone Detailed Report:
13150. ----------------------------------------------------------
13151. !ZoneStatisticsDetail!
13152. ----------------------------------------------------------
13153. ")
13154. 
13155. 
13156. 
13157. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13158. 
13159. # Script: BannerSet
13160. 
13161. # Script: DisplaySetDateTimeRun
13162. 
13163. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
13164. /* Xinclude "..\Display\BannerSet.MyDc"X */
13165. /* pause(1) */
13166. 
13167. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13168. 
13169. Title('!Heading!')
13170. /* pause(1) */
13171. 
13172. /* NOTE: Can't round or truncate to integer precision. */
13173. 
13174. pause(1)
13175. 
13176. # Script: ZoneWhenFinished
13177. 
13178. # Script: BannerSet
13179. 
13180. # Script: DisplaySetDateTimeRun
13181. 
13182. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
13183. /* Xinclude "..\Display\BannerSet.MyDc"X */
13184. /* pause(1) */
13185. 
13186. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13187. 
13188. Title('!Heading!')
13189. /* pause(1) */
13190. 
13191. /* NOTE: Can't round or truncate to integer precision. */
13192. 
13193. # Script: BannerLog
13194. 
13195. AppendLogfile("!LogFileName!", "!Title!")
13196. 
13197. 
13198. 
13199. # Zone Statistics	
13200. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
13201. 
13202. # Footer:
13203. SetVariable(ZoneFooter, "----------------------------------------------------------
13204. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
13205. 
13206. Statistics Report:
13207. ------------------
13208.    Size:  
13209.    ------------------------
13210.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13211.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13212.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13213. 
13214.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13215.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13216. 
13217.    Location:
13218.    ------------------------
13219.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13220.              Files End: !ZoneEndCurrent!
13221.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13222.       
13223.    Gap Settings:
13224.    ------------------------
13225.          Gap Requested: !ZoneGapSizePer!%
13226.       Volume Rounding: !ZoneVolRoundUpPer!%
13227.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13228.                  
13229.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
13230.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
13231.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
13232.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
13233.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
13234.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
13235.      
13236.    Free Space after Zone:
13237.    ------------------------
13238.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13239.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13240.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13241. 
13242. Directory and Files Select:
13243. ---------------------------
13244. !ZoneTypeSelectCurrent!               
13245. ---------------------------
13246. ----------------------------------------------------------
13247. ")
13248. 
13249. AppendLogfile("!LogFileName!", ".")
13250. AppendLogfile("!LogFileName!", "!ZoneFooter!")
13251. AppendLogfile("!LogFileName!", ".")
13252. 
13253. # Zone Footer Set Statistics Window Text
13254. 
13255. SetStatisticsWindowText("----------------------------------------------------------
13256. Zones Processed: 
13257. ----------------------------------------------------------
13258. !ZoneListByLine!
13259. ----------------------------------------------------------
13260. Zone Processing Step:
13261. !ZoneStepByLine!    
13262. ----------------------------------------------------------
13263. Current Zone:
13264. !ZoneFooter!
13265. ----------------------------------------------------------
13266. Volume Statistics:
13267. !VolumeStatisticsDetail!
13268. ----------------------------------------------------------
13269. Zone Detailed Report:
13270. ----------------------------------------------------------
13271. !ZoneStatisticsDetail!
13272. ----------------------------------------------------------
13273. ")
13274. 
13275. 
13276. 
13277. /* pause() */
13278. /* pause() */
13279. 
13280. 
13281. 
13282. 
13283. /* ---------------------------------------------------------- */
13284. 
13285. /* ---------------------------------------------------------- */
13286. /* Zone LinksCorp Links and Corp */
13287. # Script: DefragZoneTypeLinksCorp
13288. /* ---------------------------------------------------------- */
13289. /* Zone LinksCorp Links and Corp */
13290. SetVariable(ZoneLabel, "!ZoneLabelLinksCorp!")
13291. SetVariable(ZoneDescription, "!ZoneDescriptionLinksCorp!")
13292. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpLinksCorp!")
13293. SetVariable(ZoneGapSize, "!ZoneGapSizeLinksCorp!")
13294. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectLinksCorp
13295. # LinksCorp start.
13296. # NotBlobsArchivesBu start.
13297. (not (
13298. # Blobs start.
13299. (
13300. # BlobsAndExceptions start.
13301. ( not(
13302.   FileName("*.bat")
13303.   or FileName("*.css")
13304.   or FileName("*.dll")
13305.   or FileName("*.exe")
13306.   or FileName("*.htm*")
13307.   or FileName("*.jar")
13308.   or FileName("*.js")
13309.   or FileName("*.script")
13310.   or FileName("*.wsf")
13311.   or (
13312. # Databases start.
13313. (
13314.   FileName("*.crypt*")
13315.   or FileName("*.db*")
13316.   or FileName("*.rdb*")
13317.   or FileName("*.dc*")
13318.   or FileName("*.dict*")
13319.   or FileName("*.?db*")
13320.   or FileName("*.?rdb*")
13321.   or FileName("*.md*")
13322.   or FileName("*.myd")
13323.   or FileName("*.ndf")
13324.   or FileName("*.ns?")
13325.   or FileName("*.pab")
13326.   or FileName("*.pst")
13327.   or FileName("*.sd?*")
13328.   or FileName("*.sq**")
13329.   or FileName("*.tmd")
13330.   or FileName("*.tps")
13331.   or FileName("*.tr*")
13332. )
13333. # Databases end.
13334. 
13335.     # BlobsAndExceptions
13336.     or 
13337. # Data start.
13338. (
13339.   DirectoryName("Data*")
13340.   or DirectoryName("Device*")
13341.   or DirectoryName("Export*")
13342.   or DirectoryName("Import*")
13343.   or DirectoryName("Log*")
13344.   or DirectoryName("*Log")
13345.   or DirectoryName("Maintenance*")
13346.   or DirectoryName("Rec*")
13347.   or DirectoryName("Sales*")
13348.   or DirectoryName("Search*")
13349.   or DirectoryName("User*")
13350. )
13351. # Data end.
13352. 
13353.     # BlobsAndExceptions
13354.   )
13355. ) )
13356. # BlobsAndExceptions end.
13357. 
13358. # Blobs
13359. ) and (
13360.   Size(BlobFileSize,0)
13361.   or (
13362.     FileName("*.arj")
13363.     or FileName("*.bup")
13364.     or FileName("*.bz2")
13365.     or FileName("*.chm")
13366.     or FileName("*.dvr-ms")
13367.     or FileName("*.gz")
13368.     or FileName("*.ifo")
13369.     or FileName("*.lzh")
13370.     or FileName("*.pdf")
13371.     or FileName("*.rpm")
13372.     or FileName("*.wmv")
13373.     or FileName("*.vob")
13374.     or FileName("*.z")
13375.   ) 
13376. )
13377. # Blobs end.
13378. 
13379. # NotBlobsArchivesBu
13380. or 
13381. # Archives start.
13382. (
13383.   DirectoryName("*Archive*")
13384.   or DirectoryName("*History*")
13385.   or DirectoryName("*Old")
13386.   or DirectoryName("* Old *")
13387.   or DirectoryName("Old *")
13388. 
13389.   or FileName("*.7z")
13390.   or FileName("*.cab")
13391.   or FileName("*.iso")
13392.   or FileName("*.msi")
13393.   or FileName("*.old")
13394.   or FileName("*.rar")
13395.   or FileName("*.tar")
13396.   or FileName("*.zip")
13397.   or
13398. # WinSysLow start.
13399. (
13400.   DirectoryName("$*")
13401.   or DirectoryName("0*")
13402.   or DirectoryName("1*")
13403.   or DirectoryName("2*")
13404.   or DirectoryName("3*")
13405.   or DirectoryName("4*")
13406.   or DirectoryName("5*")
13407.   or DirectoryName("6*")
13408.   or DirectoryName("7*")
13409.   or DirectoryName("8*")
13410.   or DirectoryName("9*")
13411. 
13412.   or DirectoryName("dllcache")
13413.   or DirectoryName("Downloaded Installations")
13414.   or DirectoryName("Ehome")
13415.   or DirectoryName("Fonts")
13416.   or DirectoryName("Help")
13417.   or DirectoryName("I386")
13418.   or DirectoryName("ie?updates")
13419.   or DirectoryName("Installer")
13420.   or DirectoryName("Installshield Installation Information")
13421.   or DirectoryName("IME")
13422.   or DirectoryName("*RECYCLE*")
13423.   or DirectoryName("ServicePackFiles")
13424.   or DirectoryName("SoftwareDistribution")
13425.   or DirectoryName("Speech")
13426.   or DirectoryName("Symbols")
13427.   or DirectoryName("System Volume Information")
13428.   or DirectoryName("windows.old")
13429. )
13430. # WinSysLow end.
13431. 
13432.   # Archives
13433. )
13434. # Archives end.
13435. 
13436. # NotBlobsArchivesBu
13437. or
13438. # Backups start.
13439. (
13440.   DirectoryName("*Backup*")
13441.   or DirectoryName("*Bu")
13442.   or DirectoryName("* Bu *")
13443.   or DirectoryName("Bu *")
13444. 
13445.   or FileName("*.bak")
13446.   or FileName("* - Copy*")
13447. )
13448. # Backups end.
13449. 
13450. # NotBlobsArchivesBu
13451. ) )
13452. # NotBlobsArchivesBu end.
13453. 
13454. # LinksCorp
13455. and ( 
13456. # Corp start.
13457. (
13458.     DirectoryName("*Corp*") or
13459.     DirectoryName("*Mdm*")
13460. )
13461. # Corp end.
13462. 
13463. # LinksCorp
13464. or 
13465. # Links start.
13466. (
13467.     DirectoryName("*Favorites*") or
13468.     DirectoryName("*Job*") or
13469.     DirectoryName("*Links*")
13470. )
13471. # Links end.
13472. 
13473. # LinksCorp
13474. or 
13475. # Support start.
13476. (
13477.   DirectoryName("*Logs*") or
13478.   DirectoryName("*Support*") or
13479.   DirectoryName("*Maintenance*")
13480. )
13481. # Support end.
13482. 
13483. # LinksCorp
13484. )
13485. # LinksCorp end.
13486. ')
13487. 
13488. 	# Script: ZoneDoHeader
13489. 
13490. # Script: ZoneWhenStarted
13491. 
13492. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
13493. # Script: DisplaySetZone
13494. 
13495. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
13496. SetVariable(FileStepDescription,	"")
13497. 
13498. SetVariable(ZoneStepByLine, 			"Zone started.
13499. ")
13500. 
13501. # Script: BannerDescriptionSet
13502. 
13503. # Script: BannerSet
13504. 
13505. # Script: DisplaySetDateTimeRun
13506. 
13507. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
13508. /* Xinclude "..\Display\BannerSet.MyDc"X */
13509. /* pause(1) */
13510. 
13511. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13512. 
13513. Title('!Heading!')
13514. /* pause(1) */
13515. 
13516. /* NOTE: Can't round or truncate to integer precision. */
13517. 
13518. # Script: BannerLog
13519. 
13520. AppendLogfile("!LogFileName!", "!Title!")
13521. 
13522. 
13523. 
13524. pause(1)
13525. 
13526. 
13527. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
13528. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
13529. 
13530. SetVariable(ZoneStepNoCurrent, 0)
13531. 
13532. 
13533. # Script: ZoneDoCurrentClear
13534. 
13535. SetVariable(ZoneTypeSelectCurrent, 		"")
13536. 
13537. SetVariable(ZoneBeginCurrent, 			0)
13538. SetVariable(ZoneBeginPerCurrent, 		0)
13539. SetVariable(ZoneEndCurrent, 			0)
13540. SetVariable(ZoneEndPerCurrent, 			0)
13541. 
13542. SetVariable(ZoneSizeCurrent,			0)
13543. SetVariable(ZoneSizePerCurrent,			0)
13544. 
13545. SetVariable(ZoneGapRequestedCurrent,	0)
13546. SetVariable(ZoneGapRoundedCurrent, 		0)
13547. SetVariable(ZoneGapAdjustedCurrent, 	0)
13548. SetVariable(ZoneGapAvailableCurrent, 	0)
13549. SetVariable(ZoneGapCurrent,				0)
13550. SetVariable(ZoneGapUsedCurrent, 		0)
13551. 
13552. SetVariable(ZoneGapActualCurrent, 		0)
13553. SetVariable(ZoneGapActualPerCurrent, 	0)
13554. 
13555. SetVariable(ZoneSizeActual, 			0)
13556. SetVariable(ZoneSizeActualCurrent,		0)
13557. 
13558. SetVariable(ZoneEndActual, 				0)
13559. SetVariable(ZoneEndActualCurrent,		0)			
13560. SetVariable(ZoneSizeActualPerCurrent, 	0)
13561.       
13562. SetVariable(ZoneFilesFolders,			0)
13563. SetVariable(ZoneFilesFoldersPer,		0) 
13564. 
13565. SetVariable(ZoneFragments,				0)
13566. SetVariable(ZoneFragmentsPer,			0) 
13567. 		
13568. SetVariable(ZoneEndActualCurrent, 		0)
13569. SetVariable(ZoneEndActualPerCurrent, 	0)
13570. 
13571. # Gap Calculation Methodology:
13572. 	# Requested
13573. 	SetVariable(GapRequested, 			0) 
13574. 	SetVariable(GapRequestedStd, 		0) 
13575. 	SetVariable(GapRequestedMft, 		0) 
13576. 	SetVariable(GapRequestedOs, 		0) 
13577. 	SetVariable(GapRequestedOriginal, 	0) 
13578. 	
13579. 	# Gap Adjustments
13580. 	SetVariable(GapRounded, 			0)
13581. 	# SetVariable(GapAdjusted, 			0)
13582. 	SetVariable(GapAvailable, 			0)
13583. 	SetVariable(GapCurrent, 			0)
13584. 	SetVariable(GapActual, 				0)
13585. 	SetVariable(GapUsed, 				0)
13586. 	
13587. 	# Gap Adjustments
13588. 	SetVariable(GapRoundedLoc, 			0)
13589. 	# SetVariable(GapAdjustedLoc, 		0)
13590. 	SetVariable(GapAvailableLoc, 		0)
13591. 	SetVariable(GapCurrentLoc, 			0)
13592. 	SetVariable(GapActualLoc,			0)
13593. 	SetVariable(GapUsedLoc,				0)
13594. 	
13595. 	# Space usage
13596. 	SetVariable(ZoneFreePerRequested, 	0)
13597. 	SetVariable(ZoneFreePerUsed, 		0)
13598. 
13599. # Gap Size & Rounding
13600. 	SetVariable(ZoneGapSizePer, 		0)
13601. 	SetVariable(ZoneVolRoundUpPer, 		0)
13602. 	
13603. 	# Free Space
13604. 	SetVariable(ZoneFreeUsedPer, 		0)
13605. 	SetVariable(ZoneFreeRequestedPer, 	0)
13606. 
13607. 
13608. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
13609. 
13610. # Footer:
13611. SetVariable(ZoneFooter, "----------------------------------------------------------
13612. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
13613. 
13614. Statistics Report:
13615. ------------------
13616.    Size:  
13617.    ------------------------
13618.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13619.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13620.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13621. 
13622.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13623.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13624. 
13625.    Location:
13626.    ------------------------
13627.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13628.              Files End: !ZoneEndCurrent!
13629.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13630.       
13631.    Gap Settings:
13632.    ------------------------
13633.          Gap Requested: !ZoneGapSizePer!%
13634.       Volume Rounding: !ZoneVolRoundUpPer!%
13635.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13636.                  
13637.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
13638.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
13639.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
13640.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
13641.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
13642.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
13643.      
13644.    Free Space after Zone:
13645.    ------------------------
13646.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13647.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13648.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13649. 
13650. Directory and Files Select:
13651. ---------------------------
13652. !ZoneTypeSelectCurrent!               
13653. ---------------------------
13654. ----------------------------------------------------------
13655. ")
13656. 
13657. # Script: BannerSet
13658. 
13659. # Script: DisplaySetDateTimeRun
13660. 
13661. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
13662. /* Xinclude "..\Display\BannerSet.MyDc"X */
13663. /* pause(1) */
13664. 
13665. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13666. 
13667. Title('!Heading!')
13668. /* pause(1) */
13669. 
13670. /* NOTE: Can't round or truncate to integer precision. */
13671. 
13672. # Script: BannerLog
13673. 
13674. AppendLogfile("!LogFileName!", "!Title!")
13675. 
13676. 
13677. 
13678. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
13679. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
13680. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:45")
13681. 
13682. SetVariable(ZoneListByLine, "!ZoneListByLine!
13683. Zone: !ZoneNoCurrent! 2021-11-09 20:22:45 0:00:04 !ZoneLabel! !ZoneDescription!")
13684. 
13685. 
13686. /* Fixed Zone Position Handling */
13687. /* Literal number: */
13688. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
13689. /* Percentage of disk: */
13690. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
13691. /* Gap */
13692. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
13693. 
13694. /* ---------------------------------------------------------- */
13695. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
13696. # Script: DisplaySetFileStep
13697. 
13698. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13699. 
13700. /* add message and move to a new line. */
13701. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13702. ")
13703. 
13704. /* display the line. (hopefully.) */
13705. # Zone Footer Set Statistics Window Text
13706. 
13707. SetStatisticsWindowText("----------------------------------------------------------
13708. Zones Processed: 
13709. ----------------------------------------------------------
13710. !ZoneListByLine!
13711. ----------------------------------------------------------
13712. Zone Processing Step:
13713. !ZoneStepByLine!    
13714. ----------------------------------------------------------
13715. Current Zone:
13716. !ZoneFooter!
13717. ----------------------------------------------------------
13718. Volume Statistics:
13719. !VolumeStatisticsDetail!
13720. ----------------------------------------------------------
13721. Zone Detailed Report:
13722. ----------------------------------------------------------
13723. !ZoneStatisticsDetail!
13724. ----------------------------------------------------------
13725. ")
13726. 
13727. 
13728. 
13729. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13730. 
13731. # Script: BannerSet
13732. 
13733. # Script: DisplaySetDateTimeRun
13734. 
13735. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
13736. /* Xinclude "..\Display\BannerSet.MyDc"X */
13737. /* pause(1) */
13738. 
13739. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13740. 
13741. Title('!Heading!')
13742. /* pause(1) */
13743. 
13744. /* NOTE: Can't round or truncate to integer precision. */
13745. 
13746. pause(1)
13747. 
13748. # your stuff HERE (X)... pre file select code.
13749. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
13750. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13751. 	# (X)
13752. 
13753. FileSelect
13754. 
13755. 	# your stuff can't really go here (errors.)
13756. 	# maybe for some reason I don't know of...
13757. 	
13758. 	# Actions next...
13759. 	# Script: ZoneDo ZoneTypeSelectLinksCorp
13760. # LinksCorp start.
13761. # NotBlobsArchivesBu start.
13762. (not (
13763. # Blobs start.
13764. (
13765. # BlobsAndExceptions start.
13766. ( not(
13767.   FileName("*.bat")
13768.   or FileName("*.css")
13769.   or FileName("*.dll")
13770.   or FileName("*.exe")
13771.   or FileName("*.htm*")
13772.   or FileName("*.jar")
13773.   or FileName("*.js")
13774.   or FileName("*.script")
13775.   or FileName("*.wsf")
13776.   or (
13777. # Databases start.
13778. (
13779.   FileName("*.crypt*")
13780.   or FileName("*.db*")
13781.   or FileName("*.rdb*")
13782.   or FileName("*.dc*")
13783.   or FileName("*.dict*")
13784.   or FileName("*.?db*")
13785.   or FileName("*.?rdb*")
13786.   or FileName("*.md*")
13787.   or FileName("*.myd")
13788.   or FileName("*.ndf")
13789.   or FileName("*.ns?")
13790.   or FileName("*.pab")
13791.   or FileName("*.pst")
13792.   or FileName("*.sd?*")
13793.   or FileName("*.sq**")
13794.   or FileName("*.tmd")
13795.   or FileName("*.tps")
13796.   or FileName("*.tr*")
13797. )
13798. # Databases end.
13799. 
13800.     # BlobsAndExceptions
13801.     or 
13802. # Data start.
13803. (
13804.   DirectoryName("Data*")
13805.   or DirectoryName("Device*")
13806.   or DirectoryName("Export*")
13807.   or DirectoryName("Import*")
13808.   or DirectoryName("Log*")
13809.   or DirectoryName("*Log")
13810.   or DirectoryName("Maintenance*")
13811.   or DirectoryName("Rec*")
13812.   or DirectoryName("Sales*")
13813.   or DirectoryName("Search*")
13814.   or DirectoryName("User*")
13815. )
13816. # Data end.
13817. 
13818.     # BlobsAndExceptions
13819.   )
13820. ) )
13821. # BlobsAndExceptions end.
13822. 
13823. # Blobs
13824. ) and (
13825.   Size(BlobFileSize,0)
13826.   or (
13827.     FileName("*.arj")
13828.     or FileName("*.bup")
13829.     or FileName("*.bz2")
13830.     or FileName("*.chm")
13831.     or FileName("*.dvr-ms")
13832.     or FileName("*.gz")
13833.     or FileName("*.ifo")
13834.     or FileName("*.lzh")
13835.     or FileName("*.pdf")
13836.     or FileName("*.rpm")
13837.     or FileName("*.wmv")
13838.     or FileName("*.vob")
13839.     or FileName("*.z")
13840.   ) 
13841. )
13842. # Blobs end.
13843. 
13844. # NotBlobsArchivesBu
13845. or 
13846. # Archives start.
13847. (
13848.   DirectoryName("*Archive*")
13849.   or DirectoryName("*History*")
13850.   or DirectoryName("*Old")
13851.   or DirectoryName("* Old *")
13852.   or DirectoryName("Old *")
13853. 
13854.   or FileName("*.7z")
13855.   or FileName("*.cab")
13856.   or FileName("*.iso")
13857.   or FileName("*.msi")
13858.   or FileName("*.old")
13859.   or FileName("*.rar")
13860.   or FileName("*.tar")
13861.   or FileName("*.zip")
13862.   or
13863. # WinSysLow start.
13864. (
13865.   DirectoryName("$*")
13866.   or DirectoryName("0*")
13867.   or DirectoryName("1*")
13868.   or DirectoryName("2*")
13869.   or DirectoryName("3*")
13870.   or DirectoryName("4*")
13871.   or DirectoryName("5*")
13872.   or DirectoryName("6*")
13873.   or DirectoryName("7*")
13874.   or DirectoryName("8*")
13875.   or DirectoryName("9*")
13876. 
13877.   or DirectoryName("dllcache")
13878.   or DirectoryName("Downloaded Installations")
13879.   or DirectoryName("Ehome")
13880.   or DirectoryName("Fonts")
13881.   or DirectoryName("Help")
13882.   or DirectoryName("I386")
13883.   or DirectoryName("ie?updates")
13884.   or DirectoryName("Installer")
13885.   or DirectoryName("Installshield Installation Information")
13886.   or DirectoryName("IME")
13887.   or DirectoryName("*RECYCLE*")
13888.   or DirectoryName("ServicePackFiles")
13889.   or DirectoryName("SoftwareDistribution")
13890.   or DirectoryName("Speech")
13891.   or DirectoryName("Symbols")
13892.   or DirectoryName("System Volume Information")
13893.   or DirectoryName("windows.old")
13894. )
13895. # WinSysLow end.
13896. 
13897.   # Archives
13898. )
13899. # Archives end.
13900. 
13901. # NotBlobsArchivesBu
13902. or
13903. # Backups start.
13904. (
13905.   DirectoryName("*Backup*")
13906.   or DirectoryName("*Bu")
13907.   or DirectoryName("* Bu *")
13908.   or DirectoryName("Bu *")
13909. 
13910.   or FileName("*.bak")
13911.   or FileName("* - Copy*")
13912. )
13913. # Backups end.
13914. 
13915. # NotBlobsArchivesBu
13916. ) )
13917. # NotBlobsArchivesBu end.
13918. 
13919. # LinksCorp
13920. and ( 
13921. # Corp start.
13922. (
13923.     DirectoryName("*Corp*") or
13924.     DirectoryName("*Mdm*")
13925. )
13926. # Corp end.
13927. 
13928. # LinksCorp
13929. or 
13930. # Links start.
13931. (
13932.     DirectoryName("*Favorites*") or
13933.     DirectoryName("*Job*") or
13934.     DirectoryName("*Links*")
13935. )
13936. # Links end.
13937. 
13938. # LinksCorp
13939. or 
13940. # Support start.
13941. (
13942.   DirectoryName("*Logs*") or
13943.   DirectoryName("*Support*") or
13944.   DirectoryName("*Maintenance*")
13945. )
13946. # Support end.
13947. 
13948. # LinksCorp
13949. )
13950. # LinksCorp end.
13951. 
13952. 	# Script: ZoneDoAction
13953. # Zone Do File Action - SortByName.
13954. 
13955. FileActions
13956. 
13957. 	# Footer:
13958. SetVariable(ZoneFooter, "----------------------------------------------------------
13959. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
13960. 
13961. Statistics Report:
13962. ------------------
13963.    Size:  
13964.    ------------------------
13965.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13966.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13967.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13968. 
13969.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13970.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13971. 
13972.    Location:
13973.    ------------------------
13974.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13975.              Files End: !ZoneEndCurrent!
13976.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13977.       
13978.    Gap Settings:
13979.    ------------------------
13980.          Gap Requested: !ZoneGapSizePer!%
13981.       Volume Rounding: !ZoneVolRoundUpPer!%
13982.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13983.                  
13984.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
13985.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
13986.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
13987.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
13988.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
13989.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
13990.      
13991.    Free Space after Zone:
13992.    ------------------------
13993.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13994.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13995.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13996. 
13997. Directory and Files Select:
13998. ---------------------------
13999. !ZoneTypeSelectCurrent!               
14000. ---------------------------
14001. ----------------------------------------------------------
14002. ")
14003. 	SetStatisticsWindowText("!ZoneFooter!")
14004. 	
14005. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
14006. 	# Script: DisplaySetFileStep
14007. 
14008. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14009. 
14010. /* add message and move to a new line. */
14011. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14012. ")
14013. 
14014. /* display the line. (hopefully.) */
14015. # Zone Footer Set Statistics Window Text
14016. 
14017. SetStatisticsWindowText("----------------------------------------------------------
14018. Zones Processed: 
14019. ----------------------------------------------------------
14020. !ZoneListByLine!
14021. ----------------------------------------------------------
14022. Zone Processing Step:
14023. !ZoneStepByLine!    
14024. ----------------------------------------------------------
14025. Current Zone:
14026. !ZoneFooter!
14027. ----------------------------------------------------------
14028. Volume Statistics:
14029. !VolumeStatisticsDetail!
14030. ----------------------------------------------------------
14031. Zone Detailed Report:
14032. ----------------------------------------------------------
14033. !ZoneStatisticsDetail!
14034. ----------------------------------------------------------
14035. ")
14036. 
14037. 
14038. 
14039. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14040. 
14041. # Script: BannerSet
14042. 
14043. # Script: DisplaySetDateTimeRun
14044. 
14045. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
14046. /* Xinclude "..\Display\BannerSet.MyDc"X */
14047. /* pause(1) */
14048. 
14049. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14050. 
14051. Title('!Heading!')
14052. /* pause(1) */
14053. 
14054. /* NOTE: Can't round or truncate to integer precision. */
14055. 
14056. pause(1)
14057. 
14058. # Commands:
14059. 
14060. /* Moves to Zone or above it. */
14061. # MoveUpToZone()
14062. 
14063. # Defrag
14064. 
14065. # Defragment(OPTIONS)
14066. 
14067. /* Shuffles files around trying to make a big enough gap for fragmented files. */
14068. # Defragment()
14069. 
14070. /* Only does files where a gap will fit it. */
14071. # Defragment(Fast)
14072. 
14073. /* Skips fragmented files larger than the Chunck Size.
14074. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
14075. # Defragment(Chunk Size)
14076. 
14077. /* Moves down to zone and packs zone to beginning if there are gaps. */
14078. /* Can be similar in performance to doing a SortBy. */
14079. # MoveDownFill()
14080. 
14081. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
14082. 
14083. 
14084. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
14085. 	# Script: DisplaySetFileStep
14086. 
14087. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14088. 
14089. /* add message and move to a new line. */
14090. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14091. ")
14092. 
14093. /* display the line. (hopefully.) */
14094. # Zone Footer Set Statistics Window Text
14095. 
14096. SetStatisticsWindowText("----------------------------------------------------------
14097. Zones Processed: 
14098. ----------------------------------------------------------
14099. !ZoneListByLine!
14100. ----------------------------------------------------------
14101. Zone Processing Step:
14102. !ZoneStepByLine!    
14103. ----------------------------------------------------------
14104. Current Zone:
14105. !ZoneFooter!
14106. ----------------------------------------------------------
14107. Volume Statistics:
14108. !VolumeStatisticsDetail!
14109. ----------------------------------------------------------
14110. Zone Detailed Report:
14111. ----------------------------------------------------------
14112. !ZoneStatisticsDetail!
14113. ----------------------------------------------------------
14114. ")
14115. 
14116. 
14117. 
14118. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14119. 
14120. # Script: BannerSet
14121. 
14122. # Script: DisplaySetDateTimeRun
14123. 
14124. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
14125. /* Xinclude "..\Display\BannerSet.MyDc"X */
14126. /* pause(1) */
14127. 
14128. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14129. 
14130. Title('!Heading!')
14131. /* pause(1) */
14132. 
14133. /* NOTE: Can't round or truncate to integer precision. */
14134. 
14135. pause(1)
14136. 
14137. 	# Script: ZoneDoFooter
14138. 
14139. /* ---------------------------------------------------------- */
14140. # File Select
14141. 	# Select Statments
14142. # File Actions 
14143. 	# Standard or OS File Actions.
14144. 	# Resume...
14145. 	
14146. 	# your stuff HERE (X)... post zone (file) file actions code.
14147. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
14148. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14149. 		# (X)
14150. 		
14151. 		/* ??? Set window? */
14152. 	
14153. 	# ADD THE GAP
14154. 		
14155. # Vacate (good for diagnostics)
14156. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
14157. 
14158. # DoNotVacate - DO NOT Vacate (recommended)
14159. 
14160. # Vacate
14161. /* AddGap(GapUsedLoc) */
14162. 
14163. # DO Not Vacate
14164. AddGap(GapUsedLoc, DoNotVacate) 
14165. 	
14166. 	
14167. /* ---------------------------------------------------------- */
14168. # (failed) TEST for boolean logic.
14169. 
14170. /* It should work in the gap calculations for turning options */
14171. /* on and off but it will NOT work here. */
14172. 
14173. /* Boolean setting X or FlagX. */
14174. /* Where X will be on or off: */
14175. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
14176. /*      For ON:  (X  *  FlagAny) */
14177. 
14178. /* 1) Failed, zero gap overrode the previous one. */
14179. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
14180. /* AddGap(GapUsedTemp) */ 
14181. 
14182. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
14183. /* AddGap(GapUsedTemp, DoNotVacate) */ 
14184. 
14185. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
14186. 
14187. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
14188. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
14189. /* AddGap(GapUsedTemp) */ 
14190. 
14191. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
14192. /* AddGap(GapUsedTemp, DoNotVacate) */ 
14193. 
14194. /* ---------------------------------------------------------- */
14195. 
14196. # Vacate
14197. /* AddGap(GapUsed) */
14198. 
14199. # DO NOT Vacate (recommended)
14200. /* AddGap(GapUsed, DoNotVacate) */ 
14201. 	
14202. 
14203. 		
14204. # 
14205. FileEnd
14206. /* ---------------------------------------------------------- */
14207. 
14208. # your stuff HERE (X)... post zone (file) code.
14209. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
14210. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14211. 	# (X)
14212. 
14213. SetVariable(FileStepDescription,"Zone finished, reporting.")
14214. # Script: DisplaySetFileStep
14215. 
14216. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14217. 
14218. /* add message and move to a new line. */
14219. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14220. ")
14221. 
14222. /* display the line. (hopefully.) */
14223. # Zone Footer Set Statistics Window Text
14224. 
14225. SetStatisticsWindowText("----------------------------------------------------------
14226. Zones Processed: 
14227. ----------------------------------------------------------
14228. !ZoneListByLine!
14229. ----------------------------------------------------------
14230. Zone Processing Step:
14231. !ZoneStepByLine!    
14232. ----------------------------------------------------------
14233. Current Zone:
14234. !ZoneFooter!
14235. ----------------------------------------------------------
14236. Volume Statistics:
14237. !VolumeStatisticsDetail!
14238. ----------------------------------------------------------
14239. Zone Detailed Report:
14240. ----------------------------------------------------------
14241. !ZoneStatisticsDetail!
14242. ----------------------------------------------------------
14243. ")
14244. 
14245. 
14246. 
14247. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14248. 
14249. # Script: BannerSet
14250. 
14251. # Script: DisplaySetDateTimeRun
14252. 
14253. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
14254. /* Xinclude "..\Display\BannerSet.MyDc"X */
14255. /* pause(1) */
14256. 
14257. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14258. 
14259. Title('!Heading!')
14260. /* pause(1) */
14261. 
14262. /* NOTE: Can't round or truncate to integer precision. */
14263. 
14264. pause(1)
14265. 
14266. # Script: ZoneWhenFinished
14267. 
14268. # Script: BannerSet
14269. 
14270. # Script: DisplaySetDateTimeRun
14271. 
14272. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
14273. /* Xinclude "..\Display\BannerSet.MyDc"X */
14274. /* pause(1) */
14275. 
14276. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14277. 
14278. Title('!Heading!')
14279. /* pause(1) */
14280. 
14281. /* NOTE: Can't round or truncate to integer precision. */
14282. 
14283. # Script: BannerLog
14284. 
14285. AppendLogfile("!LogFileName!", "!Title!")
14286. 
14287. 
14288. 
14289. # Zone Statistics	
14290. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
14291. 
14292. # Footer:
14293. SetVariable(ZoneFooter, "----------------------------------------------------------
14294. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
14295. 
14296. Statistics Report:
14297. ------------------
14298.    Size:  
14299.    ------------------------
14300.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14301.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14302.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14303. 
14304.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14305.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14306. 
14307.    Location:
14308.    ------------------------
14309.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14310.              Files End: !ZoneEndCurrent!
14311.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14312.       
14313.    Gap Settings:
14314.    ------------------------
14315.          Gap Requested: !ZoneGapSizePer!%
14316.       Volume Rounding: !ZoneVolRoundUpPer!%
14317.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14318.                  
14319.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
14320.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
14321.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
14322.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
14323.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
14324.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
14325.      
14326.    Free Space after Zone:
14327.    ------------------------
14328.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14329.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14330.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14331. 
14332. Directory and Files Select:
14333. ---------------------------
14334. !ZoneTypeSelectCurrent!               
14335. ---------------------------
14336. ----------------------------------------------------------
14337. ")
14338. 
14339. AppendLogfile("!LogFileName!", ".")
14340. AppendLogfile("!LogFileName!", "!ZoneFooter!")
14341. AppendLogfile("!LogFileName!", ".")
14342. 
14343. # Zone Footer Set Statistics Window Text
14344. 
14345. SetStatisticsWindowText("----------------------------------------------------------
14346. Zones Processed: 
14347. ----------------------------------------------------------
14348. !ZoneListByLine!
14349. ----------------------------------------------------------
14350. Zone Processing Step:
14351. !ZoneStepByLine!    
14352. ----------------------------------------------------------
14353. Current Zone:
14354. !ZoneFooter!
14355. ----------------------------------------------------------
14356. Volume Statistics:
14357. !VolumeStatisticsDetail!
14358. ----------------------------------------------------------
14359. Zone Detailed Report:
14360. ----------------------------------------------------------
14361. !ZoneStatisticsDetail!
14362. ----------------------------------------------------------
14363. ")
14364. 
14365. 
14366. 
14367. /* pause() */
14368. /* pause() */
14369. 
14370. 
14371. 
14372. 
14373. /* ---------------------------------------------------------- */
14374. 
14375. 
14376. /* ---------------------------------------------------------- */
14377. /* Zone People */
14378. # Script: DefragZoneTypePeople
14379. /* ---------------------------------------------------------- */
14380. /* Zone People */
14381. SetVariable(ZoneLabel, "!ZoneLabelPeople!")
14382. SetVariable(ZoneDescription, "!ZoneDescriptionPeople!")
14383. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpPeople!")
14384. SetVariable(ZoneGapSize, "!ZoneGapSizePeople!")
14385. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectPeople
14386. # People start.
14387. # NotBlobsArchivesBu start.
14388. (not (
14389. # Blobs start.
14390. (
14391. # BlobsAndExceptions start.
14392. ( not(
14393.   FileName("*.bat")
14394.   or FileName("*.css")
14395.   or FileName("*.dll")
14396.   or FileName("*.exe")
14397.   or FileName("*.htm*")
14398.   or FileName("*.jar")
14399.   or FileName("*.js")
14400.   or FileName("*.script")
14401.   or FileName("*.wsf")
14402.   or (
14403. # Databases start.
14404. (
14405.   FileName("*.crypt*")
14406.   or FileName("*.db*")
14407.   or FileName("*.rdb*")
14408.   or FileName("*.dc*")
14409.   or FileName("*.dict*")
14410.   or FileName("*.?db*")
14411.   or FileName("*.?rdb*")
14412.   or FileName("*.md*")
14413.   or FileName("*.myd")
14414.   or FileName("*.ndf")
14415.   or FileName("*.ns?")
14416.   or FileName("*.pab")
14417.   or FileName("*.pst")
14418.   or FileName("*.sd?*")
14419.   or FileName("*.sq**")
14420.   or FileName("*.tmd")
14421.   or FileName("*.tps")
14422.   or FileName("*.tr*")
14423. )
14424. # Databases end.
14425. 
14426.     # BlobsAndExceptions
14427.     or 
14428. # Data start.
14429. (
14430.   DirectoryName("Data*")
14431.   or DirectoryName("Device*")
14432.   or DirectoryName("Export*")
14433.   or DirectoryName("Import*")
14434.   or DirectoryName("Log*")
14435.   or DirectoryName("*Log")
14436.   or DirectoryName("Maintenance*")
14437.   or DirectoryName("Rec*")
14438.   or DirectoryName("Sales*")
14439.   or DirectoryName("Search*")
14440.   or DirectoryName("User*")
14441. )
14442. # Data end.
14443. 
14444.     # BlobsAndExceptions
14445.   )
14446. ) )
14447. # BlobsAndExceptions end.
14448. 
14449. # Blobs
14450. ) and (
14451.   Size(BlobFileSize,0)
14452.   or (
14453.     FileName("*.arj")
14454.     or FileName("*.bup")
14455.     or FileName("*.bz2")
14456.     or FileName("*.chm")
14457.     or FileName("*.dvr-ms")
14458.     or FileName("*.gz")
14459.     or FileName("*.ifo")
14460.     or FileName("*.lzh")
14461.     or FileName("*.pdf")
14462.     or FileName("*.rpm")
14463.     or FileName("*.wmv")
14464.     or FileName("*.vob")
14465.     or FileName("*.z")
14466.   ) 
14467. )
14468. # Blobs end.
14469. 
14470. # NotBlobsArchivesBu
14471. or 
14472. # Archives start.
14473. (
14474.   DirectoryName("*Archive*")
14475.   or DirectoryName("*History*")
14476.   or DirectoryName("*Old")
14477.   or DirectoryName("* Old *")
14478.   or DirectoryName("Old *")
14479. 
14480.   or FileName("*.7z")
14481.   or FileName("*.cab")
14482.   or FileName("*.iso")
14483.   or FileName("*.msi")
14484.   or FileName("*.old")
14485.   or FileName("*.rar")
14486.   or FileName("*.tar")
14487.   or FileName("*.zip")
14488.   or
14489. # WinSysLow start.
14490. (
14491.   DirectoryName("$*")
14492.   or DirectoryName("0*")
14493.   or DirectoryName("1*")
14494.   or DirectoryName("2*")
14495.   or DirectoryName("3*")
14496.   or DirectoryName("4*")
14497.   or DirectoryName("5*")
14498.   or DirectoryName("6*")
14499.   or DirectoryName("7*")
14500.   or DirectoryName("8*")
14501.   or DirectoryName("9*")
14502. 
14503.   or DirectoryName("dllcache")
14504.   or DirectoryName("Downloaded Installations")
14505.   or DirectoryName("Ehome")
14506.   or DirectoryName("Fonts")
14507.   or DirectoryName("Help")
14508.   or DirectoryName("I386")
14509.   or DirectoryName("ie?updates")
14510.   or DirectoryName("Installer")
14511.   or DirectoryName("Installshield Installation Information")
14512.   or DirectoryName("IME")
14513.   or DirectoryName("*RECYCLE*")
14514.   or DirectoryName("ServicePackFiles")
14515.   or DirectoryName("SoftwareDistribution")
14516.   or DirectoryName("Speech")
14517.   or DirectoryName("Symbols")
14518.   or DirectoryName("System Volume Information")
14519.   or DirectoryName("windows.old")
14520. )
14521. # WinSysLow end.
14522. 
14523.   # Archives
14524. )
14525. # Archives end.
14526. 
14527. # NotBlobsArchivesBu
14528. or
14529. # Backups start.
14530. (
14531.   DirectoryName("*Backup*")
14532.   or DirectoryName("*Bu")
14533.   or DirectoryName("* Bu *")
14534.   or DirectoryName("Bu *")
14535. 
14536.   or FileName("*.bak")
14537.   or FileName("* - Copy*")
14538. )
14539. # Backups end.
14540. 
14541. # NotBlobsArchivesBu
14542. ) )
14543. # NotBlobsArchivesBu end.
14544. 
14545. # People
14546. and (
14547. # People start.
14548. (
14549.   DirectoryName("*Capture*")
14550.   or DirectoryName("*Document*")
14551.   or DirectoryName("*Download*")
14552.   or DirectoryName("*Kids*")
14553.   or DirectoryName("Mail*")
14554.   or DirectoryName("*Mail")
14555.   or DirectoryName("My*")
14556.   or DirectoryName("*Person*")
14557.   or DirectoryName("Private*")
14558.   or DirectoryName("Users")
14559.   
14560.   # Individual People HERE:
14561.   or DirectoryName("Dgh*")
14562. )
14563. # People end.
14564. 
14565. # People
14566. )
14567. # People end.
14568. ')
14569. 
14570. 	# Script: ZoneDoHeader
14571. 
14572. # Script: ZoneWhenStarted
14573. 
14574. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
14575. # Script: DisplaySetZone
14576. 
14577. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
14578. SetVariable(FileStepDescription,	"")
14579. 
14580. SetVariable(ZoneStepByLine, 			"Zone started.
14581. ")
14582. 
14583. # Script: BannerDescriptionSet
14584. 
14585. # Script: BannerSet
14586. 
14587. # Script: DisplaySetDateTimeRun
14588. 
14589. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
14590. /* Xinclude "..\Display\BannerSet.MyDc"X */
14591. /* pause(1) */
14592. 
14593. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14594. 
14595. Title('!Heading!')
14596. /* pause(1) */
14597. 
14598. /* NOTE: Can't round or truncate to integer precision. */
14599. 
14600. # Script: BannerLog
14601. 
14602. AppendLogfile("!LogFileName!", "!Title!")
14603. 
14604. 
14605. 
14606. pause(1)
14607. 
14608. 
14609. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
14610. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
14611. 
14612. SetVariable(ZoneStepNoCurrent, 0)
14613. 
14614. 
14615. # Script: ZoneDoCurrentClear
14616. 
14617. SetVariable(ZoneTypeSelectCurrent, 		"")
14618. 
14619. SetVariable(ZoneBeginCurrent, 			0)
14620. SetVariable(ZoneBeginPerCurrent, 		0)
14621. SetVariable(ZoneEndCurrent, 			0)
14622. SetVariable(ZoneEndPerCurrent, 			0)
14623. 
14624. SetVariable(ZoneSizeCurrent,			0)
14625. SetVariable(ZoneSizePerCurrent,			0)
14626. 
14627. SetVariable(ZoneGapRequestedCurrent,	0)
14628. SetVariable(ZoneGapRoundedCurrent, 		0)
14629. SetVariable(ZoneGapAdjustedCurrent, 	0)
14630. SetVariable(ZoneGapAvailableCurrent, 	0)
14631. SetVariable(ZoneGapCurrent,				0)
14632. SetVariable(ZoneGapUsedCurrent, 		0)
14633. 
14634. SetVariable(ZoneGapActualCurrent, 		0)
14635. SetVariable(ZoneGapActualPerCurrent, 	0)
14636. 
14637. SetVariable(ZoneSizeActual, 			0)
14638. SetVariable(ZoneSizeActualCurrent,		0)
14639. 
14640. SetVariable(ZoneEndActual, 				0)
14641. SetVariable(ZoneEndActualCurrent,		0)			
14642. SetVariable(ZoneSizeActualPerCurrent, 	0)
14643.       
14644. SetVariable(ZoneFilesFolders,			0)
14645. SetVariable(ZoneFilesFoldersPer,		0) 
14646. 
14647. SetVariable(ZoneFragments,				0)
14648. SetVariable(ZoneFragmentsPer,			0) 
14649. 		
14650. SetVariable(ZoneEndActualCurrent, 		0)
14651. SetVariable(ZoneEndActualPerCurrent, 	0)
14652. 
14653. # Gap Calculation Methodology:
14654. 	# Requested
14655. 	SetVariable(GapRequested, 			0) 
14656. 	SetVariable(GapRequestedStd, 		0) 
14657. 	SetVariable(GapRequestedMft, 		0) 
14658. 	SetVariable(GapRequestedOs, 		0) 
14659. 	SetVariable(GapRequestedOriginal, 	0) 
14660. 	
14661. 	# Gap Adjustments
14662. 	SetVariable(GapRounded, 			0)
14663. 	# SetVariable(GapAdjusted, 			0)
14664. 	SetVariable(GapAvailable, 			0)
14665. 	SetVariable(GapCurrent, 			0)
14666. 	SetVariable(GapActual, 				0)
14667. 	SetVariable(GapUsed, 				0)
14668. 	
14669. 	# Gap Adjustments
14670. 	SetVariable(GapRoundedLoc, 			0)
14671. 	# SetVariable(GapAdjustedLoc, 		0)
14672. 	SetVariable(GapAvailableLoc, 		0)
14673. 	SetVariable(GapCurrentLoc, 			0)
14674. 	SetVariable(GapActualLoc,			0)
14675. 	SetVariable(GapUsedLoc,				0)
14676. 	
14677. 	# Space usage
14678. 	SetVariable(ZoneFreePerRequested, 	0)
14679. 	SetVariable(ZoneFreePerUsed, 		0)
14680. 
14681. # Gap Size & Rounding
14682. 	SetVariable(ZoneGapSizePer, 		0)
14683. 	SetVariable(ZoneVolRoundUpPer, 		0)
14684. 	
14685. 	# Free Space
14686. 	SetVariable(ZoneFreeUsedPer, 		0)
14687. 	SetVariable(ZoneFreeRequestedPer, 	0)
14688. 
14689. 
14690. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
14691. 
14692. # Footer:
14693. SetVariable(ZoneFooter, "----------------------------------------------------------
14694. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
14695. 
14696. Statistics Report:
14697. ------------------
14698.    Size:  
14699.    ------------------------
14700.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14701.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14702.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14703. 
14704.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14705.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14706. 
14707.    Location:
14708.    ------------------------
14709.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14710.              Files End: !ZoneEndCurrent!
14711.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14712.       
14713.    Gap Settings:
14714.    ------------------------
14715.          Gap Requested: !ZoneGapSizePer!%
14716.       Volume Rounding: !ZoneVolRoundUpPer!%
14717.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14718.                  
14719.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
14720.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
14721.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
14722.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
14723.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
14724.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
14725.      
14726.    Free Space after Zone:
14727.    ------------------------
14728.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14729.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14730.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14731. 
14732. Directory and Files Select:
14733. ---------------------------
14734. !ZoneTypeSelectCurrent!               
14735. ---------------------------
14736. ----------------------------------------------------------
14737. ")
14738. 
14739. # Script: BannerSet
14740. 
14741. # Script: DisplaySetDateTimeRun
14742. 
14743. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
14744. /* Xinclude "..\Display\BannerSet.MyDc"X */
14745. /* pause(1) */
14746. 
14747. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14748. 
14749. Title('!Heading!')
14750. /* pause(1) */
14751. 
14752. /* NOTE: Can't round or truncate to integer precision. */
14753. 
14754. # Script: BannerLog
14755. 
14756. AppendLogfile("!LogFileName!", "!Title!")
14757. 
14758. 
14759. 
14760. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
14761. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
14762. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:45")
14763. 
14764. SetVariable(ZoneListByLine, "!ZoneListByLine!
14765. Zone: !ZoneNoCurrent! 2021-11-09 20:22:45 0:00:04 !ZoneLabel! !ZoneDescription!")
14766. 
14767. 
14768. /* Fixed Zone Position Handling */
14769. /* Literal number: */
14770. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
14771. /* Percentage of disk: */
14772. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
14773. /* Gap */
14774. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
14775. 
14776. /* ---------------------------------------------------------- */
14777. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
14778. # Script: DisplaySetFileStep
14779. 
14780. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14781. 
14782. /* add message and move to a new line. */
14783. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14784. ")
14785. 
14786. /* display the line. (hopefully.) */
14787. # Zone Footer Set Statistics Window Text
14788. 
14789. SetStatisticsWindowText("----------------------------------------------------------
14790. Zones Processed: 
14791. ----------------------------------------------------------
14792. !ZoneListByLine!
14793. ----------------------------------------------------------
14794. Zone Processing Step:
14795. !ZoneStepByLine!    
14796. ----------------------------------------------------------
14797. Current Zone:
14798. !ZoneFooter!
14799. ----------------------------------------------------------
14800. Volume Statistics:
14801. !VolumeStatisticsDetail!
14802. ----------------------------------------------------------
14803. Zone Detailed Report:
14804. ----------------------------------------------------------
14805. !ZoneStatisticsDetail!
14806. ----------------------------------------------------------
14807. ")
14808. 
14809. 
14810. 
14811. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14812. 
14813. # Script: BannerSet
14814. 
14815. # Script: DisplaySetDateTimeRun
14816. 
14817. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
14818. /* Xinclude "..\Display\BannerSet.MyDc"X */
14819. /* pause(1) */
14820. 
14821. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14822. 
14823. Title('!Heading!')
14824. /* pause(1) */
14825. 
14826. /* NOTE: Can't round or truncate to integer precision. */
14827. 
14828. pause(1)
14829. 
14830. # your stuff HERE (X)... pre file select code.
14831. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
14832. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14833. 	# (X)
14834. 
14835. FileSelect
14836. 
14837. 	# your stuff can't really go here (errors.)
14838. 	# maybe for some reason I don't know of...
14839. 	
14840. 	# Actions next...
14841. 	# Script: ZoneDo ZoneTypeSelectPeople
14842. # People start.
14843. # NotBlobsArchivesBu start.
14844. (not (
14845. # Blobs start.
14846. (
14847. # BlobsAndExceptions start.
14848. ( not(
14849.   FileName("*.bat")
14850.   or FileName("*.css")
14851.   or FileName("*.dll")
14852.   or FileName("*.exe")
14853.   or FileName("*.htm*")
14854.   or FileName("*.jar")
14855.   or FileName("*.js")
14856.   or FileName("*.script")
14857.   or FileName("*.wsf")
14858.   or (
14859. # Databases start.
14860. (
14861.   FileName("*.crypt*")
14862.   or FileName("*.db*")
14863.   or FileName("*.rdb*")
14864.   or FileName("*.dc*")
14865.   or FileName("*.dict*")
14866.   or FileName("*.?db*")
14867.   or FileName("*.?rdb*")
14868.   or FileName("*.md*")
14869.   or FileName("*.myd")
14870.   or FileName("*.ndf")
14871.   or FileName("*.ns?")
14872.   or FileName("*.pab")
14873.   or FileName("*.pst")
14874.   or FileName("*.sd?*")
14875.   or FileName("*.sq**")
14876.   or FileName("*.tmd")
14877.   or FileName("*.tps")
14878.   or FileName("*.tr*")
14879. )
14880. # Databases end.
14881. 
14882.     # BlobsAndExceptions
14883.     or 
14884. # Data start.
14885. (
14886.   DirectoryName("Data*")
14887.   or DirectoryName("Device*")
14888.   or DirectoryName("Export*")
14889.   or DirectoryName("Import*")
14890.   or DirectoryName("Log*")
14891.   or DirectoryName("*Log")
14892.   or DirectoryName("Maintenance*")
14893.   or DirectoryName("Rec*")
14894.   or DirectoryName("Sales*")
14895.   or DirectoryName("Search*")
14896.   or DirectoryName("User*")
14897. )
14898. # Data end.
14899. 
14900.     # BlobsAndExceptions
14901.   )
14902. ) )
14903. # BlobsAndExceptions end.
14904. 
14905. # Blobs
14906. ) and (
14907.   Size(BlobFileSize,0)
14908.   or (
14909.     FileName("*.arj")
14910.     or FileName("*.bup")
14911.     or FileName("*.bz2")
14912.     or FileName("*.chm")
14913.     or FileName("*.dvr-ms")
14914.     or FileName("*.gz")
14915.     or FileName("*.ifo")
14916.     or FileName("*.lzh")
14917.     or FileName("*.pdf")
14918.     or FileName("*.rpm")
14919.     or FileName("*.wmv")
14920.     or FileName("*.vob")
14921.     or FileName("*.z")
14922.   ) 
14923. )
14924. # Blobs end.
14925. 
14926. # NotBlobsArchivesBu
14927. or 
14928. # Archives start.
14929. (
14930.   DirectoryName("*Archive*")
14931.   or DirectoryName("*History*")
14932.   or DirectoryName("*Old")
14933.   or DirectoryName("* Old *")
14934.   or DirectoryName("Old *")
14935. 
14936.   or FileName("*.7z")
14937.   or FileName("*.cab")
14938.   or FileName("*.iso")
14939.   or FileName("*.msi")
14940.   or FileName("*.old")
14941.   or FileName("*.rar")
14942.   or FileName("*.tar")
14943.   or FileName("*.zip")
14944.   or
14945. # WinSysLow start.
14946. (
14947.   DirectoryName("$*")
14948.   or DirectoryName("0*")
14949.   or DirectoryName("1*")
14950.   or DirectoryName("2*")
14951.   or DirectoryName("3*")
14952.   or DirectoryName("4*")
14953.   or DirectoryName("5*")
14954.   or DirectoryName("6*")
14955.   or DirectoryName("7*")
14956.   or DirectoryName("8*")
14957.   or DirectoryName("9*")
14958. 
14959.   or DirectoryName("dllcache")
14960.   or DirectoryName("Downloaded Installations")
14961.   or DirectoryName("Ehome")
14962.   or DirectoryName("Fonts")
14963.   or DirectoryName("Help")
14964.   or DirectoryName("I386")
14965.   or DirectoryName("ie?updates")
14966.   or DirectoryName("Installer")
14967.   or DirectoryName("Installshield Installation Information")
14968.   or DirectoryName("IME")
14969.   or DirectoryName("*RECYCLE*")
14970.   or DirectoryName("ServicePackFiles")
14971.   or DirectoryName("SoftwareDistribution")
14972.   or DirectoryName("Speech")
14973.   or DirectoryName("Symbols")
14974.   or DirectoryName("System Volume Information")
14975.   or DirectoryName("windows.old")
14976. )
14977. # WinSysLow end.
14978. 
14979.   # Archives
14980. )
14981. # Archives end.
14982. 
14983. # NotBlobsArchivesBu
14984. or
14985. # Backups start.
14986. (
14987.   DirectoryName("*Backup*")
14988.   or DirectoryName("*Bu")
14989.   or DirectoryName("* Bu *")
14990.   or DirectoryName("Bu *")
14991. 
14992.   or FileName("*.bak")
14993.   or FileName("* - Copy*")
14994. )
14995. # Backups end.
14996. 
14997. # NotBlobsArchivesBu
14998. ) )
14999. # NotBlobsArchivesBu end.
15000. 
15001. # People
15002. and (
15003. # People start.
15004. (
15005.   DirectoryName("*Capture*")
15006.   or DirectoryName("*Document*")
15007.   or DirectoryName("*Download*")
15008.   or DirectoryName("*Kids*")
15009.   or DirectoryName("Mail*")
15010.   or DirectoryName("*Mail")
15011.   or DirectoryName("My*")
15012.   or DirectoryName("*Person*")
15013.   or DirectoryName("Private*")
15014.   or DirectoryName("Users")
15015.   
15016.   # Individual People HERE:
15017.   or DirectoryName("Dgh*")
15018. )
15019. # People end.
15020. 
15021. # People
15022. )
15023. # People end.
15024. 
15025. 	# Script: ZoneDoAction
15026. # Zone Do File Action - SortByName.
15027. 
15028. FileActions
15029. 
15030. 	# Footer:
15031. SetVariable(ZoneFooter, "----------------------------------------------------------
15032. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
15033. 
15034. Statistics Report:
15035. ------------------
15036.    Size:  
15037.    ------------------------
15038.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15039.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15040.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15041. 
15042.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15043.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15044. 
15045.    Location:
15046.    ------------------------
15047.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15048.              Files End: !ZoneEndCurrent!
15049.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15050.       
15051.    Gap Settings:
15052.    ------------------------
15053.          Gap Requested: !ZoneGapSizePer!%
15054.       Volume Rounding: !ZoneVolRoundUpPer!%
15055.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15056.                  
15057.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15058.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15059.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15060.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15061.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15062.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15063.      
15064.    Free Space after Zone:
15065.    ------------------------
15066.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15067.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15068.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15069. 
15070. Directory and Files Select:
15071. ---------------------------
15072. !ZoneTypeSelectCurrent!               
15073. ---------------------------
15074. ----------------------------------------------------------
15075. ")
15076. 	SetStatisticsWindowText("!ZoneFooter!")
15077. 	
15078. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
15079. 	# Script: DisplaySetFileStep
15080. 
15081. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15082. 
15083. /* add message and move to a new line. */
15084. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15085. ")
15086. 
15087. /* display the line. (hopefully.) */
15088. # Zone Footer Set Statistics Window Text
15089. 
15090. SetStatisticsWindowText("----------------------------------------------------------
15091. Zones Processed: 
15092. ----------------------------------------------------------
15093. !ZoneListByLine!
15094. ----------------------------------------------------------
15095. Zone Processing Step:
15096. !ZoneStepByLine!    
15097. ----------------------------------------------------------
15098. Current Zone:
15099. !ZoneFooter!
15100. ----------------------------------------------------------
15101. Volume Statistics:
15102. !VolumeStatisticsDetail!
15103. ----------------------------------------------------------
15104. Zone Detailed Report:
15105. ----------------------------------------------------------
15106. !ZoneStatisticsDetail!
15107. ----------------------------------------------------------
15108. ")
15109. 
15110. 
15111. 
15112. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15113. 
15114. # Script: BannerSet
15115. 
15116. # Script: DisplaySetDateTimeRun
15117. 
15118. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
15119. /* Xinclude "..\Display\BannerSet.MyDc"X */
15120. /* pause(1) */
15121. 
15122. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15123. 
15124. Title('!Heading!')
15125. /* pause(1) */
15126. 
15127. /* NOTE: Can't round or truncate to integer precision. */
15128. 
15129. pause(1)
15130. 
15131. # Commands:
15132. 
15133. /* Moves to Zone or above it. */
15134. # MoveUpToZone()
15135. 
15136. # Defrag
15137. 
15138. # Defragment(OPTIONS)
15139. 
15140. /* Shuffles files around trying to make a big enough gap for fragmented files. */
15141. # Defragment()
15142. 
15143. /* Only does files where a gap will fit it. */
15144. # Defragment(Fast)
15145. 
15146. /* Skips fragmented files larger than the Chunck Size.
15147. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
15148. # Defragment(Chunk Size)
15149. 
15150. /* Moves down to zone and packs zone to beginning if there are gaps. */
15151. /* Can be similar in performance to doing a SortBy. */
15152. # MoveDownFill()
15153. 
15154. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
15155. 
15156. 
15157. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
15158. 	# Script: DisplaySetFileStep
15159. 
15160. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15161. 
15162. /* add message and move to a new line. */
15163. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15164. ")
15165. 
15166. /* display the line. (hopefully.) */
15167. # Zone Footer Set Statistics Window Text
15168. 
15169. SetStatisticsWindowText("----------------------------------------------------------
15170. Zones Processed: 
15171. ----------------------------------------------------------
15172. !ZoneListByLine!
15173. ----------------------------------------------------------
15174. Zone Processing Step:
15175. !ZoneStepByLine!    
15176. ----------------------------------------------------------
15177. Current Zone:
15178. !ZoneFooter!
15179. ----------------------------------------------------------
15180. Volume Statistics:
15181. !VolumeStatisticsDetail!
15182. ----------------------------------------------------------
15183. Zone Detailed Report:
15184. ----------------------------------------------------------
15185. !ZoneStatisticsDetail!
15186. ----------------------------------------------------------
15187. ")
15188. 
15189. 
15190. 
15191. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15192. 
15193. # Script: BannerSet
15194. 
15195. # Script: DisplaySetDateTimeRun
15196. 
15197. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
15198. /* Xinclude "..\Display\BannerSet.MyDc"X */
15199. /* pause(1) */
15200. 
15201. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15202. 
15203. Title('!Heading!')
15204. /* pause(1) */
15205. 
15206. /* NOTE: Can't round or truncate to integer precision. */
15207. 
15208. pause(1)
15209. 
15210. 	# Script: ZoneDoFooter
15211. 
15212. /* ---------------------------------------------------------- */
15213. # File Select
15214. 	# Select Statments
15215. # File Actions 
15216. 	# Standard or OS File Actions.
15217. 	# Resume...
15218. 	
15219. 	# your stuff HERE (X)... post zone (file) file actions code.
15220. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
15221. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15222. 		# (X)
15223. 		
15224. 		/* ??? Set window? */
15225. 	
15226. 	# ADD THE GAP
15227. 		
15228. # Vacate (good for diagnostics)
15229. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
15230. 
15231. # DoNotVacate - DO NOT Vacate (recommended)
15232. 
15233. # Vacate
15234. /* AddGap(GapUsedLoc) */
15235. 
15236. # DO Not Vacate
15237. AddGap(GapUsedLoc, DoNotVacate) 
15238. 	
15239. 	
15240. /* ---------------------------------------------------------- */
15241. # (failed) TEST for boolean logic.
15242. 
15243. /* It should work in the gap calculations for turning options */
15244. /* on and off but it will NOT work here. */
15245. 
15246. /* Boolean setting X or FlagX. */
15247. /* Where X will be on or off: */
15248. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
15249. /*      For ON:  (X  *  FlagAny) */
15250. 
15251. /* 1) Failed, zero gap overrode the previous one. */
15252. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
15253. /* AddGap(GapUsedTemp) */ 
15254. 
15255. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
15256. /* AddGap(GapUsedTemp, DoNotVacate) */ 
15257. 
15258. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
15259. 
15260. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
15261. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
15262. /* AddGap(GapUsedTemp) */ 
15263. 
15264. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
15265. /* AddGap(GapUsedTemp, DoNotVacate) */ 
15266. 
15267. /* ---------------------------------------------------------- */
15268. 
15269. # Vacate
15270. /* AddGap(GapUsed) */
15271. 
15272. # DO NOT Vacate (recommended)
15273. /* AddGap(GapUsed, DoNotVacate) */ 
15274. 	
15275. 
15276. 		
15277. # 
15278. FileEnd
15279. /* ---------------------------------------------------------- */
15280. 
15281. # your stuff HERE (X)... post zone (file) code.
15282. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
15283. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15284. 	# (X)
15285. 
15286. SetVariable(FileStepDescription,"Zone finished, reporting.")
15287. # Script: DisplaySetFileStep
15288. 
15289. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15290. 
15291. /* add message and move to a new line. */
15292. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15293. ")
15294. 
15295. /* display the line. (hopefully.) */
15296. # Zone Footer Set Statistics Window Text
15297. 
15298. SetStatisticsWindowText("----------------------------------------------------------
15299. Zones Processed: 
15300. ----------------------------------------------------------
15301. !ZoneListByLine!
15302. ----------------------------------------------------------
15303. Zone Processing Step:
15304. !ZoneStepByLine!    
15305. ----------------------------------------------------------
15306. Current Zone:
15307. !ZoneFooter!
15308. ----------------------------------------------------------
15309. Volume Statistics:
15310. !VolumeStatisticsDetail!
15311. ----------------------------------------------------------
15312. Zone Detailed Report:
15313. ----------------------------------------------------------
15314. !ZoneStatisticsDetail!
15315. ----------------------------------------------------------
15316. ")
15317. 
15318. 
15319. 
15320. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15321. 
15322. # Script: BannerSet
15323. 
15324. # Script: DisplaySetDateTimeRun
15325. 
15326. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
15327. /* Xinclude "..\Display\BannerSet.MyDc"X */
15328. /* pause(1) */
15329. 
15330. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15331. 
15332. Title('!Heading!')
15333. /* pause(1) */
15334. 
15335. /* NOTE: Can't round or truncate to integer precision. */
15336. 
15337. pause(1)
15338. 
15339. # Script: ZoneWhenFinished
15340. 
15341. # Script: BannerSet
15342. 
15343. # Script: DisplaySetDateTimeRun
15344. 
15345. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
15346. /* Xinclude "..\Display\BannerSet.MyDc"X */
15347. /* pause(1) */
15348. 
15349. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15350. 
15351. Title('!Heading!')
15352. /* pause(1) */
15353. 
15354. /* NOTE: Can't round or truncate to integer precision. */
15355. 
15356. # Script: BannerLog
15357. 
15358. AppendLogfile("!LogFileName!", "!Title!")
15359. 
15360. 
15361. 
15362. # Zone Statistics	
15363. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
15364. 
15365. # Footer:
15366. SetVariable(ZoneFooter, "----------------------------------------------------------
15367. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
15368. 
15369. Statistics Report:
15370. ------------------
15371.    Size:  
15372.    ------------------------
15373.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15374.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15375.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15376. 
15377.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15378.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15379. 
15380.    Location:
15381.    ------------------------
15382.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15383.              Files End: !ZoneEndCurrent!
15384.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15385.       
15386.    Gap Settings:
15387.    ------------------------
15388.          Gap Requested: !ZoneGapSizePer!%
15389.       Volume Rounding: !ZoneVolRoundUpPer!%
15390.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15391.                  
15392.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15393.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15394.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15395.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15396.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15397.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15398.      
15399.    Free Space after Zone:
15400.    ------------------------
15401.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15402.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15403.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15404. 
15405. Directory and Files Select:
15406. ---------------------------
15407. !ZoneTypeSelectCurrent!               
15408. ---------------------------
15409. ----------------------------------------------------------
15410. ")
15411. 
15412. AppendLogfile("!LogFileName!", ".")
15413. AppendLogfile("!LogFileName!", "!ZoneFooter!")
15414. AppendLogfile("!LogFileName!", ".")
15415. 
15416. # Zone Footer Set Statistics Window Text
15417. 
15418. SetStatisticsWindowText("----------------------------------------------------------
15419. Zones Processed: 
15420. ----------------------------------------------------------
15421. !ZoneListByLine!
15422. ----------------------------------------------------------
15423. Zone Processing Step:
15424. !ZoneStepByLine!    
15425. ----------------------------------------------------------
15426. Current Zone:
15427. !ZoneFooter!
15428. ----------------------------------------------------------
15429. Volume Statistics:
15430. !VolumeStatisticsDetail!
15431. ----------------------------------------------------------
15432. Zone Detailed Report:
15433. ----------------------------------------------------------
15434. !ZoneStatisticsDetail!
15435. ----------------------------------------------------------
15436. ")
15437. 
15438. 
15439. 
15440. /* pause() */
15441. /* pause() */
15442. 
15443. 
15444. 
15445. 
15446. /* ---------------------------------------------------------- */
15447. 
15448. 
15449. /* ---------------------------------------------------------- */
15450. // "4" & "5" now 8 & 9
15451. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
15452. /* Process MFT & Dir's HERE. */
15453. 	SetVariable(FileStepDescription,"Calculating Gap for MFT and DIR.")
15454. # Script: BannerDescriptionSet
15455. 
15456. # Script: BannerSet
15457. 
15458. # Script: DisplaySetDateTimeRun
15459. 
15460. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
15461. /* Xinclude "..\Display\BannerSet.MyDc"X */
15462. /* pause(1) */
15463. 
15464. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15465. 
15466. Title('!Heading!')
15467. /* pause(1) */
15468. 
15469. /* NOTE: Can't round or truncate to integer precision. */
15470. 
15471. # Script: BannerLog
15472. 
15473. AppendLogfile("!LogFileName!", "!Title!")
15474. 
15475. 
15476. 
15477. 
15478. AppendLogfile("!LogFileName!", "MftLocation: !MftLocation! DoNotVacate 2021-11-09 20:22:45")
15479. 
15480. SetVariable(MftGapSlack, MftLocation - VolumeUsedTotal)
15481. AppendLogfile("!LogFileName!", "MftGapSlack: !MftGapSlack!")
15482. 
15483. SetVariable(MftGapSlackPerUsed, MftGapSlack / VolumeFreeAdj)
15484. AppendLogfile("!LogFileName!", "MftGapSlackPerUsed: !MftGapSlackPerUsed!")
15485. 
15486. AppendLogfile("!LogFileName!", "VolumeUsed before: !VolumeUsedTotal!")
15487. SetVariable(VolumeUsedTotal, MftLocation)
15488. AppendLogfile("!LogFileName!", "VolumeUsed at location: !VolumeUsedTotal!")
15489. 
15490. SetVariable(VolumeFreePerUsed, VolumeFreePerUsed + (MftGapSlack / VolumeFree))
15491. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!")
15492. 
15493. /* ---------------------------------------------------------- */
15494. #  MFT
15495. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
15496. 
15497. # Script: DefragZoneTypeOsMft
15498. /* ---------------------------------------------------------- */
15499. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
15500.   
15501. SetVariable(ZoneLabel,				"MFT") // "4" 
15502. SetVariable(ZoneDescription, 		"MFT - Master File Table")
15503. SetVariable(ZoneCurrentAjust, 		1)
15504. /* and some other special NTFS files. */
15505. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpMft!")
15506. SetVariable(ZoneGapSize, 			"!ZoneGapSizeMft!")
15507. SetVariable(ZoneTypeSelect,			'# Script: ZoneDo ZoneTypeSelectOsMFT
15508. # MFT start.
15509. SelectNtfsSystemFiles(yes)
15510. # MFT end.')
15511. 
15512. 	# Script: ZoneDoHeader
15513. 
15514. # Script: ZoneWhenStarted
15515. 
15516. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
15517. # Script: DisplaySetZone
15518. 
15519. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
15520. SetVariable(FileStepDescription,	"")
15521. 
15522. SetVariable(ZoneStepByLine, 			"Zone started.
15523. ")
15524. 
15525. # Script: BannerDescriptionSet
15526. 
15527. # Script: BannerSet
15528. 
15529. # Script: DisplaySetDateTimeRun
15530. 
15531. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
15532. /* Xinclude "..\Display\BannerSet.MyDc"X */
15533. /* pause(1) */
15534. 
15535. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15536. 
15537. Title('!Heading!')
15538. /* pause(1) */
15539. 
15540. /* NOTE: Can't round or truncate to integer precision. */
15541. 
15542. # Script: BannerLog
15543. 
15544. AppendLogfile("!LogFileName!", "!Title!")
15545. 
15546. 
15547. 
15548. pause(1)
15549. 
15550. 
15551. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
15552. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
15553. 
15554. SetVariable(ZoneStepNoCurrent, 0)
15555. 
15556. 
15557. # Script: ZoneDoCurrentClear
15558. 
15559. SetVariable(ZoneTypeSelectCurrent, 		"")
15560. 
15561. SetVariable(ZoneBeginCurrent, 			0)
15562. SetVariable(ZoneBeginPerCurrent, 		0)
15563. SetVariable(ZoneEndCurrent, 			0)
15564. SetVariable(ZoneEndPerCurrent, 			0)
15565. 
15566. SetVariable(ZoneSizeCurrent,			0)
15567. SetVariable(ZoneSizePerCurrent,			0)
15568. 
15569. SetVariable(ZoneGapRequestedCurrent,	0)
15570. SetVariable(ZoneGapRoundedCurrent, 		0)
15571. SetVariable(ZoneGapAdjustedCurrent, 	0)
15572. SetVariable(ZoneGapAvailableCurrent, 	0)
15573. SetVariable(ZoneGapCurrent,				0)
15574. SetVariable(ZoneGapUsedCurrent, 		0)
15575. 
15576. SetVariable(ZoneGapActualCurrent, 		0)
15577. SetVariable(ZoneGapActualPerCurrent, 	0)
15578. 
15579. SetVariable(ZoneSizeActual, 			0)
15580. SetVariable(ZoneSizeActualCurrent,		0)
15581. 
15582. SetVariable(ZoneEndActual, 				0)
15583. SetVariable(ZoneEndActualCurrent,		0)			
15584. SetVariable(ZoneSizeActualPerCurrent, 	0)
15585.       
15586. SetVariable(ZoneFilesFolders,			0)
15587. SetVariable(ZoneFilesFoldersPer,		0) 
15588. 
15589. SetVariable(ZoneFragments,				0)
15590. SetVariable(ZoneFragmentsPer,			0) 
15591. 		
15592. SetVariable(ZoneEndActualCurrent, 		0)
15593. SetVariable(ZoneEndActualPerCurrent, 	0)
15594. 
15595. # Gap Calculation Methodology:
15596. 	# Requested
15597. 	SetVariable(GapRequested, 			0) 
15598. 	SetVariable(GapRequestedStd, 		0) 
15599. 	SetVariable(GapRequestedMft, 		0) 
15600. 	SetVariable(GapRequestedOs, 		0) 
15601. 	SetVariable(GapRequestedOriginal, 	0) 
15602. 	
15603. 	# Gap Adjustments
15604. 	SetVariable(GapRounded, 			0)
15605. 	# SetVariable(GapAdjusted, 			0)
15606. 	SetVariable(GapAvailable, 			0)
15607. 	SetVariable(GapCurrent, 			0)
15608. 	SetVariable(GapActual, 				0)
15609. 	SetVariable(GapUsed, 				0)
15610. 	
15611. 	# Gap Adjustments
15612. 	SetVariable(GapRoundedLoc, 			0)
15613. 	# SetVariable(GapAdjustedLoc, 		0)
15614. 	SetVariable(GapAvailableLoc, 		0)
15615. 	SetVariable(GapCurrentLoc, 			0)
15616. 	SetVariable(GapActualLoc,			0)
15617. 	SetVariable(GapUsedLoc,				0)
15618. 	
15619. 	# Space usage
15620. 	SetVariable(ZoneFreePerRequested, 	0)
15621. 	SetVariable(ZoneFreePerUsed, 		0)
15622. 
15623. # Gap Size & Rounding
15624. 	SetVariable(ZoneGapSizePer, 		0)
15625. 	SetVariable(ZoneVolRoundUpPer, 		0)
15626. 	
15627. 	# Free Space
15628. 	SetVariable(ZoneFreeUsedPer, 		0)
15629. 	SetVariable(ZoneFreeRequestedPer, 	0)
15630. 
15631. 
15632. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
15633. 
15634. # Footer:
15635. SetVariable(ZoneFooter, "----------------------------------------------------------
15636. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
15637. 
15638. Statistics Report:
15639. ------------------
15640.    Size:  
15641.    ------------------------
15642.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15643.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15644.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15645. 
15646.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15647.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15648. 
15649.    Location:
15650.    ------------------------
15651.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15652.              Files End: !ZoneEndCurrent!
15653.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15654.       
15655.    Gap Settings:
15656.    ------------------------
15657.          Gap Requested: !ZoneGapSizePer!%
15658.       Volume Rounding: !ZoneVolRoundUpPer!%
15659.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15660.                  
15661.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15662.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15663.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15664.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15665.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15666.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15667.      
15668.    Free Space after Zone:
15669.    ------------------------
15670.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15671.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15672.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15673. 
15674. Directory and Files Select:
15675. ---------------------------
15676. !ZoneTypeSelectCurrent!               
15677. ---------------------------
15678. ----------------------------------------------------------
15679. ")
15680. 
15681. # Script: BannerSet
15682. 
15683. # Script: DisplaySetDateTimeRun
15684. 
15685. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
15686. /* Xinclude "..\Display\BannerSet.MyDc"X */
15687. /* pause(1) */
15688. 
15689. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15690. 
15691. Title('!Heading!')
15692. /* pause(1) */
15693. 
15694. /* NOTE: Can't round or truncate to integer precision. */
15695. 
15696. # Script: BannerLog
15697. 
15698. AppendLogfile("!LogFileName!", "!Title!")
15699. 
15700. 
15701. 
15702. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
15703. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
15704. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:45")
15705. 
15706. SetVariable(ZoneListByLine, "!ZoneListByLine!
15707. Zone: !ZoneNoCurrent! 2021-11-09 20:22:45 0:00:04 !ZoneLabel! !ZoneDescription!")
15708. 
15709. 
15710. /* Fixed Zone Position Handling */
15711. /* Literal number: */
15712. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
15713. /* Percentage of disk: */
15714. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
15715. /* Gap */
15716. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
15717. 
15718. /* ---------------------------------------------------------- */
15719. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
15720. # Script: DisplaySetFileStep
15721. 
15722. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15723. 
15724. /* add message and move to a new line. */
15725. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15726. ")
15727. 
15728. /* display the line. (hopefully.) */
15729. # Zone Footer Set Statistics Window Text
15730. 
15731. SetStatisticsWindowText("----------------------------------------------------------
15732. Zones Processed: 
15733. ----------------------------------------------------------
15734. !ZoneListByLine!
15735. ----------------------------------------------------------
15736. Zone Processing Step:
15737. !ZoneStepByLine!    
15738. ----------------------------------------------------------
15739. Current Zone:
15740. !ZoneFooter!
15741. ----------------------------------------------------------
15742. Volume Statistics:
15743. !VolumeStatisticsDetail!
15744. ----------------------------------------------------------
15745. Zone Detailed Report:
15746. ----------------------------------------------------------
15747. !ZoneStatisticsDetail!
15748. ----------------------------------------------------------
15749. ")
15750. 
15751. 
15752. 
15753. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15754. 
15755. # Script: BannerSet
15756. 
15757. # Script: DisplaySetDateTimeRun
15758. 
15759. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
15760. /* Xinclude "..\Display\BannerSet.MyDc"X */
15761. /* pause(1) */
15762. 
15763. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15764. 
15765. Title('!Heading!')
15766. /* pause(1) */
15767. 
15768. /* NOTE: Can't round or truncate to integer precision. */
15769. 
15770. pause(1)
15771. 
15772. # your stuff HERE (X)... pre file select code.
15773. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
15774. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15775. 	# (X)
15776. 
15777. FileSelect
15778. 
15779. 	# your stuff can't really go here (errors.)
15780. 	# maybe for some reason I don't know of...
15781. 	
15782. 	# Actions next...
15783. 	# Script: ZoneDo ZoneTypeSelectOsMFT
15784. # MFT start.
15785. SelectNtfsSystemFiles(yes)
15786. # MFT end.
15787. 	
15788. 	FileActions
15789. 	  		/* ---------------------------------------------------------- */
15790. 	# Gap
15791. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
15792. 		# Script: DisplaySetFileStep
15793. 
15794. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15795. 
15796. /* add message and move to a new line. */
15797. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15798. ")
15799. 
15800. /* display the line. (hopefully.) */
15801. # Zone Footer Set Statistics Window Text
15802. 
15803. SetStatisticsWindowText("----------------------------------------------------------
15804. Zones Processed: 
15805. ----------------------------------------------------------
15806. !ZoneListByLine!
15807. ----------------------------------------------------------
15808. Zone Processing Step:
15809. !ZoneStepByLine!    
15810. ----------------------------------------------------------
15811. Current Zone:
15812. !ZoneFooter!
15813. ----------------------------------------------------------
15814. Volume Statistics:
15815. !VolumeStatisticsDetail!
15816. ----------------------------------------------------------
15817. Zone Detailed Report:
15818. ----------------------------------------------------------
15819. !ZoneStatisticsDetail!
15820. ----------------------------------------------------------
15821. ")
15822. 
15823. 
15824. 
15825. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15826. 
15827. # Script: BannerSet
15828. 
15829. # Script: DisplaySetDateTimeRun
15830. 
15831. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
15832. /* Xinclude "..\Display\BannerSet.MyDc"X */
15833. /* pause(1) */
15834. 
15835. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15836. 
15837. Title('!Heading!')
15838. /* pause(1) */
15839. 
15840. /* NOTE: Can't round or truncate to integer precision. */
15841. 
15842. pause(1)
15843. 	
15844. 	# ACTUAL GAP
15845. 		/* AddGap Variant. */
15846. 	  	# Zone Do Gap
15847. # Gap Calculation Methods:
15848. 
15849. /* 1) Anything you need to add first. */
15850. /* empty */
15851. 
15852. /* ---------------------------------------------------------- */
15853. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
15854. 	# GapRequestedStd.
15855. 
15856. 		/* ---------------------------------------------------------- */
15857. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
15858. 
15859. 		# Gap Calculation Methods:
15860. 
15861. /* AddGap Variants */
15862. 
15863. 	/* Standard */
15864. 		# Gap Calculation Methods:
15865. 	/* AddGap Variants */
15866. 	/* Standard */
15867. 
15868. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
15869. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
15870. 
15871. 	SetVariable(GapRequested, GapRequestedStd)
15872. 	
15873. 
15874. 	/* MFT Low High Method */
15875. 		# Gap Calculation Methods:
15876. 	/* AddGap Variants */
15877. 	/* MFT Low High Method */
15878. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
15879. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
15880. 	SetVariable(GapRequested, GapRequestedMft)
15881. 	
15882. 
15883. 	/* OS Volume Type Method */
15884. 		# Gap Calculation Methods:
15885. 	/* AddGap Variants */
15886. 	/* OS Volume Type Method */
15887. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
15888. 	SetVariable(GapRequested, GapRequestedOs)
15889. 
15890. 
15891. 
15892. /* MakeGap Variants */
15893. 
15894. 	/* Original Os 1-3 + MFT 2 */
15895. 		# Gap Calculation Methods:
15896. 	/* MakeGap Variants */
15897. 	/* Original Os 1-3 + MFT 2 */
15898. 	/* plus MFT gap placed inline at the dividing zone. */
15899. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
15900. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
15901. 	SetVariable(GapRequested, GapRequestedOrig)
15902. 	
15903. 	
15904. /* Note: You could comment out the ones not in use */
15905. /* However having the data in the log is useful. */
15906. /* Therefore the following line is otherwise needed. */
15907. 
15908. /* Standard used */
15909. 
15910. SetVariable(GapRequested, GapRequestedStd)
15911. 
15912. # Gap Calculation Methods:
15913. 
15914. /* AddGap Variants */
15915. 	/* Standard */
15916. 	/* MFT Low High Method */
15917. 	/* OS Volume Type Method */
15918. 
15919. /* MakeGap Variants */
15920. 	/* Original Os 1-3 + MFT 2 */
15921. 
15922. /* Note: You could comment out the ones not in use */
15923. /* However having the data in the log is useful. */
15924. /* Therefore the following line is otherwise needed. */
15925. 
15926. /* Standard is used currently */
15927. 
15928. 
15929. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
15930. 
15931. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
15932. 
15933. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
15934. 
15935. /* ---------------------------------------------------------- */
15936. /* 3) SMALL ZONE ADJUSTMENT. */
15937. /* Gab cant be larger than half the Zone Size. */
15938. 
15939. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
15940. 	
15941. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
15942. 
15943. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
15944. 
15945. /* ---------------------------------------------------------- */
15946. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
15947. # Gap Adjustments.
15948. 
15949. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
15950. 	
15951. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
15952. 
15953. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
15954. 
15955. /* ---------------------------------------------------------- */
15956. # BYPASS THIS.
15957. 	/* This is definitely wrong. */
15958. 	/* The question is can we steal gap from the next zone */
15959. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
15960. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
15961. 		# Zone Overflow.
15962. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
15963. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
15964. 
15965. /* ---------------------------------------------------------- */
15966. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
15967. # Remaining free space available.
15968. 
15969. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
15970. 	
15971. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
15972. 
15973. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
15974. 
15975. /* ---------------------------------------------------------- */
15976. # CURRENT gap to use.
15977. 
15978. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
15979. 
15980. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
15981. 
15982. /* ---------------------------------------------------------- */
15983. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
15984. # Debugging.
15985. 
15986. 	SetVariable(GapUsed, GapCurrent) // for debugging
15987. 
15988. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
15989. 
15990. 		# Your code HERE
15991. 
15992. /* ---------------------------------------------------------- */
15993. /* 7) YOUR CODE. */
15994. # YOUR CODE HERE:
15995. 	# INPUT: GapCurrent or GapCurrentLoc
15996. 	# OUTPUT: GapUsed...
15997. 
15998. /* ---------------------------------------------------------- */
15999. # Gap Size.
16000. # Actual Size of Gap.
16001. 
16002. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
16003. 
16004. /* ---------------------------------------------------------- */
16005. /* xxxxxxxxxxxxxxxxxxxxxx */
16006. # ADD THE GAP
16007. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
16008. /* xxxxxxxxxxxxxxxxxxxxxx */
16009. 
16010. 	
16011. 	# Zone Statistics	
16012. 	# Script: ZoneDoStatistics
16013. # Zone / Volume Statistics and Display
16014. 		
16015. 	# Accumulate Totals
16016.   	# Script: ZoneDoVolumeTotals
16017. 
16018. /* Current total space used (by Zones and Gaps) */
16019. 
16020. SetVariable(VolumeZoneUsed, GapUsed)
16021. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
16022. /* Percentage */
16023. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
16024. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
16025. 
16026. /* Current total of free space requested */
16027. 
16028. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
16029. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16030. /* Percent. */
16031. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
16032. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16033. 
16034. /* Current total of free space used */
16035. 
16036. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
16037. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
16038. /* Percent */
16039. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
16040. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
16041. 
16042. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
16043. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
16044. /* Xinclude "..\DebugDisplayPause.MyDc"X */
16045. 
16046. 
16047. 	# Current Values
16048. 	# Script: ZoneDoCurrentSet
16049. 
16050. # Cluster, Sector, Block adjust for display.
16051. 	# Bytes per cluster is volume specific.
16052. 
16053. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
16054. 
16055. # Current Zone values.
16056. 	# Begin, end and size.
16057. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
16058. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
16059. 
16060. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
16061. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
16062. 
16063. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
16064. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
16065. 
16066. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
16067. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
16068. 
16069. 	SetVariable(ZoneFragments,				"!ZONE210N!")
16070. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
16071. 		
16072. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
16073. /* identical code to here: (separation not needed. TEST.) */	
16074. 
16075. # Current Gap, Actual and Free Values
16076. 	# Gap
16077. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
16078. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
16079. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
16080. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
16081. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
16082. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
16083. 	
16084. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
16085. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
16086. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
16087. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
16088. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
16089. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
16090. 	
16091. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
16092. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
16093. 	
16094. 	# Actual Size and End
16095. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
16096. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
16097. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
16098. 	
16099. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
16100. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
16101. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
16102. 
16103. # Gap Size & Rounding
16104. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
16105. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
16106. 	
16107. 	# Free Space
16108. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
16109. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
16110. 
16111. 	# Footer:
16112. SetVariable(ZoneFooter, "----------------------------------------------------------
16113. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
16114. 
16115. Statistics Report:
16116. ------------------
16117.    Size:  
16118.    ------------------------
16119.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16120.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16121.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16122. 
16123.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16124.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16125. 
16126.    Location:
16127.    ------------------------
16128.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16129.              Files End: !ZoneEndCurrent!
16130.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16131.       
16132.    Gap Settings:
16133.    ------------------------
16134.          Gap Requested: !ZoneGapSizePer!%
16135.       Volume Rounding: !ZoneVolRoundUpPer!%
16136.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16137.                  
16138.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16139.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16140.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16141.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16142.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16143.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16144.      
16145.    Free Space after Zone:
16146.    ------------------------
16147.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16148.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16149.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16150. 
16151. Directory and Files Select:
16152. ---------------------------
16153. !ZoneTypeSelectCurrent!               
16154. ---------------------------
16155. ----------------------------------------------------------
16156. ")
16157. 	# Zone Footer Set Statistics Window Text
16158. 
16159. SetStatisticsWindowText("----------------------------------------------------------
16160. Zones Processed: 
16161. ----------------------------------------------------------
16162. !ZoneListByLine!
16163. ----------------------------------------------------------
16164. Zone Processing Step:
16165. !ZoneStepByLine!    
16166. ----------------------------------------------------------
16167. Current Zone:
16168. !ZoneFooter!
16169. ----------------------------------------------------------
16170. Volume Statistics:
16171. !VolumeStatisticsDetail!
16172. ----------------------------------------------------------
16173. Zone Detailed Report:
16174. ----------------------------------------------------------
16175. !ZoneStatisticsDetail!
16176. ----------------------------------------------------------
16177. ")
16178. 
16179. 
16180. 	
16181.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
16182. 
16183. 	# Add Zone to list of zones for display.
16184. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
16185. 	# ??? Free Stats?
16186. 	# Footer:
16187. SetVariable(ZoneFooter, "----------------------------------------------------------
16188. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
16189. 
16190. Statistics Report:
16191. ------------------
16192.    Size:  
16193.    ------------------------
16194.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16195.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16196.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16197. 
16198.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16199.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16200. 
16201.    Location:
16202.    ------------------------
16203.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16204.              Files End: !ZoneEndCurrent!
16205.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16206.       
16207.    Gap Settings:
16208.    ------------------------
16209.          Gap Requested: !ZoneGapSizePer!%
16210.       Volume Rounding: !ZoneVolRoundUpPer!%
16211.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16212.                  
16213.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16214.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16215.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16216.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16217.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16218.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16219.      
16220.    Free Space after Zone:
16221.    ------------------------
16222.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16223.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16224.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16225. 
16226. Directory and Files Select:
16227. ---------------------------
16228. !ZoneTypeSelectCurrent!               
16229. ---------------------------
16230. ----------------------------------------------------------
16231. ")
16232. 
16233. 	# Add Zone Details to Report.	
16234. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
16235. !ZoneFooter!")
16236. 
16237. 
16238. 	
16239. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
16240. 		# Script: DisplaySetFileStep
16241. 
16242. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16243. 
16244. /* add message and move to a new line. */
16245. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16246. ")
16247. 
16248. /* display the line. (hopefully.) */
16249. # Zone Footer Set Statistics Window Text
16250. 
16251. SetStatisticsWindowText("----------------------------------------------------------
16252. Zones Processed: 
16253. ----------------------------------------------------------
16254. !ZoneListByLine!
16255. ----------------------------------------------------------
16256. Zone Processing Step:
16257. !ZoneStepByLine!    
16258. ----------------------------------------------------------
16259. Current Zone:
16260. !ZoneFooter!
16261. ----------------------------------------------------------
16262. Volume Statistics:
16263. !VolumeStatisticsDetail!
16264. ----------------------------------------------------------
16265. Zone Detailed Report:
16266. ----------------------------------------------------------
16267. !ZoneStatisticsDetail!
16268. ----------------------------------------------------------
16269. ")
16270. 
16271. 
16272. 
16273. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16274. 
16275. # Script: BannerSet
16276. 
16277. # Script: DisplaySetDateTimeRun
16278. 
16279. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
16280. /* Xinclude "..\Display\BannerSet.MyDc"X */
16281. /* pause(1) */
16282. 
16283. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16284. 
16285. Title('!Heading!')
16286. /* pause(1) */
16287. 
16288. /* NOTE: Can't round or truncate to integer precision. */
16289. 
16290. pause(1)
16291. 	
16292. 		SetVariable(MftZone, ZoneCurrent) 
16293. 
16294. 		# File Action - Type Os MFT - PlaceNtfsSystemFiles.
16295. PlaceNtfsSystemFiles(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes), MftSize * 0.1)
16296. 	
16297. 
16298.   		SetVariable(MftSize,ZoneSize) 
16299. 
16300. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
16301. 		# Script: DisplaySetFileStep
16302. 
16303. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16304. 
16305. /* add message and move to a new line. */
16306. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16307. ")
16308. 
16309. /* display the line. (hopefully.) */
16310. # Zone Footer Set Statistics Window Text
16311. 
16312. SetStatisticsWindowText("----------------------------------------------------------
16313. Zones Processed: 
16314. ----------------------------------------------------------
16315. !ZoneListByLine!
16316. ----------------------------------------------------------
16317. Zone Processing Step:
16318. !ZoneStepByLine!    
16319. ----------------------------------------------------------
16320. Current Zone:
16321. !ZoneFooter!
16322. ----------------------------------------------------------
16323. Volume Statistics:
16324. !VolumeStatisticsDetail!
16325. ----------------------------------------------------------
16326. Zone Detailed Report:
16327. ----------------------------------------------------------
16328. !ZoneStatisticsDetail!
16329. ----------------------------------------------------------
16330. ")
16331. 
16332. 
16333. 
16334. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16335. 
16336. # Script: BannerSet
16337. 
16338. # Script: DisplaySetDateTimeRun
16339. 
16340. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
16341. /* Xinclude "..\Display\BannerSet.MyDc"X */
16342. /* pause(1) */
16343. 
16344. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16345. 
16346. Title('!Heading!')
16347. /* pause(1) */
16348. 
16349. /* NOTE: Can't round or truncate to integer precision. */
16350. 
16351. pause(1)
16352.   	# Script: ZoneDoFooter
16353. 
16354. /* ---------------------------------------------------------- */
16355. # File Select
16356. 	# Select Statments
16357. # File Actions 
16358. 	# Standard or OS File Actions.
16359. 	# Resume...
16360. 	
16361. 	# your stuff HERE (X)... post zone (file) file actions code.
16362. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
16363. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16364. 		# (X)
16365. 		
16366. 		/* ??? Set window? */
16367. 	
16368. 	# ADD THE GAP
16369. 		
16370. # Vacate (good for diagnostics)
16371. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
16372. 
16373. # DoNotVacate - DO NOT Vacate (recommended)
16374. 
16375. # Vacate
16376. /* AddGap(GapUsedLoc) */
16377. 
16378. # DO Not Vacate
16379. AddGap(GapUsedLoc, DoNotVacate) 
16380. 	
16381. 	
16382. /* ---------------------------------------------------------- */
16383. # (failed) TEST for boolean logic.
16384. 
16385. /* It should work in the gap calculations for turning options */
16386. /* on and off but it will NOT work here. */
16387. 
16388. /* Boolean setting X or FlagX. */
16389. /* Where X will be on or off: */
16390. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
16391. /*      For ON:  (X  *  FlagAny) */
16392. 
16393. /* 1) Failed, zero gap overrode the previous one. */
16394. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
16395. /* AddGap(GapUsedTemp) */ 
16396. 
16397. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
16398. /* AddGap(GapUsedTemp, DoNotVacate) */ 
16399. 
16400. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
16401. 
16402. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
16403. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
16404. /* AddGap(GapUsedTemp) */ 
16405. 
16406. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
16407. /* AddGap(GapUsedTemp, DoNotVacate) */ 
16408. 
16409. /* ---------------------------------------------------------- */
16410. 
16411. # Vacate
16412. /* AddGap(GapUsed) */
16413. 
16414. # DO NOT Vacate (recommended)
16415. /* AddGap(GapUsed, DoNotVacate) */ 
16416. 	
16417. 
16418. 		
16419. # 
16420. FileEnd
16421. /* ---------------------------------------------------------- */
16422. 
16423. # your stuff HERE (X)... post zone (file) code.
16424. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
16425. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16426. 	# (X)
16427. 
16428. SetVariable(FileStepDescription,"Zone finished, reporting.")
16429. # Script: DisplaySetFileStep
16430. 
16431. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16432. 
16433. /* add message and move to a new line. */
16434. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16435. ")
16436. 
16437. /* display the line. (hopefully.) */
16438. # Zone Footer Set Statistics Window Text
16439. 
16440. SetStatisticsWindowText("----------------------------------------------------------
16441. Zones Processed: 
16442. ----------------------------------------------------------
16443. !ZoneListByLine!
16444. ----------------------------------------------------------
16445. Zone Processing Step:
16446. !ZoneStepByLine!    
16447. ----------------------------------------------------------
16448. Current Zone:
16449. !ZoneFooter!
16450. ----------------------------------------------------------
16451. Volume Statistics:
16452. !VolumeStatisticsDetail!
16453. ----------------------------------------------------------
16454. Zone Detailed Report:
16455. ----------------------------------------------------------
16456. !ZoneStatisticsDetail!
16457. ----------------------------------------------------------
16458. ")
16459. 
16460. 
16461. 
16462. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16463. 
16464. # Script: BannerSet
16465. 
16466. # Script: DisplaySetDateTimeRun
16467. 
16468. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
16469. /* Xinclude "..\Display\BannerSet.MyDc"X */
16470. /* pause(1) */
16471. 
16472. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16473. 
16474. Title('!Heading!')
16475. /* pause(1) */
16476. 
16477. /* NOTE: Can't round or truncate to integer precision. */
16478. 
16479. pause(1)
16480. 
16481. # Script: ZoneWhenFinished
16482. 
16483. # Script: BannerSet
16484. 
16485. # Script: DisplaySetDateTimeRun
16486. 
16487. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
16488. /* Xinclude "..\Display\BannerSet.MyDc"X */
16489. /* pause(1) */
16490. 
16491. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16492. 
16493. Title('!Heading!')
16494. /* pause(1) */
16495. 
16496. /* NOTE: Can't round or truncate to integer precision. */
16497. 
16498. # Script: BannerLog
16499. 
16500. AppendLogfile("!LogFileName!", "!Title!")
16501. 
16502. 
16503. 
16504. # Zone Statistics	
16505. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
16506. 
16507. # Footer:
16508. SetVariable(ZoneFooter, "----------------------------------------------------------
16509. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
16510. 
16511. Statistics Report:
16512. ------------------
16513.    Size:  
16514.    ------------------------
16515.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16516.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16517.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16518. 
16519.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16520.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16521. 
16522.    Location:
16523.    ------------------------
16524.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16525.              Files End: !ZoneEndCurrent!
16526.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16527.       
16528.    Gap Settings:
16529.    ------------------------
16530.          Gap Requested: !ZoneGapSizePer!%
16531.       Volume Rounding: !ZoneVolRoundUpPer!%
16532.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16533.                  
16534.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16535.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16536.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16537.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16538.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16539.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16540.      
16541.    Free Space after Zone:
16542.    ------------------------
16543.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16544.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16545.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16546. 
16547. Directory and Files Select:
16548. ---------------------------
16549. !ZoneTypeSelectCurrent!               
16550. ---------------------------
16551. ----------------------------------------------------------
16552. ")
16553. 
16554. AppendLogfile("!LogFileName!", ".")
16555. AppendLogfile("!LogFileName!", "!ZoneFooter!")
16556. AppendLogfile("!LogFileName!", ".")
16557. 
16558. # Zone Footer Set Statistics Window Text
16559. 
16560. SetStatisticsWindowText("----------------------------------------------------------
16561. Zones Processed: 
16562. ----------------------------------------------------------
16563. !ZoneListByLine!
16564. ----------------------------------------------------------
16565. Zone Processing Step:
16566. !ZoneStepByLine!    
16567. ----------------------------------------------------------
16568. Current Zone:
16569. !ZoneFooter!
16570. ----------------------------------------------------------
16571. Volume Statistics:
16572. !VolumeStatisticsDetail!
16573. ----------------------------------------------------------
16574. Zone Detailed Report:
16575. ----------------------------------------------------------
16576. !ZoneStatisticsDetail!
16577. ----------------------------------------------------------
16578. ")
16579. 
16580. 
16581. 
16582. /* pause() */
16583. /* pause() */
16584. 
16585. 
16586. 
16587. /* ---------------------------------------------------------- */
16588. 
16589.   
16590. /* ---------------------------------------------------------- */
16591. # DIR
16592. 
16593. # Script: DefragZoneTypeOsDir
16594. /* ---------------------------------------------------------- */
16595. SetVariable(ZoneLabel,				"DIR") // "5"
16596. SetVariable(ZoneDescription, 		"Directories.")
16597. SetVariable(ZoneCurrentAjust, 		2)
16598. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpDir!")
16599. SetVariable(ZoneGapSize, 			"!ZoneGapSizeDir!")
16600. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectOsDIR
16601. # DIR start.
16602. Directory(yes)
16603. # DIR end.
16604. ')
16605. 
16606. 	# Script: ZoneDoHeader
16607. 
16608. # Script: ZoneWhenStarted
16609. 
16610. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
16611. # Script: DisplaySetZone
16612. 
16613. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
16614. SetVariable(FileStepDescription,	"")
16615. 
16616. SetVariable(ZoneStepByLine, 			"Zone started.
16617. ")
16618. 
16619. # Script: BannerDescriptionSet
16620. 
16621. # Script: BannerSet
16622. 
16623. # Script: DisplaySetDateTimeRun
16624. 
16625. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
16626. /* Xinclude "..\Display\BannerSet.MyDc"X */
16627. /* pause(1) */
16628. 
16629. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16630. 
16631. Title('!Heading!')
16632. /* pause(1) */
16633. 
16634. /* NOTE: Can't round or truncate to integer precision. */
16635. 
16636. # Script: BannerLog
16637. 
16638. AppendLogfile("!LogFileName!", "!Title!")
16639. 
16640. 
16641. 
16642. pause(1)
16643. 
16644. 
16645. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
16646. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
16647. 
16648. SetVariable(ZoneStepNoCurrent, 0)
16649. 
16650. 
16651. # Script: ZoneDoCurrentClear
16652. 
16653. SetVariable(ZoneTypeSelectCurrent, 		"")
16654. 
16655. SetVariable(ZoneBeginCurrent, 			0)
16656. SetVariable(ZoneBeginPerCurrent, 		0)
16657. SetVariable(ZoneEndCurrent, 			0)
16658. SetVariable(ZoneEndPerCurrent, 			0)
16659. 
16660. SetVariable(ZoneSizeCurrent,			0)
16661. SetVariable(ZoneSizePerCurrent,			0)
16662. 
16663. SetVariable(ZoneGapRequestedCurrent,	0)
16664. SetVariable(ZoneGapRoundedCurrent, 		0)
16665. SetVariable(ZoneGapAdjustedCurrent, 	0)
16666. SetVariable(ZoneGapAvailableCurrent, 	0)
16667. SetVariable(ZoneGapCurrent,				0)
16668. SetVariable(ZoneGapUsedCurrent, 		0)
16669. 
16670. SetVariable(ZoneGapActualCurrent, 		0)
16671. SetVariable(ZoneGapActualPerCurrent, 	0)
16672. 
16673. SetVariable(ZoneSizeActual, 			0)
16674. SetVariable(ZoneSizeActualCurrent,		0)
16675. 
16676. SetVariable(ZoneEndActual, 				0)
16677. SetVariable(ZoneEndActualCurrent,		0)			
16678. SetVariable(ZoneSizeActualPerCurrent, 	0)
16679.       
16680. SetVariable(ZoneFilesFolders,			0)
16681. SetVariable(ZoneFilesFoldersPer,		0) 
16682. 
16683. SetVariable(ZoneFragments,				0)
16684. SetVariable(ZoneFragmentsPer,			0) 
16685. 		
16686. SetVariable(ZoneEndActualCurrent, 		0)
16687. SetVariable(ZoneEndActualPerCurrent, 	0)
16688. 
16689. # Gap Calculation Methodology:
16690. 	# Requested
16691. 	SetVariable(GapRequested, 			0) 
16692. 	SetVariable(GapRequestedStd, 		0) 
16693. 	SetVariable(GapRequestedMft, 		0) 
16694. 	SetVariable(GapRequestedOs, 		0) 
16695. 	SetVariable(GapRequestedOriginal, 	0) 
16696. 	
16697. 	# Gap Adjustments
16698. 	SetVariable(GapRounded, 			0)
16699. 	# SetVariable(GapAdjusted, 			0)
16700. 	SetVariable(GapAvailable, 			0)
16701. 	SetVariable(GapCurrent, 			0)
16702. 	SetVariable(GapActual, 				0)
16703. 	SetVariable(GapUsed, 				0)
16704. 	
16705. 	# Gap Adjustments
16706. 	SetVariable(GapRoundedLoc, 			0)
16707. 	# SetVariable(GapAdjustedLoc, 		0)
16708. 	SetVariable(GapAvailableLoc, 		0)
16709. 	SetVariable(GapCurrentLoc, 			0)
16710. 	SetVariable(GapActualLoc,			0)
16711. 	SetVariable(GapUsedLoc,				0)
16712. 	
16713. 	# Space usage
16714. 	SetVariable(ZoneFreePerRequested, 	0)
16715. 	SetVariable(ZoneFreePerUsed, 		0)
16716. 
16717. # Gap Size & Rounding
16718. 	SetVariable(ZoneGapSizePer, 		0)
16719. 	SetVariable(ZoneVolRoundUpPer, 		0)
16720. 	
16721. 	# Free Space
16722. 	SetVariable(ZoneFreeUsedPer, 		0)
16723. 	SetVariable(ZoneFreeRequestedPer, 	0)
16724. 
16725. 
16726. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
16727. 
16728. # Footer:
16729. SetVariable(ZoneFooter, "----------------------------------------------------------
16730. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
16731. 
16732. Statistics Report:
16733. ------------------
16734.    Size:  
16735.    ------------------------
16736.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16737.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16738.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16739. 
16740.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16741.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16742. 
16743.    Location:
16744.    ------------------------
16745.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16746.              Files End: !ZoneEndCurrent!
16747.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16748.       
16749.    Gap Settings:
16750.    ------------------------
16751.          Gap Requested: !ZoneGapSizePer!%
16752.       Volume Rounding: !ZoneVolRoundUpPer!%
16753.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16754.                  
16755.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16756.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16757.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16758.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16759.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16760.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16761.      
16762.    Free Space after Zone:
16763.    ------------------------
16764.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16765.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16766.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16767. 
16768. Directory and Files Select:
16769. ---------------------------
16770. !ZoneTypeSelectCurrent!               
16771. ---------------------------
16772. ----------------------------------------------------------
16773. ")
16774. 
16775. # Script: BannerSet
16776. 
16777. # Script: DisplaySetDateTimeRun
16778. 
16779. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
16780. /* Xinclude "..\Display\BannerSet.MyDc"X */
16781. /* pause(1) */
16782. 
16783. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16784. 
16785. Title('!Heading!')
16786. /* pause(1) */
16787. 
16788. /* NOTE: Can't round or truncate to integer precision. */
16789. 
16790. # Script: BannerLog
16791. 
16792. AppendLogfile("!LogFileName!", "!Title!")
16793. 
16794. 
16795. 
16796. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
16797. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
16798. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:45")
16799. 
16800. SetVariable(ZoneListByLine, "!ZoneListByLine!
16801. Zone: !ZoneNoCurrent! 2021-11-09 20:22:45 0:00:04 !ZoneLabel! !ZoneDescription!")
16802. 
16803. 
16804. /* Fixed Zone Position Handling */
16805. /* Literal number: */
16806. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
16807. /* Percentage of disk: */
16808. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
16809. /* Gap */
16810. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
16811. 
16812. /* ---------------------------------------------------------- */
16813. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
16814. # Script: DisplaySetFileStep
16815. 
16816. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16817. 
16818. /* add message and move to a new line. */
16819. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16820. ")
16821. 
16822. /* display the line. (hopefully.) */
16823. # Zone Footer Set Statistics Window Text
16824. 
16825. SetStatisticsWindowText("----------------------------------------------------------
16826. Zones Processed: 
16827. ----------------------------------------------------------
16828. !ZoneListByLine!
16829. ----------------------------------------------------------
16830. Zone Processing Step:
16831. !ZoneStepByLine!    
16832. ----------------------------------------------------------
16833. Current Zone:
16834. !ZoneFooter!
16835. ----------------------------------------------------------
16836. Volume Statistics:
16837. !VolumeStatisticsDetail!
16838. ----------------------------------------------------------
16839. Zone Detailed Report:
16840. ----------------------------------------------------------
16841. !ZoneStatisticsDetail!
16842. ----------------------------------------------------------
16843. ")
16844. 
16845. 
16846. 
16847. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16848. 
16849. # Script: BannerSet
16850. 
16851. # Script: DisplaySetDateTimeRun
16852. 
16853. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
16854. /* Xinclude "..\Display\BannerSet.MyDc"X */
16855. /* pause(1) */
16856. 
16857. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16858. 
16859. Title('!Heading!')
16860. /* pause(1) */
16861. 
16862. /* NOTE: Can't round or truncate to integer precision. */
16863. 
16864. pause(1)
16865. 
16866. # your stuff HERE (X)... pre file select code.
16867. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
16868. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16869. 	# (X)
16870. 
16871. FileSelect
16872. 
16873. 	# your stuff can't really go here (errors.)
16874. 	# maybe for some reason I don't know of...
16875. 	
16876. 	# Actions next...
16877. 	# Script: ZoneDo ZoneTypeSelectOsDIR
16878. # DIR start.
16879. Directory(yes)
16880. # DIR end.
16881. 
16882. 
16883. 	FileActions
16884. 	  		/* ---------------------------------------------------------- */
16885. 	# Gap
16886. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
16887. 		# Script: DisplaySetFileStep
16888. 
16889. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16890. 
16891. /* add message and move to a new line. */
16892. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16893. ")
16894. 
16895. /* display the line. (hopefully.) */
16896. # Zone Footer Set Statistics Window Text
16897. 
16898. SetStatisticsWindowText("----------------------------------------------------------
16899. Zones Processed: 
16900. ----------------------------------------------------------
16901. !ZoneListByLine!
16902. ----------------------------------------------------------
16903. Zone Processing Step:
16904. !ZoneStepByLine!    
16905. ----------------------------------------------------------
16906. Current Zone:
16907. !ZoneFooter!
16908. ----------------------------------------------------------
16909. Volume Statistics:
16910. !VolumeStatisticsDetail!
16911. ----------------------------------------------------------
16912. Zone Detailed Report:
16913. ----------------------------------------------------------
16914. !ZoneStatisticsDetail!
16915. ----------------------------------------------------------
16916. ")
16917. 
16918. 
16919. 
16920. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16921. 
16922. # Script: BannerSet
16923. 
16924. # Script: DisplaySetDateTimeRun
16925. 
16926. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
16927. /* Xinclude "..\Display\BannerSet.MyDc"X */
16928. /* pause(1) */
16929. 
16930. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16931. 
16932. Title('!Heading!')
16933. /* pause(1) */
16934. 
16935. /* NOTE: Can't round or truncate to integer precision. */
16936. 
16937. pause(1)
16938. 	
16939. 	# ACTUAL GAP
16940. 		/* AddGap Variant. */
16941. 	  	# Zone Do Gap
16942. # Gap Calculation Methods:
16943. 
16944. /* 1) Anything you need to add first. */
16945. /* empty */
16946. 
16947. /* ---------------------------------------------------------- */
16948. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
16949. 	# GapRequestedStd.
16950. 
16951. 		/* ---------------------------------------------------------- */
16952. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
16953. 
16954. 		# Gap Calculation Methods:
16955. 
16956. /* AddGap Variants */
16957. 
16958. 	/* Standard */
16959. 		# Gap Calculation Methods:
16960. 	/* AddGap Variants */
16961. 	/* Standard */
16962. 
16963. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
16964. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
16965. 
16966. 	SetVariable(GapRequested, GapRequestedStd)
16967. 	
16968. 
16969. 	/* MFT Low High Method */
16970. 		# Gap Calculation Methods:
16971. 	/* AddGap Variants */
16972. 	/* MFT Low High Method */
16973. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
16974. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
16975. 	SetVariable(GapRequested, GapRequestedMft)
16976. 	
16977. 
16978. 	/* OS Volume Type Method */
16979. 		# Gap Calculation Methods:
16980. 	/* AddGap Variants */
16981. 	/* OS Volume Type Method */
16982. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
16983. 	SetVariable(GapRequested, GapRequestedOs)
16984. 
16985. 
16986. 
16987. /* MakeGap Variants */
16988. 
16989. 	/* Original Os 1-3 + MFT 2 */
16990. 		# Gap Calculation Methods:
16991. 	/* MakeGap Variants */
16992. 	/* Original Os 1-3 + MFT 2 */
16993. 	/* plus MFT gap placed inline at the dividing zone. */
16994. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
16995. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
16996. 	SetVariable(GapRequested, GapRequestedOrig)
16997. 	
16998. 	
16999. /* Note: You could comment out the ones not in use */
17000. /* However having the data in the log is useful. */
17001. /* Therefore the following line is otherwise needed. */
17002. 
17003. /* Standard used */
17004. 
17005. SetVariable(GapRequested, GapRequestedStd)
17006. 
17007. # Gap Calculation Methods:
17008. 
17009. /* AddGap Variants */
17010. 	/* Standard */
17011. 	/* MFT Low High Method */
17012. 	/* OS Volume Type Method */
17013. 
17014. /* MakeGap Variants */
17015. 	/* Original Os 1-3 + MFT 2 */
17016. 
17017. /* Note: You could comment out the ones not in use */
17018. /* However having the data in the log is useful. */
17019. /* Therefore the following line is otherwise needed. */
17020. 
17021. /* Standard is used currently */
17022. 
17023. 
17024. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
17025. 
17026. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
17027. 
17028. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
17029. 
17030. /* ---------------------------------------------------------- */
17031. /* 3) SMALL ZONE ADJUSTMENT. */
17032. /* Gab cant be larger than half the Zone Size. */
17033. 
17034. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
17035. 	
17036. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
17037. 
17038. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
17039. 
17040. /* ---------------------------------------------------------- */
17041. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
17042. # Gap Adjustments.
17043. 
17044. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
17045. 	
17046. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
17047. 
17048. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
17049. 
17050. /* ---------------------------------------------------------- */
17051. # BYPASS THIS.
17052. 	/* This is definitely wrong. */
17053. 	/* The question is can we steal gap from the next zone */
17054. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
17055. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
17056. 		# Zone Overflow.
17057. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
17058. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
17059. 
17060. /* ---------------------------------------------------------- */
17061. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
17062. # Remaining free space available.
17063. 
17064. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
17065. 	
17066. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
17067. 
17068. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
17069. 
17070. /* ---------------------------------------------------------- */
17071. # CURRENT gap to use.
17072. 
17073. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
17074. 
17075. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
17076. 
17077. /* ---------------------------------------------------------- */
17078. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
17079. # Debugging.
17080. 
17081. 	SetVariable(GapUsed, GapCurrent) // for debugging
17082. 
17083. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
17084. 
17085. 		# Your code HERE
17086. 
17087. /* ---------------------------------------------------------- */
17088. /* 7) YOUR CODE. */
17089. # YOUR CODE HERE:
17090. 	# INPUT: GapCurrent or GapCurrentLoc
17091. 	# OUTPUT: GapUsed...
17092. 
17093. /* ---------------------------------------------------------- */
17094. # Gap Size.
17095. # Actual Size of Gap.
17096. 
17097. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
17098. 
17099. /* ---------------------------------------------------------- */
17100. /* xxxxxxxxxxxxxxxxxxxxxx */
17101. # ADD THE GAP
17102. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
17103. /* xxxxxxxxxxxxxxxxxxxxxx */
17104. 
17105. 	
17106. 	# Zone Statistics	
17107. 	# Script: ZoneDoStatistics
17108. # Zone / Volume Statistics and Display
17109. 		
17110. 	# Accumulate Totals
17111.   	# Script: ZoneDoVolumeTotals
17112. 
17113. /* Current total space used (by Zones and Gaps) */
17114. 
17115. SetVariable(VolumeZoneUsed, GapUsed)
17116. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
17117. /* Percentage */
17118. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
17119. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
17120. 
17121. /* Current total of free space requested */
17122. 
17123. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
17124. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17125. /* Percent. */
17126. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
17127. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17128. 
17129. /* Current total of free space used */
17130. 
17131. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
17132. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
17133. /* Percent */
17134. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
17135. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
17136. 
17137. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
17138. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
17139. /* Xinclude "..\DebugDisplayPause.MyDc"X */
17140. 
17141. 
17142. 	# Current Values
17143. 	# Script: ZoneDoCurrentSet
17144. 
17145. # Cluster, Sector, Block adjust for display.
17146. 	# Bytes per cluster is volume specific.
17147. 
17148. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
17149. 
17150. # Current Zone values.
17151. 	# Begin, end and size.
17152. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
17153. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
17154. 
17155. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
17156. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
17157. 
17158. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
17159. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
17160. 
17161. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
17162. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
17163. 
17164. 	SetVariable(ZoneFragments,				"!ZONE210N!")
17165. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
17166. 		
17167. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
17168. /* identical code to here: (separation not needed. TEST.) */	
17169. 
17170. # Current Gap, Actual and Free Values
17171. 	# Gap
17172. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
17173. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
17174. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
17175. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
17176. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
17177. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
17178. 	
17179. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
17180. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
17181. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
17182. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
17183. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
17184. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
17185. 	
17186. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
17187. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
17188. 	
17189. 	# Actual Size and End
17190. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
17191. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
17192. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
17193. 	
17194. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
17195. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
17196. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
17197. 
17198. # Gap Size & Rounding
17199. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
17200. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
17201. 	
17202. 	# Free Space
17203. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
17204. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
17205. 
17206. 	# Footer:
17207. SetVariable(ZoneFooter, "----------------------------------------------------------
17208. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
17209. 
17210. Statistics Report:
17211. ------------------
17212.    Size:  
17213.    ------------------------
17214.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17215.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17216.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17217. 
17218.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17219.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17220. 
17221.    Location:
17222.    ------------------------
17223.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17224.              Files End: !ZoneEndCurrent!
17225.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17226.       
17227.    Gap Settings:
17228.    ------------------------
17229.          Gap Requested: !ZoneGapSizePer!%
17230.       Volume Rounding: !ZoneVolRoundUpPer!%
17231.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17232.                  
17233.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17234.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17235.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17236.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17237.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17238.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17239.      
17240.    Free Space after Zone:
17241.    ------------------------
17242.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17243.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17244.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17245. 
17246. Directory and Files Select:
17247. ---------------------------
17248. !ZoneTypeSelectCurrent!               
17249. ---------------------------
17250. ----------------------------------------------------------
17251. ")
17252. 	# Zone Footer Set Statistics Window Text
17253. 
17254. SetStatisticsWindowText("----------------------------------------------------------
17255. Zones Processed: 
17256. ----------------------------------------------------------
17257. !ZoneListByLine!
17258. ----------------------------------------------------------
17259. Zone Processing Step:
17260. !ZoneStepByLine!    
17261. ----------------------------------------------------------
17262. Current Zone:
17263. !ZoneFooter!
17264. ----------------------------------------------------------
17265. Volume Statistics:
17266. !VolumeStatisticsDetail!
17267. ----------------------------------------------------------
17268. Zone Detailed Report:
17269. ----------------------------------------------------------
17270. !ZoneStatisticsDetail!
17271. ----------------------------------------------------------
17272. ")
17273. 
17274. 
17275. 	
17276.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
17277. 
17278. 	# Add Zone to list of zones for display.
17279. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
17280. 	# ??? Free Stats?
17281. 	# Footer:
17282. SetVariable(ZoneFooter, "----------------------------------------------------------
17283. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
17284. 
17285. Statistics Report:
17286. ------------------
17287.    Size:  
17288.    ------------------------
17289.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17290.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17291.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17292. 
17293.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17294.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17295. 
17296.    Location:
17297.    ------------------------
17298.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17299.              Files End: !ZoneEndCurrent!
17300.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17301.       
17302.    Gap Settings:
17303.    ------------------------
17304.          Gap Requested: !ZoneGapSizePer!%
17305.       Volume Rounding: !ZoneVolRoundUpPer!%
17306.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17307.                  
17308.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17309.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17310.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17311.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17312.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17313.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17314.      
17315.    Free Space after Zone:
17316.    ------------------------
17317.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17318.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17319.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17320. 
17321. Directory and Files Select:
17322. ---------------------------
17323. !ZoneTypeSelectCurrent!               
17324. ---------------------------
17325. ----------------------------------------------------------
17326. ")
17327. 
17328. 	# Add Zone Details to Report.	
17329. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
17330. !ZoneFooter!")
17331. 
17332. 
17333. 	
17334. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
17335. 		# Script: DisplaySetFileStep
17336. 
17337. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17338. 
17339. /* add message and move to a new line. */
17340. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17341. ")
17342. 
17343. /* display the line. (hopefully.) */
17344. # Zone Footer Set Statistics Window Text
17345. 
17346. SetStatisticsWindowText("----------------------------------------------------------
17347. Zones Processed: 
17348. ----------------------------------------------------------
17349. !ZoneListByLine!
17350. ----------------------------------------------------------
17351. Zone Processing Step:
17352. !ZoneStepByLine!    
17353. ----------------------------------------------------------
17354. Current Zone:
17355. !ZoneFooter!
17356. ----------------------------------------------------------
17357. Volume Statistics:
17358. !VolumeStatisticsDetail!
17359. ----------------------------------------------------------
17360. Zone Detailed Report:
17361. ----------------------------------------------------------
17362. !ZoneStatisticsDetail!
17363. ----------------------------------------------------------
17364. ")
17365. 
17366. 
17367. 
17368. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17369. 
17370. # Script: BannerSet
17371. 
17372. # Script: DisplaySetDateTimeRun
17373. 
17374. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
17375. /* Xinclude "..\Display\BannerSet.MyDc"X */
17376. /* pause(1) */
17377. 
17378. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17379. 
17380. Title('!Heading!')
17381. /* pause(1) */
17382. 
17383. /* NOTE: Can't round or truncate to integer precision. */
17384. 
17385. pause(1)
17386. 	
17387. 		# File Action - Type Os Dir -  SortByName.
17388. # BY 10
17389. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
17390. 	
17391. 
17392. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
17393. 		# Script: DisplaySetFileStep
17394. 
17395. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17396. 
17397. /* add message and move to a new line. */
17398. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17399. ")
17400. 
17401. /* display the line. (hopefully.) */
17402. # Zone Footer Set Statistics Window Text
17403. 
17404. SetStatisticsWindowText("----------------------------------------------------------
17405. Zones Processed: 
17406. ----------------------------------------------------------
17407. !ZoneListByLine!
17408. ----------------------------------------------------------
17409. Zone Processing Step:
17410. !ZoneStepByLine!    
17411. ----------------------------------------------------------
17412. Current Zone:
17413. !ZoneFooter!
17414. ----------------------------------------------------------
17415. Volume Statistics:
17416. !VolumeStatisticsDetail!
17417. ----------------------------------------------------------
17418. Zone Detailed Report:
17419. ----------------------------------------------------------
17420. !ZoneStatisticsDetail!
17421. ----------------------------------------------------------
17422. ")
17423. 
17424. 
17425. 
17426. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17427. 
17428. # Script: BannerSet
17429. 
17430. # Script: DisplaySetDateTimeRun
17431. 
17432. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
17433. /* Xinclude "..\Display\BannerSet.MyDc"X */
17434. /* pause(1) */
17435. 
17436. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17437. 
17438. Title('!Heading!')
17439. /* pause(1) */
17440. 
17441. /* NOTE: Can't round or truncate to integer precision. */
17442. 
17443. pause(1)
17444. 	# Script: ZoneDoFooter
17445. 
17446. /* ---------------------------------------------------------- */
17447. # File Select
17448. 	# Select Statments
17449. # File Actions 
17450. 	# Standard or OS File Actions.
17451. 	# Resume...
17452. 	
17453. 	# your stuff HERE (X)... post zone (file) file actions code.
17454. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
17455. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17456. 		# (X)
17457. 		
17458. 		/* ??? Set window? */
17459. 	
17460. 	# ADD THE GAP
17461. 		
17462. # Vacate (good for diagnostics)
17463. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
17464. 
17465. # DoNotVacate - DO NOT Vacate (recommended)
17466. 
17467. # Vacate
17468. /* AddGap(GapUsedLoc) */
17469. 
17470. # DO Not Vacate
17471. AddGap(GapUsedLoc, DoNotVacate) 
17472. 	
17473. 	
17474. /* ---------------------------------------------------------- */
17475. # (failed) TEST for boolean logic.
17476. 
17477. /* It should work in the gap calculations for turning options */
17478. /* on and off but it will NOT work here. */
17479. 
17480. /* Boolean setting X or FlagX. */
17481. /* Where X will be on or off: */
17482. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
17483. /*      For ON:  (X  *  FlagAny) */
17484. 
17485. /* 1) Failed, zero gap overrode the previous one. */
17486. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
17487. /* AddGap(GapUsedTemp) */ 
17488. 
17489. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
17490. /* AddGap(GapUsedTemp, DoNotVacate) */ 
17491. 
17492. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
17493. 
17494. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
17495. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
17496. /* AddGap(GapUsedTemp) */ 
17497. 
17498. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
17499. /* AddGap(GapUsedTemp, DoNotVacate) */ 
17500. 
17501. /* ---------------------------------------------------------- */
17502. 
17503. # Vacate
17504. /* AddGap(GapUsed) */
17505. 
17506. # DO NOT Vacate (recommended)
17507. /* AddGap(GapUsed, DoNotVacate) */ 
17508. 	
17509. 
17510. 		
17511. # 
17512. FileEnd
17513. /* ---------------------------------------------------------- */
17514. 
17515. # your stuff HERE (X)... post zone (file) code.
17516. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
17517. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17518. 	# (X)
17519. 
17520. SetVariable(FileStepDescription,"Zone finished, reporting.")
17521. # Script: DisplaySetFileStep
17522. 
17523. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17524. 
17525. /* add message and move to a new line. */
17526. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17527. ")
17528. 
17529. /* display the line. (hopefully.) */
17530. # Zone Footer Set Statistics Window Text
17531. 
17532. SetStatisticsWindowText("----------------------------------------------------------
17533. Zones Processed: 
17534. ----------------------------------------------------------
17535. !ZoneListByLine!
17536. ----------------------------------------------------------
17537. Zone Processing Step:
17538. !ZoneStepByLine!    
17539. ----------------------------------------------------------
17540. Current Zone:
17541. !ZoneFooter!
17542. ----------------------------------------------------------
17543. Volume Statistics:
17544. !VolumeStatisticsDetail!
17545. ----------------------------------------------------------
17546. Zone Detailed Report:
17547. ----------------------------------------------------------
17548. !ZoneStatisticsDetail!
17549. ----------------------------------------------------------
17550. ")
17551. 
17552. 
17553. 
17554. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17555. 
17556. # Script: BannerSet
17557. 
17558. # Script: DisplaySetDateTimeRun
17559. 
17560. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
17561. /* Xinclude "..\Display\BannerSet.MyDc"X */
17562. /* pause(1) */
17563. 
17564. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17565. 
17566. Title('!Heading!')
17567. /* pause(1) */
17568. 
17569. /* NOTE: Can't round or truncate to integer precision. */
17570. 
17571. pause(1)
17572. 
17573. # Script: ZoneWhenFinished
17574. 
17575. # Script: BannerSet
17576. 
17577. # Script: DisplaySetDateTimeRun
17578. 
17579. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
17580. /* Xinclude "..\Display\BannerSet.MyDc"X */
17581. /* pause(1) */
17582. 
17583. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17584. 
17585. Title('!Heading!')
17586. /* pause(1) */
17587. 
17588. /* NOTE: Can't round or truncate to integer precision. */
17589. 
17590. # Script: BannerLog
17591. 
17592. AppendLogfile("!LogFileName!", "!Title!")
17593. 
17594. 
17595. 
17596. # Zone Statistics	
17597. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
17598. 
17599. # Footer:
17600. SetVariable(ZoneFooter, "----------------------------------------------------------
17601. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
17602. 
17603. Statistics Report:
17604. ------------------
17605.    Size:  
17606.    ------------------------
17607.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17608.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17609.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17610. 
17611.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17612.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17613. 
17614.    Location:
17615.    ------------------------
17616.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17617.              Files End: !ZoneEndCurrent!
17618.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17619.       
17620.    Gap Settings:
17621.    ------------------------
17622.          Gap Requested: !ZoneGapSizePer!%
17623.       Volume Rounding: !ZoneVolRoundUpPer!%
17624.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17625.                  
17626.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17627.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17628.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17629.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17630.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17631.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17632.      
17633.    Free Space after Zone:
17634.    ------------------------
17635.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17636.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17637.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17638. 
17639. Directory and Files Select:
17640. ---------------------------
17641. !ZoneTypeSelectCurrent!               
17642. ---------------------------
17643. ----------------------------------------------------------
17644. ")
17645. 
17646. AppendLogfile("!LogFileName!", ".")
17647. AppendLogfile("!LogFileName!", "!ZoneFooter!")
17648. AppendLogfile("!LogFileName!", ".")
17649. 
17650. # Zone Footer Set Statistics Window Text
17651. 
17652. SetStatisticsWindowText("----------------------------------------------------------
17653. Zones Processed: 
17654. ----------------------------------------------------------
17655. !ZoneListByLine!
17656. ----------------------------------------------------------
17657. Zone Processing Step:
17658. !ZoneStepByLine!    
17659. ----------------------------------------------------------
17660. Current Zone:
17661. !ZoneFooter!
17662. ----------------------------------------------------------
17663. Volume Statistics:
17664. !VolumeStatisticsDetail!
17665. ----------------------------------------------------------
17666. Zone Detailed Report:
17667. ----------------------------------------------------------
17668. !ZoneStatisticsDetail!
17669. ----------------------------------------------------------
17670. ")
17671. 
17672. 
17673. 
17674. /* pause() */
17675. /* pause() */
17676. 
17677. 
17678. 
17679. 
17680. /* Mft Method: MFT GAP HERE. */
17681. /* For fixed zone locations */
17682. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-11-09 20:22:45")
17683. /* MakeGap(MftGap, DoNotVacate) */
17684. /* ---------------------------------------------------------- */
17685. 
17686. 
17687. /* ---------------------------------------------------------- */
17688. /* Mft Method: MFT GAP HERE. */
17689. /* For fixed zone locations */
17690. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-11-09 20:22:45")
17691. /* MakeGap(MftGap, DoNotVacate) */
17692.   
17693. /* ---------------------------------------------------------- */
17694. # PageHiberDump
17695. 
17696. # You cannot move Pagefile or Hiberfil generally speaking.
17697. # This might work in safe mode with preparation.
17698. # Zone PageHiberDump.
17699. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
17700. 
17701. # Script: DefragZoneTypeOsPageHiberDump
17702. /* ---------------------------------------------------------- */
17703. # PageHiberDump
17704. # You cannot move Pagefile or Hiberfil generally speaking.
17705. # This might work in safe mode with preparation.
17706. # Zone PageHiberDump.
17707. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
17708. 
17709. 	SetVariable(ZoneLabel, 			"!ZoneLabelPageHiberDump!")
17710. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPageHiberDump!")
17711. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPageHiberDump!")
17712. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePageHiberDump!")
17713. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsPageHiberDump
17714. # PageHiberDump start.
17715. (
17716. # Os PageHiberDump start.
17717. (
17718.   FileName("DataStore.edb")
17719.   or FileName("DUMP*.*")
17720.   or FileName("Hiberfil.sys")
17721.   or FileName("MEMORY.DMP")
17722.   or FileName("Pagefile.sys")
17723. )
17724. # Os PageHiberDump end.
17725. 
17726. )
17727. # PageHiberDump end.
17728. ')
17729. 
17730. 		# Script: ZoneDoHeader
17731. 
17732. # Script: ZoneWhenStarted
17733. 
17734. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
17735. # Script: DisplaySetZone
17736. 
17737. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
17738. SetVariable(FileStepDescription,	"")
17739. 
17740. SetVariable(ZoneStepByLine, 			"Zone started.
17741. ")
17742. 
17743. # Script: BannerDescriptionSet
17744. 
17745. # Script: BannerSet
17746. 
17747. # Script: DisplaySetDateTimeRun
17748. 
17749. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
17750. /* Xinclude "..\Display\BannerSet.MyDc"X */
17751. /* pause(1) */
17752. 
17753. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17754. 
17755. Title('!Heading!')
17756. /* pause(1) */
17757. 
17758. /* NOTE: Can't round or truncate to integer precision. */
17759. 
17760. # Script: BannerLog
17761. 
17762. AppendLogfile("!LogFileName!", "!Title!")
17763. 
17764. 
17765. 
17766. pause(1)
17767. 
17768. 
17769. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
17770. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
17771. 
17772. SetVariable(ZoneStepNoCurrent, 0)
17773. 
17774. 
17775. # Script: ZoneDoCurrentClear
17776. 
17777. SetVariable(ZoneTypeSelectCurrent, 		"")
17778. 
17779. SetVariable(ZoneBeginCurrent, 			0)
17780. SetVariable(ZoneBeginPerCurrent, 		0)
17781. SetVariable(ZoneEndCurrent, 			0)
17782. SetVariable(ZoneEndPerCurrent, 			0)
17783. 
17784. SetVariable(ZoneSizeCurrent,			0)
17785. SetVariable(ZoneSizePerCurrent,			0)
17786. 
17787. SetVariable(ZoneGapRequestedCurrent,	0)
17788. SetVariable(ZoneGapRoundedCurrent, 		0)
17789. SetVariable(ZoneGapAdjustedCurrent, 	0)
17790. SetVariable(ZoneGapAvailableCurrent, 	0)
17791. SetVariable(ZoneGapCurrent,				0)
17792. SetVariable(ZoneGapUsedCurrent, 		0)
17793. 
17794. SetVariable(ZoneGapActualCurrent, 		0)
17795. SetVariable(ZoneGapActualPerCurrent, 	0)
17796. 
17797. SetVariable(ZoneSizeActual, 			0)
17798. SetVariable(ZoneSizeActualCurrent,		0)
17799. 
17800. SetVariable(ZoneEndActual, 				0)
17801. SetVariable(ZoneEndActualCurrent,		0)			
17802. SetVariable(ZoneSizeActualPerCurrent, 	0)
17803.       
17804. SetVariable(ZoneFilesFolders,			0)
17805. SetVariable(ZoneFilesFoldersPer,		0) 
17806. 
17807. SetVariable(ZoneFragments,				0)
17808. SetVariable(ZoneFragmentsPer,			0) 
17809. 		
17810. SetVariable(ZoneEndActualCurrent, 		0)
17811. SetVariable(ZoneEndActualPerCurrent, 	0)
17812. 
17813. # Gap Calculation Methodology:
17814. 	# Requested
17815. 	SetVariable(GapRequested, 			0) 
17816. 	SetVariable(GapRequestedStd, 		0) 
17817. 	SetVariable(GapRequestedMft, 		0) 
17818. 	SetVariable(GapRequestedOs, 		0) 
17819. 	SetVariable(GapRequestedOriginal, 	0) 
17820. 	
17821. 	# Gap Adjustments
17822. 	SetVariable(GapRounded, 			0)
17823. 	# SetVariable(GapAdjusted, 			0)
17824. 	SetVariable(GapAvailable, 			0)
17825. 	SetVariable(GapCurrent, 			0)
17826. 	SetVariable(GapActual, 				0)
17827. 	SetVariable(GapUsed, 				0)
17828. 	
17829. 	# Gap Adjustments
17830. 	SetVariable(GapRoundedLoc, 			0)
17831. 	# SetVariable(GapAdjustedLoc, 		0)
17832. 	SetVariable(GapAvailableLoc, 		0)
17833. 	SetVariable(GapCurrentLoc, 			0)
17834. 	SetVariable(GapActualLoc,			0)
17835. 	SetVariable(GapUsedLoc,				0)
17836. 	
17837. 	# Space usage
17838. 	SetVariable(ZoneFreePerRequested, 	0)
17839. 	SetVariable(ZoneFreePerUsed, 		0)
17840. 
17841. # Gap Size & Rounding
17842. 	SetVariable(ZoneGapSizePer, 		0)
17843. 	SetVariable(ZoneVolRoundUpPer, 		0)
17844. 	
17845. 	# Free Space
17846. 	SetVariable(ZoneFreeUsedPer, 		0)
17847. 	SetVariable(ZoneFreeRequestedPer, 	0)
17848. 
17849. 
17850. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
17851. 
17852. # Footer:
17853. SetVariable(ZoneFooter, "----------------------------------------------------------
17854. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
17855. 
17856. Statistics Report:
17857. ------------------
17858.    Size:  
17859.    ------------------------
17860.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17861.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17862.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17863. 
17864.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17865.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17866. 
17867.    Location:
17868.    ------------------------
17869.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17870.              Files End: !ZoneEndCurrent!
17871.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17872.       
17873.    Gap Settings:
17874.    ------------------------
17875.          Gap Requested: !ZoneGapSizePer!%
17876.       Volume Rounding: !ZoneVolRoundUpPer!%
17877.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17878.                  
17879.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17880.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17881.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17882.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17883.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17884.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17885.      
17886.    Free Space after Zone:
17887.    ------------------------
17888.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17889.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17890.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17891. 
17892. Directory and Files Select:
17893. ---------------------------
17894. !ZoneTypeSelectCurrent!               
17895. ---------------------------
17896. ----------------------------------------------------------
17897. ")
17898. 
17899. # Script: BannerSet
17900. 
17901. # Script: DisplaySetDateTimeRun
17902. 
17903. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
17904. /* Xinclude "..\Display\BannerSet.MyDc"X */
17905. /* pause(1) */
17906. 
17907. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17908. 
17909. Title('!Heading!')
17910. /* pause(1) */
17911. 
17912. /* NOTE: Can't round or truncate to integer precision. */
17913. 
17914. # Script: BannerLog
17915. 
17916. AppendLogfile("!LogFileName!", "!Title!")
17917. 
17918. 
17919. 
17920. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
17921. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
17922. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:45")
17923. 
17924. SetVariable(ZoneListByLine, "!ZoneListByLine!
17925. Zone: !ZoneNoCurrent! 2021-11-09 20:22:45 0:00:04 !ZoneLabel! !ZoneDescription!")
17926. 
17927. 
17928. /* Fixed Zone Position Handling */
17929. /* Literal number: */
17930. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
17931. /* Percentage of disk: */
17932. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
17933. /* Gap */
17934. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
17935. 
17936. /* ---------------------------------------------------------- */
17937. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
17938. # Script: DisplaySetFileStep
17939. 
17940. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17941. 
17942. /* add message and move to a new line. */
17943. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17944. ")
17945. 
17946. /* display the line. (hopefully.) */
17947. # Zone Footer Set Statistics Window Text
17948. 
17949. SetStatisticsWindowText("----------------------------------------------------------
17950. Zones Processed: 
17951. ----------------------------------------------------------
17952. !ZoneListByLine!
17953. ----------------------------------------------------------
17954. Zone Processing Step:
17955. !ZoneStepByLine!    
17956. ----------------------------------------------------------
17957. Current Zone:
17958. !ZoneFooter!
17959. ----------------------------------------------------------
17960. Volume Statistics:
17961. !VolumeStatisticsDetail!
17962. ----------------------------------------------------------
17963. Zone Detailed Report:
17964. ----------------------------------------------------------
17965. !ZoneStatisticsDetail!
17966. ----------------------------------------------------------
17967. ")
17968. 
17969. 
17970. 
17971. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17972. 
17973. # Script: BannerSet
17974. 
17975. # Script: DisplaySetDateTimeRun
17976. 
17977. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
17978. /* Xinclude "..\Display\BannerSet.MyDc"X */
17979. /* pause(1) */
17980. 
17981. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17982. 
17983. Title('!Heading!')
17984. /* pause(1) */
17985. 
17986. /* NOTE: Can't round or truncate to integer precision. */
17987. 
17988. pause(1)
17989. 
17990. # your stuff HERE (X)... pre file select code.
17991. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
17992. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17993. 	# (X)
17994. 
17995. FileSelect
17996. 
17997. 	# your stuff can't really go here (errors.)
17998. 	# maybe for some reason I don't know of...
17999. 	
18000. 	# Actions next...
18001. 		# Script: ZoneDo ZoneTypeSelectOsPageHiberDump
18002. # PageHiberDump start.
18003. (
18004. # Os PageHiberDump start.
18005. (
18006.   FileName("DataStore.edb")
18007.   or FileName("DUMP*.*")
18008.   or FileName("Hiberfil.sys")
18009.   or FileName("MEMORY.DMP")
18010.   or FileName("Pagefile.sys")
18011. )
18012. # Os PageHiberDump end.
18013. 
18014. )
18015. # PageHiberDump end.
18016. 
18017. 		
18018. 		FileActions
18019. 		  		/* ---------------------------------------------------------- */
18020. 	# Gap
18021. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
18022. 		# Script: DisplaySetFileStep
18023. 
18024. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18025. 
18026. /* add message and move to a new line. */
18027. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18028. ")
18029. 
18030. /* display the line. (hopefully.) */
18031. # Zone Footer Set Statistics Window Text
18032. 
18033. SetStatisticsWindowText("----------------------------------------------------------
18034. Zones Processed: 
18035. ----------------------------------------------------------
18036. !ZoneListByLine!
18037. ----------------------------------------------------------
18038. Zone Processing Step:
18039. !ZoneStepByLine!    
18040. ----------------------------------------------------------
18041. Current Zone:
18042. !ZoneFooter!
18043. ----------------------------------------------------------
18044. Volume Statistics:
18045. !VolumeStatisticsDetail!
18046. ----------------------------------------------------------
18047. Zone Detailed Report:
18048. ----------------------------------------------------------
18049. !ZoneStatisticsDetail!
18050. ----------------------------------------------------------
18051. ")
18052. 
18053. 
18054. 
18055. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18056. 
18057. # Script: BannerSet
18058. 
18059. # Script: DisplaySetDateTimeRun
18060. 
18061. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
18062. /* Xinclude "..\Display\BannerSet.MyDc"X */
18063. /* pause(1) */
18064. 
18065. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18066. 
18067. Title('!Heading!')
18068. /* pause(1) */
18069. 
18070. /* NOTE: Can't round or truncate to integer precision. */
18071. 
18072. pause(1)
18073. 	
18074. 	# ACTUAL GAP
18075. 		/* AddGap Variant. */
18076. 	  	# Zone Do Gap
18077. # Gap Calculation Methods:
18078. 
18079. /* 1) Anything you need to add first. */
18080. /* empty */
18081. 
18082. /* ---------------------------------------------------------- */
18083. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
18084. 	# GapRequestedStd.
18085. 
18086. 		/* ---------------------------------------------------------- */
18087. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
18088. 
18089. 		# Gap Calculation Methods:
18090. 
18091. /* AddGap Variants */
18092. 
18093. 	/* Standard */
18094. 		# Gap Calculation Methods:
18095. 	/* AddGap Variants */
18096. 	/* Standard */
18097. 
18098. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
18099. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
18100. 
18101. 	SetVariable(GapRequested, GapRequestedStd)
18102. 	
18103. 
18104. 	/* MFT Low High Method */
18105. 		# Gap Calculation Methods:
18106. 	/* AddGap Variants */
18107. 	/* MFT Low High Method */
18108. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
18109. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
18110. 	SetVariable(GapRequested, GapRequestedMft)
18111. 	
18112. 
18113. 	/* OS Volume Type Method */
18114. 		# Gap Calculation Methods:
18115. 	/* AddGap Variants */
18116. 	/* OS Volume Type Method */
18117. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
18118. 	SetVariable(GapRequested, GapRequestedOs)
18119. 
18120. 
18121. 
18122. /* MakeGap Variants */
18123. 
18124. 	/* Original Os 1-3 + MFT 2 */
18125. 		# Gap Calculation Methods:
18126. 	/* MakeGap Variants */
18127. 	/* Original Os 1-3 + MFT 2 */
18128. 	/* plus MFT gap placed inline at the dividing zone. */
18129. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
18130. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
18131. 	SetVariable(GapRequested, GapRequestedOrig)
18132. 	
18133. 	
18134. /* Note: You could comment out the ones not in use */
18135. /* However having the data in the log is useful. */
18136. /* Therefore the following line is otherwise needed. */
18137. 
18138. /* Standard used */
18139. 
18140. SetVariable(GapRequested, GapRequestedStd)
18141. 
18142. # Gap Calculation Methods:
18143. 
18144. /* AddGap Variants */
18145. 	/* Standard */
18146. 	/* MFT Low High Method */
18147. 	/* OS Volume Type Method */
18148. 
18149. /* MakeGap Variants */
18150. 	/* Original Os 1-3 + MFT 2 */
18151. 
18152. /* Note: You could comment out the ones not in use */
18153. /* However having the data in the log is useful. */
18154. /* Therefore the following line is otherwise needed. */
18155. 
18156. /* Standard is used currently */
18157. 
18158. 
18159. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
18160. 
18161. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
18162. 
18163. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
18164. 
18165. /* ---------------------------------------------------------- */
18166. /* 3) SMALL ZONE ADJUSTMENT. */
18167. /* Gab cant be larger than half the Zone Size. */
18168. 
18169. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
18170. 	
18171. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
18172. 
18173. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
18174. 
18175. /* ---------------------------------------------------------- */
18176. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
18177. # Gap Adjustments.
18178. 
18179. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
18180. 	
18181. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
18182. 
18183. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
18184. 
18185. /* ---------------------------------------------------------- */
18186. # BYPASS THIS.
18187. 	/* This is definitely wrong. */
18188. 	/* The question is can we steal gap from the next zone */
18189. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
18190. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
18191. 		# Zone Overflow.
18192. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
18193. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
18194. 
18195. /* ---------------------------------------------------------- */
18196. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
18197. # Remaining free space available.
18198. 
18199. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
18200. 	
18201. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
18202. 
18203. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
18204. 
18205. /* ---------------------------------------------------------- */
18206. # CURRENT gap to use.
18207. 
18208. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
18209. 
18210. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
18211. 
18212. /* ---------------------------------------------------------- */
18213. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
18214. # Debugging.
18215. 
18216. 	SetVariable(GapUsed, GapCurrent) // for debugging
18217. 
18218. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
18219. 
18220. 		# Your code HERE
18221. 
18222. /* ---------------------------------------------------------- */
18223. /* 7) YOUR CODE. */
18224. # YOUR CODE HERE:
18225. 	# INPUT: GapCurrent or GapCurrentLoc
18226. 	# OUTPUT: GapUsed...
18227. 
18228. /* ---------------------------------------------------------- */
18229. # Gap Size.
18230. # Actual Size of Gap.
18231. 
18232. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
18233. 
18234. /* ---------------------------------------------------------- */
18235. /* xxxxxxxxxxxxxxxxxxxxxx */
18236. # ADD THE GAP
18237. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
18238. /* xxxxxxxxxxxxxxxxxxxxxx */
18239. 
18240. 	
18241. 	# Zone Statistics	
18242. 	# Script: ZoneDoStatistics
18243. # Zone / Volume Statistics and Display
18244. 		
18245. 	# Accumulate Totals
18246.   	# Script: ZoneDoVolumeTotals
18247. 
18248. /* Current total space used (by Zones and Gaps) */
18249. 
18250. SetVariable(VolumeZoneUsed, GapUsed)
18251. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
18252. /* Percentage */
18253. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
18254. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
18255. 
18256. /* Current total of free space requested */
18257. 
18258. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
18259. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18260. /* Percent. */
18261. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
18262. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18263. 
18264. /* Current total of free space used */
18265. 
18266. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
18267. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
18268. /* Percent */
18269. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
18270. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
18271. 
18272. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
18273. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
18274. /* Xinclude "..\DebugDisplayPause.MyDc"X */
18275. 
18276. 
18277. 	# Current Values
18278. 	# Script: ZoneDoCurrentSet
18279. 
18280. # Cluster, Sector, Block adjust for display.
18281. 	# Bytes per cluster is volume specific.
18282. 
18283. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
18284. 
18285. # Current Zone values.
18286. 	# Begin, end and size.
18287. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
18288. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
18289. 
18290. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
18291. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
18292. 
18293. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
18294. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
18295. 
18296. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
18297. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
18298. 
18299. 	SetVariable(ZoneFragments,				"!ZONE210N!")
18300. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
18301. 		
18302. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
18303. /* identical code to here: (separation not needed. TEST.) */	
18304. 
18305. # Current Gap, Actual and Free Values
18306. 	# Gap
18307. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
18308. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
18309. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
18310. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
18311. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
18312. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
18313. 	
18314. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
18315. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
18316. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
18317. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
18318. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
18319. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
18320. 	
18321. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
18322. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
18323. 	
18324. 	# Actual Size and End
18325. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
18326. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
18327. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
18328. 	
18329. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
18330. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
18331. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
18332. 
18333. # Gap Size & Rounding
18334. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
18335. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
18336. 	
18337. 	# Free Space
18338. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
18339. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
18340. 
18341. 	# Footer:
18342. SetVariable(ZoneFooter, "----------------------------------------------------------
18343. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
18344. 
18345. Statistics Report:
18346. ------------------
18347.    Size:  
18348.    ------------------------
18349.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18350.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18351.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18352. 
18353.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18354.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18355. 
18356.    Location:
18357.    ------------------------
18358.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18359.              Files End: !ZoneEndCurrent!
18360.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18361.       
18362.    Gap Settings:
18363.    ------------------------
18364.          Gap Requested: !ZoneGapSizePer!%
18365.       Volume Rounding: !ZoneVolRoundUpPer!%
18366.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18367.                  
18368.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18369.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18370.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18371.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18372.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18373.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18374.      
18375.    Free Space after Zone:
18376.    ------------------------
18377.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18378.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18379.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18380. 
18381. Directory and Files Select:
18382. ---------------------------
18383. !ZoneTypeSelectCurrent!               
18384. ---------------------------
18385. ----------------------------------------------------------
18386. ")
18387. 	# Zone Footer Set Statistics Window Text
18388. 
18389. SetStatisticsWindowText("----------------------------------------------------------
18390. Zones Processed: 
18391. ----------------------------------------------------------
18392. !ZoneListByLine!
18393. ----------------------------------------------------------
18394. Zone Processing Step:
18395. !ZoneStepByLine!    
18396. ----------------------------------------------------------
18397. Current Zone:
18398. !ZoneFooter!
18399. ----------------------------------------------------------
18400. Volume Statistics:
18401. !VolumeStatisticsDetail!
18402. ----------------------------------------------------------
18403. Zone Detailed Report:
18404. ----------------------------------------------------------
18405. !ZoneStatisticsDetail!
18406. ----------------------------------------------------------
18407. ")
18408. 
18409. 
18410. 	
18411.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
18412. 
18413. 	# Add Zone to list of zones for display.
18414. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
18415. 	# ??? Free Stats?
18416. 	# Footer:
18417. SetVariable(ZoneFooter, "----------------------------------------------------------
18418. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
18419. 
18420. Statistics Report:
18421. ------------------
18422.    Size:  
18423.    ------------------------
18424.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18425.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18426.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18427. 
18428.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18429.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18430. 
18431.    Location:
18432.    ------------------------
18433.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18434.              Files End: !ZoneEndCurrent!
18435.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18436.       
18437.    Gap Settings:
18438.    ------------------------
18439.          Gap Requested: !ZoneGapSizePer!%
18440.       Volume Rounding: !ZoneVolRoundUpPer!%
18441.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18442.                  
18443.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18444.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18445.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18446.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18447.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18448.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18449.      
18450.    Free Space after Zone:
18451.    ------------------------
18452.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18453.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18454.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18455. 
18456. Directory and Files Select:
18457. ---------------------------
18458. !ZoneTypeSelectCurrent!               
18459. ---------------------------
18460. ----------------------------------------------------------
18461. ")
18462. 
18463. 	# Add Zone Details to Report.	
18464. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
18465. !ZoneFooter!")
18466. 
18467. 
18468. 	
18469. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
18470. 			# Script: DisplaySetFileStep
18471. 
18472. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18473. 
18474. /* add message and move to a new line. */
18475. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18476. ")
18477. 
18478. /* display the line. (hopefully.) */
18479. # Zone Footer Set Statistics Window Text
18480. 
18481. SetStatisticsWindowText("----------------------------------------------------------
18482. Zones Processed: 
18483. ----------------------------------------------------------
18484. !ZoneListByLine!
18485. ----------------------------------------------------------
18486. Zone Processing Step:
18487. !ZoneStepByLine!    
18488. ----------------------------------------------------------
18489. Current Zone:
18490. !ZoneFooter!
18491. ----------------------------------------------------------
18492. Volume Statistics:
18493. !VolumeStatisticsDetail!
18494. ----------------------------------------------------------
18495. Zone Detailed Report:
18496. ----------------------------------------------------------
18497. !ZoneStatisticsDetail!
18498. ----------------------------------------------------------
18499. ")
18500. 
18501. 
18502. 
18503. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18504. 
18505. # Script: BannerSet
18506. 
18507. # Script: DisplaySetDateTimeRun
18508. 
18509. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
18510. /* Xinclude "..\Display\BannerSet.MyDc"X */
18511. /* pause(1) */
18512. 
18513. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18514. 
18515. Title('!Heading!')
18516. /* pause(1) */
18517. 
18518. /* NOTE: Can't round or truncate to integer precision. */
18519. 
18520. pause(1)
18521. 
18522. 			# File Action - Type Page Hiber Dump - Regular - SortByImportSequenceSkip.
18523. # File Action - SortByImportSequence with SkipBlock.
18524. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
18525. 	
18526. 	
18527. 
18528. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
18529. 		# Script: DisplaySetFileStep
18530. 
18531. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18532. 
18533. /* add message and move to a new line. */
18534. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18535. ")
18536. 
18537. /* display the line. (hopefully.) */
18538. # Zone Footer Set Statistics Window Text
18539. 
18540. SetStatisticsWindowText("----------------------------------------------------------
18541. Zones Processed: 
18542. ----------------------------------------------------------
18543. !ZoneListByLine!
18544. ----------------------------------------------------------
18545. Zone Processing Step:
18546. !ZoneStepByLine!    
18547. ----------------------------------------------------------
18548. Current Zone:
18549. !ZoneFooter!
18550. ----------------------------------------------------------
18551. Volume Statistics:
18552. !VolumeStatisticsDetail!
18553. ----------------------------------------------------------
18554. Zone Detailed Report:
18555. ----------------------------------------------------------
18556. !ZoneStatisticsDetail!
18557. ----------------------------------------------------------
18558. ")
18559. 
18560. 
18561. 
18562. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18563. 
18564. # Script: BannerSet
18565. 
18566. # Script: DisplaySetDateTimeRun
18567. 
18568. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
18569. /* Xinclude "..\Display\BannerSet.MyDc"X */
18570. /* pause(1) */
18571. 
18572. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18573. 
18574. Title('!Heading!')
18575. /* pause(1) */
18576. 
18577. /* NOTE: Can't round or truncate to integer precision. */
18578. 
18579. pause(1)
18580. 
18581. 		# Script: ZoneDoFooter
18582. 
18583. /* ---------------------------------------------------------- */
18584. # File Select
18585. 	# Select Statments
18586. # File Actions 
18587. 	# Standard or OS File Actions.
18588. 	# Resume...
18589. 	
18590. 	# your stuff HERE (X)... post zone (file) file actions code.
18591. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
18592. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18593. 		# (X)
18594. 		
18595. 		/* ??? Set window? */
18596. 	
18597. 	# ADD THE GAP
18598. 		
18599. # Vacate (good for diagnostics)
18600. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
18601. 
18602. # DoNotVacate - DO NOT Vacate (recommended)
18603. 
18604. # Vacate
18605. /* AddGap(GapUsedLoc) */
18606. 
18607. # DO Not Vacate
18608. AddGap(GapUsedLoc, DoNotVacate) 
18609. 	
18610. 	
18611. /* ---------------------------------------------------------- */
18612. # (failed) TEST for boolean logic.
18613. 
18614. /* It should work in the gap calculations for turning options */
18615. /* on and off but it will NOT work here. */
18616. 
18617. /* Boolean setting X or FlagX. */
18618. /* Where X will be on or off: */
18619. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
18620. /*      For ON:  (X  *  FlagAny) */
18621. 
18622. /* 1) Failed, zero gap overrode the previous one. */
18623. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
18624. /* AddGap(GapUsedTemp) */ 
18625. 
18626. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
18627. /* AddGap(GapUsedTemp, DoNotVacate) */ 
18628. 
18629. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
18630. 
18631. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
18632. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
18633. /* AddGap(GapUsedTemp) */ 
18634. 
18635. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
18636. /* AddGap(GapUsedTemp, DoNotVacate) */ 
18637. 
18638. /* ---------------------------------------------------------- */
18639. 
18640. # Vacate
18641. /* AddGap(GapUsed) */
18642. 
18643. # DO NOT Vacate (recommended)
18644. /* AddGap(GapUsed, DoNotVacate) */ 
18645. 	
18646. 
18647. 		
18648. # 
18649. FileEnd
18650. /* ---------------------------------------------------------- */
18651. 
18652. # your stuff HERE (X)... post zone (file) code.
18653. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
18654. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18655. 	# (X)
18656. 
18657. SetVariable(FileStepDescription,"Zone finished, reporting.")
18658. # Script: DisplaySetFileStep
18659. 
18660. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18661. 
18662. /* add message and move to a new line. */
18663. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18664. ")
18665. 
18666. /* display the line. (hopefully.) */
18667. # Zone Footer Set Statistics Window Text
18668. 
18669. SetStatisticsWindowText("----------------------------------------------------------
18670. Zones Processed: 
18671. ----------------------------------------------------------
18672. !ZoneListByLine!
18673. ----------------------------------------------------------
18674. Zone Processing Step:
18675. !ZoneStepByLine!    
18676. ----------------------------------------------------------
18677. Current Zone:
18678. !ZoneFooter!
18679. ----------------------------------------------------------
18680. Volume Statistics:
18681. !VolumeStatisticsDetail!
18682. ----------------------------------------------------------
18683. Zone Detailed Report:
18684. ----------------------------------------------------------
18685. !ZoneStatisticsDetail!
18686. ----------------------------------------------------------
18687. ")
18688. 
18689. 
18690. 
18691. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18692. 
18693. # Script: BannerSet
18694. 
18695. # Script: DisplaySetDateTimeRun
18696. 
18697. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
18698. /* Xinclude "..\Display\BannerSet.MyDc"X */
18699. /* pause(1) */
18700. 
18701. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18702. 
18703. Title('!Heading!')
18704. /* pause(1) */
18705. 
18706. /* NOTE: Can't round or truncate to integer precision. */
18707. 
18708. pause(1)
18709. 
18710. # Script: ZoneWhenFinished
18711. 
18712. # Script: BannerSet
18713. 
18714. # Script: DisplaySetDateTimeRun
18715. 
18716. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
18717. /* Xinclude "..\Display\BannerSet.MyDc"X */
18718. /* pause(1) */
18719. 
18720. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18721. 
18722. Title('!Heading!')
18723. /* pause(1) */
18724. 
18725. /* NOTE: Can't round or truncate to integer precision. */
18726. 
18727. # Script: BannerLog
18728. 
18729. AppendLogfile("!LogFileName!", "!Title!")
18730. 
18731. 
18732. 
18733. # Zone Statistics	
18734. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
18735. 
18736. # Footer:
18737. SetVariable(ZoneFooter, "----------------------------------------------------------
18738. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
18739. 
18740. Statistics Report:
18741. ------------------
18742.    Size:  
18743.    ------------------------
18744.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18745.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18746.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18747. 
18748.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18749.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18750. 
18751.    Location:
18752.    ------------------------
18753.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18754.              Files End: !ZoneEndCurrent!
18755.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18756.       
18757.    Gap Settings:
18758.    ------------------------
18759.          Gap Requested: !ZoneGapSizePer!%
18760.       Volume Rounding: !ZoneVolRoundUpPer!%
18761.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18762.                  
18763.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18764.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18765.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18766.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18767.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18768.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18769.      
18770.    Free Space after Zone:
18771.    ------------------------
18772.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18773.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18774.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18775. 
18776. Directory and Files Select:
18777. ---------------------------
18778. !ZoneTypeSelectCurrent!               
18779. ---------------------------
18780. ----------------------------------------------------------
18781. ")
18782. 
18783. AppendLogfile("!LogFileName!", ".")
18784. AppendLogfile("!LogFileName!", "!ZoneFooter!")
18785. AppendLogfile("!LogFileName!", ".")
18786. 
18787. # Zone Footer Set Statistics Window Text
18788. 
18789. SetStatisticsWindowText("----------------------------------------------------------
18790. Zones Processed: 
18791. ----------------------------------------------------------
18792. !ZoneListByLine!
18793. ----------------------------------------------------------
18794. Zone Processing Step:
18795. !ZoneStepByLine!    
18796. ----------------------------------------------------------
18797. Current Zone:
18798. !ZoneFooter!
18799. ----------------------------------------------------------
18800. Volume Statistics:
18801. !VolumeStatisticsDetail!
18802. ----------------------------------------------------------
18803. Zone Detailed Report:
18804. ----------------------------------------------------------
18805. !ZoneStatisticsDetail!
18806. ----------------------------------------------------------
18807. ")
18808. 
18809. 
18810. 
18811. /* pause() */
18812. /* pause() */
18813. 
18814. 
18815. 
18816. /* ---------------------------------------------------------- */
18817.   
18818. 
18819. /* ---------------------------------------------------------- */
18820. 
18821. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
18822. 
18823. /* ---------------------------------------------------------- */
18824. /* Zone Games */
18825. # Script: DefragZoneTypeGames
18826. /* ---------------------------------------------------------- */
18827. /* Zone Games */
18828. SetVariable(ZoneLabel, "!ZoneLabelGames!")
18829. SetVariable(ZoneDescription, "!ZoneDescriptionGames!")
18830. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpGames!")
18831. SetVariable(ZoneGapSize, "!ZoneGapSizeGames!")
18832. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectGames
18833. # Games start.
18834. # NotBlobsArchivesBu start.
18835. (not (
18836. # Blobs start.
18837. (
18838. # BlobsAndExceptions start.
18839. ( not(
18840.   FileName("*.bat")
18841.   or FileName("*.css")
18842.   or FileName("*.dll")
18843.   or FileName("*.exe")
18844.   or FileName("*.htm*")
18845.   or FileName("*.jar")
18846.   or FileName("*.js")
18847.   or FileName("*.script")
18848.   or FileName("*.wsf")
18849.   or (
18850. # Databases start.
18851. (
18852.   FileName("*.crypt*")
18853.   or FileName("*.db*")
18854.   or FileName("*.rdb*")
18855.   or FileName("*.dc*")
18856.   or FileName("*.dict*")
18857.   or FileName("*.?db*")
18858.   or FileName("*.?rdb*")
18859.   or FileName("*.md*")
18860.   or FileName("*.myd")
18861.   or FileName("*.ndf")
18862.   or FileName("*.ns?")
18863.   or FileName("*.pab")
18864.   or FileName("*.pst")
18865.   or FileName("*.sd?*")
18866.   or FileName("*.sq**")
18867.   or FileName("*.tmd")
18868.   or FileName("*.tps")
18869.   or FileName("*.tr*")
18870. )
18871. # Databases end.
18872. 
18873.     # BlobsAndExceptions
18874.     or 
18875. # Data start.
18876. (
18877.   DirectoryName("Data*")
18878.   or DirectoryName("Device*")
18879.   or DirectoryName("Export*")
18880.   or DirectoryName("Import*")
18881.   or DirectoryName("Log*")
18882.   or DirectoryName("*Log")
18883.   or DirectoryName("Maintenance*")
18884.   or DirectoryName("Rec*")
18885.   or DirectoryName("Sales*")
18886.   or DirectoryName("Search*")
18887.   or DirectoryName("User*")
18888. )
18889. # Data end.
18890. 
18891.     # BlobsAndExceptions
18892.   )
18893. ) )
18894. # BlobsAndExceptions end.
18895. 
18896. # Blobs
18897. ) and (
18898.   Size(BlobFileSize,0)
18899.   or (
18900.     FileName("*.arj")
18901.     or FileName("*.bup")
18902.     or FileName("*.bz2")
18903.     or FileName("*.chm")
18904.     or FileName("*.dvr-ms")
18905.     or FileName("*.gz")
18906.     or FileName("*.ifo")
18907.     or FileName("*.lzh")
18908.     or FileName("*.pdf")
18909.     or FileName("*.rpm")
18910.     or FileName("*.wmv")
18911.     or FileName("*.vob")
18912.     or FileName("*.z")
18913.   ) 
18914. )
18915. # Blobs end.
18916. 
18917. # NotBlobsArchivesBu
18918. or 
18919. # Archives start.
18920. (
18921.   DirectoryName("*Archive*")
18922.   or DirectoryName("*History*")
18923.   or DirectoryName("*Old")
18924.   or DirectoryName("* Old *")
18925.   or DirectoryName("Old *")
18926. 
18927.   or FileName("*.7z")
18928.   or FileName("*.cab")
18929.   or FileName("*.iso")
18930.   or FileName("*.msi")
18931.   or FileName("*.old")
18932.   or FileName("*.rar")
18933.   or FileName("*.tar")
18934.   or FileName("*.zip")
18935.   or
18936. # WinSysLow start.
18937. (
18938.   DirectoryName("$*")
18939.   or DirectoryName("0*")
18940.   or DirectoryName("1*")
18941.   or DirectoryName("2*")
18942.   or DirectoryName("3*")
18943.   or DirectoryName("4*")
18944.   or DirectoryName("5*")
18945.   or DirectoryName("6*")
18946.   or DirectoryName("7*")
18947.   or DirectoryName("8*")
18948.   or DirectoryName("9*")
18949. 
18950.   or DirectoryName("dllcache")
18951.   or DirectoryName("Downloaded Installations")
18952.   or DirectoryName("Ehome")
18953.   or DirectoryName("Fonts")
18954.   or DirectoryName("Help")
18955.   or DirectoryName("I386")
18956.   or DirectoryName("ie?updates")
18957.   or DirectoryName("Installer")
18958.   or DirectoryName("Installshield Installation Information")
18959.   or DirectoryName("IME")
18960.   or DirectoryName("*RECYCLE*")
18961.   or DirectoryName("ServicePackFiles")
18962.   or DirectoryName("SoftwareDistribution")
18963.   or DirectoryName("Speech")
18964.   or DirectoryName("Symbols")
18965.   or DirectoryName("System Volume Information")
18966.   or DirectoryName("windows.old")
18967. )
18968. # WinSysLow end.
18969. 
18970.   # Archives
18971. )
18972. # Archives end.
18973. 
18974. # NotBlobsArchivesBu
18975. or
18976. # Backups start.
18977. (
18978.   DirectoryName("*Backup*")
18979.   or DirectoryName("*Bu")
18980.   or DirectoryName("* Bu *")
18981.   or DirectoryName("Bu *")
18982. 
18983.   or FileName("*.bak")
18984.   or FileName("* - Copy*")
18985. )
18986. # Backups end.
18987. 
18988. # NotBlobsArchivesBu
18989. ) )
18990. # NotBlobsArchivesBu end.
18991. 
18992. # People
18993. and (
18994. # Games start.
18995. (
18996.   DirectoryName("Game*")
18997.   or DirectoryName("Epic*")
18998.   or DirectoryName("*XBox*")
18999.   or DirectoryName("*PS2*")
19000. )
19001. # Games end.
19002. 
19003. # People
19004. )
19005. # People end.
19006. ')
19007. 
19008. 	# Script: ZoneDoHeader
19009. 
19010. # Script: ZoneWhenStarted
19011. 
19012. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
19013. # Script: DisplaySetZone
19014. 
19015. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
19016. SetVariable(FileStepDescription,	"")
19017. 
19018. SetVariable(ZoneStepByLine, 			"Zone started.
19019. ")
19020. 
19021. # Script: BannerDescriptionSet
19022. 
19023. # Script: BannerSet
19024. 
19025. # Script: DisplaySetDateTimeRun
19026. 
19027. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
19028. /* Xinclude "..\Display\BannerSet.MyDc"X */
19029. /* pause(1) */
19030. 
19031. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19032. 
19033. Title('!Heading!')
19034. /* pause(1) */
19035. 
19036. /* NOTE: Can't round or truncate to integer precision. */
19037. 
19038. # Script: BannerLog
19039. 
19040. AppendLogfile("!LogFileName!", "!Title!")
19041. 
19042. 
19043. 
19044. pause(1)
19045. 
19046. 
19047. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
19048. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
19049. 
19050. SetVariable(ZoneStepNoCurrent, 0)
19051. 
19052. 
19053. # Script: ZoneDoCurrentClear
19054. 
19055. SetVariable(ZoneTypeSelectCurrent, 		"")
19056. 
19057. SetVariable(ZoneBeginCurrent, 			0)
19058. SetVariable(ZoneBeginPerCurrent, 		0)
19059. SetVariable(ZoneEndCurrent, 			0)
19060. SetVariable(ZoneEndPerCurrent, 			0)
19061. 
19062. SetVariable(ZoneSizeCurrent,			0)
19063. SetVariable(ZoneSizePerCurrent,			0)
19064. 
19065. SetVariable(ZoneGapRequestedCurrent,	0)
19066. SetVariable(ZoneGapRoundedCurrent, 		0)
19067. SetVariable(ZoneGapAdjustedCurrent, 	0)
19068. SetVariable(ZoneGapAvailableCurrent, 	0)
19069. SetVariable(ZoneGapCurrent,				0)
19070. SetVariable(ZoneGapUsedCurrent, 		0)
19071. 
19072. SetVariable(ZoneGapActualCurrent, 		0)
19073. SetVariable(ZoneGapActualPerCurrent, 	0)
19074. 
19075. SetVariable(ZoneSizeActual, 			0)
19076. SetVariable(ZoneSizeActualCurrent,		0)
19077. 
19078. SetVariable(ZoneEndActual, 				0)
19079. SetVariable(ZoneEndActualCurrent,		0)			
19080. SetVariable(ZoneSizeActualPerCurrent, 	0)
19081.       
19082. SetVariable(ZoneFilesFolders,			0)
19083. SetVariable(ZoneFilesFoldersPer,		0) 
19084. 
19085. SetVariable(ZoneFragments,				0)
19086. SetVariable(ZoneFragmentsPer,			0) 
19087. 		
19088. SetVariable(ZoneEndActualCurrent, 		0)
19089. SetVariable(ZoneEndActualPerCurrent, 	0)
19090. 
19091. # Gap Calculation Methodology:
19092. 	# Requested
19093. 	SetVariable(GapRequested, 			0) 
19094. 	SetVariable(GapRequestedStd, 		0) 
19095. 	SetVariable(GapRequestedMft, 		0) 
19096. 	SetVariable(GapRequestedOs, 		0) 
19097. 	SetVariable(GapRequestedOriginal, 	0) 
19098. 	
19099. 	# Gap Adjustments
19100. 	SetVariable(GapRounded, 			0)
19101. 	# SetVariable(GapAdjusted, 			0)
19102. 	SetVariable(GapAvailable, 			0)
19103. 	SetVariable(GapCurrent, 			0)
19104. 	SetVariable(GapActual, 				0)
19105. 	SetVariable(GapUsed, 				0)
19106. 	
19107. 	# Gap Adjustments
19108. 	SetVariable(GapRoundedLoc, 			0)
19109. 	# SetVariable(GapAdjustedLoc, 		0)
19110. 	SetVariable(GapAvailableLoc, 		0)
19111. 	SetVariable(GapCurrentLoc, 			0)
19112. 	SetVariable(GapActualLoc,			0)
19113. 	SetVariable(GapUsedLoc,				0)
19114. 	
19115. 	# Space usage
19116. 	SetVariable(ZoneFreePerRequested, 	0)
19117. 	SetVariable(ZoneFreePerUsed, 		0)
19118. 
19119. # Gap Size & Rounding
19120. 	SetVariable(ZoneGapSizePer, 		0)
19121. 	SetVariable(ZoneVolRoundUpPer, 		0)
19122. 	
19123. 	# Free Space
19124. 	SetVariable(ZoneFreeUsedPer, 		0)
19125. 	SetVariable(ZoneFreeRequestedPer, 	0)
19126. 
19127. 
19128. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
19129. 
19130. # Footer:
19131. SetVariable(ZoneFooter, "----------------------------------------------------------
19132. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
19133. 
19134. Statistics Report:
19135. ------------------
19136.    Size:  
19137.    ------------------------
19138.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19139.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19140.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19141. 
19142.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19143.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19144. 
19145.    Location:
19146.    ------------------------
19147.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19148.              Files End: !ZoneEndCurrent!
19149.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19150.       
19151.    Gap Settings:
19152.    ------------------------
19153.          Gap Requested: !ZoneGapSizePer!%
19154.       Volume Rounding: !ZoneVolRoundUpPer!%
19155.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19156.                  
19157.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
19158.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
19159.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
19160.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
19161.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
19162.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
19163.      
19164.    Free Space after Zone:
19165.    ------------------------
19166.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19167.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19168.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19169. 
19170. Directory and Files Select:
19171. ---------------------------
19172. !ZoneTypeSelectCurrent!               
19173. ---------------------------
19174. ----------------------------------------------------------
19175. ")
19176. 
19177. # Script: BannerSet
19178. 
19179. # Script: DisplaySetDateTimeRun
19180. 
19181. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
19182. /* Xinclude "..\Display\BannerSet.MyDc"X */
19183. /* pause(1) */
19184. 
19185. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19186. 
19187. Title('!Heading!')
19188. /* pause(1) */
19189. 
19190. /* NOTE: Can't round or truncate to integer precision. */
19191. 
19192. # Script: BannerLog
19193. 
19194. AppendLogfile("!LogFileName!", "!Title!")
19195. 
19196. 
19197. 
19198. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
19199. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
19200. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:45")
19201. 
19202. SetVariable(ZoneListByLine, "!ZoneListByLine!
19203. Zone: !ZoneNoCurrent! 2021-11-09 20:22:45 0:00:04 !ZoneLabel! !ZoneDescription!")
19204. 
19205. 
19206. /* Fixed Zone Position Handling */
19207. /* Literal number: */
19208. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
19209. /* Percentage of disk: */
19210. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
19211. /* Gap */
19212. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
19213. 
19214. /* ---------------------------------------------------------- */
19215. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
19216. # Script: DisplaySetFileStep
19217. 
19218. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19219. 
19220. /* add message and move to a new line. */
19221. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19222. ")
19223. 
19224. /* display the line. (hopefully.) */
19225. # Zone Footer Set Statistics Window Text
19226. 
19227. SetStatisticsWindowText("----------------------------------------------------------
19228. Zones Processed: 
19229. ----------------------------------------------------------
19230. !ZoneListByLine!
19231. ----------------------------------------------------------
19232. Zone Processing Step:
19233. !ZoneStepByLine!    
19234. ----------------------------------------------------------
19235. Current Zone:
19236. !ZoneFooter!
19237. ----------------------------------------------------------
19238. Volume Statistics:
19239. !VolumeStatisticsDetail!
19240. ----------------------------------------------------------
19241. Zone Detailed Report:
19242. ----------------------------------------------------------
19243. !ZoneStatisticsDetail!
19244. ----------------------------------------------------------
19245. ")
19246. 
19247. 
19248. 
19249. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19250. 
19251. # Script: BannerSet
19252. 
19253. # Script: DisplaySetDateTimeRun
19254. 
19255. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
19256. /* Xinclude "..\Display\BannerSet.MyDc"X */
19257. /* pause(1) */
19258. 
19259. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19260. 
19261. Title('!Heading!')
19262. /* pause(1) */
19263. 
19264. /* NOTE: Can't round or truncate to integer precision. */
19265. 
19266. pause(1)
19267. 
19268. # your stuff HERE (X)... pre file select code.
19269. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
19270. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19271. 	# (X)
19272. 
19273. FileSelect
19274. 
19275. 	# your stuff can't really go here (errors.)
19276. 	# maybe for some reason I don't know of...
19277. 	
19278. 	# Actions next...
19279. 	# Script: ZoneDo ZoneTypeSelectGames
19280. # Games start.
19281. # NotBlobsArchivesBu start.
19282. (not (
19283. # Blobs start.
19284. (
19285. # BlobsAndExceptions start.
19286. ( not(
19287.   FileName("*.bat")
19288.   or FileName("*.css")
19289.   or FileName("*.dll")
19290.   or FileName("*.exe")
19291.   or FileName("*.htm*")
19292.   or FileName("*.jar")
19293.   or FileName("*.js")
19294.   or FileName("*.script")
19295.   or FileName("*.wsf")
19296.   or (
19297. # Databases start.
19298. (
19299.   FileName("*.crypt*")
19300.   or FileName("*.db*")
19301.   or FileName("*.rdb*")
19302.   or FileName("*.dc*")
19303.   or FileName("*.dict*")
19304.   or FileName("*.?db*")
19305.   or FileName("*.?rdb*")
19306.   or FileName("*.md*")
19307.   or FileName("*.myd")
19308.   or FileName("*.ndf")
19309.   or FileName("*.ns?")
19310.   or FileName("*.pab")
19311.   or FileName("*.pst")
19312.   or FileName("*.sd?*")
19313.   or FileName("*.sq**")
19314.   or FileName("*.tmd")
19315.   or FileName("*.tps")
19316.   or FileName("*.tr*")
19317. )
19318. # Databases end.
19319. 
19320.     # BlobsAndExceptions
19321.     or 
19322. # Data start.
19323. (
19324.   DirectoryName("Data*")
19325.   or DirectoryName("Device*")
19326.   or DirectoryName("Export*")
19327.   or DirectoryName("Import*")
19328.   or DirectoryName("Log*")
19329.   or DirectoryName("*Log")
19330.   or DirectoryName("Maintenance*")
19331.   or DirectoryName("Rec*")
19332.   or DirectoryName("Sales*")
19333.   or DirectoryName("Search*")
19334.   or DirectoryName("User*")
19335. )
19336. # Data end.
19337. 
19338.     # BlobsAndExceptions
19339.   )
19340. ) )
19341. # BlobsAndExceptions end.
19342. 
19343. # Blobs
19344. ) and (
19345.   Size(BlobFileSize,0)
19346.   or (
19347.     FileName("*.arj")
19348.     or FileName("*.bup")
19349.     or FileName("*.bz2")
19350.     or FileName("*.chm")
19351.     or FileName("*.dvr-ms")
19352.     or FileName("*.gz")
19353.     or FileName("*.ifo")
19354.     or FileName("*.lzh")
19355.     or FileName("*.pdf")
19356.     or FileName("*.rpm")
19357.     or FileName("*.wmv")
19358.     or FileName("*.vob")
19359.     or FileName("*.z")
19360.   ) 
19361. )
19362. # Blobs end.
19363. 
19364. # NotBlobsArchivesBu
19365. or 
19366. # Archives start.
19367. (
19368.   DirectoryName("*Archive*")
19369.   or DirectoryName("*History*")
19370.   or DirectoryName("*Old")
19371.   or DirectoryName("* Old *")
19372.   or DirectoryName("Old *")
19373. 
19374.   or FileName("*.7z")
19375.   or FileName("*.cab")
19376.   or FileName("*.iso")
19377.   or FileName("*.msi")
19378.   or FileName("*.old")
19379.   or FileName("*.rar")
19380.   or FileName("*.tar")
19381.   or FileName("*.zip")
19382.   or
19383. # WinSysLow start.
19384. (
19385.   DirectoryName("$*")
19386.   or DirectoryName("0*")
19387.   or DirectoryName("1*")
19388.   or DirectoryName("2*")
19389.   or DirectoryName("3*")
19390.   or DirectoryName("4*")
19391.   or DirectoryName("5*")
19392.   or DirectoryName("6*")
19393.   or DirectoryName("7*")
19394.   or DirectoryName("8*")
19395.   or DirectoryName("9*")
19396. 
19397.   or DirectoryName("dllcache")
19398.   or DirectoryName("Downloaded Installations")
19399.   or DirectoryName("Ehome")
19400.   or DirectoryName("Fonts")
19401.   or DirectoryName("Help")
19402.   or DirectoryName("I386")
19403.   or DirectoryName("ie?updates")
19404.   or DirectoryName("Installer")
19405.   or DirectoryName("Installshield Installation Information")
19406.   or DirectoryName("IME")
19407.   or DirectoryName("*RECYCLE*")
19408.   or DirectoryName("ServicePackFiles")
19409.   or DirectoryName("SoftwareDistribution")
19410.   or DirectoryName("Speech")
19411.   or DirectoryName("Symbols")
19412.   or DirectoryName("System Volume Information")
19413.   or DirectoryName("windows.old")
19414. )
19415. # WinSysLow end.
19416. 
19417.   # Archives
19418. )
19419. # Archives end.
19420. 
19421. # NotBlobsArchivesBu
19422. or
19423. # Backups start.
19424. (
19425.   DirectoryName("*Backup*")
19426.   or DirectoryName("*Bu")
19427.   or DirectoryName("* Bu *")
19428.   or DirectoryName("Bu *")
19429. 
19430.   or FileName("*.bak")
19431.   or FileName("* - Copy*")
19432. )
19433. # Backups end.
19434. 
19435. # NotBlobsArchivesBu
19436. ) )
19437. # NotBlobsArchivesBu end.
19438. 
19439. # People
19440. and (
19441. # Games start.
19442. (
19443.   DirectoryName("Game*")
19444.   or DirectoryName("Epic*")
19445.   or DirectoryName("*XBox*")
19446.   or DirectoryName("*PS2*")
19447. )
19448. # Games end.
19449. 
19450. # People
19451. )
19452. # People end.
19453. 
19454. 	# Script: ZoneDoAction
19455. # Zone Do File Action - SortByName.
19456. 
19457. FileActions
19458. 
19459. 	# Footer:
19460. SetVariable(ZoneFooter, "----------------------------------------------------------
19461. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
19462. 
19463. Statistics Report:
19464. ------------------
19465.    Size:  
19466.    ------------------------
19467.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19468.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19469.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19470. 
19471.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19472.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19473. 
19474.    Location:
19475.    ------------------------
19476.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19477.              Files End: !ZoneEndCurrent!
19478.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19479.       
19480.    Gap Settings:
19481.    ------------------------
19482.          Gap Requested: !ZoneGapSizePer!%
19483.       Volume Rounding: !ZoneVolRoundUpPer!%
19484.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19485.                  
19486.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
19487.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
19488.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
19489.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
19490.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
19491.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
19492.      
19493.    Free Space after Zone:
19494.    ------------------------
19495.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19496.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19497.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19498. 
19499. Directory and Files Select:
19500. ---------------------------
19501. !ZoneTypeSelectCurrent!               
19502. ---------------------------
19503. ----------------------------------------------------------
19504. ")
19505. 	SetStatisticsWindowText("!ZoneFooter!")
19506. 	
19507. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
19508. 	# Script: DisplaySetFileStep
19509. 
19510. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19511. 
19512. /* add message and move to a new line. */
19513. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19514. ")
19515. 
19516. /* display the line. (hopefully.) */
19517. # Zone Footer Set Statistics Window Text
19518. 
19519. SetStatisticsWindowText("----------------------------------------------------------
19520. Zones Processed: 
19521. ----------------------------------------------------------
19522. !ZoneListByLine!
19523. ----------------------------------------------------------
19524. Zone Processing Step:
19525. !ZoneStepByLine!    
19526. ----------------------------------------------------------
19527. Current Zone:
19528. !ZoneFooter!
19529. ----------------------------------------------------------
19530. Volume Statistics:
19531. !VolumeStatisticsDetail!
19532. ----------------------------------------------------------
19533. Zone Detailed Report:
19534. ----------------------------------------------------------
19535. !ZoneStatisticsDetail!
19536. ----------------------------------------------------------
19537. ")
19538. 
19539. 
19540. 
19541. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19542. 
19543. # Script: BannerSet
19544. 
19545. # Script: DisplaySetDateTimeRun
19546. 
19547. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
19548. /* Xinclude "..\Display\BannerSet.MyDc"X */
19549. /* pause(1) */
19550. 
19551. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19552. 
19553. Title('!Heading!')
19554. /* pause(1) */
19555. 
19556. /* NOTE: Can't round or truncate to integer precision. */
19557. 
19558. pause(1)
19559. 
19560. # Commands:
19561. 
19562. /* Moves to Zone or above it. */
19563. # MoveUpToZone()
19564. 
19565. # Defrag
19566. 
19567. # Defragment(OPTIONS)
19568. 
19569. /* Shuffles files around trying to make a big enough gap for fragmented files. */
19570. # Defragment()
19571. 
19572. /* Only does files where a gap will fit it. */
19573. # Defragment(Fast)
19574. 
19575. /* Skips fragmented files larger than the Chunck Size.
19576. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
19577. # Defragment(Chunk Size)
19578. 
19579. /* Moves down to zone and packs zone to beginning if there are gaps. */
19580. /* Can be similar in performance to doing a SortBy. */
19581. # MoveDownFill()
19582. 
19583. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
19584. 
19585. 
19586. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
19587. 	# Script: DisplaySetFileStep
19588. 
19589. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19590. 
19591. /* add message and move to a new line. */
19592. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19593. ")
19594. 
19595. /* display the line. (hopefully.) */
19596. # Zone Footer Set Statistics Window Text
19597. 
19598. SetStatisticsWindowText("----------------------------------------------------------
19599. Zones Processed: 
19600. ----------------------------------------------------------
19601. !ZoneListByLine!
19602. ----------------------------------------------------------
19603. Zone Processing Step:
19604. !ZoneStepByLine!    
19605. ----------------------------------------------------------
19606. Current Zone:
19607. !ZoneFooter!
19608. ----------------------------------------------------------
19609. Volume Statistics:
19610. !VolumeStatisticsDetail!
19611. ----------------------------------------------------------
19612. Zone Detailed Report:
19613. ----------------------------------------------------------
19614. !ZoneStatisticsDetail!
19615. ----------------------------------------------------------
19616. ")
19617. 
19618. 
19619. 
19620. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19621. 
19622. # Script: BannerSet
19623. 
19624. # Script: DisplaySetDateTimeRun
19625. 
19626. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
19627. /* Xinclude "..\Display\BannerSet.MyDc"X */
19628. /* pause(1) */
19629. 
19630. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19631. 
19632. Title('!Heading!')
19633. /* pause(1) */
19634. 
19635. /* NOTE: Can't round or truncate to integer precision. */
19636. 
19637. pause(1)
19638. 
19639. 	# Script: ZoneDoFooter
19640. 
19641. /* ---------------------------------------------------------- */
19642. # File Select
19643. 	# Select Statments
19644. # File Actions 
19645. 	# Standard or OS File Actions.
19646. 	# Resume...
19647. 	
19648. 	# your stuff HERE (X)... post zone (file) file actions code.
19649. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
19650. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19651. 		# (X)
19652. 		
19653. 		/* ??? Set window? */
19654. 	
19655. 	# ADD THE GAP
19656. 		
19657. # Vacate (good for diagnostics)
19658. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
19659. 
19660. # DoNotVacate - DO NOT Vacate (recommended)
19661. 
19662. # Vacate
19663. /* AddGap(GapUsedLoc) */
19664. 
19665. # DO Not Vacate
19666. AddGap(GapUsedLoc, DoNotVacate) 
19667. 	
19668. 	
19669. /* ---------------------------------------------------------- */
19670. # (failed) TEST for boolean logic.
19671. 
19672. /* It should work in the gap calculations for turning options */
19673. /* on and off but it will NOT work here. */
19674. 
19675. /* Boolean setting X or FlagX. */
19676. /* Where X will be on or off: */
19677. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
19678. /*      For ON:  (X  *  FlagAny) */
19679. 
19680. /* 1) Failed, zero gap overrode the previous one. */
19681. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
19682. /* AddGap(GapUsedTemp) */ 
19683. 
19684. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
19685. /* AddGap(GapUsedTemp, DoNotVacate) */ 
19686. 
19687. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
19688. 
19689. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
19690. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
19691. /* AddGap(GapUsedTemp) */ 
19692. 
19693. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
19694. /* AddGap(GapUsedTemp, DoNotVacate) */ 
19695. 
19696. /* ---------------------------------------------------------- */
19697. 
19698. # Vacate
19699. /* AddGap(GapUsed) */
19700. 
19701. # DO NOT Vacate (recommended)
19702. /* AddGap(GapUsed, DoNotVacate) */ 
19703. 	
19704. 
19705. 		
19706. # 
19707. FileEnd
19708. /* ---------------------------------------------------------- */
19709. 
19710. # your stuff HERE (X)... post zone (file) code.
19711. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
19712. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19713. 	# (X)
19714. 
19715. SetVariable(FileStepDescription,"Zone finished, reporting.")
19716. # Script: DisplaySetFileStep
19717. 
19718. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19719. 
19720. /* add message and move to a new line. */
19721. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19722. ")
19723. 
19724. /* display the line. (hopefully.) */
19725. # Zone Footer Set Statistics Window Text
19726. 
19727. SetStatisticsWindowText("----------------------------------------------------------
19728. Zones Processed: 
19729. ----------------------------------------------------------
19730. !ZoneListByLine!
19731. ----------------------------------------------------------
19732. Zone Processing Step:
19733. !ZoneStepByLine!    
19734. ----------------------------------------------------------
19735. Current Zone:
19736. !ZoneFooter!
19737. ----------------------------------------------------------
19738. Volume Statistics:
19739. !VolumeStatisticsDetail!
19740. ----------------------------------------------------------
19741. Zone Detailed Report:
19742. ----------------------------------------------------------
19743. !ZoneStatisticsDetail!
19744. ----------------------------------------------------------
19745. ")
19746. 
19747. 
19748. 
19749. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19750. 
19751. # Script: BannerSet
19752. 
19753. # Script: DisplaySetDateTimeRun
19754. 
19755. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
19756. /* Xinclude "..\Display\BannerSet.MyDc"X */
19757. /* pause(1) */
19758. 
19759. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19760. 
19761. Title('!Heading!')
19762. /* pause(1) */
19763. 
19764. /* NOTE: Can't round or truncate to integer precision. */
19765. 
19766. pause(1)
19767. 
19768. # Script: ZoneWhenFinished
19769. 
19770. # Script: BannerSet
19771. 
19772. # Script: DisplaySetDateTimeRun
19773. 
19774. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:45 0:00:04")
19775. /* Xinclude "..\Display\BannerSet.MyDc"X */
19776. /* pause(1) */
19777. 
19778. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19779. 
19780. Title('!Heading!')
19781. /* pause(1) */
19782. 
19783. /* NOTE: Can't round or truncate to integer precision. */
19784. 
19785. # Script: BannerLog
19786. 
19787. AppendLogfile("!LogFileName!", "!Title!")
19788. 
19789. 
19790. 
19791. # Zone Statistics	
19792. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
19793. 
19794. # Footer:
19795. SetVariable(ZoneFooter, "----------------------------------------------------------
19796. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:45
19797. 
19798. Statistics Report:
19799. ------------------
19800.    Size:  
19801.    ------------------------
19802.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19803.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19804.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19805. 
19806.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19807.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19808. 
19809.    Location:
19810.    ------------------------
19811.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19812.              Files End: !ZoneEndCurrent!
19813.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19814.       
19815.    Gap Settings:
19816.    ------------------------
19817.          Gap Requested: !ZoneGapSizePer!%
19818.       Volume Rounding: !ZoneVolRoundUpPer!%
19819.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19820.                  
19821.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
19822.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
19823.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
19824.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
19825.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
19826.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
19827.      
19828.    Free Space after Zone:
19829.    ------------------------
19830.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19831.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19832.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19833. 
19834. Directory and Files Select:
19835. ---------------------------
19836. !ZoneTypeSelectCurrent!               
19837. ---------------------------
19838. ----------------------------------------------------------
19839. ")
19840. 
19841. AppendLogfile("!LogFileName!", ".")
19842. AppendLogfile("!LogFileName!", "!ZoneFooter!")
19843. AppendLogfile("!LogFileName!", ".")
19844. 
19845. # Zone Footer Set Statistics Window Text
19846. 
19847. SetStatisticsWindowText("----------------------------------------------------------
19848. Zones Processed: 
19849. ----------------------------------------------------------
19850. !ZoneListByLine!
19851. ----------------------------------------------------------
19852. Zone Processing Step:
19853. !ZoneStepByLine!    
19854. ----------------------------------------------------------
19855. Current Zone:
19856. !ZoneFooter!
19857. ----------------------------------------------------------
19858. Volume Statistics:
19859. !VolumeStatisticsDetail!
19860. ----------------------------------------------------------
19861. Zone Detailed Report:
19862. ----------------------------------------------------------
19863. !ZoneStatisticsDetail!
19864. ----------------------------------------------------------
19865. ")
19866. 
19867. 
19868. 
19869. /* pause() */
19870. /* pause() */
19871. 
19872. 
19873. 
19874. 
19875. /* ---------------------------------------------------------- */
19876. 
19877. 
19878. /* ---------------------------------------------------------- */
19879. /* Zone Shares */
19880. # Script: DefragZoneTypeShares
19881. /* ---------------------------------------------------------- */
19882. /* Zone Shares */
19883. SetVariable(ZoneLabel, "!ZoneLabelShares!")
19884. SetVariable(ZoneDescription, "!ZoneDescriptionShares!")
19885. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpShares!")
19886. SetVariable(ZoneGapSize, "!ZoneGapSizeShares!")
19887. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectShares
19888. # Shares start.
19889. # NotBlobsArchivesBu start.
19890. (not (
19891. # Blobs start.
19892. (
19893. # BlobsAndExceptions start.
19894. ( not(
19895.   FileName("*.bat")
19896.   or FileName("*.css")
19897.   or FileName("*.dll")
19898.   or FileName("*.exe")
19899.   or FileName("*.htm*")
19900.   or FileName("*.jar")
19901.   or FileName("*.js")
19902.   or FileName("*.script")
19903.   or FileName("*.wsf")
19904.   or (
19905. # Databases start.
19906. (
19907.   FileName("*.crypt*")
19908.   or FileName("*.db*")
19909.   or FileName("*.rdb*")
19910.   or FileName("*.dc*")
19911.   or FileName("*.dict*")
19912.   or FileName("*.?db*")
19913.   or FileName("*.?rdb*")
19914.   or FileName("*.md*")
19915.   or FileName("*.myd")
19916.   or FileName("*.ndf")
19917.   or FileName("*.ns?")
19918.   or FileName("*.pab")
19919.   or FileName("*.pst")
19920.   or FileName("*.sd?*")
19921.   or FileName("*.sq**")
19922.   or FileName("*.tmd")
19923.   or FileName("*.tps")
19924.   or FileName("*.tr*")
19925. )
19926. # Databases end.
19927. 
19928.     # BlobsAndExceptions
19929.     or 
19930. # Data start.
19931. (
19932.   DirectoryName("Data*")
19933.   or DirectoryName("Device*")
19934.   or DirectoryName("Export*")
19935.   or DirectoryName("Import*")
19936.   or DirectoryName("Log*")
19937.   or DirectoryName("*Log")
19938.   or DirectoryName("Maintenance*")
19939.   or DirectoryName("Rec*")
19940.   or DirectoryName("Sales*")
19941.   or DirectoryName("Search*")
19942.   or DirectoryName("User*")
19943. )
19944. # Data end.
19945. 
19946.     # BlobsAndExceptions
19947.   )
19948. ) )
19949. # BlobsAndExceptions end.
19950. 
19951. # Blobs
19952. ) and (
19953.   Size(BlobFileSize,0)
19954.   or (
19955.     FileName("*.arj")
19956.     or FileName("*.bup")
19957.     or FileName("*.bz2")
19958.     or FileName("*.chm")
19959.     or FileName("*.dvr-ms")
19960.     or FileName("*.gz")
19961.     or FileName("*.ifo")
19962.     or FileName("*.lzh")
19963.     or FileName("*.pdf")
19964.     or FileName("*.rpm")
19965.     or FileName("*.wmv")
19966.     or FileName("*.vob")
19967.     or FileName("*.z")
19968.   ) 
19969. )
19970. # Blobs end.
19971. 
19972. # NotBlobsArchivesBu
19973. or 
19974. # Archives start.
19975. (
19976.   DirectoryName("*Archive*")
19977.   or DirectoryName("*History*")
19978.   or DirectoryName("*Old")
19979.   or DirectoryName("* Old *")
19980.   or DirectoryName("Old *")
19981. 
19982.   or FileName("*.7z")
19983.   or FileName("*.cab")
19984.   or FileName("*.iso")
19985.   or FileName("*.msi")
19986.   or FileName("*.old")
19987.   or FileName("*.rar")
19988.   or FileName("*.tar")
19989.   or FileName("*.zip")
19990.   or
19991. # WinSysLow start.
19992. (
19993.   DirectoryName("$*")
19994.   or DirectoryName("0*")
19995.   or DirectoryName("1*")
19996.   or DirectoryName("2*")
19997.   or DirectoryName("3*")
19998.   or DirectoryName("4*")
19999.   or DirectoryName("5*")
20000.   or DirectoryName("6*")
20001.   or DirectoryName("7*")
20002.   or DirectoryName("8*")
20003.   or DirectoryName("9*")
20004. 
20005.   or DirectoryName("dllcache")
20006.   or DirectoryName("Downloaded Installations")
20007.   or DirectoryName("Ehome")
20008.   or DirectoryName("Fonts")
20009.   or DirectoryName("Help")
20010.   or DirectoryName("I386")
20011.   or DirectoryName("ie?updates")
20012.   or DirectoryName("Installer")
20013.   or DirectoryName("Installshield Installation Information")
20014.   or DirectoryName("IME")
20015.   or DirectoryName("*RECYCLE*")
20016.   or DirectoryName("ServicePackFiles")
20017.   or DirectoryName("SoftwareDistribution")
20018.   or DirectoryName("Speech")
20019.   or DirectoryName("Symbols")
20020.   or DirectoryName("System Volume Information")
20021.   or DirectoryName("windows.old")
20022. )
20023. # WinSysLow end.
20024. 
20025.   # Archives
20026. )
20027. # Archives end.
20028. 
20029. # NotBlobsArchivesBu
20030. or
20031. # Backups start.
20032. (
20033.   DirectoryName("*Backup*")
20034.   or DirectoryName("*Bu")
20035.   or DirectoryName("* Bu *")
20036.   or DirectoryName("Bu *")
20037. 
20038.   or FileName("*.bak")
20039.   or FileName("* - Copy*")
20040. )
20041. # Backups end.
20042. 
20043. # NotBlobsArchivesBu
20044. ) )
20045. # NotBlobsArchivesBu end.
20046. 
20047. # Shares
20048. and (
20049. # Share start.
20050. (
20051.   DirectoryName("*Common*")
20052.   or DirectoryName("Media*")
20053.   or DirectoryName("Multimedia*")
20054.   or DirectoryName("*Public*")
20055.   or DirectoryName("*Share*")
20056. )
20057. # Share end.
20058. 
20059. # Shares
20060. or 
20061. # Family start.
20062. (
20063.     DirectoryName("*Family*")
20064. )
20065. # Family end.
20066. 
20067. # Shares
20068. )
20069. # Shares end.
20070. ')
20071. 
20072. 	# Script: ZoneDoHeader
20073. 
20074. # Script: ZoneWhenStarted
20075. 
20076. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
20077. # Script: DisplaySetZone
20078. 
20079. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
20080. SetVariable(FileStepDescription,	"")
20081. 
20082. SetVariable(ZoneStepByLine, 			"Zone started.
20083. ")
20084. 
20085. # Script: BannerDescriptionSet
20086. 
20087. # Script: BannerSet
20088. 
20089. # Script: DisplaySetDateTimeRun
20090. 
20091. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
20092. /* Xinclude "..\Display\BannerSet.MyDc"X */
20093. /* pause(1) */
20094. 
20095. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20096. 
20097. Title('!Heading!')
20098. /* pause(1) */
20099. 
20100. /* NOTE: Can't round or truncate to integer precision. */
20101. 
20102. # Script: BannerLog
20103. 
20104. AppendLogfile("!LogFileName!", "!Title!")
20105. 
20106. 
20107. 
20108. pause(1)
20109. 
20110. 
20111. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
20112. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
20113. 
20114. SetVariable(ZoneStepNoCurrent, 0)
20115. 
20116. 
20117. # Script: ZoneDoCurrentClear
20118. 
20119. SetVariable(ZoneTypeSelectCurrent, 		"")
20120. 
20121. SetVariable(ZoneBeginCurrent, 			0)
20122. SetVariable(ZoneBeginPerCurrent, 		0)
20123. SetVariable(ZoneEndCurrent, 			0)
20124. SetVariable(ZoneEndPerCurrent, 			0)
20125. 
20126. SetVariable(ZoneSizeCurrent,			0)
20127. SetVariable(ZoneSizePerCurrent,			0)
20128. 
20129. SetVariable(ZoneGapRequestedCurrent,	0)
20130. SetVariable(ZoneGapRoundedCurrent, 		0)
20131. SetVariable(ZoneGapAdjustedCurrent, 	0)
20132. SetVariable(ZoneGapAvailableCurrent, 	0)
20133. SetVariable(ZoneGapCurrent,				0)
20134. SetVariable(ZoneGapUsedCurrent, 		0)
20135. 
20136. SetVariable(ZoneGapActualCurrent, 		0)
20137. SetVariable(ZoneGapActualPerCurrent, 	0)
20138. 
20139. SetVariable(ZoneSizeActual, 			0)
20140. SetVariable(ZoneSizeActualCurrent,		0)
20141. 
20142. SetVariable(ZoneEndActual, 				0)
20143. SetVariable(ZoneEndActualCurrent,		0)			
20144. SetVariable(ZoneSizeActualPerCurrent, 	0)
20145.       
20146. SetVariable(ZoneFilesFolders,			0)
20147. SetVariable(ZoneFilesFoldersPer,		0) 
20148. 
20149. SetVariable(ZoneFragments,				0)
20150. SetVariable(ZoneFragmentsPer,			0) 
20151. 		
20152. SetVariable(ZoneEndActualCurrent, 		0)
20153. SetVariable(ZoneEndActualPerCurrent, 	0)
20154. 
20155. # Gap Calculation Methodology:
20156. 	# Requested
20157. 	SetVariable(GapRequested, 			0) 
20158. 	SetVariable(GapRequestedStd, 		0) 
20159. 	SetVariable(GapRequestedMft, 		0) 
20160. 	SetVariable(GapRequestedOs, 		0) 
20161. 	SetVariable(GapRequestedOriginal, 	0) 
20162. 	
20163. 	# Gap Adjustments
20164. 	SetVariable(GapRounded, 			0)
20165. 	# SetVariable(GapAdjusted, 			0)
20166. 	SetVariable(GapAvailable, 			0)
20167. 	SetVariable(GapCurrent, 			0)
20168. 	SetVariable(GapActual, 				0)
20169. 	SetVariable(GapUsed, 				0)
20170. 	
20171. 	# Gap Adjustments
20172. 	SetVariable(GapRoundedLoc, 			0)
20173. 	# SetVariable(GapAdjustedLoc, 		0)
20174. 	SetVariable(GapAvailableLoc, 		0)
20175. 	SetVariable(GapCurrentLoc, 			0)
20176. 	SetVariable(GapActualLoc,			0)
20177. 	SetVariable(GapUsedLoc,				0)
20178. 	
20179. 	# Space usage
20180. 	SetVariable(ZoneFreePerRequested, 	0)
20181. 	SetVariable(ZoneFreePerUsed, 		0)
20182. 
20183. # Gap Size & Rounding
20184. 	SetVariable(ZoneGapSizePer, 		0)
20185. 	SetVariable(ZoneVolRoundUpPer, 		0)
20186. 	
20187. 	# Free Space
20188. 	SetVariable(ZoneFreeUsedPer, 		0)
20189. 	SetVariable(ZoneFreeRequestedPer, 	0)
20190. 
20191. 
20192. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
20193. 
20194. # Footer:
20195. SetVariable(ZoneFooter, "----------------------------------------------------------
20196. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
20197. 
20198. Statistics Report:
20199. ------------------
20200.    Size:  
20201.    ------------------------
20202.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20203.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20204.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20205. 
20206.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20207.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20208. 
20209.    Location:
20210.    ------------------------
20211.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20212.              Files End: !ZoneEndCurrent!
20213.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20214.       
20215.    Gap Settings:
20216.    ------------------------
20217.          Gap Requested: !ZoneGapSizePer!%
20218.       Volume Rounding: !ZoneVolRoundUpPer!%
20219.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20220.                  
20221.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
20222.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
20223.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
20224.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
20225.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
20226.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
20227.      
20228.    Free Space after Zone:
20229.    ------------------------
20230.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20231.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20232.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20233. 
20234. Directory and Files Select:
20235. ---------------------------
20236. !ZoneTypeSelectCurrent!               
20237. ---------------------------
20238. ----------------------------------------------------------
20239. ")
20240. 
20241. # Script: BannerSet
20242. 
20243. # Script: DisplaySetDateTimeRun
20244. 
20245. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
20246. /* Xinclude "..\Display\BannerSet.MyDc"X */
20247. /* pause(1) */
20248. 
20249. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20250. 
20251. Title('!Heading!')
20252. /* pause(1) */
20253. 
20254. /* NOTE: Can't round or truncate to integer precision. */
20255. 
20256. # Script: BannerLog
20257. 
20258. AppendLogfile("!LogFileName!", "!Title!")
20259. 
20260. 
20261. 
20262. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
20263. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
20264. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:46")
20265. 
20266. SetVariable(ZoneListByLine, "!ZoneListByLine!
20267. Zone: !ZoneNoCurrent! 2021-11-09 20:22:46 0:00:05 !ZoneLabel! !ZoneDescription!")
20268. 
20269. 
20270. /* Fixed Zone Position Handling */
20271. /* Literal number: */
20272. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
20273. /* Percentage of disk: */
20274. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
20275. /* Gap */
20276. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
20277. 
20278. /* ---------------------------------------------------------- */
20279. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
20280. # Script: DisplaySetFileStep
20281. 
20282. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20283. 
20284. /* add message and move to a new line. */
20285. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20286. ")
20287. 
20288. /* display the line. (hopefully.) */
20289. # Zone Footer Set Statistics Window Text
20290. 
20291. SetStatisticsWindowText("----------------------------------------------------------
20292. Zones Processed: 
20293. ----------------------------------------------------------
20294. !ZoneListByLine!
20295. ----------------------------------------------------------
20296. Zone Processing Step:
20297. !ZoneStepByLine!    
20298. ----------------------------------------------------------
20299. Current Zone:
20300. !ZoneFooter!
20301. ----------------------------------------------------------
20302. Volume Statistics:
20303. !VolumeStatisticsDetail!
20304. ----------------------------------------------------------
20305. Zone Detailed Report:
20306. ----------------------------------------------------------
20307. !ZoneStatisticsDetail!
20308. ----------------------------------------------------------
20309. ")
20310. 
20311. 
20312. 
20313. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20314. 
20315. # Script: BannerSet
20316. 
20317. # Script: DisplaySetDateTimeRun
20318. 
20319. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
20320. /* Xinclude "..\Display\BannerSet.MyDc"X */
20321. /* pause(1) */
20322. 
20323. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20324. 
20325. Title('!Heading!')
20326. /* pause(1) */
20327. 
20328. /* NOTE: Can't round or truncate to integer precision. */
20329. 
20330. pause(1)
20331. 
20332. # your stuff HERE (X)... pre file select code.
20333. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
20334. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20335. 	# (X)
20336. 
20337. FileSelect
20338. 
20339. 	# your stuff can't really go here (errors.)
20340. 	# maybe for some reason I don't know of...
20341. 	
20342. 	# Actions next...
20343. 	# Script: ZoneDo ZoneTypeSelectShares
20344. # Shares start.
20345. # NotBlobsArchivesBu start.
20346. (not (
20347. # Blobs start.
20348. (
20349. # BlobsAndExceptions start.
20350. ( not(
20351.   FileName("*.bat")
20352.   or FileName("*.css")
20353.   or FileName("*.dll")
20354.   or FileName("*.exe")
20355.   or FileName("*.htm*")
20356.   or FileName("*.jar")
20357.   or FileName("*.js")
20358.   or FileName("*.script")
20359.   or FileName("*.wsf")
20360.   or (
20361. # Databases start.
20362. (
20363.   FileName("*.crypt*")
20364.   or FileName("*.db*")
20365.   or FileName("*.rdb*")
20366.   or FileName("*.dc*")
20367.   or FileName("*.dict*")
20368.   or FileName("*.?db*")
20369.   or FileName("*.?rdb*")
20370.   or FileName("*.md*")
20371.   or FileName("*.myd")
20372.   or FileName("*.ndf")
20373.   or FileName("*.ns?")
20374.   or FileName("*.pab")
20375.   or FileName("*.pst")
20376.   or FileName("*.sd?*")
20377.   or FileName("*.sq**")
20378.   or FileName("*.tmd")
20379.   or FileName("*.tps")
20380.   or FileName("*.tr*")
20381. )
20382. # Databases end.
20383. 
20384.     # BlobsAndExceptions
20385.     or 
20386. # Data start.
20387. (
20388.   DirectoryName("Data*")
20389.   or DirectoryName("Device*")
20390.   or DirectoryName("Export*")
20391.   or DirectoryName("Import*")
20392.   or DirectoryName("Log*")
20393.   or DirectoryName("*Log")
20394.   or DirectoryName("Maintenance*")
20395.   or DirectoryName("Rec*")
20396.   or DirectoryName("Sales*")
20397.   or DirectoryName("Search*")
20398.   or DirectoryName("User*")
20399. )
20400. # Data end.
20401. 
20402.     # BlobsAndExceptions
20403.   )
20404. ) )
20405. # BlobsAndExceptions end.
20406. 
20407. # Blobs
20408. ) and (
20409.   Size(BlobFileSize,0)
20410.   or (
20411.     FileName("*.arj")
20412.     or FileName("*.bup")
20413.     or FileName("*.bz2")
20414.     or FileName("*.chm")
20415.     or FileName("*.dvr-ms")
20416.     or FileName("*.gz")
20417.     or FileName("*.ifo")
20418.     or FileName("*.lzh")
20419.     or FileName("*.pdf")
20420.     or FileName("*.rpm")
20421.     or FileName("*.wmv")
20422.     or FileName("*.vob")
20423.     or FileName("*.z")
20424.   ) 
20425. )
20426. # Blobs end.
20427. 
20428. # NotBlobsArchivesBu
20429. or 
20430. # Archives start.
20431. (
20432.   DirectoryName("*Archive*")
20433.   or DirectoryName("*History*")
20434.   or DirectoryName("*Old")
20435.   or DirectoryName("* Old *")
20436.   or DirectoryName("Old *")
20437. 
20438.   or FileName("*.7z")
20439.   or FileName("*.cab")
20440.   or FileName("*.iso")
20441.   or FileName("*.msi")
20442.   or FileName("*.old")
20443.   or FileName("*.rar")
20444.   or FileName("*.tar")
20445.   or FileName("*.zip")
20446.   or
20447. # WinSysLow start.
20448. (
20449.   DirectoryName("$*")
20450.   or DirectoryName("0*")
20451.   or DirectoryName("1*")
20452.   or DirectoryName("2*")
20453.   or DirectoryName("3*")
20454.   or DirectoryName("4*")
20455.   or DirectoryName("5*")
20456.   or DirectoryName("6*")
20457.   or DirectoryName("7*")
20458.   or DirectoryName("8*")
20459.   or DirectoryName("9*")
20460. 
20461.   or DirectoryName("dllcache")
20462.   or DirectoryName("Downloaded Installations")
20463.   or DirectoryName("Ehome")
20464.   or DirectoryName("Fonts")
20465.   or DirectoryName("Help")
20466.   or DirectoryName("I386")
20467.   or DirectoryName("ie?updates")
20468.   or DirectoryName("Installer")
20469.   or DirectoryName("Installshield Installation Information")
20470.   or DirectoryName("IME")
20471.   or DirectoryName("*RECYCLE*")
20472.   or DirectoryName("ServicePackFiles")
20473.   or DirectoryName("SoftwareDistribution")
20474.   or DirectoryName("Speech")
20475.   or DirectoryName("Symbols")
20476.   or DirectoryName("System Volume Information")
20477.   or DirectoryName("windows.old")
20478. )
20479. # WinSysLow end.
20480. 
20481.   # Archives
20482. )
20483. # Archives end.
20484. 
20485. # NotBlobsArchivesBu
20486. or
20487. # Backups start.
20488. (
20489.   DirectoryName("*Backup*")
20490.   or DirectoryName("*Bu")
20491.   or DirectoryName("* Bu *")
20492.   or DirectoryName("Bu *")
20493. 
20494.   or FileName("*.bak")
20495.   or FileName("* - Copy*")
20496. )
20497. # Backups end.
20498. 
20499. # NotBlobsArchivesBu
20500. ) )
20501. # NotBlobsArchivesBu end.
20502. 
20503. # Shares
20504. and (
20505. # Share start.
20506. (
20507.   DirectoryName("*Common*")
20508.   or DirectoryName("Media*")
20509.   or DirectoryName("Multimedia*")
20510.   or DirectoryName("*Public*")
20511.   or DirectoryName("*Share*")
20512. )
20513. # Share end.
20514. 
20515. # Shares
20516. or 
20517. # Family start.
20518. (
20519.     DirectoryName("*Family*")
20520. )
20521. # Family end.
20522. 
20523. # Shares
20524. )
20525. # Shares end.
20526. 
20527. 	# Script: ZoneDoAction
20528. # Zone Do File Action - SortByName.
20529. 
20530. FileActions
20531. 
20532. 	# Footer:
20533. SetVariable(ZoneFooter, "----------------------------------------------------------
20534. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
20535. 
20536. Statistics Report:
20537. ------------------
20538.    Size:  
20539.    ------------------------
20540.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20541.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20542.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20543. 
20544.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20545.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20546. 
20547.    Location:
20548.    ------------------------
20549.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20550.              Files End: !ZoneEndCurrent!
20551.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20552.       
20553.    Gap Settings:
20554.    ------------------------
20555.          Gap Requested: !ZoneGapSizePer!%
20556.       Volume Rounding: !ZoneVolRoundUpPer!%
20557.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20558.                  
20559.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
20560.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
20561.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
20562.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
20563.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
20564.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
20565.      
20566.    Free Space after Zone:
20567.    ------------------------
20568.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20569.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20570.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20571. 
20572. Directory and Files Select:
20573. ---------------------------
20574. !ZoneTypeSelectCurrent!               
20575. ---------------------------
20576. ----------------------------------------------------------
20577. ")
20578. 	SetStatisticsWindowText("!ZoneFooter!")
20579. 	
20580. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
20581. 	# Script: DisplaySetFileStep
20582. 
20583. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20584. 
20585. /* add message and move to a new line. */
20586. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20587. ")
20588. 
20589. /* display the line. (hopefully.) */
20590. # Zone Footer Set Statistics Window Text
20591. 
20592. SetStatisticsWindowText("----------------------------------------------------------
20593. Zones Processed: 
20594. ----------------------------------------------------------
20595. !ZoneListByLine!
20596. ----------------------------------------------------------
20597. Zone Processing Step:
20598. !ZoneStepByLine!    
20599. ----------------------------------------------------------
20600. Current Zone:
20601. !ZoneFooter!
20602. ----------------------------------------------------------
20603. Volume Statistics:
20604. !VolumeStatisticsDetail!
20605. ----------------------------------------------------------
20606. Zone Detailed Report:
20607. ----------------------------------------------------------
20608. !ZoneStatisticsDetail!
20609. ----------------------------------------------------------
20610. ")
20611. 
20612. 
20613. 
20614. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20615. 
20616. # Script: BannerSet
20617. 
20618. # Script: DisplaySetDateTimeRun
20619. 
20620. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
20621. /* Xinclude "..\Display\BannerSet.MyDc"X */
20622. /* pause(1) */
20623. 
20624. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20625. 
20626. Title('!Heading!')
20627. /* pause(1) */
20628. 
20629. /* NOTE: Can't round or truncate to integer precision. */
20630. 
20631. pause(1)
20632. 
20633. # Commands:
20634. 
20635. /* Moves to Zone or above it. */
20636. # MoveUpToZone()
20637. 
20638. # Defrag
20639. 
20640. # Defragment(OPTIONS)
20641. 
20642. /* Shuffles files around trying to make a big enough gap for fragmented files. */
20643. # Defragment()
20644. 
20645. /* Only does files where a gap will fit it. */
20646. # Defragment(Fast)
20647. 
20648. /* Skips fragmented files larger than the Chunck Size.
20649. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
20650. # Defragment(Chunk Size)
20651. 
20652. /* Moves down to zone and packs zone to beginning if there are gaps. */
20653. /* Can be similar in performance to doing a SortBy. */
20654. # MoveDownFill()
20655. 
20656. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
20657. 
20658. 
20659. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
20660. 	# Script: DisplaySetFileStep
20661. 
20662. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20663. 
20664. /* add message and move to a new line. */
20665. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20666. ")
20667. 
20668. /* display the line. (hopefully.) */
20669. # Zone Footer Set Statistics Window Text
20670. 
20671. SetStatisticsWindowText("----------------------------------------------------------
20672. Zones Processed: 
20673. ----------------------------------------------------------
20674. !ZoneListByLine!
20675. ----------------------------------------------------------
20676. Zone Processing Step:
20677. !ZoneStepByLine!    
20678. ----------------------------------------------------------
20679. Current Zone:
20680. !ZoneFooter!
20681. ----------------------------------------------------------
20682. Volume Statistics:
20683. !VolumeStatisticsDetail!
20684. ----------------------------------------------------------
20685. Zone Detailed Report:
20686. ----------------------------------------------------------
20687. !ZoneStatisticsDetail!
20688. ----------------------------------------------------------
20689. ")
20690. 
20691. 
20692. 
20693. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20694. 
20695. # Script: BannerSet
20696. 
20697. # Script: DisplaySetDateTimeRun
20698. 
20699. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
20700. /* Xinclude "..\Display\BannerSet.MyDc"X */
20701. /* pause(1) */
20702. 
20703. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20704. 
20705. Title('!Heading!')
20706. /* pause(1) */
20707. 
20708. /* NOTE: Can't round or truncate to integer precision. */
20709. 
20710. pause(1)
20711. 
20712. 	# Script: ZoneDoFooter
20713. 
20714. /* ---------------------------------------------------------- */
20715. # File Select
20716. 	# Select Statments
20717. # File Actions 
20718. 	# Standard or OS File Actions.
20719. 	# Resume...
20720. 	
20721. 	# your stuff HERE (X)... post zone (file) file actions code.
20722. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
20723. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20724. 		# (X)
20725. 		
20726. 		/* ??? Set window? */
20727. 	
20728. 	# ADD THE GAP
20729. 		
20730. # Vacate (good for diagnostics)
20731. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
20732. 
20733. # DoNotVacate - DO NOT Vacate (recommended)
20734. 
20735. # Vacate
20736. /* AddGap(GapUsedLoc) */
20737. 
20738. # DO Not Vacate
20739. AddGap(GapUsedLoc, DoNotVacate) 
20740. 	
20741. 	
20742. /* ---------------------------------------------------------- */
20743. # (failed) TEST for boolean logic.
20744. 
20745. /* It should work in the gap calculations for turning options */
20746. /* on and off but it will NOT work here. */
20747. 
20748. /* Boolean setting X or FlagX. */
20749. /* Where X will be on or off: */
20750. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
20751. /*      For ON:  (X  *  FlagAny) */
20752. 
20753. /* 1) Failed, zero gap overrode the previous one. */
20754. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
20755. /* AddGap(GapUsedTemp) */ 
20756. 
20757. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
20758. /* AddGap(GapUsedTemp, DoNotVacate) */ 
20759. 
20760. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
20761. 
20762. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
20763. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
20764. /* AddGap(GapUsedTemp) */ 
20765. 
20766. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
20767. /* AddGap(GapUsedTemp, DoNotVacate) */ 
20768. 
20769. /* ---------------------------------------------------------- */
20770. 
20771. # Vacate
20772. /* AddGap(GapUsed) */
20773. 
20774. # DO NOT Vacate (recommended)
20775. /* AddGap(GapUsed, DoNotVacate) */ 
20776. 	
20777. 
20778. 		
20779. # 
20780. FileEnd
20781. /* ---------------------------------------------------------- */
20782. 
20783. # your stuff HERE (X)... post zone (file) code.
20784. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
20785. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20786. 	# (X)
20787. 
20788. SetVariable(FileStepDescription,"Zone finished, reporting.")
20789. # Script: DisplaySetFileStep
20790. 
20791. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20792. 
20793. /* add message and move to a new line. */
20794. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20795. ")
20796. 
20797. /* display the line. (hopefully.) */
20798. # Zone Footer Set Statistics Window Text
20799. 
20800. SetStatisticsWindowText("----------------------------------------------------------
20801. Zones Processed: 
20802. ----------------------------------------------------------
20803. !ZoneListByLine!
20804. ----------------------------------------------------------
20805. Zone Processing Step:
20806. !ZoneStepByLine!    
20807. ----------------------------------------------------------
20808. Current Zone:
20809. !ZoneFooter!
20810. ----------------------------------------------------------
20811. Volume Statistics:
20812. !VolumeStatisticsDetail!
20813. ----------------------------------------------------------
20814. Zone Detailed Report:
20815. ----------------------------------------------------------
20816. !ZoneStatisticsDetail!
20817. ----------------------------------------------------------
20818. ")
20819. 
20820. 
20821. 
20822. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20823. 
20824. # Script: BannerSet
20825. 
20826. # Script: DisplaySetDateTimeRun
20827. 
20828. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
20829. /* Xinclude "..\Display\BannerSet.MyDc"X */
20830. /* pause(1) */
20831. 
20832. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20833. 
20834. Title('!Heading!')
20835. /* pause(1) */
20836. 
20837. /* NOTE: Can't round or truncate to integer precision. */
20838. 
20839. pause(1)
20840. 
20841. # Script: ZoneWhenFinished
20842. 
20843. # Script: BannerSet
20844. 
20845. # Script: DisplaySetDateTimeRun
20846. 
20847. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
20848. /* Xinclude "..\Display\BannerSet.MyDc"X */
20849. /* pause(1) */
20850. 
20851. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20852. 
20853. Title('!Heading!')
20854. /* pause(1) */
20855. 
20856. /* NOTE: Can't round or truncate to integer precision. */
20857. 
20858. # Script: BannerLog
20859. 
20860. AppendLogfile("!LogFileName!", "!Title!")
20861. 
20862. 
20863. 
20864. # Zone Statistics	
20865. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
20866. 
20867. # Footer:
20868. SetVariable(ZoneFooter, "----------------------------------------------------------
20869. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
20870. 
20871. Statistics Report:
20872. ------------------
20873.    Size:  
20874.    ------------------------
20875.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20876.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20877.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20878. 
20879.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20880.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20881. 
20882.    Location:
20883.    ------------------------
20884.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20885.              Files End: !ZoneEndCurrent!
20886.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20887.       
20888.    Gap Settings:
20889.    ------------------------
20890.          Gap Requested: !ZoneGapSizePer!%
20891.       Volume Rounding: !ZoneVolRoundUpPer!%
20892.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20893.                  
20894.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
20895.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
20896.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
20897.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
20898.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
20899.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
20900.      
20901.    Free Space after Zone:
20902.    ------------------------
20903.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20904.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20905.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20906. 
20907. Directory and Files Select:
20908. ---------------------------
20909. !ZoneTypeSelectCurrent!               
20910. ---------------------------
20911. ----------------------------------------------------------
20912. ")
20913. 
20914. AppendLogfile("!LogFileName!", ".")
20915. AppendLogfile("!LogFileName!", "!ZoneFooter!")
20916. AppendLogfile("!LogFileName!", ".")
20917. 
20918. # Zone Footer Set Statistics Window Text
20919. 
20920. SetStatisticsWindowText("----------------------------------------------------------
20921. Zones Processed: 
20922. ----------------------------------------------------------
20923. !ZoneListByLine!
20924. ----------------------------------------------------------
20925. Zone Processing Step:
20926. !ZoneStepByLine!    
20927. ----------------------------------------------------------
20928. Current Zone:
20929. !ZoneFooter!
20930. ----------------------------------------------------------
20931. Volume Statistics:
20932. !VolumeStatisticsDetail!
20933. ----------------------------------------------------------
20934. Zone Detailed Report:
20935. ----------------------------------------------------------
20936. !ZoneStatisticsDetail!
20937. ----------------------------------------------------------
20938. ")
20939. 
20940. 
20941. 
20942. /* pause() */
20943. /* pause() */
20944. 
20945. 
20946. 
20947. 
20948. /* ---------------------------------------------------------- */
20949. 
20950. 
20951. /* ---------------------------------------------------------- */
20952. /* Zone SystemOtherData System Other and Data */
20953. # Script: DefragZoneTypeSystemOtherData
20954. /* ---------------------------------------------------------- */
20955. /* Zone SystemOtherData System Other and Data */
20956. SetVariable(ZoneLabel, "!ZoneLabelSystemOtherData!")
20957. SetVariable(ZoneDescription, "!ZoneDescriptionSystemOtherData!")
20958. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSystemOtherData!")
20959. SetVariable(ZoneGapSize, "!ZoneGapSizeSystemOtherData!")
20960. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectSystemOtherData
20961. # SystemOtherData start.
20962. # NotBlobsArchivesBu start.
20963. (not (
20964. # Blobs start.
20965. (
20966. # BlobsAndExceptions start.
20967. ( not(
20968.   FileName("*.bat")
20969.   or FileName("*.css")
20970.   or FileName("*.dll")
20971.   or FileName("*.exe")
20972.   or FileName("*.htm*")
20973.   or FileName("*.jar")
20974.   or FileName("*.js")
20975.   or FileName("*.script")
20976.   or FileName("*.wsf")
20977.   or (
20978. # Databases start.
20979. (
20980.   FileName("*.crypt*")
20981.   or FileName("*.db*")
20982.   or FileName("*.rdb*")
20983.   or FileName("*.dc*")
20984.   or FileName("*.dict*")
20985.   or FileName("*.?db*")
20986.   or FileName("*.?rdb*")
20987.   or FileName("*.md*")
20988.   or FileName("*.myd")
20989.   or FileName("*.ndf")
20990.   or FileName("*.ns?")
20991.   or FileName("*.pab")
20992.   or FileName("*.pst")
20993.   or FileName("*.sd?*")
20994.   or FileName("*.sq**")
20995.   or FileName("*.tmd")
20996.   or FileName("*.tps")
20997.   or FileName("*.tr*")
20998. )
20999. # Databases end.
21000. 
21001.     # BlobsAndExceptions
21002.     or 
21003. # Data start.
21004. (
21005.   DirectoryName("Data*")
21006.   or DirectoryName("Device*")
21007.   or DirectoryName("Export*")
21008.   or DirectoryName("Import*")
21009.   or DirectoryName("Log*")
21010.   or DirectoryName("*Log")
21011.   or DirectoryName("Maintenance*")
21012.   or DirectoryName("Rec*")
21013.   or DirectoryName("Sales*")
21014.   or DirectoryName("Search*")
21015.   or DirectoryName("User*")
21016. )
21017. # Data end.
21018. 
21019.     # BlobsAndExceptions
21020.   )
21021. ) )
21022. # BlobsAndExceptions end.
21023. 
21024. # Blobs
21025. ) and (
21026.   Size(BlobFileSize,0)
21027.   or (
21028.     FileName("*.arj")
21029.     or FileName("*.bup")
21030.     or FileName("*.bz2")
21031.     or FileName("*.chm")
21032.     or FileName("*.dvr-ms")
21033.     or FileName("*.gz")
21034.     or FileName("*.ifo")
21035.     or FileName("*.lzh")
21036.     or FileName("*.pdf")
21037.     or FileName("*.rpm")
21038.     or FileName("*.wmv")
21039.     or FileName("*.vob")
21040.     or FileName("*.z")
21041.   ) 
21042. )
21043. # Blobs end.
21044. 
21045. # NotBlobsArchivesBu
21046. or 
21047. # Archives start.
21048. (
21049.   DirectoryName("*Archive*")
21050.   or DirectoryName("*History*")
21051.   or DirectoryName("*Old")
21052.   or DirectoryName("* Old *")
21053.   or DirectoryName("Old *")
21054. 
21055.   or FileName("*.7z")
21056.   or FileName("*.cab")
21057.   or FileName("*.iso")
21058.   or FileName("*.msi")
21059.   or FileName("*.old")
21060.   or FileName("*.rar")
21061.   or FileName("*.tar")
21062.   or FileName("*.zip")
21063.   or
21064. # WinSysLow start.
21065. (
21066.   DirectoryName("$*")
21067.   or DirectoryName("0*")
21068.   or DirectoryName("1*")
21069.   or DirectoryName("2*")
21070.   or DirectoryName("3*")
21071.   or DirectoryName("4*")
21072.   or DirectoryName("5*")
21073.   or DirectoryName("6*")
21074.   or DirectoryName("7*")
21075.   or DirectoryName("8*")
21076.   or DirectoryName("9*")
21077. 
21078.   or DirectoryName("dllcache")
21079.   or DirectoryName("Downloaded Installations")
21080.   or DirectoryName("Ehome")
21081.   or DirectoryName("Fonts")
21082.   or DirectoryName("Help")
21083.   or DirectoryName("I386")
21084.   or DirectoryName("ie?updates")
21085.   or DirectoryName("Installer")
21086.   or DirectoryName("Installshield Installation Information")
21087.   or DirectoryName("IME")
21088.   or DirectoryName("*RECYCLE*")
21089.   or DirectoryName("ServicePackFiles")
21090.   or DirectoryName("SoftwareDistribution")
21091.   or DirectoryName("Speech")
21092.   or DirectoryName("Symbols")
21093.   or DirectoryName("System Volume Information")
21094.   or DirectoryName("windows.old")
21095. )
21096. # WinSysLow end.
21097. 
21098.   # Archives
21099. )
21100. # Archives end.
21101. 
21102. # NotBlobsArchivesBu
21103. or
21104. # Backups start.
21105. (
21106.   DirectoryName("*Backup*")
21107.   or DirectoryName("*Bu")
21108.   or DirectoryName("* Bu *")
21109.   or DirectoryName("Bu *")
21110. 
21111.   or FileName("*.bak")
21112.   or FileName("* - Copy*")
21113. )
21114. # Backups end.
21115. 
21116. # NotBlobsArchivesBu
21117. ) )
21118. # NotBlobsArchivesBu end.
21119. 
21120. # SystemOtherData
21121. and ( 
21122. # Data start.
21123. (
21124.   DirectoryName("Data*")
21125.   or DirectoryName("Device*")
21126.   or DirectoryName("Export*")
21127.   or DirectoryName("Import*")
21128.   or DirectoryName("Log*")
21129.   or DirectoryName("*Log")
21130.   or DirectoryName("Maintenance*")
21131.   or DirectoryName("Rec*")
21132.   or DirectoryName("Sales*")
21133.   or DirectoryName("Search*")
21134.   or DirectoryName("User*")
21135. )
21136. # Data end.
21137.  
21138. # SystemOtherData
21139. or  
21140. # Databases start.
21141. (
21142.   FileName("*.crypt*")
21143.   or FileName("*.db*")
21144.   or FileName("*.rdb*")
21145.   or FileName("*.dc*")
21146.   or FileName("*.dict*")
21147.   or FileName("*.?db*")
21148.   or FileName("*.?rdb*")
21149.   or FileName("*.md*")
21150.   or FileName("*.myd")
21151.   or FileName("*.ndf")
21152.   or FileName("*.ns?")
21153.   or FileName("*.pab")
21154.   or FileName("*.pst")
21155.   or FileName("*.sd?*")
21156.   or FileName("*.sq**")
21157.   or FileName("*.tmd")
21158.   or FileName("*.tps")
21159.   or FileName("*.tr*")
21160. )
21161. # Databases end.
21162. 
21163. # SystemOtherData
21164. )
21165. # SystemOtherData end.
21166. ')
21167. 
21168. 	# Script: ZoneDoHeader
21169. 
21170. # Script: ZoneWhenStarted
21171. 
21172. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
21173. # Script: DisplaySetZone
21174. 
21175. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
21176. SetVariable(FileStepDescription,	"")
21177. 
21178. SetVariable(ZoneStepByLine, 			"Zone started.
21179. ")
21180. 
21181. # Script: BannerDescriptionSet
21182. 
21183. # Script: BannerSet
21184. 
21185. # Script: DisplaySetDateTimeRun
21186. 
21187. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
21188. /* Xinclude "..\Display\BannerSet.MyDc"X */
21189. /* pause(1) */
21190. 
21191. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21192. 
21193. Title('!Heading!')
21194. /* pause(1) */
21195. 
21196. /* NOTE: Can't round or truncate to integer precision. */
21197. 
21198. # Script: BannerLog
21199. 
21200. AppendLogfile("!LogFileName!", "!Title!")
21201. 
21202. 
21203. 
21204. pause(1)
21205. 
21206. 
21207. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
21208. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
21209. 
21210. SetVariable(ZoneStepNoCurrent, 0)
21211. 
21212. 
21213. # Script: ZoneDoCurrentClear
21214. 
21215. SetVariable(ZoneTypeSelectCurrent, 		"")
21216. 
21217. SetVariable(ZoneBeginCurrent, 			0)
21218. SetVariable(ZoneBeginPerCurrent, 		0)
21219. SetVariable(ZoneEndCurrent, 			0)
21220. SetVariable(ZoneEndPerCurrent, 			0)
21221. 
21222. SetVariable(ZoneSizeCurrent,			0)
21223. SetVariable(ZoneSizePerCurrent,			0)
21224. 
21225. SetVariable(ZoneGapRequestedCurrent,	0)
21226. SetVariable(ZoneGapRoundedCurrent, 		0)
21227. SetVariable(ZoneGapAdjustedCurrent, 	0)
21228. SetVariable(ZoneGapAvailableCurrent, 	0)
21229. SetVariable(ZoneGapCurrent,				0)
21230. SetVariable(ZoneGapUsedCurrent, 		0)
21231. 
21232. SetVariable(ZoneGapActualCurrent, 		0)
21233. SetVariable(ZoneGapActualPerCurrent, 	0)
21234. 
21235. SetVariable(ZoneSizeActual, 			0)
21236. SetVariable(ZoneSizeActualCurrent,		0)
21237. 
21238. SetVariable(ZoneEndActual, 				0)
21239. SetVariable(ZoneEndActualCurrent,		0)			
21240. SetVariable(ZoneSizeActualPerCurrent, 	0)
21241.       
21242. SetVariable(ZoneFilesFolders,			0)
21243. SetVariable(ZoneFilesFoldersPer,		0) 
21244. 
21245. SetVariable(ZoneFragments,				0)
21246. SetVariable(ZoneFragmentsPer,			0) 
21247. 		
21248. SetVariable(ZoneEndActualCurrent, 		0)
21249. SetVariable(ZoneEndActualPerCurrent, 	0)
21250. 
21251. # Gap Calculation Methodology:
21252. 	# Requested
21253. 	SetVariable(GapRequested, 			0) 
21254. 	SetVariable(GapRequestedStd, 		0) 
21255. 	SetVariable(GapRequestedMft, 		0) 
21256. 	SetVariable(GapRequestedOs, 		0) 
21257. 	SetVariable(GapRequestedOriginal, 	0) 
21258. 	
21259. 	# Gap Adjustments
21260. 	SetVariable(GapRounded, 			0)
21261. 	# SetVariable(GapAdjusted, 			0)
21262. 	SetVariable(GapAvailable, 			0)
21263. 	SetVariable(GapCurrent, 			0)
21264. 	SetVariable(GapActual, 				0)
21265. 	SetVariable(GapUsed, 				0)
21266. 	
21267. 	# Gap Adjustments
21268. 	SetVariable(GapRoundedLoc, 			0)
21269. 	# SetVariable(GapAdjustedLoc, 		0)
21270. 	SetVariable(GapAvailableLoc, 		0)
21271. 	SetVariable(GapCurrentLoc, 			0)
21272. 	SetVariable(GapActualLoc,			0)
21273. 	SetVariable(GapUsedLoc,				0)
21274. 	
21275. 	# Space usage
21276. 	SetVariable(ZoneFreePerRequested, 	0)
21277. 	SetVariable(ZoneFreePerUsed, 		0)
21278. 
21279. # Gap Size & Rounding
21280. 	SetVariable(ZoneGapSizePer, 		0)
21281. 	SetVariable(ZoneVolRoundUpPer, 		0)
21282. 	
21283. 	# Free Space
21284. 	SetVariable(ZoneFreeUsedPer, 		0)
21285. 	SetVariable(ZoneFreeRequestedPer, 	0)
21286. 
21287. 
21288. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
21289. 
21290. # Footer:
21291. SetVariable(ZoneFooter, "----------------------------------------------------------
21292. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
21293. 
21294. Statistics Report:
21295. ------------------
21296.    Size:  
21297.    ------------------------
21298.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21299.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21300.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21301. 
21302.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21303.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21304. 
21305.    Location:
21306.    ------------------------
21307.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21308.              Files End: !ZoneEndCurrent!
21309.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21310.       
21311.    Gap Settings:
21312.    ------------------------
21313.          Gap Requested: !ZoneGapSizePer!%
21314.       Volume Rounding: !ZoneVolRoundUpPer!%
21315.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21316.                  
21317.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
21318.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
21319.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
21320.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
21321.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
21322.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
21323.      
21324.    Free Space after Zone:
21325.    ------------------------
21326.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21327.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21328.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21329. 
21330. Directory and Files Select:
21331. ---------------------------
21332. !ZoneTypeSelectCurrent!               
21333. ---------------------------
21334. ----------------------------------------------------------
21335. ")
21336. 
21337. # Script: BannerSet
21338. 
21339. # Script: DisplaySetDateTimeRun
21340. 
21341. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
21342. /* Xinclude "..\Display\BannerSet.MyDc"X */
21343. /* pause(1) */
21344. 
21345. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21346. 
21347. Title('!Heading!')
21348. /* pause(1) */
21349. 
21350. /* NOTE: Can't round or truncate to integer precision. */
21351. 
21352. # Script: BannerLog
21353. 
21354. AppendLogfile("!LogFileName!", "!Title!")
21355. 
21356. 
21357. 
21358. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
21359. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
21360. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:46")
21361. 
21362. SetVariable(ZoneListByLine, "!ZoneListByLine!
21363. Zone: !ZoneNoCurrent! 2021-11-09 20:22:46 0:00:05 !ZoneLabel! !ZoneDescription!")
21364. 
21365. 
21366. /* Fixed Zone Position Handling */
21367. /* Literal number: */
21368. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
21369. /* Percentage of disk: */
21370. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
21371. /* Gap */
21372. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
21373. 
21374. /* ---------------------------------------------------------- */
21375. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
21376. # Script: DisplaySetFileStep
21377. 
21378. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21379. 
21380. /* add message and move to a new line. */
21381. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21382. ")
21383. 
21384. /* display the line. (hopefully.) */
21385. # Zone Footer Set Statistics Window Text
21386. 
21387. SetStatisticsWindowText("----------------------------------------------------------
21388. Zones Processed: 
21389. ----------------------------------------------------------
21390. !ZoneListByLine!
21391. ----------------------------------------------------------
21392. Zone Processing Step:
21393. !ZoneStepByLine!    
21394. ----------------------------------------------------------
21395. Current Zone:
21396. !ZoneFooter!
21397. ----------------------------------------------------------
21398. Volume Statistics:
21399. !VolumeStatisticsDetail!
21400. ----------------------------------------------------------
21401. Zone Detailed Report:
21402. ----------------------------------------------------------
21403. !ZoneStatisticsDetail!
21404. ----------------------------------------------------------
21405. ")
21406. 
21407. 
21408. 
21409. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21410. 
21411. # Script: BannerSet
21412. 
21413. # Script: DisplaySetDateTimeRun
21414. 
21415. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
21416. /* Xinclude "..\Display\BannerSet.MyDc"X */
21417. /* pause(1) */
21418. 
21419. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21420. 
21421. Title('!Heading!')
21422. /* pause(1) */
21423. 
21424. /* NOTE: Can't round or truncate to integer precision. */
21425. 
21426. pause(1)
21427. 
21428. # your stuff HERE (X)... pre file select code.
21429. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
21430. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21431. 	# (X)
21432. 
21433. FileSelect
21434. 
21435. 	# your stuff can't really go here (errors.)
21436. 	# maybe for some reason I don't know of...
21437. 	
21438. 	# Actions next...
21439. 	# Script: ZoneDo ZoneTypeSelectSystemOtherData
21440. # SystemOtherData start.
21441. # NotBlobsArchivesBu start.
21442. (not (
21443. # Blobs start.
21444. (
21445. # BlobsAndExceptions start.
21446. ( not(
21447.   FileName("*.bat")
21448.   or FileName("*.css")
21449.   or FileName("*.dll")
21450.   or FileName("*.exe")
21451.   or FileName("*.htm*")
21452.   or FileName("*.jar")
21453.   or FileName("*.js")
21454.   or FileName("*.script")
21455.   or FileName("*.wsf")
21456.   or (
21457. # Databases start.
21458. (
21459.   FileName("*.crypt*")
21460.   or FileName("*.db*")
21461.   or FileName("*.rdb*")
21462.   or FileName("*.dc*")
21463.   or FileName("*.dict*")
21464.   or FileName("*.?db*")
21465.   or FileName("*.?rdb*")
21466.   or FileName("*.md*")
21467.   or FileName("*.myd")
21468.   or FileName("*.ndf")
21469.   or FileName("*.ns?")
21470.   or FileName("*.pab")
21471.   or FileName("*.pst")
21472.   or FileName("*.sd?*")
21473.   or FileName("*.sq**")
21474.   or FileName("*.tmd")
21475.   or FileName("*.tps")
21476.   or FileName("*.tr*")
21477. )
21478. # Databases end.
21479. 
21480.     # BlobsAndExceptions
21481.     or 
21482. # Data start.
21483. (
21484.   DirectoryName("Data*")
21485.   or DirectoryName("Device*")
21486.   or DirectoryName("Export*")
21487.   or DirectoryName("Import*")
21488.   or DirectoryName("Log*")
21489.   or DirectoryName("*Log")
21490.   or DirectoryName("Maintenance*")
21491.   or DirectoryName("Rec*")
21492.   or DirectoryName("Sales*")
21493.   or DirectoryName("Search*")
21494.   or DirectoryName("User*")
21495. )
21496. # Data end.
21497. 
21498.     # BlobsAndExceptions
21499.   )
21500. ) )
21501. # BlobsAndExceptions end.
21502. 
21503. # Blobs
21504. ) and (
21505.   Size(BlobFileSize,0)
21506.   or (
21507.     FileName("*.arj")
21508.     or FileName("*.bup")
21509.     or FileName("*.bz2")
21510.     or FileName("*.chm")
21511.     or FileName("*.dvr-ms")
21512.     or FileName("*.gz")
21513.     or FileName("*.ifo")
21514.     or FileName("*.lzh")
21515.     or FileName("*.pdf")
21516.     or FileName("*.rpm")
21517.     or FileName("*.wmv")
21518.     or FileName("*.vob")
21519.     or FileName("*.z")
21520.   ) 
21521. )
21522. # Blobs end.
21523. 
21524. # NotBlobsArchivesBu
21525. or 
21526. # Archives start.
21527. (
21528.   DirectoryName("*Archive*")
21529.   or DirectoryName("*History*")
21530.   or DirectoryName("*Old")
21531.   or DirectoryName("* Old *")
21532.   or DirectoryName("Old *")
21533. 
21534.   or FileName("*.7z")
21535.   or FileName("*.cab")
21536.   or FileName("*.iso")
21537.   or FileName("*.msi")
21538.   or FileName("*.old")
21539.   or FileName("*.rar")
21540.   or FileName("*.tar")
21541.   or FileName("*.zip")
21542.   or
21543. # WinSysLow start.
21544. (
21545.   DirectoryName("$*")
21546.   or DirectoryName("0*")
21547.   or DirectoryName("1*")
21548.   or DirectoryName("2*")
21549.   or DirectoryName("3*")
21550.   or DirectoryName("4*")
21551.   or DirectoryName("5*")
21552.   or DirectoryName("6*")
21553.   or DirectoryName("7*")
21554.   or DirectoryName("8*")
21555.   or DirectoryName("9*")
21556. 
21557.   or DirectoryName("dllcache")
21558.   or DirectoryName("Downloaded Installations")
21559.   or DirectoryName("Ehome")
21560.   or DirectoryName("Fonts")
21561.   or DirectoryName("Help")
21562.   or DirectoryName("I386")
21563.   or DirectoryName("ie?updates")
21564.   or DirectoryName("Installer")
21565.   or DirectoryName("Installshield Installation Information")
21566.   or DirectoryName("IME")
21567.   or DirectoryName("*RECYCLE*")
21568.   or DirectoryName("ServicePackFiles")
21569.   or DirectoryName("SoftwareDistribution")
21570.   or DirectoryName("Speech")
21571.   or DirectoryName("Symbols")
21572.   or DirectoryName("System Volume Information")
21573.   or DirectoryName("windows.old")
21574. )
21575. # WinSysLow end.
21576. 
21577.   # Archives
21578. )
21579. # Archives end.
21580. 
21581. # NotBlobsArchivesBu
21582. or
21583. # Backups start.
21584. (
21585.   DirectoryName("*Backup*")
21586.   or DirectoryName("*Bu")
21587.   or DirectoryName("* Bu *")
21588.   or DirectoryName("Bu *")
21589. 
21590.   or FileName("*.bak")
21591.   or FileName("* - Copy*")
21592. )
21593. # Backups end.
21594. 
21595. # NotBlobsArchivesBu
21596. ) )
21597. # NotBlobsArchivesBu end.
21598. 
21599. # SystemOtherData
21600. and ( 
21601. # Data start.
21602. (
21603.   DirectoryName("Data*")
21604.   or DirectoryName("Device*")
21605.   or DirectoryName("Export*")
21606.   or DirectoryName("Import*")
21607.   or DirectoryName("Log*")
21608.   or DirectoryName("*Log")
21609.   or DirectoryName("Maintenance*")
21610.   or DirectoryName("Rec*")
21611.   or DirectoryName("Sales*")
21612.   or DirectoryName("Search*")
21613.   or DirectoryName("User*")
21614. )
21615. # Data end.
21616.  
21617. # SystemOtherData
21618. or  
21619. # Databases start.
21620. (
21621.   FileName("*.crypt*")
21622.   or FileName("*.db*")
21623.   or FileName("*.rdb*")
21624.   or FileName("*.dc*")
21625.   or FileName("*.dict*")
21626.   or FileName("*.?db*")
21627.   or FileName("*.?rdb*")
21628.   or FileName("*.md*")
21629.   or FileName("*.myd")
21630.   or FileName("*.ndf")
21631.   or FileName("*.ns?")
21632.   or FileName("*.pab")
21633.   or FileName("*.pst")
21634.   or FileName("*.sd?*")
21635.   or FileName("*.sq**")
21636.   or FileName("*.tmd")
21637.   or FileName("*.tps")
21638.   or FileName("*.tr*")
21639. )
21640. # Databases end.
21641. 
21642. # SystemOtherData
21643. )
21644. # SystemOtherData end.
21645. 
21646. 	# Script: ZoneDoAction
21647. # Zone Do File Action - SortByName.
21648. 
21649. FileActions
21650. 
21651. 	# Footer:
21652. SetVariable(ZoneFooter, "----------------------------------------------------------
21653. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
21654. 
21655. Statistics Report:
21656. ------------------
21657.    Size:  
21658.    ------------------------
21659.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21660.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21661.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21662. 
21663.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21664.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21665. 
21666.    Location:
21667.    ------------------------
21668.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21669.              Files End: !ZoneEndCurrent!
21670.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21671.       
21672.    Gap Settings:
21673.    ------------------------
21674.          Gap Requested: !ZoneGapSizePer!%
21675.       Volume Rounding: !ZoneVolRoundUpPer!%
21676.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21677.                  
21678.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
21679.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
21680.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
21681.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
21682.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
21683.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
21684.      
21685.    Free Space after Zone:
21686.    ------------------------
21687.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21688.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21689.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21690. 
21691. Directory and Files Select:
21692. ---------------------------
21693. !ZoneTypeSelectCurrent!               
21694. ---------------------------
21695. ----------------------------------------------------------
21696. ")
21697. 	SetStatisticsWindowText("!ZoneFooter!")
21698. 	
21699. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
21700. 	# Script: DisplaySetFileStep
21701. 
21702. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21703. 
21704. /* add message and move to a new line. */
21705. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21706. ")
21707. 
21708. /* display the line. (hopefully.) */
21709. # Zone Footer Set Statistics Window Text
21710. 
21711. SetStatisticsWindowText("----------------------------------------------------------
21712. Zones Processed: 
21713. ----------------------------------------------------------
21714. !ZoneListByLine!
21715. ----------------------------------------------------------
21716. Zone Processing Step:
21717. !ZoneStepByLine!    
21718. ----------------------------------------------------------
21719. Current Zone:
21720. !ZoneFooter!
21721. ----------------------------------------------------------
21722. Volume Statistics:
21723. !VolumeStatisticsDetail!
21724. ----------------------------------------------------------
21725. Zone Detailed Report:
21726. ----------------------------------------------------------
21727. !ZoneStatisticsDetail!
21728. ----------------------------------------------------------
21729. ")
21730. 
21731. 
21732. 
21733. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21734. 
21735. # Script: BannerSet
21736. 
21737. # Script: DisplaySetDateTimeRun
21738. 
21739. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
21740. /* Xinclude "..\Display\BannerSet.MyDc"X */
21741. /* pause(1) */
21742. 
21743. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21744. 
21745. Title('!Heading!')
21746. /* pause(1) */
21747. 
21748. /* NOTE: Can't round or truncate to integer precision. */
21749. 
21750. pause(1)
21751. 
21752. # Commands:
21753. 
21754. /* Moves to Zone or above it. */
21755. # MoveUpToZone()
21756. 
21757. # Defrag
21758. 
21759. # Defragment(OPTIONS)
21760. 
21761. /* Shuffles files around trying to make a big enough gap for fragmented files. */
21762. # Defragment()
21763. 
21764. /* Only does files where a gap will fit it. */
21765. # Defragment(Fast)
21766. 
21767. /* Skips fragmented files larger than the Chunck Size.
21768. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
21769. # Defragment(Chunk Size)
21770. 
21771. /* Moves down to zone and packs zone to beginning if there are gaps. */
21772. /* Can be similar in performance to doing a SortBy. */
21773. # MoveDownFill()
21774. 
21775. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
21776. 
21777. 
21778. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
21779. 	# Script: DisplaySetFileStep
21780. 
21781. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21782. 
21783. /* add message and move to a new line. */
21784. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21785. ")
21786. 
21787. /* display the line. (hopefully.) */
21788. # Zone Footer Set Statistics Window Text
21789. 
21790. SetStatisticsWindowText("----------------------------------------------------------
21791. Zones Processed: 
21792. ----------------------------------------------------------
21793. !ZoneListByLine!
21794. ----------------------------------------------------------
21795. Zone Processing Step:
21796. !ZoneStepByLine!    
21797. ----------------------------------------------------------
21798. Current Zone:
21799. !ZoneFooter!
21800. ----------------------------------------------------------
21801. Volume Statistics:
21802. !VolumeStatisticsDetail!
21803. ----------------------------------------------------------
21804. Zone Detailed Report:
21805. ----------------------------------------------------------
21806. !ZoneStatisticsDetail!
21807. ----------------------------------------------------------
21808. ")
21809. 
21810. 
21811. 
21812. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21813. 
21814. # Script: BannerSet
21815. 
21816. # Script: DisplaySetDateTimeRun
21817. 
21818. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
21819. /* Xinclude "..\Display\BannerSet.MyDc"X */
21820. /* pause(1) */
21821. 
21822. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21823. 
21824. Title('!Heading!')
21825. /* pause(1) */
21826. 
21827. /* NOTE: Can't round or truncate to integer precision. */
21828. 
21829. pause(1)
21830. 
21831. 	# Script: ZoneDoFooter
21832. 
21833. /* ---------------------------------------------------------- */
21834. # File Select
21835. 	# Select Statments
21836. # File Actions 
21837. 	# Standard or OS File Actions.
21838. 	# Resume...
21839. 	
21840. 	# your stuff HERE (X)... post zone (file) file actions code.
21841. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
21842. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21843. 		# (X)
21844. 		
21845. 		/* ??? Set window? */
21846. 	
21847. 	# ADD THE GAP
21848. 		
21849. # Vacate (good for diagnostics)
21850. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
21851. 
21852. # DoNotVacate - DO NOT Vacate (recommended)
21853. 
21854. # Vacate
21855. /* AddGap(GapUsedLoc) */
21856. 
21857. # DO Not Vacate
21858. AddGap(GapUsedLoc, DoNotVacate) 
21859. 	
21860. 	
21861. /* ---------------------------------------------------------- */
21862. # (failed) TEST for boolean logic.
21863. 
21864. /* It should work in the gap calculations for turning options */
21865. /* on and off but it will NOT work here. */
21866. 
21867. /* Boolean setting X or FlagX. */
21868. /* Where X will be on or off: */
21869. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
21870. /*      For ON:  (X  *  FlagAny) */
21871. 
21872. /* 1) Failed, zero gap overrode the previous one. */
21873. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
21874. /* AddGap(GapUsedTemp) */ 
21875. 
21876. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
21877. /* AddGap(GapUsedTemp, DoNotVacate) */ 
21878. 
21879. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
21880. 
21881. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
21882. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
21883. /* AddGap(GapUsedTemp) */ 
21884. 
21885. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
21886. /* AddGap(GapUsedTemp, DoNotVacate) */ 
21887. 
21888. /* ---------------------------------------------------------- */
21889. 
21890. # Vacate
21891. /* AddGap(GapUsed) */
21892. 
21893. # DO NOT Vacate (recommended)
21894. /* AddGap(GapUsed, DoNotVacate) */ 
21895. 	
21896. 
21897. 		
21898. # 
21899. FileEnd
21900. /* ---------------------------------------------------------- */
21901. 
21902. # your stuff HERE (X)... post zone (file) code.
21903. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
21904. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21905. 	# (X)
21906. 
21907. SetVariable(FileStepDescription,"Zone finished, reporting.")
21908. # Script: DisplaySetFileStep
21909. 
21910. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21911. 
21912. /* add message and move to a new line. */
21913. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21914. ")
21915. 
21916. /* display the line. (hopefully.) */
21917. # Zone Footer Set Statistics Window Text
21918. 
21919. SetStatisticsWindowText("----------------------------------------------------------
21920. Zones Processed: 
21921. ----------------------------------------------------------
21922. !ZoneListByLine!
21923. ----------------------------------------------------------
21924. Zone Processing Step:
21925. !ZoneStepByLine!    
21926. ----------------------------------------------------------
21927. Current Zone:
21928. !ZoneFooter!
21929. ----------------------------------------------------------
21930. Volume Statistics:
21931. !VolumeStatisticsDetail!
21932. ----------------------------------------------------------
21933. Zone Detailed Report:
21934. ----------------------------------------------------------
21935. !ZoneStatisticsDetail!
21936. ----------------------------------------------------------
21937. ")
21938. 
21939. 
21940. 
21941. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21942. 
21943. # Script: BannerSet
21944. 
21945. # Script: DisplaySetDateTimeRun
21946. 
21947. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
21948. /* Xinclude "..\Display\BannerSet.MyDc"X */
21949. /* pause(1) */
21950. 
21951. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21952. 
21953. Title('!Heading!')
21954. /* pause(1) */
21955. 
21956. /* NOTE: Can't round or truncate to integer precision. */
21957. 
21958. pause(1)
21959. 
21960. # Script: ZoneWhenFinished
21961. 
21962. # Script: BannerSet
21963. 
21964. # Script: DisplaySetDateTimeRun
21965. 
21966. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
21967. /* Xinclude "..\Display\BannerSet.MyDc"X */
21968. /* pause(1) */
21969. 
21970. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21971. 
21972. Title('!Heading!')
21973. /* pause(1) */
21974. 
21975. /* NOTE: Can't round or truncate to integer precision. */
21976. 
21977. # Script: BannerLog
21978. 
21979. AppendLogfile("!LogFileName!", "!Title!")
21980. 
21981. 
21982. 
21983. # Zone Statistics	
21984. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
21985. 
21986. # Footer:
21987. SetVariable(ZoneFooter, "----------------------------------------------------------
21988. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
21989. 
21990. Statistics Report:
21991. ------------------
21992.    Size:  
21993.    ------------------------
21994.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21995.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21996.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21997. 
21998.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21999.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22000. 
22001.    Location:
22002.    ------------------------
22003.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22004.              Files End: !ZoneEndCurrent!
22005.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22006.       
22007.    Gap Settings:
22008.    ------------------------
22009.          Gap Requested: !ZoneGapSizePer!%
22010.       Volume Rounding: !ZoneVolRoundUpPer!%
22011.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22012.                  
22013.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22014.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22015.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22016.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22017.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22018.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22019.      
22020.    Free Space after Zone:
22021.    ------------------------
22022.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22023.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22024.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22025. 
22026. Directory and Files Select:
22027. ---------------------------
22028. !ZoneTypeSelectCurrent!               
22029. ---------------------------
22030. ----------------------------------------------------------
22031. ")
22032. 
22033. AppendLogfile("!LogFileName!", ".")
22034. AppendLogfile("!LogFileName!", "!ZoneFooter!")
22035. AppendLogfile("!LogFileName!", ".")
22036. 
22037. # Zone Footer Set Statistics Window Text
22038. 
22039. SetStatisticsWindowText("----------------------------------------------------------
22040. Zones Processed: 
22041. ----------------------------------------------------------
22042. !ZoneListByLine!
22043. ----------------------------------------------------------
22044. Zone Processing Step:
22045. !ZoneStepByLine!    
22046. ----------------------------------------------------------
22047. Current Zone:
22048. !ZoneFooter!
22049. ----------------------------------------------------------
22050. Volume Statistics:
22051. !VolumeStatisticsDetail!
22052. ----------------------------------------------------------
22053. Zone Detailed Report:
22054. ----------------------------------------------------------
22055. !ZoneStatisticsDetail!
22056. ----------------------------------------------------------
22057. ")
22058. 
22059. 
22060. 
22061. /* pause() */
22062. /* pause() */
22063. 
22064. 
22065. 
22066. 
22067. /* ---------------------------------------------------------- */
22068. 
22069. 
22070. /* ---------------------------------------------------------- */
22071. /* Zone Reference & World */
22072. # Script: DefragZoneTypeReference
22073. /* ---------------------------------------------------------- */
22074. /* Zone Reference & World */
22075. SetVariable(ZoneLabel, "!ZoneLabelReference!")
22076. SetVariable(ZoneDescription, "!ZoneDescriptionReference!")
22077. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpReference!")
22078. SetVariable(ZoneGapSize, "!ZoneGapSizeReference!")
22079. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectReference
22080. # Reference start.
22081. # NotBlobsArchivesBu start.
22082. (not (
22083. # Blobs start.
22084. (
22085. # BlobsAndExceptions start.
22086. ( not(
22087.   FileName("*.bat")
22088.   or FileName("*.css")
22089.   or FileName("*.dll")
22090.   or FileName("*.exe")
22091.   or FileName("*.htm*")
22092.   or FileName("*.jar")
22093.   or FileName("*.js")
22094.   or FileName("*.script")
22095.   or FileName("*.wsf")
22096.   or (
22097. # Databases start.
22098. (
22099.   FileName("*.crypt*")
22100.   or FileName("*.db*")
22101.   or FileName("*.rdb*")
22102.   or FileName("*.dc*")
22103.   or FileName("*.dict*")
22104.   or FileName("*.?db*")
22105.   or FileName("*.?rdb*")
22106.   or FileName("*.md*")
22107.   or FileName("*.myd")
22108.   or FileName("*.ndf")
22109.   or FileName("*.ns?")
22110.   or FileName("*.pab")
22111.   or FileName("*.pst")
22112.   or FileName("*.sd?*")
22113.   or FileName("*.sq**")
22114.   or FileName("*.tmd")
22115.   or FileName("*.tps")
22116.   or FileName("*.tr*")
22117. )
22118. # Databases end.
22119. 
22120.     # BlobsAndExceptions
22121.     or 
22122. # Data start.
22123. (
22124.   DirectoryName("Data*")
22125.   or DirectoryName("Device*")
22126.   or DirectoryName("Export*")
22127.   or DirectoryName("Import*")
22128.   or DirectoryName("Log*")
22129.   or DirectoryName("*Log")
22130.   or DirectoryName("Maintenance*")
22131.   or DirectoryName("Rec*")
22132.   or DirectoryName("Sales*")
22133.   or DirectoryName("Search*")
22134.   or DirectoryName("User*")
22135. )
22136. # Data end.
22137. 
22138.     # BlobsAndExceptions
22139.   )
22140. ) )
22141. # BlobsAndExceptions end.
22142. 
22143. # Blobs
22144. ) and (
22145.   Size(BlobFileSize,0)
22146.   or (
22147.     FileName("*.arj")
22148.     or FileName("*.bup")
22149.     or FileName("*.bz2")
22150.     or FileName("*.chm")
22151.     or FileName("*.dvr-ms")
22152.     or FileName("*.gz")
22153.     or FileName("*.ifo")
22154.     or FileName("*.lzh")
22155.     or FileName("*.pdf")
22156.     or FileName("*.rpm")
22157.     or FileName("*.wmv")
22158.     or FileName("*.vob")
22159.     or FileName("*.z")
22160.   ) 
22161. )
22162. # Blobs end.
22163. 
22164. # NotBlobsArchivesBu
22165. or 
22166. # Archives start.
22167. (
22168.   DirectoryName("*Archive*")
22169.   or DirectoryName("*History*")
22170.   or DirectoryName("*Old")
22171.   or DirectoryName("* Old *")
22172.   or DirectoryName("Old *")
22173. 
22174.   or FileName("*.7z")
22175.   or FileName("*.cab")
22176.   or FileName("*.iso")
22177.   or FileName("*.msi")
22178.   or FileName("*.old")
22179.   or FileName("*.rar")
22180.   or FileName("*.tar")
22181.   or FileName("*.zip")
22182.   or
22183. # WinSysLow start.
22184. (
22185.   DirectoryName("$*")
22186.   or DirectoryName("0*")
22187.   or DirectoryName("1*")
22188.   or DirectoryName("2*")
22189.   or DirectoryName("3*")
22190.   or DirectoryName("4*")
22191.   or DirectoryName("5*")
22192.   or DirectoryName("6*")
22193.   or DirectoryName("7*")
22194.   or DirectoryName("8*")
22195.   or DirectoryName("9*")
22196. 
22197.   or DirectoryName("dllcache")
22198.   or DirectoryName("Downloaded Installations")
22199.   or DirectoryName("Ehome")
22200.   or DirectoryName("Fonts")
22201.   or DirectoryName("Help")
22202.   or DirectoryName("I386")
22203.   or DirectoryName("ie?updates")
22204.   or DirectoryName("Installer")
22205.   or DirectoryName("Installshield Installation Information")
22206.   or DirectoryName("IME")
22207.   or DirectoryName("*RECYCLE*")
22208.   or DirectoryName("ServicePackFiles")
22209.   or DirectoryName("SoftwareDistribution")
22210.   or DirectoryName("Speech")
22211.   or DirectoryName("Symbols")
22212.   or DirectoryName("System Volume Information")
22213.   or DirectoryName("windows.old")
22214. )
22215. # WinSysLow end.
22216. 
22217.   # Archives
22218. )
22219. # Archives end.
22220. 
22221. # NotBlobsArchivesBu
22222. or
22223. # Backups start.
22224. (
22225.   DirectoryName("*Backup*")
22226.   or DirectoryName("*Bu")
22227.   or DirectoryName("* Bu *")
22228.   or DirectoryName("Bu *")
22229. 
22230.   or FileName("*.bak")
22231.   or FileName("* - Copy*")
22232. )
22233. # Backups end.
22234. 
22235. # NotBlobsArchivesBu
22236. ) )
22237. # NotBlobsArchivesBu end.
22238. 
22239. # Reference
22240. and (
22241. # Reference start.
22242. (
22243.   DirectoryName("World*") or
22244.   DirectoryName("Education*") or
22245.   DirectoryName("Entertainment*") or
22246.   DirectoryName("Food*") or
22247.   DirectoryName("Geography*") or
22248.   DirectoryName("Help*") or
22249.   DirectoryName("Humo*") or
22250.   DirectoryName("Internet*") or
22251.   DirectoryName("Legal*") or
22252.   DirectoryName("Linquistics*") or
22253.   DirectoryName("Media*") or
22254.   DirectoryName("Multimedia*") or
22255.   DirectoryName("Reference*") or
22256.   DirectoryName("Sales*") or
22257.   DirectoryName("Science*") or
22258.   DirectoryName("Social*") or
22259.   DirectoryName("Technology*")
22260. )
22261. # Reference end.
22262. 
22263. # Reference
22264. )
22265. # Reference end.
22266. ')
22267. 
22268. 	# Script: ZoneDoHeader
22269. 
22270. # Script: ZoneWhenStarted
22271. 
22272. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
22273. # Script: DisplaySetZone
22274. 
22275. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
22276. SetVariable(FileStepDescription,	"")
22277. 
22278. SetVariable(ZoneStepByLine, 			"Zone started.
22279. ")
22280. 
22281. # Script: BannerDescriptionSet
22282. 
22283. # Script: BannerSet
22284. 
22285. # Script: DisplaySetDateTimeRun
22286. 
22287. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
22288. /* Xinclude "..\Display\BannerSet.MyDc"X */
22289. /* pause(1) */
22290. 
22291. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22292. 
22293. Title('!Heading!')
22294. /* pause(1) */
22295. 
22296. /* NOTE: Can't round or truncate to integer precision. */
22297. 
22298. # Script: BannerLog
22299. 
22300. AppendLogfile("!LogFileName!", "!Title!")
22301. 
22302. 
22303. 
22304. pause(1)
22305. 
22306. 
22307. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
22308. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
22309. 
22310. SetVariable(ZoneStepNoCurrent, 0)
22311. 
22312. 
22313. # Script: ZoneDoCurrentClear
22314. 
22315. SetVariable(ZoneTypeSelectCurrent, 		"")
22316. 
22317. SetVariable(ZoneBeginCurrent, 			0)
22318. SetVariable(ZoneBeginPerCurrent, 		0)
22319. SetVariable(ZoneEndCurrent, 			0)
22320. SetVariable(ZoneEndPerCurrent, 			0)
22321. 
22322. SetVariable(ZoneSizeCurrent,			0)
22323. SetVariable(ZoneSizePerCurrent,			0)
22324. 
22325. SetVariable(ZoneGapRequestedCurrent,	0)
22326. SetVariable(ZoneGapRoundedCurrent, 		0)
22327. SetVariable(ZoneGapAdjustedCurrent, 	0)
22328. SetVariable(ZoneGapAvailableCurrent, 	0)
22329. SetVariable(ZoneGapCurrent,				0)
22330. SetVariable(ZoneGapUsedCurrent, 		0)
22331. 
22332. SetVariable(ZoneGapActualCurrent, 		0)
22333. SetVariable(ZoneGapActualPerCurrent, 	0)
22334. 
22335. SetVariable(ZoneSizeActual, 			0)
22336. SetVariable(ZoneSizeActualCurrent,		0)
22337. 
22338. SetVariable(ZoneEndActual, 				0)
22339. SetVariable(ZoneEndActualCurrent,		0)			
22340. SetVariable(ZoneSizeActualPerCurrent, 	0)
22341.       
22342. SetVariable(ZoneFilesFolders,			0)
22343. SetVariable(ZoneFilesFoldersPer,		0) 
22344. 
22345. SetVariable(ZoneFragments,				0)
22346. SetVariable(ZoneFragmentsPer,			0) 
22347. 		
22348. SetVariable(ZoneEndActualCurrent, 		0)
22349. SetVariable(ZoneEndActualPerCurrent, 	0)
22350. 
22351. # Gap Calculation Methodology:
22352. 	# Requested
22353. 	SetVariable(GapRequested, 			0) 
22354. 	SetVariable(GapRequestedStd, 		0) 
22355. 	SetVariable(GapRequestedMft, 		0) 
22356. 	SetVariable(GapRequestedOs, 		0) 
22357. 	SetVariable(GapRequestedOriginal, 	0) 
22358. 	
22359. 	# Gap Adjustments
22360. 	SetVariable(GapRounded, 			0)
22361. 	# SetVariable(GapAdjusted, 			0)
22362. 	SetVariable(GapAvailable, 			0)
22363. 	SetVariable(GapCurrent, 			0)
22364. 	SetVariable(GapActual, 				0)
22365. 	SetVariable(GapUsed, 				0)
22366. 	
22367. 	# Gap Adjustments
22368. 	SetVariable(GapRoundedLoc, 			0)
22369. 	# SetVariable(GapAdjustedLoc, 		0)
22370. 	SetVariable(GapAvailableLoc, 		0)
22371. 	SetVariable(GapCurrentLoc, 			0)
22372. 	SetVariable(GapActualLoc,			0)
22373. 	SetVariable(GapUsedLoc,				0)
22374. 	
22375. 	# Space usage
22376. 	SetVariable(ZoneFreePerRequested, 	0)
22377. 	SetVariable(ZoneFreePerUsed, 		0)
22378. 
22379. # Gap Size & Rounding
22380. 	SetVariable(ZoneGapSizePer, 		0)
22381. 	SetVariable(ZoneVolRoundUpPer, 		0)
22382. 	
22383. 	# Free Space
22384. 	SetVariable(ZoneFreeUsedPer, 		0)
22385. 	SetVariable(ZoneFreeRequestedPer, 	0)
22386. 
22387. 
22388. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
22389. 
22390. # Footer:
22391. SetVariable(ZoneFooter, "----------------------------------------------------------
22392. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
22393. 
22394. Statistics Report:
22395. ------------------
22396.    Size:  
22397.    ------------------------
22398.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22399.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22400.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22401. 
22402.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22403.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22404. 
22405.    Location:
22406.    ------------------------
22407.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22408.              Files End: !ZoneEndCurrent!
22409.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22410.       
22411.    Gap Settings:
22412.    ------------------------
22413.          Gap Requested: !ZoneGapSizePer!%
22414.       Volume Rounding: !ZoneVolRoundUpPer!%
22415.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22416.                  
22417.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22418.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22419.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22420.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22421.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22422.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22423.      
22424.    Free Space after Zone:
22425.    ------------------------
22426.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22427.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22428.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22429. 
22430. Directory and Files Select:
22431. ---------------------------
22432. !ZoneTypeSelectCurrent!               
22433. ---------------------------
22434. ----------------------------------------------------------
22435. ")
22436. 
22437. # Script: BannerSet
22438. 
22439. # Script: DisplaySetDateTimeRun
22440. 
22441. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
22442. /* Xinclude "..\Display\BannerSet.MyDc"X */
22443. /* pause(1) */
22444. 
22445. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22446. 
22447. Title('!Heading!')
22448. /* pause(1) */
22449. 
22450. /* NOTE: Can't round or truncate to integer precision. */
22451. 
22452. # Script: BannerLog
22453. 
22454. AppendLogfile("!LogFileName!", "!Title!")
22455. 
22456. 
22457. 
22458. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
22459. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
22460. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:46")
22461. 
22462. SetVariable(ZoneListByLine, "!ZoneListByLine!
22463. Zone: !ZoneNoCurrent! 2021-11-09 20:22:46 0:00:05 !ZoneLabel! !ZoneDescription!")
22464. 
22465. 
22466. /* Fixed Zone Position Handling */
22467. /* Literal number: */
22468. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
22469. /* Percentage of disk: */
22470. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
22471. /* Gap */
22472. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
22473. 
22474. /* ---------------------------------------------------------- */
22475. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
22476. # Script: DisplaySetFileStep
22477. 
22478. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22479. 
22480. /* add message and move to a new line. */
22481. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22482. ")
22483. 
22484. /* display the line. (hopefully.) */
22485. # Zone Footer Set Statistics Window Text
22486. 
22487. SetStatisticsWindowText("----------------------------------------------------------
22488. Zones Processed: 
22489. ----------------------------------------------------------
22490. !ZoneListByLine!
22491. ----------------------------------------------------------
22492. Zone Processing Step:
22493. !ZoneStepByLine!    
22494. ----------------------------------------------------------
22495. Current Zone:
22496. !ZoneFooter!
22497. ----------------------------------------------------------
22498. Volume Statistics:
22499. !VolumeStatisticsDetail!
22500. ----------------------------------------------------------
22501. Zone Detailed Report:
22502. ----------------------------------------------------------
22503. !ZoneStatisticsDetail!
22504. ----------------------------------------------------------
22505. ")
22506. 
22507. 
22508. 
22509. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22510. 
22511. # Script: BannerSet
22512. 
22513. # Script: DisplaySetDateTimeRun
22514. 
22515. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
22516. /* Xinclude "..\Display\BannerSet.MyDc"X */
22517. /* pause(1) */
22518. 
22519. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22520. 
22521. Title('!Heading!')
22522. /* pause(1) */
22523. 
22524. /* NOTE: Can't round or truncate to integer precision. */
22525. 
22526. pause(1)
22527. 
22528. # your stuff HERE (X)... pre file select code.
22529. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
22530. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22531. 	# (X)
22532. 
22533. FileSelect
22534. 
22535. 	# your stuff can't really go here (errors.)
22536. 	# maybe for some reason I don't know of...
22537. 	
22538. 	# Actions next...
22539. 	# Script: ZoneDo ZoneTypeSelectReference
22540. # Reference start.
22541. # NotBlobsArchivesBu start.
22542. (not (
22543. # Blobs start.
22544. (
22545. # BlobsAndExceptions start.
22546. ( not(
22547.   FileName("*.bat")
22548.   or FileName("*.css")
22549.   or FileName("*.dll")
22550.   or FileName("*.exe")
22551.   or FileName("*.htm*")
22552.   or FileName("*.jar")
22553.   or FileName("*.js")
22554.   or FileName("*.script")
22555.   or FileName("*.wsf")
22556.   or (
22557. # Databases start.
22558. (
22559.   FileName("*.crypt*")
22560.   or FileName("*.db*")
22561.   or FileName("*.rdb*")
22562.   or FileName("*.dc*")
22563.   or FileName("*.dict*")
22564.   or FileName("*.?db*")
22565.   or FileName("*.?rdb*")
22566.   or FileName("*.md*")
22567.   or FileName("*.myd")
22568.   or FileName("*.ndf")
22569.   or FileName("*.ns?")
22570.   or FileName("*.pab")
22571.   or FileName("*.pst")
22572.   or FileName("*.sd?*")
22573.   or FileName("*.sq**")
22574.   or FileName("*.tmd")
22575.   or FileName("*.tps")
22576.   or FileName("*.tr*")
22577. )
22578. # Databases end.
22579. 
22580.     # BlobsAndExceptions
22581.     or 
22582. # Data start.
22583. (
22584.   DirectoryName("Data*")
22585.   or DirectoryName("Device*")
22586.   or DirectoryName("Export*")
22587.   or DirectoryName("Import*")
22588.   or DirectoryName("Log*")
22589.   or DirectoryName("*Log")
22590.   or DirectoryName("Maintenance*")
22591.   or DirectoryName("Rec*")
22592.   or DirectoryName("Sales*")
22593.   or DirectoryName("Search*")
22594.   or DirectoryName("User*")
22595. )
22596. # Data end.
22597. 
22598.     # BlobsAndExceptions
22599.   )
22600. ) )
22601. # BlobsAndExceptions end.
22602. 
22603. # Blobs
22604. ) and (
22605.   Size(BlobFileSize,0)
22606.   or (
22607.     FileName("*.arj")
22608.     or FileName("*.bup")
22609.     or FileName("*.bz2")
22610.     or FileName("*.chm")
22611.     or FileName("*.dvr-ms")
22612.     or FileName("*.gz")
22613.     or FileName("*.ifo")
22614.     or FileName("*.lzh")
22615.     or FileName("*.pdf")
22616.     or FileName("*.rpm")
22617.     or FileName("*.wmv")
22618.     or FileName("*.vob")
22619.     or FileName("*.z")
22620.   ) 
22621. )
22622. # Blobs end.
22623. 
22624. # NotBlobsArchivesBu
22625. or 
22626. # Archives start.
22627. (
22628.   DirectoryName("*Archive*")
22629.   or DirectoryName("*History*")
22630.   or DirectoryName("*Old")
22631.   or DirectoryName("* Old *")
22632.   or DirectoryName("Old *")
22633. 
22634.   or FileName("*.7z")
22635.   or FileName("*.cab")
22636.   or FileName("*.iso")
22637.   or FileName("*.msi")
22638.   or FileName("*.old")
22639.   or FileName("*.rar")
22640.   or FileName("*.tar")
22641.   or FileName("*.zip")
22642.   or
22643. # WinSysLow start.
22644. (
22645.   DirectoryName("$*")
22646.   or DirectoryName("0*")
22647.   or DirectoryName("1*")
22648.   or DirectoryName("2*")
22649.   or DirectoryName("3*")
22650.   or DirectoryName("4*")
22651.   or DirectoryName("5*")
22652.   or DirectoryName("6*")
22653.   or DirectoryName("7*")
22654.   or DirectoryName("8*")
22655.   or DirectoryName("9*")
22656. 
22657.   or DirectoryName("dllcache")
22658.   or DirectoryName("Downloaded Installations")
22659.   or DirectoryName("Ehome")
22660.   or DirectoryName("Fonts")
22661.   or DirectoryName("Help")
22662.   or DirectoryName("I386")
22663.   or DirectoryName("ie?updates")
22664.   or DirectoryName("Installer")
22665.   or DirectoryName("Installshield Installation Information")
22666.   or DirectoryName("IME")
22667.   or DirectoryName("*RECYCLE*")
22668.   or DirectoryName("ServicePackFiles")
22669.   or DirectoryName("SoftwareDistribution")
22670.   or DirectoryName("Speech")
22671.   or DirectoryName("Symbols")
22672.   or DirectoryName("System Volume Information")
22673.   or DirectoryName("windows.old")
22674. )
22675. # WinSysLow end.
22676. 
22677.   # Archives
22678. )
22679. # Archives end.
22680. 
22681. # NotBlobsArchivesBu
22682. or
22683. # Backups start.
22684. (
22685.   DirectoryName("*Backup*")
22686.   or DirectoryName("*Bu")
22687.   or DirectoryName("* Bu *")
22688.   or DirectoryName("Bu *")
22689. 
22690.   or FileName("*.bak")
22691.   or FileName("* - Copy*")
22692. )
22693. # Backups end.
22694. 
22695. # NotBlobsArchivesBu
22696. ) )
22697. # NotBlobsArchivesBu end.
22698. 
22699. # Reference
22700. and (
22701. # Reference start.
22702. (
22703.   DirectoryName("World*") or
22704.   DirectoryName("Education*") or
22705.   DirectoryName("Entertainment*") or
22706.   DirectoryName("Food*") or
22707.   DirectoryName("Geography*") or
22708.   DirectoryName("Help*") or
22709.   DirectoryName("Humo*") or
22710.   DirectoryName("Internet*") or
22711.   DirectoryName("Legal*") or
22712.   DirectoryName("Linquistics*") or
22713.   DirectoryName("Media*") or
22714.   DirectoryName("Multimedia*") or
22715.   DirectoryName("Reference*") or
22716.   DirectoryName("Sales*") or
22717.   DirectoryName("Science*") or
22718.   DirectoryName("Social*") or
22719.   DirectoryName("Technology*")
22720. )
22721. # Reference end.
22722. 
22723. # Reference
22724. )
22725. # Reference end.
22726. 
22727. 	# Script: ZoneDoAction
22728. # Zone Do File Action - SortByName.
22729. 
22730. FileActions
22731. 
22732. 	# Footer:
22733. SetVariable(ZoneFooter, "----------------------------------------------------------
22734. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
22735. 
22736. Statistics Report:
22737. ------------------
22738.    Size:  
22739.    ------------------------
22740.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22741.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22742.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22743. 
22744.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22745.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22746. 
22747.    Location:
22748.    ------------------------
22749.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22750.              Files End: !ZoneEndCurrent!
22751.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22752.       
22753.    Gap Settings:
22754.    ------------------------
22755.          Gap Requested: !ZoneGapSizePer!%
22756.       Volume Rounding: !ZoneVolRoundUpPer!%
22757.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22758.                  
22759.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22760.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22761.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22762.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22763.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22764.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22765.      
22766.    Free Space after Zone:
22767.    ------------------------
22768.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22769.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22770.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22771. 
22772. Directory and Files Select:
22773. ---------------------------
22774. !ZoneTypeSelectCurrent!               
22775. ---------------------------
22776. ----------------------------------------------------------
22777. ")
22778. 	SetStatisticsWindowText("!ZoneFooter!")
22779. 	
22780. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
22781. 	# Script: DisplaySetFileStep
22782. 
22783. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22784. 
22785. /* add message and move to a new line. */
22786. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22787. ")
22788. 
22789. /* display the line. (hopefully.) */
22790. # Zone Footer Set Statistics Window Text
22791. 
22792. SetStatisticsWindowText("----------------------------------------------------------
22793. Zones Processed: 
22794. ----------------------------------------------------------
22795. !ZoneListByLine!
22796. ----------------------------------------------------------
22797. Zone Processing Step:
22798. !ZoneStepByLine!    
22799. ----------------------------------------------------------
22800. Current Zone:
22801. !ZoneFooter!
22802. ----------------------------------------------------------
22803. Volume Statistics:
22804. !VolumeStatisticsDetail!
22805. ----------------------------------------------------------
22806. Zone Detailed Report:
22807. ----------------------------------------------------------
22808. !ZoneStatisticsDetail!
22809. ----------------------------------------------------------
22810. ")
22811. 
22812. 
22813. 
22814. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22815. 
22816. # Script: BannerSet
22817. 
22818. # Script: DisplaySetDateTimeRun
22819. 
22820. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
22821. /* Xinclude "..\Display\BannerSet.MyDc"X */
22822. /* pause(1) */
22823. 
22824. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22825. 
22826. Title('!Heading!')
22827. /* pause(1) */
22828. 
22829. /* NOTE: Can't round or truncate to integer precision. */
22830. 
22831. pause(1)
22832. 
22833. # Commands:
22834. 
22835. /* Moves to Zone or above it. */
22836. # MoveUpToZone()
22837. 
22838. # Defrag
22839. 
22840. # Defragment(OPTIONS)
22841. 
22842. /* Shuffles files around trying to make a big enough gap for fragmented files. */
22843. # Defragment()
22844. 
22845. /* Only does files where a gap will fit it. */
22846. # Defragment(Fast)
22847. 
22848. /* Skips fragmented files larger than the Chunck Size.
22849. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
22850. # Defragment(Chunk Size)
22851. 
22852. /* Moves down to zone and packs zone to beginning if there are gaps. */
22853. /* Can be similar in performance to doing a SortBy. */
22854. # MoveDownFill()
22855. 
22856. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
22857. 
22858. 
22859. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
22860. 	# Script: DisplaySetFileStep
22861. 
22862. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22863. 
22864. /* add message and move to a new line. */
22865. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22866. ")
22867. 
22868. /* display the line. (hopefully.) */
22869. # Zone Footer Set Statistics Window Text
22870. 
22871. SetStatisticsWindowText("----------------------------------------------------------
22872. Zones Processed: 
22873. ----------------------------------------------------------
22874. !ZoneListByLine!
22875. ----------------------------------------------------------
22876. Zone Processing Step:
22877. !ZoneStepByLine!    
22878. ----------------------------------------------------------
22879. Current Zone:
22880. !ZoneFooter!
22881. ----------------------------------------------------------
22882. Volume Statistics:
22883. !VolumeStatisticsDetail!
22884. ----------------------------------------------------------
22885. Zone Detailed Report:
22886. ----------------------------------------------------------
22887. !ZoneStatisticsDetail!
22888. ----------------------------------------------------------
22889. ")
22890. 
22891. 
22892. 
22893. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22894. 
22895. # Script: BannerSet
22896. 
22897. # Script: DisplaySetDateTimeRun
22898. 
22899. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
22900. /* Xinclude "..\Display\BannerSet.MyDc"X */
22901. /* pause(1) */
22902. 
22903. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22904. 
22905. Title('!Heading!')
22906. /* pause(1) */
22907. 
22908. /* NOTE: Can't round or truncate to integer precision. */
22909. 
22910. pause(1)
22911. 
22912. 	# Script: ZoneDoFooter
22913. 
22914. /* ---------------------------------------------------------- */
22915. # File Select
22916. 	# Select Statments
22917. # File Actions 
22918. 	# Standard or OS File Actions.
22919. 	# Resume...
22920. 	
22921. 	# your stuff HERE (X)... post zone (file) file actions code.
22922. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
22923. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22924. 		# (X)
22925. 		
22926. 		/* ??? Set window? */
22927. 	
22928. 	# ADD THE GAP
22929. 		
22930. # Vacate (good for diagnostics)
22931. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
22932. 
22933. # DoNotVacate - DO NOT Vacate (recommended)
22934. 
22935. # Vacate
22936. /* AddGap(GapUsedLoc) */
22937. 
22938. # DO Not Vacate
22939. AddGap(GapUsedLoc, DoNotVacate) 
22940. 	
22941. 	
22942. /* ---------------------------------------------------------- */
22943. # (failed) TEST for boolean logic.
22944. 
22945. /* It should work in the gap calculations for turning options */
22946. /* on and off but it will NOT work here. */
22947. 
22948. /* Boolean setting X or FlagX. */
22949. /* Where X will be on or off: */
22950. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
22951. /*      For ON:  (X  *  FlagAny) */
22952. 
22953. /* 1) Failed, zero gap overrode the previous one. */
22954. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
22955. /* AddGap(GapUsedTemp) */ 
22956. 
22957. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
22958. /* AddGap(GapUsedTemp, DoNotVacate) */ 
22959. 
22960. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
22961. 
22962. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
22963. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
22964. /* AddGap(GapUsedTemp) */ 
22965. 
22966. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
22967. /* AddGap(GapUsedTemp, DoNotVacate) */ 
22968. 
22969. /* ---------------------------------------------------------- */
22970. 
22971. # Vacate
22972. /* AddGap(GapUsed) */
22973. 
22974. # DO NOT Vacate (recommended)
22975. /* AddGap(GapUsed, DoNotVacate) */ 
22976. 	
22977. 
22978. 		
22979. # 
22980. FileEnd
22981. /* ---------------------------------------------------------- */
22982. 
22983. # your stuff HERE (X)... post zone (file) code.
22984. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
22985. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22986. 	# (X)
22987. 
22988. SetVariable(FileStepDescription,"Zone finished, reporting.")
22989. # Script: DisplaySetFileStep
22990. 
22991. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22992. 
22993. /* add message and move to a new line. */
22994. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22995. ")
22996. 
22997. /* display the line. (hopefully.) */
22998. # Zone Footer Set Statistics Window Text
22999. 
23000. SetStatisticsWindowText("----------------------------------------------------------
23001. Zones Processed: 
23002. ----------------------------------------------------------
23003. !ZoneListByLine!
23004. ----------------------------------------------------------
23005. Zone Processing Step:
23006. !ZoneStepByLine!    
23007. ----------------------------------------------------------
23008. Current Zone:
23009. !ZoneFooter!
23010. ----------------------------------------------------------
23011. Volume Statistics:
23012. !VolumeStatisticsDetail!
23013. ----------------------------------------------------------
23014. Zone Detailed Report:
23015. ----------------------------------------------------------
23016. !ZoneStatisticsDetail!
23017. ----------------------------------------------------------
23018. ")
23019. 
23020. 
23021. 
23022. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23023. 
23024. # Script: BannerSet
23025. 
23026. # Script: DisplaySetDateTimeRun
23027. 
23028. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
23029. /* Xinclude "..\Display\BannerSet.MyDc"X */
23030. /* pause(1) */
23031. 
23032. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23033. 
23034. Title('!Heading!')
23035. /* pause(1) */
23036. 
23037. /* NOTE: Can't round or truncate to integer precision. */
23038. 
23039. pause(1)
23040. 
23041. # Script: ZoneWhenFinished
23042. 
23043. # Script: BannerSet
23044. 
23045. # Script: DisplaySetDateTimeRun
23046. 
23047. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
23048. /* Xinclude "..\Display\BannerSet.MyDc"X */
23049. /* pause(1) */
23050. 
23051. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23052. 
23053. Title('!Heading!')
23054. /* pause(1) */
23055. 
23056. /* NOTE: Can't round or truncate to integer precision. */
23057. 
23058. # Script: BannerLog
23059. 
23060. AppendLogfile("!LogFileName!", "!Title!")
23061. 
23062. 
23063. 
23064. # Zone Statistics	
23065. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
23066. 
23067. # Footer:
23068. SetVariable(ZoneFooter, "----------------------------------------------------------
23069. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
23070. 
23071. Statistics Report:
23072. ------------------
23073.    Size:  
23074.    ------------------------
23075.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23076.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23077.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23078. 
23079.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23080.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23081. 
23082.    Location:
23083.    ------------------------
23084.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23085.              Files End: !ZoneEndCurrent!
23086.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23087.       
23088.    Gap Settings:
23089.    ------------------------
23090.          Gap Requested: !ZoneGapSizePer!%
23091.       Volume Rounding: !ZoneVolRoundUpPer!%
23092.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23093.                  
23094.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
23095.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
23096.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
23097.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
23098.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
23099.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
23100.      
23101.    Free Space after Zone:
23102.    ------------------------
23103.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23104.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23105.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23106. 
23107. Directory and Files Select:
23108. ---------------------------
23109. !ZoneTypeSelectCurrent!               
23110. ---------------------------
23111. ----------------------------------------------------------
23112. ")
23113. 
23114. AppendLogfile("!LogFileName!", ".")
23115. AppendLogfile("!LogFileName!", "!ZoneFooter!")
23116. AppendLogfile("!LogFileName!", ".")
23117. 
23118. # Zone Footer Set Statistics Window Text
23119. 
23120. SetStatisticsWindowText("----------------------------------------------------------
23121. Zones Processed: 
23122. ----------------------------------------------------------
23123. !ZoneListByLine!
23124. ----------------------------------------------------------
23125. Zone Processing Step:
23126. !ZoneStepByLine!    
23127. ----------------------------------------------------------
23128. Current Zone:
23129. !ZoneFooter!
23130. ----------------------------------------------------------
23131. Volume Statistics:
23132. !VolumeStatisticsDetail!
23133. ----------------------------------------------------------
23134. Zone Detailed Report:
23135. ----------------------------------------------------------
23136. !ZoneStatisticsDetail!
23137. ----------------------------------------------------------
23138. ")
23139. 
23140. 
23141. 
23142. /* pause() */
23143. /* pause() */
23144. 
23145. 
23146. 
23147. 
23148. /* ---------------------------------------------------------- */
23149. 
23150. 
23151. /* ---------------------------------------------------------- */
23152. /* Zone SpaceHogs (BLOBS) */
23153. # Script: DefragZoneTypeSpaceHogs
23154. /* ---------------------------------------------------------- */
23155. /* Zone SpaceHogs (BLOBS) */
23156. SetVariable(ZoneLabel, "!ZoneLabelSpaceHogs!")
23157. SetVariable(ZoneDescription, "!ZoneDescriptionSpaceHogs!")
23158. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSpaceHogs!")
23159. SetVariable(ZoneGapSize, "!ZoneGapSizeSpaceHogs!")
23160. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectSpaceHogs
23161. # SpaceHogs start.
23162. not(
23163. # Archives start.
23164. (
23165.   DirectoryName("*Archive*")
23166.   or DirectoryName("*History*")
23167.   or DirectoryName("*Old")
23168.   or DirectoryName("* Old *")
23169.   or DirectoryName("Old *")
23170. 
23171.   or FileName("*.7z")
23172.   or FileName("*.cab")
23173.   or FileName("*.iso")
23174.   or FileName("*.msi")
23175.   or FileName("*.old")
23176.   or FileName("*.rar")
23177.   or FileName("*.tar")
23178.   or FileName("*.zip")
23179.   or
23180. # WinSysLow start.
23181. (
23182.   DirectoryName("$*")
23183.   or DirectoryName("0*")
23184.   or DirectoryName("1*")
23185.   or DirectoryName("2*")
23186.   or DirectoryName("3*")
23187.   or DirectoryName("4*")
23188.   or DirectoryName("5*")
23189.   or DirectoryName("6*")
23190.   or DirectoryName("7*")
23191.   or DirectoryName("8*")
23192.   or DirectoryName("9*")
23193. 
23194.   or DirectoryName("dllcache")
23195.   or DirectoryName("Downloaded Installations")
23196.   or DirectoryName("Ehome")
23197.   or DirectoryName("Fonts")
23198.   or DirectoryName("Help")
23199.   or DirectoryName("I386")
23200.   or DirectoryName("ie?updates")
23201.   or DirectoryName("Installer")
23202.   or DirectoryName("Installshield Installation Information")
23203.   or DirectoryName("IME")
23204.   or DirectoryName("*RECYCLE*")
23205.   or DirectoryName("ServicePackFiles")
23206.   or DirectoryName("SoftwareDistribution")
23207.   or DirectoryName("Speech")
23208.   or DirectoryName("Symbols")
23209.   or DirectoryName("System Volume Information")
23210.   or DirectoryName("windows.old")
23211. )
23212. # WinSysLow end.
23213. 
23214.   # Archives
23215. )
23216. # Archives end.
23217. 
23218. or 
23219. # Backups start.
23220. (
23221.   DirectoryName("*Backup*")
23222.   or DirectoryName("*Bu")
23223.   or DirectoryName("* Bu *")
23224.   or DirectoryName("Bu *")
23225. 
23226.   or FileName("*.bak")
23227.   or FileName("* - Copy*")
23228. )
23229. # Backups end.
23230. 
23231. # SpaceHogs
23232. ) and (
23233. # Blobs start.
23234. (
23235. # BlobsAndExceptions start.
23236. ( not(
23237.   FileName("*.bat")
23238.   or FileName("*.css")
23239.   or FileName("*.dll")
23240.   or FileName("*.exe")
23241.   or FileName("*.htm*")
23242.   or FileName("*.jar")
23243.   or FileName("*.js")
23244.   or FileName("*.script")
23245.   or FileName("*.wsf")
23246.   or (
23247. # Databases start.
23248. (
23249.   FileName("*.crypt*")
23250.   or FileName("*.db*")
23251.   or FileName("*.rdb*")
23252.   or FileName("*.dc*")
23253.   or FileName("*.dict*")
23254.   or FileName("*.?db*")
23255.   or FileName("*.?rdb*")
23256.   or FileName("*.md*")
23257.   or FileName("*.myd")
23258.   or FileName("*.ndf")
23259.   or FileName("*.ns?")
23260.   or FileName("*.pab")
23261.   or FileName("*.pst")
23262.   or FileName("*.sd?*")
23263.   or FileName("*.sq**")
23264.   or FileName("*.tmd")
23265.   or FileName("*.tps")
23266.   or FileName("*.tr*")
23267. )
23268. # Databases end.
23269. 
23270.     # BlobsAndExceptions
23271.     or 
23272. # Data start.
23273. (
23274.   DirectoryName("Data*")
23275.   or DirectoryName("Device*")
23276.   or DirectoryName("Export*")
23277.   or DirectoryName("Import*")
23278.   or DirectoryName("Log*")
23279.   or DirectoryName("*Log")
23280.   or DirectoryName("Maintenance*")
23281.   or DirectoryName("Rec*")
23282.   or DirectoryName("Sales*")
23283.   or DirectoryName("Search*")
23284.   or DirectoryName("User*")
23285. )
23286. # Data end.
23287. 
23288.     # BlobsAndExceptions
23289.   )
23290. ) )
23291. # BlobsAndExceptions end.
23292. 
23293. # Blobs
23294. ) and (
23295.   Size(BlobFileSize,0)
23296.   or (
23297.     FileName("*.arj")
23298.     or FileName("*.bup")
23299.     or FileName("*.bz2")
23300.     or FileName("*.chm")
23301.     or FileName("*.dvr-ms")
23302.     or FileName("*.gz")
23303.     or FileName("*.ifo")
23304.     or FileName("*.lzh")
23305.     or FileName("*.pdf")
23306.     or FileName("*.rpm")
23307.     or FileName("*.wmv")
23308.     or FileName("*.vob")
23309.     or FileName("*.z")
23310.   ) 
23311. )
23312. # Blobs end.
23313. 
23314. # SpaceHogs
23315. ) 
23316. # SpaceHogs end.
23317. ')
23318. 
23319. /* Note: This should be all Blob Files but not archives and backups */
23320. /* It does not matter in my case because given the sorting the */
23321. /* "z Archive", "z Bu" and "z Backup" directories sort to the end. */
23322. 
23323. 	# Script: ZoneDoHeader
23324. 
23325. # Script: ZoneWhenStarted
23326. 
23327. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
23328. # Script: DisplaySetZone
23329. 
23330. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
23331. SetVariable(FileStepDescription,	"")
23332. 
23333. SetVariable(ZoneStepByLine, 			"Zone started.
23334. ")
23335. 
23336. # Script: BannerDescriptionSet
23337. 
23338. # Script: BannerSet
23339. 
23340. # Script: DisplaySetDateTimeRun
23341. 
23342. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
23343. /* Xinclude "..\Display\BannerSet.MyDc"X */
23344. /* pause(1) */
23345. 
23346. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23347. 
23348. Title('!Heading!')
23349. /* pause(1) */
23350. 
23351. /* NOTE: Can't round or truncate to integer precision. */
23352. 
23353. # Script: BannerLog
23354. 
23355. AppendLogfile("!LogFileName!", "!Title!")
23356. 
23357. 
23358. 
23359. pause(1)
23360. 
23361. 
23362. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
23363. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
23364. 
23365. SetVariable(ZoneStepNoCurrent, 0)
23366. 
23367. 
23368. # Script: ZoneDoCurrentClear
23369. 
23370. SetVariable(ZoneTypeSelectCurrent, 		"")
23371. 
23372. SetVariable(ZoneBeginCurrent, 			0)
23373. SetVariable(ZoneBeginPerCurrent, 		0)
23374. SetVariable(ZoneEndCurrent, 			0)
23375. SetVariable(ZoneEndPerCurrent, 			0)
23376. 
23377. SetVariable(ZoneSizeCurrent,			0)
23378. SetVariable(ZoneSizePerCurrent,			0)
23379. 
23380. SetVariable(ZoneGapRequestedCurrent,	0)
23381. SetVariable(ZoneGapRoundedCurrent, 		0)
23382. SetVariable(ZoneGapAdjustedCurrent, 	0)
23383. SetVariable(ZoneGapAvailableCurrent, 	0)
23384. SetVariable(ZoneGapCurrent,				0)
23385. SetVariable(ZoneGapUsedCurrent, 		0)
23386. 
23387. SetVariable(ZoneGapActualCurrent, 		0)
23388. SetVariable(ZoneGapActualPerCurrent, 	0)
23389. 
23390. SetVariable(ZoneSizeActual, 			0)
23391. SetVariable(ZoneSizeActualCurrent,		0)
23392. 
23393. SetVariable(ZoneEndActual, 				0)
23394. SetVariable(ZoneEndActualCurrent,		0)			
23395. SetVariable(ZoneSizeActualPerCurrent, 	0)
23396.       
23397. SetVariable(ZoneFilesFolders,			0)
23398. SetVariable(ZoneFilesFoldersPer,		0) 
23399. 
23400. SetVariable(ZoneFragments,				0)
23401. SetVariable(ZoneFragmentsPer,			0) 
23402. 		
23403. SetVariable(ZoneEndActualCurrent, 		0)
23404. SetVariable(ZoneEndActualPerCurrent, 	0)
23405. 
23406. # Gap Calculation Methodology:
23407. 	# Requested
23408. 	SetVariable(GapRequested, 			0) 
23409. 	SetVariable(GapRequestedStd, 		0) 
23410. 	SetVariable(GapRequestedMft, 		0) 
23411. 	SetVariable(GapRequestedOs, 		0) 
23412. 	SetVariable(GapRequestedOriginal, 	0) 
23413. 	
23414. 	# Gap Adjustments
23415. 	SetVariable(GapRounded, 			0)
23416. 	# SetVariable(GapAdjusted, 			0)
23417. 	SetVariable(GapAvailable, 			0)
23418. 	SetVariable(GapCurrent, 			0)
23419. 	SetVariable(GapActual, 				0)
23420. 	SetVariable(GapUsed, 				0)
23421. 	
23422. 	# Gap Adjustments
23423. 	SetVariable(GapRoundedLoc, 			0)
23424. 	# SetVariable(GapAdjustedLoc, 		0)
23425. 	SetVariable(GapAvailableLoc, 		0)
23426. 	SetVariable(GapCurrentLoc, 			0)
23427. 	SetVariable(GapActualLoc,			0)
23428. 	SetVariable(GapUsedLoc,				0)
23429. 	
23430. 	# Space usage
23431. 	SetVariable(ZoneFreePerRequested, 	0)
23432. 	SetVariable(ZoneFreePerUsed, 		0)
23433. 
23434. # Gap Size & Rounding
23435. 	SetVariable(ZoneGapSizePer, 		0)
23436. 	SetVariable(ZoneVolRoundUpPer, 		0)
23437. 	
23438. 	# Free Space
23439. 	SetVariable(ZoneFreeUsedPer, 		0)
23440. 	SetVariable(ZoneFreeRequestedPer, 	0)
23441. 
23442. 
23443. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
23444. 
23445. # Footer:
23446. SetVariable(ZoneFooter, "----------------------------------------------------------
23447. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
23448. 
23449. Statistics Report:
23450. ------------------
23451.    Size:  
23452.    ------------------------
23453.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23454.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23455.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23456. 
23457.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23458.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23459. 
23460.    Location:
23461.    ------------------------
23462.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23463.              Files End: !ZoneEndCurrent!
23464.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23465.       
23466.    Gap Settings:
23467.    ------------------------
23468.          Gap Requested: !ZoneGapSizePer!%
23469.       Volume Rounding: !ZoneVolRoundUpPer!%
23470.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23471.                  
23472.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
23473.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
23474.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
23475.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
23476.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
23477.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
23478.      
23479.    Free Space after Zone:
23480.    ------------------------
23481.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23482.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23483.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23484. 
23485. Directory and Files Select:
23486. ---------------------------
23487. !ZoneTypeSelectCurrent!               
23488. ---------------------------
23489. ----------------------------------------------------------
23490. ")
23491. 
23492. # Script: BannerSet
23493. 
23494. # Script: DisplaySetDateTimeRun
23495. 
23496. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
23497. /* Xinclude "..\Display\BannerSet.MyDc"X */
23498. /* pause(1) */
23499. 
23500. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23501. 
23502. Title('!Heading!')
23503. /* pause(1) */
23504. 
23505. /* NOTE: Can't round or truncate to integer precision. */
23506. 
23507. # Script: BannerLog
23508. 
23509. AppendLogfile("!LogFileName!", "!Title!")
23510. 
23511. 
23512. 
23513. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
23514. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
23515. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:46")
23516. 
23517. SetVariable(ZoneListByLine, "!ZoneListByLine!
23518. Zone: !ZoneNoCurrent! 2021-11-09 20:22:46 0:00:05 !ZoneLabel! !ZoneDescription!")
23519. 
23520. 
23521. /* Fixed Zone Position Handling */
23522. /* Literal number: */
23523. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
23524. /* Percentage of disk: */
23525. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
23526. /* Gap */
23527. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
23528. 
23529. /* ---------------------------------------------------------- */
23530. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
23531. # Script: DisplaySetFileStep
23532. 
23533. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23534. 
23535. /* add message and move to a new line. */
23536. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23537. ")
23538. 
23539. /* display the line. (hopefully.) */
23540. # Zone Footer Set Statistics Window Text
23541. 
23542. SetStatisticsWindowText("----------------------------------------------------------
23543. Zones Processed: 
23544. ----------------------------------------------------------
23545. !ZoneListByLine!
23546. ----------------------------------------------------------
23547. Zone Processing Step:
23548. !ZoneStepByLine!    
23549. ----------------------------------------------------------
23550. Current Zone:
23551. !ZoneFooter!
23552. ----------------------------------------------------------
23553. Volume Statistics:
23554. !VolumeStatisticsDetail!
23555. ----------------------------------------------------------
23556. Zone Detailed Report:
23557. ----------------------------------------------------------
23558. !ZoneStatisticsDetail!
23559. ----------------------------------------------------------
23560. ")
23561. 
23562. 
23563. 
23564. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23565. 
23566. # Script: BannerSet
23567. 
23568. # Script: DisplaySetDateTimeRun
23569. 
23570. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
23571. /* Xinclude "..\Display\BannerSet.MyDc"X */
23572. /* pause(1) */
23573. 
23574. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23575. 
23576. Title('!Heading!')
23577. /* pause(1) */
23578. 
23579. /* NOTE: Can't round or truncate to integer precision. */
23580. 
23581. pause(1)
23582. 
23583. # your stuff HERE (X)... pre file select code.
23584. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
23585. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
23586. 	# (X)
23587. 
23588. FileSelect
23589. 
23590. 	# your stuff can't really go here (errors.)
23591. 	# maybe for some reason I don't know of...
23592. 	
23593. 	# Actions next...
23594. 	# Script: ZoneDo ZoneTypeSelectSpaceHogs
23595. # SpaceHogs start.
23596. not(
23597. # Archives start.
23598. (
23599.   DirectoryName("*Archive*")
23600.   or DirectoryName("*History*")
23601.   or DirectoryName("*Old")
23602.   or DirectoryName("* Old *")
23603.   or DirectoryName("Old *")
23604. 
23605.   or FileName("*.7z")
23606.   or FileName("*.cab")
23607.   or FileName("*.iso")
23608.   or FileName("*.msi")
23609.   or FileName("*.old")
23610.   or FileName("*.rar")
23611.   or FileName("*.tar")
23612.   or FileName("*.zip")
23613.   or
23614. # WinSysLow start.
23615. (
23616.   DirectoryName("$*")
23617.   or DirectoryName("0*")
23618.   or DirectoryName("1*")
23619.   or DirectoryName("2*")
23620.   or DirectoryName("3*")
23621.   or DirectoryName("4*")
23622.   or DirectoryName("5*")
23623.   or DirectoryName("6*")
23624.   or DirectoryName("7*")
23625.   or DirectoryName("8*")
23626.   or DirectoryName("9*")
23627. 
23628.   or DirectoryName("dllcache")
23629.   or DirectoryName("Downloaded Installations")
23630.   or DirectoryName("Ehome")
23631.   or DirectoryName("Fonts")
23632.   or DirectoryName("Help")
23633.   or DirectoryName("I386")
23634.   or DirectoryName("ie?updates")
23635.   or DirectoryName("Installer")
23636.   or DirectoryName("Installshield Installation Information")
23637.   or DirectoryName("IME")
23638.   or DirectoryName("*RECYCLE*")
23639.   or DirectoryName("ServicePackFiles")
23640.   or DirectoryName("SoftwareDistribution")
23641.   or DirectoryName("Speech")
23642.   or DirectoryName("Symbols")
23643.   or DirectoryName("System Volume Information")
23644.   or DirectoryName("windows.old")
23645. )
23646. # WinSysLow end.
23647. 
23648.   # Archives
23649. )
23650. # Archives end.
23651. 
23652. or 
23653. # Backups start.
23654. (
23655.   DirectoryName("*Backup*")
23656.   or DirectoryName("*Bu")
23657.   or DirectoryName("* Bu *")
23658.   or DirectoryName("Bu *")
23659. 
23660.   or FileName("*.bak")
23661.   or FileName("* - Copy*")
23662. )
23663. # Backups end.
23664. 
23665. # SpaceHogs
23666. ) and (
23667. # Blobs start.
23668. (
23669. # BlobsAndExceptions start.
23670. ( not(
23671.   FileName("*.bat")
23672.   or FileName("*.css")
23673.   or FileName("*.dll")
23674.   or FileName("*.exe")
23675.   or FileName("*.htm*")
23676.   or FileName("*.jar")
23677.   or FileName("*.js")
23678.   or FileName("*.script")
23679.   or FileName("*.wsf")
23680.   or (
23681. # Databases start.
23682. (
23683.   FileName("*.crypt*")
23684.   or FileName("*.db*")
23685.   or FileName("*.rdb*")
23686.   or FileName("*.dc*")
23687.   or FileName("*.dict*")
23688.   or FileName("*.?db*")
23689.   or FileName("*.?rdb*")
23690.   or FileName("*.md*")
23691.   or FileName("*.myd")
23692.   or FileName("*.ndf")
23693.   or FileName("*.ns?")
23694.   or FileName("*.pab")
23695.   or FileName("*.pst")
23696.   or FileName("*.sd?*")
23697.   or FileName("*.sq**")
23698.   or FileName("*.tmd")
23699.   or FileName("*.tps")
23700.   or FileName("*.tr*")
23701. )
23702. # Databases end.
23703. 
23704.     # BlobsAndExceptions
23705.     or 
23706. # Data start.
23707. (
23708.   DirectoryName("Data*")
23709.   or DirectoryName("Device*")
23710.   or DirectoryName("Export*")
23711.   or DirectoryName("Import*")
23712.   or DirectoryName("Log*")
23713.   or DirectoryName("*Log")
23714.   or DirectoryName("Maintenance*")
23715.   or DirectoryName("Rec*")
23716.   or DirectoryName("Sales*")
23717.   or DirectoryName("Search*")
23718.   or DirectoryName("User*")
23719. )
23720. # Data end.
23721. 
23722.     # BlobsAndExceptions
23723.   )
23724. ) )
23725. # BlobsAndExceptions end.
23726. 
23727. # Blobs
23728. ) and (
23729.   Size(BlobFileSize,0)
23730.   or (
23731.     FileName("*.arj")
23732.     or FileName("*.bup")
23733.     or FileName("*.bz2")
23734.     or FileName("*.chm")
23735.     or FileName("*.dvr-ms")
23736.     or FileName("*.gz")
23737.     or FileName("*.ifo")
23738.     or FileName("*.lzh")
23739.     or FileName("*.pdf")
23740.     or FileName("*.rpm")
23741.     or FileName("*.wmv")
23742.     or FileName("*.vob")
23743.     or FileName("*.z")
23744.   ) 
23745. )
23746. # Blobs end.
23747. 
23748. # SpaceHogs
23749. ) 
23750. # SpaceHogs end.
23751. 
23752. 	# Script: ZoneDoAction
23753. # Zone Do File Action - SortByName.
23754. 
23755. FileActions
23756. 
23757. 	# Footer:
23758. SetVariable(ZoneFooter, "----------------------------------------------------------
23759. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
23760. 
23761. Statistics Report:
23762. ------------------
23763.    Size:  
23764.    ------------------------
23765.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23766.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23767.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23768. 
23769.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23770.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23771. 
23772.    Location:
23773.    ------------------------
23774.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23775.              Files End: !ZoneEndCurrent!
23776.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23777.       
23778.    Gap Settings:
23779.    ------------------------
23780.          Gap Requested: !ZoneGapSizePer!%
23781.       Volume Rounding: !ZoneVolRoundUpPer!%
23782.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23783.                  
23784.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
23785.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
23786.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
23787.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
23788.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
23789.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
23790.      
23791.    Free Space after Zone:
23792.    ------------------------
23793.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23794.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23795.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23796. 
23797. Directory and Files Select:
23798. ---------------------------
23799. !ZoneTypeSelectCurrent!               
23800. ---------------------------
23801. ----------------------------------------------------------
23802. ")
23803. 	SetStatisticsWindowText("!ZoneFooter!")
23804. 	
23805. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
23806. 	# Script: DisplaySetFileStep
23807. 
23808. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23809. 
23810. /* add message and move to a new line. */
23811. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23812. ")
23813. 
23814. /* display the line. (hopefully.) */
23815. # Zone Footer Set Statistics Window Text
23816. 
23817. SetStatisticsWindowText("----------------------------------------------------------
23818. Zones Processed: 
23819. ----------------------------------------------------------
23820. !ZoneListByLine!
23821. ----------------------------------------------------------
23822. Zone Processing Step:
23823. !ZoneStepByLine!    
23824. ----------------------------------------------------------
23825. Current Zone:
23826. !ZoneFooter!
23827. ----------------------------------------------------------
23828. Volume Statistics:
23829. !VolumeStatisticsDetail!
23830. ----------------------------------------------------------
23831. Zone Detailed Report:
23832. ----------------------------------------------------------
23833. !ZoneStatisticsDetail!
23834. ----------------------------------------------------------
23835. ")
23836. 
23837. 
23838. 
23839. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23840. 
23841. # Script: BannerSet
23842. 
23843. # Script: DisplaySetDateTimeRun
23844. 
23845. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
23846. /* Xinclude "..\Display\BannerSet.MyDc"X */
23847. /* pause(1) */
23848. 
23849. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23850. 
23851. Title('!Heading!')
23852. /* pause(1) */
23853. 
23854. /* NOTE: Can't round or truncate to integer precision. */
23855. 
23856. pause(1)
23857. 
23858. # Commands:
23859. 
23860. /* Moves to Zone or above it. */
23861. # MoveUpToZone()
23862. 
23863. # Defrag
23864. 
23865. # Defragment(OPTIONS)
23866. 
23867. /* Shuffles files around trying to make a big enough gap for fragmented files. */
23868. # Defragment()
23869. 
23870. /* Only does files where a gap will fit it. */
23871. # Defragment(Fast)
23872. 
23873. /* Skips fragmented files larger than the Chunck Size.
23874. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
23875. # Defragment(Chunk Size)
23876. 
23877. /* Moves down to zone and packs zone to beginning if there are gaps. */
23878. /* Can be similar in performance to doing a SortBy. */
23879. # MoveDownFill()
23880. 
23881. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
23882. 
23883. 
23884. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
23885. 	# Script: DisplaySetFileStep
23886. 
23887. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23888. 
23889. /* add message and move to a new line. */
23890. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23891. ")
23892. 
23893. /* display the line. (hopefully.) */
23894. # Zone Footer Set Statistics Window Text
23895. 
23896. SetStatisticsWindowText("----------------------------------------------------------
23897. Zones Processed: 
23898. ----------------------------------------------------------
23899. !ZoneListByLine!
23900. ----------------------------------------------------------
23901. Zone Processing Step:
23902. !ZoneStepByLine!    
23903. ----------------------------------------------------------
23904. Current Zone:
23905. !ZoneFooter!
23906. ----------------------------------------------------------
23907. Volume Statistics:
23908. !VolumeStatisticsDetail!
23909. ----------------------------------------------------------
23910. Zone Detailed Report:
23911. ----------------------------------------------------------
23912. !ZoneStatisticsDetail!
23913. ----------------------------------------------------------
23914. ")
23915. 
23916. 
23917. 
23918. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23919. 
23920. # Script: BannerSet
23921. 
23922. # Script: DisplaySetDateTimeRun
23923. 
23924. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
23925. /* Xinclude "..\Display\BannerSet.MyDc"X */
23926. /* pause(1) */
23927. 
23928. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23929. 
23930. Title('!Heading!')
23931. /* pause(1) */
23932. 
23933. /* NOTE: Can't round or truncate to integer precision. */
23934. 
23935. pause(1)
23936. 
23937. 	# Script: ZoneDoFooter
23938. 
23939. /* ---------------------------------------------------------- */
23940. # File Select
23941. 	# Select Statments
23942. # File Actions 
23943. 	# Standard or OS File Actions.
23944. 	# Resume...
23945. 	
23946. 	# your stuff HERE (X)... post zone (file) file actions code.
23947. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
23948. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
23949. 		# (X)
23950. 		
23951. 		/* ??? Set window? */
23952. 	
23953. 	# ADD THE GAP
23954. 		
23955. # Vacate (good for diagnostics)
23956. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
23957. 
23958. # DoNotVacate - DO NOT Vacate (recommended)
23959. 
23960. # Vacate
23961. /* AddGap(GapUsedLoc) */
23962. 
23963. # DO Not Vacate
23964. AddGap(GapUsedLoc, DoNotVacate) 
23965. 	
23966. 	
23967. /* ---------------------------------------------------------- */
23968. # (failed) TEST for boolean logic.
23969. 
23970. /* It should work in the gap calculations for turning options */
23971. /* on and off but it will NOT work here. */
23972. 
23973. /* Boolean setting X or FlagX. */
23974. /* Where X will be on or off: */
23975. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
23976. /*      For ON:  (X  *  FlagAny) */
23977. 
23978. /* 1) Failed, zero gap overrode the previous one. */
23979. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
23980. /* AddGap(GapUsedTemp) */ 
23981. 
23982. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
23983. /* AddGap(GapUsedTemp, DoNotVacate) */ 
23984. 
23985. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
23986. 
23987. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
23988. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
23989. /* AddGap(GapUsedTemp) */ 
23990. 
23991. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
23992. /* AddGap(GapUsedTemp, DoNotVacate) */ 
23993. 
23994. /* ---------------------------------------------------------- */
23995. 
23996. # Vacate
23997. /* AddGap(GapUsed) */
23998. 
23999. # DO NOT Vacate (recommended)
24000. /* AddGap(GapUsed, DoNotVacate) */ 
24001. 	
24002. 
24003. 		
24004. # 
24005. FileEnd
24006. /* ---------------------------------------------------------- */
24007. 
24008. # your stuff HERE (X)... post zone (file) code.
24009. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
24010. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24011. 	# (X)
24012. 
24013. SetVariable(FileStepDescription,"Zone finished, reporting.")
24014. # Script: DisplaySetFileStep
24015. 
24016. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24017. 
24018. /* add message and move to a new line. */
24019. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24020. ")
24021. 
24022. /* display the line. (hopefully.) */
24023. # Zone Footer Set Statistics Window Text
24024. 
24025. SetStatisticsWindowText("----------------------------------------------------------
24026. Zones Processed: 
24027. ----------------------------------------------------------
24028. !ZoneListByLine!
24029. ----------------------------------------------------------
24030. Zone Processing Step:
24031. !ZoneStepByLine!    
24032. ----------------------------------------------------------
24033. Current Zone:
24034. !ZoneFooter!
24035. ----------------------------------------------------------
24036. Volume Statistics:
24037. !VolumeStatisticsDetail!
24038. ----------------------------------------------------------
24039. Zone Detailed Report:
24040. ----------------------------------------------------------
24041. !ZoneStatisticsDetail!
24042. ----------------------------------------------------------
24043. ")
24044. 
24045. 
24046. 
24047. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24048. 
24049. # Script: BannerSet
24050. 
24051. # Script: DisplaySetDateTimeRun
24052. 
24053. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
24054. /* Xinclude "..\Display\BannerSet.MyDc"X */
24055. /* pause(1) */
24056. 
24057. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24058. 
24059. Title('!Heading!')
24060. /* pause(1) */
24061. 
24062. /* NOTE: Can't round or truncate to integer precision. */
24063. 
24064. pause(1)
24065. 
24066. # Script: ZoneWhenFinished
24067. 
24068. # Script: BannerSet
24069. 
24070. # Script: DisplaySetDateTimeRun
24071. 
24072. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
24073. /* Xinclude "..\Display\BannerSet.MyDc"X */
24074. /* pause(1) */
24075. 
24076. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24077. 
24078. Title('!Heading!')
24079. /* pause(1) */
24080. 
24081. /* NOTE: Can't round or truncate to integer precision. */
24082. 
24083. # Script: BannerLog
24084. 
24085. AppendLogfile("!LogFileName!", "!Title!")
24086. 
24087. 
24088. 
24089. # Zone Statistics	
24090. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
24091. 
24092. # Footer:
24093. SetVariable(ZoneFooter, "----------------------------------------------------------
24094. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
24095. 
24096. Statistics Report:
24097. ------------------
24098.    Size:  
24099.    ------------------------
24100.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24101.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24102.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24103. 
24104.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24105.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24106. 
24107.    Location:
24108.    ------------------------
24109.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24110.              Files End: !ZoneEndCurrent!
24111.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24112.       
24113.    Gap Settings:
24114.    ------------------------
24115.          Gap Requested: !ZoneGapSizePer!%
24116.       Volume Rounding: !ZoneVolRoundUpPer!%
24117.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24118.                  
24119.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
24120.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
24121.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
24122.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
24123.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
24124.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
24125.      
24126.    Free Space after Zone:
24127.    ------------------------
24128.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24129.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24130.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24131. 
24132. Directory and Files Select:
24133. ---------------------------
24134. !ZoneTypeSelectCurrent!               
24135. ---------------------------
24136. ----------------------------------------------------------
24137. ")
24138. 
24139. AppendLogfile("!LogFileName!", ".")
24140. AppendLogfile("!LogFileName!", "!ZoneFooter!")
24141. AppendLogfile("!LogFileName!", ".")
24142. 
24143. # Zone Footer Set Statistics Window Text
24144. 
24145. SetStatisticsWindowText("----------------------------------------------------------
24146. Zones Processed: 
24147. ----------------------------------------------------------
24148. !ZoneListByLine!
24149. ----------------------------------------------------------
24150. Zone Processing Step:
24151. !ZoneStepByLine!    
24152. ----------------------------------------------------------
24153. Current Zone:
24154. !ZoneFooter!
24155. ----------------------------------------------------------
24156. Volume Statistics:
24157. !VolumeStatisticsDetail!
24158. ----------------------------------------------------------
24159. Zone Detailed Report:
24160. ----------------------------------------------------------
24161. !ZoneStatisticsDetail!
24162. ----------------------------------------------------------
24163. ")
24164. 
24165. 
24166. 
24167. /* pause() */
24168. /* pause() */
24169. 
24170. 
24171. 
24172. 
24173. /* ---------------------------------------------------------- */
24174. 
24175. 
24176. /* ---------------------------------------------------------- */
24177. /* Zone ArchivesBu (All) Archives and Backups*/
24178. # Script: DefragZoneTypeArchivesBu
24179. /* ---------------------------------------------------------- */
24180. /* Zone ArchivesBu (All) Archives and Backups*/
24181. 
24182. SetVariable(ZoneLabel, "!ZoneLabelArchivesBu!")
24183. SetVariable(ZoneDescription, "!ZoneDescriptionArchivesBu!")
24184. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpArchivesBu!")
24185. SetVariable(ZoneGapSize, "!ZoneGapSizeArchivesBu!")
24186. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectArchivesBu
24187. # ArchivesBu start.
24188. all
24189. # ArchivesBu end.
24190. ')
24191. 
24192. /* Note: This should be all Blob archives and backups */
24193. /* The sorting the "z Archive", "z Bu" and "z Backup" directories */
24194. /* sort to the very end of the Volume. */
24195. 
24196. 	# Script: ZoneDoHeader
24197. 
24198. # Script: ZoneWhenStarted
24199. 
24200. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
24201. # Script: DisplaySetZone
24202. 
24203. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
24204. SetVariable(FileStepDescription,	"")
24205. 
24206. SetVariable(ZoneStepByLine, 			"Zone started.
24207. ")
24208. 
24209. # Script: BannerDescriptionSet
24210. 
24211. # Script: BannerSet
24212. 
24213. # Script: DisplaySetDateTimeRun
24214. 
24215. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
24216. /* Xinclude "..\Display\BannerSet.MyDc"X */
24217. /* pause(1) */
24218. 
24219. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24220. 
24221. Title('!Heading!')
24222. /* pause(1) */
24223. 
24224. /* NOTE: Can't round or truncate to integer precision. */
24225. 
24226. # Script: BannerLog
24227. 
24228. AppendLogfile("!LogFileName!", "!Title!")
24229. 
24230. 
24231. 
24232. pause(1)
24233. 
24234. 
24235. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
24236. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
24237. 
24238. SetVariable(ZoneStepNoCurrent, 0)
24239. 
24240. 
24241. # Script: ZoneDoCurrentClear
24242. 
24243. SetVariable(ZoneTypeSelectCurrent, 		"")
24244. 
24245. SetVariable(ZoneBeginCurrent, 			0)
24246. SetVariable(ZoneBeginPerCurrent, 		0)
24247. SetVariable(ZoneEndCurrent, 			0)
24248. SetVariable(ZoneEndPerCurrent, 			0)
24249. 
24250. SetVariable(ZoneSizeCurrent,			0)
24251. SetVariable(ZoneSizePerCurrent,			0)
24252. 
24253. SetVariable(ZoneGapRequestedCurrent,	0)
24254. SetVariable(ZoneGapRoundedCurrent, 		0)
24255. SetVariable(ZoneGapAdjustedCurrent, 	0)
24256. SetVariable(ZoneGapAvailableCurrent, 	0)
24257. SetVariable(ZoneGapCurrent,				0)
24258. SetVariable(ZoneGapUsedCurrent, 		0)
24259. 
24260. SetVariable(ZoneGapActualCurrent, 		0)
24261. SetVariable(ZoneGapActualPerCurrent, 	0)
24262. 
24263. SetVariable(ZoneSizeActual, 			0)
24264. SetVariable(ZoneSizeActualCurrent,		0)
24265. 
24266. SetVariable(ZoneEndActual, 				0)
24267. SetVariable(ZoneEndActualCurrent,		0)			
24268. SetVariable(ZoneSizeActualPerCurrent, 	0)
24269.       
24270. SetVariable(ZoneFilesFolders,			0)
24271. SetVariable(ZoneFilesFoldersPer,		0) 
24272. 
24273. SetVariable(ZoneFragments,				0)
24274. SetVariable(ZoneFragmentsPer,			0) 
24275. 		
24276. SetVariable(ZoneEndActualCurrent, 		0)
24277. SetVariable(ZoneEndActualPerCurrent, 	0)
24278. 
24279. # Gap Calculation Methodology:
24280. 	# Requested
24281. 	SetVariable(GapRequested, 			0) 
24282. 	SetVariable(GapRequestedStd, 		0) 
24283. 	SetVariable(GapRequestedMft, 		0) 
24284. 	SetVariable(GapRequestedOs, 		0) 
24285. 	SetVariable(GapRequestedOriginal, 	0) 
24286. 	
24287. 	# Gap Adjustments
24288. 	SetVariable(GapRounded, 			0)
24289. 	# SetVariable(GapAdjusted, 			0)
24290. 	SetVariable(GapAvailable, 			0)
24291. 	SetVariable(GapCurrent, 			0)
24292. 	SetVariable(GapActual, 				0)
24293. 	SetVariable(GapUsed, 				0)
24294. 	
24295. 	# Gap Adjustments
24296. 	SetVariable(GapRoundedLoc, 			0)
24297. 	# SetVariable(GapAdjustedLoc, 		0)
24298. 	SetVariable(GapAvailableLoc, 		0)
24299. 	SetVariable(GapCurrentLoc, 			0)
24300. 	SetVariable(GapActualLoc,			0)
24301. 	SetVariable(GapUsedLoc,				0)
24302. 	
24303. 	# Space usage
24304. 	SetVariable(ZoneFreePerRequested, 	0)
24305. 	SetVariable(ZoneFreePerUsed, 		0)
24306. 
24307. # Gap Size & Rounding
24308. 	SetVariable(ZoneGapSizePer, 		0)
24309. 	SetVariable(ZoneVolRoundUpPer, 		0)
24310. 	
24311. 	# Free Space
24312. 	SetVariable(ZoneFreeUsedPer, 		0)
24313. 	SetVariable(ZoneFreeRequestedPer, 	0)
24314. 
24315. 
24316. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
24317. 
24318. # Footer:
24319. SetVariable(ZoneFooter, "----------------------------------------------------------
24320. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
24321. 
24322. Statistics Report:
24323. ------------------
24324.    Size:  
24325.    ------------------------
24326.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24327.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24328.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24329. 
24330.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24331.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24332. 
24333.    Location:
24334.    ------------------------
24335.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24336.              Files End: !ZoneEndCurrent!
24337.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24338.       
24339.    Gap Settings:
24340.    ------------------------
24341.          Gap Requested: !ZoneGapSizePer!%
24342.       Volume Rounding: !ZoneVolRoundUpPer!%
24343.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24344.                  
24345.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
24346.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
24347.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
24348.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
24349.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
24350.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
24351.      
24352.    Free Space after Zone:
24353.    ------------------------
24354.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24355.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24356.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24357. 
24358. Directory and Files Select:
24359. ---------------------------
24360. !ZoneTypeSelectCurrent!               
24361. ---------------------------
24362. ----------------------------------------------------------
24363. ")
24364. 
24365. # Script: BannerSet
24366. 
24367. # Script: DisplaySetDateTimeRun
24368. 
24369. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
24370. /* Xinclude "..\Display\BannerSet.MyDc"X */
24371. /* pause(1) */
24372. 
24373. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24374. 
24375. Title('!Heading!')
24376. /* pause(1) */
24377. 
24378. /* NOTE: Can't round or truncate to integer precision. */
24379. 
24380. # Script: BannerLog
24381. 
24382. AppendLogfile("!LogFileName!", "!Title!")
24383. 
24384. 
24385. 
24386. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
24387. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
24388. AppendLogfile("!LogFileName!", "Time: 2021-11-09 20:22:46")
24389. 
24390. SetVariable(ZoneListByLine, "!ZoneListByLine!
24391. Zone: !ZoneNoCurrent! 2021-11-09 20:22:46 0:00:05 !ZoneLabel! !ZoneDescription!")
24392. 
24393. 
24394. /* Fixed Zone Position Handling */
24395. /* Literal number: */
24396. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
24397. /* Percentage of disk: */
24398. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
24399. /* Gap */
24400. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
24401. 
24402. /* ---------------------------------------------------------- */
24403. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
24404. # Script: DisplaySetFileStep
24405. 
24406. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24407. 
24408. /* add message and move to a new line. */
24409. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24410. ")
24411. 
24412. /* display the line. (hopefully.) */
24413. # Zone Footer Set Statistics Window Text
24414. 
24415. SetStatisticsWindowText("----------------------------------------------------------
24416. Zones Processed: 
24417. ----------------------------------------------------------
24418. !ZoneListByLine!
24419. ----------------------------------------------------------
24420. Zone Processing Step:
24421. !ZoneStepByLine!    
24422. ----------------------------------------------------------
24423. Current Zone:
24424. !ZoneFooter!
24425. ----------------------------------------------------------
24426. Volume Statistics:
24427. !VolumeStatisticsDetail!
24428. ----------------------------------------------------------
24429. Zone Detailed Report:
24430. ----------------------------------------------------------
24431. !ZoneStatisticsDetail!
24432. ----------------------------------------------------------
24433. ")
24434. 
24435. 
24436. 
24437. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24438. 
24439. # Script: BannerSet
24440. 
24441. # Script: DisplaySetDateTimeRun
24442. 
24443. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
24444. /* Xinclude "..\Display\BannerSet.MyDc"X */
24445. /* pause(1) */
24446. 
24447. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24448. 
24449. Title('!Heading!')
24450. /* pause(1) */
24451. 
24452. /* NOTE: Can't round or truncate to integer precision. */
24453. 
24454. pause(1)
24455. 
24456. # your stuff HERE (X)... pre file select code.
24457. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
24458. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24459. 	# (X)
24460. 
24461. FileSelect
24462. 
24463. 	# your stuff can't really go here (errors.)
24464. 	# maybe for some reason I don't know of...
24465. 	
24466. 	# Actions next...
24467. 	# Script: ZoneDo ZoneTypeSelectArchivesBu
24468. # ArchivesBu start.
24469. all
24470. # ArchivesBu end.
24471. 
24472. 	# Script: ZoneDoAction
24473. # Zone Do File Action - SortByName.
24474. 
24475. FileActions
24476. 
24477. 	# Footer:
24478. SetVariable(ZoneFooter, "----------------------------------------------------------
24479. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
24480. 
24481. Statistics Report:
24482. ------------------
24483.    Size:  
24484.    ------------------------
24485.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24486.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24487.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24488. 
24489.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24490.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24491. 
24492.    Location:
24493.    ------------------------
24494.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24495.              Files End: !ZoneEndCurrent!
24496.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24497.       
24498.    Gap Settings:
24499.    ------------------------
24500.          Gap Requested: !ZoneGapSizePer!%
24501.       Volume Rounding: !ZoneVolRoundUpPer!%
24502.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24503.                  
24504.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
24505.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
24506.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
24507.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
24508.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
24509.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
24510.      
24511.    Free Space after Zone:
24512.    ------------------------
24513.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24514.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24515.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24516. 
24517. Directory and Files Select:
24518. ---------------------------
24519. !ZoneTypeSelectCurrent!               
24520. ---------------------------
24521. ----------------------------------------------------------
24522. ")
24523. 	SetStatisticsWindowText("!ZoneFooter!")
24524. 	
24525. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
24526. 	# Script: DisplaySetFileStep
24527. 
24528. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24529. 
24530. /* add message and move to a new line. */
24531. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24532. ")
24533. 
24534. /* display the line. (hopefully.) */
24535. # Zone Footer Set Statistics Window Text
24536. 
24537. SetStatisticsWindowText("----------------------------------------------------------
24538. Zones Processed: 
24539. ----------------------------------------------------------
24540. !ZoneListByLine!
24541. ----------------------------------------------------------
24542. Zone Processing Step:
24543. !ZoneStepByLine!    
24544. ----------------------------------------------------------
24545. Current Zone:
24546. !ZoneFooter!
24547. ----------------------------------------------------------
24548. Volume Statistics:
24549. !VolumeStatisticsDetail!
24550. ----------------------------------------------------------
24551. Zone Detailed Report:
24552. ----------------------------------------------------------
24553. !ZoneStatisticsDetail!
24554. ----------------------------------------------------------
24555. ")
24556. 
24557. 
24558. 
24559. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24560. 
24561. # Script: BannerSet
24562. 
24563. # Script: DisplaySetDateTimeRun
24564. 
24565. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
24566. /* Xinclude "..\Display\BannerSet.MyDc"X */
24567. /* pause(1) */
24568. 
24569. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24570. 
24571. Title('!Heading!')
24572. /* pause(1) */
24573. 
24574. /* NOTE: Can't round or truncate to integer precision. */
24575. 
24576. pause(1)
24577. 
24578. # Commands:
24579. 
24580. /* Moves to Zone or above it. */
24581. # MoveUpToZone()
24582. 
24583. # Defrag
24584. 
24585. # Defragment(OPTIONS)
24586. 
24587. /* Shuffles files around trying to make a big enough gap for fragmented files. */
24588. # Defragment()
24589. 
24590. /* Only does files where a gap will fit it. */
24591. # Defragment(Fast)
24592. 
24593. /* Skips fragmented files larger than the Chunck Size.
24594. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
24595. # Defragment(Chunk Size)
24596. 
24597. /* Moves down to zone and packs zone to beginning if there are gaps. */
24598. /* Can be similar in performance to doing a SortBy. */
24599. # MoveDownFill()
24600. 
24601. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
24602. 
24603. 
24604. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
24605. 	# Script: DisplaySetFileStep
24606. 
24607. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24608. 
24609. /* add message and move to a new line. */
24610. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24611. ")
24612. 
24613. /* display the line. (hopefully.) */
24614. # Zone Footer Set Statistics Window Text
24615. 
24616. SetStatisticsWindowText("----------------------------------------------------------
24617. Zones Processed: 
24618. ----------------------------------------------------------
24619. !ZoneListByLine!
24620. ----------------------------------------------------------
24621. Zone Processing Step:
24622. !ZoneStepByLine!    
24623. ----------------------------------------------------------
24624. Current Zone:
24625. !ZoneFooter!
24626. ----------------------------------------------------------
24627. Volume Statistics:
24628. !VolumeStatisticsDetail!
24629. ----------------------------------------------------------
24630. Zone Detailed Report:
24631. ----------------------------------------------------------
24632. !ZoneStatisticsDetail!
24633. ----------------------------------------------------------
24634. ")
24635. 
24636. 
24637. 
24638. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24639. 
24640. # Script: BannerSet
24641. 
24642. # Script: DisplaySetDateTimeRun
24643. 
24644. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
24645. /* Xinclude "..\Display\BannerSet.MyDc"X */
24646. /* pause(1) */
24647. 
24648. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24649. 
24650. Title('!Heading!')
24651. /* pause(1) */
24652. 
24653. /* NOTE: Can't round or truncate to integer precision. */
24654. 
24655. pause(1)
24656. 
24657. 	# Script: ZoneDoFooter
24658. 
24659. /* ---------------------------------------------------------- */
24660. # File Select
24661. 	# Select Statments
24662. # File Actions 
24663. 	# Standard or OS File Actions.
24664. 	# Resume...
24665. 	
24666. 	# your stuff HERE (X)... post zone (file) file actions code.
24667. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
24668. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24669. 		# (X)
24670. 		
24671. 		/* ??? Set window? */
24672. 	
24673. 	# ADD THE GAP
24674. 		
24675. # Vacate (good for diagnostics)
24676. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
24677. 
24678. # DoNotVacate - DO NOT Vacate (recommended)
24679. 
24680. # Vacate
24681. /* AddGap(GapUsedLoc) */
24682. 
24683. # DO Not Vacate
24684. AddGap(GapUsedLoc, DoNotVacate) 
24685. 	
24686. 	
24687. /* ---------------------------------------------------------- */
24688. # (failed) TEST for boolean logic.
24689. 
24690. /* It should work in the gap calculations for turning options */
24691. /* on and off but it will NOT work here. */
24692. 
24693. /* Boolean setting X or FlagX. */
24694. /* Where X will be on or off: */
24695. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
24696. /*      For ON:  (X  *  FlagAny) */
24697. 
24698. /* 1) Failed, zero gap overrode the previous one. */
24699. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
24700. /* AddGap(GapUsedTemp) */ 
24701. 
24702. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
24703. /* AddGap(GapUsedTemp, DoNotVacate) */ 
24704. 
24705. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
24706. 
24707. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
24708. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
24709. /* AddGap(GapUsedTemp) */ 
24710. 
24711. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
24712. /* AddGap(GapUsedTemp, DoNotVacate) */ 
24713. 
24714. /* ---------------------------------------------------------- */
24715. 
24716. # Vacate
24717. /* AddGap(GapUsed) */
24718. 
24719. # DO NOT Vacate (recommended)
24720. /* AddGap(GapUsed, DoNotVacate) */ 
24721. 	
24722. 
24723. 		
24724. # 
24725. FileEnd
24726. /* ---------------------------------------------------------- */
24727. 
24728. # your stuff HERE (X)... post zone (file) code.
24729. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
24730. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24731. 	# (X)
24732. 
24733. SetVariable(FileStepDescription,"Zone finished, reporting.")
24734. # Script: DisplaySetFileStep
24735. 
24736. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24737. 
24738. /* add message and move to a new line. */
24739. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24740. ")
24741. 
24742. /* display the line. (hopefully.) */
24743. # Zone Footer Set Statistics Window Text
24744. 
24745. SetStatisticsWindowText("----------------------------------------------------------
24746. Zones Processed: 
24747. ----------------------------------------------------------
24748. !ZoneListByLine!
24749. ----------------------------------------------------------
24750. Zone Processing Step:
24751. !ZoneStepByLine!    
24752. ----------------------------------------------------------
24753. Current Zone:
24754. !ZoneFooter!
24755. ----------------------------------------------------------
24756. Volume Statistics:
24757. !VolumeStatisticsDetail!
24758. ----------------------------------------------------------
24759. Zone Detailed Report:
24760. ----------------------------------------------------------
24761. !ZoneStatisticsDetail!
24762. ----------------------------------------------------------
24763. ")
24764. 
24765. 
24766. 
24767. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24768. 
24769. # Script: BannerSet
24770. 
24771. # Script: DisplaySetDateTimeRun
24772. 
24773. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
24774. /* Xinclude "..\Display\BannerSet.MyDc"X */
24775. /* pause(1) */
24776. 
24777. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24778. 
24779. Title('!Heading!')
24780. /* pause(1) */
24781. 
24782. /* NOTE: Can't round or truncate to integer precision. */
24783. 
24784. pause(1)
24785. 
24786. # Script: ZoneWhenFinished
24787. 
24788. # Script: BannerSet
24789. 
24790. # Script: DisplaySetDateTimeRun
24791. 
24792. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
24793. /* Xinclude "..\Display\BannerSet.MyDc"X */
24794. /* pause(1) */
24795. 
24796. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24797. 
24798. Title('!Heading!')
24799. /* pause(1) */
24800. 
24801. /* NOTE: Can't round or truncate to integer precision. */
24802. 
24803. # Script: BannerLog
24804. 
24805. AppendLogfile("!LogFileName!", "!Title!")
24806. 
24807. 
24808. 
24809. # Zone Statistics	
24810. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
24811. 
24812. # Footer:
24813. SetVariable(ZoneFooter, "----------------------------------------------------------
24814. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 20:22:46
24815. 
24816. Statistics Report:
24817. ------------------
24818.    Size:  
24819.    ------------------------
24820.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24821.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24822.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24823. 
24824.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24825.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24826. 
24827.    Location:
24828.    ------------------------
24829.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24830.              Files End: !ZoneEndCurrent!
24831.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24832.       
24833.    Gap Settings:
24834.    ------------------------
24835.          Gap Requested: !ZoneGapSizePer!%
24836.       Volume Rounding: !ZoneVolRoundUpPer!%
24837.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24838.                  
24839.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
24840.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
24841.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
24842.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
24843.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
24844.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
24845.      
24846.    Free Space after Zone:
24847.    ------------------------
24848.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24849.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24850.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24851. 
24852. Directory and Files Select:
24853. ---------------------------
24854. !ZoneTypeSelectCurrent!               
24855. ---------------------------
24856. ----------------------------------------------------------
24857. ")
24858. 
24859. AppendLogfile("!LogFileName!", ".")
24860. AppendLogfile("!LogFileName!", "!ZoneFooter!")
24861. AppendLogfile("!LogFileName!", ".")
24862. 
24863. # Zone Footer Set Statistics Window Text
24864. 
24865. SetStatisticsWindowText("----------------------------------------------------------
24866. Zones Processed: 
24867. ----------------------------------------------------------
24868. !ZoneListByLine!
24869. ----------------------------------------------------------
24870. Zone Processing Step:
24871. !ZoneStepByLine!    
24872. ----------------------------------------------------------
24873. Current Zone:
24874. !ZoneFooter!
24875. ----------------------------------------------------------
24876. Volume Statistics:
24877. !VolumeStatisticsDetail!
24878. ----------------------------------------------------------
24879. Zone Detailed Report:
24880. ----------------------------------------------------------
24881. !ZoneStatisticsDetail!
24882. ----------------------------------------------------------
24883. ")
24884. 
24885. 
24886. 
24887. /* pause() */
24888. /* pause() */
24889. 
24890. 
24891. 
24892. 
24893. /* ---------------------------------------------------------- */
24894. 
24895. 
24896. /* ---------------------------------------------------------- */
24897. /* Volume End */
24898. # Script: VolumeWhenFinished
24899. 
24900. /* Write the "after" statistics to the logfile. */
24901. 
24902. # Script: BannerSet
24903. 
24904. # Script: DisplaySetDateTimeRun
24905. 
24906. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
24907. /* Xinclude "..\Display\BannerSet.MyDc"X */
24908. /* pause(1) */
24909. 
24910. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24911. 
24912. Title('!Heading!')
24913. /* pause(1) */
24914. 
24915. /* NOTE: Can't round or truncate to integer precision. */
24916. 
24917. # Script: BannerLog
24918. 
24919. AppendLogfile("!LogFileName!", "!Title!")
24920. 
24921. 
24922. 
24923. # Script: VolumeFooterGet
24924. # Set Volume summary stats:
24925. 
24926. # Cluster, Sector, Block adjust for display.
24927. # Bytes per cluster is volume specific.
24928. 
24929. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
24930. 
24931. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
24932. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
24933. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
24934. 
24935. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
24936. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
24937. 
24938. # Set the display text:
24939. # Script: VolumeStatisticsSummaryDisplay
24940. 
24941. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
24942. SUMMARY: !VolumeLabel! !VolumeDescription!
24943.   
24944.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
24945.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
24946.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
24947.          
24948.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
24949.       Volume Free Adj:       !VolumeFreeAdj!
24950.     Bytes per cluster:       !BytesPerCluster! bytes
24951. 
24952.    Unfragmented Items:       !FILES200N!
24953.      Fragmented Items:       !FILES210N!
24954. 
24955.     Unfragmented Data:       !FILES202N! bytes
24956.       Fragmented Data:       !FILES212N! bytes
24957. 
24958.              All Gaps:       !GAP00N!
24959.              All gaps:       !GAP10N! bytes
24960.           Average gap:       !GAP13N! bytes
24961.            Median gap:       !GAP14N! bytes
24962.           Biggest gap:       !GAP15N! bytes
24963. ----------------------------------------------------------
24964. ") 
24965. 
24966. 
24967. SetVariable(VolumeFooter, "!VolumeStatisticsSummary!")
24968. 
24969. 
24970. # Script: VolumeSizeLog
24971. AppendLogfile("!LogFileName!", ".")
24972. AppendLogfile("!LogFileName!", "      Volume Size: !VolumeSize!")
24973. AppendLogfile("!LogFileName!", "      Volume Used: !VolumeUsed!")
24974. AppendLogfile("!LogFileName!", "Volume Used Total: !VolumeUsedTotal!")
24975. AppendLogfile("!LogFileName!", "      Volume Free: !VolumeFree!")
24976. AppendLogfile("!LogFileName!", "  Volume Free Adj: !VolumeFreeAdj!")
24977. AppendLogfile("!LogFileName!", ".")
24978. AppendLogfile("!LogFileName!", "MFT Zone: !MftZone! Location: !MftLocation! Gap: !MftGap!")
24979. AppendLogfile("!LogFileName!", ".")
24980. 
24981. 
24982. /* Write/display stats: */
24983. 
24984. # Log:  
24985. 
24986. # Script: VolumeStatisticsDetailGet
24987. 
24988. # Set Volume summary stats:
24989. 
24990. # Cluster, Sector, Block adjust for display.
24991. # Bytes per cluster is volume specific.
24992. 
24993. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
24994. 
24995. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
24996. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
24997. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
24998. 
24999. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
25000. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
25001. 
25002. # Set the display text:
25003. # Script: VolumeStatisticsSummaryDisplay
25004. 
25005. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
25006. SUMMARY: !VolumeLabel! !VolumeDescription!
25007.   
25008.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
25009.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
25010.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
25011.          
25012.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
25013.       Volume Free Adj:       !VolumeFreeAdj!
25014.     Bytes per cluster:       !BytesPerCluster! bytes
25015. 
25016.    Unfragmented Items:       !FILES200N!
25017.      Fragmented Items:       !FILES210N!
25018. 
25019.     Unfragmented Data:       !FILES202N! bytes
25020.       Fragmented Data:       !FILES212N! bytes
25021. 
25022.              All Gaps:       !GAP00N!
25023.              All gaps:       !GAP10N! bytes
25024.           Average gap:       !GAP13N! bytes
25025.            Median gap:       !GAP14N! bytes
25026.           Biggest gap:       !GAP15N! bytes
25027. ----------------------------------------------------------
25028. ") 
25029. 
25030. 
25031. 
25032. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
25033. VOLUME: !VolumeLabel! !VolumeDescription!
25034. ----------------------------------------------------------
25035. !VolumeStatisticsSummary!
25036. ----------------------------------------------------------
25037. DETAILS: !VolumeLabel! !VolumeDescription!
25038. ----------------------------------------------------------
25039. 
25040. SUMMARY:
25041. 
25042. Volume label/name:          !VolumeLabel!
25043. Volume mountpoint:          !MountPoint!
25044. Volume name:                !VolumeName!
25045. Volume type:                !VolumeType!
25046. 
25047. Total disk space:           !VolumeSize! bytes
25048.                             !VolumeSizeG! gigabytes
25049. 
25050. Bytes per cluster:          !BytesPerCluster! bytes
25051. Average end-begin distance: !AverageBeginEndDistance! clusters
25052.                             !AverageBeginEndDistanceP!% of volume size
25053. 
25054. ----------------------------------------------------------
25055. FRAGMENTS:
25056. 
25057. Unfragmented Items: !FILES200N!
25058.   Fragmented Items: !FILES210N!
25059.  Unfragmented Data: !FILES202N! bytes
25060.    Fragmented Data: !FILES212N! bytes
25061. Gaps:
25062.           All Gaps: !GAP00N!
25063.           All gaps: !GAP10N! bytes
25064.        Average gap: !GAP13N! bytes
25065.         Median gap: !GAP14N! bytes
25066.        Biggest gap: !GAP15N! bytes
25067. 
25068. ----------------------------------------------------------
25069. GAPS:
25070. 
25071.    ----------------------------------------------------------
25072.    Counts:
25073.                        Count      Percentage of all
25074.                 ----------------- -----------------
25075.    Small gaps   !GAP01N! !GAP01P!%
25076.    Big gaps     !GAP02N! !GAP02P!%
25077.                 ----------------- -----------------
25078.    All gaps     !GAP00N! !GAP00P!
25079. 
25080.    ----------------------------------------------------------
25081.    By size:
25082.                       Bytes          Gigabytes      Percentage of all
25083.                 ----------------- ----------------- -----------------
25084.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
25085.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
25086.                 ----------------- ----------------- -----------------
25087.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
25088. 
25089.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
25090.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
25091.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
25092.    ----------------------------------------------------------
25093. 
25094. ----------------------------------------------------------
25095. FILE STATISTICS:
25096. ----------------------------------------------------------
25097. 
25098. ----------------------------------------------------------
25099. ITEM COUNT:
25100. ----------------------------------------------------------
25101. Number of files and folders:
25102. 
25103.               Unfragmented       Fragmented            All
25104.    ------- ----------------- ----------------- -----------------
25105.    Files   !FILES000N! !FILES010N! !FILES020N!
25106.    Folders !FILES100N! !FILES110N! !FILES120N!
25107.    ------- ----------------- ----------------- -----------------
25108.    All     !FILES200N! !FILES210N! !FILES220N!
25109. 
25110. ----------------------------------------------------------
25111. Percentage of total:
25112. 
25113.               Unfragmented       Fragmented            All
25114.    ------- ----------------- ----------------- -----------------
25115.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
25116.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
25117.    ------- ----------------- ----------------- -----------------
25118.    All     !FILES200P!%!FILES210P!%!FILES220P!%
25119. 
25120. ----------------------------------------------------------
25121. OCCUPIED SIZE on disk:
25122. ----------------------------------------------------------
25123. Bytes:
25124.               Unfragmented       Fragmented            All
25125.    ------- ----------------- ----------------- -----------------
25126.    Files   !FILES002N! !FILES012N! !FILES022N!
25127.    Folders !FILES102N! !FILES112N! !FILES122N!
25128.    ------- ----------------- ----------------- -----------------
25129.    All     !FILES202N! !FILES212N! !FILES222N!
25130. 
25131. ----------------------------------------------------------
25132. Gigabytes:
25133.               Unfragmented       Fragmented            All
25134.    ------- ----------------- ----------------- -----------------
25135.    Files   !FILES002G! !FILES012G! !FILES022G!
25136.    Folders !FILES102G! !FILES112G! !FILES122G!
25137.    ------- ----------------- ----------------- -----------------
25138.    All     !FILES202G! !FILES212G! !FILES222G!
25139. 
25140. ----------------------------------------------------------
25141. Percentage:
25142.               Unfragmented       Fragmented            All
25143.    ------- ----------------- ----------------- -----------------
25144.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
25145.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
25146.    ------- ----------------- ----------------- -----------------
25147.    All     !FILES202P!%!FILES212P!%!FILES222P!%
25148. 
25149. ----------------------------------------------------------
25150. USED SIZE:
25151. ----------------------------------------------------------
25152. Bytes:
25153.               Unfragmented       Fragmented            All
25154.    ------- ----------------- ----------------- -----------------
25155.    Files   !FILES001N! !FILES011N! !FILES021N!
25156.    Folders !FILES101N! !FILES111N! !FILES121N!
25157.    ------- ----------------- ----------------- -----------------
25158.    All     !FILES201N! !FILES211N! !FILES221N!
25159. 
25160. ----------------------------------------------------------
25161. Gigabytes:
25162.               Unfragmented       Fragmented            All
25163.    ------- ----------------- ----------------- -----------------
25164.    Files   !FILES001G! !FILES011G! !FILES021G!
25165.    Folders !FILES101G! !FILES111G! !FILES121G!
25166.    ------- ----------------- ----------------- -----------------
25167.    All     !FILES201G! !FILES211G! !FILES221G!
25168. 
25169. ----------------------------------------------------------
25170. Percentage:
25171.               Unfragmented       Fragmented            All
25172.    ------- ----------------- ----------------- -----------------
25173.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
25174.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
25175.    ------- ----------------- ----------------- -----------------
25176.    All     !FILES201P!%!FILES211P!%!FILES221P!%
25177. 
25178. ----------------------------------------------------------
25179. Volume Detailed Statistics end.
25180. ----------------------------------------------------------
25181. ") 
25182. 
25183. 
25184. AppendLogfile("!LogFileName!", ".")
25185. AppendLogfile("!LogFileName!", "!VolumeStatisticsDetail!")
25186. AppendLogfile("!LogFileName!", ".")
25187. AppendLogfile("!LogFileName!", "Volume End.")	
25188. 
25189. # SetStatisticsWindowText("!VolumeStatisticsDetail!")
25190. 
25191. /* pause() */
25192. /* pause() */
25193. 
25194.   
25195. 
25196. VolumeEnd
25197. 
25198. /* ---------------------------------------------------------- */
25199. 
25200. AppendLogfile("!LogFileName!",".")
25201. SetVariable(FileStepDescription,"!Description! Complex Volume end: 2021-11-09 20:22:41.")
25202. # Script: BannerDescriptionSet
25203. 
25204. # Script: BannerSet
25205. 
25206. # Script: DisplaySetDateTimeRun
25207. 
25208. SetVariable(DateTimeRunDescription,		"2021-11-09 20:22:46 0:00:05")
25209. /* Xinclude "..\Display\BannerSet.MyDc"X */
25210. /* pause(1) */
25211. 
25212. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
25213. 
25214. Title('!Heading!')
25215. /* pause(1) */
25216. 
25217. /* NOTE: Can't round or truncate to integer precision. */
25218. 
25219. # Script: BannerLog
25220. 
25221. AppendLogfile("!LogFileName!", "!Title!")
25222. 
25223. 
25224. 
25225. AppendLogfile("!LogFileName!",".")
25226. 
25227. /* ---------------------------------------------------------- */
25228. # End. ;-) (Return to caller lovely nubes, only MyD's get executed.)
25229. 
25230. 
