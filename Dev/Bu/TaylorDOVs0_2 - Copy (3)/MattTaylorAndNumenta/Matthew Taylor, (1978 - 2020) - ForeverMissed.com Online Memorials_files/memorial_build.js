/*!forevermissed, 3.2.3, 2021-10-22*/if(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.bowser=t():e.bowser=t()}(this,function(){return function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=90)}({17:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var o=i(18),n=function(){function e(){}return e.getFirstMatch=function(e,t){var i=t.match(e);return i&&i.length>0&&i[1]||""},e.getSecondMatch=function(e,t){var i=t.match(e);return i&&i.length>1&&i[2]||""},e.matchAndReturnConst=function(e,t,i){if(e.test(t))return i},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map(function(e){return parseInt(e,10)||0});if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map(function(e){return parseInt(e,10)||0});if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,i,o){void 0===o&&(o=!1);var n=e.getVersionPrecision(t),a=e.getVersionPrecision(i),r=Math.max(n,a),s=0,l=e.map([t,i],function(t){var i=r-e.getVersionPrecision(t),o=t+new Array(i+1).join(".0");return e.map(o.split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});for(o&&(s=r-Math.min(n,a)),r-=1;r>=s;){if(l[0][r]>l[1][r])return 1;if(l[0][r]===l[1][r]){if(r===s)return 0;r-=1}else if(l[0][r]<l[1][r])return-1}},e.map=function(e,t){var i,o=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(i=0;i<e.length;i+=1)o.push(t(e[i]));return o},e.find=function(e,t){var i,o;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(i=0,o=e.length;i<o;i+=1){var n=e[i];if(t(n,i))return n}},e.assign=function(e){for(var t,i,o=e,n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];if(Object.assign)return Object.assign.apply(Object,[e].concat(a));var s=function(){var e=a[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach(function(t){o[t]=e[t]})};for(t=0,i=a.length;t<i;t+=1)s();return e},e.getBrowserAlias=function(e){return o.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return o.BROWSER_MAP[e]||""},e}();t.default=n,e.exports=t.default},18:function(e,t,i){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var o,n=(o=i(91))&&o.__esModule?o:{default:o},a=i(18);function r(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=function(){function e(){}var t,i;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new n.default(e,t)},e.parse=function(e){return new n.default(e).getResult()},t=e,i=[{key:"BROWSER_MAP",get:function(){return a.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return a.ENGINE_MAP}},{key:"OS_MAP",get:function(){return a.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return a.PLATFORMS_MAP}}],null&&r(t.prototype,null),i&&r(t,i),e}();t.default=s,e.exports=t.default},91:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var o=l(i(92)),n=l(i(93)),a=l(i(94)),r=l(i(95)),s=l(i(17));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(o.default,function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(n.default,function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(a.default,function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(r.default,function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,i={},o=0,n={},a=0;if(Object.keys(e).forEach(function(t){var r=e[t];"string"==typeof r?(n[t]=r,a+=1):"object"==typeof r&&(i[t]=r,o+=1)}),o>0){var r=Object.keys(i),l=s.default.find(r,function(e){return t.isOS(e)});if(l){var d=this.satisfies(i[l]);if(void 0!==d)return d}var c=s.default.find(r,function(e){return t.isPlatform(e)});if(c){var u=this.satisfies(i[c]);if(void 0!==u)return u}}if(a>0){var h=Object.keys(n),p=s.default.find(h,function(e){return t.isBrowser(e,!0)});if(void 0!==p)return this.compareVersion(n[p])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var i=this.getBrowserName().toLowerCase(),o=e.toLowerCase(),n=s.default.getBrowserTypeByAlias(o);return t&&n&&(o=n.toLowerCase()),o===i},t.compareVersion=function(e){var t=[0],i=e,o=!1,n=this.getBrowserVersion();if("string"==typeof n)return">"===e[0]||"<"===e[0]?(i=e.substr(1),"="===e[1]?(o=!0,i=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?i=e.substr(1):"~"===e[0]&&(o=!0,i=e.substr(1)),t.indexOf(s.default.compareVersions(n,i,o))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some(function(e){return t.is(e)})},e}();t.default=d,e.exports=t.default},92:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var o,n=(o=i(17))&&o.__esModule?o:{default:o},a=/version\/(\d+(\.?_?\d+)+)/i,r=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},i=n.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},i=n.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},i=n.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},i=n.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},i=n.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},i=n.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},i=n.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},i=n.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},i=n.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},i=n.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},i=n.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},i=n.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},i=n.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},i=n.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},i=n.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return i&&(t.version=i),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},i=n.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},i=n.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},i=n.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},i=n.default.getFirstMatch(a,e)||n.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},i=n.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},i=n.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},i=n.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},i=n.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},i=n.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},i=n.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},i=n.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},i=n.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},i=n.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:function(e){var t=!e.test(/like android/i),i=e.test(/android/i);return t&&i},describe:function(e){var t={name:"Android Browser"},i=n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},i=n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},i=n.default.getFirstMatch(a,e);return i&&(t.version=i),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:n.default.getFirstMatch(t,e),version:n.default.getSecondMatch(t,e)}}}];t.default=r,e.exports=t.default},93:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var o,n=(o=i(17))&&o.__esModule?o:{default:o},a=i(18),r=[{test:[/Roku\/DVP/],describe:function(e){var t=n.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:a.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=n.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=n.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),i=n.default.getWindowsVersionName(t);return{name:a.OS_MAP.Windows,version:t,versionName:i}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:a.OS_MAP.iOS},i=n.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return i&&(t.version=i),t}},{test:[/macintosh/i],describe:function(e){var t=n.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),i=n.default.getMacOSVersionName(t),o={name:a.OS_MAP.MacOS,version:t};return i&&(o.versionName=i),o}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=n.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:a.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),i=e.test(/android/i);return t&&i},describe:function(e){var t=n.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),i=n.default.getAndroidVersionName(t),o={name:a.OS_MAP.Android,version:t};return i&&(o.versionName=i),o}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=n.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),i={name:a.OS_MAP.WebOS};return t&&t.length&&(i.version=t),i}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=n.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||n.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||n.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:a.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=n.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=n.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:a.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:a.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=n.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.PlayStation4,version:t}}}];t.default=r,e.exports=t.default},94:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var o,n=(o=i(17))&&o.__esModule?o:{default:o},a=i(18),r=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=n.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",i={type:a.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(i.model=t),i}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),i=e.test(/like (ipod|iphone)/i);return t&&!i},describe:function(e){var t=n.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:a.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:a.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.tv}}}];t.default=r,e.exports=t.default},95:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var o,n=(o=i(17))&&o.__esModule?o:{default:o},a=i(18),r=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:a.ENGINE_MAP.Blink};var t=n.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:a.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:a.ENGINE_MAP.Trident},i=n.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:a.ENGINE_MAP.Presto},i=n.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:function(e){var t=e.test(/gecko/i),i=e.test(/like gecko/i);return t&&!i},describe:function(e){var t={name:a.ENGINE_MAP.Gecko},i=n.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:a.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:a.ENGINE_MAP.WebKit},i=n.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}}];t.default=r,e.exports=t.default}})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.page=t()}(this,function(){"use strict";var e=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},t=f,i=s,o=function(e){return l(s(e))},n=l,a=p,r=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function s(e){for(var t,i=[],o=0,n=0,a="";null!=(t=r.exec(e));){var s=t[0],l=t[1],d=t.index;if(a+=e.slice(n,d),n=d+s.length,l)a+=l[1];else{a&&(i.push(a),a="");var u=t[2],h=t[3],p=t[4],f=t[5],m=t[6],g=t[7],v="+"===m||"*"===m,b="?"===m||"*"===m,y=u||"/",w=p||f||(g?".*":"[^"+y+"]+?");i.push({name:h||o++,prefix:u||"",delimiter:y,optional:b,repeat:v,pattern:c(w)})}}return n<e.length&&(a+=e.substr(n)),a&&i.push(a),i}function l(t){for(var i=new Array(t.length),o=0;o<t.length;o++)"object"==typeof t[o]&&(i[o]=new RegExp("^"+t[o].pattern+"$"));return function(o){for(var n="",a=o||{},r=0;r<t.length;r++){var s=t[r];if("string"!=typeof s){var l,d=a[s.name];if(null==d){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to be defined')}if(e(d)){if(!s.repeat)throw new TypeError('Expected "'+s.name+'" to not repeat, but received "'+d+'"');if(0===d.length){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to not be empty')}for(var c=0;c<d.length;c++){if(l=encodeURIComponent(d[c]),!i[r].test(l))throw new TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but received "'+l+'"');n+=(0===c?s.prefix:s.delimiter)+l}}else{if(l=encodeURIComponent(d),!i[r].test(l))throw new TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but received "'+l+'"');n+=s.prefix+l}}else n+=s}return n}}function d(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function c(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function u(e,t){return e.keys=t,e}function h(e){return e.sensitive?"":"i"}function p(e,t){for(var i=(t=t||{}).strict,o=!1!==t.end,n="",a=e[e.length-1],r="string"==typeof a&&/\/$/.test(a),s=0;s<e.length;s++){var l=e[s];if("string"==typeof l)n+=d(l);else{var c=d(l.prefix),u=l.pattern;l.repeat&&(u+="(?:"+c+u+")*"),n+=u=l.optional?c?"(?:"+c+"("+u+"))?":"("+u+")?":c+"("+u+")"}}return i||(n=(r?n.slice(0,-2):n)+"(?:\\/(?=$))?"),n+=o?"$":i&&r?"":"(?=\\/|$)",new RegExp("^"+n,h(t))}function f(t,i,o){return e(i=i||[])?o||(o={}):(o=i,i=[]),t instanceof RegExp?function(e,t){var i=e.source.match(/\((?!\?)/g);if(i)for(var o=0;o<i.length;o++)t.push({name:o,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return u(e,t)}(t,i):e(t)?function(e,t,i){for(var o=[],n=0;n<e.length;n++)o.push(f(e[n],t,i).source);return u(new RegExp("(?:"+o.join("|")+")",h(i)),t)}(t,i,o):function(e,t,i){for(var o=s(e),n=p(o,i),a=0;a<o.length;a++)"string"!=typeof o[a]&&t.push(o[a]);return u(n,t)}(t,i,o)}t.parse=i,t.compile=o,t.tokensToFunction=n,t.tokensToRegExp=a;var m,g="undefined"!=typeof document,v="undefined"!=typeof window,b="undefined"!=typeof history,y="undefined"!=typeof process,w=g&&document.ontouchstart?"touchstart":"click",_=v&&!(!window.history.location&&!window.location);function S(){this.callbacks=[],this.exits=[],this.current="",this.len=0,this._decodeURLComponents=!0,this._base="",this._strict=!1,this._running=!1,this._hashbang=!1,this.clickHandler=this.clickHandler.bind(this),this._onpopstate=this._onpopstate.bind(this)}function C(e,t){if("function"==typeof e)return C.call(this,"*",e);if("function"==typeof t)for(var i=new T(e,null,this),o=1;o<arguments.length;++o)this.callbacks.push(i.middleware(arguments[o]));else"string"==typeof e?this["string"==typeof t?"redirect":"show"](e,t):this.start(e)}function k(e,t,i){var o=this.page=i||C,n=o._window,a=o._hashbang,r=o._getBase();"/"===e[0]&&0!==e.indexOf(r)&&(e=r+(a?"#!":"")+e);var s=e.indexOf("?");this.canonicalPath=e;var l=new RegExp("^"+r.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"));if(this.path=e.replace(l,"")||"/",a&&(this.path=this.path.replace("#!","")||"/"),this.title=g&&n.document.title,this.state=t||{},this.state.path=e,this.querystring=~s?o._decodeURLEncodedURIComponent(e.slice(s+1)):"",this.pathname=o._decodeURLEncodedURIComponent(~s?e.slice(0,s):e),this.params={},this.hash="",!a){if(!~this.path.indexOf("#"))return;var d=this.path.split("#");this.path=this.pathname=d[0],this.hash=o._decodeURLEncodedURIComponent(d[1])||"",this.querystring=this.querystring.split("#")[0]}}function T(e,i,o){this.page=o||$;var n=i||{};n.strict=n.strict||o._strict,this.path="*"===e?"(.*)":e,this.method="GET",this.regexp=t(this.path,this.keys=[],n)}S.prototype.configure=function(e){var t=e||{};this._window=t.window||v&&window,this._decodeURLComponents=!1!==t.decodeURLComponents,this._popstate=!1!==t.popstate&&v,this._click=!1!==t.click&&g,this._hashbang=!!t.hashbang;var i=this._window;this._popstate?i.addEventListener("popstate",this._onpopstate,!1):v&&i.removeEventListener("popstate",this._onpopstate,!1),this._click?i.document.addEventListener(w,this.clickHandler,!1):g&&i.document.removeEventListener(w,this.clickHandler,!1),this._hashbang&&v&&!b?i.addEventListener("hashchange",this._onpopstate,!1):v&&i.removeEventListener("hashchange",this._onpopstate,!1)},S.prototype.base=function(e){if(0===arguments.length)return this._base;this._base=e},S.prototype._getBase=function(){var e=this._base;if(e)return e;var t=v&&this._window&&this._window.location;return v&&this._hashbang&&t&&"file:"===t.protocol&&(e=t.pathname),e},S.prototype.strict=function(e){if(0===arguments.length)return this._strict;this._strict=e},S.prototype.start=function(e){var t=e||{};if(this.configure(t),!1!==t.dispatch){var i;if(this._running=!0,_){var o=this._window.location;i=this._hashbang&&~o.hash.indexOf("#!")?o.hash.substr(2)+o.search:this._hashbang?o.search+o.hash:o.pathname+o.search+o.hash}this.replace(i,null,!0,t.dispatch)}},S.prototype.stop=function(){if(this._running){this.current="",this.len=0,this._running=!1;var e=this._window;this._click&&e.document.removeEventListener(w,this.clickHandler,!1),v&&e.removeEventListener("popstate",this._onpopstate,!1),v&&e.removeEventListener("hashchange",this._onpopstate,!1)}},S.prototype.show=function(e,t,i,o){var n=new k(e,t,this),a=this.prevContext;return this.prevContext=n,this.current=n.path,!1!==i&&this.dispatch(n,a),!1!==n.handled&&!1!==o&&n.pushState(),n},S.prototype.back=function(e,t){var i=this;if(this.len>0){var o=this._window;b&&o.history.back(),this.len--}else e?setTimeout(function(){i.show(e,t)}):setTimeout(function(){i.show(i._getBase(),t)})},S.prototype.redirect=function(e,t){var i=this;"string"==typeof e&&"string"==typeof t&&C.call(this,e,function(e){setTimeout(function(){i.replace(t)},0)}),"string"==typeof e&&void 0===t&&setTimeout(function(){i.replace(e)},0)},S.prototype.replace=function(e,t,i,o){var n=new k(e,t,this),a=this.prevContext;return this.prevContext=n,this.current=n.path,n.init=i,n.save(),!1!==o&&this.dispatch(n,a),n},S.prototype.dispatch=function(e,t){var i=0,o=0,n=this;function a(){var t=n.callbacks[i++];if(e.path===n.current)return t?void t(e,a):function(e){if(e.handled)return;var t,i=this._window;t=this._hashbang?_&&this._getBase()+i.location.hash.replace("#!",""):_&&i.location.pathname+i.location.search;if(t===e.canonicalPath)return;this.stop(),e.handled=!1,_&&(i.location.href=e.canonicalPath)}.call(n,e);e.handled=!1}t?function e(){var i=n.exits[o++];if(!i)return a();i(t,e)}():a()},S.prototype.exit=function(e,t){if("function"==typeof e)return this.exit("*",e);for(var i=new T(e,null,this),o=1;o<arguments.length;++o)this.exits.push(i.middleware(arguments[o]))},S.prototype.clickHandler=function(e){if(1===this._which(e)&&!(e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){var t=e.target,i=e.path||(e.composedPath?e.composedPath():null);if(i)for(var o=0;o<i.length;o++)if(i[o].nodeName&&"A"===i[o].nodeName.toUpperCase()&&i[o].href){t=i[o];break}for(;t&&"A"!==t.nodeName.toUpperCase();)t=t.parentNode;if(t&&"A"===t.nodeName.toUpperCase()){var n="object"==typeof t.href&&"SVGAnimatedString"===t.href.constructor.name;if(!t.hasAttribute("download")&&"external"!==t.getAttribute("rel")){var a=t.getAttribute("href");if((this._hashbang||!this._samePath(t)||!t.hash&&"#"!==a)&&!(a&&a.indexOf("mailto:")>-1)&&(n?!t.target.baseVal:!t.target)&&(n||this.sameOrigin(t.href))){var r=n?t.href.baseVal:t.pathname+t.search+(t.hash||"");r="/"!==r[0]?"/"+r:r,y&&r.match(/^\/[a-zA-Z]:\//)&&(r=r.replace(/^\/[a-zA-Z]:\//,"/"));var s=r,l=this._getBase();0===r.indexOf(l)&&(r=r.substr(l.length)),this._hashbang&&(r=r.replace("#!","")),(!l||s!==r||_&&"file:"===this._window.location.protocol)&&(e.preventDefault(),this.show(s))}}}}},S.prototype._onpopstate=(m=!1,v?(g&&"complete"===document.readyState?m=!0:window.addEventListener("load",function(){setTimeout(function(){m=!0},0)}),function(e){if(m)if(e.state){var t=e.state.path;this.replace(t,e.state)}else if(_){var i=this._window.location;this.show(i.pathname+i.search+i.hash,void 0,void 0,!1)}}):function(){}),S.prototype._which=function(e){return null==(e=e||v&&this._window.event).which?e.button:e.which},S.prototype._toURL=function(e){var t=this._window;if("function"==typeof URL&&_)return new URL(e,t.location.toString());if(g){var i=t.document.createElement("a");return i.href=e,i}},S.prototype.sameOrigin=function(e){if(!e||!_)return!1;var t=this._toURL(e),i=this._window.location;return i.protocol===t.protocol&&i.hostname===t.hostname},S.prototype._samePath=function(e){if(!_)return!1;var t=this._window.location;return e.pathname===t.pathname&&e.search===t.search},S.prototype._decodeURLEncodedURIComponent=function(e){return"string"!=typeof e?e:this._decodeURLComponents?decodeURIComponent(e.replace(/\+/g," ")):e},k.prototype.pushState=function(){var e=this.page,t=e._window,i=e._hashbang;e.len++,b&&t.history.pushState(this.state,this.title,i&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},k.prototype.save=function(){var e=this.page;b&&e._window.history.replaceState(this.state,this.title,e._hashbang&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},T.prototype.middleware=function(e){var t=this;return function(i,o){if(t.match(i.path,i.params))return e(i,o);o()}},T.prototype.match=function(e,t){var i=this.keys,o=e.indexOf("?"),n=~o?e.slice(0,o):e,a=this.regexp.exec(decodeURIComponent(n));if(!a)return!1;for(var r=1,s=a.length;r<s;++r){var l=i[r-1],d=this.page._decodeURLEncodedURIComponent(a[r]);void 0===d&&hasOwnProperty.call(t,l.name)||(t[l.name]=d)}return!0};var $=function e(){var t=new S;function i(){return C.apply(t,arguments)}return i.callbacks=t.callbacks,i.exits=t.exits,i.base=t.base.bind(t),i.strict=t.strict.bind(t),i.start=t.start.bind(t),i.stop=t.stop.bind(t),i.show=t.show.bind(t),i.back=t.back.bind(t),i.redirect=t.redirect.bind(t),i.replace=t.replace.bind(t),i.dispatch=t.dispatch.bind(t),i.exit=t.exit.bind(t),i.configure=t.configure.bind(t),i.sameOrigin=t.sameOrigin.bind(t),i.clickHandler=t.clickHandler.bind(t),i.create=e,Object.defineProperty(i,"len",{get:function(){return t.len},set:function(e){t.len=e}}),Object.defineProperty(i,"current",{get:function(){return t.current},set:function(e){t.current=e}}),i.Context=k,i.Route=T,i}(),x=$,E=$;return x.default=E,x}),function(e,t,i,o){function n(t,i){this.settings=null,this.options=e.extend({},n.Defaults,i),this.$element=e(t),this._handlers={},this._plugins={},this._supress={},this._current=null,this._speed=null,this._coordinates=[],this._breakpoint=null,this._width=null,this._items=[],this._clones=[],this._mergers=[],this._widths=[],this._invalidated={},this._pipe=[],this._drag={time:null,target:null,pointer:null,stage:{start:null,current:null},direction:null},this._states={current:{},tags:{initializing:["busy"],animating:["busy"],dragging:["interacting"]}},e.each(["onResize","onThrottledResize"],e.proxy(function(t,i){this._handlers[i]=e.proxy(this[i],this)},this)),e.each(n.Plugins,e.proxy(function(e,t){this._plugins[e.charAt(0).toLowerCase()+e.slice(1)]=new t(this)},this)),e.each(n.Workers,e.proxy(function(t,i){this._pipe.push({filter:i.filter,run:e.proxy(i.run,this)})},this)),this.setup(),this.initialize()}n.Defaults={items:3,loop:!1,center:!1,rewind:!1,checkVisibility:!0,mouseDrag:!0,touchDrag:!0,pullDrag:!0,freeDrag:!1,margin:0,stagePadding:0,merge:!1,mergeFit:!0,autoWidth:!1,startPosition:0,rtl:!1,smartSpeed:250,fluidSpeed:!1,dragEndSpeed:!1,responsive:{},responsiveRefreshRate:200,responsiveBaseElement:t,fallbackEasing:"swing",slideTransition:"",info:!1,nestedItemSelector:!1,itemElement:"div",stageElement:"div",refreshClass:"owl-refresh",loadedClass:"owl-loaded",loadingClass:"owl-loading",rtlClass:"owl-rtl",responsiveClass:"owl-responsive",dragClass:"owl-drag",itemClass:"owl-item",stageClass:"owl-stage",stageOuterClass:"owl-stage-outer",grabClass:"owl-grab"},n.Width={Default:"default",Inner:"inner",Outer:"outer"},n.Type={Event:"event",State:"state"},n.Plugins={},n.Workers=[{filter:["width","settings"],run:function(){this._width=this.$element.width()}},{filter:["width","items","settings"],run:function(e){e.current=this._items&&this._items[this.relative(this._current)]}},{filter:["items","settings"],run:function(){this.$stage.children(".cloned").remove()}},{filter:["width","items","settings"],run:function(e){var t=this.settings.margin||"",i=!this.settings.autoWidth,o=this.settings.rtl,n={width:"auto","margin-left":o?t:"","margin-right":o?"":t};!i&&this.$stage.children().css(n),e.css=n}},{filter:["width","items","settings"],run:function(e){var t=(this.width()/this.settings.items).toFixed(3)-this.settings.margin,i=null,o=this._items.length,n=!this.settings.autoWidth,a=[];for(e.items={merge:!1,width:t};o--;)i=this._mergers[o],i=this.settings.mergeFit&&Math.min(i,this.settings.items)||i,e.items.merge=i>1||e.items.merge,a[o]=n?t*i:this._items[o].width();this._widths=a}},{filter:["items","settings"],run:function(){var t=[],i=this._items,o=this.settings,n=Math.max(2*o.items,4),a=2*Math.ceil(i.length/2),r=o.loop&&i.length?o.rewind?n:Math.max(n,a):0,s="",l="";for(r/=2;r>0;)t.push(this.normalize(t.length/2,!0)),s+=i[t[t.length-1]][0].outerHTML,t.push(this.normalize(i.length-1-(t.length-1)/2,!0)),l=i[t[t.length-1]][0].outerHTML+l,r-=1;this._clones=t,e(s).addClass("cloned").appendTo(this.$stage),e(l).addClass("cloned").prependTo(this.$stage)}},{filter:["width","items","settings"],run:function(){for(var e=this.settings.rtl?1:-1,t=this._clones.length+this._items.length,i=-1,o=0,n=0,a=[];++i<t;)o=a[i-1]||0,n=this._widths[this.relative(i)]+this.settings.margin,a.push(o+n*e);this._coordinates=a}},{filter:["width","items","settings"],run:function(){var e=this.settings.stagePadding,t=this._coordinates,i={width:Math.ceil(Math.abs(t[t.length-1]))+2*e,"padding-left":e||"","padding-right":e||""};this.$stage.css(i)}},{filter:["width","items","settings"],run:function(e){var t=this._coordinates.length,i=!this.settings.autoWidth,o=this.$stage.children();if(i&&e.items.merge)for(;t--;)e.css.width=this._widths[this.relative(t)],o.eq(t).css(e.css);else i&&(e.css.width=e.items.width,o.css(e.css))}},{filter:["items"],run:function(){this._coordinates.length<1&&this.$stage.removeAttr("style")}},{filter:["width","items","settings"],run:function(e){e.current=e.current?this.$stage.children().index(e.current):0,e.current=Math.max(this.minimum(),Math.min(this.maximum(),e.current)),this.reset(e.current)}},{filter:["position"],run:function(){this.animate(this.coordinates(this._current))}},{filter:["width","position","items","settings"],run:function(){var e,t,i,o,n=this.settings.rtl?1:-1,a=2*this.settings.stagePadding,r=this.coordinates(this.current())+a,s=r+this.width()*n,l=[];for(i=0,o=this._coordinates.length;i<o;i++)e=this._coordinates[i-1]||0,t=Math.abs(this._coordinates[i])+a*n,(this.op(e,"<=",r)&&this.op(e,">",s)||this.op(t,"<",r)&&this.op(t,">",s))&&l.push(i);this.$stage.children(".active").removeClass("active"),this.$stage.children(":eq("+l.join("), :eq(")+")").addClass("active"),this.$stage.children(".center").removeClass("center"),this.settings.center&&this.$stage.children().eq(this.current()).addClass("center")}}],n.prototype.initializeStage=function(){this.$stage=this.$element.find("."+this.settings.stageClass),this.$stage.length||(this.$element.addClass(this.options.loadingClass),this.$stage=e("<"+this.settings.stageElement+">",{class:this.settings.stageClass}).wrap(e("<div/>",{class:this.settings.stageOuterClass})),this.$element.append(this.$stage.parent()))},n.prototype.initializeItems=function(){var t=this.$element.find(".owl-item");if(t.length)return this._items=t.get().map(function(t){return e(t)}),this._mergers=this._items.map(function(){return 1}),void this.refresh();this.replace(this.$element.children().not(this.$stage.parent())),this.isVisible()?this.refresh():this.invalidate("width"),this.$element.removeClass(this.options.loadingClass).addClass(this.options.loadedClass)},n.prototype.initialize=function(){var e,t,i;(this.enter("initializing"),this.trigger("initialize"),this.$element.toggleClass(this.settings.rtlClass,this.settings.rtl),this.settings.autoWidth&&!this.is("pre-loading"))&&(e=this.$element.find("img"),t=this.settings.nestedItemSelector?"."+this.settings.nestedItemSelector:void 0,i=this.$element.children(t).width(),e.length&&i<=0&&this.preloadAutoWidthImages(e));this.initializeStage(),this.initializeItems(),this.registerEventHandlers(),this.leave("initializing"),this.trigger("initialized")},n.prototype.isVisible=function(){return!this.settings.checkVisibility||this.$element.is(":visible")},n.prototype.setup=function(){var t=this.viewport(),i=this.options.responsive,o=-1,n=null;i?(e.each(i,function(e){e<=t&&e>o&&(o=Number(e))}),"function"==typeof(n=e.extend({},this.options,i[o])).stagePadding&&(n.stagePadding=n.stagePadding()),delete n.responsive,n.responsiveClass&&this.$element.attr("class",this.$element.attr("class").replace(new RegExp("("+this.options.responsiveClass+"-)\\S+\\s","g"),"$1"+o))):n=e.extend({},this.options),this.trigger("change",{property:{name:"settings",value:n}}),this._breakpoint=o,this.settings=n,this.invalidate("settings"),this.trigger("changed",{property:{name:"settings",value:this.settings}})},n.prototype.optionsLogic=function(){this.settings.autoWidth&&(this.settings.stagePadding=!1,this.settings.merge=!1)},n.prototype.prepare=function(t){var i=this.trigger("prepare",{content:t});return i.data||(i.data=e("<"+this.settings.itemElement+"/>").addClass(this.options.itemClass).append(t)),this.trigger("prepared",{content:i.data}),i.data},n.prototype.update=function(){for(var t=0,i=this._pipe.length,o=e.proxy(function(e){return this[e]},this._invalidated),n={};t<i;)(this._invalidated.all||e.grep(this._pipe[t].filter,o).length>0)&&this._pipe[t].run(n),t++;this._invalidated={},!this.is("valid")&&this.enter("valid")},n.prototype.width=function(e){switch(e=e||n.Width.Default){case n.Width.Inner:case n.Width.Outer:return this._width;default:return this._width-2*this.settings.stagePadding+this.settings.margin}},n.prototype.refresh=function(){this.enter("refreshing"),this.trigger("refresh"),this.setup(),this.optionsLogic(),this.$element.addClass(this.options.refreshClass),this.update(),this.$element.removeClass(this.options.refreshClass),this.leave("refreshing"),this.trigger("refreshed")},n.prototype.onThrottledResize=function(){t.clearTimeout(this.resizeTimer),this.resizeTimer=t.setTimeout(this._handlers.onResize,this.settings.responsiveRefreshRate)},n.prototype.onResize=function(){return!!this._items.length&&(this._width!==this.$element.width()&&(!!this.isVisible()&&(this.enter("resizing"),this.trigger("resize").isDefaultPrevented()?(this.leave("resizing"),!1):(this.invalidate("width"),this.refresh(),this.leave("resizing"),void this.trigger("resized")))))},n.prototype.registerEventHandlers=function(){e.support.transition&&this.$stage.on(e.support.transition.end+".owl.core",e.proxy(this.onTransitionEnd,this)),!1!==this.settings.responsive&&this.on(t,"resize",this._handlers.onThrottledResize),this.settings.mouseDrag&&(this.$element.addClass(this.options.dragClass),this.$stage.on("mousedown.owl.core",e.proxy(this.onDragStart,this)),this.$stage.on("dragstart.owl.core selectstart.owl.core",function(){return!1})),this.settings.touchDrag&&(this.$stage.on("touchstart.owl.core",e.proxy(this.onDragStart,this)),this.$stage.on("touchcancel.owl.core",e.proxy(this.onDragEnd,this)))},n.prototype.onDragStart=function(t){var o=null;3!==t.which&&(e.support.transform?o={x:(o=this.$stage.css("transform").replace(/.*\(|\)| /g,"").split(","))[16===o.length?12:4],y:o[16===o.length?13:5]}:(o=this.$stage.position(),o={x:this.settings.rtl?o.left+this.$stage.width()-this.width()+this.settings.margin:o.left,y:o.top}),this.is("animating")&&(e.support.transform?this.animate(o.x):this.$stage.stop(),this.invalidate("position")),this.$element.toggleClass(this.options.grabClass,"mousedown"===t.type),this.speed(0),this._drag.time=(new Date).getTime(),this._drag.target=e(t.target),this._drag.stage.start=o,this._drag.stage.current=o,this._drag.pointer=this.pointer(t),e(i).on("mouseup.owl.core touchend.owl.core",e.proxy(this.onDragEnd,this)),e(i).one("mousemove.owl.core touchmove.owl.core",e.proxy(function(t){var o=this.difference(this._drag.pointer,this.pointer(t));e(i).on("mousemove.owl.core touchmove.owl.core",e.proxy(this.onDragMove,this)),Math.abs(o.x)<Math.abs(o.y)&&this.is("valid")||(t.preventDefault(),this.enter("dragging"),this.trigger("drag"))},this)))},n.prototype.onDragMove=function(e){var t=null,i=null,o=null,n=this.difference(this._drag.pointer,this.pointer(e)),a=this.difference(this._drag.stage.start,n);this.is("dragging")&&(e.preventDefault(),this.settings.loop?(t=this.coordinates(this.minimum()),i=this.coordinates(this.maximum()+1)-t,a.x=((a.x-t)%i+i)%i+t):(t=this.settings.rtl?this.coordinates(this.maximum()):this.coordinates(this.minimum()),i=this.settings.rtl?this.coordinates(this.minimum()):this.coordinates(this.maximum()),o=this.settings.pullDrag?-1*n.x/5:0,a.x=Math.max(Math.min(a.x,t+o),i+o)),this._drag.stage.current=a,this.animate(a.x))},n.prototype.onDragEnd=function(t){var o=this.difference(this._drag.pointer,this.pointer(t)),n=this._drag.stage.current,a=o.x>0^this.settings.rtl?"left":"right";e(i).off(".owl.core"),this.$element.removeClass(this.options.grabClass),(0!==o.x&&this.is("dragging")||!this.is("valid"))&&(this.speed(this.settings.dragEndSpeed||this.settings.smartSpeed),this.current(this.closest(n.x,0!==o.x?a:this._drag.direction)),this.invalidate("position"),this.update(),this._drag.direction=a,(Math.abs(o.x)>3||(new Date).getTime()-this._drag.time>300)&&this._drag.target.one("click.owl.core",function(){return!1})),this.is("dragging")&&(this.leave("dragging"),this.trigger("dragged"))},n.prototype.closest=function(t,i){var o=-1,n=this.width(),a=this.coordinates();return this.settings.freeDrag||e.each(a,e.proxy(function(e,r){return"left"===i&&t>r-30&&t<r+30?o=e:"right"===i&&t>r-n-30&&t<r-n+30?o=e+1:this.op(t,"<",r)&&this.op(t,">",void 0!==a[e+1]?a[e+1]:r-n)&&(o="left"===i?e+1:e),-1===o},this)),this.settings.loop||(this.op(t,">",a[this.minimum()])?o=t=this.minimum():this.op(t,"<",a[this.maximum()])&&(o=t=this.maximum())),o},n.prototype.animate=function(t){var i=this.speed()>0;this.is("animating")&&this.onTransitionEnd(),i&&(this.enter("animating"),this.trigger("translate")),e.support.transform3d&&e.support.transition?this.$stage.css({transform:"translate3d("+t+"px,0px,0px)",transition:this.speed()/1e3+"s"+(this.settings.slideTransition?" "+this.settings.slideTransition:"")}):i?this.$stage.animate({left:t+"px"},this.speed(),this.settings.fallbackEasing,e.proxy(this.onTransitionEnd,this)):this.$stage.css({left:t+"px"})},n.prototype.is=function(e){return this._states.current[e]&&this._states.current[e]>0},n.prototype.current=function(e){if(void 0===e)return this._current;if(0!==this._items.length){if(e=this.normalize(e),this._current!==e){var t=this.trigger("change",{property:{name:"position",value:e}});void 0!==t.data&&(e=this.normalize(t.data)),this._current=e,this.invalidate("position"),this.trigger("changed",{property:{name:"position",value:this._current}})}return this._current}},n.prototype.invalidate=function(t){return"string"===e.type(t)&&(this._invalidated[t]=!0,this.is("valid")&&this.leave("valid")),e.map(this._invalidated,function(e,t){return t})},n.prototype.reset=function(e){void 0!==(e=this.normalize(e))&&(this._speed=0,this._current=e,this.suppress(["translate","translated"]),this.animate(this.coordinates(e)),this.release(["translate","translated"]))},n.prototype.normalize=function(e,t){var i=this._items.length,o=t?0:this._clones.length;return!this.isNumeric(e)||i<1?e=void 0:(e<0||e>=i+o)&&(e=((e-o/2)%i+i)%i+o/2),e},n.prototype.relative=function(e){return e-=this._clones.length/2,this.normalize(e,!0)},n.prototype.maximum=function(e){var t,i,o,n=this.settings,a=this._coordinates.length;if(n.loop)a=this._clones.length/2+this._items.length-1;else if(n.autoWidth||n.merge){if(t=this._items.length)for(i=this._items[--t].width(),o=this.$element.width();t--&&!((i+=this._items[t].width()+this.settings.margin)>o););a=t+1}else a=n.center?this._items.length-1:this._items.length-n.items;return e&&(a-=this._clones.length/2),Math.max(a,0)},n.prototype.minimum=function(e){return e?0:this._clones.length/2},n.prototype.items=function(e){return void 0===e?this._items.slice():(e=this.normalize(e,!0),this._items[e])},n.prototype.mergers=function(e){return void 0===e?this._mergers.slice():(e=this.normalize(e,!0),this._mergers[e])},n.prototype.clones=function(t){var i=this._clones.length/2,o=i+this._items.length,n=function(e){return e%2==0?o+e/2:i-(e+1)/2};return void 0===t?e.map(this._clones,function(e,t){return n(t)}):e.map(this._clones,function(e,i){return e===t?n(i):null})},n.prototype.speed=function(e){return void 0!==e&&(this._speed=e),this._speed},n.prototype.coordinates=function(t){var i,o=1,n=t-1;return void 0===t?e.map(this._coordinates,e.proxy(function(e,t){return this.coordinates(t)},this)):(this.settings.center?(this.settings.rtl&&(o=-1,n=t+1),i=this._coordinates[t],i+=(this.width()-i+(this._coordinates[n]||0))/2*o):i=this._coordinates[n]||0,i=Math.ceil(i))},n.prototype.duration=function(e,t,i){return 0===i?0:Math.min(Math.max(Math.abs(t-e),1),6)*Math.abs(i||this.settings.smartSpeed)},n.prototype.to=function(e,t){var i=this.current(),o=null,n=e-this.relative(i),a=(n>0)-(n<0),r=this._items.length,s=this.minimum(),l=this.maximum();this.settings.loop?(!this.settings.rewind&&Math.abs(n)>r/2&&(n+=-1*a*r),(o=(((e=i+n)-s)%r+r)%r+s)!==e&&o-n<=l&&o-n>0&&(i=o-n,e=o,this.reset(i))):e=this.settings.rewind?(e%(l+=1)+l)%l:Math.max(s,Math.min(l,e)),this.speed(this.duration(i,e,t)),this.current(e),this.isVisible()&&this.update()},n.prototype.next=function(e){e=e||!1,this.to(this.relative(this.current())+1,e)},n.prototype.prev=function(e){e=e||!1,this.to(this.relative(this.current())-1,e)},n.prototype.onTransitionEnd=function(e){if(void 0!==e&&(e.stopPropagation(),(e.target||e.srcElement||e.originalTarget)!==this.$stage.get(0)))return!1;this.leave("animating"),this.trigger("translated")},n.prototype.viewport=function(){var o;return this.options.responsiveBaseElement!==t?o=e(this.options.responsiveBaseElement).width():t.innerWidth?o=t.innerWidth:i.documentElement&&i.documentElement.clientWidth?o=i.documentElement.clientWidth:console.warn("Can not detect viewport width."),o},n.prototype.replace=function(t){this.$stage.empty(),this._items=[],t&&(t=t instanceof jQuery?t:e(t)),this.settings.nestedItemSelector&&(t=t.find("."+this.settings.nestedItemSelector)),t.filter(function(){return 1===this.nodeType}).each(e.proxy(function(e,t){t=this.prepare(t),this.$stage.append(t),this._items.push(t),this._mergers.push(1*t.find("[data-merge]").addBack("[data-merge]").attr("data-merge")||1)},this)),this.reset(this.isNumeric(this.settings.startPosition)?this.settings.startPosition:0),this.invalidate("items")},n.prototype.add=function(t,i){var o=this.relative(this._current);i=void 0===i?this._items.length:this.normalize(i,!0),t=t instanceof jQuery?t:e(t),this.trigger("add",{content:t,position:i}),t=this.prepare(t),0===this._items.length||i===this._items.length?(0===this._items.length&&this.$stage.append(t),0!==this._items.length&&this._items[i-1].after(t),this._items.push(t),this._mergers.push(1*t.find("[data-merge]").addBack("[data-merge]").attr("data-merge")||1)):(this._items[i].before(t),this._items.splice(i,0,t),this._mergers.splice(i,0,1*t.find("[data-merge]").addBack("[data-merge]").attr("data-merge")||1)),this._items[o]&&this.reset(this._items[o].index()),this.invalidate("items"),this.trigger("added",{content:t,position:i})},n.prototype.remove=function(e){void 0!==(e=this.normalize(e,!0))&&(this.trigger("remove",{content:this._items[e],position:e}),this._items[e].remove(),this._items.splice(e,1),this._mergers.splice(e,1),this.invalidate("items"),this.trigger("removed",{content:null,position:e}))},n.prototype.preloadAutoWidthImages=function(t){t.each(e.proxy(function(t,i){this.enter("pre-loading"),i=e(i),e(new Image).one("load",e.proxy(function(e){i.attr("src",e.target.src),i.css("opacity",1),this.leave("pre-loading"),!this.is("pre-loading")&&!this.is("initializing")&&this.refresh()},this)).attr("src",i.attr("src")||i.attr("data-src")||i.attr("data-src-retina"))},this))},n.prototype.destroy=function(){for(var o in this.$element.off(".owl.core"),this.$stage.off(".owl.core"),e(i).off(".owl.core"),!1!==this.settings.responsive&&(t.clearTimeout(this.resizeTimer),this.off(t,"resize",this._handlers.onThrottledResize)),this._plugins)this._plugins[o].destroy();this.$stage.children(".cloned").remove(),this.$stage.unwrap(),this.$stage.children().contents().unwrap(),this.$stage.children().unwrap(),this.$stage.remove(),this.$element.removeClass(this.options.refreshClass).removeClass(this.options.loadingClass).removeClass(this.options.loadedClass).removeClass(this.options.rtlClass).removeClass(this.options.dragClass).removeClass(this.options.grabClass).attr("class",this.$element.attr("class").replace(new RegExp(this.options.responsiveClass+"-\\S+\\s","g"),"")).removeData("owl.carousel")},n.prototype.op=function(e,t,i){var o=this.settings.rtl;switch(t){case"<":return o?e>i:e<i;case">":return o?e<i:e>i;case">=":return o?e<=i:e>=i;case"<=":return o?e>=i:e<=i}},n.prototype.on=function(e,t,i,o){e.addEventListener?e.addEventListener(t,i,o):e.attachEvent&&e.attachEvent("on"+t,i)},n.prototype.off=function(e,t,i,o){e.removeEventListener?e.removeEventListener(t,i,o):e.detachEvent&&e.detachEvent("on"+t,i)},n.prototype.trigger=function(t,i,o,a,r){var s={item:{count:this._items.length,index:this.current()}},l=e.camelCase(e.grep(["on",t,o],function(e){return e}).join("-").toLowerCase()),d=e.Event([t,"owl",o||"carousel"].join(".").toLowerCase(),e.extend({relatedTarget:this},s,i));return this._supress[t]||(e.each(this._plugins,function(e,t){t.onTrigger&&t.onTrigger(d)}),this.register({type:n.Type.Event,name:t}),this.$element.trigger(d),this.settings&&"function"==typeof this.settings[l]&&this.settings[l].call(this,d)),d},n.prototype.enter=function(t){e.each([t].concat(this._states.tags[t]||[]),e.proxy(function(e,t){void 0===this._states.current[t]&&(this._states.current[t]=0),this._states.current[t]++},this))},n.prototype.leave=function(t){e.each([t].concat(this._states.tags[t]||[]),e.proxy(function(e,t){this._states.current[t]--},this))},n.prototype.register=function(t){if(t.type===n.Type.Event){if(e.event.special[t.name]||(e.event.special[t.name]={}),!e.event.special[t.name].owl){var i=e.event.special[t.name]._default;e.event.special[t.name]._default=function(e){return!i||!i.apply||e.namespace&&-1!==e.namespace.indexOf("owl")?e.namespace&&e.namespace.indexOf("owl")>-1:i.apply(this,arguments)},e.event.special[t.name].owl=!0}}else t.type===n.Type.State&&(this._states.tags[t.name]?this._states.tags[t.name]=this._states.tags[t.name].concat(t.tags):this._states.tags[t.name]=t.tags,this._states.tags[t.name]=e.grep(this._states.tags[t.name],e.proxy(function(i,o){return e.inArray(i,this._states.tags[t.name])===o},this)))},n.prototype.suppress=function(t){e.each(t,e.proxy(function(e,t){this._supress[t]=!0},this))},n.prototype.release=function(t){e.each(t,e.proxy(function(e,t){delete this._supress[t]},this))},n.prototype.pointer=function(e){var i={x:null,y:null};return(e=(e=e.originalEvent||e||t.event).touches&&e.touches.length?e.touches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e).pageX?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),i},n.prototype.isNumeric=function(e){return!isNaN(parseFloat(e))},n.prototype.difference=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},e.fn.owlCarousel=function(t){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var o=e(this),a=o.data("owl.carousel");a||(a=new n(this,"object"==typeof t&&t),o.data("owl.carousel",a),e.each(["next","prev","to","destroy","refresh","replace","add","remove"],function(t,i){a.register({type:n.Type.Event,name:i}),a.$element.on(i+".owl.carousel.core",e.proxy(function(e){e.namespace&&e.relatedTarget!==this&&(this.suppress([i]),a[i].apply(this,[].slice.call(arguments,1)),this.release([i]))},a))})),"string"==typeof t&&"_"!==t.charAt(0)&&a[t].apply(a,i)})},e.fn.owlCarousel.Constructor=n}(window.Zepto||window.jQuery,window,document),function(e,t,i,o){var n=function(t){this._core=t,this._interval=null,this._visible=null,this._handlers={"initialized.owl.carousel":e.proxy(function(e){e.namespace&&this._core.settings.autoRefresh&&this.watch()},this)},this._core.options=e.extend({},n.Defaults,this._core.options),this._core.$element.on(this._handlers)};n.Defaults={autoRefresh:!0,autoRefreshInterval:500},n.prototype.watch=function(){this._interval||(this._visible=this._core.isVisible(),this._interval=t.setInterval(e.proxy(this.refresh,this),this._core.settings.autoRefreshInterval))},n.prototype.refresh=function(){this._core.isVisible()!==this._visible&&(this._visible=!this._visible,this._core.$element.toggleClass("owl-hidden",!this._visible),this._visible&&this._core.invalidate("width")&&this._core.refresh())},n.prototype.destroy=function(){var e,i;for(e in t.clearInterval(this._interval),this._handlers)this._core.$element.off(e,this._handlers[e]);for(i in Object.getOwnPropertyNames(this))"function"!=typeof this[i]&&(this[i]=null)},e.fn.owlCarousel.Constructor.Plugins.AutoRefresh=n}(window.Zepto||window.jQuery,window,document),function(e,t,i,o){var n=function(t){this._core=t,this._loaded=[],this._handlers={"initialized.owl.carousel change.owl.carousel resized.owl.carousel":e.proxy(function(t){if(t.namespace&&this._core.settings&&this._core.settings.lazyLoad&&(t.property&&"position"==t.property.name||"initialized"==t.type)){var i=this._core.settings,o=i.center&&Math.ceil(i.items/2)||i.items,n=i.center&&-1*o||0,a=(t.property&&void 0!==t.property.value?t.property.value:this._core.current())+n,r=this._core.clones().length,s=e.proxy(function(e,t){this.load(t)},this);for(i.lazyLoadEager>0&&(o+=i.lazyLoadEager,i.loop&&(a-=i.lazyLoadEager,o++));n++<o;)this.load(r/2+this._core.relative(a)),r&&e.each(this._core.clones(this._core.relative(a)),s),a++}},this)},this._core.options=e.extend({},n.Defaults,this._core.options),this._core.$element.on(this._handlers)};n.Defaults={lazyLoad:!1,lazyLoadEager:0},n.prototype.load=function(i){var o=this._core.$stage.children().eq(i),n=o&&o.find(".owl-lazy");!n||e.inArray(o.get(0),this._loaded)>-1||(n.each(e.proxy(function(i,o){var n,a=e(o),r=t.devicePixelRatio>1&&a.attr("data-src-retina")||a.attr("data-src")||a.attr("data-srcset");this._core.trigger("load",{element:a,url:r},"lazy"),a.is("img")?a.one("load.owl.lazy",e.proxy(function(){a.css("opacity",1),this._core.trigger("loaded",{element:a,url:r},"lazy")},this)).attr("src",r):a.is("source")?a.one("load.owl.lazy",e.proxy(function(){this._core.trigger("loaded",{element:a,url:r},"lazy")},this)).attr("srcset",r):((n=new Image).onload=e.proxy(function(){a.css({"background-image":'url("'+r+'")',opacity:"1"}),this._core.trigger("loaded",{element:a,url:r},"lazy")},this),n.src=r)},this)),this._loaded.push(o.get(0)))},n.prototype.destroy=function(){var e,t;for(e in this.handlers)this._core.$element.off(e,this.handlers[e]);for(t in Object.getOwnPropertyNames(this))"function"!=typeof this[t]&&(this[t]=null)},e.fn.owlCarousel.Constructor.Plugins.Lazy=n}(window.Zepto||window.jQuery,window,document),function(e,t,i,o){var n=function(i){this._core=i,this._previousHeight=null,this._handlers={"initialized.owl.carousel refreshed.owl.carousel":e.proxy(function(e){e.namespace&&this._core.settings.autoHeight&&this.update()},this),"changed.owl.carousel":e.proxy(function(e){e.namespace&&this._core.settings.autoHeight&&"position"===e.property.name&&this.update()},this),"loaded.owl.lazy":e.proxy(function(e){e.namespace&&this._core.settings.autoHeight&&e.element.closest("."+this._core.settings.itemClass).index()===this._core.current()&&this.update()},this)},this._core.options=e.extend({},n.Defaults,this._core.options),this._core.$element.on(this._handlers),this._intervalId=null;var o=this;e(t).on("load",function(){o._core.settings.autoHeight&&o.update()}),e(t).resize(function(){o._core.settings.autoHeight&&(null!=o._intervalId&&clearTimeout(o._intervalId),o._intervalId=setTimeout(function(){o.update()},250))})};n.Defaults={autoHeight:!1,autoHeightClass:"owl-height"},n.prototype.update=function(){var t=this._core._current,i=t+this._core.settings.items,o=this._core.settings.lazyLoad,n=this._core.$stage.children().toArray().slice(t,i),a=[],r=0;e.each(n,function(t,i){a.push(e(i).height())}),(r=Math.max.apply(null,a))<=1&&o&&this._previousHeight&&(r=this._previousHeight),this._previousHeight=r,this._core.$stage.parent().height(r).addClass(this._core.settings.autoHeightClass)},n.prototype.destroy=function(){var e,t;for(e in this._handlers)this._core.$element.off(e,this._handlers[e]);for(t in Object.getOwnPropertyNames(this))"function"!=typeof this[t]&&(this[t]=null)},e.fn.owlCarousel.Constructor.Plugins.AutoHeight=n}(window.Zepto||window.jQuery,window,document),function(e,t,i,o){var n=function(t){this._core=t,this._videos={},this._playing=null,this._handlers={"initialized.owl.carousel":e.proxy(function(e){e.namespace&&this._core.register({type:"state",name:"playing",tags:["interacting"]})},this),"resize.owl.carousel":e.proxy(function(e){e.namespace&&this._core.settings.video&&this.isInFullScreen()&&e.preventDefault()},this),"refreshed.owl.carousel":e.proxy(function(e){e.namespace&&this._core.is("resizing")&&this._core.$stage.find(".cloned .owl-video-frame").remove()},this),"changed.owl.carousel":e.proxy(function(e){e.namespace&&"position"===e.property.name&&this._playing&&this.stop()},this),"prepared.owl.carousel":e.proxy(function(t){if(t.namespace){var i=e(t.content).find(".owl-video");i.length&&(i.css("display","none"),this.fetch(i,e(t.content)))}},this)},this._core.options=e.extend({},n.Defaults,this._core.options),this._core.$element.on(this._handlers),this._core.$element.on("click.owl.video",".owl-video-play-icon",e.proxy(function(e){this.play(e)},this))};n.Defaults={video:!1,videoHeight:!1,videoWidth:!1},n.prototype.fetch=function(e,t){var i=e.attr("data-vimeo-id")?"vimeo":e.attr("data-vzaar-id")?"vzaar":"youtube",o=e.attr("data-vimeo-id")||e.attr("data-youtube-id")||e.attr("data-vzaar-id"),n=e.attr("data-width")||this._core.settings.videoWidth,a=e.attr("data-height")||this._core.settings.videoHeight,r=e.attr("href");if(!r)throw new Error("Missing video URL.");if((o=r.match(/(http:|https:|)\/\/(player.|www.|app.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com|be\-nocookie\.com)|vzaar\.com)\/(video\/|videos\/|embed\/|channels\/.+\/|groups\/.+\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/))[3].indexOf("youtu")>-1)i="youtube";else if(o[3].indexOf("vimeo")>-1)i="vimeo";else{if(!(o[3].indexOf("vzaar")>-1))throw new Error("Video URL not supported.");i="vzaar"}o=o[6],this._videos[r]={type:i,id:o,width:n,height:a},t.attr("data-video",r),this.thumbnail(e,this._videos[r])},n.prototype.thumbnail=function(t,i){var o,n,a,r=i.width&&i.height?"width:"+i.width+"px;height:"+i.height+"px;":"",s=t.find("img"),l="src",d="",c=this._core.settings,u=function(i){n='<div class="owl-video-play-icon"></div>',o=c.lazyLoad?e("<div/>",{class:"owl-video-tn "+d,srcType:i}):e("<div/>",{class:"owl-video-tn",style:"opacity:1;background-image:url("+i+")"}),t.after(o),t.after(n)};if(t.wrap(e("<div/>",{class:"owl-video-wrapper",style:r})),this._core.settings.lazyLoad&&(l="data-src",d="owl-lazy"),s.length)return u(s.attr(l)),s.remove(),!1;"youtube"===i.type?(a="//img.youtube.com/vi/"+i.id+"/hqdefault.jpg",u(a)):"vimeo"===i.type?e.ajax({type:"GET",url:"//vimeo.com/api/v2/video/"+i.id+".json",jsonp:"callback",dataType:"jsonp",success:function(e){a=e[0].thumbnail_large,u(a)}}):"vzaar"===i.type&&e.ajax({type:"GET",url:"//vzaar.com/api/videos/"+i.id+".json",jsonp:"callback",dataType:"jsonp",success:function(e){a=e.framegrab_url,u(a)}})},n.prototype.stop=function(){this._core.trigger("stop",null,"video"),this._playing.find(".owl-video-frame").remove(),this._playing.removeClass("owl-video-playing"),this._playing=null,this._core.leave("playing"),this._core.trigger("stopped",null,"video")},n.prototype.play=function(t){var i,o=e(t.target).closest("."+this._core.settings.itemClass),n=this._videos[o.attr("data-video")],a=n.width||"100%",r=n.height||this._core.$stage.height();this._playing||(this._core.enter("playing"),this._core.trigger("play",null,"video"),o=this._core.items(this._core.relative(o.index())),this._core.reset(o.index()),(i=e('<iframe frameborder="0" allowfullscreen mozallowfullscreen webkitAllowFullScreen ></iframe>')).attr("height",r),i.attr("width",a),"youtube"===n.type?i.attr("src","//www.youtube.com/embed/"+n.id+"?autoplay=1&rel=0&v="+n.id):"vimeo"===n.type?i.attr("src","//player.vimeo.com/video/"+n.id+"?autoplay=1"):"vzaar"===n.type&&i.attr("src","//view.vzaar.com/"+n.id+"/player?autoplay=true"),e(i).wrap('<div class="owl-video-frame" />').insertAfter(o.find(".owl-video")),this._playing=o.addClass("owl-video-playing"))},n.prototype.isInFullScreen=function(){var t=i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement;return t&&e(t).parent().hasClass("owl-video-frame")},n.prototype.destroy=function(){var e,t;for(e in this._core.$element.off("click.owl.video"),this._handlers)this._core.$element.off(e,this._handlers[e]);for(t in Object.getOwnPropertyNames(this))"function"!=typeof this[t]&&(this[t]=null)},e.fn.owlCarousel.Constructor.Plugins.Video=n}(window.Zepto||window.jQuery,window,document),function(e,t,i,o){var n=function(t){this.core=t,this.core.options=e.extend({},n.Defaults,this.core.options),this.swapping=!0,this.previous=void 0,this.next=void 0,this.handlers={"change.owl.carousel":e.proxy(function(e){e.namespace&&"position"==e.property.name&&(this.previous=this.core.current(),this.next=e.property.value)},this),"drag.owl.carousel dragged.owl.carousel translated.owl.carousel":e.proxy(function(e){e.namespace&&(this.swapping="translated"==e.type)},this),"translate.owl.carousel":e.proxy(function(e){e.namespace&&this.swapping&&(this.core.options.animateOut||this.core.options.animateIn)&&this.swap()},this)},this.core.$element.on(this.handlers)};n.Defaults={animateOut:!1,animateIn:!1},n.prototype.swap=function(){if(1===this.core.settings.items&&e.support.animation&&e.support.transition){this.core.speed(0);var t,i=e.proxy(this.clear,this),o=this.core.$stage.children().eq(this.previous),n=this.core.$stage.children().eq(this.next),a=this.core.settings.animateIn,r=this.core.settings.animateOut;this.core.current()!==this.previous&&(r&&(t=this.core.coordinates(this.previous)-this.core.coordinates(this.next),o.one(e.support.animation.end,i).css({left:t+"px"}).addClass("animated owl-animated-out").addClass(r)),a&&n.one(e.support.animation.end,i).addClass("animated owl-animated-in").addClass(a))}},n.prototype.clear=function(t){e(t.target).css({left:""}).removeClass("animated owl-animated-out owl-animated-in").removeClass(this.core.settings.animateIn).removeClass(this.core.settings.animateOut),this.core.onTransitionEnd()},n.prototype.destroy=function(){var e,t;for(e in this.handlers)this.core.$element.off(e,this.handlers[e]);for(t in Object.getOwnPropertyNames(this))"function"!=typeof this[t]&&(this[t]=null)},e.fn.owlCarousel.Constructor.Plugins.Animate=n}(window.Zepto||window.jQuery,window,document),function(e,t,i,o){var n=function(t){this._core=t,this._call=null,this._time=0,this._timeout=0,this._paused=!0,this._handlers={"changed.owl.carousel":e.proxy(function(e){e.namespace&&"settings"===e.property.name?this._core.settings.autoplay?this.play():this.stop():e.namespace&&"position"===e.property.name&&this._paused&&(this._time=0)},this),"initialized.owl.carousel":e.proxy(function(e){e.namespace&&this._core.settings.autoplay&&this.play()},this),"play.owl.autoplay":e.proxy(function(e,t,i){e.namespace&&this.play(t,i)},this),"stop.owl.autoplay":e.proxy(function(e){e.namespace&&this.stop()},this),"mouseover.owl.autoplay":e.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.pause()},this),"mouseleave.owl.autoplay":e.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.play()},this),"touchstart.owl.core":e.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.pause()},this),"touchend.owl.core":e.proxy(function(){this._core.settings.autoplayHoverPause&&this.play()},this)},this._core.$element.on(this._handlers),this._core.options=e.extend({},n.Defaults,this._core.options)};n.Defaults={autoplay:!1,autoplayTimeout:5e3,autoplayHoverPause:!1,autoplaySpeed:!1},n.prototype._next=function(o){this._call=t.setTimeout(e.proxy(this._next,this,o),this._timeout*(Math.round(this.read()/this._timeout)+1)-this.read()),this._core.is("interacting")||i.hidden||this._core.next(o||this._core.settings.autoplaySpeed)},n.prototype.read=function(){return(new Date).getTime()-this._time},n.prototype.play=function(i,o){var n;this._core.is("rotating")||this._core.enter("rotating"),i=i||this._core.settings.autoplayTimeout,n=Math.min(this._time%(this._timeout||i),i),this._paused?(this._time=this.read(),this._paused=!1):t.clearTimeout(this._call),this._time+=this.read()%i-n,this._timeout=i,this._call=t.setTimeout(e.proxy(this._next,this,o),i-n)},n.prototype.stop=function(){this._core.is("rotating")&&(this._time=0,this._paused=!0,t.clearTimeout(this._call),this._core.leave("rotating"))},n.prototype.pause=function(){this._core.is("rotating")&&!this._paused&&(this._time=this.read(),this._paused=!0,t.clearTimeout(this._call))},n.prototype.destroy=function(){var e,t;for(e in this.stop(),this._handlers)this._core.$element.off(e,this._handlers[e]);for(t in Object.getOwnPropertyNames(this))"function"!=typeof this[t]&&(this[t]=null)},e.fn.owlCarousel.Constructor.Plugins.autoplay=n}(window.Zepto||window.jQuery,window,document),function(e,t,i,o){"use strict";var n=function(t){this._core=t,this._initialized=!1,this._pages=[],this._controls={},this._templates=[],this.$element=this._core.$element,this._overrides={next:this._core.next,prev:this._core.prev,to:this._core.to},this._handlers={"prepared.owl.carousel":e.proxy(function(t){t.namespace&&this._core.settings.dotsData&&this._templates.push('<div class="'+this._core.settings.dotClass+'">'+e(t.content).find("[data-dot]").addBack("[data-dot]").attr("data-dot")+"</div>")},this),"added.owl.carousel":e.proxy(function(e){e.namespace&&this._core.settings.dotsData&&this._templates.splice(e.position,0,this._templates.pop())},this),"remove.owl.carousel":e.proxy(function(e){e.namespace&&this._core.settings.dotsData&&this._templates.splice(e.position,1)},this),"changed.owl.carousel":e.proxy(function(e){e.namespace&&"position"==e.property.name&&this.draw()},this),"initialized.owl.carousel":e.proxy(function(e){e.namespace&&!this._initialized&&(this._core.trigger("initialize",null,"navigation"),this.initialize(),this.update(),this.draw(),this._initialized=!0,this._core.trigger("initialized",null,"navigation"))},this),"refreshed.owl.carousel":e.proxy(function(e){e.namespace&&this._initialized&&(this._core.trigger("refresh",null,"navigation"),this.update(),this.draw(),this._core.trigger("refreshed",null,"navigation"))},this)},this._core.options=e.extend({},n.Defaults,this._core.options),this.$element.on(this._handlers)};n.Defaults={nav:!1,navText:['<span aria-label="Previous">&#x2039;</span>','<span aria-label="Next">&#x203a;</span>'],navSpeed:!1,navElement:'button type="button" role="presentation"',navContainer:!1,navContainerClass:"owl-nav",navClass:["owl-prev","owl-next"],slideBy:1,dotClass:"owl-dot",dotsClass:"owl-dots",dots:!0,dotsEach:!1,dotsData:!1,dotsSpeed:!1,dotsContainer:!1},n.prototype.initialize=function(){var t,i=this._core.settings;for(t in this._controls.$relative=(i.navContainer?e(i.navContainer):e("<div>").addClass(i.navContainerClass).appendTo(this.$element)).addClass("disabled"),this._controls.$previous=e("<"+i.navElement+">").addClass(i.navClass[0]).html(i.navText[0]).prependTo(this._controls.$relative).on("click",e.proxy(function(e){this.prev(i.navSpeed)},this)),this._controls.$next=e("<"+i.navElement+">").addClass(i.navClass[1]).html(i.navText[1]).appendTo(this._controls.$relative).on("click",e.proxy(function(e){this.next(i.navSpeed)},this)),i.dotsData||(this._templates=[e('<button role="button">').addClass(i.dotClass).append(e("<span>")).prop("outerHTML")]),this._controls.$absolute=(i.dotsContainer?e(i.dotsContainer):e("<div>").addClass(i.dotsClass).appendTo(this.$element)).addClass("disabled"),this._controls.$absolute.on("click","button",e.proxy(function(t){var o=e(t.target).parent().is(this._controls.$absolute)?e(t.target).index():e(t.target).parent().index();t.preventDefault(),this.to(o,i.dotsSpeed)},this)),this._overrides)this._core[t]=e.proxy(this[t],this)},n.prototype.destroy=function(){var e,t,i,o,n;for(e in n=this._core.settings,this._handlers)this.$element.off(e,this._handlers[e]);for(t in this._controls)"$relative"===t&&n.navContainer?this._controls[t].html(""):this._controls[t].remove();for(o in this.overides)this._core[o]=this._overrides[o];for(i in Object.getOwnPropertyNames(this))"function"!=typeof this[i]&&(this[i]=null)},n.prototype.update=function(){var e,t,i=this._core.clones().length/2,o=i+this._core.items().length,n=this._core.maximum(!0),a=this._core.settings,r=a.center||a.autoWidth||a.dotsData?1:a.dotsEach||a.items;if("page"!==a.slideBy&&(a.slideBy=Math.min(a.slideBy,a.items)),a.dots||"page"==a.slideBy)for(this._pages=[],e=i,t=0,0;e<o;e++){if(t>=r||0===t){if(this._pages.push({start:Math.min(n,e-i),end:e-i+r-1}),Math.min(n,e-i)===n)break;t=0,0}t+=this._core.mergers(this._core.relative(e))}},n.prototype.draw=function(){var t,i=this._core.settings,o=this._core.items().length<=i.items,n=this._core.relative(this._core.current()),a=i.loop||i.rewind;this._controls.$relative.toggleClass("disabled",!i.nav||o),i.nav&&(this._controls.$previous.toggleClass("disabled",!a&&n<=this._core.minimum(!0)),this._controls.$next.toggleClass("disabled",!a&&n>=this._core.maximum(!0))),this._controls.$absolute.toggleClass("disabled",!i.dots||o),i.dots&&(t=this._pages.length-this._controls.$absolute.children().length,i.dotsData&&0!==t?this._controls.$absolute.html(this._templates.join("")):t>0?this._controls.$absolute.append(new Array(t+1).join(this._templates[0])):t<0&&this._controls.$absolute.children().slice(t).remove(),this._controls.$absolute.find(".active").removeClass("active"),this._controls.$absolute.children().eq(e.inArray(this.current(),this._pages)).addClass("active"))},n.prototype.onTrigger=function(t){var i=this._core.settings;t.page={index:e.inArray(this.current(),this._pages),count:this._pages.length,size:i&&(i.center||i.autoWidth||i.dotsData?1:i.dotsEach||i.items)}},n.prototype.current=function(){var t=this._core.relative(this._core.current());return e.grep(this._pages,e.proxy(function(e,i){return e.start<=t&&e.end>=t},this)).pop()},n.prototype.getPosition=function(t){var i,o,n=this._core.settings;return"page"==n.slideBy?(i=e.inArray(this.current(),this._pages),o=this._pages.length,t?++i:--i,i=this._pages[(i%o+o)%o].start):(i=this._core.relative(this._core.current()),o=this._core.items().length,t?i+=n.slideBy:i-=n.slideBy),i},n.prototype.next=function(t){e.proxy(this._overrides.to,this._core)(this.getPosition(!0),t)},n.prototype.prev=function(t){e.proxy(this._overrides.to,this._core)(this.getPosition(!1),t)},n.prototype.to=function(t,i,o){var n;!o&&this._pages.length?(n=this._pages.length,e.proxy(this._overrides.to,this._core)(this._pages[(t%n+n)%n].start,i)):e.proxy(this._overrides.to,this._core)(t,i)},e.fn.owlCarousel.Constructor.Plugins.Navigation=n}(window.Zepto||window.jQuery,window,document),function(e,t,i,o){"use strict";var n=function(i){this._core=i,this._hashes={},this.$element=this._core.$element,this._handlers={"initialized.owl.carousel":e.proxy(function(i){i.namespace&&"URLHash"===this._core.settings.startPosition&&e(t).trigger("hashchange.owl.navigation")},this),"prepared.owl.carousel":e.proxy(function(t){if(t.namespace){var i=e(t.content).find("[data-hash]").addBack("[data-hash]").attr("data-hash");if(!i)return;this._hashes[i]=t.content}},this),"changed.owl.carousel":e.proxy(function(i){if(i.namespace&&"position"===i.property.name){var o=this._core.items(this._core.relative(this._core.current())),n=e.map(this._hashes,function(e,t){return e===o?t:null}).join();if(!n||t.location.hash.slice(1)===n)return;t.location.hash=n}},this)},this._core.options=e.extend({},n.Defaults,this._core.options),this.$element.on(this._handlers),e(t).on("hashchange.owl.navigation",e.proxy(function(e){var i=t.location.hash.substring(1),o=this._core.$stage.children(),n=this._hashes[i]&&o.index(this._hashes[i]);void 0!==n&&n!==this._core.current()&&this._core.to(this._core.relative(n),!1,!0)},this))};n.Defaults={URLhashListener:!1},n.prototype.destroy=function(){var i,o;for(i in e(t).off("hashchange.owl.navigation"),this._handlers)this._core.$element.off(i,this._handlers[i]);for(o in Object.getOwnPropertyNames(this))"function"!=typeof this[o]&&(this[o]=null)},e.fn.owlCarousel.Constructor.Plugins.Hash=n}(window.Zepto||window.jQuery,window,document),function(e,t,i,o){var n=e("<support>").get(0).style,a="Webkit Moz O ms".split(" "),r={transition:{end:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"}},animation:{end:{WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd",animation:"animationend"}}},s=function(){return!!c("transform")},l=function(){return!!c("perspective")},d=function(){return!!c("animation")};function c(t,i){var r=!1,s=t.charAt(0).toUpperCase()+t.slice(1);return e.each((t+" "+a.join(s+" ")+s).split(" "),function(e,t){if(n[t]!==o)return r=!i||t,!1}),r}function u(e){return c(e,!0)}(function(){return!!c("transition")})()&&(e.support.transition=new String(u("transition")),e.support.transition.end=r.transition.end[e.support.transition]),d()&&(e.support.animation=new String(u("animation")),e.support.animation.end=r.animation.end[e.support.animation]),s()&&(e.support.transform=new String(u("transform")),e.support.transform3d=l())}(window.Zepto||window.jQuery,window,document),function(e,t,i,o){var n=function(t){this._core=t,this._loaded=[],this._handlers={"initialized.owl.carousel change.owl.carousel resized.owl.carousel":e.proxy(function(t){if(t.namespace&&this._core.settings&&this._core.settings.lazyLoad&&(t.property&&"position"==t.property.name||"initialized"==t.type)){var i=this._core.settings,o=i.center&&Math.ceil(i.items/2)||i.items,n=i.center&&-1*o||0,a=(t.property&&void 0!==t.property.value?t.property.value:this._core.current())+n,r=this._core.clones().length,s=e.proxy(function(e,t){this.load(t)},this);for(i.lazyLoadEager>0&&(o+=i.lazyLoadEager,i.loop&&(a-=i.lazyLoadEager,o++));n++<o;)this.load(r/2+this._core.relative(a)),r&&e.each(this._core.clones(this._core.relative(a)),s),a++}},this)},this._core.options=e.extend({},n.Defaults,this._core.options),this._core.$element.on(this._handlers)};n.Defaults={lazyLoad:!1,lazyLoadEager:0},n.prototype.load=function(i){var o=this._core.$stage.children().eq(i),n=o&&o.find(".owl-lazy");!n||e.inArray(o.get(0),this._loaded)>-1||(n.each(e.proxy(function(i,o){var n,a=e(o),r=t.devicePixelRatio>1&&a.attr("data-src-retina")||a.attr("data-src")||a.attr("data-srcset");this._core.trigger("load",{element:a,url:r},"lazy"),a.is("img")?a.one("load.owl.lazy",e.proxy(function(){a.css("opacity",1),this._core.trigger("loaded",{element:a,url:r},"lazy")},this)).attr("src",r):a.is("source")?a.one("load.owl.lazy",e.proxy(function(){this._core.trigger("loaded",{element:a,url:r},"lazy")},this)).attr("srcset",r):((n=new Image).onload=e.proxy(function(){a.css({"background-image":'url("'+r+'")',opacity:"1"}),this._core.trigger("loaded",{element:a,url:r},"lazy")},this),n.src=r)},this)),this._loaded.push(o.get(0)))},n.prototype.destroy=function(){var e,t;for(e in this.handlers)this._core.$element.off(e,this.handlers[e]);for(t in Object.getOwnPropertyNames(this))"function"!=typeof this[t]&&(this[t]=null)},e.fn.owlCarousel.Constructor.Plugins.Lazy=n}(window.Zepto||window.jQuery,window,document),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(t){return e(t,window,document)}):"object"==typeof exports?module.exports=function(t,i){return t||(t=window),i||(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i,t,t.document)}:e(jQuery,window,document)}(function(e,t,i,o){"use strict";var n,a,r,s,l=function(t){this.$=function(e,t){return this.api(!0).$(e,t)},this._=function(e,t){return this.api(!0).rows(e,t).data()},this.api=function(e){return new a(e?rt(this[n.iApiIndex]):this)},this.fnAddData=function(t,i){var n=this.api(!0),a=e.isArray(t)&&(e.isArray(t[0])||e.isPlainObject(t[0]))?n.rows.add(t):n.row.add(t);return(i===o||i)&&n.draw(),a.flatten().toArray()},this.fnAdjustColumnSizing=function(e){var t=this.api(!0).columns.adjust(),i=t.settings()[0],n=i.oScroll;e===o||e?t.draw(!1):""===n.sX&&""===n.sY||Ue(i)},this.fnClearTable=function(e){var t=this.api(!0).clear();(e===o||e)&&t.draw()},this.fnClose=function(e){this.api(!0).row(e).child.hide()},this.fnDeleteRow=function(e,t,i){var n=this.api(!0),a=n.rows(e),r=a.settings()[0],s=r.aoData[a[0][0]];return a.remove(),t&&t.call(this,r,s),(i===o||i)&&n.draw(),s},this.fnDestroy=function(e){this.api(!0).destroy(e)},this.fnDraw=function(e){this.api(!0).draw(e)},this.fnFilter=function(e,t,i,n,a,r){var s=this.api(!0);null===t||t===o?s.search(e,i,n,r):s.column(t).search(e,i,n,r),s.draw()},this.fnGetData=function(e,t){var i=this.api(!0);if(e!==o){var n=e.nodeName?e.nodeName.toLowerCase():"";return t!==o||"td"==n||"th"==n?i.cell(e,t).data():i.row(e).data()||null}return i.data().toArray()},this.fnGetNodes=function(e){var t=this.api(!0);return e!==o?t.row(e).node():t.rows().nodes().flatten().toArray()},this.fnGetPosition=function(e){var t=this.api(!0),i=e.nodeName.toUpperCase();if("TR"==i)return t.row(e).index();if("TD"==i||"TH"==i){var o=t.cell(e).index();return[o.row,o.columnVisible,o.column]}return null},this.fnIsOpen=function(e){return this.api(!0).row(e).child.isShown()},this.fnOpen=function(e,t,i){return this.api(!0).row(e).child(t,i).show().child()[0]},this.fnPageChange=function(e,t){var i=this.api(!0).page(e);(t===o||t)&&i.draw(!1)},this.fnSetColumnVis=function(e,t,i){var n=this.api(!0).column(e).visible(t);(i===o||i)&&n.columns.adjust().draw()},this.fnSettings=function(){return rt(this[n.iApiIndex])},this.fnSort=function(e){this.api(!0).order(e).draw()},this.fnSortListener=function(e,t,i){this.api(!0).order.listener(e,t,i)},this.fnUpdate=function(e,t,i,n,a){var r=this.api(!0);return i===o||null===i?r.row(t).data(e):r.cell(t,i).data(e),(a===o||a)&&r.columns.adjust(),(n===o||n)&&r.draw(),0},this.fnVersionCheck=n.fnVersionCheck;var i=this,r=t===o,s=this.length;for(var d in r&&(t={}),this.oApi=this.internal=n.internal,l.ext.internal)d&&(this[d]=Dt(d));return this.each(function(){var n,a=s>1?dt({},t,!0):t,d=0,c=this.getAttribute("id"),u=!1,h=l.defaults,p=e(this);if("table"==this.nodeName.toLowerCase()){I(h),M(h.column),E(h,h,!0),E(h.column,h.column,!0),E(h,e.extend(a,p.data()));var f=l.settings;for(d=0,n=f.length;d<n;d++){var m=f[d];if(m.nTable==this||m.nTHead.parentNode==this||m.nTFoot&&m.nTFoot.parentNode==this){var g=a.bRetrieve!==o?a.bRetrieve:h.bRetrieve,v=a.bDestroy!==o?a.bDestroy:h.bDestroy;if(r||g)return m.oInstance;if(v){m.oInstance.fnDestroy();break}return void st(m,0,"Cannot reinitialise DataTable",3)}if(m.sTableId==this.id){f.splice(d,1);break}}null!==c&&""!==c||(c="DataTables_Table_"+l.ext._unique++,this.id=c);var b=e.extend(!0,{},l.models.oSettings,{sDestroyWidth:p[0].style.width,sInstance:c,sTableId:c});b.nTable=this,b.oApi=i.internal,b.oInit=a,f.push(b),b.oInstance=1===i.length?i:p.dataTable(),I(a),a.oLanguage&&A(a.oLanguage),a.aLengthMenu&&!a.iDisplayLength&&(a.iDisplayLength=e.isArray(a.aLengthMenu[0])?a.aLengthMenu[0][0]:a.aLengthMenu[0]),a=dt(e.extend(!0,{},h),a),lt(b.oFeatures,a,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),lt(b,a,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]),lt(b.oScroll,a,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),lt(b.oLanguage,a,"fnInfoCallback"),ut(b,"aoDrawCallback",a.fnDrawCallback,"user"),ut(b,"aoServerParams",a.fnServerParams,"user"),ut(b,"aoStateSaveParams",a.fnStateSaveParams,"user"),ut(b,"aoStateLoadParams",a.fnStateLoadParams,"user"),ut(b,"aoStateLoaded",a.fnStateLoaded,"user"),ut(b,"aoRowCallback",a.fnRowCallback,"user"),ut(b,"aoRowCreatedCallback",a.fnCreatedRow,"user"),ut(b,"aoHeaderCallback",a.fnHeaderCallback,"user"),ut(b,"aoFooterCallback",a.fnFooterCallback,"user"),ut(b,"aoInitComplete",a.fnInitComplete,"user"),ut(b,"aoPreDrawCallback",a.fnPreDrawCallback,"user"),b.rowIdFn=J(a.rowId),D(b);var y=b.oClasses;if(a.bJQueryUI?(e.extend(y,l.ext.oJUIClasses,a.oClasses),a.sDom===h.sDom&&"lfrtip"===h.sDom&&(b.sDom='<"H"lfr>t<"F"ip>'),b.renderer?e.isPlainObject(b.renderer)&&!b.renderer.header&&(b.renderer.header="jqueryui"):b.renderer="jqueryui"):e.extend(y,l.ext.classes,a.oClasses),p.addClass(y.sTable),b.iInitDisplayStart===o&&(b.iInitDisplayStart=a.iDisplayStart,b._iDisplayStart=a.iDisplayStart),null!==a.iDeferLoading){b.bDeferLoading=!0;var w=e.isArray(a.iDeferLoading);b._iRecordsDisplay=w?a.iDeferLoading[0]:a.iDeferLoading,b._iRecordsTotal=w?a.iDeferLoading[1]:a.iDeferLoading}var _=b.oLanguage;e.extend(!0,_,a.oLanguage),""!==_.sUrl&&(e.ajax({dataType:"json",url:_.sUrl,success:function(t){A(t),E(h.oLanguage,t),e.extend(!0,_,t),De(b)},error:function(){De(b)}}),u=!0),null===a.asStripeClasses&&(b.asStripeClasses=[y.sStripeOdd,y.sStripeEven]);var S=b.asStripeClasses,C=p.children("tbody").find("tr").eq(0);-1!==e.inArray(!0,e.map(S,function(e,t){return C.hasClass(e)}))&&(e("tbody tr",this).removeClass(S.join(" ")),b.asDestroyStripes=S.slice());var k,T=[],$=this.getElementsByTagName("thead");if(0!==$.length&&(ue(b.aoHeader,$[0]),T=he(b)),null===a.aoColumns)for(k=[],d=0,n=T.length;d<n;d++)k.push(null);else k=a.aoColumns;for(d=0,n=k.length;d<n;d++)P(b,T?T[d]:null);if(z(b,a.aoColumnDefs,k,function(e,t){R(b,e,t)}),C.length){var x=function(e,t){return null!==e.getAttribute("data-"+t)?t:null};e(C[0]).children("th, td").each(function(e,t){var i=b.aoColumns[e];if(i.mData===e){var n=x(t,"sort")||x(t,"order"),a=x(t,"filter")||x(t,"search");null===n&&null===a||(i.mData={_:e+".display",sort:null!==n?e+".@data-"+n:o,type:null!==n?e+".@data-"+n:o,filter:null!==a?e+".@data-"+a:o},R(b,e))}})}var L=b.oFeatures;if(a.bStateSave&&(L.bStateSave=!0,at(b,a),ut(b,"aoDrawCallback",nt,"state_save")),a.aaSorting===o){var O=b.aaSorting;for(d=0,n=O.length;d<n;d++)O[d][1]=b.aoColumns[d].asSorting[0]}it(b),L.bSort&&ut(b,"aoDrawCallback",function(){if(b.bSorted){var t=Je(b),i={};e.each(t,function(e,t){i[t.src]=t.dir}),ht(b,null,"order",[b,t,i]),Ze(b)}}),ut(b,"aoDrawCallback",function(){(b.bSorted||"ssp"===mt(b)||L.bDeferRender)&&it(b)},"sc");var N=p.children("caption").each(function(){this._captionSide=p.css("caption-side")}),B=p.children("thead");0===B.length&&(B=e("<thead/>").appendTo(this)),b.nTHead=B[0];var j=p.children("tbody");0===j.length&&(j=e("<tbody/>").appendTo(this)),b.nTBody=j[0];var F=p.children("tfoot");if(0===F.length&&N.length>0&&(""!==b.oScroll.sX||""!==b.oScroll.sY)&&(F=e("<tfoot/>").appendTo(this)),0===F.length||0===F.children().length?p.addClass(y.sNoFooter):F.length>0&&(b.nTFoot=F[0],ue(b.aoFooter,b.nTFoot)),a.aaData)for(d=0;d<a.aaData.length;d++)G(b,a.aaData[d]);else(b.bDeferLoading||"dom"==mt(b))&&V(b,e(b.nTBody).children("tr"));b.aiDisplay=b.aiDisplayMaster.slice(),b.bInitialised=!0,!1===u&&De(b)}else st(null,0,"Non-table node initialisation ("+this.nodeName+")",2)}),i=null,this},d={},c=/[\r\n]/g,u=/<.*?>/g,h=/^[\w\+\-]/,p=/[\w\+\-]$/,f=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),m=/[',$£€¥%\u2009\u202F\u20BD\u20a9\u20BArfk]/gi,g=function(e){return!e||!0===e||"-"===e},v=function(e){var t=parseInt(e,10);return!isNaN(t)&&isFinite(e)?t:null},b=function(e,t){return d[t]||(d[t]=new RegExp(ke(t),"g")),"string"==typeof e&&"."!==t?e.replace(/\./g,"").replace(d[t],"."):e},y=function(e,t,i){var o="string"==typeof e;return!!g(e)||(t&&o&&(e=b(e,t)),i&&o&&(e=e.replace(m,"")),!isNaN(parseFloat(e))&&isFinite(e))},w=function(e,t,i){return!!g(e)||(function(e){return g(e)||"string"==typeof e}(e)&&!!y(T(e),t,i)||null)},_=function(e,t,i){var n=[],a=0,r=e.length;if(i!==o)for(;a<r;a++)e[a]&&e[a][t]&&n.push(e[a][t][i]);else for(;a<r;a++)e[a]&&n.push(e[a][t]);return n},S=function(e,t,i,n){var a=[],r=0,s=t.length;if(n!==o)for(;r<s;r++)e[t[r]][i]&&a.push(e[t[r]][i][n]);else for(;r<s;r++)a.push(e[t[r]][i]);return a},C=function(e,t){var i,n=[];t===o?(t=0,i=e):(i=t,t=e);for(var a=t;a<i;a++)n.push(a);return n},k=function(e){for(var t=[],i=0,o=e.length;i<o;i++)e[i]&&t.push(e[i]);return t},T=function(e){return e.replace(u,"")},$=function(e){var t,i,o,n=[],a=e.length,r=0;e:for(i=0;i<a;i++){for(t=e[i],o=0;o<r;o++)if(n[o]===t)continue e;n.push(t),r++}return n};function x(t){var i,o,n={};e.each(t,function(e,a){(i=e.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(i[1]+" ")&&(o=e.replace(i[0],i[2].toLowerCase()),n[o]=e,"o"===i[1]&&x(t[e]))}),t._hungarianMap=n}function E(t,i,n){var a;t._hungarianMap||x(t),e.each(i,function(r,s){(a=t._hungarianMap[r])===o||!n&&i[a]!==o||("o"===a.charAt(0)?(i[a]||(i[a]={}),e.extend(!0,i[a],i[r]),E(t[a],i[a],n)):i[a]=i[r])})}function A(e){var t=l.defaults.oLanguage,i=e.sZeroRecords;!e.sEmptyTable&&i&&"No data available in table"===t.sEmptyTable&&lt(e,e,"sZeroRecords","sEmptyTable"),!e.sLoadingRecords&&i&&"Loading..."===t.sLoadingRecords&&lt(e,e,"sZeroRecords","sLoadingRecords"),e.sInfoThousands&&(e.sThousands=e.sInfoThousands);var o=e.sDecimal;o&&It(o)}l.util={throttle:function(e,t){var i,n,a=t!==o?t:200;return function(){var t=this,r=+new Date,s=arguments;i&&r<i+a?(clearTimeout(n),n=setTimeout(function(){i=o,e.apply(t,s)},a)):(i=r,e.apply(t,s))}},escapeRegex:function(e){return e.replace(f,"\\$1")}};var L=function(e,t,i){e[t]!==o&&(e[i]=e[t])};function I(e){L(e,"ordering","bSort"),L(e,"orderMulti","bSortMulti"),L(e,"orderClasses","bSortClasses"),L(e,"orderCellsTop","bSortCellsTop"),L(e,"order","aaSorting"),L(e,"orderFixed","aaSortingFixed"),L(e,"paging","bPaginate"),L(e,"pagingType","sPaginationType"),L(e,"pageLength","iDisplayLength"),L(e,"searching","bFilter"),"boolean"==typeof e.sScrollX&&(e.sScrollX=e.sScrollX?"100%":""),"boolean"==typeof e.scrollX&&(e.scrollX=e.scrollX?"100%":"");var t=e.aoSearchCols;if(t)for(var i=0,o=t.length;i<o;i++)t[i]&&E(l.models.oSearch,t[i])}function M(t){L(t,"orderable","bSortable"),L(t,"orderData","aDataSort"),L(t,"orderSequence","asSorting"),L(t,"orderDataType","sortDataType");var i=t.aDataSort;i&&!e.isArray(i)&&(t.aDataSort=[i])}function D(t){if(!l.__browser){var i={};l.__browser=i;var o=e("<div/>").css({position:"fixed",top:0,left:0,height:1,width:1,overflow:"hidden"}).append(e("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(e("<div/>").css({width:"100%",height:10}))).appendTo("body"),n=o.children(),a=n.children();i.barWidth=n[0].offsetWidth-n[0].clientWidth,i.bScrollOversize=100===a[0].offsetWidth&&100!==n[0].clientWidth,i.bScrollbarLeft=1!==Math.round(a.offset().left),i.bBounding=!!o[0].getBoundingClientRect().width,o.remove()}e.extend(t.oBrowser,l.__browser),t.oScroll.iBarWidth=l.__browser.barWidth}function O(e,t,i,n,a,r){var s,l=n,d=!1;for(i!==o&&(s=i,d=!0);l!==a;)e.hasOwnProperty(l)&&(s=d?t(s,e[l],l,e):e[l],d=!0,l+=r);return s}function P(t,o){var n=l.defaults.column,a=t.aoColumns.length,r=e.extend({},l.models.oColumn,n,{nTh:o||i.createElement("th"),sTitle:n.sTitle?n.sTitle:o?o.innerHTML:"",aDataSort:n.aDataSort?n.aDataSort:[a],mData:n.mData?n.mData:a,idx:a});t.aoColumns.push(r);var s=t.aoPreSearchCols;s[a]=e.extend({},l.models.oSearch,s[a]),R(t,a,e(o).data())}function R(t,i,n){var a=t.aoColumns[i],r=t.oClasses,s=e(a.nTh);if(!a.sWidthOrig){a.sWidthOrig=s.attr("width")||null;var d=(s.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);d&&(a.sWidthOrig=d[1])}n!==o&&null!==n&&(M(n),E(l.defaults.column,n),n.mDataProp===o||n.mData||(n.mData=n.mDataProp),n.sType&&(a._sManualType=n.sType),n.className&&!n.sClass&&(n.sClass=n.className),e.extend(a,n),lt(a,n,"sWidth","sWidthOrig"),n.iDataSort!==o&&(a.aDataSort=[n.iDataSort]),lt(a,n,"aDataSort"));var c=a.mData,u=J(c),h=a.mRender?J(a.mRender):null,p=function(e){return"string"==typeof e&&-1!==e.indexOf("@")};a._bAttrSrc=e.isPlainObject(c)&&(p(c.sort)||p(c.type)||p(c.filter)),a._setter=null,a.fnGetData=function(e,t,i){var n=u(e,t,o,i);return h&&t?h(n,t,e,i):n},a.fnSetData=function(e,t,i){return Q(c)(e,t,i)},"number"!=typeof c&&(t._rowReadObject=!0),t.oFeatures.bSort||(a.bSortable=!1,s.addClass(r.sSortableNone));var f=-1!==e.inArray("asc",a.asSorting),m=-1!==e.inArray("desc",a.asSorting);a.bSortable&&(f||m)?f&&!m?(a.sSortingClass=r.sSortableAsc,a.sSortingClassJUI=r.sSortJUIAscAllowed):!f&&m?(a.sSortingClass=r.sSortableDesc,a.sSortingClassJUI=r.sSortJUIDescAllowed):(a.sSortingClass=r.sSortable,a.sSortingClassJUI=r.sSortJUI):(a.sSortingClass=r.sSortableNone,a.sSortingClassJUI="")}function N(e){if(!1!==e.oFeatures.bAutoWidth){var t=e.aoColumns;Ve(e);for(var i=0,o=t.length;i<o;i++)t[i].nTh.style.width=t[i].sWidth}var n=e.oScroll;""===n.sY&&""===n.sX||Ue(e),ht(e,null,"column-sizing",[e])}function B(e,t){var i=H(e,"bVisible");return"number"==typeof i[t]?i[t]:null}function j(t,i){var o=H(t,"bVisible"),n=e.inArray(i,o);return-1!==n?n:null}function F(t){var i=0;return e.each(t.aoColumns,function(t,o){o.bVisible&&"none"!==e(o.nTh).css("display")&&i++}),i}function H(t,i){var o=[];return e.map(t.aoColumns,function(e,t){e[i]&&o.push(t)}),o}function U(e){var t,i,n,a,r,s,d,c,u,h=e.aoColumns,p=e.aoData,f=l.ext.type.detect;for(t=0,i=h.length;t<i;t++)if(u=[],!(d=h[t]).sType&&d._sManualType)d.sType=d._sManualType;else if(!d.sType){for(n=0,a=f.length;n<a;n++){for(r=0,s=p.length;r<s&&(u[r]===o&&(u[r]=W(e,r,t,"type")),(c=f[n](u[r],e))||n===f.length-1)&&"html"!==c;r++);if(c){d.sType=c;break}}d.sType||(d.sType="string")}}function z(t,i,n,a){var r,s,l,d,c,u,h,p=t.aoColumns;if(i)for(r=i.length-1;r>=0;r--){var f=(h=i[r]).targets!==o?h.targets:h.aTargets;for(e.isArray(f)||(f=[f]),l=0,d=f.length;l<d;l++)if("number"==typeof f[l]&&f[l]>=0){for(;p.length<=f[l];)P(t);a(f[l],h)}else if("number"==typeof f[l]&&f[l]<0)a(p.length+f[l],h);else if("string"==typeof f[l])for(c=0,u=p.length;c<u;c++)("_all"==f[l]||e(p[c].nTh).hasClass(f[l]))&&a(c,h)}if(n)for(r=0,s=n.length;r<s;r++)a(r,n[r])}function G(t,i,n,a){var r=t.aoData.length,s=e.extend(!0,{},l.models.oRow,{src:n?"dom":"data",idx:r});s._aData=i,t.aoData.push(s);for(var d=t.aoColumns,c=0,u=d.length;c<u;c++)d[c].sType=null;t.aiDisplayMaster.push(r);var h=t.rowIdFn(i);return h!==o&&(t.aIds[h]=s),!n&&t.oFeatures.bDeferRender||ne(t,r,n,a),r}function V(t,i){var o;return i instanceof e||(i=e(i)),i.map(function(e,i){return o=oe(t,i),G(t,o.data,i,o.cells)})}function W(e,t,i,n){var a=e.iDraw,r=e.aoColumns[i],s=e.aoData[t]._aData,l=r.sDefaultContent,d=r.fnGetData(s,n,{settings:e,row:t,col:i});if(d===o)return e.iDrawError!=a&&null===l&&(st(e,0,"Requested unknown parameter "+("function"==typeof r.mData?"{function}":"'"+r.mData+"'")+" for row "+t+", column "+i,4),e.iDrawError=a),l;if(d!==s&&null!==d||null===l||n===o){if("function"==typeof d)return d.call(s)}else d=l;return null===d&&"display"==n?"":d}function q(e,t,i,o){var n=e.aoColumns[i],a=e.aoData[t]._aData;n.fnSetData(a,o,{settings:e,row:t,col:i})}var Y=/\[.*?\]$/,X=/\(\)$/;function K(t){return e.map(t.match(/(\\.|[^\.])+/g)||[""],function(e){return e.replace(/\\./g,".")})}function J(t){if(e.isPlainObject(t)){var i={};return e.each(t,function(e,t){t&&(i[e]=J(t))}),function(e,t,n,a){var r=i[t]||i._;return r!==o?r(e,t,n,a):e}}if(null===t)return function(e){return e};if("function"==typeof t)return function(e,i,o,n){return t(e,i,o,n)};if("string"!=typeof t||-1===t.indexOf(".")&&-1===t.indexOf("[")&&-1===t.indexOf("("))return function(e,i){return e[t]};var n=function(t,i,a){var r,s,l,d;if(""!==a)for(var c=K(a),u=0,h=c.length;u<h;u++){if(r=c[u].match(Y),s=c[u].match(X),r){if(c[u]=c[u].replace(Y,""),""!==c[u]&&(t=t[c[u]]),l=[],c.splice(0,u+1),d=c.join("."),e.isArray(t))for(var p=0,f=t.length;p<f;p++)l.push(n(t[p],i,d));var m=r[0].substring(1,r[0].length-1);t=""===m?l:l.join(m);break}if(s)c[u]=c[u].replace(X,""),t=t[c[u]]();else{if(null===t||t[c[u]]===o)return o;t=t[c[u]]}}return t};return function(e,i){return n(e,i,t)}}function Q(t){if(e.isPlainObject(t))return Q(t._);if(null===t)return function(){};if("function"==typeof t)return function(e,i,o){t(e,"set",i,o)};if("string"!=typeof t||-1===t.indexOf(".")&&-1===t.indexOf("[")&&-1===t.indexOf("("))return function(e,i){e[t]=i};var i=function(t,n,a){for(var r,s,l,d,c,u=K(a),h=u[u.length-1],p=0,f=u.length-1;p<f;p++){if(s=u[p].match(Y),l=u[p].match(X),s){if(u[p]=u[p].replace(Y,""),t[u[p]]=[],(r=u.slice()).splice(0,p+1),c=r.join("."),e.isArray(n))for(var m=0,g=n.length;m<g;m++)i(d={},n[m],c),t[u[p]].push(d);else t[u[p]]=n;return}l&&(u[p]=u[p].replace(X,""),t=t[u[p]](n)),null!==t[u[p]]&&t[u[p]]!==o||(t[u[p]]={}),t=t[u[p]]}h.match(X)?t=t[h.replace(X,"")](n):t[h.replace(Y,"")]=n};return function(e,o){return i(e,o,t)}}function Z(e){return _(e.aoData,"_aData")}function ee(e){e.aoData.length=0,e.aiDisplayMaster.length=0,e.aiDisplay.length=0,e.aIds={}}function te(e,t,i){for(var n=-1,a=0,r=e.length;a<r;a++)e[a]==t?n=a:e[a]>t&&e[a]--;-1!=n&&i===o&&e.splice(n,1)}function ie(e,t,i,n){var a,r,s=e.aoData[t],l=function(i,o){for(;i.childNodes.length;)i.removeChild(i.firstChild);i.innerHTML=W(e,t,o,"display")};if("dom"!==i&&(i&&"auto"!==i||"dom"!==s.src)){var d=s.anCells;if(d)if(n!==o)l(d[n],n);else for(a=0,r=d.length;a<r;a++)l(d[a],a)}else s._aData=oe(e,s,n,n===o?o:s._aData).data;s._aSortData=null,s._aFilterData=null;var c=e.aoColumns;if(n!==o)c[n].sType=null;else{for(a=0,r=c.length;a<r;a++)c[a].sType=null;ae(e,s)}}function oe(t,i,n,a){var r,s,l,d=[],c=i.firstChild,u=0,h=t.aoColumns,p=t._rowReadObject;a=a!==o?a:p?{}:[];var f=function(e,t){if("string"==typeof e){var i=e.indexOf("@");if(-1!==i){var o=e.substring(i+1);Q(e)(a,t.getAttribute(o))}}},m=function(t){n!==o&&n!==u||(s=h[u],l=e.trim(t.innerHTML),s&&s._bAttrSrc?(Q(s.mData._)(a,l),f(s.mData.sort,t),f(s.mData.type,t),f(s.mData.filter,t)):p?(s._setter||(s._setter=Q(s.mData)),s._setter(a,l)):a[u]=l);u++};if(c)for(;c;)"TD"!=(r=c.nodeName.toUpperCase())&&"TH"!=r||(m(c),d.push(c)),c=c.nextSibling;else for(var g=0,v=(d=i.anCells).length;g<v;g++)m(d[g]);var b=i.firstChild?i:i.nTr;if(b){var y=b.getAttribute("id");y&&Q(t.rowId)(a,y)}return{data:a,cells:d}}function ne(t,o,n,a){var r,s,l,d,c,u=t.aoData[o],h=u._aData,p=[];if(null===u.nTr){for(r=n||i.createElement("tr"),u.nTr=r,u.anCells=p,r._DT_RowIndex=o,ae(t,u),d=0,c=t.aoColumns.length;d<c;d++)l=t.aoColumns[d],(s=n?a[d]:i.createElement(l.sCellType))._DT_CellIndex={row:o,column:d},p.push(s),n&&!l.mRender&&l.mData===d||e.isPlainObject(l.mData)&&l.mData._===d+".display"||(s.innerHTML=W(t,o,d,"display")),l.sClass&&(s.className+=" "+l.sClass),l.bVisible&&!n?r.appendChild(s):!l.bVisible&&n&&s.parentNode.removeChild(s),l.fnCreatedCell&&l.fnCreatedCell.call(t.oInstance,s,W(t,o,d),h,o,d);ht(t,"aoRowCreatedCallback",null,[r,h,o])}u.nTr.setAttribute("role","row")}function ae(t,i){var o=i.nTr,n=i._aData;if(o){var a=t.rowIdFn(n);if(a&&(o.id=a),n.DT_RowClass){var r=n.DT_RowClass.split(" ");i.__rowc=i.__rowc?$(i.__rowc.concat(r)):r,e(o).removeClass(i.__rowc.join(" ")).addClass(n.DT_RowClass)}n.DT_RowAttr&&e(o).attr(n.DT_RowAttr),n.DT_RowData&&e(o).data(n.DT_RowData)}}function re(t){var i,o,n,a,r,s=t.nTHead,l=t.nTFoot,d=0===e("th, td",s).length,c=t.oClasses,u=t.aoColumns;for(d&&(a=e("<tr/>").appendTo(s)),i=0,o=u.length;i<o;i++)r=u[i],n=e(r.nTh).addClass(r.sClass),d&&n.appendTo(a),t.oFeatures.bSort&&(n.addClass(r.sSortingClass),!1!==r.bSortable&&(n.attr("tabindex",t.iTabIndex).attr("aria-controls",t.sTableId),tt(t,r.nTh,i))),r.sTitle!=n[0].innerHTML&&n.html(r.sTitle),ft(t,"header")(t,n,r,c);if(d&&ue(t.aoHeader,s),e(s).find(">tr").attr("role","row"),e(s).find(">tr>th, >tr>td").addClass(c.sHeaderTH),e(l).find(">tr>th, >tr>td").addClass(c.sFooterTH),null!==l){var h=t.aoFooter[0];for(i=0,o=h.length;i<o;i++)(r=u[i]).nTf=h[i].cell,r.sClass&&e(r.nTf).addClass(r.sClass)}}function se(t,i,n){var a,r,s,l,d,c,u,h,p,f=[],m=[],g=t.aoColumns.length;if(i){for(n===o&&(n=!1),a=0,r=i.length;a<r;a++){for(f[a]=i[a].slice(),f[a].nTr=i[a].nTr,s=g-1;s>=0;s--)t.aoColumns[s].bVisible||n||f[a].splice(s,1);m.push([])}for(a=0,r=f.length;a<r;a++){if(u=f[a].nTr)for(;c=u.firstChild;)u.removeChild(c);for(s=0,l=f[a].length;s<l;s++)if(h=1,p=1,m[a][s]===o){for(u.appendChild(f[a][s].cell),m[a][s]=1;f[a+h]!==o&&f[a][s].cell==f[a+h][s].cell;)m[a+h][s]=1,h++;for(;f[a][s+p]!==o&&f[a][s].cell==f[a][s+p].cell;){for(d=0;d<h;d++)m[a+d][s+p]=1;p++}e(f[a][s].cell).attr("rowspan",h).attr("colspan",p)}}}}function le(t){var i=ht(t,"aoPreDrawCallback","preDraw",[t]);if(-1===e.inArray(!1,i)){var n=[],a=0,r=t.asStripeClasses,s=r.length,l=(t.aoOpenRows.length,t.oLanguage),d=t.iInitDisplayStart,c="ssp"==mt(t),u=t.aiDisplay;t.bDrawing=!0,d!==o&&-1!==d&&(t._iDisplayStart=c?d:d>=t.fnRecordsDisplay()?0:d,t.iInitDisplayStart=-1);var h=t._iDisplayStart,p=t.fnDisplayEnd();if(t.bDeferLoading)t.bDeferLoading=!1,t.iDraw++,Fe(t,!1);else if(c){if(!t.bDestroying&&!fe(t))return}else t.iDraw++;if(0!==u.length)for(var f=c?0:h,m=c?t.aoData.length:p,g=f;g<m;g++){var v=u[g],b=t.aoData[v];null===b.nTr&&ne(t,v);var y=b.nTr;if(0!==s){var w=r[a%s];b._sRowStripe!=w&&(e(y).removeClass(b._sRowStripe).addClass(w),b._sRowStripe=w)}ht(t,"aoRowCallback",null,[y,b._aData,a,g]),n.push(y),a++}else{var _=l.sZeroRecords;1==t.iDraw&&"ajax"==mt(t)?_=l.sLoadingRecords:l.sEmptyTable&&0===t.fnRecordsTotal()&&(_=l.sEmptyTable),n[0]=e("<tr/>",{class:s?r[0]:""}).append(e("<td />",{valign:"top",colSpan:F(t),class:t.oClasses.sRowEmpty}).html(_))[0]}ht(t,"aoHeaderCallback","header",[e(t.nTHead).children("tr")[0],Z(t),h,p,u]),ht(t,"aoFooterCallback","footer",[e(t.nTFoot).children("tr")[0],Z(t),h,p,u]);var S=e(t.nTBody);S.children().detach(),S.append(e(n)),ht(t,"aoDrawCallback","draw",[t]),t.bSorted=!1,t.bFiltered=!1,t.bDrawing=!1}else Fe(t,!1)}function de(e,t){var i=e.oFeatures,o=i.bSort,n=i.bFilter;o&&Qe(e),n?ye(e,e.oPreviousSearch):e.aiDisplay=e.aiDisplayMaster.slice(),!0!==t&&(e._iDisplayStart=0),e._drawHold=t,le(e),e._drawHold=!1}function ce(t){var i=t.oClasses,o=e(t.nTable),n=e("<div/>").insertBefore(o),a=t.oFeatures,r=e("<div/>",{id:t.sTableId+"_wrapper",class:i.sWrapper+(t.nTFoot?"":" "+i.sNoFooter)});t.nHolding=n[0],t.nTableWrapper=r[0],t.nTableReinsertBefore=t.nTable.nextSibling;for(var s,d,c,u,h,p,f=t.sDom.split(""),m=0;m<f.length;m++){if(s=null,"<"==(d=f[m])){if(c=e("<div/>")[0],"'"==(u=f[m+1])||'"'==u){for(h="",p=2;f[m+p]!=u;)h+=f[m+p],p++;if("H"==h?h=i.sJUIHeader:"F"==h&&(h=i.sJUIFooter),-1!=h.indexOf(".")){var g=h.split(".");c.id=g[0].substr(1,g[0].length-1),c.className=g[1]}else"#"==h.charAt(0)?c.id=h.substr(1,h.length-1):c.className=h;m+=p}r.append(c),r=e(c)}else if(">"==d)r=r.parent();else if("l"==d&&a.bPaginate&&a.bLengthChange)s=Re(t);else if("f"==d&&a.bFilter)s=be(t);else if("r"==d&&a.bProcessing)s=je(t);else if("t"==d)s=He(t);else if("i"==d&&a.bInfo)s=Le(t);else if("p"==d&&a.bPaginate)s=Ne(t);else if(0!==l.ext.feature.length)for(var v=l.ext.feature,b=0,y=v.length;b<y;b++)if(d==v[b].cFeature){s=v[b].fnInit(t);break}if(s){var w=t.aanFeatures;w[d]||(w[d]=[]),w[d].push(s),r.append(s)}}n.replaceWith(r),t.nHolding=null}function ue(t,i){var o,n,a,r,s,l,d,c,u,h,p,f=e(i).children("tr"),m=function(e,t,i){for(var o=e[t];o[i];)i++;return i};for(t.splice(0,t.length),a=0,l=f.length;a<l;a++)t.push([]);for(a=0,l=f.length;a<l;a++)for(c=0,n=(o=f[a]).firstChild;n;){if("TD"==n.nodeName.toUpperCase()||"TH"==n.nodeName.toUpperCase())for(u=1*n.getAttribute("colspan"),h=1*n.getAttribute("rowspan"),u=u&&0!==u&&1!==u?u:1,h=h&&0!==h&&1!==h?h:1,d=m(t,a,c),p=1===u,s=0;s<u;s++)for(r=0;r<h;r++)t[a+r][d+s]={cell:n,unique:p},t[a+r].nTr=o;n=n.nextSibling}}function he(e,t,i){var o=[];i||(i=e.aoHeader,t&&ue(i=[],t));for(var n=0,a=i.length;n<a;n++)for(var r=0,s=i[n].length;r<s;r++)!i[n][r].unique||o[r]&&e.bSortCellsTop||(o[r]=i[n][r].cell);return o}function pe(t,i,o){if(ht(t,"aoServerParams","serverParams",[i]),i&&e.isArray(i)){var n={},a=/(.*?)\[\]$/;e.each(i,function(e,t){var i=t.name.match(a);if(i){var o=i[0];n[o]||(n[o]=[]),n[o].push(t.value)}else n[t.name]=t.value}),i=n}var r,s=t.ajax,l=t.oInstance,d=function(e){ht(t,null,"xhr",[t,e,t.jqXHR]),o(e)};if(e.isPlainObject(s)&&s.data){r=s.data;var c=e.isFunction(r)?r(i,t):r;i=e.isFunction(r)&&c?c:e.extend(!0,i,c),delete s.data}var u={data:i,success:function(e){var i=e.error||e.sError;i&&st(t,0,i),t.json=e,d(e)},dataType:"json",cache:!1,type:t.sServerMethod,error:function(i,o,n){var a=ht(t,null,"xhr",[t,null,t.jqXHR]);-1===e.inArray(!0,a)&&("parsererror"==o?st(t,0,"Invalid JSON response",1):4===i.readyState&&st(t,0,"Ajax error",7)),Fe(t,!1)}};t.oAjaxData=i,ht(t,null,"preXhr",[t,i]),t.fnServerData?t.fnServerData.call(l,t.sAjaxSource,e.map(i,function(e,t){return{name:t,value:e}}),d,t):t.sAjaxSource||"string"==typeof s?t.jqXHR=e.ajax(e.extend(u,{url:s||t.sAjaxSource})):e.isFunction(s)?t.jqXHR=s.call(l,i,d,t):(t.jqXHR=e.ajax(e.extend(u,s)),s.data=r)}function fe(e){return!e.bAjaxDataGet||(e.iDraw++,Fe(e,!0),pe(e,me(e),function(t){ge(e,t)}),!1)}function me(t){var i,o,n,a,r=t.aoColumns,s=r.length,d=t.oFeatures,c=t.oPreviousSearch,u=t.aoPreSearchCols,h=[],p=Je(t),f=t._iDisplayStart,m=!1!==d.bPaginate?t._iDisplayLength:-1,g=function(e,t){h.push({name:e,value:t})};g("sEcho",t.iDraw),g("iColumns",s),g("sColumns",_(r,"sName").join(",")),g("iDisplayStart",f),g("iDisplayLength",m);var v={draw:t.iDraw,columns:[],order:[],start:f,length:m,search:{value:c.sSearch,regex:c.bRegex}};for(i=0;i<s;i++)n=r[i],a=u[i],o="function"==typeof n.mData?"function":n.mData,v.columns.push({data:o,name:n.sName,searchable:n.bSearchable,orderable:n.bSortable,search:{value:a.sSearch,regex:a.bRegex}}),g("mDataProp_"+i,o),d.bFilter&&(g("sSearch_"+i,a.sSearch),g("bRegex_"+i,a.bRegex),g("bSearchable_"+i,n.bSearchable)),d.bSort&&g("bSortable_"+i,n.bSortable);d.bFilter&&(g("sSearch",c.sSearch),g("bRegex",c.bRegex)),d.bSort&&(e.each(p,function(e,t){v.order.push({column:t.col,dir:t.dir}),g("iSortCol_"+e,t.col),g("sSortDir_"+e,t.dir)}),g("iSortingCols",p.length));var b=l.ext.legacy.ajax;return null===b?t.sAjaxSource?h:v:b?h:v}function ge(e,t){var i=function(e,i){return t[e]!==o?t[e]:t[i]},n=ve(e,t),a=i("sEcho","draw"),r=i("iTotalRecords","recordsTotal"),s=i("iTotalDisplayRecords","recordsFiltered");if(a){if(1*a<e.iDraw)return;e.iDraw=1*a}ee(e),e._iRecordsTotal=parseInt(r,10),e._iRecordsDisplay=parseInt(s,10);for(var l=0,d=n.length;l<d;l++)G(e,n[l]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,le(e),e._bInitComplete||Oe(e,t),e.bAjaxDataGet=!0,Fe(e,!1)}function ve(t,i){var n=e.isPlainObject(t.ajax)&&t.ajax.dataSrc!==o?t.ajax.dataSrc:t.sAjaxDataProp;return"data"===n?i.aaData||i[n]:""!==n?J(n)(i):i}function be(t){var o=t.oClasses,n=t.sTableId,a=t.oLanguage,r=t.oPreviousSearch,s=t.aanFeatures,l='<input type="search" class="'+o.sFilterInput+'"/>',d=a.sSearch;d=d.match(/_INPUT_/)?d.replace("_INPUT_",l):d+l;var c=e("<div/>",{id:s.f?null:n+"_filter",class:o.sFilter}).append(e("<label/>").append(d)),u=function(){s.f;var e=this.value?this.value:"";e!=r.sSearch&&(ye(t,{sSearch:e,bRegex:r.bRegex,bSmart:r.bSmart,bCaseInsensitive:r.bCaseInsensitive}),t._iDisplayStart=0,le(t))},h=null!==t.searchDelay?t.searchDelay:"ssp"===mt(t)?400:0,p=e("input",c).val(r.sSearch).attr("placeholder",a.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT",h?We(u,h):u).bind("keypress.DT",function(e){if(13==e.keyCode)return!1}).attr("aria-controls",n);return e(t.nTable).on("search.dt.DT",function(e,o){if(t===o)try{p[0]!==i.activeElement&&p.val(r.sSearch)}catch(e){}}),c[0]}function ye(e,t,i){var n=e.oPreviousSearch,a=e.aoPreSearchCols,r=function(e){n.sSearch=e.sSearch,n.bRegex=e.bRegex,n.bSmart=e.bSmart,n.bCaseInsensitive=e.bCaseInsensitive},s=function(e){return e.bEscapeRegex!==o?!e.bEscapeRegex:e.bRegex};if(U(e),"ssp"!=mt(e)){Se(e,t.sSearch,i,s(t),t.bSmart,t.bCaseInsensitive),r(t);for(var l=0;l<a.length;l++)_e(e,a[l].sSearch,l,s(a[l]),a[l].bSmart,a[l].bCaseInsensitive);we(e)}else r(t);e.bFiltered=!0,ht(e,null,"search",[e])}function we(t){for(var i,o,n=l.ext.search,a=t.aiDisplay,r=0,s=n.length;r<s;r++){for(var d=[],c=0,u=a.length;c<u;c++)o=a[c],i=t.aoData[o],n[r](t,i._aFilterData,o,i._aData,c)&&d.push(o);a.length=0,e.merge(a,d)}}function _e(e,t,i,o,n,a){if(""!==t)for(var r,s=e.aiDisplay,l=Ce(t,o,n,a),d=s.length-1;d>=0;d--)r=e.aoData[s[d]]._aFilterData[i],l.test(r)||s.splice(d,1)}function Se(e,t,i,o,n,a){var r,s,d,c=Ce(t,o,n,a),u=e.oPreviousSearch.sSearch,h=e.aiDisplayMaster;if(0!==l.ext.search.length&&(i=!0),s=xe(e),t.length<=0)e.aiDisplay=h.slice();else for((s||i||u.length>t.length||0!==t.indexOf(u)||e.bSorted)&&(e.aiDisplay=h.slice()),d=(r=e.aiDisplay).length-1;d>=0;d--)c.test(e.aoData[r[d]]._sFilterRow)||r.splice(d,1)}function Ce(t,i,o,n){(t=i?t:ke(t),o)&&(t="^(?=.*?"+e.map(t.match(/"[^"]+"|[^ ]+/g)||[""],function(e){if('"'===e.charAt(0)){var t=e.match(/^"(.*)"$/);e=t?t[1]:e}return e.replace('"',"")}).join(")(?=.*?")+").*$");return new RegExp(t,n?"i":"")}var ke=l.util.escapeRegex,Te=e("<div>")[0],$e=Te.textContent!==o;function xe(e){var t,i,o,n,a,r,s,d,c=e.aoColumns,u=l.ext.type.search,h=!1;for(i=0,n=e.aoData.length;i<n;i++)if(!(d=e.aoData[i])._aFilterData){for(r=[],o=0,a=c.length;o<a;o++)(t=c[o]).bSearchable?(s=W(e,i,o,"filter"),u[t.sType]&&(s=u[t.sType](s)),null===s&&(s=""),"string"!=typeof s&&s.toString&&(s=s.toString())):s="",s.indexOf&&-1!==s.indexOf("&")&&(Te.innerHTML=s,s=$e?Te.textContent:Te.innerText),s.replace&&(s=s.replace(/[\r\n]/g,"")),r.push(s);d._aFilterData=r,d._sFilterRow=r.join("  "),h=!0}return h}function Ee(e){return{search:e.sSearch,smart:e.bSmart,regex:e.bRegex,caseInsensitive:e.bCaseInsensitive}}function Ae(e){return{sSearch:e.search,bSmart:e.smart,bRegex:e.regex,bCaseInsensitive:e.caseInsensitive}}function Le(t){var i=t.sTableId,o=t.aanFeatures.i,n=e("<div/>",{class:t.oClasses.sInfo,id:o?null:i+"_info"});return o||(t.aoDrawCallback.push({fn:Ie,sName:"information"}),n.attr("role","status").attr("aria-live","polite"),e(t.nTable).attr("aria-describedby",i+"_info")),n[0]}function Ie(t){var i=t.aanFeatures.i;if(0!==i.length){var o=t.oLanguage,n=t._iDisplayStart+1,a=t.fnDisplayEnd(),r=t.fnRecordsTotal(),s=t.fnRecordsDisplay(),l=s?o.sInfo:o.sInfoEmpty;s!==r&&(l+=" "+o.sInfoFiltered),l=Me(t,l+=o.sInfoPostFix);var d=o.fnInfoCallback;null!==d&&(l=d.call(t.oInstance,t,n,a,r,s,l)),e(i).html(l)}}function Me(e,t){var i=e.fnFormatNumber,o=e._iDisplayStart+1,n=e._iDisplayLength,a=e.fnRecordsDisplay(),r=-1===n;return t.replace(/_START_/g,i.call(e,o)).replace(/_END_/g,i.call(e,e.fnDisplayEnd())).replace(/_MAX_/g,i.call(e,e.fnRecordsTotal())).replace(/_TOTAL_/g,i.call(e,a)).replace(/_PAGE_/g,i.call(e,r?1:Math.ceil(o/n))).replace(/_PAGES_/g,i.call(e,r?1:Math.ceil(a/n)))}function De(e){var t,i,o,n=e.iInitDisplayStart,a=e.aoColumns,r=e.oFeatures,s=e.bDeferLoading;if(e.bInitialised){for(ce(e),re(e),se(e,e.aoHeader),se(e,e.aoFooter),Fe(e,!0),r.bAutoWidth&&Ve(e),t=0,i=a.length;t<i;t++)(o=a[t]).sWidth&&(o.nTh.style.width=Ke(o.sWidth));ht(e,null,"preInit",[e]),de(e);var l=mt(e);("ssp"!=l||s)&&("ajax"==l?pe(e,[],function(i){var o=ve(e,i);for(t=0;t<o.length;t++)G(e,o[t]);e.iInitDisplayStart=n,de(e),Fe(e,!1),Oe(e,i)}):(Fe(e,!1),Oe(e)))}else setTimeout(function(){De(e)},200)}function Oe(e,t){e._bInitComplete=!0,(t||e.oInit.aaData)&&N(e),ht(e,null,"plugin-init",[e,t]),ht(e,"aoInitComplete","init",[e,t])}function Pe(e,t){var i=parseInt(t,10);e._iDisplayLength=i,pt(e),ht(e,null,"length",[e,i])}function Re(t){for(var i=t.oClasses,o=t.sTableId,n=t.aLengthMenu,a=e.isArray(n[0]),r=a?n[0]:n,s=a?n[1]:n,l=e("<select/>",{name:o+"_length","aria-controls":o,class:i.sLengthSelect}),d=0,c=r.length;d<c;d++)l[0][d]=new Option(s[d],r[d]);var u=e("<div><label/></div>").addClass(i.sLength);return t.aanFeatures.l||(u[0].id=o+"_length"),u.children().append(t.oLanguage.sLengthMenu.replace("_MENU_",l[0].outerHTML)),e("select",u).val(t._iDisplayLength).bind("change.DT",function(i){Pe(t,e(this).val()),le(t)}),e(t.nTable).bind("length.dt.DT",function(i,o,n){t===o&&e("select",u).val(n)}),u[0]}function Ne(t){var i=t.sPaginationType,o=l.ext.pager[i],n="function"==typeof o,a=function(e){le(e)},r=e("<div/>").addClass(t.oClasses.sPaging+i)[0],s=t.aanFeatures;return n||o.fnInit(t,r,a),s.p||(r.id=t.sTableId+"_paginate",t.aoDrawCallback.push({fn:function(e){if(n){var t,i,r=e._iDisplayStart,l=e._iDisplayLength,d=e.fnRecordsDisplay(),c=-1===l,u=c?0:Math.ceil(r/l),h=c?1:Math.ceil(d/l),p=o(u,h);for(t=0,i=s.p.length;t<i;t++)ft(e,"pageButton")(e,s.p[t],t,p,u,h)}else o.fnUpdate(e,a)},sName:"pagination"})),r}function Be(e,t,i){var o=e._iDisplayStart,n=e._iDisplayLength,a=e.fnRecordsDisplay();0===a||-1===n?o=0:"number"==typeof t?(o=t*n)>a&&(o=0):"first"==t?o=0:"previous"==t?(o=n>=0?o-n:0)<0&&(o=0):"next"==t?o+n<a&&(o+=n):"last"==t?o=Math.floor((a-1)/n)*n:st(e,0,"Unknown paging action: "+t,5);var r=e._iDisplayStart!==o;return e._iDisplayStart=o,r&&(ht(e,null,"page",[e]),i&&le(e)),r}function je(t){return e("<div/>",{id:t.aanFeatures.r?null:t.sTableId+"_processing",class:t.oClasses.sProcessing}).html(t.oLanguage.sProcessing).insertBefore(t.nTable)[0]}function Fe(t,i){t.oFeatures.bProcessing&&e(t.aanFeatures.r).css("display",i?"block":"none"),ht(t,null,"processing",[t,i])}function He(t){var i=e(t.nTable);i.attr("role","grid");var o=t.oScroll;if(""===o.sX&&""===o.sY)return t.nTable;var n=o.sX,a=o.sY,r=t.oClasses,s=i.children("caption"),l=s.length?s[0]._captionSide:null,d=e(i[0].cloneNode(!1)),c=e(i[0].cloneNode(!1)),u=i.children("tfoot"),h="<div/>",p=function(e){return e?Ke(e):null};u.length||(u=null);var f=e(h,{class:r.sScrollWrapper}).append(e(h,{class:r.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:n?p(n):"100%"}).append(e(h,{class:r.sScrollHeadInner}).css({"box-sizing":"content-box",width:o.sXInner||"100%"}).append(d.removeAttr("id").css("margin-left",0).append("top"===l?s:null).append(i.children("thead"))))).append(e(h,{class:r.sScrollBody}).css({position:"relative",overflow:"auto",width:p(n)}).append(i));u&&f.append(e(h,{class:r.sScrollFoot}).css({overflow:"hidden",border:0,width:n?p(n):"100%"}).append(e(h,{class:r.sScrollFootInner}).append(c.removeAttr("id").css("margin-left",0).append("bottom"===l?s:null).append(i.children("tfoot")))));var m=f.children(),g=m[0],v=m[1],b=u?m[2]:null;return n&&e(v).on("scroll.DT",function(e){var t=this.scrollLeft;g.scrollLeft=t,u&&(b.scrollLeft=t)}),e(v).css(a&&o.bCollapse?"max-height":"height",a),t.nScrollHead=g,t.nScrollBody=v,t.nScrollFoot=b,t.aoDrawCallback.push({fn:Ue,sName:"scrolling"}),f[0]}function Ue(t){var i,n,a,r,s,l,d,c,u,h=t.oScroll,p=h.sX,f=h.sXInner,m=h.sY,g=h.iBarWidth,v=e(t.nScrollHead),b=v[0].style,y=v.children("div"),w=y[0].style,S=y.children("table"),C=t.nScrollBody,k=e(C),T=C.style,$=e(t.nScrollFoot).children("div"),x=$.children("table"),E=e(t.nTHead),A=e(t.nTable),L=A[0],I=L.style,M=t.nTFoot?e(t.nTFoot):null,D=t.oBrowser,O=D.bScrollOversize,P=_(t.aoColumns,"nTh"),R=[],j=[],F=[],H=[],U=function(e){var t=e.style;t.paddingTop="0",t.paddingBottom="0",t.borderTopWidth="0",t.borderBottomWidth="0",t.height=0},z=C.scrollHeight>C.clientHeight;if(t.scrollBarVis!==z&&t.scrollBarVis!==o)return t.scrollBarVis=z,void N(t);t.scrollBarVis=z,A.children("thead, tfoot").remove(),M&&(l=M.clone().prependTo(A),n=M.find("tr"),r=l.find("tr")),s=E.clone().prependTo(A),i=E.find("tr"),a=s.find("tr"),s.find("th, td").removeAttr("tabindex"),p||(T.width="100%",v[0].style.width="100%"),e.each(he(t,s),function(e,i){d=B(t,e),i.style.width=t.aoColumns[d].sWidth}),M&&ze(function(e){e.style.width=""},r),u=A.outerWidth(),""===p?(I.width="100%",O&&(A.find("tbody").height()>C.offsetHeight||"scroll"==k.css("overflow-y"))&&(I.width=Ke(A.outerWidth()-g)),u=A.outerWidth()):""!==f&&(I.width=Ke(f),u=A.outerWidth()),ze(U,a),ze(function(t){F.push(t.innerHTML),R.push(Ke(e(t).css("width")))},a),ze(function(t,i){-1!==e.inArray(t,P)&&(t.style.width=R[i])},i),e(a).height(0),M&&(ze(U,r),ze(function(t){H.push(t.innerHTML),j.push(Ke(e(t).css("width")))},r),ze(function(e,t){e.style.width=j[t]},n),e(r).height(0)),ze(function(e,t){e.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+F[t]+"</div>",e.style.width=R[t]},a),M&&ze(function(e,t){e.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+H[t]+"</div>",e.style.width=j[t]},r),A.outerWidth()<u?(c=C.scrollHeight>C.offsetHeight||"scroll"==k.css("overflow-y")?u+g:u,O&&(C.scrollHeight>C.offsetHeight||"scroll"==k.css("overflow-y"))&&(I.width=Ke(c-g)),""!==p&&""===f||st(t,1,"Possible column misalignment",6)):c="100%",T.width=Ke(c),b.width=Ke(c),M&&(t.nScrollFoot.style.width=Ke(c)),m||O&&(T.height=Ke(L.offsetHeight+g));var G=A.outerWidth();S[0].style.width=Ke(G),w.width=Ke(G);var V=A.height()>C.clientHeight||"scroll"==k.css("overflow-y"),W="padding"+(D.bScrollbarLeft?"Left":"Right");w[W]=V?g+"px":"0px",M&&(x[0].style.width=Ke(G),$[0].style.width=Ke(G),$[0].style[W]=V?g+"px":"0px"),A.children("colgroup").insertBefore(A.children("thead")),k.scroll(),!t.bSorted&&!t.bFiltered||t._drawHold||(C.scrollTop=0)}function ze(e,t,i){for(var o,n,a=0,r=0,s=t.length;r<s;){for(o=t[r].firstChild,n=i?i[r].firstChild:null;o;)1===o.nodeType&&(i?e(o,n,a):e(o,a),a++),o=o.nextSibling,n=i?n.nextSibling:null;r++}}var Ge=/<.*?>/g;function Ve(i){var o,n,a,r=i.nTable,s=i.aoColumns,l=i.oScroll,d=l.sY,c=l.sX,u=l.sXInner,h=s.length,p=H(i,"bVisible"),f=e("th",i.nTHead),m=r.getAttribute("width"),g=r.parentNode,v=!1,b=i.oBrowser,y=b.bScrollOversize,w=r.style.width;for(w&&-1!==w.indexOf("%")&&(m=w),o=0;o<p.length;o++)null!==(n=s[p[o]]).sWidth&&(n.sWidth=qe(n.sWidthOrig,g),v=!0);if(y||!v&&!c&&!d&&h==F(i)&&h==f.length)for(o=0;o<h;o++){var _=B(i,o);null!==_&&(s[_].sWidth=Ke(f.eq(o).width()))}else{var S=e(r).clone().css("visibility","hidden").removeAttr("id");S.find("tbody tr").remove();var C=e("<tr/>").appendTo(S.find("tbody"));for(S.find("thead, tfoot").remove(),S.append(e(i.nTHead).clone()).append(e(i.nTFoot).clone()),S.find("tfoot th, tfoot td").css("width",""),f=he(i,S.find("thead")[0]),o=0;o<p.length;o++)n=s[p[o]],f[o].style.width=null!==n.sWidthOrig&&""!==n.sWidthOrig?Ke(n.sWidthOrig):"",n.sWidthOrig&&c&&e(f[o]).append(e("<div/>").css({width:n.sWidthOrig,margin:0,padding:0,border:0,height:1}));if(i.aoData.length)for(o=0;o<p.length;o++)n=s[a=p[o]],e(Ye(i,a)).clone(!1).append(n.sContentPadding).appendTo(C);e("[name]",S).removeAttr("name");var k=e("<div/>").css(c||d?{position:"absolute",top:0,left:0,height:1,right:0,overflow:"hidden"}:{}).append(S).appendTo(g);c&&u?S.width(u):c?(S.css("width","auto"),S.removeAttr("width"),S.width()<g.clientWidth&&m&&S.width(g.clientWidth)):d?S.width(g.clientWidth):m&&S.width(m);var T=0;for(o=0;o<p.length;o++){var $=e(f[o]),x=$.outerWidth()-$.width(),E=b.bBounding?Math.ceil(f[o].getBoundingClientRect().width):$.outerWidth();T+=E,s[p[o]].sWidth=Ke(E-x)}r.style.width=Ke(T),k.remove()}if(m&&(r.style.width=Ke(m)),(m||c)&&!i._reszEvt){var A=function(){e(t).bind("resize.DT-"+i.sInstance,We(function(){N(i)}))};y?setTimeout(A,1e3):A(),i._reszEvt=!0}}var We=l.util.throttle;function qe(t,o){if(!t)return 0;var n=e("<div/>").css("width",Ke(t)).appendTo(o||i.body),a=n[0].offsetWidth;return n.remove(),a}function Ye(t,i){var o=Xe(t,i);if(o<0)return null;var n=t.aoData[o];return n.nTr?n.anCells[i]:e("<td/>").html(W(t,o,i,"display"))[0]}function Xe(e,t){for(var i,o=-1,n=-1,a=0,r=e.aoData.length;a<r;a++)(i=(i=(i=W(e,a,t,"display")+"").replace(Ge,"")).replace(/&nbsp;/g," ")).length>o&&(o=i.length,n=a);return n}function Ke(e){return null===e?"0px":"number"==typeof e?e<0?"0px":e+"px":e.match(/\d$/)?e+"px":e}function Je(t){var i,n,a,r,s,d,c,u=[],h=t.aoColumns,p=t.aaSortingFixed,f=e.isPlainObject(p),m=[],g=function(t){t.length&&!e.isArray(t[0])?m.push(t):e.merge(m,t)};for(e.isArray(p)&&g(p),f&&p.pre&&g(p.pre),g(t.aaSorting),f&&p.post&&g(p.post),i=0;i<m.length;i++)for(n=0,a=(r=h[c=m[i][0]].aDataSort).length;n<a;n++)d=h[s=r[n]].sType||"string",m[i]._idx===o&&(m[i]._idx=e.inArray(m[i][1],h[s].asSorting)),u.push({src:c,col:s,dir:m[i][1],index:m[i]._idx,type:d,formatter:l.ext.type.order[d+"-pre"]});return u}function Qe(e){var t,i,o,n,a,r=[],s=l.ext.type.order,d=e.aoData,c=(e.aoColumns,0),u=e.aiDisplayMaster;for(U(e),t=0,i=(a=Je(e)).length;t<i;t++)(n=a[t]).formatter&&c++,ot(e,n.col);if("ssp"!=mt(e)&&0!==a.length){for(t=0,o=u.length;t<o;t++)r[u[t]]=t;c===a.length?u.sort(function(e,t){var i,o,n,s,l,c=a.length,u=d[e]._aSortData,h=d[t]._aSortData;for(n=0;n<c;n++)if(0!==(s=(i=u[(l=a[n]).col])<(o=h[l.col])?-1:i>o?1:0))return"asc"===l.dir?s:-s;return(i=r[e])<(o=r[t])?-1:i>o?1:0}):u.sort(function(e,t){var i,o,n,l,c,u=a.length,h=d[e]._aSortData,p=d[t]._aSortData;for(n=0;n<u;n++)if(i=h[(c=a[n]).col],o=p[c.col],0!==(l=(s[c.type+"-"+c.dir]||s["string-"+c.dir])(i,o)))return l;return(i=r[e])<(o=r[t])?-1:i>o?1:0})}e.bSorted=!0}function Ze(e){for(var t,i,o=e.aoColumns,n=Je(e),a=e.oLanguage.oAria,r=0,s=o.length;r<s;r++){var l=o[r],d=l.asSorting,c=l.sTitle.replace(/<.*?>/g,""),u=l.nTh;u.removeAttribute("aria-sort"),l.bSortable?(n.length>0&&n[0].col==r?(u.setAttribute("aria-sort","asc"==n[0].dir?"ascending":"descending"),i=d[n[0].index+1]||d[0]):i=d[0],t=c+("asc"===i?a.sSortAscending:a.sSortDescending)):t=c,u.setAttribute("aria-label",t)}}function et(t,i,n,a){var r,s=t.aoColumns[i],l=t.aaSorting,d=s.asSorting,c=function(t,i){var n=t._idx;return n===o&&(n=e.inArray(t[1],d)),n+1<d.length?n+1:i?null:0};if("number"==typeof l[0]&&(l=t.aaSorting=[l]),n&&t.oFeatures.bSortMulti){var u=e.inArray(i,_(l,"0"));-1!==u?(null===(r=c(l[u],!0))&&1===l.length&&(r=0),null===r?l.splice(u,1):(l[u][1]=d[r],l[u]._idx=r)):(l.push([i,d[0],0]),l[l.length-1]._idx=0)}else l.length&&l[0][0]==i?(r=c(l[0]),l.length=1,l[0][1]=d[r],l[0]._idx=r):(l.length=0,l.push([i,d[0]]),l[0]._idx=0);de(t),"function"==typeof a&&a(t)}function tt(e,t,i,o){var n=e.aoColumns[i];ct(t,{},function(t){!1!==n.bSortable&&(e.oFeatures.bProcessing?(Fe(e,!0),setTimeout(function(){et(e,i,t.shiftKey,o),"ssp"!==mt(e)&&Fe(e,!1)},0)):et(e,i,t.shiftKey,o))})}function it(t){var i,o,n,a=t.aLastSort,r=t.oClasses.sSortColumn,s=Je(t),l=t.oFeatures;if(l.bSort&&l.bSortClasses){for(i=0,o=a.length;i<o;i++)n=a[i].src,e(_(t.aoData,"anCells",n)).removeClass(r+(i<2?i+1:3));for(i=0,o=s.length;i<o;i++)n=s[i].src,e(_(t.aoData,"anCells",n)).addClass(r+(i<2?i+1:3))}t.aLastSort=s}function ot(e,t){var i,o,n,a=e.aoColumns[t],r=l.ext.order[a.sSortDataType];r&&(i=r.call(e.oInstance,e,t,j(e,t)));for(var s=l.ext.type.order[a.sType+"-pre"],d=0,c=e.aoData.length;d<c;d++)(o=e.aoData[d])._aSortData||(o._aSortData=[]),o._aSortData[t]&&!r||(n=r?i[d]:W(e,d,t,"sort"),o._aSortData[t]=s?s(n):n)}function nt(t){if(t.oFeatures.bStateSave&&!t.bDestroying){var i={time:+new Date,start:t._iDisplayStart,length:t._iDisplayLength,order:e.extend(!0,[],t.aaSorting),search:Ee(t.oPreviousSearch),columns:e.map(t.aoColumns,function(e,i){return{visible:e.bVisible,search:Ee(t.aoPreSearchCols[i])}})};ht(t,"aoStateSaveParams","stateSaveParams",[t,i]),t.oSavedState=i,t.fnStateSaveCallback.call(t.oInstance,t,i)}}function at(t,i){var n,a,r=t.aoColumns;if(t.oFeatures.bStateSave){var s=t.fnStateLoadCallback.call(t.oInstance,t);if(s&&s.time){var l=ht(t,"aoStateLoadParams","stateLoadParams",[t,s]);if(-1===e.inArray(!1,l)){var d=t.iStateDuration;if(!(d>0&&s.time<+new Date-1e3*d)&&r.length===s.columns.length){for(t.oLoadedState=e.extend(!0,{},s),s.start!==o&&(t._iDisplayStart=s.start,t.iInitDisplayStart=s.start),s.length!==o&&(t._iDisplayLength=s.length),s.order!==o&&(t.aaSorting=[],e.each(s.order,function(e,i){t.aaSorting.push(i[0]>=r.length?[0,i[1]]:i)})),s.search!==o&&e.extend(t.oPreviousSearch,Ae(s.search)),n=0,a=s.columns.length;n<a;n++){var c=s.columns[n];c.visible!==o&&(r[n].bVisible=c.visible),c.search!==o&&e.extend(t.aoPreSearchCols[n],Ae(c.search))}ht(t,"aoStateLoaded","stateLoaded",[t,s])}}}}}function rt(t){var i=l.settings,o=e.inArray(t,_(i,"nTable"));return-1!==o?i[o]:null}function st(e,i,o,n){if(o="DataTables warning: "+(e?"table id="+e.sTableId+" - ":"")+o,n&&(o+=". For more information about this error, please see http://datatables.net/tn/"+n),i)t.console&&console.log&&console.log(o);else{var a=l.ext,r=a.sErrMode||a.errMode;if(e&&ht(e,null,"error",[e,n,o]),"alert"==r)alert(o);else{if("throw"==r)throw new Error(o);"function"==typeof r&&r(e,n,o)}}}function lt(t,i,n,a){e.isArray(n)?e.each(n,function(o,n){e.isArray(n)?lt(t,i,n[0],n[1]):lt(t,i,n)}):(a===o&&(a=n),i[n]!==o&&(t[a]=i[n]))}function dt(t,i,o){var n;for(var a in i)i.hasOwnProperty(a)&&(n=i[a],e.isPlainObject(n)?(e.isPlainObject(t[a])||(t[a]={}),e.extend(!0,t[a],n)):o&&"data"!==a&&"aaData"!==a&&e.isArray(n)?t[a]=n.slice():t[a]=n);return t}function ct(t,i,o){e(t).bind("click.DT",i,function(e){t.blur(),o(e)}).bind("keypress.DT",i,function(e){13===e.which&&(e.preventDefault(),o(e))}).bind("selectstart.DT",function(){return!1})}function ut(e,t,i,o){i&&e[t].push({fn:i,sName:o})}function ht(t,i,o,n){var a=[];if(i&&(a=e.map(t[i].slice().reverse(),function(e,i){return e.fn.apply(t.oInstance,n)})),null!==o){var r=e.Event(o+".dt");e(t.nTable).trigger(r,n),a.push(r.result)}return a}function pt(e){var t=e._iDisplayStart,i=e.fnDisplayEnd(),o=e._iDisplayLength;t>=i&&(t=i-o),t-=t%o,(-1===o||t<0)&&(t=0),e._iDisplayStart=t}function ft(t,i){var o=t.renderer,n=l.ext.renderer[i];return e.isPlainObject(o)&&o[i]?n[o[i]]||n._:"string"==typeof o&&n[o]||n._}function mt(e){return e.oFeatures.bServerSide?"ssp":e.ajax||e.sAjaxSource?"ajax":"dom"}var gt=[],vt=Array.prototype;a=function(t,i){if(!(this instanceof a))return new a(t,i);var o=[],n=function(t){var i=function(t){var i,o,n=l.settings,a=e.map(n,function(e,t){return e.nTable});return t?t.nTable&&t.oApi?[t]:t.nodeName&&"table"===t.nodeName.toLowerCase()?-1!==(i=e.inArray(t,a))?[n[i]]:null:t&&"function"==typeof t.settings?t.settings().toArray():("string"==typeof t?o=e(t):t instanceof e&&(o=t),o?o.map(function(t){return-1!==(i=e.inArray(this,a))?n[i]:null}).toArray():void 0):[]}(t);i&&(o=o.concat(i))};if(e.isArray(t))for(var r=0,s=t.length;r<s;r++)n(t[r]);else n(t);this.context=$(o),i&&e.merge(this,i),this.selector={rows:null,cols:null,opts:null},a.extend(this,this,gt)},l.Api=a,e.extend(a.prototype,{any:function(){return 0!==this.count()},concat:vt.concat,context:[],count:function(){return this.flatten().length},each:function(e){for(var t=0,i=this.length;t<i;t++)e.call(this,this[t],t,this);return this},eq:function(e){var t=this.context;return t.length>e?new a(t[e],this[e]):null},filter:function(e){var t=[];if(vt.filter)t=vt.filter.call(this,e,this);else for(var i=0,o=this.length;i<o;i++)e.call(this,this[i],i,this)&&t.push(this[i]);return new a(this.context,t)},flatten:function(){var e=[];return new a(this.context,e.concat.apply(e,this.toArray()))},join:vt.join,indexOf:vt.indexOf||function(e,t){for(var i=t||0,o=this.length;i<o;i++)if(this[i]===e)return i;return-1},iterator:function(e,t,i,n){var r,s,l,d,c,u,h,p,f=[],m=this.context,g=this.selector;for("string"==typeof e&&(n=i,i=t,t=e,e=!1),s=0,l=m.length;s<l;s++){var v=new a(m[s]);if("table"===t)(r=i.call(v,m[s],s))!==o&&f.push(r);else if("columns"===t||"rows"===t)(r=i.call(v,m[s],this[s],s))!==o&&f.push(r);else if("column"===t||"column-rows"===t||"row"===t||"cell"===t)for(h=this[s],"column-rows"===t&&(u=St(m[s],g.opts)),d=0,c=h.length;d<c;d++)p=h[d],(r="cell"===t?i.call(v,m[s],p.row,p.column,s,d):i.call(v,m[s],p,s,d,u))!==o&&f.push(r)}if(f.length||n){var b=new a(m,e?f.concat.apply([],f):f),y=b.selector;return y.rows=g.rows,y.cols=g.cols,y.opts=g.opts,b}return this},lastIndexOf:vt.lastIndexOf||function(e,t){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(e){var t=[];if(vt.map)t=vt.map.call(this,e,this);else for(var i=0,o=this.length;i<o;i++)t.push(e.call(this,this[i],i));return new a(this.context,t)},pluck:function(e){return this.map(function(t){return t[e]})},pop:vt.pop,push:vt.push,reduce:vt.reduce||function(e,t){return O(this,e,t,0,this.length,1)},reduceRight:vt.reduceRight||function(e,t){return O(this,e,t,this.length-1,-1,-1)},reverse:vt.reverse,selector:null,shift:vt.shift,sort:vt.sort,splice:vt.splice,toArray:function(){return vt.slice.call(this)},to$:function(){return e(this)},toJQuery:function(){return e(this)},unique:function(){return new a(this.context,$(this))},unshift:vt.unshift}),a.extend=function(t,i,o){if(o.length&&i&&(i instanceof a||i.__dt_wrapper)){var n,r,s,l=function(e,t,i){return function(){var o=t.apply(e,arguments);return a.extend(o,o,i.methodExt),o}};for(n=0,r=o.length;n<r;n++)i[(s=o[n]).name]="function"==typeof s.val?l(t,s.val,s):e.isPlainObject(s.val)?{}:s.val,i[s.name].__dt_wrapper=!0,a.extend(t,i[s.name],s.propExt)}},a.register=r=function(t,i){if(e.isArray(t))for(var o=0,n=t.length;o<n;o++)a.register(t[o],i);else{var r,s,l,d,c=t.split("."),u=gt,h=function(e,t){for(var i=0,o=e.length;i<o;i++)if(e[i].name===t)return e[i];return null};for(r=0,s=c.length;r<s;r++){var p=h(u,l=(d=-1!==c[r].indexOf("()"))?c[r].replace("()",""):c[r]);p||(p={name:l,val:{},methodExt:[],propExt:[]},u.push(p)),r===s-1?p.val=i:u=d?p.methodExt:p.propExt}}},a.registerPlural=s=function(t,i,n){a.register(t,n),a.register(i,function(){var t=n.apply(this,arguments);return t===this?this:t instanceof a?t.length?e.isArray(t[0])?new a(t.context,t[0]):t[0]:o:t})};r("tables()",function(t){return t?new a(function(t,i){if("number"==typeof t)return[i[t]];var o=e.map(i,function(e,t){return e.nTable});return e(o).filter(t).map(function(t){var n=e.inArray(this,o);return i[n]}).toArray()}(t,this.context)):this}),r("table()",function(e){var t=this.tables(e),i=t.context;return i.length?new a(i[0]):t}),s("tables().nodes()","table().node()",function(){return this.iterator("table",function(e){return e.nTable},1)}),s("tables().body()","table().body()",function(){return this.iterator("table",function(e){return e.nTBody},1)}),s("tables().header()","table().header()",function(){return this.iterator("table",function(e){return e.nTHead},1)}),s("tables().footer()","table().footer()",function(){return this.iterator("table",function(e){return e.nTFoot},1)}),s("tables().containers()","table().container()",function(){return this.iterator("table",function(e){return e.nTableWrapper},1)}),r("draw()",function(e){return this.iterator("table",function(t){"page"===e?le(t):("string"==typeof e&&(e="full-hold"!==e),de(t,!1===e))})}),r("page()",function(e){return e===o?this.page.info().page:this.iterator("table",function(t){Be(t,e)})}),r("page.info()",function(e){if(0===this.context.length)return o;var t=this.context[0],i=t._iDisplayStart,n=t.oFeatures.bPaginate?t._iDisplayLength:-1,a=t.fnRecordsDisplay(),r=-1===n;return{page:r?0:Math.floor(i/n),pages:r?1:Math.ceil(a/n),start:i,end:t.fnDisplayEnd(),length:n,recordsTotal:t.fnRecordsTotal(),recordsDisplay:a,serverSide:"ssp"===mt(t)}}),r("page.len()",function(e){return e===o?0!==this.context.length?this.context[0]._iDisplayLength:o:this.iterator("table",function(t){Pe(t,e)})});var bt=function(e,t,i){if(i){var o=new a(e);o.one("draw",function(){i(o.ajax.json())})}if("ssp"==mt(e))de(e,t);else{Fe(e,!0);var n=e.jqXHR;n&&4!==n.readyState&&n.abort(),pe(e,[],function(i){ee(e);for(var o=ve(e,i),n=0,a=o.length;n<a;n++)G(e,o[n]);de(e,t),Fe(e,!1)})}};r("ajax.json()",function(){var e=this.context;if(e.length>0)return e[0].json}),r("ajax.params()",function(){var e=this.context;if(e.length>0)return e[0].oAjaxData}),r("ajax.reload()",function(e,t){return this.iterator("table",function(i){bt(i,!1===t,e)})}),r("ajax.url()",function(t){var i=this.context;return t===o?0===i.length?o:(i=i[0]).ajax?e.isPlainObject(i.ajax)?i.ajax.url:i.ajax:i.sAjaxSource:this.iterator("table",function(i){e.isPlainObject(i.ajax)?i.ajax.url=t:i.ajax=t})}),r("ajax.url().load()",function(e,t){return this.iterator("table",function(i){bt(i,!1===t,e)})});var yt=function(t,i,a,r,s){var l,d,c,u,h,p,f=[],m=typeof i;for(i&&"string"!==m&&"function"!==m&&i.length!==o||(i=[i]),c=0,u=i.length;c<u;c++)for(h=0,p=(d=i[c]&&i[c].split?i[c].split(","):[i[c]]).length;h<p;h++)(l=a("string"==typeof d[h]?e.trim(d[h]):d[h]))&&l.length&&(f=f.concat(l));var g=n.selector[t];if(g.length)for(c=0,u=g.length;c<u;c++)f=g[c](r,s,f);return $(f)},wt=function(t){return t||(t={}),t.filter&&t.search===o&&(t.search=t.filter),e.extend({search:"none",order:"current",page:"all"},t)},_t=function(e){for(var t=0,i=e.length;t<i;t++)if(e[t].length>0)return e[0]=e[t],e[0].length=1,e.length=1,e.context=[e.context[t]],e;return e.length=0,e},St=function(t,i){var o,n,a,r=[],s=t.aiDisplay,l=t.aiDisplayMaster,d=i.search,c=i.order,u=i.page;if("ssp"==mt(t))return"removed"===d?[]:C(0,l.length);if("current"==u)for(o=t._iDisplayStart,n=t.fnDisplayEnd();o<n;o++)r.push(s[o]);else if("current"==c||"applied"==c)r="none"==d?l.slice():"applied"==d?s.slice():e.map(l,function(t,i){return-1===e.inArray(t,s)?t:null});else if("index"==c||"original"==c)for(o=0,n=t.aoData.length;o<n;o++)"none"==d?r.push(o):(-1===(a=e.inArray(o,s))&&"removed"==d||a>=0&&"applied"==d)&&r.push(o);return r};r("rows()",function(t,i){t===o?t="":e.isPlainObject(t)&&(i=t,t=""),i=wt(i);var n=this.iterator("table",function(n){return function(t,i,n){return yt("row",i,function(i){var a=v(i);if(null!==a&&!n)return[a];var r=St(t,n);if(null!==a&&-1!==e.inArray(a,r))return[a];if(!i)return r;if("function"==typeof i)return e.map(r,function(e){var o=t.aoData[e];return i(e,o._aData,o.nTr)?e:null});var s=k(S(t.aoData,r,"nTr"));if(i.nodeName){if(i._DT_RowIndex!==o)return[i._DT_RowIndex];if(i._DT_CellIndex)return[i._DT_CellIndex.row];var l=e(i).closest("*[data-dt-row]");return l.length?[l.data("dt-row")]:[]}if("string"==typeof i&&"#"===i.charAt(0)){var d=t.aIds[i.replace(/^#/,"")];if(d!==o)return[d.idx]}return e(s).filter(i).map(function(){return this._DT_RowIndex}).toArray()},t,n)}(n,t,i)},1);return n.selector.rows=t,n.selector.opts=i,n}),r("rows().nodes()",function(){return this.iterator("row",function(e,t){return e.aoData[t].nTr||o},1)}),r("rows().data()",function(){return this.iterator(!0,"rows",function(e,t){return S(e.aoData,t,"_aData")},1)}),s("rows().cache()","row().cache()",function(e){return this.iterator("row",function(t,i){var o=t.aoData[i];return"search"===e?o._aFilterData:o._aSortData},1)}),s("rows().invalidate()","row().invalidate()",function(e){return this.iterator("row",function(t,i){ie(t,i,e)})}),s("rows().indexes()","row().index()",function(){return this.iterator("row",function(e,t){return t},1)}),s("rows().ids()","row().id()",function(e){for(var t=[],i=this.context,o=0,n=i.length;o<n;o++)for(var r=0,s=this[o].length;r<s;r++){var l=i[o].rowIdFn(i[o].aoData[this[o][r]]._aData);t.push((!0===e?"#":"")+l)}return new a(i,t)}),s("rows().remove()","row().remove()",function(){var e=this;return this.iterator("row",function(t,i,n){var a,r,s,l,d,c,u=t.aoData,h=u[i];for(u.splice(i,1),a=0,r=u.length;a<r;a++)if(c=(d=u[a]).anCells,null!==d.nTr&&(d.nTr._DT_RowIndex=a),null!==c)for(s=0,l=c.length;s<l;s++)c[s]._DT_CellIndex.row=a;te(t.aiDisplayMaster,i),te(t.aiDisplay,i),te(e[n],i,!1),pt(t);var p=t.rowIdFn(h._aData);p!==o&&delete t.aIds[p]}),this.iterator("table",function(e){for(var t=0,i=e.aoData.length;t<i;t++)e.aoData[t].idx=t}),this}),r("rows.add()",function(t){var i=this.iterator("table",function(e){var i,o,n,a=[];for(o=0,n=t.length;o<n;o++)(i=t[o]).nodeName&&"TR"===i.nodeName.toUpperCase()?a.push(V(e,i)[0]):a.push(G(e,i));return a},1),o=this.rows(-1);return o.pop(),e.merge(o,i),o}),r("row()",function(e,t){return _t(this.rows(e,t))}),r("row().data()",function(e){var t=this.context;return e===o?t.length&&this.length?t[0].aoData[this[0]]._aData:o:(t[0].aoData[this[0]]._aData=e,ie(t[0],this[0],"data"),this)}),r("row().node()",function(){var e=this.context;return e.length&&this.length&&e[0].aoData[this[0]].nTr||null}),r("row.add()",function(t){t instanceof e&&t.length&&(t=t[0]);var i=this.iterator("table",function(e){return t.nodeName&&"TR"===t.nodeName.toUpperCase()?V(e,t)[0]:G(e,t)});return this.row(i[0])});var Ct=function(e,t){var i=e.context;if(i.length){var n=i[0].aoData[t!==o?t:e[0]];n&&n._details&&(n._details.remove(),n._detailsShow=o,n._details=o)}},kt=function(e,t){var i=e.context;if(i.length&&e.length){var o=i[0].aoData[e[0]];o._details&&(o._detailsShow=t,t?o._details.insertAfter(o.nTr):o._details.detach(),Tt(i[0]))}},Tt=function(e){var t=new a(e),i=e.aoData;t.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details"),_(i,"_details").length>0&&(t.on("draw.dt.DT_details",function(o,n){e===n&&t.rows({page:"current"}).eq(0).each(function(e){var t=i[e];t._detailsShow&&t._details.insertAfter(t.nTr)})}),t.on("column-visibility.dt.DT_details",function(t,o,n,a){if(e===o)for(var r,s=F(o),l=0,d=i.length;l<d;l++)(r=i[l])._details&&r._details.children("td[colspan]").attr("colspan",s)}),t.on("destroy.dt.DT_details",function(o,n){if(e===n)for(var a=0,r=i.length;a<r;a++)i[a]._details&&Ct(t,a)}))};r("row().child()",function(t,i){var n=this.context;return t===o?n.length&&this.length?n[0].aoData[this[0]]._details:o:(!0===t?this.child.show():!1===t?Ct(this):n.length&&this.length&&function(t,i,o,n){var a=[],r=function(i,o){if(e.isArray(i)||i instanceof e)for(var n=0,s=i.length;n<s;n++)r(i[n],o);else if(i.nodeName&&"tr"===i.nodeName.toLowerCase())a.push(i);else{var l=e("<tr><td/></tr>").addClass(o);e("td",l).addClass(o).html(i)[0].colSpan=F(t),a.push(l[0])}};r(o,n),i._details&&i._details.remove(),i._details=e(a),i._detailsShow&&i._details.insertAfter(i.nTr)}(n[0],n[0].aoData[this[0]],t,i),this)}),r(["row().child.show()","row().child().show()"],function(e){return kt(this,!0),this}),r(["row().child.hide()","row().child().hide()"],function(){return kt(this,!1),this}),r(["row().child.remove()","row().child().remove()"],function(){return Ct(this),this}),r("row().child.isShown()",function(){var e=this.context;return e.length&&this.length&&e[0].aoData[this[0]]._detailsShow||!1});var $t=/^(.+):(name|visIdx|visible)$/,xt=function(e,t,i,o,n){for(var a=[],r=0,s=n.length;r<s;r++)a.push(W(e,n[r],t));return a};r("columns()",function(t,i){t===o?t="":e.isPlainObject(t)&&(i=t,t=""),i=wt(i);var n=this.iterator("table",function(o){return function(t,i,o){var n=t.aoColumns,a=_(n,"sName"),r=_(n,"nTh");return yt("column",i,function(i){var s=v(i);if(""===i)return C(n.length);if(null!==s)return[s>=0?s:n.length+s];if("function"==typeof i){var l=St(t,o);return e.map(n,function(e,o){return i(o,xt(t,o,0,0,l),r[o])?o:null})}var d="string"==typeof i?i.match($t):"";if(d)switch(d[2]){case"visIdx":case"visible":var c=parseInt(d[1],10);if(c<0){var u=e.map(n,function(e,t){return e.bVisible?t:null});return[u[u.length+c]]}return[B(t,c)];case"name":return e.map(a,function(e,t){return e===d[1]?t:null});default:return[]}if(i.nodeName&&i._DT_CellIndex)return[i._DT_CellIndex.column];var h=e(r).filter(i).map(function(){return e.inArray(this,r)}).toArray();if(h.length||!i.nodeName)return h;var p=e(i).closest("*[data-dt-column]");return p.length?[p.data("dt-column")]:[]},t,o)}(o,t,i)},1);return n.selector.cols=t,n.selector.opts=i,n}),s("columns().header()","column().header()",function(e,t){return this.iterator("column",function(e,t){return e.aoColumns[t].nTh},1)}),s("columns().footer()","column().footer()",function(e,t){return this.iterator("column",function(e,t){return e.aoColumns[t].nTf},1)}),s("columns().data()","column().data()",function(){return this.iterator("column-rows",xt,1)}),s("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(e,t){return e.aoColumns[t].mData},1)}),s("columns().cache()","column().cache()",function(e){return this.iterator("column-rows",function(t,i,o,n,a){return S(t.aoData,a,"search"===e?"_aFilterData":"_aSortData",i)},1)}),s("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(e,t,i,o,n){return S(e.aoData,n,"anCells",t)},1)}),s("columns().visible()","column().visible()",function(t,i){var n=this.iterator("column",function(i,n){if(t===o)return i.aoColumns[n].bVisible;!function(t,i,n){var a,r,s,l,d=t.aoColumns,c=d[i],u=t.aoData;if(n===o)return c.bVisible;if(c.bVisible!==n){if(n){var h=e.inArray(!0,_(d,"bVisible"),i+1);for(r=0,s=u.length;r<s;r++)l=u[r].nTr,a=u[r].anCells,l&&l.insertBefore(a[i],a[h]||null)}else e(_(t.aoData,"anCells",i)).detach();c.bVisible=n,se(t,t.aoHeader),se(t,t.aoFooter),nt(t)}}(i,n,t)});return t!==o&&(this.iterator("column",function(e,o){ht(e,null,"column-visibility",[e,o,t,i])}),(i===o||i)&&this.columns.adjust()),n}),s("columns().indexes()","column().index()",function(e){return this.iterator("column",function(t,i){return"visible"===e?j(t,i):i},1)}),r("columns.adjust()",function(){return this.iterator("table",function(e){N(e)},1)}),r("column.index()",function(e,t){if(0!==this.context.length){var i=this.context[0];if("fromVisible"===e||"toData"===e)return B(i,t);if("fromData"===e||"toVisible"===e)return j(i,t)}}),r("column()",function(e,t){return _t(this.columns(e,t))});r("cells()",function(t,i,n){if(e.isPlainObject(t)&&(t.row===o?(n=t,t=null):(n=i,i=null)),e.isPlainObject(i)&&(n=i,i=null),null===i||i===o)return this.iterator("table",function(i){return function(t,i,n){var a,r,s,l,d,c,u,h=t.aoData,p=St(t,n),f=k(S(h,p,"anCells")),m=e([].concat.apply([],f)),g=t.aoColumns.length;return yt("cell",i,function(i){var n="function"==typeof i;if(null===i||i===o||n){for(r=[],s=0,l=p.length;s<l;s++)for(a=p[s],d=0;d<g;d++)c={row:a,column:d},n?(u=h[a],i(c,W(t,a,d),u.anCells?u.anCells[d]:null)&&r.push(c)):r.push(c);return r}if(e.isPlainObject(i))return[i];var f=m.filter(i).map(function(e,t){return{row:t._DT_CellIndex.row,column:t._DT_CellIndex.column}}).toArray();return f.length||!i.nodeName?f:(u=e(i).closest("*[data-dt-row]")).length?[{row:u.data("dt-row"),column:u.data("dt-column")}]:[]},t,n)}(i,t,wt(n))});var a,r,s,l,d,c=this.columns(i,n),u=this.rows(t,n),h=this.iterator("table",function(e,t){for(a=[],r=0,s=u[t].length;r<s;r++)for(l=0,d=c[t].length;l<d;l++)a.push({row:u[t][r],column:c[t][l]});return a},1);return e.extend(h.selector,{cols:i,rows:t,opts:n}),h}),s("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(e,t,i){var n=e.aoData[t];return n&&n.anCells?n.anCells[i]:o},1)}),r("cells().data()",function(){return this.iterator("cell",function(e,t,i){return W(e,t,i)},1)}),s("cells().cache()","cell().cache()",function(e){return e="search"===e?"_aFilterData":"_aSortData",this.iterator("cell",function(t,i,o){return t.aoData[i][e][o]},1)}),s("cells().render()","cell().render()",function(e){return this.iterator("cell",function(t,i,o){return W(t,i,o,e)},1)}),s("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(e,t,i){return{row:t,column:i,columnVisible:j(e,i)}},1)}),s("cells().invalidate()","cell().invalidate()",function(e){return this.iterator("cell",function(t,i,o){ie(t,i,e,o)})}),r("cell()",function(e,t,i){return _t(this.cells(e,t,i))}),r("cell().data()",function(e){var t=this.context,i=this[0];return e===o?t.length&&i.length?W(t[0],i[0].row,i[0].column):o:(q(t[0],i[0].row,i[0].column,e),ie(t[0],i[0].row,"data",i[0].column),this)}),r("order()",function(t,i){var n=this.context;return t===o?0!==n.length?n[0].aaSorting:o:("number"==typeof t?t=[[t,i]]:t.length&&!e.isArray(t[0])&&(t=Array.prototype.slice.call(arguments)),this.iterator("table",function(e){e.aaSorting=t.slice()}))}),r("order.listener()",function(e,t,i){return this.iterator("table",function(o){tt(o,e,t,i)})}),r("order.fixed()",function(t){if(!t){var i=this.context,n=i.length?i[0].aaSortingFixed:o;return e.isArray(n)?{pre:n}:n}return this.iterator("table",function(i){i.aaSortingFixed=e.extend(!0,{},t)})}),r(["columns().order()","column().order()"],function(t){var i=this;return this.iterator("table",function(o,n){var a=[];e.each(i[n],function(e,i){a.push([i,t])}),o.aaSorting=a})}),r("search()",function(t,i,n,a){var r=this.context;return t===o?0!==r.length?r[0].oPreviousSearch.sSearch:o:this.iterator("table",function(o){o.oFeatures.bFilter&&ye(o,e.extend({},o.oPreviousSearch,{sSearch:t+"",bRegex:null!==i&&i,bSmart:null===n||n,bCaseInsensitive:null===a||a}),1)})}),s("columns().search()","column().search()",function(t,i,n,a){return this.iterator("column",function(r,s){var l=r.aoPreSearchCols;if(t===o)return l[s].sSearch;r.oFeatures.bFilter&&(e.extend(l[s],{sSearch:t+"",bRegex:null!==i&&i,bSmart:null===n||n,bCaseInsensitive:null===a||a}),ye(r,r.oPreviousSearch,1))})}),r("state()",function(){return this.context.length?this.context[0].oSavedState:null}),r("state.clear()",function(){return this.iterator("table",function(e){e.fnStateSaveCallback.call(e.oInstance,e,{})})}),r("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),r("state.save()",function(){return this.iterator("table",function(e){nt(e)})}),l.versionCheck=l.fnVersionCheck=function(e){for(var t,i,o=l.version.split("."),n=e.split("."),a=0,r=n.length;a<r;a++)if((t=parseInt(o[a],10)||0)!==(i=parseInt(n[a],10)||0))return t>i;return!0},l.isDataTable=l.fnIsDataTable=function(t){var i=e(t).get(0),o=!1;return e.each(l.settings,function(t,n){var a=n.nScrollHead?e("table",n.nScrollHead)[0]:null,r=n.nScrollFoot?e("table",n.nScrollFoot)[0]:null;n.nTable!==i&&a!==i&&r!==i||(o=!0)}),o},l.tables=l.fnTables=function(t){var i=!1;e.isPlainObject(t)&&(i=t.api,t=t.visible);var o=e.map(l.settings,function(i){if(!t||t&&e(i.nTable).is(":visible"))return i.nTable});return i?new a(o):o},l.camelToHungarian=E,r("$()",function(t,i){var o=this.rows(i).nodes(),n=e(o);return e([].concat(n.filter(t).toArray(),n.find(t).toArray()))}),e.each(["on","one","off"],function(t,i){r(i+"()",function(){var t=Array.prototype.slice.call(arguments);t[0].match(/\.dt\b/)||(t[0]+=".dt");var o=e(this.tables().nodes());return o[i].apply(o,t),this})}),r("clear()",function(){return this.iterator("table",function(e){ee(e)})}),r("settings()",function(){return new a(this.context,this.context)}),r("init()",function(){var e=this.context;return e.length?e[0].oInit:null}),r("data()",function(){return this.iterator("table",function(e){return _(e.aoData,"_aData")}).flatten()}),r("destroy()",function(i){return i=i||!1,this.iterator("table",function(o){var n,r=o.nTableWrapper.parentNode,s=o.oClasses,d=o.nTable,c=o.nTBody,u=o.nTHead,h=o.nTFoot,p=e(d),f=e(c),m=e(o.nTableWrapper),g=e.map(o.aoData,function(e){return e.nTr});o.bDestroying=!0,ht(o,"aoDestroyCallback","destroy",[o]),i||new a(o).columns().visible(!0),m.unbind(".DT").find(":not(tbody *)").unbind(".DT"),e(t).unbind(".DT-"+o.sInstance),d!=u.parentNode&&(p.children("thead").detach(),p.append(u)),h&&d!=h.parentNode&&(p.children("tfoot").detach(),p.append(h)),o.aaSorting=[],o.aaSortingFixed=[],it(o),e(g).removeClass(o.asStripeClasses.join(" ")),e("th, td",u).removeClass(s.sSortable+" "+s.sSortableAsc+" "+s.sSortableDesc+" "+s.sSortableNone),o.bJUI&&(e("th span."+s.sSortIcon+", td span."+s.sSortIcon,u).detach(),e("th, td",u).each(function(){var t=e("div."+s.sSortJUIWrapper,this);e(this).append(t.contents()),t.detach()})),f.children().detach(),f.append(g);var v=i?"remove":"detach";p[v](),m[v](),!i&&r&&(r.insertBefore(d,o.nTableReinsertBefore),p.css("width",o.sDestroyWidth).removeClass(s.sTable),(n=o.asDestroyStripes.length)&&f.children().each(function(t){e(this).addClass(o.asDestroyStripes[t%n])}));var b=e.inArray(o,l.settings);-1!==b&&l.settings.splice(b,1)})}),e.each(["column","row","cell"],function(e,t){r(t+"s().every()",function(e){var i=this.selector.opts,n=this;return this.iterator(t,function(a,r,s,l,d){e.call(n[t](r,"cell"===t?s:i,"cell"===t?i:o),r,s,l,d)})})}),r("i18n()",function(t,i,n){var a=this.context[0],r=J(t)(a.oLanguage);return r===o&&(r=i),n!==o&&e.isPlainObject(r)&&(r=r[n]!==o?r[n]:r._),r.replace("%d",n)}),l.version="1.10.12",l.settings=[],l.models={},l.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},l.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null,idx:-1},l.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},l.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(e){try{return JSON.parse((-1===e.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+e.sInstance+"_"+location.pathname))}catch(e){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(e,t){try{(-1===e.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+e.sInstance+"_"+location.pathname,JSON.stringify(t))}catch(e){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:e.extend({},l.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null,rowId:"DT_RowId"},x(l.defaults),l.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},x(l.defaults.column),l.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1,bBounding:!1,barWidth:0},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:o,oAjaxData:o,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==mt(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==mt(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var e=this._iDisplayLength,t=this._iDisplayStart,i=t+e,o=this.aiDisplay.length,n=this.oFeatures,a=n.bPaginate;return n.bServerSide?!1===a||-1===e?t+o:Math.min(t+e,this._iRecordsDisplay):!a||i>o||-1===e?o:i},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null},l.ext=n={buttons:{},classes:{},builder:"-source-",errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:l.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:l.version},e.extend(n,{afnFiltering:n.search,aTypes:n.type.detect,ofnSearch:n.type.search,oSort:n.type.order,afnSortData:n.order,aoFeatures:n.feature,oApi:n.internal,oStdClasses:n.classes,oPagination:n.pager}),e.extend(l.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""}),function(){var t="ui-state-default",i="css_right ui-icon ui-icon-",o="fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";e.extend(l.ext.oJUIClasses,l.ext.classes,{sPageButton:"fg-button ui-button "+t,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:t+" sorting_asc",sSortDesc:t+" sorting_desc",sSortable:t+" sorting",sSortableAsc:t+" sorting_asc_disabled",sSortableDesc:t+" sorting_desc_disabled",sSortableNone:t+" sorting_disabled",sSortJUIAsc:i+"triangle-1-n",sSortJUIDesc:i+"triangle-1-s",sSortJUI:i+"carat-2-n-s",sSortJUIAscAllowed:i+"carat-1-n",sSortJUIDescAllowed:i+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+t,sScrollFoot:"dataTables_scrollFoot "+t,sHeaderTH:t,sFooterTH:t,sJUIHeader:o+" ui-corner-tl ui-corner-tr",sJUIFooter:o+" ui-corner-bl ui-corner-br"})}();var Et=l.ext.pager;function At(e,t){var i=[],o=Et.numbers_length,n=Math.floor(o/2);return t<=o?i=C(0,t):e<=n?((i=C(0,o-2)).push("ellipsis"),i.push(t-1)):e>=t-1-n?((i=C(t-(o-2),t)).splice(0,0,"ellipsis"),i.splice(0,0,0)):((i=C(e-n+2,e+n-1)).push("ellipsis"),i.push(t-1),i.splice(0,0,"ellipsis"),i.splice(0,0,0)),i.DT_el="span",i}e.extend(Et,{simple:function(e,t){return["previous","next"]},full:function(e,t){return["first","previous","next","last"]},numbers:function(e,t){return[At(e,t)]},simple_numbers:function(e,t){return["previous",At(e,t),"next"]},full_numbers:function(e,t){return["first","previous",At(e,t),"next","last"]},_numbers:At,numbers_length:7}),e.extend(!0,l.ext.renderer,{pageButton:{_:function(t,o,n,a,r,s){var l,d,c,u=t.oClasses,h=t.oLanguage.oPaginate,p=t.oLanguage.oAria.paginate||{},f=0,m=function(i,o){var a,c,g,v=function(e){Be(t,e.data.action,!0)};for(a=0,c=o.length;a<c;a++)if(g=o[a],e.isArray(g)){var b=e("<"+(g.DT_el||"div")+"/>").appendTo(i);m(b,g)}else{switch(l=null,d="",g){case"ellipsis":i.append('<span class="ellipsis">&#x2026;</span>');break;case"first":l=h.sFirst,d=g+(r>0?"":" "+u.sPageButtonDisabled);break;case"previous":l=h.sPrevious,d=g+(r>0?"":" "+u.sPageButtonDisabled);break;case"next":l=h.sNext,d=g+(r<s-1?"":" "+u.sPageButtonDisabled);break;case"last":l=h.sLast,d=g+(r<s-1?"":" "+u.sPageButtonDisabled);break;default:l=g+1,d=r===g?u.sPageButtonActive:""}null!==l&&(ct(e("<a>",{class:u.sPageButton+" "+d,"aria-controls":t.sTableId,"aria-label":p[g],"data-dt-idx":f,tabindex:t.iTabIndex,id:0===n&&"string"==typeof g?t.sTableId+"_"+g:null}).html(l).appendTo(i),{action:g},v),f++)}};try{c=e(o).find(i.activeElement).data("dt-idx")}catch(e){}m(e(o).empty(),a),c&&e(o).find("[data-dt-idx="+c+"]").focus()}}}),e.extend(l.ext.type.detect,[function(e,t){var i=t.oLanguage.sDecimal;return y(e,i)?"num"+i:null},function(e,t){if(e&&!(e instanceof Date)&&(!h.test(e)||!p.test(e)))return null;var i=Date.parse(e);return null!==i&&!isNaN(i)||g(e)?"date":null},function(e,t){var i=t.oLanguage.sDecimal;return y(e,i,!0)?"num-fmt"+i:null},function(e,t){var i=t.oLanguage.sDecimal;return w(e,i)?"html-num"+i:null},function(e,t){var i=t.oLanguage.sDecimal;return w(e,i,!0)?"html-num-fmt"+i:null},function(e,t){return g(e)||"string"==typeof e&&-1!==e.indexOf("<")?"html":null}]),e.extend(l.ext.type.search,{html:function(e){return g(e)?e:"string"==typeof e?e.replace(c," ").replace(u,""):""},string:function(e){return g(e)?e:"string"==typeof e?e.replace(c," "):e}});var Lt=function(e,t,i,o){return 0===e||e&&"-"!==e?(t&&(e=b(e,t)),e.replace&&(i&&(e=e.replace(i,"")),o&&(e=e.replace(o,""))),1*e):-1/0};function It(t){e.each({num:function(e){return Lt(e,t)},"num-fmt":function(e){return Lt(e,t,m)},"html-num":function(e){return Lt(e,t,u)},"html-num-fmt":function(e){return Lt(e,t,u,m)}},function(e,i){n.type.order[e+t+"-pre"]=i,e.match(/^html\-/)&&(n.type.search[e+t]=n.type.search.html)})}e.extend(n.type.order,{"date-pre":function(e){return Date.parse(e)||0},"html-pre":function(e){return g(e)?"":e.replace?e.replace(/<.*?>/g,"").toLowerCase():e+""},"string-pre":function(e){return g(e)?"":"string"==typeof e?e.toLowerCase():e.toString?e.toString():""},"string-asc":function(e,t){return e<t?-1:e>t?1:0},"string-desc":function(e,t){return e<t?1:e>t?-1:0}}),It(""),e.extend(!0,l.ext.renderer,{header:{_:function(t,i,o,n){e(t.nTable).on("order.dt.DT",function(e,a,r,s){if(t===a){var l=o.idx;i.removeClass(o.sSortingClass+" "+n.sSortAsc+" "+n.sSortDesc).addClass("asc"==s[l]?n.sSortAsc:"desc"==s[l]?n.sSortDesc:o.sSortingClass)}})},jqueryui:function(t,i,o,n){e("<div/>").addClass(n.sSortJUIWrapper).append(i.contents()).append(e("<span/>").addClass(n.sSortIcon+" "+o.sSortingClassJUI)).appendTo(i),e(t.nTable).on("order.dt.DT",function(e,a,r,s){if(t===a){var l=o.idx;i.removeClass(n.sSortAsc+" "+n.sSortDesc).addClass("asc"==s[l]?n.sSortAsc:"desc"==s[l]?n.sSortDesc:o.sSortingClass),i.find("span."+n.sSortIcon).removeClass(n.sSortJUIAsc+" "+n.sSortJUIDesc+" "+n.sSortJUI+" "+n.sSortJUIAscAllowed+" "+n.sSortJUIDescAllowed).addClass("asc"==s[l]?n.sSortJUIAsc:"desc"==s[l]?n.sSortJUIDesc:o.sSortingClassJUI)}})}}});var Mt=function(e){return"string"==typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):e};function Dt(e){return function(){var t=[rt(this[l.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return l.ext.internal[e].apply(this,t)}}return l.render={number:function(e,t,i,o,n){return{display:function(a){if("number"!=typeof a&&"string"!=typeof a)return a;var r=a<0?"-":"",s=parseFloat(a);if(isNaN(s))return Mt(a);a=Math.abs(s);var l=parseInt(a,10),d=i?t+(a-l).toFixed(i).substring(2):"";return r+(o||"")+l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,e)+d+(n||"")}}},text:function(){return{display:Mt}}},e.extend(l.ext.internal,{_fnExternApiFunc:Dt,_fnBuildAjax:pe,_fnAjaxUpdate:fe,_fnAjaxParameters:me,_fnAjaxUpdateDraw:ge,_fnAjaxDataSrc:ve,_fnAddColumn:P,_fnColumnOptions:R,_fnAdjustColumnSizing:N,_fnVisibleToColumnIndex:B,_fnColumnIndexToVisible:j,_fnVisbleColumns:F,_fnGetColumns:H,_fnColumnTypes:U,_fnApplyColumnDefs:z,_fnHungarianMap:x,_fnCamelToHungarian:E,_fnLanguageCompat:A,_fnBrowserDetect:D,_fnAddData:G,_fnAddTr:V,_fnNodeToDataIndex:function(e,t){return t._DT_RowIndex!==o?t._DT_RowIndex:null},_fnNodeToColumnIndex:function(t,i,o){return e.inArray(o,t.aoData[i].anCells)},_fnGetCellData:W,_fnSetCellData:q,_fnSplitObjNotation:K,_fnGetObjectDataFn:J,_fnSetObjectDataFn:Q,_fnGetDataMaster:Z,_fnClearTable:ee,_fnDeleteIndex:te,_fnInvalidate:ie,_fnGetRowElements:oe,_fnCreateTr:ne,_fnBuildHead:re,_fnDrawHead:se,_fnDraw:le,_fnReDraw:de,_fnAddOptionsHtml:ce,_fnDetectHeader:ue,_fnGetUniqueThs:he,_fnFeatureHtmlFilter:be,_fnFilterComplete:ye,_fnFilterCustom:we,_fnFilterColumn:_e,_fnFilter:Se,_fnFilterCreateSearch:Ce,_fnEscapeRegex:ke,_fnFilterData:xe,_fnFeatureHtmlInfo:Le,_fnUpdateInfo:Ie,_fnInfoMacros:Me,_fnInitialise:De,_fnInitComplete:Oe,_fnLengthChange:Pe,_fnFeatureHtmlLength:Re,_fnFeatureHtmlPaginate:Ne,_fnPageChange:Be,_fnFeatureHtmlProcessing:je,_fnProcessingDisplay:Fe,_fnFeatureHtmlTable:He,_fnScrollDraw:Ue,_fnApplyToChildren:ze,_fnCalculateColumnWidths:Ve,_fnThrottle:We,_fnConvertToWidth:qe,_fnGetWidestNode:Ye,_fnGetMaxLenString:Xe,_fnStringToCss:Ke,_fnSortFlatten:Je,_fnSort:Qe,_fnSortAria:Ze,_fnSortListener:et,_fnSortAttachListener:tt,_fnSortingClasses:it,_fnSortData:ot,_fnSaveState:nt,_fnLoadState:at,_fnSettingsFromNode:rt,_fnLog:st,_fnMap:lt,_fnBindAction:ct,_fnCallbackReg:ut,_fnCallbackFire:ht,_fnLengthOverflow:pt,_fnRenderer:ft,_fnDataSource:mt,_fnRowAttributes:ae,_fnCalculateEnd:function(){}}),e.fn.dataTable=l,l.$=e,e.fn.dataTableSettings=l.settings,e.fn.dataTableExt=l.ext,e.fn.DataTable=function(t){return e(this).dataTable(t).api()},e.each(l,function(t,i){e.fn.DataTable[t]=i}),e.fn.dataTable}),function(e){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(t){return e(t,window,document)}):"object"==typeof exports?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),e(i,t,t.document)}:e(jQuery,window,document)}(function(e,t,i,o){"use strict";var n=e.fn.dataTable,a=function(t,i){if(!n.versionCheck||!n.versionCheck("1.10.3"))throw"DataTables Responsive requires DataTables 1.10.3 or newer";this.s={dt:new n.Api(t),columns:[],current:[]},this.s.dt.settings()[0].responsive||(i&&"string"==typeof i.details?i.details={type:i.details}:i&&!1===i.details?i.details={type:!1}:i&&!0===i.details&&(i.details={type:"inline"}),this.c=e.extend(!0,{},a.defaults,n.defaults.responsive,i),t.responsive=this,this._constructor())};e.extend(a.prototype,{_constructor:function(){var i=this,o=this.s.dt,a=o.settings()[0],r=e(t).width();o.settings()[0]._responsive=this,e(t).on("resize.dtr orientationchange.dtr",n.util.throttle(function(){var o=e(t).width();o!==r&&(i._resize(),r=o)})),a.oApi._fnCallbackReg(a,"aoRowCreatedCallback",function(t,n,a){-1!==e.inArray(!1,i.s.current)&&e(">td, >th",t).each(function(t){var n=o.column.index("toData",t);!1===i.s.current[n]&&e(this).css("display","none")})}),o.on("destroy.dtr",function(){o.off(".dtr"),e(o.table().body()).off(".dtr"),e(t).off("resize.dtr orientationchange.dtr"),e.each(i.s.current,function(e,t){!1===t&&i._setColumnVis(e,!0)})}),this.c.breakpoints.sort(function(e,t){return e.width<t.width?1:e.width>t.width?-1:0}),this._classLogic(),this._resizeAuto();var s=this.c.details;!1!==s.type&&(i._detailsInit(),o.on("column-visibility.dtr",function(e,t,o,n){i._classLogic(),i._resizeAuto(),i._resize()}),o.on("draw.dtr",function(){i._redrawChildren()}),e(o.table().node()).addClass("dtr-"+s.type)),o.on("column-reorder.dtr",function(e,t,o){i._classLogic(),i._resizeAuto(),i._resize()}),o.on("column-sizing.dtr",function(){i._resizeAuto(),i._resize()}),o.on("preXhr.dtr",function(){var e=[];o.rows().every(function(){this.child.isShown()&&e.push(this.id(!0))}),o.one("draw.dtr",function(){o.rows(e).every(function(){i._detailsDisplay(this,!1)})})}),o.on("init.dtr",function(t,n,a){i._resizeAuto(),i._resize(),e.inArray(!1,i.s.current)&&o.columns.adjust()}),this._resize()},_columnsVisiblity:function(t){var i,o,n=this.s.dt,a=this.s.columns,r=a.map(function(e,t){return{columnIdx:t,priority:e.priority}}).sort(function(e,t){return e.priority!==t.priority?e.priority-t.priority:e.columnIdx-t.columnIdx}),s=e.map(a,function(i){return(!i.auto||null!==i.minWidth)&&(!0===i.auto?"-":-1!==e.inArray(t,i.includeIn))}),l=0;for(i=0,o=s.length;i<o;i++)!0===s[i]&&(l+=a[i].minWidth);var d=n.settings()[0].oScroll,c=d.sY||d.sX?d.iBarWidth:0,u=n.table().container().offsetWidth-c-l;for(i=0,o=s.length;i<o;i++)a[i].control&&(u-=a[i].minWidth);var h=!1;for(i=0,o=r.length;i<o;i++){var p=r[i].columnIdx;"-"===s[p]&&!a[p].control&&a[p].minWidth&&(h||u-a[p].minWidth<0?(h=!0,s[p]=!1):s[p]=!0,u-=a[p].minWidth)}var f=!1;for(i=0,o=a.length;i<o;i++)if(!a[i].control&&!a[i].never&&!s[i]){f=!0;break}for(i=0,o=a.length;i<o;i++)a[i].control&&(s[i]=f);return-1===e.inArray(!0,s)&&(s[0]=!0),s},_classLogic:function(){var t=this,i=this.c.breakpoints,n=this.s.dt,a=n.columns().eq(0).map(function(t){var i=this.column(t),a=i.header().className,r=n.settings()[0].aoColumns[t].responsivePriority;if(r===o){var s=e(i.header()).data("priority");r=s!==o?1*s:1e4}return{className:a,includeIn:[],auto:!1,control:!1,never:!!a.match(/\bnever\b/),priority:r}}),r=function(t,i){var o=a[t].includeIn;-1===e.inArray(i,o)&&o.push(i)},s=function(e,o,n,s){var l,d,c;if(n){if("max-"===n)for(l=t._find(o).width,d=0,c=i.length;d<c;d++)i[d].width<=l&&r(e,i[d].name);else if("min-"===n)for(l=t._find(o).width,d=0,c=i.length;d<c;d++)i[d].width>=l&&r(e,i[d].name);else if("not-"===n)for(d=0,c=i.length;d<c;d++)-1===i[d].name.indexOf(s)&&r(e,i[d].name)}else a[e].includeIn.push(o)};a.each(function(t,o){for(var n=t.className.split(" "),a=!1,r=0,l=n.length;r<l;r++){var d=e.trim(n[r]);if("all"===d)return a=!0,void(t.includeIn=e.map(i,function(e){return e.name}));if("none"===d||t.never)return void(a=!0);if("control"===d)return a=!0,void(t.control=!0);e.each(i,function(e,t){var i=t.name.split("-"),n=new RegExp("(min\\-|max\\-|not\\-)?("+i[0]+")(\\-[_a-zA-Z0-9])?"),r=d.match(n);r&&(a=!0,r[2]===i[0]&&r[3]==="-"+i[1]?s(o,t.name,r[1],r[2]+r[3]):r[2]!==i[0]||r[3]||s(o,t.name,r[1],r[2]))})}a||(t.auto=!0)}),this.s.columns=a},_detailsDisplay:function(t,i){var o=this,n=this.s.dt,a=this.c.details;if(a&&!1!==a.type){var r=a.display(t,i,function(){return a.renderer(n,t[0],o._detailsObj(t[0]))});!0!==r&&!1!==r||e(n.table().node()).triggerHandler("responsive-display.dt",[n,t,r,i])}},_detailsInit:function(){var t=this,i=this.s.dt,o=this.c.details;"inline"===o.type&&(o.target="td:first-child, th:first-child"),i.on("draw.dtr",function(){t._tabIndexes()}),t._tabIndexes(),e(i.table().body()).on("keyup.dtr","td, th",function(t){13===t.keyCode&&e(this).data("dtr-keyboard")&&e(this).click()});var n=o.target,a="string"==typeof n?n:"td, th";e(i.table().body()).on("click.dtr mousedown.dtr mouseup.dtr",a,function(o){if(e(i.table().node()).hasClass("collapsed")&&-1!==e.inArray(e(this).closest("tr").get(0),i.rows().nodes().toArray())){if("number"==typeof n){var a=n<0?i.columns().eq(0).length+n:n;if(i.cell(this).index().column!==a)return}var r=i.row(e(this).closest("tr"));"click"===o.type?t._detailsDisplay(r,!1):"mousedown"===o.type?e(this).css("outline","none"):"mouseup"===o.type&&e(this).blur().css("outline","")}})},_detailsObj:function(t){var i=this,o=this.s.dt;return e.map(this.s.columns,function(e,n){if(!e.never&&!e.control)return{title:o.settings()[0].aoColumns[n].sTitle,data:o.cell(t,n).render(i.c.orthogonal),hidden:o.column(n).visible()&&!i.s.current[n],columnIndex:n,rowIndex:t}})},_find:function(e){for(var t=this.c.breakpoints,i=0,o=t.length;i<o;i++)if(t[i].name===e)return t[i]},_redrawChildren:function(){var e=this,t=this.s.dt;t.rows({page:"current"}).iterator("row",function(i,o){t.row(o);e._detailsDisplay(t.row(o),!0)})},_resize:function(){var i,o,n=this,a=this.s.dt,r=e(t).width(),s=this.c.breakpoints,l=s[0].name,d=this.s.columns,c=this.s.current.slice();for(i=s.length-1;i>=0;i--)if(r<=s[i].width){l=s[i].name;break}var u=this._columnsVisiblity(l);this.s.current=u;var h=!1;for(i=0,o=d.length;i<o;i++)if(!1===u[i]&&!d[i].never&&!d[i].control){h=!0;break}e(a.table().node()).toggleClass("collapsed",h);var p=!1;a.columns().eq(0).each(function(e,t){u[t]!==c[t]&&(p=!0,n._setColumnVis(e,u[t]))}),p&&(this._redrawChildren(),e(a.table().node()).trigger("responsive-resize.dt",[a,this.s.current]))},_resizeAuto:function(){var t=this.s.dt,i=this.s.columns;if(this.c.auto&&-1!==e.inArray(!0,e.map(i,function(e){return e.auto}))){t.table().node().offsetWidth,t.columns;var o=t.table().node().cloneNode(!1),n=e(t.table().header().cloneNode(!1)).appendTo(o),a=e(t.table().body()).clone(!1,!1).empty().appendTo(o),r=t.columns().header().filter(function(e){return t.column(e).visible()}).to$().clone(!1).css("display","table-cell");e(a).append(e(t.rows({page:"current"}).nodes()).clone(!1)).find("th, td").css("display","");var s=t.table().footer();if(s){var l=e(s.cloneNode(!1)).appendTo(o),d=t.columns().footer().filter(function(e){return t.column(e).visible()}).to$().clone(!1).css("display","table-cell");e("<tr/>").append(d).appendTo(l)}e("<tr/>").append(r).appendTo(n),"inline"===this.c.details.type&&e(o).addClass("dtr-inline collapsed"),e(o).find("[name]").removeAttr("name");var c=e("<div/>").css({width:1,height:1,overflow:"hidden"}).append(o);c.insertBefore(t.table().node()),r.each(function(e){var o=t.column.index("fromVisible",e);i[o].minWidth=this.offsetWidth||0}),c.remove()}},_setColumnVis:function(t,i){var o=this.s.dt,n=i?"":"none";e(o.column(t).header()).css("display",n),e(o.column(t).footer()).css("display",n),o.column(t).nodes().to$().css("display",n)},_tabIndexes:function(){var t=this.s.dt,i=t.cells({page:"current"}).nodes().to$(),o=t.settings()[0],n=this.c.details.target;i.filter("[data-dtr-keyboard]").removeData("[data-dtr-keyboard]");var a="number"==typeof n?":eq("+n+")":n;"td:first-child, th:first-child"===a&&(a=">td:first-child, >th:first-child"),e(a,t.rows({page:"current"}).nodes()).attr("tabIndex",o.iTabIndex).data("dtr-keyboard",1)}}),a.breakpoints=[{name:"desktop",width:1/0},{name:"tablet-l",width:1024},{name:"tablet-p",width:768},{name:"mobile-l",width:480},{name:"mobile-p",width:320}],a.display={childRow:function(t,i,o){return i?e(t.node()).hasClass("parent")?(t.child(o(),"child").show(),!0):void 0:t.child.isShown()?(t.child(!1),e(t.node()).removeClass("parent"),!1):(t.child(o(),"child").show(),e(t.node()).addClass("parent"),!0)},childRowImmediate:function(t,i,o){return!i&&t.child.isShown()||!t.responsive.hasHidden()?(t.child(!1),e(t.node()).removeClass("parent"),!1):(t.child(o(),"child").show(),e(t.node()).addClass("parent"),!0)},modal:function(t){return function(o,n,a){if(n)e("div.dtr-modal-content").empty().append(a());else{var r=function(){s.remove(),e(i).off("keypress.dtr")},s=e('<div class="dtr-modal"/>').append(e('<div class="dtr-modal-display"/>').append(e('<div class="dtr-modal-content"/>').append(a())).append(e('<div class="dtr-modal-close">&times;</div>').click(function(){r()}))).append(e('<div class="dtr-modal-background"/>').click(function(){r()})).appendTo("body");e(i).on("keyup.dtr",function(e){27===e.keyCode&&(e.stopPropagation(),r())})}t&&t.header&&e("div.dtr-modal-content").prepend("<h2>"+t.header(o)+"</h2>")}}},a.renderer={listHidden:function(){return function(t,i,o){var n=e.map(o,function(e){return e.hidden?'<li data-dtr-index="'+e.columnIndex+'" data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'"><span class="dtr-title">'+e.title+'</span> <span class="dtr-data">'+e.data+"</span></li>":""}).join("");return!!n&&e('<ul data-dtr-index="'+i+'" class="dtr-details"/>').append(n)}},tableAll:function(t){return t=e.extend({tableClass:""},t),function(i,o,n){var a=e.map(n,function(e){return'<tr data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'"><td>'+e.title+":</td> <td>"+e.data+"</td></tr>"}).join("");return e('<table class="'+t.tableClass+' dtr-details" width="100%"/>').append(a)}}},a.defaults={breakpoints:a.breakpoints,auto:!0,details:{display:a.display.childRow,renderer:a.renderer.listHidden(),target:0,type:"inline"},orthogonal:"display"};var r=e.fn.dataTable.Api;return r.register("responsive()",function(){return this}),r.register("responsive.index()",function(t){return{column:(t=e(t)).data("dtr-index"),row:t.parent().data("dtr-index")}}),r.register("responsive.rebuild()",function(){return this.iterator("table",function(e){e._responsive&&e._responsive._classLogic()})}),r.register("responsive.recalc()",function(){return this.iterator("table",function(e){e._responsive&&(e._responsive._resizeAuto(),e._responsive._resize())})}),r.register("responsive.hasHidden()",function(){var t=this.context[0];return!!t._responsive&&-1!==e.inArray(!1,t._responsive.s.current)}),a.version="2.1.1-dev",e.fn.dataTable.Responsive=a,e.fn.DataTable.Responsive=a,e(i).on("preInit.dt.dtr",function(t,i,o){if("dt"===t.namespace&&(e(i.nTable).hasClass("responsive")||e(i.nTable).hasClass("dt-responsive")||i.oInit.responsive||n.defaults.responsive)){var r=i.oInit.responsive;!1!==r&&new a(i,e.isPlainObject(r)?r:{})}}),a}),function(e){var t,i,o,n,a,r,s,l,d,c,u,h,p,f,m,g,v,b,y,w,_,S,C,k,T,$,x,E,A,L,I,M,D,O,P,R,N,B,j,F=(t=65,i={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!1},o=function(t,i){var o=R(t);e(i).data("colorpicker").fields.eq(1).val(o.r).end().eq(2).val(o.g).end().eq(3).val(o.b).end()},n=function(t,i){e(i).data("colorpicker").fields.eq(4).val(t.h).end().eq(5).val(t.s).end().eq(6).val(t.b).end()},a=function(t,i){e(i).data("colorpicker").fields.eq(0).val(B(t)).end()},r=function(t,i){e(i).data("colorpicker").selector.css("backgroundColor","#"+B({h:t.h,s:100,b:100})),e(i).data("colorpicker").selectorIndic.css({left:parseInt(150*t.s/100,10),top:parseInt(150*(100-t.b)/100,10)})},s=function(t,i){e(i).data("colorpicker").hue.css("top",parseInt(150-150*t.h/360,10))},l=function(t,i){e(i).data("colorpicker").currentColor.css("backgroundColor","#"+B(t))},d=function(t,i){e(i).data("colorpicker").newColor.css("backgroundColor","#"+B(t))},c=function(i){var o=i.charCode||i.keyCode||-1;if(o>t&&o<=90||32==o)return!1;!0===e(this).parent().parent().data("colorpicker").livePreview&&u.apply(this)},u=function(t){var i,l=e(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?l.data("colorpicker").color=i=O(M(this.value)):this.parentNode.className.indexOf("_hsb")>0?l.data("colorpicker").color=i=L({h:parseInt(l.data("colorpicker").fields.eq(4).val(),10),s:parseInt(l.data("colorpicker").fields.eq(5).val(),10),b:parseInt(l.data("colorpicker").fields.eq(6).val(),10)}):l.data("colorpicker").color=i=P(I({r:parseInt(l.data("colorpicker").fields.eq(1).val(),10),g:parseInt(l.data("colorpicker").fields.eq(2).val(),10),b:parseInt(l.data("colorpicker").fields.eq(3).val(),10)})),t&&(o(i,l.get(0)),a(i,l.get(0)),n(i,l.get(0))),r(i,l.get(0)),s(i,l.get(0)),d(i,l.get(0)),l.data("colorpicker").onChange.apply(l,[i,B(i),R(i)])},h=function(t){e(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus")},p=function(){t=this.parentNode.className.indexOf("_hex")>0?70:65,e(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),e(this).parent().addClass("colorpicker_focus")},f=function(t){var i=e(this).parent().find("input").focus(),o={el:e(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:t.pageY,field:i,val:parseInt(i.val(),10),preview:e(this).parent().parent().data("colorpicker").livePreview};e(document).bind("mouseup",o,g),e(document).bind("mousemove",o,m)},m=function(e){return e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val+e.pageY-e.data.y,10)))),e.data.preview&&u.apply(e.data.field.get(0),[!0]),!1},g=function(t){return u.apply(t.data.field.get(0),[!0]),t.data.el.removeClass("colorpicker_slider").find("input").focus(),e(document).unbind("mouseup",g),e(document).unbind("mousemove",m),!1},v=function(t){var i={cal:e(this).parent(),y:e(this).offset().top};i.preview=i.cal.data("colorpicker").livePreview,e(document).bind("mouseup",i,y),e(document).bind("mousemove",i,b)},b=function(e){return u.apply(e.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,e.pageY-e.data.y)))/150,10)).get(0),[e.data.preview]),!1},y=function(t){return o(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),a(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),e(document).unbind("mouseup",y),e(document).unbind("mousemove",b),!1},w=function(t){var i={cal:e(this).parent(),pos:e(this).offset()};i.preview=i.cal.data("colorpicker").livePreview,e(document).bind("mouseup",i,S),e(document).bind("mousemove",i,_)},_=function(e){return u.apply(e.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,e.pageY-e.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,e.pageX-e.data.pos.left))/150,10)).get(0),[e.data.preview]),!1},S=function(t){return o(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),a(t.data.cal.data("colorpicker").color,t.data.cal.get(0)),e(document).unbind("mouseup",S),e(document).unbind("mousemove",_),!1},C=function(t){e(this).addClass("colorpicker_focus")},k=function(t){e(this).removeClass("colorpicker_focus")},T=function(t){var i=e(this).parent(),o=i.data("colorpicker").color;i.data("colorpicker").origColor=o,l(o,i.get(0)),i.data("colorpicker").onSubmit(o,B(o),R(o),i.data("colorpicker").el)},$=function(t){var i=e("#"+e(this).data("colorpickerId"));i.data("colorpicker").onBeforeShow.apply(this,[i.get(0)]);var o=e(this).offset(),n=A(),a=o.top+this.offsetHeight,r=o.left;return a+176>n.t+n.h&&(a-=this.offsetHeight+176),r+356>n.l+n.w&&(r-=356),i.css({left:r+"px",top:a+"px"}),0!=i.data("colorpicker").onShow.apply(this,[i.get(0)])&&i.show(),e(document).bind("mousedown",{cal:i},x),!1},x=function(t){E(t.data.cal.get(0),t.target,t.data.cal.get(0))||(0!=t.data.cal.data("colorpicker").onHide.apply(this,[t.data.cal.get(0)])&&t.data.cal.hide(),e(document).unbind("mousedown",x))},E=function(e,t,i){if(e==t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));for(var o=t.parentNode;o&&o!=i;){if(o==e)return!0;o=o.parentNode}return!1},A=function(){var e="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(e?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(e?document.documentElement.clientHeight:document.body.clientHeight)}},L=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},I=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},M=function(e){var t=6-e.length;if(t>0){for(var i=[],o=0;o<t;o++)i.push("0");i.push(e),e=i.join("")}return e},D=function(e){return{r:(e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16))>>16,g:(65280&e)>>8,b:255&e}},O=function(e){return P(D(e))},P=function(e){var t={h:0,s:0,b:0},i=Math.min(e.r,e.g,e.b),o=Math.max(e.r,e.g,e.b),n=o-i;return t.b=o,t.s=0!=o?255*n/o:0,0!=t.s?e.r==o?t.h=(e.g-e.b)/n:e.g==o?t.h=2+(e.b-e.r)/n:t.h=4+(e.r-e.g)/n:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},R=function(e){var t={},i=Math.round(e.h),o=Math.round(255*e.s/100),n=Math.round(255*e.b/100);if(0==o)t.r=t.g=t.b=n;else{var a=n,r=(255-o)*n/255,s=i%60*(a-r)/60;360==i&&(i=0),i<60?(t.r=a,t.b=r,t.g=r+s):i<120?(t.g=a,t.b=r,t.r=a-s):i<180?(t.g=a,t.r=r,t.b=r+s):i<240?(t.b=a,t.r=r,t.g=a-s):i<300?(t.b=a,t.g=r,t.r=r+s):i<360?(t.r=a,t.g=r,t.b=a-s):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}},N=function(t){var i=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.each(i,function(e,t){1==t.length&&(i[e]="0"+t)}),i.join("")},B=function(e){return N(R(e))},j=function(){var t=e(this).parent(),i=t.data("colorpicker").origColor;t.data("colorpicker").color=i,o(i,t.get(0)),a(i,t.get(0)),n(i,t.get(0)),r(i,t.get(0)),s(i,t.get(0)),d(i,t.get(0))},{init:function(t){if("string"==typeof(t=e.extend({},i,t||{})).color)t.color=O(t.color);else if(void 0!=t.color.r&&void 0!=t.color.g&&void 0!=t.color.b)t.color=P(t.color);else{if(void 0==t.color.h||void 0==t.color.s||void 0==t.color.b)return this;t.color=L(t.color)}return this.each(function(){if(!e(this).data("colorpickerId")){var i=e.extend({},t);i.origColor=t.color;var m="collorpicker_"+parseInt(1e3*Math.random());e(this).data("colorpickerId",m);var g=e('<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>').attr("id",m);i.flat?g.appendTo(this).show():g.appendTo(document.body),i.fields=g.find("input").bind("keyup",c).bind("change",u).bind("blur",h).bind("focus",p),g.find("span").bind("mousedown",f).end().find(">div.colorpicker_current_color").bind("click",j),i.selector=g.find("div.colorpicker_color").bind("mousedown",w),i.selectorIndic=i.selector.find("div div"),i.el=this,i.hue=g.find("div.colorpicker_hue div"),g.find("div.colorpicker_hue").bind("mousedown",v),i.newColor=g.find("div.colorpicker_new_color"),i.currentColor=g.find("div.colorpicker_current_color"),g.data("colorpicker",i),g.find("div.colorpicker_submit").bind("mouseenter",C).bind("mouseleave",k).bind("click",T),o(i.color,g.get(0)),n(i.color,g.get(0)),a(i.color,g.get(0)),s(i.color,g.get(0)),r(i.color,g.get(0)),l(i.color,g.get(0)),d(i.color,g.get(0)),i.flat?g.css({position:"relative",display:"block"}):e(this).bind(i.eventName,$)}})},showPicker:function(){return this.each(function(){e(this).data("colorpickerId")&&$.apply(this)})},hidePicker:function(){return this.each(function(){e(this).data("colorpickerId")&&e("#"+e(this).data("colorpickerId")).hide()})},HexToHSB:function(e){return e+="",hsb=!1,"string"==typeof e&&(hsb=O(e)),hsb},HSBToHex:function(e){return B(e)},HexToRGB:function(e){return D(e)},RGBToHSB:function(e){return P(e)},RGBToHex:function(e){return N(e)},setColor:function(t){if("string"==typeof t)t=O(t);else if(void 0!=t.r&&void 0!=t.g&&void 0!=t.b)t=P(t);else{if(void 0==t.h||void 0==t.s||void 0==t.b)return this;t=L(t)}return this.each(function(){if(e(this).data("colorpickerId")){var i=e("#"+e(this).data("colorpickerId"));i.data("colorpicker").color=t,i.data("colorpicker").origColor=t,o(t,i.get(0)),n(t,i.get(0)),a(t,i.get(0)),s(t,i.get(0)),r(t,i.get(0)),l(t,i.get(0)),d(t,i.get(0))}})}});e.fn.extend({ColorPicker:F.init,ColorPickerHide:F.hidePicker,ColorPickerShow:F.showPicker,ColorPickerSetColor:F.setColor,ColorPickerHexToHSB:F.HexToHSB,ColorPickerHSBToHex:F.HSBToHex,ColorPickerHexToRGB:F.HexToRGB,ColorPickerRGBToHSB:F.RGBToHSB,ColorPickerRGBToHex:F.RGBToHex})}(jQuery),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.bootbox=t(e.jQuery)}(this,function e(t,i){"use strict";var o={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",textarea:"<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",select:"<select class='bootbox-input bootbox-input-select form-control'></select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>",date:"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",time:"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",number:"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",password:"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"}},n={locale:"en",backdrop:"static",animate:!0,className:null,closeButton:!0,show:!0,container:"body"},a={};function r(e){var t=p[n.locale];return t?t[e]:p.en[e]}function s(e,i,o){e.stopPropagation(),e.preventDefault(),t.isFunction(o)&&!1===o.call(i,e)||i.modal("hide")}function l(e,i){var o=0;t.each(e,function(e,t){i(e,t,o++)})}function d(e,i,o){return t.extend(!0,{},e,function(e,t){var i=e.length,o={};if(i<1||i>2)throw new Error("Invalid argument length");return 2===i||"string"==typeof e[0]?(o[t[0]]=e[0],o[t[1]]=e[1]):o=e[0],o}(i,o))}function c(e,t,i,o){return h(d({className:"bootbox-"+e,buttons:u.apply(null,t)},o,i),t)}function u(){for(var e={},t=0,i=arguments.length;t<i;t++){var o=arguments[t],n=o.toLowerCase(),a=o.toUpperCase();e[n]={label:r(a)}}return e}function h(e,t){var o={};return l(t,function(e,t){o[t]=!0}),l(e.buttons,function(e){if(o[e]===i)throw new Error("button key "+e+" is not allowed (options are "+t.join("\n")+")")}),e}a.alert=function(){var e;if((e=c("alert",["ok"],["message","callback"],arguments)).callback&&!t.isFunction(e.callback))throw new Error("alert requires callback property to be a function when provided");return e.buttons.ok.callback=e.onEscape=function(){return!t.isFunction(e.callback)||e.callback.call(this)},a.dialog(e)},a.confirm=function(){var e;if((e=c("confirm",["cancel","confirm"],["message","callback"],arguments)).buttons.cancel.callback=e.onEscape=function(){return e.callback.call(this,!1)},e.buttons.confirm.callback=function(){return e.callback.call(this,!0)},!t.isFunction(e.callback))throw new Error("confirm requires a callback");return a.dialog(e)},a.prompt=function(){var e,n,r,s,c,p,f;if(s=t(o.form),n={className:"bootbox-prompt",buttons:u("cancel","confirm"),value:"",inputType:"text"},p=(e=h(d(n,arguments,["title","callback"]),["cancel","confirm"])).show===i||e.show,e.message=s,e.buttons.cancel.callback=e.onEscape=function(){return e.callback.call(this,null)},e.buttons.confirm.callback=function(){var i;switch(e.inputType){case"text":case"textarea":case"email":case"select":case"date":case"time":case"number":case"password":i=c.val();break;case"checkbox":var o=c.find("input:checked");i=[],l(o,function(e,o){i.push(t(o).val())})}return e.callback.call(this,i)},e.show=!1,!e.title)throw new Error("prompt requires a title");if(!t.isFunction(e.callback))throw new Error("prompt requires a callback");if(!o.inputs[e.inputType])throw new Error("invalid prompt type");switch(c=t(o.inputs[e.inputType]),e.inputType){case"text":case"textarea":case"email":case"date":case"time":case"number":case"password":c.val(e.value);break;case"select":var m={};if(f=e.inputOptions||[],!t.isArray(f))throw new Error("Please pass an array of input options");if(!f.length)throw new Error("prompt with select requires options");l(f,function(e,o){var n=c;if(o.value===i||o.text===i)throw new Error("given options in wrong format");o.group&&(m[o.group]||(m[o.group]=t("<optgroup/>").attr("label",o.group)),n=m[o.group]),n.append("<option value='"+o.value+"'>"+o.text+"</option>")}),l(m,function(e,t){c.append(t)}),c.val(e.value);break;case"checkbox":var g=t.isArray(e.value)?e.value:[e.value];if(!(f=e.inputOptions||[]).length)throw new Error("prompt with checkbox requires options");if(!f[0].value||!f[0].text)throw new Error("given options in wrong format");c=t("<div/>"),l(f,function(i,n){var a=t(o.inputs[e.inputType]);a.find("input").attr("value",n.value),a.find("label").append(n.text),l(g,function(e,t){t===n.value&&a.find("input").prop("checked",!0)}),c.append(a)})}return e.placeholder&&c.attr("placeholder",e.placeholder),e.pattern&&c.attr("pattern",e.pattern),e.maxlength&&c.attr("maxlength",e.maxlength),s.append(c),s.on("submit",function(e){e.preventDefault(),e.stopPropagation(),r.find(".btn-primary").click()}),(r=a.dialog(e)).off("shown.bs.modal"),r.on("shown.bs.modal",function(){c.focus()}),!0===p&&r.modal("show"),r},a.dialog=function(e){e=function(e){var i,o;if("object"!=typeof e)throw new Error("Please supply an object of options");if(!e.message)throw new Error("Please specify a message");return(e=t.extend({},n,e)).buttons||(e.buttons={}),i=e.buttons,o=function(e){var t,i=0;for(t in e)i++;return i}(i),l(i,function(e,n,a){if(t.isFunction(n)&&(n=i[e]={callback:n}),"object"!==t.type(n))throw new Error("button with key "+e+" must be an object");n.label||(n.label=e),n.className||(n.className=o<=2&&a===o-1?"btn-primary":"btn-default")}),e}(e);var a=t(o.dialog),r=a.find(".modal-dialog"),d=a.find(".modal-body"),c=e.buttons,u="",h={onEscape:e.onEscape};if(t.fn.modal===i)throw new Error("$.fn.modal is not defined; please double check you have included the Bootstrap JavaScript library. See http://getbootstrap.com/javascript/ for more details.");if(l(c,function(e,t){u+="<button data-bb-handler='"+e+"' type='button' class='btn "+t.className+"'>"+t.label+"</button>",h[e]=t.callback}),d.find(".bootbox-body").html(e.message),!0===e.animate&&a.addClass("fade"),e.className&&a.addClass(e.className),"large"===e.size?r.addClass("modal-lg"):"small"===e.size&&r.addClass("modal-sm"),e.title&&d.before(o.header),e.closeButton){var p=t(o.closeButton);e.title?a.find(".modal-header").prepend(p):p.css("margin-top","-10px").prependTo(d)}return e.title&&a.find(".modal-title").html(e.title),u.length&&(d.after(o.footer),a.find(".modal-footer").html(u)),a.on("hidden.bs.modal",function(e){e.target===this&&a.remove()}),a.on("shown.bs.modal",function(){a.find(".btn-primary:first").focus()}),"static"!==e.backdrop&&a.on("click.dismiss.bs.modal",function(e){a.children(".modal-backdrop").length&&(e.currentTarget=a.children(".modal-backdrop").get(0)),e.target===e.currentTarget&&a.trigger("escape.close.bb")}),a.on("escape.close.bb",function(e){h.onEscape&&s(e,a,h.onEscape)}),a.on("click",".modal-footer button",function(e){var i=t(this).data("bb-handler");t(this).hasClass("disabled")||s(e,a,h[i])}),a.on("click",".bootbox-close-button",function(e){s(e,a,h.onEscape)}),a.on("keyup",function(e){27===e.which&&a.trigger("escape.close.bb")}),t(e.container).append(a),a.modal({backdrop:!!e.backdrop&&"static",keyboard:!1,show:!1}),e.show&&a.modal("show"),a},a.setDefaults=function(){var e={};2===arguments.length?e[arguments[0]]=arguments[1]:e=arguments[0],t.extend(n,e)},a.hideAll=function(){return t(".bootbox").modal("hide"),a};var p={bg_BG:{OK:"Ок",CANCEL:"Отказ",CONFIRM:"Потвърждавам"},br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},cs:{OK:"OK",CANCEL:"Zrušit",CONFIRM:"Potvrdit"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},el:{OK:"Εντάξει",CANCEL:"Ακύρωση",CONFIRM:"Επιβεβαίωση"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},et:{OK:"OK",CANCEL:"Katkesta",CONFIRM:"OK"},fa:{OK:"قبول",CANCEL:"لغو",CONFIRM:"تایید"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},he:{OK:"אישור",CANCEL:"ביטול",CONFIRM:"אישור"},hu:{OK:"OK",CANCEL:"Mégsem",CONFIRM:"Megerősít"},hr:{OK:"OK",CANCEL:"Odustani",CONFIRM:"Potvrdi"},id:{OK:"OK",CANCEL:"Batal",CONFIRM:"OK"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},ja:{OK:"OK",CANCEL:"キャンセル",CONFIRM:"確認"},lt:{OK:"Gerai",CANCEL:"Atšaukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"Apstiprināt"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierdź"},pt:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Confirmar"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},sq:{OK:"OK",CANCEL:"Anulo",CONFIRM:"Prano"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},th:{OK:"ตกลง",CANCEL:"ยกเลิก",CONFIRM:"ยืนยัน"},tr:{OK:"Tamam",CANCEL:"İptal",CONFIRM:"Onayla"},zh_CN:{OK:"OK",CANCEL:"取消",CONFIRM:"确认"},zh_TW:{OK:"OK",CANCEL:"取消",CONFIRM:"確認"}};return a.addLocale=function(e,i){return t.each(["OK","CANCEL","CONFIRM"],function(e,t){if(!i[t])throw new Error("Please supply a translation for '"+t+"'")}),p[e]={OK:i.OK,CANCEL:i.CANCEL,CONFIRM:i.CONFIRM},a},a.removeLocale=function(e){return delete p[e],a},a.setLocale=function(e){return a.setDefaults("locale",e)},a.init=function(i){return e(i||t)},a}),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");!function(e){"use strict";var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1==t[0]&&9==t[1]&&t[2]<1||t[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(jQuery),function(e){"use strict";e.fn.emulateTransitionEnd=function(t){var i=!1,o=this;e(this).one("bsTransitionEnd",function(){i=!0});return setTimeout(function(){i||e(o).trigger(e.support.transition.end)},t),this},e(function(){e.support.transition=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]};return!1}(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(e){"use strict";var t='[data-dismiss="alert"]',i=function(i){e(i).on("click",t,this.close)};i.VERSION="3.3.7",i.TRANSITION_DURATION=150,i.prototype.close=function(t){var o=e(this),n=o.attr("data-target");n||(n=(n=o.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,""));var a=e("#"===n?[]:n);function r(){a.detach().trigger("closed.bs.alert").remove()}t&&t.preventDefault(),a.length||(a=o.closest(".alert")),a.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(a.removeClass("in"),e.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",r).emulateTransitionEnd(i.TRANSITION_DURATION):r())};var o=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var o=e(this),n=o.data("bs.alert");n||o.data("bs.alert",n=new i(this)),"string"==typeof t&&n[t].call(o)})},e.fn.alert.Constructor=i,e.fn.alert.noConflict=function(){return e.fn.alert=o,this},e(document).on("click.bs.alert.data-api",t,i.prototype.close)}(jQuery),function(e){"use strict";var t=function(i,o){this.$element=e(i),this.options=e.extend({},t.DEFAULTS,o),this.isLoading=!1};function i(i){return this.each(function(){var o=e(this),n=o.data("bs.button"),a="object"==typeof i&&i;n||o.data("bs.button",n=new t(this,a)),"toggle"==i?n.toggle():i&&n.setState(i)})}t.VERSION="3.3.7",t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(t){var i="disabled",o=this.$element,n=o.is("input")?"val":"html",a=o.data();t+="Text",null==a.resetText&&o.data("resetText",o[n]()),setTimeout(e.proxy(function(){o[n](null==a[t]?this.options[t]:a[t]),"loadingText"==t?(this.isLoading=!0,o.addClass(i).attr(i,i).prop(i,!0)):this.isLoading&&(this.isLoading=!1,o.removeClass(i).removeAttr(i).prop(i,!1))},this),0)},t.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var i=this.$element.find("input");"radio"==i.prop("type")?(i.prop("checked")&&(e=!1),t.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==i.prop("type")&&(i.prop("checked")!==this.$element.hasClass("active")&&(e=!1),this.$element.toggleClass("active")),i.prop("checked",this.$element.hasClass("active")),e&&i.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var o=e.fn.button;e.fn.button=i,e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=o,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var o=e(t.target).closest(".btn");i.call(o,"toggle"),e(t.target).is('input[type="radio"], input[type="checkbox"]')||(t.preventDefault(),o.is("input,button")?o.trigger("focus"):o.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){e(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),function(e){"use strict";var t=function(t,i){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",e.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",e.proxy(this.pause,this)).on("mouseleave.bs.carousel",e.proxy(this.cycle,this))};function i(i){return this.each(function(){var o=e(this),n=o.data("bs.carousel"),a=e.extend({},t.DEFAULTS,o.data(),"object"==typeof i&&i),r="string"==typeof i?i:a.slide;n||o.data("bs.carousel",n=new t(this,a)),"number"==typeof i?n.to(i):r?n[r]():a.interval&&n.pause().cycle()})}t.VERSION="3.3.7",t.TRANSITION_DURATION=600,t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},t.prototype.keydown=function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()}},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},t.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},t.prototype.getItemForDirection=function(e,t){var i=this.getItemIndex(t);if(("prev"==e&&0===i||"next"==e&&i==this.$items.length-1)&&!this.options.wrap)return t;var o=(i+("prev"==e?-1:1))%this.$items.length;return this.$items.eq(o)},t.prototype.to=function(e){var t=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(e>this.$items.length-1||e<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){t.to(e)}):i==e?this.pause().cycle():this.slide(e>i?"next":"prev",this.$items.eq(e))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){if(!this.sliding)return this.slide("next")},t.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},t.prototype.slide=function(i,o){var n=this.$element.find(".item.active"),a=o||this.getItemForDirection(i,n),r=this.interval,s="next"==i?"left":"right",l=this;if(a.hasClass("active"))return this.sliding=!1;var d=a[0],c=e.Event("slide.bs.carousel",{relatedTarget:d,direction:s});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,r&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var u=e(this.$indicators.children()[this.getItemIndex(a)]);u&&u.addClass("active")}var h=e.Event("slid.bs.carousel",{relatedTarget:d,direction:s});return e.support.transition&&this.$element.hasClass("slide")?(a.addClass(i),a[0].offsetWidth,n.addClass(s),a.addClass(s),n.one("bsTransitionEnd",function(){a.removeClass([i,s].join(" ")).addClass("active"),n.removeClass(["active",s].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(h)},0)}).emulateTransitionEnd(t.TRANSITION_DURATION)):(n.removeClass("active"),a.addClass("active"),this.sliding=!1,this.$element.trigger(h)),r&&this.cycle(),this}};var o=e.fn.carousel;e.fn.carousel=i,e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=o,this};var n=function(t){var o,n=e(this),a=e(n.attr("data-target")||(o=n.attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,""));if(a.hasClass("carousel")){var r=e.extend({},a.data(),n.data()),s=n.attr("data-slide-to");s&&(r.interval=!1),i.call(a,r),s&&a.data("bs.carousel").to(s),t.preventDefault()}};e(document).on("click.bs.carousel.data-api","[data-slide]",n).on("click.bs.carousel.data-api","[data-slide-to]",n),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var t=e(this);i.call(t,t.data())})})}(jQuery),function(e){"use strict";var t=function(i,o){this.$element=e(i),this.options=e.extend({},t.DEFAULTS,o),this.$trigger=e('[data-toggle="collapse"][href="#'+i.id+'"],[data-toggle="collapse"][data-target="#'+i.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};function i(t){var i,o=t.attr("data-target")||(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return e(o)}function o(i){return this.each(function(){var o=e(this),n=o.data("bs.collapse"),a=e.extend({},t.DEFAULTS,o.data(),"object"==typeof i&&i);!n&&a.toggle&&/show|hide/.test(i)&&(a.toggle=!1),n||o.data("bs.collapse",n=new t(this,a)),"string"==typeof i&&n[i]()})}t.VERSION="3.3.7",t.TRANSITION_DURATION=350,t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},t.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var i,n=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(n&&n.length&&(i=n.data("bs.collapse"))&&i.transitioning)){var a=e.Event("show.bs.collapse");if(this.$element.trigger(a),!a.isDefaultPrevented()){n&&n.length&&(o.call(n,"hide"),i||n.data("bs.collapse",null));var r=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[r](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[r](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var l=e.camelCase(["scroll",r].join("-"));this.$element.one("bsTransitionEnd",e.proxy(s,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[r](this.$element[0][l])}}}},t.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var i=e.Event("hide.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){var o=this.dimension();this.$element[o](this.$element[o]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!e.support.transition)return n.call(this);this.$element[o](0).one("bsTransitionEnd",e.proxy(n,this)).emulateTransitionEnd(t.TRANSITION_DURATION)}}},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},t.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy(function(t,o){var n=e(o);this.addAriaAndCollapsedClass(i(n),n)},this)).end()},t.prototype.addAriaAndCollapsedClass=function(e,t){var i=e.hasClass("in");e.attr("aria-expanded",i),t.toggleClass("collapsed",!i).attr("aria-expanded",i)};var n=e.fn.collapse;e.fn.collapse=o,e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var n=e(this);n.attr("data-target")||t.preventDefault();var a=i(n),r=a.data("bs.collapse")?"toggle":n.data();o.call(a,r)})}(jQuery),function(e){"use strict";var t=".dropdown-backdrop",i='[data-toggle="dropdown"]',o=function(t){e(t).on("click.bs.dropdown",this.toggle)};function n(t){var i=t.attr("data-target");i||(i=(i=t.attr("href"))&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var o=i&&e(i);return o&&o.length?o:t.parent()}function a(o){o&&3===o.which||(e(t).remove(),e(i).each(function(){var t=e(this),i=n(t),a={relatedTarget:this};i.hasClass("open")&&(o&&"click"==o.type&&/input|textarea/i.test(o.target.tagName)&&e.contains(i[0],o.target)||(i.trigger(o=e.Event("hide.bs.dropdown",a)),o.isDefaultPrevented()||(t.attr("aria-expanded","false"),i.removeClass("open").trigger(e.Event("hidden.bs.dropdown",a)))))}))}o.VERSION="3.3.7",o.prototype.toggle=function(t){var i=e(this);if(!i.is(".disabled, :disabled")){var o=n(i),r=o.hasClass("open");if(a(),!r){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&e(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(e(this)).on("click",a);var s={relatedTarget:this};if(o.trigger(t=e.Event("show.bs.dropdown",s)),t.isDefaultPrevented())return;i.trigger("focus").attr("aria-expanded","true"),o.toggleClass("open").trigger(e.Event("shown.bs.dropdown",s))}return!1}},o.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)){var o=e(this);if(t.preventDefault(),t.stopPropagation(),!o.is(".disabled, :disabled")){var a=n(o),r=a.hasClass("open");if(!r&&27!=t.which||r&&27==t.which)return 27==t.which&&a.find(i).trigger("focus"),o.trigger("click");var s=a.find(".dropdown-menu li:not(.disabled):visible a");if(s.length){var l=s.index(t.target);38==t.which&&l>0&&l--,40==t.which&&l<s.length-1&&l++,~l||(l=0),s.eq(l).trigger("focus")}}}};var r=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var i=e(this),n=i.data("bs.dropdown");n||i.data("bs.dropdown",n=new o(this)),"string"==typeof t&&n[t].call(i)})},e.fn.dropdown.Constructor=o,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=r,this},e(document).on("click.bs.dropdown.data-api",a).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",i,o.prototype.toggle).on("keydown.bs.dropdown.data-api",i,o.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",o.prototype.keydown)}(jQuery),function(e){"use strict";var t=function(t,i){this.options=i,this.$body=e(document.body),this.$element=e(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};function i(i,o){return this.each(function(){var n=e(this),a=n.data("bs.modal"),r=e.extend({},t.DEFAULTS,n.data(),"object"==typeof i&&i);a||n.data("bs.modal",a=new t(this,r)),"string"==typeof i?a[i](o):r.show&&a.show(o)})}t.VERSION="3.3.7",t.TRANSITION_DURATION=300,t.BACKDROP_TRANSITION_DURATION=150,t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},t.prototype.show=function(i){var o=this,n=e.Event("show.bs.modal",{relatedTarget:i});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){o.$element.one("mouseup.dismiss.bs.modal",function(t){e(t.target).is(o.$element)&&(o.ignoreBackdropClick=!0)})}),this.backdrop(function(){var n=e.support.transition&&o.$element.hasClass("fade");o.$element.parent().length||o.$element.appendTo(o.$body),o.$element.show().scrollTop(0),o.adjustDialog(),n&&o.$element[0].offsetWidth,o.$element.addClass("in"),o.enforceFocus();var a=e.Event("shown.bs.modal",{relatedTarget:i});n?o.$dialog.one("bsTransitionEnd",function(){o.$element.trigger("focus").trigger(a)}).emulateTransitionEnd(t.TRANSITION_DURATION):o.$element.trigger("focus").trigger(a)}))},t.prototype.hide=function(i){i&&i.preventDefault(),i=e.Event("hide.bs.modal"),this.$element.trigger(i),this.isShown&&!i.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){document===e.target||this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},t.prototype.resize=function(){this.isShown?e(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):e(window).off("resize.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(i){var o=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var a=e.support.transition&&n;if(this.$backdrop=e(document.createElement("div")).addClass("modal-backdrop "+n).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),a&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!i)return;a?this.$backdrop.one("bsTransitionEnd",i).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):i()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var r=function(){o.removeBackdrop(),i&&i()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",r).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):r()}else i&&i()},t.prototype.handleUpdate=function(){this.adjustDialog()},t.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},t.prototype.checkScrollbar=function(){var e=window.innerWidth;if(!e){var t=document.documentElement.getBoundingClientRect();e=t.right-Math.abs(t.left)}this.bodyIsOverflowing=document.body.clientWidth<e,this.scrollbarWidth=this.measureScrollbar()},t.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth)},t.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},t.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var o=e.fn.modal;e.fn.modal=i,e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=o,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var o=e(this),n=o.attr("href"),a=e(o.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),r=a.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(n)&&n},a.data(),o.data());o.is("a")&&t.preventDefault(),a.one("show.bs.modal",function(e){e.isDefaultPrevented()||a.one("hidden.bs.modal",function(){o.is(":visible")&&o.trigger("focus")})}),i.call(a,r,this)})}(jQuery),function(e){"use strict";var t=function(e,t){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",e,t)};t.VERSION="3.3.7",t.TRANSITION_DURATION=150,t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},t.prototype.init=function(t,i,o){if(this.enabled=!0,this.type=t,this.$element=e(i),this.options=this.getOptions(o),this.$viewport=this.options.viewport&&e(e.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var n=this.options.trigger.split(" "),a=n.length;a--;){var r=n[a];if("click"==r)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=r){var s="hover"==r?"mouseenter":"focusin",l="hover"==r?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return(t=e.extend({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&e.each(this._options,function(e,o){i[e]!=o&&(t[e]=o)}),t},t.prototype.enter=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),t instanceof e.Event&&(i.inState["focusin"==t.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState)i.hoverState="in";else{if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)}},t.prototype.isInStateTrue=function(){for(var e in this.inState)if(this.inState[e])return!0;return!1},t.prototype.leave=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),t instanceof e.Event&&(i.inState["focusout"==t.type?"focus":"hover"]=!1),!i.isInStateTrue()){if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)}},t.prototype.show=function(){var i=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(i);var o=e.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(i.isDefaultPrevented()||!o)return;var n=this,a=this.tip(),r=this.getUID(this.type);this.setContent(),a.attr("id",r),this.$element.attr("aria-describedby",r),this.options.animation&&a.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,d=l.test(s);d&&(s=s.replace(l,"")||"top"),a.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?a.appendTo(this.options.container):a.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var c=this.getPosition(),u=a[0].offsetWidth,h=a[0].offsetHeight;if(d){var p=s,f=this.getPosition(this.$viewport);s="bottom"==s&&c.bottom+h>f.bottom?"top":"top"==s&&c.top-h<f.top?"bottom":"right"==s&&c.right+u>f.width?"left":"left"==s&&c.left-u<f.left?"right":s,a.removeClass(p).addClass(s)}var m=this.getCalculatedOffset(s,c,u,h);this.applyPlacement(m,s);var g=function(){var e=n.hoverState;n.$element.trigger("shown.bs."+n.type),n.hoverState=null,"out"==e&&n.leave(n)};e.support.transition&&this.$tip.hasClass("fade")?a.one("bsTransitionEnd",g).emulateTransitionEnd(t.TRANSITION_DURATION):g()}},t.prototype.applyPlacement=function(t,i){var o=this.tip(),n=o[0].offsetWidth,a=o[0].offsetHeight,r=parseInt(o.css("margin-top"),10),s=parseInt(o.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(s)&&(s=0),t.top+=r,t.left+=s,e.offset.setOffset(o[0],e.extend({using:function(e){o.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),o.addClass("in");var l=o[0].offsetWidth,d=o[0].offsetHeight;"top"==i&&d!=a&&(t.top=t.top+a-d);var c=this.getViewportAdjustedDelta(i,t,l,d);c.left?t.left+=c.left:t.top+=c.top;var u=/top|bottom/.test(i),h=u?2*c.left-n+l:2*c.top-a+d,p=u?"offsetWidth":"offsetHeight";o.offset(t),this.replaceArrow(h,o[0][p],u)},t.prototype.replaceArrow=function(e,t,i){this.arrow().css(i?"left":"top",50*(1-e/t)+"%").css(i?"top":"left","")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(i){var o=this,n=e(this.$tip),a=e.Event("hide.bs."+this.type);function r(){"in"!=o.hoverState&&n.detach(),o.$element&&o.$element.removeAttr("aria-describedby").trigger("hidden.bs."+o.type),i&&i()}if(this.$element.trigger(a),!a.isDefaultPrevented())return n.removeClass("in"),e.support.transition&&n.hasClass("fade")?n.one("bsTransitionEnd",r).emulateTransitionEnd(t.TRANSITION_DURATION):r(),this.hoverState=null,this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(t){var i=(t=t||this.$element)[0],o="BODY"==i.tagName,n=i.getBoundingClientRect();null==n.width&&(n=e.extend({},n,{width:n.right-n.left,height:n.bottom-n.top}));var a=window.SVGElement&&i instanceof window.SVGElement,r=o?{top:0,left:0}:a?null:t.offset(),s={scroll:o?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},l=o?{width:e(window).width(),height:e(window).height()}:null;return e.extend({},n,s,l,r)},t.prototype.getCalculatedOffset=function(e,t,i,o){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-o,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-o/2,left:t.left-i}:{top:t.top+t.height/2-o/2,left:t.left+t.width}},t.prototype.getViewportAdjustedDelta=function(e,t,i,o){var n={top:0,left:0};if(!this.$viewport)return n;var a=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(e)){var s=t.top-a-r.scroll,l=t.top+a-r.scroll+o;s<r.top?n.top=r.top-s:l>r.top+r.height&&(n.top=r.top+r.height-l)}else{var d=t.left-a,c=t.left+a+i;d<r.left?n.left=r.left-d:c>r.right&&(n.left=r.left+r.width-c)}return n},t.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},t.prototype.getUID=function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},t.prototype.tip=function(){if(!this.$tip&&(this.$tip=e(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var i=this;t&&((i=e(t.currentTarget).data("bs."+this.type))||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i))),t?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},t.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs."+e.type),e.$tip&&e.$tip.detach(),e.$tip=null,e.$arrow=null,e.$viewport=null,e.$element=null})};var i=e.fn.tooltip;e.fn.tooltip=function(i){return this.each(function(){var o=e(this),n=o.data("bs.tooltip"),a="object"==typeof i&&i;!n&&/destroy|hide/.test(i)||(n||o.data("bs.tooltip",n=new t(this,a)),"string"==typeof i&&n[i]())})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(jQuery),function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.7",t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof i?"html":"append":"text"](i),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var i=e.fn.popover;e.fn.popover=function(i){return this.each(function(){var o=e(this),n=o.data("bs.popover"),a="object"==typeof i&&i;!n&&/destroy|hide/.test(i)||(n||o.data("bs.popover",n=new t(this,a)),"string"==typeof i&&n[i]())})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=i,this}}(jQuery),function(e){"use strict";function t(i,o){this.$body=e(document.body),this.$scrollElement=e(i).is(document.body)?e(window):e(i),this.options=e.extend({},t.DEFAULTS,o),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",e.proxy(this.process,this)),this.refresh(),this.process()}function i(i){return this.each(function(){var o=e(this),n=o.data("bs.scrollspy"),a="object"==typeof i&&i;n||o.data("bs.scrollspy",n=new t(this,a)),"string"==typeof i&&n[i]()})}t.VERSION="3.3.7",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t=this,i="offset",o=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),e.isWindow(this.$scrollElement[0])||(i="position",o=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var t=e(this),n=t.data("target")||t.attr("href"),a=/^#./.test(n)&&e(n);return a&&a.length&&a.is(":visible")&&[[a[i]().top+o,n]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),o=this.options.offset+i-this.$scrollElement.height(),n=this.offsets,a=this.targets,r=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),t>=o)return r!=(e=a[a.length-1])&&this.activate(e);if(r&&t<n[0])return this.activeTarget=null,this.clear();for(e=n.length;e--;)r!=a[e]&&t>=n[e]&&(void 0===n[e+1]||t<n[e+1])&&this.activate(a[e])},t.prototype.activate=function(t){this.activeTarget=t,this.clear();var i=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',o=e(i).parents("li").addClass("active");o.parent(".dropdown-menu").length&&(o=o.closest("li.dropdown").addClass("active")),o.trigger("activate.bs.scrollspy")},t.prototype.clear=function(){e(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var o=e.fn.scrollspy;e.fn.scrollspy=i,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=o,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);i.call(t,t.data())})})}(jQuery),function(e){"use strict";var t=function(t){this.element=e(t)};function i(i){return this.each(function(){var o=e(this),n=o.data("bs.tab");n||o.data("bs.tab",n=new t(this)),"string"==typeof i&&n[i]()})}t.VERSION="3.3.7",t.TRANSITION_DURATION=150,t.prototype.show=function(){var t=this.element,i=t.closest("ul:not(.dropdown-menu)"),o=t.data("target");if(o||(o=(o=t.attr("href"))&&o.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var n=i.find(".active:last a"),a=e.Event("hide.bs.tab",{relatedTarget:t[0]}),r=e.Event("show.bs.tab",{relatedTarget:n[0]});if(n.trigger(a),t.trigger(r),!r.isDefaultPrevented()&&!a.isDefaultPrevented()){var s=e(o);this.activate(t.closest("li"),i),this.activate(s,s.parent(),function(){n.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:n[0]})})}}},t.prototype.activate=function(i,o,n){var a=o.find("> .active"),r=n&&e.support.transition&&(a.length&&a.hasClass("fade")||!!o.find("> .fade").length);function s(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),i.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),r?(i[0].offsetWidth,i.addClass("in")):i.removeClass("fade"),i.parent(".dropdown-menu").length&&i.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),n&&n()}a.length&&r?a.one("bsTransitionEnd",s).emulateTransitionEnd(t.TRANSITION_DURATION):s(),a.removeClass("in")};var o=e.fn.tab;e.fn.tab=i,e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=o,this};var n=function(t){t.preventDefault(),i.call(e(this),"show")};e(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',n).on("click.bs.tab.data-api",'[data-toggle="pill"]',n)}(jQuery),function(e){"use strict";var t=function(i,o){this.options=e.extend({},t.DEFAULTS,o),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(i),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};function i(i){return this.each(function(){var o=e(this),n=o.data("bs.affix"),a="object"==typeof i&&i;n||o.data("bs.affix",n=new t(this,a)),"string"==typeof i&&n[i]()})}t.VERSION="3.3.7",t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0,target:window},t.prototype.getState=function(e,t,i,o){var n=this.$target.scrollTop(),a=this.$element.offset(),r=this.$target.height();if(null!=i&&"top"==this.affixed)return n<i&&"top";if("bottom"==this.affixed)return null!=i?!(n+this.unpin<=a.top)&&"bottom":!(n+r<=e-o)&&"bottom";var s=null==this.affixed,l=s?n:a.top;return null!=i&&n<=i?"top":null!=o&&l+(s?r:t)>=e-o&&"bottom"},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var e=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=this.$element.height(),o=this.options.offset,n=o.top,a=o.bottom,r=Math.max(e(document).height(),e(document.body).height());"object"!=typeof o&&(a=n=o),"function"==typeof n&&(n=o.top(this.$element)),"function"==typeof a&&(a=o.bottom(this.$element));var s=this.getState(r,i,n,a);if(this.affixed!=s){null!=this.unpin&&this.$element.css("top","");var l="affix"+(s?"-"+s:""),d=e.Event(l+".bs.affix");if(this.$element.trigger(d),d.isDefaultPrevented())return;this.affixed=s,this.unpin="bottom"==s?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==s&&this.$element.offset({top:r-i-a})}};var o=e.fn.affix;e.fn.affix=i,e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=o,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),o=t.data();o.offset=o.offset||{},null!=o.offsetBottom&&(o.offset.bottom=o.offsetBottom),null!=o.offsetTop&&(o.offset.top=o.offsetTop),i.call(t,o)})})}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(e){var t=/\+/g;function i(e){return n.raw?e:encodeURIComponent(e)}function o(i,o){var a=n.raw?i:function(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),n.json?JSON.parse(e):e}catch(e){}}(i);return e.isFunction(o)?o(a):a}var n=e.cookie=function(t,a,r){if(void 0!==a&&!e.isFunction(a)){if("number"==typeof(r=e.extend({},n.defaults,r)).expires){var s=r.expires,l=r.expires=new Date;l.setTime(+l+864e5*s)}return document.cookie=[i(t),"=",function(e){return i(n.json?JSON.stringify(e):String(e))}(a),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("")}for(var d,c=t?void 0:{},u=document.cookie?document.cookie.split("; "):[],h=0,p=u.length;h<p;h++){var f=u[h].split("="),m=(d=f.shift(),n.raw?d:decodeURIComponent(d)),g=f.join("=");if(t&&t===m){c=o(g,a);break}t||void 0===(g=o(g))||(c[m]=g)}return c};n.defaults={},e.removeCookie=function(t,i){return void 0!==e.cookie(t)&&(e.cookie(t,"",e.extend({},i,{expires:-1})),!e.cookie(t))}}),function(e,t,i,o){"use strict";var n,a=["","webkit","Moz","MS","ms","o"],r=t.createElement("div"),s="function",l=Math.round,d=Math.abs,c=Date.now;function u(e,t,i){return setTimeout(b(e,i),t)}function h(e,t,i){return!!Array.isArray(e)&&(p(e,i[t],i),!0)}function p(e,t,i){var n;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==o)for(n=0;n<e.length;)t.call(i,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n,e)}function f(t,i,o){var n="DEPRECATED METHOD: "+i+"\n"+o+" AT \n";return function(){var i=new Error("get-stack-trace"),o=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=e.console&&(e.console.warn||e.console.log);return a&&a.call(e.console,n,o),t.apply(this,arguments)}}n="function"!=typeof Object.assign?function(e){if(e===o||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==o&&null!==n)for(var a in n)n.hasOwnProperty(a)&&(t[a]=n[a])}return t}:Object.assign;var m=f(function(e,t,i){for(var n=Object.keys(t),a=0;a<n.length;)(!i||i&&e[n[a]]===o)&&(e[n[a]]=t[n[a]]),a++;return e},"extend","Use `assign`."),g=f(function(e,t){return m(e,t,!0)},"merge","Use `assign`.");function v(e,t,i){var o,a=t.prototype;(o=e.prototype=Object.create(a)).constructor=e,o._super=a,i&&n(o,i)}function b(e,t){return function(){return e.apply(t,arguments)}}function y(e,t){return typeof e==s?e.apply(t&&t[0]||o,t):e}function w(e,t){return e===o?t:e}function _(e,t,i){p(T(t),function(t){e.addEventListener(t,i,!1)})}function S(e,t,i){p(T(t),function(t){e.removeEventListener(t,i,!1)})}function C(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function k(e,t){return e.indexOf(t)>-1}function T(e){return e.trim().split(/\s+/g)}function $(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var o=0;o<e.length;){if(i&&e[o][i]==t||!i&&e[o]===t)return o;o++}return-1}function x(e){return Array.prototype.slice.call(e,0)}function E(e,t,i){for(var o=[],n=[],a=0;a<e.length;){var r=t?e[a][t]:e[a];$(n,r)<0&&o.push(e[a]),n[a]=r,a++}return i&&(o=t?o.sort(function(e,i){return e[t]>i[t]}):o.sort()),o}function A(e,t){for(var i,n,r=t[0].toUpperCase()+t.slice(1),s=0;s<a.length;){if((n=(i=a[s])?i+r:t)in e)return n;s++}return o}var L=1;function I(t){var i=t.ownerDocument||t;return i.defaultView||i.parentWindow||e}var M="ontouchstart"in e,D=A(e,"PointerEvent")!==o,O=M&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),P=25,R=1,N=2,B=4,j=8,F=1,H=2,U=4,z=8,G=16,V=H|U,W=z|G,q=V|W,Y=["x","y"],X=["clientX","clientY"];function K(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){y(e.options.enable,[e])&&i.handler(t)},this.init()}function J(e,t,i){var n=i.pointers.length,a=i.changedPointers.length,r=t&R&&n-a==0,s=t&(B|j)&&n-a==0;i.isFirst=!!r,i.isFinal=!!s,r&&(e.session={}),i.eventType=t,function(e,t){var i=e.session,n=t.pointers,a=n.length;i.firstInput||(i.firstInput=Q(t));a>1&&!i.firstMultiple?i.firstMultiple=Q(t):1===a&&(i.firstMultiple=!1);var r=i.firstInput,s=i.firstMultiple,l=s?s.center:r.center,u=t.center=Z(n);t.timeStamp=c(),t.deltaTime=t.timeStamp-r.timeStamp,t.angle=oe(l,u),t.distance=ie(l,u),function(e,t){var i=t.center,o=e.offsetDelta||{},n=e.prevDelta||{},a=e.prevInput||{};t.eventType!==R&&a.eventType!==B||(n=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},o=e.offsetDelta={x:i.x,y:i.y});t.deltaX=n.x+(i.x-o.x),t.deltaY=n.y+(i.y-o.y)}(i,t),t.offsetDirection=te(t.deltaX,t.deltaY);var h=ee(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=h.x,t.overallVelocityY=h.y,t.overallVelocity=d(h.x)>d(h.y)?h.x:h.y,t.scale=s?(p=s.pointers,f=n,ie(f[0],f[1],X)/ie(p[0],p[1],X)):1,t.rotation=s?function(e,t){return oe(t[1],t[0],X)+oe(e[1],e[0],X)}(s.pointers,n):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,function(e,t){var i,n,a,r,s=e.lastInterval||t,l=t.timeStamp-s.timeStamp;if(t.eventType!=j&&(l>P||s.velocity===o)){var c=t.deltaX-s.deltaX,u=t.deltaY-s.deltaY,h=ee(l,c,u);n=h.x,a=h.y,i=d(h.x)>d(h.y)?h.x:h.y,r=te(c,u),e.lastInterval=t}else i=s.velocity,n=s.velocityX,a=s.velocityY,r=s.direction;t.velocity=i,t.velocityX=n,t.velocityY=a,t.direction=r}(i,t);var p,f;var m=e.element;C(t.srcEvent.target,m)&&(m=t.srcEvent.target);t.target=m}(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function Q(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:l(e.pointers[i].clientX),clientY:l(e.pointers[i].clientY)},i++;return{timeStamp:c(),pointers:t,center:Z(t),deltaX:e.deltaX,deltaY:e.deltaY}}function Z(e){var t=e.length;if(1===t)return{x:l(e[0].clientX),y:l(e[0].clientY)};for(var i=0,o=0,n=0;n<t;)i+=e[n].clientX,o+=e[n].clientY,n++;return{x:l(i/t),y:l(o/t)}}function ee(e,t,i){return{x:t/e||0,y:i/e||0}}function te(e,t){return e===t?F:d(e)>=d(t)?e<0?H:U:t<0?z:G}function ie(e,t,i){i||(i=Y);var o=t[i[0]]-e[i[0]],n=t[i[1]]-e[i[1]];return Math.sqrt(o*o+n*n)}function oe(e,t,i){i||(i=Y);var o=t[i[0]]-e[i[0]],n=t[i[1]]-e[i[1]];return 180*Math.atan2(n,o)/Math.PI}K.prototype={handler:function(){},init:function(){this.evEl&&_(this.element,this.evEl,this.domHandler),this.evTarget&&_(this.target,this.evTarget,this.domHandler),this.evWin&&_(I(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(I(this.element),this.evWin,this.domHandler)}};var ne={mousedown:R,mousemove:N,mouseup:B},ae="mousedown",re="mousemove mouseup";function se(){this.evEl=ae,this.evWin=re,this.pressed=!1,K.apply(this,arguments)}v(se,K,{handler:function(e){var t=ne[e.type];t&R&&0===e.button&&(this.pressed=!0),t&N&&1!==e.which&&(t=B),this.pressed&&(t&B&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var le={pointerdown:R,pointermove:N,pointerup:B,pointercancel:j,pointerout:j},de={2:"touch",3:"pen",4:"mouse",5:"kinect"},ce="pointerdown",ue="pointermove pointerup pointercancel";function he(){this.evEl=ce,this.evWin=ue,K.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}e.MSPointerEvent&&!e.PointerEvent&&(ce="MSPointerDown",ue="MSPointerMove MSPointerUp MSPointerCancel"),v(he,K,{handler:function(e){var t=this.store,i=!1,o=e.type.toLowerCase().replace("ms",""),n=le[o],a=de[e.pointerType]||e.pointerType,r="touch"==a,s=$(t,e.pointerId,"pointerId");n&R&&(0===e.button||r)?s<0&&(t.push(e),s=t.length-1):n&(B|j)&&(i=!0),s<0||(t[s]=e,this.callback(this.manager,n,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),i&&t.splice(s,1))}});var pe={touchstart:R,touchmove:N,touchend:B,touchcancel:j},fe="touchstart",me="touchstart touchmove touchend touchcancel";function ge(){this.evTarget=fe,this.evWin=me,this.started=!1,K.apply(this,arguments)}v(ge,K,{handler:function(e){var t=pe[e.type];if(t===R&&(this.started=!0),this.started){var i=function(e,t){var i=x(e.touches),o=x(e.changedTouches);t&(B|j)&&(i=E(i.concat(o),"identifier",!0));return[i,o]}.call(this,e,t);t&(B|j)&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}}});var ve={touchstart:R,touchmove:N,touchend:B,touchcancel:j},be="touchstart touchmove touchend touchcancel";function ye(){this.evTarget=be,this.targetIds={},K.apply(this,arguments)}v(ye,K,{handler:function(e){var t=ve[e.type],i=function(e,t){var i=x(e.touches),o=this.targetIds;if(t&(R|N)&&1===i.length)return o[i[0].identifier]=!0,[i,i];var n,a,r=x(e.changedTouches),s=[],l=this.target;if(a=i.filter(function(e){return C(e.target,l)}),t===R)for(n=0;n<a.length;)o[a[n].identifier]=!0,n++;n=0;for(;n<r.length;)o[r[n].identifier]&&s.push(r[n]),t&(B|j)&&delete o[r[n].identifier],n++;if(!s.length)return;return[E(a.concat(s),"identifier",!0),s]}.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}});var we=2500,_e=25;function Se(){K.apply(this,arguments);var e=b(this.handler,this);this.touch=new ye(this.manager,e),this.mouse=new se(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Ce(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var o=this.lastTouches;setTimeout(function(){var e=o.indexOf(i);e>-1&&o.splice(e,1)},we)}}v(Se,K,{handler:function(e,t,i){var o="touch"==i.pointerType,n="mouse"==i.pointerType;if(!(n&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(o)(function(e,t){e&R?(this.primaryTouch=t.changedPointers[0].identifier,Ce.call(this,t)):e&(B|j)&&Ce.call(this,t)}).call(this,t,i);else if(n&&function(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,o=0;o<this.lastTouches.length;o++){var n=this.lastTouches[o],a=Math.abs(t-n.x),r=Math.abs(i-n.y);if(a<=_e&&r<=_e)return!0}return!1}.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ke=A(r.style,"touchAction"),Te=ke!==o,$e="auto",xe="manipulation",Ee="none",Ae="pan-x",Le="pan-y",Ie=function(){if(!Te)return!1;var t={},i=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(o){t[o]=!i||e.CSS.supports("touch-action",o)}),t}();function Me(e,t){this.manager=e,this.set(t)}Me.prototype={set:function(e){"compute"==e&&(e=this.compute()),Te&&this.manager.element.style&&Ie[e]&&(this.manager.element.style[ke]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return p(this.manager.recognizers,function(t){y(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(k(e,Ee))return Ee;var t=k(e,Ae),i=k(e,Le);if(t&&i)return Ee;if(t||i)return t?Ae:Le;if(k(e,xe))return xe;return $e}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var o=this.actions,n=k(o,Ee)&&!Ie[Ee],a=k(o,Le)&&!Ie[Le],r=k(o,Ae)&&!Ie[Ae];if(n){var s=1===e.pointers.length,l=e.distance<2,d=e.deltaTime<250;if(s&&l&&d)return}if(!r||!a)return n||a&&i&V||r&&i&W?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var De=1,Oe=2,Pe=4,Re=8,Ne=Re,Be=16;function je(e){this.options=n({},this.defaults,e||{}),this.id=L++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=De,this.simultaneous={},this.requireFail=[]}function Fe(e){return e&Be?"cancel":e&Re?"end":e&Pe?"move":e&Oe?"start":""}function He(e){return e==G?"down":e==z?"up":e==H?"left":e==U?"right":""}function Ue(e,t){var i=t.manager;return i?i.get(e):e}function ze(){je.apply(this,arguments)}function Ge(){ze.apply(this,arguments),this.pX=null,this.pY=null}function Ve(){ze.apply(this,arguments)}function We(){je.apply(this,arguments),this._timer=null,this._input=null}function qe(){ze.apply(this,arguments)}function Ye(){ze.apply(this,arguments)}function Xe(){je.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ke(e,t){return(t=t||{}).recognizers=w(t.recognizers,Ke.defaults.preset),new Je(e,t)}je.prototype={defaults:{},set:function(e){return n(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(h(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Ue(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return h(e,"dropRecognizeWith",this)?this:(e=Ue(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(h(e,"requireFailure",this))return this;var t=this.requireFail;return-1===$(t,e=Ue(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(h(e,"dropRequireFailure",this))return this;e=Ue(e,this);var t=$(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,i=this.state;function o(i){t.manager.emit(i,e)}i<Re&&o(t.options.event+Fe(i)),o(t.options.event),e.additionalEvent&&o(e.additionalEvent),i>=Re&&o(t.options.event+Fe(i))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|De)))return!1;e++}return!0},recognize:function(e){var t=n({},e);if(!y(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(Ne|Be|32)&&(this.state=De),this.state=this.process(t),this.state&(Oe|Pe|Re|Be)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},v(ze,je,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,o=t&(Oe|Pe),n=this.attrTest(e);return o&&(i&j||!n)?t|Be:o||n?i&B?t|Re:t&Oe?t|Pe:Oe:32}}),v(Ge,ze,{defaults:{event:"pan",threshold:10,pointers:1,direction:q},getTouchAction:function(){var e=this.options.direction,t=[];return e&V&&t.push(Le),e&W&&t.push(Ae),t},directionTest:function(e){var t=this.options,i=!0,o=e.distance,n=e.direction,a=e.deltaX,r=e.deltaY;return n&t.direction||(t.direction&V?(n=0===a?F:a<0?H:U,i=a!=this.pX,o=Math.abs(e.deltaX)):(n=0===r?F:r<0?z:G,i=r!=this.pY,o=Math.abs(e.deltaY))),e.direction=n,i&&o>t.threshold&&n&t.direction},attrTest:function(e){return ze.prototype.attrTest.call(this,e)&&(this.state&Oe||!(this.state&Oe)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=He(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),v(Ve,ze,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ee]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&Oe)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),v(We,je,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[$e]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,o=e.distance<t.threshold,n=e.deltaTime>t.time;if(this._input=e,!o||!i||e.eventType&(B|j)&&!n)this.reset();else if(e.eventType&R)this.reset(),this._timer=u(function(){this.state=Ne,this.tryEmit()},t.time,this);else if(e.eventType&B)return Ne;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===Ne&&(e&&e.eventType&B?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=c(),this.manager.emit(this.options.event,this._input)))}}),v(qe,ze,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ee]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&Oe)}}),v(Ye,ze,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:V|W,pointers:1},getTouchAction:function(){return Ge.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return i&(V|W)?t=e.overallVelocity:i&V?t=e.overallVelocityX:i&W&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&e.eventType&B},emit:function(e){var t=He(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),v(Xe,je,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xe]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,o=e.distance<t.threshold,n=e.deltaTime<t.time;if(this.reset(),e.eventType&R&&0===this.count)return this.failTimeout();if(o&&n&&i){if(e.eventType!=B)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,r=!this.pCenter||ie(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,r&&a?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=u(function(){this.state=Ne,this.tryEmit()},t.interval,this),Oe):Ne}return 32},failTimeout:function(){return this._timer=u(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ne&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ke.VERSION="2.0.8",Ke.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[qe,{enable:!1}],[Ve,{enable:!1},["rotate"]],[Ye,{direction:V}],[Ge,{direction:V},["swipe"]],[Xe],[Xe,{event:"doubletap",taps:2},["tap"]],[We]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Je(e,t){var i;this.options=n({},Ke.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((i=this).options.inputClass||(D?he:O?ye:M?Se:se))(i,J),this.touchAction=new Me(this,this.options.touchAction),Qe(this,!0),p(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Qe(e,t){var i,o=e.element;o.style&&(p(e.options.cssProps,function(n,a){i=A(o.style,a),t?(e.oldCssProps[i]=o.style[i],o.style[i]=n):o.style[i]=e.oldCssProps[i]||""}),t||(e.oldCssProps={}))}Je.prototype={set:function(e){return n(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var i;this.touchAction.preventDefaults(e);var o=this.recognizers,n=t.curRecognizer;(!n||n&&n.state&Ne)&&(n=t.curRecognizer=null);for(var a=0;a<o.length;)i=o[a],2===t.stopped||n&&i!=n&&!i.canRecognizeWith(n)?i.reset():i.recognize(e),!n&&i.state&(Oe|Pe|Re)&&(n=t.curRecognizer=i),a++}},get:function(e){if(e instanceof je)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(h(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(h(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=$(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(e!==o&&t!==o){var i=this.handlers;return p(T(e),function(e){i[e]=i[e]||[],i[e].push(t)}),this}},off:function(e,t){if(e!==o){var i=this.handlers;return p(T(e),function(e){t?i[e]&&i[e].splice($(i[e],t),1):delete i[e]}),this}},emit:function(e,i){this.options.domEvents&&function(e,i){var o=t.createEvent("Event");o.initEvent(e,!0,!0),o.gesture=i,i.target.dispatchEvent(o)}(e,i);var o=this.handlers[e]&&this.handlers[e].slice();if(o&&o.length){i.type=e,i.preventDefault=function(){i.srcEvent.preventDefault()};for(var n=0;n<o.length;)o[n](i),n++}},destroy:function(){this.element&&Qe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},n(Ke,{INPUT_START:R,INPUT_MOVE:N,INPUT_END:B,INPUT_CANCEL:j,STATE_POSSIBLE:De,STATE_BEGAN:Oe,STATE_CHANGED:Pe,STATE_ENDED:Re,STATE_RECOGNIZED:Ne,STATE_CANCELLED:Be,STATE_FAILED:32,DIRECTION_NONE:F,DIRECTION_LEFT:H,DIRECTION_RIGHT:U,DIRECTION_UP:z,DIRECTION_DOWN:G,DIRECTION_HORIZONTAL:V,DIRECTION_VERTICAL:W,DIRECTION_ALL:q,Manager:Je,Input:K,TouchAction:Me,TouchInput:ye,MouseInput:se,PointerEventInput:he,TouchMouseInput:Se,SingleTouchInput:ge,Recognizer:je,AttrRecognizer:ze,Tap:Xe,Pan:Ge,Swipe:Ye,Pinch:Ve,Rotate:qe,Press:We,on:_,off:S,each:p,merge:g,extend:m,assign:n,inherit:v,bindFn:b,prefixed:A}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=Ke,"function"==typeof define&&define.amd?define(function(){return Ke}):"undefined"!=typeof module&&module.exports?module.exports=Ke:e.Hammer=Ke}(window,document),function(e){"use strict";Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;return function(){return t.apply(e)}});var t=0;function i(e,t){return new i.prototype.init(e,t)}e.fn.redactor=function(t){var o=[],n=Array.prototype.slice.call(arguments,1);return"string"==typeof t?this.each(function(){var i,a=e.data(this,"redactor");if("-1"!=t.search(/\./)?void 0!==a[(i=t.split("."))[0]]&&(i=a[i[0]][i[1]]):i=a[t],void 0!==a&&e.isFunction(i)){var r=i.apply(a,n);void 0!==r&&r!==a&&o.push(r)}else e.error('No such method "'+t+'" for Redactor')}):this.each(function(){e.data(this,"redactor",{}),e.data(this,"redactor",i(this,t))}),0===o.length?this:1===o.length?o[0]:o},e.Redactor=i,e.Redactor.VERSION="10.2.5",e.Redactor.modules=["alignment","autosave","block","buffer","build","button","caret","clean","code","core","dropdown","file","focus","image","indent","inline","insert","keydown","keyup","lang","line","link","linkify","list","modal","observe","paragraphize","paste","placeholder","progress","selection","shortcuts","tabifier","tidy","toolbar","upload","utils"],e.Redactor.opts={lang:"en",direction:"ltr",plugins:!1,focus:!1,focusEnd:!1,placeholder:!1,visual:!0,tabindex:!1,minHeight:!1,maxHeight:!1,linebreaks:!1,replaceDivs:!0,paragraphize:!0,cleanStyleOnEnter:!1,enterKey:!0,cleanOnPaste:!0,cleanSpaces:!0,pastePlainText:!1,autosave:!1,autosaveName:!1,autosaveInterval:60,autosaveOnChange:!1,autosaveFields:!1,linkTooltip:!0,linkProtocol:"http",linkNofollow:!1,linkSize:50,imageEditable:!0,imageLink:!0,imagePosition:!0,imageFloatMargin:"10px",imageResizable:!0,imageUpload:null,imageUploadParam:"file",uploadImageField:!1,dragImageUpload:!0,fileUpload:null,fileUploadParam:"file",dragFileUpload:!0,s3:!1,convertLinks:!0,convertUrlLinks:!0,convertImageLinks:!0,convertVideoLinks:!0,preSpaces:4,tabAsSpaces:!1,tabKey:!0,scrollTarget:!1,toolbar:!0,toolbarFixed:!0,toolbarFixedTarget:document,toolbarFixedTopOffset:0,toolbarExternal:!1,toolbarOverflow:!1,source:!0,buttons:["html","formatting","bold","italic","deleted","unorderedlist","orderedlist","outdent","indent","image","file","link","alignment","horizontalrule"],buttonsHide:[],buttonsHideOnMobile:[],formatting:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],formattingAdd:!1,tabifier:!0,deniedTags:["script","style"],allowedTags:!1,paragraphizeBlocks:["table","div","pre","form","ul","ol","h1","h2","h3","h4","h5","h6","dl","blockquote","figcaption","address","section","header","footer","aside","article","object","style","script","iframe","select","input","textarea","button","option","map","area","math","hr","fieldset","legend","hgroup","nav","figure","details","menu","summary","p"],removeComments:!1,replaceTags:[["strike","del"],["b","strong"]],replaceStyles:[["font-weight:\\s?bold","strong"],["font-style:\\s?italic","em"],["text-decoration:\\s?underline","u"],["text-decoration:\\s?line-through","del"]],removeDataAttr:!1,removeAttr:!1,allowedAttr:!1,removeWithoutAttr:["span"],removeEmpty:["p"],activeButtons:["deleted","italic","bold","underline","unorderedlist","orderedlist","alignleft","aligncenter","alignright","justify"],activeButtonsStates:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",ul:"unorderedlist",ol:"orderedlist",u:"underline"},shortcuts:{"ctrl+shift+m, meta+shift+m":{func:"inline.removeFormat"},"ctrl+b, meta+b":{func:"inline.format",params:["bold"]},"ctrl+i, meta+i":{func:"inline.format",params:["italic"]},"ctrl+h, meta+h":{func:"inline.format",params:["superscript"]},"ctrl+l, meta+l":{func:"inline.format",params:["subscript"]},"ctrl+k, meta+k":{func:"link.show"},"ctrl+shift+7":{func:"list.toggle",params:["orderedlist"]},"ctrl+shift+8":{func:"list.toggle",params:["unorderedlist"]}},shortcutsAdd:!1,buffer:[],rebuffer:[],emptyHtml:"<p>&#x200b;</p>",invisibleSpace:"&#x200b;",imageTypes:["image/png","image/jpeg","image/gif"],indentValue:20,verifiedTags:["a","img","b","strong","sub","sup","i","em","u","small","strike","del","cite","ul","ol","li"],inlineTags:["strong","b","u","em","i","code","del","ins","samp","kbd","sup","sub","mark","var","cite","small"],alignmentTags:["P","H1","H2","H3","H4","H5","H6","DL","DT","DD","DIV","TD","BLOCKQUOTE","OUTPUT","FIGCAPTION","ADDRESS","SECTION","HEADER","FOOTER","ASIDE","ARTICLE"],blockLevelElements:["PRE","UL","OL","LI"],highContrast:!1,observe:{dropdowns:[]},langs:{en:{html:"HTML",video:"Insert Video",image:"Insert Image",table:"Table",link:"Link",link_insert:"Insert link",link_edit:"Edit link",unlink:"Unlink",formatting:"Formatting",paragraph:"Normal text",quote:"Quote",code:"Code",header1:"Header 1",header2:"Header 2",header3:"Header 3",header4:"Header 4",header5:"Header 5",bold:"Bold",italic:"Italic",fontcolor:"Font Color",backcolor:"Back Color",unorderedlist:"Unordered List",orderedlist:"Ordered List",outdent:"Outdent",indent:"Indent",cancel:"Cancel",insert:"Insert",save:"Save",_delete:"Delete",insert_table:"Insert Table",insert_row_above:"Add Row Above",insert_row_below:"Add Row Below",insert_column_left:"Add Column Left",insert_column_right:"Add Column Right",delete_column:"Delete Column",delete_row:"Delete Row",delete_table:"Delete Table",rows:"Rows",columns:"Columns",add_head:"Add Head",delete_head:"Delete Head",title:"Title",image_position:"Position",none:"None",left:"Left",right:"Right",center:"Center",image_web_link:"Image Web Link",text:"Text",mailto:"Email",web:"URL",video_html_code:"Video Embed Code or Youtube/Vimeo Link",file:"Insert File",upload:"Upload",download:"Download",choose:"Choose",or_choose:"Or choose",drop_file_here:"Drop file here",align_left:"Align text to the left",align_center:"Center text",align_right:"Align text to the right",align_justify:"Justify text",horizontalrule:"Insert Horizontal Rule",deleted:"Deleted",anchor:"Anchor",link_new_tab:"Open link in new tab",underline:"Underline",alignment:"Alignment",filename:"Name (optional)",edit:"Edit",upload_label:"Drop file here or "}},linkify:{regexps:{youtube:/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube\.com\S*[^\w\-\s])([\w\-]{11})(?=[^\w\-]|$)(?![?=&+%\w.\-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,vimeo:/https?:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/,image:/((https?|www)[^\s]+\.)(jpe?g|png|gif)(\?[^\s-]+)?/gi,url:/(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/gi}},codemirror:!1},i.fn=e.Redactor.prototype={keyCode:{BACKSPACE:8,DELETE:46,UP:38,DOWN:40,ENTER:13,SPACE:32,ESC:27,TAB:9,CTRL:17,META:91,SHIFT:16,ALT:18,RIGHT:39,LEFT:37,LEFT_WIN:91},init:function(i,o){if(this.$element=e(i),this.uuid=t++,this.rtePaste=!1,this.$pasteBox=!1,this.loadOptions(o),this.loadModules(),this.formatting={},e.merge(this.opts.blockLevelElements,this.opts.alignmentTags),this.reIsBlock=new RegExp("^("+this.opts.blockLevelElements.join("|")+")$","i"),this.tidy.setupAllowed(),!1!==this.opts.deniedTags)for(var n=["html","head","link","body","meta","applet"],a=0;a<n.length;a++)this.opts.deniedTags.push(n[a]);this.lang.load(),e.extend(this.opts.shortcuts,this.opts.shortcutsAdd),this.core.setCallback("start"),this.start=!0,this.build.run()},loadOptions:function(t){this.opts=e.extend({},e.extend(!0,{},e.Redactor.opts),this.$element.data(),t)},getModuleMethods:function(e){return Object.getOwnPropertyNames(e).filter(function(t){return"function"==typeof e[t]})},loadModules:function(){for(var t=e.Redactor.modules.length,i=0;i<t;i++)this.bindModuleMethods(e.Redactor.modules[i])},bindModuleMethods:function(e){if(void 0!==this[e]){this[e]=this[e]();for(var t=this.getModuleMethods(this[e]),i=t.length,o=0;o<i;o++)this[e][t[o]]=this[e][t[o]].bind(this)}},alignment:function(){return{left:function(){this.alignment.set("")},right:function(){this.alignment.set("right")},center:function(){this.alignment.set("center")},justify:function(){this.alignment.set("justify")},set:function(e){this.utils.browser("msie")||this.opts.linebreaks||this.$editor.focus(),this.alignment.blocks=this.selection.getBlocks(),this.alignment.type=e,this.buffer.set(),this.selection.save(),this.alignment.isLinebreaksOrNoBlocks()?this.alignment.setText():this.alignment.setBlocks(),this.selection.restore(),this.code.sync()},setText:function(){var t=this.selection.wrap("div");e(t).attr("data-tagblock","redactor").css("text-align",this.alignment.type)},setBlocks:function(){e.each(this.alignment.blocks,e.proxy(function(e,t){var i=this.utils.getAlignmentElement(t);i&&(this.alignment.isNeedReplaceElement(i)?this.alignment.replaceElement(i):this.alignment.alignElement(i))},this))},isLinebreaksOrNoBlocks:function(){return this.opts.linebreaks&&!1===this.alignment.blocks[0]},isNeedReplaceElement:function(e){return""===this.alignment.type&&void 0!==e.data("tagblock")},replaceElement:function(e){e.replaceWith(e.html())},alignElement:function(e){e.css("text-align",this.alignment.type),this.utils.removeEmptyAttr(e,"style")}}},autosave:function(){return{html:!1,enable:function(){this.opts.autosave&&(this.autosave.name=this.opts.autosaveName?this.opts.autosaveName:this.$textarea.attr("name"),this.opts.autosaveOnChange||(this.autosaveInterval=setInterval(this.autosave.load,1e3*this.opts.autosaveInterval)))},onChange:function(){this.opts.autosaveOnChange&&this.autosave.load()},load:function(){if(this.opts.autosave&&(this.autosave.source=this.code.get(),this.autosave.html!==this.autosave.source)){var t={};t.name=this.autosave.name,t[this.autosave.name]=this.autosave.source,t=this.autosave.getHiddenFields(t),e.ajax({url:this.opts.autosave,type:"post",data:t}).done(this.autosave.success)}},getHiddenFields:function(t){return!1===this.opts.autosaveFields||"object"!=typeof this.opts.autosaveFields?t:(e.each(this.opts.autosaveFields,e.proxy(function(i,o){null!==o&&0===o.toString().indexOf("#")&&(o=e(o).val()),t[i]=o},this)),t)},success:function(t){var i;try{i=e.parseJSON(t)}catch(e){i=t}var o=void 0===i.error?"autosave":"autosaveError";this.core.setCallback(o,this.autosave.name,i),this.autosave.html=this.autosave.source},disable:function(){clearInterval(this.autosaveInterval)}}},block:function(){return{formatting:function(e){var t,i;this.block.clearStyle=!1,void 0!==this.formatting[e].data?t="data":void 0!==this.formatting[e].attr?t="attr":void 0!==this.formatting[e].class&&(t="class"),void 0!==this.formatting[e].clear&&(this.block.clearStyle=!0),t&&(i=this.formatting[e][t]),this.block.format(this.formatting[e].tag,t,i)},format:function(t,i,o){"quote"==t&&(t="blockquote");if(-1!=e.inArray(t,["p","pre","blockquote","h1","h2","h3","h4","h5","h6"])){this.block.isRemoveInline="pre"==t||-1!=t.search(/h[1-6]/i),this.utils.browser("msie")||this.$editor.focus();var n,a=e.trim(this.$editor.html());if(this.block.isEmpty=this.utils.isEmpty(a),this.utils.browser("mozilla")&&!this.focus.isFocused())if(this.block.isEmpty)this.opts.linebreaks||(n=this.$editor.children().first(),this.caret.setEnd(n));this.block.blocks=this.selection.getBlocks(),this.block.blocksSize=this.block.blocks.length,this.block.type=i,this.block.value=o,this.buffer.set(),this.selection.save(),this.block.set(t),this.selection.restore(),this.code.sync(),this.observe.load()}},set:function(e){this.selection.get(),this.block.containerTag=this.range.commonAncestorContainer.tagName,this.range.collapsed?this.block.setCollapsed(e):this.block.setMultiple(e)},setCollapsed:function(t){if(this.opts.linebreaks&&this.block.isEmpty&&"p"!=t){var i=document.createElement(t);return this.$editor.html(i),void this.caret.setEnd(i)}var o=this.block.blocks[0];if(!1!==o)if("LI"!=o.tagName){if(("TD"==this.block.containerTag||"TH"==this.block.containerTag)&&!this.opts.linebreaks)document.execCommand("formatblock",!1,"<"+t+">"),o=this.selection.getBlock(),this.block.toggle(e(o));else if(o.tagName.toLowerCase()!=t)if(this.opts.linebreaks&&"p"==t)e(o).append("<br>"),this.utils.replaceWithContents(o);else{var n=this.utils.replaceToTag(o,t);this.block.toggle(n),"p"!=t&&"blockquote"!=t&&n.find("img").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags(n),("p"==t||this.block.headTag)&&n.find("p").contents().unwrap(),this.block.formatTableWrapping(n)}else if("blockquote"==t&&o.tagName.toLowerCase()==t)if(this.opts.linebreaks)e(o).append("<br>"),this.utils.replaceWithContents(o);else{var a=this.utils.replaceToTag(o,"p");this.block.toggle(a)}else o.tagName.toLowerCase()==t&&this.block.toggle(e(o));void 0===this.block.type&&void 0===this.block.value&&e(o).removeAttr("class").removeAttr("style")}else{if("blockquote"!=t)return;this.block.formatListToBlockquote()}},setMultiple:function(t){var i=this.block.blocks[0],o="TD"==this.block.containerTag||"TH"==this.block.containerTag;if(!1!==i&&1===this.block.blocksSize)if(i.tagName.toLowerCase()==t&&"blockquote"==t)if(this.opts.linebreaks)e(i).append("<br>"),this.utils.replaceWithContents(i);else{var n=this.utils.replaceToTag(i,"p");this.block.toggle(n)}else if("LI"==i.tagName){if("blockquote"!=t)return;this.block.formatListToBlockquote()}else if("BLOCKQUOTE"==this.block.containerTag)this.block.formatBlockquote(t);else if(this.opts.linebreaks&&(o||this.range.commonAncestorContainer!=i))this.block.formatWrap(t);else if(this.opts.linebreaks&&"p"==t)e(i).prepend("<br>").append("<br>"),this.utils.replaceWithContents(i);else if("TD"===i.tagName)this.block.formatWrap(t);else{var a=this.utils.replaceToTag(i,t);this.block.toggle(a),this.block.isRemoveInline&&this.utils.removeInlineTags(a),("p"==t||this.block.headTag)&&a.find("p").contents().unwrap()}else if(this.opts.linebreaks||"p"!=t){if("blockquote"==t){for(var r=0,s=0;s<this.block.blocksSize;s++)"BLOCKQUOTE"==this.block.blocks[s].tagName&&r++;if(r==this.block.blocksSize)return void e.each(this.block.blocks,e.proxy(function(t,i){var o=!1;this.opts.linebreaks?(e(i).prepend("<br>").append("<br>"),o=this.utils.replaceWithContents(i)):o=this.utils.replaceToTag(i,"p"),o&&void 0===this.block.type&&void 0===this.block.value&&o.removeAttr("class").removeAttr("style")},this))}this.block.formatWrap(t)}else{var l=0,d=!1;"class"==this.block.type&&(d="toggle",l=e(this.block.blocks).filter("."+this.block.value).length,this.block.blocksSize==l?d="toggle":this.block.blocksSize>l?d="set":0===l&&(d="set"));var c=["ul","ol","li","td","th","dl","dt","dd"];e.each(this.block.blocks,e.proxy(function(i,o){if(-1==e.inArray(o.tagName.toLowerCase(),c)){var n=this.utils.replaceToTag(o,t);d?"toggle"==d?this.block.toggle(n):"remove"==d?this.block.remove(n):"set"==d&&this.block.setForce(n):this.block.toggle(n),"p"!=t&&"blockquote"!=t&&n.find("img").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags(n),("p"==t||this.block.headTag)&&n.find("p").contents().unwrap(),void 0===this.block.type&&void 0===this.block.value&&n.removeAttr("class").removeAttr("style")}},this))}},setForce:function(e){this.block.clearStyle&&e.removeAttr("class").removeAttr("style"),"class"!=this.block.type?"attr"!=this.block.type&&"data"!=this.block.type||e.attr(this.block.value.name,this.block.value.value):e.addClass(this.block.value)},toggle:function(e){return this.block.clearStyle&&e.removeAttr("class").removeAttr("style"),"class"==this.block.type?void e.toggleClass(this.block.value):"attr"==this.block.type||"data"==this.block.type?void(e.attr(this.block.value.name)==this.block.value.value?e.removeAttr(this.block.value.name):e.attr(this.block.value.name,this.block.value.value)):void e.removeAttr("style class")},remove:function(e){e.removeClass(this.block.value)},formatListToBlockquote:function(){var t=e(this.block.blocks[0]).closest("ul, ol",this.$editor[0]);e(t).find("ul, ol").contents().unwrap(),e(t).find("li").append(e("<br>")).contents().unwrap();var i=this.utils.replaceToTag(t,"blockquote");this.block.toggle(i)},formatBlockquote:function(t){document.execCommand("outdent"),document.execCommand("formatblock",!1,t),this.clean.clearUnverified(),this.$editor.find("p:empty").remove();var i=this.selection.getBlock();"p"!=t&&e(i).find("img").remove(),this.opts.linebreaks||this.block.toggle(e(i)),this.$editor.find("ul, ol, tr, blockquote, p").each(e.proxy(this.utils.removeEmpty,this)),this.opts.linebreaks&&"p"==t&&this.utils.replaceWithContents(i)},formatWrap:function(t){if("UL"==this.block.containerTag||"OL"==this.block.containerTag){if("blockquote"!=t)return;this.block.formatListToBlockquote()}var i=this.selection.wrap(t);if(!1!==i){var o=e(i);if(this.block.formatTableWrapping(o),o.find(this.opts.blockLevelElements.join(",")+", td, table, thead, tbody, tfoot, th, tr").contents().unwrap(),"p"!=t&&"blockquote"!=t&&o.find("img").remove(),e.each(this.block.blocks,e.proxy(this.utils.removeEmpty,this)),o.append(this.selection.getMarker(2)),this.opts.linebreaks||this.block.toggle(o),this.$editor.find("ul, ol, tr, blockquote, p").each(e.proxy(this.utils.removeEmpty,this)),o.find("blockquote:empty").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags(o),this.opts.linebreaks&&"p"==t&&this.utils.replaceWithContents(o),this.opts.linebreaks){var n=o.next().next();0!=n.size()&&"BR"===n[0].tagName&&n.remove()}}},formatTableWrapping:function(e){0!==e.closest("table",this.$editor[0]).length&&(0===e.closest("tr",this.$editor[0]).length&&e.wrap("<tr>"),0===e.closest("td",this.$editor[0]).length&&0===e.closest("th").length&&e.wrap("<td>"))},removeData:function(t,i){var o=this.selection.getBlocks();e(o).removeAttr("data-"+t),this.code.sync()},setData:function(t,i){var o=this.selection.getBlocks();e(o).attr("data-"+t,i),this.code.sync()},toggleData:function(t,i){var o=this.selection.getBlocks();e.each(o,function(){e(this).attr("data-"+t)?e(this).removeAttr("data-"+t):e(this).attr("data-"+t,i)})},removeAttr:function(t,i){var o=this.selection.getBlocks();e(o).removeAttr(t),this.code.sync()},setAttr:function(t,i){var o=this.selection.getBlocks();e(o).attr(t,i),this.code.sync()},toggleAttr:function(t,i){var o=this.selection.getBlocks();e.each(o,function(){e(this).attr(name)?e(this).removeAttr(name):e(this).attr(name,i)})},removeClass:function(t){var i=this.selection.getBlocks();e(i).removeClass(t),this.utils.removeEmptyAttr(i,"class"),this.code.sync()},setClass:function(t){var i=this.selection.getBlocks();e(i).addClass(t),this.code.sync()},toggleClass:function(t){var i=this.selection.getBlocks();e(i).toggleClass(t),this.code.sync()}}},buffer:function(){return{set:function(e){void 0===e||"undo"==e?this.buffer.setUndo():this.buffer.setRedo()},setUndo:function(){this.selection.save(),this.opts.buffer.push(this.$editor.html()),this.selection.restore()},setRedo:function(){this.selection.save(),this.opts.rebuffer.push(this.$editor.html()),this.selection.restore()},getUndo:function(){this.$editor.html(this.opts.buffer.pop())},getRedo:function(){this.$editor.html(this.opts.rebuffer.pop())},add:function(){this.opts.buffer.push(this.$editor.html())},undo:function(){0!==this.opts.buffer.length&&(this.buffer.set("redo"),this.buffer.getUndo(),this.selection.restore(),setTimeout(e.proxy(this.observe.load,this),50))},redo:function(){0!==this.opts.rebuffer.length&&(this.buffer.set("undo"),this.buffer.getRedo(),this.selection.restore(),setTimeout(e.proxy(this.observe.load,this),50))}}},build:function(){return{focused:!1,blured:!0,run:function(){this.build.createContainerBox(),this.build.loadContent(),this.build.loadEditor(),this.build.enableEditor(),this.build.setCodeAndCall()},isTextarea:function(){return"TEXTAREA"===this.$element[0].tagName},createContainerBox:function(){this.$box=e('<div class="redactor-box" role="application" />')},createTextarea:function(){this.$textarea=e("<textarea />").attr("name",this.build.getTextareaName())},getTextareaName:function(){return"undefined"==typeof name?"content-"+this.uuid:this.$element.attr("id")},loadContent:function(){var t=this.build.isTextarea()?"val":"html";this.content=e.trim(this.$element[t]())},enableEditor:function(){this.$editor.attr({contenteditable:!0,dir:this.opts.direction})},loadEditor:function(){var e=this.build.isTextarea()?"fromTextarea":"fromElement";this.build[e]()},fromTextarea:function(){this.$editor=e("<div />"),this.$textarea=this.$element,this.$box.insertAfter(this.$element).append(this.$editor).append(this.$element),this.$editor.addClass("redactor-editor"),this.$element.hide()},fromElement:function(){this.$editor=this.$element,this.build.createTextarea(),this.$box.insertAfter(this.$editor).append(this.$editor).append(this.$textarea),this.$editor.addClass("redactor-editor"),this.$textarea.hide()},setCodeAndCall:function(){this.code.set(this.content),this.build.setOptions(),this.build.callEditor(),this.opts.visual||setTimeout(e.proxy(this.code.showCode,this),200)},callEditor:function(){this.build.disableMozillaEditing(),this.build.disableIeLinks(),this.build.setEvents(),this.build.setHelpers(),this.opts.toolbar&&(this.opts.toolbar=this.toolbar.init(),this.toolbar.build()),this.modal.loadTemplates(),this.build.plugins(),setTimeout(e.proxy(this.observe.load,this),4),this.core.setCallback("init")},setOptions:function(){e(this.$textarea).attr("dir",this.opts.direction),this.opts.linebreaks&&this.$editor.addClass("redactor-linebreaks"),this.opts.tabindex&&this.$editor.attr("tabindex",this.opts.tabindex),this.opts.minHeight&&this.$editor.css("minHeight",this.opts.minHeight),this.opts.maxHeight&&this.$editor.css("maxHeight",this.opts.maxHeight)},setEventDropUpload:function(e){if(e.preventDefault(),this.opts.dragImageUpload&&this.opts.dragFileUpload){var t=e.dataTransfer.files;this.upload.directUpload(t[0],e)}},setEventDrop:function(e){this.code.sync(),setTimeout(this.clean.clearUnverified,1),this.core.setCallback("drop",e)},setEvents:function(){this.$editor.on("dragover.redactor dragenter.redactor",function(e){e.preventDefault(),e.stopPropagation()}),this.$editor.on("drop.redactor",e.proxy(function(e){return e=e.originalEvent||e,void 0===window.FormData||!e.dataTransfer||(0===e.dataTransfer.files.length?this.build.setEventDrop(e):(this.build.setEventDropUpload(e),setTimeout(this.clean.clearUnverified,1),void this.core.setCallback("drop",e)))},this)),this.$editor.on("click.redactor",e.proxy(function(e){var t=this.core.getEvent(),i="click"!=t&&"arrow"!=t&&"click";this.core.addEvent(i),this.utils.disableSelectAll(),this.core.setCallback("click",e)},this)),this.$editor.on("paste.redactor",e.proxy(this.paste.init,this)),this.$editor.on("cut.redactor",e.proxy(this.code.sync,this)),this.$editor.on("keydown.redactor",e.proxy(this.keydown.init,this)),this.$editor.on("keyup.redactor",e.proxy(this.keyup.init,this)),e.isFunction(this.opts.codeKeydownCallback)&&this.$textarea.on("keydown.redactor-textarea",e.proxy(this.opts.codeKeydownCallback,this)),e.isFunction(this.opts.codeKeyupCallback)&&this.$textarea.on("keyup.redactor-textarea",e.proxy(this.opts.codeKeyupCallback,this)),this.$editor.on("focus.redactor",e.proxy(function(t){e.isFunction(this.opts.focusCallback)&&this.core.setCallback("focus",t),this.build.focused=!0,this.build.blured=!1,!1===this.selection.getCurrent()&&(this.selection.get(),this.range.setStart(this.$editor[0],0),this.range.setEnd(this.$editor[0],0),this.selection.addRange())},this)),e(document).on("mousedown.redactor-blur."+this.uuid,e.proxy(function(t){this.start||this.rtePaste||0===e(t.target).closest(".redactor-editor, .redactor-toolbar, .redactor-dropdown").size()&&(this.utils.disableSelectAll(),!this.build.blured&&e.isFunction(this.opts.blurCallback)&&this.core.setCallback("blur",t),this.build.focused=!1,this.build.blured=!0)},this))},setHelpers:function(){this.linkify.isEnabled()&&this.linkify.format(),this.placeholder.enable(),this.opts.focus&&setTimeout(this.focus.setStart,100),this.opts.focusEnd&&setTimeout(this.focus.setEnd,100)},plugins:function(){this.opts.plugins&&e.each(this.opts.plugins,e.proxy(function(t,o){var n="undefined"!=typeof RedactorPlugins&&void 0!==RedactorPlugins[o]?RedactorPlugins:i.fn;if(e.isFunction(n[o])){this[o]=n[o]();for(var a=this.getModuleMethods(this[o]),r=a.length,s=0;s<r;s++)this[o][a[s]]=this[o][a[s]].bind(this);e.isFunction(this[o].init)&&this[o].init()}},this))},disableMozillaEditing:function(){if(this.utils.browser("mozilla"))try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)}catch(e){}},disableIeLinks:function(){this.utils.browser("msie")&&document.execCommand("AutoUrlDetect",!1,!1)}}},button:function(){return{build:function(t,i){var o=e('<a href="#" class="re-icon re-'+t+'" rel="'+t+'" />').attr({role:"button","aria-label":i.title,tabindex:"-1"});if((i.func||i.command||i.dropdown)&&this.button.setEvent(o,t,i),i.dropdown){o.addClass("redactor-toolbar-link-dropdown").attr("aria-haspopup",!0);var n=e('<div class="redactor-dropdown redactor-dropdown-'+this.uuid+" redactor-dropdown-box-"+t+'" style="display: none;">');o.data("dropdown",n),this.dropdown.build(t,n,i.dropdown)}return this.utils.isDesktop()&&this.button.createTooltip(o,t,i.title),o},setEvent:function(t,i,o){t.on("touchstart click",e.proxy(function(e){if(t.hasClass("redactor-button-disabled"))return!1;var n="func",a=o.func;o.command?(n="command",a=o.command):o.dropdown&&(n="dropdown",a=!1),this.button.onClick(e,i,n,a)},this))},createTooltip:function(t,i,o){var n=e("<span>").addClass("redactor-toolbar-tooltip redactor-toolbar-tooltip-"+this.uuid+" redactor-toolbar-tooltip-"+i).hide().html(o);n.appendTo("body"),t.on("mouseover",function(){if(!e(this).hasClass("redactor-button-disabled")){var i=t.offset();n.css({top:i.top+t.innerHeight()+"px",left:i.left+t.innerWidth()/2-n.innerWidth()/2+"px"}),n.show()}}),t.on("mouseout",function(){n.hide()})},onClick:function(t,i,o,n){this.button.caretOffset=this.caret.getOffset(),t.preventDefault(),e(document).find(".redactor-toolbar-tooltip").hide(),this.utils.browser("msie")&&(t.returnValue=!1),"command"==o?this.inline.format(n):"dropdown"==o?this.dropdown.show(t,i):this.button.onClickCallback(t,n,i)},onClickCallback:function(t,i,o){var n;if(e.isFunction(i))i.call(this,o);else if("-1"!=i.search(/\./)){if(void 0===this[(n=i.split("."))[0]])return;this[n[0]][n[1]](o)}else this[i](o);this.observe.buttons(t,o)},get:function(e){return this.$toolbar.find("a.re-"+e)},setActive:function(e){this.button.get(e).addClass("redactor-act")},setInactive:function(e){this.button.get(e).removeClass("redactor-act")},setInactiveAll:function(e){void 0===e?this.$toolbar.find("a.re-icon").removeClass("redactor-act"):this.$toolbar.find("a.re-icon").not(".re-"+e).removeClass("redactor-act")},setActiveInVisual:function(){this.$toolbar.find("a.re-icon").not("a.re-html, a.re-fullscreen").removeClass("redactor-button-disabled")},setInactiveInCode:function(){this.$toolbar.find("a.re-icon").not("a.re-html, a.re-fullscreen").addClass("redactor-button-disabled")},changeIcon:function(e,t){this.button.get(e).addClass("re-"+t)},removeIcon:function(e,t){this.button.get(e).removeClass("re-"+t)},setAwesome:function(e,t){var i=this.button.get(e);i.removeClass("redactor-btn-image").addClass("fa-redactor-btn"),i.html('<i class="fa '+t+'"></i>')},addCallback:function(t,i){if("buffer"!=t){var o="dropdown"==i?"dropdown":"func",n=t.attr("rel");t.on("touchstart click",e.proxy(function(e){if(t.hasClass("redactor-button-disabled"))return!1;this.button.onClick(e,n,o,i)},this))}},addDropdown:function(t,i){t.addClass("redactor-toolbar-link-dropdown").attr("aria-haspopup",!0);var o=t.attr("rel");this.button.addCallback(t,"dropdown");var n=e('<div class="redactor-dropdown redactor-dropdown-'+this.uuid+" redactor-dropdown-box-"+o+'" style="display: none;">');return t.data("dropdown",n),i&&this.dropdown.build(o,n,i),n},add:function(t,i){if(this.opts.toolbar){if(this.button.isMobileUndoRedo(t))return"buffer";var o=this.button.build(t,{title:i});return o.addClass("redactor-btn-image"),this.$toolbar.append(e("<li>").append(o)),o}},addFirst:function(t,i){if(this.opts.toolbar){if(this.button.isMobileUndoRedo(t))return"buffer";var o=this.button.build(t,{title:i});return o.addClass("redactor-btn-image"),this.$toolbar.prepend(e("<li>").append(o)),o}},addAfter:function(t,i,o){if(this.opts.toolbar){if(this.button.isMobileUndoRedo(i))return"buffer";var n=this.button.build(i,{title:o});n.addClass("redactor-btn-image");var a=this.button.get(t);return 0!==a.length?a.parent().after(e("<li>").append(n)):this.$toolbar.append(e("<li>").append(n)),n}},addBefore:function(t,i,o){if(this.opts.toolbar){if(this.button.isMobileUndoRedo(i))return"buffer";var n=this.button.build(i,{title:o});n.addClass("redactor-btn-image");var a=this.button.get(t);return 0!==a.length?a.parent().before(e("<li>").append(n)):this.$toolbar.append(e("<li>").append(n)),n}},remove:function(e){this.button.get(e).remove()},isMobileUndoRedo:function(e){return("undo"==e||"redo"==e)&&!this.utils.isDesktop()}}},caret:function(){return{setStart:function(t){if(this.utils.isBlock(t))this.caret.set(t,0,t,0);else{var i=this.utils.createSpaceElement();e(t).prepend(i),this.caret.setEnd(i)}},setEnd:function(e){if(1==(e=e[0]||e).lastChild.nodeType)return this.caret.setAfter(e.lastChild);this.caret.set(e,1,e,1)},set:function(t,i,o,n){if(t=t[0]||t,o=o[0]||o,this.utils.isBlockTag(t.tagName)&&""===t.innerHTML&&(t.innerHTML=this.opts.invisibleSpace),"BR"==t.tagName&&!1===this.opts.linebreaks){var a=e(this.opts.emptyHtml)[0];e(t).replaceWith(a),o=t=a}this.selection.get();try{this.range.setStart(t,i),this.range.setEnd(o,n)}catch(e){}this.selection.addRange()},setAfter:function(t){try{var i=e(t)[0].tagName;if("BR"==i||this.utils.isBlock(t))"BR"!=i&&this.utils.browser("msie")?this.caret.setStart(e(t).next()):this.caret.setAfterOrBefore(t,"after");else{var o=this.utils.createSpaceElement();e(t).after(o),this.caret.setEnd(o)}}catch(i){o=this.utils.createSpaceElement();e(t).after(o),this.caret.setEnd(o)}},setBefore:function(t){this.utils.isBlock(t)?this.caret.setEnd(e(t).prev()):this.caret.setAfterOrBefore(t,"before")},setAfterOrBefore:function(e,t){if(this.utils.browser("msie")||this.$editor.focus(),e=e[0]||e,this.selection.get(),"after"==t)try{this.range.setStartAfter(e),this.range.setEndAfter(e)}catch(e){}else try{this.range.setStartBefore(e),this.range.setEndBefore(e)}catch(e){}this.range.collapse(!1),this.selection.addRange()},getOffsetOfElement:function(t){t=t[0]||t,this.selection.get();var i=this.range.cloneRange();return i.selectNodeContents(t),i.setEnd(this.range.endContainer,this.range.endOffset),e.trim(i.toString()).length},getOffset:function(){var e=0;if(window.getSelection().rangeCount>0){var t=window.getSelection().getRangeAt(0),i=t.cloneRange();i.selectNodeContents(this.$editor[0]),i.setEnd(t.endContainer,t.endOffset),e=i.toString().length}return e},setOffset:function(e,t){void 0===t&&(t=e),this.focus.isFocused()||this.focus.setStart();this.selection.get();for(var i,o=0,n=document.createTreeWalker(this.$editor[0],NodeFilter.SHOW_TEXT,null,null);i=n.nextNode();)if((o+=i.nodeValue.length)>e&&(this.range.setStart(i,i.nodeValue.length+e-o),e=1/0),o>=t){this.range.setEnd(i,i.nodeValue.length+t-o);break}this.range.collapse(!1),this.selection.addRange()},setToPoint:function(e,t){this.caret.setOffset(e,t)},getCoords:function(){return this.caret.getOffset()}}},clean:function(){return{onSet:function(t){t=(t=(t=(t=this.clean.savePreCode(t)).replace(/<script(.*?[^>]?)>([\w\W]*?)<\/script>/gi,'<pre class="redactor-script-tag" style="display: none;" $1>$2</pre>')).replace(/\$/g,"&#36;")).replace(/<a href="(.*?[^>]?)®(.*?[^>]?)">/gi,'<a href="$1&reg$2">'),this.opts.replaceDivs&&!this.opts.linebreaks&&(t=this.clean.replaceDivs(t)),this.opts.linebreaks&&(t=this.clean.replaceParagraphsToBr(t)),t=this.clean.saveFormTags(t);var i=e("<div>");i.html(t);var o=i.find("font[style]");return 0!==o.length&&(o.replaceWith(function(){var t=e(this);return e("<span>").attr("style",t.attr("style")).append(t.contents())}),t=i.html()),i.remove(),t=(t=t.replace(/<font(.*?)>/gi,"")).replace(/<\/font>/gi,""),t=this.tidy.load(t),this.opts.paragraphize&&(t=this.paragraphize.load(t)),t=this.clean.setVerified(t),t=(t=this.clean.convertInline(t)).replace(/&amp;/g,"&")},onSync:function(t){if(t=(t=t.replace(/\u200B/g,"")).replace(/&#x200b;/gi,""),this.opts.cleanSpaces&&(t=t.replace(/&nbsp;/gi," ")),-1!=t.search(/^<p>(||\s||<br\s?\/?>||&nbsp;)<\/p>$/i))return"";t=t.replace(/<pre class="redactor-script-tag" style="display: none;"(.*?[^>]?)>([\w\W]*?)<\/pre>/gi,"<script$1>$2<\/script>"),t=this.clean.restoreFormTags(t);e.each({"™":"&trade;","©":"&copy;","…":"&hellip;","—":"&mdash;","‐":"&dash;"},function(e,i){t=t.replace(new RegExp(e,"g"),i)}),this.utils.browser("mozilla")&&(t=t.replace(/<br\s?\/?>$/gi,"")),t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(new RegExp("<br\\s?/?></li>","gi"),"</li>")).replace(new RegExp("</li><br\\s?/?>","gi"),"</li>")).replace(/<(.*?)rel="\s*?"(.*?[^>]?)>/gi,'<$1$2">')).replace(/<(.*?)style="\s*?"(.*?[^>]?)>/gi,'<$1$2">')).replace(/="">/gi,">")).replace(/""">/gi,'">')).replace(/"">/gi,'">')).replace(/<div(.*?)data-tagblock="redactor"(.*?[^>])>/gi,"<div$1$2>")).replace(/<(.*?) data-verified="redactor"(.*?[^>])>/gi,"<$1$2>");var i=e("<div/>").html(e.parseHTML(t,document,!0));return i.find("span").removeAttr("rel"),i.find("pre .redactor-invisible-space").each(function(){e(this).contents().unwrap()}),t=(t=(t=(t=(t=(t=(t=(t=(t=i.html()).replace(/<img(.*?[^>])rel="(.*?[^>])"(.*?[^>])>/gi,"<img$1$3>")).replace(/<span class="redactor-invisible-space">(.*?)<\/span>/gi,"$1")).replace(/ data-save-url="(.*?[^>])"/gi,"")).replace(/<span(.*?)id="redactor-image-box"(.*?[^>])>([\w\W]*?)<img(.*?)><\/span>/gi,"$3<img$4>")).replace(/<span(.*?)id="redactor-image-resizer"(.*?[^>])>(.*?)<\/span>/gi,"")).replace(/<span(.*?)id="redactor-image-editter"(.*?[^>])>(.*?)<\/span>/gi,"")).replace(/<font(.*?)>/gi,"")).replace(/<\/font>/gi,""),t=this.tidy.load(t),this.opts.linkNofollow&&(t=(t=t.replace(/<a(.*?)rel="nofollow"(.*?[^>])>/gi,"<a$1$2>")).replace(/<a(.*?[^>])>/gi,'<a$1 rel="nofollow">')),t=(t=(t=(t=t.replace(/\sdata-redactor-(tag|class|style)="(.*?[^>])"/gi,"")).replace(new RegExp('<(.*?) data-verified="redactor"(.*?[^>])>',"gi"),"<$1$2>")).replace(new RegExp('<(.*?) data-verified="redactor">',"gi"),"<$1>")).replace(/&amp;/g,"&")},onPaste:function(t,i){if(t=(t=(t=(t=(t=(t=e.trim(t)).replace(/\$/g,"&#36;")).replace(/<span class="s[0-9]">/gi,"<span>")).replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," ")).replace(/<span class="Apple-tab-span"[^>]*>\t<\/span>/gi,"\t")).replace(/<span[^>]*>(\s|&nbsp;)<\/span>/gi," "),this.opts.pastePlainText)return this.clean.getPlainText(t);if(!this.utils.isSelectAll()&&void 0===i){if(this.utils.isCurrentOrParent(["FIGCAPTION","A"]))return this.clean.getPlainText(t,!1);if(this.utils.isCurrentOrParent("PRE"))return t=(t=(t=(t=t.replace(/”/g,'"')).replace(/“/g,'"')).replace(/‘/g,"'")).replace(/’/g,"'"),this.clean.getPreCode(t);if(this.utils.isCurrentOrParent(["BLOCKQUOTE","H1","H2","H3","H4","H5","H6"])){if(t=this.clean.getOnlyImages(t),!this.utils.browser("msie")){var o=this.selection.getBlock();o&&"P"==o.tagName&&(t=t.replace(/<img(.*?)>/gi,"<p><img$1></p>"))}return t}if(this.utils.isCurrentOrParent(["TD"]))return t=this.clean.onPasteTidy(t,"td"),this.opts.linebreaks&&(t=this.clean.replaceParagraphsToBr(t)),t=this.clean.replaceDivsToBr(t);if(this.utils.isCurrentOrParent(["LI"]))return this.clean.onPasteTidy(t,"li")}return t=this.clean.isSingleLine(t,i),this.clean.singleLine||(this.opts.linebreaks&&(t=this.clean.replaceParagraphsToBr(t)),this.opts.replaceDivs&&(t=this.clean.replaceDivs(t)),t=this.clean.saveFormTags(t)),t=this.clean.onPasteWord(t),t=this.clean.onPasteExtra(t),t=this.clean.onPasteTidy(t,"all"),!this.clean.singleLine&&this.opts.paragraphize&&(t=this.paragraphize.load(t)),t=this.clean.removeDirtyStyles(t),t=this.clean.onPasteRemoveSpans(t),t=this.clean.onPasteRemoveEmpty(t),t=this.clean.convertInline(t)},onPasteWord:function(t){if((t=(t=(t=t.replace(/<!--[\s\S]*?-->/gi,"")).replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"")).replace(/<o\:p[^>]*>[\s\S]*?<\/o\:p>/gi,"")).match(/class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i)){t=(t=(t=(t=(t=t.replace(/<!--[\s\S]+?-->/gi,"")).replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,"")).replace(/<(\/?)s>/gi,"<$1strike>")).replace(/ /gi," ")).replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(" "):""}),t=(t=(t=this.clean.onPasteIeFixLinks(t)).replace(/<img(.*?)v:shapes=(.*?)>/gi,"")).replace(/src="file\:\/\/(.*?)"/,'src=""');var i=e("<div/>").html(t),o=!1,n=1,a=[];i.find("p[style]").each(function(){var t=e(this).attr("style").match(/mso\-list\:l([0-9]+)\slevel([0-9]+)/);if(t){var r=parseInt(t[1]),s=parseInt(t[2]),l=e(this).html().match(/^[\w]+\./)?"ol":"ul",d=e("<li/>").html(e(this).html());if(d.html(d.html().replace(/^([\w\.]+)</,"<")),d.find("span:first").remove(),1==s&&-1==e.inArray(r,a)){var c=e("<"+l+"/>").attr({"data-level":s,"data-list":r}).html(d);e(this).replaceWith(c),o=r,a.push(r)}else{if(s>n){for(var u=i.find('[data-level="'+n+'"][data-list="'+o+'"]'),h=n;h<s;h++)(c=e("<"+l+"/>")).appendTo(u.find("li").last()),u=c;u.attr({"data-level":s,"data-list":r}).html(d)}else{i.find('[data-level="'+s+'"][data-list="'+r+'"]').last().append(d)}n=s,o=r,e(this).remove()}}}),i.find("[data-level][data-list]").removeAttr("data-level data-list"),t=(t=(t=(t=(t=(t=(t=(t=i.html()).replace(/·/g,"")).replace(/<p class="Mso(.*?)"/gi,"<p")).replace(/ class=\"(mso[^\"]*)\"/gi,"")).replace(/ class=(mso\w+)/gi,"")).replace(/<o:p(.*?)>([\w\W]*?)<\/o:p>/gi,"$2")).replace(/\n/g," ")).replace(/<p>\n?<li>/gi,"<li>")}return t},onPasteExtra:function(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2")).replace(/<b(.*?)id="docs-internal-guid(.*?)">([\w\W]*?)<\/b>/gi,"$3")).replace(/<span[^>]*(font-style: italic; font-weight: bold|font-weight: bold; font-style: italic)[^>]*>/gi,'<span style="font-weight: bold;"><span style="font-style: italic;">')).replace(/<span[^>]*font-style: italic[^>]*>/gi,'<span style="font-style: italic;">')).replace(/<span[^>]*font-weight: bold[^>]*>/gi,'<span style="font-weight: bold;">')).replace(/<span[^>]*text-decoration: underline[^>]*>/gi,'<span style="text-decoration: underline;">')).replace(/<img>/gi,"")).replace(/\n{3,}/gi,"\n")).replace(/<font(.*?)>([\w\W]*?)<\/font>/gi,"$2")).replace(/<p><p>/gi,"<p>")).replace(/<\/p><\/p>/gi,"</p>")).replace(/<li>(\s*|\t*|\n*)<p>/gi,"<li>")).replace(/<\/p>(\s*|\t*|\n*)<\/li>/gi,"</li>")).replace(/<\/p>\s<p/gi,"</p><p")).replace(/<img src="webkit-fake-url\:\/\/(.*?)"(.*?)>/gi,"")).replace(/<p>•([\w\W]*?)<\/p>/gi,"<li>$1</li>"),this.utils.browser("mozilla")&&(e=e.replace(/<br\s?\/?>$/gi,"")),e},onPasteTidy:function(e,t){var i=["span","a","pre","blockquote","small","em","strong","code","kbd","mark","address","cite","var","samp","dfn","sup","sub","b","i","u","del","ol","ul","li","dl","dt","dd","p","br","video","audio","iframe","embed","param","object","img","table","td","th","tr","tbody","tfoot","thead","h1","h2","h3","h4","h5","h6"],o=!1,n=[["a","*"],["img",["src","alt"]],["span",["class","rel","data-verified"]],["iframe","*"],["video","*"],["audio","*"],["embed","*"],["object","*"],["param","*"],["source","*"]];"all"==t?(o=["p","span","h1","h2","h3","h4","h5","h6"],n=[["table","class"],["td",["colspan","rowspan"]],["a","*"],["img",["src","alt","data-redactor-inserted-image"]],["span",["class","rel","data-verified"]],["iframe","*"],["video","*"],["audio","*"],["embed","*"],["object","*"],["param","*"],["source","*"]]):"td"==t?i=["ul","ol","li","span","a","small","em","strong","code","kbd","mark","cite","var","samp","dfn","sup","sub","b","i","u","del","ol","ul","li","dl","dt","dd","br","iframe","video","audio","embed","param","object","img","h1","h2","h3","h4","h5","h6"]:"li"==t&&(i=["ul","ol","li","span","a","small","em","strong","code","kbd","mark","cite","var","samp","dfn","sup","sub","b","i","u","del","br","iframe","video","audio","embed","param","object","img"]);var a={deniedTags:!!this.opts.deniedTags&&this.opts.deniedTags,allowedTags:this.opts.allowedTags?this.opts.allowedTags:i,removeComments:!0,removePhp:!0,removeAttr:!!this.opts.removeAttr&&this.opts.removeAttr,allowedAttr:this.opts.allowedAttr?this.opts.allowedAttr:n,removeEmpty:o};return this.tidy.load(e,a)},onPasteRemoveEmpty:function(e){return e=e.replace(/<(p|h[1-6])>(|\s|\n|\t|<br\s?\/?>)<\/(p|h[1-6])>/gi,""),this.opts.linebreaks||(e=e.replace(/<br>$/i,"")),e},onPasteRemoveSpans:function(e){return e=(e=e.replace(/<span>(.*?)<\/span>/gi,"$1")).replace(/<span[^>]*>\s|&nbsp;<\/span>/gi," ")},onPasteIeFixLinks:function(t){return this.utils.browser("msie")?(0===e.trim(t).search(/^<a(.*?)>(.*?)<\/a>$/i)&&(t=t.replace(/^<a(.*?)>(.*?)<\/a>$/i,"$2")),t):t},isSingleLine:function(e,t){if(this.clean.singleLine=!1,!this.utils.isSelectAll()&&void 0===t){var i=this.opts.blockLevelElements.join("|").replace("P|","").replace("DIV|",""),o=e.match(new RegExp("</("+i+")>","gi")),n=e.match(/<\/(p|div)>/gi);if(!o&&(null===n||n&&n.length<=1))e.match(/<br\s?\/?>/gi)||(this.clean.singleLine=!0,e=e.replace(/<\/?(p|div)(.*?)>/gi,""))}return e},stripTags:function(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return e.replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(e,i){return t.indexOf("<"+i.toLowerCase()+">")>-1?e:""})},savePreCode:function(e){return e=this.clean.savePreFormatting(e),e=this.clean.saveCodeFormatting(e),e=this.clean.restoreSelectionMarker(e)},savePreFormatting:function(t){var i=t.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);return null!==i&&e.each(i,e.proxy(function(e,i){var o=i.match(/<pre(.*?)>([\w\W]*?)<\/pre>/i);o[2]=o[2].replace(/<br\s?\/?>/g,"\n"),o[2]=o[2].replace(/&nbsp;/g," "),this.opts.preSpaces&&(o[2]=o[2].replace(/\t/g,Array(this.opts.preSpaces+1).join(" "))),o[2]=this.clean.encodeEntities(o[2]),o[2]=o[2].replace(/\$/g,"&#36;"),t=t.replace(i,"<pre"+o[1]+">"+o[2]+"</pre>")},this)),t},saveCodeFormatting:function(t){var i=t.match(/<code(.*?)>([\w\W]*?)<\/code>/gi);return null!==i&&e.each(i,e.proxy(function(e,i){var o=i.match(/<code(.*?)>([\w\W]*?)<\/code>/i);o[2]=o[2].replace(/&nbsp;/g," "),o[2]=this.clean.encodeEntities(o[2]),o[2]=o[2].replace(/\$/g,"&#36;"),t=t.replace(i,"<code"+o[1]+">"+o[2]+"</code>")},this)),t},restoreSelectionMarker:function(e){return e=e.replace(/&lt;span id=&quot;selection-marker-([0-9])&quot; class=&quot;redactor-selection-marker&quot; data-verified=&quot;redactor&quot;&gt;​&lt;\/span&gt;/g,'<span id="selection-marker-$1" class="redactor-selection-marker" data-verified="redactor">​</span>')},getTextFromHtml:function(t){t=t.replace(/<br\s?\/?>|<\/H[1-6]>|<\/p>|<\/div>|<\/li>|<\/td>/gi,"\n");var i=document.createElement("div");return i.innerHTML=t,t=i.textContent||i.innerText,e.trim(t)},getPlainText:function(e,t){return e=(e=(e=(e=this.clean.getTextFromHtml(e)).replace(/\n\s*\n/g,"\n")).replace(/\n\n/g,"\n")).replace(/\n/g,"<br />"),this.opts.paragraphize&&void 0===t&&!this.utils.browser("mozilla")&&(e=this.paragraphize.load(e)),e},getPreCode:function(e){return e=(e=e.replace(/<img(.*?) style="(.*?)"(.*?[^>])>/gi,"<img$1$3>")).replace(/<img(.*?)>/gi,"&lt;img$1&gt;"),e=this.clean.getTextFromHtml(e),this.opts.preSpaces&&(e=e.replace(/\t/g,Array(this.opts.preSpaces+1).join(" "))),e=this.clean.encodeEntities(e)},getOnlyImages:function(e){return e=(e=(e=e.replace(/<img(.*?)>/gi,"[img$1]")).replace(/<([Ss]*?)>/gi,"")).replace(/\[img(.*?)\]/gi,"<img$1>")},getOnlyLinksAndImages:function(e){return e=(e=(e=(e=(e=e.replace(/<a(.*?)href="(.*?)"(.*?)>([\w\W]*?)<\/a>/gi,'[a href="$2"]$4[/a]')).replace(/<img(.*?)>/gi,"[img$1]")).replace(/<(.*?)>/gi,"")).replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2</a>')).replace(/\[img(.*?)\]/gi,"<img$1>")},encodeEntities:function(e){return(e=String(e).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},removeDirtyStyles:function(t){if(this.utils.browser("msie"))return t;var i=document.createElement("div");return i.innerHTML=t,this.clean.clearUnverifiedRemove(e(i)),t=i.innerHTML,e(i).remove(),t},clearUnverified:function(){if(!this.utils.browser("msie")){this.clean.clearUnverifiedRemove(this.$editor);var e=this.$editor.find("h1, h2, h3, h4, h5, h6");e.find("span").removeAttr("style"),e.find(this.opts.verifiedTags.join(", ")).removeAttr("style"),this.code.sync()}},clearUnverifiedRemove:function(t){t.find(this.opts.verifiedTags.join(", ")).removeAttr("style"),t.find("span").not('[data-verified="redactor"]').removeAttr("style"),t.find('span[data-verified="redactor"], img[data-verified="redactor"]').each(function(t,i){var o=e(i);o.attr("style",o.attr("rel"))})},cleanEmptyParagraph:function(){},setVerified:function(e){if(this.utils.browser("msie"))return e;var t=(e=(e=e.replace(new RegExp("<img(.*?[^>])>","gi"),'<img$1 data-verified="redactor">')).replace(new RegExp("<span(.*?[^>])>","gi"),'<span$1 data-verified="redactor">')).match(new RegExp('<(span|img)(.*?)style="(.*?)"(.*?[^>])>',"gi"));if(t)for(var i=t.length,o=0;o<i;o++)try{var n=t[o].replace(/style="(.*?)"/i,'style="$1" rel="$1"');e=e.replace(t[o],n)}catch(e){}return e},convertInline:function(t){var i=e("<div />").html(t),o=this.opts.inlineTags;return o.push("span"),i.find(o.join(",")).each(function(){var t=e(this),i=this.tagName.toLowerCase();t.attr("data-redactor-tag",i),"span"==i&&(t.attr("style")?t.attr("data-redactor-style",t.attr("style")):t.attr("class")&&t.attr("data-redactor-class",t.attr("class")))}),t=i.html(),i.remove(),t},normalizeLists:function(){this.$editor.find("li").each(function(t,i){var o=e(i).next();0===o.length||"UL"!=o[0].tagName&&"OL"!=o[0].tagName||e(i).append(o)})},removeSpaces:function(e){return e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\n/g,"")).replace(/[\t]*/g,"")).replace(/\n\s*\n/g,"\n")).replace(/^[\s\n]*/g," ")).replace(/[\s\n]*$/g," ")).replace(/>\s{2,}</g,"> <")).replace(/\n\n/g,"\n")).replace(/\u200B/g,"")},replaceDivs:function(e){return e=(e=(e=this.opts.linebreaks?(e=e.replace(/<div><br\s?\/?><\/div>/gi,"<br />")).replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"$2<br />"):e.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p$1>$2</p>")).replace(/<div(.*?[^>])>/gi,"")).replace(/<\/div>/gi,"")},replaceDivsToBr:function(e){return e=(e=(e=e.replace(/<div\s(.*?)>/gi,"<p>")).replace(/<div><br\s?\/?><\/div>/gi,"<br /><br />")).replace(/<div>([\w\W]*?)<\/div>/gi,"$1<br /><br />")},replaceParagraphsToBr:function(e){return e=(e=(e=(e=e.replace(/<p\s(.*?)>/gi,"<p>")).replace(/<p><br\s?\/?><\/p>/gi,"<br />")).replace(/<p>([\w\W]*?)<\/p>/gi,"$1<br /><br />")).replace(/(<br\s?\/?>){1,}\n?<\/blockquote>/gi,"</blockquote>")},saveFormTags:function(e){return e.replace(/<form(.*?)>([\w\W]*?)<\/form>/gi,'<section$1 rel="redactor-form-tag">$2</section>')},restoreFormTags:function(e){return e.replace(/<section(.*?) rel="redactor-form-tag"(.*?)>([\w\W]*?)<\/section>/gi,"<form$1$2>$3</form>")}}},code:function(){return{set:function(t){t=e.trim(t.toString()),t=this.clean.onSet(t),this.utils.browser("msie")&&(t=t.replace(/<span(.*?)id="selection-marker-(1|2)"(.*?)><\/span>/gi,"")),this.$editor.html(t),this.code.sync(),""!==t&&this.placeholder.remove(),setTimeout(e.proxy(this.buffer.add,this),15),!1===this.start&&this.observe.load()},get:function(){var e=this.$textarea.val();return this.opts.replaceDivs&&(e=this.clean.replaceDivs(e)),this.opts.linebreaks&&(e=this.clean.replaceParagraphsToBr(e)),e=this.tabifier.get(e)},sync:function(){setTimeout(e.proxy(this.code.startSync,this),10)},startSync:function(){var e=this.$editor.html();this.code.syncCode&&this.code.syncCode==e||this.start&&""==e||(this.code.syncCode=e,e=this.core.setCallback("syncBefore",e),e=this.clean.onSync(e),this.$textarea.val(e),this.core.setCallback("sync",e),!1===this.start&&this.core.setCallback("change",e),this.start=!1,0==this.autosave.html&&(this.autosave.html=this.code.get()),this.opts.codemirror&&this.$textarea.next(".CodeMirror").each(function(t,i){i.CodeMirror.setValue(e)}),this.autosave.onChange(),this.autosave.enable())},toggle:function(){this.opts.visual?this.code.showCode():this.code.showVisual()},showCode:function(){this.selection.save(),this.code.offset=this.caret.getOffset();var t=e(window).scrollTop(),i=(this.$editor.innerWidth(),this.$editor.innerHeight());this.$editor.hide();var o=this.$textarea.val();this.modified=this.clean.removeSpaces(o),o=this.tabifier.get(o);var n=0,a=0,r=e("<div/>").append(e.parseHTML(this.clean.onSync(this.$editor.html()),document,!0)),s=r.find("span.redactor-selection-marker");if(s.length>0){var l=this.tabifier.get(r.html()).replace(/&amp;/g,"&");1==s.length?(n=this.utils.strpos(l,r.find("#selection-marker-1").prop("outerHTML")),a=n):2==s.length&&(n=this.utils.strpos(l,r.find("#selection-marker-1").prop("outerHTML")),a=this.utils.strpos(l,r.find("#selection-marker-2").prop("outerHTML"))-r.find("#selection-marker-1").prop("outerHTML").toString().length)}this.selection.removeMarkers(),this.$textarea.val(o),this.opts.codemirror?this.$textarea.next(".CodeMirror").each(function(t,r){e(r).show(),r.CodeMirror.setValue(o),r.CodeMirror.setSize("100%",i),r.CodeMirror.refresh(),n==a?r.CodeMirror.setCursor(r.CodeMirror.posFromIndex(n).line,r.CodeMirror.posFromIndex(a).ch):r.CodeMirror.setSelection({line:r.CodeMirror.posFromIndex(n).line,ch:r.CodeMirror.posFromIndex(n).ch},{line:r.CodeMirror.posFromIndex(a).line,ch:r.CodeMirror.posFromIndex(a).ch}),r.CodeMirror.focus()}):(this.$textarea.height(i).show().focus(),this.$textarea.on("keydown.redactor-textarea-indenting",this.code.textareaIndenting),e(window).scrollTop(t),this.$textarea[0].setSelectionRange&&this.$textarea[0].setSelectionRange(n,a),this.$textarea[0].scrollTop=0),this.opts.visual=!1,this.button.setInactiveInCode(),this.button.setActive("html"),this.core.setCallback("source",o)},showVisual:function(){var e;if(!this.opts.visual){var t,i=0,o=0;if(this.opts.codemirror)this.$textarea.next(".CodeMirror").each(function(n,a){t=a.CodeMirror.listSelections(),i=a.CodeMirror.indexFromPos(t[0].anchor),o=a.CodeMirror.indexFromPos(t[0].head),e=a.CodeMirror.getValue()});else i=this.$textarea.get(0).selectionStart,o=this.$textarea.get(0).selectionEnd,e=this.$textarea.hide().val();if(i>o&&o>0){var n=i;i=o,o=n}if(i=this.code.enlargeOffset(e,i),o=this.code.enlargeOffset(e,o),e=e.substr(0,i)+this.selection.getMarkerAsHtml(1)+e.substr(i),o>i){var a=this.selection.getMarkerAsHtml(1).toString().length;e=e.substr(0,o+a)+this.selection.getMarkerAsHtml(2)+e.substr(o+a)}this.modified!==this.clean.removeSpaces(e)&&this.code.set(e),this.opts.codemirror&&this.$textarea.next(".CodeMirror").hide(),this.$editor.show(),this.utils.isEmpty(e)||this.placeholder.remove(),this.selection.restore(),this.$textarea.off("keydown.redactor-textarea-indenting"),this.button.setActiveInVisual(),this.button.setInactive("html"),this.observe.load(),this.opts.visual=!0,this.core.setCallback("visual",e)}},textareaIndenting:function(e){if(9!==e.keyCode)return!0;var t=this.$textarea,i=t.get(0).selectionStart;return t.val(t.val().substring(0,i)+"\t"+t.val().substring(t.get(0).selectionEnd)),t.get(0).selectionStart=t.get(0).selectionEnd=i+1,!1},enlargeOffset:function(e,t){var i=e.length,o=0;if(">"==e[t])o++;else for(var n=t;n<=i&&(o++,">"!=e[n]);n++)if("<"==e[n]||n==i){o=0;break}return t+o}}},core:function(){return{getObject:function(){return e.extend({},this)},getEditor:function(){return this.$editor},getBox:function(){return this.$box},getElement:function(){return this.$element},getTextarea:function(){return this.$textarea},getToolbar:function(){return!!this.$toolbar&&this.$toolbar},addEvent:function(e){this.core.event=e},getEvent:function(){return this.core.event},setCallback:function(t,i,o){var n=t+"Callback",a=this.opts[n];if(this.$textarea){var r=!1,s=e._data(this.$textarea[0],"events");if(void 0!==s&&void 0!==s[n]&&e.each(s[n],e.proxy(function(e,t){if("redactor"==t.namespace){var o=void 0===o?[i]:[i,o];r=void 0===o?t.handler.call(this,i):t.handler.call(this,i,o)}},this)),r)return r}return e.isFunction(a)?void 0===o?a.call(this,i):a.call(this,i,o):void 0===o?i:o},destroy:function(){this.opts.destroyed=!0,this.core.setCallback("destroy"),this.$element.off(".redactor").removeData("redactor"),this.$editor.off(".redactor"),e(document).off("mousedown.redactor-blur."+this.uuid),e(document).off("mousedown.redactor."+this.uuid),e(document).off("click.redactor-image-delete."+this.uuid),e(document).off("click.redactor-image-resize-hide."+this.uuid),e(document).off("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid),e("body").off("scroll.redactor."+this.uuid),e(this.opts.toolbarFixedTarget).off("scroll.redactor."+this.uuid),this.$editor.removeClass("redactor-editor redactor-linebreaks redactor-placeholder"),this.$editor.removeAttr("contenteditable");var t=this.code.get();this.opts.toolbar&&this.$toolbar.find("a").each(function(){var t=e(this);t.data("dropdown")&&(t.data("dropdown").remove(),t.data("dropdown",{}))}),this.build.isTextarea()?(this.$box.after(this.$element),this.$box.remove(),this.$element.val(t).show()):(this.$box.after(this.$editor),this.$box.remove(),this.$element.html(t).show()),this.$pasteBox&&this.$pasteBox.remove(),this.$modalBox&&this.$modalBox.remove(),this.$modalOverlay&&this.$modalOverlay.remove(),e(".redactor-toolbar-tooltip-"+this.uuid).remove(),clearInterval(this.autosaveInterval)}}},dropdown:function(){return{build:function(t,i,o){"formatting"==t&&this.opts.formattingAdd&&e.each(this.opts.formattingAdd,e.proxy(function(e,t){var i,n=t.tag;void 0!==t.class&&(n=n+"-"+t.class),t.type=this.utils.isBlockTag(t.tag)?"block":"inline",i=void 0!==t.func?t.func:"inline"==t.type?"inline.formatting":"block.formatting",this.opts.linebreaks&&"block"==t.type&&"p"==t.tag||(this.formatting[n]={tag:t.tag,style:t.style,class:t.class,attr:t.attr,data:t.data,clear:t.clear},o[n]={func:i,title:t.title})},this)),e.each(o,e.proxy(function(o,n){var a=e('<a href="#" class="redactor-dropdown-'+o+'" role="button">'+n.title+"</a>");"formatting"==t&&a.addClass("redactor-formatting-"+o),a.on("click",e.proxy(function(t){t.preventDefault();var i="func",a=n.func;n.command?(i="command",a=n.command):n.dropdown&&(i="dropdown",a=n.dropdown),e(t.target).hasClass("redactor-dropdown-link-inactive")||(this.button.onClick(t,o,i,a),this.dropdown.hideAll())},this)),this.observe.addDropdown(a,o,n),i.append(a)},this))},show:function(t,i){if(!this.opts.visual)return t.preventDefault(),!1;var o=this.button.get(i),n=o.data("dropdown").appendTo(document.body);if(this.opts.highContrast&&n.addClass("redactor-dropdown-contrast"),o.hasClass("dropact"))this.dropdown.hideAll();else{this.dropdown.hideAll(),this.observe.dropdowns(),this.core.setCallback("dropdownShow",{dropdown:n,key:i,button:o}),this.button.setActive(i),o.addClass("dropact");var a=o.offset(),r=n.width();a.left+r>e(document).width()&&(a.left=Math.max(0,a.left-r));var s=a.left+"px";if(this.$toolbar.hasClass("toolbar-fixed-box")){var l=this.$toolbar.innerHeight()+this.opts.toolbarFixedTopOffset,d="fixed";this.opts.toolbarFixedTarget!==document&&(l=this.$toolbar.innerHeight()+this.$toolbar.offset().top+this.opts.toolbarFixedTopOffset,d="absolute"),n.css({position:d,left:s,top:l+"px"}).show()}else{l=o.innerHeight()+a.top+"px";n.css({position:"absolute",left:s,top:l}).show()}this.core.setCallback("dropdownShown",{dropdown:n,key:i,button:o}),this.$dropdown=n}e(document).one("click.redactor-dropdown",e.proxy(this.dropdown.hide,this)),this.$editor.one("click.redactor-dropdown",e.proxy(this.dropdown.hide,this)),e(document).one("keyup.redactor-dropdown",e.proxy(this.dropdown.closeHandler,this)),t.stopPropagation()},closeHandler:function(e){e.which==this.keyCode.ESC&&(this.dropdown.hideAll(),this.$editor.focus())},hideAll:function(){this.$toolbar.find("a.dropact").removeClass("redactor-act").removeClass("dropact"),this.utils.enableBodyScroll(),e(".redactor-dropdown-"+this.uuid).hide(),e(".redactor-dropdown-link-selected").removeClass("redactor-dropdown-link-selected"),this.$dropdown&&(this.$dropdown.off(".redactor-dropdown"),this.core.setCallback("dropdownHide",this.$dropdown),this.$dropdown=!1)},hide:function(t){var i=e(t.target);i.hasClass("dropact")||i.hasClass("redactor-dropdown-link-inactive")||(i.hasClass("redactor-dropdown")&&(i.removeClass("dropact"),i.off("mouseover mouseout")),this.dropdown.hideAll())}}},file:function(){return{show:function(){this.modal.load("file",this.lang.get("file"),700),this.upload.init("#redactor-modal-file-upload",this.opts.fileUpload,this.file.insert),this.selection.save(),this.selection.get();var t=this.sel.toString();e("#redactor-filename").val(t),this.modal.show()},insert:function(t,i,o){if(void 0!==t.error)return this.modal.close(),this.selection.restore(),void this.core.setCallback("fileUploadError",t);var n;if("string"==typeof t)n=t;else{var a=e("#redactor-filename").val();void 0!==a&&""!==a||(a=t.filename),n='<a href="'+t.filelink+'" id="filelink-marker">'+a+"</a>"}if(i){this.selection.removeMarkers();var r=this.selection.getMarker();this.insert.nodeToCaretPositionFromPoint(o,r)}else this.modal.close();if(this.selection.restore(),this.buffer.set(),this.insert.htmlWithoutClean(n),"string"!=typeof t){var s=e(this.$editor.find("a#filelink-marker"));0!==s.length?s.removeAttr("id").removeAttr("style"):s=!1,this.core.setCallback("fileUpload",s,t)}}}},focus:function(){return{setStart:function(){this.$editor.focus();var e=this.$editor.children().first();if(0!==e.length&&0!==e[0].length&&"BR"!=e[0].tagName&&3!=e[0].nodeType){if("UL"==e[0].tagName||"OL"==e[0].tagName){var t=e.find("li").first();if(!this.utils.isBlock(t)&&""===t.text())return void this.caret.setStart(t)}if(this.opts.linebreaks&&!this.utils.isBlockTag(e[0].tagName))return this.selection.get(),this.range.setStart(this.$editor[0],0),this.range.setEnd(this.$editor[0],0),void this.selection.addRange();this.caret.setStart(e)}},setEnd:function(){var e=this.$editor.children().last();this.$editor.focus(),0!==e.size()&&(this.utils.isEmpty(this.$editor.html())?(this.selection.get(),this.range.collapse(!0),this.range.setStartAfter(e[0]),this.range.setEnd(e[0],0),this.selection.addRange()):(this.selection.get(),this.range.selectNodeContents(e[0]),this.range.collapse(!1),this.selection.addRange()))},isFocused:function(){return this.$editor[0]===document.activeElement}}},image:function(){return{show:function(){this.modal.load("image",this.lang.get("image"),700),this.upload.init("#redactor-modal-image-droparea",this.opts.imageUpload,this.image.insert),this.selection.save(),this.modal.show()},showEdit:function(t){var i=t.closest("a",this.$editor[0]);if(this.modal.load("imageEdit",this.lang.get("edit"),705),this.modal.createCancelButton(),this.image.buttonDelete=this.modal.createDeleteButton(this.lang.get("_delete")),this.image.buttonSave=this.modal.createActionButton(this.lang.get("save")),this.image.buttonDelete.on("click",e.proxy(function(){this.image.remove(t)},this)),this.image.buttonSave.on("click",e.proxy(function(){this.image.update(t)},this)),e(".redactor-link-tooltip").remove(),e("#redactor-image-title").val(t.attr("alt")),this.opts.imageLink){var o=e("#redactor-image-link");o.attr("href",t.attr("src")),0!==i.length&&(o.val(i.attr("href")),"_blank"==i.attr("target")&&e("#redactor-image-link-blank").prop("checked",!0))}else e(".redactor-image-link-option").hide();if(this.opts.imagePosition){var n="block"==t.css("display")&&"none"==t.css("float")?"center":t.css("float");e("#redactor-image-align").val(n)}else e(".redactor-image-position-option").hide();this.modal.show(),e("#redactor-image-title").focus()},setFloating:function(t){var i="",o="",n="";switch(e("#redactor-image-align").val()){case"left":i="left",n="0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin+" 0";break;case"right":i="right",n="0 0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin;break;case"center":o="block",n="auto"}t.css({float:i,display:o,margin:n}),t.attr("rel",t.attr("style"))},update:function(t){this.image.hideResize(),this.buffer.set();var i,o=t.closest("a",this.$editor[0]),n=e("#redactor-image-title").val().replace(/(<([^>]+)>)/gi,"");if(t.attr("alt",n),this.image.setFloating(t),""!==(i=(i=e.trim(e("#redactor-image-link").val())).replace(/(<([^>]+)>)/gi,""))){var a="((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}",r=new RegExp("^(http|ftp|https)://"+a,"i"),s=new RegExp("^"+a,"i");-1==i.search(r)&&0===i.search(s)&&this.opts.linkProtocol&&(i=this.opts.linkProtocol+"://"+i);var l=!!e("#redactor-image-link-blank").prop("checked");if(0===o.length){var d=e('<a href="'+i+'">'+this.utils.getOuterHtml(t)+"</a>");l&&d.attr("target","_blank"),t.replaceWith(d)}else o.attr("href",i),l?o.attr("target","_blank"):o.removeAttr("target")}else 0!==o.length&&o.replaceWith(this.utils.getOuterHtml(t));this.modal.close(),this.observe.images(),this.code.sync()},setEditable:function(t){this.opts.imageEditable&&t.on("dragstart",e.proxy(this.image.onDrag,this));var i=e.proxy(function(i){this.observe.image=t,this.image.resizer=this.image.loadEditableControls(t),e(document).on("mousedown.redactor-image-resize-hide."+this.uuid,e.proxy(this.image.hideResize,this)),this.opts.imageResizable&&this.image.resizer.on("mousedown.redactor touchstart.redactor",e.proxy(function(e){this.image.setResizable(e,t)},this))},this);t.off("mousedown.redactor").on("mousedown.redactor",e.proxy(this.image.hideResize,this)),t.off("click.redactor touchstart.redactor").on("click.redactor touchstart.redactor",i)},setResizable:function(e,t){e.preventDefault(),this.image.resizeHandle={x:e.pageX,y:e.pageY,el:t,ratio:t.width()/t.height(),h:t.height()},(e=e.originalEvent||e).targetTouches&&(this.image.resizeHandle.x=e.targetTouches[0].pageX,this.image.resizeHandle.y=e.targetTouches[0].pageY),this.image.startResize()},startResize:function(){e(document).on("mousemove.redactor-image-resize touchmove.redactor-image-resize",e.proxy(this.image.moveResize,this)),e(document).on("mouseup.redactor-image-resize touchend.redactor-image-resize",e.proxy(this.image.stopResize,this))},moveResize:function(e){e.preventDefault(),e=e.originalEvent||e;var t=this.image.resizeHandle.h;e.targetTouches?t+=e.targetTouches[0].pageY-this.image.resizeHandle.y:t+=e.pageY-this.image.resizeHandle.y;var i=Math.round(t*this.image.resizeHandle.ratio);if(!(t<50||i<100)){t=Math.round(this.image.resizeHandle.el.width()/this.image.resizeHandle.ratio);this.image.resizeHandle.el.attr({width:i,height:t}),this.image.resizeHandle.el.width(i),this.image.resizeHandle.el.height(t),this.code.sync()}},stopResize:function(){this.handle=!1,e(document).off(".redactor-image-resize"),this.image.hideResize()},onDrag:function(t){if(0!==this.$editor.find("#redactor-image-box").length)return t.preventDefault(),!1;this.$editor.on("drop.redactor-image-inside-drop",e.proxy(function(){setTimeout(e.proxy(this.image.onDrop,this),1)},this))},onDrop:function(){this.image.fixImageSourceAfterDrop(),this.observe.images(),this.$editor.off("drop.redactor-image-inside-drop"),this.clean.clearUnverified(),this.code.sync()},fixImageSourceAfterDrop:function(){this.$editor.find("img[data-save-url]").each(function(){var t=e(this);t.attr("src",t.attr("data-save-url")),t.removeAttr("data-save-url")})},hideResize:function(t){if(!t||0===e(t.target).closest("#redactor-image-box",this.$editor[0]).length){if(t&&"IMG"==t.target.tagName){var i=e(t.target);i.attr("data-save-url",i.attr("src"))}var o=this.$editor.find("#redactor-image-box");0!==o.length&&(e("#redactor-image-editter").remove(),e("#redactor-image-resizer").remove(),o.find("img").css({marginTop:o[0].style.marginTop,marginBottom:o[0].style.marginBottom,marginLeft:o[0].style.marginLeft,marginRight:o[0].style.marginRight}),o.css("margin",""),o.find("img").css("opacity",""),o.replaceWith(function(){return e(this).contents()}),e(document).off("mousedown.redactor-image-resize-hide."+this.uuid),void 0!==this.image.resizeHandle&&this.image.resizeHandle.el.attr("rel",this.image.resizeHandle.el.attr("style")),this.code.sync())}},loadResizableControls:function(t,i){if(this.opts.imageResizable&&!this.utils.isMobile()){var o=e('<span id="redactor-image-resizer" data-redactor="verified"></span>');return this.utils.isDesktop()||o.css({width:"15px",height:"15px"}),o.attr("contenteditable",!1),i.append(o),i.append(t),o}return i.append(t),!1},loadEditableControls:function(t){var i=e('<span id="redactor-image-box" data-redactor="verified">');if(i.css("float",t.css("float")).attr("contenteditable",!1),"auto"!=t[0].style.margin?(i.css({marginTop:t[0].style.marginTop,marginBottom:t[0].style.marginBottom,marginLeft:t[0].style.marginLeft,marginRight:t[0].style.marginRight}),t.css("margin","")):i.css({display:"block",margin:"auto"}),t.css("opacity",".5").after(i),this.opts.imageEditable){this.image.editter=e('<span id="redactor-image-editter" data-redactor="verified">'+this.lang.get("edit")+"</span>"),this.image.editter.attr("contenteditable",!1),this.image.editter.on("click",e.proxy(function(){this.image.showEdit(t)},this)),i.append(this.image.editter);var o=this.image.editter.innerWidth();this.image.editter.css("margin-left","-"+o/2+"px")}return this.image.loadResizableControls(t,i)},remove:function(t){var i,o=e(t),n=o.closest("a",this.$editor[0]),a=o.closest("figure",this.$editor[0]),r=o.parent();0!==e("#redactor-image-box").length&&(r=e("#redactor-image-box").parent()),0!==a.length?(i=a.next(),a.remove()):0!==n.length?(r=n.parent(),n.remove()):o.remove(),e("#redactor-image-box").remove(),0!==a.length?this.caret.setStart(i):this.caret.setStart(r),this.core.setCallback("imageDelete",o[0].src,o),this.modal.close(),this.code.sync()},insert:function(t,i,o){if(void 0!==t.error)return this.modal.close(),this.selection.restore(),void this.core.setCallback("imageUploadError",t);var n;"string"==typeof t?n=e(t).attr("data-redactor-inserted-image","true"):(n=e("<img>")).attr("src",t.filelink).attr("data-redactor-inserted-image","true");var a=n,r=this.utils.isCurrentOrParent("P");if(r&&(a=e("<blockquote />").append(n)),i){this.selection.removeMarkers();var s=this.selection.getMarker();this.insert.nodeToCaretPositionFromPoint(o,s)}else this.modal.close();this.selection.restore(),this.buffer.set(),this.insert.html(this.utils.getOuterHtml(a),!1);var l=this.$editor.find("img[data-redactor-inserted-image=true]").removeAttr("data-redactor-inserted-image");r?l.parent().contents().unwrap().wrap("<p />"):this.opts.linebreaks&&(this.utils.isEmpty(this.code.get())||l.before("<br>"),l.after("<br>")),"string"!=typeof t&&this.core.setCallback("imageUpload",l,t)}}},indent:function(){return{increase:function(){this.utils.browser("msie")||this.$editor.focus(),this.buffer.set(),this.selection.save();var e=this.selection.getBlock();e&&"LI"==e.tagName?this.indent.increaseLists():!1===e&&this.opts.linebreaks?this.indent.increaseText():this.indent.increaseBlocks(),this.selection.restore(),this.code.sync()},increaseLists:function(){document.execCommand("indent"),this.indent.fixEmptyIndent(),this.clean.normalizeLists(),this.clean.clearUnverified()},increaseBlocks:function(){e.each(this.selection.getBlocks(),e.proxy(function(e,t){if("TD"!==t.tagName&&"TH"!==t.tagName){var i=this.utils.getAlignmentElement(t),o=this.utils.normalize(i.css("margin-left"))+this.opts.indentValue;i.css("margin-left",o+"px")}},this))},increaseText:function(){var t=this.selection.wrap("div");e(t).attr("data-tagblock","redactor"),e(t).css("margin-left",this.opts.indentValue+"px")},decrease:function(){this.buffer.set(),this.selection.save();var e=this.selection.getBlock();e&&"LI"==e.tagName?this.indent.decreaseLists():this.indent.decreaseBlocks(),this.selection.restore(),this.code.sync()},decreaseLists:function(){document.execCommand("outdent");var t=this.selection.getCurrent(),i=e(t).closest("li",this.$editor[0]);this.indent.fixEmptyIndent(),this.opts.linebreaks||0!==i.length||(document.execCommand("formatblock",!1,"p"),this.$editor.find("ul, ol, blockquote, p").each(e.proxy(this.utils.removeEmpty,this))),this.clean.clearUnverified()},decreaseBlocks:function(){e.each(this.selection.getBlocks(),e.proxy(function(e,t){var i=this.utils.getAlignmentElement(t),o=this.utils.normalize(i.css("margin-left"))-this.opts.indentValue;o<=0?this.opts.linebreaks&&void 0!==i.data("tagblock")?i.replaceWith(i.html()+"<br />"):(i.css("margin-left",""),this.utils.removeEmptyAttr(i,"style")):i.css("margin-left",o+"px")},this))},fixEmptyIndent:function(){var t=this.selection.getBlock();if(this.range.collapsed&&t&&"LI"==t.tagName&&this.utils.isEmpty(e(t).text())){var i=e(t);i.find("span").not(".redactor-selection-marker").contents().unwrap(),i.append("<br>")}}}},inline:function(){return{formatting:function(e){var t,i;void 0!==this.formatting[e].style?t="style":void 0!==this.formatting[e].class&&(t="class"),t&&(i=this.formatting[e][t]),this.inline.format(this.formatting[e].tag,t,i)},format:function(t,i,o){var n=this.selection.getCurrent();if(!(n&&"TR"===n.tagName||this.utils.isCurrentOrParent("PRE")||this.utils.isCurrentOrParentHeader())){for(var a=["b","bold","i","italic","underline","strikethrough","deleted","superscript","subscript"],r=["strong","strong","em","em","u","del","del","sup","sub"],s=0;s<a.length;s++)t==a[s]&&(t=r[s]);if(this.opts.allowedTags){if(-1==e.inArray(t,this.opts.allowedTags))return}else if(-1!==e.inArray(t,this.opts.deniedTags))return;this.inline.type=i||!1,this.inline.value=o||!1,this.buffer.set(),this.utils.browser("msie")||this.opts.linebreaks||this.$editor.focus(),this.selection.get(),this.range.collapsed?this.inline.formatCollapsed(t):this.inline.formatMultiple(t)}},formatCollapsed:function(t){var i=this.selection.getCurrent(),o=e(i).closest(t+"[data-redactor-tag="+t+"]",this.$editor[0]);if(0===o.length||"style"==this.inline.type||"SPAN"==o[0].tagName){(n=e("<"+t+">").attr("data-verified","redactor").attr("data-redactor-tag",t)).html(this.opts.invisibleSpace),n=this.inline.setFormat(n);var n=this.insert.node(n);this.caret.setEnd(n),this.code.sync()}else this.utils.isEmpty(o.text())?(this.caret.setAfter(o[0]),o.remove(),this.code.sync()):this.utils.isEndOfElement(o)&&this.caret.setAfter(o[0])},formatMultiple:function(t){if(this.inline.formatConvert(t),this.selection.save(),document.execCommand("strikethrough"),this.$editor.find("strike").each(e.proxy(function(i,o){var n,a=e(o);this.inline.formatRemoveSameChildren(a,t),this.inline.type?(n=e("<span>").attr("data-redactor-tag",t).attr("data-verified","redactor"),n=this.inline.setFormat(n)):n=e("<"+t+">").attr("data-redactor-tag",t).attr("data-verified","redactor"),a.replaceWith(n.html(a.contents()));var r=n.parent();if("A"===n[0].tagName&&r&&"U"===r[0].tagName&&n.parent().replaceWith(n),"span"==t&&r&&"SPAN"===r[0].tagName&&"style"===this.inline.type)for(var s=this.inline.value.split(";"),l=0;l<s.length;l++){if(""===s[l])return;var d=s[l].split(":");r.css(d[0],""),this.utils.removeEmptyAttr(r,"style")&&r.replaceWith(r.contents())}},this)),"span"!=t&&this.$editor.find(this.opts.inlineTags.join(", ")).each(e.proxy(function(t,i){var o=e(i);"U"!==i.tagName||0!==i.attributes.length?"line-through"===o.css("text-decoration")&&(o.css("text-decoration",""),this.utils.removeEmptyAttr(o,"style")):o.replaceWith(o.contents())},this)),"del"!=t){var i=this;this.$editor.find("inline").each(function(e,t){i.utils.replaceToTag(t,"del")})}if("u"!=t){i=this;this.$editor.find("unline").each(function(e,t){i.utils.replaceToTag(t,"u")})}this.selection.restore(),this.code.sync()},formatRemoveSameChildren:function(t,i){var o=this;t.children(i).each(function(){var t=e(this);if(!t.hasClass("redactor-selection-marker"))if("style"==o.inline.type)for(var i=o.inline.value.split(";"),n=0;n<i.length;n++){if(""===i[n])return;var a=i[n].split(":");t.css(a[0],""),o.utils.removeEmptyAttr(t,"style")&&t.replaceWith(t.contents())}else t.contents().unwrap()})},formatConvert:function(t){this.selection.save();var i="";"class"==this.inline.type?i="[data-redactor-class="+this.inline.value+"]":"style"==this.inline.type&&(i='[data-redactor-style="'+this.inline.value+'"]');var o=this;"del"!=t&&this.$editor.find("del").each(function(e,t){o.utils.replaceToTag(t,"inline")}),"u"!=t&&this.$editor.find("u").each(function(e,t){o.utils.replaceToTag(t,"unline")}),"span"!=t&&this.$editor.find(t).each(function(){var t=e(this);t.replaceWith(e("<strike />").html(t.contents()))}),this.$editor.find('[data-redactor-tag="'+t+'"]'+i).each(function(){if(""!==i||"span"!=t||this.tagName.toLowerCase()!=t){var o=e(this);o.replaceWith(e("<strike />").html(o.contents()))}}),this.selection.restore()},setFormat:function(e){switch(this.inline.type){case"class":e.hasClass(this.inline.value)?(e.removeClass(this.inline.value),e.removeAttr("data-redactor-class")):(e.addClass(this.inline.value),e.attr("data-redactor-class",this.inline.value));break;case"style":e[0].style.cssText=this.inline.value,e.attr("data-redactor-style",this.inline.value)}return e},removeStyle:function(){this.buffer.set();var t=this.selection.getCurrent(),i=this.selection.getInlines();if(this.selection.save(),t&&"SPAN"===t.tagName){var o=e(t);o.removeAttr("style"),0===o[0].attributes.length&&o.replaceWith(o.contents())}e.each(i,e.proxy(function(t,i){var o=e(i);-1==e.inArray(i.tagName.toLowerCase(),this.opts.inlineTags)||o.hasClass("redactor-selection-marker")||(o.removeAttr("style"),0===o[0].attributes.length&&o.replaceWith(o.contents()))},this)),this.selection.restore(),this.code.sync()},removeStyleRule:function(t){this.buffer.set();var i=this.selection.getParent(),o=this.selection.getInlines();if(this.selection.save(),i&&"SPAN"===i.tagName){var n=e(i);n.css(t,""),this.utils.removeEmptyAttr(n,"style"),0===n[0].attributes.length&&n.replaceWith(n.contents())}e.each(o,e.proxy(function(i,o){var n=e(o);-1==e.inArray(o.tagName.toLowerCase(),this.opts.inlineTags)||n.hasClass("redactor-selection-marker")||(n.css(t,""),this.utils.removeEmptyAttr(n,"style"),0===n[0].attributes.length&&n.replaceWith(n.contents()))},this)),this.selection.restore(),this.code.sync()},removeFormat:function(){this.buffer.set();var t=this.selection.getCurrent();this.selection.save(),document.execCommand("removeFormat"),t&&"SPAN"===t.tagName&&e(t).replaceWith(e(t).contents()),e.each(this.selection.getNodes(),e.proxy(function(t,i){var o=e(i);-1==e.inArray(i.tagName.toLowerCase(),this.opts.inlineTags)||o.hasClass("redactor-selection-marker")||o.replaceWith(o.contents())},this)),this.selection.restore(),this.code.sync()},toggleClass:function(e){this.inline.format("span","class",e)},toggleStyle:function(e){this.inline.format("span","style",e)}}},insert:function(){return{set:function(t,i){this.placeholder.remove(),t=this.clean.setVerified(t),void 0===i&&(t=this.clean.onPaste(t,!1)),this.$editor.html(t),this.selection.remove(),this.focus.setEnd(),this.clean.normalizeLists(),this.code.sync(),this.observe.load(),void 0===i&&setTimeout(e.proxy(this.clean.clearUnverified,this),10)},text:function(t){if(this.placeholder.remove(),t=t.toString(),t=e.trim(t),t=this.clean.getPlainText(t,!1),this.$editor.focus(),this.utils.browser("msie"))this.insert.htmlIe(t);else{this.selection.get(),this.range.deleteContents();var i=document.createElement("div");i.innerHTML=t;for(var o,n,a=document.createDocumentFragment();o=i.firstChild;)n=a.appendChild(o);if(this.range.insertNode(a),n){var r=this.range.cloneRange();r.setStartAfter(n),r.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(r)}}this.code.sync(),this.clean.clearUnverified()},htmlWithoutClean:function(e){this.insert.html(e,!1)},html:function(t,i){this.placeholder.remove(),void 0===i&&(i=!0),this.opts.linebreaks||this.$editor.focus(),t=this.clean.setVerified(t),i&&(t=this.clean.onPaste(t)),this.utils.browser("msie")?this.insert.htmlIe(t):(this.clean.singleLine?this.insert.execHtml(t):document.execCommand("insertHTML",!1,t),this.insert.htmlFixMozilla()),this.clean.normalizeLists(),this.opts.linebreaks||this.$editor.find("p").each(e.proxy(this.utils.removeEmpty,this)),this.code.sync(),this.observe.load(),i&&this.clean.clearUnverified()},htmlFixMozilla:function(){if(this.utils.browser("mozilla")){var t=e(this.selection.getBlock()).next();t.length>0&&"P"==t[0].tagName&&""===t.html()&&t.remove()}},htmlIe:function(t){if(this.utils.isIe11()){var i=this.utils.isCurrentOrParent("P"),o=e("<div>").append(t).contents().is("p, :header, dl, ul, ol, div, table, td, blockquote, pre, address, section, header, footer, aside, article");i&&o?this.insert.ie11FixInserting(i,t):this.insert.ie11PasteFrag(t)}else document.selection.createRange().pasteHTML(t)},execHtml:function(e){e=this.clean.setVerified(e),this.selection.get(),this.range.deleteContents();var t=document.createElement("div");t.innerHTML=e;for(var i,o,n=document.createDocumentFragment();i=t.firstChild;)o=n.appendChild(i);this.range.insertNode(n),this.range.collapse(!0),this.caret.setAfter(o)},node:function(t,i){t=t[0]||t;var o=this.caret.getOffset(),n=this.utils.getOuterHtml(t);return null!==(n=this.clean.setVerified(n)).match(/</g)&&(t=e(n)[0]),this.selection.get(),!1!==i&&this.range.deleteContents(),this.range.insertNode(t),this.range.collapse(!1),this.selection.addRange(),this.caret.setOffset(o),t},nodeToPoint:function(e,t,i){var o;if(e=e[0]||e,this.selection.get(),document.caretPositionFromPoint){var n=document.caretPositionFromPoint(t,i);this.range.setStart(n.offsetNode,n.offset),this.range.collapse(!0),this.range.insertNode(e)}else if(document.caretRangeFromPoint)(o=document.caretRangeFromPoint(t,i)).insertNode(e);else if(void 0!==document.body.createTextRange){(o=document.body.createTextRange()).moveToPoint(t,i);var a=o.duplicate();a.moveToPoint(t,i),o.setEndPoint("EndToEnd",a),o.select()}},nodeToCaretPositionFromPoint:function(e,t){var i;t=t[0]||t;var o=e.clientX,n=e.clientY;if(document.caretPositionFromPoint){var a=document.caretPositionFromPoint(o,n);(i=document.getSelection().getRangeAt(0)).setStart(a.offsetNode,a.offset),i.collapse(!0),i.insertNode(t)}else if(document.caretRangeFromPoint)(i=document.caretRangeFromPoint(o,n)).insertNode(t);else if(void 0!==document.body.createTextRange){(i=document.body.createTextRange()).moveToPoint(o,n);var r=i.duplicate();r.moveToPoint(o,n),i.setEndPoint("EndToEnd",r),i.select()}},ie11FixInserting:function(t,i){var o=document.createElement("span");o.className="redactor-ie-paste",this.insert.node(o);var n=e(t).html();n=(n="<p>"+n.replace(/<span class="redactor-ie-paste"><\/span>/gi,"</p>"+i+"<p>")+"</p>").replace(/<p><\/p>/gi,""),e(t).replaceWith(n)},ie11PasteFrag:function(e){this.selection.get(),this.range.deleteContents();var t=document.createElement("div");t.innerHTML=e;for(var i,o=document.createDocumentFragment();i=t.firstChild;)o.appendChild(i);this.range.insertNode(o),this.range.collapse(!1),this.selection.addRange()}}},keydown:function(){return{init:function(t){if(!this.rtePaste){var i=t.which,o=i>=37&&i<=40;if(this.keydown.ctrl=t.ctrlKey||t.metaKey,this.keydown.current=this.selection.getCurrent(),this.keydown.parent=this.selection.getParent(),this.keydown.block=this.selection.getBlock(),this.keydown.pre=this.utils.isTag(this.keydown.current,"pre"),this.keydown.blockquote=this.utils.isTag(this.keydown.current,"blockquote"),this.keydown.figcaption=this.utils.isTag(this.keydown.current,"figcaption"),this.shortcuts.init(t,i),this.utils.isDesktop()&&(this.keydown.checkEvents(o,i),this.keydown.setupBuffer(t,i)),this.keydown.addArrowsEvent(o),this.keydown.setupSelectAll(t,i),!1===this.core.setCallback("keydown",t))return t.preventDefault(),!1;if(this.opts.enterKey&&(this.utils.browser("msie")||this.utils.browser("mozilla"))&&(i===this.keyCode.DOWN||i===this.keyCode.RIGHT)){var n=!1,a=!1;if(this.keydown.block&&"TD"===this.keydown.block.tagName&&(a=e(this.keydown.block).closest("table",this.$editor[0])),a&&a.find("td").last()[0]===this.keydown.block&&(n=!0),this.utils.isEndOfElement()&&n){var r=e(this.opts.emptyHtml);a.after(r),this.caret.setStart(r)}}if(this.opts.enterKey&&i===this.keyCode.DOWN&&this.keydown.onArrowDown(),!this.opts.enterKey&&i===this.keyCode.ENTER)return t.preventDefault(),void(this.range.collapsed||this.range.deleteContents());if(i==this.keyCode.ENTER&&!t.shiftKey&&!t.ctrlKey&&!t.metaKey){var s,l;if(!1===this.core.setCallback("enter",t))return t.preventDefault(),!1;if(this.keydown.blockquote&&!0===this.keydown.exitFromBlockquote(t))return!1;if(this.keydown.pre)return this.keydown.insertNewLine(t);if(this.keydown.blockquote||this.keydown.figcaption)return s=this.selection.getCurrent(),0!==(l=e(s).next()).length&&"BR"==l[0].tagName?this.keydown.insertBreakLine(t):this.utils.isEndOfElement()&&s&&"SPAN"!=s?this.keydown.insertDblBreakLine(t):this.keydown.insertBreakLine(t);if(this.opts.linebreaks&&!this.keydown.block)return s=this.selection.getCurrent(),0!==(l=e(this.keydown.current).next()).length&&"BR"==l[0].tagName?this.keydown.insertBreakLine(t):!1!==s&&e(s).hasClass("redactor-invisible-space")?(this.caret.setAfter(s),e(s).contents().unwrap(),this.keydown.insertDblBreakLine(t)):this.utils.isEndOfEditor()?this.keydown.insertDblBreakLine(t):(0===l.length&&!1===s&&l.context,this.keydown.insertBreakLine(t));if(this.opts.linebreaks&&this.keydown.block)setTimeout(e.proxy(this.keydown.replaceDivToBreakLine,this),1);else if(!this.opts.linebreaks&&this.keydown.block){if(setTimeout(e.proxy(this.keydown.replaceDivToParagraph,this),1),"LI"===this.keydown.block.tagName){s=this.selection.getCurrent();var d=e(s).closest("li",this.$editor[0]),c=d.closest("ul,ol",this.$editor[0]);if(0!==d.length&&this.utils.isEmpty(d.html())&&0===c.next().length&&this.utils.isEmpty(c.find("li").last().html())){c.find("li").last().remove();r=e(this.opts.emptyHtml);return c.after(r),this.caret.setStart(r),!1}}}else if(!this.opts.linebreaks&&!this.keydown.block)return this.keydown.insertParagraph(t)}if(i===this.keyCode.ENTER&&(t.ctrlKey||t.shiftKey))return this.keydown.onShiftEnter(t);if(i===this.keyCode.TAB||t.metaKey&&221===i||t.metaKey&&219===i)return this.keydown.onTab(t,i);if(i===this.keyCode.BACKSPACE||i===this.keyCode.DELETE){var u=this.selection.getNodes();if(u)for(var h,p=u.length,f=0;f<p;f++){var m=e(u[f]).children("img");if(0!==m.length){var g=this;e.each(m,function(t,i){var o=e(i);"none"==o.css("float")&&(g.core.setCallback("imageDelete",i.src,o),h=i)})}else"IMG"==u[f].tagName&&h!=u[f]&&(this.core.setCallback("imageDelete",u[f].src,e(u[f])),h=u[f])}}if(i===this.keyCode.BACKSPACE){var v=this.selection.getBlock(),b="0px"!==e(v).css("margin-left");if(v&&b&&this.range.collapsed&&this.utils.isStartOfElement())return this.indent.decrease(),void t.preventDefault();if(this.utils.browser("mozilla")){var y=this.selection.getPrev(),w=e(y).prev()[0];y&&"HR"===y.tagName&&e(y).remove(),w&&"HR"===w.tagName&&e(w).remove()}this.keydown.removeInvisibleSpace(),this.keydown.removeEmptyListInTable(t)}this.code.sync()}},checkEvents:function(e,t){e||"click"!=this.core.getEvent()&&"arrow"!=this.core.getEvent()||(this.core.addEvent(!1),this.keydown.checkKeyEvents(t)&&this.buffer.set())},checkKeyEvents:function(t){var i=this.keyCode,o=[i.BACKSPACE,i.DELETE,i.ENTER,i.ESC,i.TAB,i.CTRL,i.META,i.ALT,i.SHIFT];return-1==e.inArray(t,o)},addArrowsEvent:function(e){e&&("click"!=this.core.getEvent()&&"arrow"!=this.core.getEvent()?this.core.addEvent("arrow"):this.core.addEvent(!1))},setupBuffer:function(e,t){return this.keydown.ctrl&&90===t&&!e.shiftKey&&!e.altKey&&this.opts.buffer.length?(e.preventDefault(),void this.buffer.undo()):this.keydown.ctrl&&90===t&&e.shiftKey&&!e.altKey&&0!==this.opts.rebuffer.length?(e.preventDefault(),void this.buffer.redo()):void(this.keydown.ctrl||t!=this.keyCode.BACKSPACE&&t!=this.keyCode.DELETE&&(t!=this.keyCode.ENTER||e.ctrlKey||e.shiftKey)||this.buffer.set())},setupSelectAll:function(e,t){this.keydown.ctrl&&65===t?this.utils.enableSelectAll():t==this.keyCode.LEFT_WIN||this.keydown.ctrl||this.utils.disableSelectAll()},onArrowDown:function(){for(var e=[this.keydown.blockquote,this.keydown.pre,this.keydown.figcaption],t=0;t<e.length;t++)if(e[t])return this.keydown.insertAfterLastElement(e[t]),!1},onShiftEnter:function(e){return this.buffer.set(),this.utils.isEndOfElement()?this.keydown.insertDblBreakLine(e):this.keydown.insertBreakLine(e)},onTab:function(e,t){return!this.opts.tabKey||(!(!this.utils.isEmpty(this.code.get())||!1!==this.opts.tabAsSpaces)||(e.preventDefault(),this.keydown.pre&&!e.shiftKey?(i=this.opts.preSpaces?document.createTextNode(Array(this.opts.preSpaces+1).join(" ")):document.createTextNode("\t"),this.insert.node(i),this.code.sync()):!1!==this.opts.tabAsSpaces?(i=document.createTextNode(Array(this.opts.tabAsSpaces+1).join(" ")),this.insert.node(i),this.code.sync()):e.metaKey&&219===t?this.indent.decrease():e.metaKey&&221===t?this.indent.increase():e.shiftKey?this.indent.decrease():this.indent.increase(),!1));var i},replaceDivToBreakLine:function(){var t=this.selection.getBlock(),i=t.innerHTML.replace(/<br\s?\/?>/gi,"");if(("DIV"===t.tagName||"P"===t.tagName)&&""===i&&!e(t).hasClass("redactor-editor")){var o=document.createElement("br");return e(t).replaceWith(o),this.caret.setBefore(o),this.code.sync(),!1}},replaceDivToParagraph:function(){var t=this.selection.getBlock(),i=t.innerHTML.replace(/<br\s?\/?>/gi,"");if("DIV"===t.tagName&&this.utils.isEmpty(i)&&!e(t).hasClass("redactor-editor")){var o=document.createElement("p");return o.innerHTML=this.opts.invisibleSpace,e(t).replaceWith(o),this.caret.setStart(o),this.code.sync(),!1}this.opts.cleanStyleOnEnter&&"P"==t.tagName&&e(t).removeAttr("class").removeAttr("style")},insertParagraph:function(e){e.preventDefault(),this.selection.get();var t=document.createElement("p");return t.innerHTML=this.opts.invisibleSpace,this.range.deleteContents(),this.range.insertNode(t),this.caret.setStart(t),this.code.sync(),!1},exitFromBlockquote:function(t){if(this.utils.isEndOfElement()){var i=e.trim(e(this.keydown.block).html());if(-1!=i.search(/(<br\s?\/?>){2}$/i)){if(t.preventDefault(),this.opts.linebreaks){var o=document.createElement("br");e(this.keydown.blockquote).after(o),this.caret.setBefore(o),e(this.keydown.block).html(i.replace(/<br\s?\/?>$/i,""))}else{var n=e(this.opts.emptyHtml);e(this.keydown.blockquote).after(n),this.caret.setStart(n)}return!0}}},insertAfterLastElement:function(t){if(this.utils.isEndOfElement())if(this.buffer.set(),this.opts.linebreaks){var i=e("<div>").append(e.trim(this.$editor.html())).contents(),o=i.last()[0];if("SPAN"==o.tagName&&""===o.innerHTML&&(o=i.prev()[0]),this.utils.getOuterHtml(o)!=this.utils.getOuterHtml(t))return;var n=document.createElement("br");e(t).after(n),this.caret.setAfter(n)}else{if(this.$editor.contents().last()[0]!==t)return;var a=e(this.opts.emptyHtml);e(t).after(a),this.caret.setStart(a)}},insertNewLine:function(e){e.preventDefault();var t=document.createTextNode("\n");return this.selection.get(),this.range.deleteContents(),this.range.insertNode(t),this.caret.setAfter(t),this.code.sync(),!1},insertBreakLine:function(e){return this.keydown.insertBreakLineProcessing(e)},insertDblBreakLine:function(e){return this.keydown.insertBreakLineProcessing(e,!0)},insertBreakLineProcessing:function(t,i){t.stopPropagation(),this.selection.get();var o=document.createElement("br");this.utils.browser("msie")?(this.range.collapse(!1),this.range.setEnd(this.range.endContainer,this.range.endOffset)):this.range.deleteContents(),this.range.insertNode(o);var n=e(o).parent("a");if(n.length>0&&(n.find(o).remove(),n.after(o)),!0===i){var a=e(o).next();if(0!==a.length&&"BR"===a[0].tagName&&this.utils.isEndOfEditor())return this.caret.setAfter(o),this.code.sync(),!1;var r=document.createElement("br");this.range.insertNode(r),this.caret.setAfter(r)}else if(this.utils.browser("msie")){var s=document.createElement("span");s.innerHTML="&#x200b;",e(o).after(s),this.range.setStartAfter(s),this.range.setEndAfter(s),e(s).remove()}else{var l=document.createRange();l.setStartAfter(o),l.collapse(!0);var d=window.getSelection();d.removeAllRanges(),d.addRange(l)}return this.code.sync(),!1},removeInvisibleSpace:function(){var t=e(this.keydown.current);0===t.text().search(/^\u200B$/g)&&t.remove()},removeEmptyListInTable:function(t){var i=e(this.keydown.current),o=e(this.keydown.parent),n=i.closest("td",this.$editor[0]);if(0!==n.length&&i.closest("li",this.$editor[0])&&1===o.children("li").length){if(!this.utils.isEmpty(i.text()))return;t.preventDefault(),i.remove(),o.remove(),this.caret.setStart(n)}}}},keyup:function(){return{init:function(t){if(!this.rtePaste){var i=t.which;this.keyup.current=this.selection.getCurrent(),this.keyup.parent=this.selection.getParent();var o=this.utils.isRedactorParent(e(this.keyup.parent).parent());if(!1===this.core.setCallback("keyup",t))return t.preventDefault(),!1;if(!this.opts.linebreaks&&3===this.keyup.current.nodeType&&this.keyup.current.length<=1&&(!1===this.keyup.parent||"BODY"==this.keyup.parent.tagName)&&this.keyup.replaceToParagraph(),!this.opts.linebreaks&&this.utils.isRedactorParent(this.keyup.current)&&"DIV"===this.keyup.current.tagName&&this.keyup.replaceToParagraph(!1),this.opts.linebreaks||!e(this.keyup.parent).hasClass("redactor-invisible-space")||!1!==o&&"BODY"!=o[0].tagName||(e(this.keyup.parent).contents().unwrap(),this.keyup.replaceToParagraph()),this.linkify.isEnabled()&&this.linkify.isKey(i)&&this.linkify.format(),i===this.keyCode.DELETE||i===this.keyCode.BACKSPACE){if(this.utils.browser("mozilla")){var n=e(this.keydown.current).closest("td",this.$editor[0]);if(0!==n.size()&&""!==n.text())return t.preventDefault(),!1}return this.clean.clearUnverified(),this.observe.image?(t.preventDefault(),this.image.hideResize(),this.buffer.set(),this.image.remove(this.observe.image),this.observe.image=!1,!1):(this.$editor.find("p").each(e.proxy(function(t,i){this.utils.removeEmpty(t,e(i).html())},this)),this.opts.linebreaks&&this.keyup.current&&"DIV"==this.keyup.current.tagName&&this.utils.isEmpty(this.keyup.current.innerHTML)&&(e(this.keyup.current).after(this.selection.getMarkerAsHtml()),this.selection.restore(),e(this.keyup.current).remove()),this.keyup.removeEmptyLists(),this.keyup.formatEmpty(t))}}},replaceToParagraph:function(t){var i,o=e(this.keyup.current);i=!1===t?e("<p>").append(o.html()):e("<p>").append(o.clone()),o.replaceWith(i);var n=e(i).next();void 0!==n[0]&&"BR"==n[0].tagName&&n.remove(),this.caret.setEnd(i)},removeEmptyLists:function(){var t=function(){""===e.trim(this.innerHTML).replace(/\/t\/n/g,"")&&e(this).remove()};this.$editor.find("li").each(t),this.$editor.find("ul, ol").each(t)},formatEmpty:function(t){var i=e.trim(this.$editor.html());if(this.utils.isEmpty(i))return t.preventDefault(),this.opts.linebreaks?(this.$editor.html(this.selection.getMarkerAsHtml()),this.selection.restore()):(this.$editor.html(this.opts.emptyHtml),this.focus.setStart()),this.code.sync(),!1}}},lang:function(){return{load:function(){this.opts.curLang=this.opts.langs[this.opts.lang]},get:function(e){return void 0!==this.opts.curLang[e]?this.opts.curLang[e]:""}}},line:function(){return{insert:function(){this.buffer.set();var e=this.selection.getBlocks();!1!==e[0]&&this.line.isExceptLastOrFirst(e)?this.utils.browser("msie")||this.$editor.focus():this.utils.browser("msie")?this.line.insertInIe():this.line.insertInOthersBrowsers()},isExceptLastOrFirst:function(t){var i=["li","td","th","blockquote","figcaption","pre","dl","dt","dd"],o=t[0].tagName.toLowerCase(),n=this.selection.getLastBlock();n=void 0===n?o:n.tagName.toLowerCase();var a=-1!=e.inArray(o,i),r=-1!=e.inArray(n,i);if(a&&r||a)return!0},insertInIe:function(){this.utils.saveScroll(),this.buffer.set(),this.insert.node(document.createElement("hr")),this.utils.restoreScroll(),this.code.sync()},insertInOthersBrowsers:function(){this.buffer.set();var e='<p id="redactor-insert-line"><br /></p>';this.opts.linebreaks&&(e='<br id="redactor-insert-line">'),document.execCommand("insertHtml",!1,"<hr>"+e),this.line.setFocus(),this.code.sync()},setFocus:function(){var t=this.$editor.find("#redactor-insert-line"),i=e(t).next()[0],o=i;this.utils.browser("mozilla")&&i&&""===i.innerHTML&&(o=e(i).next()[0],e(i).remove()),o?(t.remove(),this.opts.linebreaks||(this.$editor.focus(),this.line.setStart(o))):(t.removeAttr("id"),this.line.setStart(t[0]))},setStart:function(e){if(void 0!==e){var t=document.createTextNode("​");this.selection.get(),this.range.setStart(e,0),this.range.insertNode(t),this.range.collapse(!0),this.selection.addRange()}}}},link:function(){return{show:function(t){void 0!==t&&t.preventDefault&&t.preventDefault(),this.observe.isCurrent("a")?this.modal.load("link",this.lang.get("link_edit"),600):this.modal.load("link",this.lang.get("link_insert"),600),this.modal.createCancelButton();var i=this.observe.isCurrent("a")?this.lang.get("edit"):this.lang.get("insert");this.link.buttonInsert=this.modal.createActionButton(i),this.selection.get(),this.link.getData(),this.link.cleanUrl(),"_blank"==this.link.target&&e("#redactor-link-blank").prop("checked",!0),this.link.$inputUrl=e("#redactor-link-url"),this.link.$inputText=e("#redactor-link-url-text"),this.link.$inputText.val(this.link.text),this.link.$inputUrl.val(this.link.url),this.link.buttonInsert.on("click",e.proxy(this.link.insert,this)),e(".redactor-link-tooltip").remove(),this.selection.save(),this.modal.show(),this.link.$inputUrl.focus()},cleanUrl:function(){var e=self.location.href.replace(/\/$/i,"");if(void 0!==this.link.url&&(this.link.url=this.link.url.replace(e,""),this.link.url=this.link.url.replace(/^\/#/,"#"),this.link.url=this.link.url.replace("mailto:",""),!this.opts.linkProtocol)){var t=new RegExp("^(http|ftp|https)://"+self.location.host,"i");this.link.url=this.link.url.replace(t,"")}},getData:function(){this.link.$node=!1;var t=e(this.selection.getCurrent()).closest("a",this.$editor[0]);0!==t.length&&"A"===t[0].tagName?(this.link.$node=t,this.link.url=t.attr("href"),this.link.text=t.text(),this.link.target=t.attr("target")):(this.link.text=this.sel.toString(),this.link.url="",this.link.target="")},insert:function(){this.placeholder.remove();var t="",i=this.link.$inputUrl.val(),o=this.link.$inputText.val().replace(/(<([^>]+)>)/gi,"");if(""!==e.trim(i)){if(-1!=i.search("@")&&!1===/(http|ftp|https):\/\//i.test(i))i="mailto:"+(i=i.replace("mailto:",""));else if(0!==i.search("#")){e("#redactor-link-blank").prop("checked")&&(t="_blank");var n="((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}",a=new RegExp("^(http|ftp|https)://"+n,"i"),r=new RegExp("^"+n,"i"),s=new RegExp(".(html|php)$","i");-1==i.search(a)&&-1==i.search(s)&&0===i.search(r)&&this.opts.linkProtocol&&(i=this.opts.linkProtocol+"://"+i)}this.link.set(o,i,t),this.modal.close()}else this.link.$inputUrl.addClass("redactor-input-error").on("keyup",function(){e(this).removeClass("redactor-input-error"),e(this).off("keyup")})},set:function(t,i,o){t=e.trim(t.replace(/<|>/g,"")),this.selection.restore();var n=this.selection.getBlocks();if(""!==t||""!==i){if(""===t&&""!==i&&(t=i),this.link.$node){this.buffer.set();var a=this.link.$node,r=a.children();if(r.length>0){for(;r.length;)r=r.children();r=r.end()}else r=a;a.attr("href",i),r.text(t),""!==o?a.attr("target",o):a.removeAttr("target"),this.selection.selectElement(a),this.code.sync()}else{if(this.utils.browser("mozilla")&&""===this.link.text){var s=e("<a />").attr("href",i).text(t);""!==o&&s.attr("target",o),s=e(this.insert.node(s)),this.opts.linebreaks&&s.after("&nbsp;"),this.selection.selectElement(s)}else{this.utils.browser("msie")?(s=e('<a href="'+i+'">').text(t),""!==o&&s.attr("target",o),s=e(this.insert.node(s)),this.selection.getText().match(/\s$/)&&s.after(" "),this.selection.selectElement(s)):(document.execCommand("createLink",!1,i),s=e(this.selection.getCurrent()).closest("a",this.$editor[0]),this.utils.browser("mozilla")&&(s=e('a[_moz_dirty=""]')),""!==o&&s.attr("target",o),s.removeAttr("style").removeAttr("_moz_dirty"),this.selection.getText().match(/\s$/)&&s.after(" "),""===this.link.text&&this.link.text==t||(!this.opts.linebreaks&&n&&n.length<=1?s.text(t):this.opts.linebreaks&&s.text(t),this.selection.selectElement(s)))}this.code.sync(),this.core.setCallback("insertedLink",s)}setTimeout(e.proxy(function(){this.observe.links()},this),5)}},unlink:function(t){void 0!==t&&t.preventDefault&&t.preventDefault();var i=this.selection.getNodes();if(i){this.buffer.set();for(var o=i.length,n=[],a=0;a<o;a++){"A"===i[a].tagName&&n.push(i[a]);var r=e(i[a]).closest("a",this.$editor[0]);r.replaceWith(r.contents())}this.core.setCallback("deletedLink",n),e(".redactor-link-tooltip").remove(),this.code.sync()}},toggleClass:function(e){this.link.setClass(e,"toggleClass")},addClass:function(e){this.link.setClass(e,"addClass")},removeClass:function(e){this.link.setClass(e,"removeClass")},setClass:function(t,i){var o=this.selection.getInlinesTags(["a"]);!1!==o&&e.each(o,function(){e(this)[i](t)})}}},linkify:function(){return{isKey:function(e){return e==this.keyCode.ENTER||e==this.keyCode.SPACE},isEnabled:function(){return this.opts.convertLinks&&(this.opts.convertUrlLinks||this.opts.convertImageLinks||this.opts.convertVideoLinks)&&!this.utils.isCurrentOrParent("PRE")},format:function(){var t=this.linkify,i=this.opts;this.$editor.find(":not(iframe,img,a,pre)").addBack().contents().filter(function(){return 3===this.nodeType&&""!=e.trim(this.nodeValue)&&!e(this).parent().is("pre")&&(this.nodeValue.match(i.linkify.regexps.youtube)||this.nodeValue.match(i.linkify.regexps.vimeo)||this.nodeValue.match(i.linkify.regexps.image)||this.nodeValue.match(i.linkify.regexps.url))}).each(function(){var o=e(this).text(),n=o;i.convertVideoLinks&&(n.match(i.linkify.regexps.youtube)||n.match(i.linkify.regexps.vimeo))?n=t.convertVideoLinks(n):i.convertImageLinks&&n.match(i.linkify.regexps.image)?n=t.convertImages(n):i.convertUrlLinks&&(n=t.convertLinks(n)),e(this).before(o.replace(o,n)).remove()});var o=this.$editor.find(".redactor-linkify-object").each(function(){var t=e(this);return t.removeClass("redactor-linkify-object"),""===t.attr("class")&&t.removeAttr("class"),t[0]});setTimeout(e.proxy(function(){this.observe.load(),this.core.setCallback("linkify",o)},this),100),this.code.sync()},convertVideoLinks:function(e){var t='<iframe class="redactor-linkify-object" width="500" height="281" src="',i='" frameborder="0" allowfullscreen></iframe>';return e.match(this.opts.linkify.regexps.youtube)&&(e=e.replace(this.opts.linkify.regexps.youtube,t+"//www.youtube.com/embed/$1"+i)),e.match(this.opts.linkify.regexps.vimeo)&&(e=e.replace(this.opts.linkify.regexps.vimeo,t+"//player.vimeo.com/video/$2"+i)),e},convertImages:function(e){var t=e.match(this.opts.linkify.regexps.image);return t&&(e=e.replace(e,'<img src="'+t+'" class="redactor-linkify-object" />'),this.opts.linebreaks&&(this.utils.isEmpty(this.code.get())||(e="<br>"+e)),e+="<br>"),e},convertLinks:function(t){var i=t.match(this.opts.linkify.regexps.url);if(i)for(var o=(i=e.grep(i,function(t,o){return e.inArray(t,i)===o})).length,n=0;n<o;n++){var a=i[n],r=a,s=this.opts.linkProtocol+"://";null!==a.match(/(https?|ftp):\/\//i)&&(s=""),r.length>this.opts.linkSize&&(r=r.substring(0,this.opts.linkSize)+"..."),-1===r.search("%")&&(r=decodeURIComponent(r));var l="\\b";-1!=e.inArray(a.slice(-1),["/","&","="])&&(l="");var d=new RegExp("("+a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+l+")","g");t=t.replace(d,'<a href="'+s+e.trim(a)+'" class="redactor-linkify-object">'+e.trim(r)+"</a>")}return t}}},list:function(){return{toggle:function(t){this.placeholder.remove(),this.utils.browser("msie")||this.opts.linebreaks||this.$editor.focus(),this.buffer.set(),this.selection.save();var i,o,n=this.selection.getParent(),a=e(n).closest("ol, ul",this.$editor[0]);this.utils.isRedactorParent(a)||0===a.length||(a=!1);var r=!1;if(a&&a.length){r=!0;var s=a[0].tagName;i="orderedlist"===t&&"UL"===s,o="unorderedlist"===t&&"OL"===s}i?this.utils.replaceToTag(a,"ol"):o?this.utils.replaceToTag(a,"ul"):r?this.list.remove(t,a):this.list.insert(t),this.selection.restore(),this.code.sync()},insert:function(t){var i=this.selection.getCurrent(),o=e(i).closest("td, th",this.$editor[0]);this.utils.browser("msie")&&this.opts.linebreaks?this.list.insertInIe(t):document.execCommand("insert"+t);var n=this.selection.getParent(),a=e(n).closest("ol, ul",this.$editor[0]);if(0!==o.length){var r=o.clone();o.after(r).remove("")}if(this.utils.isEmpty(a.find("li").text())){var s=a.children("li");s.find("br").remove(),s.append(this.selection.getMarkerAsHtml()),this.opts.linebreaks&&this.utils.browser("mozilla")&&2==s.size()&&this.utils.isEmpty(s.eq(1).text())&&s.eq(1).remove()}if(a.length){var l=a.parent();this.utils.isRedactorParent(l)&&"LI"!=l[0].tagName&&this.utils.isBlock(l[0])&&l.replaceWith(l.contents())}this.utils.browser("msie")||this.$editor.focus(),this.clean.clearUnverified()},insertInIe:function(t){var i=this.selection.wrap("div"),o=e(i).html(),n=e("orderedlist"==t?"<ol>":"<ul>"),a=e("<li>");if(""===e.trim(o))a.append(this.selection.getMarkerAsHtml()),n.append(a),this.$editor.find("#selection-marker-1").replaceWith(n);else{var r=o.split(/<br\s?\/?>/gi);if(r)for(var s=0;s<r.length;s++)""!==e.trim(r[s])&&n.append(e("<li>").html(r[s]));else a.append(o),n.append(a);e(i).replaceWith(n)}},remove:function(t,i){e.inArray("ul",this.selection.getBlocks())&&(t="unorderedlist"),document.execCommand("insert"+t);var o=e(this.selection.getCurrent());this.indent.fixEmptyIndent(),this.opts.linebreaks||0!==o.closest("li, th, td",this.$editor[0]).length||(document.execCommand("formatblock",!1,"p"),this.$editor.find("ul, ol, blockquote").each(e.proxy(this.utils.removeEmpty,this)));var n=e(this.selection.getCurrent()).closest("table",this.$editor[0]),a=n.prev();this.opts.linebreaks||0===n.length||0===a.length||"BR"!=a[0].tagName||a.remove(),this.clean.clearUnverified()}}},modal:function(){return{callbacks:{},loadTemplates:function(){this.opts.modal={imageEdit:String()+'<section id="redactor-modal-image-edit"><label>'+this.lang.get("title")+'</label><input type="text" id="redactor-image-title" /><label class="redactor-image-link-option">'+this.lang.get("link")+'</label><input type="text" id="redactor-image-link" class="redactor-image-link-option" aria-label="'+this.lang.get("link")+'" /><label class="redactor-image-link-option"><input type="checkbox" id="redactor-image-link-blank" aria-label="'+this.lang.get("link_new_tab")+'"> '+this.lang.get("link_new_tab")+'</label><label class="redactor-image-position-option">'+this.lang.get("image_position")+'</label><select class="redactor-image-position-option" id="redactor-image-align" aria-label="'+this.lang.get("image_position")+'"><option value="none">'+this.lang.get("none")+'</option><option value="left">'+this.lang.get("left")+'</option><option value="center">'+this.lang.get("center")+'</option><option value="right">'+this.lang.get("right")+"</option></select></section>",image:String()+'<section id="redactor-modal-image-insert"><div id="redactor-modal-image-droparea"></div></section>',file:String()+'<section id="redactor-modal-file-insert"><div id="redactor-modal-file-upload-box"><label>'+this.lang.get("filename")+'</label><input type="text" id="redactor-filename" aria-label="'+this.lang.get("filename")+'" /><br><br><div id="redactor-modal-file-upload"></div></div></section>',link:String()+'<section id="redactor-modal-link-insert"><label>URL</label><input type="url" id="redactor-link-url" aria-label="URL" /><label>'+this.lang.get("text")+'</label><input type="text" id="redactor-link-url-text" aria-label="'+this.lang.get("text")+'" /><label><input type="checkbox" id="redactor-link-blank"> '+this.lang.get("link_new_tab")+"</label></section>"},e.extend(this.opts,this.opts.modal)},addCallback:function(e,t){this.modal.callbacks[e]=t},createTabber:function(t){this.modal.$tabber=e("<div>").attr("id","redactor-modal-tabber"),t.prepend(this.modal.$tabber)},addTab:function(t,i,o){var n=e('<a href="#" rel="tab'+t+'">').text(i);o&&n.addClass("active");var a=this;n.on("click",function(t){t.preventDefault(),e(".redactor-tab").hide(),e(".redactor-"+e(this).attr("rel")).show(),a.modal.$tabber.find("a").removeClass("active"),e(this).addClass("active")}),this.modal.$tabber.append(n)},addTemplate:function(e,t){this.opts.modal[e]=t},getTemplate:function(e){return this.opts.modal[e]},getModal:function(){return this.$modalBody.find("section")},load:function(e,t,i){this.modal.templateName=e,this.modal.width=i,this.modal.build(),this.modal.enableEvents(),this.modal.setTitle(t),this.modal.setDraggable(),this.modal.setContent(),void 0!==this.modal.callbacks[e]&&this.modal.callbacks[e].call(this)},show:function(){this.utils.disableBodyScroll(),this.utils.isMobile()?this.modal.showOnMobile():this.modal.showOnDesktop(),this.opts.highContrast&&this.$modalBox.addClass("redactor-modal-contrast"),this.$modalOverlay.show(),this.$modalBox.show(),this.$modal.attr("tabindex","-1"),this.$modal.focus(),this.modal.setButtonsWidth(),this.utils.saveScroll(),this.utils.isMobile()||(setTimeout(e.proxy(this.modal.showOnDesktop,this),0),e(window).on("resize.redactor-modal",e.proxy(this.modal.resize,this))),this.core.setCallback("modalOpened",this.modal.templateName,this.$modal),e(document).off("focusin.modal"),this.$modal.find("input[type=text],input[type=url],input[type=email]").on("keydown.redactor-modal",e.proxy(this.modal.setEnter,this))},showOnDesktop:function(){var t=this.$modal.outerHeight(),i=e(window).height(),o=e(window).width();this.modal.width>o?this.$modal.css({width:"96%",marginTop:i/2-t/2+"px"}):t>i?this.$modal.css({width:this.modal.width+"px",marginTop:"20px"}):this.$modal.css({width:this.modal.width+"px",marginTop:i/2-t/2+"px"})},showOnMobile:function(){this.$modal.css({width:"96%",marginTop:"2%"})},resize:function(){this.utils.isMobile()?this.modal.showOnMobile():this.modal.showOnDesktop()},setTitle:function(e){this.$modalHeader.html(e)},setContent:function(){this.$modalBody.html(this.modal.getTemplate(this.modal.templateName))},setDraggable:function(){void 0!==e.fn.draggable&&(this.$modal.draggable({handle:this.$modalHeader}),this.$modalHeader.css("cursor","move"))},setEnter:function(e){13==e.which&&(e.preventDefault(),this.$modal.find("button.redactor-modal-action-btn").click())},createCancelButton:function(){var t=e("<button>").addClass("redactor-modal-btn redactor-modal-close-btn").html(this.lang.get("cancel"));t.on("click",e.proxy(this.modal.close,this)),this.$modalFooter.append(t)},createDeleteButton:function(e){return this.modal.createButton(e,"delete")},createActionButton:function(e){return this.modal.createButton(e,"action")},createButton:function(t,i){var o=e("<button>").addClass("redactor-modal-btn").addClass("redactor-modal-"+i+"-btn").html(t);return this.$modalFooter.append(o),o},setButtonsWidth:function(){var e=this.$modalFooter.find("button"),t=e.length;0!==t&&e.css("width",100/t+"%")},build:function(){this.modal.buildOverlay(),this.$modalBox=e('<div id="redactor-modal-box"/>').hide(),this.$modal=e('<div id="redactor-modal" role="dialog" aria-labelledby="redactor-modal-header" />'),this.$modalHeader=e('<header id="redactor-modal-header"/>'),this.$modalClose=e('<button type="button" id="redactor-modal-close" tabindex="1" aria-label="Close" />').html("&times;"),this.$modalBody=e('<div id="redactor-modal-body" />'),this.$modalFooter=e("<footer />"),this.$modal.append(this.$modalHeader),this.$modal.append(this.$modalClose),this.$modal.append(this.$modalBody),this.$modal.append(this.$modalFooter),this.$modalBox.append(this.$modal),this.$modalBox.appendTo(document.body)},buildOverlay:function(){this.$modalOverlay=e('<div id="redactor-modal-overlay">').hide(),e("body").prepend(this.$modalOverlay)},enableEvents:function(){this.$modalClose.on("click.redactor-modal",e.proxy(this.modal.close,this)),e(document).on("keyup.redactor-modal",e.proxy(this.modal.closeHandler,this)),this.$editor.on("keyup.redactor-modal",e.proxy(this.modal.closeHandler,this)),this.$modalBox.on("click.redactor-modal",e.proxy(this.modal.close,this))},disableEvents:function(){this.$modalClose.off("click.redactor-modal"),e(document).off("keyup.redactor-modal"),this.$editor.off("keyup.redactor-modal"),this.$modalBox.off("click.redactor-modal"),e(window).off("resize.redactor-modal")},closeHandler:function(e){e.which==this.keyCode.ESC&&this.modal.close(!1)},close:function(t){if(t){if(!e(t.target).hasClass("redactor-modal-close-btn")&&t.target!=this.$modalClose[0]&&t.target!=this.$modalBox[0])return;t.preventDefault()}this.$modalBox&&(this.modal.disableEvents(),this.utils.enableBodyScroll(),this.$modalOverlay.remove(),this.$modalBox.fadeOut("fast",e.proxy(function(){this.$modalBox.remove(),setTimeout(e.proxy(this.utils.restoreScroll,this),0),void 0!==t&&this.selection.restore(),e(document.body).css("overflow",this.modal.bodyOveflow),this.core.setCallback("modalClosed",this.modal.templateName)},this)))}}},observe:function(){return{load:function(){if(void 0===this.opts.destroyed){if(this.utils.browser("msie")){var t=this;this.$editor.find("pre, code").on("mouseover",function(){t.$editor.attr("contenteditable",!1),e(this).attr("contenteditable",!0)}).on("mouseout",function(){t.$editor.attr("contenteditable",!0),e(this).removeAttr("contenteditable")})}this.observe.images(),this.observe.links()}},toolbar:function(e,t){this.observe.buttons(e,t),this.observe.dropdowns()},isCurrent:function(t,i){if(void 0===i)i=e(this.selection.getCurrent());return i.is(t)||i.parents(t).length>0},dropdowns:function(){var t=e(this.selection.getCurrent());e.each(this.opts.observe.dropdowns,e.proxy(function(e,i){var o=i.observe,n=o.element,a=i.item,r=void 0!==o.in&&o.in,s=void 0!==o.out&&o.out;t.closest(n).size()>0?this.observe.setDropdownProperties(a,r,s):this.observe.setDropdownProperties(a,s,r)},this))},setDropdownProperties:function(e,t,i){i&&void 0!==i.attr&&this.observe.setDropdownAttr(e,i.attr,!0),void 0!==t.attr&&this.observe.setDropdownAttr(e,t.attr),void 0!==t.title&&e.text(t.title)},setDropdownAttr:function(t,i,o){e.each(i,function(e,i){"class"==e?o?t.removeClass(i):t.addClass(i):o?t.removeAttr(e):t.attr(e,i)})},addDropdown:function(e,t,i){void 0!==i.observe&&(i.item=e,this.opts.observe.dropdowns.push(i))},buttons:function(t,i){var o=this.selection.getCurrent(),n=this.selection.getParent();if(!1!==t?this.button.setInactiveAll():this.button.setInactiveAll(i),!1!==t||"html"===i){e.each(this.opts.activeButtonsStates,e.proxy(function(t,i){var a=e(n).closest(t,this.$editor[0]),r=e(o).closest(t,this.$editor[0]);(0===a.length||this.utils.isRedactorParent(a))&&this.utils.isRedactorParent(r)&&(0===a.length&&0===r.closest(t,this.$editor[0]).length||this.button.setActive(i))},this));var a=e(n).closest(this.opts.alignmentTags.toString().toLowerCase(),this.$editor[0]);if(this.utils.isRedactorParent(n)&&a.length){var r=""===a.css("text-align")?"left":a.css("text-align");this.button.setActive("align"+r)}}else-1!=e.inArray(i,this.opts.activeButtons)&&this.button.toggleActive(i)},addButton:function(e,t){this.opts.activeButtons.push(t),this.opts.activeButtonsStates[e]=t},images:function(){this.$editor.find("img").each(e.proxy(function(t,i){var o=e(i);o.closest("a",this.$editor[0]).on("click",function(e){e.preventDefault()}),this.utils.browser("msie")&&o.attr("unselectable","on"),this.image.setEditable(o)},this)),e(document).on("click.redactor-image-delete."+this.uuid,e.proxy(function(e){this.observe.image=!1,"IMG"==e.target.tagName&&this.utils.isRedactorParent(e.target)&&(this.observe.image=(!this.observe.image||this.observe.image!=e.target)&&e.target)},this))},links:function(){this.opts.linkTooltip&&(this.$editor.find("a").on("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid,e.proxy(this.observe.showTooltip,this)),this.$editor.on("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid,e.proxy(this.observe.closeTooltip,this)),e(document).on("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid,e.proxy(this.observe.closeTooltip,this)))},getTooltipPosition:function(e){return e.offset()},showTooltip:function(t){var i=e(t.target);if("IMG"!=i[0].tagName&&("A"!==i[0].tagName&&(i=i.closest("a",this.$editor[0])),"A"===i[0].tagName)){var o=i,n=this.observe.getTooltipPosition(o),a=e('<span class="redactor-link-tooltip"></span>'),r=o.attr("href");void 0===r&&(r=""),r.length>24&&(r=r.substring(0,24)+"...");var s=e('<a href="'+o.attr("href")+'" target="_blank" />').html(r).addClass("redactor-link-tooltip-action"),l=e('<a href="#" />').html(this.lang.get("edit")).on("click",e.proxy(this.link.show,this)).addClass("redactor-link-tooltip-action"),d=e('<a href="#" />').html(this.lang.get("unlink")).on("click",e.proxy(this.link.unlink,this)).addClass("redactor-link-tooltip-action");a.append(s).append(" | ").append(l).append(" | ").append(d),a.css({top:n.top+parseInt(o.css("line-height"),10)+"px",left:n.left+"px"}),e(".redactor-link-tooltip").remove(),e("body").append(a)}},closeTooltip:function(t){var i=(t=t.originalEvent||t).target,o=e(i).closest("a",this.$editor[0]);0!==o.length&&"A"===o[0].tagName&&"A"!==i.tagName||"A"===i.tagName&&this.utils.isRedactorParent(i)||e(i).hasClass("redactor-link-tooltip-action")||e(".redactor-link-tooltip").remove()}}},paragraphize:function(){return{load:function(t){return this.opts.linebreaks?t:""===t||"<p></p>"===t?this.opts.emptyHtml:(t+="\n",this.paragraphize.safes=[],this.paragraphize.z=0,t=t.replace(/(<br\s?\/?>){1,}\n?<\/blockquote>/gi,"</blockquote>"),t=this.paragraphize.getSafes(t),t=this.paragraphize.getSafesComments(t),t=this.paragraphize.replaceBreaksToNewLines(t),t=this.paragraphize.replaceBreaksToParagraphs(t),t=this.paragraphize.clear(t),t=(t=this.paragraphize.restoreSafes(t)).replace(new RegExp("<br\\s?/?>\n?<("+this.opts.paragraphizeBlocks.join("|")+")(.*?[^>])>","gi"),"<p><br /></p>\n<$1$2>"),e.trim(t))},getSafes:function(t){var i=e("<div />").append(t);return i.find("blockquote p").replaceWith(function(){return e(this).append("<br />").contents()}),t=i.html(),i.find(this.opts.paragraphizeBlocks.join(", ")).each(e.proxy(function(e,i){this.paragraphize.z++,this.paragraphize.safes[this.paragraphize.z]=i.outerHTML,t=t.replace(i.outerHTML,"\n{replace"+this.paragraphize.z+"}")},this)),t},getSafesComments:function(t){var i=t.match(/<!--([\w\W]*?)-->/gi);return i?(e.each(i,e.proxy(function(e,i){this.paragraphize.z++,this.paragraphize.safes[this.paragraphize.z]=i,t=t.replace(i,"\n{replace"+this.paragraphize.z+"}")},this)),t):t},restoreSafes:function(t){return e.each(this.paragraphize.safes,function(e,i){i=void 0!==i?i.replace(/\$/g,"&#36;"):i,t=t.replace("{replace"+e+"}",i)}),t},replaceBreaksToParagraphs:function(e){var t=e.split(new RegExp("\n","g"),-1);if(e="",t)for(var i=t.length,o=0;o<i;o++){if(!t.hasOwnProperty(o))return;-1==t[o].search("{replace")?(t[o]=t[o].replace(/<p>\n\t?<\/p>/gi,""),t[o]=t[o].replace(/<p><\/p>/gi,""),""!==t[o]&&(e+="<p>"+t[o].replace(/^\n+|\n+$/g,"")+"</p>")):e+=t[o]}return e},replaceBreaksToNewLines:function(e){return e=(e=(e=(e=(e=e.replace(/<br \/>\s*<br \/>/gi,"\n\n")).replace(/<br\s?\/?>\n?<br\s?\/?>/gi,"\n<br /><br />")).replace(new RegExp("\r\n","g"),"\n")).replace(new RegExp("\r","g"),"\n")).replace(new RegExp("/\n\n+/"),"g","\n\n")},clear:function(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(new RegExp("</blockquote></p>","gi"),"</blockquote>")).replace(new RegExp("<p></blockquote>","gi"),"</blockquote>")).replace(new RegExp("<p><blockquote>","gi"),"<blockquote>")).replace(new RegExp("<blockquote></p>","gi"),"<blockquote>")).replace(new RegExp("<p><p ","gi"),"<p ")).replace(new RegExp("<p><p>","gi"),"<p>")).replace(new RegExp("</p></p>","gi"),"</p>")).replace(new RegExp("<p>\\s?</p>","gi"),"")).replace(new RegExp("\n</p>","gi"),"</p>")).replace(new RegExp("<p>\t?\t?\n?<p>","gi"),"<p>")).replace(new RegExp("<p>\t*</p>","gi"),"")}}},paste:function(){return{init:function(t){this.opts.cleanOnPaste?(this.rtePaste=!0,this.buffer.set(),this.selection.save(),this.utils.saveScroll(),this.paste.createPasteBox(),e(window).on("scroll.redactor-freeze",e.proxy(function(){e(window).scrollTop(this.saveBodyScroll)},this)),setTimeout(e.proxy(function(){var t=this.$pasteBox.html();this.$pasteBox.remove(),this.selection.restore(),this.utils.restoreScroll(),this.paste.insert(t),e(window).off("scroll.redactor-freeze"),this.linkify.isEnabled()&&this.linkify.format()},this),1)):setTimeout(e.proxy(this.code.sync,this),1)},createPasteBox:function(){if(this.$pasteBox=e("<div>").html("").attr("contenteditable","true").css({position:"fixed",width:0,top:0,left:"-9999px"}),this.utils.browser("msie"))this.$box.append(this.$pasteBox);else{var t=e(".modal-body:visible");t.length>0?t.append(this.$pasteBox):e("body").append(this.$pasteBox)}this.$pasteBox.get(0).focus()},insert:function(t){t=this.core.setCallback("pasteBefore",t),t=this.utils.isSelectAll()?this.clean.onPaste(t,!1):this.clean.onPaste(t),t=this.core.setCallback("paste",t),this.utils.isSelectAll()?this.insert.set(t,!1):this.insert.html(t,!1),this.utils.disableSelectAll(),this.rtePaste=!1,setTimeout(e.proxy(this.clean.clearUnverified,this),10),setTimeout(e.proxy(function(){var t=this.$editor.find("span");e.each(t,function(t,i){""===i.innerHTML.replace(/\u200B/,"")&&0===i.attributes.length&&e(i).remove()})},this),10)}}},placeholder:function(){return{enable:function(){this.placeholder.is()&&(this.$editor.attr("placeholder",this.$element.attr("placeholder")),this.placeholder.toggle(),this.$editor.on("keydown.redactor-placeholder",e.proxy(this.placeholder.toggle,this)))},toggle:function(){setTimeout(e.proxy(function(){var e=this.utils.isEmpty(this.$editor.html(),!1)?"addClass":"removeClass";this.$editor[e]("redactor-placeholder")},this),5)},remove:function(){this.$editor.removeClass("redactor-placeholder")},is:function(){return this.opts.placeholder?this.$element.attr("placeholder",this.opts.placeholder):!(void 0===this.$element.attr("placeholder")||""===this.$element.attr("placeholder"))}}},progress:function(){return{show:function(){e(document.body).append(e('<div id="redactor-progress"><span></span></div>')),e("#redactor-progress").fadeIn()},hide:function(){e("#redactor-progress").fadeOut(1500,function(){e(this).remove()})}}},selection:function(){return{get:function(){this.sel=document.getSelection(),document.getSelection&&this.sel.getRangeAt&&this.sel.rangeCount?this.range=this.sel.getRangeAt(0):this.range=document.createRange()},addRange:function(){try{this.sel.removeAllRanges()}catch(e){}this.sel.addRange(this.range)},getCurrent:function(){var e=!1;return this.selection.get(),this.sel&&this.sel.rangeCount>0&&(e=this.sel.getRangeAt(0).startContainer),this.utils.isRedactorParent(e)},getParent:function(t){return!!(t=t||this.selection.getCurrent())&&this.utils.isRedactorParent(e(t).parent()[0])},getPrev:function(){return window.getSelection().anchorNode.previousSibling},getNext:function(){return window.getSelection().anchorNode.nextSibling},getBlock:function(t){for(t=t||this.selection.getCurrent();t;){if(this.utils.isBlockTag(t.tagName))return!e(t).hasClass("redactor-editor")&&t;t=t.parentNode}return!1},getInlines:function(t,i){if(this.selection.get(),this.range&&this.range.collapsed)return!1;var o=[];t=void 0===t||!1===t?this.selection.getNodes():t;var n=this.opts.inlineTags;if(n.push("span"),void 0!==i)for(var a=0;a<i.length;a++)n.push(i[a]);return e.each(t,e.proxy(function(t,i){-1!=e.inArray(i.tagName.toLowerCase(),n)&&o.push(i)},this)),0!==o.length&&o},getInlinesTags:function(t){if(this.selection.get(),this.range&&this.range.collapsed)return!1;var i=[],o=this.selection.getNodes();return e.each(o,e.proxy(function(o,n){-1!=e.inArray(n.tagName.toLowerCase(),t)&&i.push(n)},this)),0!==i.length&&i},getBlocks:function(t){if(this.selection.get(),this.range&&this.range.collapsed)return[this.selection.getBlock()];var i=[];return t=void 0===t?this.selection.getNodes():t,e.each(t,e.proxy(function(e,t){this.utils.isBlock(t)&&i.push(t)},this)),0===i.length?[this.selection.getBlock()]:i},getLastBlock:function(){return this.selection.lastBlock},getNodes:function(){this.selection.get();var t=this.selection.getNodesMarker(1),i=this.selection.getNodesMarker(2);if(!1===this.range.collapsed){if(window.getSelection){var o=window.getSelection();if(o.rangeCount>0){var n=o.getRangeAt(0),a=n.startContainer,r=n.startOffset,s=n.cloneRange();s.collapse(!1),s.insertNode(i),s.setStart(a,r),s.collapse(!0),s.insertNode(t),n.setStartAfter(t),n.setEndBefore(i),o.removeAllRanges(),o.addRange(n)}}}else this.selection.setNodesMarker(this.range,t,!0),i=t;var l=[],d=0,c=this;this.$editor.find("*").each(function(){if(this==t){var o=e(this).parent();0!==o.length&&"BODY"!=o[0].tagName&&c.utils.isRedactorParent(o[0])&&l.push(o[0]),l.push(this),d=1}else d>0&&(l.push(this),d+=1);if(this==i)return!1});for(var u=[],h=l.length,p=0;p<h;p++)"nodes-marker-1"!=l[p].id&&"nodes-marker-2"!=l[p].id&&u.push(l[p]);return this.selection.removeNodesMarkers(),u},getNodesMarker:function(t){return e('<span id="nodes-marker-'+t+'" class="redactor-nodes-marker" data-verified="redactor">'+this.opts.invisibleSpace+"</span>")[0]},setNodesMarker:function(e,t,i){e=e.cloneRange();try{e.collapse(i),e.insertNode(t)}catch(e){}},removeNodesMarkers:function(){e(document).find("span.redactor-nodes-marker").remove(),this.$editor.find("span.redactor-nodes-marker").remove()},fromPoint:function(e,t){this.caret.setOffset(e,t)},wrap:function(e){if(this.selection.get(),this.range.collapsed)return!1;var t=document.createElement(e);return t.appendChild(this.range.extractContents()),this.range.insertNode(t),t},selectElement:function(e){this.utils.browser("mozilla")?(e=e[0]||e,document.createRange().selectNodeContents(e)):this.caret.set(e,0,e,1)},selectAll:function(){this.selection.get(),this.range.selectNodeContents(this.$editor[0]),this.selection.addRange()},remove:function(){this.selection.get(),this.sel.removeAllRanges()},save:function(){this.selection.createMarkers()},createMarkers:function(){this.selection.get();var e=this.selection.getMarker(1);if(this.selection.setMarker(this.range,e,!0),!1===this.range.collapsed){var t=this.selection.getMarker(2);this.selection.setMarker(this.range,t,!1),this.utils.browser("chrome")&&this.caret.set(e,0,t,0)}this.savedSel=this.$editor.html()},getMarker:function(t){return void 0===t&&(t=1),e('<span id="selection-marker-'+t+'" class="redactor-selection-marker"  data-verified="redactor">'+this.opts.invisibleSpace+"</span>")[0]},getMarkerAsHtml:function(e){return this.utils.getOuterHtml(this.selection.getMarker(e))},setMarker:function(e,t,i){e=e.cloneRange();try{e.collapse(i),e.insertNode(t)}catch(e){this.focus.setStart()}},restore:function(){var e=this.$editor.find("span#selection-marker-1"),t=this.$editor.find("span#selection-marker-2");this.utils.browser("mozilla")&&this.$editor.focus(),0!==e.length&&0!==t.length?this.caret.set(e,0,t,0):0!==e.length?this.caret.set(e,0,e,0):this.$editor.focus(),this.selection.removeMarkers(),this.savedSel=!1},removeMarkers:function(){this.$editor.find("span.redactor-selection-marker").each(function(t,i){""===e(i).text().replace(/\u200B/g,"")?e(i).remove():e(i).replaceWith(function(){return e(this).contents()})})},getText:function(){return this.selection.get(),this.sel.toString()},getHtml:function(){var e="";if(this.selection.get(),this.sel.rangeCount){for(var t=document.createElement("div"),i=this.sel.rangeCount,o=0;o<i;++o)t.appendChild(this.sel.getRangeAt(o).cloneContents());e=t.innerHTML}return this.clean.onSync(e)},replaceSelection:function(e){this.selection.get(),this.range.deleteContents();var t=document.createElement("div");t.innerHTML=e;for(var i,o=document.createDocumentFragment();i=t.firstChild;)o.appendChild(i);this.range.insertNode(o)},replaceWithHtml:function(e){e=this.selection.getMarkerAsHtml(1)+e+this.selection.getMarkerAsHtml(2),this.selection.get(),window.getSelection&&window.getSelection().getRangeAt?this.selection.replaceSelection(e):document.selection&&document.selection.createRange&&this.range.pasteHTML(e),this.selection.restore(),this.code.sync()}}},shortcuts:function(){return{init:function(t,i){if(!this.opts.shortcuts)return!t.ctrlKey&&!t.metaKey||66!==i&&73!==i||t.preventDefault(),!1;e.each(this.opts.shortcuts,e.proxy(function(i,o){for(var n=i.split(","),a=n.length,r=0;r<a;r++)"string"==typeof n[r]&&this.shortcuts.handler(t,e.trim(n[r]),e.proxy(function(){var e;"-1"!=o.func.search(/\./)?void 0!==this[(e=o.func.split("."))[0]]&&this[e[0]][e[1]].apply(this,o.params):this[o.func].apply(this,o.params)},this))},this))},handler:function(t,i,o){var n={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"};i=i.toLowerCase().split(" ");var a={8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[t.keyCode],r=String.fromCharCode(t.which).toLowerCase(),s="",l={};e.each(["alt","ctrl","meta","shift"],function(e,i){t[i+"Key"]&&a!==i&&(s+=i+"+")}),a&&(l[s+a]=!0),r&&(l[s+r]=!0,l[s+n[r]]=!0,"shift+"===s&&(l[n[r]]=!0));for(var d=0,c=i.length;d<c;d++)if(l[i[d]])return t.preventDefault(),o.apply(this,arguments)}}},tabifier:function(){return{get:function(e){if(!this.opts.tabifier)return e;var t=["area","body","head","hr","i?frame","link","meta","noscript","style","script","table","tbody","thead","tfoot"],i=["li","dt","dt","h[1-6]","option","script"];this.tabifier.lineBefore=new RegExp("^<(/?"+t.join("|/?")+"|"+i.join("|")+")[ >]"),this.tabifier.lineAfter=new RegExp("^<(br|/?"+t.join("|/?")+"|/"+i.join("|/")+")[ >]"),this.tabifier.newLevel=new RegExp("^</?("+["p","blockquote","div","dl","fieldset","form","frameset","map","ol","pre","select","td","th","tr","ul"].join("|")+")[ >]");var o=0,n=e.length,a=0,r=null,s=null,l="",d="",c="";for(this.tabifier.cleanlevel=0;o<n;o++){if(a=o,-1==e.substr(o).indexOf("<"))return d+=e.substr(o),this.tabifier.finish(d);for(;a<n&&"<"!=e.charAt(a);)a++;for(o!=a&&((c=e.substr(o,a-o)).match(/^\s{2,}$/g)||("\n"==d.charAt(d.length-1)?d+=this.tabifier.getTabs():"\n"==c.charAt(0)&&(d+="\n"+this.tabifier.getTabs(),c=c.replace(/^\s+/,"")),d+=c),c.match(/\n/)&&(d+="\n"+this.tabifier.getTabs())),r=a;a<n&&">"!=e.charAt(a);)a++;var u;if(o=a,"!--"==(l=e.substr(r,a-r)).substr(1,3)){if(!l.match(/--$/)){for(;"--\x3e"!=e.substr(a,3);)a++;a+=2,l=e.substr(r,a-r),o=a}"\n"!=d.charAt(d.length-1)&&(d+="\n"),d+=this.tabifier.getTabs(),d+=l+">\n"}else"!"==l[1]?d=this.tabifier.placeTag(l+">",d):"?"==l[1]?d+=l+">\n":(u=l.match(/^<(script|style|pre)/i))?(u[1]=u[1].toLowerCase(),l=this.tabifier.cleanTag(l),d=this.tabifier.placeTag(l,d),(s=String(e.substr(o+1)).toLowerCase().indexOf("</"+u[1]))&&(c=e.substr(o+1,s),o+=s,d+=c)):(l=this.tabifier.cleanTag(l),d=this.tabifier.placeTag(l,d))}return this.tabifier.finish(d)},getTabs:function(){for(var e="",t=0;t<this.tabifier.cleanlevel;t++)e+="\t";return e},finish:function(e){return e=(e=(e=(e=e.replace(/\n\s*\n/g,"\n")).replace(/^[\s\n]*/,"")).replace(/[\s\n]*$/,"")).replace(/<script(.*?)>\n<\/script>/gi,"<script$1><\/script>"),this.tabifier.cleanlevel=0,e},cleanTag:function(e){var t,i="",o="";for((e=(e=(e=e.replace(/\n/g," ")).replace(/\s{2,}/g," ")).replace(/^\s+|\s+$/g," ")).match(/\/$/)&&(o="/",e=e.replace(/\/+$/,""));t=/\s*([^= ]+)(?:=((['"']).*?\3|[^ ]+))?/.exec(e);)t[2]?i+=t[1].toLowerCase()+"="+t[2]:t[1]&&(i+=t[1].toLowerCase()),i+=" ",e=e.substr(t[0].length);return i.replace(/\s*$/,"")+o+">"},placeTag:function(e,t){var i=e.match(this.tabifier.newLevel);return(e.match(this.tabifier.lineBefore)||i)&&(t=t.replace(/\s*$/,""),t+="\n"),i&&"/"==e.charAt(1)&&this.tabifier.cleanlevel--,"\n"==t.charAt(t.length-1)&&(t+=this.tabifier.getTabs()),i&&"/"!=e.charAt(1)&&this.tabifier.cleanlevel++,t+=e,(e.match(this.tabifier.lineAfter)||e.match(this.tabifier.newLevel))&&(t=t.replace(/ *$/,"")),t}}},tidy:function(){return{setupAllowed:function(){var t=e.inArray("span",this.opts.removeEmpty);if(-1!==t&&this.opts.removeEmpty.splice(t,1),this.opts.allowedTags&&(this.opts.deniedTags=!1),this.opts.allowedAttr&&(this.opts.removeAttr=!1),!this.opts.linebreaks){var i=["p","section"];this.opts.allowedTags&&this.tidy.addToAllowed(i),this.opts.deniedTags&&this.tidy.removeFromDenied(i)}},addToAllowed:function(t){for(var i=t.length,o=0;o<i;o++)-1==e.inArray(t[o],this.opts.allowedTags)&&this.opts.allowedTags.push(t[o])},removeFromDenied:function(t){for(var i=t.length,o=0;o<i;o++){var n=e.inArray(t[o],this.opts.deniedTags);-1!=n&&this.opts.deniedTags.splice(n,1)}},load:function(t,i){return this.tidy.settings={deniedTags:this.opts.deniedTags,allowedTags:this.opts.allowedTags,removeComments:this.opts.removeComments,replaceTags:this.opts.replaceTags,replaceStyles:this.opts.replaceStyles,removeDataAttr:this.opts.removeDataAttr,removeAttr:this.opts.removeAttr,allowedAttr:this.opts.allowedAttr,removeWithoutAttr:this.opts.removeWithoutAttr,removeEmpty:this.opts.removeEmpty},e.extend(this.tidy.settings,i),t=this.tidy.removeComments(t),this.tidy.$div=e("<div />").append(t),this.tidy.replaceTags(),this.tidy.replaceStyles(),this.tidy.removeTags(),this.tidy.removeAttr(),this.tidy.removeEmpty(),this.tidy.removeParagraphsInLists(),this.tidy.removeDataAttr(),this.tidy.removeWithoutAttr(),t=this.tidy.$div.html(),this.tidy.$div.remove(),t},removeComments:function(e){return this.tidy.settings.removeComments?e.replace(/<!--[\s\S]*?-->/gi,""):e},replaceTags:function(t){if(!this.tidy.settings.replaceTags)return t;for(var i=this.tidy.settings.replaceTags.length,o=[],n=[],a=0;a<i;a++)n.push(this.tidy.settings.replaceTags[a][1]),o.push(this.tidy.settings.replaceTags[a][0]);e.each(o,e.proxy(function(t,i){this.tidy.$div.find(i).replaceWith(function(){return e("<"+n[t]+" />",{html:e(this).html()})})},this))},replaceStyles:function(){if(this.tidy.settings.replaceStyles){var t=this.tidy.settings.replaceStyles.length;this.tidy.$div.find("span").each(e.proxy(function(i,o){for(var n=e(o),a=n.attr("style"),r=0;r<t;r++)if(a&&a.match(new RegExp("^"+this.tidy.settings.replaceStyles[r][0],"i"))){var s=this.tidy.settings.replaceStyles[r][1];n.replaceWith(function(){var t=document.createElement(s);return e(t).append(e(this).contents())})}},this))}},removeTags:function(){!this.tidy.settings.deniedTags&&this.tidy.settings.allowedTags&&this.tidy.$div.find("*").not(this.tidy.settings.allowedTags.join(",")).each(function(t,i){""===i.innerHTML?e(i).remove():e(i).contents().unwrap()}),this.tidy.settings.deniedTags&&this.tidy.$div.find(this.tidy.settings.deniedTags.join(",")).each(function(t,i){e(i).hasClass("redactor-script-tag")||e(i).hasClass("redactor-selection-marker")||(""===i.innerHTML?e(i).remove():e(i).contents().unwrap())})},removeAttr:function(){var t;if(!this.tidy.settings.removeAttr&&this.tidy.settings.allowedAttr){var i=[],o=[];t=this.tidy.settings.allowedAttr.length;for(var n=0;n<t;n++)i.push(this.tidy.settings.allowedAttr[n][0]),o.push(this.tidy.settings.allowedAttr[n][1]);this.tidy.$div.find("*").each(e.proxy(function(t,n){var a=e(n),r=e.inArray(a[0].tagName.toLowerCase(),i),s=this.tidy.removeAttrGetRemoves(r,o,a);s&&e.each(s,function(e,t){a.removeAttr(t)})},this))}if(this.tidy.settings.removeAttr){t=this.tidy.settings.removeAttr.length;for(n=0;n<t;n++){var a=this.tidy.settings.removeAttr[n][1];e.isArray(a)&&(a=a.join(" ")),this.tidy.$div.find(this.tidy.settings.removeAttr[n][0]).removeAttr(a)}}},removeAttrGetRemoves:function(t,i,o){var n=[];return-1==t?e.each(o[0].attributes,function(e,t){n.push(t.name)}):"*"==i[t]?n=[]:e.each(o[0].attributes,function(o,a){e.isArray(i[t])?-1==e.inArray(a.name,i[t])&&n.push(a.name):i[t]!=a.name&&n.push(a.name)}),n},removeAttrs:function(t,i){return i=new RegExp(i,"g"),t.each(function(){for(var t=e(this),o=this.attributes.length-1;o>=0;o--){var n=this.attributes[o];n&&n.specified&&n.name.search(i)>=0&&t.removeAttr(n.name)}})},removeEmpty:function(){this.tidy.settings.removeEmpty&&this.tidy.$div.find(this.tidy.settings.removeEmpty.join(",")).each(function(){var t=e(this),i=t.text();""===(i=(i=(i=i.replace(/\u200B/g,"")).replace(/&nbsp;/gi,"")).replace(/\s/g,""))&&0===t.children().length&&t.remove()})},removeParagraphsInLists:function(){this.tidy.$div.find("li p").contents().unwrap()},removeDataAttr:function(){if(this.tidy.settings.removeDataAttr){var t=this.tidy.settings.removeDataAttr;e.isArray(this.tidy.settings.removeDataAttr)&&(t=this.tidy.settings.removeDataAttr.join(",")),this.tidy.removeAttrs(this.tidy.$div.find(t),"^(data-)")}},removeWithoutAttr:function(){this.tidy.settings.removeWithoutAttr&&this.tidy.$div.find(this.tidy.settings.removeWithoutAttr.join(",")).each(function(){0===this.attributes.length&&e(this).contents().unwrap()})}}},toolbar:function(){return{init:function(){return{html:{title:this.lang.get("html"),func:"code.toggle"},formatting:{title:this.lang.get("formatting"),dropdown:{p:{title:this.lang.get("paragraph"),func:"block.format"},blockquote:{title:this.lang.get("quote"),func:"block.format"},pre:{title:this.lang.get("code"),func:"block.format"},h1:{title:this.lang.get("header1"),func:"block.format"},h2:{title:this.lang.get("header2"),func:"block.format"},h3:{title:this.lang.get("header3"),func:"block.format"},h4:{title:this.lang.get("header4"),func:"block.format"},h5:{title:this.lang.get("header5"),func:"block.format"}}},bold:{title:this.lang.get("bold"),func:"inline.format"},italic:{title:this.lang.get("italic"),func:"inline.format"},deleted:{title:this.lang.get("deleted"),func:"inline.format"},underline:{title:this.lang.get("underline"),func:"inline.format"},unorderedlist:{title:"&bull; "+this.lang.get("unorderedlist"),func:"list.toggle"},orderedlist:{title:"1. "+this.lang.get("orderedlist"),func:"list.toggle"},outdent:{title:"< "+this.lang.get("outdent"),func:"indent.decrease"},indent:{title:"> "+this.lang.get("indent"),func:"indent.increase"},image:{title:this.lang.get("image"),func:"image.show"},file:{title:this.lang.get("file"),func:"file.show"},link:{title:this.lang.get("link"),dropdown:{link:{title:this.lang.get("link_insert"),func:"link.show",observe:{element:"a",in:{title:this.lang.get("link_edit")},out:{title:this.lang.get("link_insert")}}},unlink:{title:this.lang.get("unlink"),func:"link.unlink",observe:{element:"a",out:{attr:{class:"redactor-dropdown-link-inactive","aria-disabled":!0}}}}}},alignment:{title:this.lang.get("alignment"),dropdown:{left:{title:this.lang.get("align_left"),func:"alignment.left"},center:{title:this.lang.get("align_center"),func:"alignment.center"},right:{title:this.lang.get("align_right"),func:"alignment.right"},justify:{title:this.lang.get("align_justify"),func:"alignment.justify"}}},horizontalrule:{title:this.lang.get("horizontalrule"),func:"line.insert"}}},build:function(){this.toolbar.hideButtons(),this.toolbar.hideButtonsOnMobile(),this.toolbar.isButtonSourceNeeded(),0!==this.opts.buttons.length&&(this.$toolbar=this.toolbar.createContainer(),this.toolbar.setOverflow(),this.toolbar.append(),this.toolbar.setFormattingTags(),this.toolbar.loadButtons(),this.toolbar.setFixed(),this.opts.activeButtons&&this.$editor.on("mouseup.redactor keyup.redactor focus.redactor",e.proxy(this.observe.toolbar,this)))},createContainer:function(){return e("<ul>").addClass("redactor-toolbar").attr({id:"redactor-toolbar-"+this.uuid,role:"toolbar"})},setFormattingTags:function(){e.each(this.opts.toolbar.formatting.dropdown,e.proxy(function(t,i){-1==e.inArray(t,this.opts.formatting)&&delete this.opts.toolbar.formatting.dropdown[t]},this))},loadButtons:function(){e.each(this.opts.buttons,e.proxy(function(t,i){if(this.opts.toolbar[i]){if("file"===i){if(!1===this.opts.fileUpload)return;if(!this.opts.fileUpload&&!1===this.opts.s3)return}if("image"===i){if(!1===this.opts.imageUpload)return;if(!this.opts.imageUpload&&!1===this.opts.s3)return}var o=this.opts.toolbar[i];this.$toolbar.append(e("<li>").append(this.button.build(i,o)))}},this))},append:function(){this.opts.toolbarExternal?(this.$toolbar.addClass("redactor-toolbar-external"),e(this.opts.toolbarExternal).html(this.$toolbar)):this.$box.prepend(this.$toolbar)},setFixed:function(){this.utils.isDesktop()&&(this.opts.toolbarExternal||this.opts.toolbarFixed&&(this.toolbar.observeScroll(),e(this.opts.toolbarFixedTarget).on("scroll.redactor."+this.uuid,e.proxy(this.toolbar.observeScroll,this))))},setOverflow:function(){this.utils.isMobile()&&this.opts.toolbarOverflow&&this.$toolbar.addClass("redactor-toolbar-overflow")},isButtonSourceNeeded:function(){if(!this.opts.source){var e=this.opts.buttons.indexOf("html");-1!==e&&this.opts.buttons.splice(e,1)}},hideButtons:function(){0!==this.opts.buttonsHide.length&&e.each(this.opts.buttonsHide,e.proxy(function(e,t){var i=this.opts.buttons.indexOf(t);this.opts.buttons.splice(i,1)},this))},hideButtonsOnMobile:function(){this.utils.isMobile()&&0!==this.opts.buttonsHideOnMobile.length&&e.each(this.opts.buttonsHideOnMobile,e.proxy(function(e,t){var i=this.opts.buttons.indexOf(t);this.opts.buttons.splice(i,1)},this))},observeScroll:function(){var t=e(this.opts.toolbarFixedTarget).scrollTop(),i=1;this.opts.toolbarFixedTarget===document&&(i=this.$box.offset().top),t+this.opts.toolbarFixedTopOffset>i?this.toolbar.observeScrollEnable(t,i):this.toolbar.observeScrollDisable()},observeScrollEnable:function(t,i){var o=this.opts.toolbarFixedTopOffset+t-i,n=i+this.$box.height()-32,a=this.$box.innerWidth();this.$toolbar.addClass("toolbar-fixed-box"),this.$toolbar.css({position:"absolute",width:a,top:o+"px",left:0}),t>n&&e(".redactor-dropdown-"+this.uuid+":visible").hide(),this.toolbar.setDropdownsFixed(),this.$toolbar.css("visibility",t<n?"visible":"hidden")},observeScrollDisable:function(){this.$toolbar.css({position:"relative",width:"auto",top:0,left:0,visibility:"visible"}),this.toolbar.unsetDropdownsFixed(),this.$toolbar.removeClass("toolbar-fixed-box")},setDropdownsFixed:function(){var t=this.$toolbar.innerHeight()+this.opts.toolbarFixedTopOffset,i="fixed";this.opts.toolbarFixedTarget!==document&&(t=this.$toolbar.innerHeight()+this.$toolbar.offset().top+this.opts.toolbarFixedTopOffset,i="absolute"),e(".redactor-dropdown-"+this.uuid).each(function(){e(this).css({position:i,top:t+"px"})})},unsetDropdownsFixed:function(){var t=this.$toolbar.innerHeight()+this.$toolbar.offset().top;e(".redactor-dropdown-"+this.uuid).each(function(){e(this).css({position:"absolute",top:t+"px"})})}}},upload:function(){return{init:function(t,i,o){this.upload.direct=!1,this.upload.callback=o,this.upload.url=i,this.upload.$el=e(t),this.upload.$droparea=e('<div id="redactor-droparea" />'),this.upload.$placeholdler=e('<div id="redactor-droparea-placeholder" />').text(this.lang.get("upload_label")),this.upload.$input=e('<input type="file" name="file" />'),this.upload.$placeholdler.append(this.upload.$input),this.upload.$droparea.append(this.upload.$placeholdler),this.upload.$el.append(this.upload.$droparea),this.upload.$droparea.off("redactor.upload"),this.upload.$input.off("redactor.upload"),this.upload.$droparea.on("dragover.redactor.upload",e.proxy(this.upload.onDrag,this)),this.upload.$droparea.on("dragleave.redactor.upload",e.proxy(this.upload.onDragLeave,this)),this.upload.$input.on("change.redactor.upload",e.proxy(function(e){e=e.originalEvent||e,this.upload.traverseFile(this.upload.$input[0].files[0],e)},this)),this.upload.$droparea.on("drop.redactor.upload",e.proxy(function(e){e.preventDefault(),this.upload.$droparea.removeClass("drag-hover").addClass("drag-drop"),this.upload.onDrop(e)},this))},directUpload:function(e,t){this.upload.direct=!0,this.upload.traverseFile(e,t)},onDrop:function(e){var t=(e=e.originalEvent||e).dataTransfer.files;this.upload.traverseFile(t[0],e)},traverseFile:function(e,t){if(this.opts.s3)return this.upload.setConfig(e),void this.upload.s3uploadFile(e);var i=window.FormData?new FormData:null;if(window.FormData){this.upload.setConfig(e);var o="image"==this.upload.type?this.opts.imageUploadParam:this.opts.fileUploadParam;i.append(o,e)}this.progress.show(),this.core.setCallback("uploadStart",t,i),this.upload.sendData(i,t)},setConfig:function(e){this.upload.getType(e),this.upload.direct&&(this.upload.url="image"==this.upload.type?this.opts.imageUpload:this.opts.fileUpload,this.upload.callback="image"==this.upload.type?this.image.insert:this.file.insert)},getType:function(e){this.upload.type="image",-1==this.opts.imageTypes.indexOf(e.type)&&(this.upload.type="file")},getHiddenFields:function(t,i){return!1===t||"object"!=typeof t?i:(e.each(t,e.proxy(function(t,o){null!==o&&0===o.toString().indexOf("#")&&(o=e(o).val()),i.append(t,o)},this)),i)},sendData:function(t,i){"image"==this.upload.type?(t=this.upload.getHiddenFields(this.opts.uploadImageFields,t),t=this.upload.getHiddenFields(this.upload.imageFields,t)):(t=this.upload.getHiddenFields(this.opts.uploadFileFields,t),t=this.upload.getHiddenFields(this.upload.fileFields,t));var o=new XMLHttpRequest;o.open("POST",this.upload.url),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.onreadystatechange=e.proxy(function(){if(4==o.readyState){var t,n=o.responseText;n=(n=n.replace(/^\[/,"")).replace(/\]$/,"");try{t="string"==typeof n?e.parseJSON(n):n}catch(e){t={error:!0}}this.progress.hide(),this.upload.direct||this.upload.$droparea.removeClass("drag-drop"),this.upload.callback(t,this.upload.direct,i)}},this),o.send(t)},onDrag:function(e){e.preventDefault(),this.upload.$droparea.addClass("drag-hover")},onDragLeave:function(e){e.preventDefault(),this.upload.$droparea.removeClass("drag-hover")},clearImageFields:function(){this.upload.imageFields={}},addImageFields:function(e,t){this.upload.imageFields[e]=t},removeImageFields:function(e){delete this.upload.imageFields[e]},clearFileFields:function(){this.upload.fileFields={}},addFileFields:function(e,t){this.upload.fileFields[e]=t},removeFileFields:function(e){delete this.upload.fileFields[e]},s3uploadFile:function(t){this.upload.s3executeOnSignedUrl(t,e.proxy(function(e){this.upload.s3uploadToS3(t,e)},this))},s3executeOnSignedUrl:function(e,t){var i=new XMLHttpRequest,o="-1"!==this.opts.s3.search(/\?/)?"?":"&";i.open("GET",this.opts.s3+o+"name="+e.name+"&type="+e.type,!0),i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined");var n=this;i.onreadystatechange=function(e){4==this.readyState&&200==this.status?(n.progress.show(),t(decodeURIComponent(this.responseText))):4==this.readyState&&this.status},i.send()},s3createCORSRequest:function(e,t){var i=new XMLHttpRequest;return"withCredentials"in i?i.open(e,t,!0):"undefined"!=typeof XDomainRequest?(i=new XDomainRequest).open(e,t):i=null,i},s3uploadToS3:function(t,i){var o=this.upload.s3createCORSRequest("PUT",i);o&&(o.onload=e.proxy(function(){if(200==o.status){this.progress.hide();var e=i.split("?");if(!e[0])return!1;this.upload.direct||this.upload.$droparea.removeClass("drag-drop");var t={filelink:e[0]};if("file"==this.upload.type){var n=e[0].split("/");t.filename=n[n.length-1]}this.upload.callback(t,this.upload.direct,!1)}},this),o.onerror=function(){},o.upload.onprogress=function(e){},o.setRequestHeader("Content-Type",t.type),o.setRequestHeader("x-amz-acl","public-read"),o.send(t))}}},utils:function(){return{isMobile:function(){return/(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent)},isDesktop:function(){return!/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent)},isString:function(e){return"[object String]"==Object.prototype.toString.call(e)},isEmpty:function(t,i){return t=(t=(t=(t=(t=(t=(t=t.replace(/[\u200B-\u200D\uFEFF]/g,"")).replace(/&nbsp;/gi,"")).replace(/<\/?br\s?\/?>/g,"")).replace(/\s/g,"")).replace(/^<p>[^\W\w\D\d]*?<\/p>$/i,"")).replace(/<iframe(.*?[^>])>$/i,"iframe")).replace(/<source(.*?[^>])>$/i,"source"),!1!==i&&(t=(t=t.replace(/<[^\/>][^>]*><\/[^>]+>/gi,"")).replace(/<[^\/>][^>]*><\/[^>]+>/gi,"")),""===(t=e.trim(t))},normalize:function(e){return void 0===e?0:parseInt(e.replace("px",""),10)},hexToRgb:function(e){if(void 0!==e){if(-1==e.search(/^#/))return e;e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,i,o){return t+t+i+i+o+o});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return"rgb("+parseInt(t[1],16)+", "+parseInt(t[2],16)+", "+parseInt(t[3],16)+")"}},getOuterHtml:function(t){return e("<div>").append(e(t).eq(0).clone()).html()},getAlignmentElement:function(t){return-1!==e.inArray(t.tagName,this.opts.alignmentTags)?e(t):e(t).closest(this.opts.alignmentTags.toString().toLowerCase(),this.$editor[0])},removeEmptyAttr:function(t,i){var o=e(t);return void 0===o.attr(i)||""===o.attr(i)&&(o.removeAttr(i),!0)},removeEmpty:function(t,i){var o=e(e.parseHTML(i));if(o.find(".redactor-invisible-space").removeAttr("style").removeAttr("class"),0===o.find("hr, br, img, iframe, source").length){var n=e.trim(o.text());this.utils.isEmpty(n,!1)&&o.remove()}},saveScroll:function(){this.saveEditorScroll=this.$editor.scrollTop(),this.saveBodyScroll=e(window).scrollTop(),this.opts.scrollTarget&&(this.saveTargetScroll=e(this.opts.scrollTarget).scrollTop())},restoreScroll:function(){void 0===this.saveScroll&&void 0===this.saveBodyScroll||(e(window).scrollTop(this.saveBodyScroll),this.$editor.scrollTop(this.saveEditorScroll),this.opts.scrollTarget&&e(this.opts.scrollTarget).scrollTop(this.saveTargetScroll))},createSpaceElement:function(){var e=document.createElement("span");return e.className="redactor-invisible-space",e.innerHTML=this.opts.invisibleSpace,e},removeInlineTags:function(t){var i=this.opts.inlineTags;i.push("span"),"PRE"==t.tagName&&i.push("a"),e(t).find(i.join(",")).not("span.redactor-selection-marker").contents().unwrap()},replaceWithContents:function(t,i){var o=this;return e(t).replaceWith(function(){return!0===i&&o.utils.removeInlineTags(this),e(this).contents()}),e(t)},replaceToTag:function(t,i,o){var n,a=this;return e(t).replaceWith(function(){n=e("<"+i+" />").append(e(this).contents());for(var t=0;t<this.attributes.length;t++)n.attr(this.attributes[t].name,this.attributes[t].value);return!0===o&&a.utils.removeInlineTags(n),n}),n},isStartOfElement:function(){var e=this.selection.getBlock();return!!e&&0===this.caret.getOffsetOfElement(e)},isEndOfElement:function(t){if(void 0===t&&!(t=this.selection.getBlock()))return!1;return this.caret.getOffsetOfElement(t)==e.trim(e(t).text()).replace(/\n\r\n/g,"").length},isStartOfEditor:function(){return 0===this.caret.getOffsetOfElement(this.$editor[0])},isEndOfEditor:function(){var t=this.$editor[0];return this.caret.getOffsetOfElement(t)==e.trim(e(t).html().replace(/(<([^>]+)>)/gi,"")).length},isBlock:function(e){return(e=e[0]||e)&&this.utils.isBlockTag(e.tagName)},isBlockTag:function(e){return void 0!==e&&this.reIsBlock.test(e)},isTag:function(t,i){var o=e(t).closest(i,this.$editor[0]);return 1==o.length&&o[0]},isSelectAll:function(){return this.selectAll},enableSelectAll:function(){this.selectAll=!0},disableSelectAll:function(){this.selectAll=!1},isRedactorParent:function(t){return!!t&&(0!==e(t).parents(".redactor-editor").length&&!e(t).hasClass("redactor-editor")&&t)},isCurrentOrParentHeader:function(){return this.utils.isCurrentOrParent(["H1","H2","H3","H4","H5","H6"])},isCurrentOrParent:function(t){var i=this.selection.getParent(),o=this.selection.getCurrent();if(e.isArray(t)){var n=0;return e.each(t,e.proxy(function(e,t){this.utils.isCurrentOrParentOne(o,i,t)&&n++},this)),0!==n}return this.utils.isCurrentOrParentOne(o,i,t)},isCurrentOrParentOne:function(e,t,i){return i=i.toUpperCase(),t&&t.tagName===i?t:!(!e||e.tagName!==i)&&e},isOldIe:function(){return!!(this.utils.browser("msie")&&parseInt(this.utils.browser("version"),10)<9)},isLessIe10:function(){return!!(this.utils.browser("msie")&&parseInt(this.utils.browser("version"),10)<10)},isIe11:function(){return!!navigator.userAgent.match(/Trident\/7\./)},browser:function(e){var t=navigator.userAgent.toLowerCase(),i=/(opr)[\/]([\w.]+)/.exec(t)||/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return"safari"==e?void 0!==i[3]&&"safari"==i[3]:"version"==e?i[2]:"webkit"==e?"chrome"==i[1]||"opr"==i[1]||"webkit"==i[1]:"rv"==i[1]?"msie"==e:"opr"==i[1]?"webkit"==e:e==i[1]},strpos:function(e,t,i){var o=e.indexOf(t,i);return o>=0&&o},disableBodyScroll:function(){var t=e("html"),i=window.innerWidth;if(!i){var o=document.documentElement.getBoundingClientRect();i=o.right-Math.abs(o.left)}var n=document.body.clientWidth<i,a=this.utils.measureScrollbar();t.css("overflow","hidden"),n&&t.css("padding-right",a)},measureScrollbar:function(){var t=e("body"),i=document.createElement("div");i.className="redactor-scrollbar-measure",t.append(i);var o=i.offsetWidth-i.clientWidth;return t[0].removeChild(i),o},enableBodyScroll:function(){e("html").css({overflow:"","padding-right":""}),e("body").remove("redactor-scrollbar-measure")}}}},e(window).on("load.tools.redactor",function(){e('[data-tools="redactor"]').redactor()}),i.prototype.init.prototype=i.prototype}(jQuery),function(e,t){var i=e.document,o=e.jQuery;o.fn.printElement=function(t){var n=o.extend({},o.fn.printElement.defaults,t);return"iframe"==n.printMode&&/chrome/.test(navigator.userAgent.toLowerCase())&&(n.printMode="popup"),o("[id^='printElement_']").remove(),this.each(function(){var t=o.meta?o.extend({},n,o(this).data()):n;!function(t,n){var a=function(t,n){var a=o(t),r=function(e){var t=o(e);return o(":checked",t).each(function(){this.setAttribute("checked","checked")}),o("input[type='text']",t).each(function(){this.setAttribute("value",o(this).val())}),o("select",t).each(function(){var e=o(this);o("option",e).each(function(){e.val()==o(this).val()&&this.setAttribute("selected","selected")})}),o("textarea",t).each(function(){var e=o(this).attr("value");o.browser.mozilla&&this.firstChild?this.firstChild.textContent=e:this.innerHTML=e}),o("<div></div>").append(t.clone()).html()}(t),s=new Array;if(s.push("<html><head><title>"+n.pageTitle+"</title>"),n.overrideElementCSS){if(n.overrideElementCSS.length>0)for(var l=0;l<n.overrideElementCSS.length;l++){var d=n.overrideElementCSS[l];"string"==typeof d?s.push('<link type="text/css" rel="stylesheet" href="'+d+'" >'):s.push('<link type="text/css" rel="stylesheet" href="'+d.href+'" media="'+d.media+'" >')}}else o("link",i).filter(function(){return"stylesheet"==o(this).attr("rel").toLowerCase()}).each(function(){s.push('<link type="text/css" rel="stylesheet" href="'+o(this).attr("href")+'" media="'+o(this).attr("media")+'" >')});return s.push('<base href="'+(c=e.location.port?":"+e.location.port:"",e.location.protocol+"//"+e.location.hostname+c+e.location.pathname)+'" />'),s.push('</head><body style="'+n.printBodyOptions.styleToAdd+'" class="'+n.printBodyOptions.classNameToAdd+'">'),s.push('<div class="'+a.attr("class")+'">'+r+"</div>"),s.push('<script type="text/javascript">function printPage(){focus();print();'+(n.leaveOpen||"popup"!=n.printMode.toLowerCase()?"":"close();")+"}<\/script>"),s.push("</body></html>"),s.join("");var c}(t,n),r=null,s=null;if("popup"==n.printMode.toLowerCase())r=e.open("about:blank","printElementWindow","width=650,height=440,scrollbars=yes"),s=r.document;else{var l="printElement_"+Math.round(99999*Math.random()).toString(),d=i.createElement("IFRAME");o(d).attr({style:n.iframeElementOptions.styleToAdd,id:l,className:n.iframeElementOptions.classNameToAdd,frameBorder:0,scrolling:"no",src:"about:blank"}),i.body.appendChild(d),(s=d.contentWindow||d.contentDocument).document&&(s=s.document),d=i.frames?i.frames[l]:i.getElementById(l),r=d.contentWindow||d}focus(),s.open(),s.write(a),s.close(),function e(t){t&&t.printPage?t.printPage():setTimeout(function(){e(t)},50)}(r)}(o(this),t)})},o.fn.printElement.defaults={printMode:"iframe",pageTitle:"",overrideElementCSS:null,printBodyOptions:{styleToAdd:"padding:10px;margin:10px;",classNameToAdd:""},leaveOpen:!1,iframeElementOptions:{styleToAdd:"border:none;position:absolute;width:0px;height:0px;bottom:0px;left:0px;",classNameToAdd:""}},o.fn.printElement.cssElement={href:"",media:""}}(window),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Sortable=t()}(this,function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e}).apply(this,arguments)}function o(e){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{},n=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),n.forEach(function(i){t(e,i,o[i])})}return e}function n(e,t){if(null==e)return{};var i,o,n=function(e,t){if(null==e)return{};var i,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)i=a[o],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)i=a[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var s=r(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),l=r(/Edge/i),d=r(/firefox/i),c=r(/safari/i)&&!r(/chrome/i)&&!r(/android/i),u=r(/iP(ad|od|hone)/i),h=r(/chrome/i)&&r(/android/i),p={capture:!1,passive:!1};function f(e,t,i){e.addEventListener(t,i,!s&&p)}function m(e,t,i){e.removeEventListener(t,i,!s&&p)}function g(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function v(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function b(e,t,i,o){if(e){i=i||document;do{if(null!=t&&(">"===t[0]?e.parentNode===i&&g(e,t):g(e,t))||o&&e===i)return e;if(e===i)break}while(e=v(e))}return null}var y,w=/\s+/g;function _(e,t,i){if(e&&t)if(e.classList)e.classList[i?"add":"remove"](t);else{var o=(" "+e.className+" ").replace(w," ").replace(" "+t+" "," ");e.className=(o+(i?" "+t:"")).replace(w," ")}}function S(e,t,i){var o=e&&e.style;if(o){if(void 0===i)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),void 0===t?i:i[t];t in o||-1!==t.indexOf("webkit")||(t="-webkit-"+t),o[t]=i+("string"==typeof i?"":"px")}}function C(e,t){var i="";if("string"==typeof e)i=e;else do{var o=S(e,"transform");o&&"none"!==o&&(i=o+" "+i)}while(!t&&(e=e.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix;return n&&new n(i)}function k(e,t,i){if(e){var o=e.getElementsByTagName(t),n=0,a=o.length;if(i)for(;n<a;n++)i(o[n],n);return o}return[]}function T(){return s?document.documentElement:document.scrollingElement}function x(e,t,i,o,n){if(e.getBoundingClientRect||e===window){var a,r,l,d,c,u,h;if(e!==window&&e!==T()?(r=(a=e.getBoundingClientRect()).top,l=a.left,d=a.bottom,c=a.right,u=a.height,h=a.width):(r=0,l=0,d=window.innerHeight,c=window.innerWidth,u=window.innerHeight,h=window.innerWidth),(t||i)&&e!==window&&(n=n||e.parentNode,!s))do{if(n&&n.getBoundingClientRect&&("none"!==S(n,"transform")||i&&"static"!==S(n,"position"))){var p=n.getBoundingClientRect();r-=p.top+parseInt(S(n,"border-top-width")),l-=p.left+parseInt(S(n,"border-left-width")),d=r+a.height,c=l+a.width;break}}while(n=n.parentNode);if(o&&e!==window){var f=C(n||e),m=f&&f.a,g=f&&f.d;f&&(d=(r/=g)+(u/=g),c=(l/=m)+(h/=m))}return{top:r,left:l,bottom:d,right:c,width:h,height:u}}}function E(e,t,i){for(var o=D(e,!0),n=x(e)[t];o;){var a=x(o)[i];if(!("top"===i||"left"===i?n>=a:n<=a))return o;if(o===T())break;o=D(o,!1)}return!1}function A(e,t,i){for(var o=0,n=0,a=e.children;n<a.length;){if("none"!==a[n].style.display&&a[n]!==Be.ghost&&a[n]!==Be.dragged&&b(a[n],i.draggable,e,!1)){if(o===t)return a[n];o++}n++}return null}function L(e,t){for(var i=e.lastElementChild;i&&(i===Be.ghost||"none"===S(i,"display")||t&&!g(i,t));)i=i.previousElementSibling;return i||null}function I(e,t){var i=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Be.clone||t&&!g(e,t)||i++;return i}function M(e){var t=0,i=0,o=T();if(e)do{var n=C(e),a=n.a,r=n.d;t+=e.scrollLeft*a,i+=e.scrollTop*r}while(e!==o&&(e=e.parentNode));return[t,i]}function D(e,t){if(!e||!e.getBoundingClientRect)return T();var i=e,o=!1;do{if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var n=S(i);if(i.clientWidth<i.scrollWidth&&("auto"==n.overflowX||"scroll"==n.overflowX)||i.clientHeight<i.scrollHeight&&("auto"==n.overflowY||"scroll"==n.overflowY)){if(!i.getBoundingClientRect||i===document.body)return T();if(o||t)return i;o=!0}}}while(i=i.parentNode);return T()}function O(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function P(e,t){return function(){if(!y){var i=arguments;1===i.length?e.call(this,i[0]):e.apply(this,i),y=setTimeout(function(){y=void 0},t)}}}function R(e,t,i){e.scrollLeft+=t,e.scrollTop+=i}function N(e){var t=window.Polymer,i=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):i?i(e).clone(!0)[0]:e.cloneNode(!0)}function B(e,t){S(e,"position","absolute"),S(e,"top",t.top),S(e,"left",t.left),S(e,"width",t.width),S(e,"height",t.height)}function j(e){S(e,"position",""),S(e,"top",""),S(e,"left",""),S(e,"width",""),S(e,"height","")}var F="Sortable"+(new Date).getTime();function H(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach(function(e){if("none"!==S(e,"display")&&e!==Be.ghost){t.push({target:e,rect:x(e)});var i=o({},t[t.length-1].rect);if(e.thisAnimationDuration){var n=C(e,!0);n&&(i.top-=n.f,i.left-=n.e)}e.fromRect=i}})},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var i in e)if(e.hasOwnProperty(i))for(var o in t)if(t.hasOwnProperty(o)&&t[o]===e[i][o])return Number(i);return-1}(t,{target:e}),1)},animateAll:function(i){var o=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof i&&i());var n=!1,a=0;t.forEach(function(e){var t=0,i=e.target,r=i.fromRect,s=x(i),l=i.prevFromRect,d=i.prevToRect,c=e.rect,u=C(i,!0);u&&(s.top-=u.f,s.left-=u.e),i.toRect=s,i.thisAnimationDuration&&O(l,s)&&!O(r,s)&&(c.top-s.top)/(c.left-s.left)==(r.top-s.top)/(r.left-s.left)&&(t=function(e,t,i,o){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-i.top,2)+Math.pow(t.left-i.left,2))*o.animation}(c,l,d,o.options)),O(s,r)||(i.prevFromRect=r,i.prevToRect=s,t||(t=o.options.animation),o.animate(i,c,s,t)),t&&(n=!0,a=Math.max(a,t),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout(function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null},t),i.thisAnimationDuration=t)}),clearTimeout(e),n?e=setTimeout(function(){"function"==typeof i&&i()},a):"function"==typeof i&&i(),t=[]},animate:function(e,t,i,o){if(o){S(e,"transition",""),S(e,"transform","");var n=C(this.el),a=n&&n.a,r=n&&n.d,s=(t.left-i.left)/(a||1),l=(t.top-i.top)/(r||1);e.animatingX=!!s,e.animatingY=!!l,S(e,"transform","translate3d("+s+"px,"+l+"px,0)"),function(e){e.offsetWidth}(e),S(e,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),S(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout(function(){S(e,"transition",""),S(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},o)}}}}var U=[],z={initializeByDefault:!0},G={mount:function(e){for(var t in z)!z.hasOwnProperty(t)||t in e||(e[t]=z[t]);U.push(e)},pluginEvent:function(e,t,i){var n=this;this.eventCanceled=!1,i.cancel=function(){n.eventCanceled=!0};var a=e+"Global";U.forEach(function(n){t[n.pluginName]&&(t[n.pluginName][a]&&t[n.pluginName][a](o({sortable:t},i)),t.options[n.pluginName]&&t[n.pluginName][e]&&t[n.pluginName][e](o({sortable:t},i)))})},initializePlugins:function(e,t,o,n){for(var a in U.forEach(function(n){var a=n.pluginName;if(e.options[a]||n.initializeByDefault){var r=new n(e,t,e.options);r.sortable=e,r.options=e.options,e[a]=r,i(o,r.defaults)}}),e.options)if(e.options.hasOwnProperty(a)){var r=this.modifyOption(e,a,e.options[a]);void 0!==r&&(e.options[a]=r)}},getEventProperties:function(e,t){var o={};return U.forEach(function(n){"function"==typeof n.eventProperties&&i(o,n.eventProperties.call(t[n.pluginName],e))}),o},modifyOption:function(e,t,i){var o;return U.forEach(function(n){e[n.pluginName]&&n.optionListeners&&"function"==typeof n.optionListeners[t]&&(o=n.optionListeners[t].call(e[n.pluginName],i))}),o}};function V(e){var t=e.sortable,i=e.rootEl,n=e.name,a=e.targetEl,r=e.cloneEl,d=e.toEl,c=e.fromEl,u=e.oldIndex,h=e.newIndex,p=e.oldDraggableIndex,f=e.newDraggableIndex,m=e.originalEvent,g=e.putSortable,v=e.extraEventProperties;if(t=t||i&&i[F]){var b,y=t.options,w="on"+n.charAt(0).toUpperCase()+n.substr(1);!window.CustomEvent||s||l?(b=document.createEvent("Event")).initEvent(n,!0,!0):b=new CustomEvent(n,{bubbles:!0,cancelable:!0}),b.to=d||i,b.from=c||i,b.item=a||i,b.clone=r,b.oldIndex=u,b.newIndex=h,b.oldDraggableIndex=p,b.newDraggableIndex=f,b.originalEvent=m,b.pullMode=g?g.lastPutMode:void 0;var _=o({},v,G.getEventProperties(n,t));for(var S in _)b[S]=_[S];i&&i.dispatchEvent(b),y[w]&&y[w].call(t,b)}}var W=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.evt,r=n(i,["evt"]);G.pluginEvent.bind(Be)(e,t,o({dragEl:Y,parentEl:X,ghostEl:K,rootEl:J,nextEl:Q,lastDownEl:Z,cloneEl:ee,cloneHidden:te,dragStarted:fe,putSortable:se,activeSortable:Be.active,originalEvent:a,oldIndex:ie,oldDraggableIndex:ne,newIndex:oe,newDraggableIndex:ae,hideGhostForTarget:Oe,unhideGhostForTarget:Pe,cloneNowHidden:function(){te=!0},cloneNowShown:function(){te=!1},dispatchSortableEvent:function(e){q({sortable:t,name:e,originalEvent:a})}},r))};function q(e){V(o({putSortable:se,cloneEl:ee,targetEl:Y,rootEl:J,oldIndex:ie,oldDraggableIndex:ne,newIndex:oe,newDraggableIndex:ae},e))}var Y,X,K,J,Q,Z,ee,te,ie,oe,ne,ae,re,se,le,de,ce,ue,he,pe,fe,me,ge,ve,be,ye=!1,we=!1,_e=[],Se=!1,Ce=!1,ke=[],Te=!1,$e=[],xe="undefined"!=typeof document,Ee=u,Ae=l||s?"cssFloat":"float",Le=xe&&!h&&!u&&"draggable"in document.createElement("div"),Ie=function(){if(xe){if(s)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Me=function(e,t){var i=S(e),o=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),n=A(e,0,t),a=A(e,1,t),r=n&&S(n),s=a&&S(a),l=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+x(n).width,d=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+x(a).width;if("flex"===i.display)return"column"===i.flexDirection||"column-reverse"===i.flexDirection?"vertical":"horizontal";if("grid"===i.display)return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(n&&r.float&&"none"!==r.float){var c="left"===r.float?"left":"right";return!a||"both"!==s.clear&&s.clear!==c?"horizontal":"vertical"}return n&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||l>=o&&"none"===i[Ae]||a&&"none"===i[Ae]&&l+d>o)?"vertical":"horizontal"},De=function(t){function i(e,t){return function(o,n,a,r){var s=o.options.group.name&&n.options.group.name&&o.options.group.name===n.options.group.name;if(null==e&&(t||s))return!0;if(null==e||!1===e)return!1;if(t&&"clone"===e)return e;if("function"==typeof e)return i(e(o,n,a,r),t)(o,n,a,r);var l=(t?o:n).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var o={},n=t.group;n&&"object"==e(n)||(n={name:n}),o.name=n.name,o.checkPull=i(n.pull,!0),o.checkPut=i(n.put),o.revertClone=n.revertClone,t.group=o},Oe=function(){!Ie&&K&&S(K,"display","none")},Pe=function(){!Ie&&K&&S(K,"display","")};xe&&document.addEventListener("click",function(e){if(we)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),we=!1,!1},!0);var Re=function(e){if(Y){if(e=e.touches?e.touches[0]:e,t=!1,!$("body").hasClass("ie11"))var t=(n=e.clientX,a=e.clientY,_e.some(function(e){if(!L(e)){var t=x(e),i=e[F].options.emptyInsertThreshold,o=n>=t.left-i&&n<=t.right+i,s=a>=t.top-i&&a<=t.bottom+i;return i&&o&&s?r=e:void 0}}),r);if(t){var i={};for(var o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);i.target=i.rootEl=t,i.preventDefault=void 0,i.stopPropagation=void 0,t[F]._onDragOver(i)}}var n,a,r},Ne=function(e){Y&&Y.parentNode[F]._isOutsideThisEl(e.target)};function Be(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=i({},t),e[F]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Me(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Be.supportPointer&&"PointerEvent"in window,emptyInsertThreshold:5};for(var n in G.initializePlugins(this,e,o),o)!(n in t)&&(t[n]=o[n]);for(var a in De(t),this)"_"===a.charAt(0)&&"function"==typeof this[a]&&(this[a]=this[a].bind(this));this.nativeDraggable=!t.forceFallback&&Le,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?f(e,"pointerdown",this._onTapStart):(f(e,"mousedown",this._onTapStart),f(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(f(e,"dragover",this),f(e,"dragenter",this)),_e.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),i(this,H())}function je(e,t,i,o,n,a,r,d){var c,u,h=e[F],p=h.options.onMove;return!window.CustomEvent||s||l?(c=document.createEvent("Event")).initEvent("move",!0,!0):c=new CustomEvent("move",{bubbles:!0,cancelable:!0}),c.to=t,c.from=e,c.dragged=i,c.draggedRect=o,c.related=n||t,c.relatedRect=a||x(t),c.willInsertAfter=d,c.originalEvent=r,e.dispatchEvent(c),p&&(u=p.call(h,c,r)),u}function Fe(e){e.draggable=!1}function He(){Te=!1}function Ue(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,o=0;i--;)o+=t.charCodeAt(i);return o.toString(36)}function ze(e){return setTimeout(e,0)}function Ge(e){return clearTimeout(e)}Be.prototype={constructor:Be,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(me=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,Y):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,i=this.el,o=this.options,n=o.preventOnFilter,a=e.type,r=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(r||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,d=o.filter;if(function(e){$e.length=0;var t=e.getElementsByTagName("input"),i=t.length;for(;i--;){var o=t[i];o.checked&&$e.push(o)}}(i),!Y&&!(/mousedown|pointerdown/.test(a)&&0!==e.button||o.disabled||l.isContentEditable||(s=b(s,o.draggable,i,!1))&&s.animated||Z===s)){if(ie=I(s),ne=I(s,o.draggable),"function"==typeof d){if(d.call(this,e,s,this))return q({sortable:t,rootEl:l,name:"filter",targetEl:s,toEl:i,fromEl:i}),W("filter",t,{evt:e}),void(n&&e.cancelable&&e.preventDefault())}else if(d&&(d=d.split(",").some(function(o){if(o=b(l,o.trim(),i,!1))return q({sortable:t,rootEl:o,name:"filter",targetEl:s,fromEl:i,toEl:i}),W("filter",t,{evt:e}),!0})))return void(n&&e.cancelable&&e.preventDefault());o.handle&&!b(l,o.handle,i,!1)||this._prepareDragStart(e,r,s)}}},_prepareDragStart:function(e,t,i){var o,n=this,a=n.el,r=n.options,c=a.ownerDocument;if(i&&!Y&&i.parentNode===a){var u=x(i);if(J=a,X=(Y=i).parentNode,Q=Y.nextSibling,Z=i,re=r.group,Be.dragged=Y,le={target:Y,clientX:(t||e).clientX,clientY:(t||e).clientY},he=le.clientX-u.left,pe=le.clientY-u.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Y.style["will-change"]="all",o=function(){W("delayEnded",n,{evt:e}),Be.eventCanceled?n._onDrop():(n._disableDelayedDragEvents(),!d&&n.nativeDraggable&&(Y.draggable=!0),n._triggerDragStart(e,t),q({sortable:n,name:"choose",originalEvent:e}),_(Y,r.chosenClass,!0))},r.ignore.split(",").forEach(function(e){k(Y,e.trim(),Fe)}),f(c,"dragover",Re),f(c,"mousemove",Re),f(c,"touchmove",Re),f(c,"mouseup",n._onDrop),f(c,"touchend",n._onDrop),f(c,"touchcancel",n._onDrop),d&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Y.draggable=!0),W("delayStart",this,{evt:e}),!r.delay||r.delayOnTouchOnly&&!t||this.nativeDraggable&&(l||s))o();else{if(Be.eventCanceled)return void this._onDrop();f(c,"mouseup",n._disableDelayedDrag),f(c,"touchend",n._disableDelayedDrag),f(c,"touchcancel",n._disableDelayedDrag),f(c,"mousemove",n._delayedDragTouchMoveHandler),f(c,"touchmove",n._delayedDragTouchMoveHandler),r.supportPointer&&f(c,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(o,r.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Y&&Fe(Y),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;m(e,"mouseup",this._disableDelayedDrag),m(e,"touchend",this._disableDelayedDrag),m(e,"touchcancel",this._disableDelayedDrag),m(e,"mousemove",this._delayedDragTouchMoveHandler),m(e,"touchmove",this._delayedDragTouchMoveHandler),m(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?f(document,"pointermove",this._onTouchMove):f(document,t?"touchmove":"mousemove",this._onTouchMove):(f(Y,"dragend",this),f(J,"dragstart",this._onDragStart));try{document.selection?ze(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(ye=!1,J&&Y){W("dragStarted",this,{evt:t}),this.nativeDraggable&&f(document,"dragover",Ne);var i=this.options;!e&&_(Y,i.dragClass,!1),_(Y,i.ghostClass,!0),Be.active=this,e&&this._appendGhost(),q({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(de){this._lastX=de.clientX,this._lastY=de.clientY,Oe();for(var e=document.elementFromPoint(de.clientX,de.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(de.clientX,de.clientY))!==t;)t=e;if(Y.parentNode[F]._isOutsideThisEl(e),t)do{if(t[F]){if(t[F]._onDragOver({clientX:de.clientX,clientY:de.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Pe()}},_onTouchMove:function(e){if(le){var t=this.options,i=t.fallbackTolerance,o=t.fallbackOffset,n=e.touches?e.touches[0]:e,a=K&&C(K),r=K&&a&&a.a,s=K&&a&&a.d,l=Ee&&be&&M(be),d=(n.clientX-le.clientX+o.x)/(r||1)+(l?l[0]-ke[0]:0)/(r||1),c=(n.clientY-le.clientY+o.y)/(s||1)+(l?l[1]-ke[1]:0)/(s||1);if(!Be.active&&!ye){if(i&&Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(K){a?(a.e+=d-(ce||0),a.f+=c-(ue||0)):a={a:1,b:0,c:0,d:1,e:d,f:c};var u="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");S(K,"webkitTransform",u),S(K,"mozTransform",u),S(K,"msTransform",u),S(K,"transform",u),ce=d,ue=c,de=n}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!K){var e=this.options.fallbackOnBody?document.body:J,t=x(Y,!0,Ee,!0,e),i=this.options;if(Ee){for(be=e;"static"===S(be,"position")&&"none"===S(be,"transform")&&be!==document;)be=be.parentNode;be!==document.body&&be!==document.documentElement?(be===document&&(be=T()),t.top+=be.scrollTop,t.left+=be.scrollLeft):be=T(),ke=M(be)}_(K=Y.cloneNode(!0),i.ghostClass,!1),_(K,i.fallbackClass,!0),_(K,i.dragClass,!0),S(K,"transition",""),S(K,"transform",""),S(K,"box-sizing","border-box"),S(K,"margin",0),S(K,"top",t.top),S(K,"left",t.left),S(K,"width",t.width),S(K,"height",t.height),S(K,"opacity","0.8"),S(K,"position",Ee?"absolute":"fixed"),S(K,"zIndex","100000"),S(K,"pointerEvents","none"),Be.ghost=K,e.appendChild(K),S(K,"transform-origin",he/parseInt(K.style.width)*100+"% "+pe/parseInt(K.style.height)*100+"%")}},_onDragStart:function(e,t){var i=this,o=e.dataTransfer,n=i.options;W("dragStart",this,{evt:e}),Be.eventCanceled?this._onDrop():(W("setupClone",this),Be.eventCanceled||((ee=N(Y)).draggable=!1,ee.style["will-change"]="",this._hideClone(),_(ee,this.options.chosenClass,!1),Be.clone=ee),i.cloneId=ze(function(){W("clone",i),Be.eventCanceled||(i.options.removeCloneOnHide||J.insertBefore(ee,Y),i._hideClone(),q({sortable:i,name:"clone"}))}),!t&&_(Y,n.dragClass,!0),t?(we=!0,i._loopId=setInterval(i._emulateDragOver,50)):(m(document,"mouseup",i._onDrop),m(document,"touchend",i._onDrop),m(document,"touchcancel",i._onDrop),o&&(o.effectAllowed="move",n.setData&&n.setData.call(i,o,Y)),f(document,"drop",i),S(Y,"transform","translateZ(0)")),ye=!0,i._dragStartId=ze(i._dragStarted.bind(i,t,e)),f(document,"selectstart",i),fe=!0,c&&S(document.body,"user-select","none"))},_onDragOver:function(e){var t,i,n,a,r=this.el,s=e.target,l=this.options,d=l.group,c=Be.active,u=re===d,h=l.sort,p=se||c,f=this,m=!1;if(!Te){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),s=b(s,l.draggable,r,!0),N("dragOver"),Be.eventCanceled)return m;if(Y.contains(e.target)||s.animated&&s.animatingX&&s.animatingY||f._ignoreWhileAnimating===s)return j(!1);if(we=!1,c&&!l.disabled&&(u?h||(n=!J.contains(Y)):se===this||(this.lastPutMode=re.checkPull(this,c,Y,e))&&d.checkPut(this,c,Y,e))){if(a="vertical"===this._getDirection(e,s),t=x(Y),N("dragOverValid"),Be.eventCanceled)return m;if(n)return X=J,B(),this._hideClone(),N("revert"),Be.eventCanceled||(Q?J.insertBefore(Y,Q):J.appendChild(Y)),j(!0);var g=L(r,l.draggable);if(!g||function(e,t,i){var o=x(L(i.el,i.options.draggable));return t?e.clientX>o.right+10||e.clientX<=o.right&&e.clientY>o.bottom&&e.clientX>=o.left:e.clientX>o.right&&e.clientY>o.top||e.clientX<=o.right&&e.clientY>o.bottom+10}(e,a,this)&&!g.animated){if(g===Y)return j(!1);if(g&&r===e.target&&(s=g),s&&(i=x(s)),!1!==je(J,r,Y,t,s,i,e,!!s))return B(),r.appendChild(Y),X=r,H(),j(!0)}else if(s.parentNode===r){i=x(s);var v,y,w,C=Y.parentNode!==r,k=!function(e,t,i){var o=i?e.left:e.top,n=i?e.right:e.bottom,a=i?e.width:e.height,r=i?t.left:t.top,s=i?t.right:t.bottom,l=i?t.width:t.height;return o===r||n===s||o+a/2===r+l/2}(Y.animated&&Y.toRect||t,s.animated&&s.toRect||i,a),T=a?"top":"left",$=E(s,"top","top")||E(Y,"top","top"),A=$?$.scrollTop:void 0;if(me!==s&&(y=i[T],Se=!1,Ce=!k&&l.invertSwap||C),0!==(v=function(e,t,i,o,n,a,r,s){var l=o?e.clientY:e.clientX,d=o?i.height:i.width,c=o?i.top:i.left,u=o?i.bottom:i.right,h=!1;if(!r)if(s&&ve<d*n){if(!Se&&(1===ge?l>c+d*a/2:l<u-d*a/2)&&(Se=!0),Se)h=!0;else if(1===ge?l<c+ve:l>u-ve)return-ge}else if(l>c+d*(1-n)/2&&l<u-d*(1-n)/2)return function(e){return I(Y)<I(e)?1:-1}(t);if((h=h||r)&&(l<c+d*a/2||l>u-d*a/2))return l>c+d/2?1:-1;return 0}(e,s,i,a,k?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,Ce,me===s))){var M=I(Y);do{M-=v,w=X.children[M]}while(w&&("none"===S(w,"display")||w===K))}if(0===v||w===s)return j(!1);me=s,ge=v;var D=s.nextElementSibling,O=!1,P=je(J,r,Y,t,s,i,e,O=1===v);if(!1!==P)return 1!==P&&-1!==P||(O=1===P),Te=!0,setTimeout(He,30),B(),O&&!D?r.appendChild(Y):s.parentNode.insertBefore(Y,O?D:s),$&&R($,0,A-$.scrollTop),X=Y.parentNode,void 0===y||Ce||(ve=Math.abs(y-x(s)[T])),H(),j(!0)}if(r.contains(Y))return j(!1)}return!1}function N(l,d){W(l,f,o({evt:e,isOwner:u,axis:a?"vertical":"horizontal",revert:n,dragRect:t,targetRect:i,canSort:h,fromSortable:p,target:s,completed:j,onMove:function(i,o){return je(J,r,Y,t,i,x(i),e,o)},changed:H},d))}function B(){N("dragOverAnimationCapture"),f.captureAnimationState(),f!==p&&p.captureAnimationState()}function j(t){return N("dragOverCompleted",{insertion:t}),t&&(u?c._hideClone():c._showClone(f),f!==p&&(_(Y,se?se.options.ghostClass:c.options.ghostClass,!1),_(Y,l.ghostClass,!0)),se!==f&&f!==Be.active?se=f:f===Be.active&&se&&(se=null),p===f&&(f._ignoreWhileAnimating=s),f.animateAll(function(){N("dragOverAnimationComplete"),f._ignoreWhileAnimating=null}),f!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(s===Y&&!Y.animated||s===r&&!s.animated)&&(me=null),l.dragoverBubble||e.rootEl||s===document||(Y.parentNode[F]._isOutsideThisEl(e.target),!t&&Re(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function H(){oe=I(Y),ae=I(Y,l.draggable),q({sortable:f,name:"change",toEl:r,newIndex:oe,newDraggableIndex:ae,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){m(document,"mousemove",this._onTouchMove),m(document,"touchmove",this._onTouchMove),m(document,"pointermove",this._onTouchMove),m(document,"dragover",Re),m(document,"mousemove",Re),m(document,"touchmove",Re)},_offUpEvents:function(){var e=this.el.ownerDocument;m(e,"mouseup",this._onDrop),m(e,"touchend",this._onDrop),m(e,"pointerup",this._onDrop),m(e,"touchcancel",this._onDrop),m(document,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;oe=I(Y),ae=I(Y,i.draggable),W("drop",this,{evt:e}),X=Y&&Y.parentNode,oe=I(Y),ae=I(Y,i.draggable),Be.eventCanceled?this._nulling():(ye=!1,Ce=!1,Se=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ge(this.cloneId),Ge(this._dragStartId),this.nativeDraggable&&(m(document,"drop",this),m(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),c&&S(document.body,"user-select",""),e&&(fe&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),K&&K.parentNode&&K.parentNode.removeChild(K),(J===X||se&&"clone"!==se.lastPutMode)&&ee&&ee.parentNode&&ee.parentNode.removeChild(ee),Y&&(this.nativeDraggable&&m(Y,"dragend",this),Fe(Y),Y.style["will-change"]="",fe&&!ye&&_(Y,se?se.options.ghostClass:this.options.ghostClass,!1),_(Y,this.options.chosenClass,!1),q({sortable:this,name:"unchoose",toEl:X,newIndex:null,newDraggableIndex:null,originalEvent:e}),J!==X?(oe>=0&&(q({rootEl:X,name:"add",toEl:X,fromEl:J,originalEvent:e}),q({sortable:this,name:"remove",toEl:X,originalEvent:e}),q({rootEl:X,name:"sort",toEl:X,fromEl:J,originalEvent:e}),q({sortable:this,name:"sort",toEl:X,originalEvent:e})),se&&se.save()):oe!==ie&&oe>=0&&(q({sortable:this,name:"update",toEl:X,originalEvent:e}),q({sortable:this,name:"sort",toEl:X,originalEvent:e})),Be.active&&(null!=oe&&-1!==oe||(oe=ie,ae=ne),q({sortable:this,name:"end",toEl:X,originalEvent:e}),this.save()))),this._nulling())},_nulling:function(){W("nulling",this),J=Y=X=K=Q=ee=Z=te=le=de=fe=oe=ae=ie=ne=me=ge=se=re=Be.dragged=Be.ghost=Be.clone=Be.active=null,$e.forEach(function(e){e.checked=!0}),$e.length=ce=ue=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Y&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],i=this.el.children,o=0,n=i.length,a=this.options;o<n;o++)b(e=i[o],a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||Ue(e));return t},sort:function(e){var t={},i=this.el;this.toArray().forEach(function(e,o){var n=i.children[o];b(n,this.options.draggable,i,!1)&&(t[e]=n)},this),e.forEach(function(e){t[e]&&(i.removeChild(t[e]),i.appendChild(t[e]))})},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return b(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var i=this.options;if(void 0===t)return i[e];var o=G.modifyOption(this,e,t);i[e]=void 0!==o?o:t,"group"===e&&De(i)},destroy:function(){W("destroy",this);var e=this.el;e[F]=null,m(e,"mousedown",this._onTapStart),m(e,"touchstart",this._onTapStart),m(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(m(e,"dragover",this),m(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),_e.splice(_e.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!te){if(W("hideClone",this),Be.eventCanceled)return;S(ee,"display","none"),this.options.removeCloneOnHide&&ee.parentNode&&ee.parentNode.removeChild(ee),te=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(te){if(W("showClone",this),Be.eventCanceled)return;J.contains(Y)&&!this.options.group.revertClone?J.insertBefore(ee,Y):Q?J.insertBefore(ee,Q):J.appendChild(ee),this.options.group.revertClone&&this.animate(Y,ee),S(ee,"display",""),te=!1}}else this._hideClone()}},xe&&f(document,"touchmove",function(e){(Be.active||ye)&&e.cancelable&&e.preventDefault()}),Be.utils={on:f,off:m,css:S,find:k,is:function(e,t){return!!b(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},throttle:P,closest:b,toggleClass:_,clone:N,index:I,nextTick:ze,cancelNextTick:Ge,detectDirection:Me,getChild:A},Be.get=function(e){return e[F]},Be.mount=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t[0].constructor===Array&&(t=t[0]),t.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Be.utils=o({},Be.utils,e.utils)),G.mount(e)})},Be.create=function(e,t){return new Be(e,t)},Be.version="1.10.1";var Ve,We,qe,Ye,Xe,Ke,Je=[],Qe=!1;function Ze(){Je.forEach(function(e){clearInterval(e.pid)}),Je=[]}function et(){clearInterval(Ke)}var tt,it=P(function(e,t,i,o){if(t.scroll){var n,a=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,l=t.scrollSpeed,d=T(),c=!1;We!==i&&(We=i,Ze(),Ve=t.scroll,n=t.scrollFn,!0===Ve&&(Ve=D(i,!0)));var u=0,h=Ve;do{var p=h,f=x(p),m=f.top,g=f.bottom,v=f.left,b=f.right,y=f.width,w=f.height,_=void 0,C=void 0,k=p.scrollWidth,$=p.scrollHeight,E=S(p),A=p.scrollLeft,L=p.scrollTop;p===d?(_=y<k&&("auto"===E.overflowX||"scroll"===E.overflowX||"visible"===E.overflowX),C=w<$&&("auto"===E.overflowY||"scroll"===E.overflowY||"visible"===E.overflowY)):(_=y<k&&("auto"===E.overflowX||"scroll"===E.overflowX),C=w<$&&("auto"===E.overflowY||"scroll"===E.overflowY));var I=_&&(Math.abs(b-a)<=s&&A+y<k)-(Math.abs(v-a)<=s&&!!A),M=C&&(Math.abs(g-r)<=s&&L+w<$)-(Math.abs(m-r)<=s&&!!L);if(!Je[u])for(var O=0;O<=u;O++)Je[O]||(Je[O]={});Je[u].vx==I&&Je[u].vy==M&&Je[u].el===p||(Je[u].el=p,Je[u].vx=I,Je[u].vy=M,clearInterval(Je[u].pid),0==I&&0==M||(c=!0,Je[u].pid=setInterval(function(){o&&0===this.layer&&Be.active._onTouchMove(Xe);var t=Je[this.layer].vy?Je[this.layer].vy*l:0,i=Je[this.layer].vx?Je[this.layer].vx*l:0;"function"==typeof n&&"continue"!==n.call(Be.dragged.parentNode[F],i,t,e,Xe,Je[this.layer].el)||R(Je[this.layer].el,i,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&h!==d&&(h=D(h,!1)));Qe=c}},30),ot=function(e){var t=e.originalEvent,i=e.putSortable,o=e.dragEl,n=e.activeSortable,a=e.dispatchSortableEvent,r=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var l=i||n;r();var d=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,c=document.elementFromPoint(d.clientX,d.clientY);s(),l&&!l.el.contains(c)&&(a("spill"),this.onSpill({dragEl:o,putSortable:i}))}};function nt(){}function at(){}nt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var o=A(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(t,o):this.sortable.el.appendChild(t),this.sortable.animateAll(),i&&i.animateAll()},drop:ot},i(nt,{pluginName:"revertOnSpill"}),at.prototype={onSpill:function(e){var t=e.dragEl,i=e.putSortable||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:ot},i(at,{pluginName:"removeOnSpill"});var rt,st,lt,dt,ct,ut=[],ht=[],pt=!1,ft=!1,mt=!1;function gt(e,t){ht.forEach(function(i,o){var n=t.children[i.sortableIndex+(e?Number(o):0)];n?t.insertBefore(i,n):t.appendChild(i)})}function vt(){ut.forEach(function(e){e!==lt&&e.parentNode&&e.parentNode.removeChild(e)})}return Be.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?f(document,"dragover",this._handleAutoScroll):this.options.supportPointer?f(document,"pointermove",this._handleFallbackAutoScroll):t.touches?f(document,"touchmove",this._handleFallbackAutoScroll):f(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?m(document,"dragover",this._handleAutoScroll):(m(document,"pointermove",this._handleFallbackAutoScroll),m(document,"touchmove",this._handleFallbackAutoScroll),m(document,"mousemove",this._handleFallbackAutoScroll)),et(),Ze(),clearTimeout(y),y=void 0},nulling:function(){Xe=We=Ve=Qe=Ke=qe=Ye=null,Je.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var i=this,o=(e.touches?e.touches[0]:e).clientX,n=(e.touches?e.touches[0]:e).clientY,a=document.elementFromPoint(o,n);if(Xe=e,t||l||s||c){it(e,this.options,a,t);var r=D(a,!0);!Qe||Ke&&o===qe&&n===Ye||(Ke&&et(),Ke=setInterval(function(){var a=D(document.elementFromPoint(o,n),!0);a!==r&&(r=a,Ze()),it(e,i.options,a,t)},10),qe=o,Ye=n)}else{if(!this.options.bubbleScroll||D(a,!0)===T())return void Ze();it(e,this.options,D(a,!1),!1)}}},i(e,{pluginName:"scroll",initializeByDefault:!0})}),Be.mount(at,nt),Be.mount(new function(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(e){var t=e.dragEl;tt=t},dragOverValid:function(e){var t=e.completed,i=e.target,o=e.onMove,n=e.activeSortable,a=e.changed,r=e.cancel;if(n.options.swap){var s=this.sortable.el,l=this.options;if(i&&i!==s){var d=tt;!1!==o(i)?(_(i,l.swapClass,!0),tt=i):tt=null,d&&d!==tt&&_(d,l.swapClass,!1)}a(),t(!0),r()}},drop:function(e){var t,i,o,n,a,r,s=e.activeSortable,l=e.putSortable,d=e.dragEl,c=l||this.sortable,u=this.options;tt&&_(tt,u.swapClass,!1),tt&&(u.swap||l&&l.options.swap)&&d!==tt&&(c.captureAnimationState(),c!==s&&s.captureAnimationState(),i=tt,a=(t=d).parentNode,r=i.parentNode,a&&r&&!a.isEqualNode(i)&&!r.isEqualNode(t)&&(o=I(t),n=I(i),a.isEqualNode(r)&&o<n&&n++,a.insertBefore(i,a.children[o]),r.insertBefore(t,r.children[n])),c.animateAll(),c!==s&&s.animateAll())},nulling:function(){tt=null}},i(e,{pluginName:"swap",eventProperties:function(){return{swapItem:tt}}})}),Be.mount(new function(){function e(e){for(var t in this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this));e.options.supportPointer?f(document,"pointerup",this._deselectMultiDrag):(f(document,"mouseup",this._deselectMultiDrag),f(document,"touchend",this._deselectMultiDrag)),f(document,"keydown",this._checkKeyDown),f(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(t,i){var o="";ut.length&&st===e?ut.forEach(function(e,t){o+=(t?", ":"")+e.textContent}):o=i.textContent,t.setData("Text",o)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){var t=e.dragEl;lt=t},delayEnded:function(){this.isMultiDrag=~ut.indexOf(lt)},setupClone:function(e){var t=e.sortable,i=e.cancel;if(this.isMultiDrag){for(var o=0;o<ut.length;o++)ht.push(N(ut[o])),ht[o].sortableIndex=ut[o].sortableIndex,ht[o].draggable=!1,ht[o].style["will-change"]="",_(ht[o],this.options.selectedClass,!1),ut[o]===lt&&_(ht[o],this.options.chosenClass,!1);t._hideClone(),i()}},clone:function(e){var t=e.sortable,i=e.rootEl,o=e.dispatchSortableEvent,n=e.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||ut.length&&st===t&&(gt(!0,i),o("clone"),n()))},showClone:function(e){var t=e.cloneNowShown,i=e.rootEl,o=e.cancel;this.isMultiDrag&&(gt(!1,i),ht.forEach(function(e){S(e,"display","")}),t(),ct=!1,o())},hideClone:function(e){var t=this,i=(e.sortable,e.cloneNowHidden),o=e.cancel;this.isMultiDrag&&(ht.forEach(function(e){S(e,"display","none"),t.options.removeCloneOnHide&&e.parentNode&&e.parentNode.removeChild(e)}),i(),ct=!0,o())},dragStartGlobal:function(e){e.sortable,!this.isMultiDrag&&st&&st.multiDrag._deselectMultiDrag(),ut.forEach(function(e){e.sortableIndex=I(e)}),ut=ut.sort(function(e,t){return e.sortableIndex-t.sortableIndex}),mt=!0},dragStarted:function(e){var t=this,i=e.sortable;if(this.isMultiDrag){if(this.options.sort&&(i.captureAnimationState(),this.options.animation)){ut.forEach(function(e){e!==lt&&S(e,"position","absolute")});var o=x(lt,!1,!0,!0);ut.forEach(function(e){e!==lt&&B(e,o)}),ft=!0,pt=!0}i.animateAll(function(){ft=!1,pt=!1,t.options.animation&&ut.forEach(function(e){j(e)}),t.options.sort&&vt()})}},dragOver:function(e){var t=e.target,i=e.completed,o=e.cancel;ft&&~ut.indexOf(t)&&(i(!1),o())},revert:function(e){var t=e.fromSortable,i=e.rootEl,o=e.sortable,n=e.dragRect;ut.length>1&&(ut.forEach(function(e){o.addAnimationState({target:e,rect:ft?x(e):n}),j(e),e.fromRect=n,t.removeAnimationState(e)}),ft=!1,function(e,t){ut.forEach(function(i,o){var n=t.children[i.sortableIndex+(e?Number(o):0)];n?t.insertBefore(i,n):t.appendChild(i)})}(!this.options.removeCloneOnHide,i))},dragOverCompleted:function(e){var t=e.sortable,i=e.isOwner,o=e.insertion,n=e.activeSortable,a=e.parentEl,r=e.putSortable,s=this.options;if(o){if(i&&n._hideClone(),pt=!1,s.animation&&ut.length>1&&(ft||!i&&!n.options.sort&&!r)){var l=x(lt,!1,!0,!0);ut.forEach(function(e){e!==lt&&(B(e,l),a.appendChild(e))}),ft=!0}if(!i)if(ft||vt(),ut.length>1){var d=ct;n._showClone(t),n.options.animation&&!ct&&d&&ht.forEach(function(e){n.addAnimationState({target:e,rect:dt}),e.fromRect=dt,e.thisAnimationDuration=null})}else n._showClone(t)}},dragOverAnimationCapture:function(e){var t=e.dragRect,o=e.isOwner,n=e.activeSortable;if(ut.forEach(function(e){e.thisAnimationDuration=null}),n.options.animation&&!o&&n.multiDrag.isMultiDrag){dt=i({},t);var a=C(lt,!0);dt.top-=a.f,dt.left-=a.e}},dragOverAnimationComplete:function(){ft&&(ft=!1,vt())},drop:function(e){var t=e.originalEvent,i=e.rootEl,o=e.parentEl,n=e.sortable,a=e.dispatchSortableEvent,r=e.oldIndex,s=e.putSortable,l=s||this.sortable;if(t){var d=this.options,c=o.children;if(!mt)if(d.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),_(lt,d.selectedClass,!~ut.indexOf(lt)),~ut.indexOf(lt))ut.splice(ut.indexOf(lt),1),rt=null,V({sortable:n,rootEl:i,name:"deselect",targetEl:lt,originalEvt:t});else{if(ut.push(lt),V({sortable:n,rootEl:i,name:"select",targetEl:lt,originalEvt:t}),t.shiftKey&&rt&&n.el.contains(rt)){var u,h,p=I(rt),f=I(lt);if(~p&&~f&&p!==f)for(f>p?(h=p,u=f):(h=f,u=p+1);h<u;h++)~ut.indexOf(c[h])||(_(c[h],d.selectedClass,!0),ut.push(c[h]),V({sortable:n,rootEl:i,name:"select",targetEl:c[h],originalEvt:t}))}else rt=lt;st=l}if(mt&&this.isMultiDrag){if((o[F].options.sort||o!==i)&&ut.length>1){var m=x(lt),g=I(lt,":not(."+this.options.selectedClass+")");if(!pt&&d.animation&&(lt.thisAnimationDuration=null),l.captureAnimationState(),!pt&&(d.animation&&(lt.fromRect=m,ut.forEach(function(e){if(e.thisAnimationDuration=null,e!==lt){var t=ft?x(e):m;e.fromRect=t,l.addAnimationState({target:e,rect:t})}})),vt(),ut.forEach(function(e){c[g]?o.insertBefore(e,c[g]):o.appendChild(e),g++}),r===I(lt))){var v=!1;ut.forEach(function(e){e.sortableIndex===I(e)||(v=!0)}),v&&a("update")}ut.forEach(function(e){j(e)}),l.animateAll()}st=l}(i===o||s&&"clone"!==s.lastPutMode)&&ht.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})}},nullingGlobal:function(){this.isMultiDrag=mt=!1,ht.length=0},destroyGlobal:function(){this._deselectMultiDrag(),m(document,"pointerup",this._deselectMultiDrag),m(document,"mouseup",this._deselectMultiDrag),m(document,"touchend",this._deselectMultiDrag),m(document,"keydown",this._checkKeyDown),m(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(!mt&&st===this.sortable&&!(e&&b(e.target,this.options.draggable,this.sortable.el,!1)||e&&0!==e.button))for(;ut.length;){var t=ut[0];_(t,this.options.selectedClass,!1),ut.shift(),V({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:t,originalEvt:e})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},i(e,{pluginName:"multiDrag",utils:{select:function(e){var t=e.parentNode[F];t&&t.options.multiDrag&&!~ut.indexOf(e)&&(st&&st!==t&&(st.multiDrag._deselectMultiDrag(),st=t),_(e,t.options.selectedClass,!0),ut.push(e))},deselect:function(e){var t=e.parentNode[F],i=ut.indexOf(e);t&&t.options.multiDrag&&~i&&(_(e,t.options.selectedClass,!1),ut.splice(i,1))}},eventProperties:function(){var e=this,t=[],i=[];return ut.forEach(function(o){var n;t.push({multiDragElement:o,index:o.sortableIndex}),n=ft&&o!==lt?-1:ft?I(o,":not(."+e.options.selectedClass+")"):I(o),i.push({multiDragElement:o,index:n})}),{items:a(ut),clones:[].concat(ht),oldIndicies:t,newIndicies:i}},optionListeners:{multiDragKey:function(e){return"ctrl"===(e=e.toLowerCase())?e="Control":e.length>1&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})}),Be}),function(e){"use strict";var t=function(t){this.element=e(t)};function i(i){return this.each(function(){var o=e(this),n=o.data("bs.tab");n||o.data("bs.tab",n=new t(this)),"string"==typeof i&&n[i]()})}t.VERSION="3.3.7",t.TRANSITION_DURATION=150,t.prototype.show=function(){var t=this.element,i=t.closest("ul:not(.dropdown-menu)"),o=t.data("target");if(o||(o=(o=t.attr("href"))&&o.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var n=i.find(".active:last a"),a=e.Event("hide.bs.tab",{relatedTarget:t[0]}),r=e.Event("show.bs.tab",{relatedTarget:n[0]});if(n.trigger(a),t.trigger(r),!r.isDefaultPrevented()&&!a.isDefaultPrevented()){var s=e(o);this.activate(t.closest("li"),i),this.activate(s,s.parent(),function(){n.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:n[0]})})}}},t.prototype.activate=function(i,o,n){var a=o.find("> .active"),r=n&&e.support.transition&&(a.length&&a.hasClass("fade")||!!o.find("> .fade").length);function s(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),i.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),r?(i[0].offsetWidth,i.addClass("in")):i.removeClass("fade"),i.parent(".dropdown-menu").length&&i.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),n&&n()}a.length&&r?a.one("bsTransitionEnd",s).emulateTransitionEnd(t.TRANSITION_DURATION):s(),a.removeClass("in")};var o=e.fn.tab;e.fn.tab=i,e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=o,this};var n=function(t){t.preventDefault(),i.call(e(this),"show")};e(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',n).on("click.bs.tab.data-api",'[data-toggle="pill"]',n)}(jQuery),function(e,t){if("function"==typeof define&&define.amd)define(["exports","module"],t);else if("undefined"!=typeof exports&&"undefined"!=typeof module)t(exports,module);else{var i={exports:{}};t(i.exports,i),e.autosize=i.exports}}(this,function(e,t){"use strict";function i(e){function t(t){var o=e.style.width;e.style.width="0px",e.offsetWidth,e.style.width=o,e.style.overflowY=t,i()}function i(){var t=e.style.height,i=function(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push({node:e.parentNode,scrollTop:e.parentNode.scrollTop}),e=e.parentNode;return t}(e),o=document.documentElement&&document.documentElement.scrollTop;e.style.height="auto";var a=e.scrollHeight+n;return 0===e.scrollHeight?void(e.style.height=t):(e.style.height=a+"px",s=e.clientWidth,i.forEach(function(e){e.node.scrollTop=e.scrollTop}),void(o&&(document.documentElement.scrollTop=o)))}function o(){i();var o=window.getComputedStyle(e,null),n=Math.round(parseFloat(o.height));if(n!==Math.round(parseFloat(e.style.height))?"visible"!==o.overflowY&&t("visible"):"hidden"!==o.overflowY&&t("hidden"),l!==n){l=n;var a=r("autosize:resized");e.dispatchEvent(a)}}if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!a.has(e)){var n=null,s=e.clientWidth,l=null,d=function(){e.clientWidth!==s&&o()},c=function(t){window.removeEventListener("resize",d,!1),e.removeEventListener("input",o,!1),e.removeEventListener("keyup",o,!1),e.removeEventListener("autosize:destroy",c,!1),e.removeEventListener("autosize:update",o,!1),a.delete(e),Object.keys(t).forEach(function(i){e.style[i]=t[i]})}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",c,!1),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",o,!1),window.addEventListener("resize",d,!1),e.addEventListener("input",o,!1),e.addEventListener("autosize:update",o,!1),a.add(e),e.style.overflowX="hidden",e.style.wordWrap="break-word",function(){var t=window.getComputedStyle(e,null);"vertical"===t.resize?e.style.resize="none":"both"===t.resize&&(e.style.resize="horizontal"),n="content-box"===t.boxSizing?-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)):parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),isNaN(n)&&(n=0),o()}()}}function o(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=r("autosize:destroy");e.dispatchEvent(t)}}function n(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=r("autosize:update");e.dispatchEvent(t)}}var a="function"==typeof Set?new Set:function(){var e=[];return{has:function(t){return Boolean(e.indexOf(t)>-1)},add:function(t){e.push(t)},delete:function(t){e.splice(e.indexOf(t),1)}}}(),r=function(e){return new Event(e)};try{new Event("test")}catch(e){r=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}var s=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?((s=function(e){return e}).destroy=function(e){return e},s.update=function(e){return e}):((s=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return i(e)}),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],o),e},s.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],n),e}),t.exports=s}),function(e){e.oauthpopup=function(t){if(!t||!t.path)throw new Error("options.path must not be empty");t=e.extend({windowName:"ConnectWithOAuth",windowOptions:"location=0,status=0,width=800,height=400",callback:function(){window.location.reload()}},t);const i=window.open(t.path,t.windowName,t.windowOptions),o=window.setInterval(function(){i&&i.closed&&(window.clearInterval(o),t.callback())},1e3)},e.fn.oauthpopup=function(t){e(this).click(e.oauthpopup.bind(this,t))}}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){var t,i=navigator.userAgent,o=/iphone/i.test(i),n=/chrome/i.test(i),a=/android/i.test(i);e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},e.fn.extend({caret:function(e,t){var i;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof e?(t="number"==typeof t?t:e,this.each(function(){this.setSelectionRange?this.setSelectionRange(e,t):this.createTextRange&&((i=this.createTextRange()).collapse(!0),i.moveEnd("character",t),i.moveStart("character",e),i.select())})):(this[0].setSelectionRange?(e=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(i=document.selection.createRange(),e=0-i.duplicate().moveStart("character",-1e5),t=e+i.text.length),{begin:e,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(i,r){var s,l,d,c,u,h,p;if(!i&&this.length>0){var f=e(this[0]).data(e.mask.dataName);return f?f():void 0}return r=e.extend({autoclear:e.mask.autoclear,placeholder:e.mask.placeholder,completed:null},r),s=e.mask.definitions,l=[],d=h=i.length,c=null,e.each(i.split(""),function(e,t){"?"==t?(h--,d=e):s[t]?(l.push(new RegExp(s[t])),null===c&&(c=l.length-1),d>e&&(u=l.length-1)):l.push(null)}),this.trigger("unmask").each(function(){function f(){if(r.completed){for(var e=c;u>=e;e++)if(l[e]&&C[e]===m(e))return;r.completed.call(S)}}function m(e){return r.placeholder.charAt(e<r.placeholder.length?e:0)}function g(e){for(;++e<h&&!l[e];);return e}function v(e,t){var i,o;if(!(0>e)){for(i=e,o=g(t);h>i;i++)if(l[i]){if(!(h>o&&l[i].test(C[o])))break;C[i]=C[o],C[o]=m(o),o=g(o)}w(),S.caret(Math.max(c,e))}}function b(){_(),S.val()!=T&&S.change()}function y(e,t){var i;for(i=e;t>i&&h>i;i++)l[i]&&(C[i]=m(i))}function w(){S.val(C.join(""))}function _(e){var t,i,o,n=S.val(),a=-1;for(t=0,o=0;h>t;t++)if(l[t]){for(C[t]=m(t);o++<n.length;)if(i=n.charAt(o-1),l[t].test(i)){C[t]=i,a=t;break}if(o>n.length){y(t+1,h);break}}else C[t]===n.charAt(o)&&o++,d>t&&(a=t);return e?w():d>a+1?r.autoclear||C.join("")===k?(S.val()&&S.val(""),y(0,h)):w():(w(),S.val(S.val().substring(0,a+1))),d?t:c}var S=e(this),C=e.map(i.split(""),function(e,t){return"?"!=e?s[e]?m(t):e:void 0}),k=C.join(""),T=S.val();S.data(e.mask.dataName,function(){return e.map(C,function(e,t){return l[t]&&e!=m(t)?e:null}).join("")}),S.one("unmask",function(){S.off(".mask").removeData(e.mask.dataName)}).on("focus.mask",function(){var e;S.prop("readonly")||(clearTimeout(t),T=S.val(),e=_(),t=setTimeout(function(){S.get(0)===document.activeElement&&(w(),e==i.replace("?","").length?S.caret(0,e):S.caret(e))},10))}).on("blur.mask",b).on("keydown.mask",function(e){if(!S.prop("readonly")){var t,i,n,a=e.which||e.keyCode;p=S.val(),8===a||46===a||o&&127===a?(i=(t=S.caret()).begin,(n=t.end)-i==0&&(i=46!==a?function(e){for(;--e>=0&&!l[e];);return e}(i):n=g(i-1),n=46===a?g(n):n),y(i,n),v(i,n-1),e.preventDefault()):13===a?b.call(this,e):27===a&&(S.val(T),S.caret(0,_()),e.preventDefault())}}).on("keypress.mask",function(t){if(!S.prop("readonly")){var i,o,n,r=t.which||t.keyCode,s=S.caret();t.ctrlKey||t.altKey||t.metaKey||32>r||!r||13===r||(s.end-s.begin!=0&&(y(s.begin,s.end),v(s.begin,s.end-1)),i=g(s.begin-1),h>i&&(o=String.fromCharCode(r),l[i].test(o))&&(function(e){var t,i,o,n;for(t=e,i=m(e);h>t;t++)if(l[t]){if(o=g(t),n=C[t],C[t]=i,!(h>o&&l[o].test(n)))break;i=n}}(i),C[i]=o,w(),n=g(i),a?setTimeout(function(){e.proxy(e.fn.caret,S,n)()},0):S.caret(n),s.begin<=u&&f()),t.preventDefault())}}).on("input.mask paste.mask",function(){S.prop("readonly")||setTimeout(function(){var e=_(!0);S.caret(e),f()},0)}),n&&a&&S.off("input.mask").on("input.mask",function(){var e=S.val(),t=S.caret();if(p&&p.length&&p.length>e.length){for(_(!0);t.begin>0&&!l[t.begin-1];)t.begin--;if(0===t.begin)for(;t.begin<c&&!l[t.begin];)t.begin++;S.caret(t.begin,t.begin)}else{for(_(!0);t.begin<h&&!l[t.begin];)t.begin++;S.caret(t.begin,t.begin)}f()}),_()})}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(e){var t,i=0,o=Array.prototype.slice;e.cleanData=(t=e.cleanData,function(i){var o,n,a;for(a=0;null!=(n=i[a]);a++)try{(o=e._data(n,"events"))&&o.remove&&e(n).triggerHandler("remove")}catch(e){}t(i)}),e.widget=function(t,i,o){var n,a,r,s,l={},d=t.split(".")[0];return t=t.split(".")[1],n=d+"-"+t,o||(o=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[d]=e[d]||{},a=e[d][t],r=e[d][t]=function(e,t){if(!this._createWidget)return new r(e,t);arguments.length&&this._createWidget(e,t)},e.extend(r,a,{version:o.version,_proto:e.extend({},o),_childConstructors:[]}),(s=new i).options=e.widget.extend({},s.options),e.each(o,function(t,o){var n,a;e.isFunction(o)?l[t]=(n=function(){return i.prototype[t].apply(this,arguments)},a=function(e){return i.prototype[t].apply(this,e)},function(){var e,t=this._super,i=this._superApply;return this._super=n,this._superApply=a,e=o.apply(this,arguments),this._super=t,this._superApply=i,e}):l[t]=o}),r.prototype=e.widget.extend(s,{widgetEventPrefix:a&&s.widgetEventPrefix||t},l,{constructor:r,namespace:d,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var o=i.prototype;e.widget(o.namespace+"."+o.widgetName,r,i._proto)}),delete a._childConstructors):i._childConstructors.push(r),e.widget.bridge(t,r),r},e.widget.extend=function(t){for(var i,n,a=o.call(arguments,1),r=0,s=a.length;r<s;r++)for(i in a[r])n=a[r][i],a[r].hasOwnProperty(i)&&void 0!==n&&(e.isPlainObject(n)?t[i]=e.isPlainObject(t[i])?e.widget.extend({},t[i],n):e.widget.extend({},n):t[i]=n);return t},e.widget.bridge=function(t,i){var n=i.prototype.widgetFullName||t;e.fn[t]=function(a){var r="string"==typeof a,s=o.call(arguments,1),l=this;return r?this.each(function(){var i,o=e.data(this,n);return"instance"===a?(l=o,!1):o?e.isFunction(o[a])&&"_"!==a.charAt(0)?(i=o[a].apply(o,s))!==o&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0:e.error("no such method '"+a+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+a+"'")}):(s.length&&(a=e.widget.extend.apply(null,[a].concat(s))),this.each(function(){var t=e.data(this,n);t?(t.option(a||{}),t._init&&t._init()):e.data(this,n,new i(a,this))})),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,o){o=e(o||this.defaultElement||this)[0],this.element=e(o),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),o!==this&&(e.data(o,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===o&&this.destroy()}}),this.document=e(o.style?o.ownerDocument:o.document||o),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var o,n,a,r=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(r={},t=(o=t.split(".")).shift(),o.length){for(n=r[t]=e.widget.extend({},this.options[t]),a=0;a<o.length-1;a++)n[o[a]]=n[o[a]]||{},n=n[o[a]];if(t=o.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];r[t]=i}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,o){var n,a=this;"boolean"!=typeof t&&(o=i,i=t,t=!1),o?(i=n=e(i),this.bindings=this.bindings.add(i)):(o=i,i=this.element,n=this.widget()),e.each(o,function(o,r){function s(){if(t||!0!==a.options.disabled&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof r?a[r]:r).apply(a,arguments)}"string"!=typeof r&&(s.guid=r.guid=r.guid||s.guid||e.guid++);var l=o.match(/^([\w:-]*)\s*(.*)$/),d=l[1]+a.eventNamespace,c=l[2];c?n.delegate(c,d,s):i.bind(d,s)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){var i=this;return setTimeout(function(){return("string"==typeof e?i[e]:e).apply(i,arguments)},t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,o){var n,a,r=this.options[t];if(o=o||{},(i=e.Event(i)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,o),!(e.isFunction(r)&&!1===r.apply(this.element[0],[i].concat(o))||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(o,n,a){"string"==typeof n&&(n={effect:n});var r,s=n?!0===n||"number"==typeof n?i:n.effect||i:t;"number"==typeof(n=n||{})&&(n={duration:n}),r=!e.isEmptyObject(n),n.complete=a,n.delay&&o.delay(n.delay),r&&e.effects&&e.effects.effect[s]?o[t](n):s!==t&&o[s]?o[s](n.duration,n.easing,a):o.queue(function(i){e(this)[t](),a&&a.call(o[0]),i()})}});e.widget}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],e):e(window.jQuery)}(function(e){"use strict";e.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:e(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,i){return t=this.messages[t]||t.toString(),i&&e.each(i,function(e,i){t=t.replace("{"+e+"}",i)}),t},formData:function(e){return e.serializeArray()},add:function(t,i){(i.autoUpload||!1!==i.autoUpload&&e(this).fileupload("option","autoUpload"))&&i.process().done(function(){i.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,i){var o=e-this.timestamp;return(!this.bitrate||!i||o>i)&&(this.bitrate=(t-this.loaded)*(1e3/o)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return"function"==typeof t.formData?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(i=[],e.each(t.formData,function(e,t){i.push({name:e,value:t})}),i):[]},_getTotal:function(t){var i=0;return e.each(t,function(e,t){i+=t.size||1}),i},_initProgressObject:function(t){var i={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,i):t._progress=i},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(e,t){if(e.lengthComputable){var i,o=Date.now?Date.now():(new Date).getTime();if(t._time&&t.progressInterval&&o-t._time<t.progressInterval&&e.loaded!==e.total)return;t._time=o,i=Math.floor(e.loaded/e.total*(t.chunkSize||t._progress.total))+(t.uploadedBytes||0),this._progress.loaded+=i-t._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(o,this._progress.loaded,t.bitrateInterval),t._progress.loaded=t.loaded=i,t._progress.bitrate=t.bitrate=t._bitrateTimer.getBitrate(o,i,t.bitrateInterval),this._trigger("progress",e,t),this._trigger("progressall",e,this._progress)}},_initProgressListener:function(t){var i=this,o=t.xhr?t.xhr():e.ajaxSettings.xhr();o.upload&&(e(o.upload).on("progress",function(e){var o=e.originalEvent;e.lengthComputable=o.lengthComputable,e.loaded=o.loaded,e.total=o.total,i._onProgress(e,t)}),t.xhr=function(){return o})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var i,o=this,n=t.files[0],a=t.multipart||!e.support.xhrFileUpload,r=t.paramName[0];t.headers=t.headers||{},t.contentRange&&(t.headers["Content-Range"]=t.contentRange),a&&!t.blob&&this._isInstanceOf("File",n)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(n.name)+'"'),a?e.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:r,value:t.blob}):e.each(t.files,function(e,o){i.push({name:t.paramName[e]||r,value:o})})):(o._isInstanceOf("FormData",t.formData)?i=t.formData:(i=new FormData,e.each(this._getFormData(t),function(e,t){i.append(t.name,t.value)})),t.blob?i.append(r,t.blob,n.name):e.each(t.files,function(e,n){(o._isInstanceOf("File",n)||o._isInstanceOf("Blob",n))&&i.append(t.paramName[e]||r,n,n.name)})),t.data=i):(t.contentType=n.type,t.data=t.blob||n),t.blob=null},_initIframeSettings:function(t){var i=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&i&&i!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var i=e(t.fileInput),o=t.paramName;return o?e.isArray(o)||(o=[o]):(o=[],i.each(function(){for(var t=e(this),i=t.prop("name")||"files[]",n=(t.prop("files")||[1]).length;n;)o.push(i),n-=1}),o.length||(o=[i.prop("name")||"files[]"])),o},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=e.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,i,o){var n=e.Deferred(),a=n.promise();return i=i||this.options.context||a,!0===t?n.resolveWith(i,o):!1===t&&n.rejectWith(i,o),a.abort=n.promise,this._enhancePromise(a)},_addConvenienceMethods:function(t,i){var o=this,n=function(t){return e.Deferred().resolveWith(o,[t]).promise()};i.process=function(e,t){return(e||t)&&(i._processQueue=this._processQueue=(this._processQueue||n(this)).pipe(e,t)),this._processQueue||n(this)},i.submit=function(){return"pending"!==this.state()&&(i.jqXHR=this.jqXHR=!1!==o._trigger("submit",t,this)&&o._onSend(t,this)),this.jqXHR||o._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():o._getXHRPromise()},i.state=function(){return this.jqXHR?o._getDeferredState(this.jqXHR):this._processQueue?o._getDeferredState(this._processQueue):void 0},i.progress=function(){return this._progress},i.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),i=t&&t.split("-"),o=i&&i.length>1&&parseInt(i[1],10);return o&&o+1},_chunkedUpload:function(t,i){t.uploadedBytes=t.uploadedBytes||0;var o,n,a=this,r=t.files[0],s=r.size,l=t.uploadedBytes,d=t.maxChunkSize||s,c=this._blobSlice,u=e.Deferred(),h=u.promise();return!(!(this._isXHRUpload(t)&&c&&(l||d<s))||t.data)&&(!!i||(l>=s?(r.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",r.error])):(n=function(){var i=e.extend({},t),h=i._progress.loaded;i.blob=c.call(r,l,l+d,r.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+l+"-"+(l+i.chunkSize-1)+"/"+s,a._initXHRData(i),a._initProgressListener(i),o=(!1!==a._trigger("chunksend",null,i)&&e.ajax(i)||a._getXHRPromise(!1,i.context)).done(function(o,r,d){l=a._getUploadedBytes(d)||l+i.chunkSize,h+i.chunkSize-i._progress.loaded&&a._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-i.uploadedBytes,total:l-i.uploadedBytes}),i),t.uploadedBytes=i.uploadedBytes=l,i.result=o,i.textStatus=r,i.jqXHR=d,a._trigger("chunkdone",null,i),a._trigger("chunkalways",null,i),l<s?n():u.resolveWith(i.context,[o,r,d])}).fail(function(e,t,o){i.jqXHR=e,i.textStatus=t,i.errorThrown=o,a._trigger("chunkfail",null,i),a._trigger("chunkalways",null,i),u.rejectWith(i.context,[e,t,o])})},this._enhancePromise(h),h.abort=function(){return o.abort()},n(),h)))},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,i,o,n){var a=n._progress.total,r=n._response;n._progress.loaded<a&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:a,total:a}),n),r.result=n.result=t,r.textStatus=n.textStatus=i,r.jqXHR=n.jqXHR=o,this._trigger("done",null,n)},_onFail:function(e,t,i,o){var n=o._response;o.recalculateProgress&&(this._progress.loaded-=o._progress.loaded,this._progress.total-=o._progress.total),n.jqXHR=o.jqXHR=e,n.textStatus=o.textStatus=t,n.errorThrown=o.errorThrown=i,this._trigger("fail",null,o)},_onAlways:function(e,t,i,o){this._trigger("always",null,o)},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var o,n,a,r,s=this,l=s._getAJAXSettings(i),d=function(){return s._sending+=1,l._bitrateTimer=new s._BitrateTimer,o=o||((n||!1===s._trigger("send",t,l))&&s._getXHRPromise(!1,l.context,n)||s._chunkedUpload(l)||e.ajax(l)).done(function(e,t,i){s._onDone(e,t,i,l)}).fail(function(e,t,i){s._onFail(e,t,i,l)}).always(function(e,t,i){if(s._onAlways(e,t,i,l),s._sending-=1,s._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>s._sending)for(var o=s._slots.shift();o;){if("pending"===s._getDeferredState(o)){o.resolve();break}o=s._slots.shift()}0===s._active&&s._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(a=e.Deferred(),this._slots.push(a),r=a.pipe(d)):(this._sequence=this._sequence.pipe(d,d),r=this._sequence),r.abort=function(){return n=[void 0,"abort","abort"],o?o.abort():(a&&a.rejectWith(l.context,n),d())},this._enhancePromise(r)):d()},_onAdd:function(t,i){var o,n,a,r,s=this,l=!0,d=e.extend({},this.options,i),c=d.limitMultiFileUploads,u=this._getParamName(d);if((d.singleFileUploads||c)&&this._isXHRUpload(d))if(!d.singleFileUploads&&c)for(a=[],o=[],r=0;r<i.files.length;r+=c)a.push(i.files.slice(r,r+c)),(n=u.slice(r,r+c)).length||(n=u),o.push(n);else o=u;else a=[i.files],o=[u];return i.originalFiles=i.files,e.each(a||i.files,function(n,r){var d=e.extend({},i);return d.files=a?r:[r],d.paramName=o[n],s._initResponseObject(d),s._initProgressObject(d),s._addConvenienceMethods(t,d),l=s._trigger("add",t,d)}),l},_replaceFileInput:function(t){var i=t.clone(!0);e("<form></form>").append(i)[0].reset(),t.after(i).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,o){return o===t[0]?i[0]:o}),t[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,i){var o=this,n=e.Deferred(),a=function(e){e&&!e.entry&&(e.entry=t),n.resolve([e])};return i=i||"",t.isFile?t._file?(t._file.relativePath=i,n.resolve(t._file)):t.file(function(e){e.relativePath=i,n.resolve(e)},a):t.isDirectory?t.createReader().readEntries(function(e){o._handleFileTreeEntries(e,i+t.name+"/").done(function(e){n.resolve(e)}).fail(a)},a):n.resolve([]),n.promise()},_handleFileTreeEntries:function(t,i){var o=this;return e.when.apply(e,e.map(t,function(e){return o._handleFileTreeEntry(e,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){var i=(t=t||{}).items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(e.map(i,function(e){var t;return e.webkitGetAsEntry?((t=e.webkitGetAsEntry())&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){var i,o,n=(t=e(t)).prop("webkitEntries")||t.prop("entries");if(n&&n.length)return this._handleFileTreeEntries(n);if((i=e.makeArray(t.prop("files"))).length)void 0===i[0].name&&i[0].fileName&&e.each(i,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(!(o=t.prop("value")))return e.Deferred().resolve([]).promise();i=[{name:o.replace(/^.*\\/,"")}]}return e.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var i=this,o={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(o.fileInput).always(function(e){o.files=e,i.options.replaceFileInput&&i._replaceFileInput(o.fileInput),!1!==i._trigger("change",t,o)&&i._onAdd(t,o)})},_onPaste:function(t){var i=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,o={files:[]};if(i&&i.length&&(e.each(i,function(e,t){var i=t.getAsFile&&t.getAsFile();i&&o.files.push(i)}),!1===this._trigger("paste",t,o)||!1===this._onAdd(t,o)))return!1},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var t=this,i=e.dataTransfer,o={};i&&i.files&&i.files.length&&(e.preventDefault(),this._getDroppedFiles(i).always(function(i){o.files=i,!1!==t._trigger("drop",e,o)&&t._onAdd(e,o)}))},_onDragOver:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var i=t.dataTransfer;if(i){if(!1===this._trigger("dragover",t))return!1;-1!==e.inArray("Files",i.types)&&(i.dropEffect="copy",t.preventDefault())}},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,i){var o=-1!==e.inArray(t,this._specialOptions);o&&this._destroyEventHandlers(),this._super(t,i),o&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(t,i){return"url"!==t&&"string"===e.type(i)&&/^\/.*\/[igm]{0,3}$/.test(i)},_initDataAttributes:function(){var t=this,i=this.options;e.each(e(this.element[0].cloneNode(!1)).data(),function(e,o){t._isRegExpOption(e,o)&&(o=t._getRegExp(o)),i[e]=o})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,i._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var i,o,n=this,a=e.Deferred(),r=a.promise();return r.abort=function(){return o=!0,i?i.abort():(a.reject(null,"abort","abort"),r)},this._getFileInputFiles(t.fileInput).always(function(e){o||(t.files=e,i=n._onSend(null,t).then(function(e,t,i){a.resolve(e,t,i)},function(e,t,i){a.reject(e,t,i)}))}),this._enhancePromise(r)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=i(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function i(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.on("mouseout",i,function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",i,o)}function o(){e.datepicker._isDisabledDatepicker(a.inline?a.dpDiv.parent()[0]:a.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function n(t,i){for(var o in e.extend(t,i),i)null==i[o]&&(t[o]=i[o]);return t}var a;e.ui=e.ui||{},e.ui.version="1.12.1",e.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},e.extend(e.ui,{datepicker:{version:"1.12.1"}}),e.extend(t.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return n(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var o,n,a;n="div"===(o=t.nodeName.toLowerCase())||"span"===o,t.id||(this.uuid+=1,t.id="dp"+this.uuid),(a=this._newInst(e(t),n)).settings=e.extend({},i||{}),"input"===o?this._connectDatepicker(t,a):n&&this._inlineDatepicker(t,a)},_newInst:function(t,o){return{id:t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:o,dpDiv:o?i(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var o=e(t);i.append=e([]),i.trigger=e([]),o.hasClass(this.markerClassName)||(this._attachments(o,i),o.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var o,n,a,r=this._get(i,"appendText"),s=this._get(i,"isRTL");i.append&&i.append.remove(),r&&(i.append=e("<span class='"+this._appendClass+"'>"+r+"</span>"),t[s?"before":"after"](i.append)),t.off("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),("focus"===(o=this._get(i,"showOn"))||"both"===o)&&t.on("focus",this._showDatepicker),("button"===o||"both"===o)&&(n=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(a?e("<img/>").attr({src:a,alt:n,title:n}):n)),t[s?"before":"after"](i.trigger),i.trigger.on("click",function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,o,n,a=new Date(2009,11,20),r=this._get(e,"dateFormat");r.match(/[DM]/)&&(t=function(e){for(i=0,o=0,n=0;e.length>n;n++)e[n].length>i&&(i=e[n].length,o=n);return o},a.setMonth(t(this._get(e,r.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(t(this._get(e,r.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),e.input.attr("size",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var o=e(t);o.hasClass(this.markerClassName)||(o.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,o,a,r){var s,l,d,c,u,h=this._dialogInst;return h||(this.uuid+=1,s="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+s+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),e("body").append(this._dialogInput),(h=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},e.data(this._dialogInput[0],"datepicker",h)),n(h.settings,a||{}),i=i&&i.constructor===Date?this._formatDate(h,i):i,this._dialogInput.val(i),this._pos=r?r.length?r:[r.pageX,r.pageY]:null,this._pos||(l=document.documentElement.clientWidth,d=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+c,d/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),h.settings.onSelect=o,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",h),this},_destroyDatepicker:function(t){var i,o=e(t),n=e.data(t,"datepicker");o.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),o.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):("div"===i||"span"===i)&&o.removeClass(this.markerClassName).empty(),a===n&&(a=null))},_enableDatepicker:function(t){var i,o,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&("input"===(i=t.nodeName.toLowerCase())?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&((o=n.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),o.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,o,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&("input"===(i=t.nodeName.toLowerCase())?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&((o=n.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),o.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,o){var a,r,s,l,d=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):d?"all"===i?e.extend({},d.settings):this._get(d,i):null:(a=i||{},"string"==typeof i&&((a={})[i]=o),void(d&&(this._curInst===d&&this._hideDatepicker(),r=this._getDateDatepicker(t,!0),s=this._getMinMaxDate(d,"min"),l=this._getMinMaxDate(d,"max"),n(d.settings,a),null!==s&&void 0!==a.dateFormat&&void 0===a.minDate&&(d.settings.minDate=this._formatDate(d,s)),null!==l&&void 0!==a.dateFormat&&void 0===a.maxDate&&(d.settings.maxDate=this._formatDate(d,l)),"disabled"in a&&(a.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),d),this._autoSize(d),this._setDate(d,r),this._updateAlternate(d),this._updateDatepicker(d))))},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,o,n,a=e.datepicker._getInst(t.target),r=!0,s=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),r=!1;break;case 13:return(n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",a.dpDiv))[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,n[0]),(i=e.datepicker._get(a,"onSelect"))?(o=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[o,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),r=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),r=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,s?1:-1,"D"),r=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),r=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,s?-1:1,"D"),r=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),r=t.ctrlKey||t.metaKey;break;default:r=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):r=!1;r&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,o,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),o=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">o||!i||i.indexOf(o)>-1):void 0},_doKeyUp:function(t){var i=e.datepicker._getInst(t.target);if(i.input.val()!==i.lastVal)try{e.datepicker.parseDate(e.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,e.datepicker._getFormatConfig(i))&&(e.datepicker._setDateFromField(i),e.datepicker._updateAlternate(i),e.datepicker._updateDatepicker(i))}catch(e){}return!0},_showDatepicker:function(t){var i,o,a,r,s,l,d;("input"!==(t=t.target||t).nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t)||(i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),!1!==(a=(o=e.datepicker._get(i,"beforeShow"))?o.apply(t,[t,i]):{})&&(n(i.settings,a),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),r=!1,e(t).parents().each(function(){return!(r|="fixed"===e(this).css("position"))}),s={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),s=e.datepicker._checkOffset(i,s,r),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":r?"fixed":"absolute",display:"none",left:s.left+"px",top:s.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),d=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",function(e){for(var t,i;e.length&&e[0]!==document;){if(("absolute"===(t=e.css("position"))||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),d):i.dpDiv[l||"show"](l?d:null),e.datepicker._shouldFocusInput(i)&&i.input.trigger("focus"),e.datepicker._curInst=i)))},_updateDatepicker:function(t){this.maxRows=4,a=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,n=this._getNumberOfMonths(t),r=n[1],s=t.dpDiv.find("."+this._dayOverClass+" a");s.length>0&&o.apply(s.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),r>1&&t.dpDiv.addClass("ui-datepicker-multi-"+r).css("width",17*r+"em"),t.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.trigger("focus"),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,o){var n=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),r=t.input?t.input.outerWidth():0,s=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(o?0:e(document).scrollLeft()),d=document.documentElement.clientHeight+(o?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-r:0,i.left-=o&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=o&&i.top===t.input.offset().top+s?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>l&&l>n?Math.abs(i.left+n-l):0),i.top-=Math.min(i.top,i.top+a>d&&d>a?Math.abs(a+s):0),i},_findPos:function(t){for(var i,o=this._getInst(t),n=this._get(o,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return[(i=e(t).offset()).left,i.top]},_hideDatepicker:function(t){var i,o,n,a,r=this._curInst;!r||t&&r!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(r,"showAnim"),o=this._get(r,"duration"),n=function(){e.datepicker._tidyDialog(r)},e.effects&&(e.effects.effect[i]||e.effects[i])?r.dpDiv.hide(i,e.datepicker._get(r,"showOptions"),o,n):r.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?o:null,n),i||n(),this._datepickerShowing=!1,(a=this._get(r,"onClose"))&&a.apply(r.input?r.input[0]:null,[r.input?r.input.val():"",r]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),o=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==o)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,o){var n=e(t),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+("M"===o?this._get(a,"showCurrentAtPos"):0),o),this._updateDatepicker(a))},_gotoToday:function(t){var i,o=e(t),n=this._getInst(o[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(o)},_selectMonthYear:function(t,i,o){var n=e(t),a=this._getInst(n[0]);a["selected"+("M"===o?"Month":"Year")]=a["draw"+("M"===o?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(t,i,o,n){var a,r=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(r[0])||((a=this._getInst(r[0])).selectedDay=a.currentDay=e("a",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=o,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var o,n=e(t),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),(o=this._get(a,"onSelect"))?o.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(t){var i,o,n,a=this._get(t,"altField");a&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),o=this._getDate(t),n=this.formatDate(i,o,this._getFormatConfig(t)),e(a).val(n))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,o){if(null==t||null==i)throw"Invalid arguments";if(""===(i="object"==typeof i?""+i:i+""))return null;var n,a,r,s,l=0,d=(o?o.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof d?d:(new Date).getFullYear()%100+parseInt(d,10),u=(o?o.dayNamesShort:null)||this._defaults.dayNamesShort,h=(o?o.dayNames:null)||this._defaults.dayNames,p=(o?o.monthNamesShort:null)||this._defaults.monthNamesShort,f=(o?o.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,b=-1,y=!1,w=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},_=function(e){var t=w(e),o="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n=RegExp("^\\d{"+("y"===e?o:1)+","+o+"}"),a=i.substring(l).match(n);if(!a)throw"Missing number at position "+l;return l+=a[0].length,parseInt(a[0],10)},S=function(t,o,n){var a=-1,r=e.map(w(t)?n:o,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(r,function(e,t){var o=t[1];return i.substr(l,o.length).toLowerCase()===o.toLowerCase()?(a=t[0],l+=o.length,!1):void 0}),-1!==a)return a+1;throw"Unknown name at position "+l},C=function(){if(i.charAt(l)!==t.charAt(n))throw"Unexpected literal at position "+l;l++};for(n=0;t.length>n;n++)if(y)"'"!==t.charAt(n)||w("'")?C():y=!1;else switch(t.charAt(n)){case"d":v=_("d");break;case"D":S("D",u,h);break;case"o":b=_("o");break;case"m":g=_("m");break;case"M":g=S("M",p,f);break;case"y":m=_("y");break;case"@":m=(s=new Date(_("@"))).getFullYear(),g=s.getMonth()+1,v=s.getDate();break;case"!":m=(s=new Date((_("!")-this._ticksTo1970)/1e4)).getFullYear(),g=s.getMonth()+1,v=s.getDate();break;case"'":w("'")?C():y=!0;break;default:C()}if(i.length>l&&(r=i.substr(l),!/^\s+/.test(r)))throw"Extra/unparsed characters found in date: "+r;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c>=m?0:-100)),b>-1)for(g=1,v=b;!((a=this._getDaysInMonth(m,g-1))>=v);)g++,v-=a;if((s=this._daylightSavingAdjust(new Date(m,g-1,v))).getFullYear()!==m||s.getMonth()+1!==g||s.getDate()!==v)throw"Invalid date";return s},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var o,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,r=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,s=(i?i.monthNames:null)||this._defaults.monthNames,l=function(t){var i=e.length>o+1&&e.charAt(o+1)===t;return i&&o++,i},d=function(e,t,i){var o=""+t;if(l(e))for(;i>o.length;)o="0"+o;return o},c=function(e,t,i,o){return l(e)?o[t]:i[t]},u="",h=!1;if(t)for(o=0;e.length>o;o++)if(h)"'"!==e.charAt(o)||l("'")?u+=e.charAt(o):h=!1;else switch(e.charAt(o)){case"d":u+=d("d",t.getDate(),2);break;case"D":u+=c("D",t.getDay(),n,a);break;case"o":u+=d("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=d("m",t.getMonth()+1,2);break;case"M":u+=c("M",t.getMonth(),r,s);break;case"y":u+=l("y")?t.getFullYear():(10>t.getFullYear()%100?"0":"")+t.getFullYear()%100;break;case"@":u+=t.getTime();break;case"!":u+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":h=!0;break;default:u+=e.charAt(o)}return u},_possibleChars:function(e){var t,i="",o=!1,n=function(i){var o=e.length>t+1&&e.charAt(t+1)===i;return o&&t++,o};for(t=0;e.length>t;t++)if(o)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):o=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":o=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),o=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),a=n,r=this._getFormatConfig(e);try{a=this.parseDate(i,o,r)||n}catch(e){o=t?"":o}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=o?a.getDate():0,e.currentMonth=o?a.getMonth():0,e.currentYear=o?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,o){var n=null==i||""===i?o:"string"==typeof i?function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(e){}for(var o=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,n=o.getFullYear(),a=o.getMonth(),r=o.getDate(),s=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=s.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":a+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(n,a));break;case"y":case"Y":n+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(n,a))}l=s.exec(i)}return new Date(n,a,r)}(i):"number"==typeof i?isNaN(i)?o:function(e){var t=new Date;return t.setDate(t.getDate()+e),t}(i):new Date(i.getTime());return(n=n&&"Invalid Date"==""+n?o:n)&&(n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0)),this._daylightSavingAdjust(n)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var o=!t,n=e.selectedMonth,a=e.selectedYear,r=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=r.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=r.getMonth(),e.drawYear=e.selectedYear=e.currentYear=r.getFullYear(),n===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(o?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),o="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(o,-i,"M")},next:function(){e.datepicker._adjustDate(o,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(o)},selectDay:function(){return e.datepicker._selectDay(o,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(o,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(o,this,"Y"),!1}};e(this).on(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,o,n,a,r,s,l,d,c,u,h,p,f,m,g,v,b,y,w,_,S,C,k,T,$,x,E,A,L,I,M,D,O,P,R,N,B,j,F=new Date,H=this._daylightSavingAdjust(new Date(F.getFullYear(),F.getMonth(),F.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),G=this._get(e,"hideIfNoPrevNext"),V=this._get(e,"navigationAsDateFormat"),W=this._getNumberOfMonths(e),q=this._get(e,"showCurrentAtPos"),Y=this._get(e,"stepMonths"),X=1!==W[0]||1!==W[1],K=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),J=this._getMinMaxDate(e,"min"),Q=this._getMinMaxDate(e,"max"),Z=e.drawMonth-q,ee=e.drawYear;if(0>Z&&(Z+=12,ee--),Q)for(t=this._daylightSavingAdjust(new Date(Q.getFullYear(),Q.getMonth()-W[0]*W[1]+1,Q.getDate())),t=J&&J>t?J:t;this._daylightSavingAdjust(new Date(ee,Z,1))>t;)0>--Z&&(Z=11,ee--);for(e.drawMonth=Z,e.drawYear=ee,i=this._get(e,"prevText"),i=V?this.formatDate(i,this._daylightSavingAdjust(new Date(ee,Z-Y,1)),this._getFormatConfig(e)):i,o=this._canAdjustMonth(e,-1,ee,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+i+"</span></a>":G?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=V?this.formatDate(n,this._daylightSavingAdjust(new Date(ee,Z+Y,1)),this._getFormatConfig(e)):n,a=this._canAdjustMonth(e,1,ee,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+n+"</span></a>":G?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+n+"</span></a>",r=this._get(e,"currentText"),s=this._get(e,"gotoCurrent")&&e.currentDay?K:H,r=V?this.formatDate(r,s,this._getFormatConfig(e)):r,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",d=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?l:"")+(this._isInRange(e,s)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+r+"</button>":"")+(U?"":l)+"</div>":"",c=parseInt(this._get(e,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),b=this._get(e,"selectOtherMonths"),y=this._getDefaultDate(e),w="",S=0;W[0]>S;S++){for(C="",this.maxRows=4,k=0;W[1]>k;k++){if(T=this._daylightSavingAdjust(new Date(ee,Z,e.selectedDay)),$=" ui-corner-all",x="",X){if(x+="<div class='ui-datepicker-group",W[1]>1)switch(k){case 0:x+=" ui-datepicker-group-first",$=" ui-corner-"+(U?"right":"left");break;case W[1]-1:x+=" ui-datepicker-group-last",$=" ui-corner-"+(U?"left":"right");break;default:x+=" ui-datepicker-group-middle",$=""}x+="'>"}for(x+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+$+"'>"+(/all|left/.test($)&&0===S?U?a:o:"")+(/all|right/.test($)&&0===S?U?o:a:"")+this._generateMonthYearHeader(e,Z,ee,J,Q,S>0||k>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",E=u?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",_=0;7>_;_++)A=(_+c)%7,E+="<th scope='col'"+((_+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+h[A]+"'>"+p[A]+"</span></th>";for(x+=E+"</tr></thead><tbody>",L=this._getDaysInMonth(ee,Z),ee===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,L)),I=(this._getFirstDayOfMonth(ee,Z)-c+7)%7,M=Math.ceil((I+L)/7),D=X&&this.maxRows>M?this.maxRows:M,this.maxRows=D,O=this._daylightSavingAdjust(new Date(ee,Z,1-I)),P=0;D>P;P++){for(x+="<tr>",R=u?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(O)+"</td>":"",_=0;7>_;_++)N=g?g.apply(e.input?e.input[0]:null,[O]):[!0,""],j=(B=O.getMonth()!==Z)&&!b||!N[0]||J&&J>O||Q&&O>Q,R+="<td class='"+((_+c+6)%7>=5?" ui-datepicker-week-end":"")+(B?" ui-datepicker-other-month":"")+(O.getTime()===T.getTime()&&Z===e.selectedMonth&&e._keyEvent||y.getTime()===O.getTime()&&y.getTime()===T.getTime()?" "+this._dayOverClass:"")+(j?" "+this._unselectableClass+" ui-state-disabled":"")+(B&&!v?"":" "+N[1]+(O.getTime()===K.getTime()?" "+this._currentClass:"")+(O.getTime()===H.getTime()?" ui-datepicker-today":""))+"'"+(B&&!v||!N[2]?"":" title='"+N[2].replace(/'/g,"&#39;")+"'")+(j?"":" data-handler='selectDay' data-event='click' data-month='"+O.getMonth()+"' data-year='"+O.getFullYear()+"'")+">"+(B&&!v?"&#xa0;":j?"<span class='ui-state-default'>"+O.getDate()+"</span>":"<a class='ui-state-default"+(O.getTime()===H.getTime()?" ui-state-highlight":"")+(O.getTime()===K.getTime()?" ui-state-active":"")+(B?" ui-priority-secondary":"")+"' href='#'>"+O.getDate()+"</a>")+"</td>",O.setDate(O.getDate()+1),O=this._daylightSavingAdjust(O);x+=R+"</tr>"}++Z>11&&(Z=0,ee++),C+=x+="</tbody></table>"+(X?"</div>"+(W[0]>0&&k===W[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}w+=C}return w+=d,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,i,o,n,a,r,s){var l,d,c,u,h,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),b=this._get(e,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",w="";if(a||!g)w+="<span class='ui-datepicker-month'>"+r[t]+"</span>";else{for(l=o&&o.getFullYear()===i,d=n&&n.getFullYear()===i,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;12>c;c++)(!l||c>=o.getMonth())&&(!d||n.getMonth()>=c)&&(w+="<option value='"+c+"'"+(c===t?" selected='selected'":"")+">"+s[c]+"</option>");w+="</select>"}if(b||(y+=w+(!a&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",a||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),f=(p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t})(u[0]),m=Math.max(f,p(u[1]||"")),f=o?Math.max(f,o.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",y+=e.yearshtml,e.yearshtml=null}return y+=this._get(e,"yearSuffix"),b&&(y+=(!a&&g&&v?"":"&#xa0;")+w),y+"</div>"},_adjustInstDate:function(e,t,i){var o=e.selectedYear+("Y"===i?t:0),n=e.selectedMonth+("M"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(o,n))+("D"===i?t:0),r=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(o,n,a)));e.selectedDay=r.getDate(),e.drawMonth=e.selectedMonth=r.getMonth(),e.drawYear=e.selectedYear=r.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),o=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return o&&n>o?o:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,o){var n=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,o+(0>t?t:n[0]*n[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,o,n=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),r=null,s=null,l=this._get(e,"yearRange");return l&&(i=l.split(":"),o=(new Date).getFullYear(),r=parseInt(i[0],10),s=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(r+=o),i[1].match(/[+\-].*/)&&(s+=o)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!r||t.getFullYear()>=r)&&(!s||s>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,o){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(o,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).on("mousedown",e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new t,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.12.1",e.datepicker}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Popper={})}(this,function(e){"use strict";function t(e){var t=e.getBoundingClientRect();return{width:t.width,height:t.height,top:t.top,right:t.right,bottom:t.bottom,left:t.left,x:t.left,y:t.top}}function i(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function o(e){var t=i(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function n(e){return e instanceof i(e).Element||e instanceof Element}function a(e){return e instanceof i(e).HTMLElement||e instanceof HTMLElement}function r(e){return"undefined"!=typeof ShadowRoot&&(e instanceof i(e).ShadowRoot||e instanceof ShadowRoot)}function s(e){return e?(e.nodeName||"").toLowerCase():null}function l(e){return((n(e)?e.ownerDocument:e.document)||window.document).documentElement}function d(e){return t(l(e)).left+o(e).scrollLeft}function c(e){return i(e).getComputedStyle(e)}function u(e){var t=c(e),i=t.overflow,o=t.overflowX,n=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+n+o)}function h(e,n,r){void 0===r&&(r=!1);var c,h,p=l(n),f=t(e),m=a(n),g={scrollLeft:0,scrollTop:0},v={x:0,y:0};return(m||!m&&!r)&&(("body"!==s(n)||u(p))&&(g=(c=n)!==i(c)&&a(c)?{scrollLeft:(h=c).scrollLeft,scrollTop:h.scrollTop}:o(c)),a(n)?((v=t(n)).x+=n.clientLeft,v.y+=n.clientTop):p&&(v.x=d(p))),{x:f.left+g.scrollLeft-v.x,y:f.top+g.scrollTop-v.y,width:f.width,height:f.height}}function p(e){var i=t(e),o=e.offsetWidth,n=e.offsetHeight;return Math.abs(i.width-o)<=1&&(o=i.width),Math.abs(i.height-n)<=1&&(n=i.height),{x:e.offsetLeft,y:e.offsetTop,width:o,height:n}}function f(e){return"html"===s(e)?e:e.assignedSlot||e.parentNode||(r(e)?e.host:null)||l(e)}function m(e,t){var o;void 0===t&&(t=[]);var n=function e(t){return["html","body","#document"].indexOf(s(t))>=0?t.ownerDocument.body:a(t)&&u(t)?t:e(f(t))}(e),r=n===(null==(o=e.ownerDocument)?void 0:o.body),l=i(n),d=r?[l].concat(l.visualViewport||[],u(n)?n:[]):n,c=t.concat(d);return r?c:c.concat(m(f(d)))}function g(e){return["table","td","th"].indexOf(s(e))>=0}function v(e){return a(e)&&"fixed"!==c(e).position?e.offsetParent:null}function b(e){for(var t=i(e),o=v(e);o&&g(o)&&"static"===c(o).position;)o=v(o);return o&&("html"===s(o)||"body"===s(o)&&"static"===c(o).position)?t:o||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&a(e)&&"fixed"===c(e).position)return null;for(var i=f(e);a(i)&&["html","body"].indexOf(s(i))<0;){var o=c(i);if("none"!==o.transform||"none"!==o.perspective||"paint"===o.contain||-1!==["transform","perspective"].indexOf(o.willChange)||t&&"filter"===o.willChange||t&&o.filter&&"none"!==o.filter)return i;i=i.parentNode}return null}(e)||t}var y="top",w="bottom",_="right",S="left",C="auto",k=[y,w,_,S],T="start",$="end",x="clippingParents",E="viewport",A="popper",L="reference",I=k.reduce(function(e,t){return e.concat([t+"-"+T,t+"-"+$])},[]),M=[].concat(k,[C]).reduce(function(e,t){return e.concat([t,t+"-"+T,t+"-"+$])},[]),D=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function O(e){var t=new Map,i=new Set,o=[];return e.forEach(function(e){t.set(e.name,e)}),e.forEach(function(e){i.has(e.name)||function e(n){i.add(n.name),[].concat(n.requires||[],n.requiresIfExists||[]).forEach(function(o){if(!i.has(o)){var n=t.get(o);n&&e(n)}}),o.push(n)}(e)}),o}function P(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return[].concat(i).reduce(function(e,t){return e.replace(/%s/,t)},e)}var R='Popper: modifier "%s" provided an invalid %s property, expected %s but got %s',N='Popper: modifier "%s" requires "%s", but "%s" modifier is not available',B=["name","enabled","phase","fn","effect","requires","options"];function j(e){return e.split("-")[0]}var F=Math.max,H=Math.min,U=Math.round;function z(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&r(i)){var o=t;do{if(o&&e.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function G(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function V(e,n){return n===E?G(function(e){var t=i(e),o=l(e),n=t.visualViewport,a=o.clientWidth,r=o.clientHeight,s=0,c=0;return n&&(a=n.width,r=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(s=n.offsetLeft,c=n.offsetTop)),{width:a,height:r,x:s+d(e),y:c}}(e)):a(n)?function(e){var i=t(e);return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}(n):G(function(e){var t,i=l(e),n=o(e),a=null==(t=e.ownerDocument)?void 0:t.body,r=F(i.scrollWidth,i.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),s=F(i.scrollHeight,i.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),u=-n.scrollLeft+d(e),h=-n.scrollTop;return"rtl"===c(a||i).direction&&(u+=F(i.clientWidth,a?a.clientWidth:0)-r),{width:r,height:s,x:u,y:h}}(l(e)))}function W(e,t,i){var o="clippingParents"===t?function(e){var t=m(f(e)),i=["absolute","fixed"].indexOf(c(e).position)>=0&&a(e)?b(e):e;return n(i)?t.filter(function(e){return n(e)&&z(e,i)&&"body"!==s(e)}):[]}(e):[].concat(t),r=[].concat(o,[i]),l=r[0],d=r.reduce(function(t,i){var o=V(e,i);return t.top=F(o.top,t.top),t.right=H(o.right,t.right),t.bottom=H(o.bottom,t.bottom),t.left=F(o.left,t.left),t},V(e,l));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function q(e){return e.split("-")[1]}function Y(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function X(e){var t,i=e.reference,o=e.element,n=e.placement,a=n?j(n):null,r=n?q(n):null,s=i.x+i.width/2-o.width/2,l=i.y+i.height/2-o.height/2;switch(a){case y:t={x:s,y:i.y-o.height};break;case w:t={x:s,y:i.y+i.height};break;case _:t={x:i.x+i.width,y:l};break;case S:t={x:i.x-o.width,y:l};break;default:t={x:i.x,y:i.y}}var d=a?Y(a):null;if(null!=d){var c="y"===d?"height":"width";switch(r){case T:t[d]=t[d]-(i[c]/2-o[c]/2);break;case $:t[d]=t[d]+(i[c]/2-o[c]/2)}}return t}function K(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function J(e,t){return t.reduce(function(t,i){return t[i]=e,t},{})}function Q(e,i){void 0===i&&(i={});var o=i,a=o.placement,r=void 0===a?e.placement:a,s=o.boundary,d=void 0===s?x:s,c=o.rootBoundary,u=void 0===c?E:c,h=o.elementContext,p=void 0===h?A:h,f=o.altBoundary,m=void 0!==f&&f,g=o.padding,v=void 0===g?0:g,b=K("number"!=typeof v?v:J(v,k)),S=p===A?L:A,C=e.elements.reference,T=e.rects.popper,$=e.elements[m?S:p],I=W(n($)?$:$.contextElement||l(e.elements.popper),d,u),M=t(C),D=X({reference:M,element:T,strategy:"absolute",placement:r}),O=G(Object.assign({},T,D)),P=p===A?O:M,R={top:I.top-P.top+b.top,bottom:P.bottom-I.bottom+b.bottom,left:I.left-P.left+b.left,right:P.right-I.right+b.right},N=e.modifiersData.offset;if(p===A&&N){var B=N[r];Object.keys(R).forEach(function(e){var t=[_,w].indexOf(e)>=0?1:-1,i=[y,w].indexOf(e)>=0?"y":"x";R[e]+=B[i]*t})}return R}var Z="Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.",ee="Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.",te={placement:"bottom",modifiers:[],strategy:"absolute"};function ie(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}function oe(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,o=void 0===i?[]:i,a=t.defaultOptions,r=void 0===a?te:a;return function(e,t,i){void 0===i&&(i=r);var a,s,l={placement:"bottom",orderedModifiers:[],options:Object.assign({},te,r),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},d=[],u=!1,f={state:l,setOptions:function(i){g(),l.options=Object.assign({},r,l.options,i),l.scrollParents={reference:n(e)?m(e):e.contextElement?m(e.contextElement):[],popper:m(t)};var a=function(e){var t=O(e);return D.reduce(function(e,i){return e.concat(t.filter(function(e){return e.phase===i}))},[])}(function(e){var t=e.reduce(function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e},{});return Object.keys(t).map(function(e){return t[e]})}([].concat(o,l.options.modifiers)));(l.orderedModifiers=a.filter(function(e){return e.enabled}),function(e){e.forEach(function(t){Object.keys(t).forEach(function(i){switch(i){case"name":"string"!=typeof t.name&&console.error(P(R,String(t.name),'"name"','"string"','"'+String(t.name)+'"'));break;case"enabled":"boolean"!=typeof t.enabled&&console.error(P(R,t.name,'"enabled"','"boolean"','"'+String(t.enabled)+'"'));case"phase":D.indexOf(t.phase)<0&&console.error(P(R,t.name,'"phase"',"either "+D.join(", "),'"'+String(t.phase)+'"'));break;case"fn":"function"!=typeof t.fn&&console.error(P(R,t.name,'"fn"','"function"','"'+String(t.fn)+'"'));break;case"effect":"function"!=typeof t.effect&&console.error(P(R,t.name,'"effect"','"function"','"'+String(t.fn)+'"'));break;case"requires":Array.isArray(t.requires)||console.error(P(R,t.name,'"requires"','"array"','"'+String(t.requires)+'"'));break;case"requiresIfExists":Array.isArray(t.requiresIfExists)||console.error(P(R,t.name,'"requiresIfExists"','"array"','"'+String(t.requiresIfExists)+'"'));break;case"options":case"data":break;default:console.error('PopperJS: an invalid property has been provided to the "'+t.name+'" modifier, valid properties are '+B.map(function(e){return'"'+e+'"'}).join(", ")+'; but "'+i+'" was provided.')}t.requires&&t.requires.forEach(function(i){null==e.find(function(e){return e.name===i})&&console.error(P(N,String(t.name),i,i))})})})}((s=[].concat(a,l.options.modifiers),u=function(e){return e.name},h=new Set,s.filter(function(e){var t=u(e);if(!h.has(t))return h.add(t),!0}))),j(l.options.placement)===C)&&(l.orderedModifiers.find(function(e){return"flip"===e.name})||console.error(['Popper: "auto" placements require the "flip" modifier be',"present and enabled to work."].join(" ")));var s,u,h,p=c(t);return[p.marginTop,p.marginRight,p.marginBottom,p.marginLeft].some(function(e){return parseFloat(e)})&&console.warn(['Popper: CSS "margin" styles cannot be used to apply padding',"between the popper and its reference element or boundary.","To replicate margin, use the `offset` modifier, as well as","the `padding` option in the `preventOverflow` and `flip`","modifiers."].join(" ")),l.orderedModifiers.forEach(function(e){var t=e.name,i=e.options,o=void 0===i?{}:i,n=e.effect;if("function"==typeof n){var a=n({state:l,name:t,instance:f,options:o});d.push(a||function(){})}}),f.update()},forceUpdate:function(){if(!u){var e=l.elements,t=e.reference,i=e.popper;if(ie(t,i)){l.rects={reference:h(t,b(i),"fixed"===l.options.strategy),popper:p(i)},l.reset=!1,l.placement=l.options.placement,l.orderedModifiers.forEach(function(e){return l.modifiersData[e.name]=Object.assign({},e.data)});for(var o=0,n=0;n<l.orderedModifiers.length;n++){if((o+=1)>100){console.error(ee);break}if(!0!==l.reset){var a=l.orderedModifiers[n],r=a.fn,s=a.options,d=void 0===s?{}:s,c=a.name;"function"==typeof r&&(l=r({state:l,options:d,name:c,instance:f})||l)}else l.reset=!1,n=-1}}else console.error(Z)}},update:(a=function(){return new Promise(function(e){f.forceUpdate(),e(l)})},function(){return s||(s=new Promise(function(e){Promise.resolve().then(function(){s=void 0,e(a())})})),s}),destroy:function(){g(),u=!0}};if(!ie(e,t))return console.error(Z),f;function g(){d.forEach(function(e){return e()}),d=[]}return f.setOptions(i).then(function(e){!u&&i.onFirstUpdate&&i.onFirstUpdate(e)}),f}}var ne={passive:!0};var ae={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,o=e.instance,n=e.options,a=n.scroll,r=void 0===a||a,s=n.resize,l=void 0===s||s,d=i(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return r&&c.forEach(function(e){e.addEventListener("scroll",o.update,ne)}),l&&d.addEventListener("resize",o.update,ne),function(){r&&c.forEach(function(e){e.removeEventListener("scroll",o.update,ne)}),l&&d.removeEventListener("resize",o.update,ne)}},data:{}};var re={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=X({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},se={top:"auto",right:"auto",bottom:"auto",left:"auto"};function le(e){var t,o=e.popper,n=e.popperRect,a=e.placement,r=e.offsets,s=e.position,d=e.gpuAcceleration,u=e.adaptive,h=e.roundOffsets,p=!0===h?function(e){var t=e.x,i=e.y,o=window.devicePixelRatio||1;return{x:U(U(t*o)/o)||0,y:U(U(i*o)/o)||0}}(r):"function"==typeof h?h(r):r,f=p.x,m=void 0===f?0:f,g=p.y,v=void 0===g?0:g,C=r.hasOwnProperty("x"),k=r.hasOwnProperty("y"),T=S,$=y,x=window;if(u){var E=b(o),A="clientHeight",L="clientWidth";E===i(o)&&"static"!==c(E=l(o)).position&&(A="scrollHeight",L="scrollWidth"),E=E,a===y&&($=w,v-=E[A]-n.height,v*=d?1:-1),a===S&&(T=_,m-=E[L]-n.width,m*=d?1:-1)}var I,M=Object.assign({position:s},u&&se);return d?Object.assign({},M,((I={})[$]=k?"0":"",I[T]=C?"0":"",I.transform=(x.devicePixelRatio||1)<2?"translate("+m+"px, "+v+"px)":"translate3d("+m+"px, "+v+"px, 0)",I)):Object.assign({},M,((t={})[$]=k?v+"px":"",t[T]=C?m+"px":"",t.transform="",t))}var de={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,o=i.gpuAcceleration,n=void 0===o||o,a=i.adaptive,r=void 0===a||a,s=i.roundOffsets,l=void 0===s||s,d=c(t.elements.popper).transitionProperty||"";r&&["transform","top","right","bottom","left"].some(function(e){return d.indexOf(e)>=0})&&console.warn(["Popper: Detected CSS transitions on at least one of the following",'CSS properties: "transform", "top", "right", "bottom", "left".',"\n\n",'Disable the "computeStyles" modifier\'s `adaptive` option to allow',"for smooth transitions, or remove these properties from the CSS","transition declaration on the popper element if only transitioning","opacity or background-color for example.","\n\n","We recommend using the popper element as a wrapper around an inner","element that can have any CSS property transitioned for animations."].join(" "));var u={placement:j(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:n};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,le(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:r,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,le(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var ce={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach(function(e){var i=t.styles[e]||{},o=t.attributes[e]||{},n=t.elements[e];a(n)&&s(n)&&(Object.assign(n.style,i),Object.keys(o).forEach(function(e){var t=o[e];!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(e){var o=t.elements[e],n=t.attributes[e]||{},r=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:i[e]).reduce(function(e,t){return e[t]="",e},{});a(o)&&s(o)&&(Object.assign(o.style,r),Object.keys(n).forEach(function(e){o.removeAttribute(e)}))})}},requires:["computeStyles"]};var ue={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,i=e.options,o=e.name,n=i.offset,a=void 0===n?[0,0]:n,r=M.reduce(function(e,i){return e[i]=function(e,t,i){var o=j(e),n=[S,y].indexOf(o)>=0?-1:1,a="function"==typeof i?i(Object.assign({},t,{placement:e})):i,r=a[0],s=a[1];return r=r||0,s=(s||0)*n,[S,_].indexOf(o)>=0?{x:s,y:r}:{x:r,y:s}}(i,t.rects,a),e},{}),s=r[t.placement],l=s.x,d=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=d),t.modifiersData[o]=r}},he={left:"right",right:"left",bottom:"top",top:"bottom"};function pe(e){return e.replace(/left|right|bottom|top/g,function(e){return he[e]})}var fe={start:"end",end:"start"};function me(e){return e.replace(/start|end/g,function(e){return fe[e]})}function ge(e,t){void 0===t&&(t={});var i=t,o=i.placement,n=i.boundary,a=i.rootBoundary,r=i.padding,s=i.flipVariations,l=i.allowedAutoPlacements,d=void 0===l?M:l,c=q(o),u=c?s?I:I.filter(function(e){return q(e)===c}):k,h=u.filter(function(e){return d.indexOf(e)>=0});0===h.length&&(h=u,console.error(["Popper: The `allowedAutoPlacements` option did not allow any","placements. Ensure the `placement` option matches the variation","of the allowed placements.",'For example, "auto" cannot be used to allow "bottom-start".','Use "auto-start" instead.'].join(" ")));var p=h.reduce(function(t,i){return t[i]=Q(e,{placement:i,boundary:n,rootBoundary:a,padding:r})[j(i)],t},{});return Object.keys(p).sort(function(e,t){return p[e]-p[t]})}var ve={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,o=e.name;if(!t.modifiersData[o]._skip){for(var n=i.mainAxis,a=void 0===n||n,r=i.altAxis,s=void 0===r||r,l=i.fallbackPlacements,d=i.padding,c=i.boundary,u=i.rootBoundary,h=i.altBoundary,p=i.flipVariations,f=void 0===p||p,m=i.allowedAutoPlacements,g=t.options.placement,v=j(g),b=l||(v!==g&&f?function(e){if(j(e)===C)return[];var t=pe(e);return[me(e),t,me(t)]}(g):[pe(g)]),k=[g].concat(b).reduce(function(e,i){return e.concat(j(i)===C?ge(t,{placement:i,boundary:c,rootBoundary:u,padding:d,flipVariations:f,allowedAutoPlacements:m}):i)},[]),$=t.rects.reference,x=t.rects.popper,E=new Map,A=!0,L=k[0],I=0;I<k.length;I++){var M=k[I],D=j(M),O=q(M)===T,P=[y,w].indexOf(D)>=0,R=P?"width":"height",N=Q(t,{placement:M,boundary:c,rootBoundary:u,altBoundary:h,padding:d}),B=P?O?_:S:O?w:y;$[R]>x[R]&&(B=pe(B));var F=pe(B),H=[];if(a&&H.push(N[D]<=0),s&&H.push(N[B]<=0,N[F]<=0),H.every(function(e){return e})){L=M,A=!1;break}E.set(M,H)}if(A)for(var U=function(e){var t=k.find(function(t){var i=E.get(t);if(i)return i.slice(0,e).every(function(e){return e})});if(t)return L=t,"break"},z=f?3:1;z>0&&"break"!==U(z);z--);t.placement!==L&&(t.modifiersData[o]._skip=!0,t.placement=L,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function be(e,t,i){return F(e,H(t,i))}var ye={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,o=e.name,n=i.mainAxis,a=void 0===n||n,r=i.altAxis,s=void 0!==r&&r,l=i.boundary,d=i.rootBoundary,c=i.altBoundary,u=i.padding,h=i.tether,f=void 0===h||h,m=i.tetherOffset,g=void 0===m?0:m,v=Q(t,{boundary:l,rootBoundary:d,padding:u,altBoundary:c}),C=j(t.placement),k=q(t.placement),$=!k,x=Y(C),E="x"===x?"y":"x",A=t.modifiersData.popperOffsets,L=t.rects.reference,I=t.rects.popper,M="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,D={x:0,y:0};if(A){if(a||s){var O="y"===x?y:S,P="y"===x?w:_,R="y"===x?"height":"width",N=A[x],B=A[x]+v[O],U=A[x]-v[P],z=f?-I[R]/2:0,G=k===T?L[R]:I[R],V=k===T?-I[R]:-L[R],W=t.elements.arrow,X=f&&W?p(W):{width:0,height:0},K=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},J=K[O],Z=K[P],ee=be(0,L[R],X[R]),te=$?L[R]/2-z-ee-J-M:G-ee-J-M,ie=$?-L[R]/2+z+ee+Z+M:V+ee+Z+M,oe=t.elements.arrow&&b(t.elements.arrow),ne=oe?"y"===x?oe.clientTop||0:oe.clientLeft||0:0,ae=t.modifiersData.offset?t.modifiersData.offset[t.placement][x]:0,re=A[x]+te-ae-ne,se=A[x]+ie-ae;if(a){var le=be(f?H(B,re):B,N,f?F(U,se):U);A[x]=le,D[x]=le-N}if(s){var de="x"===x?y:S,ce="x"===x?w:_,ue=A[E],he=ue+v[de],pe=ue-v[ce],fe=be(f?H(he,re):he,ue,f?F(pe,se):pe);A[E]=fe,D[E]=fe-ue}}t.modifiersData[o]=D}},requiresIfExists:["offset"]},we=function(e,t){return K("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:J(e,k))};var _e={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,o=e.name,n=e.options,a=i.elements.arrow,r=i.modifiersData.popperOffsets,s=j(i.placement),l=Y(s),d=[S,_].indexOf(s)>=0?"height":"width";if(a&&r){var c=we(n.padding,i),u=p(a),h="y"===l?y:S,f="y"===l?w:_,m=i.rects.reference[d]+i.rects.reference[l]-r[l]-i.rects.popper[d],g=r[l]-i.rects.reference[l],v=b(a),C=v?"y"===l?v.clientHeight||0:v.clientWidth||0:0,k=m/2-g/2,T=c[h],$=C-u[d]-c[f],x=C/2-u[d]/2+k,E=be(T,x,$),A=l;i.modifiersData[o]=((t={})[A]=E,t.centerOffset=E-x,t)}},effect:function(e){var t=e.state,i=e.options.element,o=void 0===i?"[data-popper-arrow]":i;null!=o&&("string"!=typeof o||(o=t.elements.popper.querySelector(o)))&&(a(o)||console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).',"To use an SVG arrow, wrap it in an HTMLElement that will be used as","the arrow."].join(" ")),z(t.elements.popper,o)?t.elements.arrow=o:console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper',"element."].join(" ")))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Se(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function Ce(e){return[y,_,w,S].some(function(t){return e[t]>=0})}var ke={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,o=t.rects.reference,n=t.rects.popper,a=t.modifiersData.preventOverflow,r=Q(t,{elementContext:"reference"}),s=Q(t,{altBoundary:!0}),l=Se(r,o),d=Se(s,n,a),c=Ce(l),u=Ce(d);t.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:d,isReferenceHidden:c,hasPopperEscaped:u},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":u})}},Te=oe({defaultModifiers:[ae,re,de,ce]}),$e=[ae,re,de,ce,ue,ve,ye,_e,ke],xe=oe({defaultModifiers:$e});e.applyStyles=ce,e.arrow=_e,e.computeStyles=de,e.createPopper=xe,e.createPopperLite=Te,e.defaultModifiers=$e,e.detectOverflow=Q,e.eventListeners=ae,e.flip=ve,e.hide=ke,e.offset=ue,e.popperGenerator=oe,e.popperOffsets=re,e.preventOverflow=ye,Object.defineProperty(e,"__esModule",{value:!0})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@popperjs/core")):"function"==typeof define&&define.amd?define(["@popperjs/core"],t):(e=e||self).tippy=t(e.Popper)}(this,function(e){"use strict";var t="undefined"!=typeof window&&"undefined"!=typeof document,i=t?navigator.userAgent:"",o=/MSIE |Trident\//.test(i),n="tippy-box",a="tippy-content",r="tippy-backdrop",s="tippy-arrow",l="tippy-svg-arrow",d={passive:!0,capture:!0};function c(e,t,i){if(Array.isArray(e)){var o=e[t];return null==o?Array.isArray(i)?i[t]:i:o}return e}function u(e,t){var i={}.toString.call(e);return 0===i.indexOf("[object")&&i.indexOf(t+"]")>-1}function h(e,t){return"function"==typeof e?e.apply(void 0,t):e}function p(e,t){return 0===t?e:function(o){clearTimeout(i),i=setTimeout(function(){e(o)},t)};var i}function f(e,t){var i=Object.assign({},e);return t.forEach(function(e){delete i[e]}),i}function m(e){return[].concat(e)}function g(e,t){-1===e.indexOf(t)&&e.push(t)}function v(e){return e.split("-")[0]}function b(e){return[].slice.call(e)}function y(){return document.createElement("div")}function w(e){return["Element","Fragment"].some(function(t){return u(e,t)})}function _(e){return u(e,"MouseEvent")}function S(e){return!(!e||!e._tippy||e._tippy.reference!==e)}function C(e){return w(e)?[e]:function(e){return u(e,"NodeList")}(e)?b(e):Array.isArray(e)?e:b(document.querySelectorAll(e))}function k(e,t){e.forEach(function(e){e&&(e.style.transitionDuration=t+"ms")})}function T(e,t){e.forEach(function(e){e&&e.setAttribute("data-state",t)})}function $(e){var t,i=m(e)[0];return(null==i?void 0:null==(t=i.ownerDocument)?void 0:t.body)?i.ownerDocument:document}function x(e,t,i){var o=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(t){e[o](t,i)})}var E,A={isTouch:!1},L=0;function I(){A.isTouch||(A.isTouch=!0,window.performance&&document.addEventListener("mousemove",M))}function M(){var e=performance.now();e-L<20&&(A.isTouch=!1,document.removeEventListener("mousemove",M)),L=e}function D(){var e=document.activeElement;if(S(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function O(e){return[e+"() was called on a"+("destroy"===e?"n already-":" ")+"destroyed instance. This is a no-op but","indicates a potential memory leak."].join(" ")}function P(e){return e.replace(/[ \t]{2,}/g," ").replace(/^[ \t]*/gm,"").trim()}function R(e){return[function(e){return P("\n  %ctippy.js\n\n  %c"+P(e)+"\n\n  %c👷‍ This is a development-only message. It will be removed in production.\n  ")}(e),"color: #00C584; font-size: 1.3em; font-weight: bold;","line-height: 1.5","color: #a6a095;"]}function N(e,t){var i;e&&!E.has(t)&&(E.add(t),(i=console).warn.apply(i,R(t)))}function B(e,t){var i;e&&!E.has(t)&&(E.add(t),(i=console).error.apply(i,R(t)))}E=new Set;var j={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},F=Object.assign({appendTo:function(){return document.body},aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},j,{},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),H=Object.keys(F);function U(e){var t=(e.plugins||[]).reduce(function(t,i){var o=i.name,n=i.defaultValue;return o&&(t[o]=void 0!==e[o]?e[o]:n),t},{});return Object.assign({},e,{},t)}function z(e,t){var i=Object.assign({},t,{content:h(t.content,[e])},t.ignoreAttributes?{}:function(e,t){return(t?Object.keys(U(Object.assign({},F,{plugins:t}))):H).reduce(function(t,i){var o=(e.getAttribute("data-tippy-"+i)||"").trim();if(!o)return t;if("content"===i)t[i]=o;else try{t[i]=JSON.parse(o)}catch(e){t[i]=o}return t},{})}(e,t.plugins));return i.aria=Object.assign({},F.aria,{},i.aria),i.aria={expanded:"auto"===i.aria.expanded?t.interactive:i.aria.expanded,content:"auto"===i.aria.content?t.interactive?null:"describedby":i.aria.content},i}function G(e,t){void 0===e&&(e={}),void 0===t&&(t=[]),Object.keys(e).forEach(function(e){var i,o,n=f(F,Object.keys(j)),a=(i=n,o=e,!{}.hasOwnProperty.call(i,o));a&&(a=0===t.filter(function(t){return t.name===e}).length),N(a,["`"+e+"`","is not a valid prop. You may have spelled it incorrectly, or if it's","a plugin, forgot to pass it in an array as props.plugins.","\n\n","All props: https://atomiks.github.io/tippyjs/v6/all-props/\n","Plugins: https://atomiks.github.io/tippyjs/v6/plugins/"].join(" "))})}var V=function(){return"innerHTML"};function W(e,t){e[V()]=t}function q(e){var t=y();return!0===e?t.className=s:(t.className=l,w(e)?t.appendChild(e):W(t,e)),t}function Y(e,t){w(t.content)?(W(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?W(e,t.content):e.textContent=t.content)}function X(e){var t=e.firstElementChild,i=b(t.children);return{box:t,content:i.find(function(e){return e.classList.contains(a)}),arrow:i.find(function(e){return e.classList.contains(s)||e.classList.contains(l)}),backdrop:i.find(function(e){return e.classList.contains(r)})}}function K(e){var t=y(),i=y();i.className=n,i.setAttribute("data-state","hidden"),i.setAttribute("tabindex","-1");var o=y();function r(i,o){var n=X(t),a=n.box,r=n.content,s=n.arrow;o.theme?a.setAttribute("data-theme",o.theme):a.removeAttribute("data-theme"),"string"==typeof o.animation?a.setAttribute("data-animation",o.animation):a.removeAttribute("data-animation"),o.inertia?a.setAttribute("data-inertia",""):a.removeAttribute("data-inertia"),a.style.maxWidth="number"==typeof o.maxWidth?o.maxWidth+"px":o.maxWidth,o.role?a.setAttribute("role",o.role):a.removeAttribute("role"),i.content===o.content&&i.allowHTML===o.allowHTML||Y(r,e.props),o.arrow?s?i.arrow!==o.arrow&&(a.removeChild(s),a.appendChild(q(o.arrow))):a.appendChild(q(o.arrow)):s&&a.removeChild(s)}return o.className=a,o.setAttribute("data-state","hidden"),Y(o,e.props),t.appendChild(i),i.appendChild(o),r(e.props,e.props),{popper:t,onUpdate:r}}K.$$tippy=!0;var J=1,Q=[],Z=[];function ee(t,i){var n,a,r,s,l,u,f,w,S,C=z(t,Object.assign({},F,{},U((n=i,Object.keys(n).reduce(function(e,t){return void 0!==n[t]&&(e[t]=n[t]),e},{}))))),E=!1,L=!1,I=!1,M=!1,D=[],P=p(_e,C.interactiveDebounce),R=J++,j=(S=C.plugins).filter(function(e,t){return S.indexOf(e)===t}),H={id:R,reference:t,popper:y(),popperInstance:null,props:C,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:j,clearDelayTimeouts:function(){clearTimeout(a),clearTimeout(r),cancelAnimationFrame(s)},setProps:function(e){if(N(H.state.isDestroyed,O("setProps")),H.state.isDestroyed)return;se("onBeforeUpdate",[H,e]),ye();var i=H.props,o=z(t,Object.assign({},H.props,{},e,{ignoreAttributes:!0}));H.props=o,be(),i.interactiveDebounce!==o.interactiveDebounce&&(ce(),P=p(_e,o.interactiveDebounce));i.triggerTarget&&!o.triggerTarget?m(i.triggerTarget).forEach(function(e){e.removeAttribute("aria-expanded")}):o.triggerTarget&&t.removeAttribute("aria-expanded");de(),re(),W&&W(i,o);H.popperInstance&&(Te(),xe().forEach(function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)}));se("onAfterUpdate",[H,e])},setContent:function(e){H.setProps({content:e})},show:function(){N(H.state.isDestroyed,O("show"));var e=H.state.isVisible,t=H.state.isDestroyed,i=!H.state.isEnabled,o=A.isTouch&&!H.props.touch,n=c(H.props.duration,0,F.duration);if(e||t||i||o)return;if(ie().hasAttribute("disabled"))return;if(se("onShow",[H],!1),!1===H.props.onShow(H))return;H.state.isVisible=!0,te()&&(V.style.visibility="visible");re(),fe(),H.state.isMounted||(V.style.transition="none");if(te()){var a=ne(),r=a.box,s=a.content;k([r,s],0)}f=function(){var e;if(H.state.isVisible&&!M){if(M=!0,V.offsetHeight,V.style.transition=H.props.moveTransition,te()&&H.props.animation){var t=ne(),i=t.box,o=t.content;k([i,o],n),T([i,o],"visible")}le(),de(),g(Z,H),null==(e=H.popperInstance)||e.forceUpdate(),H.state.isMounted=!0,se("onMount",[H]),H.props.animation&&te()&&function(e,t){ge(e,t)}(n,function(){H.state.isShown=!0,se("onShown",[H])})}},function(){var e,t=H.props.appendTo,i=ie();e=H.props.interactive&&t===F.appendTo||"parent"===t?i.parentNode:h(t,[i]);e.contains(V)||e.appendChild(V);Te(),N(H.props.interactive&&t===F.appendTo&&i.nextElementSibling!==V,["Interactive tippy element may not be accessible via keyboard","navigation because it is not directly after the reference element","in the DOM source order.","\n\n","Using a wrapper <div> or <span> tag around the reference element","solves this by creating a new parentNode context.","\n\n","Specifying `appendTo: document.body` silences this warning, but it","assumes you are using a focus management solution to handle","keyboard navigation.","\n\n","See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity"].join(" "))}()},hide:function(){N(H.state.isDestroyed,O("hide"));var e=!H.state.isVisible,t=H.state.isDestroyed,i=!H.state.isEnabled,o=c(H.props.duration,1,F.duration);if(e||t||i)return;if(se("onHide",[H],!1),!1===H.props.onHide(H))return;H.state.isVisible=!1,H.state.isShown=!1,M=!1,E=!1,te()&&(V.style.visibility="hidden");if(ce(),me(),re(),te()){var n=ne(),a=n.box,r=n.content;H.props.animation&&(k([a,r],o),T([a,r],"hidden"))}le(),de(),H.props.animation?te()&&function(e,t){ge(e,function(){!H.state.isVisible&&V.parentNode&&V.parentNode.contains(V)&&t()})}(o,H.unmount):H.unmount()},hideWithInteractivity:function(e){N(H.state.isDestroyed,O("hideWithInteractivity")),oe().addEventListener("mousemove",P),g(Q,P),P(e)},enable:function(){H.state.isEnabled=!0},disable:function(){H.hide(),H.state.isEnabled=!1},unmount:function(){N(H.state.isDestroyed,O("unmount")),H.state.isVisible&&H.hide();if(!H.state.isMounted)return;$e(),xe().forEach(function(e){e._tippy.unmount()}),V.parentNode&&V.parentNode.removeChild(V);Z=Z.filter(function(e){return e!==H}),H.state.isMounted=!1,se("onHidden",[H])},destroy:function(){if(N(H.state.isDestroyed,O("destroy")),H.state.isDestroyed)return;H.clearDelayTimeouts(),H.unmount(),ye(),delete t._tippy,H.state.isDestroyed=!0,se("onDestroy",[H])}};if(!C.render)return B(!0,"render() function has not been supplied."),H;var G=C.render(H),V=G.popper,W=G.onUpdate;V.setAttribute("data-tippy-root",""),V.id="tippy-"+H.id,H.popper=V,t._tippy=H,V._tippy=H;var q=j.map(function(e){return e.fn(H)}),Y=t.hasAttribute("aria-expanded");return be(),de(),re(),se("onCreate",[H]),C.showOnCreate&&Ee(),V.addEventListener("mouseenter",function(){H.props.interactive&&H.state.isVisible&&H.clearDelayTimeouts()}),V.addEventListener("mouseleave",function(e){H.props.interactive&&H.props.trigger.indexOf("mouseenter")>=0&&(oe().addEventListener("mousemove",P),P(e))}),H;function K(){var e=H.props.touch;return Array.isArray(e)?e:[e,0]}function ee(){return"hold"===K()[0]}function te(){var e;return!!(null==(e=H.props.render)?void 0:e.$$tippy)}function ie(){return w||t}function oe(){var e=ie().parentNode;return e?$(e):document}function ne(){return X(V)}function ae(e){return H.state.isMounted&&!H.state.isVisible||A.isTouch||l&&"focus"===l.type?0:c(H.props.delay,e?0:1,F.delay)}function re(){V.style.pointerEvents=H.props.interactive&&H.state.isVisible?"":"none",V.style.zIndex=""+H.props.zIndex}function se(e,t,i){var o;(void 0===i&&(i=!0),q.forEach(function(i){i[e]&&i[e].apply(void 0,t)}),i)&&(o=H.props)[e].apply(o,t)}function le(){var e=H.props.aria;if(e.content){var i="aria-"+e.content,o=V.id;m(H.props.triggerTarget||t).forEach(function(e){var t=e.getAttribute(i);if(H.state.isVisible)e.setAttribute(i,t?t+" "+o:o);else{var n=t&&t.replace(o,"").trim();n?e.setAttribute(i,n):e.removeAttribute(i)}})}}function de(){!Y&&H.props.aria.expanded&&m(H.props.triggerTarget||t).forEach(function(e){H.props.interactive?e.setAttribute("aria-expanded",H.state.isVisible&&e===ie()?"true":"false"):e.removeAttribute("aria-expanded")})}function ce(){oe().removeEventListener("mousemove",P),Q=Q.filter(function(e){return e!==P})}function ue(e){if(!(A.isTouch&&(I||"mousedown"===e.type)||H.props.interactive&&V.contains(e.target))){if(ie().contains(e.target)){if(A.isTouch)return;if(H.state.isVisible&&H.props.trigger.indexOf("click")>=0)return}else se("onClickOutside",[H,e]);!0===H.props.hideOnClick&&(H.clearDelayTimeouts(),H.hide(),L=!0,setTimeout(function(){L=!1}),H.state.isMounted||me())}}function he(){I=!0}function pe(){I=!1}function fe(){var e=oe();e.addEventListener("mousedown",ue,!0),e.addEventListener("touchend",ue,d),e.addEventListener("touchstart",pe,d),e.addEventListener("touchmove",he,d)}function me(){var e=oe();e.removeEventListener("mousedown",ue,!0),e.removeEventListener("touchend",ue,d),e.removeEventListener("touchstart",pe,d),e.removeEventListener("touchmove",he,d)}function ge(e,t){var i=ne().box;function o(e){e.target===i&&(x(i,"remove",o),t())}if(0===e)return t();x(i,"remove",u),x(i,"add",o),u=o}function ve(e,i,o){void 0===o&&(o=!1),m(H.props.triggerTarget||t).forEach(function(t){t.addEventListener(e,i,o),D.push({node:t,eventType:e,handler:i,options:o})})}function be(){var e;ee()&&(ve("touchstart",we,{passive:!0}),ve("touchend",Se,{passive:!0})),(e=H.props.trigger,e.split(/\s+/).filter(Boolean)).forEach(function(e){if("manual"!==e)switch(ve(e,we),e){case"mouseenter":ve("mouseleave",Se);break;case"focus":ve(o?"focusout":"blur",Ce);break;case"focusin":ve("focusout",Ce)}})}function ye(){D.forEach(function(e){var t=e.node,i=e.eventType,o=e.handler,n=e.options;t.removeEventListener(i,o,n)}),D=[]}function we(e){var t,i=!1;if(H.state.isEnabled&&!ke(e)&&!L){var o="focus"===(null==(t=l)?void 0:t.type);l=e,w=e.currentTarget,de(),!H.state.isVisible&&_(e)&&Q.forEach(function(t){return t(e)}),"click"===e.type&&(H.props.trigger.indexOf("mouseenter")<0||E)&&!1!==H.props.hideOnClick&&H.state.isVisible?i=!0:Ee(e),"click"===e.type&&(E=!i),i&&!o&&Ae(e)}}function _e(e){var t=e.target,i=ie().contains(t)||V.contains(t);"mousemove"===e.type&&i||function(e,t){var i=t.clientX,o=t.clientY;return e.every(function(e){var t=e.popperRect,n=e.popperState,a=e.props.interactiveBorder,r=v(n.placement),s=n.modifiersData.offset;if(!s)return!0;var l="bottom"===r?s.top.y:0,d="top"===r?s.bottom.y:0,c="right"===r?s.left.x:0,u="left"===r?s.right.x:0,h=t.top-o+l>a,p=o-t.bottom-d>a,f=t.left-i+c>a,m=i-t.right-u>a;return h||p||f||m})}(xe().concat(V).map(function(e){var t,i=null==(t=e._tippy.popperInstance)?void 0:t.state;return i?{popperRect:e.getBoundingClientRect(),popperState:i,props:C}:null}).filter(Boolean),e)&&(ce(),Ae(e))}function Se(e){ke(e)||H.props.trigger.indexOf("click")>=0&&E||(H.props.interactive?H.hideWithInteractivity(e):Ae(e))}function Ce(e){H.props.trigger.indexOf("focusin")<0&&e.target!==ie()||H.props.interactive&&e.relatedTarget&&V.contains(e.relatedTarget)||Ae(e)}function ke(e){return!!A.isTouch&&ee()!==e.type.indexOf("touch")>=0}function Te(){$e();var i=H.props,o=i.popperOptions,n=i.placement,a=i.offset,r=i.getReferenceClientRect,s=i.moveTransition,l=te()?X(V).arrow:null,d=r?{getBoundingClientRect:r,contextElement:r.contextElement||ie()}:t,c=[{name:"offset",options:{offset:a}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!s}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;if(te()){var i=ne().box;["placement","reference-hidden","escaped"].forEach(function(e){"placement"===e?i.setAttribute("data-placement",t.placement):t.attributes.popper["data-popper-"+e]?i.setAttribute("data-"+e,""):i.removeAttribute("data-"+e)}),t.attributes.popper={}}}}];te()&&l&&c.push({name:"arrow",options:{element:l,padding:3}}),c.push.apply(c,(null==o?void 0:o.modifiers)||[]),H.popperInstance=e.createPopper(d,V,Object.assign({},o,{placement:n,onFirstUpdate:f,modifiers:c}))}function $e(){H.popperInstance&&(H.popperInstance.destroy(),H.popperInstance=null)}function xe(){return b(V.querySelectorAll("[data-tippy-root]"))}function Ee(e){H.clearDelayTimeouts(),e&&se("onTrigger",[H,e]),fe();var t=ae(!0),i=K(),o=i[0],n=i[1];A.isTouch&&"hold"===o&&n&&(t=n),t?a=setTimeout(function(){H.show()},t):H.show()}function Ae(e){if(H.clearDelayTimeouts(),se("onUntrigger",[H,e]),H.state.isVisible){if(!(H.props.trigger.indexOf("mouseenter")>=0&&H.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(e.type)>=0&&E)){var t=ae(!1);t?r=setTimeout(function(){H.state.isVisible&&H.hide()},t):s=requestAnimationFrame(function(){H.hide()})}}else me()}}function te(e,t){void 0===t&&(t={});var i=F.plugins.concat(t.plugins||[]);!function(e){var t=!e,i="[object Object]"===Object.prototype.toString.call(e)&&!e.addEventListener;B(t,["tippy() was passed","`"+String(e)+"`","as its targets (first) argument. Valid types are: String, Element,","Element[], or NodeList."].join(" ")),B(i,["tippy() was passed a plain object which is not supported as an argument","for virtual positioning. Use props.getReferenceClientRect instead."].join(" "))}(e),G(t,i),document.addEventListener("touchstart",I,d),window.addEventListener("blur",D);var o=Object.assign({},t,{plugins:i}),n=C(e),a=w(o.content),r=n.length>1;N(a&&r,["tippy() was passed an Element as the `content` prop, but more than","one tippy instance was created by this invocation. This means the","content element will only be appended to the last tippy instance.","\n\n","Instead, pass the .innerHTML of the element, or use a function that","returns a cloned version of the element instead.","\n\n","1) content: element.innerHTML\n","2) content: () => element.cloneNode(true)"].join(" "));var s=n.reduce(function(e,t){var i=t&&ee(t,o);return i&&e.push(i),e},[]);return w(e)?s[0]:s}te.defaultProps=F,te.setDefaultProps=function(e){G(e,[]),Object.keys(e).forEach(function(t){F[t]=e[t]})},te.currentInput=A;var ie=Object.assign({},e.applyStyles,{effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow)}}),oe={mouseover:"mouseenter",focusin:"focus",click:"click"};var ne={name:"animateFill",defaultValue:!1,fn:function(e){var t;if(!(null==(t=e.props.render)?void 0:t.$$tippy))return B(e.props.animateFill,"The `animateFill` plugin requires the default render function."),{};var i=X(e.popper),o=i.box,n=i.content,a=e.props.animateFill?function(){var e=y();return e.className=r,T([e],"hidden"),e}():null;return{onCreate:function(){a&&(o.insertBefore(a,o.firstElementChild),o.setAttribute("data-animatefill",""),o.style.overflow="hidden",e.setProps({arrow:!1,animation:"shift-away"}))},onMount:function(){if(a){var e=o.style.transitionDuration,t=Number(e.replace("ms",""));n.style.transitionDelay=Math.round(t/10)+"ms",a.style.transitionDuration=e,T([a],"visible")}},onShow:function(){a&&(a.style.transitionDuration="0ms")},onHide:function(){a&&T([a],"hidden")}}}};var ae={clientX:0,clientY:0},re=[];function se(e){var t=e.clientX,i=e.clientY;ae={clientX:t,clientY:i}}var le={name:"followCursor",defaultValue:!1,fn:function(e){var t=e.reference,i=$(e.props.triggerTarget||t),o=!1,n=!1,a=!0,r=e.props;function s(){return"initial"===e.props.followCursor&&e.state.isVisible}function l(){i.addEventListener("mousemove",u)}function d(){i.removeEventListener("mousemove",u)}function c(){o=!0,e.setProps({getReferenceClientRect:null}),o=!1}function u(i){var o=!i.target||t.contains(i.target),n=e.props.followCursor,a=i.clientX,r=i.clientY,s=t.getBoundingClientRect(),l=a-s.left,d=r-s.top;!o&&e.props.interactive||e.setProps({getReferenceClientRect:function(){var e=t.getBoundingClientRect(),i=a,o=r;"initial"===n&&(i=e.left+l,o=e.top+d);var s="horizontal"===n?e.top:o,c="vertical"===n?e.right:i,u="horizontal"===n?e.bottom:o,h="vertical"===n?e.left:i;return{width:c-h,height:u-s,top:s,right:c,bottom:u,left:h}}})}function h(){e.props.followCursor&&(re.push({instance:e,doc:i}),function(e){e.addEventListener("mousemove",se)}(i))}function p(){0===(re=re.filter(function(t){return t.instance!==e})).filter(function(e){return e.doc===i}).length&&function(e){e.removeEventListener("mousemove",se)}(i)}return{onCreate:h,onDestroy:p,onBeforeUpdate:function(){r=e.props},onAfterUpdate:function(t,i){var a=i.followCursor;o||void 0!==a&&r.followCursor!==a&&(p(),a?(h(),!e.state.isMounted||n||s()||l()):(d(),c()))},onMount:function(){e.props.followCursor&&!n&&(a&&(u(ae),a=!1),s()||l())},onTrigger:function(e,t){_(t)&&(ae={clientX:t.clientX,clientY:t.clientY}),n="focus"===t.type},onHidden:function(){e.props.followCursor&&(c(),d(),a=!0)}}}};var de={name:"inlinePositioning",defaultValue:!1,fn:function(e){var t,i=e.reference;var o=-1,n=!1,a={name:"tippyInlinePositioning",enabled:!0,phase:"afterWrite",fn:function(n){var a=n.state;e.props.inlinePositioning&&(t!==a.placement&&e.setProps({getReferenceClientRect:function(){return function(e,t,i,o){if(i.length<2||null===e)return t;if(2===i.length&&o>=0&&i[0].left>i[1].right)return i[o]||t;switch(e){case"top":case"bottom":var n=i[0],a=i[i.length-1],r="top"===e,s=n.top,l=a.bottom,d=r?n.left:a.left,c=r?n.right:a.right,u=c-d,h=l-s;return{top:s,bottom:l,left:d,right:c,width:u,height:h};case"left":case"right":var p=Math.min.apply(Math,i.map(function(e){return e.left})),f=Math.max.apply(Math,i.map(function(e){return e.right})),m=i.filter(function(t){return"left"===e?t.left===p:t.right===f}),g=m[0].top,v=m[m.length-1].bottom,b=p,y=f,w=y-b,_=v-g;return{top:g,bottom:v,left:b,right:y,width:w,height:_};default:return t}}(v(a.placement),i.getBoundingClientRect(),b(i.getClientRects()),o)}}),t=a.placement)}};function r(){var t;n||(t=function(e,t){var i;return{popperOptions:Object.assign({},e.popperOptions,{modifiers:[].concat(((null==(i=e.popperOptions)?void 0:i.modifiers)||[]).filter(function(e){return e.name!==t.name}),[t])})}}(e.props,a),n=!0,e.setProps(t),n=!1)}return{onCreate:r,onAfterUpdate:r,onTrigger:function(t,i){if(_(i)){var n=b(e.reference.getClientRects()),a=n.find(function(e){return e.left-2<=i.clientX&&e.right+2>=i.clientX&&e.top-2<=i.clientY&&e.bottom+2>=i.clientY});o=n.indexOf(a)}},onUntrigger:function(){o=-1}}}};var ce={name:"sticky",defaultValue:!1,fn:function(e){var t=e.reference,i=e.popper;function o(t){return!0===e.props.sticky||e.props.sticky===t}var n=null,a=null;function r(){var s=o("reference")?(e.popperInstance?e.popperInstance.state.elements.reference:t).getBoundingClientRect():null,l=o("popper")?i.getBoundingClientRect():null;(s&&ue(n,s)||l&&ue(a,l))&&e.popperInstance&&e.popperInstance.update(),n=s,a=l,e.state.isMounted&&requestAnimationFrame(r)}return{onMount:function(){e.props.sticky&&r()}}}};function ue(e,t){return!e||!t||(e.top!==t.top||e.right!==t.right||e.bottom!==t.bottom||e.left!==t.left)}return t&&function(e){var t=document.createElement("style");t.textContent=e,t.setAttribute("data-tippy-stylesheet","");var i=document.head,o=document.querySelector("head>style,head>link");o?i.insertBefore(t,o):i.appendChild(t)}('.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}'),te.setDefaultProps({plugins:[ne,le,de,ce],render:K}),te.createSingleton=function(e,t){var i;void 0===t&&(t={}),B(!Array.isArray(e),["The first argument passed to createSingleton() must be an array of","tippy instances. The passed value was",String(e)].join(" "));var o,n=e,a=[],r=t.overrides,s=[],l=!1;function d(){a=n.map(function(e){return e.reference})}function c(e){n.forEach(function(t){e?t.enable():t.disable()})}function u(e){return n.map(function(t){var i=t.setProps;return t.setProps=function(n){i(n),t.reference===o&&e.setProps(n)},function(){t.setProps=i}})}function h(e,t){var i=a.indexOf(t);if(t!==o){o=t;var s=(r||[]).concat("content").reduce(function(e,t){return e[t]=n[i].props[t],e},{});e.setProps(Object.assign({},s,{getReferenceClientRect:"function"==typeof s.getReferenceClientRect?s.getReferenceClientRect:function(){return t.getBoundingClientRect()}}))}}c(!1),d();var p={fn:function(){return{onDestroy:function(){c(!0)},onHidden:function(){o=null},onClickOutside:function(e){e.props.showOnCreate&&!l&&(l=!0,o=null)},onShow:function(e){e.props.showOnCreate&&!l&&(l=!0,h(e,a[0]))},onTrigger:function(e,t){h(e,t.currentTarget)}}}},m=te(y(),Object.assign({},f(t,["overrides"]),{plugins:[p].concat(t.plugins||[]),triggerTarget:a,popperOptions:Object.assign({},t.popperOptions,{modifiers:[].concat((null==(i=t.popperOptions)?void 0:i.modifiers)||[],[ie])})})),g=m.show;m.show=function(e){if(g(),!o&&null==e)return h(m,a[0]);if(!o||null!=e){if("number"==typeof e)return a[e]&&h(m,a[e]);if(n.includes(e)){var t=e.reference;return h(m,t)}return a.includes(e)?h(m,e):void 0}},m.showNext=function(){var e=a[0];if(!o)return m.show(0);var t=a.indexOf(o);m.show(a[t+1]||e)},m.showPrevious=function(){var e=a[a.length-1];if(!o)return m.show(e);var t=a.indexOf(o),i=a[t-1]||e;m.show(i)};var v=m.setProps;return m.setProps=function(e){r=e.overrides||r,v(e)},m.setInstances=function(e){c(!0),s.forEach(function(e){return e()}),n=e,c(!1),d(),u(m),m.setProps({triggerTarget:a})},s=u(m),m},te.delegate=function(e,t){B(!(t&&t.target),["You must specity a `target` prop indicating a CSS selector string matching","the target elements that should receive a tippy."].join(" "));var i=[],o=[],n=!1,a=t.target,r=f(t,["target"]),s=Object.assign({},r,{trigger:"manual",touch:!1}),l=Object.assign({},r,{showOnCreate:!0}),c=te(e,s);function u(e){if(e.target&&!n){var i=e.target.closest(a);if(i){var r=i.getAttribute("data-tippy-trigger")||t.trigger||F.trigger;if(!i._tippy&&!("touchstart"===e.type&&"boolean"==typeof l.touch||"touchstart"!==e.type&&r.indexOf(oe[e.type])<0)){var s=te(i,l);s&&(o=o.concat(s))}}}}function h(e,t,o,n){void 0===n&&(n=!1),e.addEventListener(t,o,n),i.push({node:e,eventType:t,handler:o,options:n})}return m(c).forEach(function(e){var t=e.destroy,a=e.enable,r=e.disable;e.destroy=function(e){void 0===e&&(e=!0),e&&o.forEach(function(e){e.destroy()}),o=[],i.forEach(function(e){var t=e.node,i=e.eventType,o=e.handler,n=e.options;t.removeEventListener(i,o,n)}),i=[],t()},e.enable=function(){a(),o.forEach(function(e){return e.enable()}),n=!1},e.disable=function(){r(),o.forEach(function(e){return e.disable()}),n=!0},function(e){var t=e.reference;h(t,"touchstart",u,d),h(t,"mouseover",u),h(t,"focusin",u),h(t,"click",u)}(e)}),c},te.hideAll=function(e){var t=void 0===e?{}:e,i=t.exclude,o=t.duration;Z.forEach(function(e){var t=!1;if(i&&(t=S(i)?e.reference===i:e.popper===i.popper),!t){var n=e.props.duration;e.setProps({duration:o}),e.hide(),e.state.isDestroyed||e.setProps({duration:n})}})},te.roundArrow='<svg width="16" height="6" xmlns="http://www.w3.org/2000/svg"><path d="M0 6s1.796-.013 4.67-3.615C5.851.9 6.93.006 8 0c1.07-.006 2.148.887 3.343 2.385C14.233 6.005 16 6 16 6H0z"></svg>',te}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ClipboardJS=t():e.ClipboardJS=t()}(this,function(){return function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),a=l(i(1)),r=l(i(3)),s=l(i(4));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.resolveOptions(i),o.listenClick(e),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),n(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===o(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,s.default)(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new a.default({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return c("action",e)}},{key:"defaultTarget",value:function(e){var t=c("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return c("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof e?[e]:e,i=!!document.queryCommandSupported;return t.forEach(function(e){i=i&&!!document.queryCommandSupported(e)}),i}}]),t}();function c(e,t){var i="data-clipboard-"+e;if(t.hasAttribute(i))return t.getAttribute(i)}e.exports=d},function(e,t,i){"use strict";var o,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),r=i(2),s=(o=r)&&o.__esModule?o:{default:o};var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resolveOptions(t),this.initSelection()}return a(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var i=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=i+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,s.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,s.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==(void 0===e?"undefined":n(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}();e.exports=l},function(e,t){e.exports=function(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var i=e.hasAttribute("readonly");i||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),i||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var o=window.getSelection(),n=document.createRange();n.selectNodeContents(e),o.removeAllRanges(),o.addRange(n),t=o.toString()}return t}},function(e,t){function i(){}i.prototype={on:function(e,t,i){var o=this.e||(this.e={});return(o[e]||(o[e]=[])).push({fn:t,ctx:i}),this},once:function(e,t,i){var o=this;function n(){o.off(e,n),t.apply(i,arguments)}return n._=t,this.on(e,n,i)},emit:function(e){for(var t=[].slice.call(arguments,1),i=((this.e||(this.e={}))[e]||[]).slice(),o=0,n=i.length;o<n;o++)i[o].fn.apply(i[o].ctx,t);return this},off:function(e,t){var i=this.e||(this.e={}),o=i[e],n=[];if(o&&t)for(var a=0,r=o.length;a<r;a++)o[a].fn!==t&&o[a].fn._!==t&&n.push(o[a]);return n.length?i[e]=n:delete i[e],this}},e.exports=i},function(e,t,i){var o=i(5),n=i(6);e.exports=function(e,t,i){if(!e&&!t&&!i)throw new Error("Missing required arguments");if(!o.string(t))throw new TypeError("Second argument must be a String");if(!o.fn(i))throw new TypeError("Third argument must be a Function");if(o.node(e))return function(e,t,i){return e.addEventListener(t,i),{destroy:function(){e.removeEventListener(t,i)}}}(e,t,i);if(o.nodeList(e))return function(e,t,i){return Array.prototype.forEach.call(e,function(e){e.addEventListener(t,i)}),{destroy:function(){Array.prototype.forEach.call(e,function(e){e.removeEventListener(t,i)})}}}(e,t,i);if(o.string(e))return function(e,t,i){return n(document.body,e,t,i)}(e,t,i);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var i=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===i||"[object HTMLCollection]"===i)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"==typeof e||e instanceof String},t.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},function(e,t,i){var o=i(7);function n(e,t,i,n,a){var r=function(e,t,i,n){return function(i){i.delegateTarget=o(i.target,t),i.delegateTarget&&n.call(e,i)}}.apply(this,arguments);return e.addEventListener(i,r,a),{destroy:function(){e.removeEventListener(i,r,a)}}}e.exports=function(e,t,i,o,a){return"function"==typeof e.addEventListener?n.apply(null,arguments):"function"==typeof i?n.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,function(e){return n(e,t,i,o,a)}))}},function(e,t){var i=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var o=Element.prototype;o.matches=o.matchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector||o.webkitMatchesSelector}e.exports=function(e,t){for(;e&&e.nodeType!==i;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}}])}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Swiper=t()}(this,function(){"use strict";var e="undefined"==typeof document?{body:{},addEventListener:function(){},removeEventListener:function(){},activeElement:{blur:function(){},nodeName:""},querySelector:function(){return null},querySelectorAll:function(){return[]},getElementById:function(){return null},createEvent:function(){return{initEvent:function(){}}},createElement:function(){return{children:[],childNodes:[],style:{},setAttribute:function(){},getElementsByTagName:function(){return[]}}},location:{hash:""}}:document,t="undefined"==typeof window?{document:e,navigator:{userAgent:""},location:{},history:{},CustomEvent:function(){return this},addEventListener:function(){},removeEventListener:function(){},getComputedStyle:function(){return{getPropertyValue:function(){return""}}},Image:function(){},Date:function(){},screen:{},setTimeout:function(){},clearTimeout:function(){}}:window,i=function(e){for(var t=0;t<e.length;t+=1)this[t]=e[t];return this.length=e.length,this};function o(o,n){var a=[],r=0;if(o&&!n&&o instanceof i)return o;if(o)if("string"==typeof o){var s,l,d=o.trim();if(d.indexOf("<")>=0&&d.indexOf(">")>=0){var c="div";for(0===d.indexOf("<li")&&(c="ul"),0===d.indexOf("<tr")&&(c="tbody"),0!==d.indexOf("<td")&&0!==d.indexOf("<th")||(c="tr"),0===d.indexOf("<tbody")&&(c="table"),0===d.indexOf("<option")&&(c="select"),(l=e.createElement(c)).innerHTML=d,r=0;r<l.childNodes.length;r+=1)a.push(l.childNodes[r])}else for(s=n||"#"!==o[0]||o.match(/[ .<>:~]/)?(n||e).querySelectorAll(o.trim()):[e.getElementById(o.trim().split("#")[1])],r=0;r<s.length;r+=1)s[r]&&a.push(s[r])}else if(o.nodeType||o===t||o===e)a.push(o);else if(o.length>0&&o[0].nodeType)for(r=0;r<o.length;r+=1)a.push(o[r]);return new i(a)}function n(e){for(var t=[],i=0;i<e.length;i+=1)-1===t.indexOf(e[i])&&t.push(e[i]);return t}o.fn=i.prototype,o.Class=i,o.Dom7=i;var a={addClass:function(e){if(void 0===e)return this;for(var t=e.split(" "),i=0;i<t.length;i+=1)for(var o=0;o<this.length;o+=1)void 0!==this[o]&&void 0!==this[o].classList&&this[o].classList.add(t[i]);return this},removeClass:function(e){for(var t=e.split(" "),i=0;i<t.length;i+=1)for(var o=0;o<this.length;o+=1)void 0!==this[o]&&void 0!==this[o].classList&&this[o].classList.remove(t[i]);return this},hasClass:function(e){return!!this[0]&&this[0].classList.contains(e)},toggleClass:function(e){for(var t=e.split(" "),i=0;i<t.length;i+=1)for(var o=0;o<this.length;o+=1)void 0!==this[o]&&void 0!==this[o].classList&&this[o].classList.toggle(t[i]);return this},attr:function(e,t){var i=arguments;if(1===arguments.length&&"string"==typeof e)return this[0]?this[0].getAttribute(e):void 0;for(var o=0;o<this.length;o+=1)if(2===i.length)this[o].setAttribute(e,t);else for(var n in e)this[o][n]=e[n],this[o].setAttribute(n,e[n]);return this},removeAttr:function(e){for(var t=0;t<this.length;t+=1)this[t].removeAttribute(e);return this},data:function(e,t){var i;if(void 0!==t){for(var o=0;o<this.length;o+=1)(i=this[o]).dom7ElementDataStorage||(i.dom7ElementDataStorage={}),i.dom7ElementDataStorage[e]=t;return this}if(i=this[0]){if(i.dom7ElementDataStorage&&e in i.dom7ElementDataStorage)return i.dom7ElementDataStorage[e];var n=i.getAttribute("data-"+e);return n||void 0}},transform:function(e){for(var t=0;t<this.length;t+=1){var i=this[t].style;i.webkitTransform=e,i.transform=e}return this},transition:function(e){"string"!=typeof e&&(e+="ms");for(var t=0;t<this.length;t+=1){var i=this[t].style;i.webkitTransitionDuration=e,i.transitionDuration=e}return this},on:function(){for(var e,t=[],i=arguments.length;i--;)t[i]=arguments[i];var n=t[0],a=t[1],r=t[2],s=t[3];function l(e){var t=e.target;if(t){var i=e.target.dom7EventData||[];if(i.indexOf(e)<0&&i.unshift(e),o(t).is(a))r.apply(t,i);else for(var n=o(t).parents(),s=0;s<n.length;s+=1)o(n[s]).is(a)&&r.apply(n[s],i)}}function d(e){var t=e&&e.target&&e.target.dom7EventData||[];t.indexOf(e)<0&&t.unshift(e),r.apply(this,t)}"function"==typeof t[1]&&(n=(e=t)[0],r=e[1],s=e[2],a=void 0),s||(s=!1);for(var c,u=n.split(" "),h=0;h<this.length;h+=1){var p=this[h];if(a)for(c=0;c<u.length;c+=1){var f=u[c];p.dom7LiveListeners||(p.dom7LiveListeners={}),p.dom7LiveListeners[f]||(p.dom7LiveListeners[f]=[]),p.dom7LiveListeners[f].push({listener:r,proxyListener:l}),p.addEventListener(f,l,s)}else for(c=0;c<u.length;c+=1){var m=u[c];p.dom7Listeners||(p.dom7Listeners={}),p.dom7Listeners[m]||(p.dom7Listeners[m]=[]),p.dom7Listeners[m].push({listener:r,proxyListener:d}),p.addEventListener(m,d,s)}}return this},off:function(){for(var e,t=[],i=arguments.length;i--;)t[i]=arguments[i];var o=t[0],n=t[1],a=t[2],r=t[3];"function"==typeof t[1]&&(o=(e=t)[0],a=e[1],r=e[2],n=void 0),r||(r=!1);for(var s=o.split(" "),l=0;l<s.length;l+=1)for(var d=s[l],c=0;c<this.length;c+=1){var u=this[c],h=void 0;if(!n&&u.dom7Listeners?h=u.dom7Listeners[d]:n&&u.dom7LiveListeners&&(h=u.dom7LiveListeners[d]),h&&h.length)for(var p=h.length-1;p>=0;p-=1){var f=h[p];a&&f.listener===a?(u.removeEventListener(d,f.proxyListener,r),h.splice(p,1)):a&&f.listener&&f.listener.dom7proxy&&f.listener.dom7proxy===a?(u.removeEventListener(d,f.proxyListener,r),h.splice(p,1)):a||(u.removeEventListener(d,f.proxyListener,r),h.splice(p,1))}}return this},trigger:function(){for(var i=[],o=arguments.length;o--;)i[o]=arguments[o];for(var n=i[0].split(" "),a=i[1],r=0;r<n.length;r+=1)for(var s=n[r],l=0;l<this.length;l+=1){var d=this[l],c=void 0;try{c=new t.CustomEvent(s,{detail:a,bubbles:!0,cancelable:!0})}catch(t){(c=e.createEvent("Event")).initEvent(s,!0,!0),c.detail=a}d.dom7EventData=i.filter(function(e,t){return t>0}),d.dispatchEvent(c),d.dom7EventData=[],delete d.dom7EventData}return this},transitionEnd:function(e){var t,i=["webkitTransitionEnd","transitionend"],o=this;function n(a){if(a.target===this)for(e.call(this,a),t=0;t<i.length;t+=1)o.off(i[t],n)}if(e)for(t=0;t<i.length;t+=1)o.on(i[t],n);return this},outerWidth:function(e){if(this.length>0){if(e){var t=this.styles();return this[0].offsetWidth+parseFloat(t.getPropertyValue("margin-right"))+parseFloat(t.getPropertyValue("margin-left"))}return this[0].offsetWidth}return null},outerHeight:function(e){if(this.length>0){if(e){var t=this.styles();return this[0].offsetHeight+parseFloat(t.getPropertyValue("margin-top"))+parseFloat(t.getPropertyValue("margin-bottom"))}return this[0].offsetHeight}return null},offset:function(){if(this.length>0){var i=this[0],o=i.getBoundingClientRect(),n=e.body,a=i.clientTop||n.clientTop||0,r=i.clientLeft||n.clientLeft||0,s=i===t?t.scrollY:i.scrollTop,l=i===t?t.scrollX:i.scrollLeft;return{top:o.top+s-a,left:o.left+l-r}}return null},css:function(e,i){var o;if(1===arguments.length){if("string"!=typeof e){for(o=0;o<this.length;o+=1)for(var n in e)this[o].style[n]=e[n];return this}if(this[0])return t.getComputedStyle(this[0],null).getPropertyValue(e)}if(2===arguments.length&&"string"==typeof e){for(o=0;o<this.length;o+=1)this[o].style[e]=i;return this}return this},each:function(e){if(!e)return this;for(var t=0;t<this.length;t+=1)if(!1===e.call(this[t],t,this[t]))return this;return this},html:function(e){if(void 0===e)return this[0]?this[0].innerHTML:void 0;for(var t=0;t<this.length;t+=1)this[t].innerHTML=e;return this},text:function(e){if(void 0===e)return this[0]?this[0].textContent.trim():null;for(var t=0;t<this.length;t+=1)this[t].textContent=e;return this},is:function(n){var a,r,s=this[0];if(!s||void 0===n)return!1;if("string"==typeof n){if(s.matches)return s.matches(n);if(s.webkitMatchesSelector)return s.webkitMatchesSelector(n);if(s.msMatchesSelector)return s.msMatchesSelector(n);for(a=o(n),r=0;r<a.length;r+=1)if(a[r]===s)return!0;return!1}if(n===e)return s===e;if(n===t)return s===t;if(n.nodeType||n instanceof i){for(a=n.nodeType?[n]:n,r=0;r<a.length;r+=1)if(a[r]===s)return!0;return!1}return!1},index:function(){var e,t=this[0];if(t){for(e=0;null!==(t=t.previousSibling);)1===t.nodeType&&(e+=1);return e}},eq:function(e){if(void 0===e)return this;var t,o=this.length;return new i(e>o-1?[]:e<0?(t=o+e)<0?[]:[this[t]]:[this[e]])},append:function(){for(var t,o=[],n=arguments.length;n--;)o[n]=arguments[n];for(var a=0;a<o.length;a+=1){t=o[a];for(var r=0;r<this.length;r+=1)if("string"==typeof t){var s=e.createElement("div");for(s.innerHTML=t;s.firstChild;)this[r].appendChild(s.firstChild)}else if(t instanceof i)for(var l=0;l<t.length;l+=1)this[r].appendChild(t[l]);else this[r].appendChild(t)}return this},prepend:function(t){var o,n;for(o=0;o<this.length;o+=1)if("string"==typeof t){var a=e.createElement("div");for(a.innerHTML=t,n=a.childNodes.length-1;n>=0;n-=1)this[o].insertBefore(a.childNodes[n],this[o].childNodes[0])}else if(t instanceof i)for(n=0;n<t.length;n+=1)this[o].insertBefore(t[n],this[o].childNodes[0]);else this[o].insertBefore(t,this[o].childNodes[0]);return this},next:function(e){return this.length>0?e?this[0].nextElementSibling&&o(this[0].nextElementSibling).is(e)?new i([this[0].nextElementSibling]):new i([]):this[0].nextElementSibling?new i([this[0].nextElementSibling]):new i([]):new i([])},nextAll:function(e){var t=[],n=this[0];if(!n)return new i([]);for(;n.nextElementSibling;){var a=n.nextElementSibling;e?o(a).is(e)&&t.push(a):t.push(a),n=a}return new i(t)},prev:function(e){if(this.length>0){var t=this[0];return e?t.previousElementSibling&&o(t.previousElementSibling).is(e)?new i([t.previousElementSibling]):new i([]):t.previousElementSibling?new i([t.previousElementSibling]):new i([])}return new i([])},prevAll:function(e){var t=[],n=this[0];if(!n)return new i([]);for(;n.previousElementSibling;){var a=n.previousElementSibling;e?o(a).is(e)&&t.push(a):t.push(a),n=a}return new i(t)},parent:function(e){for(var t=[],i=0;i<this.length;i+=1)null!==this[i].parentNode&&(e?o(this[i].parentNode).is(e)&&t.push(this[i].parentNode):t.push(this[i].parentNode));return o(n(t))},parents:function(e){for(var t=[],i=0;i<this.length;i+=1)for(var a=this[i].parentNode;a;)e?o(a).is(e)&&t.push(a):t.push(a),a=a.parentNode;return o(n(t))},closest:function(e){var t=this;return void 0===e?new i([]):(t.is(e)||(t=t.parents(e).eq(0)),t)},find:function(e){for(var t=[],o=0;o<this.length;o+=1)for(var n=this[o].querySelectorAll(e),a=0;a<n.length;a+=1)t.push(n[a]);return new i(t)},children:function(e){for(var t=[],a=0;a<this.length;a+=1)for(var r=this[a].childNodes,s=0;s<r.length;s+=1)e?1===r[s].nodeType&&o(r[s]).is(e)&&t.push(r[s]):1===r[s].nodeType&&t.push(r[s]);return new i(n(t))},remove:function(){for(var e=0;e<this.length;e+=1)this[e].parentNode&&this[e].parentNode.removeChild(this[e]);return this},add:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var i,n;for(i=0;i<e.length;i+=1){var a=o(e[i]);for(n=0;n<a.length;n+=1)this[this.length]=a[n],this.length+=1}return this},styles:function(){return this[0]?t.getComputedStyle(this[0],null):{}}};Object.keys(a).forEach(function(e){o.fn[e]=a[e]});var r,s,l={deleteProps:function(e){var t=e;Object.keys(t).forEach(function(e){try{t[e]=null}catch(e){}try{delete t[e]}catch(e){}})},nextTick:function(e,t){return void 0===t&&(t=0),setTimeout(e,t)},now:function(){return Date.now()},getTranslate:function(e,i){var o,n,a;void 0===i&&(i="x");var r=t.getComputedStyle(e,null);return t.WebKitCSSMatrix?((n=r.transform||r.webkitTransform).split(",").length>6&&(n=n.split(", ").map(function(e){return e.replace(",",".")}).join(", ")),a=new t.WebKitCSSMatrix("none"===n?"":n)):o=(a=r.MozTransform||r.OTransform||r.MsTransform||r.msTransform||r.transform||r.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,")).toString().split(","),"x"===i&&(n=t.WebKitCSSMatrix?a.m41:16===o.length?parseFloat(o[12]):parseFloat(o[4])),"y"===i&&(n=t.WebKitCSSMatrix?a.m42:16===o.length?parseFloat(o[13]):parseFloat(o[5])),n||0},parseUrlQuery:function(e){var i,o,n,a,r={},s=e||t.location.href;if("string"==typeof s&&s.length)for(a=(o=(s=s.indexOf("?")>-1?s.replace(/\S*\?/,""):"").split("&").filter(function(e){return""!==e})).length,i=0;i<a;i+=1)n=o[i].replace(/#\S+/g,"").split("="),r[decodeURIComponent(n[0])]=void 0===n[1]?void 0:decodeURIComponent(n[1])||"";return r},isObject:function(e){return"object"==typeof e&&null!==e&&e.constructor&&e.constructor===Object},extend:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var i=Object(e[0]),o=1;o<e.length;o+=1){var n=e[o];if(void 0!==n&&null!==n)for(var a=Object.keys(Object(n)),r=0,s=a.length;r<s;r+=1){var d=a[r],c=Object.getOwnPropertyDescriptor(n,d);void 0!==c&&c.enumerable&&(l.isObject(i[d])&&l.isObject(n[d])?l.extend(i[d],n[d]):!l.isObject(i[d])&&l.isObject(n[d])?(i[d]={},l.extend(i[d],n[d])):i[d]=n[d])}}return i}},d=(s=e.createElement("div"),{touch:t.Modernizr&&!0===t.Modernizr.touch||!!(t.navigator.maxTouchPoints>0||"ontouchstart"in t||t.DocumentTouch&&e instanceof t.DocumentTouch),pointerEvents:!!(t.navigator.pointerEnabled||t.PointerEvent||"maxTouchPoints"in t.navigator&&t.navigator.maxTouchPoints>0),prefixedPointerEvents:!!t.navigator.msPointerEnabled,transition:(r=s.style,"transition"in r||"webkitTransition"in r||"MozTransition"in r),transforms3d:t.Modernizr&&!0===t.Modernizr.csstransforms3d||function(){var e=s.style;return"webkitPerspective"in e||"MozPerspective"in e||"OPerspective"in e||"MsPerspective"in e||"perspective"in e}(),flexbox:function(){for(var e=s.style,t="alignItems webkitAlignItems webkitBoxAlign msFlexAlign mozBoxAlign webkitFlexDirection msFlexDirection mozBoxDirection mozBoxOrient webkitBoxDirection webkitBoxOrient".split(" "),i=0;i<t.length;i+=1)if(t[i]in e)return!0;return!1}(),observer:"MutationObserver"in t||"WebkitMutationObserver"in t,passiveListener:function(){var e=!1;try{var i=Object.defineProperty({},"passive",{get:function(){e=!0}});t.addEventListener("testPassiveListener",null,i)}catch(e){}return e}(),gestures:"ongesturestart"in t}),c=function(){return{isIE:!!t.navigator.userAgent.match(/Trident/g)||!!t.navigator.userAgent.match(/MSIE/g),isEdge:!!t.navigator.userAgent.match(/Edge/g),isSafari:(e=t.navigator.userAgent.toLowerCase(),e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("android")<0),isUiWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(t.navigator.userAgent)};var e}(),u=function(e){void 0===e&&(e={});var t=this;t.params=e,t.eventsListeners={},t.params&&t.params.on&&Object.keys(t.params.on).forEach(function(e){t.on(e,t.params.on[e])})},h={components:{configurable:!0}};u.prototype.on=function(e,t,i){var o=this;if("function"!=typeof t)return o;var n=i?"unshift":"push";return e.split(" ").forEach(function(e){o.eventsListeners[e]||(o.eventsListeners[e]=[]),o.eventsListeners[e][n](t)}),o},u.prototype.once=function(e,t,i){var o=this;if("function"!=typeof t)return o;function n(){for(var i=[],a=arguments.length;a--;)i[a]=arguments[a];t.apply(o,i),o.off(e,n),n.f7proxy&&delete n.f7proxy}return n.f7proxy=t,o.on(e,n,i)},u.prototype.off=function(e,t){var i=this;return i.eventsListeners?(e.split(" ").forEach(function(e){void 0===t?i.eventsListeners[e]=[]:i.eventsListeners[e]&&i.eventsListeners[e].length&&i.eventsListeners[e].forEach(function(o,n){(o===t||o.f7proxy&&o.f7proxy===t)&&i.eventsListeners[e].splice(n,1)})}),i):i},u.prototype.emit=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var i,o,n,a=this;return a.eventsListeners?("string"==typeof e[0]||Array.isArray(e[0])?(i=e[0],o=e.slice(1,e.length),n=a):(i=e[0].events,o=e[0].data,n=e[0].context||a),(Array.isArray(i)?i:i.split(" ")).forEach(function(e){if(a.eventsListeners&&a.eventsListeners[e]){var t=[];a.eventsListeners[e].forEach(function(e){t.push(e)}),t.forEach(function(e){e.apply(n,o)})}}),a):a},u.prototype.useModulesParams=function(e){var t=this;t.modules&&Object.keys(t.modules).forEach(function(i){var o=t.modules[i];o.params&&l.extend(e,o.params)})},u.prototype.useModules=function(e){void 0===e&&(e={});var t=this;t.modules&&Object.keys(t.modules).forEach(function(i){var o=t.modules[i],n=e[i]||{};o.instance&&Object.keys(o.instance).forEach(function(e){var i=o.instance[e];t[e]="function"==typeof i?i.bind(t):i}),o.on&&t.on&&Object.keys(o.on).forEach(function(e){t.on(e,o.on[e])}),o.create&&o.create.bind(t)(n)})},h.components.set=function(e){this.use&&this.use(e)},u.installModule=function(e){for(var t=[],i=arguments.length-1;i-->0;)t[i]=arguments[i+1];var o=this;o.prototype.modules||(o.prototype.modules={});var n=e.name||Object.keys(o.prototype.modules).length+"_"+l.now();return o.prototype.modules[n]=e,e.proto&&Object.keys(e.proto).forEach(function(t){o.prototype[t]=e.proto[t]}),e.static&&Object.keys(e.static).forEach(function(t){o[t]=e.static[t]}),e.install&&e.install.apply(o,t),o},u.use=function(e){for(var t=[],i=arguments.length-1;i-->0;)t[i]=arguments[i+1];var o=this;return Array.isArray(e)?(e.forEach(function(e){return o.installModule(e)}),o):o.installModule.apply(o,[e].concat(t))},Object.defineProperties(u,h);var p={updateSize:function(){var e,t,i=this.$el;e=void 0!==this.params.width?this.params.width:i[0].clientWidth,t=void 0!==this.params.height?this.params.height:i[0].clientHeight,0===e&&this.isHorizontal()||0===t&&this.isVertical()||(e=e-parseInt(i.css("padding-left"),10)-parseInt(i.css("padding-right"),10),t=t-parseInt(i.css("padding-top"),10)-parseInt(i.css("padding-bottom"),10),l.extend(this,{width:e,height:t,size:this.isHorizontal()?e:t}))},updateSlides:function(){var e=this.params,i=this.$wrapperEl,o=this.size,n=this.rtlTranslate,a=this.wrongRTL,r=this.virtual&&e.virtual.enabled,s=r?this.virtual.slides.length:this.slides.length,c=i.children("."+this.params.slideClass),u=r?this.virtual.slides.length:c.length,h=[],p=[],f=[],m=e.slidesOffsetBefore;"function"==typeof m&&(m=e.slidesOffsetBefore.call(this));var g=e.slidesOffsetAfter;"function"==typeof g&&(g=e.slidesOffsetAfter.call(this));var v=this.snapGrid.length,b=this.snapGrid.length,y=e.spaceBetween,w=-m,_=0,S=0;if(void 0!==o){var C,k;"string"==typeof y&&y.indexOf("%")>=0&&(y=parseFloat(y.replace("%",""))/100*o),this.virtualSize=-y,n?c.css({marginLeft:"",marginTop:""}):c.css({marginRight:"",marginBottom:""}),e.slidesPerColumn>1&&(C=Math.floor(u/e.slidesPerColumn)===u/this.params.slidesPerColumn?u:Math.ceil(u/e.slidesPerColumn)*e.slidesPerColumn,"auto"!==e.slidesPerView&&"row"===e.slidesPerColumnFill&&(C=Math.max(C,e.slidesPerView*e.slidesPerColumn)));for(var T,$=e.slidesPerColumn,x=C/$,E=Math.floor(u/e.slidesPerColumn),A=0;A<u;A+=1){k=0;var L=c.eq(A);if(e.slidesPerColumn>1){var I=void 0,M=void 0,D=void 0;"column"===e.slidesPerColumnFill?(D=A-(M=Math.floor(A/$))*$,(M>E||M===E&&D===$-1)&&(D+=1)>=$&&(D=0,M+=1),I=M+D*C/$,L.css({"-webkit-box-ordinal-group":I,"-moz-box-ordinal-group":I,"-ms-flex-order":I,"-webkit-order":I,order:I})):M=A-(D=Math.floor(A/x))*x,L.css("margin-"+(this.isHorizontal()?"top":"left"),0!==D&&e.spaceBetween&&e.spaceBetween+"px").attr("data-swiper-column",M).attr("data-swiper-row",D)}if("none"!==L.css("display")){if("auto"===e.slidesPerView){var O=t.getComputedStyle(L[0],null),P=L[0].style.transform,R=L[0].style.webkitTransform;if(P&&(L[0].style.transform="none"),R&&(L[0].style.webkitTransform="none"),e.roundLengths)k=this.isHorizontal()?L.outerWidth(!0):L.outerHeight(!0);else if(this.isHorizontal()){var N=parseFloat(O.getPropertyValue("width")),B=parseFloat(O.getPropertyValue("padding-left")),j=parseFloat(O.getPropertyValue("padding-right")),F=parseFloat(O.getPropertyValue("margin-left")),H=parseFloat(O.getPropertyValue("margin-right")),U=O.getPropertyValue("box-sizing");k=U&&"border-box"===U?N+F+H:N+B+j+F+H}else{var z=parseFloat(O.getPropertyValue("height")),G=parseFloat(O.getPropertyValue("padding-top")),V=parseFloat(O.getPropertyValue("padding-bottom")),W=parseFloat(O.getPropertyValue("margin-top")),q=parseFloat(O.getPropertyValue("margin-bottom")),Y=O.getPropertyValue("box-sizing");k=Y&&"border-box"===Y?z+W+q:z+G+V+W+q}P&&(L[0].style.transform=P),R&&(L[0].style.webkitTransform=R),e.roundLengths&&(k=Math.floor(k))}else k=(o-(e.slidesPerView-1)*y)/e.slidesPerView,e.roundLengths&&(k=Math.floor(k)),c[A]&&(this.isHorizontal()?c[A].style.width=k+"px":c[A].style.height=k+"px");c[A]&&(c[A].swiperSlideSize=k),f.push(k),e.centeredSlides?(w=w+k/2+_/2+y,0===_&&0!==A&&(w=w-o/2-y),0===A&&(w=w-o/2-y),Math.abs(w)<.001&&(w=0),e.roundLengths&&(w=Math.floor(w)),S%e.slidesPerGroup==0&&h.push(w),p.push(w)):(e.roundLengths&&(w=Math.floor(w)),S%e.slidesPerGroup==0&&h.push(w),p.push(w),w=w+k+y),this.virtualSize+=k+y,_=k,S+=1}}if(this.virtualSize=Math.max(this.virtualSize,o)+g,n&&a&&("slide"===e.effect||"coverflow"===e.effect)&&i.css({width:this.virtualSize+e.spaceBetween+"px"}),d.flexbox&&!e.setWrapperSize||(this.isHorizontal()?i.css({width:this.virtualSize+e.spaceBetween+"px"}):i.css({height:this.virtualSize+e.spaceBetween+"px"})),e.slidesPerColumn>1&&(this.virtualSize=(k+e.spaceBetween)*C,this.virtualSize=Math.ceil(this.virtualSize/e.slidesPerColumn)-e.spaceBetween,this.isHorizontal()?i.css({width:this.virtualSize+e.spaceBetween+"px"}):i.css({height:this.virtualSize+e.spaceBetween+"px"}),e.centeredSlides)){T=[];for(var X=0;X<h.length;X+=1){var K=h[X];e.roundLengths&&(K=Math.floor(K)),h[X]<this.virtualSize+h[0]&&T.push(K)}h=T}if(!e.centeredSlides){T=[];for(var J=0;J<h.length;J+=1){var Q=h[J];e.roundLengths&&(Q=Math.floor(Q)),h[J]<=this.virtualSize-o&&T.push(Q)}h=T,Math.floor(this.virtualSize-o)-Math.floor(h[h.length-1])>1&&h.push(this.virtualSize-o)}if(0===h.length&&(h=[0]),0!==e.spaceBetween&&(this.isHorizontal()?n?c.css({marginLeft:y+"px"}):c.css({marginRight:y+"px"}):c.css({marginBottom:y+"px"})),e.centerInsufficientSlides){var Z=0;if(f.forEach(function(t){Z+=t+(e.spaceBetween?e.spaceBetween:0)}),(Z-=e.spaceBetween)<o){var ee=(o-Z)/2;h.forEach(function(e,t){h[t]=e-ee}),p.forEach(function(e,t){p[t]=e+ee})}}l.extend(this,{slides:c,snapGrid:h,slidesGrid:p,slidesSizesGrid:f}),u!==s&&this.emit("slidesLengthChange"),h.length!==v&&(this.params.watchOverflow&&this.checkOverflow(),this.emit("snapGridLengthChange")),p.length!==b&&this.emit("slidesGridLengthChange"),(e.watchSlidesProgress||e.watchSlidesVisibility)&&this.updateSlidesOffset()}},updateAutoHeight:function(e){var t,i=[],o=0;if("number"==typeof e?this.setTransition(e):!0===e&&this.setTransition(this.params.speed),"auto"!==this.params.slidesPerView&&this.params.slidesPerView>1)for(t=0;t<Math.ceil(this.params.slidesPerView);t+=1){var n=this.activeIndex+t;if(n>this.slides.length)break;i.push(this.slides.eq(n)[0])}else i.push(this.slides.eq(this.activeIndex)[0]);for(t=0;t<i.length;t+=1)if(void 0!==i[t]){var a=i[t].offsetHeight;o=a>o?a:o}o&&this.$wrapperEl.css("height",o+"px")},updateSlidesOffset:function(){for(var e=this.slides,t=0;t<e.length;t+=1)e[t].swiperSlideOffset=this.isHorizontal()?e[t].offsetLeft:e[t].offsetTop},updateSlidesProgress:function(e){void 0===e&&(e=this&&this.translate||0);var t=this.params,i=this.slides,n=this.rtlTranslate;if(0!==i.length){void 0===i[0].swiperSlideOffset&&this.updateSlidesOffset();var a=-e;n&&(a=e),i.removeClass(t.slideVisibleClass),this.visibleSlidesIndexes=[],this.visibleSlides=[];for(var r=0;r<i.length;r+=1){var s=i[r],l=(a+(t.centeredSlides?this.minTranslate():0)-s.swiperSlideOffset)/(s.swiperSlideSize+t.spaceBetween);if(t.watchSlidesVisibility){var d=-(a-s.swiperSlideOffset),c=d+this.slidesSizesGrid[r];(d>=0&&d<this.size||c>0&&c<=this.size||d<=0&&c>=this.size)&&(this.visibleSlides.push(s),this.visibleSlidesIndexes.push(r),i.eq(r).addClass(t.slideVisibleClass))}s.progress=n?-l:l}this.visibleSlides=o(this.visibleSlides)}},updateProgress:function(e){void 0===e&&(e=this&&this.translate||0);var t=this.params,i=this.maxTranslate()-this.minTranslate(),o=this.progress,n=this.isBeginning,a=this.isEnd,r=n,s=a;0===i?(o=0,n=!0,a=!0):(n=(o=(e-this.minTranslate())/i)<=0,a=o>=1),l.extend(this,{progress:o,isBeginning:n,isEnd:a}),(t.watchSlidesProgress||t.watchSlidesVisibility)&&this.updateSlidesProgress(e),n&&!r&&this.emit("reachBeginning toEdge"),a&&!s&&this.emit("reachEnd toEdge"),(r&&!n||s&&!a)&&this.emit("fromEdge"),this.emit("progress",o)},updateSlidesClasses:function(){var e,t=this.slides,i=this.params,o=this.$wrapperEl,n=this.activeIndex,a=this.realIndex,r=this.virtual&&i.virtual.enabled;t.removeClass(i.slideActiveClass+" "+i.slideNextClass+" "+i.slidePrevClass+" "+i.slideDuplicateActiveClass+" "+i.slideDuplicateNextClass+" "+i.slideDuplicatePrevClass),(e=r?this.$wrapperEl.find("."+i.slideClass+'[data-swiper-slide-index="'+n+'"]'):t.eq(n)).addClass(i.slideActiveClass),i.loop&&(e.hasClass(i.slideDuplicateClass)?o.children("."+i.slideClass+":not(."+i.slideDuplicateClass+')[data-swiper-slide-index="'+a+'"]').addClass(i.slideDuplicateActiveClass):o.children("."+i.slideClass+"."+i.slideDuplicateClass+'[data-swiper-slide-index="'+a+'"]').addClass(i.slideDuplicateActiveClass));var s=e.nextAll("."+i.slideClass).eq(0).addClass(i.slideNextClass);i.loop&&0===s.length&&(s=t.eq(0)).addClass(i.slideNextClass);var l=e.prevAll("."+i.slideClass).eq(0).addClass(i.slidePrevClass);i.loop&&0===l.length&&(l=t.eq(-1)).addClass(i.slidePrevClass),i.loop&&(s.hasClass(i.slideDuplicateClass)?o.children("."+i.slideClass+":not(."+i.slideDuplicateClass+')[data-swiper-slide-index="'+s.attr("data-swiper-slide-index")+'"]').addClass(i.slideDuplicateNextClass):o.children("."+i.slideClass+"."+i.slideDuplicateClass+'[data-swiper-slide-index="'+s.attr("data-swiper-slide-index")+'"]').addClass(i.slideDuplicateNextClass),l.hasClass(i.slideDuplicateClass)?o.children("."+i.slideClass+":not(."+i.slideDuplicateClass+')[data-swiper-slide-index="'+l.attr("data-swiper-slide-index")+'"]').addClass(i.slideDuplicatePrevClass):o.children("."+i.slideClass+"."+i.slideDuplicateClass+'[data-swiper-slide-index="'+l.attr("data-swiper-slide-index")+'"]').addClass(i.slideDuplicatePrevClass))},updateActiveIndex:function(e){var t,i=this.rtlTranslate?this.translate:-this.translate,o=this.slidesGrid,n=this.snapGrid,a=this.params,r=this.activeIndex,s=this.realIndex,d=this.snapIndex,c=e;if(void 0===c){for(var u=0;u<o.length;u+=1)void 0!==o[u+1]?i>=o[u]&&i<o[u+1]-(o[u+1]-o[u])/2?c=u:i>=o[u]&&i<o[u+1]&&(c=u+1):i>=o[u]&&(c=u);a.normalizeSlideIndex&&(c<0||void 0===c)&&(c=0)}if((t=n.indexOf(i)>=0?n.indexOf(i):Math.floor(c/a.slidesPerGroup))>=n.length&&(t=n.length-1),c!==r){var h=parseInt(this.slides.eq(c).attr("data-swiper-slide-index")||c,10);l.extend(this,{snapIndex:t,realIndex:h,previousIndex:r,activeIndex:c}),this.emit("activeIndexChange"),this.emit("snapIndexChange"),s!==h&&this.emit("realIndexChange"),this.emit("slideChange")}else t!==d&&(this.snapIndex=t,this.emit("snapIndexChange"))},updateClickedSlide:function(e){var t=this.params,i=o(e.target).closest("."+t.slideClass)[0],n=!1;if(i)for(var a=0;a<this.slides.length;a+=1)this.slides[a]===i&&(n=!0);if(!i||!n)return this.clickedSlide=void 0,void(this.clickedIndex=void 0);this.clickedSlide=i,this.virtual&&this.params.virtual.enabled?this.clickedIndex=parseInt(o(i).attr("data-swiper-slide-index"),10):this.clickedIndex=o(i).index(),t.slideToClickedSlide&&void 0!==this.clickedIndex&&this.clickedIndex!==this.activeIndex&&this.slideToClickedSlide()}};var f={getTranslate:function(e){void 0===e&&(e=this.isHorizontal()?"x":"y");var t=this.params,i=this.rtlTranslate,o=this.translate,n=this.$wrapperEl;if(t.virtualTranslate)return i?-o:o;var a=l.getTranslate(n[0],e);return i&&(a=-a),a||0},setTranslate:function(e,t){var i=this.rtlTranslate,o=this.params,n=this.$wrapperEl,a=this.progress,r=0,s=0;this.isHorizontal()?r=i?-e:e:s=e,o.roundLengths&&(r=Math.floor(r),s=Math.floor(s)),o.virtualTranslate||(d.transforms3d?n.transform("translate3d("+r+"px, "+s+"px, 0px)"):n.transform("translate("+r+"px, "+s+"px)")),this.previousTranslate=this.translate,this.translate=this.isHorizontal()?r:s;var l=this.maxTranslate()-this.minTranslate();(0===l?0:(e-this.minTranslate())/l)!==a&&this.updateProgress(e),this.emit("setTranslate",this.translate,t)},minTranslate:function(){return-this.snapGrid[0]},maxTranslate:function(){return-this.snapGrid[this.snapGrid.length-1]}};var m={setTransition:function(e,t){this.$wrapperEl.transition(e),this.emit("setTransition",e,t)},transitionStart:function(e,t){void 0===e&&(e=!0);var i=this.activeIndex,o=this.params,n=this.previousIndex;o.autoHeight&&this.updateAutoHeight();var a=t;if(a||(a=i>n?"next":i<n?"prev":"reset"),this.emit("transitionStart"),e&&i!==n){if("reset"===a)return void this.emit("slideResetTransitionStart");this.emit("slideChangeTransitionStart"),"next"===a?this.emit("slideNextTransitionStart"):this.emit("slidePrevTransitionStart")}},transitionEnd:function(e,t){void 0===e&&(e=!0);var i=this.activeIndex,o=this.previousIndex;this.animating=!1,this.setTransition(0);var n=t;if(n||(n=i>o?"next":i<o?"prev":"reset"),this.emit("transitionEnd"),e&&i!==o){if("reset"===n)return void this.emit("slideResetTransitionEnd");this.emit("slideChangeTransitionEnd"),"next"===n?this.emit("slideNextTransitionEnd"):this.emit("slidePrevTransitionEnd")}}};var g={slideTo:function(e,t,i,o){void 0===e&&(e=0),void 0===t&&(t=this.params.speed),void 0===i&&(i=!0);var n=this,a=e;a<0&&(a=0);var r=n.params,s=n.snapGrid,l=n.slidesGrid,c=n.previousIndex,u=n.activeIndex,h=n.rtlTranslate;if(n.animating&&r.preventInteractionOnTransition)return!1;var p=Math.floor(a/r.slidesPerGroup);p>=s.length&&(p=s.length-1),(u||r.initialSlide||0)===(c||0)&&i&&n.emit("beforeSlideChangeStart");var f,m=-s[p];if(n.updateProgress(m),r.normalizeSlideIndex)for(var g=0;g<l.length;g+=1)-Math.floor(100*m)>=Math.floor(100*l[g])&&(a=g);if(n.initialized&&a!==u){if(!n.allowSlideNext&&m<n.translate&&m<n.minTranslate())return!1;if(!n.allowSlidePrev&&m>n.translate&&m>n.maxTranslate()&&(u||0)!==a)return!1}return f=a>u?"next":a<u?"prev":"reset",h&&-m===n.translate||!h&&m===n.translate?(n.updateActiveIndex(a),r.autoHeight&&n.updateAutoHeight(),n.updateSlidesClasses(),"slide"!==r.effect&&n.setTranslate(m),"reset"!==f&&(n.transitionStart(i,f),n.transitionEnd(i,f)),!1):(0!==t&&d.transition?(n.setTransition(t),n.setTranslate(m),n.updateActiveIndex(a),n.updateSlidesClasses(),n.emit("beforeTransitionStart",t,o),n.transitionStart(i,f),n.animating||(n.animating=!0,n.onSlideToWrapperTransitionEnd||(n.onSlideToWrapperTransitionEnd=function(e){n&&!n.destroyed&&e.target===this&&(n.$wrapperEl[0].removeEventListener("transitionend",n.onSlideToWrapperTransitionEnd),n.$wrapperEl[0].removeEventListener("webkitTransitionEnd",n.onSlideToWrapperTransitionEnd),n.onSlideToWrapperTransitionEnd=null,delete n.onSlideToWrapperTransitionEnd,n.transitionEnd(i,f))}),n.$wrapperEl[0].addEventListener("transitionend",n.onSlideToWrapperTransitionEnd),n.$wrapperEl[0].addEventListener("webkitTransitionEnd",n.onSlideToWrapperTransitionEnd))):(n.setTransition(0),n.setTranslate(m),n.updateActiveIndex(a),n.updateSlidesClasses(),n.emit("beforeTransitionStart",t,o),n.transitionStart(i,f),n.transitionEnd(i,f)),!0)},slideToLoop:function(e,t,i,o){void 0===e&&(e=0),void 0===t&&(t=this.params.speed),void 0===i&&(i=!0);var n=e;return this.params.loop&&(n+=this.loopedSlides),this.slideTo(n,t,i,o)},slideNext:function(e,t,i){void 0===e&&(e=this.params.speed),void 0===t&&(t=!0);var o=this.params,n=this.animating;return o.loop?!n&&(this.loopFix(),this._clientLeft=this.$wrapperEl[0].clientLeft,this.slideTo(this.activeIndex+o.slidesPerGroup,e,t,i)):this.slideTo(this.activeIndex+o.slidesPerGroup,e,t,i)},slidePrev:function(e,t,i){void 0===e&&(e=this.params.speed),void 0===t&&(t=!0);var o=this.params,n=this.animating,a=this.snapGrid,r=this.slidesGrid,s=this.rtlTranslate;if(o.loop){if(n)return!1;this.loopFix(),this._clientLeft=this.$wrapperEl[0].clientLeft}function l(e){return e<0?-Math.floor(Math.abs(e)):Math.floor(e)}var d,c=l(s?this.translate:-this.translate),u=a.map(function(e){return l(e)}),h=(r.map(function(e){return l(e)}),a[u.indexOf(c)],a[u.indexOf(c)-1]);return void 0!==h&&(d=r.indexOf(h))<0&&(d=this.activeIndex-1),this.slideTo(d,e,t,i)},slideReset:function(e,t,i){return void 0===e&&(e=this.params.speed),void 0===t&&(t=!0),this.slideTo(this.activeIndex,e,t,i)},slideToClosest:function(e,t,i){void 0===e&&(e=this.params.speed),void 0===t&&(t=!0);var o=this.activeIndex,n=Math.floor(o/this.params.slidesPerGroup);if(n<this.snapGrid.length-1){var a=this.rtlTranslate?this.translate:-this.translate,r=this.snapGrid[n];a-r>(this.snapGrid[n+1]-r)/2&&(o=this.params.slidesPerGroup)}return this.slideTo(o,e,t,i)},slideToClickedSlide:function(){var e,t=this,i=t.params,n=t.$wrapperEl,a="auto"===i.slidesPerView?t.slidesPerViewDynamic():i.slidesPerView,r=t.clickedIndex;if(i.loop){if(t.animating)return;e=parseInt(o(t.clickedSlide).attr("data-swiper-slide-index"),10),i.centeredSlides?r<t.loopedSlides-a/2||r>t.slides.length-t.loopedSlides+a/2?(t.loopFix(),r=n.children("."+i.slideClass+'[data-swiper-slide-index="'+e+'"]:not(.'+i.slideDuplicateClass+")").eq(0).index(),l.nextTick(function(){t.slideTo(r)})):t.slideTo(r):r>t.slides.length-a?(t.loopFix(),r=n.children("."+i.slideClass+'[data-swiper-slide-index="'+e+'"]:not(.'+i.slideDuplicateClass+")").eq(0).index(),l.nextTick(function(){t.slideTo(r)})):t.slideTo(r)}else t.slideTo(r)}};var v={loopCreate:function(){var t=this,i=t.params,n=t.$wrapperEl;n.children("."+i.slideClass+"."+i.slideDuplicateClass).remove();var a=n.children("."+i.slideClass);if(i.loopFillGroupWithBlank){var r=i.slidesPerGroup-a.length%i.slidesPerGroup;if(r!==i.slidesPerGroup){for(var s=0;s<r;s+=1){var l=o(e.createElement("div")).addClass(i.slideClass+" "+i.slideBlankClass);n.append(l)}a=n.children("."+i.slideClass)}}"auto"!==i.slidesPerView||i.loopedSlides||(i.loopedSlides=a.length),t.loopedSlides=parseInt(i.loopedSlides||i.slidesPerView,10),t.loopedSlides+=i.loopAdditionalSlides,t.loopedSlides>a.length&&(t.loopedSlides=a.length);var d=[],c=[];a.each(function(e,i){var n=o(i);e<t.loopedSlides&&c.push(i),e<a.length&&e>=a.length-t.loopedSlides&&d.push(i),n.attr("data-swiper-slide-index",e)});for(var u=0;u<c.length;u+=1)n.append(o(c[u].cloneNode(!0)).addClass(i.slideDuplicateClass));for(var h=d.length-1;h>=0;h-=1)n.prepend(o(d[h].cloneNode(!0)).addClass(i.slideDuplicateClass))},loopFix:function(){var e,t=this.params,i=this.activeIndex,o=this.slides,n=this.loopedSlides,a=this.allowSlidePrev,r=this.allowSlideNext,s=this.snapGrid,l=this.rtlTranslate;this.allowSlidePrev=!0,this.allowSlideNext=!0;var d=-s[i]-this.getTranslate();i<n?(e=o.length-3*n+i,e+=n,this.slideTo(e,0,!1,!0)&&0!==d&&this.setTranslate((l?-this.translate:this.translate)-d)):("auto"===t.slidesPerView&&i>=2*n||i>=o.length-n)&&(e=-o.length+i+n,e+=n,this.slideTo(e,0,!1,!0)&&0!==d&&this.setTranslate((l?-this.translate:this.translate)-d));this.allowSlidePrev=a,this.allowSlideNext=r},loopDestroy:function(){var e=this.$wrapperEl,t=this.params,i=this.slides;e.children("."+t.slideClass+"."+t.slideDuplicateClass+",."+t.slideClass+"."+t.slideBlankClass).remove(),i.removeAttr("data-swiper-slide-index")}};var b={setGrabCursor:function(e){if(!(d.touch||!this.params.simulateTouch||this.params.watchOverflow&&this.isLocked)){var t=this.el;t.style.cursor="move",t.style.cursor=e?"-webkit-grabbing":"-webkit-grab",t.style.cursor=e?"-moz-grabbin":"-moz-grab",t.style.cursor=e?"grabbing":"grab"}},unsetGrabCursor:function(){d.touch||this.params.watchOverflow&&this.isLocked||(this.el.style.cursor="")}};var y={appendSlide:function(e){var t=this.$wrapperEl,i=this.params;if(i.loop&&this.loopDestroy(),"object"==typeof e&&"length"in e)for(var o=0;o<e.length;o+=1)e[o]&&t.append(e[o]);else t.append(e);i.loop&&this.loopCreate(),i.observer&&d.observer||this.update()},prependSlide:function(e){var t=this.params,i=this.$wrapperEl,o=this.activeIndex;t.loop&&this.loopDestroy();var n=o+1;if("object"==typeof e&&"length"in e){for(var a=0;a<e.length;a+=1)e[a]&&i.prepend(e[a]);n=o+e.length}else i.prepend(e);t.loop&&this.loopCreate(),t.observer&&d.observer||this.update(),this.slideTo(n,0,!1)},addSlide:function(e,t){var i=this.$wrapperEl,o=this.params,n=this.activeIndex;o.loop&&(n-=this.loopedSlides,this.loopDestroy(),this.slides=i.children("."+o.slideClass));var a=this.slides.length;if(e<=0)this.prependSlide(t);else if(e>=a)this.appendSlide(t);else{for(var r=n>e?n+1:n,s=[],l=a-1;l>=e;l-=1){var c=this.slides.eq(l);c.remove(),s.unshift(c)}if("object"==typeof t&&"length"in t){for(var u=0;u<t.length;u+=1)t[u]&&i.append(t[u]);r=n>e?n+t.length:n}else i.append(t);for(var h=0;h<s.length;h+=1)i.append(s[h]);o.loop&&this.loopCreate(),o.observer&&d.observer||this.update(),o.loop?this.slideTo(r+this.loopedSlides,0,!1):this.slideTo(r,0,!1)}},removeSlide:function(e){var t=this.params,i=this.$wrapperEl,o=this.activeIndex;t.loop&&(o-=this.loopedSlides,this.loopDestroy(),this.slides=i.children("."+t.slideClass));var n,a=o;if("object"==typeof e&&"length"in e){for(var r=0;r<e.length;r+=1)n=e[r],this.slides[n]&&this.slides.eq(n).remove(),n<a&&(a-=1);a=Math.max(a,0)}else n=e,this.slides[n]&&this.slides.eq(n).remove(),n<a&&(a-=1),a=Math.max(a,0);t.loop&&this.loopCreate(),t.observer&&d.observer||this.update(),t.loop?this.slideTo(a+this.loopedSlides,0,!1):this.slideTo(a,0,!1)},removeAllSlides:function(){for(var e=[],t=0;t<this.slides.length;t+=1)e.push(t);this.removeSlide(e)}},w=function(){var i=t.navigator.userAgent,o={ios:!1,android:!1,androidChrome:!1,desktop:!1,windows:!1,iphone:!1,ipod:!1,ipad:!1,cordova:t.cordova||t.phonegap,phonegap:t.cordova||t.phonegap},n=i.match(/(Windows Phone);?[\s\/]+([\d.]+)?/),a=i.match(/(Android);?[\s\/]+([\d.]+)?/),r=i.match(/(iPad).*OS\s([\d_]+)/),s=i.match(/(iPod)(.*OS\s([\d_]+))?/),l=!r&&i.match(/(iPhone\sOS|iOS)\s([\d_]+)/);if(n&&(o.os="windows",o.osVersion=n[2],o.windows=!0),a&&!n&&(o.os="android",o.osVersion=a[2],o.android=!0,o.androidChrome=i.toLowerCase().indexOf("chrome")>=0),(r||l||s)&&(o.os="ios",o.ios=!0),l&&!s&&(o.osVersion=l[2].replace(/_/g,"."),o.iphone=!0),r&&(o.osVersion=r[2].replace(/_/g,"."),o.ipad=!0),s&&(o.osVersion=s[3]?s[3].replace(/_/g,"."):null,o.iphone=!0),o.ios&&o.osVersion&&i.indexOf("Version/")>=0&&"10"===o.osVersion.split(".")[0]&&(o.osVersion=i.toLowerCase().split("version/")[1].split(" ")[0]),o.desktop=!(o.os||o.android||o.webView),o.webView=(l||r||s)&&i.match(/.*AppleWebKit(?!.*Safari)/i),o.os&&"ios"===o.os){var d=o.osVersion.split("."),c=e.querySelector('meta[name="viewport"]');o.minimalUi=!o.webView&&(s||l)&&(1*d[0]==7?1*d[1]>=1:1*d[0]>7)&&c&&c.getAttribute("content").indexOf("minimal-ui")>=0}return o.pixelRatio=t.devicePixelRatio||1,o}();function _(){var e=this.params,t=this.el;if(!t||0!==t.offsetWidth){e.breakpoints&&this.setBreakpoint();var i=this.allowSlideNext,o=this.allowSlidePrev,n=this.snapGrid;if(this.allowSlideNext=!0,this.allowSlidePrev=!0,this.updateSize(),this.updateSlides(),e.freeMode){var a=Math.min(Math.max(this.translate,this.maxTranslate()),this.minTranslate());this.setTranslate(a),this.updateActiveIndex(),this.updateSlidesClasses(),e.autoHeight&&this.updateAutoHeight()}else this.updateSlidesClasses(),("auto"===e.slidesPerView||e.slidesPerView>1)&&this.isEnd&&!this.params.centeredSlides?this.slideTo(this.slides.length-1,0,!1,!0):this.slideTo(this.activeIndex,0,!1,!0);this.allowSlidePrev=o,this.allowSlideNext=i,this.params.watchOverflow&&n!==this.snapGrid&&this.checkOverflow()}}var S={init:!0,direction:"horizontal",touchEventsTarget:"container",initialSlide:0,speed:300,preventInteractionOnTransition:!1,edgeSwipeDetection:!1,edgeSwipeThreshold:20,freeMode:!1,freeModeMomentum:!0,freeModeMomentumRatio:1,freeModeMomentumBounce:!0,freeModeMomentumBounceRatio:1,freeModeMomentumVelocityRatio:1,freeModeSticky:!1,freeModeMinimumVelocity:.02,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsInverse:!1,spaceBetween:0,slidesPerView:1,slidesPerColumn:1,slidesPerColumnFill:"column",slidesPerGroup:1,centeredSlides:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!1,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:0,touchMoveStopPropagation:!0,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,watchSlidesVisibility:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,preloadImages:!0,updateOnImagesReady:!0,loop:!1,loopAdditionalSlides:0,loopedSlides:null,loopFillGroupWithBlank:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,containerModifierClass:"swiper-container-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-invisible-blank",slideActiveClass:"swiper-slide-active",slideDuplicateActiveClass:"swiper-slide-duplicate-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",slideNextClass:"swiper-slide-next",slideDuplicateNextClass:"swiper-slide-duplicate-next",slidePrevClass:"swiper-slide-prev",slideDuplicatePrevClass:"swiper-slide-duplicate-prev",wrapperClass:"swiper-wrapper",runCallbacksOnInit:!0},C={update:p,translate:f,transition:m,slide:g,loop:v,grabCursor:b,manipulation:y,events:{attachEvents:function(){var i=this.params,n=this.touchEvents,a=this.el,r=this.wrapperEl;this.onTouchStart=function(i){var n=this.touchEventsData,a=this.params,r=this.touches;if(!this.animating||!a.preventInteractionOnTransition){var s=i;if(s.originalEvent&&(s=s.originalEvent),n.isTouchEvent="touchstart"===s.type,(n.isTouchEvent||!("which"in s)||3!==s.which)&&!(!n.isTouchEvent&&"button"in s&&s.button>0||n.isTouched&&n.isMoved))if(a.noSwiping&&o(s.target).closest(a.noSwipingSelector?a.noSwipingSelector:"."+a.noSwipingClass)[0])this.allowClick=!0;else if(!a.swipeHandler||o(s).closest(a.swipeHandler)[0]){r.currentX="touchstart"===s.type?s.targetTouches[0].pageX:s.pageX,r.currentY="touchstart"===s.type?s.targetTouches[0].pageY:s.pageY;var d=r.currentX,c=r.currentY,u=a.edgeSwipeDetection||a.iOSEdgeSwipeDetection,h=a.edgeSwipeThreshold||a.iOSEdgeSwipeThreshold;if(!u||!(d<=h||d>=t.screen.width-h)){if(l.extend(n,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),r.startX=d,r.startY=c,n.touchStartTime=l.now(),this.allowClick=!0,this.updateSize(),this.swipeDirection=void 0,a.threshold>0&&(n.allowThresholdMove=!1),"touchstart"!==s.type){var p=!0;o(s.target).is(n.formElements)&&(p=!1),e.activeElement&&o(e.activeElement).is(n.formElements)&&e.activeElement!==s.target&&e.activeElement.blur();var f=p&&this.allowTouchMove&&a.touchStartPreventDefault;(a.touchStartForcePreventDefault||f)&&s.preventDefault()}this.emit("touchStart",s)}}}}.bind(this),this.onTouchMove=function(t){var i=this.touchEventsData,n=this.params,a=this.touches,r=this.rtlTranslate,s=t;if(s.originalEvent&&(s=s.originalEvent),i.isTouched){if(!i.isTouchEvent||"mousemove"!==s.type){var d="touchmove"===s.type?s.targetTouches[0].pageX:s.pageX,c="touchmove"===s.type?s.targetTouches[0].pageY:s.pageY;if(s.preventedByNestedSwiper)return a.startX=d,void(a.startY=c);if(!this.allowTouchMove)return this.allowClick=!1,void(i.isTouched&&(l.extend(a,{startX:d,startY:c,currentX:d,currentY:c}),i.touchStartTime=l.now()));if(i.isTouchEvent&&n.touchReleaseOnEdges&&!n.loop)if(this.isVertical()){if(c<a.startY&&this.translate<=this.maxTranslate()||c>a.startY&&this.translate>=this.minTranslate())return i.isTouched=!1,void(i.isMoved=!1)}else if(d<a.startX&&this.translate<=this.maxTranslate()||d>a.startX&&this.translate>=this.minTranslate())return;if(i.isTouchEvent&&e.activeElement&&s.target===e.activeElement&&o(s.target).is(i.formElements))return i.isMoved=!0,void(this.allowClick=!1);if(i.allowTouchCallbacks&&this.emit("touchMove",s),!(s.targetTouches&&s.targetTouches.length>1)){a.currentX=d,a.currentY=c;var u,h=a.currentX-a.startX,p=a.currentY-a.startY;if(!(this.params.threshold&&Math.sqrt(Math.pow(h,2)+Math.pow(p,2))<this.params.threshold))if(void 0===i.isScrolling&&(this.isHorizontal()&&a.currentY===a.startY||this.isVertical()&&a.currentX===a.startX?i.isScrolling=!1:h*h+p*p>=25&&(u=180*Math.atan2(Math.abs(p),Math.abs(h))/Math.PI,i.isScrolling=this.isHorizontal()?u>n.touchAngle:90-u>n.touchAngle)),i.isScrolling&&this.emit("touchMoveOpposite",s),void 0===i.startMoving&&(a.currentX===a.startX&&a.currentY===a.startY||(i.startMoving=!0)),i.isScrolling)i.isTouched=!1;else if(i.startMoving){this.allowClick=!1,s.preventDefault(),n.touchMoveStopPropagation&&!n.nested&&s.stopPropagation(),i.isMoved||(n.loop&&this.loopFix(),i.startTranslate=this.getTranslate(),this.setTransition(0),this.animating&&this.$wrapperEl.trigger("webkitTransitionEnd transitionend"),i.allowMomentumBounce=!1,!n.grabCursor||!0!==this.allowSlideNext&&!0!==this.allowSlidePrev||this.setGrabCursor(!0),this.emit("sliderFirstMove",s)),this.emit("sliderMove",s),i.isMoved=!0;var f=this.isHorizontal()?h:p;a.diff=f,f*=n.touchRatio,r&&(f=-f),this.swipeDirection=f>0?"prev":"next",i.currentTranslate=f+i.startTranslate;var m=!0,g=n.resistanceRatio;if(n.touchReleaseOnEdges&&(g=0),f>0&&i.currentTranslate>this.minTranslate()?(m=!1,n.resistance&&(i.currentTranslate=this.minTranslate()-1+Math.pow(-this.minTranslate()+i.startTranslate+f,g))):f<0&&i.currentTranslate<this.maxTranslate()&&(m=!1,n.resistance&&(i.currentTranslate=this.maxTranslate()+1-Math.pow(this.maxTranslate()-i.startTranslate-f,g))),m&&(s.preventedByNestedSwiper=!0),!this.allowSlideNext&&"next"===this.swipeDirection&&i.currentTranslate<i.startTranslate&&(i.currentTranslate=i.startTranslate),!this.allowSlidePrev&&"prev"===this.swipeDirection&&i.currentTranslate>i.startTranslate&&(i.currentTranslate=i.startTranslate),n.threshold>0){if(!(Math.abs(f)>n.threshold||i.allowThresholdMove))return void(i.currentTranslate=i.startTranslate);if(!i.allowThresholdMove)return i.allowThresholdMove=!0,a.startX=a.currentX,a.startY=a.currentY,i.currentTranslate=i.startTranslate,void(a.diff=this.isHorizontal()?a.currentX-a.startX:a.currentY-a.startY)}n.followFinger&&((n.freeMode||n.watchSlidesProgress||n.watchSlidesVisibility)&&(this.updateActiveIndex(),this.updateSlidesClasses()),n.freeMode&&(0===i.velocities.length&&i.velocities.push({position:a[this.isHorizontal()?"startX":"startY"],time:i.touchStartTime}),i.velocities.push({position:a[this.isHorizontal()?"currentX":"currentY"],time:l.now()})),this.updateProgress(i.currentTranslate),this.setTranslate(i.currentTranslate))}}}}else i.startMoving&&i.isScrolling&&this.emit("touchMoveOpposite",s)}.bind(this),this.onTouchEnd=function(e){var t=this,i=t.touchEventsData,o=t.params,n=t.touches,a=t.rtlTranslate,r=t.$wrapperEl,s=t.slidesGrid,d=t.snapGrid,c=e;if(c.originalEvent&&(c=c.originalEvent),i.allowTouchCallbacks&&t.emit("touchEnd",c),i.allowTouchCallbacks=!1,!i.isTouched)return i.isMoved&&o.grabCursor&&t.setGrabCursor(!1),i.isMoved=!1,void(i.startMoving=!1);o.grabCursor&&i.isMoved&&i.isTouched&&(!0===t.allowSlideNext||!0===t.allowSlidePrev)&&t.setGrabCursor(!1);var u,h=l.now(),p=h-i.touchStartTime;if(t.allowClick&&(t.updateClickedSlide(c),t.emit("tap",c),p<300&&h-i.lastClickTime>300&&(i.clickTimeout&&clearTimeout(i.clickTimeout),i.clickTimeout=l.nextTick(function(){t&&!t.destroyed&&t.emit("click",c)},300)),p<300&&h-i.lastClickTime<300&&(i.clickTimeout&&clearTimeout(i.clickTimeout),t.emit("doubleTap",c))),i.lastClickTime=l.now(),l.nextTick(function(){t.destroyed||(t.allowClick=!0)}),!i.isTouched||!i.isMoved||!t.swipeDirection||0===n.diff||i.currentTranslate===i.startTranslate)return i.isTouched=!1,i.isMoved=!1,void(i.startMoving=!1);if(i.isTouched=!1,i.isMoved=!1,i.startMoving=!1,u=o.followFinger?a?t.translate:-t.translate:-i.currentTranslate,o.freeMode){if(u<-t.minTranslate())return void t.slideTo(t.activeIndex);if(u>-t.maxTranslate())return void(t.slides.length<d.length?t.slideTo(d.length-1):t.slideTo(t.slides.length-1));if(o.freeModeMomentum){if(i.velocities.length>1){var f=i.velocities.pop(),m=i.velocities.pop(),g=f.position-m.position,v=f.time-m.time;t.velocity=g/v,t.velocity/=2,Math.abs(t.velocity)<o.freeModeMinimumVelocity&&(t.velocity=0),(v>150||l.now()-f.time>300)&&(t.velocity=0)}else t.velocity=0;t.velocity*=o.freeModeMomentumVelocityRatio,i.velocities.length=0;var b=1e3*o.freeModeMomentumRatio,y=t.velocity*b,w=t.translate+y;a&&(w=-w);var _,S,C=!1,k=20*Math.abs(t.velocity)*o.freeModeMomentumBounceRatio;if(w<t.maxTranslate())o.freeModeMomentumBounce?(w+t.maxTranslate()<-k&&(w=t.maxTranslate()-k),_=t.maxTranslate(),C=!0,i.allowMomentumBounce=!0):w=t.maxTranslate(),o.loop&&o.centeredSlides&&(S=!0);else if(w>t.minTranslate())o.freeModeMomentumBounce?(w-t.minTranslate()>k&&(w=t.minTranslate()+k),_=t.minTranslate(),C=!0,i.allowMomentumBounce=!0):w=t.minTranslate(),o.loop&&o.centeredSlides&&(S=!0);else if(o.freeModeSticky){for(var T,$=0;$<d.length;$+=1)if(d[$]>-w){T=$;break}w=-(w=Math.abs(d[T]-w)<Math.abs(d[T-1]-w)||"next"===t.swipeDirection?d[T]:d[T-1])}if(S&&t.once("transitionEnd",function(){t.loopFix()}),0!==t.velocity)b=a?Math.abs((-w-t.translate)/t.velocity):Math.abs((w-t.translate)/t.velocity);else if(o.freeModeSticky)return void t.slideToClosest();o.freeModeMomentumBounce&&C?(t.updateProgress(_),t.setTransition(b),t.setTranslate(w),t.transitionStart(!0,t.swipeDirection),t.animating=!0,r.transitionEnd(function(){t&&!t.destroyed&&i.allowMomentumBounce&&(t.emit("momentumBounce"),t.setTransition(o.speed),t.setTranslate(_),r.transitionEnd(function(){t&&!t.destroyed&&t.transitionEnd()}))})):t.velocity?(t.updateProgress(w),t.setTransition(b),t.setTranslate(w),t.transitionStart(!0,t.swipeDirection),t.animating||(t.animating=!0,r.transitionEnd(function(){t&&!t.destroyed&&t.transitionEnd()}))):t.updateProgress(w),t.updateActiveIndex(),t.updateSlidesClasses()}else if(o.freeModeSticky)return void t.slideToClosest();(!o.freeModeMomentum||p>=o.longSwipesMs)&&(t.updateProgress(),t.updateActiveIndex(),t.updateSlidesClasses())}else{for(var x=0,E=t.slidesSizesGrid[0],A=0;A<s.length;A+=o.slidesPerGroup)void 0!==s[A+o.slidesPerGroup]?u>=s[A]&&u<s[A+o.slidesPerGroup]&&(x=A,E=s[A+o.slidesPerGroup]-s[A]):u>=s[A]&&(x=A,E=s[s.length-1]-s[s.length-2]);var L=(u-s[x])/E;if(p>o.longSwipesMs){if(!o.longSwipes)return void t.slideTo(t.activeIndex);"next"===t.swipeDirection&&(L>=o.longSwipesRatio?t.slideTo(x+o.slidesPerGroup):t.slideTo(x)),"prev"===t.swipeDirection&&(L>1-o.longSwipesRatio?t.slideTo(x+o.slidesPerGroup):t.slideTo(x))}else{if(!o.shortSwipes)return void t.slideTo(t.activeIndex);"next"===t.swipeDirection&&t.slideTo(x+o.slidesPerGroup),"prev"===t.swipeDirection&&t.slideTo(x)}}}.bind(this),this.onClick=function(e){this.allowClick||(this.params.preventClicks&&e.preventDefault(),this.params.preventClicksPropagation&&this.animating&&(e.stopPropagation(),e.stopImmediatePropagation()))}.bind(this);var s="container"===i.touchEventsTarget?a:r,c=!!i.nested;if(d.touch||!d.pointerEvents&&!d.prefixedPointerEvents){if(d.touch){var u=!("touchstart"!==n.start||!d.passiveListener||!i.passiveListeners)&&{passive:!0,capture:!1};s.addEventListener(n.start,this.onTouchStart,u),s.addEventListener(n.move,this.onTouchMove,d.passiveListener?{passive:!1,capture:c}:c),s.addEventListener(n.end,this.onTouchEnd,u)}(i.simulateTouch&&!w.ios&&!w.android||i.simulateTouch&&!d.touch&&w.ios)&&(s.addEventListener("mousedown",this.onTouchStart,!1),e.addEventListener("mousemove",this.onTouchMove,c),e.addEventListener("mouseup",this.onTouchEnd,!1))}else s.addEventListener(n.start,this.onTouchStart,!1),e.addEventListener(n.move,this.onTouchMove,c),e.addEventListener(n.end,this.onTouchEnd,!1);(i.preventClicks||i.preventClicksPropagation)&&s.addEventListener("click",this.onClick,!0),this.on(w.ios||w.android?"resize orientationchange observerUpdate":"resize observerUpdate",_,!0)},detachEvents:function(){var t=this.params,i=this.touchEvents,o=this.el,n=this.wrapperEl,a="container"===t.touchEventsTarget?o:n,r=!!t.nested;if(d.touch||!d.pointerEvents&&!d.prefixedPointerEvents){if(d.touch){var s=!("onTouchStart"!==i.start||!d.passiveListener||!t.passiveListeners)&&{passive:!0,capture:!1};a.removeEventListener(i.start,this.onTouchStart,s),a.removeEventListener(i.move,this.onTouchMove,r),a.removeEventListener(i.end,this.onTouchEnd,s)}(t.simulateTouch&&!w.ios&&!w.android||t.simulateTouch&&!d.touch&&w.ios)&&(a.removeEventListener("mousedown",this.onTouchStart,!1),e.removeEventListener("mousemove",this.onTouchMove,r),e.removeEventListener("mouseup",this.onTouchEnd,!1))}else a.removeEventListener(i.start,this.onTouchStart,!1),e.removeEventListener(i.move,this.onTouchMove,r),e.removeEventListener(i.end,this.onTouchEnd,!1);(t.preventClicks||t.preventClicksPropagation)&&a.removeEventListener("click",this.onClick,!0),this.off(w.ios||w.android?"resize orientationchange observerUpdate":"resize observerUpdate",_)}},breakpoints:{setBreakpoint:function(){var e=this.activeIndex,t=this.initialized,i=this.loopedSlides;void 0===i&&(i=0);var o=this.params,n=o.breakpoints;if(n&&(!n||0!==Object.keys(n).length)){var a=this.getBreakpoint(n);if(a&&this.currentBreakpoint!==a){var r=a in n?n[a]:void 0;r&&["slidesPerView","spaceBetween","slidesPerGroup"].forEach(function(e){var t=r[e];void 0!==t&&(r[e]="slidesPerView"!==e||"AUTO"!==t&&"auto"!==t?"slidesPerView"===e?parseFloat(t):parseInt(t,10):"auto")});var s=r||this.originalParams,d=s.direction&&s.direction!==o.direction,c=o.loop&&(s.slidesPerView!==o.slidesPerView||d);d&&t&&this.changeDirection(),l.extend(this.params,s),l.extend(this,{allowTouchMove:this.params.allowTouchMove,allowSlideNext:this.params.allowSlideNext,allowSlidePrev:this.params.allowSlidePrev}),this.currentBreakpoint=a,c&&t&&(this.loopDestroy(),this.loopCreate(),this.updateSlides(),this.slideTo(e-i+this.loopedSlides,0,!1)),this.emit("breakpoint",s)}}},getBreakpoint:function(e){if(e){var i=!1,o=[];Object.keys(e).forEach(function(e){o.push(e)}),o.sort(function(e,t){return parseInt(e,10)-parseInt(t,10)});for(var n=0;n<o.length;n+=1){var a=o[n];this.params.breakpointsInverse?a<=t.innerWidth&&(i=a):a>=t.innerWidth&&!i&&(i=a)}return i||"max"}}},checkOverflow:{checkOverflow:function(){var e=this.isLocked;this.isLocked=1===this.snapGrid.length,this.allowSlideNext=!this.isLocked,this.allowSlidePrev=!this.isLocked,e!==this.isLocked&&this.emit(this.isLocked?"lock":"unlock"),e&&e!==this.isLocked&&(this.isEnd=!1,this.navigation.update())}},classes:{addClasses:function(){var e=this.classNames,t=this.params,i=this.rtl,o=this.$el,n=[];n.push("initialized"),n.push(t.direction),t.freeMode&&n.push("free-mode"),d.flexbox||n.push("no-flexbox"),t.autoHeight&&n.push("autoheight"),i&&n.push("rtl"),t.slidesPerColumn>1&&n.push("multirow"),w.android&&n.push("android"),w.ios&&n.push("ios"),(c.isIE||c.isEdge)&&(d.pointerEvents||d.prefixedPointerEvents)&&n.push("wp8-"+t.direction),n.forEach(function(i){e.push(t.containerModifierClass+i)}),o.addClass(e.join(" "))},removeClasses:function(){var e=this.$el,t=this.classNames;e.removeClass(t.join(" "))}},images:{loadImage:function(e,i,o,n,a,r){var s;function l(){r&&r()}e.complete&&a?l():i?((s=new t.Image).onload=l,s.onerror=l,n&&(s.sizes=n),o&&(s.srcset=o),i&&(s.src=i)):l()},preloadImages:function(){var e=this;function t(){void 0!==e&&null!==e&&e&&!e.destroyed&&(void 0!==e.imagesLoaded&&(e.imagesLoaded+=1),e.imagesLoaded===e.imagesToLoad.length&&(e.params.updateOnImagesReady&&e.update(),e.emit("imagesReady")))}e.imagesToLoad=e.$el.find("img");for(var i=0;i<e.imagesToLoad.length;i+=1){var o=e.imagesToLoad[i];e.loadImage(o,o.currentSrc||o.getAttribute("src"),o.srcset||o.getAttribute("srcset"),o.sizes||o.getAttribute("sizes"),!0,t)}}}},k={},T=function(e){function t(){for(var i,n,a,r=[],s=arguments.length;s--;)r[s]=arguments[s];1===r.length&&r[0].constructor&&r[0].constructor===Object?a=r[0]:(n=(i=r)[0],a=i[1]),a||(a={}),a=l.extend({},a),n&&!a.el&&(a.el=n),e.call(this,a),Object.keys(C).forEach(function(e){Object.keys(C[e]).forEach(function(i){t.prototype[i]||(t.prototype[i]=C[e][i])})});var c=this;void 0===c.modules&&(c.modules={}),Object.keys(c.modules).forEach(function(e){var t=c.modules[e];if(t.params){var i=Object.keys(t.params)[0],o=t.params[i];if("object"!=typeof o||null===o)return;if(!(i in a&&"enabled"in o))return;!0===a[i]&&(a[i]={enabled:!0}),"object"!=typeof a[i]||"enabled"in a[i]||(a[i].enabled=!0),a[i]||(a[i]={enabled:!1})}});var u=l.extend({},S);c.useModulesParams(u),c.params=l.extend({},u,k,a),c.originalParams=l.extend({},c.params),c.passedParams=l.extend({},a),c.$=o;var h=o(c.params.el);if(n=h[0]){if(h.length>1){var p=[];return h.each(function(e,i){var o=l.extend({},a,{el:i});p.push(new t(o))}),p}n.swiper=c,h.data("swiper",c);var f,m,g=h.children("."+c.params.wrapperClass);return l.extend(c,{$el:h,el:n,$wrapperEl:g,wrapperEl:g[0],classNames:[],slides:o(),slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal:function(){return"horizontal"===c.params.direction},isVertical:function(){return"vertical"===c.params.direction},rtl:"rtl"===n.dir.toLowerCase()||"rtl"===h.css("direction"),rtlTranslate:"horizontal"===c.params.direction&&("rtl"===n.dir.toLowerCase()||"rtl"===h.css("direction")),wrongRTL:"-webkit-box"===g.css("display"),activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,allowSlideNext:c.params.allowSlideNext,allowSlidePrev:c.params.allowSlidePrev,touchEvents:(f=["touchstart","touchmove","touchend"],m=["mousedown","mousemove","mouseup"],d.pointerEvents?m=["pointerdown","pointermove","pointerup"]:d.prefixedPointerEvents&&(m=["MSPointerDown","MSPointerMove","MSPointerUp"]),c.touchEventsTouch={start:f[0],move:f[1],end:f[2]},c.touchEventsDesktop={start:m[0],move:m[1],end:m[2]},d.touch||!c.params.simulateTouch?c.touchEventsTouch:c.touchEventsDesktop),touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,formElements:"input, select, option, textarea, button, video",lastClickTime:l.now(),clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,isTouchEvent:void 0,startMoving:void 0},allowClick:!0,allowTouchMove:c.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),c.useModules(),c.params.init&&c.init(),c}}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var i={extendedDefaults:{configurable:!0},defaults:{configurable:!0},Class:{configurable:!0},$:{configurable:!0}};return t.prototype.slidesPerViewDynamic=function(){var e=this.params,t=this.slides,i=this.slidesGrid,o=this.size,n=this.activeIndex,a=1;if(e.centeredSlides){for(var r,s=t[n].swiperSlideSize,l=n+1;l<t.length;l+=1)t[l]&&!r&&(a+=1,(s+=t[l].swiperSlideSize)>o&&(r=!0));for(var d=n-1;d>=0;d-=1)t[d]&&!r&&(a+=1,(s+=t[d].swiperSlideSize)>o&&(r=!0))}else for(var c=n+1;c<t.length;c+=1)i[c]-i[n]<o&&(a+=1);return a},t.prototype.update=function(){var e=this;if(e&&!e.destroyed){var t=e.snapGrid,i=e.params;i.breakpoints&&e.setBreakpoint(),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),e.params.freeMode?(o(),e.params.autoHeight&&e.updateAutoHeight()):(("auto"===e.params.slidesPerView||e.params.slidesPerView>1)&&e.isEnd&&!e.params.centeredSlides?e.slideTo(e.slides.length-1,0,!1,!0):e.slideTo(e.activeIndex,0,!1,!0))||o(),i.watchOverflow&&t!==e.snapGrid&&e.checkOverflow(),e.emit("update")}function o(){var t=e.rtlTranslate?-1*e.translate:e.translate,i=Math.min(Math.max(t,e.maxTranslate()),e.minTranslate());e.setTranslate(i),e.updateActiveIndex(),e.updateSlidesClasses()}},t.prototype.changeDirection=function(e,t){void 0===t&&(t=!0);var i=this.params.direction;return e||(e="horizontal"===i?"vertical":"horizontal"),e===i||"horizontal"!==e&&"vertical"!==e?this:("vertical"===i&&(this.$el.removeClass(this.params.containerModifierClass+"vertical wp8-vertical").addClass(""+this.params.containerModifierClass+e),(c.isIE||c.isEdge)&&(d.pointerEvents||d.prefixedPointerEvents)&&this.$el.addClass(this.params.containerModifierClass+"wp8-"+e)),"horizontal"===i&&(this.$el.removeClass(this.params.containerModifierClass+"horizontal wp8-horizontal").addClass(""+this.params.containerModifierClass+e),(c.isIE||c.isEdge)&&(d.pointerEvents||d.prefixedPointerEvents)&&this.$el.addClass(this.params.containerModifierClass+"wp8-"+e)),this.params.direction=e,this.slides.each(function(t,i){"vertical"===e?i.style.width="":i.style.height=""}),this.emit("changeDirection"),t&&this.update(),this)},t.prototype.init=function(){this.initialized||(this.emit("beforeInit"),this.params.breakpoints&&this.setBreakpoint(),this.addClasses(),this.params.loop&&this.loopCreate(),this.updateSize(),this.updateSlides(),this.params.watchOverflow&&this.checkOverflow(),this.params.grabCursor&&this.setGrabCursor(),this.params.preloadImages&&this.preloadImages(),this.params.loop?this.slideTo(this.params.initialSlide+this.loopedSlides,0,this.params.runCallbacksOnInit):this.slideTo(this.params.initialSlide,0,this.params.runCallbacksOnInit),this.attachEvents(),this.initialized=!0,this.emit("init"))},t.prototype.destroy=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);var i=this,o=i.params,n=i.$el,a=i.$wrapperEl,r=i.slides;return void 0===i.params||i.destroyed?null:(i.emit("beforeDestroy"),i.initialized=!1,i.detachEvents(),o.loop&&i.loopDestroy(),t&&(i.removeClasses(),n.removeAttr("style"),a.removeAttr("style"),r&&r.length&&r.removeClass([o.slideVisibleClass,o.slideActiveClass,o.slideNextClass,o.slidePrevClass].join(" ")).removeAttr("style").removeAttr("data-swiper-slide-index").removeAttr("data-swiper-column").removeAttr("data-swiper-row")),i.emit("destroy"),Object.keys(i.eventsListeners).forEach(function(e){i.off(e)}),!1!==e&&(i.$el[0].swiper=null,i.$el.data("swiper",null),l.deleteProps(i)),i.destroyed=!0,null)},t.extendDefaults=function(e){l.extend(k,e)},i.extendedDefaults.get=function(){return k},i.defaults.get=function(){return S},i.Class.get=function(){return e},i.$.get=function(){return o},Object.defineProperties(t,i),t}(u),$={name:"device",proto:{device:w},static:{device:w}},x={name:"support",proto:{support:d},static:{support:d}},E={name:"browser",proto:{browser:c},static:{browser:c}},A={name:"resize",create:function(){var e=this;l.extend(e,{resize:{resizeHandler:function(){e&&!e.destroyed&&e.initialized&&(e.emit("beforeResize"),e.emit("resize"))},orientationChangeHandler:function(){e&&!e.destroyed&&e.initialized&&e.emit("orientationchange")}}})},on:{init:function(){t.addEventListener("resize",this.resize.resizeHandler),t.addEventListener("orientationchange",this.resize.orientationChangeHandler)},destroy:function(){t.removeEventListener("resize",this.resize.resizeHandler),t.removeEventListener("orientationchange",this.resize.orientationChangeHandler)}}},L={func:t.MutationObserver||t.WebkitMutationObserver,attach:function(e,i){void 0===i&&(i={});var o=this,n=new(0,L.func)(function(e){if(1!==e.length){var i=function(){o.emit("observerUpdate",e[0])};t.requestAnimationFrame?t.requestAnimationFrame(i):t.setTimeout(i,0)}else o.emit("observerUpdate",e[0])});n.observe(e,{attributes:void 0===i.attributes||i.attributes,childList:void 0===i.childList||i.childList,characterData:void 0===i.characterData||i.characterData}),o.observer.observers.push(n)},init:function(){if(d.observer&&this.params.observer){if(this.params.observeParents)for(var e=this.$el.parents(),t=0;t<e.length;t+=1)this.observer.attach(e[t]);this.observer.attach(this.$el[0],{childList:this.params.observeSlideChildren}),this.observer.attach(this.$wrapperEl[0],{attributes:!1})}},destroy:function(){this.observer.observers.forEach(function(e){e.disconnect()}),this.observer.observers=[]}},I={name:"observer",params:{observer:!1,observeParents:!1,observeSlideChildren:!1},create:function(){l.extend(this,{observer:{init:L.init.bind(this),attach:L.attach.bind(this),destroy:L.destroy.bind(this),observers:[]}})},on:{init:function(){this.observer.init()},destroy:function(){this.observer.destroy()}}},M={update:function(e){var t=this,i=t.params,o=i.slidesPerView,n=i.slidesPerGroup,a=i.centeredSlides,r=t.params.virtual,s=r.addSlidesBefore,d=r.addSlidesAfter,c=t.virtual,u=c.from,h=c.to,p=c.slides,f=c.slidesGrid,m=c.renderSlide,g=c.offset;t.updateActiveIndex();var v,b,y,w=t.activeIndex||0;v=t.rtlTranslate?"right":t.isHorizontal()?"left":"top",a?(b=Math.floor(o/2)+n+s,y=Math.floor(o/2)+n+d):(b=o+(n-1)+s,y=n+d);var _=Math.max((w||0)-y,0),S=Math.min((w||0)+b,p.length-1),C=(t.slidesGrid[_]||0)-(t.slidesGrid[0]||0);function k(){t.updateSlides(),t.updateProgress(),t.updateSlidesClasses(),t.lazy&&t.params.lazy.enabled&&t.lazy.load()}if(l.extend(t.virtual,{from:_,to:S,offset:C,slidesGrid:t.slidesGrid}),u===_&&h===S&&!e)return t.slidesGrid!==f&&C!==g&&t.slides.css(v,C+"px"),void t.updateProgress();if(t.params.virtual.renderExternal)return t.params.virtual.renderExternal.call(t,{offset:C,from:_,to:S,slides:function(){for(var e=[],t=_;t<=S;t+=1)e.push(p[t]);return e}()}),void k();var T=[],$=[];if(e)t.$wrapperEl.find("."+t.params.slideClass).remove();else for(var x=u;x<=h;x+=1)(x<_||x>S)&&t.$wrapperEl.find("."+t.params.slideClass+'[data-swiper-slide-index="'+x+'"]').remove();for(var E=0;E<p.length;E+=1)E>=_&&E<=S&&(void 0===h||e?$.push(E):(E>h&&$.push(E),E<u&&T.push(E)));$.forEach(function(e){t.$wrapperEl.append(m(p[e],e))}),T.sort(function(e,t){return t-e}).forEach(function(e){t.$wrapperEl.prepend(m(p[e],e))}),t.$wrapperEl.children(".swiper-slide").css(v,C+"px"),k()},renderSlide:function(e,t){var i=this.params.virtual;if(i.cache&&this.virtual.cache[t])return this.virtual.cache[t];var n=i.renderSlide?o(i.renderSlide.call(this,e,t)):o('<div class="'+this.params.slideClass+'" data-swiper-slide-index="'+t+'">'+e+"</div>");return n.attr("data-swiper-slide-index")||n.attr("data-swiper-slide-index",t),i.cache&&(this.virtual.cache[t]=n),n},appendSlide:function(e){if("object"==typeof e&&"length"in e)for(var t=0;t<e.length;t+=1)e[t]&&this.virtual.slides.push(e[t]);else this.virtual.slides.push(e);this.virtual.update(!0)},prependSlide:function(e){var t=this.activeIndex,i=t+1,o=1;if(Array.isArray(e)){for(var n=0;n<e.length;n+=1)e[n]&&this.virtual.slides.unshift(e[n]);i=t+e.length,o=e.length}else this.virtual.slides.unshift(e);if(this.params.virtual.cache){var a=this.virtual.cache,r={};Object.keys(a).forEach(function(e){r[parseInt(e,10)+o]=a[e]}),this.virtual.cache=r}this.virtual.update(!0),this.slideTo(i,0)},removeSlide:function(e){if(void 0!==e&&null!==e){var t=this.activeIndex;if(Array.isArray(e))for(var i=e.length-1;i>=0;i-=1)this.virtual.slides.splice(e[i],1),this.params.virtual.cache&&delete this.virtual.cache[e[i]],e[i]<t&&(t-=1),t=Math.max(t,0);else this.virtual.slides.splice(e,1),this.params.virtual.cache&&delete this.virtual.cache[e],e<t&&(t-=1),t=Math.max(t,0);this.virtual.update(!0),this.slideTo(t,0)}},removeAllSlides:function(){this.virtual.slides=[],this.params.virtual.cache&&(this.virtual.cache={}),this.virtual.update(!0),this.slideTo(0,0)}},D={name:"virtual",params:{virtual:{enabled:!1,slides:[],cache:!0,renderSlide:null,renderExternal:null,addSlidesBefore:0,addSlidesAfter:0}},create:function(){l.extend(this,{virtual:{update:M.update.bind(this),appendSlide:M.appendSlide.bind(this),prependSlide:M.prependSlide.bind(this),removeSlide:M.removeSlide.bind(this),removeAllSlides:M.removeAllSlides.bind(this),renderSlide:M.renderSlide.bind(this),slides:this.params.virtual.slides,cache:{}}})},on:{beforeInit:function(){if(this.params.virtual.enabled){this.classNames.push(this.params.containerModifierClass+"virtual");var e={watchSlidesProgress:!0};l.extend(this.params,e),l.extend(this.originalParams,e),this.params.initialSlide||this.virtual.update()}},setTranslate:function(){this.params.virtual.enabled&&this.virtual.update()}}},O={handle:function(i){var o=this.rtlTranslate,n=i;n.originalEvent&&(n=n.originalEvent);var a=n.keyCode||n.charCode;if(!this.allowSlideNext&&(this.isHorizontal()&&39===a||this.isVertical()&&40===a))return!1;if(!this.allowSlidePrev&&(this.isHorizontal()&&37===a||this.isVertical()&&38===a))return!1;if(!(n.shiftKey||n.altKey||n.ctrlKey||n.metaKey||e.activeElement&&e.activeElement.nodeName&&("input"===e.activeElement.nodeName.toLowerCase()||"textarea"===e.activeElement.nodeName.toLowerCase()))){if(this.params.keyboard.onlyInViewport&&(37===a||39===a||38===a||40===a)){var r=!1;if(this.$el.parents("."+this.params.slideClass).length>0&&0===this.$el.parents("."+this.params.slideActiveClass).length)return;var s=t.innerWidth,l=t.innerHeight,d=this.$el.offset();o&&(d.left-=this.$el[0].scrollLeft);for(var c=[[d.left,d.top],[d.left+this.width,d.top],[d.left,d.top+this.height],[d.left+this.width,d.top+this.height]],u=0;u<c.length;u+=1){var h=c[u];h[0]>=0&&h[0]<=s&&h[1]>=0&&h[1]<=l&&(r=!0)}if(!r)return}this.isHorizontal()?(37!==a&&39!==a||(n.preventDefault?n.preventDefault():n.returnValue=!1),(39===a&&!o||37===a&&o)&&this.slideNext(),(37===a&&!o||39===a&&o)&&this.slidePrev()):(38!==a&&40!==a||(n.preventDefault?n.preventDefault():n.returnValue=!1),40===a&&this.slideNext(),38===a&&this.slidePrev()),this.emit("keyPress",a)}},enable:function(){this.keyboard.enabled||(o(e).on("keydown",this.keyboard.handle),this.keyboard.enabled=!0)},disable:function(){this.keyboard.enabled&&(o(e).off("keydown",this.keyboard.handle),this.keyboard.enabled=!1)}},P={name:"keyboard",params:{keyboard:{enabled:!1,onlyInViewport:!0}},create:function(){l.extend(this,{keyboard:{enabled:!1,enable:O.enable.bind(this),disable:O.disable.bind(this),handle:O.handle.bind(this)}})},on:{init:function(){this.params.keyboard.enabled&&this.keyboard.enable()},destroy:function(){this.keyboard.enabled&&this.keyboard.disable()}}};var R={lastScrollTime:l.now(),event:t.navigator.userAgent.indexOf("firefox")>-1?"DOMMouseScroll":function(){var t="onwheel"in e;if(!t){var i=e.createElement("div");i.setAttribute("onwheel","return;"),t="function"==typeof i.onwheel}return!t&&e.implementation&&e.implementation.hasFeature&&!0!==e.implementation.hasFeature("","")&&(t=e.implementation.hasFeature("Events.wheel","3.0")),t}()?"wheel":"mousewheel",normalize:function(e){var t=0,i=0,o=0,n=0;return"detail"in e&&(i=e.detail),"wheelDelta"in e&&(i=-e.wheelDelta/120),"wheelDeltaY"in e&&(i=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=i,i=0),o=10*t,n=10*i,"deltaY"in e&&(n=e.deltaY),"deltaX"in e&&(o=e.deltaX),(o||n)&&e.deltaMode&&(1===e.deltaMode?(o*=40,n*=40):(o*=800,n*=800)),o&&!t&&(t=o<1?-1:1),n&&!i&&(i=n<1?-1:1),{spinX:t,spinY:i,pixelX:o,pixelY:n}},handleMouseEnter:function(){this.mouseEntered=!0},handleMouseLeave:function(){this.mouseEntered=!1},handle:function(e){var i=e,o=this,n=o.params.mousewheel;if(!o.mouseEntered&&!n.releaseOnEdges)return!0;i.originalEvent&&(i=i.originalEvent);var a=0,r=o.rtlTranslate?-1:1,s=R.normalize(i);if(n.forceToAxis)if(o.isHorizontal()){if(!(Math.abs(s.pixelX)>Math.abs(s.pixelY)))return!0;a=s.pixelX*r}else{if(!(Math.abs(s.pixelY)>Math.abs(s.pixelX)))return!0;a=s.pixelY}else a=Math.abs(s.pixelX)>Math.abs(s.pixelY)?-s.pixelX*r:-s.pixelY;if(0===a)return!0;if(n.invert&&(a=-a),o.params.freeMode){o.params.loop&&o.loopFix();var d=o.getTranslate()+a*n.sensitivity,c=o.isBeginning,u=o.isEnd;if(d>=o.minTranslate()&&(d=o.minTranslate()),d<=o.maxTranslate()&&(d=o.maxTranslate()),o.setTransition(0),o.setTranslate(d),o.updateProgress(),o.updateActiveIndex(),o.updateSlidesClasses(),(!c&&o.isBeginning||!u&&o.isEnd)&&o.updateSlidesClasses(),o.params.freeModeSticky&&(clearTimeout(o.mousewheel.timeout),o.mousewheel.timeout=l.nextTick(function(){o.slideToClosest()},300)),o.emit("scroll",i),o.params.autoplay&&o.params.autoplayDisableOnInteraction&&o.autoplay.stop(),d===o.minTranslate()||d===o.maxTranslate())return!0}else{if(l.now()-o.mousewheel.lastScrollTime>60)if(a<0)if(o.isEnd&&!o.params.loop||o.animating){if(n.releaseOnEdges)return!0}else o.slideNext(),o.emit("scroll",i);else if(o.isBeginning&&!o.params.loop||o.animating){if(n.releaseOnEdges)return!0}else o.slidePrev(),o.emit("scroll",i);o.mousewheel.lastScrollTime=(new t.Date).getTime()}return i.preventDefault?i.preventDefault():i.returnValue=!1,!1},enable:function(){if(!R.event)return!1;if(this.mousewheel.enabled)return!1;var e=this.$el;return"container"!==this.params.mousewheel.eventsTarged&&(e=o(this.params.mousewheel.eventsTarged)),e.on("mouseenter",this.mousewheel.handleMouseEnter),e.on("mouseleave",this.mousewheel.handleMouseLeave),e.on(R.event,this.mousewheel.handle),this.mousewheel.enabled=!0,!0},disable:function(){if(!R.event)return!1;if(!this.mousewheel.enabled)return!1;var e=this.$el;return"container"!==this.params.mousewheel.eventsTarged&&(e=o(this.params.mousewheel.eventsTarged)),e.off(R.event,this.mousewheel.handle),this.mousewheel.enabled=!1,!0}},N={update:function(){var e=this.params.navigation;if(!this.params.loop){var t=this.navigation,i=t.$nextEl,o=t.$prevEl;o&&o.length>0&&(this.isBeginning?o.addClass(e.disabledClass):o.removeClass(e.disabledClass),o[this.params.watchOverflow&&this.isLocked?"addClass":"removeClass"](e.lockClass)),i&&i.length>0&&(this.isEnd?i.addClass(e.disabledClass):i.removeClass(e.disabledClass),i[this.params.watchOverflow&&this.isLocked?"addClass":"removeClass"](e.lockClass))}},onPrevClick:function(e){e.preventDefault(),this.isBeginning&&!this.params.loop||this.slidePrev()},onNextClick:function(e){e.preventDefault(),this.isEnd&&!this.params.loop||this.slideNext()},init:function(){var e,t,i=this.params.navigation;(i.nextEl||i.prevEl)&&(i.nextEl&&(e=o(i.nextEl),this.params.uniqueNavElements&&"string"==typeof i.nextEl&&e.length>1&&1===this.$el.find(i.nextEl).length&&(e=this.$el.find(i.nextEl))),i.prevEl&&(t=o(i.prevEl),this.params.uniqueNavElements&&"string"==typeof i.prevEl&&t.length>1&&1===this.$el.find(i.prevEl).length&&(t=this.$el.find(i.prevEl))),e&&e.length>0&&e.on("click",this.navigation.onNextClick),t&&t.length>0&&t.on("click",this.navigation.onPrevClick),l.extend(this.navigation,{$nextEl:e,nextEl:e&&e[0],$prevEl:t,prevEl:t&&t[0]}))},destroy:function(){var e=this.navigation,t=e.$nextEl,i=e.$prevEl;t&&t.length&&(t.off("click",this.navigation.onNextClick),t.removeClass(this.params.navigation.disabledClass)),i&&i.length&&(i.off("click",this.navigation.onPrevClick),i.removeClass(this.params.navigation.disabledClass))}},B={update:function(){var e=this.rtl,t=this.params.pagination;if(t.el&&this.pagination.el&&this.pagination.$el&&0!==this.pagination.$el.length){var i,n=this.virtual&&this.params.virtual.enabled?this.virtual.slides.length:this.slides.length,a=this.pagination.$el,r=this.params.loop?Math.ceil((n-2*this.loopedSlides)/this.params.slidesPerGroup):this.snapGrid.length;if(this.params.loop?((i=Math.ceil((this.activeIndex-this.loopedSlides)/this.params.slidesPerGroup))>n-1-2*this.loopedSlides&&(i-=n-2*this.loopedSlides),i>r-1&&(i-=r),i<0&&"bullets"!==this.params.paginationType&&(i=r+i)):i=void 0!==this.snapIndex?this.snapIndex:this.activeIndex||0,"bullets"===t.type&&this.pagination.bullets&&this.pagination.bullets.length>0){var s,l,d,c=this.pagination.bullets;if(t.dynamicBullets&&(this.pagination.bulletSize=c.eq(0)[this.isHorizontal()?"outerWidth":"outerHeight"](!0),a.css(this.isHorizontal()?"width":"height",this.pagination.bulletSize*(t.dynamicMainBullets+4)+"px"),t.dynamicMainBullets>1&&void 0!==this.previousIndex&&(this.pagination.dynamicBulletIndex+=i-this.previousIndex,this.pagination.dynamicBulletIndex>t.dynamicMainBullets-1?this.pagination.dynamicBulletIndex=t.dynamicMainBullets-1:this.pagination.dynamicBulletIndex<0&&(this.pagination.dynamicBulletIndex=0)),s=i-this.pagination.dynamicBulletIndex,d=((l=s+(Math.min(c.length,t.dynamicMainBullets)-1))+s)/2),c.removeClass(t.bulletActiveClass+" "+t.bulletActiveClass+"-next "+t.bulletActiveClass+"-next-next "+t.bulletActiveClass+"-prev "+t.bulletActiveClass+"-prev-prev "+t.bulletActiveClass+"-main"),a.length>1)c.each(function(e,n){var a=o(n),r=a.index();r===i&&a.addClass(t.bulletActiveClass),t.dynamicBullets&&(r>=s&&r<=l&&a.addClass(t.bulletActiveClass+"-main"),r===s&&a.prev().addClass(t.bulletActiveClass+"-prev").prev().addClass(t.bulletActiveClass+"-prev-prev"),r===l&&a.next().addClass(t.bulletActiveClass+"-next").next().addClass(t.bulletActiveClass+"-next-next"))});else if(c.eq(i).addClass(t.bulletActiveClass),t.dynamicBullets){for(var u=c.eq(s),h=c.eq(l),p=s;p<=l;p+=1)c.eq(p).addClass(t.bulletActiveClass+"-main");u.prev().addClass(t.bulletActiveClass+"-prev").prev().addClass(t.bulletActiveClass+"-prev-prev"),h.next().addClass(t.bulletActiveClass+"-next").next().addClass(t.bulletActiveClass+"-next-next")}if(t.dynamicBullets){var f=Math.min(c.length,t.dynamicMainBullets+4),m=(this.pagination.bulletSize*f-this.pagination.bulletSize)/2-d*this.pagination.bulletSize,g=e?"right":"left";c.css(this.isHorizontal()?g:"top",m+"px")}}if("fraction"===t.type&&(a.find("."+t.currentClass).text(t.formatFractionCurrent(i+1)),a.find("."+t.totalClass).text(t.formatFractionTotal(r))),"progressbar"===t.type){var v;v=t.progressbarOpposite?this.isHorizontal()?"vertical":"horizontal":this.isHorizontal()?"horizontal":"vertical";var b=(i+1)/r,y=1,w=1;"horizontal"===v?y=b:w=b,a.find("."+t.progressbarFillClass).transform("translate3d(0,0,0) scaleX("+y+") scaleY("+w+")").transition(this.params.speed)}"custom"===t.type&&t.renderCustom?(a.html(t.renderCustom(this,i+1,r)),this.emit("paginationRender",this,a[0])):this.emit("paginationUpdate",this,a[0]),a[this.params.watchOverflow&&this.isLocked?"addClass":"removeClass"](t.lockClass)}},render:function(){var e=this.params.pagination;if(e.el&&this.pagination.el&&this.pagination.$el&&0!==this.pagination.$el.length){var t=this.virtual&&this.params.virtual.enabled?this.virtual.slides.length:this.slides.length,i=this.pagination.$el,o="";if("bullets"===e.type){for(var n=this.params.loop?Math.ceil((t-2*this.loopedSlides)/this.params.slidesPerGroup):this.snapGrid.length,a=0;a<n;a+=1)e.renderBullet?o+=e.renderBullet.call(this,a,e.bulletClass):o+="<"+e.bulletElement+' class="'+e.bulletClass+'"></'+e.bulletElement+">";i.html(o),this.pagination.bullets=i.find("."+e.bulletClass)}"fraction"===e.type&&(o=e.renderFraction?e.renderFraction.call(this,e.currentClass,e.totalClass):'<span class="'+e.currentClass+'"></span> / <span class="'+e.totalClass+'"></span>',i.html(o)),"progressbar"===e.type&&(o=e.renderProgressbar?e.renderProgressbar.call(this,e.progressbarFillClass):'<span class="'+e.progressbarFillClass+'"></span>',i.html(o)),"custom"!==e.type&&this.emit("paginationRender",this.pagination.$el[0])}},init:function(){var e=this,t=e.params.pagination;if(t.el){var i=o(t.el);0!==i.length&&(e.params.uniqueNavElements&&"string"==typeof t.el&&i.length>1&&1===e.$el.find(t.el).length&&(i=e.$el.find(t.el)),"bullets"===t.type&&t.clickable&&i.addClass(t.clickableClass),i.addClass(t.modifierClass+t.type),"bullets"===t.type&&t.dynamicBullets&&(i.addClass(""+t.modifierClass+t.type+"-dynamic"),e.pagination.dynamicBulletIndex=0,t.dynamicMainBullets<1&&(t.dynamicMainBullets=1)),"progressbar"===t.type&&t.progressbarOpposite&&i.addClass(t.progressbarOppositeClass),t.clickable&&i.on("click","."+t.bulletClass,function(t){t.preventDefault();var i=o(this).index()*e.params.slidesPerGroup;e.params.loop&&(i+=e.loopedSlides),e.slideTo(i)}),l.extend(e.pagination,{$el:i,el:i[0]}))}},destroy:function(){var e=this.params.pagination;if(e.el&&this.pagination.el&&this.pagination.$el&&0!==this.pagination.$el.length){var t=this.pagination.$el;t.removeClass(e.hiddenClass),t.removeClass(e.modifierClass+e.type),this.pagination.bullets&&this.pagination.bullets.removeClass(e.bulletActiveClass),e.clickable&&t.off("click","."+e.bulletClass)}}},j={setTranslate:function(){if(this.params.scrollbar.el&&this.scrollbar.el){var e=this.scrollbar,t=this.rtlTranslate,i=this.progress,o=e.dragSize,n=e.trackSize,a=e.$dragEl,r=e.$el,s=this.params.scrollbar,l=o,c=(n-o)*i;t?(c=-c)>0?(l=o-c,c=0):-c+o>n&&(l=n+c):c<0?(l=o+c,c=0):c+o>n&&(l=n-c),this.isHorizontal()?(d.transforms3d?a.transform("translate3d("+c+"px, 0, 0)"):a.transform("translateX("+c+"px)"),a[0].style.width=l+"px"):(d.transforms3d?a.transform("translate3d(0px, "+c+"px, 0)"):a.transform("translateY("+c+"px)"),a[0].style.height=l+"px"),s.hide&&(clearTimeout(this.scrollbar.timeout),r[0].style.opacity=1,this.scrollbar.timeout=setTimeout(function(){r[0].style.opacity=0,r.transition(400)},1e3))}},setTransition:function(e){this.params.scrollbar.el&&this.scrollbar.el&&this.scrollbar.$dragEl.transition(e)},updateSize:function(){if(this.params.scrollbar.el&&this.scrollbar.el){var e=this.scrollbar,t=e.$dragEl,i=e.$el;t[0].style.width="",t[0].style.height="";var o,n=this.isHorizontal()?i[0].offsetWidth:i[0].offsetHeight,a=this.size/this.virtualSize,r=a*(n/this.size);o="auto"===this.params.scrollbar.dragSize?n*a:parseInt(this.params.scrollbar.dragSize,10),this.isHorizontal()?t[0].style.width=o+"px":t[0].style.height=o+"px",i[0].style.display=a>=1?"none":"",this.params.scrollbar.hide&&(i[0].style.opacity=0),l.extend(e,{trackSize:n,divider:a,moveDivider:r,dragSize:o}),e.$el[this.params.watchOverflow&&this.isLocked?"addClass":"removeClass"](this.params.scrollbar.lockClass)}},setDragPosition:function(e){var t,i=this.scrollbar,o=this.rtlTranslate,n=i.$el,a=i.dragSize,r=i.trackSize;t=((this.isHorizontal()?"touchstart"===e.type||"touchmove"===e.type?e.targetTouches[0].pageX:e.pageX||e.clientX:"touchstart"===e.type||"touchmove"===e.type?e.targetTouches[0].pageY:e.pageY||e.clientY)-n.offset()[this.isHorizontal()?"left":"top"]-a/2)/(r-a),t=Math.max(Math.min(t,1),0),o&&(t=1-t);var s=this.minTranslate()+(this.maxTranslate()-this.minTranslate())*t;this.updateProgress(s),this.setTranslate(s),this.updateActiveIndex(),this.updateSlidesClasses()},onDragStart:function(e){var t=this.params.scrollbar,i=this.scrollbar,o=this.$wrapperEl,n=i.$el,a=i.$dragEl;this.scrollbar.isTouched=!0,e.preventDefault(),e.stopPropagation(),o.transition(100),a.transition(100),i.setDragPosition(e),clearTimeout(this.scrollbar.dragTimeout),n.transition(0),t.hide&&n.css("opacity",1),this.emit("scrollbarDragStart",e)},onDragMove:function(e){var t=this.scrollbar,i=this.$wrapperEl,o=t.$el,n=t.$dragEl;this.scrollbar.isTouched&&(e.preventDefault?e.preventDefault():e.returnValue=!1,t.setDragPosition(e),i.transition(0),o.transition(0),n.transition(0),this.emit("scrollbarDragMove",e))},onDragEnd:function(e){var t=this.params.scrollbar,i=this.scrollbar.$el;this.scrollbar.isTouched&&(this.scrollbar.isTouched=!1,t.hide&&(clearTimeout(this.scrollbar.dragTimeout),this.scrollbar.dragTimeout=l.nextTick(function(){i.css("opacity",0),i.transition(400)},1e3)),this.emit("scrollbarDragEnd",e),t.snapOnRelease&&this.slideToClosest())},enableDraggable:function(){if(this.params.scrollbar.el){var t=this.scrollbar,i=this.touchEventsTouch,o=this.touchEventsDesktop,n=this.params,a=t.$el[0],r=!(!d.passiveListener||!n.passiveListeners)&&{passive:!1,capture:!1},s=!(!d.passiveListener||!n.passiveListeners)&&{passive:!0,capture:!1};d.touch?(a.addEventListener(i.start,this.scrollbar.onDragStart,r),a.addEventListener(i.move,this.scrollbar.onDragMove,r),a.addEventListener(i.end,this.scrollbar.onDragEnd,s)):(a.addEventListener(o.start,this.scrollbar.onDragStart,r),e.addEventListener(o.move,this.scrollbar.onDragMove,r),e.addEventListener(o.end,this.scrollbar.onDragEnd,s))}},disableDraggable:function(){if(this.params.scrollbar.el){var t=this.scrollbar,i=this.touchEventsTouch,o=this.touchEventsDesktop,n=this.params,a=t.$el[0],r=!(!d.passiveListener||!n.passiveListeners)&&{passive:!1,capture:!1},s=!(!d.passiveListener||!n.passiveListeners)&&{passive:!0,capture:!1};d.touch?(a.removeEventListener(i.start,this.scrollbar.onDragStart,r),a.removeEventListener(i.move,this.scrollbar.onDragMove,r),a.removeEventListener(i.end,this.scrollbar.onDragEnd,s)):(a.removeEventListener(o.start,this.scrollbar.onDragStart,r),e.removeEventListener(o.move,this.scrollbar.onDragMove,r),e.removeEventListener(o.end,this.scrollbar.onDragEnd,s))}},init:function(){if(this.params.scrollbar.el){var e=this.scrollbar,t=this.$el,i=this.params.scrollbar,n=o(i.el);this.params.uniqueNavElements&&"string"==typeof i.el&&n.length>1&&1===t.find(i.el).length&&(n=t.find(i.el));var a=n.find("."+this.params.scrollbar.dragClass);0===a.length&&(a=o('<div class="'+this.params.scrollbar.dragClass+'"></div>'),n.append(a)),l.extend(e,{$el:n,el:n[0],$dragEl:a,dragEl:a[0]}),i.draggable&&e.enableDraggable()}},destroy:function(){this.scrollbar.disableDraggable()}},F={setTransform:function(e,t){var i=this.rtl,n=o(e),a=i?-1:1,r=n.attr("data-swiper-parallax")||"0",s=n.attr("data-swiper-parallax-x"),l=n.attr("data-swiper-parallax-y"),d=n.attr("data-swiper-parallax-scale"),c=n.attr("data-swiper-parallax-opacity");if(s||l?(s=s||"0",l=l||"0"):this.isHorizontal()?(s=r,l="0"):(l=r,s="0"),s=s.indexOf("%")>=0?parseInt(s,10)*t*a+"%":s*t*a+"px",l=l.indexOf("%")>=0?parseInt(l,10)*t+"%":l*t+"px",void 0!==c&&null!==c){var u=c-(c-1)*(1-Math.abs(t));n[0].style.opacity=u}if(void 0===d||null===d)n.transform("translate3d("+s+", "+l+", 0px)");else{var h=d-(d-1)*(1-Math.abs(t));n.transform("translate3d("+s+", "+l+", 0px) scale("+h+")")}},setTranslate:function(){var e=this,t=e.$el,i=e.slides,n=e.progress,a=e.snapGrid;t.children("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(t,i){e.parallax.setTransform(i,n)}),i.each(function(t,i){var r=i.progress;e.params.slidesPerGroup>1&&"auto"!==e.params.slidesPerView&&(r+=Math.ceil(t/2)-n*(a.length-1)),r=Math.min(Math.max(r,-1),1),o(i).find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(t,i){e.parallax.setTransform(i,r)})})},setTransition:function(e){void 0===e&&(e=this.params.speed);this.$el.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(t,i){var n=o(i),a=parseInt(n.attr("data-swiper-parallax-duration"),10)||e;0===e&&(a=0),n.transition(a)})}},H={getDistanceBetweenTouches:function(e){if(e.targetTouches.length<2)return 1;var t=e.targetTouches[0].pageX,i=e.targetTouches[0].pageY,o=e.targetTouches[1].pageX,n=e.targetTouches[1].pageY;return Math.sqrt(Math.pow(o-t,2)+Math.pow(n-i,2))},onGestureStart:function(e){var t=this.params.zoom,i=this.zoom,n=i.gesture;if(i.fakeGestureTouched=!1,i.fakeGestureMoved=!1,!d.gestures){if("touchstart"!==e.type||"touchstart"===e.type&&e.targetTouches.length<2)return;i.fakeGestureTouched=!0,n.scaleStart=H.getDistanceBetweenTouches(e)}n.$slideEl&&n.$slideEl.length||(n.$slideEl=o(e.target).closest(".swiper-slide"),0===n.$slideEl.length&&(n.$slideEl=this.slides.eq(this.activeIndex)),n.$imageEl=n.$slideEl.find("img, svg, canvas"),n.$imageWrapEl=n.$imageEl.parent("."+t.containerClass),n.maxRatio=n.$imageWrapEl.attr("data-swiper-zoom")||t.maxRatio,0!==n.$imageWrapEl.length)?(n.$imageEl.transition(0),this.zoom.isScaling=!0):n.$imageEl=void 0},onGestureChange:function(e){var t=this.params.zoom,i=this.zoom,o=i.gesture;if(!d.gestures){if("touchmove"!==e.type||"touchmove"===e.type&&e.targetTouches.length<2)return;i.fakeGestureMoved=!0,o.scaleMove=H.getDistanceBetweenTouches(e)}o.$imageEl&&0!==o.$imageEl.length&&(d.gestures?i.scale=e.scale*i.currentScale:i.scale=o.scaleMove/o.scaleStart*i.currentScale,i.scale>o.maxRatio&&(i.scale=o.maxRatio-1+Math.pow(i.scale-o.maxRatio+1,.5)),i.scale<t.minRatio&&(i.scale=t.minRatio+1-Math.pow(t.minRatio-i.scale+1,.5)),o.$imageEl.transform("translate3d(0,0,0) scale("+i.scale+")"))},onGestureEnd:function(e){var t=this.params.zoom,i=this.zoom,o=i.gesture;if(!d.gestures){if(!i.fakeGestureTouched||!i.fakeGestureMoved)return;if("touchend"!==e.type||"touchend"===e.type&&e.changedTouches.length<2&&!w.android)return;i.fakeGestureTouched=!1,i.fakeGestureMoved=!1}o.$imageEl&&0!==o.$imageEl.length&&(i.scale=Math.max(Math.min(i.scale,o.maxRatio),t.minRatio),o.$imageEl.transition(this.params.speed).transform("translate3d(0,0,0) scale("+i.scale+")"),i.currentScale=i.scale,i.isScaling=!1,1===i.scale&&(o.$slideEl=void 0))},onTouchStart:function(e){var t=this.zoom,i=t.gesture,o=t.image;i.$imageEl&&0!==i.$imageEl.length&&(o.isTouched||(w.android&&e.preventDefault(),o.isTouched=!0,o.touchesStart.x="touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,o.touchesStart.y="touchstart"===e.type?e.targetTouches[0].pageY:e.pageY))},onTouchMove:function(e){var t=this.zoom,i=t.gesture,o=t.image,n=t.velocity;if(i.$imageEl&&0!==i.$imageEl.length&&(this.allowClick=!1,o.isTouched&&i.$slideEl)){o.isMoved||(o.width=i.$imageEl[0].offsetWidth,o.height=i.$imageEl[0].offsetHeight,o.startX=l.getTranslate(i.$imageWrapEl[0],"x")||0,o.startY=l.getTranslate(i.$imageWrapEl[0],"y")||0,i.slideWidth=i.$slideEl[0].offsetWidth,i.slideHeight=i.$slideEl[0].offsetHeight,i.$imageWrapEl.transition(0),this.rtl&&(o.startX=-o.startX,o.startY=-o.startY));var a=o.width*t.scale,r=o.height*t.scale;if(!(a<i.slideWidth&&r<i.slideHeight)){if(o.minX=Math.min(i.slideWidth/2-a/2,0),o.maxX=-o.minX,o.minY=Math.min(i.slideHeight/2-r/2,0),o.maxY=-o.minY,o.touchesCurrent.x="touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,o.touchesCurrent.y="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY,!o.isMoved&&!t.isScaling){if(this.isHorizontal()&&(Math.floor(o.minX)===Math.floor(o.startX)&&o.touchesCurrent.x<o.touchesStart.x||Math.floor(o.maxX)===Math.floor(o.startX)&&o.touchesCurrent.x>o.touchesStart.x))return void(o.isTouched=!1);if(!this.isHorizontal()&&(Math.floor(o.minY)===Math.floor(o.startY)&&o.touchesCurrent.y<o.touchesStart.y||Math.floor(o.maxY)===Math.floor(o.startY)&&o.touchesCurrent.y>o.touchesStart.y))return void(o.isTouched=!1)}e.preventDefault(),e.stopPropagation(),o.isMoved=!0,o.currentX=o.touchesCurrent.x-o.touchesStart.x+o.startX,o.currentY=o.touchesCurrent.y-o.touchesStart.y+o.startY,o.currentX<o.minX&&(o.currentX=o.minX+1-Math.pow(o.minX-o.currentX+1,.8)),o.currentX>o.maxX&&(o.currentX=o.maxX-1+Math.pow(o.currentX-o.maxX+1,.8)),o.currentY<o.minY&&(o.currentY=o.minY+1-Math.pow(o.minY-o.currentY+1,.8)),o.currentY>o.maxY&&(o.currentY=o.maxY-1+Math.pow(o.currentY-o.maxY+1,.8)),n.prevPositionX||(n.prevPositionX=o.touchesCurrent.x),n.prevPositionY||(n.prevPositionY=o.touchesCurrent.y),n.prevTime||(n.prevTime=Date.now()),n.x=(o.touchesCurrent.x-n.prevPositionX)/(Date.now()-n.prevTime)/2,n.y=(o.touchesCurrent.y-n.prevPositionY)/(Date.now()-n.prevTime)/2,Math.abs(o.touchesCurrent.x-n.prevPositionX)<2&&(n.x=0),Math.abs(o.touchesCurrent.y-n.prevPositionY)<2&&(n.y=0),n.prevPositionX=o.touchesCurrent.x,n.prevPositionY=o.touchesCurrent.y,n.prevTime=Date.now(),i.$imageWrapEl.transform("translate3d("+o.currentX+"px, "+o.currentY+"px,0)")}}},onTouchEnd:function(){var e=this.zoom,t=e.gesture,i=e.image,o=e.velocity;if(t.$imageEl&&0!==t.$imageEl.length){if(!i.isTouched||!i.isMoved)return i.isTouched=!1,void(i.isMoved=!1);i.isTouched=!1,i.isMoved=!1;var n=300,a=300,r=o.x*n,s=i.currentX+r,l=o.y*a,d=i.currentY+l;0!==o.x&&(n=Math.abs((s-i.currentX)/o.x)),0!==o.y&&(a=Math.abs((d-i.currentY)/o.y));var c=Math.max(n,a);i.currentX=s,i.currentY=d;var u=i.width*e.scale,h=i.height*e.scale;i.minX=Math.min(t.slideWidth/2-u/2,0),i.maxX=-i.minX,i.minY=Math.min(t.slideHeight/2-h/2,0),i.maxY=-i.minY,i.currentX=Math.max(Math.min(i.currentX,i.maxX),i.minX),i.currentY=Math.max(Math.min(i.currentY,i.maxY),i.minY),t.$imageWrapEl.transition(c).transform("translate3d("+i.currentX+"px, "+i.currentY+"px,0)")}},onTransitionEnd:function(){var e=this.zoom,t=e.gesture;t.$slideEl&&this.previousIndex!==this.activeIndex&&(t.$imageEl.transform("translate3d(0,0,0) scale(1)"),t.$imageWrapEl.transform("translate3d(0,0,0)"),e.scale=1,e.currentScale=1,t.$slideEl=void 0,t.$imageEl=void 0,t.$imageWrapEl=void 0)},toggle:function(e){var t=this.zoom;t.scale&&1!==t.scale?t.out():t.in(e)},in:function(e){var t,i,n,a,r,s,l,d,c,u,h,p,f,m,g,v,b=this.zoom,y=this.params.zoom,w=b.gesture,_=b.image;(w.$slideEl||(w.$slideEl=this.clickedSlide?o(this.clickedSlide):this.slides.eq(this.activeIndex),w.$imageEl=w.$slideEl.find("img, svg, canvas"),w.$imageWrapEl=w.$imageEl.parent("."+y.containerClass)),w.$imageEl&&0!==w.$imageEl.length)&&(w.$slideEl.addClass(""+y.zoomedSlideClass),void 0===_.touchesStart.x&&e?(t="touchend"===e.type?e.changedTouches[0].pageX:e.pageX,i="touchend"===e.type?e.changedTouches[0].pageY:e.pageY):(t=_.touchesStart.x,i=_.touchesStart.y),b.scale=w.$imageWrapEl.attr("data-swiper-zoom")||y.maxRatio,b.currentScale=w.$imageWrapEl.attr("data-swiper-zoom")||y.maxRatio,e?(g=w.$slideEl[0].offsetWidth,v=w.$slideEl[0].offsetHeight,n=w.$slideEl.offset().left+g/2-t,a=w.$slideEl.offset().top+v/2-i,l=w.$imageEl[0].offsetWidth,d=w.$imageEl[0].offsetHeight,c=l*b.scale,u=d*b.scale,f=-(h=Math.min(g/2-c/2,0)),m=-(p=Math.min(v/2-u/2,0)),r=n*b.scale,s=a*b.scale,r<h&&(r=h),r>f&&(r=f),s<p&&(s=p),s>m&&(s=m)):(r=0,s=0),w.$imageWrapEl.transition(300).transform("translate3d("+r+"px, "+s+"px,0)"),w.$imageEl.transition(300).transform("translate3d(0,0,0) scale("+b.scale+")"))},out:function(){var e=this.zoom,t=this.params.zoom,i=e.gesture;i.$slideEl||(i.$slideEl=this.clickedSlide?o(this.clickedSlide):this.slides.eq(this.activeIndex),i.$imageEl=i.$slideEl.find("img, svg, canvas"),i.$imageWrapEl=i.$imageEl.parent("."+t.containerClass)),i.$imageEl&&0!==i.$imageEl.length&&(e.scale=1,e.currentScale=1,i.$imageWrapEl.transition(300).transform("translate3d(0,0,0)"),i.$imageEl.transition(300).transform("translate3d(0,0,0) scale(1)"),i.$slideEl.removeClass(""+t.zoomedSlideClass),i.$slideEl=void 0)},enable:function(){var e=this.zoom;if(!e.enabled){e.enabled=!0;var t=!("touchstart"!==this.touchEvents.start||!d.passiveListener||!this.params.passiveListeners)&&{passive:!0,capture:!1};d.gestures?(this.$wrapperEl.on("gesturestart",".swiper-slide",e.onGestureStart,t),this.$wrapperEl.on("gesturechange",".swiper-slide",e.onGestureChange,t),this.$wrapperEl.on("gestureend",".swiper-slide",e.onGestureEnd,t)):"touchstart"===this.touchEvents.start&&(this.$wrapperEl.on(this.touchEvents.start,".swiper-slide",e.onGestureStart,t),this.$wrapperEl.on(this.touchEvents.move,".swiper-slide",e.onGestureChange,t),this.$wrapperEl.on(this.touchEvents.end,".swiper-slide",e.onGestureEnd,t)),this.$wrapperEl.on(this.touchEvents.move,"."+this.params.zoom.containerClass,e.onTouchMove)}},disable:function(){var e=this.zoom;if(e.enabled){this.zoom.enabled=!1;var t=!("touchstart"!==this.touchEvents.start||!d.passiveListener||!this.params.passiveListeners)&&{passive:!0,capture:!1};d.gestures?(this.$wrapperEl.off("gesturestart",".swiper-slide",e.onGestureStart,t),this.$wrapperEl.off("gesturechange",".swiper-slide",e.onGestureChange,t),this.$wrapperEl.off("gestureend",".swiper-slide",e.onGestureEnd,t)):"touchstart"===this.touchEvents.start&&(this.$wrapperEl.off(this.touchEvents.start,".swiper-slide",e.onGestureStart,t),this.$wrapperEl.off(this.touchEvents.move,".swiper-slide",e.onGestureChange,t),this.$wrapperEl.off(this.touchEvents.end,".swiper-slide",e.onGestureEnd,t)),this.$wrapperEl.off(this.touchEvents.move,"."+this.params.zoom.containerClass,e.onTouchMove)}}},U={loadInSlide:function(e,t){void 0===t&&(t=!0);var i=this,n=i.params.lazy;if(void 0!==e&&0!==i.slides.length){var a=i.virtual&&i.params.virtual.enabled?i.$wrapperEl.children("."+i.params.slideClass+'[data-swiper-slide-index="'+e+'"]'):i.slides.eq(e),r=a.find("."+n.elementClass+":not(."+n.loadedClass+"):not(."+n.loadingClass+")");!a.hasClass(n.elementClass)||a.hasClass(n.loadedClass)||a.hasClass(n.loadingClass)||(r=r.add(a[0])),0!==r.length&&r.each(function(e,r){var s=o(r);s.addClass(n.loadingClass);var l=s.attr("data-background"),d=s.attr("data-src"),c=s.attr("data-srcset"),u=s.attr("data-sizes");i.loadImage(s[0],d||l,c,u,!1,function(){if(void 0!==i&&null!==i&&i&&(!i||i.params)&&!i.destroyed){if(l?(s.css("background-image",'url("'+l+'")'),s.removeAttr("data-background")):(c&&(s.attr("srcset",c),s.removeAttr("data-srcset")),u&&(s.attr("sizes",u),s.removeAttr("data-sizes")),d&&(s.attr("src",d),s.removeAttr("data-src"))),s.addClass(n.loadedClass).removeClass(n.loadingClass),a.find("."+n.preloaderClass).remove(),i.params.loop&&t){var e=a.attr("data-swiper-slide-index");if(a.hasClass(i.params.slideDuplicateClass)){var o=i.$wrapperEl.children('[data-swiper-slide-index="'+e+'"]:not(.'+i.params.slideDuplicateClass+")");i.lazy.loadInSlide(o.index(),!1)}else{var r=i.$wrapperEl.children("."+i.params.slideDuplicateClass+'[data-swiper-slide-index="'+e+'"]');i.lazy.loadInSlide(r.index(),!1)}}i.emit("lazyImageReady",a[0],s[0])}}),i.emit("lazyImageLoad",a[0],s[0])})}},load:function(){var e=this,t=e.$wrapperEl,i=e.params,n=e.slides,a=e.activeIndex,r=e.virtual&&i.virtual.enabled,s=i.lazy,l=i.slidesPerView;function d(e){if(r){if(t.children("."+i.slideClass+'[data-swiper-slide-index="'+e+'"]').length)return!0}else if(n[e])return!0;return!1}function c(e){return r?o(e).attr("data-swiper-slide-index"):o(e).index()}if("auto"===l&&(l=0),e.lazy.initialImageLoaded||(e.lazy.initialImageLoaded=!0),e.params.watchSlidesVisibility)t.children("."+i.slideVisibleClass).each(function(t,i){var n=r?o(i).attr("data-swiper-slide-index"):o(i).index();e.lazy.loadInSlide(n)});else if(l>1)for(var u=a;u<a+l;u+=1)d(u)&&e.lazy.loadInSlide(u);else e.lazy.loadInSlide(a);if(s.loadPrevNext)if(l>1||s.loadPrevNextAmount&&s.loadPrevNextAmount>1){for(var h=s.loadPrevNextAmount,p=l,f=Math.min(a+p+Math.max(h,p),n.length),m=Math.max(a-Math.max(p,h),0),g=a+l;g<f;g+=1)d(g)&&e.lazy.loadInSlide(g);for(var v=m;v<a;v+=1)d(v)&&e.lazy.loadInSlide(v)}else{var b=t.children("."+i.slideNextClass);b.length>0&&e.lazy.loadInSlide(c(b));var y=t.children("."+i.slidePrevClass);y.length>0&&e.lazy.loadInSlide(c(y))}}},z={LinearSpline:function(e,t){var i,o,n,a,r,s=function(e,t){for(o=-1,i=e.length;i-o>1;)e[n=i+o>>1]<=t?o=n:i=n;return i};return this.x=e,this.y=t,this.lastIndex=e.length-1,this.interpolate=function(e){return e?(r=s(this.x,e),a=r-1,(e-this.x[a])*(this.y[r]-this.y[a])/(this.x[r]-this.x[a])+this.y[a]):0},this},getInterpolateFunction:function(e){this.controller.spline||(this.controller.spline=this.params.loop?new z.LinearSpline(this.slidesGrid,e.slidesGrid):new z.LinearSpline(this.snapGrid,e.snapGrid))},setTranslate:function(e,t){var i,o,n=this,a=n.controller.control;function r(e){var t=n.rtlTranslate?-n.translate:n.translate;"slide"===n.params.controller.by&&(n.controller.getInterpolateFunction(e),o=-n.controller.spline.interpolate(-t)),o&&"container"!==n.params.controller.by||(i=(e.maxTranslate()-e.minTranslate())/(n.maxTranslate()-n.minTranslate()),o=(t-n.minTranslate())*i+e.minTranslate()),n.params.controller.inverse&&(o=e.maxTranslate()-o),e.updateProgress(o),e.setTranslate(o,n),e.updateActiveIndex(),e.updateSlidesClasses()}if(Array.isArray(a))for(var s=0;s<a.length;s+=1)a[s]!==t&&a[s]instanceof T&&r(a[s]);else a instanceof T&&t!==a&&r(a)},setTransition:function(e,t){var i,o=this,n=o.controller.control;function a(t){t.setTransition(e,o),0!==e&&(t.transitionStart(),t.params.autoHeight&&l.nextTick(function(){t.updateAutoHeight()}),t.$wrapperEl.transitionEnd(function(){n&&(t.params.loop&&"slide"===o.params.controller.by&&t.loopFix(),t.transitionEnd())}))}if(Array.isArray(n))for(i=0;i<n.length;i+=1)n[i]!==t&&n[i]instanceof T&&a(n[i]);else n instanceof T&&t!==n&&a(n)}},G={makeElFocusable:function(e){return e.attr("tabIndex","0"),e},addElRole:function(e,t){return e.attr("role",t),e},addElLabel:function(e,t){return e.attr("aria-label",t),e},disableEl:function(e){return e.attr("aria-disabled",!0),e},enableEl:function(e){return e.attr("aria-disabled",!1),e},onEnterKey:function(e){var t=this.params.a11y;if(13===e.keyCode){var i=o(e.target);this.navigation&&this.navigation.$nextEl&&i.is(this.navigation.$nextEl)&&(this.isEnd&&!this.params.loop||this.slideNext(),this.isEnd?this.a11y.notify(t.lastSlideMessage):this.a11y.notify(t.nextSlideMessage)),this.navigation&&this.navigation.$prevEl&&i.is(this.navigation.$prevEl)&&(this.isBeginning&&!this.params.loop||this.slidePrev(),this.isBeginning?this.a11y.notify(t.firstSlideMessage):this.a11y.notify(t.prevSlideMessage)),this.pagination&&i.is("."+this.params.pagination.bulletClass)&&i[0].click()}},notify:function(e){var t=this.a11y.liveRegion;0!==t.length&&(t.html(""),t.html(e))},updateNavigation:function(){if(!this.params.loop){var e=this.navigation,t=e.$nextEl,i=e.$prevEl;i&&i.length>0&&(this.isBeginning?this.a11y.disableEl(i):this.a11y.enableEl(i)),t&&t.length>0&&(this.isEnd?this.a11y.disableEl(t):this.a11y.enableEl(t))}},updatePagination:function(){var e=this,t=e.params.a11y;e.pagination&&e.params.pagination.clickable&&e.pagination.bullets&&e.pagination.bullets.length&&e.pagination.bullets.each(function(i,n){var a=o(n);e.a11y.makeElFocusable(a),e.a11y.addElRole(a,"button"),e.a11y.addElLabel(a,t.paginationBulletMessage.replace(/{{index}}/,a.index()+1))})},init:function(){this.$el.append(this.a11y.liveRegion);var e,t,i=this.params.a11y;this.navigation&&this.navigation.$nextEl&&(e=this.navigation.$nextEl),this.navigation&&this.navigation.$prevEl&&(t=this.navigation.$prevEl),e&&(this.a11y.makeElFocusable(e),this.a11y.addElRole(e,"button"),this.a11y.addElLabel(e,i.nextSlideMessage),e.on("keydown",this.a11y.onEnterKey)),t&&(this.a11y.makeElFocusable(t),this.a11y.addElRole(t,"button"),this.a11y.addElLabel(t,i.prevSlideMessage),t.on("keydown",this.a11y.onEnterKey)),this.pagination&&this.params.pagination.clickable&&this.pagination.bullets&&this.pagination.bullets.length&&this.pagination.$el.on("keydown","."+this.params.pagination.bulletClass,this.a11y.onEnterKey)},destroy:function(){var e,t;this.a11y.liveRegion&&this.a11y.liveRegion.length>0&&this.a11y.liveRegion.remove(),this.navigation&&this.navigation.$nextEl&&(e=this.navigation.$nextEl),this.navigation&&this.navigation.$prevEl&&(t=this.navigation.$prevEl),e&&e.off("keydown",this.a11y.onEnterKey),t&&t.off("keydown",this.a11y.onEnterKey),this.pagination&&this.params.pagination.clickable&&this.pagination.bullets&&this.pagination.bullets.length&&this.pagination.$el.off("keydown","."+this.params.pagination.bulletClass,this.a11y.onEnterKey)}},V={init:function(){if(this.params.history){if(!t.history||!t.history.pushState)return this.params.history.enabled=!1,void(this.params.hashNavigation.enabled=!0);var e=this.history;e.initialized=!0,e.paths=V.getPathValues(),(e.paths.key||e.paths.value)&&(e.scrollToSlide(0,e.paths.value,this.params.runCallbacksOnInit),this.params.history.replaceState||t.addEventListener("popstate",this.history.setHistoryPopState))}},destroy:function(){this.params.history.replaceState||t.removeEventListener("popstate",this.history.setHistoryPopState)},setHistoryPopState:function(){this.history.paths=V.getPathValues(),this.history.scrollToSlide(this.params.speed,this.history.paths.value,!1)},getPathValues:function(){var e=t.location.pathname.slice(1).split("/").filter(function(e){return""!==e}),i=e.length;return{key:e[i-2],value:e[i-1]}},setHistory:function(e,i){if(this.history.initialized&&this.params.history.enabled){var o=this.slides.eq(i),n=V.slugify(o.attr("data-history"));t.location.pathname.includes(e)||(n=e+"/"+n);var a=t.history.state;a&&a.value===n||(this.params.history.replaceState?t.history.replaceState({value:n},null,n):t.history.pushState({value:n},null,n))}},slugify:function(e){return e.toString().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},scrollToSlide:function(e,t,i){if(t)for(var o=0,n=this.slides.length;o<n;o+=1){var a=this.slides.eq(o);if(V.slugify(a.attr("data-history"))===t&&!a.hasClass(this.params.slideDuplicateClass)){var r=a.index();this.slideTo(r,e,i)}}else this.slideTo(0,e,i)}},W={onHashCange:function(){var t=e.location.hash.replace("#","");if(t!==this.slides.eq(this.activeIndex).attr("data-hash")){var i=this.$wrapperEl.children("."+this.params.slideClass+'[data-hash="'+t+'"]').index();if(void 0===i)return;this.slideTo(i)}},setHash:function(){if(this.hashNavigation.initialized&&this.params.hashNavigation.enabled)if(this.params.hashNavigation.replaceState&&t.history&&t.history.replaceState)t.history.replaceState(null,null,"#"+this.slides.eq(this.activeIndex).attr("data-hash")||"");else{var i=this.slides.eq(this.activeIndex),o=i.attr("data-hash")||i.attr("data-history");e.location.hash=o||""}},init:function(){if(!(!this.params.hashNavigation.enabled||this.params.history&&this.params.history.enabled)){this.hashNavigation.initialized=!0;var i=e.location.hash.replace("#","");if(i)for(var n=0,a=this.slides.length;n<a;n+=1){var r=this.slides.eq(n);if((r.attr("data-hash")||r.attr("data-history"))===i&&!r.hasClass(this.params.slideDuplicateClass)){var s=r.index();this.slideTo(s,0,this.params.runCallbacksOnInit,!0)}}this.params.hashNavigation.watchState&&o(t).on("hashchange",this.hashNavigation.onHashCange)}},destroy:function(){this.params.hashNavigation.watchState&&o(t).off("hashchange",this.hashNavigation.onHashCange)}},q={run:function(){var e=this,t=e.slides.eq(e.activeIndex),i=e.params.autoplay.delay;t.attr("data-swiper-autoplay")&&(i=t.attr("data-swiper-autoplay")||e.params.autoplay.delay),e.autoplay.timeout=l.nextTick(function(){e.params.autoplay.reverseDirection?e.params.loop?(e.loopFix(),e.slidePrev(e.params.speed,!0,!0),e.emit("autoplay")):e.isBeginning?e.params.autoplay.stopOnLastSlide?e.autoplay.stop():(e.slideTo(e.slides.length-1,e.params.speed,!0,!0),e.emit("autoplay")):(e.slidePrev(e.params.speed,!0,!0),e.emit("autoplay")):e.params.loop?(e.loopFix(),e.slideNext(e.params.speed,!0,!0),e.emit("autoplay")):e.isEnd?e.params.autoplay.stopOnLastSlide?e.autoplay.stop():(e.slideTo(0,e.params.speed,!0,!0),e.emit("autoplay")):(e.slideNext(e.params.speed,!0,!0),e.emit("autoplay"))},i)},start:function(){return void 0===this.autoplay.timeout&&(!this.autoplay.running&&(this.autoplay.running=!0,this.emit("autoplayStart"),this.autoplay.run(),!0))},stop:function(){return!!this.autoplay.running&&(void 0!==this.autoplay.timeout&&(this.autoplay.timeout&&(clearTimeout(this.autoplay.timeout),this.autoplay.timeout=void 0),this.autoplay.running=!1,this.emit("autoplayStop"),!0))},pause:function(e){this.autoplay.running&&(this.autoplay.paused||(this.autoplay.timeout&&clearTimeout(this.autoplay.timeout),this.autoplay.paused=!0,0!==e&&this.params.autoplay.waitForTransition?(this.$wrapperEl[0].addEventListener("transitionend",this.autoplay.onTransitionEnd),this.$wrapperEl[0].addEventListener("webkitTransitionEnd",this.autoplay.onTransitionEnd)):(this.autoplay.paused=!1,this.autoplay.run())))}},Y={setTranslate:function(){for(var e=this.slides,t=0;t<e.length;t+=1){var i=this.slides.eq(t),o=-i[0].swiperSlideOffset;this.params.virtualTranslate||(o-=this.translate);var n=0;this.isHorizontal()||(n=o,o=0);var a=this.params.fadeEffect.crossFade?Math.max(1-Math.abs(i[0].progress),0):1+Math.min(Math.max(i[0].progress,-1),0);i.css({opacity:a}).transform("translate3d("+o+"px, "+n+"px, 0px)")}},setTransition:function(e){var t=this,i=t.slides,o=t.$wrapperEl;if(i.transition(e),t.params.virtualTranslate&&0!==e){var n=!1;i.transitionEnd(function(){if(!n&&t&&!t.destroyed){n=!0,t.animating=!1;for(var e=["webkitTransitionEnd","transitionend"],i=0;i<e.length;i+=1)o.trigger(e[i])}})}}},X={setTranslate:function(){var e,t=this.$el,i=this.$wrapperEl,n=this.slides,a=this.width,r=this.height,s=this.rtlTranslate,l=this.size,d=this.params.cubeEffect,u=this.isHorizontal(),h=this.virtual&&this.params.virtual.enabled,p=0;d.shadow&&(u?(0===(e=i.find(".swiper-cube-shadow")).length&&(e=o('<div class="swiper-cube-shadow"></div>'),i.append(e)),e.css({height:a+"px"})):0===(e=t.find(".swiper-cube-shadow")).length&&(e=o('<div class="swiper-cube-shadow"></div>'),t.append(e)));for(var f=0;f<n.length;f+=1){var m=n.eq(f),g=f;h&&(g=parseInt(m.attr("data-swiper-slide-index"),10));var v=90*g,b=Math.floor(v/360);s&&(v=-v,b=Math.floor(-v/360));var y=Math.max(Math.min(m[0].progress,1),-1),w=0,_=0,S=0;g%4==0?(w=4*-b*l,S=0):(g-1)%4==0?(w=0,S=4*-b*l):(g-2)%4==0?(w=l+4*b*l,S=l):(g-3)%4==0&&(w=-l,S=3*l+4*l*b),s&&(w=-w),u||(_=w,w=0);var C="rotateX("+(u?0:-v)+"deg) rotateY("+(u?v:0)+"deg) translate3d("+w+"px, "+_+"px, "+S+"px)";if(y<=1&&y>-1&&(p=90*g+90*y,s&&(p=90*-g-90*y)),m.transform(C),d.slideShadows){var k=u?m.find(".swiper-slide-shadow-left"):m.find(".swiper-slide-shadow-top"),T=u?m.find(".swiper-slide-shadow-right"):m.find(".swiper-slide-shadow-bottom");0===k.length&&(k=o('<div class="swiper-slide-shadow-'+(u?"left":"top")+'"></div>'),m.append(k)),0===T.length&&(T=o('<div class="swiper-slide-shadow-'+(u?"right":"bottom")+'"></div>'),m.append(T)),k.length&&(k[0].style.opacity=Math.max(-y,0)),T.length&&(T[0].style.opacity=Math.max(y,0))}}if(i.css({"-webkit-transform-origin":"50% 50% -"+l/2+"px","-moz-transform-origin":"50% 50% -"+l/2+"px","-ms-transform-origin":"50% 50% -"+l/2+"px","transform-origin":"50% 50% -"+l/2+"px"}),d.shadow)if(u)e.transform("translate3d(0px, "+(a/2+d.shadowOffset)+"px, "+-a/2+"px) rotateX(90deg) rotateZ(0deg) scale("+d.shadowScale+")");else{var $=Math.abs(p)-90*Math.floor(Math.abs(p)/90),x=1.5-(Math.sin(2*$*Math.PI/360)/2+Math.cos(2*$*Math.PI/360)/2),E=d.shadowScale,A=d.shadowScale/x,L=d.shadowOffset;e.transform("scale3d("+E+", 1, "+A+") translate3d(0px, "+(r/2+L)+"px, "+-r/2/A+"px) rotateX(-90deg)")}var I=c.isSafari||c.isUiWebView?-l/2:0;i.transform("translate3d(0px,0,"+I+"px) rotateX("+(this.isHorizontal()?0:p)+"deg) rotateY("+(this.isHorizontal()?-p:0)+"deg)")},setTransition:function(e){var t=this.$el;this.slides.transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e),this.params.cubeEffect.shadow&&!this.isHorizontal()&&t.find(".swiper-cube-shadow").transition(e)}},K={setTranslate:function(){for(var e=this.slides,t=this.rtlTranslate,i=0;i<e.length;i+=1){var n=e.eq(i),a=n[0].progress;this.params.flipEffect.limitRotation&&(a=Math.max(Math.min(n[0].progress,1),-1));var r=-180*a,s=0,l=-n[0].swiperSlideOffset,d=0;if(this.isHorizontal()?t&&(r=-r):(d=l,l=0,s=-r,r=0),n[0].style.zIndex=-Math.abs(Math.round(a))+e.length,this.params.flipEffect.slideShadows){var c=this.isHorizontal()?n.find(".swiper-slide-shadow-left"):n.find(".swiper-slide-shadow-top"),u=this.isHorizontal()?n.find(".swiper-slide-shadow-right"):n.find(".swiper-slide-shadow-bottom");0===c.length&&(c=o('<div class="swiper-slide-shadow-'+(this.isHorizontal()?"left":"top")+'"></div>'),n.append(c)),0===u.length&&(u=o('<div class="swiper-slide-shadow-'+(this.isHorizontal()?"right":"bottom")+'"></div>'),n.append(u)),c.length&&(c[0].style.opacity=Math.max(-a,0)),u.length&&(u[0].style.opacity=Math.max(a,0))}n.transform("translate3d("+l+"px, "+d+"px, 0px) rotateX("+s+"deg) rotateY("+r+"deg)")}},setTransition:function(e){var t=this,i=t.slides,o=t.activeIndex,n=t.$wrapperEl;if(i.transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e),t.params.virtualTranslate&&0!==e){var a=!1;i.eq(o).transitionEnd(function(){if(!a&&t&&!t.destroyed){a=!0,t.animating=!1;for(var e=["webkitTransitionEnd","transitionend"],i=0;i<e.length;i+=1)n.trigger(e[i])}})}}},J={setTranslate:function(){for(var e=this.width,t=this.height,i=this.slides,n=this.$wrapperEl,a=this.slidesSizesGrid,r=this.params.coverflowEffect,s=this.isHorizontal(),l=this.translate,c=s?e/2-l:t/2-l,u=s?r.rotate:-r.rotate,h=r.depth,p=0,f=i.length;p<f;p+=1){var m=i.eq(p),g=a[p],v=(c-m[0].swiperSlideOffset-g/2)/g*r.modifier,b=s?u*v:0,y=s?0:u*v,w=-h*Math.abs(v),_=s?0:r.stretch*v,S=s?r.stretch*v:0;Math.abs(S)<.001&&(S=0),Math.abs(_)<.001&&(_=0),Math.abs(w)<.001&&(w=0),Math.abs(b)<.001&&(b=0),Math.abs(y)<.001&&(y=0);var C="translate3d("+S+"px,"+_+"px,"+w+"px)  rotateX("+y+"deg) rotateY("+b+"deg)";if(m.transform(C),m[0].style.zIndex=1-Math.abs(Math.round(v)),r.slideShadows){var k=s?m.find(".swiper-slide-shadow-left"):m.find(".swiper-slide-shadow-top"),T=s?m.find(".swiper-slide-shadow-right"):m.find(".swiper-slide-shadow-bottom");0===k.length&&(k=o('<div class="swiper-slide-shadow-'+(s?"left":"top")+'"></div>'),m.append(k)),0===T.length&&(T=o('<div class="swiper-slide-shadow-'+(s?"right":"bottom")+'"></div>'),m.append(T)),k.length&&(k[0].style.opacity=v>0?v:0),T.length&&(T[0].style.opacity=-v>0?-v:0)}}(d.pointerEvents||d.prefixedPointerEvents)&&(n[0].style.perspectiveOrigin=c+"px 50%")},setTransition:function(e){this.slides.transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e)}},Q={init:function(){var e=this.params.thumbs,t=this.constructor;e.swiper instanceof t?(this.thumbs.swiper=e.swiper,l.extend(this.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),l.extend(this.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1})):l.isObject(e.swiper)&&(this.thumbs.swiper=new t(l.extend({},e.swiper,{watchSlidesVisibility:!0,watchSlidesProgress:!0,slideToClickedSlide:!1})),this.thumbs.swiperCreated=!0),this.thumbs.swiper.$el.addClass(this.params.thumbs.thumbsContainerClass),this.thumbs.swiper.on("tap",this.thumbs.onThumbClick)},onThumbClick:function(){var e=this.thumbs.swiper;if(e){var t=e.clickedIndex,i=e.clickedSlide;if(!(i&&o(i).hasClass(this.params.thumbs.slideThumbActiveClass)||void 0===t||null===t)){var n;if(n=e.params.loop?parseInt(o(e.clickedSlide).attr("data-swiper-slide-index"),10):t,this.params.loop){var a=this.activeIndex;this.slides.eq(a).hasClass(this.params.slideDuplicateClass)&&(this.loopFix(),this._clientLeft=this.$wrapperEl[0].clientLeft,a=this.activeIndex);var r=this.slides.eq(a).prevAll('[data-swiper-slide-index="'+n+'"]').eq(0).index(),s=this.slides.eq(a).nextAll('[data-swiper-slide-index="'+n+'"]').eq(0).index();n=void 0===r?s:void 0===s?r:s-a<a-r?s:r}this.slideTo(n)}}},update:function(e){var t=this.thumbs.swiper;if(t){var i="auto"===t.params.slidesPerView?t.slidesPerViewDynamic():t.params.slidesPerView;if(this.realIndex!==t.realIndex){var o,n=t.activeIndex;if(t.params.loop){t.slides.eq(n).hasClass(t.params.slideDuplicateClass)&&(t.loopFix(),t._clientLeft=t.$wrapperEl[0].clientLeft,n=t.activeIndex);var a=t.slides.eq(n).prevAll('[data-swiper-slide-index="'+this.realIndex+'"]').eq(0).index(),r=t.slides.eq(n).nextAll('[data-swiper-slide-index="'+this.realIndex+'"]').eq(0).index();o=void 0===a?r:void 0===r?a:r-n==n-a?n:r-n<n-a?r:a}else o=this.realIndex;t.visibleSlidesIndexes.indexOf(o)<0&&(t.params.centeredSlides?o=o>n?o-Math.floor(i/2)+1:o+Math.floor(i/2)-1:o>n&&(o=o-i+1),t.slideTo(o,e?0:void 0))}var s=1,l=this.params.thumbs.slideThumbActiveClass;if(this.params.slidesPerView>1&&!this.params.centeredSlides&&(s=this.params.slidesPerView),t.slides.removeClass(l),t.params.loop)for(var d=0;d<s;d+=1)t.$wrapperEl.children('[data-swiper-slide-index="'+(this.realIndex+d)+'"]').addClass(l);else for(var c=0;c<s;c+=1)t.slides.eq(this.realIndex+c).addClass(l)}}},Z=[$,x,E,A,I,D,P,{name:"mousewheel",params:{mousewheel:{enabled:!1,releaseOnEdges:!1,invert:!1,forceToAxis:!1,sensitivity:1,eventsTarged:"container"}},create:function(){l.extend(this,{mousewheel:{enabled:!1,enable:R.enable.bind(this),disable:R.disable.bind(this),handle:R.handle.bind(this),handleMouseEnter:R.handleMouseEnter.bind(this),handleMouseLeave:R.handleMouseLeave.bind(this),lastScrollTime:l.now()}})},on:{init:function(){this.params.mousewheel.enabled&&this.mousewheel.enable()},destroy:function(){this.mousewheel.enabled&&this.mousewheel.disable()}}},{name:"navigation",params:{navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock"}},create:function(){l.extend(this,{navigation:{init:N.init.bind(this),update:N.update.bind(this),destroy:N.destroy.bind(this),onNextClick:N.onNextClick.bind(this),onPrevClick:N.onPrevClick.bind(this)}})},on:{init:function(){this.navigation.init(),this.navigation.update()},toEdge:function(){this.navigation.update()},fromEdge:function(){this.navigation.update()},destroy:function(){this.navigation.destroy()},click:function(e){var t,i=this.navigation,n=i.$nextEl,a=i.$prevEl;!this.params.navigation.hideOnClick||o(e.target).is(a)||o(e.target).is(n)||(n?t=n.hasClass(this.params.navigation.hiddenClass):a&&(t=a.hasClass(this.params.navigation.hiddenClass)),!0===t?this.emit("navigationShow",this):this.emit("navigationHide",this),n&&n.toggleClass(this.params.navigation.hiddenClass),a&&a.toggleClass(this.params.navigation.hiddenClass))}}},{name:"pagination",params:{pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:function(e){return e},formatFractionTotal:function(e){return e},bulletClass:"swiper-pagination-bullet",bulletActiveClass:"swiper-pagination-bullet-active",modifierClass:"swiper-pagination-",currentClass:"swiper-pagination-current",totalClass:"swiper-pagination-total",hiddenClass:"swiper-pagination-hidden",progressbarFillClass:"swiper-pagination-progressbar-fill",progressbarOppositeClass:"swiper-pagination-progressbar-opposite",clickableClass:"swiper-pagination-clickable",lockClass:"swiper-pagination-lock"}},create:function(){l.extend(this,{pagination:{init:B.init.bind(this),render:B.render.bind(this),update:B.update.bind(this),destroy:B.destroy.bind(this),dynamicBulletIndex:0}})},on:{init:function(){this.pagination.init(),this.pagination.render(),this.pagination.update()},activeIndexChange:function(){this.params.loop?this.pagination.update():void 0===this.snapIndex&&this.pagination.update()},snapIndexChange:function(){this.params.loop||this.pagination.update()},slidesLengthChange:function(){this.params.loop&&(this.pagination.render(),this.pagination.update())},snapGridLengthChange:function(){this.params.loop||(this.pagination.render(),this.pagination.update())},destroy:function(){this.pagination.destroy()},click:function(e){this.params.pagination.el&&this.params.pagination.hideOnClick&&this.pagination.$el.length>0&&!o(e.target).hasClass(this.params.pagination.bulletClass)&&(!0===this.pagination.$el.hasClass(this.params.pagination.hiddenClass)?this.emit("paginationShow",this):this.emit("paginationHide",this),this.pagination.$el.toggleClass(this.params.pagination.hiddenClass))}}},{name:"scrollbar",params:{scrollbar:{el:null,dragSize:"auto",hide:!1,draggable:!1,snapOnRelease:!0,lockClass:"swiper-scrollbar-lock",dragClass:"swiper-scrollbar-drag"}},create:function(){l.extend(this,{scrollbar:{init:j.init.bind(this),destroy:j.destroy.bind(this),updateSize:j.updateSize.bind(this),setTranslate:j.setTranslate.bind(this),setTransition:j.setTransition.bind(this),enableDraggable:j.enableDraggable.bind(this),disableDraggable:j.disableDraggable.bind(this),setDragPosition:j.setDragPosition.bind(this),onDragStart:j.onDragStart.bind(this),onDragMove:j.onDragMove.bind(this),onDragEnd:j.onDragEnd.bind(this),isTouched:!1,timeout:null,dragTimeout:null}})},on:{init:function(){this.scrollbar.init(),this.scrollbar.updateSize(),this.scrollbar.setTranslate()},update:function(){this.scrollbar.updateSize()},resize:function(){this.scrollbar.updateSize()},observerUpdate:function(){this.scrollbar.updateSize()},setTranslate:function(){this.scrollbar.setTranslate()},setTransition:function(e){this.scrollbar.setTransition(e)},destroy:function(){this.scrollbar.destroy()}}},{name:"parallax",params:{parallax:{enabled:!1}},create:function(){l.extend(this,{parallax:{setTransform:F.setTransform.bind(this),setTranslate:F.setTranslate.bind(this),setTransition:F.setTransition.bind(this)}})},on:{beforeInit:function(){this.params.parallax.enabled&&(this.params.watchSlidesProgress=!0,this.originalParams.watchSlidesProgress=!0)},init:function(){this.params.parallax.enabled&&this.parallax.setTranslate()},setTranslate:function(){this.params.parallax.enabled&&this.parallax.setTranslate()},setTransition:function(e){this.params.parallax.enabled&&this.parallax.setTransition(e)}}},{name:"zoom",params:{zoom:{enabled:!1,maxRatio:3,minRatio:1,toggle:!0,containerClass:"swiper-zoom-container",zoomedSlideClass:"swiper-slide-zoomed"}},create:function(){var e=this,t={enabled:!1,scale:1,currentScale:1,isScaling:!1,gesture:{$slideEl:void 0,slideWidth:void 0,slideHeight:void 0,$imageEl:void 0,$imageWrapEl:void 0,maxRatio:3},image:{isTouched:void 0,isMoved:void 0,currentX:void 0,currentY:void 0,minX:void 0,minY:void 0,maxX:void 0,maxY:void 0,width:void 0,height:void 0,startX:void 0,startY:void 0,touchesStart:{},touchesCurrent:{}},velocity:{x:void 0,y:void 0,prevPositionX:void 0,prevPositionY:void 0,prevTime:void 0}};"onGestureStart onGestureChange onGestureEnd onTouchStart onTouchMove onTouchEnd onTransitionEnd toggle enable disable in out".split(" ").forEach(function(i){t[i]=H[i].bind(e)}),l.extend(e,{zoom:t});var i=1;Object.defineProperty(e.zoom,"scale",{get:function(){return i},set:function(t){if(i!==t){var o=e.zoom.gesture.$imageEl?e.zoom.gesture.$imageEl[0]:void 0,n=e.zoom.gesture.$slideEl?e.zoom.gesture.$slideEl[0]:void 0;e.emit("zoomChange",t,o,n)}i=t}})},on:{init:function(){this.params.zoom.enabled&&this.zoom.enable()},destroy:function(){this.zoom.disable()},touchStart:function(e){this.zoom.enabled&&this.zoom.onTouchStart(e)},touchEnd:function(e){this.zoom.enabled&&this.zoom.onTouchEnd(e)},doubleTap:function(e){this.params.zoom.enabled&&this.zoom.enabled&&this.params.zoom.toggle&&this.zoom.toggle(e)},transitionEnd:function(){this.zoom.enabled&&this.params.zoom.enabled&&this.zoom.onTransitionEnd()}}},{name:"lazy",params:{lazy:{enabled:!1,loadPrevNext:!1,loadPrevNextAmount:1,loadOnTransitionStart:!1,elementClass:"swiper-lazy",loadingClass:"swiper-lazy-loading",loadedClass:"swiper-lazy-loaded",preloaderClass:"swiper-lazy-preloader"}},create:function(){l.extend(this,{lazy:{initialImageLoaded:!1,load:U.load.bind(this),loadInSlide:U.loadInSlide.bind(this)}})},on:{beforeInit:function(){this.params.lazy.enabled&&this.params.preloadImages&&(this.params.preloadImages=!1)},init:function(){this.params.lazy.enabled&&!this.params.loop&&0===this.params.initialSlide&&this.lazy.load()},scroll:function(){this.params.freeMode&&!this.params.freeModeSticky&&this.lazy.load()},resize:function(){this.params.lazy.enabled&&this.lazy.load()},scrollbarDragMove:function(){this.params.lazy.enabled&&this.lazy.load()},transitionStart:function(){this.params.lazy.enabled&&(this.params.lazy.loadOnTransitionStart||!this.params.lazy.loadOnTransitionStart&&!this.lazy.initialImageLoaded)&&this.lazy.load()},transitionEnd:function(){this.params.lazy.enabled&&!this.params.lazy.loadOnTransitionStart&&this.lazy.load()}}},{name:"controller",params:{controller:{control:void 0,inverse:!1,by:"slide"}},create:function(){l.extend(this,{controller:{control:this.params.controller.control,getInterpolateFunction:z.getInterpolateFunction.bind(this),setTranslate:z.setTranslate.bind(this),setTransition:z.setTransition.bind(this)}})},on:{update:function(){this.controller.control&&this.controller.spline&&(this.controller.spline=void 0,delete this.controller.spline)},resize:function(){this.controller.control&&this.controller.spline&&(this.controller.spline=void 0,delete this.controller.spline)},observerUpdate:function(){this.controller.control&&this.controller.spline&&(this.controller.spline=void 0,delete this.controller.spline)},setTranslate:function(e,t){this.controller.control&&this.controller.setTranslate(e,t)},setTransition:function(e,t){this.controller.control&&this.controller.setTransition(e,t)}}},{name:"a11y",params:{a11y:{enabled:!0,notificationClass:"swiper-notification",prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",paginationBulletMessage:"Go to slide {{index}}"}},create:function(){var e=this;l.extend(e,{a11y:{liveRegion:o('<span class="'+e.params.a11y.notificationClass+'" aria-live="assertive" aria-atomic="true"></span>')}}),Object.keys(G).forEach(function(t){e.a11y[t]=G[t].bind(e)})},on:{init:function(){this.params.a11y.enabled&&(this.a11y.init(),this.a11y.updateNavigation())},toEdge:function(){this.params.a11y.enabled&&this.a11y.updateNavigation()},fromEdge:function(){this.params.a11y.enabled&&this.a11y.updateNavigation()},paginationUpdate:function(){this.params.a11y.enabled&&this.a11y.updatePagination()},destroy:function(){this.params.a11y.enabled&&this.a11y.destroy()}}},{name:"history",params:{history:{enabled:!1,replaceState:!1,key:"slides"}},create:function(){l.extend(this,{history:{init:V.init.bind(this),setHistory:V.setHistory.bind(this),setHistoryPopState:V.setHistoryPopState.bind(this),scrollToSlide:V.scrollToSlide.bind(this),destroy:V.destroy.bind(this)}})},on:{init:function(){this.params.history.enabled&&this.history.init()},destroy:function(){this.params.history.enabled&&this.history.destroy()},transitionEnd:function(){this.history.initialized&&this.history.setHistory(this.params.history.key,this.activeIndex)}}},{name:"hash-navigation",params:{hashNavigation:{enabled:!1,replaceState:!1,watchState:!1}},create:function(){l.extend(this,{hashNavigation:{initialized:!1,init:W.init.bind(this),destroy:W.destroy.bind(this),setHash:W.setHash.bind(this),onHashCange:W.onHashCange.bind(this)}})},on:{init:function(){this.params.hashNavigation.enabled&&this.hashNavigation.init()},destroy:function(){this.params.hashNavigation.enabled&&this.hashNavigation.destroy()},transitionEnd:function(){this.hashNavigation.initialized&&this.hashNavigation.setHash()}}},{name:"autoplay",params:{autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!0,stopOnLastSlide:!1,reverseDirection:!1}},create:function(){var e=this;l.extend(e,{autoplay:{running:!1,paused:!1,run:q.run.bind(e),start:q.start.bind(e),stop:q.stop.bind(e),pause:q.pause.bind(e),onTransitionEnd:function(t){e&&!e.destroyed&&e.$wrapperEl&&t.target===this&&(e.$wrapperEl[0].removeEventListener("transitionend",e.autoplay.onTransitionEnd),e.$wrapperEl[0].removeEventListener("webkitTransitionEnd",e.autoplay.onTransitionEnd),e.autoplay.paused=!1,e.autoplay.running?e.autoplay.run():e.autoplay.stop())}}})},on:{init:function(){this.params.autoplay.enabled&&this.autoplay.start()},beforeTransitionStart:function(e,t){this.autoplay.running&&(t||!this.params.autoplay.disableOnInteraction?this.autoplay.pause(e):this.autoplay.stop())},sliderFirstMove:function(){this.autoplay.running&&(this.params.autoplay.disableOnInteraction?this.autoplay.stop():this.autoplay.pause())},destroy:function(){this.autoplay.running&&this.autoplay.stop()}}},{name:"effect-fade",params:{fadeEffect:{crossFade:!1}},create:function(){l.extend(this,{fadeEffect:{setTranslate:Y.setTranslate.bind(this),setTransition:Y.setTransition.bind(this)}})},on:{beforeInit:function(){if("fade"===this.params.effect){this.classNames.push(this.params.containerModifierClass+"fade");var e={slidesPerView:1,slidesPerColumn:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!0};l.extend(this.params,e),l.extend(this.originalParams,e)}},setTranslate:function(){"fade"===this.params.effect&&this.fadeEffect.setTranslate()},setTransition:function(e){"fade"===this.params.effect&&this.fadeEffect.setTransition(e)}}},{name:"effect-cube",params:{cubeEffect:{slideShadows:!0,shadow:!0,shadowOffset:20,shadowScale:.94}},create:function(){l.extend(this,{cubeEffect:{setTranslate:X.setTranslate.bind(this),setTransition:X.setTransition.bind(this)}})},on:{beforeInit:function(){if("cube"===this.params.effect){this.classNames.push(this.params.containerModifierClass+"cube"),this.classNames.push(this.params.containerModifierClass+"3d");var e={slidesPerView:1,slidesPerColumn:1,slidesPerGroup:1,watchSlidesProgress:!0,resistanceRatio:0,spaceBetween:0,centeredSlides:!1,virtualTranslate:!0};l.extend(this.params,e),l.extend(this.originalParams,e)}},setTranslate:function(){"cube"===this.params.effect&&this.cubeEffect.setTranslate()},setTransition:function(e){"cube"===this.params.effect&&this.cubeEffect.setTransition(e)}}},{name:"effect-flip",params:{flipEffect:{slideShadows:!0,limitRotation:!0}},create:function(){l.extend(this,{flipEffect:{setTranslate:K.setTranslate.bind(this),setTransition:K.setTransition.bind(this)}})},on:{beforeInit:function(){if("flip"===this.params.effect){this.classNames.push(this.params.containerModifierClass+"flip"),this.classNames.push(this.params.containerModifierClass+"3d");var e={slidesPerView:1,slidesPerColumn:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!0};l.extend(this.params,e),l.extend(this.originalParams,e)}},setTranslate:function(){"flip"===this.params.effect&&this.flipEffect.setTranslate()},setTransition:function(e){"flip"===this.params.effect&&this.flipEffect.setTransition(e)}}},{name:"effect-coverflow",params:{coverflowEffect:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0}},create:function(){l.extend(this,{coverflowEffect:{setTranslate:J.setTranslate.bind(this),setTransition:J.setTransition.bind(this)}})},on:{beforeInit:function(){"coverflow"===this.params.effect&&(this.classNames.push(this.params.containerModifierClass+"coverflow"),this.classNames.push(this.params.containerModifierClass+"3d"),this.params.watchSlidesProgress=!0,this.originalParams.watchSlidesProgress=!0)},setTranslate:function(){"coverflow"===this.params.effect&&this.coverflowEffect.setTranslate()},setTransition:function(e){"coverflow"===this.params.effect&&this.coverflowEffect.setTransition(e)}}},{name:"thumbs",params:{thumbs:{swiper:null,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-container-thumbs"}},create:function(){l.extend(this,{thumbs:{swiper:null,init:Q.init.bind(this),update:Q.update.bind(this),onThumbClick:Q.onThumbClick.bind(this)}})},on:{beforeInit:function(){var e=this.params.thumbs;e&&e.swiper&&(this.thumbs.init(),this.thumbs.update(!0))},slideChange:function(){this.thumbs.swiper&&this.thumbs.update()},update:function(){this.thumbs.swiper&&this.thumbs.update()},resize:function(){this.thumbs.swiper&&this.thumbs.update()},observerUpdate:function(){this.thumbs.swiper&&this.thumbs.update()},setTransition:function(e){var t=this.thumbs.swiper;t&&t.setTransition(e)},beforeDestroy:function(){var e=this.thumbs.swiper;e&&this.thumbs.swiperCreated&&e&&e.destroy()}}}];return void 0===T.use&&(T.use=T.Class.use,T.installModule=T.Class.installModule),T.use(Z),T}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}(function(e){var t=function(){if(e&&e.fn&&e.fn.select2&&e.fn.select2.amd)var t=e.fn.select2.amd;var i,o,n,a,r,s,l,d,c,u,h,p,f,m,g;function v(e,t){return f.call(e,t)}function b(e,t){var i,o,n,a,r,s,l,d,c,u,p,f=t&&t.split("/"),m=h.map,v=m&&m["*"]||{};if(e){for(r=(e=e.split("/")).length-1,h.nodeIdCompat&&g.test(e[r])&&(e[r]=e[r].replace(g,"")),"."===e[0].charAt(0)&&f&&(e=f.slice(0,f.length-1).concat(e)),c=0;c<e.length;c++)if("."===(p=e[c]))e.splice(c,1),c-=1;else if(".."===p){if(0===c||1===c&&".."===e[2]||".."===e[c-1])continue;0<c&&(e.splice(c-1,2),c-=2)}e=e.join("/")}if((f||v)&&m){for(c=(i=e.split("/")).length;0<c;c-=1){if(o=i.slice(0,c).join("/"),f)for(u=f.length;0<u;u-=1)if(n=(n=m[f.slice(0,u).join("/")])&&n[o]){a=n,s=c;break}if(a)break;!l&&v&&v[o]&&(l=v[o],d=c)}!a&&l&&(a=l,s=d),a&&(i.splice(0,s,a),e=i.join("/"))}return e}function y(e,t){return function(){var i=m.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),s.apply(a,i.concat([e,t]))}}function w(e){return function(t){c[e]=t}}function _(e){if(v(u,e)){var t=u[e];delete u[e],p[e]=!0,r.apply(a,t)}if(!v(c,e)&&!v(p,e))throw new Error("No "+e);return c[e]}function S(e){var t,i=e?e.indexOf("!"):-1;return-1<i&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function C(e){return e?S(e):[]}return t&&t.requirejs||(t?o=t:t={},c={},u={},h={},p={},f=Object.prototype.hasOwnProperty,m=[].slice,g=/\.js$/,l=function(e,t){var i,o=S(e),n=o[0],a=t[1];return e=o[1],n&&(i=_(n=b(n,a))),n?e=i&&i.normalize?i.normalize(e,function(e){return function(t){return b(t,e)}}(a)):b(e,a):(n=(o=S(e=b(e,a)))[0],e=o[1],n&&(i=_(n))),{f:n?n+"!"+e:e,n:e,pr:n,p:i}},d={require:function(e){return y(e)},exports:function(e){var t=c[e];return void 0!==t?t:c[e]={}},module:function(e){return{id:e,uri:"",exports:c[e],config:function(e){return function(){return h&&h.config&&h.config[e]||{}}}(e)}}},r=function(e,t,i,o){var n,r,s,h,f,m,g,b=[],S=typeof i;if(m=C(o=o||e),"undefined"==S||"function"==S){for(t=!t.length&&i.length?["require","exports","module"]:t,f=0;f<t.length;f+=1)if("require"===(r=(h=l(t[f],m)).f))b[f]=d.require(e);else if("exports"===r)b[f]=d.exports(e),g=!0;else if("module"===r)n=b[f]=d.module(e);else if(v(c,r)||v(u,r)||v(p,r))b[f]=_(r);else{if(!h.p)throw new Error(e+" missing "+r);h.p.load(h.n,y(o,!0),w(r),{}),b[f]=c[r]}s=i?i.apply(c[e],b):void 0,e&&(n&&n.exports!==a&&n.exports!==c[e]?c[e]=n.exports:s===a&&g||(c[e]=s))}else e&&(c[e]=i)},i=o=s=function(e,t,i,o,n){if("string"==typeof e)return d[e]?d[e](t):_(l(e,C(t)).f);if(!e.splice){if((h=e).deps&&s(h.deps,h.callback),!t)return;t.splice?(e=t,t=i,i=null):e=a}return t=t||function(){},"function"==typeof i&&(i=o,o=n),o?r(a,e,t,i):setTimeout(function(){r(a,e,t,i)},4),s},s.config=function(e){return s(e)},i._defined=c,(n=function(e,t,i){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(i=t,t=[]),v(c,e)||v(u,e)||(u[e]=[e,t,i])}).amd={jQuery:!0},t.requirejs=i,t.require=o,t.define=n),t.define("almond",function(){}),t.define("jquery",[],function(){var t=e||$;return null==t&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),t}),t.define("select2/utils",["jquery"],function(e){var t={};function i(e){var t=e.prototype,i=[];for(var o in t)"function"==typeof t[o]&&"constructor"!==o&&i.push(o);return i}function o(){this.listeners={}}t.Extend=function(e,t){var i={}.hasOwnProperty;function o(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype,e},t.Decorate=function(e,t){var o=i(t),n=i(e);function a(){var i=Array.prototype.unshift,o=t.prototype.constructor.length,n=e.prototype.constructor;0<o&&(i.call(arguments,e.prototype.constructor),n=t.prototype.constructor),n.apply(this,arguments)}t.displayName=e.displayName,a.prototype=new function(){this.constructor=a};for(var r=0;r<n.length;r++){var s=n[r];a.prototype[s]=e.prototype[s]}function l(e){var i=function(){};e in a.prototype&&(i=a.prototype[e]);var o=t.prototype[e];return function(){return Array.prototype.unshift.call(arguments,i),o.apply(this,arguments)}}for(var d=0;d<o.length;d++){var c=o[d];a.prototype[c]=l(c)}return a},o.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},o.prototype.trigger=function(e){var t=Array.prototype.slice,i=t.call(arguments,1);this.listeners=this.listeners||{},null==i&&(i=[]),0===i.length&&i.push({}),(i[0]._type=e)in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},o.prototype.invoke=function(e,t){for(var i=0,o=e.length;i<o;i++)e[i].apply(this,t)},t.Observable=o,t.generateChars=function(e){for(var t="",i=0;i<e;i++)t+=Math.floor(36*Math.random()).toString(36);return t},t.bind=function(e,t){return function(){e.apply(t,arguments)}},t._convertData=function(e){for(var t in e){var i=t.split("-"),o=e;if(1!==i.length){for(var n=0;n<i.length;n++){var a=i[n];(a=a.substring(0,1).toLowerCase()+a.substring(1))in o||(o[a]={}),n==i.length-1&&(o[a]=e[t]),o=o[a]}delete e[t]}}return e},t.hasScroll=function(t,i){var o=e(i),n=i.style.overflowX,a=i.style.overflowY;return(n!==a||"hidden"!==a&&"visible"!==a)&&("scroll"===n||"scroll"===a||o.innerHeight()<i.scrollHeight||o.innerWidth()<i.scrollWidth)},t.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},t.appendMany=function(t,i){if("1.7"===e.fn.jquery.substr(0,3)){var o=e();e.map(i,function(e){o=o.add(e)}),i=o}t.append(i)},t.__cache={};var n=0;return t.GetUniqueElementId=function(e){var t=e.getAttribute("data-select2-id");return null==t&&(e.id?(t=e.id,e.setAttribute("data-select2-id",t)):(e.setAttribute("data-select2-id",++n),t=n.toString())),t},t.StoreData=function(e,i,o){var n=t.GetUniqueElementId(e);t.__cache[n]||(t.__cache[n]={}),t.__cache[n][i]=o},t.GetData=function(i,o){var n=t.GetUniqueElementId(i);return o?t.__cache[n]&&null!=t.__cache[n][o]?t.__cache[n][o]:e(i).data(o):t.__cache[n]},t.RemoveData=function(e){var i=t.GetUniqueElementId(e);null!=t.__cache[i]&&delete t.__cache[i],e.removeAttribute("data-select2-id")},t}),t.define("select2/results",["jquery","./utils"],function(e,t){function i(e,t,o){this.$element=e,this.data=o,this.options=t,i.__super__.constructor.call(this)}return t.Extend(i,t.Observable),i.prototype.render=function(){var t=e('<ul class="select2-results__options" role="listbox"></ul>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t},i.prototype.clear=function(){this.$results.empty()},i.prototype.displayMessage=function(t){var i=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var o=e('<li role="alert" aria-live="assertive" class="select2-results__option"></li>'),n=this.options.get("translations").get(t.message);o.append(i(n(t.args))),o[0].className+=" select2-results__message",this.$results.append(o)},i.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},i.prototype.append=function(e){this.hideLoading();var t=[];if(null!=e.results&&0!==e.results.length){e.results=this.sort(e.results);for(var i=0;i<e.results.length;i++){var o=e.results[i],n=this.option(o);t.push(n)}this.$results.append(t)}else 0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"})},i.prototype.position=function(e,t){t.find(".select2-results").append(e)},i.prototype.sort=function(e){return this.options.get("sorter")(e)},i.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option[aria-selected]"),t=e.filter("[aria-selected=true]");0<t.length?t.first().trigger("mouseenter"):e.first().trigger("mouseenter"),this.ensureHighlightVisible()},i.prototype.setClasses=function(){var i=this;this.data.current(function(o){var n=e.map(o,function(e){return e.id.toString()});i.$results.find(".select2-results__option[aria-selected]").each(function(){var i=e(this),o=t.GetData(this,"data"),a=""+o.id;null!=o.element&&o.element.selected||null==o.element&&-1<e.inArray(a,n)?i.attr("aria-selected","true"):i.attr("aria-selected","false")})})},i.prototype.showLoading=function(e){this.hideLoading();var t={disabled:!0,loading:!0,text:this.options.get("translations").get("searching")(e)},i=this.option(t);i.className+=" loading-results",this.$results.prepend(i)},i.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},i.prototype.option=function(i){var o=document.createElement("li");o.className="select2-results__option";var n={role:"option","aria-selected":"false"},a=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;for(var r in(null!=i.element&&a.call(i.element,":disabled")||null==i.element&&i.disabled)&&(delete n["aria-selected"],n["aria-disabled"]="true"),null==i.id&&delete n["aria-selected"],null!=i._resultId&&(o.id=i._resultId),i.title&&(o.title=i.title),i.children&&(n.role="group",n["aria-label"]=i.text,delete n["aria-selected"]),n){var s=n[r];o.setAttribute(r,s)}if(i.children){var l=e(o),d=document.createElement("strong");d.className="select2-results__group",e(d),this.template(i,d);for(var c=[],u=0;u<i.children.length;u++){var h=i.children[u],p=this.option(h);c.push(p)}var f=e("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});f.append(c),l.append(d),l.append(f)}else this.template(i,o);return t.StoreData(o,"data",i),o},i.prototype.bind=function(i,o){var n=this,a=i.id+"-results";this.$results.attr("id",a),i.on("results:all",function(e){n.clear(),n.append(e.data),i.isOpen()&&(n.setClasses(),n.highlightFirstItem())}),i.on("results:append",function(e){n.append(e.data),i.isOpen()&&n.setClasses()}),i.on("query",function(e){n.hideMessages(),n.showLoading(e)}),i.on("select",function(){i.isOpen()&&(n.setClasses(),n.options.get("scrollAfterSelect")&&n.highlightFirstItem())}),i.on("unselect",function(){i.isOpen()&&(n.setClasses(),n.options.get("scrollAfterSelect")&&n.highlightFirstItem())}),i.on("open",function(){n.$results.attr("aria-expanded","true"),n.$results.attr("aria-hidden","false"),n.setClasses(),n.ensureHighlightVisible()}),i.on("close",function(){n.$results.attr("aria-expanded","false"),n.$results.attr("aria-hidden","true"),n.$results.removeAttr("aria-activedescendant")}),i.on("results:toggle",function(){var e=n.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),i.on("results:select",function(){var e=n.getHighlightedResults();if(0!==e.length){var i=t.GetData(e[0],"data");"true"==e.attr("aria-selected")?n.trigger("close",{}):n.trigger("select",{data:i})}}),i.on("results:previous",function(){var e=n.getHighlightedResults(),t=n.$results.find("[aria-selected]"),i=t.index(e);if(!(i<=0)){var o=i-1;0===e.length&&(o=0);var a=t.eq(o);a.trigger("mouseenter");var r=n.$results.offset().top,s=a.offset().top,l=n.$results.scrollTop()+(s-r);0===o?n.$results.scrollTop(0):s-r<0&&n.$results.scrollTop(l)}}),i.on("results:next",function(){var e=n.getHighlightedResults(),t=n.$results.find("[aria-selected]"),i=t.index(e)+1;if(!(i>=t.length)){var o=t.eq(i);o.trigger("mouseenter");var a=n.$results.offset().top+n.$results.outerHeight(!1),r=o.offset().top+o.outerHeight(!1),s=n.$results.scrollTop()+r-a;0===i?n.$results.scrollTop(0):a<r&&n.$results.scrollTop(s)}}),i.on("results:focus",function(e){e.element.addClass("select2-results__option--highlighted")}),i.on("results:message",function(e){n.displayMessage(e)}),e.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=n.$results.scrollTop(),i=n.$results.get(0).scrollHeight-t+e.deltaY,o=0<e.deltaY&&t-e.deltaY<=0,a=e.deltaY<0&&i<=n.$results.height();o?(n.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):a&&(n.$results.scrollTop(n.$results.get(0).scrollHeight-n.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(i){var o=e(this),a=t.GetData(this,"data");"true"!==o.attr("aria-selected")?n.trigger("select",{originalEvent:i,data:a}):n.options.get("multiple")?n.trigger("unselect",{originalEvent:i,data:a}):n.trigger("close",{})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(i){var o=t.GetData(this,"data");n.getHighlightedResults().removeClass("select2-results__option--highlighted"),n.trigger("results:focus",{data:o,element:e(this)})})},i.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},i.prototype.destroy=function(){this.$results.remove()},i.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(0!==e.length){var t=this.$results.find("[aria-selected]").index(e),i=this.$results.offset().top,o=e.offset().top,n=this.$results.scrollTop()+(o-i),a=o-i;n-=2*e.outerHeight(!1),t<=2?this.$results.scrollTop(0):(a>this.$results.outerHeight()||a<0)&&this.$results.scrollTop(n)}},i.prototype.template=function(t,i){var o=this.options.get("templateResult"),n=this.options.get("escapeMarkup"),a=o(t,i);null==a?i.style.display="none":"string"==typeof a?i.innerHTML=n(a):e(i).append(a)},i}),t.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),t.define("select2/selection/base",["jquery","../utils","../keys"],function(e,t,i){function o(e,t){this.$element=e,this.options=t,o.__super__.constructor.call(this)}return t.Extend(o,t.Observable),o.prototype.render=function(){var i=e('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=t.GetData(this.$element[0],"old-tabindex")?this._tabindex=t.GetData(this.$element[0],"old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),i.attr("title",this.$element.attr("title")),i.attr("tabindex",this._tabindex),i.attr("aria-disabled","false"),this.$selection=i},o.prototype.bind=function(e,t){var o=this,n=e.id+"-results";this.container=e,this.$selection.on("focus",function(e){o.trigger("focus",e)}),this.$selection.on("blur",function(e){o._handleBlur(e)}),this.$selection.on("keydown",function(e){o.trigger("keypress",e),e.which===i.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){o.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){o.update(e.data)}),e.on("open",function(){o.$selection.attr("aria-expanded","true"),o.$selection.attr("aria-owns",n),o._attachCloseHandler(e)}),e.on("close",function(){o.$selection.attr("aria-expanded","false"),o.$selection.removeAttr("aria-activedescendant"),o.$selection.removeAttr("aria-owns"),o.$selection.trigger("focus"),o._detachCloseHandler(e)}),e.on("enable",function(){o.$selection.attr("tabindex",o._tabindex),o.$selection.attr("aria-disabled","false")}),e.on("disable",function(){o.$selection.attr("tabindex","-1"),o.$selection.attr("aria-disabled","true")})},o.prototype._handleBlur=function(t){var i=this;window.setTimeout(function(){document.activeElement==i.$selection[0]||e.contains(i.$selection[0],document.activeElement)||i.trigger("blur",t)},1)},o.prototype._attachCloseHandler=function(i){e(document.body).on("mousedown.select2."+i.id,function(i){var o=e(i.target).closest(".select2");e(".select2.select2-container--open").each(function(){this!=o[0]&&t.GetData(this,"element").select2("close")})})},o.prototype._detachCloseHandler=function(t){e(document.body).off("mousedown.select2."+t.id)},o.prototype.position=function(e,t){t.find(".selection").append(e)},o.prototype.destroy=function(){this._detachCloseHandler(this.container)},o.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")},o}),t.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,i,o){function n(){n.__super__.constructor.apply(this,arguments)}return i.Extend(n,t),n.prototype.render=function(){var e=n.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},n.prototype.bind=function(e,t){var i=this;n.__super__.bind.apply(this,arguments);var o=e.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",o).attr("role","textbox").attr("aria-readonly","true"),this.$selection.attr("aria-labelledby",o),this.$selection.on("mousedown",function(e){1===e.which&&i.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(e){}),this.$selection.on("blur",function(e){}),e.on("focus",function(t){e.isOpen()||i.$selection.trigger("focus")})},n.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty(),e.removeAttr("title")},n.prototype.display=function(e,t){var i=this.options.get("templateSelection");return this.options.get("escapeMarkup")(i(e,t))},n.prototype.selectionContainer=function(){return e("<span></span>")},n.prototype.update=function(e){if(0!==e.length){var t=e[0],i=this.$selection.find(".select2-selection__rendered"),o=this.display(t,i);i.empty().append(o);var n=t.title||t.text;n?i.attr("title",n):i.removeAttr("title")}else this.clear()},n}),t.define("select2/selection/multiple",["jquery","./base","../utils"],function(e,t,i){function o(e,t){o.__super__.constructor.apply(this,arguments)}return i.Extend(o,t),o.prototype.render=function(){var e=o.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},o.prototype.bind=function(t,n){var a=this;o.__super__.bind.apply(this,arguments),this.$selection.on("click",function(e){a.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(t){if(!a.options.get("disabled")){var o=e(this).parent(),n=i.GetData(o[0],"data");a.trigger("unselect",{originalEvent:t,data:n})}})},o.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty(),e.removeAttr("title")},o.prototype.display=function(e,t){var i=this.options.get("templateSelection");return this.options.get("escapeMarkup")(i(e,t))},o.prototype.selectionContainer=function(){return e('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},o.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],o=0;o<e.length;o++){var n=e[o],a=this.selectionContainer(),r=this.display(n,a);a.append(r);var s=n.title||n.text;s&&a.attr("title",s),i.StoreData(a[0],"data",n),t.push(a)}var l=this.$selection.find(".select2-selection__rendered");i.appendMany(l,t)}},o}),t.define("select2/selection/placeholder",["../utils"],function(e){function t(e,t,i){this.placeholder=this.normalizePlaceholder(i.get("placeholder")),e.call(this,t,i)}return t.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},t.prototype.createPlaceholder=function(e,t){var i=this.selectionContainer();return i.html(this.display(t)),i.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),i},t.prototype.update=function(e,t){var i=1==t.length&&t[0].id!=this.placeholder.id;if(1<t.length||i)return e.call(this,t);this.clear();var o=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(o)},t}),t.define("select2/selection/allowClear",["jquery","../keys","../utils"],function(e,t,i){function o(){}return o.prototype.bind=function(e,t,i){var o=this;e.call(this,t,i),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(e){o._handleClear(e)}),t.on("keypress",function(e){o._handleKeyboardClear(e,t)})},o.prototype._handleClear=function(e,t){if(!this.options.get("disabled")){var o=this.$selection.find(".select2-selection__clear");if(0!==o.length){t.stopPropagation();var n=i.GetData(o[0],"data"),a=this.$element.val();this.$element.val(this.placeholder.id);var r={data:n};if(this.trigger("clear",r),r.prevented)this.$element.val(a);else{for(var s=0;s<n.length;s++)if(r={data:n[s]},this.trigger("unselect",r),r.prevented)return void this.$element.val(a);this.$element.trigger("change"),this.trigger("toggle",{})}}}},o.prototype._handleKeyboardClear=function(e,i,o){o.isOpen()||i.which!=t.DELETE&&i.which!=t.BACKSPACE||this._handleClear(i)},o.prototype.update=function(t,o){if(t.call(this,o),!(0<this.$selection.find(".select2-selection__placeholder").length||0===o.length)){var n=this.options.get("translations").get("removeAllItems"),a=e('<span class="select2-selection__clear" title="'+n()+'">&times;</span>');i.StoreData(a[0],"data",o),this.$selection.find(".select2-selection__rendered").prepend(a)}},o}),t.define("select2/selection/search",["jquery","../utils","../keys"],function(e,t,i){function o(e,t,i){e.call(this,t,i)}return o.prototype.render=function(t){var i=e('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" /></li>');this.$searchContainer=i,this.$search=i.find("input");var o=t.call(this);return this._transferTabIndex(),o},o.prototype.bind=function(e,o,n){var a=this,r=o.id+"-results";e.call(this,o,n),o.on("open",function(){a.$search.attr("aria-controls",r),a.$search.trigger("focus")}),o.on("close",function(){a.$search.val(""),a.$search.removeAttr("aria-controls"),a.$search.removeAttr("aria-activedescendant"),a.$search.trigger("focus")}),o.on("enable",function(){a.$search.prop("disabled",!1),a._transferTabIndex()}),o.on("disable",function(){a.$search.prop("disabled",!0)}),o.on("focus",function(e){a.$search.trigger("focus")}),o.on("results:focus",function(e){e.data._resultId?a.$search.attr("aria-activedescendant",e.data._resultId):a.$search.removeAttr("aria-activedescendant")}),this.$selection.on("focusin",".select2-search--inline",function(e){a.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){a._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){if(e.stopPropagation(),a.trigger("keypress",e),a._keyUpPrevented=e.isDefaultPrevented(),e.which===i.BACKSPACE&&""===a.$search.val()){var o=a.$searchContainer.prev(".select2-selection__choice");if(0<o.length){var n=t.GetData(o[0],"data");a.searchRemoveChoice(n),e.preventDefault()}}}),this.$selection.on("click",".select2-search--inline",function(e){a.$search.val()&&e.stopPropagation()});var s=document.documentMode,l=s&&s<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){l?a.$selection.off("input.search input.searchcheck"):a.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){if(l&&"input"===e.type)a.$selection.off("input.search input.searchcheck");else{var t=e.which;t!=i.SHIFT&&t!=i.CTRL&&t!=i.ALT&&t!=i.TAB&&a.handleSearch(e)}})},o.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},o.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},o.prototype.update=function(e,t){var i=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),i&&this.$search.trigger("focus")},o.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},o.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},o.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";e=""!==this.$search.attr("placeholder")?this.$selection.find(".select2-selection__rendered").width():.75*(this.$search.val().length+1)+"em",this.$search.css("width",e)},o}),t.define("select2/selection/eventRelay",["jquery"],function(e){function t(){}return t.prototype.bind=function(t,i,o){var n=this,a=["open","opening","close","closing","select","selecting","unselect","unselecting","clear","clearing"],r=["opening","closing","selecting","unselecting","clearing"];t.call(this,i,o),i.on("*",function(t,i){if(-1!==e.inArray(t,a)){i=i||{};var o=e.Event("select2:"+t,{params:i});n.$element.trigger(o),-1!==e.inArray(t,r)&&(i.prevented=o.isDefaultPrevented())}})},t}),t.define("select2/translation",["jquery","require"],function(e,t){function i(e){this.dict=e||{}}return i.prototype.all=function(){return this.dict},i.prototype.get=function(e){return this.dict[e]},i.prototype.extend=function(t){this.dict=e.extend({},t.all(),this.dict)},i._cache={},i.loadPath=function(e){if(!(e in i._cache)){var o=t(e);i._cache[e]=o}return new i(i._cache[e])},i}),t.define("select2/diacritics",[],function(){return{"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Œ":"OE","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","œ":"oe","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ώ":"ω","ς":"σ","’":"'"}}),t.define("select2/data/base",["../utils"],function(e){function t(e,i){t.__super__.constructor.call(this)}return e.Extend(t,e.Observable),t.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")},t.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")},t.prototype.bind=function(e,t){},t.prototype.destroy=function(){},t.prototype.generateResultId=function(t,i){var o=t.id+"-result-";return o+=e.generateChars(4),null!=i.id?o+="-"+i.id.toString():o+="-"+e.generateChars(4),o},t}),t.define("select2/data/select",["./base","../utils","jquery"],function(e,t,i){function o(e,t){this.$element=e,this.options=t,o.__super__.constructor.call(this)}return t.Extend(o,e),o.prototype.current=function(e){var t=[],o=this;this.$element.find(":selected").each(function(){var e=i(this),n=o.item(e);t.push(n)}),e(t)},o.prototype.select=function(e){var t=this;if(e.selected=!0,i(e.element).is("option"))return e.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(o){var n=[];(e=[e]).push.apply(e,o);for(var a=0;a<e.length;a++){var r=e[a].id;-1===i.inArray(r,n)&&n.push(r)}t.$element.val(n),t.$element.trigger("change")});else{var o=e.id;this.$element.val(o),this.$element.trigger("change")}},o.prototype.unselect=function(e){var t=this;if(this.$element.prop("multiple")){if(e.selected=!1,i(e.element).is("option"))return e.element.selected=!1,void this.$element.trigger("change");this.current(function(o){for(var n=[],a=0;a<o.length;a++){var r=o[a].id;r!==e.id&&-1===i.inArray(r,n)&&n.push(r)}t.$element.val(n),t.$element.trigger("change")})}},o.prototype.bind=function(e,t){var i=this;(this.container=e).on("select",function(e){i.select(e.data)}),e.on("unselect",function(e){i.unselect(e.data)})},o.prototype.destroy=function(){this.$element.find("*").each(function(){t.RemoveData(this)})},o.prototype.query=function(e,t){var o=[],n=this;this.$element.children().each(function(){var t=i(this);if(t.is("option")||t.is("optgroup")){var a=n.item(t),r=n.matches(e,a);null!==r&&o.push(r)}}),t({results:o})},o.prototype.addOptions=function(e){t.appendMany(this.$element,e)},o.prototype.option=function(e){var o;e.children?(o=document.createElement("optgroup")).label=e.text:void 0!==(o=document.createElement("option")).textContent?o.textContent=e.text:o.innerText=e.text,void 0!==e.id&&(o.value=e.id),e.disabled&&(o.disabled=!0),e.selected&&(o.selected=!0),e.title&&(o.title=e.title);var n=i(o),a=this._normalizeItem(e);return a.element=o,t.StoreData(o,"data",a),n},o.prototype.item=function(e){var o={};if(null!=(o=t.GetData(e[0],"data")))return o;if(e.is("option"))o={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){o={text:e.prop("label"),children:[],title:e.prop("title")};for(var n=e.children("option"),a=[],r=0;r<n.length;r++){var s=i(n[r]),l=this.item(s);a.push(l)}o.children=a}return(o=this._normalizeItem(o)).element=e[0],t.StoreData(e[0],"data",o),o},o.prototype._normalizeItem=function(e){return e!==Object(e)&&(e={id:e,text:e}),null!=(e=i.extend({},{text:""},e)).id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),i.extend({},{selected:!1,disabled:!1},e)},o.prototype.matches=function(e,t){return this.options.get("matcher")(e,t)},o}),t.define("select2/data/array",["./select","../utils","jquery"],function(e,t,i){function o(e,t){this._dataToConvert=t.get("data")||[],o.__super__.constructor.call(this,e,t)}return t.Extend(o,e),o.prototype.bind=function(e,t){o.__super__.bind.call(this,e,t),this.addOptions(this.convertToOptions(this._dataToConvert))},o.prototype.select=function(e){var t=this.$element.find("option").filter(function(t,i){return i.value==e.id.toString()});0===t.length&&(t=this.option(e),this.addOptions(t)),o.__super__.select.call(this,e)},o.prototype.convertToOptions=function(e){var o=this,n=this.$element.find("option"),a=n.map(function(){return o.item(i(this)).id}).get(),r=[];function s(e){return function(){return i(this).val()==e.id}}for(var l=0;l<e.length;l++){var d=this._normalizeItem(e[l]);if(0<=i.inArray(d.id,a)){var c=n.filter(s(d)),u=this.item(c),h=i.extend(!0,{},d,u),p=this.option(h);c.replaceWith(p)}else{var f=this.option(d);if(d.children){var m=this.convertToOptions(d.children);t.appendMany(f,m)}r.push(f)}}return r},o}),t.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,i){function o(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),o.__super__.constructor.call(this,e,t)}return t.Extend(o,e),o.prototype._applyDefaults=function(e){var t={data:function(e){return i.extend({},e,{q:e.term})},transport:function(e,t,o){var n=i.ajax(e);return n.then(t),n.fail(o),n}};return i.extend({},t,e,!0)},o.prototype.processResults=function(e){return e},o.prototype.query=function(e,t){var o=this;null!=this._request&&(i.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var n=i.extend({type:"GET"},this.ajaxOptions);function a(){var a=n.transport(n,function(n){var a=o.processResults(n,e);o.options.get("debug")&&window.console&&console.error&&(a&&a.results&&i.isArray(a.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),t(a)},function(){"status"in a&&(0===a.status||"0"===a.status)||o.trigger("results:message",{message:"errorLoading"})});o._request=a}"function"==typeof n.url&&(n.url=n.url.call(this.$element,e)),"function"==typeof n.data&&(n.data=n.data.call(this.$element,e)),this.ajaxOptions.delay&&null!=e.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(a,this.ajaxOptions.delay)):a()},o}),t.define("select2/data/tags",["jquery"],function(e){function t(t,i,o){var n=o.get("tags"),a=o.get("createTag");void 0!==a&&(this.createTag=a);var r=o.get("insertTag");if(void 0!==r&&(this.insertTag=r),t.call(this,i,o),e.isArray(n))for(var s=0;s<n.length;s++){var l=n[s],d=this._normalizeItem(l),c=this.option(d);this.$element.append(c)}}return t.prototype.query=function(e,t,i){var o=this;this._removeOldTags(),null!=t.term&&null==t.page?e.call(this,t,function e(n,a){for(var r=n.results,s=0;s<r.length;s++){var l=r[s],d=null!=l.children&&!e({results:l.children},!0);if((l.text||"").toUpperCase()===(t.term||"").toUpperCase()||d)return!a&&(n.data=r,void i(n))}if(a)return!0;var c=o.createTag(t);if(null!=c){var u=o.option(c);u.attr("data-select2-tag",!0),o.addOptions([u]),o.insertTag(r,c)}n.results=r,i(n)}):e.call(this,t,i)},t.prototype.createTag=function(t,i){var o=e.trim(i.term);return""===o?null:{id:o,text:o}},t.prototype.insertTag=function(e,t,i){t.unshift(i)},t.prototype._removeOldTags=function(t){this.$element.find("option[data-select2-tag]").each(function(){this.selected||e(this).remove()})},t}),t.define("select2/data/tokenizer",["jquery"],function(e){function t(e,t,i){var o=i.get("tokenizer");void 0!==o&&(this.tokenizer=o),e.call(this,t,i)}return t.prototype.bind=function(e,t,i){e.call(this,t,i),this.$search=t.dropdown.$search||t.selection.$search||i.find(".select2-search__field")},t.prototype.query=function(t,i,o){var n=this;i.term=i.term||"";var a=this.tokenizer(i,this.options,function(t){var i=n._normalizeItem(t);if(!n.$element.find("option").filter(function(){return e(this).val()===i.id}).length){var o=n.option(i);o.attr("data-select2-tag",!0),n._removeOldTags(),n.addOptions([o])}!function(e){n.trigger("select",{data:e})}(i)});a.term!==i.term&&(this.$search.length&&(this.$search.val(a.term),this.$search.trigger("focus")),i.term=a.term),t.call(this,i,o)},t.prototype.tokenizer=function(t,i,o,n){for(var a=o.get("tokenSeparators")||[],r=i.term,s=0,l=this.createTag||function(e){return{id:e.term,text:e.term}};s<r.length;){var d=r[s];if(-1!==e.inArray(d,a)){var c=r.substr(0,s),u=l(e.extend({},i,{term:c}));null!=u?(n(u),r=r.substr(s+1)||"",s=0):s++}else s++}return{term:r}},t}),t.define("select2/data/minimumInputLength",[],function(){function e(e,t,i){this.minimumInputLength=i.get("minimumInputLength"),e.call(this,t,i)}return e.prototype.query=function(e,t,i){t.term=t.term||"",t.term.length<this.minimumInputLength?this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}}):e.call(this,t,i)},e}),t.define("select2/data/maximumInputLength",[],function(){function e(e,t,i){this.maximumInputLength=i.get("maximumInputLength"),e.call(this,t,i)}return e.prototype.query=function(e,t,i){t.term=t.term||"",0<this.maximumInputLength&&t.term.length>this.maximumInputLength?this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}}):e.call(this,t,i)},e}),t.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,i){this.maximumSelectionLength=i.get("maximumSelectionLength"),e.call(this,t,i)}return e.prototype.bind=function(e,t,i){var o=this;e.call(this,t,i),t.on("select",function(){o._checkIfMaximumSelected()})},e.prototype.query=function(e,t,i){var o=this;this._checkIfMaximumSelected(function(){e.call(o,t,i)})},e.prototype._checkIfMaximumSelected=function(e,t){var i=this;this.current(function(e){var o=null!=e?e.length:0;0<i.maximumSelectionLength&&o>=i.maximumSelectionLength?i.trigger("results:message",{message:"maximumSelected",args:{maximum:i.maximumSelectionLength}}):t&&t()})},e}),t.define("select2/dropdown",["jquery","./utils"],function(e,t){function i(e,t){this.$element=e,this.options=t,i.__super__.constructor.call(this)}return t.Extend(i,t.Observable),i.prototype.render=function(){var t=e('<span class="select2-dropdown"><span class="select2-results"></span></span>');return t.attr("dir",this.options.get("dir")),this.$dropdown=t},i.prototype.bind=function(){},i.prototype.position=function(e,t){},i.prototype.destroy=function(){this.$dropdown.remove()},i}),t.define("select2/dropdown/search",["jquery","../utils"],function(e,t){function i(){}return i.prototype.render=function(t){var i=t.call(this),o=e('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" /></span>');return this.$searchContainer=o,this.$search=o.find("input"),i.prepend(o),i},i.prototype.bind=function(t,i,o){var n=this,a=i.id+"-results";t.call(this,i,o),this.$search.on("keydown",function(e){n.trigger("keypress",e),n._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(t){e(this).off("keyup")}),this.$search.on("keyup input",function(e){n.handleSearch(e)}),i.on("open",function(){n.$search.attr("tabindex",0),n.$search.attr("aria-controls",a),n.$search.trigger("focus"),window.setTimeout(function(){n.$search.trigger("focus")},0)}),i.on("close",function(){n.$search.attr("tabindex",-1),n.$search.removeAttr("aria-controls"),n.$search.removeAttr("aria-activedescendant"),n.$search.val(""),n.$search.trigger("blur")}),i.on("focus",function(){i.isOpen()||n.$search.trigger("focus")}),i.on("results:all",function(e){null!=e.query.term&&""!==e.query.term||(n.showSearch(e)?n.$searchContainer.removeClass("select2-search--hide"):n.$searchContainer.addClass("select2-search--hide"))}),i.on("results:focus",function(e){e.data._resultId?n.$search.attr("aria-activedescendant",e.data._resultId):n.$search.removeAttr("aria-activedescendant")})},i.prototype.handleSearch=function(e){if(!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=!1},i.prototype.showSearch=function(e,t){return!0},i}),t.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,i,o){this.placeholder=this.normalizePlaceholder(i.get("placeholder")),e.call(this,t,i,o)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.removePlaceholder=function(e,t){for(var i=t.slice(0),o=t.length-1;0<=o;o--){var n=t[o];this.placeholder.id===n.id&&i.splice(o,1)}return i},e}),t.define("select2/dropdown/infiniteScroll",["jquery"],function(e){function t(e,t,i,o){this.lastParams={},e.call(this,t,i,o),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return t.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&(this.$results.append(this.$loadingMore),this.loadMoreIfNeeded())},t.prototype.bind=function(e,t,i){var o=this;e.call(this,t,i),t.on("query",function(e){o.lastParams=e,o.loading=!0}),t.on("query:append",function(e){o.lastParams=e,o.loading=!0}),this.$results.on("scroll",this.loadMoreIfNeeded.bind(this))},t.prototype.loadMoreIfNeeded=function(){var t=e.contains(document.documentElement,this.$loadingMore[0]);if(!this.loading&&t){var i=this.$results.offset().top+this.$results.outerHeight(!1);this.$loadingMore.offset().top+this.$loadingMore.outerHeight(!1)<=i+50&&this.loadMore()}},t.prototype.loadMore=function(){this.loading=!0;var t=e.extend({},{page:1},this.lastParams);t.page++,this.trigger("query:append",t)},t.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},t.prototype.createLoadingMore=function(){var t=e('<li class="select2-results__option select2-results__option--load-more"role="option" aria-disabled="true"></li>'),i=this.options.get("translations").get("loadingMore");return t.html(i(this.lastParams)),t},t}),t.define("select2/dropdown/attachBody",["jquery","../utils"],function(e,t){function i(t,i,o){this.$dropdownParent=e(o.get("dropdownParent")||document.body),t.call(this,i,o)}return i.prototype.bind=function(e,t,i){var o=this;e.call(this,t,i),t.on("open",function(){o._showDropdown(),o._attachPositioningHandler(t),o._bindContainerResultHandlers(t)}),t.on("close",function(){o._hideDropdown(),o._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},i.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},i.prototype.position=function(e,t,i){t.attr("class",i.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=i},i.prototype.render=function(t){var i=e("<span></span>"),o=t.call(this);return i.append(o),this.$dropdownContainer=i},i.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()},i.prototype._bindContainerResultHandlers=function(e,t){if(!this._containerResultsHandlersBound){var i=this;t.on("results:all",function(){i._positionDropdown(),i._resizeDropdown()}),t.on("results:append",function(){i._positionDropdown(),i._resizeDropdown()}),t.on("results:message",function(){i._positionDropdown(),i._resizeDropdown()}),t.on("select",function(){i._positionDropdown(),i._resizeDropdown()}),t.on("unselect",function(){i._positionDropdown(),i._resizeDropdown()}),this._containerResultsHandlersBound=!0}},i.prototype._attachPositioningHandler=function(i,o){var n=this,a="scroll.select2."+o.id,r="resize.select2."+o.id,s="orientationchange.select2."+o.id,l=this.$container.parents().filter(t.hasScroll);l.each(function(){t.StoreData(this,"select2-scroll-position",{x:e(this).scrollLeft(),y:e(this).scrollTop()})}),l.on(a,function(i){var o=t.GetData(this,"select2-scroll-position");e(this).scrollTop(o.y)}),e(window).on(a+" "+r+" "+s,function(e){n._positionDropdown(),n._resizeDropdown()})},i.prototype._detachPositioningHandler=function(i,o){var n="scroll.select2."+o.id,a="resize.select2."+o.id,r="orientationchange.select2."+o.id;this.$container.parents().filter(t.hasScroll).off(n),e(window).off(n+" "+a+" "+r)},i.prototype._positionDropdown=function(){var t=e(window),i=this.$dropdown.hasClass("select2-dropdown--above"),o=this.$dropdown.hasClass("select2-dropdown--below"),n=null,a=this.$container.offset();a.bottom=a.top+this.$container.outerHeight(!1);var r={height:this.$container.outerHeight(!1)};r.top=a.top,r.bottom=a.top+r.height;var s=this.$dropdown.outerHeight(!1),l=t.scrollTop(),d=t.scrollTop()+t.height(),c=l<a.top-s,u=d>a.bottom+s,h={left:a.left,top:r.bottom},p=this.$dropdownParent;"static"===p.css("position")&&(p=p.offsetParent());var f=p.offset();h.top-=f.top,h.left-=f.left,i||o||(n="below"),u||!c||i?!c&&u&&i&&(n="below"):n="above",("above"==n||i&&"below"!==n)&&(h.top=r.top-f.top-s),null!=n&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+n),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+n)),this.$dropdownContainer.css(h)},i.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},i.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},i}),t.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(e,t,i,o){this.minimumResultsForSearch=i.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),e.call(this,t,i,o)}return e.prototype.showSearch=function(e,t){return!(function e(t){for(var i=0,o=0;o<t.length;o++){var n=t[o];n.children?i+=e(n.children):i++}return i}(t.data.results)<this.minimumResultsForSearch)&&e.call(this,t)},e}),t.define("select2/dropdown/selectOnClose",["../utils"],function(e){function t(){}return t.prototype.bind=function(e,t,i){var o=this;e.call(this,t,i),t.on("close",function(e){o._handleSelectOnClose(e)})},t.prototype._handleSelectOnClose=function(t,i){if(i&&null!=i.originalSelect2Event){var o=i.originalSelect2Event;if("select"===o._type||"unselect"===o._type)return}var n=this.getHighlightedResults();if(!(n.length<1)){var a=e.GetData(n[0],"data");null!=a.element&&a.element.selected||null==a.element&&a.selected||this.trigger("select",{data:a})}},t}),t.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,i){var o=this;e.call(this,t,i),t.on("select",function(e){o._selectTriggered(e)}),t.on("unselect",function(e){o._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var i=t.originalEvent;i&&(i.ctrlKey||i.metaKey)||this.trigger("close",{originalEvent:i,originalSelect2Event:t})},e}),t.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,i="Please delete "+t+" character";return 1!=t&&(i+="s"),i},inputTooShort:function(e){return"Please enter "+(e.minimum-e.input.length)+" or more characters"},loadingMore:function(){return"Loading more results…"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching…"},removeAllItems:function(){return"Remove all items"}}}),t.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(e,t,i,o,n,a,r,s,l,d,c,u,h,p,f,m,g,v,b,y,w,_,S,C,k,T,$,x,E){function A(){this.reset()}return A.prototype.apply=function(c){if(null==(c=e.extend(!0,{},this.defaults,c)).dataAdapter){if(null!=c.ajax?c.dataAdapter=f:null!=c.data?c.dataAdapter=p:c.dataAdapter=h,0<c.minimumInputLength&&(c.dataAdapter=d.Decorate(c.dataAdapter,v)),0<c.maximumInputLength&&(c.dataAdapter=d.Decorate(c.dataAdapter,b)),0<c.maximumSelectionLength&&(c.dataAdapter=d.Decorate(c.dataAdapter,y)),c.tags&&(c.dataAdapter=d.Decorate(c.dataAdapter,m)),null==c.tokenSeparators&&null==c.tokenizer||(c.dataAdapter=d.Decorate(c.dataAdapter,g)),null!=c.query){var u=t(c.amdBase+"compat/query");c.dataAdapter=d.Decorate(c.dataAdapter,u)}if(null!=c.initSelection){var E=t(c.amdBase+"compat/initSelection");c.dataAdapter=d.Decorate(c.dataAdapter,E)}}if(null==c.resultsAdapter&&(c.resultsAdapter=i,null!=c.ajax&&(c.resultsAdapter=d.Decorate(c.resultsAdapter,C)),null!=c.placeholder&&(c.resultsAdapter=d.Decorate(c.resultsAdapter,S)),c.selectOnClose&&(c.resultsAdapter=d.Decorate(c.resultsAdapter,$))),null==c.dropdownAdapter){if(c.multiple)c.dropdownAdapter=w;else{var A=d.Decorate(w,_);c.dropdownAdapter=A}if(0!==c.minimumResultsForSearch&&(c.dropdownAdapter=d.Decorate(c.dropdownAdapter,T)),c.closeOnSelect&&(c.dropdownAdapter=d.Decorate(c.dropdownAdapter,x)),null!=c.dropdownCssClass||null!=c.dropdownCss||null!=c.adaptDropdownCssClass){var L=t(c.amdBase+"compat/dropdownCss");c.dropdownAdapter=d.Decorate(c.dropdownAdapter,L)}c.dropdownAdapter=d.Decorate(c.dropdownAdapter,k)}if(null==c.selectionAdapter){if(c.multiple?c.selectionAdapter=n:c.selectionAdapter=o,null!=c.placeholder&&(c.selectionAdapter=d.Decorate(c.selectionAdapter,a)),c.allowClear&&(c.selectionAdapter=d.Decorate(c.selectionAdapter,r)),c.multiple&&(c.selectionAdapter=d.Decorate(c.selectionAdapter,s)),null!=c.containerCssClass||null!=c.containerCss||null!=c.adaptContainerCssClass){var I=t(c.amdBase+"compat/containerCss");c.selectionAdapter=d.Decorate(c.selectionAdapter,I)}c.selectionAdapter=d.Decorate(c.selectionAdapter,l)}c.language=this._resolveLanguage(c.language),c.language.push("en");for(var M=[],D=0;D<c.language.length;D++){var O=c.language[D];-1===M.indexOf(O)&&M.push(O)}return c.language=M,c.translations=this._processTranslations(c.language,c.debug),c},A.prototype.reset=function(){function t(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return u[e]||e})}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:d.escapeMarkup,language:{},matcher:function i(o,n){if(""===e.trim(o.term))return n;if(n.children&&0<n.children.length){for(var a=e.extend(!0,{},n),r=n.children.length-1;0<=r;r--)null==i(o,n.children[r])&&a.children.splice(r,1);return 0<a.children.length?a:i(o,a)}var s=t(n.text).toUpperCase(),l=t(o.term).toUpperCase();return-1<s.indexOf(l)?n:null},minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,scrollAfterSelect:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},A.prototype.applyFromElement=function(e,t){var i=e.language,o=this.defaults.language,n=t.prop("lang"),a=t.closest("[lang]").prop("lang"),r=Array.prototype.concat.call(this._resolveLanguage(n),this._resolveLanguage(i),this._resolveLanguage(o),this._resolveLanguage(a));return e.language=r,e},A.prototype._resolveLanguage=function(t){if(!t)return[];if(e.isEmptyObject(t))return[];if(e.isPlainObject(t))return[t];var i;i=e.isArray(t)?t:[t];for(var o=[],n=0;n<i.length;n++)if(o.push(i[n]),"string"==typeof i[n]&&0<i[n].indexOf("-")){var a=i[n].split("-")[0];o.push(a)}return o},A.prototype._processTranslations=function(t,i){for(var o=new c,n=0;n<t.length;n++){var a=new c,r=t[n];if("string"==typeof r)try{a=c.loadPath(r)}catch(t){try{r=this.defaults.amdLanguageBase+r,a=c.loadPath(r)}catch(t){i&&window.console&&console.warn&&console.warn('Select2: The language file for "'+r+'" could not be automatically loaded. A fallback will be used instead.')}}else a=e.isPlainObject(r)?new c(r):r;o.extend(a)}return o},A.prototype.set=function(t,i){var o={};o[e.camelCase(t)]=i;var n=d._convertData(o);e.extend(!0,this.defaults,n)},new A}),t.define("select2/options",["require","jquery","./defaults","./utils"],function(e,t,i,o){function n(t,n){if(this.options=t,null!=n&&this.fromElement(n),null!=n&&(this.options=i.applyFromElement(this.options,n)),this.options=i.apply(this.options),n&&n.is("input")){var a=e(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=o.Decorate(this.options.dataAdapter,a)}}return n.prototype.fromElement=function(e){var i=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),o.GetData(e[0],"select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),o.StoreData(e[0],"data",o.GetData(e[0],"select2Tags")),o.StoreData(e[0],"tags",!0)),o.GetData(e[0],"ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",o.GetData(e[0],"ajaxUrl")),o.StoreData(e[0],"ajax-Url",o.GetData(e[0],"ajaxUrl")));var n={};function a(e,t){return t.toUpperCase()}for(var r=0;r<e[0].attributes.length;r++){var s=e[0].attributes[r].name,l="data-";if(s.substr(0,l.length)==l){var d=s.substring(l.length),c=o.GetData(e[0],d);n[d.replace(/-([a-z])/g,a)]=c}}t.fn.jquery&&"1."==t.fn.jquery.substr(0,2)&&e[0].dataset&&(n=t.extend(!0,{},e[0].dataset,n));var u=t.extend(!0,{},o.GetData(e[0]),n);for(var h in u=o._convertData(u))-1<t.inArray(h,i)||(t.isPlainObject(this.options[h])?t.extend(this.options[h],u[h]):this.options[h]=u[h]);return this},n.prototype.get=function(e){return this.options[e]},n.prototype.set=function(e,t){this.options[e]=t},n}),t.define("select2/core",["jquery","./options","./utils","./keys"],function(e,t,i,o){var n=function(e,o){null!=i.GetData(e[0],"select2")&&i.GetData(e[0],"select2").destroy(),this.$element=e,this.id=this._generateId(e),o=o||{},this.options=new t(o,e),n.__super__.constructor.call(this);var a=e.attr("tabindex")||0;i.StoreData(e[0],"old-tabindex",a),e.attr("tabindex","-1");var r=this.options.get("dataAdapter");this.dataAdapter=new r(e,this.options);var s=this.render();this._placeContainer(s);var l=this.options.get("selectionAdapter");this.selection=new l(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,s);var d=this.options.get("dropdownAdapter");this.dropdown=new d(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,s);var c=this.options.get("resultsAdapter");this.results=new c(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var u=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){u.trigger("selection:update",{data:e})}),e.addClass("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),i.StoreData(e[0],"select2",this),e.data("select2",this)};return i.Extend(n,i.Observable),n.prototype._generateId=function(e){return"select2-"+(null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+i.generateChars(2):i.generateChars(4)).replace(/(:|\.|\[|\]|,)/g,"")},n.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},n.prototype._resolveWidth=function(e,t){var i=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var o=this._resolveWidth(e,"style");return null!=o?o:this._resolveWidth(e,"element")}if("element"==t){var n=e.outerWidth(!1);return n<=0?"auto":n+"px"}if("style"!=t)return"computedstyle"!=t?t:window.getComputedStyle(e[0]).width;var a=e.attr("style");if("string"!=typeof a)return null;for(var r=a.split(";"),s=0,l=r.length;s<l;s+=1){var d=r[s].replace(/\s/g,"").match(i);if(null!==d&&1<=d.length)return d[1]}return null},n.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},n.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this.$element.on("focus.select2",function(e){t.trigger("focus",e)}),this._syncA=i.bind(this._syncAttributes,this),this._syncS=i.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var o=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=o?(this._observer=new o(function(i){e.each(i,t._syncA),e.each(i,t._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",t._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",t._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",t._syncS,!1))},n.prototype._registerDataEvents=function(){var e=this;this.dataAdapter.on("*",function(t,i){e.trigger(t,i)})},n.prototype._registerSelectionEvents=function(){var t=this,i=["toggle","focus"];this.selection.on("toggle",function(){t.toggleDropdown()}),this.selection.on("focus",function(e){t.focus(e)}),this.selection.on("*",function(o,n){-1===e.inArray(o,i)&&t.trigger(o,n)})},n.prototype._registerDropdownEvents=function(){var e=this;this.dropdown.on("*",function(t,i){e.trigger(t,i)})},n.prototype._registerResultsEvents=function(){var e=this;this.results.on("*",function(t,i){e.trigger(t,i)})},n.prototype._registerEvents=function(){var e=this;this.on("open",function(){e.$container.addClass("select2-container--open")}),this.on("close",function(){e.$container.removeClass("select2-container--open")}),this.on("enable",function(){e.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){e.$container.addClass("select2-container--disabled")}),this.on("blur",function(){e.$container.removeClass("select2-container--focus")}),this.on("query",function(t){e.isOpen()||e.trigger("open",{}),this.dataAdapter.query(t,function(i){e.trigger("results:all",{data:i,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(i){e.trigger("results:append",{data:i,query:t})})}),this.on("keypress",function(t){var i=t.which;e.isOpen()?i===o.ESC||i===o.TAB||i===o.UP&&t.altKey?(e.close(),t.preventDefault()):i===o.ENTER?(e.trigger("results:select",{}),t.preventDefault()):i===o.SPACE&&t.ctrlKey?(e.trigger("results:toggle",{}),t.preventDefault()):i===o.UP?(e.trigger("results:previous",{}),t.preventDefault()):i===o.DOWN&&(e.trigger("results:next",{}),t.preventDefault()):(i===o.ENTER||i===o.SPACE||i===o.DOWN&&t.altKey)&&(e.open(),t.preventDefault())})},n.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},n.prototype._syncSubtree=function(e,t){var i=!1,o=this;if(!e||!e.target||"OPTION"===e.target.nodeName||"OPTGROUP"===e.target.nodeName){if(t)if(t.addedNodes&&0<t.addedNodes.length)for(var n=0;n<t.addedNodes.length;n++)t.addedNodes[n].selected&&(i=!0);else t.removedNodes&&0<t.removedNodes.length&&(i=!0);else i=!0;i&&this.dataAdapter.current(function(e){o.trigger("selection:update",{data:e})})}},n.prototype.trigger=function(e,t){var i=n.__super__.trigger,o={open:"opening",close:"closing",select:"selecting",unselect:"unselecting",clear:"clearing"};if(void 0===t&&(t={}),e in o){var a=o[e],r={prevented:!1,name:e,args:t};if(i.call(this,a,r),r.prevented)return void(t.prevented=!0)}i.call(this,e,t)},n.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},n.prototype.open=function(){this.isOpen()||this.trigger("query",{})},n.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},n.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},n.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},n.prototype.focus=function(e){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},n.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),null!=e&&0!==e.length||(e=[!0]);var t=!e[0];this.$element.prop("disabled",t)},n.prototype.data=function(){this.options.get("debug")&&0<arguments.length&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var e=[];return this.dataAdapter.current(function(t){e=t}),e},n.prototype.val=function(t){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==t||0===t.length)return this.$element.val();var i=t[0];e.isArray(i)&&(i=e.map(i,function(e){return e.toString()})),this.$element.val(i).trigger("change")},n.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",i.GetData(this.$element[0],"old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),i.RemoveData(this.$element[0]),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},n.prototype.render=function(){var t=e('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return t.attr("dir",this.options.get("dir")),this.$container=t,this.$container.addClass("select2-container--"+this.options.get("theme")),i.StoreData(t[0],"element",this.$element),t},n}),t.define("jquery-mousewheel",["jquery"],function(e){return e}),t.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults","./select2/utils"],function(e,t,i,o,n){if(null==e.fn.select2){var a=["open","close","destroy"];e.fn.select2=function(t){if("object"==typeof(t=t||{}))return this.each(function(){var o=e.extend(!0,{},t);new i(e(this),o)}),this;if("string"!=typeof t)throw new Error("Invalid arguments for Select2: "+t);var o,r=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=n.GetData(this,"select2");null==e&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2."),o=e[t].apply(e,r)}),-1<e.inArray(t,a)?this:o}}return null==e.fn.select2.defaults&&(e.fn.select2.defaults=o),i}),{define:t.define,require:t.require}}(),i=t.require("jquery.select2");return e.fn.select2.amd=t,i});var auth={};function isDefined(e){return void 0!==e}auth.showLoginPopup=function(e,t){var i=screen.width/2-350,o="menubar=no,toolbar=no,status=no,location=0,directories=no,status=0,width=700,height=650,top="+(screen.height/2-325)+",left="+i;globalLoader.showGlobalLoader(),$.oauthpopup({path:t.attr("href"),windowOptions:o,callback:function(){auth.socialAuth(t.data("service-name")),globalLoader.hideGlobalLoader()}})},auth.getState=function(){var e={};return $.ajax({url:"/chk",async:!1,dataType:"json",success:function(t){e=t}}),e},auth.socialAuth=function(e){if(auth.getState().id)"undefined"!=typeof me&&"object"==typeof meRouter&&meRouter.isHashCheckAfterSignin(meRouter.getCurrentAnchorAction())&&meRouter.unSetCurrentHashAction(),location.reload();else switch(e){case"facebook":popup.error(Lang.CANT_GET_FACEBOOK_SOCIAL_PROFILE,"error",void 0,1e4);break;case"google":popup.error(Lang.CANT_GET_GOOGLE_SOCIAL_PROFILE,"error",void 0,1e4);break;default:popup.error(Lang.CANT_GET_SOCIAL_PROFILE,"error",void 0,1e4)}};var ud=void 0,App={};function ContentPopup(e){this.options=$.extend({holder:null,popup:".popup",btnOpen:".open",btnClose:".close",openClass:"popup-active",clickEvent:"click",mode:"click",hideOnClickLink:!0,hideOnClickOutside:!0,delay:50},e),this.options.holder&&(this.holder=$(this.options.holder),this.init())}App.ajaxSuccess=function(e){return Boolean("object"==typeof e&&e&&typeof e.success!==ud&&parseInt(e.success))},App.ajaxError=function(e,t){if(App.ajaxSuccess(e))return!1;if("object"==typeof e&&e&&typeof e.error!==ud&&e.error){if("function"==typeof t){var i=t(e);return typeof i===ud?e.error:i}return"string"==typeof e.error&&("ERR_PERM"!==e.error&&"NOT_SIGNED_IN"!==e.error||me.getCheckState(function(){auth.isSignedIn()||auth.open()})),e.error}return"ERR_UNEXPECTED_RESULT"},String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,i){return void 0!==e[i]?e[i]:t})}),String.prototype.includes||(String.prototype.includes=function(){"use strict";return-1!==String.prototype.indexOf.apply(this,arguments)}),App.cutString=function(e,t,i){this.tempDiv=document.createElement("div"),this.tempDiv.id="TempNodeForTest",this.tempDiv.innerHTML=e,this.charCount=0,this.limit=t,this.disableCutWord=i||!1},App.cutString.prototype.cut=function(){var e=document.createElement("div");return this.searchEnd(this.tempDiv,e),e.innerHTML},App.cutString.prototype.searchEnd=function(e,t){for(var i,o,n=0;n<e.childNodes.length;n++)if(3==(i=e.childNodes[n]).nodeType){if(i.nodeValue.length+this.charCount>=this.limit)return o=i.cloneNode(!0),this.disableCutWord&&this.limit-i.nodeValue.lastIndexOf(" ")<=20&&i.nodeValue.lastIndexOf(" ",this.limit-this.charCount)>0?o.nodeValue=i.nodeValue.substr(0,i.nodeValue.lastIndexOf(" ",this.limit-this.charCount)):o.nodeValue=i.nodeValue.substr(0,this.limit-this.charCount),t.appendChild(o),!0;o=i.cloneNode(!0),t.appendChild(o),this.charCount+=i.nodeValue.length}else{if(o=i.cloneNode(!0),t.appendChild(o),0===i.childNodes.length)continue;o.innerHTML="";var a=this.searchEnd(i,o);if(a)return a}return!1},ContentPopup.prototype={init:function(){this.findElements(),this.attachEvents()},findElements:function(){this.popup=this.holder.find(this.options.popup),this.btnOpen=this.holder.find(this.options.btnOpen),this.btnClose=this.holder.find(this.options.btnClose)},attachEvents:function(){var e=this;if(this.clickMode=isTouchDevice||e.options.mode===e.options.clickEvent,this.clickMode)this.btnOpen.bind(e.options.clickEvent,function(t){e.holder.hasClass(e.options.openClass)?e.options.hideOnClickLink&&e.hidePopup():e.showPopup(),t.preventDefault()}),this.outsideClickHandler=this.bind(this.outsideClickHandler,this);else{var t,i=function(i){clearTimeout(t),t=setTimeout(function(){i.call(e)},e.options.delay)};this.btnOpen.bind("mouseover",function(){i(e.showPopup)}).bind("mouseout",function(){i(e.hidePopup)}),this.popup.bind("mouseover",function(){i(e.showPopup)}).bind("mouseout",function(){i(e.hidePopup)})}this.btnClose.bind(e.options.clickEvent,function(t){e.hidePopup(),t.preventDefault()})},outsideClickHandler:function(e){var t=$((e.changedTouches?e.changedTouches[0]:e).target);t.closest(this.popup).length||t.closest(this.btnOpen).length||this.hidePopup()},showPopup:function(){this.holder.addClass(this.options.openClass),this.popup.css({display:"block"}),this.clickMode&&this.options.hideOnClickOutside&&!this.outsideHandlerActive&&(this.outsideHandlerActive=!0,$(document).bind("click touchstart",this.outsideClickHandler))},hidePopup:function(){this.holder.removeClass(this.options.openClass),this.popup.css({display:"none"}),this.clickMode&&this.options.hideOnClickOutside&&this.outsideHandlerActive&&(this.outsideHandlerActive=!1,$(document).unbind("click touchstart",this.outsideClickHandler))},bind:function(e,t,i){return function(){return e.apply(t,i?[i]:arguments)}}};var isTouchDevice=/Windows Phone/.test(navigator.userAgent)||"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;$.fn.contentPopup=function(e){return this.each(function(){new ContentPopup($.extend(e,{holder:this}))})},function(e,t){t.fn.lockOn=function(e){return t(this).data("lock"+("string"==typeof e?e:""),1),t(this)},t.fn.lockOff=function(e){return t(this).removeData("lock"+("string"==typeof e?e:"")),t(this)},t.fn.lockCheck=function(e){return t(this).data("lock"+("string"==typeof e?e:""))},t.fn.lockTimeout=function(e,i,o){var n=t(this);n.lockCheck(o)||(n.lockOn(o),i(),setTimeout(function(){n.lockOff(o)},e))}}(0,jQuery);var popup=window.popup={},ud="undefined",extendPopup=!1,scrollPosition=0;jQuery(function(e){e(document).on("show.bs.modal",function(t){e("body").hasClass("modal-open")&&bootbox.hideAll(),e().saveIphoneScrollPosition()}),e(document).on("shown.bs.modal",function(t){e().initDialogScroll()}),e(document).on("hidden.bs.modal",function(t){e().returnToSavedIphoneScroll()}),e(window).on("resize",function(){let t=e(".modal-content .close i");t.removeClass("mobile-icon"),_IS_MOBILE_&&!_IS_TABLET_&&t.addClass("mobile-icon")})}),popup.confirm=function(e,t,i,o,n,a,r){var s=function(e){e?"function"==typeof t&&t():"function"==typeof i&&i(),"function"==typeof o&&o()},l={cancel:Lang.CANCEL,ok:Lang.OK};"object"==typeof a&&$.extend(l,a);var d="popup-confirm";return"string"==typeof r&&(d+=" "+r),popup.extended({message:e,className:d,closeButton:!1,buttons:{cancel:{label:l.cancel,className:"button cancel same-size-desktop",callback:function(){s(0)}},ok:{label:l.ok,className:"button ok same-size-desktop",callback:function(){s(1)}}},onEscape:function(){s(0)},onClose:function(){"function"==typeof n&&n()}})},popup.notify=function(e,t,i){var o={message:e,className:"popup-notify"};typeof t===ud&&t||(o.title=t),typeof i!==ud&&(o.callback=i),o.closeButton=!1,o.buttons={ok:{className:"button"}};var n=bootbox.alert(o);return popup.appendCloseButton(n),popup.fixZIndexes(),n},popup.success=function(e,t,i){popup.flash(e,"success",void 0,void 0,i)},popup.error=function(e,t,i,o){var n="error";typeof t!=ud&&(n+=" "+t),popup.flash(e,n,o,void 0,i)},popup.flash=function(e,t,i,o,n){var a=2e3;typeof i===ud&&t.indexOf("success")>-1?i=3e3:typeof i===ud&&t.indexOf("error")>-1&&(i=2e3,a=3e3),typeof t===ud&&(t="info");var r="flash-alert";typeof o!==ud&&o&&(r+=" footer"),$(".bootstrap.flash-alert").length&&$(".bootstrap.flash-alert").detach();var s='<div class="bootstrap '+r+'"><div class="alert alert-'+t+'"><i class="fmi-flash-yes"></i><i class="fmi-flash-no"></i>'+e+"</div></div>",l=$(s);l.appendTo($("body")),l.show().addClass("visible");var d=function(){l.removeClass("visible").detach(),c.detach(),void 0!==n&&n()};$(".bootstrap.flash-alert a").on("click",function(){d()});var c=$("<div class='flash-overlay'></div>");c.on("click",function(){d()}),t.indexOf("error")>-1&&-1==t.indexOf("no-connection")&&$(s).find("a").length&&(i=5e3);var u=setTimeout(d,i);_IS_MOBILE_?(c.appendTo($("body")),l.find(".alert").click(function(){clearTimeout(u)})):l.find(".alert").hover(function(){clearTimeout(u)},function(){u=setTimeout(d,a)})},popup.extended=function(e){if(void 0!==e.title&&e.title.length&&(e.title='<p class="title-text">'+e.title+"</p>"),void 0!==e.iconClass&&void 0!==e.title){var t="i";void 0!==e.iconTag&&(t=e.iconTag);var i="<"+t+' class="'+e.iconClass+'"></'+t+">";-1==e.title.indexOf(e.iconClass)&&(e.title=i+e.title)}var o=bootbox.dialog(e).on("shown.bs.modal",function(e){$(".bootbox select.form-control").each(function(){popup.checkFilled($(this))})});return popup.appendCloseButton(o),popup.fixZIndexes(),o.find(".close").click(function(){"undefined"!=typeof me&&void 0!==meRouter&&(""!=meRouter.getCurrentAnchorAction()||meRouter.getCurrentAnchorAction().indexOf("gallery|photo")<0)&&meRouter.unSetCurrentHashAction(),void 0!==e.onClose&&e.onClose()}),$(".modal-backdrop").on("click",function(){$(".bootbox.modal").hasClass("popup-confirm")||(bootbox.hideAll(),void 0!==meRouter&&meRouter.unSetCurrentHashAction())}),$("textarea[name=emails]",o).length&&$("textarea[name=emails]",o).autosize(),_IS_MOBILE_&&(o.find(".button.save").addClass("modal-header-button"),$(window).width()<=_TABLET_&&o.hasClass("popup-confirm")?o.addClass("simple-popup"):o.hasClass("popup-confirm")||o.addClass("material-mobile")),this.extendPopup=this.removeScroll(o,!0),this.extendPopup},popup.checkFilled=function(e){e.removeClass("filled"),e.val()&&e.addClass("filled")},popup.removeScroll=function(e,t){return e.on("shown.bs.modal",function(e){e.target===this&&(t&&$(".bootbox.modal").css({overflowY:"scroll"}),$("html, #header .head, #sticky_bar").css("width",$(window).width()+"px"),$(window).on("resize",function(){$("body").hasClass("modal-open")&&$("html, #header .head, #sticky_bar").css("width",$(window).width()+"px")}),$("html").css({overflow:"hidden"}),$("body.ie11").length&&$(window).width()>=_MOBILE_&&($("input[placeholder]:not('.placeholder-visible')").attr("placeholder",""),$("textarea[placeholder]:not('.placeholder-visible')").attr("placeholder",""))),$("body").addClass("modal-open")}),e.on("hidden.bs.modal",function(e){e.target===this&&($("html, #header .head, #sticky_bar").removeAttr("style"),t&&$(".bootbox.modal").css({overflow:"hidden"}))}),e},popup.native=function(e){return bootbox.dialog(e)},popup.extendedWhiteFullScreen=function(e){void 0!==e.className?e.className+=" modal-full-white":e.className="modal-full-white",e.closeButton=!1;var t=bootbox.dialog(e);var i=$('<div class="close"><i class="fmi-close '+(_IS_MOBILE_&&!_IS_TABLET_?"mobile-icon":"")+'"></i></div>');return i.click(function(){return void 0!==e.onEscape?e.onEscape():t.modal("hide"),!1}),t.append(i),popup.fixZIndexes(),t},popup.extendedBlackFullScreen=function(e){void 0!==e.className?e.className+=" modal-full-black":e.className="modal-full-black",e.closeButton=!1;var t=bootbox.dialog(e);var i=$('<div class="close"><i class="fmi-close '+(_IS_MOBILE_&&!_IS_TABLET_?"mobile-icon":"")+'"></i></div>');return i.click(function(){return void 0!==meRouter&&meRouter.unSetCurrentHashAction(),void 0!==e.onEscape?e.onEscape():t.modal("hide"),!1}),$(".modal-dialog",t).append(i),popup.fixZIndexes(),this.removeScroll(t,!1),t},popup.appendCloseButton=function(e){let t=$('<div class="close" data-dismiss="modal" aria-hidden="true"><i class="fmi-close '+(_IS_MOBILE_&&!_IS_TABLET_?"mobile-icon":"")+'"></i></div>');e.find(".modal-content").prepend(t)},popup.fixZIndexes=function(){if(!($(".modal-backdrop.in").length<1)){var e=0;$(".bootbox.modal, .modal-backdrop").each(function(){var t=$(this);e||(e=parseInt(t.css("z-index"))+100);var i=e+=10;t.hasClass("modal-backdrop")&&(i-=15),t.css("z-index",i)})}},popup.closePopupIfExist=function(){$(".modal-header").length&&(bootbox.hideAll(),$(".bootbox.modal").length||$("html, body").removeClass("modal-open"))};var globalLoader=function(){};globalLoader.spinnerTimeout=!1,globalLoader.showGlobalLoader=function(e,t){t=t||!1;var i=$("#global-spinner-template");if(!$("#global-spinner").length){var o=i.clone();o.removeAttr("id").attr("id","global-spinner"),t&&o.addClass("show-immediately"),$(o).insertAfter(i),$("#global-spinner").removeClass("hidden").addClass("showLoader")}void 0===e&&(globalLoader.spinnerTimeout=setTimeout(function(){globalLoader.hideGlobalLoader()},1e4))},globalLoader.hideGlobalLoader=function(){globalLoader.spinnerTimeout=!1;var e=$("#global-spinner");e.length&&e.remove()},globalLoader.isGlobalLoader=function(){return!!$("#global-spinner").is(":visible")};var imgPreload={loadedImagesStack:[],loadedImagesStackLength:50,preloadImage:function(e){var t;for(t=0;t<imgPreload.loadedImagesStack.length;t++)if(imgPreload.loadedImagesStack[t]==e)return!0;var i=new Image;if(i.src=e,imgPreload.loadedImagesStack.push(i),imgPreload.loadedImagesStack.length>imgPreload.loadedImagesStackLength){var o=imgPreload.loadedImagesStack.length/2,n=imgPreload.loadedImagesStack.length;for(t=o;t<n;t++)delete imgPreload.loadedImagesStack[t];imgPreload.loadedImagesStack=imgPreload.loadedImagesStack.slice(o,n)}return i}};me.checkGalleryImgErrors=function(e){$("img",e).on("error",function(e){var t=$(e.target);t.attr("srcDist",t.attr("src")),t.attr("src","/assets/images/no_img.png"),t.attr("srcError","checkGalleryImgErrors")})},me.getVendorPrefix=function(){if(typeof me.vendorPrefix!==ud)return me.vendorPrefix;var e,t,i,o;for(t=(document.body||document.documentElement).style,o=["Moz","Webkit","Khtml","O","ms"],i=(i="transition").charAt(0).toUpperCase()+i.substr(1),e=0;e<o.length;){if("string"==typeof t[o[e]+i])return me.vendorPrefix=o[e],o[e];e++}return!1},$.fn.animateRotate=function(e,t,i,o){var n=$.speed(t,i,o),a=n.step,r=me.getVendorPrefix();return this.each(function(t,i){n.step=function(e){if($.style(i,r+"Transform","rotate("+e+"deg)"),a)return a.apply(this,arguments)},$(this).data("animateRotate",$({deg:0}).animate({deg:e},n))})},$.fn.animateRotateRevert=function(e,t,i){var o=$.speed(e,t,i),n=o.step,a=me.getVendorPrefix();return this.each(function(e,t){var i=$(this).data("animateRotate");i&&i.stop(1),o.step=function(e){if($.style(t,a+"Transform","rotate("+e+"deg)"),n)return n.apply(this,arguments)},$(this).animate({deg:0},o)})},$.fn.animateReset=function(){$.style($(this).get(0),me.getVendorPrefix()+"Transform","none")};var share={isSlideshow:0,getBox:function(e){return $("div.share-dropdown-box[data="+e+"]")},action:function(e,t,i){var o="entity"+e.substring(0,1).toUpperCase()+e.substring(1);if(!share.hasOwnProperty(o))throw"Unknown share method ["+e+"]";if(!me.canShare())return me.changeSettingsDialog(function(){return share[o](t,i)}),!1;share[o](t,i),globalLoader.hideGlobalLoader()}};$.fn.share_dropdownShow=function(){var e=$(this),t=e.data("share-entity"),i=e.data("share-id"),o="share-"+t+"-"+i,n=share.getBox(o),a={email:Lang.EMAIL,face:Lang.FACEBOOK};if(_IS_MOBILE_&&(a.email=Lang.SHARE_MOBILE_DIALOG_EMAIL,a.face=Lang.SHARE_MOBILE_DIALOG_FACEBOOK),!n.length){var r="|share|"+t+"|"+i;if(n=$('<div class="share-dropdown-box"><div class="mobile-dialog-menu-wrapper"><div class="backdrop"></div><div class="submenu-wrapper"><ul class="submenu"><li><a class="facebook action" href="javascript:void(0)" '+"onclick=\"eventTracking.run('content_share_FB_click', 'invitations_and_sharing', '"+t+'\');" data-action="facebook" data-entity="'+t+'" data-eid="'+i+'" data-ajax-url="'+r+'|facebook"><i class="fmi-facebook-box"></i>'+a.face+"</a></li><li><a class=\"email action\" href=\"javascript:void(0)\" onclick=\"eventTracking.run('content_share_by_email_click', 'invitations_and_sharing', '"+t+'\');" data-action="email" data-entity="'+t+'" data-eid="'+i+'" data-ajax-url="'+r+'|email"><i class="fmi-mail-icon-2"></i>'+a.email+'</a></li></ul></div></div><div class="drop-shadow"></div></div>'),_IS_MOBILE_)$().saveIphoneScrollPosition(),n.attr("data",o).appendTo(e.parent()),n.addClass("mobile"),n.on("click",".backdrop",function(){$("html, body").removeClass("sub-menu-dialog-open modal-open"),e.share_dropdownHide()}),me.on("swipeDown",function(){let t=n.find(".submenu");t.is(":visible")&&0===t.scrollTop()&&($("html, body").removeClass("sub-menu-dialog-open modal-open"),e.share_dropdownHide())});else{n.attr("data",o).appendTo(e),e.css({position:"relative"});var s=n.offset(),l=n.outerWidth(),d=$(window).outerWidth(),c=s.left;c+l+5>d&&n.css({left:d-(c+l)-5+"px"})}n.on("click","a.action",function(){var e=$(this).data("action"),t=$(this).data("entity"),i=$(this).data("eid");share.action(e,t,i)}),n.addClass("in");var u=n.find(".mobile-dialog-menu-wrapper");u.addClass("active"),$(".submenu-wrapper",u).addClass("active").outerHeight(),$(".submenu-wrapper .submenu, .backdrop",u).addClass("active")}},$.fn.share_dropdownHide=function(){var e=$(this),t="share-"+e.data("share-entity")+"-"+e.data("share-id"),i=share.getBox(t);if(i.length)if(_IS_MOBILE_){i.removeClass("in");var o=i.find(".mobile-dialog-menu-wrapper");$(".submenu-wrapper .submenu, .backdrop",o).removeClass("active"),setTimeout(function(){$(".submenu-wrapper",o).removeClass("active"),o.removeClass("active"),i.detach(),$().returnToSavedIphoneScroll()},200)}else void 0!==$.support.transition.end?i.removeClass("in").one($.support.transition.end,function(){i.hasClass("in")||i.detach()}).emulateTransitionEnd(900):i.detach()},function(e){e.fn.scrollAndHighlight=function(){const t=e(this);if(t.length)return e("html, body").animate({scrollTop:t.offset().top-120},1e3,"swing",function(){t.fadeOut("fast").fadeIn("slow")}),t},e.fn.removeSelection=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},e.fn.saveIphoneScrollPosition=function(){e("body").hasClass("safari")&&e("body").hasClass("iphone")&&(scrollPosition=e(window).scrollTop())},e.fn.unsetIphoneScrollPosition=function(){scrollPosition=0},e.fn.returnToSavedIphoneScroll=function(){e("body").hasClass("safari")&&e("body").hasClass("iphone")&&scrollPosition&&!meRouter.getScrollPosition()?e("html, body").animate({scrollTop:scrollPosition},0,null,function(){scrollPosition=0}):scrollPosition=0},e.fn.initDialogScroll=function(){const t=e(".modal .modal-content");if(t.length){let i=t.offset().top;e("body.iphone").length&&(i=t.offset().top-60),e(".bootbox.modal").on("scroll",function(){e().checkDialogScrolled(i)})}},e.fn.checkDialogScrolled=function(t){if(void 0===t&&(t=0),_IS_MOBILE_){const i=e(".modal .modal-content");i.length&&i.offset().top<t?i.addClass("scrolled"):i.removeClass("scrolled")}}}(jQuery),window.uploader_basic={},function(e,t){t.init=function(i){if(!(i=e.extend({serverUrl:null,corsBase:"/js/uploader/cors/",$inputFile:null,eventAddFile:null,eventProgressFile:null,eventUploadedFile:null,eventUploadFail:null,$dropZone:null,dropHoverCallback:null,rawUploaderOptions:{}},i)).serverUrl)throw"Server url empty";if(!i.$inputFile||1!=i.$inputFile.length)throw"Wrong input file selector.";var o=function(){var o={url:i.serverUrl,dataType:"json",sequentialUploads:!0,limitConcurrentUploads:1,maxChunkSize:7e7,redirect:i.corsBase+"result.html?%s",add:i.eventAddFile,progress:i.eventProgressFile,done:i.eventUploadedFile,fail:i.eventUploadFail};i.$dropZone&&(o.dropZone=i.$dropZone,o.dropZone.unbind("dragover"),o.dropZone.unbind("drop"),i.$inputFile.data("dropZone",i.$dropZone)),i.$inputFile.fileupload(e.extend(o,i.rawUploaderOptions)),i.$dropZone&&t.initDropZone(i)};return e("body").is(".ie8, .ie9")?e.getScript("/js/dist/uploader-xdr.js?"+App.ver,function(){o()}):o(),i.$inputFile},t.initDropZone=function(t){var i=t.$dropZone;i&&i.length&&(i.data("dropZoneInited")||(i.data("dropZoneInited",1),i.addClass("dropzone"),e(document).on("dragover",function(i){var o=e(".dropzone"),n=window.dropZoneTimeout;n?clearTimeout(n):o.addClass("in");var a=!1,r=i.target;do{if(r===o[0]){a=!0;break}r=r.parentNode}while(null!==r);a?("function"!=typeof t.dropHoverCallback||o.hasClass("hover")||t.dropHoverCallback(),o.addClass("hover")):o.removeClass("hover"),window.dropZoneTimeout=setTimeout(function(){window.dropZoneTimeout=null,o.removeClass("in hover")},100)})))},e.fn.uploaderBasic_removeDropZone=function(){var t=e(this).data("dropZone");t&&t.length&&(t.unbind("dragover"),t.unbind("drop"),t.data("dropZoneInited",0))}}(jQuery,window.uploader_basic),function(e){window.uploader_story={},me.uploaderUnlockStoryTimeoutId=!1;window.uploader_story.init=function(t){var i={};t=i.opts=e.extend(!0,i.opts,{$uploader:null,type:null,limitUploadItems:!1,serverUrl:"",$inputFile:null,editMode:0,allowedMimeTypes:null,saveCallback:null,autostartUpload:!0,fileAdded:null,firstFileAdded:null,dropHoverCallback:null,rawUploaderOptions:{}},t);var o=i.opts.$uploader=t.$inputFile.closest(".uploader");return function(t){t.destroy=function(e){e.uploaderBasic_removeDropZone()},t.setFile=function(e){t.opts.$uploader.data("file")?e&&("youtube"==e.gallery_type&&e.name&&(e.title=e.name),t.opts.$uploader.data("file",e)):t.opts.$uploader.data("file",e)},t.lockStoryButtons=function(){var e=t.opts.$uploader.closest("form");es.$modal&&(e=es.$modal);var i=e.find(".publish-button"),o=e.find(".publish-button");i.length&&i.addClass("disabled"),o.length&&o.addClass("disabled"),clearTimeout(t.uploaderUnlockStoryTimeoutId)},t.unLockStoryButtons=function(){t.uploaderUnlockTimeoutId=setTimeout(function(){var e=t.opts.$uploader.closest("form");es.$modal&&(e=es.$modal);var i=e.find(".publish-button"),o=e.find(".publish-button");i.length&&i.removeClass("disabled"),o.length&&o.removeClass("disabled"),t.uploaderUnlockStoryTimeoutId=!1},1e3)},t.getFile=function(){return slideShowActions.mediaFileObj?slideShowActions.mediaFileObj:t.opts.$uploader.data("file")},t.eventAddFile=function(i,o){var n=e(".uploader-box",t.opts.$uploader);if(n.is(":visible")){var a=o.files[0];if(t.setFile(a),t.opts.allowedMimeTypes&&typeof a.type!==ud){var r=a.type;if(e.inArray(r,t.opts.allowedMimeTypes)<0&&(r="audio/mpeg"==r||"audio/mpg"==r?"audio/mp3":"audio/"+a.name.substr(a.name.lastIndexOf(".")+1)),e.inArray(r,t.opts.allowedMimeTypes)<0)return console.warn(r),jsLogger.showCustomBackError("j30002",[a.name,r],Lang.FILE_TYPE_NOT_ALLOWED.format(a.name),Lang.CONTACT_CUSTOMER_SUPPORT),!1}n.hide(),e(".uploading-progress .line",t.opts.$uploader).css({width:0}),t.setIconState("posting",e(".uploading-progress",t.opts.$uploader)),e(".uploading-progress",t.opts.$uploader).addClass("in");var s="unknown";e(".uploading-progress .preview div[data-type]",t.opts.$uploader).addClass("hidden"),a.type&&(s=t.getFileType(a.type)),e('.uploading-progress .preview div[data-type="'+s+'"]',t.opts.$uploader).removeClass("hidden"),"function"==typeof t.opts.fileAdded&&t.opts.fileAdded(),t.opts.$uploader.data("uploadingXHR",o.submit())}},t.eventProgressFile=function(i,o){parseInt(o.total)<1||(t.lockStoryButtons(),t.progressCalculate(o),e(window).on("resize",function(){o.loaded==o.total?e(".progressbar .line",o.context).css({width:"100%"}):t.progressCalculate(o)}))},t.progressCalculate=function(e){var i=parseInt(e.total),o=parseInt(e.loaded)/i*100;100==o?t.progressBackCalculate(o/3,e.context):t.drawProgressLine(o/3,e.context)},t.progressBackCalculate=function(e,i){if(t.drawProgressLine(e,i),e<95){var o=Math.floor(500*Math.random())+100;e>90&&(o=Math.floor(2500*Math.random())+1e3),t.uploaderProgressTimeoutId=setTimeout(function(){e+=2,t.progressBackCalculate(e,i)},o)}100==e&&clearTimeout(t.uploaderProgressTimeoutId)},t.drawProgressLine=function(t,i){parentWidth=e(".uploading-progress.in .line_wrapper",i).outerWidth(),progressBarWidth=Math.ceil(t*parentWidth/100),progressBarWidth<=parentWidth?e(".progressbar .line",i).animate({width:progressBarWidth},.3,"linear"):e(".progressbar .line",i).css({width:parentWidth+"px"})},t.getFileType=function(e){var t=window.AppMemorial_config.allowMimes;return t.photo.indexOf(e)>=0?"photo":t.audio.indexOf(e)>=0?"audio":t.video.indexOf(e)>=0?"video":t.doc.indexOf(e)>=0?"doc":"unknown"},t.setIconState=function(t,i){i.removeClass("posting error success").addClass(t),e(".img_wrapper",i).removeClass("posting error success").addClass(t)},t.eventUploadedFile=function(i,o){if(t.setIconState("error",e(".uploading-progress.in",t.opts.$uploader)),t.progressBackCalculate(100,t.opts.$uploader),!o||!o.result)throw"No result data";if(o.result.error)t.showError(o.result.error);else{if(1!=o.result.files.length)throw"Unexpected files count.";var n=o.result.files[0];t.setFile(n),typeof n.error!==ud&&n.error?t.showError(n.error):(t.unLockStoryButtons(),t.showFile())}},t.showFile=function(){var i=t.getFile(),o=i.gallery_type,n=e(".file-preview."+o,t.opts.$uploader),a=e(".rotate-controls",t.opts.$uploader).hide(),r=typeof i.can_edit===ud||i.can_edit;if(i){var s=t.opts.$uploader.parent().parent().parent().parent().find(".story-media img").attr("src");i.url||(i.url=s),i.mimg||(i.mimg=s)}n.addClass("in"),t.setIconState("success",n),e(".uploading-progress",t.opts.$uploader).removeClass("in"),"photo"==o?(t.prehideServerPosting(),i.mimg?e("img",n).one("load",function(){t.hideServerPosting()}).attr("src",i.mimg).removeClass("hidden"):e("img",n).one("load",function(){t.hideServerPosting()}).attr("src",i.simg).removeClass("hidden"),r&&a.show()):"video"==o?(t.prehideServerPosting(),e("img",n).one("load",function(){t.hideServerPosting()}).attr("src","/assets/images/icons/icon_video.gif").removeClass("hidden")):"youtube"==o?(t.prehideServerPosting(),e("img",n).one("load",function(){t.hideServerPosting()}).attr("src",i.url).removeClass("hidden")):"audio"==o?(t.prehideServerPosting(),e("img",n).one("load",function(){t.hideServerPosting()}).attr("src","/assets/images/icons/icon_audio.png").removeClass("hidden")):"doc"==o&&(t.prehideServerPosting(),e("img",n).one("load",function(){t.hideServerPosting()}).attr("src","/assets/images/pdf.svg").removeClass("hidden")),e("input",n).removeAttr("disabled"),e("input",n).val(""),("photo"!=o&&"video"!=o&&"doc"!=o||t.opts.editMode)&&e("input",n).val(i.title),"video"!=o&&"audio"!=o||(n.attr("data-not-ready",i.id).attr("data-oid",i.id),a.hide()),e(".publish-button").hasClass("disabled")&&e(".publish-button").removeClass("disabled"),0==e(".modal-dialog").length&&e(">.buttons",t.opts.$uploader.parent().parent()).show(),e("input[name=album_file_id]",t.opts.$uploader.closest("form")).val(i.id)},t.eventUploadFail=function(i,o){var n=t.opts.$uploader;if(t.progressBackCalculate(100,n),n&&n.data("uploadingXHR")&&n.removeData("uploadingXHR"),(n=e(".uploading-progress.in .item",t.opts.$item)).hasClass("canceled")||t.setIconState("error",n),"song"==t.opts.type);else if(!n.hasClass("canceled")){var a=Lang.UPLOADING_FAIL_CLICK_TO_TRY_AGAIN,r=e("<span />").addClass("upload-error-message").html(a);n.append(r)}},t.removeMedia=function(i){t.clearMediaBox();var o=e.Deferred(),n=t.getFile();if(n&&typeof n.delete_url!==ud&&n.delete_url){var a=typeof i!==ud&&i||!t.opts.editMode;o=e.ajax({url:n.delete_url+(a?"&clear_autosave=1":""),type:n.delete_type,async:!0,dataType:"json"})}else o.resolve();return t.setFile(null),o},t.clearMediaBox=function(){var i=t.opts.$uploader.data("uploadingXHR");i&&i.abort(),t.opts.$uploader.data("uploadingXHR",null),e(".upload-error-message",t.opts.$uploader).remove(),$item=e(".uploading-progress.in .item",t.opts.$item),t.setIconState("posting",$item),e(".uploader-box",t.opts.$uploader).fadeIn(),e(".file-preview",t.opts.$uploader).removeClass("in"),e(".uploading-progress",t.opts.$uploader).removeClass("in"),setTimeout(function(){e(".file-preview img").each(function(){e(this).attr("src","").addClass("hidden")}),t.setFile(null)},500)},t.showError=function(t){e(".uploading-progress .progressbar").hide().after('<div class="error">'+t+'<br>Please try again or <a href="/contactus" style="float: inherit" target="_blank">contact customer support</a>.</div>')},t.prehideServerPosting=function(){e(".file-preview",t.opts.$uploader).addClass("prehide")},t.hideServerPosting=function(){e(".file-preview",t.opts.$uploader).removeClass("prehide")},t.playClick=function(){var i=t.opts.$uploader,o=e(".file-preview.audio",i),n=e("audio",i),a=o.data("url"),r=e(".player",i);a&&(n.length?App.mediaPlayer(n,function(e){r.hasClass("pause")?(e.pause(),o.songShowPlay()):(o.songShowPause(),e.play())}):(e('<audio class="hidden-audio-box"></audio>').attr("src",a).appendTo(i),n=e("audio",i),App.mediaPlayer(n,function(e){e.addEventListener("pause",function(){o.trigger("playlist-pause",[o,e])}),e.addEventListener("play",function(){o.trigger("playlist-play",[o,e])}),e.addEventListener("stop",function(){o.trigger("playlist-stop",[o,e])}),e.addEventListener("timeupdate",function(t){o.trigger("playlist-timeupdate",[o,e,t])}),e.addEventListener("loadedmetadata",function(t){o.trigger("playlist-metaloaded",[o,e])}),e.pauseOthers(),e.setSrc(a),e.load(),App.playlist_attachTimeline(o,e),o.songShowPause(),e.play()})))}}(i),window.uploader_basic.init({serverUrl:t.serverUrl,$inputFile:t.$inputFile,eventAddFile:i.eventAddFile,eventProgressFile:i.eventProgressFile,eventUploadedFile:i.eventUploadedFile,eventUploadFail:i.eventUploadFail,$dropZone:t.dropZone,dropHoverCallback:t.dropHoverCallback,rawUploaderOptions:t.rawUploaderOptions}),i.opts.allowedMimeTypes=(t.$inputFile.attr("data-accept")+"").split(/ *, */),o.on("click",".rotate-controls a.left, .item .rotate_controls a.rotate_left",function(){return window.uploader_gallery.rotateItemStoriesMedia(e(this).closest(".file-preview"),"left",i.getFile()),!1}).on("click",".rotate-controls a.right, .item .rotate_controls a.rotate_right",function(){return window.uploader_gallery.rotateItemStoriesMedia(e(this).closest(".file-preview"),"right",i.getFile()),!1}).on("click",".source-youtube .button.submit, .file-preview a.remove, .uploading-progress a, .item a.cancel, .file-preview .delete > a",function(){return i.removeMedia(),e(".source-youtube",o).hide(),e(".source-youtube .buttons",o).hide(),e(".source-youtube .buttons .cancel",o).hide(),e(".publish-button").removeClass("disabled"),e(".chooser",o).show(),0==e(".modal-dialog").length&&e(">.buttons",i.opts.$uploader.parent().parent()).show(),!1}).on("click",".file-preview a.player",function(){return i.playClick(),!1}),i}}(jQuery),window.uploader_gallery={},me.opts={},me.$items=null,me.$item=null,me.uploaderUnlockTimeoutId=!1,me.uploaderProgressTimeoutId=!1,me.uploaderInit=function(e){var t=(e=me.opts=$.extend(!0,me.opts,{type:null,limitUploadItems:!1,limitMaxUploadItems:!1,serverUrl:"",$inputFile:null,allowedMimeTypes:null,saveCallback:null,autostartUpload:!0,showRotationControls:!0,fileAdded:null,firstFileAdded:null,lastFileRemoved:null,dropHoverCallback:null,rawUploaderOptions:{}},e)).$inputFile.closest(".uploader");window.uploader_basic.init({serverUrl:e.serverUrl,$inputFile:e.$inputFile,eventAddFile:me.eventAddFile,eventProgressFile:me.eventProgressFile,eventUploadedFile:me.eventUploadedFile,eventUploadFail:me.eventUploadFail,$dropZone:$("body"),dropHoverCallback:e.dropHoverCallback,rawUploaderOptions:e.rawUploaderOptions}),me.unLockButtons(),me.opts.allowedMimeTypes=(e.$inputFile.attr("data-accept")+"").split(/ *, */),me.$items=$(".uploaded.items",t);var i=$(".item.blank",me.$items);me.$item=i.first().clone().removeClass("blank"),typeof e.type!==ud&&"song"==e.type?($(".preview > .image",me.$item).detach(),$(".preview > .video",me.$item).detach(),$(".preview > .youtube",me.$item).detach()):typeof e.type!==ud&&"video"==e.type?($(".preview > .image",me.$item).detach(),$(".preview > .song",me.$item).detach(),$(".preview > .youtube",me.$item).detach()):($(".preview > .song",me.$item).detach(),$(".preview > .video",me.$item).detach(),$(".preview > .youtube",me.$item).detach()),i.detach(),t.on("click",".item a.cancel",function(){var e=$(this).closest(".item").addClass("canceled");return me.removeItem(e),me.unLockButtons(),!1}).off("click",".item .rotate_controls a.rotate_left").on("click",".item .rotate_controls a.rotate_left",function(){return window.uploader_gallery.rotateItemGallery($(this).closest(".item"),"left"),!1}).off("click",".item .rotate_controls a.rotate_right").on("click",".item .rotate_controls a.rotate_right",function(){return window.uploader_gallery.rotateItemGallery($(this).closest(".item"),"right"),!1}).on("click",".item .song a.player",function(){var e=$(this).closest(".item");return me.playClick(e),!1}),$(".button.save",t).click(function(){return me.lockButtons(),"song"==me.opts.type&&$("[data-clicked-play]",t).removeAttr("data-clicked-play"),me.opts.autostartUpload?me.saveItems():$(".item",me.$items).each(function(e,t){var i=$(t);me.showServerPosting(i),me.submitFile(i)}),!1}),$(".button.more",t).click(function(e){$(this).parent().find("input[type=file]").click()}),me.checkUploadLimitationsInit()},me.destroy=function(){me.opts.$inputFile.uploaderBasic_removeDropZone()},me.eventAddFile=function(e,t){if(typeof t.files===ud||!t.files.length)throw"undefined or null data.files";if(!me.checkUploadLimitations())return!1;var i=t.files[0],o=i.name.substr(i.name.lastIndexOf(".")+1).toLowerCase(),n=i.type.toLowerCase();if(typeof n===ud||i.type||-1===["heic","heif","webp"].indexOf(o)||(n="image/"+o),me.opts.allowedMimeTypes&&typeof n!==ud&&n){if($.inArray(n,me.opts.allowedMimeTypes)<0&&(n="audio/mpeg"==n||"audio/mpg"==n?"audio/mp3":"audio/"+o),$.inArray(n,me.opts.allowedMimeTypes)<0)return void jsLogger.showCustomBackError("j29004",{filename:i.name,fileType:n},Lang.FILE_TYPE_NOT_ALLOWED.format(i.name),Lang.CONTACT_CUSTOMER_SUPPORT)}else if(typeof n!==ud&&!n)return void jsLogger.showCustomBackError("j29004",{filename:i.name,fileType:n},Lang.EMPTY_FILE_TYPE,Lang.CONTACT_CUSTOMER_SUPPORT);var a=me.$item.clone(!0);a.data("preparedData",t),me.opts.showRotationControls||$(".rotate_controls",a).hide(),"song"==me.opts.type&&a.find(".edit_name input").attr("disabled","disabled"),"function"==typeof me.opts.fileAdded&&me.opts.fileAdded(),"function"!=typeof me.opts.firstFileAdded||$(">.item:visible",me.$items).length||me.opts.firstFileAdded(),a.appendTo(me.$items).fadeIn(),t.context=a,me.checkUploadLimitations(),me.opts.autostartUpload&&(me.showServerPosting([a]),a.data("uploadingXHR",t.submit()))},me.eventProgressFile=function(e,t){var i=parseInt(t.total);me.lockButtons(),i<1||(me.progressCalculate(t),$(window).on("resize",function(){t.loaded==t.total?$(".progressbar .line",t.context).css({width:"100%"}):me.progressCalculate(t)}))},me.progressCalculate=function(e){var t=parseInt(e.total),i=parseInt(e.loaded)/t*100;100==i?me.progressBackCalculate(i/3,e.context):me.drawProgressLine(i/3,e.context)},me.progressBackCalculate=function(e,t){if(me.drawProgressLine(e,t),e<95){var i=Math.floor(500*Math.random())+100;e>90&&(i=Math.floor(2500*Math.random())+1e3),me.uploaderProgressTimeoutId=setTimeout(function(){e+=2,me.progressBackCalculate(e,t)},i)}100==e&&clearTimeout(me.uploaderProgressTimeoutId)},me.drawProgressLine=function(e,t){$line=$(".progressbar .line",t),parentWidth=$line.parent().outerWidth(),progressBarWidth=Math.ceil(e*parentWidth/100),progressBarWidth<=parentWidth?$(".progressbar .line",t).animate({width:progressBarWidth},.3,"linear"):$(".progressbar .line",t).css({width:parentWidth+"px"})},me.eventUploadedFile=function(e,t){var i=t.context;if(me.progressBackCalculate(100,i),me.setIconState("error",i),i&&i.data("uploadingXHR")&&i.removeData("uploadingXHR"),!t||!t.result)throw"No result data";if(t.result.error)return me.showError(i,t.result.error),void($(".uploaded.items .item.success").length&&me.unLockButtons());if(1!=t.result.files.length)throw"Unexpected files count.";var o=t.result.files[0];if("song"==me.opts.type&&o.title&&i.find(".edit_name input").removeAttr("disabled").val(o.title),o.error)return me.showError(i,o.error),void($(".uploaded.items .item.success").length&&me.unLockButtons());if(t.context.data("uploadedFile",o),me.opts.autostartUpload)typeof o.simg!==ud?(me.prehideServerPosting([i]),$(".preview img",i).one("load",function(){me.hideServerPosting([i])}).attr("src",o.simg)):me.hideServerPosting([i]);else{if(i.attr("data-clicked-play")&&"song"==me.opts.type)return me.hideServerPosting(i),i.attr("ready",o.id).attr("data-oid",o.id),me.playClick(i),!1;me.saveItems(i)}me.setIconState("success",i),eventTracking.run(me.opts.type,"content_additions",o.type),me.unLockButtons(),i.trigger("afterupload")},me.setIconState=function(e,t){t.removeClass("posting error success").addClass(e),$(".img_wrapper",t).removeClass("posting error success").addClass(e)},me.eventUploadFail=function(e,t){var i=$(t.context);if(me.progressBackCalculate(100,i),i&&i.data("uploadingXHR")&&i.removeData("uploadingXHR"),i.hasClass("canceled")||me.setIconState("error",i),me.hideServerPosting(i),"song"==me.opts.type);else if(!i.hasClass("canceled")){var o=Lang.UPLOADING_FAIL_CLICK_TO_TRY_AGAIN,n=$("<span />").addClass("upload-error-message").html(o);i.append(n)}$(".uploaded.items .item.success").length&&me.unLockButtons()},me.clickCancelAll=function(){return me.$items.closest(".uploader-box").find(".premium-note").hide(),$(".item",me.$items).each(function(e,t){$(t).addClass("canceled"),me.removeItem($(t))}),me.unLockButtons(),!1},me.removeItem=function(e){if(e&&e.length&&!e.lockCheck())if(e.lockOn(),e.data("uploadingXHR"))e.data("uploadingXHR").abort(),e.fadeOut(function(){me.detachItem(e)});else if(e.data("uploadedFile")){var t="",i="",o=e.data("uploadedFile");if(typeof o.delete_type===ud||typeof o.delete_url===ud)throw"Cannot remove file $item, no delete options provided from server";t=o.delete_type,i=o.delete_url,$.ajax({url:i,type:t,async:!0,dataType:"json"}).done(function(t,i,o){e.fadeOut(function(){me.detachItem(e)})}).fail(function(t){jsLogger.showInternalError("j29001",t),e.lockOff()})}else e.fadeOut(function(){me.detachItem(e)})},me.detachItem=function(e){e.detach(),me.checkUploadLimitations(),"function"!=typeof me.opts.lastFileRemoved||$(">.item:visible",me.$items).length||me.opts.lastFileRemoved()},me.showError=function(e,t){$(".edit_name input",e).detach(),$(".progressbar",e).detach(),$(".rotate_controls",e).detach(),$(".edit_name",e).addClass("error").html(t)},me.submitFile=function(e){var t=e.data("preparedData");if(typeof t.submit===ud)throw"Cant locate data.submit";e.hasClass("canceled")||e.data("uploadingXHR",t.submit())},me.submitMeta=function(e,t){$.ajax({url:me.opts.serverUrl,data:{names:JSON.stringify(e),_method:"SAVE"},type:"post",dataType:"json"}).done(function(e,i,o){typeof e.success!==ud&&e.success?typeof t!==ud&&t(e):jsLogger.showInternalError("j29002",o)}).fail(function(e,t){"abort"!=t&&jsLogger.showInternalError("j29003",e)})},me.saveItems=function(e){var t=[];if(typeof e!==ud&&e.length){var i=e.data("uploadedFile");me.showServerPosting([e]),t.push({id:i.id,title:$(".edit_name input",e).val()}),me.submitMeta(t,function(){e.fadeOut("fast",function(){me.detachItem(e),$(".item",me.$items).length<1&&me.opts.saveCallback&&me.opts.saveCallback()})})}else{var o=[],n=[];$(".item",me.$items).each(function(e,i){var a=$(i),r=a.data("uploadedFile");r&&typeof r.id!==ud?(o.push(a),t.push({id:r.id,title:$(".edit_name input",a).val()})):(n.push(a),a.data("hasAfteruploadEvent")||a.data("hasAfteruploadEvent",1).on("afterupload",function(){a.unbind("afterupload"),a.data("hasAfteruploadEvent",0),me.saveItems()}))}),t.length>0&&(me.showServerPosting(o),me.submitMeta(t,function(){$.each(o,function(e,t){var i=$(t);i.fadeOut("fast",function(){me.detachItem(i)})}),me.opts.saveCallback&&me.opts.saveCallback()}))}},me.showServerPosting=function(e){$.each(e,function(e,t){$(".preview",t).addClass("posting"),me.setIconState("posting",t)}),isIE()&&isIE()<=8&&$(window).trigger("resize")},me.prehideServerPosting=function(e){$.each(e,function(e,t){$(".preview",t).addClass("prehide").removeClass("posting")})},me.hideServerPosting=function(e){$.each(e,function(e,t){$(".preview",t).removeClass("prehide posting")})},me.playClick=function(e){var t=me.$items.closest(".uploader"),i=$("audio",t),o=e.data("url"),n=$(".player",e),a=e.parent(),r=!n.hasClass("pause"),s=function(){a.find(".player").each(function(){var e=$(this);e.hasClass("pause")&&e.parent().songShowPlay()})};s(),$("[data-clicked-play]",a).removeAttr("data-clicked-play"),o?(i.length||($('<audio class="hidden-audio-box"></audio>').attr("src",o).appendTo(t),i=$("audio",t),App.mediaPlayer(i,function(e){e.addEventListener("pause",s),e.addEventListener("stop",s)})),App.mediaPlayer(i,function(t){t.pause(),r&&(e.songShowPause(),t.pauseOthers(),t.setSrc(o),t.load(),t.play())})):(i.length&&App.mediaPlayer(i,function(e){e.pause()}),me.showServerPosting([e]),e.attr("data-clicked-play",1),me.submitFile(e))},me.checkUploadLimitationsInit=function(){me.opts.$inputFile.closest(".uploader")},me.checkUploadLimitations=function(){if(!1!==me.opts.limitUploadItems&&me.$items){var e=me.$items.closest(".uploader-box"),t=e.find(".premium-note"),i=e.find(".source-computer .button.more");return me.opts.limitUploadItems<=$(">.item",me.$items).length?(i.addClass("disabled"),meRouter.isCurrentRoute("gallery/photos")&&me.sidebarAddPhotoButtonHide(),!1):(t.hide(),meRouter.isCurrentRoute("gallery/photos")&&me.sidebarAddPhotoButtonShow(),i.removeClass("disabled"),!0)}return!0},me.sidebarAddPhotoButtonHide=function(){$("#aside_slideshow .add_new_photo .button").hide(),$("#aside_slideshow .add_new_photo .upgrade-line").show()},me.sidebarAddPhotoButtonShow=function(){$("#aside_slideshow .add_new_photo .button").show(),$("#aside_slideshow .add_new_photo .upgrade-line").hide()},me.lockButtons=function(){if(me.$items){var e=me.$items.closest(".uploader-box");$btnSave=e.find(".source-computer .button.more"),$btnMore=e.find(".source-computer .button.save"),$btnSave.length&&$btnSave.addClass("disabled"),$btnMore.length&&$btnMore.addClass("disabled"),clearTimeout(me.uploaderUnlockTimeoutId)}},me.unLockButtons=function(){me.uploaderUnlockTimeoutId=setTimeout(function(){if(me.$items){var e=me.$items.closest(".uploader-box");$btnSave=e.find(".source-computer .button.more"),$btnMore=e.find(".source-computer .button.save"),$btnSave.length&&$btnSave.removeClass("disabled"),$btnMore.length&&$btnMore.removeClass("disabled"),me.uploaderUnlockTimeoutId=!1,me.checkUploadLimitations()}},1e3)},function(e){e.fn.storyMediaUploader=function(t){var i=e(this),o=window.uploader_story.init(t);return i.data("uploaderObj",o),i.on("click",".chooser .providers > .provider",function(){var t;(t=meRouter.isCurrentRoute("lifestory")?me.pageLifeStories:me.pageStories).title=e("input[name='title']",t.$editForm).val(),t.text=e("[name='txt']",t.$editForm).val(),t.is_only_in_story=e("input[name='is_only_in_story']",t.$editForm).prop("checked");var o=e(this).data("source-name");return i.storyMediaUploaderOpenSource(o),!1}).on("click",".remove-media",function(){return i.storyMediaUploaderRemove(),!1}),me.facebookPhotoDownloader.init(),o},e.fn.storyMediaUploaderOpenSource=function(t,i){var o=e(this),n=o.data("uploaderObj"),a=e(".uploader form[data-remaining-files]").data("remaining-files");if("unlimited"!==a&&a<=0)meRouter.runAction("|premium-dialog-page");else switch(t){case"google-photo":me.googlePhotoDownloader.openGooglePhotoProvider({targetEntity:"story",loadOnlyOne:!0,onClose:async e=>{if(null!==e)try{globalLoader.showGlobalLoader(!0,!0);const t=e.getFirstPhotoId();if(null===t)return;const i=await e.body.downloadPhoto(t);await e.body.savePhotos([{id:i.id,title:"",target_entity:this.targetEntity}]);let o=i;if(o.mimg=i.simg,o.gallery_type="photo",_IS_MOBILE_){let e;(e=meRouter.isCurrentRoute("lifestory")?me.pageLifeStories:me.pageStories).media=o,e.openPreviousPopup()}n.setFile(o),n.showFile()}catch(e){jsLogger.showErrorResponse("j61006",e,null)}finally{globalLoader.hideGlobalLoader()}}});break;case"facebook":typeof me!==ud&&e(me).trigger("aside-slideshow-pause"),me.facebookPhotoDownloader.remainingFiles=e(".uploader form[data-remaining-files]").data("remaining-files"),me.facebookPhotoDownloader.open({serverUrl:n.opts.serverUrl,justOne:!0,targetEntity:"story"}).done(function(t){o.successUploadAction(function(){e(".uploader-box",n.opts.$uploader).fadeOut();var i,o=t;o.mimg=t.simg,o.gallery_type="photo",_IS_MOBILE_&&((i=meRouter.isCurrentRoute("lifestory")?me.pageLifeStories:me.pageStories).media=o,i.openPreviousPopup());n.setFile(o),n.showFile()})}).fail(function(t,i){o.deleteLoaderLayout(),typeof me!==ud&&e(me).trigger("aside-slideshow-resume")});break;case"youtube":e(".source-youtube .buttons .cancel:visible")&&e(".source-youtube .buttons .cancel:visible").click(),e(".chooser",o).hide(),e("textarea:visible",o).first().focus(),e(".source-youtube",o).show(),e(".source-youtube .buttons",o).show(),e(".source-youtube .buttons .cancel",o).show(),e(window).width()<=_MOBILE_?e(".modal-footer",es.$modal).hide():(e(".publish-button",o.parent().parent()).addClass("disabled"),e(">.buttons",o.parent().parent()).hide()),e(".source-youtube .buttons .cancel",o).click(function(){e(".chooser",o).show(),e(".source-youtube",o).hide(),e(".source-youtube .buttons",o).hide(),e(".source-youtube .buttons .cancel",o).hide(),e(".add-form>.form-group, .add-media-check, .modal-footer, .in-gallery-check",es.$modal).show(),e(".buttons .publish-button",o.parent().parent()).removeClass("disabled"),0==e(".modal-dialog").length&&e(">.buttons",o.parent().parent()).show()}),me.youtubeUploader("story",function(t){me.successUploadAction(function(){meRouter.scrollTo(o.offset().top,1e3),e(".uploader-box",o).hide(),n.setFile({id:t.id,url:t.url,title:t.name,gallery_type:"youtube"}),n.showFile(),e(".modal-footer",es.$modal).show()})});break;case"computer":typeof i===ud&&e("input[type=file]",o).removeAttr("multiple").click()}},e.fn.storyMediaUploaderRemove=function(){e(this).data("uploaderObj").removeMedia(),typeof slideShowActions!==un&&slideShowActions.flushMediaData(),typeof AppMemorial.facebookPhotoDownloader.clickCancelAll!==ud&&AppMemorial.facebookPhotoDownloader.clickCancelAll()},e.fn.storyMediaUploaderDestroy=function(){var t=e(this),i=t.data("uploaderObj");i&&typeof i.destroy!==ud&&i.destroy(e("input[type=file]",t)),t.off()},e.fn.successUploadAction=function(e){e()}}(jQuery),function(e){e.fn.galleryUploader=function(t){var i=e(this),o=e("form[data-remaining-files]",i).data("remaining-files");if("unlimited"!==o&&o<=0?e("form[data-remaining-files]",i).addClass("premium-contribute"):e("form[data-remaining-files]",i).removeClass("premium-contribute"),me.uploaderInit(t),i.on("click",".chooser .providers > .provider",function(){var t=e(this).data("source-name");return i.galleryUploaderOpen(t),!1}),i.on("click",".cancel-all",function(){i.galleryUploaderCloseSource(function(){me.clickCancelAll()})}),e(".provider.facebook").length&&("unlimited"==o||o>0)&&me.facebookPhotoDownloader.init(),e(".provider.google-photo").length&&("unlimited"==o||o>0)&&me.googlePhotoDownloader.init(),meRouter.getCurrentAnchorAction().indexOf("provider")>=0&&e(window).width()>=_MOBILE_){var n=meRouter.getCurrentAnchorAction().replace("|provider-","");return e(".chooser .providers > .provider."+n).click(),e("html, body").animate({scrollTop:e("#uploader_anchor").offset().top-100},1e3),!1}},e.fn.displayFileChooser=function(t,i){e(".chooser",i).hide(),_IS_MOBILE_||e(".cancel-all",i).show(),e('[data-source="'+t+'"]',i).show()},e.fn.galleryUploaderOpen=function(t,i){var o=e(".uploader form[data-remaining-files]").data("remaining-files");if("unlimited"!==o&&o<=0)meRouter.runAction("|premium-dialog-page");else{var n=e(this);if("facebook"==t)return e(me).trigger("aside-slideshow-pause"),me.facebookPhotoDownloader.remainingFiles=e(".uploader form[data-remaining-files]").data("remaining-files"),void me.facebookPhotoDownloader.open({justOne:!1,targetEntity:"gallery"}).done(function(){meRouter.scrollTo(e("#pg").offset().top,1e3),me.loadBlock("pageContent")}).fail(function(e,t){n.deleteLoaderLayout(),jQuery(me).trigger("aside-slideshow-resume")});var a=e('[data-source="'+t+'"]',n);"youtube"==t?(e(".chooser",n).hide(),e(".cancel.back",n).show(),_IS_MOBILE_||e(".cancel.cancel-all",n).show(),a.show(),n.youtubeUploader("gallery"),e("textarea",a).focus()):"computer"==t&&typeof i===ud&&9!=isIE()&&e("input[type=file]",n).click()}},e.fn.galleryUploaderDestroy=function(){e(this).off("click",".chooser .sources a[data-source-name]"),me.destroy()},e.fn.galleryUploaderCloseSource=function(t){var i=e(".uploader");return e("[data-source]",i).hide(),e(".cancel-all",i).hide(),e(".chooser",i).show(),"function"==typeof t&&t(),!1}}(jQuery),function(e,t){var i=function(t,i,o,n){var a=e.Deferred();if(a.reject(),i.lockCheck("rotation"))return a;i.lockOn("rotation");var r,s,l=!1,d=!1,c=!1,u=window.AppMemorial_config.baseUrl+"gallery-edit/rotateleft",h=window.AppMemorial_config.baseUrl+"gallery-edit/rotateright",p=function(){l&&d&&(i.one("load",function(){i.animateReset()}).attr("src",c),i.lockOff("rotation"))},f=function(){l=!0,p()};return"left"==o?(r=u,i.animateRotate(-90,1e3,null,f),s=function(){i.animateRotateRevert(500)}):"right"==o&&(r=h,i.animateRotate(90,1e3,null,f),s=function(){i.animateRotateRevert(500)}),e.ajax({url:r,data:{id:t,size:n,uploader:1},type:"post",async:!0,dataType:"json"}).done(function(e){if(App.ajaxSuccess(e)){var o=e["img-"+n];a.resolve(t,o),c=o,d=!0,p()}else err.app(1710622),s(),i.lockOff("rotation"),a.reject()}).fail(function(e,t){"abort"!=t&&err.network(1710188),s(),i.lockOff("rotation"),a.reject()}),a};t.rotateItemGallery=function(t,o){var n=t.data("uploadedFile");if(!n)return!1;i(n.id,e(".preview img",t),o,"upload").done(function(e,i){n.img=i,t.data("uploadedFile",n)})},t.rotateItemStoriesMedia=function(t,o,n){i(n.id,e("img",t),o,"list").done(function(e,t){n.url=t})}}(jQuery,window.uploader_gallery),function(e){var t=e(window);e.fn.visible=function(e,i,o){if(!(this.length<1)){var n=this.length>1?this.eq(0):this,a=n.get(0),r=t.width(),s=t.height(),l=(o=o||"both",!0!==i||a.offsetWidth*a.offsetHeight);if("function"==typeof a.getBoundingClientRect){var d=a.getBoundingClientRect(),c=d.top>=0&&d.top<s,u=d.bottom>0&&d.bottom<=s,h=d.left>=0&&d.left<r,p=d.right>0&&d.right<=r,f=e?c||u:c&&u,m=e?h||p:h&&p;if("both"===o)return l&&f&&m;if("vertical"===o)return l&&f;if("horizontal"===o)return l&&m}else{var g=t.scrollTop(),v=g+s,b=t.scrollLeft(),y=b+r,w=n.offset(),_=w.top,S=_+n.height(),C=w.left,k=C+n.width(),T=!0===e?S:_,$=!0===e?_:S,x=!0===e?k:C,E=!0===e?C:k;if("both"===o)return!!l&&v>=$&&T>=g&&y>=E&&x>=b;if("vertical"===o)return!!l&&v>=$&&T>=g;if("horizontal"===o)return!!l&&y>=E&&x>=b}}}}(jQuery),attributions={initCovidCountryOnChange:function(){const e=$("#attribution-country"),t=$(".passed-country"),i=function(){const e=$("#attribution"),t=$(".attribution-wrapper");$("option",e).each(function(e,i){$(i).data("enable-section")&&($($(i).data("enable-section")).addClass("hidden"),t.removeClass("double-fields"))});let i=$("option:selected",e);i.data("enable-section")&&($(i.data("enable-section")).removeClass("hidden"),t.addClass("double-fields"))},o=function(e,t){const i=e.data("change-field"),o=$(i).val(),n=e.val();o!==n&&($(i).val(n).addClass("filled").trigger("change"),"function"==typeof t&&t())};t.val()?o(t):e.val()&&o(e),e.change(function(){o($(this))}),$(".passed-country").change(function(){o($(this))}),$("#attribution").change(function(){i()}),i()}},googlePlaces={selectors:{bornCity:"#born-city",bornState:"#born-state, #born-state-select",bornCountry:"#born-country",passedCity:"#passed-city",passedState:"#passed-state, #passed-state-select",passedCountry:"#passed-country"},initAutocompleteForBornAddress:function(){const e=googlePlaces.selectors;$(".autocomplete-born").each(function(t,i){let o=$(this).data("autocomplete-types")||"(regions)",n=$(this).data("field-type"),a=new google.maps.places.Autocomplete(i,{types:[o]});google.maps.event.addListener(a,"place_changed",function(){let t=a.getPlace();for(let i=0;i<t.address_components.length;i++){let o=t.address_components[i];switch(o.types[0]){case"locality":("city"===n||!$(e.bornCity).val()&&"city"!==n)&&$(e.bornCity).val(o.long_name);break;case"administrative_area_level_1":$(e.bornState).val(o.long_name).addClass("filled");break;case"country":let t=o.long_name;const i=$(e.bornCountry);$(i).find('option[value="'+t+'"]').length?i.val(t).addClass("filled"):(t=$('[data-code="'+o.short_name+'"]').val())&&i.val(t).addClass("filled"),"country"!==n&&i.trigger("change")}}})})},initAutocompleteForDiedAddress:function(){const e=googlePlaces.selectors,t=$("#attribution-country");$(".autocomplete-passed").each(function(i,o){let n=$(this).data("autocomplete-types")||"(regions)",a=$(this).data("field-type"),r=new google.maps.places.Autocomplete(o,{types:[n]});google.maps.event.addListener(r,"place_changed",function(){let i=r.getPlace();for(let o=0;o<i.address_components.length;o++){let n=i.address_components[o];switch(n.types[0]){case"locality":("city"===a||!$(e.passedCity).val()&&"city"!==a)&&$(e.passedCity).val(n.long_name);break;case"administrative_area_level_1":$(e.passedState).val(n.long_name).addClass("filled");break;case"country":let i=n.long_name;const o=$(e.passedCountry);$(o).find('option[value="'+i+'"]').length?o.val(i).addClass("filled"):(i=$('[data-code="'+n.short_name+'"]').val())?o.val(i).addClass("filled"):i=null,t.length&&i&&t.val(i).addClass("filled"),"country"!==a&&o.trigger("change")}}})})}};const autoSave={classPainted:"painted-draft",getAutoSave:function(e,t,i,o,n,a){if(!auth.isSignedIn())return!1;void 0===a&&(a=!1),$.ajax({url:"/autosave?"+t,type:"POST",dataType:"json",data:{get_content:1,entity_id:i,lst_id:o,entity_type:n},error:function(t){autoSave.draftError(e)},success:function(t){if(t||autoSave.draftError(e),1==t.success){if(autoSave.draftSuccess(e),t.content){const i=t.content[e.attr("name")];i&&(e.val(i),e.siblings(".redactor-editor").addClass(autoSave.classPainted),e.parents("#new_tribute_form").length&&(e.addClass(autoSave.classPainted).height(e.get(0).scrollHeight),"type"===e.attr("name")&&$("[name='type'][value='"+i+"']",e).prop("checked",!0).closest("label").trigger("click")),a&&e.prev().html(e.val()),e.data("state-loaded",!0))}e.data("autosave-on",!0)}}})},draftError:function(e){e&&e.closest("form").length&&e.closest("form").find(".draft-marker").html(Lang.DRAFT_ERROR).addClass("save-error").removeClass("save-ok").css("opacity",1)},draftSuccess:function(e){e&&e.closest("form").length&&autoSave.checkEmptyDraft(e)&&e.closest("form").find(".draft-marker").html(Lang.DRAFT_SAVED).removeClass("save-error").addClass("save-ok").css("opacity",1)},checkEmptyDraft:function(e){const t=e.closest("form").find('[name="txt"]').val(),i=e.closest("form").find('[name="title"]').val();return void 0!==t&&$($.parseHTML(t)).text().trim().length>=1||void 0!==i&&$($.parseHTML(i)).text().trim().length>=1}};!function(e){const t={};e.fn.autoSaveDB=function(i,o){const n=t[i],a=e(this),r=a.closest("form").find(".draft-marker"),s=a.data("autosave-time");r.html(""),void 0===n&&(t[i]=setTimeout(function(){void 0===o&&(o=a.val());const n=a.attr("name"),r=new Date,l=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()+" "+(r.getHours()+":"+r.getMinutes()+":"+r.getSeconds());let d="name="+n+"&"+n+"="+encodeURIComponent(o)+"&entity_type="+encodeURIComponent(i).split("-")[0]+"&mtime="+l;a.data("entity-id")&&(d+="&entity_id="+a.data("entity-id")),window.AppMemorial_config.memorialId&&(d+="&lst_id="+window.AppMemorial_config.memorialId),e.post("/autosave",d,function(e){a.data("autosave-time",s),1==e.success?autoSave.draftSuccess(a):1!=e.success&&autoSave.draftError(a)},"json").fail(function(){autoSave.draftError(a)}).always(function(){a.data("sync-request",!1)}),delete t[i]},2e3))},e.fn.autosave=function(t){const i=e(this);if(!auth.isSignedIn())return i;if(!i.length)return i;if(void 0===t&&(t=i.data("autosave")),!t)throw"Empty autosave section name";if("destroy"==t)return i.off("keyup"),i;const o=i.data("entity-id");return autoSave.getAutoSave(i,t,o,window.AppMemorial_config.memorialId,encodeURIComponent(t).split("-")[0]),i.on("keyup",function(){i.autoSaveDB(t)}),i},e.fn.autosaveClear=function(i){const o=e(this);let n="";if(!o.length)return!1;if(void 0===i&&(i=o.data("autosave")),!i)throw"Empty autosave section name";o.autosave("destroy"),localStorage.setItem("wysiwyg-autosave","autosave-destroy");const a=o.attr("name");return o.data("autosave-destroy",!0),localStorage.removeItem(i+"-created"),localStorage.removeItem(i),o.data("entity-id")&&(n=o.data("entity-id")),e.post("/autosave?section="+encodeURIComponent(i),{clear:1,entity_id:n,name:a,lst_id:window.AppMemorial_config.memorialId,entity_type:encodeURIComponent(i).split("-")[0]},"json").done(function(){t[i]&&clearTimeout(t[i])})},e.fn.autosize=function(t){const i=e(this);return i.length?typeof t!==ud?(i.trigger(t),i):(autosize(this),i):i}}(jQuery),function(e,t,i){billing=function(){var e={oneClickButtonEnabled:!1},i={},o={initialized:!1,googlePayNativeLoaded:!1};e.stripe={},"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var i=arguments[t];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e});const n={apiVersion:2,apiVersionMinor:0},a={type:"PAYMENT_GATEWAY",parameters:{gateway:"stripe","stripe:version":"2019-05-16","stripe:publishableKey":window.AppMain_config.stripe.publishable}},r={type:"CARD",parameters:{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:["AMEX","DISCOVER","MASTERCARD","VISA"],billingAddressRequired:!1}},s=Object.assign({},r,{tokenizationSpecification:a});let l=null;function d(){const e=Object.assign({},n);return e.allowedPaymentMethods=[s],e.transactionInfo=h(),e.merchantInfo={},e.merchantInfo.merchantName=window.AppMain_config.google_pay.merchantName,window.AppMain_config.google_pay.merchantId&&(e.merchantInfo.merchantId=window.AppMain_config.google_pay.merchantId),e}function c(){return null===l&&(l=new google.payments.api.PaymentsClient({environment:window.AppMain_config.google_pay.environment})),l}function u(){const i=(l=c()).createButton({onClick:p,buttonColor:"white"});document.getElementById("payment-request-button").appendChild(i),t("#billing-form .billing-form").removeClass("one-click-off").addClass("one-click-on"),e.oneClickButtonEnabled=!0}function h(){return{currencyCode:planCurrency.toUpperCase(),totalPriceStatus:"FINAL",totalPriceLabel:planLabel,totalPrice:googlePlanPriceFormat.toString()}}function p(){const t=d();t.transactionInfo=h(),c().loadPaymentData(t).then(function(t){eventTracking.run("pay_button","user_actions","google_pay"),function(t){if(t.paymentMethodData.tokenizationData.token){var i=JSON.parse(t.paymentMethodData.tokenizationData.token);if(i){let t=window.AppMain_config.payment_methods.google_pay,o=null;i.card&&i.card.name&&(o=i.card.name),e.chargeByToken(i.id,o,t)}else jsLogger.showInternalError("j87005","Parse payment json error.")}else jsLogger.showInternalError("j87006",t)}(t)}).catch(function(e){jsLogger.setToBackErrorLog("j87004",e)})}return e.options={locale:window.AppMain_config.default_language,formId:"#billing-form",paymentButtonId:"#payment-request-button",cardNumberId:"#credit_card",cardNameId:"#name",cardExpiryId:"#expiration_date",cardCvcId:"#cvc",cardElements:{}},e.init=function(t){e.stripe=Stripe(window.AppMain_config.stripe.publishable),e.initStripeModule(),e.initActions()},e.initGooglePay=function(){if(t(e.options.paymentButtonId).length&&t(".filled-payment-form").hasClass("hidden")&&e.options.googlePayNativeLoaded){c().isReadyToPay(Object.assign({},n,{allowedPaymentMethods:[r]})).then(function(e){e.result&&(u(),function(){const e=d();e.transactionInfo={totalPriceStatus:"NOT_CURRENTLY_KNOWN",currencyCode:planCurrency.toUpperCase()},c().prefetchPaymentData(e)}())}).catch(function(e){console.error(e)})}},e.initStripeModule=function(){t(".filled-payment-form").hasClass("hidden")&&!e.options.initialized&&(console.log("Stripe initialized..."),e.initBillingForm(),window.AppMain_config.apple_pay.enabled&&e.initPaymentRequestButton(),window.AppMain_config.google_pay.enabled&&e.initGooglePay(),e.options.initialized=!0)},e.getStripeErrorList=function(){return{card_decline_rate_limit_exceeded:Lang.STRIPE_CARD_DECLINE_RATE_LIMIT_EXCEEDED,card_declined:Lang.STRIPE_CARD_DECLINED,coupon_expired:Lang.STRIPE_COUPON_EXPIRED,email_invalid:Lang.STRIPE_EMAIL_INVALID,expired_card:Lang.STRIPE_EXPIRED_CARD,incorrect_address:Lang.STRIPE_INCORRECT_ADDRESS,incorrect_cvc:Lang.STRIPE_INCORRECT_CVC,incorrect_number:Lang.STRIPE_INCORRECT_NUMBER,incorrect_zip:Lang.STRIPE_INCORRECT_ZIP,instant_payouts_unsupported:Lang.STRIPE_INSTANT_PAYOUTS_UNSUPPORTED,invalid_card_type:Lang.STRIPE_INVALID_CARD_TYPE,invalid_cvc:Lang.STRIPE_INVALID_CVC,invalid_expiry_month:Lang.STRIPE_INVALID_EXPIRY_MONTH,invalid_expiry_year:Lang.STRIPE_INVALID_EXPIRY_YEAR,invalid_number:Lang.STRIPE_INVALID_NUMBER,postal_code_invalid:Lang.STRIPE_POSTAL_CODE_INVALID,processing_error:Lang.STRIPE_PROCESSING_ERROR,incomplete_expiry:Lang.INCOMPLETE_EXPIRY,incomplete_cvc:Lang.INCOMPLETE_CVC,incomplete_number:Lang.INCOMPLETE_NUMBER,invalid_expiry_year_past:Lang.INVALID_EXPIRY_YEAR_PAST}},e.initBillingForm=function(){var i=e.options,o=e.getFormStyles(),n=e.getElementClasses(),a=e.stripe.elements({fonts:[{cssSrc:"https://fonts.googleapis.com/css?family=Open+Sans"}],locale:window.AppMain_config.stripe.locale});i.cardElements={},t("[data-module]").each(function(r,s){var l=t(s).data("module");i.cardElements[l]=a.create(l,{style:o,classes:n,placeholder:t(s).data("placeholder")}),i.cardElements[l].mount(i[l+"Id"]);let d=e.getStripeErrorList();i.cardElements[l].addEventListener("change",function(e,i){var o=t('[data-module="'+e.elementType+'"]').parent();if(t(".help-block",o).remove(),e.error){let i=e.error.message;void 0!==d[e.error.code]&&(i=d[e.error.code]);var n=t("<span>").addClass("help-block form-error").text(i);t(o).append(n)}"cardNumber"==l&&e.brand&&!t(".card-icon").hasClass(e.brand)&&t(".card-icon").removeAttr("class").addClass("card-icon "+e.brand)})}),t(i.formId).on("submit",function(i){globalLoader.showGlobalLoader(),i.preventDefault();var o=e.getAdditionalData();e.stripe.createToken(e.options.cardElements.cardNumber,o).then(function(i){e.removeMessagePanel(),i.error?(globalLoader.hideGlobalLoader(),t(".empty-payment-form .invalid").length||(i.errorMessage?e.showErrorPanelMessage(i.errorMessage):i.error.message&&e.showErrorPanelMessage(i.error.message))):e.stripeTokenHandler(i.token)})})},e.destroyBillingForm=function(){let i=t(e.options.formId);t("[data-module]").each(function(o,n){var a=t(n).data("module");e.options.cardElements[a].destroy(),t(".help-block",i).remove()}),e.options.cardElements={},i.off("submit"),t("#apple-btn, #google-btn").off("click"),t("#payer_name").removeAttr("style").removeClass("error"),e.options.initialized=!1,e.options.googlePayNativeLoaded=!1,console.log("Stripe destroyed...")},e.initPaymentRequestButton=function(){if($pg=t(e.options.formId),t(e.options.paymentButtonId).length){var i=e.stripe.paymentRequest({country:planCountry,currency:planCurrency,total:{label:planLabel,amount:stripePlanPriceFormat},requestPayerName:!0,requestPayerEmail:!0});i.canMakePayment().then(function(o){o&&o.applePay&&(t(".billing-form",$pg).removeClass("one-click-off").addClass("one-click-on"),e.oneClickButtonEnabled=!0,btn="#apple-btn",t(btn).removeClass("hidden").on("click",i.show))}),i.on("token",function(t){let i=window.AppMain_config.payment_methods.apple_pay,o=null;t.token.card&&t.token.card.name&&(o=t.token.card.name),e.chargeByToken(t.token.id,o,i,t)})}},e.chargeByToken=function(i,o,n,a){globalLoader.showGlobalLoader(),t.post(t(e.options.formId).attr("action"),{stripeToken:i,payer_name:o,payment_method:n},"json").done(function(t){e.removeMessagePanel(),t.success?(void 0!==a&&a.complete("success"),t.redirectLink?window.location.href=t.redirectLink:globalLoader.hideGlobalLoader()):(globalLoader.hideGlobalLoader(),t.errorMessage&&e.showErrorPanelMessage(t.errorMessage),void 0!==a&&a.complete("fail"))}).fail(function(e){jsLogger.showAjaxFail("j87001",e)})},e.initActions=function(){$pg=t(e.options.formId),t(".panel.panel-danger").length&&t(".empty-payment-form",$pg).hasClass("hidden")&&t(".buttons input.button",$pg).addClass("disabled").attr("disabled","disabled"),t(".action-wrapper.edit .action",$pg).on("click",function(){t(".buttons input.button",$pg).removeClass("disabled").removeAttr("disabled"),t(".panel.panel-danger").remove()}),t(".edit-card",$pg).click(function(){return t(".empty-payment-form, .filled-payment-form, .one-click-payments, .edit-card-cancel, .buttons .cancel:not(.edit-card-cancel)",$pg).toggleClass("hidden"),t(".billing-form",$pg).removeClass("card-filled"),e.initStripeModule(),e.oneClickButtonEnabled&&t(".billing-form",$pg).removeClass("one-click-off").addClass("one-click-on"),!1}),t(".edit-card-cancel",$pg).click(function(){return e.removeMessagePanel(),e.destroyBillingForm(),t(".empty-payment-form, .filled-payment-form, .one-click-payments, .edit-card-cancel, .buttons .cancel:not(.edit-card-cancel)",$pg).toggleClass("hidden"),t(".billing-form",$pg).removeClass("one-click-on").addClass("one-click-off card-filled"),!1}),t(".remove-card",$pg).click(function(){return popup.confirm(Lang.REMOVE_BILLING_FORM_CONFIRMATION,function(){globalLoader.showGlobalLoader(),t.post("/account/user_billing/remove-card",{},"json").done(function(e){globalLoader.hideGlobalLoader(),App.ajaxError(e,function(){jsLogger.showAjaxFail("j87002",e)})||(globalLoader.showGlobalLoader(),popup.success(Lang.PAYMENT_INFO_REMOVED,"",function(){window.location.reload()}))}).fail(function(){globalLoader.hideGlobalLoader()})}),!1})},e.getAdditionalData=function(){let e={};return t("[data-additional-billing-field]").each(function(i,o){e[t(o).data("additional-billing-field")]=t(o).val()}),e},e.getElementClasses=function(){return{focus:"focus",empty:"empty",invalid:"invalid"}},e.getFormStyles=function(){return{base:{color:"#1b4046",fontFamily:'"Open Sans", "OpenSansFM", Tahoma, Helvetica, sans-serif',fontWeight:"600",lineHeight:"30px",fontSize:"14px","::placeholder":{color:"#999",fontWeight:"600",fontSize:_IS_MOBILE_?"15px":"14px"}},invalid:{color:"#1b4046"}}},e.stripeTokenHandler=function(i){var o=t(e.options.formId);t("#stripeToken").remove();var n=document.createElement("input");n.setAttribute("id","stripeToken"),n.setAttribute("type","hidden"),n.setAttribute("name","stripeToken"),n.setAttribute("value",i.id),o.append(n),globalLoader.showGlobalLoader(),t.post(o.attr("action"),o.serializeArray(),"json").done(function(t){e.removeMessagePanel(),t.success?t.redirectLink?window.location.href=t.redirectLink:globalLoader.hideGlobalLoader():(globalLoader.hideGlobalLoader(),t.errorMessage&&e.showErrorPanelMessage(t.errorMessage))}).fail(function(e){globalLoader.hideGlobalLoader(),jsLogger.showAjaxFail("j87003",e)})},e.removeMessagePanel=function(){t(".panel:not(#js-template)",t(e.options.formId)).remove()},e.showErrorPanelMessage=function(i){$html=t("#js-template").clone().removeClass("hidden").removeAttr("id").addClass("panel-danger"),t(".panel-body",$html).text(i.trim()),t(e.options.formId).prepend($html)},i.googlePayLoaded=function(){window.AppMain_config.google_pay.enabled&&(e.options.googlePayNativeLoaded=!0,e.initGooglePay())},i.init=function(n){return t.extend(e.options,o,n),e.init(n),console.log("Billing system initialized..."),i},i},e.billing=billing}(this,jQuery),function(e,t,i){cancelActions=function(){var e={},i={},o={};return e.options={},e.sendCall=function(e,i){t.post("/cancel-actions/add",e).done(function(e){"function"==typeof i&&i(e.action_id)}).fail(function(e){jsLogger.showAjaxFail("j86001",e)})},i.addUserAction=function(t,i,o){e.sendCall({actionType:t,memorialId:i},o)},i.init=function(n){return console.log("User cancelActions initialized..."),t.extend(e.options,o,n),i},i},e.cancelActions=cancelActions}(this,jQuery);var cancelActions=new cancelActions;cancelActions.init(),function(e,t,i){contentPagination=function(){var e=!1,i={options:{refreshStickyBar:!1}},o={scrollAfterPagination:"html, body"};i.setAfterChangeTabAction=function(){return t("body").off("click.pagination_step").on("click.pagination_step",".pagination-step:not(.active)",function(){t(this).hasClass("switch-off")||globalLoader.showGlobalLoader(!1,!0),t(i.options.scrollAfterPagination).length&&(e=!0)})};var n={getNumberActivePage:function(){return parseInt(t("#pagination_block").attr("actpage"))},afterChangeTab:function(){e&&t("html, body").animate({scrollTop:t(i.options.scrollAfterPagination).offset().top-120},100,null,function(){e=!1})},init:function(e){console.log("contentPagination initialized..."),t.extend(i.options,o,e),i.setAfterChangeTabAction()}};return n},e.contentPagination=contentPagination()}(this,jQuery);const cookiePopup={popupClassName:"cookie-popup",cookieName:"cookie_policy_accepted",cookieExpires:365,open:function(e){popup.extended({message:Lang.COOKIE_POPUP_TEXT,className:cookiePopup.popupClassName,buttons:{understand:{label:Lang.COOKIE_POPUP_UNDERSTAND_BUTTON_LABEL,className:"button same-size-all",callback:function(){$.cookie(cookiePopup.cookieName,1,{expires:cookiePopup.cookieExpires,path:"/"})}}}})}};jQuery(document).ready(function(e){("undefined"!=typeof me?window.AppMemorial_config:window.AppMain_config).showCookiePopup&&!e("#page-privacy-policy").length&&cookiePopup.open()});const customValidations={errorMessage:"",noError:!0,errorClass:"error",dateBornPassValidate:function(e){try{return customValidations.customDate(e)}catch(e){return!1}},initOnchangeDatesValidation:function(e){$(".born-dates-wrapper [id ^= 'born-']",e).on("focusout",function(){customValidations.customDate(e)}),$(".passed-dates-wrapper [id ^= 'passed-']",e).on("focusout",function(){customValidations.customDate(e)})},customDate:function(e){let t;this.noError=!0;let i=null,o=$(".born-dates-wrapper [id ^= 'born-']",e);try{this.removeErrors(o),t=this.combineDate("#born",e)}catch(e){this.errorMessage=e.message,this.noError=!1,this.checkOnError(o)}o=$(".passed-dates-wrapper [id ^= 'passed-']",e);try{if(this.removeErrors(o),i=this.combineDate("#passed",e),null!==t&&null!==i&&t>i)throw new Error(Lang.BORN_DATE_LESS_THAN_PASSED)}catch(e){this.errorMessage=e.message,this.noError=!1,this.checkOnError(o)}return this.noError},combineDate(e,t){const i=$(`${e}-year`,t).val(),o=$(`${e}-month`,t).val(),n=$(`${e}-day`,t).val();if(/^0+$/.test(n))throw new Error(Lang.FORMVALIDATOR_REQUIRED_FIELDS);const a=parseInt(0+i);let r=parseInt(0+o),s=parseInt(0+n),l=null;if(s+r+a){if(0!==s&&0!==r&&0!==a);else{if(0!==s||0!==r||0===a)throw new Error(Lang.FORMVALIDATOR_REQUIRED_FIELDS);s=1,r=1}if(a<1e3)throw new Error(Lang.MINIMUM_YEAR_ERROR);const t=new Date;if(l=new Date(a,r-1,s),s>new Date(a,r,0).getDate())throw new Error(Lang.VALIDATION_ERROR_DAY_NOT_EXIST);if(l>t)throw new Error("#born"===e?Lang.BORN_DATE_LESS_THAN_NOW:Lang.PASSED_DATE_LESS_THAN_NOW)}return l},removeErrors(e){this.removeErrorClass(e),this.removeErrorMessages(e)},checkOnError:function(e){if(this.removeErrors(e),!this.noError)if(this.addErrorClass(e),this.showErrorMessage(e),$(".material-mobile").length){const e=$(".material-mobile"),t=$(".help-block.form-error").first();_IS_MOBILE_&&e.scrollTop(t.offset().top-e.offset().top+e.scrollTop()-120)}else $("html, body").animate({scrollTop:$(".help-block.form-error").first().parents(".form-group").offset().top-200},100)},showErrorMessage:function(e){const t=$(e[0]).attr("data-validation-error-msg-container"),i=$("<span />").addClass("help-block form-error").html(this.errorMessage);$(t).html(i)},removeErrorMessages:function(e){$.each(e,function(e,t){const i=$(t).attr("data-validation-error-msg-container");$(i).html("")})},addErrorClass:function(e){e.addClass(this.errorClass)},removeErrorClass:function(e){e.removeClass(this.errorClass).attr("style","")},checkMaxLength:function(e){const t=$(".show-age-wrapper");$("#born-month").val()&&$("#born-day").val()&&$("#born-year").val()&&$("#passed-month").val()&&$("#passed-day").val()&&$("#passed-year").val()?t.removeClass("hidden"):t.addClass("hidden"),e.value.length>e.maxLength&&(e.value=e.value.slice(0,e.maxLength))}};var eventTracking={defaultServices:["gtag","pixel","sendinblue"],gtag:function(e,t,i){"undefined"!=typeof gtag&&gtag("event",e,{event_category:t,event_label:i})},pixel:function(e,t,i){"undefined"!=typeof fbq&&fbq("trackCustom",e,{event_category:t,event_label:i})},sendinblue:function(e,t,i){"undefined"!=typeof sendinblue&&sendinblue.track(t,{event_name:e,event_label:i})},run:function(e,t,i,o){void 0===o&&(o=eventTracking.defaultServices),o.length&&$(o).each(function(o,n){"function"==typeof eventTracking[n]&&eventTracking[n](e,t,i)})}};jQuery(function(e){e(document).on("paste",".without-paste",function(e){e.preventDefault()})});var invite=me.invite={lockHandler:null,inviteWindow:null,message:"",emailRowN:2},config;invite.makeInvite=function(e){meRouter.setHashAction($(this)),auth.isSignedIn()?invite.byType(e):auth.open()},invite.byType=function(e){var t={"invite-email":"openInviteEmail","invite-facebook":"openInviteFacebook",default:"openSelector"};t.hasOwnProperty(e)||(e="default"),invite[t[e]]()},invite.openSelector=function(){if(!me.canInvite())return me.changeSettingsDialog(invite.openSelector),!1;var e=$("body");e.lockCheck("invite-lock")||(e.lockOn("invite-lock"),$.post(window.AppMemorial_config.baseUrl+"invite",function(e){if(globalLoader.hideGlobalLoader(),!App.ajaxError(e)){var t={className:"dialog-invite-selector bottom-slide-up",title:"",buttons:{},afterShow:function(){invite.setAllActions()}};t.message=e.page;var i=popup.extended(t).on("shown.bs.modal",t.afterShow);$("a, div.close",i).click(function(){return i.modal("hide"),meRouter.unSetCurrentHashAction(),!0})}},"json").fail(function(e){jsLogger.showAjaxFail("j1001",e)}).always(function(){e.lockOff("invite-lock")}))},invite.setAllActions=function(){$(".button-icon-wrapper .invite").click(function(){auth.isSignedIn()?invite.setAction($(this)):$(this).hasClass("facebook")||auth.open()})},invite.setAction=function(e){var t=e.data("invite-action");invite.hasOwnProperty(t)&&invite[t]()},invite.openInviteEmail=function(){if(!me.canInvite())return me.changeSettingsDialog(invite.openInviteEmail),!1;var e=$("body"),t="invite-email";e.lockCheck(t)||(e.lockOn(t),$.post(window.AppMemorial_config.baseUrl+"invite/invite-email",function(i){if(globalLoader.hideGlobalLoader(),!App.ajaxError(i))var o=invite.inviteWindow=popup.extended({className:"dialog-invite-email extra-wide-dialog full-height",title:Lang.ADD_YOUR_INVITES,iconClass:"fmi-add-your",message:i.page,buttons:{save:{label:Lang.SEND_INVITATIONS,className:"button send-button large-center-mobile",callback:function(){return $("#page-invite-email .invite-contacts").length?(me.contactsImport.syncTable(function(){invite.submitInvitees()}),e.lockOff(t),!1):(popup.error(Lang.PLEASE_ADD_CONTACTS_TO_SEND_INVITE),!1)}}}}).on("shown.bs.modal",function(){invite.initMessageBlock(o),localStorage.setItem("invDialogType","invite"),me.addFormValidate($(".invite-settings-form")),ci.initContactsImportBlock("invite",o,invite.openInviteEmail)}).on("hide.bs.modal",function(){e.lockOff(t)})},"json").fail(function(i){e.lockOff(t),jsLogger.showAjaxFail("j1002",i)}))},invite.initMessageBlock=function(e){$(window).width()<=_MOBILE_&&($("#invite_message",e).addClass("hidden"),$(".link",e).on("click",function(){$("#invite_message, .add-message i",e).toggleClass("hidden")})),invite.message.length&&($(window).width()<=_MOBILE_&&$(".link",e).trigger("click"),$("#invite_message",e).val(invite.message)),$("#invite_message",e).on("keyup",function(){invite.message=$(this).val()})},invite.openInviteFacebook=function(){if(!me.canInvite())return me.changeSettingsDialog(invite.openInviteFacebook),!1;if("undefined"!=typeof FB){var e=function(e){e&&void 0!==e&&e.success&&popup.success(Lang.INVITATIONS_SENT)};globalLoader.showGlobalLoader();var t=window.AppMemorial_config;$.post(t.baseUrl+"invite/get-invite-link",{invitation_target:t.target.fb.messenger},"json").done(function(i){if(i.success){var o="f"==t.gender?"her":"his",n={method:"send",name:Lang.SHARE_MEMORIES_OF_MEMORIAL.format(t.fullname,o),message:Lang.VISIT_MEMORIAL.format(t.fullname),description:Lang.MEMORIAL_CREATED_IN_MEMORY.format(t.fullname,o),link:t.baseUrl+"?"+i.code+"&utm_source=Facebook&utm_medium=FB+Invitations&utm_content=Memorial+Friend+Invites&utm_campaign=FB+Invitations&v="+parseInt((new Date).getSeconds()/60)};FB.ui(n,e)}}).fail(function(e){}).always(function(){globalLoader.hideGlobalLoader()})}else $(window).one("fb.init",invite.openInviteFacebook)},invite.submitInvitees=function(){var e=$("#invite_message"),t=$(".modal-body",invite.inviteWindow);invite.message="",t.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"invite/submit",{message:e.val()},"json").done(function(e){App.ajaxError(e)||(eventTracking.run("invite_by_email_send","invitations_and_sharing"),$("#page-visitors").length&&e.sentCount&&me.loadBlock("pageContent"),e.sentCount>1?(invite.inviteWindow.modal("hide"),popup.success(Lang.MULTIPLE_INVITATIONS_SEND.format(e.sentCount))):1==e.sentCount?(invite.inviteWindow.modal("hide"),popup.success(Lang.INVITATION_HAS_BEEN_SENT)):jsLogger.showErrorResponse("j1003",e,closeMainModal))}).fail(function(e){jsLogger.showAjaxFail("j1004",e)}).always(function(){t.deleteLoaderLayout()})},function(e,t,i){e.jsLogger=function(){var e={},i={},o={debugMode:!0,sendBackLogs:!0,enableGlobalWatcher:!0,showWatcherErrors:!0,sendWatcherBackLogs:!0};return e.options={userErrorLog:{},backErrorLog:{},watcherBackLogs:{}},e.sendToSentry=function(t,o,n,a=null){"undefined"!=typeof Sentry&&!1!==i.isSupportedBrowser()&&Sentry.withScope(i=>{i.setExtras({source:t,errorCode:o}),null!==a&&i.setExtra("type",a),"object"==typeof n&&"function"==typeof n.abort&&(n=e.getErrorFromAjaxResponse(n)),n instanceof Error?Sentry.captureException(n):"watcher"===t?(i.setTag("watcher"),i.setLevel("warning"),n.filename&&(i.setExtra("filename",n.filename),i.setExtra("linenumber",n.linenumber),Sentry.captureMessage(n.message))):"string"==typeof n?(i.setLevel("error"),Sentry.captureMessage(n)):"object"==typeof n&&n.fileType&&(i.setLevel("error"),Sentry.captureMessage("Filetype not allowed: "+n.fileType))})},e.addErrorToUserLog=function(t,i,o){"ajax"===t?e.options.userErrorLog[i]=o.responseText:"response"!==t&&"custom"!==t||(e.options.userErrorLog[i]=o)},e.addErrorToBackLog=function(t,i){e.sendToSentry("addErrorToBackLog",t,i),e.options.backErrorLog[t]=i,e.options.sendBackLogs&&e.sendToBack(t)},e.addErrorToWatcherBackLog=function(t,i){e.options.watcherBackLogs[t]=i,e.options.sendWatcherBackLogs&&(e.sendToSentry("watcher",t,i),e.sendToBack(t,"watcher"))},e.sendToBack=function(t,i){void 0==i&&(i="log");var o={};e.options.backErrorLog[t]&&"log"==i?o[t]=e.options.backErrorLog[t]:e.options.watcherBackLogs[t]&&"watcher"==i&&(o[t]=e.options.watcherBackLogs[t]),e.sendCall(o)},e.convertError=function(t){try{t=JSON.stringify(t)}catch(i){t="{}",e.options.debugMode&&console.warn("Cant convert object to json:",t)}return t},e.sendCall=function(i){"object"==typeof i&&(window.AppMemorial_config?url=window.AppMemorial_config.baseSiteUrl:url=window.AppMain_config.baseSiteUrl,i=e.convertError(i),t.post(url+"ajax/front-error",{errorInstance:i}).done(function(t){e.options.debugMode&&(console.warn("JsError log were sent",i),console.warn("JsError log response",t))}).fail(function(t){e.options.debugMode&&console.warn("Sending JsError log fail...",t)}))},e.showMessage=function(e,t){switch(e){case"error":popup.error(t);break;default:popup.error(Lang.ERROR_UNKNOWN)}},e.getErrorMsg=function(t,i,o){return i.replace(/{contact_us_for_support}/g,e.getSupportUrlHtml(t,o)).replace(/{error_code}/g,t)},e.getSupportUrlHtml=function(e,t){var i=Lang.CONTACT_US_FOR_SUPPORT;return t&&(i=t),'<a href="javascript:void(0)" data-action-url="|open-contact-us-dialog" data-request-type="report_a_problem" data-error-code="'+e+'">'+i+"</a>"},e.showUserLogInConsole=function(){console.warn("User Log",e.options.userErrorLog)},e.showBackLogInConsole=function(){console.warn("Back Log",e.options.backErrorLog)},e.globalWatcherInit=function(){window.onerror=function(t,i,o){return error={message:t,filename:i,linenumber:o},e.options.sendWatcherBackLogs&&(errorCode="j7001",e.addErrorToWatcherBackLog(errorCode,error)),e.options.showWatcherErrors&&alert(e.convertError(error)),!1}},e.getErrorFromAjaxResponse=(e=>`${e.responseText} [Status: ${e.status} - StatusText: ${e.statusText}]`),i.showInternalError=function(t,o,n){e.addErrorToBackLog(t,o);var a=e.getErrorMsg(t,Lang.ERROR_TYPE_C);e.showMessage("error",a),"function"==typeof n&&n(),e.options.debugMode&&i.showLogs()},i.showAjaxFail=function(t,o,n){e.addErrorToUserLog("ajax",t,o);var a=e.getErrorMsg(t,Lang.ERROR_TYPE_B);e.showMessage("error",a),"function"==typeof n&&n(),e.options.debugMode&&i.showLogs()},i.showErrorResponse=function(t,o,n){e.addErrorToUserLog("response",t,o);var a=e.getErrorMsg(t,Lang.ERROR_TYPE_B);e.showMessage("error",a),"function"==typeof n&&n(),e.options.debugMode&&i.showLogs()},i.showCustomBackError=function(t,o,n,a,r){e.addErrorToBackLog(t,o),n=e.getErrorMsg(t,n,a),e.showMessage("error",n),"function"==typeof r&&r(),e.options.debugMode&&i.showLogs()},i.logAndShowCustomError=function(t,o,n,a){if(e.addErrorToUserLog("custom",t,o),void 0!=n){var r=e.getErrorMsg(t,n);e.showMessage("error",r)}"function"==typeof a&&a(),e.options.debugMode&&i.showLogs()},i.getItemForLocalStorage=function(t,i){var o={};return e.options.userErrorLog[t]&&(o.errorId=t,o.errorTrace=e.options.userErrorLog[t],o.contactMessage=i),e.convertError(o)},i.setToUserErrorLog=function(t,i){e.addErrorToUserLog("custom",t,i)},i.setToBackErrorLog=function(t,i){e.addErrorToBackLog(t,i)},i.getUserLogTraceById=function(t){return errorTrace=e.options.userErrorLog[t],"object"==typeof errorTrace&&(errorTrace=JSON.stringify(errorTrace)),errorTrace},i.showLogs=function(){console.warn("jsLogger error logs:"),e.showUserLogInConsole(),e.showBackLogInConsole()},i.isSupportedBrowser=(()=>"undefined"==typeof bowser||bowser.getParser(window.navigator.userAgent).satisfies(e.options.supportedBrowsers)),i.init=function(n){return console.log("jsLogger initialized..."),t.extend(e.options,o,n),e.options.enableGlobalWatcher&&e.globalWatcherInit(),i},i}}(this,jQuery),config=window.AppMemorial_config?window.AppMemorial_config.jsLogger:window.AppMain_config.jsLogger;var options={debugMode:config.debugMode,sendBackLogs:config.sendBackLogs,enableGlobalWatcher:config.enableGlobalWatcher,showWatcherErrors:config.showWatcherErrors,sendWatcherBackLogs:config.sendWatcherBackLogs,supportedBrowsers:config.supportedBrowsers},jsLogger=new jsLogger;jsLogger.init(options),jQuery(document).ready(function(e){e.fn.addLoaderLayout=function(t){let i=e(this);if(i.data("loader_layout"))return;i.data("loader_layout",1);const o=function(){let t=i.css("position");i.data("was-position",t),"fixed"!=t&&"relative"!=t&&i.css({position:"relative"}),i.append('<div class="loader-overlay"></div><div class="loader-img"><div class="icon"></div></div>'),e(".loader-overlay",i).addClass("in"),e(".loader-img",i).addClass("in")};return"number"==typeof t&&t>0?i.data("loader_timer",setTimeout(o,t)):o(),i},e.fn.deleteLoaderLayout=function(){let t=e(this);t.data("loader_timer")&&(clearTimeout(t.data("loader_timer")),t.removeData("loader_timer")),e(".loader-overlay, .loader-img",t).detach();let i=t.data("was-position");return i&&(t.css({position:i}),t.removeData("was-position")),t.removeData("loader_layout"),t},e.fn.appendLoader=function(t,i){let o=e(this);if(o.data("loader_img"))return;o.data("loader_img",1);const n=function(){let i=e("<img />");i.attr("src","/assets/images/loadings/"+t+".gif");let n=e("<div></div>");n.addClass("loader-wrapper"),n.append(i),o.append(n)};return"number"==typeof i&&i>0?o.data("loader_timer",setTimeout(n,i)):n(),o},e.fn.detachLoader=function(){let t=e(this);return t.data("loader_timer")&&(clearTimeout(t.data("loader_timer")),t.removeData("loader_timer")),e(".loader-wrapper",t).detach(),t.removeData("loader_img"),t}});var bgplayer={do:function(e,t){return!bgplayer.hasOwnProperty(e)||bgplayer[e](t)}},mediaPlayer={isOnMusic:!1,playAllPages:!1,pausedByVideo:!1,page:$(document),currentItemObj:{},current:"",emptySeek:{currentTime:0,duration:0},playerStates:{true:"play",false:"stop"},delay:0,do:function(e){mediaPlayer.hasOwnProperty(e)&&mediaPlayer[e]()},init:function(){var e=$("#playlist-selector",mediaPlayer.page),t=$(".songs",e),i=[],o=[];$(".song-wrapper:not(.template)",t).each(function(e,t){i.push({id:$(t).data("oid"),order:e+1}),o.push($(t).data("url"))}),$('input[name="selected_audio"]').val(JSON.stringify(i)),mediaPlayer.updateSelected(o),mediaPlayer.setHandlers(),mediaPlayer.playAnotherPages()},pauseVideo:function(){mediaPlayer.pausedByVideo||(mediaPlayer.pausedByVideo=mediaPlayer.isPlaying(),mediaPlayer.moveForAllPlayers("pause"))},moveForAllPlayers:function(e){"object"==typeof mediaPlayer.getPlayer()&&mediaPlayer.getPlayer()[e](),"object"==typeof mediaPlayer.getSavePlayer()&&mediaPlayer.getSavePlayer()[e]()},playVideo:function(){mediaPlayer.pausedByVideo&&(mediaPlayer.pausedByVideo=!1,mediaPlayer.moveForAllPlayers("play"))},play:function(e){var t=!0;e=e||!1,bgplayer.do("pause"),mediaPlayer.permissionAnotherPlay()&&e?setInterval(function(){mediaPlayer.audioEvents.timeupdate()},500):e?(t=!1,mediaPlayer.getSavePlayer().play()):mediaPlayer.getPlayer().play(),mediaPlayer.isOnMusic=!0,mediaPlayer.toggleTimeLine(t)},getCurrent:function(){return $('.item[data-url="'+mediaPlayer.current+'"]')},updateTimeline:function(e,t){parseInt(t.duration)||(t=mediaPlayer.emptySeek);var i=(t.currentTime/t.duration*100).toFixed(2);return e.find(".line").css({width:i+"%"}),e.find(".seek").html(this.convertSecondToMinutes(t.currentTime)),e.find(".duration").html(this.convertSecondToMinutes(t.duration)),{seek:t.currentTime,duration:t.duration}},playAnotherPages:function(){mediaPlayer.isPlaying()&&mediaPlayer.playAllPages&&setTimeout(function(){mediaPlayer.play(!0),mediaPlayer.getSavePlayer().addEventListener("ended",mediaPlayer.audioEvents.ended),mediaPlayer.getSavePlayer().addEventListener("error",mediaPlayer.audioEvents.ended)},5)},convertSecondToMinutes:function(e){var t=Math.floor(e/60),i=Math.floor(e%60).toString();return 1==i.length&&(i="0"+i),t+":"+i},getAction:function(e){var t=!mediaPlayer.isCurrent(e);return this.playerStates[t]},isPlaying:function(){return mediaPlayer.isOnMusic},isCurrent:function(e){var t=!1;if(this.isPlaying()&&bgplayer.do("notPlaying")){var i=this.getCurrent().data("url");t=this.compareUrls(e,i)}return t},prepareLink:function(e){var t=document.createElement("a");t.href=e;var i=t.pathname;return i.length&&"string"==typeof i&&"/"!=i.charAt(0)&&(i="/"+i),i},permissionAnotherPlay:function(){return!("undefined"==typeof me||!meRouter.isCurrentRoute("songs"))},compareUrls:function(e,t){return this.prepareLink(e)==this.prepareLink(t)},toggleTimeLine:function(e,t){var i=$("[data-url] .timeline"),o=mediaPlayer.currentItemObj.find("audio")[0];if(i.hide(mediaPlayer.delay),mediaPlayer.updateTimeline(i,mediaPlayer.emptySeek),e){var n=mediaPlayer.getCurrent().find(".timeline");n.show(this.delay),t&&mediaPlayer.updateTimeline(n,o),n.on("click",function(e){var t=(void 0==e.offsetX?e.layerX:e.offsetX)/($(this).width()/100),i=Math.floor(mediaPlayer.getSavePlayer().duration*(t/100));mediaPlayer.seekTo(i),mediaPlayer.updateTimeline(mediaPlayer.getCurrent().find(".timeline"),o)})}else mediaPlayer.updateTimeline($("[data-url] .timeline"),o);this.changeSongBtnState(e)},changeSongBtnState:function(e){$("[data-url].playing").removeClass("playing"),$("[data-url] a.button").removeClass("pause").find("i").removeClass("fmi-stop-audio").addClass("fmi-play"),mediaPlayer.getCurrent().length&&(mediaPlayer.getCurrent().find("a.button").toggleClass("pause",!e).find("i").toggleClass("fmi-play",!e).toggleClass("fmi-stop-audio",e),e&&mediaPlayer.getCurrent().addClass("playing"))},stop:function(){mediaPlayer.isPlaying()&&($(".song-wrapper.playing audio").each(function(e,t){t.currentTime=0,t.pause()}),"object"==typeof mediaPlayer.getPlayer()&&(mediaPlayer.getPlayer().pause(),mediaPlayer.getPlayer().currentTime=0),"object"==typeof mediaPlayer.getSavePlayer()&&(mediaPlayer.getSavePlayer().pause(),mediaPlayer.getSavePlayer().currentTime=0),mediaPlayer.isOnMusic=!1,mediaPlayer.toggleTimeLine(!1),bgplayer.do("play"))},seekTo:function(e){e||(e=0),mediaPlayer.getSavePlayer().currentTime=e},getPlayer:function(){if(mediaPlayer.current.length)return mediaPlayer.getCurrent().find("audio")[0]},getSavePlayer:function(){if(mediaPlayer.currentItemObj.length)return mediaPlayer.currentItemObj.find("audio")[0]},setNext:function(){var e=mediaPlayer.getCurrent().next();0==e.length&&(e=$(".songs [data-url]").first()),mediaPlayer.current=e.attr("data-url")},showSongOption:function(e){e.removeClass("hidden").prop("disabled",!1).unwrap("<span></span>").show()},hideSongOption:function(e){e.addClass("hidden").prop("disabled",!0).wrap("<span></span>")},updateSelected:function(e){var t=$("#playlist-selector select",mediaPlayer.page);$("span option",t).unwrap().prop("disabled",!1).removeClass("hidden"),$.each(e,function(e,i){mediaPlayer.hideSongOption($('option[data-url="'+i+'"]',t))})},setHandlers:function(){var e=$("#playlist-selector",mediaPlayer.page);$.each(this.clickEvents,function(e,t){e=".item "+e,$(e).off("click").on("click",t)}),$.each(this.audioEvents,function(e,t){$("audio").off(e).on(e,t)}),$(".selector-wrapper select",e).bind("mousewheel",function(e){return!1}),$(".selector-wrapper select",e).change(function(e){var t=$(this),i=$("option:selected",t);return!(!i||!i.val()||i.val().length<1)&&(mediaPlayer.addSong(i.data("url")),i.toggle(),i.removeAttr("selected"),t.val("").blur(),mediaPlayer.init(),bgplayer.do("save"),!1)})},addSong:function(e){var t=$('#playlist-selector select option[data-url="'+e+'"]',mediaPlayer.page),i=$("#playlist-selector .songs > .template",mediaPlayer.page).clone();i.removeAttr("style").attr("data-url",e).attr("data-oid",t.val()).removeClass("template");var o=t.data("shared");o?$(".shared",i).html(o):i.addClass("noauthor"),i.find("a.name").html(t.text()),i.find("audio").attr("src",e),"object"==typeof playlistSort&&playlistSort.bindClicks($(i)),i.appendTo($("#playlist-selector .songs"))},audioEvents:{ended:function(){$("div[data-init]").data("init");mediaPlayer.stop(),bgplayer.do("play")},timeupdate:function(){var e=mediaPlayer.getCurrent().find(".timeline");if("object"==typeof mediaPlayer.getSavePlayer())var t=mediaPlayer.currentItemObj.find("audio")[0];else t=$(this).parent().find(".timeline");mediaPlayer.updateTimeline(e,t)},error:function(){mediaPlayer.getCurrent().hasOwnProperty("src")&&mediaPlayer.getCurrent().src&&jsLogger.logAndShowCustomError("j9001","mediaPlayer:audioEvents - error(no scr tag)",Lang.AUDIO_CANNOT_BE_LOADED)}},clickEvents:{".player":function(){mediaPlayer.permissionAnotherPlay()?mediaPlayer.playAllPages=!0:mediaPlayer.playAllPages=!1,"object"==typeof mediaPlayer.getPlayer()&&mediaPlayer.getPlayer().pause();var e=$(this).closest(".song-wrapper").data("url"),t=mediaPlayer.getAction(e);if("error"==$(this).attr("data-song-state"))me.showContactUs(this);else{if("processing"==$(this).attr("data-song-state"))return;mediaPlayer.isPlaying()&&("object"==typeof mediaPlayer.getPlayer()&&(mediaPlayer.getPlayer().pause(),mediaPlayer.getPlayer().currentTime=0),"object"==typeof mediaPlayer.getSavePlayer()&&(mediaPlayer.getSavePlayer().pause(),mediaPlayer.getSavePlayer().currentTime=0)),mediaPlayer.currentItemObj=$(this).parent(),mediaPlayer.current=$(this).parent().attr("data-url"),mediaPlayer[t]()}},".delete a":function(){if($(".page-create-memorial").length>0||$(".memorial-loved-ones").length>0){var e=$(this).closest(".song-wrapper"),t=e.data("url");mediaPlayer.isCurrent(t)&&mediaPlayer.stop(),bgplayer.do("delete",t),$('.selector-wrapper select option[value="'+e.data("oid")+'"]').toggle(),e.detach().remove(),mediaPlayer.init(),bgplayer.do("save")}}}};memorialUri={xhr:{},uriValidationMessage:function(e,t){let i=$("#memorial-uri");$(".url-error").remove(),i.addClass("error").removeClass("valid").css({borderColor:"rgb(185, 74, 72)"}),$(".web-address .input-wrapper",e).append($("<span />").addClass("help-block form-error url-error").html(t)),$(".web-address .address-suffix.memorial",e).addClass("hidden")},cleanUriError:function(e){$("#memorial-uri",e).removeClass("valid error validating").removeAttr("style"),$(".web-address .help-block",e).remove(),$(".web-address .address-suffix.memorial",e).removeClass("hidden")},checkMemorialUri:function(e,t,i){void 0===i&&(i=!1);var o=$("#memorial-uri");if(o.length&&o.val().length){"function"==typeof memorialUri.xhr.abort&&memorialUri.xhr.abort();let n="/creatememorial/info/check-uri";return"memorial"==t&&(n=window.AppMemorial_config.baseUrl+"about/check-uri"),o.addClass("validating"),o.attr("data-uri",o.val()),memorialUri.xhr=$.ajax({url:n,method:"POST",data:{uri:o.val(),trimTrailingDash:i},dataType:"json",success:function(t){memorialUri.cleanUriError(),t.valid?(o.addClass("valid"),t.uri&&o.attr("data-uri")!==t.uri&&o.val(t.uri)):memorialUri.uriValidationMessage(e,o.data("validation-error-msg"))}}),memorialUri.xhr}},uriCreate:function(e,t){const i=e;if(void 0===e){let t="",i="",o="",n="-";const a=$("#first_name.contain"),r=$("#middle_name.contain"),s=$("#last_name.contain");if(a.length&&(t=a.val().toLowerCase().replace(/[^A-Za-z0-9-]/g,"")),r.length&&(i=r.val().toLowerCase().replace(/[^A-Za-z0-9-]/g,"")),s.length&&(o=s.val().toLowerCase().replace(/[^A-Za-z0-9-]/g,"")),e=t.length?t:"",e+=i.length?n+i:"",!(e+=o.length?n+o:"").length)return}if(e=(e=(e=(e=e.replace(/[^A-Za-z0-9-]/g,"")).replace(/-+/gi,"-")).replace(/^-/,"")).toLowerCase(),void 0!==t&&t)return e;i!==e&&$("#memorial-uri").val(e)}};var playlistSort={delayTimer:0,$sortableInstance:{},init:function(){var e=$(document),t=$("#playlist-selector",e),i=$(".songs",t);this.destroy(i),this.initSort(i),this.bindClicks(i),this.bindSelect(t),mediaPlayer.updateSelected(window.AppMemorial_config.songs_playlist)},songExists:function(e){return e.length>0&&"undefined"!=e.data("url")&&e.is(":visible")},exchangeSongs:function(e,t){if(playlistSort.songExists(t)&&playlistSort.songExists(e)){me.sortable_animateMove(e,t,!0,function(){me.pageBackgroundMusic.save(playlistSort.playlistFetch())})}},initSort:function(e){if(me.sortable_reindex(e.find(".song-wrapper")),$(window).width()>=_MOBILE_){var t=new me.Sortable(e.get(0),{handle:"li.item",draggable:"li.item",sort:!0,scrollSpeed:10,ignore:"",filter:".ordering, .delete, .timeline, .shared, .button.player",scroll:!0,scrollSensitivity:30,animation:150,onSort:function(e){me.pageBackgroundMusic.save(playlistSort.playlistFetch())}});playlistSort.$sortableInstance=e.data("sortable",t),playlistSort.checkShuffle()}},checkShuffle:function(){var e=$("#shuffle_playback_songs");e.length&&playlistSort.setSortState(e.prop("checked"))},setSortState:function(e){playlistSort.$sortableInstance.length&&playlistSort.$sortableInstance.data("sortable").option("disabled",e)},bindSelect:function(e){$("select",e).on("change",function(){var e=$(this),t=$("option:selected",e),i=playlistSort.playlistFetch();return i.length&&playlistSort.notEmptyPlaylistAction(),!(!t.length||!t.val().length)&&(i.push({id:t.val(),order:i.length+1}),me.pageBackgroundMusic.save(i),e.val(""),!1)})},bindClicks:function(e){$(".ordering .up",e).off("click").on("click",function(){var e=$(this).closest("[data-url]");playlistSort.exchangeSongs(e,e.prev())}),$(".ordering .down",e).off("click").on("click",function(){var e=$(this).closest("[data-url]");playlistSort.exchangeSongs(e.next(),e)}),$(".song .delete",e).off("click").on("click",function(){var e=$(this).closest("[data-url]").attr("data-url");if($(".selector-wrapper select").length&&mediaPlayer!=un){var t=$(".selector-wrapper select");mediaPlayer.showSongOption($("option[data-url='"+e+"']",t))}$(this).closest("[data-url]").detach();var i=playlistSort.playlistFetch();return me.pageBackgroundMusic.save(i),playlistSort.emptyPlaylistAction(i),!1})},update:function(e){clearTimeout(this.delayTimer),this.delayTimer=setTimeout(function(){$.post(window.AppMemorial_config.baseUrl+"layout-blocks/fetch-playlist",{},function(t){if(App.ajaxSuccess(t)){var i=window.AppMemorial_config.songs_playlist,o=!i||i.length<1;window.AppMemorial_config.songs_playlist=t.playlist,o&&t.playlist.length>0?(bgplayer.setNextSong(),bgplayer.play()):t.playlist.length<1&&(bgplayer.pause(),bgplayer.updateIcon(!1)),popup.flash(Lang.PLAYLIST_UPDATED,"success",1100),playlistSort.rebuild(t.html,e)}},"json")},2500)},rebuild:function(e,t){this.destroy(),mediaPlayer.init(),this.init(),"function"==typeof t&&t()},destroy:function(){var e=$("#playlist-selector .songs");e.off("click",".ordering .up, .ordering .down, .song .delete");var t=e.data("sortable");t&&"function"==typeof t.destroy&&t.el&&t.destroy()},playlistFetch:function(){var e=[];return $("#playlist-selector .songs [data-url]:not(.template)").each(function(t,i){e.push({id:$(i).data("oid"),url:$(i).data("url"),order:t+1})}),e},emptyPlaylistAction:function(e){e.length||$(".empty-playlist-text").removeClass("hidden"),playlistSort.playlistFetch().length<=1&&$(".shuffle.checkbox").addClass("hidden")},notEmptyPlaylistAction:function(){$(".empty-playlist-text").addClass("hidden"),playlistSort.playlistFetch().length>1&&$(".shuffle.checkbox").removeClass("hidden")}};share.message="",share.facebook=function(e,t,i,o,n){if(typeof n===ud&&(n="object"),typeof FB!==ud){if(!me.canShare())return me.changeSettingsDialog(function(){return share.facebook(e,t,i,o,n)}),!1;if("invited"==window.AppMemorial_config.privacy&&!auth.isSignedIn())return auth.open({},function(){me.checkPrivacy()}),!1;if(typeof FB===ud)throw new Error("Facebook object not loaded.");o&&-1==o.indexOf("youtube")&&(o=window.AppMemorial_config.baseSiteUrl+o),shareObj=e,"object"==n&&(shareObj={"og:url":e});var a={app_id:window.AppMemorial_config.fbId,display:"popup",method:"share_open_graph",action_type:"og.shares",action_properties:JSON.stringify({object:shareObj})};FB.ui(a,function(e){meRouter.unSetCurrentHashAction(),$("html").lockOff("memorialFacebook")})}else $(window).one("fb.init",function(){share.facebook(e,t,i,o,n)})},share.addthisInit=function(e,t){if(typeof window.addthis===ud){var i,o,n,a,r,s=setInterval(function(){typeof window.addthis_sendto!==ud&&(clearInterval(s),addthis.init(),t())},100);if(typeof e.addthis_pubid===ud||typeof e.addthis_ga===ud||typeof e.addthis_username===ud)throw"Not enough params in addthis init.";window.addthis_config={data_track_clickback:!1,data_ga_property:e.addthis_ga,pubid:e.addthis_pubid},window.addthis_share={email_template:"fm",email_vars:{username:"{"+e.addthis_username+"}",entity:"content"}},i=document,o="script",n="addthis-js",r=i.getElementsByTagName(o)[0],i.getElementById(n)||((a=i.createElement(o)).id=n,a.src="//s7.addthis.com/js/300/addthis_widget.js",r.parentNode.insertBefore(a,r))}else t()},share.addthis=function(e,t,i){if(typeof e.addthis_email_from===ud||typeof e.addthis_email_note===ud||typeof e.addthis_title===ud||typeof e.addthis_url===ud)throw"Not enough params in share.addthis.";share.addthisInit(e,function(){var i;if("lifestory"==t||"stories"==t||"story"==t)i="story";else if("photo"!=t&&"song"!=t&&"video"!=t&&"content"!=t&&"tribute"!=t)throw"Unknown entity ["+t+"]";window.addthis_share.email_vars.entity=i,window.addthis_sendto("more",{ui_email_note:e.addthis_email_note,ui_email_from:e.addthis_email_from},{title:e.addthis_title,description:e.addthis_description,url:e.addthis_url})})},share.memorialFacebook=function(){const e=$("html");if(e.lockCheck("memorialFacebook"))return;e.lockOn("memorialFacebook");let t=window.AppMemorial_config;$.ajax({url:t.baseUrl+"share/memorial-info",data:{invitation_target:t.target.fb.timeline},dataType:"json",async:!1}).done(function(e){App.ajaxError(e)||share.facebook(t.baseUrl+"?"+e.code+"&utm_source=Facebook&utm_medium=FB+User+Sharing&utm_content=Memorial+Share&utm_campaign=FB+User+Sharing",null,null,null,"link")}).fail(function(e){jsLogger.showAjaxFail("j12001",e)}).always(function(){meRouter.unSetCurrentHashAction(),globalLoader.hideGlobalLoader()})},share.entityFacebook=function(e,t){$.ajax({url:window.AppMemorial_config.baseUrl+"share/facebook-info",data:{entity:e,id:t},dataType:"json",async:!1}).done(function(e){App.ajaxError(e)||share.facebook(e.facebook_url,e.facebook_title,e.facebook_description,e.facebook_image)}).fail(function(e){jsLogger.showAjaxFail("j12002",e)}).always(function(){globalLoader.hideGlobalLoader()})},share.entityEmail=function(e,t){if("invited"==window.AppMemorial_config.privacy){if(!auth.isSignedIn())return auth.open({},function(){me.checkPrivacy()}),!1}else if(!auth.isSignedIn())return auth.open(),!1;if(!me.canInvite())return me.changeSettingsDialog(function(){return share.entityEmail(e,t)}),!1;$.ajax({url:window.AppMemorial_config.baseUrl+"share/share-email",data:{entity:e,id:t},dataType:"json"}).done(function(i){if(!App.ajaxError(i))var o=function(){n.modal("hide"),share.isSlideshow&&(me.find("#page-gallery-photos").length>0&&me.find("#page-gallery-photos .items-list [data-oid="+t+"] .image img").click(),me.find("#page-gallery-videos").length>0&&me.find("#page-gallery-videos .items-list [data-oid="+t+"] .image img").click(),me.find("#page-stories").length>0&&(meRouter.unSetCurrentHashAction(),me.find(".story .story-media [data-oid="+t+"] img").click()),me.find("#page-lifestories").length>0&&(meRouter.unSetCurrentHashAction(),me.find(".lifestory .story-media [data-oid="+t+"] img").click()),share.isSlideshow=0)},n=popup.extended({className:"dialog-share-email extra-wide-dialog full-height",title:Lang.SHARE_BY_EMAIL_DIALOG_TITLE,iconClass:"fmi-mail-icon-2",message:i.page,buttons:{share:{label:Lang.SEND_INVITATIONS,className:"button send-button large-center-mobile",callback:function(){return n.length?(share.submitShareByEmail(e,t,n),!1):(popup.error(Lang.PLEASE_ADD_CONTACTS_TO_SEND_INVITE),!1)}}},onEscape:o,onClose:o}).on("shown.bs.modal",function(){me.checkGalleryImgErrors($(".preview .img-wrapper",n)),share.initMessageBlock(n),me.addFormValidate($(".invite-settings-form")),localStorage.setItem("invDialogType","share"),localStorage.setItem("shareEntity",e),localStorage.setItem("shareId",t),ci.initContactsImportBlock("share",n,share.entityEmail,[e,t])})}).fail(function(e){jsLogger.showAjaxFail("j12003",e)}).always(function(){globalLoader.hideGlobalLoader()})},share.initMessageBlock=function(e){$(window).width()<=_MOBILE_&&($("#share_message",e).addClass("hidden"),$(".link",e).on("click",function(){$("#share_message, .add-message i",e).toggleClass("hidden")})),share.message.length&&($(window).width()<=_MOBILE_&&$(".link",e).trigger("click"),$("#share_message",e).val(share.message)),$("#share_message",e).on("keyup",function(){share.message=$(this).val()})},share.submitShareByEmail=function(e,t,i){if($(".invite-contacts",i).length)return globalLoader.showGlobalLoader(),share.message="",$.post(window.AppMemorial_config.baseUrl+"share/share-email-send",{entity:e,id:t,message:$("#share_message").val()},"json").done(function(e){globalLoader.hideGlobalLoader(),eventTracking.run("content_share_by_email_send","invitations_and_sharing");var t=Lang.X_MESSAGES_WERE_SENT.format(e.emails_sent);1==e.emails_sent&&(t=Lang.ONE_MESSAGE_WAS_SENT),popup.flash(t,"success",2e3),i.modal("hide"),share.isSlideshow&&($("#page-gallery-photos [data-oid="+slideShowActions.currentSlide.data("oid")+"] img").click(),$("#page-gallery-videos [data-oid="+slideShowActions.currentSlide.data("oid")+"] img").click())}).fail(function(){popup.flash(Lang.ERROR_UNKNOWN,"error")}),!1;popup.error(Lang.PLEASE_ADD_CONTACTS_TO_SEND_INVITE)},auth.$modalHandler=null,auth.securedUrl="",auth.isValidating=!1,auth.notValidHint=!1,auth.isSignedIn=function(){return isDefined(me)&&me.vars.isSignedIn},auth.getSecuredUrl=function(){var e=window.location.host;return!/^www./.test(e)&&e.split(".").length>2&&(e=e.replace(/^([^\.]+)\./,"www.")),me.opts.useHttps?"https://"+e:"http://"+e},auth.requireLogin=function(e){auth.getState().id?e():auth.open(function(){$(me).one("checkState.loggedIn",e)},function(){me.getCheckState(function(t,i){i.id||$(document).off("checkState.loggedIn",e)},function(){$(document).off("checkState.loggedIn",e)})})},auth.addValidation=function(e){"undefined"!=typeof me&&me.addFormValidate(e)},auth.states={login:function(){$(".first-time-visit input").prop("checked",!1),$(".site-login .first-time-visit").hasClass("hidden")||$(".site-login input[name=email]").focus(),$(".site-login .reset-email").removeClass("hidden"),$("#signin-email").length&&$("#signin-email").focus(),auth.emailValidate()},register:function(){const e=$(".registrationForm");e.get(0).reset();let t=$("#reg-email"),i=$("#signin-email");!t.val()&&i.val()&&t.val(i.val()),auth.addValidation(e)},"forgot-email":function(){$("#forgotEmailForm")[0].reset()},"enter-new-email":function(){$("#forgotEmailChange")[0].reset()}},auth.emailValidate=function(e){var t=auth.$signInSection,i=t.find(".site-login .form-group.email"),o=$("input[name=email]",i),n=$(".account-not-found",i);o.removeClass("error").removeAttr("style"),o.next().removeClass("has-error").html("");var a=!t.length,r=!o.length,s=o.length&&!o.val().length;a||r||s||auth.isValidating||(auth.isValidating=!0,n.addClass("hidden"),t.addLoaderLayout(),$.ajax({url:auth.securedUrl+"/auth/check-email",data:{email:o.val()},dataType:"json",type:"POST",async:!1}).done(function(i){var o=i.valid;if(auth.notValidHint=!o,o)"function"==typeof e&&e();else{if($(".site-login .first-time-visit input",t).is(":checked"))return auth.switchStateTo("register"),!1;$(".help-block.account-not-found",t).removeClass("hidden")}}).always(function(){auth.isValidating=!1,t.deleteLoaderLayout()}))},auth.loginFailParser=function(e,t){var i=auth.$signInSection,o=$(".site-login .form-group.email",i),n=$(".site-login .password-group",i),a=$("input",n),r=$("input",o);if("ERR_PASS_REQUIRED"==e)n.removeClass("hidden"),$(".loginForm",i).addClass("password-state"),$(".loginForm .cancel-login").removeClass("hidden"),$(".site-login .first-time-visit",i).addClass("hidden"),$(".reset-email").addClass("hidden"),$("button",o).addClass("hidden"),r.attr("disabled","disabled"),$("#signin-password").focus();else if("ERR_EMAIL"==e||"ERR_SPAM"==e||"ERR_DELETED"==e){$(".registrationForm input").clone().find("input:not(#reg-email)").each(function(e,t){var i=$(t);$(".registrationForm #"+i.attr("id")).val(i.val())}),$(".site-register .form-group.email input",i).val(r.val()),i.find(".first-time-visit input").is(":checked")?($headerUsual.addClass("hidden"),i.find(".account-not-found").addClass("hidden"),auth.switchStateTo("register"),setTimeout(function(){i.find(".site-register input[name=first_name]").focus()},100)):i.find(".account-not-found").removeClass("hidden")}else"ERR_PASS"==e&&(a.val(""),$(".password-field",n).append('<span class="not-found help-block form-error">'+t+"</span>"))},auth.checkCredentials=function(){var e=auth.$signInSection,t=$(".loginForm",e);password="",$("input[name=password]",t).is(":visible")&&(password=$("input[name=password]",t).val());var i={email:$("input[name=email]",t).val(),pass:password};e.addLoaderLayout(),$.ajax({url:"/auth/check-credentials",type:"post",data:i,dataType:"json",success:function(t){if(typeof t.error!==ud&&t.error&&auth.loginFailParser(t.error,t.message),typeof t.fmid!==ud&&t.fmid){"undefined"!=typeof me&&"object"==typeof meRouter&&meRouter.isHashCheckAfterSignin(meRouter.getCurrentAnchorAction())&&meRouter.unSetCurrentHashAction();let e=new URL(window.location).searchParams.get("after_login_url");e?window.location=e:window.location.reload()}else e.deleteLoaderLayout()},error:function(t){e.deleteLoaderLayout()}})},auth.bindAuthEvents=function(e){void 0!==e&&null!==e||(e=$("#signin, #modal-auth-form")),auth.$signInSection=e,$(".first-time-visit input",e).click(function(){auth.notValidHint&&$(".help-block.account-not-found",e).removeClass("hidden")}),auth.addValidation($("form",e)),e.on("click",".reset-account-email",function(e){e.preventDefault(),auth.switchStateTo("forgot-email")}).on("click",".switch-to-register, .switch-to-register a",function(e){e.preventDefault(),auth.switchStateTo("register"),$(this).removeAttr("checked")}).on("click",".switch-to-login",function(e){e.preventDefault(),auth.switchStateTo("login")}).on("click",".site-login .loginForm .cancel-login",function(t){t.preventDefault(),$(".first-time-visit input").prop("checked",!1);var i=e.find(".site-login .form-group.email");e.find(".site-login .password-group").addClass("hidden"),$(".loginForm",e).removeClass("password-state"),$(".loginForm .cancel-login").addClass("hidden"),$(".reset-email").removeClass("hidden"),$(".site-login .first-time-visit",e).removeClass("hidden"),$("button",i).removeClass("hidden"),$("input",i).removeAttr("disabled").focus()}).on("keydown","#signin-email",function(){$(".account-not-found").addClass("hidden")}).on("click",".return-sign-in",function(e){e.preventDefault();var t=jQuery(this).closest(".form-group.email").find("input")[0].value;jQuery(".loginForm #signin-email").val(t),auth.switchStateTo("login")}).on("click",".forgot-password-link:not(.disabled)",function(e){e.preventDefault(),auth.sendResetPassLink()}),e.on("submit",".loginForm",function(e){e.preventDefault(),auth.emailValidate(auth.checkCredentials)}),e.on("submit",".registrationForm",function(t){t.preventDefault(),e.addLoaderLayout();var i=$(this),o={email:$("input[name=email]",i).val(),password:$("input[name=password]",i).val(),first_name:$("input[name=first_name]",i).val(),last_name:$("input[name=last_name]",i).val()};"undefined"!=typeof AppMemorial_config&&(o.memorial_id=AppMemorial_config.memorialId),$.ajax({url:"/registration/ajax",type:"post",data:o,dataType:"json",success:function(e){typeof e.fmid!==ud&&e.fmid?$("#page-signin.memorial").length&&$("body.memorial").length?auth.postRegisterMemorial():auth.postRegisterMain():popup.error(e.message)},error:function(e){jsLogger.showErrorResponse("j13004",e)},complete:function(){e.deleteLoaderLayout()}})}),e.on("submit","#forgotEmailForm",function(t){t.preventDefault();var i=$(this),o=$(".pass-wrapper",i);e.addLoaderLayout(),$(".not-found",o).remove(),$.ajax({url:i.attr("action"),type:"POST",data:i.serialize(),success:function(e){e.error?o.append('<span class="not-found help-block form-error">'+e.message+"</span>"):e.user_id&&($("#forgotEmailChange #uid").val(e.user_id),auth.switchStateTo("enter-new-email"))},complete:function(){e.deleteLoaderLayout()}})}),e.on("submit","#forgotEmailChange",function(t){t.preventDefault();var i=$(this),o=$("#email-confirm",i).val(),n=$("#uid",i).val(),a=$("#changeEmailToken",i).val();e.addLoaderLayout(),$.post(auth.securedUrl+"/forgot/email-change",{uid:n,change_email_token:a,email:o,memorial_id:typeof AppMemorial!==ud?AppMemorial.opts.memorialId:0},function(t){App.ajaxError(t,function(e){"ERR_EMAIL_USED"==e.error?$(".email-confirm-group",i).append('<span class="not-found help-block form-error">'+Lang.ERR_EMAIL_USED+"</span>"):jsLogger.showErrorResponse("j13005",e)})?e.deleteLoaderLayout():(popup.success(Lang.YOUR_NEW_EMAIL_SAVED),t.url?window.location.replace(auth.securedUrl+t.url):window.location.reload())},"json").fail(function(t){e.deleteLoaderLayout(),jsLogger.showAjaxFail("j13001",t)})}),auth.postRegisterMemorial=function(){"undefined"!=typeof me&&"object"==typeof meRouter&&meRouter.isHashCheckAfterSignin(meRouter.getCurrentAnchorAction())&&meRouter.unSetCurrentHashAction(),window.location.reload()},auth.postRegisterMain=function(){-1!=window.location.href.indexOf("after_login_url")?window.location.reload():(e.addLoaderLayout(),$.post(auth.securedUrl+"/creatememorial/login/next-step-url",{},"json").done(function(t){e.addLoaderLayout(),window.location=t.url}).fail(function(){e.deleteLoaderLayout()}))},auth.sendResetPassLink=function(){var t=$("#signin-email",e).val();$(".forgot-password-link",e).addClass("disabled"),$(".password-field .help-block.form-error",e).remove(),e.addLoaderLayout(),$.ajax({url:"/forgot/sendResetPassLink",type:"post",data:{email:t},dataType:"json",success:function(t){App.ajaxError(t,function(t){$(".password-field",e).append('<span class="not-found help-block form-error">'+t.message+"</span>")})||(window.location.href="/forgot/form-sent")},error:function(e){jsLogger.showErrorResponse("j13006",e)}}).always(function(){e.deleteLoaderLayout(),$(".forgot-password-link",e).removeClass("disabled")})};var t=$(".auth-dialog");return t.on("click",".oauth-btn",function(e){return e.preventDefault(),auth.showLoginPopup(t,$(this)),!1}),t},auth.destroyAuthEvents=function(e){return auth.$signInSection=void 0,null!=e&&e.off("click","#oauth-facebook").off("click","#oauth-google").off("click",".switch-to-register").off("click",".switch-to-login").off("submit","form"),e},auth.switchStateTo=function(e){$(".account-not-found, .right-panel-content > div").addClass("hidden"),$(".site-"+e).removeClass("hidden"),auth.states.hasOwnProperty(e)&&auth.states[e]()},me.Sortable=Sortable,me.sortable_reindex=function(e){e.each(function(e,t){$(t).attr("data-index",e+1),$(t).find("[data-slide-position]").attr("data-slide-position",e)})},me.sortGalleryReindex=function(){var e=isNaN(me.editAlbum.getStartIndex())?0:me.editAlbum.getStartIndex(),t=isNaN(me.editAlbum.getOrderingStart())?0:me.editAlbum.getOrderingStart();$.each($(".items.bootstrap item:visible"),function(i,o){e++,$(o).find(".order-item").val(t),$(o).attr("data-slide-position",e).find("[data-slide-position]").attr("data-slide-position",e),$(o).attr("data-slide-position",e),$(o).attr("data-ordering",t),$(o).find(".orderingField").val(e).text(e),t--})},me.forceDataOrdering=function(e,t,i){t=t.parents(".main-item");let o=Number(t.attr("data-ordering")),n=-1;if($.each(e,function(e,t){if(Number(t.ordering)===o)return n=e,!1}),-1!==n){let t;t=i?n+1:n-1;let o=Number(e[n].ordering),a=Number(e[t].ordering);e[n].ordering=a,e[t].ordering=o,e=me.sortableGalleryItems(e)}return e},me.sortable_callback=function(e,t,i,o){var n=$(t),a=n.parent();a.addLoaderLayout(),$.ajax({type:"post",dataType:"json",url:e,async:!1,data:{prev:n.prev().data("oid"),current:n.data("oid"),next:n.next().data("oid")}}).done(function(e){a.deleteLoaderLayout(),App.ajaxSuccess(e)?(!0,"function"==typeof i&&i(e)):(jsLogger.showInternalError("j14001",e),!1,"function"==typeof o&&o(e))}).fail(function(e){a.deleteLoaderLayout(),"function"==typeof o&&o(e),jsLogger.showAjaxFail("j14002",e)})},me.sortGalleryEditCallback=function(e,t,i,o){globalLoader.showGlobalLoader(!0,!0);var n=meRouter.isCurrentRoute("photos")?"photo":"video";$.ajax({url:window.AppMemorial_config.baseUrl+"gallery-edit/save-items",type:"POST",dataType:"json",data:{sortList:e,type:n,paginationTab:contentPagination.getNumberActivePage()},success:function(e){App.ajaxError(e)?jsLogger.showAjaxFail("j14003",e):(!0===t&&e.content.length&&me.editAlbum.replaceContent($(e.content),function(){globalLoader.hideGlobalLoader()}),e&&("function"==typeof o&&o(),"photos"===me.editAlbum.galleryType&&me.editAlbum.updateCoverPhoto(introSteps.removeExpired),globalLoader.hideGlobalLoader()))}})},me.sortable_onScroll=function(){},me.sortable_destroy=function(e){if(!e.data("can-change-order"))return!1;e.sortable("destroy"),$(window).off("scroll",me.sortable_onScroll)},me.sortable_animateMove=function(e,t,i,o,n,a){if(e.hasClass("ui-sortable-helper"))return!1;n=n||!1,a=a||!1,e.css("z-index",1e3).css("position","relative"),t.css("z-index",999).css("position","relative");var r=function(){e.css("z-index","").css("top","").css("position",""),t.css("z-index","").css("top","").css("position",""),i?n&&a?n.insertBefore(a):e.insertBefore(t):n&&a?n.insertAfter(a):e.insertAfter(t),"function"==typeof o&&(me.sortable_reindex(e.parent().children()),o())},s=s||parseInt(e.css("margin-bottom"));return i?(e.animate({top:0-t.outerHeight()-s},250,function(){me.editAlbum.onSorting(),globalLoader.hideGlobalLoader()}),t.animate({top:e.outerHeight()+s},700,function(){r()})):(e.animate({top:t.outerHeight()+s},250,function(){me.editAlbum.onSorting(),globalLoader.hideGlobalLoader()}),t.animate({top:0-e.outerHeight()-s},700,function(){r()})),!0},me.sortable_animateRevert=function(e,t,i){return me.sortable_reindex(e.parent().children()),!0},me.sortable_animateChangePosition=function(e,t,i,o){e.css("z-index",1e3).css("position","relative"),e.animate({top:t},i,function(){"function"==typeof o&&o(),e.css("z-index","").css("top","").css("position","")})},me.sortableAddNewOrderingToList=function(e){var t=[],i=!1,o=0;return $.each(e,function(e,n){if(null===n)return!0;var a=$('item[data-oid="'+n.id+'"]'),r=i?o+1:e;if(a.length){if(parseInt(a.find(".orderingField").val())!=parseInt(a.attr("data-slide-position")))return;i=!0,o<Number(a.attr("data-ordering"))&&(o=Number(a.attr("data-ordering"))),t.push({id:n.id,ordering:a.attr("data-ordering"),title:a.find(".details .item-title").val(),remove:!(!a.find(".details .set-remove").prop("checked")&&!parseInt(n.is_deleted))||""})}else t.push({ordering:r,id:n.id,title:n.title,remove:parseInt(n.is_deleted)?1:""}),o=r}),t},me.sortableGalleryItems=function(e){return e=e.sort(function(e,t){return parseInt(e.ordering)-parseInt(t.ordering)})},me.insertReOrderingElementToList=function(e){return $.each($(".items.bootstrap item"),function(t,i){var o=$(i);o.length&&parseInt(o.find(".orderingField").val())!=parseInt(o.attr("data-slide-position"))&&e.splice(Number(o.find(".orderingField").val())-1,0,{id:$(i).attr("data-oid"),ordering:Number(o.find(".orderingField").val())-1,title:o.find(".details .item-title").val(),remove:!!o.find(".details .set-remove").prop("checked")||"",is_modified:!0})}),e},me.ReOrderingGalleryItems=function(e){return e.reverse().filter(function(e,t){return e.ordering=t,e}),e};var subs=me.subscriptions={modalHandler:null};subs.open=function(e){if(typeof e===ud&&(e=""),e.length&&(e="?email="+encodeURIComponent(e)),!auth.isSignedIn())return auth.open(),!1;$.post(window.AppMemorial_config.baseUrl+"subscriptions/"+e,{},"json").done(function(e){if(!App.ajaxError(e)){subs.modalHandler=popup.extended({className:"dialog-subscriptions full-height",iconClass:"fmi-mail-icon-2",title:Lang.NOTIFICATION_PREFERENCES,message:e.page,onEscape:function(){meRouter.unSetCurrentHashAction(),subs.modalHandler.modal("hide"),me.isExpired()},onClose:function(){me.isExpired()},buttons:{save:{label:Lang.SUBSCRIPTION_DIALOG_SAVE_BUTTON,className:"button",callback:function(){return $("form",subs.modalHandler).submit(),popup.success(Lang.NOTIFICATION_WAS_SAVED_MESSAGE),me.isExpired(),!1}}}});var t=$("form",subs.modalHandler);t.submit(function(){var e=$(subs.modalHandler);if(!t.lockCheck())return t.lockOn(),e.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"subscriptions/save",t.serialize(),function(e){e.hasOwnProperty("error")?jsLogger.showErrorResponse("j15001",e):($(subs.modalHandler).modal("hide"),meRouter.unSetCurrentHashAction(),me.loadBlock("subscription"))},"JSON").fail(function(e){jsLogger.showAjaxFail("j15002",e)}).always(function(){t.lockOff(),e.deleteLoaderLayout()}),!1}),t.on("click","input[type=checkbox]",function(){var e=$(this),t=e.closest("div.checkbox");e.is(":checked")?t.addClass("checked"):t.removeClass("checked");var i=e.closest("form");"unsubscribe"==e.attr("name")?($("input[name=updates]",i).removeAttr("checked"),$("input[name=important]",i).removeAttr("checked"),$("input[name=news]",i).removeAttr("checked")):$("input[name=unsubscribe]",i).removeAttr("checked")})}}).fail(function(){}).always(function(){$("#global-spinner").stop(1).fadeOut("fast",function(){$(this).detach()})})},$(function(){});var sug=me.suggestion={modalHandler:null};sug.open=function(){$.post(window.AppMemorial_config.baseUrl+"suggestion/",{},"json").done(function(e){if(!App.ajaxError(e)){sug.modalHandler=popup.extended({className:"dialog-suggestion full-height",title:Lang.MAKE_SUGGESTION,message:e.page}).on("shown.bs.modal",function(){me.addFormValidate($("form",sug.modalHandler))});var t=$("form",sug.modalHandler);t.submit(function(){return $(this).validate(function(e,i){if(!e)return!1;var o=$(sug.modalHandler);t.lockCheck()||(t.lockOn(),o.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"suggestion/send",t.serialize(),function(e){App.ajaxError(e,function(e){jsLogger.showErrorResponse("j16001",e)})||(sug.modalHandler.modal("hide"),popup.success(Lang.ONE_MESSAGE_WAS_SENT))},"JSON").fail(function(e){jsLogger.showAjaxFail("j16002",e)}).always(function(){t.lockOff(),o.deleteLoaderLayout()}))}),!1})}}).fail(function(e){jsLogger.showAjaxFail("j16003",e)}).always(function(){globalLoader.hideGlobalLoader()})},function(e,t,i){swipeMenu=function(){var e={},i={},o={menuIdSelector:"#menu_swipe",overlayIdSelector:"#menu_swipe_overlay",swipeToggleSelector:".menu-swipe-toggle",visibleMenuClass:"menu_swipe_visible"};return e.options={scrollPosition:0},e.initMenu=function(){var o=t(e.options.menuIdSelector),n=t(e.options.swipeToggleSelector);n.on("click",function(){var i=!o.hasClass(e.options.visibleMenuClass);i&&e.lockScroll(),t("#menu_swipe, #menu_swipe_overlay").toggleClass(e.options.visibleMenuClass,i),t("body").toggleClass("modal-open",i),i||e.unlockScroll()}),t("a, .swipe-header",o).on("click",function(){i.hideSwipeMenu()}),o.on("selectstart",function(){return!1}),t("#menu_swipe, #menu_swipe_overlay").each(function(e,t){new Hammer(t,{dragLockToAxis:!0,dragBlockHorizontal:!0}).on("dragleft",function(e){}).on("swipeleft",function(e){i.hideSwipeMenu()}).on("release",function(e){e.target.style.left=0})}),t(".swipe-menu-list li:not(.submenu-wrapper)",o).on("click",function(){t(".swipe-menu-list li",o).removeClass("active"),t(this).addClass("active")}),t(".swipe-header",o).on("click",".user-guest",function(){n.click()}),t(window).on("resize",function(){t("."+e.options.visibleMenuClass).length&&(e.unlockScroll(),e.lockScroll())})},e.lockScroll=function(){t("html, #header .head").css("width",t(window).width()+"px"),t("html, body").css({overflow:"hidden"}),t("body").hasClass("safari")&&t("body").hasClass("iphone")&&(e.options.scrollPosition=t(window).scrollTop(),t("html, body").css("position","fixed"))},e.unlockScroll=function(){t("html, #header .head").removeAttr("style"),t("body").css({overflow:"visible"}),t("html, body").css("position","static"),t("body").hasClass("safari")&&t("body").hasClass("iphone")&&e.options.scrollPosition&&t("html, body").css("position","static").animate({scrollTop:e.options.scrollPosition},0)},i.hideSwipeMenu=function(){t("#menu_swipe, #menu_swipe_overlay").removeClass(e.options.visibleMenuClass),t("body").removeClass("modal-open"),e.unlockScroll()},i.init=function(n){return console.log("swipeMenu initialized..."),t.extend(e.options,o,n),e.initMenu(),i},i},e.swipeMenu=swipeMenu}(this,jQuery);var swipeMenu=new swipeMenu;$(function(){swipeMenu.init()}),function(e){e.fn.MemorialTagsManager=function(t,i){const o=this;let n={_tag_template:e("#tag-template").html().replace("{{DELETE}}",Lang.DELETE)};function a(){e("ul li.action a.download-qr",o).unbind("click").click(t=>{const i=e(t.currentTarget).attr("rel");window.location.href=e("#urlDownloadTag").val().replace("__tag_id__",i)})}function r(){e("ul li.action a.delete",o).unbind("click").click(function(){return e(this).parent().parent().parent().remove(),!1}),e("ul li.action a.unlink",o).unbind("click").click(function(){const t=e(this),o=e(this).attr("rel"),n=popup.extended({message:Lang.UNLINK_TAG,className:"dialog-unlink-tag popup-confirm",onEscape:function(){n.modal("hide")},buttons:{"Go back":{className:"button cancel",label:Lang.CANCEL},"Cancel Subscription":{className:"button ok",label:Lang.OK,callback:function(){return e.post(t.data("url"),{tag_id:o,memorial_id:i},function(e){e.success?(t.parent().parent().parent().remove(),popup.success(Lang.MEMORIAL_QR_CODES_CHANGES_SAVED)):popup.error(Lang.MEMORIAL_QR_CODES_CHANGES_SAVED_ERROR),n.modal("hide")},"json"),!1}}}})})}return n=e.extend(n,t),e(".add-link-container a",o).click(()=>{const t=e(n._tag_template),i=e("#save-changes");return e("ul.tags-container",o).append(t),r(),function(){const t=e("#reseller-edit-tag").data("tags-url");e("ul li.tag-id select",o).select2({placeholder:"Select a tag",ajax:{url:t,method:"post",dataType:"json",contentType:"application/json; charset=UTF-8",data(t){const i=[];return e("ul li.tag-id select").each((t,o)=>{const n=e(o).val();null!==n&&i.push(n)}),JSON.stringify({used:i,search:t.term,page:t.page||1})}},language:{noResults:()=>Lang.NO_MORE_QR_CODE}})}(),a(),i.length&&i.removeClass("hidden"),!1}),r(),a(),e("button#generateNewTag").click(async()=>{const t=e("#urlGenerateNewTag").val(),{id:i}=await e.ajax(t,{url:t,method:"get",dataType:"json"}),o=e("#list-item-template").first().html().replaceAll("{{ID}}",i);e("#memorial-tags-container ul.tags-container").append(o),r(),a()}),o}}(jQuery);var blockTemplates={isMemorial:function(){return"undefined"!=typeof me},switchTemplateLink:function(e,t){$("#memorial_stylesheet_link").attr("id","memorial_stylesheet_link_old");var i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,i.id="memorial_stylesheet_link",i.onload=function(){i.onload=null,$("#memorial_stylesheet_link_old").remove(),setTimeout(function(){globalLoader.hideGlobalLoader(),"function"==typeof t&&t()},500)},$("#memorial_stylesheet_link_old").before(i)},applyTemplate:function(e,t){if(e.length){let i=window.AppMemorial_config;globalLoader.showGlobalLoader(!1),$.post(i.baseUrl+"settings/get-theme-url",{themeName:e},function(e){e.success?blockTemplates.switchTemplateLink(e.url,t):jsLogger.showErrorResponse("j17003",e)},"json").fail(function(e){jsLogger.showAjaxFail("j17004",e)}).always(function(){globalLoader.hideGlobalLoader()})}},updateTemplate:function(e){let t=window.AppMemorial_config;e.length&&(globalLoader.showGlobalLoader(),$.post(t.baseUrl+"settings/edit-theme",{tpl:e},function(i){i.success&&(t.previous_tpl!==t.current_tpl&&(t.previous_tpl=t.current_tpl),t.current_tpl=e,t.with_snow_templates_list.hasOwnProperty(t.current_tpl)?me.addHeaderSnow():t.with_snow_templates_list.hasOwnProperty(t.current_tpl)||me.removeHeaderSnow(),popup.success(Lang.CHANGES_SAVED),meRouter.moveToAbout())},"json").fail(function(e){jsLogger.showAjaxFail("j17000",e)}).always(function(){globalLoader.hideGlobalLoader()}))},setHolidayTemplate:function(e){if(e.length){let t=window.AppMemorial_config;globalLoader.showGlobalLoader(),$.post(t.baseUrl+"settings/set-holiday-template",{tpl:e},function(i){i.success?(t.holiday_tpl=e,t.with_snow_templates_list.hasOwnProperty(e)&&!$("#snow-canvas").length&&me.addHeaderSnow(),popup.success(Lang.CHANGES_SAVED),meRouter.moveToAbout()):i.message&&popup.error(i.message)},"json").fail(function(e){jsLogger.showAjaxFail("j17001",e)}).always(function(){globalLoader.hideGlobalLoader()})}},removeHolidayTemplate:function(e){e.length&&(globalLoader.showGlobalLoader(),$.post(window.AppMemorial_config.baseUrl+"settings/remove-holiday-template",{tpl:e},function(e){if(e.success){let e=$("#snow-canvas");AppMemorial_config.holyday_tpl=null,e.length&&e.remove(),popup.success(Lang.CHANGES_SAVED),meRouter.moveToAbout()}else e.message&&popup.error(e.message)},"json").fail(function(e){jsLogger.showAjaxFail("j17002",e)}).always(function(){globalLoader.hideGlobalLoader()}))}};!function(e){e.fn.wysiwyg=function(t){e(this).each(function(){var i=e(this);if("string"==typeof t){if("air"==t)t={air:!0};else if("air-autosize"==t)t={air:!0,autoresize:!0};else if("destroy"==t||"sync"==t)return void(typeof i.data("redactor")!==ud&&("destroy"==t?i.redactor("core.destroy"):"sync"==t&&i.redactor("code.sync")))}else t=e.extend({},t);var o=i.data("autosave");o&&function(e,t,i){var o=e.data("entity-id");autoSave.getAutoSave(e,i,o,window.AppMemorial_config.memorialId,encodeURIComponent(i).split("-")[0],!0),t.syncCallback=function(){e.data("autosave-on")&&e.autoSaveDB(i)}}(i,t,o);var n=i.attr("placeholder");n&&i.val()==n&&i.val(""),e.extend(e.Redactor.prototype,{counter:function(){return{init:function(){this.opts.counterCallback&&this.$editor.on("keyup.redactor-limiter",e.proxy(function(t){var i=0,o=0,n=0,a=this.code.get().replace(/<\/(.*?)>/gi," ");if(a=(a=(a=(a=a.replace(/<(.*?)>/gi,"")).replace(/\t/gi,"")).replace(/\n/gi," ")).replace(/\r/gi," "),""!==(a=e.trim(a))){var r=a.split(/\s+/),s=a.match(/\s/g);r&&(i=r.length),s&&(n=s.length),o=a.length}this.core.setCallback("counter",{words:i,characters:o,spaces:n})},this))}}},fontcolor:function(){return{init:function(){for(var e=["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#f2f2f2","#7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada","#fff2ca","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f","#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000"],t=["fontcolor","backcolor"],i=0;i<2;i++){var o=t[i],n=this.button.add(o,this.lang.get(o)),a=this.button.addDropdown(n);a.width(242),this.fontcolor.buildPicker(a,o,e)}},buildPicker:function(t,i,o){for(var n="backcolor"==i?"background-color":"color",a=o.length,r=this,s=function(t){t.preventDefault(),r.fontcolor.set(e(this).data("rule"),e(this).attr("rel"))},l=0;l<a;l++){var d=o[l],c=e('<a rel="'+d+'" data-rule="'+n+'" href="#" style="float: left; font-size: 0; border: 2px solid #fff; padding: 0; margin: 0; width: 22px; height: 22px;"></a>');c.css("background-color",d),c.on("click",s),t.append(c)}var u=e('<a href="#" style="display: block; clear: both; padding: 5px; font-size: 12px; line-height: 1;"></a>').html(this.lang.get("none"));u.on("click",e.proxy(function(e){e.preventDefault(),this.fontcolor.remove(n)},this)),t.append(u)},set:function(e,t){this.inline.format("span","style",e+": "+t+";")},remove:function(e){this.inline.removeStyleRule(e)}}},limiter:function(){return{init:function(){this.opts.limiter&&this.$editor.on("keydown.redactor-limiter",e.proxy(function(e){var t=e.which,i=e.ctrlKey||e.metaKey;if(!(t==this.keyCode.BACKSPACE||t==this.keyCode.DELETE||t==this.keyCode.ESC||t==this.keyCode.SHIFT||i&&65==t||i&&82==t||i&&116==t))return!(this.$editor.text().length>=this.opts.limiter)&&void 0},this))}}},bufferbuttons:function(){return{init:function(){var e=this.button.addFirst("undo",Lang.REDACTOR_UNDO),t=this.button.addAfter("undo","redo",Lang.REDACTOR_REDO);this.button.addCallback(e,this.buffer.undo),this.button.addCallback(t,this.buffer.redo)}}},fontsize:function(){return{init:function(){var t=this,i={};e.each([12,14,16,18,24,36,48],function(e,o){i["s"+e]={title:o+"px",func:function(){t.fontsize.set(o)}}}),i.remove={title:"Remove Font Size",func:t.fontsize.reset};var o=this.button.add("fontsize",Lang.REDACTOR_CHANGE_FONT_SIZE);this.button.addDropdown(o,i)},set:function(e){this.inline.format("span","style","font-size: "+e+"px;")},reset:function(){this.inline.removeStyleRule("font-size")}}},fontfamily:function(){return{init:function(){var t=this,i={};e.each(["Arial","Helvetica","Georgia","Times New Roman","Monospace"],function(e,o){i["s"+e]={title:o,func:function(){t.fontfamily.set(o)}}}),i.remove={title:"Remove Font Family",func:t.fontfamily.reset};var o=this.button.add("fontfamily",Lang.REDACTOR_CHANGE_FONT_FAMILY);this.button.addDropdown(o,i)},set:function(e){this.inline.format("span","style","font-family:"+e+";")},reset:function(){this.inline.removeStyleRule("font-family")}}},clean_text:function(){return{init:function(){var e=this.button.add("clean_text",Lang.REDACTOR_CLEAN_FORMATTING);this.button.setAwesome("clean_text","fmi-cross"),this.button.addCallback(e,this.clean_text.removeFormat)},removeFormat:function(){this.buffer.set();var t=this.selection.getCurrent();this.selection.save(),document.execCommand("removeFormat"),t&&"SPAN"===t.tagName&&e(t).replaceWith(e(t).contents()),e.each(this.selection.getNodes(),e.proxy(function(t,i){var o=e(i);-1==e.inArray(i.tagName.toLowerCase(),this.opts.inlineTags)||o.hasClass("redactor-selection-marker")||o.replaceWith(o.contents())},this)),this.selection.restore(),this.code.sync()}}},link_blank:function(){return{init:function(){this.modal.addCallback("link",this.link_blank.setTargetBlank)},setTargetBlank:function(){this.$modalBody.find("#redactor-link-blank").attr("checked",!0).parent().hide()}}},print_text:function(){return{init:function(){var e=this.button.addAfter("clean_text","print",Lang.REDACTOR_PRINT);this.button.addCallback(e,this.print_text.printTextEditor)},printTextEditor:function(){this.$editor.printElement()}}}}),t.minHeight=320,t.formatting=["h4","h5","p","blockquote"],t.allowedTags=["span","div","p","img","blockquote","h4","h5","strong","b","i","em","u","br","hr","ul","li","ol","a","div","s","del","form","input","embed","iframe"],t.buttons=["formatting","bold","italic","underline","outdent","indent","unorderedlist","orderedlist","link","alignment","horizontalrule","html"],t.toolbarFixed=!1,t.pastePlainText=!1,t.dragImageUpload=!1,t.dragFileUpload=!1,t.removeWithoutAttr=!1,t.removeEmpty=!1,t.cleanSpaces=!1,t.replaceDivs=!1,t.linebreaks=!0,t.limiter=6e4,t.autosave||(t.autosave=!1),t.disabledLinks&&(t.convertLinks=!1,t.convertUrlLinks=!1,t.convertImageLinks=!1,t.convertVideoLinks=!1),t.plugins=["limiter","counter","bufferbuttons","fontfamily","fontsize","fontcolor","link_blank","clean_text"],e.Redactor.opts.langs.en={html:Lang.REDACTOR_HTML,video:Lang.REDACTOR_VIDEO,image:Lang.REDACTOR_IMAGE,table:Lang.REDACTOR_TABLE,link:Lang.REDACTOR_LINK,link_insert:Lang.REDACTOR_LINK_INSERT,link_edit:Lang.REDACTOR_LINK_EDIT,unlink:Lang.REDACTOR_UNLINK,formatting:Lang.REDACTOR_FORMATTING,paragraph:Lang.REDACTOR_PARAGRAPH,quote:Lang.REDACTOR_QUOTE,code:Lang.REDACTOR_CODE,header1:Lang.REDACTOR_HEADER_1,header2:Lang.REDACTOR_HEADER_2,header3:Lang.REDACTOR_HEADER_3,header4:Lang.REDACTOR_HEADER,header5:Lang.REDACTOR_SUBHEADER,bold:Lang.REDACTOR_BOLD,italic:Lang.REDACTOR_ITALIC,fontcolor:Lang.REDACTOR_FONTCOLOR,backcolor:Lang.REDACTOR_BACKCOLOR,unorderedlist:Lang.REDACTOR_UNORDEREDLIST,orderedlist:Lang.REDACTOR_ORDEREDLIST,outdent:Lang.REDACTOR_OUTDENT,indent:Lang.REDACTOR_INDENT,cancel:Lang.REDACTOR_CANCEL,insert:Lang.REDACTOR_INSERT,save:Lang.REDACTOR_SAVE,_delete:Lang.REDACTOR__DELETE,insert_table:Lang.REDACTOR_INSERT_TABLE,insert_row_above:Lang.REDACTOR_INSERT_ROW_ABOVE,insert_row_below:Lang.REDACTOR_INSERT_ROW_BELOW,insert_column_left:Lang.REDACTOR_INSERT_COLUMN_LEFT,insert_column_right:Lang.REDACTOR_INSERT_COLUMN_RIGHT,delete_column:Lang.REDACTOR_DELETE_COLUMN,delete_row:Lang.REDACTOR_DELETE_ROW,delete_table:Lang.REDACTOR_DELETE_TABLE,rows:Lang.REDACTOR_ROWS,columns:Lang.REDACTOR_COLUMNS,add_head:Lang.REDACTOR_ADD_HEAD,delete_head:Lang.REDACTOR_DELETE_HEAD,title:Lang.REDACTOR_TITLE,image_position:Lang.REDACTOR_IMAGE_POSITION,none:Lang.REDACTOR_NONE,left:Lang.REDACTOR_LEFT,right:Lang.REDACTOR_RIGHT,center:Lang.REDACTOR_CENTER,image_web_link:Lang.REDACTOR_IMAGE_WEB_LINK,text:Lang.REDACTOR_TEXT,mailto:Lang.REDACTOR_MAILTO,web:Lang.REDACTOR_WEB,video_html_code:Lang.REDACTOR_VIDEO_HTML_CODE,file:Lang.REDACTOR_FILE,upload:Lang.REDACTOR_UPLOAD,download:Lang.REDACTOR_DOWNLOAD,choose:Lang.REDACTOR_CHOOSE,or_choose:Lang.REDACTOR_OR_CHOOSE,drop_file_here:Lang.REDACTOR_DROP_FILE_HERE,align_left:Lang.REDACTOR_ALIGN_LEFT,align_center:Lang.REDACTOR_ALIGN_CENTER,align_right:Lang.REDACTOR_ALIGN_RIGHT,align_justify:Lang.REDACTOR_ALIGN_JUSTIFY,horizontalrule:Lang.REDACTOR_HORIZONTALRULE,deleted:Lang.REDACTOR_DELETED,anchor:Lang.REDACTOR_ANCHOR,link_new_tab:Lang.REDACTOR_LINK_NEW_TAB,underline:Lang.REDACTOR_UNDERLINE,alignment:Lang.REDACTOR_ALIGNMENT,filename:Lang.REDACTOR_FILENAME,edit:Lang.REDACTOR_EDIT,upload_label:Lang.REDACTOR_UPLOAD_LABEL},t.initCallback=function(){setTimeout(function(){localStorage.setItem("wysiwyg-autosave",new Date)},5e3),"undefined"!=typeof me?e(me).trigger("wysiwyg-init"):e("#page-admin-announcements textarea").trigger("wysiwyg-init")},i.redactor(t);var a=i.closest(".bootbox.modal"),r=i.parent().find(".redactor-toolbar");if(a.length){var s=parseInt(a.css("zIndex"))+1;r.css("zIndex",s),r.get(0)&&"function"==typeof r.get(0).style.setProperty&&r.get(0).style.setProperty("z-index",s,"important")}else r.addClass("redactor-overwrite-zindex100")})}}(jQuery),function(e,t,i){meRouter=function(){var e={},i={},o={arrayHashesDisableCheckPrivacy:["contact-memorial-owner","contact-memorial-user"],arrayHashesClearAfterSignin:["signin-force","signin"],currentAnchor:"",currentAnchorAction:"",currentRoute:"",listUrlsWithPagination:["about","tributes","gallery","lifestory","stories"],scrollToElement:null,isFirstPageLoad:!0,forceBackToAbout:!1,scrollPosition:0,pages:["/about/:pageNumber?","/tributes/:pageNumber?","/lifestory/:pageNumber?","/gallery/photos/:pageNumber?","/gallery/videos/:pageNumber?","/gallery/songs/:pageNumber?","/stories/:pageNumber?","/settings","/bg-music","/visitors","/upgrade","/lifetime","/resent-activity","/gallery-edit/photos/:pageNumber?","/gallery-edit/videos/:pageNumber?"]};return e.options={previousPath:null,aboutPageOffset:0,actions:{"|signin":function(){auth.isSignedIn()||null!==auth.getState().id?i.unSetCurrentHashAction():auth.open({},function(){me.checkPrivacy()})},"|invite-confirm-dialog":function(){me.showInviteConfirmationDialog()},"|signin-force":function(){auth.open({},function(){me.checkPrivacy(),i.unSetCurrentHashAction()})},"|edit-memorial-info":function(){let e=function(){me.pageAbout.about_editInfo("about/edit-info",Lang.ABOUT_EDIT_INFO,function(){t("form",$editForm).submit()})};i.isAboutPage()?e():me.loadAndGotToBlock(me.data("ajax-url","/about"),function(){e()})},"|show-edit-memorial-menu":function(){setTimeout(function(){me.pageAbout.showEditMemorialMobileMenu()},500)},"|edit-personal-phrase":function(){let e=function(){me.pageAbout.about_editInfo("about/edit-personal-phrase",Lang.EDIT_PERSONAL_PHRASE,function(){me.pageAbout.updateRequestPersonalPhrase()})};i.isAboutPage()?e():me.loadAndGotToBlock(me.data("ajax-url","/about"),function(){e()})},"|edit-about-info":function(){let e=function(){me.pageAbout.about_editPersonalText()};i.isAboutPage()?e():me.loadAndGotToBlock(me.data("ajax-url","/about"),function(){e()})},"|open-template-selector":function(){templateSelector.init()},"|open-template-selector-new-category":function(){templateSelector.init(function(){t('#select_category option[data-cat-id="new"]').prop("selected",!0).trigger("change")})},"|open-contact-us-dialog":function(e){void 0===e&&(e=this),me.showContactUs(e)},"|invite":function(e){invite.makeInvite(e)},"|open-action-menu":function(){meMobileActionMenu.showSubMenuDialog()},"|try-theme":function(){if(i.unSetCurrentHashAction(),!t(this).hasClass("disabled")){var e=t(this).data("theme-name");void 0!==e&&e.length&&(i.unSetCurrentHashAction(),me.announcements.enablePreviousBtn(),blockTemplates.applyTemplate(e,function(){blockTemplates.updateTemplate(e)}))}},"|return-previous-tpl":function(){var e=window.AppMemorial_config.previous_tpl;void 0!==e&&e.length&&(i.unSetCurrentHashAction(),me.announcements.enableHolidayBtn(),blockTemplates.applyTemplate(e,function(){blockTemplates.updateTemplate(e)}))},"|set-holiday-theme":function(){if(i.unSetCurrentHashAction(),!t(this).hasClass("disabled")){var e=t(this).data("theme-name");void 0!==e&&e.length&&(me.announcements.enablePreviousBtn(),blockTemplates.applyTemplate(e,function(){blockTemplates.setHolidayTemplate(e)}))}},"|return-normal-tpl":function(){var e=AppMemorial_config.current_tpl;void 0!==e&&e.length&&(window.AppMemorial_config.holiday_tpl="",i.unSetCurrentHashAction(),me.announcements.enableHolidayBtn(),blockTemplates.applyTemplate(e,function(){blockTemplates.removeHolidayTemplate(e)}))},"|read-more-highlight":function(){let e=i.getCurrentAnchorAction().split("|")[2];if(e.length&&t("[data-oid="+e+"]").length){let o=t("[data-oid="+e+"]");t(".readmore",o).click(),i.scrollTo(o.offset().top-80),me.highlightBlock(o)}},"|mobile-invite-selector":function(e){invite.makeInvite(e)},"|open_renew_dialog":function(){},"|premium-dialog":function(){me.upgradeDialogs.openPremiumDialog(this)},"|premium-dialog-page":function(){i.setIsForceBackToAboutPage(!1),page("/upgrade")},"|lifetime-page":function(){i.setIsForceBackToAboutPage(!1),page("/lifetime")},"|lifetime-dialog":function(){me.upgradeDialogs.openLifeTimeDialog()},"|share-memorial-fb":function(){share.memorialFacebook()},"|new-features-dialog":function(){me.newFeaturesDialog()},"|add_content_button":function(){me.pageAbout.showAddContentMenu()},"|subscribe":function(e){subs.open(e)},"|replace_photo":function(){return auth.isSignedIn()?me.isPermsChangedCoverPhoto()?!!i.isCurrentRoute("gallery/photos")&&void me.showInstructionReplaceCoverPhotoDialog():(i.unSetCurrentHashAction(),!1):(auth.open(),!1)},"|add_photos":function(){return auth.isSignedIn()?me.isPermsChangedCoverPhoto()?void(me.pageGalleryPhotos.checkPhotoInGallery()?me.showInstructionSetCoverPhotoDialog():t("#uploader-photo").length&&t([document.documentElement,document.body]).animate({scrollTop:t("#uploader-photo").offset().top-60},500)):(i.unSetCurrentHashAction(),!1):(auth.open(),!1)},"|about-this-website":function(){me.showAboutWebsite()},"|add_tribute":function(){_IS_MOBILE_?me.loadAndGotToBlock(t("<div/>").attr({"data-ajax-url":"/tributes"}),function(){i.runAction("|add_tribute_mobile_dialog")}):i.scrollTo(t("#new_tribute_form").offset().top)},"|scroll_to_add_story":function(){const e=t("#add_story_box");e.length&&i.scrollTo(e.offset().top)},"|add_tribute_mobile_dialog":function(){me.pageTributes.addTributeMobile()},"|upgradenotification":function(){me.upgradenotification()},"|upgradenotification_and_ts":function(){me.upgradenotification(function(){!1===window.AppMemorial_config.is_tpl_default&&templateSelector.init()})},"|add_lifestory_mobile_dialog":function(){me.pageLifeStories.addFormMobile()},"|add_story_mobile_dialog":function(){me.pageStories.addFormMobile()},"|show_cover_photos_mobile_dialog":function(){if(auth.isSignedIn()){if(!me.isPermsChangedCoverPhoto())return i.unSetCurrentHashAction(),!1;me.pageGalleryPhotos.checkPhotoInGallery()?me.showInstructionSetCoverPhotoDialog():me.pageGalleryPhotos.addFormMobile()}else auth.open()},"|add_photos_mobile_dialog":function(){auth.isSignedIn()?me.pageGalleryPhotos.addFormMobile():auth.open()},"|add_videos_mobile_dialog":function(){auth.isSignedIn()?me.pageGalleryVideos.addFormMobile():auth.open()},"|add_songs_mobile_dialog":function(){auth.isSignedIn()?me.pageGallerySongs.addFormMobile():auth.open()},"|contact-memorial-owner":function(){auth.isSignedIn()?me.contact.owner():auth.open()},"|add_photos_sidebar":function(){var e=t(this);if(console.log(t(this)),!auth.isSignedIn())return auth.open(),!1;e.prop("disabled",!0),globalLoader.showGlobalLoader(),me.loadAndGotToBlock(me.data("ajax-url","/gallery/photos"),function(){i.setScrollAnchor("gallery_upload_form"),e.prop("disabled",!1),globalLoader.hideGlobalLoader()})},"|contact-memorial-user":function(){auth.isSignedIn()?me.contact.open(null,null,!0):auth.open()}}},e.initCurrentAnchor=function(o,n){e.isScrollAnchor(o.canonicalPath)&&(o.canonicalPath=o.canonicalPath.split("#")[0]),i.isAboutPage()&&i.setAboutPageOffset(t(window).scrollTop()),i.setPreviousRoute(),i.setCurrentRoute(o.path),n()},e.initPagesRoute=function(){page.base("/"+window.AppMemorial_config.memorialUrl),page("/",function(){page.redirect("/about")}),t(e.options.pages).each(function(t,i){page(i,e.initCurrentAnchor,function(){me.getAjaxContent()})}),page("*",function(e,t){console.error("page Not found: "+e.path)}),page()},e.initHistoryActions=function(){t(window).on("hashchange",function(){i.checkModals(),window.location.hash&&i.runCurrentHashAnchor()})},e.pushState=function(e){e&&(e="#"+e);var t="/"+window.AppMemorial_config.memorialUrl+i.getCurrentRoute()+e;window.history.pushState({path:t},null,t)},e.getActionName=function(e){let t="";if(e=e.replace(/%7C/gi,"|")){let i=e.split("|");i[1]&&(t="|"+i[1])}return t},i.isFirstPageLoad=function(){return o.isFirstPageLoad},i.checkForceBackToAboutPage=function(){i.getIsForceBackToAboutPage()&&(i.setIsForceBackToAboutPage(!1),me.loadAndGotToBlock(me.data("ajax-url","/about"),function(){i.returnToSavedScrollPosition()}))},i.returnToSavedScrollPosition=function(){i.getScrollPosition()&&(t("html, body").animate({scrollTop:i.getScrollPosition()},0),i.setScrollPosition(0))},i.setScrollPosition=function(t){e.options.scrollPosition=t},i.setIsForceBackToAboutPage=function(t){e.options.forceBackToAbout=t},i.getScrollPosition=function(){return e.options.scrollPosition},i.getIsForceBackToAboutPage=function(){return e.options.forceBackToAbout},i.setAboutPageOffset=function(t){e.options.aboutPageOffset=t},i.pushCurrentAnchor=function(){e.pushState(i.getCurrentAnchor()+i.getCurrentAnchorAction())},i.getCurrentAnchor=function(){return e.options.currentAnchor},i.setCurrentAnchor=function(t){e.options.currentAnchor=t},i.getCurrentAnchorAction=function(){return e.options.currentAnchorAction},i.setCurrentAnchorAction=function(t){e.options.currentAnchorAction=t},i.getCurrentRoute=function(){return e.options.currentRoute},i.isCurrentRoute=function(e){return i.getCurrentRoute().indexOf(e)>-1},i.setPreviousRoute=function(){e.options.previousPath=e.options.currentRoute},i.getPreviousRoute=function(){return e.options.previousPath},i.isNewRoute=function(){return i.getPreviousRoute()&&i.getPreviousRoute()!==i.getCurrentRoute()},i.setCurrentRoute=function(t){e.options.currentRoute=t},i.isNewHashAction=function(e){return i.getCurrentAnchorAction()!==e},i.setHashAction=function(e){var t=e;"object"==typeof e&&(t=e.attr("data-action-url")||e.find("[data-action-url]").first().attr("data-action-url")),typeof t!=ud&&i.isNewHashAction(t)&&(i.setCurrentAnchorAction(t),i.pushCurrentAnchor())},i.unSetCurrentHashAction=function(e){return void 0===e&&(e=!0),i.getCurrentAnchorAction()&&(i.setCurrentAnchorAction(""),e&&i.pushCurrentAnchor()),!1},i.unSetCurrentHash=function(){window.location.hash&&(window.location.hash="",i.setCurrentAnchor(""),i.setCurrentAnchorAction(""))},i.runCurrentHashAnchor=function(t){e.options.currentAnchor="",e.options.currentAnchorAction="",window.location.hash&&(e.options.currentAnchor=window.location.hash.replace(/%7C/gi,"|").replace("#","").split("|")[0],e.options.currentAnchorAction=window.location.hash.replace(window.location.hash.replace(/%7C/gi,"|").split("|")[0],"").replace(/%7C/gi,"|")),i.getCurrentAnchorAction()||popup.closePopupIfExist(),i.goToHashAction()},i.setScrollAnchor=function(e){o.scrollToElement=e},i.getScrollAnchor=function(){return o.scrollToElement},e.isScrollAnchor=function(o){const n=o.replace(o.replace(/%7C/gi,"|").split("|")[0],"").replace(/%7C/gi,"|"),a=e.getActionName(n);if(n){const e=t("[data-oid='"+n.replace(/\|/gi,"")+"']").length,o=t("[data-action-url='"+n+"']").first().length;if((!i.isActionExist(a)||e)&&!o){const e=n.replace(/\|/gi,"");return i.setScrollAnchor(e),!0}}return!1},i.checkModals=function(e){void 0===e&&(e=!1),e&&e&&popup.closePopupIfExist(),t(".bootbox.modal").length||t("html, body").removeClass("modal-open"),t(".menu-wrapper").is(":visible")||t("html, body").removeClass("sub-menu-dialog-open"),t(".mobile-dialog-menu-wrapper").is(":visible")||t("#add-content-menu").is(":visible")||t("html, body").removeClass("add-content-menu-open")},i.isActionExist=function(t){return e.options.actions[t]&&"function"==typeof e.options.actions[t]},i.setBodyClass=function(){let e="memorial-page"+i.getCurrentRoute().split("?")[0].replace(/[0-9]/g,"").replace(new RegExp("/","g"),"-");e=e.replace(/-+$/,"");let o=t("#mobile-inner-pages-header"),n=t("#photo-memorial-inner");t("body").attr("data-page",e),t(".title-section .text",o).addClass("hidden");let a=t('#mobile-inner-pages-header .title-section .text[data-page="'+e+'"]');a.removeClass("hidden");let r=t("#photo-memorial-inner img").length;a.data("without-photo")?(o.removeClass("with-photo").addClass("without-photo"),t(".header-wrapper",o).removeClass("with-photo").addClass("without-photo"),n.addClass("hidden")):r&&(o.removeClass("without-photo").addClass("with-photo"),t(".header-wrapper",o).removeClass("without-photo").addClass("with-photo"),n.removeClass("hidden")),a.data("with-bg-image")?(o.addClass("with-bg-image"),t(".header-wrapper",o).addClass("with-bg-image")):(o.removeClass("with-bg-image"),t(".header-wrapper",o).removeClass("with-bg-image"))},i.moveToAbout=function(e){e=e||!1,i.isAboutPage()&&!e||page("/about")},i.isAboutPage=function(){let e=i.getCurrentRoute();if(e.indexOf("?")){let t=e.split("?");void 0!==t[0]&&(e=t[0])}return"/about"===e},i.scrollTo=function(e,i,o){o=o||!1,void 0===i&&(i=300),t("html, body").animate({scrollTop:e},i,null,o)},i.goToHashAction=function(){if(i.getScrollAnchor()){let e="",o=i.getScrollAnchor();if(t("#"+o).length?e="#"+o:t("."+o).length?e="."+o:t("[data-oid='"+o+"']").length&&(e=t("[data-oid='"+o+"']")),e){let o=t(e).first().offset().top-100;i.scrollTo(o),me.highlightBlock(t(e))}i.setScrollAnchor(null)}else if(i.getCurrentAnchorAction()){const e="public"===window.AppMemorial_config.privacy,o=window.AppMemorial_config.invitee_session;if((e||o||auth.isSignedIn())&&i.getCurrentAnchorAction().length)if(i.runAction(i.getCurrentAnchorAction()));else if(t("[data-action-url='"+i.getCurrentAnchorAction()+"']").first().length){let e=t("[data-action-url='"+i.getCurrentAnchorAction()+"']").first(),o=e.offset().top-100;i.scrollTo(o),e.trigger("click")}}else if(_IS_MOBILE_&&!i.isFirstPageLoad()&&!i.getScrollPosition()){let t=0,o=0;i.isAboutPage()&&(t=e.options.aboutPageOffset,o=0),i.scrollTo(t,o)}o.isFirstPageLoad=!1},i.runAction=function(o,n){let a=!1,r=null;"object"==typeof o&&(r=o,o=t(o).attr("data-action-url"));let s=e.getActionName(o);if((!window.AppMemorial_config.is_tpl_default||"|open-template-selector"===s)&&i.isActionExist(s)){["|premium-dialog-page","|lifetime-page"].indexOf(s)<0&&i.setHashAction(t("<div/>").attr("data-action-url",o)),e.options.actions[s].apply(r,n),a=!0}return a},i.getAllUrlParams=function(e){var t=e?e.split("?")[1]:window.location.search.slice(1),i={};if(t)for(var o=(t=t.split("#")[0]).split("&"),n=0;n<o.length;n++){var a=o[n].split("="),r=a[0],s=void 0===a[1]||a[1];if(r=r.toLowerCase(),"string"==typeof s&&(s=s.toLowerCase()),r.match(/\[(\d+)?\]$/)){var l=r.replace(/\[(\d+)?\]/,"");if(i[l]||(i[l]=[]),r.match(/\[\d+\]$/)){var d=/\[(\d+)\]/.exec(r)[1];i[l][d]=s}else i[l].push(s)}else i[r]?i[r]&&"string"==typeof i[r]?(i[r]=[i[r]],i[r].push(s)):i[r].push(s):i[r]=s}return i},i.resolve=function(){return res=!1,i.getCurrentAnchorAction().length&&(res=i.runAction(i.getCurrentAnchorAction())),res},i.isHashDisablePrivacy=function(t){return-1!==e.options.arrayHashesDisableCheckPrivacy.indexOf(t)},i.isHashCheckAfterSignin=function(i){i=i.split("|");let o=!1;return t(i).each(function(t,i){if(i&&e.options.arrayHashesClearAfterSignin.indexOf(i)>-1)return o=!0,!1}),o},i.init=function(n){return console.log("meRouter initialized..."),t.extend(e.options,o,n),e.initPagesRoute(),i},i},e.meRouter=meRouter}(this,jQuery);var meRouter=new meRouter;$(function(){meRouter.init(),me.init()});var un=void 0,scrollPosition=0,ajaxEvents=[],loadedObjects=[],_MOBILE_=1139,_TABLET_=600,_IS_MOBILE_=$(window).width()<=_MOBILE_,_IS_TABLET_=$(window).width()>=_TABLET_&&$(window).width()<=_MOBILE_,_IS_BACK_FROM_HISTORY_=!1,_TEXT_INPUT_MAX_LENGTH_=100,_TEXT_AREA_INPUT_MAX_LENGTH_=15e3;function isIE(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")&&parseInt(e.split("msie")[1])}$(window).on("resize",function(){_IS_MOBILE_=$(window).width()<=_MOBILE_,_IS_TABLET_=$(window).width()>=_TABLET_&&$(window).width()<=_MOBILE_}),addEventListener("popstate",function(e){return _IS_BACK_FROM_HISTORY_=!0,!1},!1),me.init=function(){me.checkCookie()&&(me.force_history_back=!1,me.removeAnnouncementCookies(),me.ajaxGlobal(),me.initNumberFields(),me.initMaxLength(),me.initCheckState(),me.initFormValidators(),me.layout_topButton(),me.showSignInHint(),me.setAsideSlideshow(),me.setContactAction(),me.loadShare(),me.initHeader(),me.isFirstOpenMemorial(),me.enableDropdownClickMenus(),me.enableHeaderSnowAnimation(),me.enableSwipeTriggers(),$(".custom-action").click(function(){me.loadAndGotToBlock($(this))}),me.on("click","[data-action-url]",function(){return meRouter.runAction(this),!1}).on("click",".block.visits a, #aside_admins .manage-admins",function(){auth.isSignedIn()&&$(this).data("ajax-url")&&me.loadAndGotToBlock($(this))}).on("click","#aside_slideshow .photo .slide-img",function(){me.pageSlideShow.disableActions=!1,me.pageSlideShow.onePhotoMode=!1,me.pageSlideShow.currentItemObj=$(this),me.pageSlideShow.init(!1)}).on("click","#photo-memorial a, #photo-memorial-mobile a, #photo-memorial-inner a",function(){me.pageSlideShow.disableActions=!0,me.pageSlideShow.onePhotoMode=!0,me.pageSlideShow.currentItemObj=$(this),me.pageSlideShow.init(!1)}).on("click","#aside_activities .activities a, #page-resent-activity .activities a",function(){var e=$(this);$(e).data("ajax-url")&&(me.force_history_back=!0,me.loadAndGotToBlock(e,function(){var t=e.data("activity-id");setTimeout(function(){""!=t&&$('div[data-oid="'+t+'"]').length&&$("html, body").animate({scrollTop:$('div[data-oid="'+t+'"]').offset().top-120},300,function(){me.highlightBlock($('div[data-oid="'+t+'"]'))})},1)}))}).on("change keyup keydown","select.form-control",function(){me.checkFilled($(this))}).on("click",".bootbox.modal input[type='text'],.bootbox.modal input[type='email'],.bootbox.modal input[type='number'],.bootbox.modal textarea",function(){if(_IS_MOBILE_&&!$("body").hasClass("iphone")&&!$("body").hasClass("mac")){var e=$(".bootbox.modal").offset().top,t=$(".bootbox.modal").scrollTop(),i=$(this).offset().top;if(i>e){var o=t+(i-e)-130;o>0&&$(".bootbox.modal").animate({scrollTop:o},300)}}}).on("click","#show-more-activities .arrow",function(){var e=$(this),t=$("#aside_activities .block.activities"),i=$("#aside_activities li");t.css("max-height",t.height()),e.hasClass("down")?(e.addClass("hidden"),$("#show-more-activities .arrow.up").removeClass("hidden"),i.removeClass("hidden"),t.animate({"max-height":5e3},300)):(e.addClass("hidden"),$("#show-more-activities .arrow.down").removeClass("hidden"),i.slice(5,i.length).addClass("hidden"))}).on("click",".premium-contribute .provider",function(){meRouter.runAction("|premium-dialog-page")}).on("click","a[data-contact-id]",function(){if(auth.isSignedIn()){var e=$(this).data("contact-id");me.contact.open(e)}else auth.open();return!1}).on("click","a[data-contact-user-id]",function(){if(auth.isSignedIn()){let e=$(this).data("contact-user-id");me.contact.user(e)}else auth.open();return!1}).on("click",".allowed-changed-photo, .changed-cover-photo",function(){if(!auth.isSignedIn())return auth.open(),!1;if(!me.isPermsChangedCoverPhoto())return meRouter.unSetCurrentHashAction(),!1;let e="|replace_photo";if($(this).find("[data-empty-cover-photo]").data("empty-cover-photo")&&(e="|add_photos",_IS_MOBILE_&&(e="|show_cover_photos_mobile_dialog")),meRouter.isCurrentRoute("gallery/photos"))return meRouter.setHashAction(e),meRouter.runCurrentHashAnchor(),!1;page("/gallery/photos#"+e)}),$("body.ie11").length&&!_IS_MOBILE_&&($("input[placeholder]:not('.placeholder-visible')").attr("placeholder",""),$("textarea[placeholder]:not('.placeholder-visible')").attr("placeholder","")),bgplayer.hideIcon())},me.isFirstOpenMemorial=function(){$(".loading-overlay:visible").length?setTimeout(function(){me.isFirstOpenMemorial()},1e3):!0===window.AppMemorial_config.is_tpl_default&&templateSelector.init()},me.showInviteConfirmationDialog=function(){popup.confirm(Lang.CHANGE_THE_PRIVACY_INVITED_DIALOG_TEXT,function(){meRouter.runAction("|invite")},function(){meRouter.unSetCurrentHashAction()},!1,!1,{ok:Lang.CHANGE_PRIVACY_INVITED_OK_BUTTON_TEST,cancel:Lang.CHANGE_PRIVACY_INVITED_CANCEL_BUTTON_TEXT})},me.addHeaderSnow=function(){$("#snow-canvas").length||$("#cover-memorial").prepend('<canvas id="snow-canvas" class="header-snow"></canvas>'),me.enableHeaderSnowAnimation()},me.removeHeaderSnow=function(){$("#snow-canvas").length&&$("#snow-canvas").remove()},me.enableHeaderSnowAnimation=function(){$(".header-snow").length&&function(){"use strict";var e,t,i=[],o=300;function n(){e=document.getElementById("snow-canvas"),t=e.getContext("2d"),l(),function(e){for(var t=0;t<e;t++)new a}(_IS_MOBILE_?75:150),s(),setInterval(s,25),window.addEventListener("resize",l,!1)}function a(){this.x=Math.random()*(e.width+o)-o/2,this.y=Math.random()*(e.height+o)-o/2,this.z=.5*Math.random()+.5,this.vx=(2*Math.random()-.5)*this.z,this.vy=(1.5*Math.random()+1.5)*this.z,this.fill="rgba(255,255,255,"+(.5*Math.random()+.5)+")",this.dia=(2.5*Math.random()+1.5)*this.z,i.push(this)}function r(t){t.x+=t.vx,t.y+=t.vy,t.x>e.width+o/2?t.x=-o/2:t.xpos<-o/2&&(t.x=e.width+o/2),t.y>e.height+o/2?t.y=-o/2:t.y<-o/2&&(t.y=e.height+o/2)}function s(){t.clearRect(0,0,e.width,e.height);for(var o=0;o<i.length;o++)n=i[o],t.beginPath(),t.strokeStyle="transparent",t.fillStyle=n.fill,t.arc(n.x,n.y,n.dia,0,2*Math.PI),t.closePath(),t.stroke(),t.fill(),r(i[o]);var n}function l(){const t=$("#snow-canvas");let i=300,o=$(window).width();$(t).is(":visible")&&(i=t.height(),o=t.width()),e.width=o,e.height=i,s()}jQuery(document).ready(function(e){n()})}()},me.mobileHeaderBackAction=function(){var e="";$.each({"/gallery-edit/photos":"/gallery/photos","/gallery-edit/videos":"/gallery/videos"},function(t,i){if(t.indexOf(meRouter.getCurrentRoute())>=0)return e=i,!1}),meRouter.getIsForceBackToAboutPage()||"/upgrade"!==meRouter.getCurrentRoute()&&!me.force_history_back?e?page(e):(meRouter.setIsForceBackToAboutPage(!1),meRouter.moveToAbout()):(meRouter.setIsForceBackToAboutPage(!1),window.history.back())},me.adsBlocked=function(e){if("undefined"!=typeof Request){var t=new Request("https://www.googletagmanager.com/gtag/js",{method:"HEAD",mode:"no-cors"});fetch(t).then(function(e){return e}).then(function(t){e(!1)}).catch(function(t){e(!0)})}else e(!1)},me.removeAnnouncementCookies=function(){me.announcements.setPhpCookie("renew_announcement_closed_"+AppMemorial_config.memorialId,null,0),me.announcements.setPhpCookie("wrong_email_announcement_closed_"+AppMemorial_config.memorialId,null,0),me.announcements.setPhpCookie("cart_expiration_announcement_closed_"+AppMemorial_config.memorialId,null,0)},me.checkCookie=function(){var e=navigator.cookieEnabled;return e||(document.cookie="testcookie",e=-1!=document.cookie.indexOf("testcookie")),e||me.showCookieFail()},me.showCookieFail=function(){return es.$modal=popup.extended({className:"private-memorial full-height",message:$("#disabled-cookie-message").html(),onEscape:function(){return!1}}).on("shown.bs.modal",function(){me.setContactAction()}),es.$modal.find(".close").remove(),!1},me.initNumberFields=function(){$("[type='number']").on("keypress",function(e){(8!=e.which&&0!=e.which&&e.which<48||e.which>57)&&e.preventDefault()})},me.getMainPhotoId=function(){return window.AppMemorial_config.idMainPhotoMemorial},me.setMainPhotoId=function(e){window.AppMemorial_config.idMainPhotoMemorial=e},me.initBlurBackground=function(){$("#title-memorial .blur-background").css("opacity",1)},me.initHeader=function(){var e=$("#header #cover-memorial").css("background-image");void 0!==e&&"none"!==(e=e.replace("url(","").replace(")","").replace(/\"/gi,""))&&$("<img/>").attr("src",e).on("load",function(){$(this).remove(),me.initBlurBackground()}),setTimeout(function(){me.initBlurBackground()},5e3),me.checkScrolled(),$(window).on("scroll",function(){me.checkScrolled()})},me.checkScrolled=function(){$(window).scrollTop()>50?$("body ,section.head").addClass("scrolled"):$("body, section.head").removeClass("scrolled")},me.initMaxLength=function(){$.fn.setTextInputMaxLen=function(e){var t="input[type='text']:not([maxlength]), input[type='email']:not([maxlength]), input[type='password']:not([maxlength])";$(t).length&&$(t).attr("maxlength",e)},$.fn.setTextAreaInputMaxLen=function(e){var t="textarea:not([maxlength])";$(t).length&&$(t).attr("maxlength",e)},$().setTextInputMaxLen(_TEXT_INPUT_MAX_LENGTH_),$().setTextAreaInputMaxLen(_TEXT_AREA_INPUT_MAX_LENGTH_)},me.changePrivacy=function(e,t){globalLoader.showGlobalLoader(),$.post(window.AppMemorial_config.baseUrl+"settings/change-privacy-save",{privacy:e},"json").done(function(e){if(!App.ajaxError(e)){if(window.AppMemorial_config.privacy=e.privacy,me.vars.checkState.privacy=e.privacy,$("#page-settings").length){$('#page-settings form input[name="privacy"]').prop("checked",!1);var i=$('#page-settings form input[name="privacy"][value="'+e.privacy+'"]');i.prop("checked","checked"),me.pageSettings.removeSelectedClass(i,!0)}me.loadBlock("menuMemorial"),me.loadBlock("mobileActionMenu"),"function"==typeof t&&t()}}).fail(function(){}).always(function(){globalLoader.hideGlobalLoader()})},me.canInvite=function(){return!me.isPrivate()},me.canShare=function(){return!me.isPrivate()},me.isPrivate=function(){return"private"==window.AppMemorial_config.privacy},me.isInviteOnly=function(){return"invited"==window.AppMemorial_config.privacy},me.canRevokeInvitation=function(){return me.isInviteOnly()},me.changeSettingsDialog=function(e,t,i){var o=["public","invited"];void 0!==i&&(o=i),$.post(window.AppMemorial_config.baseUrl+"settings/get-settings-dialog",{showPrivateOption:o},function(i){var o=popup.extended({className:"dialog-invite-change-privacy full-height",iconClass:"fmi-persons",title:Lang.CHANGE_PRIVACY_DIALOG,message:i,buttons:{Cancel:{label:Lang.CANCEL,className:"button cancel",callback:function(){meRouter.unSetCurrentHashAction(),"function"==typeof t&&t()}},confirm:{className:"button",label:Lang.SAVE_AND_INVITE,callback:function(){var t=$("#dialog-invite-change-privacy .radio-buttons:not(.current-privacy) input[name=privacy]:checked").val();if(void 0===t)return popup.error(Lang.YOU_MUST_SELECT_PRIVACY_LEVEL),!1;me.changePrivacy(t,e)}}}}).on("shown.bs.modal",function(){$('[type="radio"]',o).on("click",function(){$(".radio-buttons .selected",o).removeClass("selected"),$(this).parent().addClass("selected")})})},"html").fail(function(e){jsLogger.showAjaxFail("j79013",e)})},me.openAlreadyInvitedDialog=function(e){var t=function(){return $modal.modal("hide"),!1};$modal=popup.extended({className:"sent-invite-already-invited extra-wide-dialog response full-height",message:e,onEscape:function(){return!1},onClose:function(){return!1}}).on("shown.bs.modal",function(){$modal.find(".close").remove(),$modal.find(".close-button").on("click",t)})},me.beforeApprove=function(){var e=window.AppMemorial_config.needApprove;window.AppMemorial_config.needApprove=null,$.post(window.AppMemorial_config.baseUrl+"invite/only-invited-approve",{approveCode:e},function(t){1==t.success?(ci.approveCode=e,invite.openInviteEmail()):"ERROR_PERMISSIONS"==t.error||("ALREADY_INVITED"==t.error?me.openAlreadyInvitedDialog(t.msg):"EMPTY_CODE"!=t.error&&"ROW_NOT_FOUND"!=t.error||jsLogger.showAjaxFail("j79014",t))},"json").fail(function(e){jsLogger.showAjaxFail("j79015",e)})},me.checkFilled=function(e){e.removeClass("filled"),e.val()&&(e.addClass("filled"),e.trigger("blur"))},me.setAsideSlideshow=function(e){if(!_IS_MOBILE_){let t=$("#aside_slideshow .slideshow .photo");t.addLoaderLayout(),$.ajax({url:window.AppMemorial_config.baseUrl+"gallery/get-sidebar-slideshow-slides",data:{offset:0},method:"post",dataType:"json",success:function(i){t.deleteLoaderLayout();var o=t.trigger("destroy.owl.carousel").html("");if(i.slides.length){o.show().next().show(),$("#aside_slideshow .slideshow .empty-text").hide(),$(i.slides).each(function(e,t){if(e>=100)return!1;!function(e,t){var i=$("<div/>",{class:"slide-img owl-lazy",alt:t.title,"data-author":t.author,"data-title":t.title,"data-i":e+1,"data-slide-position":e,"data-oid":t.id,"data-perms":t.perms,"data-story-id":t.story_id,ordering:t.ordering});i.attr("data-src",t.url),t.exist||i.html('<i class="fmi-candle-light no-image-icon"></i>'),o.append(i)}(e,t)}),o.owlCarousel({animateIn:"fadeIn",animateOut:"fadeOut",nav:!1,dots:!1,items:1,loop:!0,margin:10,autoplay:!0,autoplayTimeout:6e3,autoplaySpeed:1,itemClass:"aside-slide owl-item",stageOuterClass:"block_W owl-stage-outer",stageClass:"aside-slides owl-stage",responsiveBaseElement:"#aside_slideshow",lazyLoad:!0,lazyLoadEager:2})}else o.trigger("destroy.owl.carousel").hide().next().hide(),$("#aside_slideshow .slideshow .empty-text").show();typeof e!=ud&&e()}})}},me.showSignInHint=function(){if(!auth.isSignedIn()&&"|signin"!==window.location.hash){$.cookie("signin_hint_closed")||$(".modal.login-modal").length||$("#announcement-container").length||(AppMemorial_config.invitee_session||"private"!=AppMemorial_config.privacy&&"invited"!=AppMemorial_config.privacy)&&setTimeout(function(){me.announcements.showSignInAnnouncement()},18e4)}},me.ajaxGlobal=function(){$.ajaxSetup({data:{internal_ajax_call:1}}),me.ajaxSend(function(e,t,i){var o=i.url;ajaxEvents.indexOf(o)<0?ajaxEvents.push(o):t.abort()}),me.ajaxComplete(function(e,t,i){var o=i.url,n=ajaxEvents.indexOf(o);0==t.status&&"error"==t.statusText&&(popup.error(Lang.NO_INTERNET_CONNECTION,"no-connection"),t.abort()),me.initNumberFields(),$.isFunction($().setTextInputMaxLen)&&$().setTextInputMaxLen(_TEXT_INPUT_MAX_LENGTH_),$.isFunction($().setTextAreaInputMaxLen)&&$().setTextAreaInputMaxLen(_TEXT_AREA_INPUT_MAX_LENGTH_),setInterval(function(){ajaxEvents.splice(n,1)},100)})},me.loadAndGotToBlock=function(e,t){t=t||!1;var i=e.data("ajax-url");"string"==typeof i&&(ajaxUrl=i.split("|")[0],meRouter.unSetCurrentHashAction(!1),meRouter.setPreviousRoute(),meRouter.setCurrentRoute(ajaxUrl),meRouter.pushCurrentAnchor(),me.getAjaxContent(function(){meRouter.getCurrentAnchorAction()||popup.closePopupIfExist(),void 0!==e.data("block-selector")&&meRouter.setScrollAnchor(e.data("block-selector")),t&&t()}))},me.initFormValidators=function(){$("[data-form-validate=true]").each(function(){me.addFormValidate($(this))})},me.isObjLoaded=function(){return!(loadedObjects.indexOf(meRouter.getCurrentRoute())<0)||(loadedObjects.push(meRouter.getCurrentRoute()),!1)},me.addFormValidate=function(e){var t=e,i={language:formValidatorTranslations,lang:"en",form:t};return t.attr("data-form-validate-modules")&&(i.modules=t.attr("data-form-validate-modules"),t.find("input, textarea").each(function(e,t){var i=$(t);i.attr("data-validation")&&-1==i.attr("data-validation").search("required")&&i.attr("data-validation-optional","true")})),t.attr("data-form-validate-on-blur")&&(i.validateOnBlur=t.data("form-validate-on-blur")),t.attr("data-scroll-to-top-on-error")&&(i.scrollToTopOnError=t.data("scroll-to-top-on-error")),_IS_MOBILE_&&$(".material-mobile").length&&(i.scrollToTopOnError=!1,i.onError=function(e){$error=$(".error",e).first(),$(".material-mobile").animate({scrollTop:$error.offset().top-120},300)}),jQuery.validate(i),t},me.isPageAboutInCache=function(){return void 0!==me.aboutPageCache&&me.aboutPageCache.length},me.getAjaxContent=function(e){e=e||!1;var t=window.AppMemorial_config.baseUrl.replace(/\/+$/,"")+meRouter.getCurrentRoute(),i=new XMLHttpRequest;$("#pg");(meRouter.isCurrentRoute("settings")||meRouter.isCurrentRoute("visitors"))&&$("#pg .settings-inner-block"),"undefined"!=typeof gtag&&gtag("config",window.AppMemorial_config.analiticsId,{page_path:"/memorial"+meRouter.getCurrentRoute()}),me.setActiveMenu(),meRouter.checkModals(!0),me.circleButton.destroy(),meMobileActionMenu.hideSubMenuDialog(),meRouter.isAboutPage()&&meRouter.getCurrentAnchorAction()&&me.cleanAboutPageCache(),me.isAboutPageCacheEnabled()?me.runAjaxContentResponse(me.aboutPageCache,i,e):(globalLoader.showGlobalLoader(),$.ajax({url:t,type:"POST",xhr:function(){return i},data:{signInStatus:auth.isSignedIn(),privacyStatus:window.AppMemorial_config.privacy,showPlanSelectors:$("body").hasClass("visible-premium-plans")},success:function(t){me.runAjaxContentResponse(t,i,e)},default:function(){setTimeout(function(){globalLoader.hideGlobalLoader()},5e3)}}))},me.runAjaxContentResponse=function(e,t,i){if(1==e.reloadIsNeeded)return void window.location.reload();if(e.errorCode||1==e.not_permited||e.indexOf("page-not-found")>-1)return void(auth.isSignedIn()?meRouter.moveToAbout():auth.open(null,function(){meRouter.moveToAbout()}));var o=$(e).data("init");let n=function(){$("#pg").html(e).show(),meRouter.setBodyClass()};n(),me.isExpired(),window.AppMemorial_config.doShowInvitation?auth.open(!1,me.checkPrivacy):me.checkPrivacy(),mediaPlayer.init(),me.pageJsInit(o,function(){"function"==typeof i&&i(),meRouter.runCurrentHashAnchor(),$("#mobile-action-menu").addClass("hidden"),meRouter.isAboutPage()&&$("#mobile-action-menu").removeClass("hidden"),!meRouter.isAboutPage()||$("#announcement-container").length||meRouter.getCurrentAnchorAction()||"pageAbout"!=o||me.cacheAboutPage(e),introSteps.showGeneralUserTooltips(),contentPagination.afterChangeTab(),window.AppMemorial_config.needApprove&&me.beforeApprove()}),globalLoader.hideGlobalLoader()},me.animateInnerPage=function(e,t){$(e).addClass("animated "+t).one("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(){$(e).removeClass("animated "+t),me.triggerWindowResize()})},me.isAboutPageCacheEnabled=function(){return _IS_MOBILE_&&me.isPageAboutInCache()&&meRouter.isAboutPage()},me.enableSwipeTriggers=function(){document.addEventListener("touchstart",function(i){const o=function(e){return e.touches||e.originalEvent.touches}(i)[0];e=o.clientX,t=o.clientY},!1),document.addEventListener("touchmove",function(i){if(!e||!t)return;var o=i.touches[0].clientX,n=i.touches[0].clientY,a=e-o,r=t-n;Math.abs(a)>Math.abs(r)?a>0?me.trigger("swipeLeft"):me.trigger("swipeRight"):r>0?me.trigger("swipeUp"):me.trigger("swipeDown");e=null,t=null},!1);var e=null,t=null},me.cacheAboutPage=function(e){me.aboutPageCache=e},me.cleanAboutPageCache=function(){me.aboutPageCache=""},me.setActiveMenu=function(){if(void 0!==meRouter.getCurrentRoute().split("/")[1]){let e=meRouter.getCurrentRoute().split("/")[1];if(void 0!==meRouter.getCurrentRoute().split("?")[0]){(e=e.split("?")[0]).includes("gallery")&&(e="gallery");let t=$("#menu_memorial"),i=t.find('a[href*="/'+e+'/"]'),o=t.find('a[href$="/'+e+'"]');$("a.clicked",t).removeClass("clicked"),i.length?i.addClass("clicked"):o.length&&o.addClass("clicked")}}},me.pageJsInit=function(e,t){if(e){var i=me[e];me.isObjLoaded()?void 0!==i.reload&&i.reload(t):(i.init(t),bgplayer.init(),mediaPlayer.init()),bgplayer.hideIcon()}else"function"==typeof t&&t()},me.loadShare=function(){_IS_MOBILE_?me.on("click",".share-dropdown ",function(){$(this).addClass("hover").share_dropdownShow(),$("html, body").toggleClass("sub-menu-dialog-open modal-open")}):me.on("mouseover",".share-dropdown",function(){$(this).addClass("hover").share_dropdownShow()}).on("mouseleave",".share-dropdown",function(){$(this).removeClass("hover").share_dropdownHide()})},me.loadBlock=function(e,t,i){if(typeof me.layoutLoad[e]!=ud)return me.layoutLoad[e](t,i);if(typeof me.sidebarLoad[e]!=ud)return me.sidebarLoad[e](t);throw"Unknown block ["+e+"]"},me.triggerWindowResize=function(){var e=window.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)},me.layoutLoad={menuTop:function(e){var t="menu_top";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"layout-blocks/menu-top/",{},function(i){me.showContent(t,i),typeof e!=ud&&e()},"html")},titleText:function(e){var t="title-memorial",i=window.AppMemorial_config.baseUrl+"layout-blocks/title-memorial/";me.showBlockLoading(t,"small"),$.post(i,{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},templateSelectorHeaderText:function(e){var t=window.AppMemorial_config.baseUrl+"layout-blocks/title-memorial-ts/";me.showBlockLoading("header-text-wrapper","small"),$.post(t,{},function(t){me.showContent("header-text-wrapper",t,function(){typeof e!=ud&&e()})},"html")},mobileInnerPageTitlePhoto:function(e){let t="photo-memorial-inner",i=window.AppMemorial_config.baseUrl+"layout-blocks/inner-title-photo/",o=$("#"+t).hasClass("hidden");o||me.showBlockLoading(t,"small"),$.post(i,{},function(i){o&&(i=$(i).find("#"+t).addClass("hidden")),me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},mobileInnerPageTitle:function(e){var t="mobile-inner-pages-header",i=window.AppMemorial_config.baseUrl+"layout-blocks/mobile-inner-title/";me.showBlockLoading(t,"small"),$.post(i,{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},titleTextMobile:function(e){var t="title-memorial-mobile",i=window.AppMemorial_config.baseUrl+"layout-blocks/title-memorial-mobile/";me.showBlockLoading(t,"small"),$.post(i,{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},menuMemorial:function(e){var t="menu_memorial",i=window.AppMemorial_config.baseUrl+"layout-blocks/menu-memorial/";me.showBlockLoading(t,"small"),$.post(i,{},function(i){me.showContent(t,i,function(){me.enableDropdownClickMenus(),typeof e!=ud&&e()})},"html")},user_text:function(e){let t=window.AppMemorial_config.baseUrl+"layout-blocks/user-text/";$.post(t,{},function(t){me.showContent("user_text",t,function(){typeof e!=ud&&e()})},"html")},mobileActionMenu:function(e){var t="submenu-list",i=window.AppMemorial_config.baseUrl+"layout-blocks/mobile-action-menu/";meMobileActionMenu.hideSubMenuDialog(),$.post(i,{},function(i){$html=$(i).find("#"+t),me.showContent(t,$html,function(){typeof e!=ud&&e()})},"html")},titlePhoto:function(e){var t="photo-memorial-mobile";me.showBlockLoading("photo-memorial"),me.showBlockLoading(t),$.post(window.AppMemorial_config.baseUrl+"layout-blocks/title-photo/",{},function(i){var o=$(i),n=o.siblings("#"+t),a=o.siblings("#photo-memorial"),r=o.find(".title-photo a").first().data("oid");isNaN(r)?(me.setMainPhotoId(0),$(".text-status-cover-photo").data("empty-cover-photo",!0).parents(".add-cover-wrapper").removeClass("hidden"),$("#title-memorial, #title-memorial-mobile").addClass("without-title-photo"),$("#header, #cover-memorial").addClass("without-photo"),$(".covid-label-wrapper.mobile").addClass("hidden")):(me.setMainPhotoId(r),$(".text-status-cover-photo").data("empty-cover-photo",!1).parents(".add-cover-wrapper").addClass("hidden"),$("#title-memorial, #title-memorial-mobile").removeClass("without-title-photo"),$("#header, #cover-memorial").removeClass("without-photo"),$(".covid-label-wrapper.mobile").removeClass("hidden")),n.find(".title-photo").removeClass("border-title-photo"),a.find(".title-photo").removeClass("border-title-photo");var s=[{id:"photo-memorial",html:a.get(0).outerHTML},{id:t,html:n.get(0).outerHTML}];$.each(s,function(t,i){me.showContent(i.id,i.html,function(){typeof e!=ud&&e(),$("#"+i.id+" .memorial_main_photo").load(function(){$(".title-photo").addClass("border-title-photo")})})}),meRouter.isCurrentRoute("/gallery-edit/photos")&&o.find("[data-oid]").first().length&&$('.radio [name="is_main"][value="'+o.find("[data-oid]").first().attr("data-oid")+'"]').prop("checked",!0)},"html")},pageContent:function(e,t){t=t||!1,meRouter.unSetCurrentHashAction();var i=meRouter.getCurrentRoute();!0===t&&(i=i.replace(/[0-9]/g,"")),me.loadAndGotToBlock(me.data("ajax-url",i),e)},invitation:function(e){var t="aside_invitation";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/invitation/",{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},subscription:function(e){var t="aside_subscriptions";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/subscription/",{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},slideshow:function(e){me.setAsideSlideshow(e)},visits:function(e){var t="aside_visits";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/visits/",{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},admins:function(e){var t="aside_admins";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/admins/",{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},sponsored:function(e){var t="aside_sponsored";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/sponsored/",{},function(i){me.showContent(t,i,e)},"html")},activities:function(e){const t="aside_activities";!me.isPrivate()&&$("#aside_activities").length&&(me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/activities/",{},function(i){me.showContent(t,i,e)},"html"))}},me.showBlockLoading=function(e,t){let i=$("#"+e),o="id";if(i.length||(i=$("."+e),o="class"),void 0===t&&(t="middle"),i.length){const n=function(){const n=$('<div class="AJAX_wait '+t+'"></div>');n.attr(o,e),i.replaceWith(n),i.show()};i.data("showBlockLoading",setTimeout(n,1500)).fadeOut(1500)}},me.showContent=function(e,t,i){let o=$("#"+e),n="id";if(o.length||(o=$("."+e),n="class"),!o.length)throw"showContent-> Could not find DOM by ID ["+e+"]";t||me.getCheckState();var a=!1;o.data("showBlockLoading")&&(clearTimeout(o.data("showBlockLoading")),o.data("showBlockLoading",null),a=!0);var r=$(t).text().replace(/ +/," ").trim(),s=$(o).text().replace(/ +/," ").trim();a&&r!=s?o.fadeOut("fast",function(){o.replaceWith(t),o.attr(n,e),"function"==typeof i&&i(),o.fadeIn("fast")}):(o.replaceWith(t),o.attr(n,e),"function"==typeof i&&i())},me.initCheckState=function(){me.getCheckState(),setInterval(function(){me.getCheckState()},6e4)},me.checkStateDone=function(e,t){let i=window.AppMemorial_config;(typeof e.permission_blocked!==ud&&e.permission_blocked!=i.permission_blocked||typeof e.spam_marked!==ud&&e.spam_marked!=i.spam_marked||typeof e.plan_id!==ud&&e.plan_id!==i.plan_id)&&window.location.reload(),"function"==typeof t&&t()},me.getCheckState=function(e,t){if(me.vars.checkStateLock)return;me.vars.checkStateLock=!0;let i={};typeof window.AppMemorial_config!==ud&&(i.memorial_id=window.AppMemorial_config.memorialId),$.post("/chk",i,function(t){typeof t.s!==ud&&(t.time=Date.now(),me.checkStateTriggers(me.vars.checkState,t),me.fillUserData(t),me.vars.checkState=t,me.checkStateDone(t,e))},"json").fail(function(e){"function"==typeof t&&t(),jsLogger.showAjaxFail("j79001",e)}).always(function(){me.vars.checkStateLock=!1})},me.checkStateTriggers=function(e,t){typeof t.s===ud&&jsLogger.showInternalError("j79016","checkStateTriggers new response is wrong."),$.isEmptyObject(e)?(me.vars.uid=t.id,me.vars.isSignedIn=!1,t.id&&(me.vars.isSignedIn=!0)):me.vars.isSignedIn||e.id||!t.id?me.vars.isSignedIn&&!t.id?(me.vars.isSignedIn=!1,me.vars.uid=!1,me.showRefreshDialog()):e.id&&t.id&&e.id!=t.id?me.showRefreshDialog():e.privacy!==t.privacy&&me.showRefreshDialog():(me.vars.isSignedIn=!0,me.vars.uid=t.id,"undefined"!=typeof gtag&&gtag("set",{user_id:t.id}),me.showRefreshDialog());t.ann&&meRouter.isAboutPage()&&setTimeout(function(){me.announcements.announcementAddAndShow(t.ann)},300)},me.fillUserData=function(e){e.user&&void 0!==e.user?(void 0!==window.AppMemorial_config.user&&null!=window.AppMemorial_config.user||(window.AppMemorial_config.user={}),window.AppMemorial_config.user.id=e.user.id,window.AppMemorial_config.user.fnme=e.user.fnme,window.AppMemorial_config.user.lnme=e.user.lnme):window.AppMemorial_config.user=null},me.showRefreshDialog=function(){modal=popup.confirm(Lang.SESSION_HAS_EXPIRED,function(){window.location.reload()},null,null,null,{ok:Lang.REFRESH_BUTTON}),modal.find(".cancel").hide()},me.showInstructionSetCoverPhotoDialog=function(){popup.confirm(Lang.TO_SET_A_NEW_COVER_PICTURE,function(){meRouter.unSetCurrentHashAction()},null,null,null,{ok:Lang.OK}).find(".cancel").hide()},me.showInstructionReplaceCoverPhotoDialog=function(){popup.confirm(Lang.TO_SET_A_REPLACE_COVER_PICTURE,function(){meRouter.unSetCurrentHashAction()},null,null,null,{ok:Lang.OK}).find(".cancel").hide()},me.layout_topButton=function(){if(!_IS_MOBILE_){const e=800,t=$(".scroll-top").hide().removeClass("hidden").click(function(i){t.lockCheck()||(t.lockOn(),$("html, body").animate({scrollTop:$("#main").offset().top},e,()=>{t.lockOff()}))});$(window).on("scroll",function(){$(window).scrollTop()>e?t.fadeIn(e):t.fadeOut(e)})}},me.upgradenotification=function(e){$.post(window.AppMemorial_config.baseUrl+"upgrade/notification",{},function(t){globalLoader.hideGlobalLoader();var i="extra-wide-dialog dialog-upgrade-notification full-height";t.indexOf("no-guest")>0&&(i+=" no-guest"),$modal=popup.extended({className:i,message:t,buttons:{Continue:{className:"button ok",label:Lang.CONTINUE_TO_MEMORIAL,callback:function(){return function(e,t){var i=$(".modal-content",e);if($("form",e).length){if(i.lockCheck())return!1;i.lockOn().addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"upgrade/notification-read",$("form",e).serialize(),function(i){App.ajaxError(i)?jsLogger.showInternalError("j79002",i):(e.modal("hide"),"function"==typeof t&&t())},"JSON").fail(function(e){jsLogger.showAjaxFail("j79003",e)}).always(function(){i.lockOff().deleteLoaderLayout()})}else e.modal("hide"),"function"==typeof t&&t()}($modal,e),meRouter.unSetCurrentHashAction(),!1}}}}),$modal.find("[name='notification_type']:checked").parents(".radio-wrapper").addClass("active")},"html").fail(function(e){jsLogger.showAjaxFail("j79004",e)})},me.sidebarLoad={invitation:function(e){var t="aside_invitation";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/invitation/",{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},subscription:function(e){var t="aside_subscriptions";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/subscription/",{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},slideshow:function(e){var t="aside_slideshow";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/slideshow/",{},function(i){me.showContent(t,i),typeof e!=ud&&e(),$(me).trigger("loaded.aside.slideshow",i)},"html")},visits:function(e){var t="aside_visits";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/visits/",{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},admins:function(e){var t="aside_admins";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/admins/",{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")},activities:function(e){const t="aside_activities";!me.isPrivate()&&$("#aside_activities").length&&(me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/activities/",{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html"))},bookmarks:function(e){var t="aside_bookmarks";me.showBlockLoading(t,"small"),$.post(window.AppMemorial_config.baseUrl+"sidebar-blocks/bookmarks/",{},function(i){me.showContent(t,i,function(){typeof e!=ud&&e()})},"html")}},me.editAsideSlideshow=function(e,t){$("#aside_slideshow").find("img[data-oid="+e.data("oid")+"]").attr("src",t["img-list"])},me.setContactAction=function(){$('a[href*="contactus"]').click(function(){return me.showContactUs(this,!1),!1})},me.showContactUs=function(e){let t=$(e),i=t.parent().text().replace(/{br}/g,"\r\n");var o="";t.parent().text().length&&(o=Lang.REPORT_PROBLEM_DESCRIPTION.replace(/{br}/g,"\r\n").replace(/{message}/g,i)),meRouter.setHashAction(t);var n=window.AppMemorial_config.contactUsErrorUrl;t.data("url")&&(n=t.data("url"));var a={modalHandler:null,oldFormData:[],$field:t,getModalWindow:function(){$.ajax({url:n,data:{},dataType:"json",success:function(e){if(!e.success)return jsLogger.showInternalError("j79005",e),!1;a.modalHandler=popup.extended({className:"dialog-suggestion full-height",title:Lang.CONTACT_US_DIALOG_TITLE,iconClass:"fmi-mail-icon-2",message:e.page,closeButton:!1,buttons:{confirm:{label:Lang.CONTACT_US_SUBMIT_BUTTON,className:"button noupper contact-submit large-center-mobile",callback:function(){return $("form",a.modalHandler).submit(),!1}}},onEscape:function(){me.checkPrivacy(),meRouter.unSetCurrentHashAction(),a.modalHandler.modal("hide")},onClose:function(){me.checkPrivacy()}}).on("shown.bs.modal",function(){var t=$("form",a.modalHandler),i=Object.keys(a.oldFormData);if(i.length>0&&i.forEach(function(e){var t=$("#"+e);"SELECT"==t.prop("tagName")?(t.find("option").removeAttr("selected"),t.find("[value="+objectVal+"]").attr("selected","selected"),t.addClass("filled")):t.val(objectVal)}),$("body").deleteLoaderLayout(),a.modalHandler.css({"padding-left":"0"}),me.addFormValidate(t),e.inquiry_type&&(t.find("option").removeAttr("selected"),t.find("select").val(e.inquiry_type).addClass("filled"),t.find("option[value="+e.inquiry_type+"]").attr("selected","selected").addClass("filled")),a.$field.data("error-code")){var n=a.$field.data("error-code");$(".errorId",t).val(n),$(".errorTrace",t).val(jsLogger.getUserLogTraceById(n)),o.length&&$("#contact-text",t).val(o)}globalLoader.hideGlobalLoader(700),t.submit(function(){var e=$(a.modalHandler);return $.post(t.data("ajax-url"),t.serialize(),function(e){a.modalHandler.modal("hide"),me.showContactUsThanks(e)},"JSON").fail(function(e){jsLogger.showAjaxFail("j79006",e)}).always(function(){e.deleteLoaderLayout()}),!1})})}})}};$(".menu_swipe_visible").length>0&&swipeMenu.hideSwipeMenu(),globalLoader.showGlobalLoader(),a.getModalWindow()},me.showContactUsThanks=function(e){$modal=popup.extended({className:"contact-us-thanks full-height",message:e.message,onEscape:function(){return me.checkPrivacy(),meRouter.unSetCurrentHashAction(),!1},onClose:function(){return me.checkPrivacy(),meRouter.unSetCurrentHashAction(),!1}}).on("shown.bs.modal",function(){$modal.find(".close").remove(),$modal.on("click",function(){return $modal.modal("hide"),me.checkPrivacy(),meRouter.unSetCurrentHashAction(),!1})})},me.showSuccessContactModal=function(e){let t=function(){"function"==typeof me.isExpired&&me.isExpired(),"function"==typeof me.checkPrivacy&&me.checkPrivacy()};$modal=popup.extended({className:"show-contact extra-wide-dialog full-height",message:e,onClose:function(){t()}}).on("shown.bs.modal",function(){$modal.find(".close").remove(),$(".go-home-link-block",$modal).on("click",function(){$modal.modal("hide"),t()})})},me.isMobile=function(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))},me.isExpired=function(){if($(".need_renew").hasClass("in"))return!1;var e=window.location.href.split("|").slice(-1)[0];me.isExpire&&(auth.isSignedIn()&&!meRouter.isHashDisablePrivacy(e)||!auth.isSignedIn())&&$.post(window.AppMemorial_config.baseUrl+"renewal/locked",{from:window.AppMemorial_config.came_from},function(e){App.ajaxError(e)?jsLogger.showInternalError("j79011",e):e&&me.showExpiredPopup(e.page)})},me.showExpiredPopup=function(e){let t=$(e).hasClass("with-offer")?"":" full-height ";es.$modal=popup.extended({className:"need_renew extra-wide-dialog"+t,message:e,onEscape:function(){return!1}}),es.$modal.find(".close").remove()},me.newFeaturesDialog=function(){$.ajax({url:window.AppMemorial_config.baseUrl+"new-features-dialog",data:{},dataType:"json",success:function(e){if(!e.success)return!1;var t=popup.extended({className:"new-features-dialog premium-dialogs-type full-height",title:Lang.NEW_FEATURES_DIALOG_TITLE,iconClass:"fmi-sponsored-icon",message:e.page,closeButton:!1,onEscape:function(){t.modal("hide")},buttons:{}})}})},me.checkPrivacy=function(){var e=window.location.href.split("|").slice(-1)[0];me.isExpire||(!auth.isSignedIn()||meRouter.isHashDisablePrivacy(e))&&auth.isSignedIn()||("private"==window.AppMemorial_config.privacy&&$.post(window.AppMemorial_config.baseUrl+"layout-blocks/checkPrivacy",{},function(e){window.location.href.split("|").slice(-1)[0];App.ajaxError(e)?jsLogger.showInternalError("j79009",e):e.success&&e.page.length&&(me.showPrivateDialog(e.page),$("body").addClass("access-restricted"))}),"invited"==window.AppMemorial_config.privacy&&$.post(window.AppMemorial_config.baseUrl+"layout-blocks/checkPrivacy",{},function(e){App.ajaxError(e)?jsLogger.showInternalError("j79007",e):e.success&&e.page.length&&(me.showOnlyInviteDialog(e.page),$("body").addClass("access-restricted"))}))},me.showPrivateDialog=function(e){es.$modal=popup.extended({className:"private-memorial extra-wide-dialog full-height",message:e,onEscape:function(){return!1}}).on("shown.bs.modal",function(){me.setContactAction()}),es.$modal.find(".close").remove()},me.showOnlyInviteDialog=function(e){es.$modal=popup.extended({className:"only-invite-memorial extra-wide-dialog full-height",message:e,onEscape:function(){return!1}}).on("shown.bs.modal",function(){me.setInviteAction(),me.setContactAction()}),es.$modal.find(".close").remove()},me.showRequestInvitationDialog=function(e){es.$modal=popup.extended({className:"send-invite-memorial full-height",title:Lang.REQUEST_INVITATION_TITLE,message:e,onEscape:function(){me.checkPrivacy()},onClose:function(){me.checkPrivacy()},buttons:{save:{label:Lang.SEND_INVITATIONS,className:"button send modal-header-button same-size-all",callback:function(){return $("form",es.$modal).submit(),!1}}}}).on("shown.bs.modal",function(){me.addFormValidate($("form",es.$modal)),$("form",es.$modal).submit(function(){globalLoader.showGlobalLoader();var e=window.AppMemorial_config.baseUrl+"invite/only-invited-request";return $.ajax({url:e,method:"POST",data:{name:es.$modal.find("#contact-name").val(),email:es.$modal.find("#contact-email").val(),msg:es.$modal.find("#invitation-message").val()},dataType:"json",success:function(e){globalLoader.hideGlobalLoader(),e.success?es.$modal=popup.extended({className:"sent-invite-memorial full-height extra-wide-dialog response",message:e.html,onEscape:function(){return!1},onClose:function(){return!1}}).on("shown.bs.modal",function(){es.$modal.find(".close").remove()}):jsLogger.showInternalError("j79008",e)}}),!1})})},me.highlightBlock=function(e){if(e&&e.length)var t=0,i=setInterval(function(){1===(t+=1)&&(clearInterval(i),meRouter.unSetCurrentHashAction()),e.fadeTo(500,.3).fadeTo(400,1)},900)},me.setInviteAction=function(){$(".send-invite-url").click(function(){$.post(window.AppMemorial_config.baseUrl+"layout-blocks/requestInvitation",{},function(e){App.ajaxError(e)?jsLogger.showInternalError("j79012",e):e.success&&e.page.length&&me.showRequestInvitationDialog(e.page)})})},me.enableDropdownClickMenus=function(){$("#memorial-admin-menu, #menu_desktop .before-more").on("click",function(){$(this).toggleClass("visible")});var e=$("#menu_desktop .before-more"),t=$("#memorial-admin-menu");$("body").on("click",function(i){t===i.target||t.has(i.target).length||t.removeClass("visible"),e===i.target||e.has(i.target).length||e.removeClass("visible")})},me.initShowQrCode=function(e){$(e).click(e=>{me.showQrCode($(e.target))})},me.initCopyTextToClipboard=function(e){$("body").hasClass("ie11")&&($.fn.modal.Constructor.prototype.enforceFocus=function(){});let t=new ClipboardJS(e);t.on("success",function(e){popup.flash(Lang.COPIED_TO_CLIPBOARD,"success",1500),e.clearSelection()}),t.on("error",function(e){popup.flash(Lang.COPIED_TO_CLIPBOARD_FAILED,"error",1500)})},me.opts={loaded:!1,memorialId:null,memorialUrl:null,gender:null,dob:null,dod:null,baseUrl:null,baseUrlSubdomain:null,fbId:null,fullname:null,isLocked:!1,isOutdated:!1,isRenew:!1,isPremium:!1,isMobile:!1,isPrivate:!1,onlyInvites:!1,songs_playlist:null,songs_shuffle:!1,songs_autostart:!1,slideshow:[],tributeShortLength:400,tributeShortLines:10,storyShortLength:800,storyShortLines:18,lifeStoryShortLength:800,lifeStoryShortLines:18,snippetTributeShortLength:285,snippetTributeShortLines:8,snippetStoryShortLength:285,snippetStoryShortLines:8,snippetLifeStoryShortLength:285,snippetLifeStoryShortLines:8,loadPageLockTimeout:45e3,loadPageFadeoutTimeout:200,loadPageLoaderTimeout:1e3,loadPageFadeoutUseCss:1,routingHistory_threshold:20,routingHistory_slice:10,doShowInvitation:0,doShowUserNotification:""},me.vars={routingHistory:[],loadPageJqXHR:null,loadPageLock:null,alreadyLoadedRouting:null,checkState:{},isSignedIn:window.AppMemorial_config.isSignedIn},function(e,t,i){readMore=function(e,i,o,n,a,r){var s={},l={callback:null,buttonLabel:Lang.READ_MORE,htmlTextFlag:!0};return s.getRolledText=function(e,i,o){return t(e).find(".user_text").not(".rolled-up, .body").each(function(e,t){s.checkSizeText(t,i,o)})},s.checkSizeText=function(e,i,o){var n,a=t(e),r=a.html(),d=0,c=a.text();l.htmlTextFlag?(d=s.getNumberLines(r),n=s.rolledHtmlText):(c=r=a.html().split("<br>").join("\n"),d=s.getNumberLines(c),n=s.rolledText);var u=c.length;(r&&u>i&&u-i>.2*i||d.paragraph>o||d.lineBreak>o)&&n(a,r,i,o,d,s.getShortText(r,i))},s.uncoverText=function(e){e.html(e.data("fullText"))},s.getShortText=function(e,t){return new App.cutString(e,t,!0).cut()},s.uncoverButton=function(e){return element=t('<a href="javascript:void(0);">'+l.buttonLabel+"</a>").on("click",function(){return"function"==typeof l.callback?l.callback(e):(s.uncoverText(e),e.removeClass("rolled-up")),!1}).addClass("readmore show-all-text"),element},s.rolledText=function(e,t,i,o,n,a){n.lineBreak>o&&(a=a.split("\n").splice(0,o).join("\n")),e.data("fullText",t).html(a+"...&nbsp;"),e.addClass("rolled-up"),s.uncoverButton(e).appendTo(e)},s.rolledHtmlText=function(e,i,o,n,a,r){var l="",d="",c="<rolled></rolled>";a.paragraph>n&&(r=r.split("<p>").splice(0,n).join("<p>")),a.lineBreak>n&&(r=r.split("<br>").splice(0,n).join("<br>")),(l+=(r=t("<div/>").html(r)).prop("outerHTML")).lastIndexOf(" ")>1?(l.lastIndexOf(" ")/l.length>.5&&(r=t([l.slice(0,l.lastIndexOf(" ")),c].join(""))),r.find("rolled").length||(d=s.searchLastIndex(l),r=t([l.slice(0,l.lastIndexOf(d)),c,l.slice(l.lastIndexOf(d))].join("")))):(d=s.searchLastIndex(l),r=t([l.slice(0,l.lastIndexOf(d)),c,l.slice(l.lastIndexOf(d))].join(""))),r.find("rolled").parents().css("padding-bottom",0),r.find("rolled").replaceWith('<span class="three-point">...&nbsp;<span>',s.uncoverButton(e)),e.addClass("rolled-up"),e.data("fullText",i).html(r)},s.getNumberLines=function(e){return l.htmlTextFlag?{paragraph:e.split(/<p>/).length,lineBreak:e.split(/<br>/).length}:{lineBreak:e.split(/\r\n|\r|\n/).length}},s.searchLastIndex=function(e){var t="</";return"</p></div>"===e.slice(-10)?t="</p></div>":"</span></div></div>"===e.slice(-19)?t="</span></div></div>":"</div>"===e.slice(-6)&&(t=(t=e.match("(</div>){1,}$"))[0]?t[0]:"</div>"),t},s.init=function(e,t,i,o,n,a){try{return void 0===o&&(l.htmlTextFlag=!0),"function"==typeof n&&(l.callback=n),void 0!==a&&(l.buttonLabel=a),s.getRolledText(e,t,i)}catch(e){jsLogger.showAjaxFail("j88001",e)}},s.init(e,i,o,n,a,r),{}},e.readMore=readMore}(this,jQuery),me.showAboutWebsite=function(){$.post(window.AppMemorial_config.baseUrl+"about-this-website/dialog",{},"json").done(function(e){if(!App.ajaxError(e))var t=popup.extended({className:"about-this-website",title:"Information",message:e.page,onEscape:function(){meRouter.unSetCurrentHashAction(),t.modal("hide")},buttons:{}}).on("shown.bs.modal",function(){$("a:not(.copy-link)",t).on("click",function(){t.modal("hide")}),me.initCopyTextToClipboard("div.button.copy-link"),me.initCopyTextToClipboard("i.fmi-link-icon.copy-link"),me.initShowQrCode("div.button.show-qr-code"),t.find("[data-contact-id]").on("click",function(){var e=$(this).data("contact-id");return me.contact.open(e,null,null,function(){meRouter.runAction("|about-this-website")},function(){meRouter.runAction("|about-this-website")}),!1})})}).fail(function(e){jsLogger.showAjaxFail("j92000",e)})},me.showQrCode=function(e){$.get(e.data("qr-code-dialog-url")).done(e=>{popup.extended({className:"about-this-website",title:"QR-Code",message:e.page,onClose(){me.showAboutWebsite()}})})},me.announcements={$container:null,initAnnouncement:function(){var e=this.$container;$(".full-text-container",e).hide(),$("a.readmore",e).click(function(){return me.announcements.expand(),!1}),$("a.readless",e).click(function(){return me.announcements.narrow(),!1}),$(".announcement-wrapper",e).hasClass("short")&&$(".title-container",e).click(function(){return $(".announcement-wrapper",e).hasClass("expanded")?me.announcements.narrow():me.announcements.expand(),!1}),$("a.close",e).click(function(){var e=$(this).data("aid");$("#announcement-container").hasClass("time_to_renew")?(me.announcements.hideAnnouncement(),me.announcements.setPhpCookie("renew_announcement_closed_"+AppMemorial_config.memorialId,1,1)):$("#announcement-container").hasClass("signin_hint")?($.cookie("signin_hint_closed",1),me.announcements.hideAnnouncement()):$("#announcement-container").hasClass("wrong_email")?(me.announcements.hideAnnouncement(),me.announcements.setPhpCookie("wrong_email_announcement_closed_"+AppMemorial_config.memorialId,1,1)):$("#announcement-container").hasClass("cart_expiration")?(me.announcements.hideAnnouncement(),me.announcements.setPhpCookie("cart_expiration_announcement_closed_"+AppMemorial_config.memorialId,1,1)):$.post("/announcement/mark-read/",{aid:e},"json").done(function(e){App.ajaxError(e)||me.announcements.hideAnnouncement()})})},expand:function(){let e=".mobile";_IS_MOBILE_&&(e=".desktop");var t=this.$container;$(".announcement-wrapper",t).addClass("expanded"),$(".full-text-container",t).show(),$(".readmore-wrapper:not("+e+"), .divider",t).hide(),me.announcements.reCalcHeadHeight(0)},narrow:function(){var e=".mobile";if(_IS_MOBILE_)e=".desktop";var t=this.$container;$(".announcement-wrapper",t).removeClass("expanded"),$(".full-text-container",t).hide(),$(".readmore-wrapper:not("+e+"), .divider",t).show(),me.announcements.reCalcHeadHeight(0)},setPhpCookie:function(e,t,i){$.cookie(e,t,{expires:i,domain:"."+window.AppMemorial_config.domain_suffix,path:"/"})},setPhpSessionValue:function(e,t){$.post("/announcement/set-php-session-value/",{name:e,value:t},"json").done(function(e){App.ajaxError(e)?jsLogger.showAjaxFail("j52001",e):me.announcements.hideAnnouncement()})},reCalcHeadHeight:function(e,t,i){var o=$.Deferred();return i==un&&(i=this.$container),this.getActualHeight(i).then(function(i){t!=un&&(i=t),$("body").stop().animate({paddingTop:i+"px"},e),o.resolve()}),o.promise()},showSignInAnnouncement:function(){$.post("/announcement/get-signin-content/",{},"json").done(function(e){App.ajaxError(e)||e.ann&&e.ann.content&&me.announcements.announcementAddAndShow(e.ann)})},showAnnouncement:function(e,t){e==un&&(e=this.$container),t==un&&(t=1e3),this.reCalcHeadHeight(t,un,e).then(function(){e.slideDown(t,function(){me.announcements.reCalcHeadHeight(0,un,e),$(window).on("resize",function(){$(e).is(":visible")&&me.announcements.reCalcHeadHeight(0,un,e)}),me.triggerWindowResize()})})},enableHolidayBtn:function(){var e=this.$container;$(".new-theme",e).removeClass("disabled"),$(".previous-theme",e).addClass("hidden")},enablePreviousBtn:function(){var e=this.$container;$(".new-theme",e).addClass("disabled"),$(".previous-theme",e).removeClass("hidden")},hideAnnouncement:function(e,t){e==un&&(e=this.$container),e&&e.length&&(t==un&&(t=1e3),interval=null,interval=setInterval(function(){me.triggerWindowResize()},10),this.reCalcHeadHeight(t,0,e).then(function(){e.slideUp(t,function(){e.remove(),clearInterval(interval)})}))},getActualHeight:function(e){var t=$.Deferred(),i=0;if($(e).is(":visible"))i=$(e).outerHeight(!0),t.resolve(i);else{var o=$(e).hasClass("hidden");$(e).css({position:"fixed",top:"-10000px",right:"0",left:"0"}).show(0),o&&$(e).removeClass("hidden"),setTimeout(function(){i=$(e).outerHeight(!0),$(e).css({position:"static",top:"inherit",right:"inherit",left:"inherit"}).hide(),o&&$(e).addClass("hidden"),t.resolve(i)},500)}return t.promise()},announcementAddAndShow:function(e){if(!$("#template_selector:visible").length&&!window.AppMemorial_config.is_tpl_default&&(!$("#renew-hint-content").length||$("#renew-hint-content").hasClass("hidden"))&&!$("#announcement-container .announcement-wrapper").length){var t=$(e.content);if("new_theme"==e.type)$(e.content).find(".new-theme").data("theme-name")==AppMemorial_config.current_tpl&&(t.find(".new-theme").addClass("disabled"),t.find(".previous-theme").removeClass("hidden"));else if("holiday_theme"==e.type){var i=$(e.content).find(".new-theme").data("theme-name");AppMemorial_config.holiday_tpl&&i==AppMemorial_config.holiday_tpl&&(t.find(".new-theme").addClass("disabled"),t.find(".previous-theme").removeClass("hidden"))}$("body #announcement-container").length?(this.$container=$("body #announcement-container"),this.$container.html(t)):(this.$container=$('<div id="announcement-container" ></div>').hide(),this.$container.html(t),$("body section.head").prepend(this.$container)),this.$container.removeAttr("class").addClass(e.type),this.initAnnouncement(),this.showAnnouncement()}}},me.asideSlideshow={container:"#aside_slideshow .photo",slides:[],pos:null,slidesInterval:5e3,fadeTime:700,changeSlideTimer:null,loadNextPageThreshold:5,isPagesEnded:0,paused:0,slidesFetchShift:0,loadedImagesStack:[],loadedImagesStackLength:4,$link:null,$photo:null};var s=me.asideSlideshow;s.changeSlide=function(){if(!s.paused)if(s.prepareSlide()){var e=s.slides[s.pos];s.$photo.fadeOut(700,function(){s.$photo.css("background-image","url("+e.url+")"),s.$link.attr("title",e.title).data("oid",e.id),e=null,s.$photo.fadeIn(700,function(){s.changeSlideRunTimer()})})}else $("#aside_slideshow").fadeOut()},s.changeSlideRunTimer=function(){if(!(s.paused||s.slides.length<2)){var e=s.pos;if((e+=1)>=s.slides.length&&(e=0),s.slides[e]){s.slides[e].loaded=!1;var t=imgPreload.preloadImage(s.slides[e].url);$(t).one("load",function(){s.slides[e].loaded=!0}),s.changeSlideTimer=setTimeout(s.changeSlide,s.slidesInterval)}}},s.loadSlides=function(e,t){typeof t===ud&&(t=s.slides.length),$.ajax({type:"post",url:window.AppMemorial_config.baseUrl+"gallery/next-slides-aside",data:{offset:t},timeout:s.slidesInterval,dataType:"json"}).done(function(t){if(typeof t===ud||typeof t.success===ud||!t.success)throw"Wrong server response";t.slides.length?s.slides=s.slides.concat(t.slides):s.isPagesEnded=1,"function"==typeof e&&e()}).fail(function(){throw"Loading slideshow page failed [offset:"+s.slides.length+"]"})},s.prepareSlide=function(){return!!s.slides.length&&(s.pos+=1,s.pos>=s.slides.length&&(s.pos=0),s.pos>1&&!s.isPagesEnded&&window.AppMemorial_config.slideshowMore&&s.slides.length-s.pos<s.loadNextPageThreshold&&s.loadSlides(),!0)},s.removeSlide=function(e){$.each(s.slides,function(t,i){if(i.id==e)return s.slides.splice(t,1),(s.pos==t||s.pos>s.slides.length)&&(clearTimeout(s.changeSlideTimer),s.prepareSlide(),s.changeSlide()),!1})},s.slideChanged=function(e,t){$.each(s.slides,function(i,o){if(o.id==e)return s.slides[i].url=t,s.$photo.hasClass("story")?s.$photo.find(".story-img").css("background-image","url("+t+")"):s.$photo.css("background-image","url("+t+")"),!1})},s.isNeedReloadAsideBlock=function(){return me.asideSlideshow.slides.length<=1},s.removeSlide=function(e){$("#aside_slideshow [data-oid="+e+"]").remove()},auth.open=function(e,t){if($(".login-modal").data("bs.modal")||{}.isShown)return!1;$.post("/auth/login-modal",function(i){null!==auth.$modalHandler&&auth.close(),auth.destroyAuthEvents(auth.$modalHandler),auth.$modalHandler=popup.extended({title:Lang.SING_IN,iconClass:"fmi-login",message:i,className:"login-modal extra-wide-dialog full-height",onEscape:function(){"function"==typeof t&&t(),auth.close()}}).on("shown.bs.modal",function(){$(window).width()>=_MOBILE_&&$("input:visible",auth.$modalHandler).first().focus(),auth.bindAuthEvents(auth.$modalHandler),globalLoader.hideGlobalLoader(),"function"==typeof e&&e()}).on("hidden.bs.modal",function(){"function"==typeof t&&t(),"function"==typeof me.checkPrivacy&&me.checkPrivacy(),"function"==typeof me.isExpired&&me.isExpired(),void 0!==meRouter&&meRouter.unSetCurrentHashAction(),auth.close()})},"html").fail(function(){popup.error(Lang.ERROR_UNKNOWN)})},auth.close=function(e){auth.destroyAuthEvents(auth.$modalHandler),auth.$modalHandler&&auth.$modalHandler.modal("hide"),void 0!==e&&me.getCheckState(),auth.$modalHandler=null},jQuery.extend(bgplayer,{player:{},topSoundBtn:{},playing:!0,pausedByVideo:!1,disableKey:"disableBG",topBtnClasses:{0:"off",1:"on",2:"none",3:"off disabled-by-browser"},playerStates:{true:"play",false:"pause"},init:function(){this.mustInit()&&(this.bindClickOnTopBtn(),this.initPlayer())},mustInit:function(){return!(this.player instanceof Audio)},initPlayer:function(){this.player=new Audio,bgplayer.emptyPlayList()||bgplayer.updateIcon(!1),this.player.addEventListener("ended",bgplayer.playNextSong),this.player.addEventListener("play",function(){bgplayer.updateIcon(!0)}),this.player.addEventListener("pause",function(){bgplayer.updateIcon(!1)}),this.playNextSong()},playNextSong:function(e){bgplayer.pausedByVideo||(bgplayer.pause(),bgplayer.emptyPlayList()||(bgplayer.setNextSong(),(void 0===e||e)&&bgplayer.play()))},setNextSong:function(){var e=window.AppMemorial_config.songs_playlist,t=Boolean(parseInt(window.AppMemorial_config.songs_shuffle)),i={true:function(){var t=[],i=[];$("#top_snd_btn").attr("data-finished-songs")&&(t=$("#top_snd_btn").attr("data-finished-songs").split(",")),t.length===e.length&&(t=[]),$.each(e,function(e){i.push(e.toString())});var o=i.filter(function(e){return-1==t.indexOf(e)}),n=o[Math.floor(Math.random()*o.length)];return t.push(n),$("#top_snd_btn").attr("data-finished-songs",t.join()),n},false:function(){var t=bgplayer.getCurrentIndex()+1;return t==e.length&&(t=0),t}};this.player.src=e[i[t]()]},getCurrentIndex:function(){var e=mediaPlayer.prepareLink(this.player.src);return!!window.AppMemorial_config.songs_playlist&&window.AppMemorial_config.songs_playlist.indexOf(e)},updateIcon:function(e){e*=1,this.topSoundBtn.removeClass("on off none disabled-by-browser"),bgplayer.emptyPlayList()&&(e=2);var t=this.topBtnClasses[e];this.topSoundBtn.addClass(t),this.hideIcon()},emptyPlayList:function(){var e=window.AppMemorial_config.songs_playlist;return!e||e.length<1},pauseVideo:function(){bgplayer.pausedByVideo||(bgplayer.pausedByVideo=bgplayer.isPlaying(),bgplayer.pause())},playVideo:function(){bgplayer.pausedByVideo&&(bgplayer.pausedByVideo=!1,bgplayer.play())},play:function(){this.toggle(!0)},pause:function(){this.toggle(!1)},toggle:function(e){if(this.mustInit())this.init();else if(mediaPlayer.isPlaying()&&e&&mediaPlayer.stop(),(this.pausedByVideo||bgplayer.emptyPlayList()||localStorage.getItem(bgplayer.disableKey))&&(e=!1,bgplayer.updateIcon(!1)),!this.isPlaying()||!e){this.playing=e;var t=this.playerStates[e];e&&!this.player.src&&this.setNextSong();var i=this.player[t]();e&&void 0!==i&&i.then(function(){}).catch(function(e){cancelCallback=function(){bgplayer.pause(),bgplayer.toggleState(!1),setTimeout(function(){let e=_IS_MOBILE_&&!meRouter.isAboutPage();introSteps.showStep("bg_music",e)},500)},popup.confirm(Lang.BG_PLAYER_PLAYBACK_FAILED_DIALOG,function(){bgplayer.play()},cancelCallback,null,cancelCallback,{ok:Lang.BG_PLAYBACK_PLAY_MUSIC,cancel:Lang.BG_PLAYBACK_MUTE})})}},bindClickOnTopBtn:function(){this.topSoundBtn=$("#top_snd_btn, #top_mob_snd_btn"),this.topSoundBtn.click(function(e){if(!$(".show-confirm-changes-dialog").length)if(e.target.className&&"fmi-close-lg"==e.target.className&&bgplayer.topSoundBtn.hasClass("disabled-by-browser"))bgplayer.topSoundBtn.removeClass("disabled-by-browser");else if(bgplayer.topSoundBtn.hasClass("none"))$("#menu_memorial #memorial-admin-menu").length>0&&me.loadAndGotToBlock($("<div/>").attr("data-ajax-url","/bg-music"),function(){meRouter.setScrollAnchor("playlist-selector")});else{var t=bgplayer.notPlaying();bgplayer.toggleState(t),bgplayer.toggle(t)}})},save:function(){me.sortable_reindex($("#playlist-selector .songs").find(".song-wrapper")),me.pageBackgroundMusic.save(playlistSort.playlistFetch())},delete:function(e){var t=window.AppMemorial_config.songs_playlist,i=t[this.getCurrentIndex()],o=mediaPlayer.isPlaying()||bgplayer.isPlaying();(i=mediaPlayer.prepareLink(i))!=(e=mediaPlayer.prepareLink(e))&&void 0!==i||(1==t.length&&(window.AppMemorial_config.songs_playlist=[]),bgplayer.playNextSong(o))},isPlaying:function(){return!this.notPlaying()},notPlaying:function(){return this.player.paused},toggleState:function(e){e?localStorage.removeItem(bgplayer.disableKey):localStorage.setItem(bgplayer.disableKey,1)},hideIcon:function(){var e=$("#top_snd_btn, #top_mob_snd_btn");0==$("#menu_memorial #memorial-admin-menu").length&&e.hasClass("none")?e.hide():e.show()}}),me.circleButton={defaultText:Lang.BUTTON_CIRCLE_TEXT_CONTRIBUTE,wrapper:"#circle-round-button-wrapper",button:"#circle-round-button",defaultIconClass:"fmi-pen",initialize:function(e,t,i){return this.unSetActionUrl(),this.setButtonIcon(t),this.setActionUrl(e),this.setButtonText(i),this.initScrollCheck(),$(this.button).off().click(function(){return me.circleButton.runAction($(this)),!1}),this.show(),this},clickFunction:function(e){"function"==typeof e&&$(this.button).on("click",function(){e()})},destroy:function(){return this.hide(),$(this.button).removeAttr("data-ajax-url").removeAttr("data-action-url").off(),this},setAjaxUrl:function(e){$(this.button).attr("data-ajax-url",e)},setActionUrl:function(e){e!=un&&$(this.button).attr("data-action-url",e)},unSetActionUrl:function(){$(this.button).removeAttr("data-action-url")},setButtonIcon:function(e){e!=un?$(this.button).find("i").attr("class",e):$(this.button).find("i").attr("class",this.defaultIconClass)},setButtonText:function(e){e!=un?$(this.button).find("span").text(e):$(this.button).find("span").text(this.defaultText)},getButtonTextWidth:function(){return $tempObj=$(this.wrapper).clone(),$tempObj.addClass("temp-round-button").css("opacity",0).show(),$("body").append($tempObj),buttonTxtWidth=$(".temp-round-button").find("#btn-text").addClass("text-visible").width(),$(".temp-round-button").remove(),buttonTxtWidth},initScrollCheck:function(){$(window).off("scroll.btn-text");let e=$(window).scrollTop(),t="up";$btntext=$("#btn-text"),$btntext.removeAttr("style class");let i=me.circleButton.getButtonTextWidth();$(window).on("scroll.btn-text",function(){if($("body").hasClass("modal-open"))return;let o=$(window).scrollTop(),n=o>e?"down":"up";let a=$(document).height()-($(window).height()+o),r=function(){$btntext.removeClass("text-visible").addClass("text-hidden"),$btntext.css("width",0)},s=function(){$btntext.removeClass("text-hidden").addClass("text-visible"),$btntext.css("width",i+"px")};o>0&&a>0?"down"===n&&o>10?r():s():0===o?s():0===a&&r(),e=o,t=n})},hide:function(){$(this.wrapper).hide("slow")},show:function(){$(this.wrapper).show("slow")},runAction:function(e){meRouter.runAction(e)||e.attr("data-ajax-url")&&me.loadAndGotToBlock(e)}},me.contact={modalHandler:null},me.contact.comeBackToSlide=function(){meRouter.getCurrentAnchorAction().indexOf("gallery|photo")>-1&&meRouter.goToHashAction()},me.contact.modal=function(e,t){me.contact.modalHandler=popup.extended({className:"dialog-contact full-height",title:e.title,iconClass:"fmi-mail-icon-2",message:e.page,buttons:{send:{label:Lang.SEND,className:"btn button large-center-mobile",callback:function(){return $("form",me.contact.modalHandler).submit(),!1}}},onEscape:function(){"function"==typeof me.isExpired&&me.isExpired(),"function"==typeof me.checkPrivacy&&me.checkPrivacy(),"function"==typeof t&&t()},onClose:function(){"function"==typeof me.isExpired&&me.isExpired(),"function"==typeof me.checkPrivacy&&me.checkPrivacy(),"function"==typeof t&&t()}}).on("hidden.bs.modal",function(){});var i=$("form",me.contact.modalHandler);return me.addFormValidate($("form",me.contact.modalHandler)),me.contact.modalHandler.find(".fmi-close").click(function(){me.contact.comeBackToSlide()}),i},me.contact.open=function(e,t,i,o,n){i=i||!1;var a={};if(typeof t!==ud&&null!==t){"number"==typeof t&&(t=[t]);var r=t.join(",");a.subscribers=r}else if(typeof e!==ud&&null!==e){"number"==typeof e&&(e=[e]);var s=e.join(",");a.uids=s}else{if(!i)throw"Logic error [.contact.open]";a.lastAdmin=!0}$.post(window.AppMemorial_config.baseUrl+"contact/",a,function(e){if(globalLoader.hideGlobalLoader(),App.ajaxError(e))return!1===e.success&&(meRouter.unSetCurrentHashAction(),me.isExpired()),void(e.message&&popup.error(e.message));if(1===e.success){var t=me.contact.modal(e,n);t.submit(function(){var e=$(me.contact.modalHandler);if(!t.lockCheck())return t.lockOn(),e.addLoaderLayout(),$(me.contact.modalHandler).modal("hide"),meRouter.unSetCurrentHashAction(),globalLoader.showGlobalLoader(),$.post(window.AppMemorial_config.baseUrl+"contact/send",t.serialize(),function(e){if(e.hasOwnProperty("error"))return jsLogger.showInternalError("j57001",e),void $(me.contact.modalHandler).modal("show");globalLoader.hideGlobalLoader(),typeof e.sent!==ud&&(i?me.showSuccessContactModal(e.message):(popup.flash(Lang.CONTACT_MESSAGE_SENT,"success"),"function"==typeof o&&o()))},"JSON").fail(function(e){jsLogger.showAjaxFail("j57002",e)}).always(function(){t.lockOff(),e.deleteLoaderLayout(),me.contact.comeBackToSlide()}),!1})}},"json").fail(function(e){jsLogger.showAjaxFail("j57003",e)})},me.contact.owner=function(){$.ajax({url:window.AppMemorial_config.baseUrl+"contact/owner",type:"POST",success:function(e){if(!0===e.success){globalLoader.hideGlobalLoader();var t=me.contact.modal(e);t.submit(function(){globalLoader.showGlobalLoader(),meRouter.unSetCurrentHashAction(),t.lockOn();var e=$(this).find("textarea").val();return $.ajax({url:window.AppMemorial_config.baseUrl+"contact/send_owner",type:"POST",data:{message:e},success:function(e){globalLoader.hideGlobalLoader(),!0===e.success?($(me.contact.modalHandler).modal("hide"),me.showSuccessContactModal(e.message)):jsLogger.showInternalError("j57001",e)}}),!1})}else meRouter.unSetCurrentHashAction()}})},me.contact.user=function(e){$.ajax({url:window.AppMemorial_config.baseUrl+"contact/user",type:"POST",data:{acctId:e},success:function(t){if(!0===t.success){globalLoader.hideGlobalLoader();var i=me.contact.modal(t);i.submit(function(){globalLoader.showGlobalLoader(),meRouter.unSetCurrentHashAction(),i.lockOn();var t=$(this).find("textarea").val();return $.ajax({url:window.AppMemorial_config.baseUrl+"contact/send-user",type:"POST",data:{message:t,acctId:e},success:function(e){globalLoader.hideGlobalLoader(),!0===e.success&&($(me.contact.modalHandler).modal("hide"),popup.flash(Lang.CONTACT_MESSAGE_SENT,"success"))}}),!1})}else meRouter.unSetCurrentHashAction()}})};var ci=me.contactsImport={msgUnknownProvider:"Sorry, cannot find your email provider.",domainKey:null,inviteWindow:null,basePopupFunction:null,fnArguments:[],$settingsRow:null,approveCode:null,type:""};ci.load=function(){if(typeof window.cloudsponge!==ud)return $.when(1);var e=$.Deferred(),t=$.ajax({url:window.AppMemorial_config.baseUrl+"cloudsponge/get-key",dataType:"json"}).done(function(t){if(!App.ajaxError(t)){var i=t.key;window.csPageOptions={domain_key:i,afterInit:function(){e.resolve()}};var o=document.createElement("script");o.src="https://api.cloudsponge.com/address_books.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n),me.addFormValidate($(".invite-settings-form"))}});return $.when(e,t)},ci.runImport=function(e){var t=$.Deferred();return typeof window.cloudsponge===ud?(ci.load(),t.reject(),t):(window.cloudsponge.init({localeData:cloudSpongeTranslations,afterClosing:function(e,i,o){t.reject()},afterSubmitContacts:function(e,i,o){var n=[];$.each(e,function(e,t){if(!(t.email.length<1)){var i=t.email[0].address;$.each(t.email,function(e,t){t.selected&&(i=t.address)}),n.push({email:i,first_name:t.first_name,last_name:t.last_name})}}),t.resolve(n,e)}}),window.cloudsponge.launch(e),t)},ci.initServices=function(e,t){$(e,t).click(function(){var e=$(this);if(!e.lockCheck()){e.lockOn().addLoaderLayout();var t=e.data("source");ci.runImport(t).done(function(e,t,i){$.each(e,function(e,t){var i={email:t.email,firstName:t.first_name,lastName:t.last_name};ci.addTableRow(i)}),ci.syncTable()}).always(function(){e.deleteLoaderLayout().lockOff()})}})},ci.initManualAdd=function(e,t){var i=$(e,t);me.addFormValidate(i),i.submit(function(){return ci.addRowManually(),!1})},ci.initAddressBlock=function(e){var t=$(".address-book .services",e);t.addLoaderLayout(),ci.load().done(function(){t.css({opacity:1}).deleteLoaderLayout(),e.removeAttr("tabindex")}).fail(function(){t.css({opacity:.2}).deleteLoaderLayout()})},ci.initContactsImportBlock=function(e,t,i,o){ci.type=e,typeof i!==ud&&(ci.basePopupFunction=i),typeof o!==ud&&(ci.fnArguments=o),$("tr.invite-contacts",t).length&&$("tr.empty",t).addClass("hidden"),$(window).width()>_MOBILE_&&(ci.initAddressBlock(t),ci.initServices(".address-book .services a",t)),ci.initManualAdd(".manual-add form",t),ci.initTable(t,function(){ci.syncTable()})},ci.initTable=function(e,t){ci.inviteWindow=e,initedKey="datatable_inited";var i=$(".dialog.visitors-table table");if(ci.$settingsRow=$(".dialog.visitors-table tr.settings"),e.data(initedKey))return!1;ci.initTableSettingsAction(i),ci.initTableTrash(e),ci.initSortableHead(e),$(".dialog.visitors-table th.email").trigger("click"),"function"==typeof t&&t(),e.data(initedKey,1)},ci.hideSettingsRow=function(){$(".wrapper",ci.$settingsRow).removeClass("shown").removeClass("open"),ci.$settingsRow.hide()},ci.showSettingsRow=function(e){var t=$(".wrapper",ci.$settingsRow);if(t.hasClass("open"))return t.removeClass("shown").removeClass("open"),void ci.showSettingsRow(e);e.next()&&e.next().hasClass("settings")||ci.$settingsRow.insertAfter(e),ci.$settingsRow.show(0,function(){t.addClass("open").addClass("shown"),ci.invitees_fillSettings(),ci.initSettingsRowActions()})},ci.invitees_fillSettings=function(){$.each(["name","email"],function(e,t){var i=ci.$settingsRow.prev();if(i.attr("data-acct-id")?$(".edit-buttons",ci.$settingsRow).hide():$(".edit-buttons",ci.$settingsRow).show(),"name"==t){if($("#f_name, #l_name",ci.$settingsRow).val(),$(".first-name .val, .last-name .val",ci.$settingsRow).text("-"),i.attr("data-fname")){var o=i.attr("data-fname");$(".first-name .val",ci.$settingsRow).text(o),$("#f_name",ci.$settingsRow).val(o)}if(i.attr("data-lname")){var n=i.attr("data-lname");$(".last-name .val",ci.$settingsRow).text(n),$("#l_name",ci.$settingsRow).val(n)}}if("email"==t){var a=i.attr("data-email").trim().toLowerCase();$(".email .val",ci.$settingsRow).text(a),$("#email",ci.$settingsRow).val(a)}})},ci.initSettingsRowActions=function(){$(".edit",ci.$settingsRow).click(function(){($(".help-block.form-error").remove(),ci.settingsRowShowSaveButtons(this),_IS_MOBILE_)&&$(this).parents(".edit-block-wrapper").prev().prev().hide()}),$(".cancel",ci.$settingsRow).click(function(){var e=$(this).parents(".edit-block-wrapper"),t=e.prev().text().trim();"-"==t&&(t=""),$("input",e).val(t),ci.settingsRowShowEditButtons(e),_IS_MOBILE_&&e.prev().prev().show()}),$(".save",ci.$settingsRow).click(function(){var e=this;$(".invite-settings-form").off("submit").on("submit",function(t){(t.preventDefault(),ci.updateRowData(e),_IS_MOBILE_)&&$(e).parents(".edit-block-wrapper").prev().prev().show();return!1}),$(".invite-settings-form").submit()})},ci.settingsRowShowSaveButtons=function(e){var t=$(e).parents(".edit-block-wrapper");$(".save, .cancel, input, .input-wrapper",t).show(),$(".edit",t).hide(),t.prev().hide()},ci.settingsRowShowEditButtons=function(e){$(".save, .cancel, input, .input-wrapper",e).hide(),$(".edit",e).show(),e.prev().show()},ci.updateRowData=function(e){var t=$(e).parents(".edit-block-wrapper"),i=$("input",t),o=i.val().trim();if(o){var n=ci.$settingsRow.prev(),a=i.attr("id").replace(new RegExp("_","g"),"");"email"===a&&n.attr("data-previous-email",n.attr("data-email")),n.attr("data-"+a,o),t.prev().text(o),ci.syncTable()}ci.settingsRowShowEditButtons(t)},ci.syncTable=function(e,t){var i=$(".dialog.visitors-table .table",ci.inviteWindow);if(i.lockCheck())"function"==typeof t&&t();else{i.lockOn().addLoaderLayout();var o=$("tr.invite-contacts",i),n=[];$.each(o,function(e,t){var i={email:$(t).attr("data-email").toLowerCase(),actionType:ci.type,first_name:$(t).attr("data-fname"),last_name:$(t).attr("data-lname"),previous_email:$(t).attr("data-previous-email")};n.push(i)}),$.post(window.AppMemorial_config.baseUrl+"invite/sync",{contacts:n,approveCode:ci.approveCode},"json").done(function(t){if(ci.approveCode=null,o.addClass("unsync"),typeof t.list!==ud){var n=[];$.each(t.list,function(e,t){var o={email:t.email,firstName:t.first_name,lastName:t.last_name};if((typeof t.acct_id!==ud&&t.acct_id&&(o.acctId=t.acct_id),"invite"==ci.type)&&(typeof t.id!==ud&&t.id&&"blocked"!=t.permissions&&!$("[data-email='"+t.email+"']",i).hasClass("re-invite")&&0==confirm(Lang.INVITE_ALREADY_INVITED_HAVE_EMAIL.format(t.email)))){var a=$("[data-email='"+t.email+"']",i);return n.push(a),!0}var r=!1;$("[data-email='"+t.email.trim()+"']",i).length&&(r=!0),ci.addTableRow(o,r),$("[data-email='"+t.email.trim()+"']",i).removeClass("unsync").removeAttr("data-previous-email"),t.id&&$("[data-email='"+t.email.trim()+"']",i).addClass("re-invite")}),n&&ci.bulkRemoveRows(n,!1,i)}$(".invite-contacts .unsync",i).length&&console.error("sync error exist unsync rows"),"function"==typeof e&&e(t)}).fail(function(e){jsLogger.showAjaxFail("j58001",e)}).always(function(){i.deleteLoaderLayout().lockOff()})}},ci.initTableSettingsAction=function(e){e.on("click","tbody .open-settings-link",function(e){var t=$(this).closest("tr");return ci.$settingsRow.closest(".visitors-table").find(".close-settings-link").click(),t.next()&&t.next().find(".wrapper.open").length||(ci.showSettingsRow(t),t.css({display:"none"})),!1}),e.on("click","tbody .close-settings-link",function(e){return ci.hideSettingsRow(),$(this).closest("tr").prev().css({display:"table-row"}),!1})},ci.initSortableHead=function(e){e.on("click","table th.sortable",function(){ci.hideSettingsRow(),$("table th.sortable i").addClass("hidden");var e=$(this),t=e.parents("table").eq(0),i=t.find("tr:gt(0)").toArray().sort(ci.comparer($(this).index()));$(".invite-contacts").css({display:"table-row"}),e.find("i."+e.attr("data-order-dir")).removeClass("hidden"),"desc"==e.attr("data-order-dir")&&(i=i.reverse()),"asc"==e.attr("data-order-dir")?e.attr("data-order-dir","desc"):e.attr("data-order-dir","asc");for(var o=0;o<i.length;o++)t.append(i[o])})},ci.comparer=function(e){return function(t,i){var o=ci.getCellValue(t,e),n=ci.getCellValue(i,e);return $.isNumeric(o)&&$.isNumeric(n)?o-n:o.localeCompare(n)}},ci.getCellValue=function(e,t){return $(e).children("td").eq(t).text()},ci.initTableTrash=function(e){e.on("click","table .delete-invitee",function(){var t=ci.$settingsRow.prev();if(t.data("email"))var i=t.data("email");else{i=$(this).parent().parent().find(".email-row").text();t.attr("data-email",i.trim())}popup.confirm(Lang.DELETE_INVITEE_CONFIRMATION_MESSAGE.replace("{email}",i),function(){ci.removeRow(t,!0,e)},function(){ci.openPreviousPopup()})})},ci.addRowManually=function(){var e=$(".manual-add form",ci.inviteWindow);e.lockCheck()||(e.lockOn(),$(".no-contacts",ci.inviteWindow).detach(),setTimeout(function(){var t=$("#invite_email"),i=t.val(),o=$("#first_name").val();if($("[data-email='"+i.trim()+"']",ci.inviteWindow).length)return popup.error(Lang.CONTACT_ALREADY_EXIST),void e.lockOff();var n={email:i,firstName:o||""};ci.addTableRow(n),ci.syncTable(function(o){var n=!1;typeof o.errorContacts!==ud&&$.each(o.errorContacts,function(e,t){if(t.email==i&&typeof t.error!==ud)return n=t.error,!1}),n&&jsLogger.showErrorResponse("j58002",o),t.val(""),$("#first_name").val(""),e.lockOff()},function(){e.lockOff()})},1))},ci.addTableRow=function(e,t){var i=$(".dialog.visitors-table .table"),o={};t==un&&(t=!1);var n=$.extend({email:"",firstName:"",lastName:"",acctId:""},e);n.email=n.email.toLowerCase(),(o=1==t?$("[data-email='"+n.email.trim()+"']",i):$(".invite-contacts-template",i).clone()).removeClass("hidden invite-contacts-template").addClass("invite-contacts").attr("data-email",n.email.trim()).attr("data-fname",n.firstName).attr("data-lname",n.lastName),o.find(".email").html('<div class="email-row">'+n.email.trim()+'</div><div class="email-mobile">'+n.firstName+"</div>"),o.find(".name").text(n.firstName+" "+n.lastName),n.acctId.length&&o.attr("data-acct-id",n.acctId);o.find(".actions").html('<a href="javascript:void(0)" class="delete-invitee fmi-close-lg"></a><a href="javascript:void(0)" class="open-settings-link fmi-arrow-down3"></a>'),0==t&&($("tbody",i).first().append(o),$(".empty",i).addClass("hidden"))},ci.removeRow=function(e,t,i){if(!e.lockCheck()){e.lockOn();var o=e.data("email").trim();e.addLoaderLayout(),o.length&&$.post(window.AppMemorial_config.baseUrl+"invite/delete",{email:o},"json").done(function(o){App.ajaxError(o)&&(jsLogger.showErrorResponse("j58003",o),t&&ci.openPreviousPopup()),ci.hideSettingsRow(),e.remove(),$("tr.invite-contacts",i).length||$("tr.empty",i).removeClass("hidden"),t&&ci.openPreviousPopup()}).fail(function(e){jsLogger.showAjaxFail("j58004",e)}).always(function(){e.lockOff(),e.deleteLoaderLayout()})}},ci.bulkRemoveRows=function(e,t,i){var o=[];$.each(e,function(e,t){o.push(t.data("email"))}),(o=o.join(",")).length&&$.post(window.AppMemorial_config.baseUrl+"invite/bulk-delete",{emails:o},"json").done(function(o){App.ajaxError(o)&&(jsLogger.showErrorResponse("j58003",o),t&&ci.openPreviousPopup()),ci.hideSettingsRow(),ci.$settingsRow.closest(".visitors-table").find(".close-settings-link").click(),$.each(e,function(e,t){t.remove()}),$("tr.invite-contacts",i).length||$("tr.empty",i).removeClass("hidden"),t&&ci.openPreviousPopup()}).fail(function(e){jsLogger.showAjaxFail("j58004",e)})},ci.openPreviousPopup=function(){if(null!=ci.basePopupFunction)if(ci.fnHasArguments()){var e=Array.prototype.slice.call(ci.fnArguments);ci.basePopupFunction.apply(null,e)}else ci.basePopupFunction()},ci.fnHasArguments=function(){return ci.fnArguments.length},me.editAlbum={contentUrl:"",saveUrl:"",galleryType:"",sortingEnabled:!0,init:function(e,t){return loadedObjects.push("editAlbum"),console.log("editAlbum - loaded"),StickyBar.prototype.show(),this.galleryType=meRouter.isCurrentRoute("photos")?"photos":"videos",this.contentUrl=window.AppMemorial_config.baseUrl+"gallery-edit/"+this.galleryType,this.saveUrl=window.AppMemorial_config.baseUrl+"gallery-edit/"+this.galleryType+"-post",this.route="/gallery-edit/"+this.galleryType,this.removeItem(),this.openSlideShow(),this.contactAuthor(),this.setCoverPhoto(),this.removeCoverPhoto(),this.prevNextSort(),this.firstLastSort(),this.changeOrdering(),this.sortableGallery(),this.forwardToGallery(),this.saveChangesAfterReorder(),this.checkActivateSaveButton(),this.observerChangedItemOption(),this.initCheckForUnsaveChanges(),contentPagination.init({scrollAfterPagination:"#content"}),"videos"===this.galleryType&&me.pageGalleryVideos.checkConverted(),me.on("click","#page-gallery-edit-"+me.editAlbum.galleryType+" .no-image-error",function(){return me.showContactUs($(this)),!1}),this.afterLoad(e)},reload:function(e){this.removeItem(),this.openSlideShow(),this.contactAuthor(),this.setCoverPhoto(),this.removeCoverPhoto(),this.prevNextSort(),this.firstLastSort(),this.changeOrdering(),this.sortableGallery(),this.forwardToGallery(),this.saveChangesAfterReorder(),this.checkActivateSaveButton(),this.observerChangedItemOption(),this.initCheckForUnsaveChanges(),contentPagination.init({scrollAfterPagination:"#content"}),this.galleryType=meRouter.isCurrentRoute("photos")?"photos":"videos",this.contentUrl=window.AppMemorial_config.baseUrl+"gallery-edit/"+this.galleryType,this.saveUrl=window.AppMemorial_config.baseUrl+"gallery-edit/"+this.galleryType+"-post",this.route="/gallery-edit/"+this.galleryType,"function"==typeof e&&e()},afterLoad:function(e){return e&&e(),!1},getSortList:function(){return JSON.parse($("#all_items").text())},setDeletedToSortList:function(e){let t=me.editAlbum.getSortList();t.forEach(function(t){if(t){parseInt(t.id)===parseInt(e)&&(t.is_deleted=1)}}),me.editAlbum.saveNewSortList(JSON.stringify(t))},saveNewSortList:function(e){$("#all_items").html(e)},getNewSortList:function(){var e=me.editAlbum.getSortList().reverse();return e=me.sortableAddNewOrderingToList(e),e=(e=me.sortableGalleryItems(e)).reverse(),e=me.insertReOrderingElementToList(e),e=me.ReOrderingGalleryItems(e)},updateCoverPhoto:function(e){let t=!1;$.each($(".items.bootstrap item:visible"),function(i,o){let n=$(o);if(n.find('[name="is_main"]:checked').length){let i=$('[value="'+n.attr("data-oid")+'"].set-remove:checkbox:checked').length,o=parseInt(n.attr("data-oid"));i||o===window.AppMemorial_config.idMainPhotoMemorial||(me.pageGalleryPhotos.galleryPhotos_coverChange(n,window.AppMemorial_config.status_main_photo.main,e),t=!0)}}),t||"function"==typeof e&&e()},observerChangedItemOption:function(){$('input[name="is_main"], input.set-remove').on("change",function(){StickyBar.prototype.enabledChangeGallery(),me.editAlbum.paginationDeactivation()})},saveChangesAfterReorder:function(){$(".save-changed-gallery").on("click",function(){me.editAlbum.checkRemoveCoverPhoto(function(){globalLoader.showGlobalLoader(!1,!0),$(".list-items , #sticky_bar").removeClass("show-confirm-changes-dialog"),me.editAlbum.requestSaveGallery(function(){me.loadBlock("slideshow"),popup.success(Lang.EDIT_GALLERY_CHANGES_SAVED)})})})},requestSaveGallery:function(e){globalLoader.showGlobalLoader(3e4),StickyBar.prototype.disabledChangeGallery();let t=me.editAlbum.getNewSortList();me.sortGalleryEditCallback(t,!0,function(){StickyBar.prototype.enabledChangeGallery()},function(){"function"==typeof e&&e()})},checkActivateSaveButton:function(){$("#content").on("input",".details textarea, .details input",function(){StickyBar.prototype.enabledChangeGallery(),me.editAlbum.paginationDeactivation()})},paginationDeactivation:function(){$(".list-items , #sticky_bar").addClass("show-confirm-changes-dialog"),$(".dropdown").children().addClass("exclude-from-transition")},initCheckForUnsaveChanges:function(){$("header, aside, #pagination_block, #sticky_bar").on("click","[href], [data-action-url], [data-ajax-url], .cancel-changed-gallery",function(){if($(".list-items , #sticky_bar").hasClass("show-confirm-changes-dialog")&&!$(this).hasClass("exclude-from-transition")){$(".list-items , #sticky_bar").removeClass("show-confirm-changes-dialog"),$(".dropdown").children().removeClass("exclude-from-transition"),$el=$(this);let e=Lang.YOUR_CHANGES_HAVE_NOT_BEEN_SAVED;return popup.confirm(e,function(){globalLoader.showGlobalLoader(),me.editAlbum.requestSaveGallery(function(){StickyBar.prototype.disabledChangeGallery(),$el[0].click()})},function(){me.loadBlock("pageContent",function(){StickyBar.prototype.disabledChangeGallery(),$el[0].click()})},null,null,{ok:Lang.MG_SAVE,cancel:Lang.MG_DISCARD}),!1}})},removeItem:function(){$("#content").on("click",".action .remove-item",function(){let e=$(this).parents("item[data-oid]"),t=function(e,t){let i=e.data("oid");e.slideUp("slow",function(){e.detach(),me.editAlbum.setDeletedToSortList(i),me.sortGalleryReindex(),me.cleanAboutPageCache(),"function"==typeof t&&t(),$(".list-items item").length||me.loadBlock("pageContent")})};if("photos"===me.editAlbum.galleryType){var i=me.pageGalleryPhotos.getMessageForDelete(e);slideShowActions.currentSlide={},me.pageGallery_delete(i,e,me.deleteItemRequest,function(){t(e,function(){me.setAsideSlideshow(),me.loadBlock("slideshow")})})}else slideShowActions.currentSlide={},me.pageGallery_delete(Lang.YOU_ARE_ABOUT_TO_DELETE_VIDEO,e,me.deleteItemRequest,function(){t(e)})})},changeOrdering:function(){$("#content").on("keypress keyup blur",".orderingField",function(e){var t=$(this).parents("item[data-oid]").attr("data-slide-position");$(this).val($(this).val().replace(/[^\d].+/,"")),(e.which<48||e.which>57)&&e.preventDefault(),t!=$(this).val()&&(StickyBar.prototype.enabledChangeGallery(),me.editAlbum.paginationDeactivation())})},contactAuthor:function(){$("body").off("click.open_contact").on("click.open_contact","a[data-author-contact-id]",function(){if(auth.isSignedIn()){var e=$(this).data("author-contact-id"),t=$(this).data("action-url");me.contact.open(e,null,null,null,function(){meRouter.setHashAction(t)})}else auth.open();return!1})},setCoverPhoto:function(){$("#content").on("click",".action .set-cover-photo",function(){var e=$(this).parents("item[data-oid]");me.pageGalleryPhotos.galleryPhotos_coverChange(e,window.AppMemorial_config.status_main_photo.main,function(){popup.success(Lang.COVER_PICTURE_ADDED),e.find(".remove-cover-photo").removeClass("hidden"),e.find(".set-cover-photo").addClass("hidden"),_IS_MOBILE_&&meRouter.moveToAbout()})})},removeCoverPhoto:function(){$("#content").on("click",".action .remove-cover-photo",function(){var e=$(this).parents("item[data-oid]");me.pageGalleryPhotos.galleryPhotos_coverChange(e,window.AppMemorial_config.status_main_photo.simple,function(){popup.success(Lang.COVER_PICTURE_REMOVED),e.find(".remove-cover-photo").addClass("hidden"),e.find(".set-cover-photo").removeClass("hidden"),_IS_MOBILE_&&meRouter.moveToAbout()})})},openSlideShow:function(){$("#page-gallery-edit-photos, #page-gallery-edit-videos").off("click.slideShow").on("click.slideShow",".open-full-slide-show a, .action .open-full-slide, .preview img",function(){meRouter.unSetCurrentHashAction();var e=$(this).parents("item[data-oid]");"photos"===me.editAlbum.galleryType?(me.pageSlideShow.disableActions=!0,me.pageSlideShow.hideOptionStartSlideShow=!0,me.pageSlideShow.currentItemObj=e,me.pageSlideShow.init()):e.find("#status_video").hasClass("status-ok")&&(me.pageVideoView.disableActions=!0,me.pageVideoView.init(!1,$(this).parents("item[data-oid]")),meRouter.setHashAction($(this).parents("item[data-oid]").find(".slide-action").data("action-url")))})},isSortingEnabled:function(){return me.editAlbum.sortingEnabled},onSorting:function(){return me.editAlbum.sortingEnabled=!0},offSorting:function(){return me.editAlbum.sortingEnabled=!1},isCanSort:function(e,t){return t?$("item[data-oid]").first().attr("data-oid")!=e.attr("data-oid")||!$('item[data-oid="'+$(me.editAlbum.getSortList()).first()[0].id+'"]').length:$("item[data-oid]").last().attr("data-oid")!=e.attr("data-oid")||!$('item[data-oid="'+$(me.editAlbum.getSortList()).last()[0].id+'"]').length},firstLastSort:function(){$("#content").on("click",".start-end-sort a",function(){var e=$(this),t=e.parents("item[data-oid]"),i=e.hasClass("start-sort");if(!me.editAlbum.isSortingEnabled()||!me.editAlbum.isCanSort(t,i))return!1;globalLoader.showGlobalLoader(!1,!0);var o=0,n=0,a=$([]),r=e.parents(".item[data-oid]"),s=parseInt(r.css("margin-bottom")),l=function(){return t.addClass("hidden")};i?(a=$(".items").find("item").first(),n=t.attr("data-slide-position")-a.attr("data-slide-position"),o=0-r.outerHeight()*Math.abs(n)-s,$('item[data-oid="'+$(me.editAlbum.getSortList()).first()[0].id+'"]').length?l=function(){return t.insertBefore(a)}:t.find(".orderingField").val(1)):(a=$(".items").find("item[data-oid]").last(),n=t.attr("data-slide-position")-a.attr("data-slide-position"),o=r.outerHeight()*Math.abs(n)+s,$('item[data-oid="'+$(me.editAlbum.getSortList()).last()[0].id+'"]').length?l=function(){return t.insertAfter(a)}:t.find(".orderingField").val(me.editAlbum.getSortList().length+1)),o>window.innerHeight&&(o=window.innerHeight),me.editAlbum.offSorting(),me.sortable_animateChangePosition(t,o,300,function(){l(),me.sortGalleryReindex();var e=me.editAlbum.getNewSortList();me.sortGalleryEditCallback(e,!0,null,function(){me.editAlbum.onSorting(),globalLoader.hideGlobalLoader()})})})},getStartIndex:function(){return Number($("#start_index").val())},checkRemoveCoverPhoto:function(e){var t=me.getMainPhotoId(),i=!1;$.each($(".set-remove:checkbox:checked"),function(o,n){var a=$(n).val();if(t==a&&$('[name="is_main"][value="'+a+'"]').is(":checked"))return i=!0,popup.confirm(Lang.THIS_WILL_DELETE_MEMORIAL_COVER_PHOTO,function(){"function"==typeof e&&e()}),!1}),i||"function"!=typeof e||e()},getOrderingStart:function(){return Number($("#start_ordering").val())},prevNextSort:function(){$("#content").on("click",".prev-next-sort a",function(){var e=$(this),t=e.hasClass("move-up"),i=e.parents(".item[data-oid]");if(!me.editAlbum.isSortingEnabled()||!me.editAlbum.isCanSort(i,t))return!1;var o=$([]),n=e.parents("item[data-oid]"),a=(o=t?n.prevAll().first():n.nextAll().first()).find(".item[data-oid]").not(":hidden"),r=parseInt(i.css("margin-bottom"))+parseInt(n.find("hr").height());if(me.editAlbum.offSorting(),a.length)me.sortable_animateMove(i,a,t,function(){me.sortGalleryReindex();var e=me.editAlbum.getNewSortList();me.sortGalleryEditCallback(e,!1,function(){me.editAlbum.onSorting()},function(){me.editAlbum.onSorting()})},n,o,r);else{var s=me.editAlbum.getNewSortList();s=me.forceDataOrdering(s,i,t),me.sortGalleryEditCallback(s,!0,function(){me.editAlbum.onSorting()},function(){me.editAlbum.onSorting()})}})},sortableGallery:function(){let e=$("#content .items.bootstrap .list-items"),t=".ordering-icon";_IS_MOBILE_&&(t+=", .ordering"),e.data("sortable",new me.Sortable(e.get(0),{cursor:"move",handle:t,animation:350,forceFallback:!0,onStart:function(){$(".main-item:not(.sortable-fallback)").last().addClass("last-items"),$("body, img, textarea, input").addClass("cursor-move")},onChange:function(e){$(".last-items").removeClass("last-items"),$(".main-item:not(.sortable-fallback)").last().addClass("last-items")},onEnd:function(e){$("body, img, textarea, input").removeClass("cursor-move"),$(".last-items").removeClass("last-items")},onSort:function(e){if(me.sortGalleryReindex(),_IS_MOBILE_){var t=me.editAlbum.getNewSortList();me.sortGalleryEditCallback(t)}else StickyBar.prototype.enabledChangeGallery(),me.editAlbum.paginationDeactivation()}}))},replaceContent:function(e,t){if(e.find(".list-items").find("item"),$(".main-item.hidden").remove(),e.find(".list-items").find("item").length){let t=$(".set-remove:checkbox:checked").parents(".main-item"),i=$('.main-item [name="is_main"]:checked'),o=!1;i.length&&i.parents(".main-item").find(".set-remove:checkbox:checked").length&&(o=!0),t.remove(),o&&(me.loadBlock("titlePhoto"),me.loadBlock("mobileInnerPageTitlePhoto"));let n=null;i.length&&(n=i.val()),$.each(e.find(".list-items").find("item"),function(e,t){var i=$("item[data-oid]").eq(e),o=$(t);i.length?i.replaceWith(o):$(".list-items").append(o)}),n&&$('.main-item[data-oid="'+n+'"] [name="is_main"]').prop("checked",!0),me.editAlbum.saveNewSortList(e.find("#all_items").html()),$("#start_index").val(e.find("#start_index").val()),$("#start_ordering").val(e.find("#start_ordering").val()),$("#pagination_block").html(e.find("#pagination_block").html())}else me.loadBlock("titlePhoto"),me.loadBlock("mobileInnerPageTitlePhoto"),me.loadBlock("pageContent");"function"==typeof t&&t()},getContent:function(e,t,i){globalLoader.showGlobalLoader(),t||(t={});var o=window.AppMemorial_config.baseUrl.replace(/\/+$/,"");$.ajax({url:o+e,type:"POST",data:t,error:function(e,t,i){jsLogger.showAjaxFail("j59001",i)},success:function(e){globalLoader.hideGlobalLoader(),e&&me.editAlbum.replaceContent($(e),i),me.editAlbum.onSorting()}})},forwardToGallery:function(){$(".cancel-changed-gallery").on("click",function(){$(".show-confirm-changes-dialog").length||($(".save-changed-gallery").prop("disabled",!0),"videos"===me.editAlbum.galleryType?page("/gallery/videos"):page("/gallery/photos"))})}};const fpd=me.facebookPhotoDownloader={tokenExpiredIn:null,token:null,uid:null,remainingFiles:"unlimited",totalSelectedCount:0,currentAlbumId:null,$modal:null,$modalBody:null,lazyloadTimer:null,lazyloadTimeoutBetweenFails:5e3,lazyloadMaxFails:5,$step1_albums:null,$step2_photos:null,$step3_save:null,$step3_item:null,ajaxHandlers:[],baseEventsWasBind:!1,enteredCaptions:[],targetEntity:"gallery",selectedIds:[],fbPhotoCache:[],justOne:!1,resultDeferred:null};fpd.init=function(){"undefined"!=typeof FB?(fpd.$modal=null,fpd.$modalBody=null,fpd.currentAlbumId=null,fpd.selectedIds=[],fpd.fbPhotoCache=[],fpd.ajaxHandlers.length&&$.each(fpd.ajaxHandlers,function(e,t){t&&"OK"!==t.statusText&&t.abort()}),fpd.ajaxHandlers=[],fpd.lazyloadTimer&&clearInterval(fpd.lazyloadTimer),fpd.baseEventsWasBind||(fpd.baseEventsWasBind=1,FB.getLoginStatus(function(e){fpd.setFBLoginData(e)}),FB.Event.subscribe("auth.logout",function(e){fpd.setFBLoginData(),fpd.close()}),$(fpd).on("layout-changed",function(){}))):$(window).one("fb.init",fpd.init)},fpd.fbCheckLogin=function(e){fpd.uid?FB.api("/me/permissions",function(t){let i=!1;$.each(t.data,function(e,t){"user_photos"!==t.permission||void 0!==t.status&&"declined"===t.status||(i=!0)}),fpd.getPermissionPhoto(e,i)}):fpd.getPermissionPhoto(e,!1)},fpd.getPermissionPhoto=function(e,t){!t||!fpd.uid||null!==fpd.tokenExpiredIn&&Date.now()>fpd.tokenExpiredIn?FB.login(function(i){i&&FB.api("/me/permissions",function(o){t=!1,$.each(o.data,function(e,i){"user_photos"!==i.permission||void 0!==i.status&&"declined"===i.status||(t=!0)}),fpd.setFBLoginData(i)&&t?e(1):(e(0),t||popup.error(Lang.FB_PHOTO_PERMISSION_REVOKED))})},{scope:"user_photos",return_scopes:!0}):e(1)},fpd.setFBLoginData=function(e){return void 0!==e&&void 0!==e.authResponse&&("connected"!==e.status||null!==fpd.uid&&e.authResponse.userID!==fpd.uid?(fpd.uid=null,fpd.token=null,fpd.tokenExpiredIn=null,!1):(fpd.uid=e.authResponse.userID,fpd.token=e.authResponse.accessToken,void 0!==e.authResponse.expiresIn?fpd.tokenExpiredIn=Date.now()+1e3*e.authResponse.expiresIn:fpd.tokenExpiredIn=null,!0))},fpd.open=function(e){return fpd.resultDeferred=$.Deferred(),fpd.totalSelectedCount=0,"undefined"==typeof FB?($(window).one("fb.init",function(){fpd.open(e)}),fpd.resultDeferred.reject(0,"ERR_FB_OBJ"),fpd.resultDeferred):(fpd.lazyloadTimer&&clearInterval(fpd.lazyloadTimer),fpd.selectedIds=[],$.extend(fpd,e),fpd.fbCheckLogin(function(e){if(!e)return fpd.resultDeferred.reject(0,"ERR_FB_LOGIN"),fpd.resultDeferred;$(me).trigger("popup-page.loaded"),fpd.$modal=popup.extended({iconClass:"fmi-add-camera",className:"facebook-photo-downloader modal-full-white",closeButton:!1,title:_IS_MOBILE_?"":Lang.FB_CHOOSE_ALBUM,message:'<div id="facebook_content"></div>',onEscape:function(){fpd.close(),$(me).trigger("popup-page.unloaded")},onClose:function(){fpd.close(),$(me).trigger("popup-page.unloaded"),_IS_MOBILE_&&(meRouter.isCurrentRoute("lifestory")?me.pageLifeStories.openPreviousPopup():meRouter.isCurrentRoute("stories")&&me.pageStories.openPreviousPopup())}}).on("shown.bs.modal",function(){meRouter.setHashAction("|fb-dialog")}),fpd.$modalBody=$(".modal-body",fpd.$modal),fpd.initPopupEvents(),$(fpd).trigger("photos-list-changed");const t=$("#facebook_content");t.html(""),globalLoader.showGlobalLoader(),fpd.ajaxHandlers.push($.ajax({url:window.AppMemorial_config.baseUrl+"facebook-photos/layout",data:{access_token:fpd.token},type:"post",dataType:"json"}).done(function(e){if(!App.ajaxSuccess(e))return void 0!==e.error_string&&e.error_string.indexOf("appsecret_proof")>0?(jsLogger.showErrorResponse("j60001",e),void fpd.close(1)):(jsLogger.showErrorResponse("j60002",e),void fpd.close(1));t.detachLoader(),t.html(e.page),fpd.$step1_albums=$(".step-albums",fpd.$modalBody),fpd.$step2_photos=$(".step-photos",fpd.$modalBody),fpd.$step3_save=$(".step-save",fpd.$modalBody),fpd.$step3_item=$(".step-save .item.blank",fpd.$modalBody).clone().removeClass("blank"),$(".step-save .item.blank",fpd.$modalBody).detach(),fpd.loadAlbumCovers(),fpd.step1_albums()}).fail(function(e,t){"abort"!==t&&(fpd.close(1),jsLogger.showInternalError("j60003",e))}))}),fpd.resultDeferred)},fpd.close=function(e){fpd.destroyPopupEvents(),meRouter.unSetCurrentHashAction();const t=fpd.selectedIds.length>0;if(null!==fpd.resultDeferred&&fpd.resultDeferred.reject([t,void 0!==e?e:null]),fpd.ajaxHandlers.length){let e;for(e=0;e<fpd.ajaxHandlers.length;e++){const t=fpd.ajaxHandlers[e];t&&(t.abort(),fpd.ajaxHandlers[e]=0)}fpd.ajaxHandlers=[]}fpd.$modal&&fpd.$modal.length&&fpd.$modal.modal("hide")},fpd.initPopupEvents=function(){fpd.initLazyLoad(),fpd.$modalBody.on("click",".step-albums li",function(){const e=$(this),t=e.data("album-id"),i=e.data("album-name");return e.data("photo-count")>0&&fpd.step2_photos(t,i),!1}).on("click",".step-photos li",function(){return fpd.clickPhoto($(this)),!1}),fpd.$modal.on("click",".button.back, .thumbs .my.albums, .modal-title .fmi-back-arrow, a#return-to-albums-link",function(){if(!$(this).hasClass("disabled"))return fpd.$step3_save.is(":visible")?(fpd.step3_saveEnteredData(),fpd.step2_photos()):fpd.step1_albums(),!1}).on("click",".button.next",function(){if(!$(this).hasClass("disabled"))return fpd.ajaxHandlers.length&&$.each(fpd.ajaxHandlers,function(e,t){!t||"OK"===t.statusText&&t.statusText||t.abort()}),auth.requireLogin(function(){fpd.step3_save()}),!1}).on("click",".button.save",function(){if(!$(this).hasClass("disabled"))return fpd.ajaxHandlers.length&&$.each(fpd.ajaxHandlers,function(e,t){!t||"OK"===t.statusText&&t.statusText||t.abort()}),auth.requireLogin(function(){fpd.step3_save()}),!1}).on("click",".upper-panel a.albums",function(){return fpd.step1_albums(),!1}).on("click",".step-albums .pagination-more",function(){const e=$(this);fpd.loadNextPage(e,e.closest(".step-albums"))}).on("click",".step-photos .pagination-more",function(){const e=$(this);fpd.loadNextPage(e,e.closest(".step-photos"))}).on("click","a#return-to-gallery-link",()=>{fpd.close()}),fpd.step3_initEvents()},fpd.destroyPopupEvents=function(){fpd.lazyloadTimer&&clearInterval(fpd.lazyloadTimer)},fpd.fillAlbumCounters=function(){$(".album-photo-counter").remove(),$("#facebook_content [data-album-id]").each(function(){const e=$(this),t=parseInt(e.attr("data-album-selected-count"));t&&$('<div class="album-photo-counter">'+t+"</div>").appendTo($(".img-wrapper",e))})},fpd.clearAlbumCounters=function(){$("#facebook_content [data-album-id]").each(function(e,t){$(t).attr("data-album-selected-count",0).removeClass("selected")})},fpd.step1_albums=function(){fpd.currentAlbumId=null,$("#facebook_content, .facebook-photo-downloader").removeClass("step-2").addClass("step-1"),fpd.fillAlbumCounters(),$(".photo-counter .all-album-text").removeClass("hidden"),$(".photo-counter .album-text").addClass("hidden"),fpd.$step1_albums.show(),fpd.$step2_photos.hide(),$(".step-photos .pagination-more",fpd.$modalBody).removeData(),fpd.$step3_save.hide(),$(".thumbs .step-2",fpd.$modal).addClass("hidden"),$(".thumbs .step-1",fpd.$modal).removeClass("hidden"),$(".upper-panel .thumbs",fpd.$modal).show();const e=$(".step-albums ul li.selected",fpd.$modal).length,t=e+(e>1?" albums":" album");$(".photo-counter .count-album",fpd.$modalBody).attr("data-album-count",e).text(t),$(".button.save",fpd.$modal).removeClass("hidden"),$(".button.back",fpd.$modal).addClass("hidden"),$(".button-wrapper",fpd.$modal).toggleClass("hidden",fpd.selectedIds.length<1),_IS_MOBILE_&&($(".button.save",fpd.$modal).attr("disabled",function(e,t){return fpd.selectedIds.length<1}),$(".button-wrapper",fpd.$modal).removeClass("hidden"),$(".modal-header .modal-title",fpd.$modal).html("<i class='fmi-add-camera'></i>"+$(".upper-panel .your.albums",fpd.$modal).text()))},fpd.step2_photos=function(e,t){const i=function(){fpd.$step1_albums.hide(),$(".photo-counter .all-album-text").addClass("hidden"),$(".photo-counter .album-text").removeClass("hidden"),fpd.$step2_photos.show(),$(".pagination-more",fpd.$step2_photos).removeAttr("disabled"),fpd.$step3_save.hide(),$(".thumbs .step-1",fpd.$modal).addClass("hidden"),$(".thumbs .step-2",fpd.$modal).removeClass("hidden"),$(".button-wrapper",fpd.$modal).removeClass("hidden"),$(".button.save",fpd.$modal).addClass("hidden"),$(".button.back",fpd.$modal).removeClass("hidden"),$(fpd).trigger("layout-changed"),$("#facebook_content, .facebook-photo-downloader").removeClass("step-1").addClass("step-2"),_IS_MOBILE_&&$(".modal-header .modal-title",fpd.$modal).html("<i class='fmi-back-arrow'></i>"+$(".upper-panel .step-2 .album-title",fpd.$modal).text())};void 0===e?(fpd.currentAlbumId=null,fpd.checkDownloaded($(".step-photos .img-wrapper img",fpd.$modalBody)),i()):(fpd.currentAlbumId=e,$(".step-photos ul",fpd.$modalBody).html(""),$(".step-photos .pagination-more",fpd.$modalBody).removeData(),$(".thumbs .step-2 .album-title",fpd.$modal).removeClass("empty").html(t),fpd.loadPhotos(e,function(){i(),$(fpd).trigger("photos-list-changed")}));const o=$("li[data-album-id="+fpd.currentAlbumId+"]"),n=parseInt(o.attr("data-album-selected-count")),a=n+(n>1?" photos":" photo");$(".photo-counter .album-photo-count").text(a)},fpd.step3_save=function(){"story"!==fpd.targetEntity?(eventTracking.run("photo","content_additions","FB"),globalLoader.showGlobalLoader(),fpd.step3_buildPreviews(),fpd.allDone(),me.cleanAboutPageCache()):fpd.step3_buildStoryPreviews()},fpd.initLazyLoad=function(){fpd.lazyloadTimer=setInterval(function(){let e;$(".step-photos",fpd.$modalBody).is(":visible")?e=$(".step-photos",fpd.$modalBody):$(".step-albums",fpd.$modalBody).is(":visible")&&(e=$(".step-albums",fpd.$modalBody));const t=$(".pagination-more",e);if(!t.length||t.data("no-more")||t.attr("disabled")||!t.is(":visible"))return;const i=$(".modal-full-white"),o=i.height(),n=i.scrollTop();t.position()&&t.position().top-(o+n)<500&&fpd.loadNextPage(t,e)},300)},fpd.loadNextPage=function(e,t){e.lockCheck()||(e.lockOn().addLoaderLayout(),fpd.fbCheckLogin(function(i){let o,n;i||(e.deleteLoaderLayout().lockOff(),fpd.close(1)),$(".step-photos",fpd.$modalBody).is(":visible")?(o=window.AppMemorial_config.baseUrl+"facebook-photos/photos?access_token="+fpd.token+"&album_id="+fpd.currentAlbumId,n=function(e){const t=$(".step-photos ul",fpd.$modalBody);t.append(e);const i=$(".step-photos .img-wrapper img",fpd.$modalBody);return fpd.checkDownloaded(i),t}):$(".step-albums",fpd.$modalBody).is(":visible")&&(o=window.AppMemorial_config.baseUrl+"facebook-photos/albums?access_token="+fpd.token,n=function(e){const t=$(".step-albums ul",fpd.$modalBody);return t.append(e),fpd.loadAlbumCovers(),t});const a=$("[data-next-page-token]",t).last();a.length?(o+="&next_page_token="+a.data("next-page-token"),$.ajax({url:o,cache:!1,timeout:5e4,method:"get",dataType:"html"}).done(function(t){if(t.length<2)return void err.network(1710144,"Empty result");a.detach();const i=n(t);fpd.checkNoMore(e,i),e.data("fails",0)}).fail(function(t,i){if("abort"===i)return;const o=e.data("fails");e.data("fails",o||1),o>fpd.lazyloadMaxFails?(e.show().removeAttr("disabled"),clearInterval(fpd.lazyloadTimer)):(e.attr("disabled","disabled"),setTimeout(function(){e.show().removeAttr("disabled")},fpd.lazyloadTimeoutBetweenFails))}).always(function(){e.deleteLoaderLayout().lockOff()})):console.warn("Unexpected noMore")}))},fpd.checkNoMore=function(e,t){return!(!$(".no-more-items",t).length&&!t.hasClass("no-more-items"))&&(e.hide().data("no-more",1),$(".no-more-items",t).hide(),!0)},fpd.loadAlbumCovers=function(){$("#facebook_content [data-album-id]").each(function(){const e=$(this);if(e.data("cover-loaded"))return;e.data("cover-loaded",1);const t=e.data("photo-id"),i=e.data("album-id"),o=$('[data-album-id="'+i+'"] img');o.css({opacity:0});const n=$(".img-wrapper",e),a=$(".img-background",e);n.addLoaderLayout(),fpd.ajaxHandlers.push($.post(window.AppMemorial_config.baseUrl+"facebook-photos/preview?photo_id="+t,{access_token:fpd.token,photo_id:t},function(e){App.ajaxSuccess(e)?o.one("load",function(){n.deleteLoaderLayout(),a.css({"background-image":"url("+e.url+")"}),o.css("display","none")}).each(function(){this.complete&&$(this).load()}).attr("src",e.url):n.deleteLoaderLayout()}).fail(function(){n.deleteLoaderLayout()}))})},fpd.loadPhotos=function(e,t){fpd.fbCheckLogin(function(i){i||fpd.close(1);const o=$("#facebook_content");o.addLoaderLayout(),$("div#return-to-gallery-message").addClass("hide"),fpd.ajaxHandlers.push($.ajax({url:window.AppMemorial_config.baseUrl+"facebook-photos/photos",data:{access_token:fpd.token,album_id:e},type:"post",dataType:"html"}).done(function(e){if(e.length<2)jsLogger.showErrorResponse("j60004",e);else{try{const t=JSON.parse(e);t.hasOwnProperty("errorCode")&&40404===t.errorCode&&$("div#return-to-albums-message").removeClass("hide")}catch(t){const i=$(".step-photos ul",fpd.$modalBody);i.html(e);const o=$(".step-photos .img-wrapper img",fpd.$modalBody);fpd.checkDownloaded(o);const n=$(".step-photos .pagination-more",fpd.$modalBody);fpd.checkNoMore(n,i)||n.show()}t()}}).fail(function(e,t){"abort"!==t&&(jsLogger.showAjaxFail("j60005",e),fpd.step1_albums())}).always(function(){o.deleteLoaderLayout()}))})},fpd.checkDownloaded=function(e){e.each(function(){const e=$(this),t=""+e.data("photo-id"),i=e.closest("li");fpd.selectedIds.indexOf(t)>-1?fpd.photo_addSuccess(i):fpd.photo_removeSuccess(i)})},fpd.clickPhoto=function(e){fpd.justOne&&fpd.clearAlbumCounters();const t=e.find("img").data("photo-id");if(e.hasClass("downloaded")||e.lockCheck()){const i=e.data("ajax-handler");return i&&(i.abort(),e.removeData("ajax-handler")),e.lockOff(),fpd.photo_removeFromList(t),void fpd.photo_removeSuccess(e)}"unlimited"!==fpd.remainingFiles&&fpd.remainingFiles>0&&fpd.selectedIds.length>=fpd.remainingFiles?popup.error(Lang.FACEBOOK_DOWNLOADER_MAX_PHOTO_LIMIT_REACHED.format(window.AppMemorial_config.maxPhotoLimit),"facebook-max-limit-reached"):e.lockCheck()||(e.lockOn(),fpd.fbCheckLogin(function(i){if(i||fpd.close("ERR_FB_SIGNED_OUT"),fpd.justOne&&fpd.selectedIds.length>0){const e=$("[data-photo-id="+fpd.selectedIds[0]+"]",fpd.$modalBody);fpd.photo_removeSuccess(e.closest("li")),fpd.photo_removeFromList(fpd.selectedIds[0]),fpd.selectedIds=[]}fpd.photo_addSuccess(e),fpd.photo_addToList(t);const o=$.post(window.AppMemorial_config.baseUrl+"facebook-photos/download",{access_token:fpd.token,photo_id:t},function(e){App.ajaxSuccess(e)?fpd.cachePhoto(e):jsLogger.showErrorResponse("j60007",e,fpd.close)},"json").fail(function(t,i){"abort"!==i&&fpd.photo_addError(e)}).always(function(){e.removeData("ajax-handler"),e.lockOff()});fpd.ajaxHandlers.push(o),e.data("ajax-handler",o)}))},fpd.setPhotosCounter=function(){fpd.totalSelectedCount=0,$("#facebook_content [data-album-id]").each(function(e,t){const i=parseInt($(t).attr("data-album-selected-count"));i>0&&(fpd.totalSelectedCount+=i)});const e=fpd.totalSelectedCount+(fpd.totalSelectedCount>1?" photos":" photo");$(".photo-counter .total-photo-count",fpd.$modalBody).text(e)},fpd.album_counterIncrease=function(){const e=$("li[data-album-id="+fpd.currentAlbumId+"]"),t=parseInt(e.attr("data-album-selected-count"))+1;e.attr("data-album-selected-count",t),e.addClass("selected");const i=t+(t>1?" photos":" photo");$(".photo-counter .album-photo-count",fpd.$modalBody).text(i),$(".step-albums ul li.selected",fpd.$modal).length&&($(".photo-counter .selected-wrapper",fpd.$modal).removeClass("hidden"),$(".photo-counter .count-help",fpd.$modal).addClass("hidden")),fpd.setPhotosCounter()},fpd.album_counterDecrease=function(){const e=$("li[data-album-id="+fpd.currentAlbumId+"]");let t=parseInt(e.attr("data-album-selected-count"));const i=fpd.totalSelectedCount+(fpd.totalSelectedCount>1?" photos":" photo");if($(".photo-counter .total-photo-count",fpd.$modalBody).text(i),t>0){t-=1,e.attr("data-album-selected-count",t);const i=t+(t>1?" photos":" photo");$(".photo-counter .album-photo-count",fpd.$modalBody).text(i)}0===t&&e.removeClass("selected"),$(".step-albums ul li.selected",fpd.$modal).length||($(".photo-counter .selected-wrapper",fpd.$modal).addClass("hidden"),$(".photo-counter .count-help",fpd.$modal).removeClass("hidden")),fpd.setPhotosCounter()},fpd.photo_addToList=function(e){fpd.selectedIds.push(""+e),fpd.album_counterIncrease(),$(fpd).trigger("photos-list-changed")},fpd.photo_removeFromList=function(e){e=""+e;const t=fpd.selectedIds.indexOf(e);t>-1&&fpd.selectedIds.splice(t,1),fpd.album_counterDecrease(),$(fpd).trigger("photos-list-changed")},fpd.photo_addError=function(e){e.lockCheck()&&(fpd.photo_removeSuccess(e),e.addClass("download-error"),$('<div class="error-box"><i class="fmi-warning"></i><span>'+Lang.PHOTO_SAVE_FAILED+"</span></div>").appendTo(e))},fpd.photo_removeError=function(e){e.removeClass("download-error").find(".error-box").detach()},fpd.photo_addSuccess=function(e){fpd.photo_removeError(e),$('<div class="downloaded-check"><i class="fmi-ok-o"></i></div>').appendTo(e),e.addClass("downloaded").addClass("notransition")},fpd.photo_removeSuccess=function(e){e.removeClass("downloaded notransition").find(".downloaded-check").detach()},fpd.step3_initEvents=function(){fpd.$modal.on("click",".rotate_controls .rotate_left",function(){const e=$(this).closest(".item");return e.data("uploadedFile",{id:e.attr("fmid")}),window.uploader_gallery.rotateItemGallery(e,"left"),!1}).on("click",".rotate_controls .rotate_right",function(){const e=$(this).closest(".item");return e.data("uploadedFile",{id:e.attr("fmid")}),window.uploader_gallery.rotateItemGallery(e,"right"),!1}).on("click",".items .cancel, .controls.top .cancel",function(){const e=$(this).parents(".item"),t=e.attr("fbid");if(e.css("opacity",0),setTimeout(function(){e.detach(),$(".items .item",fpd.$step3_save).length||(fpd.step3_saveEnteredData(),fpd.step2_photos())},300),fpd.close(),void 0!==t&&t)return fpd.photo_removeFromList(t),!1})},fpd.cachePhoto=function(e){void 0!==e.fbid&&(fpd.fbPhotoCache[e.fbid]=e)},fpd.step3_buildPreviews=function(){const e=$(".items",fpd.$step3_save),t=fpd.$step3_item.clone();e.html("");let i=1;$.each(fpd.selectedIds,function(o,n){const a=t.clone();if(a.css({opacity:0}).show(),a.appendTo(e),a.css({opacity:1}),$("input[name=item_name]",a).attr("tabindex",i++),void 0!==fpd.fbPhotoCache[n]&&fpd.fbPhotoCache[n])fpd.setIconState("success",a),fpd.step3_setPhotoInfo(a,fpd.fbPhotoCache[n]);else{const e=$.post(window.AppMemorial_config.baseUrl+"facebook-photos/download?"+n,{access_token:fpd.token,photo_id:n},function(e){App.ajaxSuccess(e)?(fpd.cachePhoto(e),fpd.setIconState("success",a),fpd.step3_setPhotoInfo(a,fpd.fbPhotoCache[n])):fpd.setIconState("error",a)},"json").fail(function(e,t){});fpd.ajaxHandlers.push(e)}})},fpd.setIconState=function(e,t){$(".img_wrapper",t).removeClass("posting error success").addClass(e)},fpd.step3_buildStoryPreviews=function(){$("#facebook_content").html(""),$.each(fpd.selectedIds,function(e,t){if(void 0!==fpd.fbPhotoCache[t]&&fpd.fbPhotoCache[t])fpd.resultDeferred.resolve(fpd.fbPhotoCache[t]),fpd.close();else{const e=$.post(window.AppMemorial_config.baseUrl+"facebook-photos/download",{access_token:fpd.token,photo_id:t},function(e){App.ajaxSuccess(e)&&(fpd.resultDeferred.resolve(e),fpd.close())},"json").fail(function(e,t){"abort"===t&&(fpd.close(1),jsLogger.showAjaxFail("j60006",e))}).always(function(){});fpd.ajaxHandlers.push(e)}})},fpd.step3_setPhotoInfo=function(e,t){$(".img_wrapper img",e).attr("src",t.simg),e.attr("fmid",t.id),e.attr("fbid",t.fbid);const i=$("input[name=item_name]",e);void 0!==fpd.enteredCaptions[t.fbid]?i.val(fpd.enteredCaptions[t.fbid]):i.val(t.name)},fpd.allDone=function(){globalLoader.showGlobalLoader();const e=[];return $(".items .item",fpd.$step3_save).each(function(t,i){const o=$(i);o.attr("fmid")&&e.push({id:o.attr("fmid"),title:$(".edit_name input",o).val(),target_entity:fpd.targetEntity})}),e.length&&$.ajax({url:window.AppMemorial_config.baseUrl+"upload/photo",data:{names:JSON.stringify(e),_method:"SAVE"},type:"post",async:!1,cache:!1,dataType:"json"}).done(function(e){if(!App.ajaxSuccess(e))return;globalLoader.hideGlobalLoader();const t=me.getMainPhotoId();me.loadBlock("titlePhoto",function(){!t&&me.getMainPhotoId()&&_IS_MOBILE_?meRouter.moveToAbout():!t&&me.getMainPhotoId()?me.loadBlock("pageContent",function(){meRouter.scrollTo(0)},!0):me.loadBlock("pageContent",function(){me.scrollTop($("#pg").offset().top)},!0)}),me.loadBlock("mobileInnerPageTitle"),me.loadBlock("subscription"),me.loadBlock("slideshow"),me.loadBlock("activities"),$(me).trigger("checkGalleryMedia"),me.setAsideSlideshow(),fpd.close()}).fail(function(e,t){globalLoader.hideGlobalLoader()}),!1},fpd.step3_saveEnteredData=function(){$(".items .item",fpd.$step3_save).each(function(e,t){const i=$(t);fpd.enteredCaptions[i.attr("fbid")]=$("input",i).val()})},fpd.checkDimensions=function(e){e.each(function(){const e=$(this);e.data("checkDimensions")||(e.data("checkDimensions",1),0===e.parent(".backstretch").length&&e.css({opacity:0}),e.one("load",function(){const e=$(this),t=e.parent(".img-wrapper"),i=e.attr("src"),o=e.attr("title"),n=e.data();e.remove(),t.deleteLoaderLayout().css({position:"relative"}).backstretch(i),t.find("img").data(n).attr("title",o)}))})},me.gallerySongs_delete=function(e){e.lockCheck()||(e.lockOn(),popup.confirm(Lang.YOU_ARE_ABOUT_TO_DELETE_SONG,function(){e.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"gallery-edit/delete",{id:e.data("oid"),isGallery:meRouter.isCurrentRoute("gallery/")},function(t){App.ajaxError(t)?App.ajaxError(t,function(e){jsLogger.showInternalError("j77001",e)}):(window.AppMemorial_config.songs_playlist&&(window.AppMemorial_config.songs_playlist.indexOf(e.data("url"))>=0&&window.AppMemorial_config.songs_playlist.splice(window.AppMemorial_config.songs_playlist.indexOf(e.data("url")),1),mediaPlayer.stop()),e.hide("slow",function(){e.detach()}))},"JSON").fail(function(e){jsLogger.showAjaxFail("j62001",e)}).always(function(){e.deleteLoaderLayout()})},!1,function(){e.lockOff()}))},me.pageGallery_delete=function(e,t,i,o){if(!t.lockCheck()){t.lockOn(),"object"==typeof $slideshow&&$slideshow.modal("hide");var n=function(){meRouter.getCurrentAnchor().indexOf("|videos|")&&!$.isEmptyObject(slideShowActions.currentSlide)&&(slideShowActions.currentSlide.click(),$("[data-oid="+slideShowActions.currentSlide.data("oid")+"] img").click())};popup.confirm(e,function(){t.addLoaderLayout(),i(o,t)},n,function(){t.lockOff()},n)}},me.pageGallery_editTitle=function(e){var t=Lang.CHANGE_PHOTO_CAPTION_POPUP_TITLE;meRouter.isCurrentRoute("gallery/videos")&&(t=Lang.CHANGE_VIDEO_CAPTION_POPUP_TITLE);var i=$(".items-list [data-oid="+e+"]"),o=popup.extended({className:"dialog-change-caption bottom-slide-up",title:t,iconClass:"fmi-old-pen-writing",message:'<textarea name="item-title" type="text" class="form-control" maxlength="190"><textarea>',buttons:{cancel:{label:Lang.CANCEL,className:"button cancel"},main:{label:Lang.OK,className:"button ok same-size-desktop",callback:function(){var t=$(".modal-content",o),n=$("textarea[name=item-title]",t).val();return t.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"gallery-edit/rename",{method:"ajax",id:e,name:n},function(e){t.deleteLoaderLayout(),e.error?jsLogger.showInternalError("j62004",e):($(".actions .title",i).html(e.name),$("img",i).attr("alt",e.name),i.find(".title").html(e.name),o.modal("hide"),me.pageGallery_addHideTitleTooltip(i,e.name))},"json").fail(function(e){t.deleteLoaderLayout(),jsLogger.showAjaxFail("j62003",e)}),!1}}}}).on("shown.bs.modal",function(){$("textarea[name=item-title]",o).focus().select()});$(".bootbox-body",o).addClass("bootstrap"),$("textarea[name=item-title]",o).val(i.find(".title").text())},me.pageGallery_addHideTitleTooltip=function(e,t){var i=$(".bottom-caption-wrapper",e),o=$(".title-tooltip",e),n=$(".tooltip-content",o);i.hasClass("story-exist")||(i.removeClass("comment-exist"),n.html(t),o.addClass("hidden"),t&&(o.removeClass("hidden"),i.addClass("comment-exist")))},me.pageGallery_editTitleInline=function(e,t,i,o){if($(".edit-area",e).length)return!1;$('<div class="edit-area bootstrap form-inline"><input type="text" class="form-control" maxlength="190"><button class="cancel button square fmi-cancel" title="'+Lang.INLINE_EDIT_CANCEL_BUTTON_TITLE+'"></button><button class="save button square fmi-ok" title="'+Lang.INLINE_EDIT_SAVE_BUTTON_TITLE+'"></button></div>').insertAfter(t);var n=$(".edit-area",e),a=$("input",n),r=t.text();r!=a.attr("placeholder")&&r!=Lang.ADD_CAPTION_HERE||(r=""),a.val(r).focus();var s=function(e){void 0===e&&(e=!0),n.detach(),o(e)};e.one("titleChanged",s),$(".cancel",n).click(function(){return s(!1),!1});var l=$(".save",n),d=function(){if(!l.lockCheck()){l.lockOn(),l.attr("disabled","disabled"),e.addLoaderLayout();var o=a.val();return $.post(window.AppMemorial_config.baseUrl+"gallery-edit/rename",{id:i,name:o},function(n){if(e.deleteLoaderLayout(),n.error)jsLogger.showInternalError("j62005",n),l.removeAttr("disabled").lockOff();else{if(t.text(n.name),$("#page-gallery-songs").length||slideShowActions.currentSlide.find(".slide-img").attr("data-title",n.name),me.pageSlideShow.currentItemObj)$(".title-mobile, .title",me.pageSlideShow.currentItemObj).html(n.name),$("img",me.pageSlideShow.currentItemObj).attr("alt",n.name),me.pageGallery_addHideTitleTooltip($(me.pageSlideShow.currentItemObj).parents(".item"),n.name);else if(!$("#page-gallery-songs").length){var a=$(".item[data-oid='"+slideShowActions.currentSlide.data("oid")+"']");a.find(".title").html(n.name),a.find("img").attr("alt",n.name),me.pageGallery_addHideTitleTooltip(a,n.name),slideShowActions.currentSlide.parent().find(".title-mobile").text(n.name),slideShowActions.currentSlide.parent().find(".title").text(n.name)}s()}$('.main-item[data-oid="'+i+'"]').length&&$('.main-item[data-oid="'+i+'"]').find(".item-title").val(o)},"JSON").fail(function(t){e.deleteLoaderLayout(),l.removeAttr("disabled").lockOff(),jsLogger.showAjaxFail("j62006",t)}),!1}};l.click(d),a.on("keyup",function(e){13==e.keyCode?d():13==e.keyCode&&s()})},me.galleryPhotos_rotate=function(e,t,i){if(!e.lockCheck()){e.lockOn(),$(".modal-content .slides").addLoaderLayout();var o=e.data("oid");$.post(window.AppMemorial_config.baseUrl+"gallery-edit/rotate"+("right"==t?"right":"left"),{id:o,size:"list,aside-slideshow,slideshow"},function(t){App.ajaxError(t)||(typeof t.isCover!==ud&&t.isCover&&(me.loadBlock("titlePhoto"),me.loadBlock("mobileInnerPageTitlePhoto")),me.loadBlock("slideshow"),typeof t.status!==ud&&"ok"==t.status?(e.find(".image img").attr("src",t["img-list"]),me.asideSlideshow.slideChanged(o,t["img-aside-slideshow"])):(e.find("img").attr("src","/assets/images/icons/icon_photo_converting.gif"),e.addClass("processing"),e.data("perms",t.perms).removeData("permsObject"),e.attr("data-not-ready",o),$(me).trigger("checkGalleryMedia",t)),me.editAsideSlideshow(e,t),i&&i(t,e))},"JSON").fail(function(e){jsLogger.showAjaxFail("j62007",e)}).always(function(){e.lockOff(),$(".modal-content .slides").deleteLoaderLayout(200)})}},me.galleryVideos_changeSnapshot=function(e,t){$.post(window.AppMemorial_config.baseUrl+"gallery-edit/change-snapshot-dialog",{id:e},function(i){App.ajaxError(i)||($modalHandler=popup.extended({className:"dialog-change-video-snapshot full-height",title:Lang.CHOOSE_NEW_THUMBNAIL,message:i.page,onEscape:function(){$modalHandler.modal("hide"),meRouter.unSetCurrentHashAction(),t&&t()}}).on("shown.bs.modal",function(){$("#page-change-snapshot .item",$modalHandler).click(function(){var i=$(this);return $.post(window.AppMemorial_config.baseUrl+"gallery-edit/change-snapshot-save",{id:e,snapshot_id:i.data("snapshot-id")},function(i){App.ajaxError(i)||($modalHandler.modal("hide"),i.newSrc&&$(".items-list .video[data-oid="+e+"] img").attr("src",i.newSrc),t&&t())},"json").fail(function(e){jsLogger.showAjaxFail("j62011",e)}),!1})}))},"json").fail(function(e){jsLogger.showAjaxFail("j62010",e)})},me.galleryVideos_rotate=function(e,t,i){if(!e.lockCheck()){e.lockOn(),e.addLoaderLayout();var o=e.data("oid");$.post(window.AppMemorial_config.baseUrl+"gallery-edit/rotate"+("right"==t?"right":"left"),{id:o,size:"list"},function(t){if(!App.ajaxError(t)){var n=$(".gallery-video-slideshow");if(n.is(":visible")&&(n.find(".video-slide").html('<img src="'+t["img-list"]+'" alt="rotate" class="image status-converting h-100">'),_IS_MOBILE_&&n.modal("hide")),meRouter.isCurrentRoute("/gallery-edit/videos")&&$('item[data-oid="'+o+'"]').find("#status_video").attr("class","image status-converting"),typeof t.status!==ud&&t.status===window.AppMemorial_config.album_status.ok)e.find(".image img").attr("src",t["img-list"]);else e.find("img").attr("src","/assets/images/icons/icon_video_converting.svg"),e.addClass("processing"),$("a.video[data-oid="+o+"]").parents(".image").removeClass("status-ok status-error video-ok").addClass("status-converting video-pending no-img"),$(".story-media a[data-oid="+o+"]").parent().removeClass("status-ok status-error video-ok").addClass("status-converting video-pending no-img"),e.attr("data-perms",t.perms).removeData("permsObject"),me.pageGallery_setPerms(t.perms),me.pageGalleryVideos.setItemPerms(e),e.attr("data-not-ready",o),$(me).trigger("checkGalleryMedia",t);i&&i(t,e)}},"JSON").fail(function(e){jsLogger.showAjaxFail("j62008",e)}).always(function(){e.deleteLoaderLayout(),e.lockOff()})}},me.deleteItemRequest=function(e,t){var i=!1,o=t.data("oid");me.getMainPhotoId()==o&&me.isClickOnMainPhoto()&&(i=!0),t.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"gallery-edit/delete",{id:o,isGallery:meRouter.isCurrentRoute("gallery/"),isCoverPhoto:i},function(t){App.ajaxError(t)?jsLogger.showErrorResponse("j62009",t):(typeof t.reloadMain!==ud&&t.reloadMain&&(me.loadBlock("titlePhoto"),me.loadBlock("mobileInnerPageTitle"),meRouter.unSetCurrentHashAction()),typeof t.removeSlide!==ud&&t.removeSlide&&me.asideSlideshow.removeSlide(o),me.cleanAboutPageCache(),e())},"JSON").fail(function(e){jsLogger.showAjaxFail("j62002",e)}).always(function(){t.deleteLoaderLayout()})},me.isClickOnMainPhoto=function(){return me.pageSlideShow.currentItemObj&&!!me.pageSlideShow.currentItemObj.find(".memorial_main_photo").length},me.pageSlideShow={currentItemObj:!1,onePhotoMode:!1,disabledSlideShow:!1,actionsState:1,modalHandler:{},currentSlide:{},currentSlidePosition:0,$playButton:{},$stopButton:{},carousel:{},openItemId:0,autoplay:!1,disableActions:!1,hideOptionStartSlideShow:!1,isLoadingData:!1,isFullScreenMode:!1,isDruggedTriggered:!1,druggedDirection:!1,countUploadedPage:window.AppMemorial_config.slideshowOption.count_uploaded_page,NEXT_DIRECTION:window.AppMemorial_config.slideshowOption.following_slides,PREVIOUS_DIRECTION:window.AppMemorial_config.slideshowOption.previous_slides,init:function(e){if($(".gallery-photo-slideshow:visible").length)return console.log("pageSlideShow - prohibited to initialize"),!1;console.log("pageSlideShow - loaded"),this.getSlideShowHTML(),this.contactAuthor(),this.afterInit(e)},getSlideShowHTML:function(){var e=window.AppMemorial_config.baseUrl+"gallery/photo/slideshow";globalLoader.showGlobalLoader(),$.ajax({url:e,type:"POST",data:{},success:function(e){me.pageSlideShow.currentItemObj&&me.pageSlideShow.currentItemObj.attr("data-slide-position")?me.pageSlideShow.currentSlidePosition=Number(me.pageSlideShow.currentItemObj.attr("data-slide-position")):me.pageSlideShow.currentSlidePosition=0,$slideshow=popup.extendedBlackFullScreen({className:"gallery-photo-slideshow hidden",message:e,onEscape:function(){var e=$slideshow.find(".slide.owl-item.active").attr("data-oid");return $(".footer.editable .edit-area").length?($(".footer.editable .edit-area .cancel").trigger("click"),$(".gallery-photo-slideshow").focus()):$(".gallery-photo-slideshow").hasClass("slideshow-played")||$(".gallery-photo-slideshow").hasClass("slideshow-paused")||($slideshow.modal("hide"),meRouter.unSetCurrentHashAction(),me.pageSlideShow.hideOptionStartSlideShow=!1,me.pageSlideShow.backToItemGalleryManage(e)),!1},onClose:function(){var e=$slideshow.find(".slide.owl-item.active").attr("data-oid");me.pageSlideShow.hideOptionStartSlideShow=!1,me.pageSlideShow.stopAutoplay(),meRouter.unSetCurrentHashAction(),me.pageSlideShow.backToItemGalleryManage(e)}}),me.pageSlideShow.slideShowLoadSlidesByOffset(),me.pageSlideShow.modalHandler=$(".gallery-photo-slideshow"),me.pageSlideShow.$playButton=$(".toolbar .start-slideshow",me.pageSlideShow.modalHandler),me.pageSlideShow.$stopButton=$(".overlap .exit-full-mode",me.pageSlideShow.modalHandler),me.pageSlideShow.$changeBackroundSongs=$(".overlap .change-background-songs",me.pageSlideShow.modalHandler)}})},getNumberOfNextItems:function(){return $(".slide.owl-item.active").nextUntil(".slide.owl-item.cloned").length},getNumberOfPrevItems:function(){return $(".slide.owl-item.active").prevUntil(".slide.owl-item.cloned").length},backToItemGalleryManage:function(e){if(meRouter.isCurrentRoute("/gallery-edit/photos")&&Number(e)>0)if(meRouter.unSetCurrentHashAction(),$(".list-items item[data-oid='"+e+"']").length)$("html, body").animate({scrollTop:$(".list-items item[data-oid='"+e+"']").offset().top-80},100);else{var t=0;$.each(me.editAlbum.getSortList(),function(i,o){o.id===e&&(t=i+1)});var i=Math.ceil(t/window.AppMemorial_config.limitPhotoMG);i=0===i?1:i,globalLoader.showGlobalLoader(!1,!0),me.loadAndGotToBlock(me.data("ajax-url","/gallery-edit/photos/"+i),function(){globalLoader.hideGlobalLoader(),$(".list-items item[data-oid='"+e+"']").length&&$("html, body").animate({scrollTop:$(".list-items item[data-oid='"+e+"']").offset().top-80},100)})}},contactAuthor:function(){$("body").off("click.open_contact").on("click.open_contact","a[data-author-contact-id]",function(){if(auth.isSignedIn()){var e=$(this).data("author-contact-id"),t=meRouter.getCurrentAnchorAction();me.contact.open(e,null,null,function(){meRouter.setHashAction(t),meRouter.goToHashAction()})}else auth.open();return!1})},slideShowLoadSlidesByOffset:function(){var e=0,t={onePhotoMode:me.pageSlideShow.onePhotoMode,is_open_slide_show:!0};me.pageSlideShow.disableActions=!1,me.pageSlideShow.disabledSlideShow=!1,me.pageSlideShow.currentItemObj&&(t.current_slide_id=e=me.pageSlideShow.currentItemObj.data("oid")),$.ajax({url:window.AppMemorial_config.baseUrl+"gallery/get-slides",data:t,method:"post",dataType:"json",success:function(t){if(1==t.success){(t.onePhotoMode||1===t.slides.length)&&(me.pageSlideShow.onePhotoMode=!0,me.pageSlideShow.disableActions=!0,me.pageSlideShow.disabledSlideShow=!0);var i=0,o=me.find("#page-gallery-photo .center .wrapper");t.currentPosition>me.pageSlideShow.countUploadedPage&&(i=t.currentPosition-1-me.pageSlideShow.countUploadedPage),currentSlide=me.pageSlideShow.slideFormation(t.slides,me.pageSlideShow.currentSlidePosition,o,e,i),me.pageSlideShow.carousel=me.pageSlideShow.setOwlCarousel(currentSlide),me.pageSlideShow.carousel.show(),slideShowActions.setActionsToSliderHeader(me.pageSlideShow.modalHandler),me.pageSlideShow.onePhotoMode?$(".counter",me.pageSlideShow.modalHandler).hide():$(".counter",me.pageSlideShow.modalHandler).show(),me.pageSlideShow.disableActions?$(".left, .right",me.pageSlideShow.modalHandler).hide():_IS_MOBILE_?($(".footer .story-min-mobile",me.pageSlideShow.modalHandler).show(),$(".left, .right",me.pageSlideShow.modalHandler).hide()):$(".left, .right, .story-wrapper",me.pageSlideShow.modalHandler).show(),me.pageSlideShow.hideOptionStartSlideShow&&$(".action.start-slideshow",me.pageSlideShow.modalHandler).hide(),$(me.pageSlideShow.modalHandler).on("click",".story-wrapper .slide-edit-store",function(){var e=$(this).data("oid");meRouter.unSetCurrentHashAction(),me.loadAndGotToBlock($(this),function(){$("html, body").animate({scrollTop:$(".stories-page .story[data-oid='"+e+"']").offset().top-40},100),slideShowActions.modalHandler.modal("hide"),me.pageStories.stories_openEditDialog(e)})}),$(me.pageSlideShow.modalHandler).on("click",".hide-story-mobile",function(){$(this).parent().toggle(),$(this).parents(".slide-img-span").find(".story-img").show(),$(".footer",me.pageSlideShow.modalHandler).toggle().find(".story-min-mobile").toggle(),$(".toolbar .wrapper .buttons a.visible",me.pageSlideShow.modalHandler).length&&$(".fmi-dots-three-vertical",me.pageSlideShow.modalHandler).css({opacity:1,visibility:"visible"})}),$(".toolbar .start-slideshow",me.pageSlideShow.modalHandler).length&&!me.pageSlideShow.onePhotoMode&&me.pageSlideShow.autoplay&&me.pageSlideShow.startAutoplay(),me.pageSlideShow.modalHandler.removeClass("hidden"),globalLoader.hideGlobalLoader()}}})},checkLoadingProcess:function(e,t,i){0==e&&!0===me.pageSlideShow.isLoadingData||0==e&&me.pageSlideShow.checkAllItemsOnSlideShow()?globalLoader.showGlobalLoader(!0):"function"==typeof i&&i()},nextSlideObserver:function(e,t){void 0===t&&(t=!0);var i=me.pageSlideShow.getNumberOfNextItems();t&&me.pageSlideShow.getNumberOfPrevItems()>me.pageSlideShow.countUploadedPage/2&&(e.trigger("remove.owl.carousel",[0]),e.trigger("prev.owl.carousel")),me.pageSlideShow.checkNeedSlideLoading(i)&&me.pageSlideShow.slideDataLoading(e,me.pageSlideShow.NEXT_DIRECTION,function(){e.trigger("refresh.owl.carousel"),$(".gallery-photo-slideshow").hasClass("slideshow-played")?e.trigger("play.owl.autoplay"):e.trigger("stop.owl.autoplay"),0===i&&t&&e.trigger("next.owl.carousel")}),me.pageSlideShow.checkLoadingProcess(i,e,function(){t&&e.trigger("next.owl.carousel")})},checkNeedSlideLoadingAutoPlay:function(e){if(me.pageSlideShow.checkNeedSlideLoading(e)){globalLoader.showGlobalLoader();let e=$("#page-gallery-photo .center .wrapper");e.trigger("stop.owl.autoplay"),me.pageSlideShow.autoplay=!1,me.pageSlideShow.slideDataLoading($("#page-gallery-photo .center .wrapper"),me.pageSlideShow.NEXT_DIRECTION,function(){e.trigger("refresh.owl.carousel"),e.trigger("play.owl.autoplay"),globalLoader.hideGlobalLoader()})}},checkNeedSlideLoading:function(e){return!!(!1===me.pageSlideShow.isLoadingData&&e<me.pageSlideShow.countUploadedPage/2&&me.pageSlideShow.checkAllItemsOnSlideShow())},prevSlideObserver:function(e,t){var i=me.pageSlideShow.getNumberOfNextItems(),o=me.pageSlideShow.getNumberOfPrevItems();if(void 0===t&&(t=!0),t&&i>1.5*me.pageSlideShow.countUploadedPage&&e.trigger("remove.owl.carousel",[-1]),me.pageSlideShow.checkNeedSlideLoading(o)){var n=me.pageSlideShow.PREVIOUS_DIRECTION;me.pageSlideShow.slideDataLoading(e,n,function(){$(".gallery-photo-slideshow").hasClass("slideshow-played")?e.trigger("play.owl.autoplay"):e.trigger("stop.owl.autoplay"),0===o&&t&&e.trigger("prev.owl.carousel")})}me.pageSlideShow.checkLoadingProcess(o,e,function(){t&&e.trigger("prev.owl.carousel")})},setOwlCarousel:function(e){var t=$("#page-gallery-photo .center .wrapper");t.css({opacity:"0"});var i={loop:!1,rewind:!0,nav:!1,dots:!1,autoplay:me.pageSlideShow.autoplay,slideSpeed:2e3,autoplayTimeout:5e3,paginationSpeed:1e3,smartSpeed:250,singleItem:!0,items:1,itemClass:"slide owl-item",stageOuterClass:"slides photo owl-stage-outer",stageClass:"slides-frame owl-stage",margin:60,startPosition:e,lazyLoad:!0,lazyLoadEager:2,onInitialized:function(e){setTimeout(function(){t.css({opacity:"1"}),_IS_MOBILE_&&$(".slides .img-span").on("tap",function(){me.pageSlideShow.actionsState=!me.pageSlideShow.actionsState,$(".dots, .footer, .close").toggle()}),me.pageSlideShow.getNumberOfNextItems()||me.pageSlideShow.nextSlideObserver(t,!1),me.pageSlideShow.getNumberOfPrevItems()||me.pageSlideShow.prevSlideObserver(t,!1)},1e3)}};_IS_MOBILE_||(i.animateOut="fadeOut",i.animateIn="fadeIn"),!0===me.pageSlideShow.onePhotoMode&&(i.mouseDrag=!1,i.touchDrag=!1,i.loop=!1,me.pageSlideShow.$playButton.hide()),!0===me.pageSlideShow.disabledSlideShow&&me.pageSlideShow.$playButton.addClass("disabled"),t.owlCarousel(i),$("#page-gallery-photo .right:not(.disabled), #page-gallery-photo .help-text .fmi-key-arrow-right").click(function(){me.pageSlideShow.nextSlideObserver(t)}),$("#page-gallery-photo .left, #page-gallery-photo .help-text .fmi-key-arrow-left").click(function(){me.pageSlideShow.prevSlideObserver(t)}),$(".toolbar .start-slideshow",me.pageSlideShow.modalHandler).length&&!me.pageSlideShow.onePhotoMode&&(me.pageSlideShow.$playButton.on("click",function(){me.pageSlideShow.startAutoplay()}),me.pageSlideShow.$stopButton.on("click",function(){me.pageSlideShow.stopAutoplay()}),me.pageSlideShow.$changeBackroundSongs.on("click",function(){var e=$(this);e.find(".fmi-volume-high").length?(e.find(".fmi-volume-high").removeClass().addClass("fmi-volume-mute"),bgplayer.pause()):(e.find(".fmi-volume-mute").removeClass().addClass("fmi-volume-high"),bgplayer.toggleState(!0),bgplayer.toggle(!0))})),_IS_MOBILE_||$(document).off("keyup").keyup(function(e){me.pageSlideShow.disableActions||$(".footer.editable .edit-area").length||(37==e.keyCode?$("#page-gallery-photo .left, #page-gallery-photo .help-text .fmi-key-arrow-left").first().click():39==e.keyCode&&$("#page-gallery-photo .right:not(.disabled), #page-gallery-photo .help-text .fmi-key-arrow-right").first().click())}),t.on("changed.owl.carousel",function(e){me.pageSlideShow.currentSlidePosition=e.item.index,me.pageSlideShow.setDataToSlideAndFooter(e,this),me.pageSlideShow.setDataToStory(e,this),!0===me.pageSlideShow.autoplay&&me.pageSlideShow.checkNeedSlideLoading(me.pageSlideShow.getNumberOfNextItems())&&(t.trigger("stop.owl.autoplay"),globalLoader.showGlobalLoader(),me.pageSlideShow.slideDataLoading(t,me.pageSlideShow.NEXT_DIRECTION,function(){if(me.pageSlideShow.getNumberOfPrevItems()>2*me.pageSlideShow.countUploadedPage)for(var e=0;e<me.pageSlideShow.countUploadedPage;e++)t.trigger("remove.owl.carousel",[0]),t.trigger("prev.owl.carousel");t.trigger("refresh.owl.carousel"),t.trigger("play.owl.autoplay"),globalLoader.hideGlobalLoader()}))});let o=0,n=null;return t.on("translate.owl.carousel",function(e){n&&clearTimeout(n)}),t.on("translated.owl.carousel",function(e){me.pageSlideShow.isDruggedTriggered&&("left"===me.pageSlideShow.druggedDirection?(me.pageSlideShow.getNumberOfPrevItems()>me.pageSlideShow.countUploadedPage/2&&(o++,n=setTimeout(function(){for(let e=0;e<o;e++)t.trigger("remove.owl.carousel",[0]),t.trigger("prev.owl.carousel"),n=null;o=0},500)),me.pageSlideShow.nextSlideObserver(t,!1)):(me.pageSlideShow.getNumberOfNextItems()>1.5*me.pageSlideShow.countUploadedPage&&t.trigger("remove.owl.carousel",[-1]),me.pageSlideShow.prevSlideObserver(t,!1)),me.pageSlideShow.isDruggedTriggered=!1)}),t.on("dragged.owl.carousel",function(e){me.pageSlideShow.isDruggedTriggered=!0,me.pageSlideShow.druggedDirection=e.relatedTarget._drag.direction}),t.find(".owl-nav").remove(),t},stopAutoplay:function(){var e=$(".gallery-photo-slideshow");e.removeClass("slideshow-played slideshow-paused");var t=me.pageSlideShow,i=$(".overlap",e),o=$(".help-text-wrapper",e);i.off("mousemove click"),i.fadeOut(0),o.fadeOut(0),me.pageSlideShow.exitFullScreen(),t.carousel.trigger("refresh.owl.carousel"),t.carousel.trigger("stop.owl.autoplay"),t.autoplay=!1},pauseAutoplay:function(){var e=me.pageSlideShow,t=$(".gallery-photo-slideshow");t.hasClass("slideshow-played")?(t.removeClass("slideshow-played").addClass("slideshow-paused"),e.carousel.trigger("stop.owl.autoplay"),e.autoplay=!1):(t.removeClass("slideshow-paused").addClass("slideshow-played"),e.carousel.trigger("play.owl.autoplay"),e.autoplay=!0)},playBackgroundSongs:function(){bgplayer.emptyPlayList()||(me.pageSlideShow.$changeBackroundSongs=$(".overlap .change-background-songs",me.pageSlideShow.modalHandler),!0===bgplayer.playing?(!1===bgplayer.isPlaying()&&(bgplayer.toggleState(!0),bgplayer.toggle(!0)),$("#status_song").addClass("fmi-volume-high")):$("#status_song").addClass("fmi-volume-mute"))},startAutoplay:function(){me.pageSlideShow.playBackgroundSongs();var e=me.pageSlideShow;$(".gallery-photo-slideshow").addClass("slideshow-played"),me.pageSlideShow.launchIntoFullScreen(document.documentElement),e.carousel.trigger("refresh.owl.carousel"),me.pageSlideShow.autoplay=!0,me.pageSlideShow.checkNeedSlideLoadingAutoPlay(me.pageSlideShow.getNumberOfNextItems()),me.pageSlideShow.initPause()},initPause:function(){var e=$(".gallery-photo-slideshow"),t=$(".overlap",e),i=$(".overlap",e),o=$(".actions-wrapper",e),n=$(".help-text-wrapper",e),a=function(){return setTimeout(function(){$(".gallery-photo-slideshow").hasClass("slideshow-played")&&me.pageSlideShow.carousel.trigger("play.owl.autoplay"),o.fadeOut("slow"),$(".help-text-wrapper:not(:hover)",e).fadeOut("slow")},1e3)},r=a(),s=0,l=0,d=function(){$(".gallery-photo-slideshow").hasClass("slideshow-played")&&me.pageSlideShow.carousel.trigger("stop.owl.autoplay"),o.fadeIn(0),n.fadeIn(0),clearTimeout(r),r=a()};i.on("mousemove",function(e){0==s&&0==l&&(s=e.pageX,l=e.pageY),e.pageX==s&&e.pageY==l||(s=e.pageX,l=e.pageY,d())}),t.off("click").on("click",function(e){$(e.target).is(".fmi-volume-mute, .fmi-volume-high")||(me.pageSlideShow.pauseAutoplay(),d())})},setDataToStory:function(e,t){var i=$(t).find(".slide"),o={};o=e.item?$(i[me.pageSlideShow.currentSlidePosition]):$(".slide.active",me.pageSlideShow.modalHandler);var n=$(".story-wrapper",o),a=n.parent();if($(window).width()>=_MOBILE_){if(n.height()>0){var r=new Image;r.src=a.parent().find("img").attr("src"),r.onload=function(){var e=this.width,t=this.height,i=e/(t/100)/100,r=0;if(t*a.width()/e*.61-40>n.parent().height())r=(n.height()+35)*i;else{var s=.2*(e=o.width()-60);r=e-n.width()-s}a.find(".story-img").css({width:r+"px","margin-right":"1%"}),a.css({"text-align":"center"}),n.css({float:"initial","margin-left":"1%"})}}}else a.find(".story-img, .story-wrapper").css({width:"100%"})},setDataToSlideAndFooter:function(e,t){var i=$("#page-gallery-photo .main-section .footer"),o=$("#page-gallery-photo .main-section .overlap"),n=$(t).find(".slide"),a=$(n[e.item.index]),r=a.find(".slide-img").data();if(meRouter.setHashAction("|gallery|photo|"+r.oid),$(window).width()<_MOBILE_){$(".story-min-mobile",i).remove(),$(".story-wrapper",a).hide(),$(".story-img",a).show(),me.pageSlideShow.actionsState&&(i.show(),$(".toolbar .wrapper .buttons a.visible",me.pageSlideShow.modalHandler).length&&$(".fmi-dots-three-vertical",me.pageSlideShow.modalHandler).css({opacity:1,visibility:"visible"}));var s=a.find(".story-min-mobile").clone();s.length&&(me.pageSlideShow.actionsState&&s.show(),s.removeClass("hidden").on("click",function(){$(".fmi-dots-three-vertical",me.pageSlideShow.modalHandler).css({opacity:0,visibility:"hidden"}),$(".story-wrapper",a).show(),$(".story-img",a).hide(),i.hide(),s.hide()}),i.append(s))}a.attr("data-perms",r.perms).attr("data-author",r.author).attr("data-author-id",r.authorId).attr("data-oid",r.oid).find(".slide-img").css({opacity:"1"}),i.find(".number").text(r.i),o.find(".number").text(r.i);var l=$(".gallery-photo-slideshow .slide-img[data-oid="+a.find("img").data("oid")+"]").attr("data-title");r.title=l,r.perms.indexOf("t:1")>=0?i.find(".title").html('<a class="editable" href="javascript:void(0)">'+l+"</a>"):i.find(".title").html('<a href="javascript:void(0)">'+l+"</a>"),me.pageGallery_setPerms(r.perms),i.find(".author").text(" by "+r.author),this.currentSlide=a,slideShowActions.setCurrentSlide(a),$(".toolbar, .footer",me.pageSlideShow.modalHandler).removeClass("hidden"),this.editableTitle()},editTitleMobile:function(e){let t="";e.hasClass("no-caption")||e.find(".no-caption").length||(t=e.text());let i=$("<textarea/>").attr("maxlength",190).addClass("title-name").val(t),o=function(){me.pageSlideShow.currentItemObj=$("<div/>").data("oid",slideShowActions.currentSlide.data("oid")),me.pageSlideShow.init()},n=popup.extended({className:"dialog-edit-title-mobile full-height",title:Lang.CHANGE_PHOTO_CAPTION_POPUP_TITLE,message:i,onEscape:function(){o()},onClose:function(){o()},buttons:{Save:{className:"button save",label:Lang.SAVE,callback:function(){return n.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"gallery-edit/rename",{method:"ajax",id:me.pageSlideShow.currentSlide.data("oid"),name:n.find(".title-name").val()},function(e){n.deleteLoaderLayout(),App.ajaxError(e)?jsLogger.showInternalError("j63001",e):(n.modal("hide"),o())},"json").fail(function(e){n.deleteLoaderLayout(),jsLogger.showAjaxFail("j63002",e)}),!1}}}})},editableTitle:function(){let e=$(".main-section .footer .title",me),t=$(">a",e);return t.on("click",function(){return t.hasClass("editable")&&(eventTracking.run("edit_title","user_actions","photo_slideshow"),_IS_MOBILE_?me.pageSlideShow.editTitleMobile($(this)):(t.hide(),me.pageGallery_editTitleInline(e,t,me.pageSlideShow.currentSlide.data("oid"),function(){t.show(),me.pageSlideShow.updateTitle()}))),!1}),this.updateTitle(),e},updateTitle:function(){var e=$("img",this.currentSlide),t=e.attr("data-title"),i=e.data("author"),o=e.data("perms"),n=e.data("oid"),a=$(".footer .title a",this.modalHandler);if(t||(t=$(".footer .title",this.modalHandler).text()),i||(i=$(".footer .author",this.modalHandler).text()),a.text(typeof t===ud?"":t.replace(/^\s*/,"").replace(/\s*$/,"")),o.indexOf("t:1")>=0){let e=Lang.LARGE_PHOTO_VIEW_BY_AUTHOR.replace("{author_full_name}",typeof i===ud?"":"<a href='javascript:void(0)'>"+i+"</a>");$(".footer .author",this.modalHandler).html(e)}else{var r=$('.slide[data-oid="'+n+'"]').attr("data-author-id");let e=Lang.LARGE_PHOTO_VIEW_BY_AUTHOR.replace("{author_full_name}",typeof i===ud?"":"<a class='contact' data-author-contact-id='"+r+"' class='contact' href='javascript:void(0)'>"+i+"</a>");$(".footer .author",this.modalHandler).html(e)}!a.text()&&a.hasClass("editable")&&a.html('<span class="no-caption">'+Lang.ADD_CAPTION_HERE+"</span>")},afterInit:function(e){me.pageSlideShow.addFullScreenEventListeners(),e&&e()},launchIntoFullScreen:function(e){me.pageSlideShow.isFullScreenMode||(e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen())},exitFullScreen:function(){me.pageSlideShow.isFullScreenMode&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())},addFullScreenEventListeners:function(){FShandler=function(e){document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement?me.pageSlideShow.isFullScreenMode=!0:(me.pageSlideShow.isFullScreenMode=!1,me.pageSlideShow.stopAutoplay())},document.addEventListener("fullscreenchange",FShandler),document.addEventListener("webkitfullscreenchange",FShandler),document.addEventListener("mozfullscreenchange",FShandler),document.addEventListener("MSFullscreenChange",FShandler)},slideDataLoading:function(e,t,i){let o={onePhotoMode:!1,direction_slide:t},n=0;const a=Number($(".counter .total").text()),r=$(".slides-frame.owl-stage").find(".slide.owl-item:not(.cloned)");me.pageSlideShow.isLoadingData=!0,t===me.pageSlideShow.NEXT_DIRECTION&&r.last().find(".slide-img")&&r.last().find(".slide-img").data()?n=r.last().find(".slide-img").data().oid:r.first().find(".slide-img")&&r.first().find(".slide-img").data()&&(n=r.first().find(".slide-img").data().oid),o.current_slide_id=n,$.ajax({url:window.AppMemorial_config.baseUrl+"gallery/get-slides",data:o,method:"post",dataType:"json",success:function(o){if(1==o.success){var r=o.currentPosition;o.onePhotoMode&&(me.pageSlideShow.onePhotoMode=!0,me.pageSlideShow.disableActions=!0),me.pageSlideShow.slideFormation(o.slides,null,null,n,r,e,a,t),"function"==typeof i&&i(),me.pageSlideShow.isLoadingData=!1,globalLoader.hideGlobalLoader()}}})},slideFormation:function(slides,currentSlide,itemsWrapper,itemId,numberSlide,owl,allPhotos,directionSlide){return currentSlide=currentSlide||0,itemsWrapper=itemsWrapper||null,owl=owl||null,allPhotos=allPhotos||0,directionSlide=directionSlide||!1,$(slides).each(function(key,data){var imgWrapper=$("<span/>",{class:"img-wrapper"}).attr("ordering",data.ordering);data.id==itemId&&(currentSlide=key);var itemImg=$("<span/>",{class:"slide-img-span"});!1===directionSlide&&(numberSlide+=1),directionSlide===me.pageSlideShow.NEXT_DIRECTION?(numberSlide==allPhotos&&(numberSlide=0),numberSlide+=1):directionSlide===me.pageSlideShow.PREVIOUS_DIRECTION&&(numberSlide-=1,0==numberSlide&&(numberSlide=allPhotos));var itemImgHidden=$("<img/>",{class:"slide-img owl-lazy","data-src":data.url,alt:data.title,style:"opacity:0","data-author":data.author,"data-author-id":data.author_id,"data-title":data.title,"data-i":numberSlide,"data-oid":data.id,"data-perms":data.perms,"data-story-id":data.story_id}).css({visibility:"hidden"});if(data.is_story)itemImg.addClass("story");else{var itemSlideImg=$("<span/>",{class:"img-span owl-lazy"}).attr("data-src",window.AppMemorial_config.baseSiteUrl+data.url.substr(1));itemSlideImg.append(itemImgHidden),itemImg.html(itemSlideImg[0].outerHTML)}if(imgWrapper.append(itemImg),data.is_story){var stories=eval(data.stories.replace(/[\r\n]/,"")),storyMobile='<button class="story-min-mobile hidden" style="display: none;"><i class="fmi-story"></i></button>',storyWrapper=$("<span/>",{class:"story-wrapper"});$(".slide-img-span",imgWrapper).css({float:"left"}),$.each(stories,function(e,t){storyWrapper.append($("<span/>",{class:"hide-story-mobile"}).html("<i class='fmi-close'></i>")),t.story_title&&storyWrapper.append($("<h3/>",{class:"story-title"}).text(t.story_title)),storyWrapper.append($("<div/>",{class:"story-author"}).html(Lang.SLIDESHOW_STORY_SHARED_BY_AUTHOR.replace("{story_author}",t.story_author))),storyWrapper.append($("<div/>",{class:"story-text"}).html(t.story_text)),t.story_author.indexOf("editable")>-1&&storyWrapper.append($("<div/>",{class:"story-edit"}).html('<a class="slide-edit-store" href="javascript:void(0)" data-oid="'+t.story_id+'" data-ajax-url="/stories?entity_id='+t.story_id+'"><i class="fmi-pen-border zoom"></i>'+Lang.EDIT+"</a>"))});var imgHtml=$("<span/>",{class:"story-img img-span",style:"background: url("+window.AppMemorial_config.baseSiteUrl+data.url.substr(1)+")"}).append(itemImgHidden);$(".slide-img-span",imgWrapper).html(imgHtml[0].outerHTML+storyMobile+storyWrapper[0].outerHTML)}itemsWrapper?itemsWrapper.append(imgWrapper):directionSlide===me.pageSlideShow.NEXT_DIRECTION?owl.trigger("add.owl.carousel",[imgWrapper[0].outerHTML]):directionSlide===me.pageSlideShow.PREVIOUS_DIRECTION&&(owl.trigger("add.owl.carousel",[imgWrapper[0].outerHTML,0]),owl.trigger("next.owl.carousel"))}),currentSlide},checkAllItemsOnSlideShow:function(){return Number($(".counter .total").text())!==Number($(".slides-frame.owl-stage").find(".slide.owl-item:not(.cloned)").length)}},me.pageVideoView={currentItemObj:!1,disableActions:!1,youtubePlayer:{},actionsState:1,modalHandler:{},currentSlide:{},init:function(e,t){console.log("pageVideoView - loaded"),this.currentItemObj=t,this.getVideoViewHTML(),this.afterInit(e),this.contactAuthor()},getVideoViewHTML:function(){var e=window.AppMemorial_config.baseUrl+"gallery/video/"+this.currentItemObj.data("oid");globalLoader.showGlobalLoader(),$.ajax({url:e,type:"POST",data:{},success:function(e){var t={className:"gallery-video-slideshow",message:e,onEscape:function(){return $(".footer.editable .edit-area").length?($(".footer.editable .edit-area .cancel").trigger("click"),$(".gallery-video-slideshow").focus()):(bgplayer.playVideo(),mediaPlayer.playVideo(),bootbox.hideAll()),!1},onClose:function(){bgplayer.playVideo(),mediaPlayer.playVideo(),bootbox.hideAll()}};popup.extendedBlackFullScreen(t),me.pageVideoView.modalHandler=$(".gallery-video-slideshow"),me.pageVideoView.currentItemObj.attr("data-perms",me.pageVideoView.modalHandler.find(".slide").data("perms")),me.pageVideoView.currentItemObj.attr("data-title",me.pageVideoView.modalHandler.find(".name .title a").text()),me.pageVideoView.modalHandler.find(".video-player").length||me.pageVideoView.modalHandler.find(".icons").remove(),me.pageVideoView.modalHandler.find(".slide").data("perms").search("t:1")>=0&&me.pageVideoView.modalHandler.find(".name .title a").addClass("editable"),setTimeout(function(){(me.pageVideoView.modalHandler.css({"padding-right":"0px"}).find(".slides-frame .hidden").removeClass("hidden"),slideShowActions.galleryType="video",slideShowActions.setCurrentSlide(me.pageVideoView.currentItemObj),me.pageVideoView.disableActions?$(".left, .right, .counter",me.pageVideoView.modalHandler).hide():($(".counter",me.pageVideoView.modalHandler).show(),$(window).width()>=_MOBILE_?$(".left, .right, .story-wrapper",me.pageVideoView.modalHandler).show():($(".footer .story-min-mobile",me.pageVideoView.modalHandler).show(),$(".left, .right",me.pageVideoView.modalHandler).show())),me.pageVideoView.setToolbarPerms(),slideShowActions.setActionsToSliderHeader(me.pageVideoView.modalHandler),me.pageVideoView.editableTitle(),bgplayer.pauseVideo(),mediaPlayer.pauseVideo(),globalLoader.hideGlobalLoader(),"youtube"==me.pageVideoView.currentItemObj.data("type")&&($("#page-gallery-video .rotate-left").hide(),$("#page-gallery-video .rotate-right").hide(),$("#page-gallery-video .download").hide(),me.pageVideoView.initYoutubeApi()),_IS_MOBILE_)?$(me.pageVideoView.modalHandler).on("tap",".slides .slide .video-player",function(){me.pageSlideShow.actionsState=!me.pageSlideShow.actionsState,$(".dots, .footer, .close").toggle()}):$(".video-player",me.pageVideoView.modalHandler).width()<$(".video-player",me.pageVideoView.modalHandler).height()?$(".video-player",me.pageVideoView.modalHandler).css("minHeight","50%"):$(".video-player",me.pageVideoView.modalHandler).css("minWidth","50%");$(".slide.active",me.pageVideoView.modalHandler).data("story-id")&&$.ajax({url:window.AppMemorial_config.baseUrl+"gallery/story/"+$(".slide.active",me.pageVideoView.modalHandler).data("oid"),type:"POST",data:{},success:function(e){var t=$(".slide.active",me.pageVideoView.modalHandler);$(window).width()>=_MOBILE_?(t.append(e.page),$("#page-gallery-video .stories-section").show()):t.append(e.page),t.addClass("story"),$(me.pageVideoView.modalHandler).on("click",".story-wrapper .slide-edit-store",function(){var e=$(this).data("oid");me.loadAndGotToBlock($(this),function(){$("html, body").animate({scrollTop:$(".stories-page .story[data-oid='"+e+"']").offset().top-40},100),me.pageVideoView.modalHandler.modal("hide"),me.pageStories.stories_openEditDialog(e)})}),$(me.pageVideoView.modalHandler).on("click",".hide-story-mobile",function(){$(this).parent().toggle(),$(".video-player",me.pageVideoView.modalHandler).show(),$(".footer",me.pageVideoView.modalHandler).toggle().find(".story-min-mobile").toggle(),$(".toolbar .wrapper .buttons a.visible",me.pageVideoView.modalHandler).length&&$(".fmi-dots-three-vertical",me.pageVideoView.modalHandler).css({opacity:1,visibility:"visible"})}),$(".footer",me.pageVideoView.modalHandler).css({"padding-top":"0"}),$(window).width()<_MOBILE_&&me.pageVideoView.addShowStoryFooterButton()}}),$(".toolbar, .footer",me.pageVideoView.modalHandler).removeClass("hidden")},300)}})},contactAuthor:function(){$("body").off("click.open_contact").on("click.open_contact","a[data-author-contact-id]",function(){if(auth.isSignedIn()){var e=$(this).data("author-contact-id"),t=meRouter.getCurrentAnchorAction();me.contact.open(e,null,null,function(){meRouter.setHashAction(t),meRouter.goToHashAction()})}else auth.open();return!1})},initYoutubeApi:function(){if(me.pageVideoView.youtubePlayer.loadVideoById!=un)me.pageVideoView.onYouTubeIframeAPIReady();else{var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),window.onYouTubeIframeAPIReady=function(){me.pageVideoView.onYouTubeIframeAPIReady()}}},onYouTubeIframeAPIReady:function(){var e=$("#youtube");me.pageVideoView.youtubePlayer=new YT.Player("youtube",{height:"100%",width:"100%",videoId:e.attr("data-file"),events:{onReady:me.pageVideoView.onPlayerReady,onStateChange:me.pageVideoView.onPlayerStateChange}})},onPlayerReady:function(e){},onPlayerStateChange:function(e){1!=e.data&&2!=e.data||_IS_MOBILE_&&$(".footer .story-min-mobile",me.pageVideoView.modalHandler).toggle()},setToolbarPerms:function(){var e=$("#page-gallery-video .slide.active.video-slide"),t=e.data();e.attr("data-perms",t.perms).attr("data-author",t.author).attr("data-oid",t.oid),e.find(".slide-img").css({opacity:"1"}),me.pageGallery_setPerms(t.perms),this.currentSlide=e,slideShowActions.setCurrentSlide(e)},addShowStoryFooterButton:function(){var e=$("#page-gallery-video .main-section .footer"),t=$("#page-gallery-video .slide.active.video-slide");$(".story-min-mobile",e).remove(),$(".story-wrapper",t).hide(),$(".video-player",t).show(),me.pageVideoView.actionsState&&(e.show(),$(".toolbar .wrapper .buttons a.visible",me.pageVideoView.modalHandler).length&&$(".fmi-dots-three-vertical",me.pageVideoView.modalHandler).css({opacity:1,visibility:"visible"}));var i=t.find(".story-min-mobile").clone();i.length&&(me.pageVideoView.actionsState&&i.show(),i.removeClass("hidden").on("click",function(){$(".fmi-dots-three-vertical",me.pageVideoView.modalHandler).css({opacity:0,visibility:"hidden"}),$(".story-wrapper",t).show(),$(".video-player",t).hide(),e.hide(),i.hide()}),e.append(i))},editableTitle:function(){var e=$(".main-section .footer .title",me),t=$(">a",e);return t.on("click",function(){if(t.hasClass("editable"))if(eventTracking.run("edit_title","user_actions","video_slideshow"),_IS_MOBILE_){var i="";$(this).hasClass("no-caption")||$(this).find(".no-caption").length||(i=$(this).text());var o=$("<textarea/>").attr("maxlength",190).addClass("title-name").val(i),n=function(){slideShowActions.currentSlide.click(),$("#page-gallery-videos [data-oid="+slideShowActions.currentSlide.data("oid")+"] img").click()},a=popup.extended({className:"dialog-edit-title-mobile full-height",title:Lang.CHANGE_VIDEO_CAPTION_POPUP_TITLE,message:o,onEscape:function(){n()},onClose:function(){n()},buttons:{Save:{className:"button save",label:Lang.SAVE,callback:function(){return a.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"gallery-edit/rename",{method:"ajax",id:slideShowActions.currentSlide.data("oid"),name:a.find(".title-name").val()},function(e){a.deleteLoaderLayout(),e.error?jsLogger.showInternalError("j64001",e):(a.modal("hide"),meRouter.goToHashAction())},"json").fail(function(e){jsLogger.showAjaxFail("j64002",e)}),!1}}}})}else t.hide(),me.pageGallery_editTitleInline(e,t,slideShowActions.currentSlide.data("oid"),function(){t.show()});return!1}),this.updateTitle(),e},updateTitle:function(){var e=$("img",this.currentSlide),t=e.attr("alt"),i=e.data("author"),o=e.parents(".video-slide").data("perms"),n=e.parents(".video-slide").data("oid"),a=$(".footer .title a",this.modalHandler);if(t||(t=$(".footer .title",this.modalHandler).text()),i||(i=$(".footer .author",this.modalHandler).attr("author-full-name")),a.text(typeof t===ud?"":t.replace(/^\s*/,"").replace(/\s*$/,"")),o.indexOf("t:1")>=0)$(".footer .author",this.modalHandler).html("by&nbsp"+(typeof i===ud?"":"<a href='javascript:void(0)'>"+i+"</a>"));else{var r=$('.item[data-oid="'+n+'"]').find("[data-contact-id]").attr("data-contact-id");$(".footer .author",this.modalHandler).html("by&nbsp"+(typeof i===ud?"":"<a class='contact' data-author-contact-id='"+r+"' class='contact' href='javascript:void(0)'>"+i+"</a>"))}!a.text()&&a.hasClass("editable")&&a.html('<span class="no-caption">'+Lang.ADD_CAPTION_HERE+"</span>")},afterInit:function(e){e&&e()}};var pageGallery_applyShareButtons=function(e){var t=e.data("oid"),i="|share|"+($("a.video",e).length?"video":"photo")+"|"+t+"|";$(".share-facebook",e).attr("data-ajax-url",i+"facebook").attr("href","#"+i+"facebook"),$(".share-email",e).attr("data-ajax-url",i+"email").attr("href","#"+i+"email"),$(".share-other",e).attr("data-ajax-url",i+"other").attr("href","#"+i+"other")};me.pageGallery_showActionBar=function(e,t){e.find(".actions-wrapper").addClass("view-action")},me.changePermsToItems=function(e){e.each(function(e,t){var i=$(t),o=i.data("perms");$(".options .list .option-item",i).each(function(e,t){var i=$(t).data("perm-id");o.indexOf(i+":1")<0&&$(t).remove()}),$(".options .list .option-item",i).length>4?$(".options .list",i).addClass("col-2"):$(".options .list",i).addClass("col-1")})},me.pageGallery_hideActionBar=function(e,t){var i=$(".action-bar",e);typeof $.support.transition.end===ud||typeof t!==ud&&t?i.detach():i.removeClass("visible").one($.support.transition.end,function(){i.hasClass("visible")||i.detach()}).emulateTransitionEnd(900)},me.isPermsChangedCoverPhoto=function(){return 1==window.AppMemorial_config.is_edit_cover_photo},me.pageGallery_getPerms=function(e){var t=e.data("permsObject");return typeof t!==ud?t:!!(t=e.data("perms"))&&(t=t.replace(/(\w+)\:/g,'"$1":'),t=$.parseJSON(t),e.data("permsObject",t),t)},me.pageGallery_updatePerms=function(e,t,i){var o=me.pageGallery_getPerms(e);o&&(o[t]=i)},me.pageGallery_loadEditBundle=function(e){},me.pageGallery_handleActionClick=function(e,t,i){var o=$(this),n=o.data("action");if("string"==typeof n&&typeof t[n]!==ud){typeof i===ud&&(i=o.closest("[data-oid]").data("oid"));var a=o.closest("[data-oid]"),r=t[n](e,i,o,a);return typeof r!==ud&&r}throw"Unknown action ["+n+"]"},me.pageGallery_afterDelete=function(e,t){let i=$(".uploader"),o=$("form",i),n=$(".content .items-list .item").length,a=function(){t?(t(e),!e.hasClass("video-slide")&&$(".content .items-list .item").length?me.pageSlideShow.fromStory?me.loadBlock("pageContent"):me.pageSlideShow.init(!1):e.hasClass("video-slide")&&meRouter.unSetCurrentHashAction()):me.asideSlideshow.removeSlide(e.data("oid"))};$(".uploader form.premium-contribute").length||1==n?me.loadBlock("pageContent",function(){a()}):e.slideUp("slow",function(){e.detach();var t=o.data("max-files");$.isNumeric(t)&&i.trigger("countChanged",t-n),me.sortable_reindex($(".content .items-list .item")),a()})},me.pageGallery_setPerms=function(e){e.indexOf("t:1")>=0?($(".toolbar .edit-caption").addClass("visible"),$(".toolbar .edit-caption").removeClass("not-visible")):($(".toolbar .edit-caption").removeClass("visible"),$(".toolbar .edit-caption").addClass("not-visible")),e.indexOf("del:1")>=0?($(".toolbar .delete").addClass("visible"),$(".toolbar .delete").removeClass("not-visible")):($(".toolbar .delete").removeClass("visible"),$(".toolbar .delete").addClass("not-visible")),e.indexOf("r:1")>=0?($(".toolbar .rotate-left, .toolbar .rotate-right").addClass("visible"),$(".toolbar .rotate-left, .toolbar .rotate-right").removeClass("not-visible")):($(".toolbar .rotate-left, .toolbar .rotate-right").removeClass("visible"),$(".toolbar .rotate-left, .toolbar .rotate-right").addClass("not-visible")),e.indexOf("ts:1")>=0?($(".toolbar .tell-story").addClass("visible"),$(".toolbar .tell-story").removeClass("not-visible")):($(".toolbar .tell-story").removeClass("visible"),$(".toolbar .tell-story").addClass("not-visible")),e.indexOf("cp:1")>=0?($(".toolbar .set-cover").addClass("visible"),$(".toolbar .set-cover").removeClass("not-visible")):($(".toolbar .set-cover").removeClass("visible"),$(".toolbar .set-cover").addClass("not-visible")),e.indexOf("rc:1")>=0?($(".toolbar .remove-cover").addClass("visible"),$(".toolbar .remove-cover").removeClass("not-visible")):($(".toolbar .remove-cover").removeClass("visible"),$(".toolbar .remove-cover").addClass("not-visible")),e.indexOf("dw:1")>=0?($(".toolbar .download").addClass("visible"),$(".toolbar .download").removeClass("not-visible")):($(".toolbar .download").removeClass("visible"),$(".toolbar .download").addClass("not-visible"))};const gpd=me.googlePhotoDownloader={gapi:null,layoutUrl:null,albumsUrl:null,photosUrl:null,downloadUrl:null,token:null,remainingFiles:null,targetEntity:"gallery",loadOnlyOne:!1,enteredCaptions:[],body:null,onClose:null,$modal:null,setGapi(e){return this.gapi=e,this},setLayoutUrl(e){return this.layoutUrl=e,this},setAlbumsUrl(e){return this.albumsUrl=e,this},setPhotosUrl(e){return this.photosUrl=e,this},setDownloadUrl(e){return this.downloadUrl=e,this},init(){this.$modal=null,$(".provider.google-photo").click(this.openGooglePhotoProvider)},close(){"function"==typeof gpd.onClose&&gpd.onClose(this),gpd.$modal&&gpd.$modal.length&&gpd.$modal.modal("hide"),gpd.gapi.signOut()},async openGooglePhotoProvider(e){const t=["https://www.googleapis.com/auth/photoslibrary.readonly"].join(" ");let i=gpd.gapi.currentUser.get();i.hasGrantedScopes(t)||(i=await gpd.gapi.signIn({prompt:"select_account",scope:t,ux_mode:"popup"})),gpd.targetEntity=e.targetEntity?e.targetEntity:"gallery",gpd.loadOnlyOne=!!e.loadOnlyOne&&e.loadOnlyOne,gpd.token=await i.reloadAuthResponse(),gpd.createModal(e.onClose?e.onClose:null)},async initAlbum(){this.$contentBody=$("#google_content_wrapper",this.$modal),this.$contentBody.html(""),this.enteredCaptions=[],globalLoader.showGlobalLoader(!0,!0);try{const{page:e}=await $.ajax(this.layoutUrl,{method:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify({token:this.token,pageToken:null})});this.$contentBody.html(e);const t=meRouter.isCurrentRoute("lifestory")||meRouter.isCurrentRoute("stories")?1:$("#google_content",this.$contentBody).data("files-limit");this.remainingFiles=""===t?null:t+0}catch(e){jsLogger.showErrorResponse("j61001",e,this.close)}globalLoader.hideGlobalLoader();const e=Vue.createApp({data:()=>({ready:!1,step:1,currentAlbumTitle:null,albumsSource:window.AppMemorial_config.googleAlbumSource.your}),mounted(){this.ready=!0},computed:{isMobile:()=>_IS_MOBILE_},methods:{goBack(){gpd.body.goBack()}}}).mount("div.modal.facebook-photo-downloader .modal-header .modal-title");this.body=Vue.createApp({data:()=>({yourAlbums:[],sharedAlbums:[],photos:[],yourNextAlbumPageToken:null,sharedNextAlbumPageToken:null,nextPhotoPageToken:null,step:1,selectedIds:[],photoCache:[],nestedImageRequest:0,currentAlbum:null,disabledSaveButton:!1,totalSelectedCount:0,title:e,albumsSource:window.AppMemorial_config.googleAlbumSource.your,loadOnlyOne:gpd.loadOnlyOne,lastPhotoPageSize:0,lastPageSize:0,loaded:!1}),async created(){this.init(),await this.loadAlbums([])},watch:{albumsSource(e){this.title.albumsSource=e,this.lastPageSize=this.albumsSource===window.AppMemorial_config.googleAlbumSource.your?this.lastYourPageSize:this.lastSharedPageSize},step(e){this.title.step=e},currentAlbum(e){if(null===e)return;const t=this.albums[e];this.title.currentAlbumTitle=t.title},photos(e){let t=null;e.forEach(e=>{t!==e.created.year&&(t=e.created.year,e.groupTitle=t)}),this.photos=e},lastYourPageSize(e){this.lastPageSize=e},lastSharedPageSize(e){this.lastPageSize=e}},computed:{albums(){return this.albumsSource===window.AppMemorial_config.googleAlbumSource.your?this.yourAlbums:this.sharedAlbums},nextAlbumPageToken(){return this.albumsSource===window.AppMemorial_config.googleAlbumSource.your?this.yourNextAlbumPageToken:this.sharedNextAlbumPageToken},isMobile:()=>_IS_MOBILE_,currentAlbumId(){return null!==this.currentAlbum?this.albums[this.currentAlbum].id:null},currentAlbumTitle(){return null!==this.currentAlbum?this.albums[this.currentAlbum].title:""},selectedAlbumsText(){return`${this.selectedAlbums} album${this.selectedAlbums>1?"s":""}`},currentAlbumSelectedCounter(){return null===this.currentAlbum?0:this.albums[this.currentAlbum].counter},selectedAlbums(){let e=0;return this.yourAlbums.forEach(t=>{t.counter<=0||e++}),this.sharedAlbums.forEach(t=>{t.counter<=0||e++}),e},showSaveButton(){return 1===this.step},showBackButton(){return 2===this.step},showButtonWrapper(){return this.selectedIds.length>0||this.isMobile||2===this.step},disableSaveButton(){return this.disabledSaveButton||this.selectedIds.length<1},hideNoPhotos(){return this.photos.some(function(e){return e.photo})}},methods:{init(){this.photos=[],this.nextPhotoPageToken=null,this.step=1,this.lastPhotoPageSize=0},closeModal(){gpd.close()},async loadAlbums(e=null){if(!$(this).lockCheck("load-albums")){$(this).lockOn("load-albums"),0===this.albums.length&&globalLoader.showGlobalLoader(!0,!0);try{const{nextPageToken:t,albums:i}=await $.ajax(gpd.albumsUrl,{method:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify({token:gpd.token,pageToken:this.nextAlbumPageToken,albumsSource:this.albumsSource})});switch(e=e||this.albums,this.lastPageSize=i.length,this.albumsSource){case window.AppMemorial_config.googleAlbumSource.your:this.yourNextAlbumPageToken=t,this.yourAlbums=e.concat(i);break;case window.AppMemorial_config.googleAlbumSource.shared:this.sharedNextAlbumPageToken=t,this.sharedAlbums=e.concat(i)}}catch(e){jsLogger.showErrorResponse("j61002",e,this.close)}this.loaded=!0,globalLoader.hideGlobalLoader(),$(this).lockOff("load-albums")}},async onAlbumsScroll(){$("li.album-item div[data-next-page-token]").visible()&&await this.loadAlbums()},async onPhotosScroll(){$("li.album-photo div[data-next-page-token]").visible()&&await this.loadPhotos()},async showAlbumPhotos(e){this.currentAlbum=e,this.nextPhotoPageToken=null,this.photos=[],this.step=2,this.loaded=!1,await this.loadPhotos()},async loadPhotos(){if($(this).lockCheck("load-photos"))return;$(this).lockOn("load-photos");const e=this.photos,t=this.albums[this.currentAlbum],i={method:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify({token:gpd.token,pageToken:this.nextPhotoPageToken,albumId:t.id})};0===this.photos.length&&globalLoader.showGlobalLoader(!0,!0);try{const{nextPageToken:t,photos:o}=await $.ajax(gpd.photosUrl,i);this.nextPhotoPageToken=t,this.lastPhotoPageSize=o.length,this.photos=e.concat(o)}catch(e){jsLogger.showErrorResponse("j61003",e,this.close)}this.loaded=!0,globalLoader.hideGlobalLoader(),$(this).lockOff("load-photos")},goBack(){this.currentAlbum=null,this.step=1,this.photos=[]},clearSelected(){this.selectedIds=[],this.albums.forEach(e=>{e.counter=0}),this.totalSelectedCount=this.selectedIds.length},async downloadPhoto(e){const t=await $.ajax(gpd.downloadUrl,{method:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify({token:gpd.token,photoId:e})});if(0===t.success)throw t.error_string;return t},async clickPhoto(e){const t=this.photos[e];if(this.isDownloaded(t.id))return void this.photoRemoveFromList(t.id);if(null!==gpd.remainingFiles&&gpd.remainingFiles>0&&this.selectedIds.length>=gpd.remainingFiles){if(!this.loadOnlyOne)return void popup.error(Lang.FACEBOOK_DOWNLOADER_MAX_PHOTO_LIMIT_REACHED.format(window.AppMemorial_config.maxPhotoLimit),"facebook-max-limit-reached");this.clearSelected()}const i=this.currentAlbum;this.disabledSaveButton=!0;try{if(this.photoAddToList(t.id),this.nestedImageRequest+=1,!this.loadOnlyOne){const e=await this.downloadPhoto(t.id);this.cachePhoto(e)}}catch(e){this.photoRemoveFromList(t.id,i),jsLogger.showErrorResponse("j61004",e,this.close)}finally{this.nestedImageRequest-=1,this.disabledSaveButton=this.nestedImageRequest>0}},cachePhoto(e){void 0!==e.gid&&(this.photoCache[e.gid]=e)},photoAddToList(e){this.selectedIds.push(e),this.albumCounterIncrease()},photoRemoveFromList(e,t){const i=this.selectedIds.indexOf(e);i>-1&&this.selectedIds.splice(i,1),this.albumCounterDecrease(t)},isDownloaded(e){return-1!==this.selectedIds.indexOf(e)},albumCounterIncrease(){if(null===this.currentAlbum)return;this.albums[this.currentAlbum].counter++,this.totalSelectedCount=this.selectedIds.length},albumCounterDecrease(e=null){if(null===(e=e||this.currentAlbum))return;this.albums[e].counter--,this.totalSelectedCount=this.selectedIds.length},async saveSelected(){this.loadOnlyOne?gpd.close():(eventTracking.run("photo","content_additions","FB"),globalLoader.showGlobalLoader(!0,!0),await this.allDone(),this.selectedIds=[],me.cleanAboutPageCache(),globalLoader.hideGlobalLoader())},async savePhotos(e){await $.ajax({url:window.AppMemorial_config.baseUrl+"upload/photo",data:{names:JSON.stringify(e),_method:"SAVE"},type:"post",async:!1,cache:!1,dataType:"json"})},async allDone(){const e=[];if(this.selectedIds.forEach(t=>{const i=this.photoCache[t];e.push({id:i.id,title:"",target_entity:this.targetEntity})}),e.length)try{await this.savePhotos(e)}catch(e){jsLogger.showErrorResponse("j61005",e,this.close)}finally{const e=me.getMainPhotoId();me.loadBlock("titlePhoto",()=>{!e&&me.getMainPhotoId()&&_IS_MOBILE_?meRouter.moveToAbout():!e&&me.getMainPhotoId()?me.loadBlock("pageContent",()=>{meRouter.scrollTo(0)},!0):me.loadBlock("pageContent",()=>{me.scrollTop($("#pg").offset().top)},!0)}),me.loadBlock("mobileInnerPageTitle"),me.loadBlock("subscription"),me.loadBlock("slideshow"),me.loadBlock("activities"),$(me).trigger("checkGalleryMedia"),me.setAsideSlideshow(),gpd.close()}},async changeAlbumSource(){this.albums.length>0||(this.init(),this.loaded=!1,await this.loadAlbums())},async changeAlbumsSource(e){this.albumsSource!==e&&(this.albumsSource=e,await this.changeAlbumSource())}}}).mount("#google_content_wrapper")},createModal(e){const t=[`<span style="display: none;" v-show="ready" v-if="isMobile && albumsSource == '${window.AppMemorial_config.googleAlbumSource.your}' && step == 1">${Lang.YOUR_GOOGLE_ALBUMS}</span>`,`<span style="display: none;" v-show="ready" v-if="isMobile && albumsSource == '${window.AppMemorial_config.googleAlbumSource.shared}' && step == 1">${Lang.SHARED_GOOGLE_ALBUMS}</span>`,'<span style="display: none;" v-show="ready" v-if="isMobile && step == 2"><i class="fmi-back-arrow" @click="goBack"></i>{{ currentAlbumTitle }}</span>',`<span style="display: none;" v-show="ready" v-if="!isMobile"><i class="fmi-add-camera"></i>${Lang.GOOGLE_CHOOSE_ALBUM}</span>`];this.onClose=e,this.$modal=popup.extended({iconClass:"fmi-add-camera",className:"facebook-photo-downloader modal-full-white google-photo-downloader",closeButton:!1,title:t.join(""),message:'<span id="google_content_wrapper"></span>',onEscape:()=>{gpd.close()},onClose:()=>{gpd.close(),_IS_MOBILE_&&(meRouter.isCurrentRoute("lifestory")?me.pageLifeStories.openPreviousPopup():meRouter.isCurrentRoute("stories")&&me.pageStories.openPreviousPopup()),null!==e&&e(gpd.getFirstPhotoId())}}).on("shown.bs.modal",async()=>{meRouter.setHashAction("|google-dialog"),await this.initAlbum()})},getFirstPhotoId(){return this.body.selectedIds.length>0?this.body.selectedIds[0]:null}};!function(e,t,i){introSteps=function(){var e={},i={},o={previousTarget:""};return e.options={instance:[],steps:{admin_menu:{targetElement:"#menu_memorial #memorial-admin-menu",targetElementMobile:"#mobile-action-menu .drop-button",title:"",additionalClass:"",placement:"top",placementMobile:"top",offsetMobile:"",buttonLabel:Lang.INTRO_STEP_GOT_IT_BUTTON,overlay:!1,eventLabel:"Tooltip: Admin Menu",eventLabelMobile:"Tooltip: Admin Menu mobile",fixPosition:!1,scrollToTheTarget:!0,hideOnClick:!1,isSpecial:!1,addBorderRadius:!1,showCallback:function(){},callback:function(){i.showGeneralUserTooltips()}},edit_info:{targetElement:"#page-about .edit-memorial-info.desktop-only",targetElementMobile:"#page-about .edit-memorial-info.mobile-only",title:"",additionalClass:"",placement:"bottom",placementMobile:"bottom",page:"/about",buttonLabel:Lang.INTRO_STEP_GOT_IT_BUTTON,overlay:!1,eventLabel:"Tooltip: Edit Info",eventLabelMobile:"Tooltip: Edit Info mobile",scrollToTheTarget:!0,hideOnClick:!1,fixPosition:!0,isSpecial:!1,callback:function(){i.showGeneralUserTooltips()}},invite:{targetElement:".share-blocks-wrapper",targetElementMobile:".additional-mobile-info .social.mobile a",title:"",additionalClass:"",placement:"left",placementMobile:"bottom",overlay:!1,eventLabel:"Tooltip: Invite",eventLabelMobile:"Tooltip: Invite mobile",buttonLabel:Lang.INTRO_STEP_GOT_IT_BUTTON,fixPosition:!0,scrollToTheTarget:!0,addBorderRadius:!0,hideOnClick:!1,isSpecial:!1,callback:function(){i.showGeneralUserTooltips()}},bg_music:{targetElement:"#menu_top li.sound",targetElementMobile:"#top_mob_snd_btn",title:"",additionalClass:"",placement:"bottom",placementMobile:"bottom",overlay:!1,eventLabel:"Tooltip: BG Music",eventLabelMobile:"Tooltip: BG Music mobile",offsetDesk:[0,12],offsetMobile:"",scrollToTheTarget:!0,fixPosition:!1,hideOnClick:!1,isSpecial:!0,is_repeatable:!0,buttonLabel:Lang.INTRO_STEP_GOT_IT_BUTTON,callback:function(){i.showGeneralUserTooltips()}},change_cover_photo:{targetElement:"#photo-memorial .open-slide-cover",targetElementMobile:"#photo-memorial-mobile .open-slide-cover",title:"",additionalClass:"",placement:"left",placementMobile:"bottom",overlay:!1,eventLabel:"Tooltip: Change Cover Photo",eventLabelMobile:"Tooltip: Change Cover Photo mobile",offsetMobile:"",scrollToTheTarget:!0,fixPosition:!1,hideOnClick:!1,isSpecial:!1,is_repeatable:!1,withoutArrow:!1,buttonLabel:Lang.INTRO_STEP_GOT_IT_BUTTON,callback:function(){i.showGeneralUserTooltips()}}}},e.isSet=function(e){return void 0!==e},e.setViewed=function(e,i,o){t.post(window.AppMemorial_config.baseUrl+"about/set-intro-step-viewed",{deviceType:i,stepName:e},"json").done(function(t){window.AppMemorial_config.introSteps.content[i][e].viewed=1,"function"==typeof o&&o()}).fail(function(e){jsLogger.showAjaxFail("j95002",e)})},e.createAndShowStep=function(i){var o=e.getStepHtml(i),n=_IS_MOBILE_?i.targetElementMobile:i.targetElement;if(!t(n).is(":visible"))return;i.overlay&&e.addOverlay(i),i.scrollToTheTarget&&t(n).length&&t("html, body").animate({scrollTop:t(n).offset().top-500},250);let a="";_IS_MOBILE_&&i.offsetMobile?a=i.offsetMobile:!_IS_MOBILE_&&i.offsetDesk&&(a=i.offsetDesk);tippy(n,{content:t(o).html(),allowHTML:!0,hideOnClick:i.hideOnClick,interactive:!0,appendTo:document.getElementById("pg"),interactiveBorder:15,maxWidth:_IS_MOBILE_?275:350,showOnCreate:!0,offset:a,placement:_IS_MOBILE_?i.placementMobile:i.placement,trigger:"manual",onShow:function(o){t(o.popper).addClass("tippy-popper"),o&&(void 0===e.options.instance[o.id]&&(e.options.instance[o.id]=[]),e.options.instance[o.id].stepInstance=o,e.options.instance[o.id].stepParams=i),i.overlay&&t(o.popper).addClass("with-overlay"),i.additionalClass&&t(o.popper).find(".tippy-box").addClass(i.additionalClass),i.withoutArrow&&t(o.popper).addClass("without-arrow"),"function"==typeof i.showCallback&&i.showCallback()},onHidden:function(t){e.destroy(t,i)},onMount:function(o){t(o.popper).find(".intro-button").on("click",function(){o.hide();let t=function(){eventLabel="undefined",void 0!==i.eventLabel&&(eventLabel=_IS_MOBILE_?i.eventLabelMobile:i.eventLabel),eventTracking.run("intro_steps","user_actions",eventLabel),e.setViewedTooltipContent(i),"function"==typeof i.callback&&i.callback()};void 0!==i.is_repeatable&&i.is_repeatable?t():e.setViewed(i.stepName,i.deviceType,t)}),t(".intro-step-overlay").on("click",function(){i.scrollToTheTarget&&t(n).length&&t("html, body").animate({scrollTop:t(n).offset().top-500},250)}),me.triggerWindowResize()}})},e.destroy=function(t,i){i.overlay&&e.removeOverlay(),delete e.options.instance[t.id];try{t.destroy()}catch(e){console.error(e)}},e.removeOverlay=function(){t(".intro-step-overlay").remove(),o.previousTarget.length&&t(o.previousTarget).removeAttr("style")},e.addOverlay=function(i){var n=e.getBlackOverlayHtml(i),a=e.getWhiteOverlayHtml(i),r=_IS_MOBILE_?i.targetElementMobile:i.targetElement,s=t(r);o.previousTarget=r,s.css("zIndex",8350),e.isSet(i.fixPosition)&&i.fixPosition&&s.css("position","relative"),e.isSet(i.addBorderRadius)&&i.addBorderRadius&&s.css("borderRadius","6px"),n.insertBefore(s),a.insertBefore(s)},e.getStepHtml=function(e){var i='<div class="intro-title hidden"></div><div class="intro-content"></div><div class="intro-button-wrapper"><a href="javascript:void(0)" class="btn button intro-button">'+e.buttonLabel+"</a></div>",o=t("<div>",{class:"intro-step-wrapper"});return o.html(i),e.title.lenght&&o.find(".intro-title").removeClass("hidden").html(e.title),o.find(".intro-content").html(e.text),o},e.getBlackOverlayHtml=function(){return t("<div>",{class:"intro-step-overlay black"})},e.getWhiteOverlayHtml=function(){return t("<div>",{class:"intro-step-overlay white"})},e.getStepParams=function(t,i){let o=window.AppMemorial_config.introSteps.content,n=e.options.steps[t];if(n.stepName=t,void 0===i&&(void 0!==o[i=_IS_MOBILE_?"mobile":"desktop"]&&void 0!==o[i][n.stepName]||(i="both")),n.deviceType=i,void 0!==o[i]||void 0!==o[i][n.stepName]){let e=o[i][n.stepName];n.text=e.text,n.viewed=e.viewed,void 0!==e.isSpecial&&(n.isSpecial=e.isSpecial)}return n},e.merge_options=function(e,t){let i={};for(let t in e)i[t]=e[t];for(let e in t)i[e]=t[e];return i},e.setGeneralTooltipType=function(e){window.AppMemorial_config.introSteps.content[e.deviceType][e.stepName].isSpecial=!1},e.setViewedTooltipContent=function(e){window.AppMemorial_config.introSteps.content[e.deviceType][e.stepName].viewed=1},i.removeExpired=function(){t(e.options.instance).each(function(i,o){void 0!==o&&(t(o.stepInstance.reference).is(":visible")||e.destroy(o.stepInstance,o.stepParams))})},i.showGeneralUserTooltips=function(){if(i.removeExpired(),t("#memorial-intro-overlay").length||!auth.isSignedIn()||!window.AppMemorial_config.user.is_admin)return;let o=window.AppMemorial_config.introSteps.content,n=o[_IS_MOBILE_?"mobile":"desktop"];for(var a in void 0!==o.both&&(n=e.merge_options(n,o.both)),n)if(n.hasOwnProperty(a)){var r=n[a];if(!(_IS_MOBILE_&&"desktop"===r.device_type||!_IS_MOBILE_&&"mobile"===r.device_type||r.viewed||void 0===e.options.steps[a])){let i=e.getStepParams(a),o=_IS_MOBILE_?i.targetElementMobile:i.targetElement;if(void 0!==i.isSpecial&&i.isSpecial||!t(o).is(":visible"))continue;if(void 0===i.text)return;e.createAndShowStep(i);break}}},i.showStep=function(i,o){if(void 0===o&&(o=!1),void 0!==e.options.steps[i]){let n=e.getStepParams(i);if(void 0===n.viewed||!n.viewed){if(t(".tippy-popper").is(":visible")||o)return void e.setGeneralTooltipType(n);if(void 0===n.text)return;void 0!==n.page&&meRouter.getCurrentRoute()!=n.page?me.loadAndGotToBlock(t("<div/>").attr("data-ajax-url",n.page),function(){e.createAndShowStep(n)}):e.createAndShowStep(n)}}else jsLogger.showInternalError("j95001","introSteps.showStep: "+i)},i.init=function(n){return t.extend(e.options,o,n),e.initSteps(),i},i},e.introSteps=introSteps}(this,jQuery);var introSteps=new introSteps;!function(e,t,i){meMobileActionMenu=function(){var e={},i={},o={minItems:4,maxItems:6,menuWidth:85};return e.options={id:"#mobile-action-menu",$menu:{},scrollPosition:0},e.getMenuWidth=function(){var i=0;return t(".menu-wrapper li",e.options.$menu).each(function(e,o){i+=t(o).width()}),i},e.buildMenu=function(){let i=e.options.$menu,o=t(".menu-wrapper",i).width();t(".vertical-separator",i).remove(),o-20<e.getMenuWidth()&&t(t(".menu-wrapper li:not(.drop-wrapper)",i).get().reverse()).each(function(n,a){t(".menu-wrapper ul li",i).length;o-20<e.getMenuWidth()&&(t(a).closest(".vertical-separator").remove(),t(".mobile-dialog-menu-wrapper .submenu").prepend(t(a)))}),e.getMenuWidth()<i.width()&&t(".mobile-dialog-menu-wrapper .submenu li",i).each(function(o,n){let a=t(".menu-wrapper ul li",i).length;e.getMenuWidth()+e.options.menuWidth+20<i.width()&&a<e.options.maxItems&&t(n).insertBefore(t(".menu-wrapper .drop-wrapper",i))}),t(".menu-wrapper li:not(.drop-wrapper)",i).each(function(e,i){t("<li>").addClass("vertical-separator").insertAfter(t(i))})},e.bindClicks=function(){t(e.options.$menu).on("click",".backdrop",function(e){i.hideSubMenuDialog(!0)}),me.on("swipeDown",function(){let e=t("#mobile-action-menu .submenu");e.is(":visible")&&0===e.scrollTop()&&i.hideSubMenuDialog(!0)}),t(e.options.$menu).on("click",".submenu li:not(.admin-submenu-wrapper)",function(e){meRouter.setIsForceBackToAboutPage(!0),i.hideSubMenuDialog(!1,!1)})},i.showSubMenuDialog=function(){let i=t(e.options.id);t().saveIphoneScrollPosition(),t("html, body").addClass("sub-menu-dialog-open modal-open"),t(".mobile-dialog-menu-wrapper, .backdrop",i).addClass("active").outerHeight(),t(".mobile-dialog-menu-wrapper .submenu").animate({scrollTop:0},0),t(".mobile-dialog-menu-wrapper .submenu",i).addClass("active")},i.hideSubMenuDialog=function(i,o){i=i||!1;let n=t(e.options.id);t(".mobile-dialog-menu-wrapper .submenu, .backdrop",n).removeClass("active"),setTimeout(function(){t(".mobile-dialog-menu-wrapper",n).removeClass("active"),t("html, body").removeClass("sub-menu-dialog-open modal-open"),void 0===o||o?t().returnToSavedIphoneScroll():t().unsetIphoneScrollPosition(),"|open-action-menu"===meRouter.getCurrentAnchorAction()&&meRouter.unSetCurrentHashAction(i)},200)},i.rebuild=function(){e.buildMenu()},i.init=function(n){return console.log("meMobileActionMenu initialized..."),t.extend(e.options,o,n),e.options.$menu=t(e.options.id),e.bindClicks(),i},i},e.meMobileActionMenu=meMobileActionMenu}(this,jQuery);var meMobileActionMenu=new meMobileActionMenu;$(document).ready(function(){meMobileActionMenu.init()});var slideShowActions={modalHandler:{},currentSlide:{},galleryType:"photo",mediaFileId:!1,mediaFileObj:!1,mediaFileSRC:!1,mediaFileIsRotate:"",mediaFileIsEditCaption:"",setActionsToSliderHeader:function(e){this.modalHandler=e,slideShowActions.modalHandler.find(".slides-frame .slides").css({"background-image":"none"}),slideShowActions.modalHandler.find(".slides-frame .slides img").css({"padding-top":"10%"}),this.modalHandler.on("click",".action.delete",function(){var e={photo:me.pageGalleryPhotos.getMessageForDelete(slideShowActions.currentSlide),video:Lang.YOU_ARE_ABOUT_TO_DELETE_VIDEO},t={photo:Lang.PHOTO_DELETED_SLIDESHOW,video:Lang.VIDEO_DELETED_SLIDESHOW};me.pageGallery_delete(e[slideShowActions.galleryType],slideShowActions.currentSlide,me.deleteItemRequest,function(){me.pageGallery_afterDelete(slideShowActions.currentSlide,function(e){var i=$("#page-gallery-photos"),o=$("#page-gallery-videos");i.data("can-upload")||o.data("can-upload")||me.loadBlock("pageContent"),me.find(".item[data-oid="+e.data("oid")+"]").remove(),me.cleanAboutPageCache(),popup.success(t[slideShowActions.galleryType]),me.setAsideSlideshow(),me.loadBlock("slideshow"),me.loadBlock("titlePhoto"),_IS_MOBILE_&&me.loadBlock("pageContent")})})}).on("click",".action.set-cover",function(){me.pageGalleryPhotos.sliderPhoto_coverChange(window.AppMemorial_config.status_main_photo.main)}).on("click",".action.remove-cover",function(){me.pageGalleryPhotos.sliderPhoto_coverChange(window.AppMemorial_config.status_main_photo.simple)}).on("click",".action.tell-story",function(){var e=$(this),t=function(){slideShowActions.currentSlide.click(),$("[data-oid="+slideShowActions.currentSlide.data("oid")+"] img").click()};popup.confirm(Lang.THIS_WILL_CANCEL_SLIDESHOW,function(){"photo"==slideShowActions.galleryType?(slideShowActions.mediaFileId=slideShowActions.currentSlide.data("oid"),slideShowActions.mediaFileSRC=$(slideShowActions.currentSlide[0].innerHTML).find("img").attr("src"),slideShowActions.mediaFileIsRotate=$(slideShowActions.currentSlide[0]).data("perms").indexOf("r:0"),slideShowActions.mediaFileIsEditCaption=$(slideShowActions.currentSlide[0]).data("perms").indexOf("t:1"),slideShowActions.mediaFileTitle=$(slideShowActions.currentSlide[0].innerHTML).find(".slide-img").attr("data-title")):"video"==slideShowActions.galleryType&&(slideShowActions.mediaFileId=slideShowActions.currentSlide.data("oid"),slideShowActions.mediaFileSRC=slideShowActions.currentSlide.find("img").attr("src"),slideShowActions.mediaFileIsRotate=me.pageVideoView.currentItemObj.data("perms").indexOf("r:0"),slideShowActions.mediaFileIsEditCaption=me.pageVideoView.currentItemObj.data("perms").indexOf("t:1"),slideShowActions.mediaFileTitle=me.pageVideoView.currentItemObj.attr("data-title"),slideShowActions.mediaFileSRC||(slideShowActions.mediaFileSRC=$(".story-media a[data-oid="+slideShowActions.mediaFileId+"] img").attr("src"))),meRouter.unSetCurrentHashAction(),me.loadAndGotToBlock(e,function(){$("#add_story_box").length&&meRouter.setScrollAnchor("add_story_box"),$("#add_story_box .in-gallery-check").hide(),$("#add_story_box .rotate_controls").hide(),slideShowActions.currentSlide.hasClass("video")?slideShowActions.setMediaItemToStory("video",".file-preview.video"):slideShowActions.setMediaItemToStory("photo",".file-preview.photo")})},t,!1,t)}).on("click",".action.change-snapshot",function(e){var t=slideShowActions.currentSlide.data("oid");e.stopPropagation();return me.galleryVideos_changeSnapshot(t,function(){me.pageVideoView.init(!1,me.pageVideoView.currentItemObj)}),!0}).on("click",".action.download",function(e){var t=slideShowActions.currentSlide.data("oid");return e.stopPropagation(),slideShowActions.currentSlide.hasClass("video-slide")||slideShowActions.currentSlide.hasClass("video")?$(this).attr("target","_blank").attr("href",window.AppMemorial_config.baseUrl+"gallery/download-original-video?id="+t):$(this).attr("target","_blank").attr("href",window.AppMemorial_config.baseUrl+"gallery/download-original-photo?id="+t),!0}).on("click",".action.rotate-right",function(){"video"!=slideShowActions.galleryType?me.galleryPhotos_rotate(slideShowActions.currentSlide,"right",function(e,t){slideShowActions.setImgAfterRotate(e,t)}):me.galleryVideos_rotate(slideShowActions.currentSlide,"right",function(e,t){slideShowActions.setVideoAfterRotate(e,t)})}).on("click",".action.rotate-left",function(){"video"!=slideShowActions.galleryType?me.galleryPhotos_rotate(slideShowActions.currentSlide,"left",function(e,t){slideShowActions.setImgAfterRotate(e,t)}):me.galleryVideos_rotate(slideShowActions.currentSlide,"left",function(e,t){slideShowActions.setVideoAfterRotate(e,t)})}).on("click",".fmi-dots-three-vertical",function(){e.find(".wrapper").toggleClass("active")}).on("click",".wrapper, .footer",function(){e.find(".wrapper").removeClass("active")}).on("click",".action.edit-caption-mobile",function(){$(".footer .name .title .editable")&&$(".footer .name .title .editable").click()}).on("click",".close",function(){e.modal("hide")}),$(".dots .share.action",this.modalHandler).show(),$(".not-share",this.modalHandler).length>0?$(".share.action",this.modalHandler).hide():this.modalHandler.on("click",".action.share-facebook, .action.share-email",function(){share.isSlideshow=1;var e=slideShowActions.currentSlide.data("oid"),t=$(this).data("action"),i=$(".bootbox-body #page-gallery-photo").length>0?"photo":"video";if(!me.canShare()){return me.changeSettingsDialog(function(){return share.action(t,i,e)},function(){return me.pageSlideShow.init(!1)}),!1}eventTracking.run("content_share_by_"+t+"_click","invitations_and_sharing","large_"+i+"_view"),share.action(t,i,e)}),0==$(".toolbar .wrapper .buttons a.visible",slideShowActions.modalHandler).length?$(".fmi-dots-three-vertical",slideShowActions.modalHandler).css({opacity:0,visibility:"hidden"}):$(".fmi-dots-three-vertical",slideShowActions.modalHandler).css({opacity:1,visibility:"visible"})},flushMediaData:function(){this.mediaFileId=!1,this.mediaFileObj=!1,this.mediaFileSRC=!1},setMediaItemToStory:function(e,t){slideShowActions.mediaFileObj={id:slideShowActions.mediaFileId,gallery_type:e},slideShowActions.mediaFileSRC||(slideShowActions.mediaFileSRC=$(slideShowActions.currentSlide[0].innerHTML).find(".slide-img").attr("src"));var i=function(e){$("#add_story_box .in-gallery-check").hide(),$("#album_file_id",e).val(slideShowActions.mediaFileId),$(".uploader-box",e).hide(),$(t,e).addClass("in"),$(t+" .img_wrapper img",e).attr("src",slideShowActions.mediaFileSRC).css({"max-width":"190px"}).click(function(){return!1}).removeClass("hidden").parent().addClass("success has-preview"),$(t+" .edit_name input",e).val(slideShowActions.mediaFileTitle),$(".source-computer input[name=item_name]").attr("disabled","disabled"),slideShowActions.mediaFileIsRotate>=0?$(".rotate_controls",e).hide():$(t+" .rotate_controls",e).show(),slideShowActions.mediaFileIsEditCaption>=0?$(t+" .edit_name input",e).removeAttr("disabled"):$(".edit_name input",e).attr("disabled","disabled")};_IS_MOBILE_?setTimeout(function(){me.pageStories.openAddFormMobile(i)},1):setTimeout(function(){var e=$("#add_story_box");i(e)},1e3)},setImgAfterRotate:function(e,t){var i="img-aside-slideshow",o=slideShowActions.currentSlide.find(".img-span");t.closest(".modal-body").length&&(i="img-slideshow"),slideShowActions.currentSlide.find("img").attr("src",e[i]),o.css({background:'url("'+window.AppMemorial_config.baseSiteUrl.slice(0,-1)+e[i]+'") center center no-repeat'}),me.find(".item[data-oid="+t.data("oid")+"] img").attr("src",e["img-list"]),me.find(".story-media [data-oid="+t.data("oid")+"] img").attr("src",e["img-list"]),me.find(".main-item[data-oid="+t.data("oid")+"] img").attr("src",e["img-list"]),me.pageSlideShow.setDataToStory("",$(".owl-carousel",slideShowActions.modalHandler)[0]),me.loadBlock("slideshow"),me.editAsideSlideshow(t,e)},setVideoAfterRotate:function(e,t){if(e.success){slideShowActions.modalHandler.find(".slides-frame .slide .video-player").replaceWith('<img src="'+e["img-list"]+'" alt="rotate" />');var i=me.find("[data-oid="+t.data("oid")+"] img");i.attr("src",e["img-list"]),me.pageGalleryVideos.permsUpdate(i.parents(".item"),e.perms),i.parents(".item").addClass("processing"),i.parents(".image").addClass("no-img"),i.parents(".preview").removeClass("status-ok").addClass("status-converting"),me.pageGalleryVideos.checkConverted(),i.parents(".video.video").length&&me.pageGalleryVideos.permsUpdate(i.parents(".video.video"),e.perms),slideShowActions.modalHandler.find(".slides-frame .slides img").css({"padding-top":"20%"})}},setCurrentSlide:function(e){this.currentSlide=e}},StickyBar=function(){this.initialize.apply(this,arguments)};StickyBar.prototype={first:!0,selector:"",stickyBarId:"#sticky_bar",_$:function(e){return this.selector=e,this.$el.find(e)},onAction:function(e){e.preventDefault()},disabledChangeGallery:function(){$(".save-changed-gallery").prop("disabled",!0)},enabledChangeGallery:function(){$(".save-changed-gallery").prop("disabled",!1)},loadBar:function(){console.log("StickyBar - loaded"),$(".other-actions a.premium-upgrade",this.$el).off().on("click",function(){meRouter.runAction("|premium-dialog-page")})},initialize:function(){this.el="#sticky_bar",this.$el=$(this.el),this.loadBar()},show:function(){$(this.stickyBarId).removeClass("hidden")}},me.stories_moveUp=function(e){var t=e.closest(".story"),i=t.prev();i.length&&me.sortable_animateMove(t,i,1,function(){me.stories_backendMove(t,window.AppMemorial_config.baseUrl+"stories/move",function(){me.sortable_animateRevert(t,i,1)})})},me.stories_moveDown=function(e){var t=e.closest(".story"),i=t.next();i.length&&i.hasClass("story")&&me.sortable_animateMove(t,i,0,function(){me.stories_backendMove(t,window.AppMemorial_config.baseUrl+"stories/move",function(){me.sortable_animateRevert(t,i,0)})})},me.lifestories_moveUp=function(e){var t=e.closest(".lifestory"),i=t.prev();i.length&&me.sortable_animateMove(t,i,1,function(){me.lifeStories_backendMove(t,window.AppMemorial_config.baseUrl+"lifestory/move",function(){me.sortable_animateRevert(t,i,1)})})},me.lifestories_moveDown=function(e){var t=e.closest(".lifestory"),i=t.next();i.length&&i.hasClass("lifestory")&&me.sortable_animateMove(t,i,0,function(){me.lifeStories_backendMove(t,window.AppMemorial_config.baseUrl+"lifestory/move",function(){me.sortable_animateRevert(t,i,0)})})},me.stories_backendMove=function(e,t,i){$.ajax({type:"post",dataType:"json",url:t,async:!1,data:{prev:e.prev().data("oid"),current:e.data("oid"),next:e.next().data("oid")}}).done(function(e){App.ajaxSuccess(e)||i&&i(500)}).fail(function(){i&&i(404)})},me.lifeStories_backendMove=function(e,t,i){return me.stories_backendMove(e,t,i)},me.stories_delete=function(e){var t=e.closest(".story"),i=t.data("oid");e.lockCheck()||(e.lockOn(),popup.confirm(Lang.YOU_ARE_ABOUT_TO_DELETE_STORY,function(){e.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"stories/delete",{id:i},function(e){if(App.ajaxError(e))return void jsLogger.showInternalError("j67001",e);let i=$("#page-stories .list-wrapper .story").length;i&&(t.slideUp("slow",function(){t.detach()}),1===i&&me.loadBlock("pageContent")),me.cleanAboutPageCache(),popup.success(Lang.STORY_DELETED)},"JSON").fail(function(e){jsLogger.showAjaxFail("j67002",e)}).always(function(){e.deleteLoaderLayout()})},!1,function(){e.lockOff()}))},me.lifestory_delete=function(e){var t=e.closest(".lifestory"),i=t.data("oid");e.lockCheck()||(e.lockOn(),popup.confirm(Lang.YOU_ARE_ABOUT_TO_DELETE_LIFESTORY,function(){e.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"lifestory/delete",{id:i},function(e){if(App.ajaxError(e))jsLogger.showInternalError("j67003",e);else{var i=null;1==$("#page-lifestories .list-wrapper .lifestory").length&&(i=function(){t.slideUp("slow",function(){t.detach()})}),me.loadBlock("pageContent",i),me.cleanAboutPageCache(),popup.success(Lang.LIFESTORY_DELETED)}},"JSON").fail(function(e){jsLogger.showAjaxFail("j67004",e)}).always(function(){e.deleteLoaderLayout()})},!1,function(){e.lockOff()}))},me.story_openMedia=function(e){var t=$(e).find("a"),i=t.data("oid");if($("img",t).attr("src")&&$("img",t).attr("src").indexOf("icons/icon_")>0)return!1;i||(i=$(e).data("oid")),$(e).hasClass("photo")?(me.pageSlideShow.currentItemObj=t,me.pageSlideShow.onePhotoMode=!0,me.pageSlideShow.disableActions=!0,me.pageSlideShow.init(!1)):$(e).hasClass("video")||$(e).hasClass("youtube")?(me.pageVideoView.disableActions=!0,me.pageVideoView.init(!1,t)):$(e).hasClass("doc")&&window.open(t.attr("href"),"_blank")};var es=me.editStoryDialog={$modal:null};es.cancelModalAction=function(){var e=$(".uploader.story_media",es.$modal);typeof e.storyMediaUploaderDestroy!==ud&&e.storyMediaUploaderDestroy(),$(".edit-form .content",es.$modal).autosaveClear(),$(".edit-form .title",es.$modal).autosaveClear(),$(".edit-form .content",es.$modal).wysiwyg("destroy"),es.$modal.modal("hide")},es.showModalWindow=function(e,t,i){return es.$modal=popup.extended({iconClass:"fmi-pen-border",className:e,title:t,message:i,onEscape:function(){es.cancelModalAction()},buttons:{save:{label:Lang.PUBLISH_BUTTON,className:"button save same-size-all",callback:function(){return es.saveAction(es.$modal,$("form",es.$modal)),!1}}}}),es.$modal},es.editLifestory=function(e){var t=$('.lifestory[data-oid="'+e+'"]');$.post(window.AppMemorial_config.baseUrl+"lifestory/edit",{id:e},function(e){App.ajaxError(e)?jsLogger.showInternalError("j68001",e):($(".lifestory").addClass("ignore-elements").click(),_IS_MOBILE_?me.pageLifeStories.$editForm=t=es.showModalWindow("dialog-edit-story full-height","Edit Lifestory",e.page):($(".txt, ul.actions",t).hide(),t.addClass("lifestory-edit-mode"),$(">div",t).append($(e.page).addClass("dialog-edit-story")),$(".edit-form .buttons .button.cancel:not(.back)").click(function(){t.removeClass("lifestory-edit-mode"),$(".edit-form .content",t).autosaveClear(),$(".edit-form .title",t).autosaveClear(),$("textarea",t).wysiwyg("destroy"),$("#dialog-edit-lifetory",t).detach(),$(".txt, ul.actions",t).show(),meRouter.unSetCurrentHashAction(),me.pageLifeStories.addSortTableData($("#page-lifestories .list-wrapper"))})),es.initEditFormAbstract(t,window.AppMemorial_config.baseUrl+"lifestory/save",window.AppMemorial_config.baseUrl+"upload/lifestory-media"))},"json").fail(function(e){jsLogger.showAjaxFail("j68002",e)}).always(function(){globalLoader.hideGlobalLoader()})},es.editStory=function(e){$.post(window.AppMemorial_config.baseUrl+"stories/edit",{id:e},function(t){if(App.ajaxError(t))jsLogger.showInternalError("j68003",t);else{var i=$('.story[data-oid="'+e+'"]');$(".story").addClass("ignore-elements"),_IS_MOBILE_?me.pageStories.$editForm=i=es.showModalWindow("dialog-edit-story full-height",Lang.EDIT_STORY,t.page):($(".txt, ul.actions",i).hide(),i.addClass("story-edit-mode"),$(">div",i).append($(t.page).addClass("dialog-edit-story")),$(".edit-form .buttons .button.cancel:not(.back)").click(function(){i.removeClass("story-edit-mode"),$(".edit-form .content",i).autosaveClear(),$(".edit-form .title",i).autosaveClear(),$("textarea",i).wysiwyg("destroy"),$("#dialog-edit-story",i).detach(),$(".txt, ul.actions",i).show(),meRouter.unSetCurrentHashAction(),me.pageStories.addSortTableData($("#page-stories .list-wrapper"))}));var o=i.find(".add-media-wrapper").data("media");o&&(o.delete_type=!1,o.delete_url=!1,i.find(".add-media-wrapper").attr("data-media",JSON.stringify(o))),es.initEditFormAbstract(i,window.AppMemorial_config.baseUrl+"stories/save",window.AppMemorial_config.baseUrl+"upload/story-media"),i.find(".uploader-wrapper .cancel").click(function(){i.find("#album_file_id").val("")})}},"json").fail(function(e){jsLogger.showAjaxFail("j68004",e)}).always(function(){globalLoader.hideGlobalLoader()})},es.initEditFormAbstract=function(e,t,i){var o=$("form",e);if(o.length){$(".edit-form .content",e).wysiwyg({disabledLinks:1});$(".edit-form .title",e).autosave(),me.addFormValidate(o),o.submit(function(){var i=$("textarea[name=txt]",o);if(i.wysiwyg("sync"),i.val()==i.attr("placeholder")&&i.val(""),!i.val()||0===$($.parseHTML(i.val())).text().trim().length){var n=i.closest(".redactor-box"),a='<div class="story-txt-edit-error-container has-error"><span class="help-block form-error">'+Lang.EMPTY_TXT_LIFE_STORY+"</span></div>";return $("#dialog-edit-lifetory .redactor-box, #dialog-edit-story .redactor-box").addClass("error").after(a),$(window).width()>_MOBILE_&&me.scrollTop(n.offset().top-120),$("#dialog-edit-lifetory .redactor-editor, #dialog-edit-story .redactor-editor").on("keydown",function(){$("#dialog-edit-lifetory .redactor-box, #dialog-edit-story .redactor-box").removeClass("error"),$(".story-txt-edit-error-container").remove()}),!1}return $("#dialog-edit-lifetory .redactor-box, #dialog-edit-story .redactor-box").addClass("has-success"),$(".story-txt-edit-error-container").remove(),o.validate(function(e,i){if(e){if(o.lockCheck())return;$.post(t,o.serialize(),function(e){var t,i;App.ajaxError(e,function(e){return jsLogger.showInternalError("j68005",e),!1})||(t=e.id,i=$.Deferred(),me.loadBlock("pageContent",function(){$("#pg .list-wrapper [data-oid="+t+"]").scrollAndHighlight()}),i.resolve(),i).always(function(){es.$modal.trigger("escape.close.bb")})},"JSON").fail(function(e){jsLogger.showAjaxFail("j68006",e)}).always(function(){o.lockOff(),es.$modal&&es.$modal.modal("hide"),globalLoader.hideGlobalLoader()})}}),$(".edit-form .content",e).autosaveClear(),$(".edit-form .title",e).autosaveClear(),!1});var n=o.data("remaining-files");if("unlimited"==n||n?es.initMediaUploaderAbstract(e,i):o.addClass("premium-contribute"),e.find(".add-media-check").on("click",function(){$(this).find("input").trigger("change")}),e.find(".buttons .save").on("click",function(){es.saveAction(e,o)}),o.data("can-contribute"));else if(auth.isSignedIn())o.addClass("premium-contribute");else{var a=function(){return auth.open(),!1};o.on("click",a).on("submit",a)}}},es.initMediaUploaderAbstract=function(e,t){var i=$(".uploader.story_media",e).first(),o=$("input[type=file]",i);if(i.length&&o.length){var n=o.closest("form"),a=i.storyMediaUploader({signedIn:auth.isSignedIn(),$inputFile:o,dropZone:$("body"),serverUrl:t,limitUploadItems:n.data("remaining-files"),editMode:1,saveCallback:function(){me.runAction("#|content"),me.loadBlock("titlePhoto"),me.loadBlock("mobileInnerPageTitlePhoto"),me.loadBlock("slideshow"),me.loadBlock("pageContent"),me.loadBlock("activities"),$(me).trigger("checkGalleryMedia")},dropHoverCallback:function(){$("#uploader_anchor:visible").length&&i.lockTimeout(1e3,function(){me.scrollTop($("#uploader_anchor").offset().top-200)},"scroller")}});me.pageStories.fillForm(a,e)}},es.saveAction=function(e,t){var i=$("textarea[name=txt]",t);if(!i.val()||0===$($.parseHTML(i.val())).text().trim().length){var o=i.closest(".redactor-box"),n='<div class="story-txt-edit-error-container has-error"><span class="help-block form-error">'+Lang.EMPTY_TXT_LIFE_STORY+"</span></div>";return $("#dialog-edit-lifetory .redactor-box, #dialog-edit-story .redactor-box").addClass("error").after(n),$(window).width()>_MOBILE_&&me.scrollTop(o.offset().top-120),!1}$("#dialog-edit-lifetory .redactor-box, #dialog-edit-story .redactor-box").addClass("has-success"),$(".story-txt-edit-error-container").remove(),globalLoader.showGlobalLoader(),meRouter.unSetCurrentHashAction();var a={id:$("input[name=id]",t).val(),title:$("input[name=title]",t).val(),album_file_id:$("input[name=album_file_id]",t).val(),item_name:$("input[name=item_name]",$(".file-preview.in",e)).val(),code:$("input[name=code]",t).val(),is_only_in_story:$("input[name=is_only_in_story]",$(".file-preview.in",e)).prop("checked"),txt:me.pageStories.removeExtraLineBreak($("textarea[name=txt]",t).val())};$.post(window.AppMemorial_config.baseUrl+me.vars.saveEditUrl,a,function(i){var o=t.closest(".rounded-box");if(!i.success&&i.message)return popup.error(i.message),void o.lockOff().deleteLoaderLayout();App.ajaxError(i,function(e){jsLogger.showInternalError("j68007",e)})?o.lockOff().deleteLoaderLayout():App.ajaxError(i,function(e){jsLogger.showInternalError("j68007",e)})?o.lockOff().deleteLoaderLayout():($(".edit-form .content",e).autosaveClear(),$(".edit-form .title",e).autosaveClear(),me.pageStories.saveDone(i.id,e,t,!1).always(function(){o.lockOff().deleteLoaderLayout()}),popup.flash(Lang.CHANGES_SAVED,"success"))},"JSON").fail(function(e){jsLogger.showAjaxFail("j68008",e),o.lockOff().deleteLoaderLayout()}).always(function(){es.$modal&&es.$modal.modal("hide"),globalLoader.hideGlobalLoader()})},function(exports,$,undefined){const templateSelector=function(){const self={},defaults={},templateSelector={};return self.option={items:{default:4,with_1140:7.5,with_956:6.75,with_860:6.25,with_768:5.75,with_660:4.75,with_520:4.25,with_480:3.5,with_380:3.25,with_320:2.5},selectorList:{dataThemes:"#themes_data",classPreviewTheme:"preview",classActiveTheme:"active",classPremiumOn:"premium-on",classPremiumOff:"premium-off",themesSlide:"#themes_selection",slideCategories:"#slide_category",selectCategories:"#select_category",themesSlideWrapper:"#themes_slider",mainBlock:".template-selector-block",categoriesSlide:"#category_selection",templateSelector:"#template_selector",backgroundMainBlock:".background-selector-template"},mobileLayoutWidth:"1140",currentWindowSize:0,previousWindowSize:0,currentPreviewTheme:"",oldThemeLink:"",previewThemeId:"",paramsThemesSlide:{},paramsCategoriesSlide:{},defaultSelectedCategory:"all",defaultCategories:{all:{label:Lang.TEXT_TO_ID_TS_CATEGORY_TITLE_ALL,id:"all"},new:{label:Lang.TEXT_TO_ID_TS_CATEGORY_TITLE_NEW,id:"new"}},currentTheme:window.AppMemorial_config.current_tpl,elementsDisableHideTemplateSelector:[".flash-alert",".bootbox.modal",".info-theme-content-js:not(.hidden)",".loading-overlay:visible"],premiumClass:window.AppMemorial_config.isPremium?"premium-off":"premium-on"},self.checkHideTemplateSelector=function(e){let t=!0;return $.each(self.option.elementsDisableHideTemplateSelector,function(e,i){if($("html").find(i).length)return t=!1,!1}),!0===t&&!e.parents(self.option.selectorList.templateSelector).length&&!e.is($(self.option.selectorList.templateSelector))},self.isDefaultTheme=function(){return window.AppMemorial_config.is_tpl_default},self.disableDefaultTheme=function(){return window.AppMemorial_config.is_tpl_default=!1},self.checkUnsavedTheme=function(){return $("#memorial_stylesheet_link").attr("href")!==self.option.oldThemeLink},self.checkOpenConfirmMessageUsingDefaultTheme=function(){return!!self.isDefaultTheme()&&(self.openConfirmMessageUsingDefaultTheme(),!0)},self.checkOpenConfirmMessageUsingPreviousTheme=function(){return!!self.checkUnsavedTheme()&&(self.openConfirmMessageUsingPreviousTheme(),!0)},self.checkOpenConfirmMessageUsingPremiumTheme=function(){return!!self.checkPremium(self.getPreviewThemeElement())&&(self.openConfirmMessageUsingPremiumTheme(),!0)},self.checkConfirmDialogs=function(){return!self.checkOpenConfirmMessageUsingPremiumTheme()&&(!self.checkOpenConfirmMessageUsingDefaultTheme()&&!self.checkOpenConfirmMessageUsingPreviousTheme())},self.close=function(){$(".close-template-selector").off("click.hide_template_selector").on("click.hide_template_selector",function(){self.checkConfirmDialogs()&&self.actionHideTemplateSelector()}),$(".template-selector-block").off("click.hide_template_selector").on("click.hide_template_selector",function(e){const t=$(e.target);return!(self.isDefaultTheme()&&!self.getPreviewThemeElement().length)&&(!(t.is(".close-info-theme-js")||!self.checkHideTemplateSelector(t))&&(self.checkConfirmDialogs()&&self.actionHideTemplateSelector(),!0))})},self.openConfirmMessageUsingDefaultTheme=function(){var e=popup.extended({className:"popup-confirm",message:Lang.WOULD_YOU_LIKE_TO_SAVE_THE_SELECTED_THEME,onEscape:function(){e.modal("hide")},buttons:{Cancel:{className:"button cancel",label:Lang.TS_DEFAULT_THEME_CONFIRM_CANCEL_BUTTON,callback:function(){e.modal("hide"),eventTracking.run("template_selector","user_actions","Save Theme Dialog No")}},Save:{className:"button save",label:Lang.TS_DEFAULT_THEME_SAVE_BUTTON,callback:function(){const e=self.getConfirmThemeId();e?self.requestAjaxEditTheme(e,function(){if(self.disableDefaultTheme(),eventTracking.run("template_selector","user_actions","Save Theme Dialog Yes"),"undefined"!=typeof gtag){const e=window.AppMemorial_config.isMobile?"mobile":"desktop";gtag("config",window.AppMemorial_config.analiticsId,{page_path:"/memorial/ts-dialog-continue-with-selected?device_type="+e})}}):jsLogger.showInternalError("j91002","TS self.openConfirmMessageUsingDefaultTheme, themeId not set")}}}})},self.openConfirmMessageUsingPreviousTheme=function(){var e=popup.extended({className:"popup-confirm",message:Lang.WOULD_YOU_LIKE_TO_SAVE_THE_SELECTED_THEME,onEscape:function(){e.modal("hide")},buttons:{No:{className:"button cancel",label:Lang.TS_PREVIOUS_THEME_CONFIRM_CANCEL,callback:function(){e.modal("hide"),self.actionHideTemplateSelector()}},Yes:{className:"button save",label:Lang.TS_PREVIOUS_THEME_CONFIRM_SAVE,callback:function(){self.getPreviewThemeId()?self.requestAjaxEditTheme(self.getPreviewThemeId(),function(){self.disableDefaultTheme()}):jsLogger.showInternalError("j91003","TS self.openConfirmMessageUsingPreviousTheme, getPreviewThemeId return null")}}}})},self.openConfirmMessageUsingPremiumTheme=function(){var e=popup.extended({className:"popup-confirm confirm-premium-theme",message:Lang.SORRY_THIS_THEME_IS_NOT_INCLUDED_IN_A_FREE_SUBSCRIPTION,onEscape:function(){e.modal("hide")},buttons:{No:{className:"button cancel",label:Lang.TS_PREMIUM_CANCEL,callback:function(){e.modal("hide"),self.actionHideTemplateSelector()}},Yes:{className:"button",label:Lang.TS_VIEW_UPGRADE_OPTIONS,callback:function(){me.upgradeDialogs.openPremiumDialog(null,templateSelector.enableThemeSelection(),"template_selector")}}}})},self.actionHideTemplateSelector=function(){const e=window.AppMemorial_config,t=e.holiday_tpl||e.current_tpl,i=$("#snow-canvas");$("html").off("click.close_theme_block").off("mouseup.hide_template_selector"),$(self.option.selectorList.mainBlock).addClass("fadeOutDown hidden"),$("#memorial_stylesheet_link").attr("href")!==self.option.oldThemeLink&&$('[href="'+self.option.oldThemeLink+'"]').attr("rel","stylesheet").attr("id","memorial_stylesheet_link"),e.with_snow_templates_list.hasOwnProperty(t)&&!i.length?me.addHeaderSnow():!e.with_snow_templates_list.hasOwnProperty(t)&&i.length&&me.removeHeaderSnow(),void 0!==meRouter&&void 0!==meRouter.unSetCurrentHashAction&&meRouter.unSetCurrentHashAction(),setTimeout(function(){$('#memorial_stylesheet_link:not([href="'+self.option.oldThemeLink+'"])').attr("id","").attr("rel","")},200);const o=function(){$(self.option.selectorList.mainBlock).hasClass("fadeOutDown")&&(self.slideTheme.destroy(),$(window).off("resize.themesSlide")),$("#memorial-intro-overlay").length&&self.showMemorialSetupCompletedDialog()};let n=!1;return $(self.option.selectorList.mainBlock).on("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(){n=!0,o()}),n||o(),!0},self.showMemorialSetupCompletedDialog=function(){modal=popup.confirm(Lang.MEMORIAL_SETUP_COMPLETED_TEXT.replace("{memorial_first_name}",window.AppMemorial_config.firstname),function(){$("#memorial-intro-overlay, .template-selector-block .intro-main-wrapper").remove()},null,function(){if("undefined"!=typeof gtag){const e=window.AppMemorial_config.isMobile?"mobile":"desktop";gtag("config",window.AppMemorial_config.analiticsId,{page_path:"/memorial/setup-completed?device_type="+e})}setTimeout(function(){introSteps.showGeneralUserTooltips()},1e3)},null,{ok:Lang.MEMORIAL_SETUP_COMPLETED_CONTINUE_BUTTON},"memorial-setup-competed"),modal.find(".cancel").hide()},self.setCurrentTheme=function(e){const t=window.AppMemorial_config;return t.temporary_templates_list.hasOwnProperty(e)?t.holiday_tpl=e:(t.holiday_tpl="",t.current_tpl=!1,t.current_tpl=e)},self.getCurrentTheme=function(){return window.AppMemorial_config.holiday_tpl||window.AppMemorial_config.current_tpl},self.autoScrollToActiveTheme=function(){const e=$(`[id-theme="${self.getCurrentTheme()}"]`),t=_IS_MOBILE_?1:2;e.hasClass("active")&&(defaults.themesSlide.initialSlide=e.index()>=t?e.index()-t:0)},self.getConfirmThemeId=function(){return self.getPreviewThemeId()?self.getPreviewThemeId():!!self.getActiveThemeElement().length&&self.getActiveThemeElement().attr("id-theme")},self.getPreviewThemeElement=function(){return $(self.option.selectorList.themesSlideWrapper).find(".item-theme."+self.option.selectorList.classPreviewTheme)},self.getActiveThemeElement=function(){return $(self.option.selectorList.themesSlideWrapper).find(".item-theme."+self.option.selectorList.classActiveTheme)},self.setActiveCategory=function(e){return e=e||"all",$(self.option.selectorList.categoriesSlide).find('[data-cat-id="'+e+'"]').addClass("active")},self.generateItemThemes=function(){let e="",t="";const i=self.getAllCategories(),o=self.choiceThemes(self.option.defaultSelectedCategory),n=$("#shape_item_category").clone().attr("id","").removeClass("hidden"),a=$("#shape_select_category").find("option").clone().removeClass("hidden");function r(i,o){n.find(".name-categories-js").attr("data-cat-id",i).find("span").text(o),a.attr("data-cat-id",i).text(o),e+=n.addClass("swiper-slide").get(0).outerHTML,t+=a.get(0).outerHTML}return $(["all","new"]).each(function(e,t){void 0!==i[t]&&(r(i[t].id,i[t].label),delete i[t])}),$.each(i,function(e,t){r(t.id,t.label)}),$(self.option.selectorList.selectCategories).html(t),$(self.option.selectorList.themesSlide).find(".swiper-wrapper").html(o),$(self.option.selectorList.categoriesSlide).find(".swiper-wrapper").html(e),$(self.option.selectorList.themesSlide).find("[id-theme='"+self.getCurrentTheme()+"']").addClass("active"),self.setActiveCategory(),!0},self.reloadThemes=function(){const e=self.getActiveCategory(),t=self.choiceThemes(e);self.slideTheme.removeAllSlides(),self.slideTheme.appendSlide(t),self.slideTheme.destroy(),self.initThemeSlide(),self.isloadTheme=!1;const i=$('[id-theme="'+self.currentPreviewTheme+'"]');self.checkInfoTheme(i),self.showPreviewTheme(i),self.checkPermissionsTheme(i),$(self.option.selectorList.themesSlide).find("[id-theme='"+self.getCurrentTheme()+"']").addClass("active")},self.checkEmptyNewThemes=function(e){let t=!1;return $.each(e,function(e,i){if("true"===i.is_new)return t=!0,!1}),t},self.getAllCategories=function(){const e=$.extend(!0,{},self.option.defaultCategories);return self.checkEmptyNewThemes(self.themesList)||void 0!==e.new&&delete e.new,$.each(self.themesList,function(t,i){const o=window.AppMemorial_config;o.is_tpl_default&&o.temporary_templates_list.hasOwnProperty(i.folder_name)||(null===i.category_id&&void 0===e.uncategorized?e.uncategorized={label:i.category_title,id:"uncategorized"}:void 0===e[i.category_ordering]&&null!==i.category_id&&(e[i.category_ordering]={label:i.category_title,id:i.category_id}))}),e},self.getOptionItem=function(e,t){return $.parseJSON(t.is_new)&&e.find(".new-theme-js").removeClass("hidden"),$.parseJSON(t.is_premium)&&e.find(".lock-theme-js").removeClass("hidden").addClass(self.option.premiumClass),e},self.choiceThemes=function(selectedCategory){const premium="";let $themes=$(),uniqueThemes=[],checkCategories="true";const $shapeItem=$("#shape_item_theme"),srcThemeMobile=$(".theme.mobile-only",$shapeItem).attr("src-path"),srcThemeDesktop=$(".theme.desktop-only",$shapeItem).attr("src-path"),$itemTheme=$shapeItem.clone().attr("id","").removeClass("hidden");return checkCategories="all"===selectedCategory?"true":"new"===selectedCategory?"item['is_new'] === 'true'":"uncategorized"===selectedCategory?"item['category_id'] === null":"selectedCategory === item['category_id']",$.each(self.themesList,function(index,item){if(eval(checkCategories)&&-1===uniqueThemes.indexOf(item.folder_name)){let e=$itemTheme.clone();uniqueThemes=uniqueThemes.concat(item.folder_name),e=self.getOptionItem(e,item),e.attr("id-theme",item.folder_name).find(".theme.desktop-only").attr("src",srcThemeDesktop.replace("{:folder}",item.build_path)),e.attr("id-theme",item.folder_name).find(".theme.mobile-only").attr("src",srcThemeMobile.replace("{:folder}",item.build_path)),e.find(".name-theme-js").text(item.name_theme),e.data("theme-description",item.description).addClass(premium),$themes=$themes.add(e)}}),$themes},self.getActiveCategory=function(){return $(self.option.selectorList.selectCategories).find(".name-categories-js.active").attr("data-cat-id")},self.initThemeSlide=function(e){return $.extend(self.option.paramsThemesSlide,defaults.themesSlide,e),self.slideTheme=new Swiper(self.option.selectorList.themesSlide,self.option.paramsThemesSlide)},self.initCategorySlide=function(e){return $.extend(self.option.paramsCategoriesSlide,defaults.categoriesSlide,e),self.slideCategory=new Swiper(self.option.selectorList.categoriesSlide,self.option.paramsCategoriesSlide)},self.checkPremium=function(e){return e.find("."+self.option.selectorList.classPremiumOff).length},self.checkPermissionsTheme=function(e){return self.checkPremium(e)?self.showGetPremium(e):self.showSaveTheme(e),self.showStyleSelectedTheme(e)},self.checkInfoTheme=function(e){return!!e.data("theme-description")&&self.showIconInfoTheme(e)},self.clickShowInfoTheme=function(e){$(self.option.selectorList.mainBlock).off("click.open_info_theme").on("click.open_info_theme",".info-theme-js",function(){self.showInfoTheme(),self.setTextInfoTheme(e),self.closeThemeInfo()})},self.setTextInfoTheme=function(e){return $(".theme-description-js").text(""),null!==e.data("theme-description")&&$(".theme-description-js").text(e.data("theme-description")),!0},self.showIconInfoTheme=function(e){return e.find(".info-theme-js").removeClass("hidden"),self.clickShowInfoTheme(e),!0},self.hideIconInfoTheme=function(){return $(".info-theme-js").addClass("hidden")},self.showInfoTheme=function(){return $(".info-theme-content-js").removeClass("hidden")},self.hideInfoTheme=function(){return $(".info-theme-content-js").addClass("hidden")},self.clearThemeActions=function(){return self.hideSaveTheme(),self.hideInfoTheme(),self.hideGetPremium(),self.hidePreviewTheme(),self.hideIconInfoTheme(),self.hideStyleSelectedTheme(),!0},self.hideGetPremium=function(){return $(self.option.selectorList.templateSelector).find(".get-premium-js").addClass("hidden")},self.showGetPremium=function(e){return e.find(".get-premium-js").removeClass("hidden")},self.hideThemeSelection=function(){return $(".selected-overlay").remove(),$(self.option.selectorList.templateSelector).find(".selected-save").removeClass("selected-save")},self.hideSaveTheme=function(){return $(self.option.selectorList.templateSelector).find(".save-theme-js:not(.hidden)").addClass("hidden")},self.isElementInViewport=function(e,t,i,o){const n=e.offset();return!n||t.left<=n.left&&n.left<=t.left+i&&t.top<=n.top&&n.top<=t.top+o},self.getViewport=function(e){const t=$(self.option.selectorList.themesSlide);return{offset:t.offset(),width:t.width(),height:t.height()}},self.showSaveTheme=function(e){const t=e.find(".save-theme-js").removeClass("hidden"),{offset:i,width:o,height:n}=self.getViewport(self.option.selectorList.themesSlide);return self.isElementInViewport(e.find(".left-button-side"),i,o,n)?self.isElementInViewport(e.find(".right-button-side"),i,o,n)||self.slideTheme.slideNext():self.slideTheme.slideTo(self.slideTheme.activeIndex-1),t},self.hideStyleSelectedTheme=function(){return $(".selected-overlay").remove(),$(self.option.selectorList.templateSelector).find(".selected-save").removeClass("selected-save")},self.showStyleSelectedTheme=function(e){return e.find(".view-theme-block-js").addClass("selected-save").append('<div class="selected-overlay"></div>')},self.showPreviewTheme=function(e){if(meRouter.scrollTo(0,0),!e.length)return!1;const t=e.attr("id-theme"),i=window.AppMemorial_config,o=$("#snow-canvas");return i.with_snow_templates_list.hasOwnProperty(t)&&!o.length?me.addHeaderSnow():!i.with_snow_templates_list.hasOwnProperty(t)&&o.length&&me.removeHeaderSnow(),$("#memorial-intro-overlay, .template-selector-block .intro-main-wrapper").addClass("hidden"),$(".template-selector-block").removeClass("default-template"),$(".mobile-close-template-selector-div, .close-template-selector").removeClass("hidden"),self.setPreviewThemeId(t),e.addClass(self.option.selectorList.classPreviewTheme)},self.setPreviewThemeId=function(e){self.option.previewThemeId=e},self.getPreviewThemeId=function(){return self.option.previewThemeId},self.hidePreviewTheme=function(){return self.setPreviewThemeId(""),$(self.option.selectorList.templateSelector).find("."+self.option.selectorList.classPreviewTheme).removeClass(self.option.selectorList.classPreviewTheme)},self.checkHideThemeActions=function(e){return!e.parents(".info-theme-block-js").length&&!e.is($(".info-theme-block-js"))},self.setThemeCss=function(e){return self.currentPreviewTheme!==e&&($("#memorial_stylesheet_link").attr("href","/tpl/"+e+"/css/"+e+".css?"+(new Date).getTime()),self.currentPreviewTheme=e,!0)},self.replaceActiveTheme=function(e,t,i){const o=i.attr("href").match(/(?!.*\/).+(.*?)(?=\.css)/g)[0];e!==o&&(t.attr("rel","stylesheet").attr("id","memorial_stylesheet_link"),setTimeout(function(){i.attr("id","").attr("name-tpl",o).attr("rel","")},200))},self.getBuildPath=function(e){let t={};return $.each(self.themesList,function(i,o){if(o.folder_name===e)return t=o,!1}),t},self.selectTheme=function(){return $(self.option.selectorList.themesSlide).off("click.select_theme").on("click.select_theme",".choice-theme-js",function(){if(!0===self.isloadTheme)return!1;const e=$(this),t=e.attr("id-theme"),i=$("#memorial_stylesheet_link"),o=$('[name-tpl="'+t+'"]');if(t===self.getCurrentTheme())return self.clearThemeActions(),self.replaceActiveTheme(t,o,i),self.currentPreviewTheme=t,self.showPreviewTheme(e),!1;if(self.currentPreviewTheme!==t)if(self.clearThemeActions(),o.length)self.replaceActiveTheme(t,o,i),self.checkInfoTheme(e),self.showPreviewTheme(e),self.checkPermissionsTheme(e),self.currentPreviewTheme=t;else{self.isloadTheme=!0,e.addClass("loading");const o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=self.getBuildPath(t).build_path+"/css/"+t+".css?"+(new Date).getTime(),o.id="memorial_stylesheet_link",o.onload=function(){self.isloadTheme=!1;let n="not set";i.attr("href").match(/(?!.*\/).+(.*?)(?=\.css)/g)&&(n=i.attr("href").match(/(?!.*\/).+(.*?)(?=\.css)/g)[0]),e.removeClass("loading"),i.attr("id","").attr("rel","").attr("name-tpl",n),self.checkInfoTheme(e),self.showPreviewTheme(e),self.checkPermissionsTheme(e),self.currentPreviewTheme=t,o.onload=null},$("#memorial_stylesheet_link").after(o)}return!0}),!1},self.requestAjaxEditTheme=function(e,t){if(void 0===e||!e)return!1;const i=$('[id-theme="'+e+'"]');$.ajax({url:window.AppMemorial_config.baseUrl+"settings/edit-theme",data:{tpl:e},success:function(o){self.isloadTheme=!1,globalLoader.hideGlobalLoader(),o.success?(self.currentPreviewTheme="",self.setCurrentTheme(e),self.option.oldThemeLink=$("#memorial_stylesheet_link").attr("href"),self.hideSaveTheme(),self.hideThemeSelection(),self.hideIconInfoTheme(),$(".choice-theme-js.active").removeClass("active"),i.length&&i.addClass("active"),"function"==typeof t&&t(),self.actionHideTemplateSelector()):!1===o.premium_permissions?(self.isloadTheme=!0,globalLoader.showGlobalLoader(),me.upgradeDialogs.openPremiumDialog(null,function(){templateSelector.enableThemeSelection(),globalLoader.hideGlobalLoader()},"template_selector")):jsLogger.showInternalError("j91004","TS save template error.")}})},self.saveTheme=function(){$(self.option.selectorList.themesSlideWrapper).off("click.save_theme").on("click.save_theme",".save-theme-js",function(){const e=$(this).parents(".choice-theme-js ");e.length?(globalLoader.showGlobalLoader(),self.isloadTheme=!0,self.requestAjaxEditTheme(e.attr("id-theme"),function(){self.disableDefaultTheme()})):jsLogger.showInternalError("j91001","TS self.saveTheme, themeId not set")})},self.showUpgradeDialogs=function(){$(self.option.selectorList.themesSlideWrapper).on("click.upgrade_dialog",".get-premium-js, .lock-theme-js",function(){self.isloadTheme=!0,me.upgradeDialogs.openPremiumDialog(null,templateSelector.enableThemeSelection(),"template_selector")})},self.choiceCategoriesMobile=function(){return $(self.option.selectorList.categoriesSlide).off("click.choose_category").on("click.choose_category",".name-categories-js",function(){const e=$(this).attr("data-cat-id");return $(".name-categories-js.active").removeClass("active"),$(self.option.selectorList.templateSelector).find("[data-cat-id='"+e+"']").addClass("active"),$(self.option.selectorList.selectCategories).find(".name-categories-js[data-cat-id='"+e+"']").prop("selected",!0),self.reloadThemes(),!0}),!1},self.choiceCategoriesDesktop=function(){return $(self.option.selectorList.selectCategories).off("change.choose_category").on("change.choose_category",function(){const e=$("option:selected",this).attr("data-cat-id");return $(".name-categories-js.active").removeClass("active"),$(self.option.selectorList.templateSelector).find("[data-cat-id='"+e+"']").addClass("active"),self.reloadThemes(),!0}),!1},self.checkOpenTemplateSelector=function(){return!$(self.option.selectorList.mainBlock).hasClass("hidden")},self.eventBrowserBack=function(){window.onhashchange=function(){console.log(self.checkOpenTemplateSelector()),self.checkOpenTemplateSelector()&&self.actionHideTemplateSelector()}},self.checkOpen=function(){return $(self.option.selectorList.dataThemes).text().length>0},self.initHeaderTextColor=function(){$(self.themesList).each(function(e,t){$(".item-theme[id-theme="+t.folder_name+"] .header-text-wrapper").css("color",t.header_text_color)})},self.selectCategories=function(){return self.clearThemeActions(),self.choiceCategoriesDesktop(),defaults.themesSlide.initialSlide=0,!0},self.checkResizeTemplateSelector=function(){$(window).off("resize.themesSlide").on("resize.themesSlide",function(){self.option.currentWindowSize=$(window).width(),(self.option.currentWindowSize<self.option.mobileLayoutWidth&&self.option.previousWindowSize>self.option.mobileLayoutWidth||self.option.currentWindowSize>self.option.mobileLayoutWidth&&self.option.previousWindowSize<self.option.mobileLayoutWidth)&&(self.option.previousWindowSize=$(window).width(),self.reloadThemes())})},self.closeThemeInfo=function(){return $("html").off("click.close_theme_block").on("click.close_theme_block",function(e){const t=$(e.target);if(!($(".info-theme-content-js").hasClass("hidden")||t.is($(".info-theme-js"))||t.parents(".info-theme-js").length||t.parents(".info-theme-block-js").length||t.is($(".info-theme-block-js"))))return self.hideInfoTheme(),!0}),$(self.option.selectorList.mainBlock).off("click.close_theme_block").on("click.close_theme_block",".close-info-theme-js",function(){return self.hideInfoTheme(),!0}),!1},defaults.categoriesSlide={loop:!1,freeMode:!0,slidesPerView:"auto",spaceBetween:20,slidesPerGroup:1,iOSEdgeSwipeDetection:!0,loopFillGroupWithBlank:!1},self.callbackAfterInit=function(e){$(self.option.selectorList.mainBlock).one("animationstart webkitAnimationStart oAnimationStart MSAnimationStart",function(){meRouter.scrollTo(0,600)}),$(self.option.selectorList.mainBlock).one("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(){"function"==typeof e&&e()});const t=$("#memorial-intro-overlay");if(t.length&&!t.hasClass("hidden")&&"undefined"!=typeof gtag){const e=window.AppMemorial_config.isMobile?"mobile":"desktop";gtag("config",window.AppMemorial_config.analiticsId,{page_path:"/memorial/ts-intro?device_type="+e})}},self.stopCarouselOnTouch=function(e){const t=function(e){const t=window.getComputedStyle(document.getElementById(e),null).getPropertyValue("transform").match(/matrix(?:(3d)\(-{0,1}\d+\.?\d*(?:, -{0,1}\d+\.?\d*)*(?:, (-{0,1}\d+\.?\d*))(?:, (-{0,1}\d+\.?\d*))(?:, (-{0,1}\d+\.?\d*)), -{0,1}\d+\.?\d*\)|\(-{0,1}\d+\.?\d*(?:, -{0,1}\d+\.?\d*)*(?:, (-{0,1}\d+\.?\d*))(?:, (-{0,1}\d+\.?\d*))\))/);let i=[0,0,0];t&&("3d"===t[1]?i=t.slice(2,5):(t.push(0),i=t.slice(5,9)));return i}(e.substr(1)),i=t[0],o=t[1];$(e).css({transform:"translate3d("+i+"px , "+o+"px, 0px)"}),$(e).css("webkit-transition-duration","0s")},defaults.themesSlide={initialSlide:0,observer:!0,observeParents:!0,observeSlideChildren:!0,loop:!1,grabCursor:0,freeMode:!0,spaceBetween:20,allowTouchMove:!1,iOSEdgeSwipeDetection:!0,slidesPerView:4.5,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev",disabledClass:"hidden"},on:{touchStart:function(){self.stopCarouselOnTouch(self.option.selectorList.themesSlideWrapper)}},breakpoints:{1140:{spaceBetween:10,allowTouchMove:!0,slidesPerView:"auto"},991:{spaceBetween:10,allowTouchMove:!0,slidesPerView:"auto"},860:{spaceBetween:10,allowTouchMove:!0,slidesPerView:"auto"},768:{spaceBetween:10,allowTouchMove:!0,slidesPerView:"auto"},660:{spaceBetween:10,allowTouchMove:!0,slidesPerView:"auto"},520:{spaceBetween:10,allowTouchMove:!0,slidesPerView:"auto"},480:{spaceBetween:10,allowTouchMove:!0,slidesPerView:"auto"},380:{spaceBetween:10,allowTouchMove:!0,slidesPerView:"auto"},320:{spaceBetween:10,allowTouchMove:!0,slidesPerView:"auto"}}},templateSelector.enableThemeSelection=function(){self.isloadTheme=!1},templateSelector.getCurrentPreviewTheme=function(){return self.currentPreviewTheme},templateSelector.init=function(e,t,i){if(!0===self.checkOpen()){const t=$(self.option.selectorList.templateSelector);return $(self.option.selectorList.mainBlock).removeClass("hidden fadeOutDown"),self.option.previousWindowSize=$(window).width(),self.option.oldThemeLink=$("#memorial_stylesheet_link").attr("href"),self.isloadTheme=!1,self.currentPreviewTheme="",self.themesList=JSON.parse($(self.option.selectorList.dataThemes).text()),me.announcements.hideAnnouncement(),self.generateItemThemes(),self.selectTheme(),self.autoScrollToActiveTheme(),self.initThemeSlide(i),self.selectCategories(),self.initHeaderTextColor(),self.checkResizeTemplateSelector(),self.saveTheme(),self.showUpgradeDialogs(),self.eventBrowserBack(),self.close(),self.callbackAfterInit(e),t}},templateSelector};exports.templateSelector=templateSelector()}(this,jQuery),me.upgradeDialogs={dialogAjaxInProgress:!1,openRenewDialog:function(){me.upgradeDialogs.dialogAjaxInProgress||(me.upgradeDialogs.dialogAjaxInProgress=!0,$.ajax({url:window.AppMemorial_config.baseUrl+"renewal",data:{},dataType:"json",success:function(e){if(!e.success)return!1;var t=popup.extended({className:"renewal-dialog extra-wide-dialog premium-dialogs-type full-height",title:Lang.RENEW_DIALOG_TITLE,iconClass:"fmi-restore",message:e.page,closeButton:!1,onEscape:function(){t.modal("hide"),meRouter.unSetCurrentHashAction()},onClose:function(){t.modal("hide"),meRouter.unSetCurrentHashAction()},buttons:{}}).on("shown.bs.modal",function(){})}}).always(function(){me.upgradeDialogs.dialogAjaxInProgress=!1}))},openPremiumDialog:function(e,t,i){if(void 0===i&&(i=""),!me.upgradeDialogs.dialogAjaxInProgress){var o="standard";_IS_MOBILE_&&!$(e).parents("#menu_memorial_mobile").length&&(meRouter.isCurrentRoute("gallery/photos")?o="photos":meRouter.isCurrentRoute("gallery/videos")?o="videos":meRouter.isCurrentRoute("gallery/songs")&&(o="songs")),me.upgradeDialogs.dialogAjaxInProgress=!0,$.ajax({url:window.AppMemorial_config.baseUrl+"upgrade/dialog",data:{subType:o,from:i},dataType:"json",success:function(i){if(!i.success)return!1;"function"==typeof t&&t();var o=popup.extended({className:"premium-dialog extra-wide-dialog premium-dialogs-type full-height",title:Lang.PREMIUM_DIALOG_TITLE,iconClass:"fmi-star-filled",message:i.page,closeButton:!1,onEscape:function(){o.modal("hide"),me.upgradeDialogs.onClosePremiumDialog(e)},onClose:function(){me.upgradeDialogs.onClosePremiumDialog(e)},buttons:{}})}}).always(function(){me.upgradeDialogs.dialogAjaxInProgress=!1})}},onClosePremiumDialog:function(e){if(meRouter.unSetCurrentHashAction(),$(e).parents(".bootbox.modal").length){var t=$(e).parents(".bootbox.modal");(t.hasClass("dialog-new-lifestory-mobile")||t.hasClass("dialog-new-stories-mobile"))&&(meRouter.isCurrentRoute("lifestory")?me.pageLifeStories.openPreviousPopup():meRouter.isCurrentRoute("stories")&&me.pageStories.openPreviousPopup())}},openLifeTimeDialog:function(){me.upgradeDialogs.dialogAjaxInProgress||(me.upgradeDialogs.dialogAjaxInProgress=!0,$.ajax({url:window.AppMemorial_config.baseUrl+"lifetime/dialog",data:{},dataType:"json",success:function(e){if(!e.success)return!1;var t=Lang.LIFETIME_DIALOG_TITLE;_IS_MOBILE_&&(t=Lang.LIFETIME_DIALOG_TITLE_MOBILE);var i=popup.extended({className:"lifetime-dialog extra-wide-dialog premium-dialogs-type full-height",title:t,iconClass:"fmi-plans-lifetime",message:e.page,closeButton:!1,onEscape:function(){i.modal("hide"),meRouter.unSetCurrentHashAction()},buttons:{}})}}).always(function(){me.upgradeDialogs.dialogAjaxInProgress=!1}))}},me.$youtubeItems=null,me.$youtubeItem=null,me.$youtubeMode=null,function(e){e.fn.youtubeUploader=function(t,i){var o=e(this),n=e("[data-source=youtube]",o),a=e.Deferred(),r=e(".uploader");return me.$youtubeMode=t,"gallery"==t&&(r.youtubeUploaderTemplateInit(),r.youtubeUploaderButtonsInit(),r.youtubeUploaderPreviewButtonsInit()),r.youtubeUploaderSwitchState("upload"),n.off().on("click","input.submit",function(){var o=n.closest(".modal-content");o.length||(o=n.closest(".source-youtube"));var s=e("textarea",n),l=""+s.val();return l?(s.css({"border-color":"green"}),o.addLoaderLayout(),e.post(window.AppMemorial_config.baseUrl+"youtube-media/add",{url:l,entity:t},function(e){if(!e.success)return void 0!==e.message?popup.error(e.message):jsLogger.showAjaxFail("j70001",e),e.error;"story"==t?i(e):(a.resolve(e),r.youtubeUploaderAddShowFile(e))},"json").fail(function(e){jsLogger.showAjaxFail("j70002",e)}).always(function(){o.deleteLoaderLayout()}),!1):(popup.error(Lang.ENTER_YOUTUBE_URL),s.css({"border-color":"red"}),!1)}),a},e.fn.youtubeUploaderButtonsInit=function(){var t=e(".uploader"),i=e(".source-youtube .upload-wrapper .buttons");e(".cancel",i).off().on("click",function(){"gallery"==me.$youtubeMode&&(e(".item",me.$youtubeItems).length?t.youtubeUploaderSwitchState("preview"):t.galleryUploaderCloseSource())})},e.fn.youtubeUploaderPreviewButtonsInit=function(){var t=e(".uploader"),i=e(".source-youtube .preview-wrapper .buttons");me.$youtubeItems.on("click",".item a.cancel",function(){return e(this).closest(".item").addClass("canceled").detach(),e(".item",me.$youtubeItems).length||me.galleryUploaderCloseSource(),!1}),e(".more",i).off("click").on("click",function(){t.youtubeUploader("gallery")}),e(".cancel-all",i).off("click").on("click",function(){e(".item",me.$youtubeItems).detach(),me.galleryUploaderCloseSource()}),e(".save",i).off("click").on("click",function(){var i=t.closest(".modal-content");i.length||(i=t.closest(".source-youtube")),i.addLoaderLayout();var o=[];e(".item",me.$youtubeItems).each(function(t,i){o.push({id:e(i).attr("data-id"),title:e(".edit_name input",i).val()})}),e.post(window.AppMemorial_config.baseUrl+"youtube-media/save",{items:o},function(t){if(t.hasOwnProperty("error"))return"UNKNOWN_YOUTUBE_URL"==t.error?popup.error(Lang.WRONG_YOUTUBE_URL):jsLogger.showAjaxFail("j70003",t),t.error;me.youtubeUploaderDestroy(),meRouter.scrollTo(e("#pg").offset().top,1e3),me.loadBlock("pageContent")},"json").fail(function(e){jsLogger.showAjaxFail("j70004",e)}).always(function(){i.deleteLoaderLayout()})})},e.fn.youtubeUploaderTemplateInit=function(){if(!me.$youtubeItem){var t=e(".uploader");me.$youtubeItems=e(".source-youtube .preview.items",t);var i=e(".item.blank",me.$youtubeItems);me.$youtubeItem=i.first().clone().removeClass("blank"),e(".preview > .image",me.$youtubeItem).detach(),e(".preview > .video",me.$youtubeItem).detach(),e(".preview > .song",me.$youtubeItem).detach(),i.detach()}},e.fn.youtubeUploaderAddShowFile=function(t){e(".uploader").youtubeUploaderSwitchState("preview");var i=me.$youtubeItem.clone(!0);e(".preview img",i).attr("src",t.url),i.find(".edit_name input").val(t.name),i.attr("data-id",t.id),me.setIconState("success",i),e(".progressbar .line",i).css({width:"100%"}),i.appendTo(me.$youtubeItems).fadeIn(),eventTracking.run("video","content_additions","youtube")},e.fn.youtubeUploaderSwitchState=function(t){var i=e(".source-youtube .preview-wrapper"),o=e(".source-youtube .upload-wrapper");o.addClass("hidden"),i.removeClass("hidden"),void 0!==t&&"upload"==t&&(e("textarea",o).val(""),o.removeClass("hidden"),i.addClass("hidden"))},e.fn.youtubeUploaderDestroy=function(){me.$youtubeItems=null,me.$youtubeItem=null}}(jQuery),me.pageAbout={init:function(e){console.log("pageAbout - loaded"),this.redirectToTributes(),this.about_addActions(),_IS_MOBILE_||(me.pageTributes.addTributeActions(),me.pageTributes.addTributeForm(),me.pageTributes.saveAddTributeMobile()),this.editPersonalPhrase(),this.enableReadMore(),this.enableBackToAboutChecks(),contentPagination.init({scrollAfterPagination:"#page-tributes"}),this.afterInit(e)},reload:function(e){this.about_addActions(),_IS_MOBILE_||(me.pageTributes.addTributeActions(),me.pageTributes.addTributeForm(),me.pageTributes.saveAddTributeMobile()),this.editPersonalPhrase(),this.enableReadMore(),this.enableBackToAboutChecks(),contentPagination.init({scrollAfterPagination:"#page-tributes"}),this.afterReload(e)},afterInit:function(e){e&&e()},redirectToTributes:function(){_IS_MOBILE_&&"object"==typeof meRouter.getAllUrlParams()&&Number(meRouter.getAllUrlParams().entity_id)>0&&(globalLoader.showGlobalLoader(),page("/tributes?"+window.location.search.substr(1)))},afterReload:function(e){e&&e()},enableBackToAboutChecks:function(){let e='[href*="|add_tribute_mobile_dialog"]';e+=',[href*="|add_story_mobile_dialog"]',e+=',[href*="|add_lifestory_mobile_dialog"]',e+=',[href*="|add_photos_mobile_dialog"]',e+=',[href*="|add_videos_mobile_dialog"]',e+=',[href*="|add_songs_mobile_dialog"]';let t="click.enableBackToAboutChecks";$(document).off(t).on(t,e,function(){meRouter.isAboutPage()&&(meRouter.setIsForceBackToAboutPage(!0),meRouter.setScrollPosition($(window).scrollTop()))})},enableReadMore:function(){new readMore($("#page-tributes.about"),me.opts.tributeShortLength,me.opts.tributeShortLines,!1),new readMore($(".section-snippets-wrapper .tributes-section-wrapper"),me.opts.snippetTributeShortLength,me.opts.snippetTributeShortLines,!1),new readMore($(".section-snippets-wrapper .stories-section-wrapper.stories"),me.opts.snippetStoryShortLength,me.opts.snippetStoryShortLines,!0),new readMore($(".section-snippets-wrapper .stories-section-wrapper.life-stories"),me.opts.snippetLifeStoryShortLength,me.opts.snippetLifeStoryShortLines,!0)},about_addActions:function(){var e=$("#page-about");if(me.circleButton.destroy(),me.circleButton.initialize("|add_content_button"),e.hasClass("editable")){e.on("click",".edit-memorial-info.desktop-only, #edit-memorial-menu a",function(t){$(".edit-memorial-info-wrapper",e).toggleClass("visible")}).on("click",".edit-memorial-info.mobile-only",function(e){me.pageAbout.showEditMemorialMobileMenu()}).on("click","#edit-memorial-menu-mobile .backdrop, #edit-memorial-menu-mobile li a",function(e){me.pageAbout.hideEditMemorialMobileMenu()}),me.on("swipeDown",function(){let e=$("#edit-memorial-menu-mobile .submenu");e.is(":visible")&&0===e.scrollTop()&&me.pageAbout.hideEditMemorialMobileMenu()});let t=$(".edit-memorial-info-wrapper");$("body").on("click",function(i){t===i.target||t.has(i.target).length||$(".edit-memorial-info-wrapper",e).removeClass("visible")})}$("#add-content-menu .backdrop, #add-content-menu .menu-wrapper a").on("click",function(){me.pageAbout.hideAddContentMenu()}),me.on("swipeDown",function(){let e=$("#add-content-menu .menu");e.is(":visible")&&0===e.scrollTop()&&me.pageAbout.hideAddContentMenu()}),$(".gallery-section-wrapper .item.photo").on("click",function(e){return me.pageSlideShow.disableActions=!1,me.pageSlideShow.onePhotoMode=!1,me.pageSlideShow.currentItemObj=$(this),me.pageSlideShow.init(!1),!1}),$(".gallery-section-wrapper .item.video").on("click",function(e){return $el=$(this).find(".video"),$el.hasClass("video-error")?(me.showContactUs($el),!1):!$el.parents(".image").hasClass("status-error")&&!$el.parents(".image").hasClass("status-converting")&&(meRouter.setHashAction($el),me.pageVideoView.disableActions=!1,me.pageVideoView.init(!1,$el),!1)}),$(".stories-section-wrapper .story-media").on("click",function(e){return me.story_openMedia($(this)),!1})},showEditMemorialMobileMenu:function(){let e=$("#edit-memorial-menu-mobile");$().saveIphoneScrollPosition(),$("html, body").addClass("sub-menu-dialog-open modal-open"),$(".mobile-dialog-menu-wrapper, .backdrop",e).toggleClass("active").outerHeight(),$(".submenu",e).toggleClass("active")},hideEditMemorialMobileMenu:function(){let e=$("#edit-memorial-menu-mobile");$(".submenu, .backdrop",e).removeClass("active"),setTimeout(function(){$(".mobile-dialog-menu-wrapper",e).removeClass("active"),$("html, body").removeClass("sub-menu-dialog-open modal-open"),meRouter.unSetCurrentHashAction(),$().returnToSavedIphoneScroll()},200)},phraseFontChanged:function(e){var t=$(".block-phrase select option:selected",e),i=$(".block-phrase textarea",e),o=t.data("link"),n=t.data("css-name");o&&($("#phrase_styles").attr("href",o),o.match(/^\//)&&(setCssNameImmediate=0,$loaderArea.addLoaderLayout(),$.post(o,"text").done(function(){i.css("font-family",n)}).always(function(){$loaderArea.deleteLoaderLayout()})));var a=$("select[name=phrase_font]",e).find(":selected"),r=a.attr("data-css-name"),s=a.attr("data-size"),l=a.attr("data-size-mobile"),d=a.attr("data-line-height"),c=a.attr("data-line-height-mobile"),u=$("#phrase-font-size",e).find(":selected").val(),h=0;"small"==u?h=-4:"large"==u&&(h=8),s=parseInt(s)+h,l=parseInt(l)+h;var p=".personal_phrase_font{ font-family: "+r+", sans-serif;\n font-size:"+s+"px!important;\n line-height:"+d+"em!important;\n}\n";p+="@media (max-width: "+_MOBILE_+"px){\n        .personal_phrase_font{\n            font-size: "+l+"px!important;\n            line-height: "+c+"em!important;\n        }\n    }",$("#phrase_styles_css").html(p),i.css("font-family",n||"")},editFormPhraseBlockInit:function(e){$(".block-phrase select",e).on("change",function(){me.pageAbout.phraseFontChanged(e)}),me.pageAbout.phraseFontChanged(e),$(".personal_phrase_font",e).on("keyup",function(){var t=$(this).val(),i=$(".phrase-font [data-language='latin']",e);if(/[^\u0000-\u007f]/.test(t)){if(!i.hasClass("hidden")){i.addClass("hidden").removeAttr("selected");var o=$(".phrase-font [data-language='all']").first().val();$(".phrase-font",e).val(o),me.pageAbout.phraseFontChanged(e)}}else i.hasClass("hidden")&&(i.removeClass("hidden"),me.pageAbout.phraseFontChanged(e))})},editPersonalPhrase:function(){$("#page-about").on("click",".save-phrase",function(){me.pageAbout.updateRequestPersonalPhrase()}),$(".dialog-edit-info.phrase .button.save").on("click",function(){me.pageAbout.updateRequestPersonalPhrase()})},updateRequestPersonalPhrase:function(){var e={};e.phrase_font=$("#phrase_font option:selected").val(),e.phrase_font_size=$("#phrase-font-size option:selected").val(),e.txt_title=$("#txt_title").val().trim(),$.ajax({type:"POST",url:window.AppMemorial_config.baseUrl+"about/save-personal-phrase",dataType:"json",data:e,success:function(e){App.ajaxError(e,function(e){e.error&&jsLogger.showInternalError("j71006",e)})||(meRouter.unSetCurrentHashAction(),me.pageAbout.showEditInfoButton(),me.cleanAboutPageCache(),me.loadAndGotToBlock(me.data("ajax-url","/about"),function(){$(".additional-mobile-info .personal_phrase_font").text($("#page-about .personal_phrase_font").text()),me.scrollTop($("#page-about").offset().top-200)}))}})},checkUrlOnContaining:function(e){return e.length&&memorialUri.uriCreate(e.val(),!0)!==e.attr("data-old-value")},editPersonalInfoInit:function(e,t){var i={},o=$("#page-about"),n=$(">.info",o),a=$(">.text",o),r=$(">.edit-info-area",o);_IS_MOBILE_?i=$("form",$(e)):(n.hide(),r.hide().html(e).stop(1,1).fadeIn(),a.hide(),i=r.is("form")?r:$("form",r),$("select",i).each(function(){popup.checkFilled($(this))}),me.scrollTop($("#page-about").offset().top));$.each([".radio-inline",".checkbox-inline"],function(e,t){$(t,i).on("click tap",function(){$(t,i).removeClass("active"),$(this).find("input").prop("checked")&&$(this).addClass("active")})}),attributions.initCovidCountryOnChange(),$("#born-country, #passed-country",i).on("change",function(){let e=$(this);e.val()!==e.attr("data-old-value")&&e.attr("data-old-value",e.val())}),$(".button.cancel",i).on("click",function(){$("textarea",r).autosize("autosize.destroy"),r.html(""),n.stop(1,1).fadeIn(),a.stop(1,1).fadeIn(),meRouter.unSetCurrentHashAction(),me.scrollTop($("#header").offset().top),me.pageAbout.showEditInfoButton()}),me.pageAbout.hideEditInfoButton();$(["#first_name","#middle_name","#last_name"]).each(function(e,t){$(t).length&&($(t).val()?$(t).attr("data-old-value",memorialUri.uriCreate($(t).val(),!0).toLowerCase()):$(t).attr("data-old-value",""))}),googlePlaces.initAutocompleteForBornAddress(),googlePlaces.initAutocompleteForDiedAddress(),$("textarea",r).autosize(),$("input[name=date_born_y], input[name=date_passed_y]",i).change(function(){var e=$("input[name=date_born_y]",i).val(),t=$("input[name=date_passed_y]",i).val();$("input[name=show_age]",i).attr("checked",t-e<1?0:1)}),t.indexOf("phrase")>-1&&me.pageAbout.editFormPhraseBlockInit(i),jQuery.validate({language:formValidatorTranslations,modules:"logic",onValidate:function(e){customValidations.dateBornPassValidate(e)},onError:function(e){me.pageAbout.scrollToError(e)}});var s={};$("#memorial-uri").keyup(function(){$input=$(this),clearTimeout(s),memorialUri.cleanUriError(i),memorialUri.uriCreate($(this).val()),s=setTimeout(function(){$input.val()!=$input.data("old-uri-value")&&$("#first_name.contain, #middle_name.contain, #last_name.contain").removeClass("contain"),memorialUri.checkMemorialUri(i,"memorial")},1e3)});let l=_IS_MOBILE_?".dialog-edit-info.info .modal-footer .button.save":"form.edit-info .button.save",d=$("form.edit-info");$(l).on("click",function(){return customValidations.dateBornPassValidate(i)&&d.submit(),!1}),d.on("submit",function(){var e=$("#memorial-uri");return e.val().length?(memorialUri.cleanUriError(i),globalLoader.showGlobalLoader(),clearTimeout(s),memorialUri.checkMemorialUri(i,"memorial",!0).done(function(t){if(t.valid){let t=$("#first_name.contain"),o=$("#middle_name.contain"),n=$("#last_name.contain"),a=me.pageAbout.is_uri_changed();e.val()!==memorialUri.uriCreate(un,!0)&&!a&&me.pageAbout.checkUrlOnContaining(t)||me.pageAbout.checkUrlOnContaining(o)||me.pageAbout.checkUrlOnContaining(n)?_IS_MOBILE_?me.pageAbout.submitInfo(i,!0):popup.confirm(Lang.MEMORIAL_URL_CHANGES_OF_URI,function(){me.pageAbout.submitInfo(i,!1)},function(){meRouter.scrollTo($("#memorial-uri").offset().top-150,300)},null,null,{ok:Lang.MEMORIAL_URL_CHANGED_KEEP_BUTTON,cancel:Lang.MEMORIAL_URL_CHANGED_GO_BACK_BUTTON},"without-close url-change"):me.pageAbout.submitInfo(i,!1)}else me.pageAbout.scrollToError(i);globalLoader.hideGlobalLoader()}),!1):(memorialUri.uriValidationMessage(i,e.data("validation-empty-msg")),$("input",i).blur(),!1)});var c=function(e,t,o,n){$('select[name="'+e+'"]',i).change(function(){$("option:selected",$(this)).data("code")==n?($('select[name="'+t+'"]',i).show().prop("disabled",!1),null===$('select[name="'+t+'"]',i).val()&&$('select[name="'+t+'"]',i).val("").removeClass("filled"),$('input[name="'+o+'"]',i).hide().prop("disabled",!0)):($('select[name="'+t+'"]',i).hide().prop("disabled",!0),$('input[name="'+o+'"]',i).show().prop("disabled",!1))}).change()};c("b_ctry","b_st","b_st_other","US"),c("d_ctry","d_st","d_st_other","US"),$("select[name=creator_relationship]",i).change(function(){var e=$("input[name=creator_relationship_custom]",i);"other"==$("option:selected",$(this)).data("code")?e.show():(e.hide(),$('[name="creator_relationship_custom"]').removeClass("valid").val(""))}).triggerHandler("change")},scrollToError:function(e){let t=$("body, html"),i=$(".error",e).first();_IS_MOBILE_?(t=$(".material-mobile")).scrollTop(i.offset().top-t.offset().top+t.scrollTop()-150):t.scrollTop(i.offset().top-120)},is_uri_changed:function(){let e=$("#memorial-uri");return e.val()!==e.attr("data-old-uri-value")},submitInfo:function(e,t){let i=$("#page-about"),o=$(">.edit-info-area",i);o.lockOn().addLoaderLayout();let n=$("input[type=submit]",e).attr("disabled","disabled"),a=0,r=me.pageAbout.is_uri_changed();$.post(window.AppMemorial_config.baseUrl+"about/save-info",e.serialize()+"&save=1","json").done(function(e){App.ajaxError(e,function(e){e.error&&jsLogger.showInternalError("j71003",e)})||($().unsetIphoneScrollPosition(),me.cleanAboutPageCache(),meRouter.unSetCurrentHashAction(),me.loadBlock("titleText",me.initBlurBackground),me.loadBlock("titleTextMobile",me.initBlurBackground),me.loadBlock("templateSelectorHeaderText"),me.loadBlock("mobileInnerPageTitle"),successCallback=function(){me.loadAndGotToBlock(me.data("ajax-url","/about"),function(){me.scrollTop(0),popup.success(Lang.ABOUT_INFO_CHANGES_SAVED),r&&setTimeout(function(){window.location.reload()},1e3)})},t?popup.confirm(Lang.MEMORIAL_URL_CHANGES_OF_URI,function(){successCallback()},function(){meRouter.runAction("|edit-memorial-info")},null,null,{ok:Lang.MEMORIAL_URL_CHANGED_KEEP_BUTTON,cancel:Lang.MEMORIAL_URL_CHANGED_GO_BACK_BUTTON},"without-close"):successCallback(),_IS_MOBILE_&&null!==es.$modal&&es.$modal.modal("hide"),a=1)}).fail(function(e){jsLogger.showAjaxFail("j71004",e)}).always(function(){a||(o.lockOff().deleteLoaderLayout(),n.removeAttr("disabled")),me.pageAbout.showEditInfoButton(),meRouter.unSetCurrentHashAction()})},about_editInfo:function(e,t,i){let o=$("#page-about"),n=$(".profile",o),a="info";e.indexOf("phrase")>-1&&(a="phrase",n=$(".quote-block",o)),n.lockCheck()||(n.lockOn().addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+e,{},"json").done(function(o){if(!App.ajaxError(o)){var n=o.page;if(_IS_MOBILE_)$editForm=es.$modal=popup.extended({className:"dialog-edit-info "+a+" full-height",title:t,iconClass:"fmi-pen-border",message:n,buttons:{save:{label:Lang.PUBLISH_BUTTON,className:"button save modal-header-button same-size-all",callback:function(){return scrollPosition=0,"function"==typeof i&&i(),!1}}},onClose:function(){me.pageAbout.showEditInfoButton()},onEscape:function(){meRouter.unSetCurrentHashAction(),es.$modal.modal("hide"),me.pageAbout.showEditInfoButton()}}).on("shown.bs.modal",function(){me.pageAbout.editPersonalInfoInit($editForm,e)});else{me.pageAbout.editPersonalInfoInit(n,e);let t=$(".edit-memorial-info-wrapper");me.scrollTop(t.offset().top-50)}}}).fail(function(e){jsLogger.showAjaxFail("j71005",e)}).always(function(){n.lockOff().deleteLoaderLayout()}))},hideEditInfoButton:function(){$(".edit-memorial-info-wrapper").addClass("hidden")},showEditInfoButton:function(){$(".edit-memorial-info-wrapper").removeClass("hidden")},about_editPersonalText:function(e){var t=$("#page-about"),i=$(".text",t),o=$(".info",t),n=$(".edit-text-area",t);if(!i.lockCheck()){i.lockOn().addLoaderLayout();var a=function(e){var t={};_IS_MOBILE_?t=n=$("form",$(e)):(n.hide().html(e.page).stop(1,1).fadeIn(),i.hide(),o.hide(),t=n.is("form")?n:$("form",n)),$(".button.cancel",t).on("click",function(){$("textarea",n).wysiwyg("destroy"),$('[name="text"]',t).autosaveClear(),n.html(""),i.stop(1,1).fadeIn(),o.stop(1,1).fadeIn(),meRouter.unSetCurrentHashAction(),me.scrollTop($("#header").offset().top),me.pageAbout.showEditInfoButton()}),$("textarea",n).wysiwyg(),me.addFormValidate(t),me.pageAbout.hideEditInfoButton(),t.submit(function(){return function(e){if(!n.lockCheck()){n.lockOn().addLoaderLayout();var t=$("input[type=submit]",e).attr("disabled","disabled"),a=0;$.post(window.AppMemorial_config.baseUrl+"about/save-text",e.serialize()+"&save=1","json").done(function(r){r.success?($().unsetIphoneScrollPosition(),n.lockOff().deleteLoaderLayout(),$("textarea",n).wysiwyg("destroy"),$('[name="text"]',e).autosaveClear(),n.html(""),i.stop(1,1).fadeIn(),o.stop(1,1).fadeIn(),t.removeAttr("disabled"),me.cleanAboutPageCache(),meRouter.unSetCurrentHashAction(),me.pageAbout.showEditInfoButton(),_IS_MOBILE_&&es.$modal.modal("hide"),me.loadBlock("user_text",function(){setTimeout(function(){me.scrollTop($("#user_text").offset().top-200)},500)}),a=1):popup.error(r.message)}).fail(function(e){jsLogger.showAjaxFail("j71007",e)}).always(function(){a||(n.lockOff().deleteLoaderLayout(),t.removeAttr("disabled")),meRouter.unSetCurrentHashAction()})}}(t),!1})};$.post(window.AppMemorial_config.baseUrl+"about/edit-text",{},"json").done(function(e){App.ajaxError(e)||(_IS_MOBILE_?$editForm=es.$modal=popup.extended({className:"dialog-edit-info text full-height",title:Lang.ABOUT_EDIT_INFO_TEXT,iconClass:"fmi-pen-border",message:e.page,buttons:{save:{label:Lang.PUBLISH_BUTTON,className:"button save modal-header-button same-size-all",callback:function(){return scrollPosition=0,$("form",$editForm).submit(),!1}}},onClose:function(){me.pageAbout.showEditInfoButton()},onEscape:function(){meRouter.unSetCurrentHashAction(),es.$modal.modal("hide"),me.pageAbout.showEditInfoButton()}}).on("shown.bs.modal",function(){a($editForm)}):(a(e),me.scrollTop(n.offset().top-50)))}).fail(function(){}).always(function(){i.lockOff().deleteLoaderLayout()})}},showAddContentMenu:function(){auth.isSignedIn()?($().saveIphoneScrollPosition(),$("html, body").addClass("sub-menu-dialog-open modal-open"),$("#add-content-menu, #add-content-menu .backdrop").addClass("active").outerHeight(),$("#add-content-menu .menu-wrapper .menu").addClass("active")):auth.open()},hideAddContentMenu:function(){meRouter.unSetCurrentHashAction(),$("#add-content-menu .menu-wrapper .menu, #add-content-menu .backdrop").removeClass("active"),setTimeout(function(){$("#add-content-menu").removeClass("active"),$("html, body").removeClass("sub-menu-dialog-open modal-open"),$().returnToSavedIphoneScroll()},200)}},me.pageBackgroundMusic={page:{},currentEl:!1,delayTimer:0,data:{reloadPlaylist:!1},init:function(e){this.page=$("#page-backgroud-music"),playlistSort.init(),this.initOptions(),console.log("pageBackgroundMusic - loaded"),this.afterInit(e)},reload:function(e){this.page=$("#page-backgroud-music"),playlistSort.init(),this.initOptions(),this.afterReload(e)},afterInit:function(e){e&&e()},afterReload:function(e){e&&e()},initOptions:function(){this.checkShuffle(),this.checkOrdering(),$(".upload-link a").click(function(){me.loadAndGotToBlock($(this),function(){$("html, body").animate({scrollTop:$(".uploader.audio").offset().top-80},300)})}),$("#shuffle_playback_songs").on("click",function(){me.pageBackgroundMusic.checkOrdering(),playlistSort.checkShuffle(),me.pageBackgroundMusic.save()}),mediaPlayer.init()},save:function(e){me.pageBackgroundMusic.reloadPlaylist=!1,void 0!==e&&(me.pageBackgroundMusic.data.playlist=JSON.stringify(e),me.pageBackgroundMusic.reloadPlaylist=!0,bgplayer.play());var t=$("form",me.pageBackgroundMusic.page);$.each(t.serializeArray(),function(e,t){me.pageBackgroundMusic.data[t.name]=t.value}),clearTimeout(this.delayTimer),this.delayTimer=setTimeout(function(){me.pageBackgroundMusic.page.addLoaderLayout(),me.pageBackgroundMusic.data.shuffle_playback_songs=$("#shuffle_playback_songs").prop("checked")?1:0,$.post(window.AppMemorial_config.baseUrl+"bg-music/save",me.pageBackgroundMusic.data,function(e){me.pageBackgroundMusic.reloadPlaylist?playlistSort.update(void 0):void 0!=un&&(void 0)()},"json").fail(function(e){jsLogger.showAjaxFail("j76003",e)}).always(function(){me.pageBackgroundMusic.page.deleteLoaderLayout()})},1500)},checkShuffle:function(){playlistSort.playlistFetch().length>1&&$("#playlist-selector .shuffle",this.page).removeClass("hidden")},checkOrdering:function(){$("#shuffle_playback_songs").prop("checked")?$("#playlist-selector .ordering",this.page).addClass("hidden"):$("#playlist-selector .ordering",this.page).removeClass("hidden")}},me.pageGalleryPhotos={$addFormHTML:{},init:function(e){console.log("pageGalleryPhotos - loaded"),this.setAllAction(),contentPagination.init({scrollAfterPagination:"#content"}),this.afterInit(e)},reload:function(e){setTimeout(function(){me.pageGalleryPhotos.setAllAction()},300),contentPagination.init({scrollAfterPagination:"#content"}),this.afterReload(e)},afterInit:function(e){e&&e()},afterReload:function(e){e&&e()},setAllAction:function(){var e=$("#page-gallery-photos"),t=$(".content > .items-list",e);if(e.data("can-upload")?me.circleButton.initialize("|add_photos_mobile_dialog","fmi-add-camera",Lang.BUTTON_CIRCLE_TEXT_ADD_PHOTOS):me.circleButton.initialize("|premium-dialog-page","fmi-add-photo-locked",Lang.BUTTON_CIRCLE_TEXT_ADD_PHOTOS).clickFunction(function(){eventTracking.run("memorial","purchase_trigger","Free Memorial Photo Uploader")}),t.length>0&&(me.changePermsToItems($(".item",t)),t.on("click",".options .list",function(e){var t=$(e.target);return"A"==t.prop("tagName")&&(t.attr("target")?e.stopPropagation():e)}).on("click",".options .list [data-action]",function(e){var t=me.pageGallery_handleActionClick.apply(this,[e,me.pageGalleryPhotos.galleryPhotos_clickAction]);return me.pageGallery_hideActionBar($(this).closest(".item"),1),t}).on("click",".share .list [data-action]",function(e){var t=me.pageGallery_handleActionClick.apply(this,[e,me.pageGalleryPhotos.galleryPhotos_clickAction]);return me.pageGallery_hideActionBar($(this).closest(".item"),1),t})),me.on("click",".action.edit-photos",function(){page("/gallery-edit/photos")}).on("click",".action.add_photo",function(){$("#uploader_anchor").length&&$("html, body").animate({scrollTop:$("#uploader_anchor").offset().top-200},300)}).on("click",".author .me a",function(){return window.open($(this).attr("href"),"_blank"),!1}).on("click",".action.slideshow",function(){me.pageSlideShow.disableActions=!1,me.pageSlideShow.autoplay=!0,me.pageSlideShow.currentSlide={},me.pageSlideShow.currentItemObj=!1,me.pageSlideShow.onePhotoMode=!1,me.pageSlideShow.init(!1),me.pageSlideShow.launchIntoFullScreen(document.documentElement)}).on("click","#page-gallery-photos .items-list .image img,#page-gallery-photos .story-icon-wrapper,#page-gallery-photos  .img-background",function(){var e=$(this).parents(".image");e.hasClass("no-img")?me.showContactUs(e):(meRouter.setHashAction(e),me.pageSlideShow.currentItemObj=e.attr("data-oid",e.parents(".item").attr("data-oid")),me.pageSlideShow.disableActions=!1,me.pageSlideShow.onePhotoMode=!1,me.pageSlideShow.init(!1))}).on("dragstart",".image img",function(e){e.preventDefault()}),$(me).trigger("checkGalleryMedia"),_IS_MOBILE_?me.pageGalleryPhotos.addAddFormMobile():me.pageGalleryPhotos.galleryPhotos_initUploader(e),me.checkGalleryImgErrors(t),!t.data("can-change-order"))return!1;me.sortable_reindex(t.children("div.item")),!_IS_MOBILE_&&t.length&&t.data("sortable",new me.Sortable(t.get(0),{handle:".drug-drop",draggable:"div.item",scroll:!0,scrollSensitivity:150,scrollSpeed:35,animation:150,filter:"",forceFallback:!0,fallbackClass:"sortable-fallback",fallbackOnBody:!1,setData:function(e,t){$(t).find(".action-bar").remove()},onStart:function(e){var i=$(e.item);$(".action-bar",i).detach(),"undefined"!=typeof itemMouseEnter&&t.off("mouseenter",">.item",itemMouseEnter)},onSort:function(e){e.item;me.sortable_callback(window.AppMemorial_config.baseUrl+"gallery-edit/move",e.item,function(){me.sortable_reindex(t.children("div.item"))},function(){var e=t.children("div.item").detach().sort(function(e,t){return parseInt($(e).data("index"))-parseInt($(t).data("index"))});t.append(e)}),"undefined"!=typeof itemMouseEnter&&t.on("mouseenter",">.item",itemMouseEnter)}}))},addAddFormMobile:function(){if(_IS_MOBILE_){var e=$("#pg #uploader-photo",me);e.length&&(me.pageGalleryPhotos.$addFormHTML=e[0].outerHTML,e.remove())}},checkPhotoInGallery:function(){return $(".items-list").find("div.item").length},addFormMobile:function(){me.pageGalleryPhotos.addAddFormMobile(),_IS_MOBILE_&&me.pageGalleryPhotos.$addFormHTML.length&&($editForm=es.$modal=popup.extended({className:"dialog-new-photo-mobile bottom-slide-up",iconClass:"fmi-add-camera",title:Lang.ADD_PHOTOS,message:me.pageGalleryPhotos.$addFormHTML,onEscape:function(){es.$modal.modal("hide"),meRouter.unSetCurrentHashAction()}}).on("shown.bs.modal",function(){me.pageGalleryPhotos.galleryPhotos_initUploader($editForm)}))},galleryPhotos_initUploader:function(e){var t=$("#uploader-photo",e),i=$("input[type=file]",t);if(t.length&&i.length){var o=i.closest("form");if(o.data("can-contribute"))t.galleryUploader({type:"photo",signedIn:auth.isSignedIn(),$inputFile:i,serverUrl:window.AppMemorial_config.baseUrl+"upload/photo",autostartUpload:!0,limitUploadItems:o.data("remaining-files"),limitMaxUploadItems:o.data("max-files"),saveCallback:function(){t.trigger("countChanged",o.data("max-files")-$(".content .items-list .item").length);let e=me.getMainPhotoId();me.loadBlock("titlePhoto",function(){!e&&me.getMainPhotoId()&&_IS_MOBILE_?meRouter.moveToAbout():!e&&me.getMainPhotoId()?me.loadBlock("pageContent",function(){meRouter.scrollTo(0)},!0):me.loadBlock("pageContent",function(){me.scrollTop($("#pg").offset().top)},!0)}),me.loadBlock("mobileInnerPageTitle"),me.loadBlock("subscription"),me.loadBlock("slideshow"),me.loadBlock("activities"),$(me).trigger("checkGalleryMedia"),me.cleanAboutPageCache(),me.setAsideSlideshow()},dropHoverCallback:function(){$("#uploader_anchor:visible").length&&t.lockTimeout(1e3,function(){me.scrollTop($("#uploader_anchor").offset().top-200)},"scroller")},fileAdded:function(){$(e).removeClass("bottom-slide-up").addClass("full-height"),$.fn.initDialogScroll(),$("[data-source=computer]:visible",e).length||(t.galleryUploaderOpen("computer",1),t.displayFileChooser("computer",t))},lastFileRemoved:function(){t.galleryUploaderCloseSource(),_IS_MOBILE_&&(es.$modal.modal("hide"),meRouter.unSetCurrentHashAction())}});else{var n=o.data("remaining-files");if("unlimited"!==n&&n<=0)o.addClass("premium-contribute");else if(!auth.isSignedIn()){var a=function(){var e=$(this).data("source-name");return meRouter.setHashAction("|provider-"+e),auth.open(),_IS_MOBILE_&&es.$modal.modal("hide"),!1};$(".provider",o).on("click",a).on("submit",a),$('#circle-round-button[data-action-url="|add_photos_mobile_dialog"]').off().on("click",a)}$(".drag-drop-help",o).hide()}}},galleryPhotos_destroyUploader:function(e){var t=$(".uploader",e);"function"==typeof t.galleryUploaderDestroy&&t.galleryUploaderDestroy()},removeEvent:function(e){var t=me.pageGalleryPhotos.getMessageForDelete(e);slideShowActions.currentSlide={},me.pageGallery_delete(t,e,me.deleteItemRequest,function(){me.pageGallery_afterDelete(e),me.setAsideSlideshow(),me.loadBlock("slideshow"),me.loadBlock("titlePhoto"),me.cleanAboutPageCache(),_IS_MOBILE_&&(meRouter.setScrollAnchor($(window).scrollTop()),me.loadBlock("pageContent"))})},galleryPhotos_clickAction:{"rotate-left":function(e,t,i,o){me.galleryPhotos_rotate(o,"left")},"rotate-right":function(e,t,i,o){me.galleryPhotos_rotate(o,"right")},"tell-story":function(e,t,i,o){var n=o.attr("data-ajax-url","/stories");popup.confirm(Lang.THIS_WILL_CANCEL_SLIDESHOW,function(){slideShowActions.mediaFileId=t,slideShowActions.mediaFileSRC=o.find("img").attr("src"),slideShowActions.mediaFileTitle=o.find("img").attr("alt"),slideShowActions.mediaFileTitle=o.find(".title").text(),slideShowActions.mediaFileIsRotate=o.data("perms").indexOf("r:0"),slideShowActions.mediaFileIsEditCaption=o.data("perms").indexOf("t:1"),meRouter.unSetCurrentHashAction(),me.loadAndGotToBlock(n,function(){meRouter.setScrollAnchor("add_story_box"),slideShowActions.setMediaItemToStory("photo",".file-preview.photo")})},!1,!1,!1)},"edit-caption":function(e,t,i,o){me.pageGallery_editTitle(t)},"remove-cover":function(e,t,i,o){me.pageGalleryPhotos.galleryPhotos_coverChange(o,window.AppMemorial_config.status_main_photo.simple)},"set-cover":function(e,t,i,o){me.pageGalleryPhotos.galleryPhotos_coverChange(o,window.AppMemorial_config.status_main_photo.main,function(){$("html").animate({scrollTop:0},"slow")})},"share-facebook":function(e,t,i,o){share.isSlideshow=0,share.entityFacebook("photo",t)},"share-email":function(e,t,i,o){share.isSlideshow=0,share.entityEmail("photo",t)},delete:function(e,t,i,o){me.pageGalleryPhotos.removeEvent(o)},download:function(e,t,i,o){return e.stopPropagation(),$("a",i).attr("target","_blank").attr("href",window.AppMemorial_config.baseUrl+"gallery/download-original-photo?id="+t),!0},"premium-feature-download":function(e,t,i,o){popup.confirm(Lang.THIS_FEATURE_FOR_PREMIUM,function(){auth.requireLogin(function(){window.location="|upgrade|download_original"})})}},galleryPhotos_coverChange:function(e,t,i){if(e.lockCheck())return;e.lockOn(),e.addLoaderLayout();const o=e.attr("data-oid"),n=t?window.AppMemorial_config.status_main_photo.main:window.AppMemorial_config.status_main_photo.simple;$.post(window.AppMemorial_config.baseUrl+"gallery-edit/cover",{id:o,state:n},function(e){App.ajaxError(e)?jsLogger.showInternalError("j72002",e):e.success&&(me.loadBlock("titlePhoto"),!_IS_MOBILE_&&meRouter.isCurrentRoute("gallery/photos")?me.loadBlock("pageContent"):me.loadBlock("mobileInnerPageTitle"),n||meRouter.unSetCurrentHashAction(),"function"==typeof i&&i())},"JSON").fail(function(e){jsLogger.showAjaxFail("j72001",e)}).always(function(){e.deleteLoaderLayout(),e.lockOff()})},sliderPhoto_coverChange:function(e){var t=slideShowActions.currentSlide,i=Lang.COVER_PICTURE_ADDED;me.pageGalleryPhotos.galleryPhotos_coverChange(t,e,function(){slideShowActions.currentSlide;var t=$(".toolbar .set-cover",slideShowActions.modalHandler),o=$(".toolbar .remove-cover",slideShowActions.modalHandler);e?(t.addClass("not-visible").removeClass("visible"),o.addClass("visible").removeClass("not-visible")):(i=Lang.COVER_PICTURE_REMOVED,t.removeClass("not-visible").addClass("visible"),o.removeClass("visible").addClass("not-visible")),$(".gallery-photo-slideshow").modal("hide"),$.fn.unsetIphoneScrollPosition(),meRouter.scrollTo(0,0),_IS_MOBILE_&&meRouter.moveToAbout(),popup.success(i)})},getMessageForDelete:function(e){return e.attr("data-oid")==me.getMainPhotoId()&&(meRouter.isCurrentRoute("gallery")||me.isClickOnMainPhoto())?Lang.THIS_WILL_DELETE_MEMORIAL_COVER_PHOTO:Lang.YOU_ARE_ABOUT_TO_DELETE_PHOTO}},me.pageGallerySongs={$addFormHTML:{},init:function(e){console.log("pageGallerySongs - loaded");var t=$("#page-gallery-songs");this.loadBasicEvents(t),contentPagination.init({scrollAfterPagination:"#content"}),_IS_MOBILE_?this.addAddFormMobile():this.gallerySongs_initUploader(t),this.checkPath(),this.checkConverted(),this.afterInit(e)},reload:function(e){var t=$("#page-gallery-songs");this.loadBasicEvents(t),this.checkConverted(),contentPagination.init({scrollAfterPagination:"#content"}),_IS_MOBILE_?this.addAddFormMobile():this.gallerySongs_initUploader(t),this.checkPath(),this.afterReload(e)},checkPath:function(){"/bg-music/"===meRouter.getPreviousRoute()&&(meRouter.setIsForceBackToAboutPage(!1),me.force_history_back=!0)},afterInit:function(e){e&&e()},afterReload:function(e){e&&e()},checkConverted:function(){setInterval(function(){if(meRouter.isCurrentRoute("gallery/songs")){console.log("convert sound checking");var e=$(".item.processing"),t=[];e.length&&(e.each(function(e,i){t.push($(i).data("oid"))}),$.ajax({url:window.AppMemorial_config.baseUrl+"gallery/processing",data:{items:t,is_checking:1},method:"post",success:function(e){if(e.success){var t=e.converted;$.each(t,function(e,t){("processing"!=t.status&&"ok"!=t.status||"user_upload"!=t.state&&"conversion"!=t.state)&&$(".item.processing[data-oid="+e+"]").html($(t.html).html()).removeClass("processing").attr("data-url",$(t.html).data("url")).find(".button.player").click(function(){var e=$(t.html).data("url"),i=mediaPlayer.getAction(e),o=$("audio",$(this).next())[0],n=$(".timeline",$(this).next());return mediaPlayer.currentItemObj=$(this).parent(),mediaPlayer.current=$(this).parent().attr("data-url"),mediaPlayer[i](),setInterval(function(){var e=mediaPlayer.updateTimeline(n,o);e.duration&&e.seek==e.duration&&mediaPlayer.stop()},1e3),!1})})}}}))}},6e4)},loadBasicEvents:function(e){return e.data("can-upload")?me.circleButton.initialize("|add_songs_mobile_dialog","fmi-music",Lang.BUTTON_CIRCLE_TEXT_ADD_SONGS):me.circleButton.initialize("|premium-dialog-page","fmi-add-audio-locked",Lang.BUTTON_CIRCLE_TEXT_ADD_SONGS),e.on("click",".song .edit-song-name",function(){var e=$(this).closest("div.item"),t=$(".name",e),i=t.text(),o=$(".song .delete",e),n=$(".song .edit-song-name",e);if(_IS_MOBILE_){var a=$("<textarea/>").addClass("song-name").val(i);es.$modal=popup.extended({className:"dialog-edit-audio-mobile full-height",title:"Edit song name",message:a,onEscape:function(){es.$modal.modal("hide"),meRouter.unSetCurrentHashAction()},buttons:{Save:{className:"button save",label:Lang.SAVE,callback:function(){return es.$modal.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"gallery-edit/rename",{method:"ajax",id:e.data("oid"),name:$(".dialog-edit-audio-mobile .song-name").val()},function(e){es.$modal.deleteLoaderLayout(),e.error?jsLogger.showInternalError("j73001",e):(t.html(e.name),es.$modal.modal("hide"),popup.success(Lang.EDIT_SONG_TITLE_MOBILE_CHANGES_SAVED))},"json").fail(function(e){jsLogger.showAjaxFail("j73002",e)}),!1}}}})}else t.hide(),o.hide(),n.hide(),me.pageGallery_editTitleInline(e,t,e.data("oid"),function(e){t.show(),o.show(),n.show(),e&&popup.success(Lang.EDIT_SONG_TITLE_CHANGES_SAVED)})}).on("click",".songs .delete",function(){var e=$(this).closest("div.item");return me.gallerySongs_delete(e),!1}).find("#add-audio").off().click(function(){$(".uploader.audio").length&&$("html, body").animate({scrollTop:$(".uploader.audio").offset().top-200},300)}),e.find(".manage-bg-music").click(function(){me.loadAndGotToBlock($(this))}),this},addAddFormMobile:function(){if(_IS_MOBILE_){var e=$("#uploader-audio",me);$("body").hasClass("safari")&&$("body").hasClass("iphone")&&e.find('[type="file"]').removeAttr("accept"),e.length>0&&(me.pageGallerySongs.$addFormHTML=e[0].outerHTML,e.remove())}},addFormMobile:function(){_IS_MOBILE_&&me.pageGallerySongs.$addFormHTML.length&&($editForm=es.$modal=popup.extended({iconClass:"fmi-music-add",className:"dialog-new-audio-mobile bottom-slide-up",title:Lang.ADD_SONGS,message:me.pageGallerySongs.$addFormHTML,onEscape:function(){es.$modal.modal("hide"),meRouter.unSetCurrentHashAction()}}).on("shown.bs.modal",function(){me.pageGallerySongs.gallerySongs_initUploader($editForm)}))},gallerySongs_initUploader:function(e){var t=$(".uploader.audio",e),i=$("input[type=file]",t);if(t.length&&i.length){var o=i.closest("form");if(o.data("can-contribute"))t.galleryUploader({type:"song",signedIn:auth.isSignedIn(),$inputFile:$("input[type=file]",t),serverUrl:window.AppMemorial_config.baseUrl+"upload/audio",autostartUpload:!0,limitUploadItems:o.data("remaining-files"),limitMaxUploadItems:o.data("max-files"),saveCallback:function(){t.trigger("countChanged",o.data("max-files")-$(".content .items-list .item").length),me.scrollTop($("#pg").offset().top),me.loadBlock("pageContent",null,!0),me.loadBlock("activities"),$(me).trigger("checkGalleryMedia"),mediaPlayer.stop()},dropHoverCallback:function(){$("#uploader_anchor:visible").length&&t.lockTimeout(1e3,function(){me.scrollTop($("#uploader_anchor").offset().top-200)},"scroller")},fileAdded:function(){$(e).removeClass("bottom-slide-up").addClass("full-height"),$.fn.initDialogScroll(),$("[data-source=computer]:visible",e).length||(t.galleryUploaderOpen("computer",1),t.displayFileChooser("computer",t))},lastFileRemoved:function(){t.galleryUploaderCloseSource(),_IS_MOBILE_&&(es.$modal.modal("hide"),meRouter.unSetCurrentHashAction())}});else{var n=o.data("remaining-files");if("unlimited"!==n&&n<=0)o.addClass("premium-contribute");else if(!auth.isSignedIn()){var a=function(){return auth.open(),_IS_MOBILE_&&es.$modal.modal("hide"),!1};o.on("click",a).on("submit",a)}$(".drag-drop-help",o).hide()}}}},me.pageGalleryVideos={pageSelector:"#page-gallery-videos",itemsSelector:".content > .items-list",$pg:{},$items:{},$addFormHTML:{},init:function(e){this.$pg=$(this.pageSelector),this.$items=$(this.itemsSelector,this.$pg),this.bindClicks(),this.initCircleButton(),this.setItemsPermissions(),this.initUploadForms(),this.initShareActions(),this.initSortableActions(),this.checkConverted(),$(me).trigger("checkGalleryMedia"),contentPagination.init({scrollAfterPagination:"#content"}),this.afterInit(e),console.log("pageGalleryVideos - loaded")},reload:function(e){this.init(!1),this.afterReload(e)},afterInit:function(e){e&&e()},afterReload:function(e){e&&e()},bindClicks:function(){$(this.pageSelector).on("mouseenter",".content > .items-list >.item",function(){me.pageGallery_showActionBar($(this))}).on("mouseleave",".content > .items-list >.item",function(){me.pageGallery_hideActionBar($(this))}).on("click",'.page-actions a[data-ajax-url="gallery-edit/videos"]',function(){page("/gallery-edit/videos")}).on("click",".items-list .video, .items-list .img-background, .items-list .story-icon-wrapper",function(){return $el=$(this).parents(".image").find(".video"),$el.hasClass("video-error")?(me.showContactUs($el),!1):!$el.parents(".image").hasClass("status-error")&&!$el.parents(".image").hasClass("status-converting")&&(meRouter.setHashAction($el),me.pageVideoView.disableActions=!1,me.pageVideoView.init(!1,$el),!1)}).on("click","#add-video",function(){const e=$(".uploader.video");if(e.length){let t=e.offset().top-200;meRouter.scrollTo(t)}}).on("dragstart",".image img",function(e){e.preventDefault()})},initCircleButton:function(){this.$pg.data("can-upload")?me.circleButton.initialize("|add_videos_mobile_dialog","fmi-video",Lang.BUTTON_CIRCLE_TEXT_ADD_VIDEOS):me.circleButton.initialize("|premium-dialog-page","fmi-add-video-locked",Lang.BUTTON_CIRCLE_TEXT_ADD_VIDEOS).clickFunction(function(){eventTracking.run("memorial","purchase_trigger","Free Memorial Video Uploader")})},initShareActions:function(){this.$items.on("click",".actions [data-action], .share [data-action]",function(e){var t=me.pageGallery_handleActionClick.apply(this,[e,me.pageGalleryVideos.galleryVideos_clickAction]);return me.pageGallery_hideActionBar($(this).closest(".item"),1),t})},setItemsPermissions:function(){const e=this.$items;$(".item",e).each(function(e,t){var i=$(t);me.pageGalleryVideos.setItemPerms(i)})},initUploadForms:function(){const e=this.$pg;me.youtubeUploaderDestroy(),_IS_MOBILE_?me.pageGalleryVideos.addAddFormMobile():me.pageGalleryVideos.galleryVideos_initUploader(e)},initSortableActions:function(){const e=this.$pg,t=this.$items,i=function(){me.pageGallery_showActionBar($(this))};if(!t.data("can-change-order"))return!1;me.sortable_reindex(t.find("div.item")),!_IS_MOBILE_&&t.length&&t.data("sortable",new me.Sortable(t.get(0),{handle:".drug-drop",draggable:"div.item",scroll:!0,scrollSensitivity:150,scrollSpeed:35,animation:150,ignore:"",forceFallback:!0,fallbackClass:"sortable-fallback",fallbackOnBody:!1,setData:function(e,t){$(t).find(".action-bar").remove()},onStart:function(t){var o=$(t.item);$(".action-bar",o).detach(),e.off("mouseenter",".content > .items-list >.item",i)},onSort:function(o){e.on("mouseenter",".content > .items-list >.item",i);o.item;me.sortable_callback(window.AppMemorial_config.baseUrl+"gallery-edit/move",o.item,function(){me.sortable_reindex(t.find("div.item"))},function(){var e=t.children("div.item").detach().sort(function(e,t){return parseInt($(e).data("index"))-parseInt($(t).data("index"))});t.append(e)})}}))},checkConverted:function(){setInterval(function(){if(meRouter.isCurrentRoute("/gallery/videos")||meRouter.isCurrentRoute("/gallery-edit/videos")){console.log("convert video checking");var e=$(".image.status-converting").parent(),t=[];e.length&&(e.each(function(e,i){t.push($(i).data("oid"))}),$.ajax({url:window.AppMemorial_config.baseUrl+"gallery/check",data:{ids:t,is_checking:1},method:"post",success:function(e){e.success&&jQuery.each(e.states,function(e,t){var i=$(".gallery-video-slideshow");if(t.status===window.AppMemorial_config.album_status.ok&&t.state===window.AppMemorial_config.album_state.ready&&(i.find(".video-slide[data-oid="+t.id+"]").length&&(i.find(".not-visible").addClass("visible").removeClass("not-visible"),i.find(".video-slide[data-oid="+t.id+"]").html(t.video_block)),meRouter.isCurrentRoute("/gallery-edit/videos"))){var o=$('item[data-oid="'+t.id+'"]');o.find(".status-converting").removeClass("status-converting"),o.find(".video img").attr("src",t.url),o.find("#status_video").attr("class","")}var n=$("a.video[data-oid="+t.id+"]").parents(".image");(t.status!==window.AppMemorial_config.album_status.ok||t.state!==window.AppMemorial_config.album_state.user_upload&&t.state!==window.AppMemorial_config.album_state.conversion)&&(t.status===window.AppMemorial_config.album_status.ok&&t.state===window.AppMemorial_config.album_state.ready?(n.removeClass("status-converting no-img"),$(".no-img",n).removeClass("no-img"),t.perms&&($("a.video[data-oid="+t.id+"]").attr("data-perms",t.perms),$(".item[data-oid="+t.id+"]").attr("data-perms",t.perms).removeClass("processing"),me.pageGalleryVideos.permsUpdate($(".item[data-oid="+t.id+"]"),t.perms)),$("a.video[data-oid="+t.id+"] .img-wrapper").append('<div class="play-overlay"></div>')):t.status===window.AppMemorial_config.album_status.error&&(n.removeClass("status-converting").addClass("status-error video-error"),$(".video",n).removeClass("video-ok").addClass("status-error video-error"))),$("a.video[data-oid="+t.id+"] .img-wrapper img").attr("src",t.url)})}}))}},6e4)},setColumns:function(e){$(".options .list .option-item.visible",e).length>4?$(".options .list",e).addClass("col-2"):$(".options .list",e).addClass("col-1")},setItemPerms:function(e){var t=e.attr("data-perms");$(".options .list .option-item",e).each(function(e,i){var o=$(i).data("perm-id");t.indexOf(o+":1")>=0?$(i).show().addClass("visible"):$(i).hide().removeClass("visible")}),me.pageGalleryVideos.setColumns(e)},permsUpdate:function(e,t){void 0!=t&&$(".options .list .option-item",e).each(function(e,i){var o=$(i).attr("data-perm-id");t.indexOf(o+":1")<0?$(i).hide().removeClass("visible"):$(i).show().addClass("visible")}),me.pageGalleryVideos.setColumns(e)},addAddFormMobile:function(){if(_IS_MOBILE_){var e=$("#uploader-video",me);e.length>0&&(me.pageGalleryVideos.$addFormHTML=e[0].outerHTML,e.remove())}},addFormMobile:function(){_IS_MOBILE_&&me.pageGalleryVideos.$addFormHTML.length&&($editForm=es.$modal=popup.extended({iconClass:"fmi-video-add",className:"dialog-new-video-mobile bottom-slide-up",title:Lang.MOBILE_ADD_VIDEO_DIALOG_TITLE,message:me.pageGalleryVideos.$addFormHTML,onEscape:function(){es.$modal.modal("hide"),me.youtubeUploaderDestroy(),meRouter.unSetCurrentHashAction()},onClose:function(){me.youtubeUploaderDestroy()}}).on("shown.bs.modal",function(){me.pageGalleryVideos.galleryVideos_initUploader($editForm)}))},galleryVideos_initUploader:function(e){var t=$(".uploader.video",e),i=$("input[type=file]",t);if(t.length&&i.length){var o=i.closest("form");if(o.data("can-contribute"))t.galleryUploader({type:"video",signedIn:auth.isSignedIn(),$inputFile:$("input[type=file]",t),serverUrl:window.AppMemorial_config.baseUrl+"upload/video",autostartUpload:!0,showRotationControls:!1,limitUploadItems:o.data("remaining-files"),limitMaxUploadItems:o.data("max-files"),saveCallback:function(){$.isNumeric(o.data("max-files"))&&t.trigger("countChanged",o.data("max-files")-$(".content .items-list .item").length),_IS_MOBILE_||me.scrollTop($("#pg").offset().top),me.loadBlock("pageContent",null,!0),me.loadBlock("activities"),me.cleanAboutPageCache(),$(me).trigger("checkGalleryMedia")},dropHoverCallback:function(){$("#uploader_anchor:visible").length&&t.lockTimeout(1e3,function(){me.scrollTop($("#uploader_anchor").offset().top-200)},"scroller")},fileAdded:function(){$(e).removeClass("bottom-slide-up").addClass("full-height"),$.fn.initDialogScroll(),$("[data-source=computer]:visible",e).length||(t.galleryUploaderOpen("computer",1),t.displayFileChooser("computer",t))},lastFileRemoved:function(){t.galleryUploaderCloseSource(),_IS_MOBILE_&&(es.$modal.modal("hide"),meRouter.unSetCurrentHashAction())}});else{var n=o.data("remaining-files");if("unlimited"!==n&&n<=0)o.addClass("premium-contribute");else if(!auth.isSignedIn()){var a=function(){var e=$(this).data("source-name");return meRouter.setHashAction("|provider-"+e),auth.open(),_IS_MOBILE_&&es.$modal.modal("hide"),!1};$(".provider",o).on("click",a).on("submit",a)}$(".drag-drop-help",o).hide()}}},galleryVideos_destroyUploader:function(e){var t=$(".uploader",e);"function"==typeof t.galleryUploaderDestroy&&t.galleryUploaderDestroy()},galleryVideos_clickAction:{"change-snapshot":function(e,t,i,o){me.galleryVideos_changeSnapshot(t)},"rotate-left":function(e,t,i,o){me.galleryVideos_rotate(o,"left")},"rotate-right":function(e,t,i,o){me.galleryVideos_rotate(o,"right")},"tell-story":function(e,t,i,o){var n=o.attr("data-ajax-url","/stories");popup.confirm(Lang.THIS_WILL_CANCEL_SLIDESHOW,function(){slideShowActions.mediaFileId=t,slideShowActions.mediaFileSRC=o.find("img").attr("src"),slideShowActions.mediaFileTitle=o.find("img").attr("alt"),slideShowActions.mediaFileTitle=o.find(".title").text(),slideShowActions.mediaFileIsRotate=o.data("perms").indexOf("r:0"),slideShowActions.mediaFileIsEditCaption=o.data("perms").indexOf("t:1"),meRouter.unSetCurrentHashAction(),me.loadAndGotToBlock(n,function(){meRouter.setScrollAnchor("add_story_box"),slideShowActions.setMediaItemToStory("video",".file-preview.video")})},!1,!1,!1)},"edit-caption":function(e,t,i,o){me.pageGallery_editTitle(t)},delete:function(e,t,i,o){slideShowActions.currentSlide={},me.pageGallery_delete(Lang.YOU_ARE_ABOUT_TO_DELETE_VIDEO,o,me.deleteItemRequest,function(){me.pageGallery_afterDelete(o),me.cleanAboutPageCache()})},download:function(e,t,i,o){return e.stopPropagation(),$("a",i).attr("target","_blank").attr("href",window.AppMemorial_config.baseUrl+"gallery/download-original-video?id="+t),!0},"share-facebook":function(e,t,i,o){share.entityFacebook("video",t)},"share-email":function(e,t,i,o){share.entityEmail("video",t)},"premium-feature-download":function(e,t,i,o){popup.confirm(Lang.THIS_FEATURE_FOR_PREMIUM,function(){auth.requireLogin(function(){window.location="|upgrade|download_original"})})}}},me.pageLifeStories={$editForm:!1,title:"",text:"",editMode:!1,mediaCheck:!1,editStoryId:-1,is_only_in_story:!1,media:{},$addFormHTML:"",init:function(e){console.log("pageLifeStories - loaded");var t=$("#page-lifestories"),i=$(".list-wrapper",t);_IS_MOBILE_?me.pageLifeStories.addAddFormMobile():me.pageLifeStories.lifestories_initAddForm(),this.setBaseEvents(t),i.data("can-change-order")&&!_IS_MOBILE_&&this.addSortTableData(i),$(me).trigger("checkGalleryMedia"),me.pageStories.checkConverted(),new readMore(t,me.opts.lifeStoryShortLength,me.opts.lifeStoryShortLines),contentPagination.init({scrollAfterPagination:"#content"}),this.afterInit(e),this.activeColorDraft()},reload:function(e){var t=$("#page-lifestories"),i=$(".list-wrapper",t);this.setBaseEvents(t),new readMore(t,me.opts.lifeStoryShortLength,me.opts.lifeStoryShortLines),contentPagination.init({scrollAfterPagination:"#content"}),i.data("can-change-order")&&!_IS_MOBILE_&&this.addSortTableData(i),_IS_MOBILE_?me.pageLifeStories.addAddFormMobile():me.pageLifeStories.lifestories_initAddForm(),this.afterReload(e)},afterInit:function(e){e&&e()},afterReload:function(e){e&&e()},addAddFormMobile:function(){if(_IS_MOBILE_){var e=$("#add_lifestory_box",me);e.length&&(me.pageLifeStories.$addFormHTML=e[0].outerHTML,e.remove())}},activeColorDraft:function(){$("body").on("click","#add_lifestory_box ."+autoSave.classPainted,function(){$(this).removeClass(autoSave.classPainted)})},addFormMobile:function(){if(_IS_MOBILE_&&me.pageLifeStories.$addFormHTML.length){if(!auth.isSignedIn())return auth.open(),!1;me.pageLifeStories.openAddFormMobile()}},openAddFormMobile:function(){me.pageLifeStories.$editForm=es.$modal=popup.extended({className:"dialog-new-lifestory-mobile full-height",title:Lang.MOBILE_DIALOG_TITLE_SHARE_A_LIFE_STORY,iconClass:"fmi-person-book",message:me.pageLifeStories.$addFormHTML,onEscape:function(){meRouter.unSetCurrentHashAction(),es.$modal.modal("hide")},buttons:{publish:{label:Lang.PUBLISH_BUTTON,className:"button modal-header-button publish-button large-center-mobile",callback:function(){return meRouter.setIsForceBackToAboutPage(!1),$("form",me.pageLifeStories.$editForm).submit(),!1}}}}).on("shown.bs.modal",function(){me.pageLifeStories.lifestories_initAddForm()}).on("hide.bs.modal",function(){meRouter.checkForceBackToAboutPage()})},addSortTableData:function(e){me.sortable_reindex(e.find("div.lifestory")),$("div.lifestory").removeClass("ignore-elements"),e.get(0).length&&e.data("sortable",new me.Sortable(e.get(0),{handle:"div.lifestory",draggable:"div.lifestory",scroll:!0,scrollSensitivity:150,scrollSpeed:35,animation:150,ignore:"",filter:".ignore-elements, .user_text, .ordering, .actions",preventOnFilter:!1,forceFallback:!0,fallbackClass:"sortable-fallback",fallbackOnBody:!1,setData:function(e,t){$(t).find(".action-bar").remove()},onStart:function(e){var t=$(e.item);$(".action-bar",t).detach()},onSort:function(t){me.sortable_callback(window.AppMemorial_config.baseUrl+"lifestory/move",t.item,function(){me.sortable_reindex(e.find("div.lifestory"))},function(){var t=e.children("div.lifestory").detach().sort(function(e,t){return parseInt($(e).data("index"))-parseInt($(t).data("index"))});e.append(t)})}}))},setBaseEvents:function(e){var t=0;auth.isSignedIn()&&$("#page-lifestories.can-add").length?me.circleButton.initialize("|add_lifestory_mobile_dialog","fmi-person-book",Lang.BUTTON_CIRCLE_TEXT_SHARE_A_LIFE_STORY):me.circleButton.destroy(),e.find(".ordering .up").on("click",function(){var e=$(this);me.lifestories_moveUp(e)}),e.find(".action.add_lifestory").on("click",function(){$("html, body").animate({scrollTop:e.find("#add_lifestory_box").offset().top},300)}),e.find(".ordering .down").on("click",function(){var e=$(this);me.lifestories_moveDown(e)}),e.find(".action.delete").on("click",function(){var e=$(this);me.lifestory_delete(e)}),e.find(".action.edit").on("click",function(){var e=$(this),i=e.closest(".lifestory").data("oid");meRouter.setHashAction(e),clearTimeout(t),$("#dialog-edit-lifetory").length>0&&$(".edit-form .button.cancel").click(),t=setTimeout(function(){me.pageLifeStories.lifestories_openEditDialog(i)},500)}),e.find(".add-media-check-check").on("click",function(){$(this).find("input").trigger("change")}),e.find(".lifestory .story-media").on("click",function(){if($(this).hasClass("media-error"))return me.showContactUs(this),!1;if($(this).hasClass("audio")){var e=$(this).find("a.button.player");if("processing"==e.attr("data-song-state"))return!1;if("error"==e.attr("data-song-state"))return e.attr("data-url",e.attr("href")),me.showContactUs(e),!1}return me.story_openMedia(this),!1})},lifestories_initAddForm:function(){me.pageStories.stories_initAddFormAbstract($("#add_lifestory_box"),window.AppMemorial_config.baseUrl+"lifestory/add",window.AppMemorial_config.baseUrl+"upload/lifestory-media")},lifestories_openEditDialog:function(e){globalLoader.showGlobalLoader(),me.pageStories.stories_loadTellStoryDialogBundle(function(){me.vars.saveEditUrl="lifestory/save",auth.requireLogin(function(){me.editStoryDialog.editLifestory(e)})})},openPreviousPopup:function(){_IS_MOBILE_&&(me.pageLifeStories.editMode?me.pageLifeStories.editStoryId>0?me.editStoryDialog.editLifestory(me.pageLifeStories.editStoryId):jsLogger.showInternalError("j75001",me.pageLifeStories):me.pageLifeStories.openAddFormMobile())}},me.pagePremium={pgSelector:"#page-premium",$pg:{},init:function(e){me.pagePremium.$pg=$(me.pagePremium.pgSelector),me.circleButton.destroy(),meRouter.scrollTo(0),this.checkPath(),this.afterInit(e)},reload:function(e){me.pagePremium.$pg=$(me.pagePremium.pgSelector),me.circleButton.destroy(),meRouter.scrollTo(0),this.checkPath(),this.afterReload(e)},afterInit:function(e){e&&e()},afterReload:function(e){e&&e()},checkPath:function(){"/bg-music/"===meRouter.getPreviousRoute()?(meRouter.setIsForceBackToAboutPage(!1),me.force_history_back=!0):"/about"!==meRouter.getPreviousRoute()&&meRouter.setIsForceBackToAboutPage(!1)}},me.pageSettings={page:{},currentEl:!1,privacyChanged:!1,showInviteConfirmation:!1,data:{reloadPlaylist:!1},init:function(e){this.page=$("#page-settings"),this.initOptions(),console.log("pageSettings - loaded"),this.afterInit(e)},reload:function(e){this.page=$("#page-settings"),this.initOptions(),this.afterReload(e)},afterInit:function(e){e&&e()},afterReload:function(e){e&&e()},removeSelectedClass:function(e,t){e.parents(".radio-buttons").find(".selected").removeClass("selected"),void 0!=typeof t&&1==t&&e.parent().addClass("selected")},initOptions:function(){$("form input",this.page).change(function(){$el=$(this),me.pageSettings.currentEl=$el;var e=$el;me.pageSettings.removeSelectedClass(e,!0);let t=function(){me.pageSettings.privacyChanged=!0;var e=me.pageSettings.page.data("saveTimer");e&&clearTimeout(e),me.pageSettings.page.data("saveTimer",setTimeout(function(){me.loadBlock("visits"),me.loadBlock("bookmarks")},1500)),me.pageSettings.save()};if("privacy"==e.attr("name")){let i=e.val();if("private"===i)return popup.confirm(Lang.CHANGE_THE_PRIVACY_PRIVACY,function(){t()},function(){me.pageSettings.removeSelectedClass(e),$('.privacy-input[value="'+window.AppMemorial_config.privacy+'"]',me.pageSettings.page).prop("checked",!0).parent().addClass("selected")},!1,!1,{ok:Lang.MAKE_PRIVATE}),!1;"invited"===i&&(me.pageSettings.showInviteConfirmation=!0),t()}else me.pageSettings.save()}),$(".for-all-guests").click(function(){$("#notification-preferences .radio-custom").hasClass("selected")&&($(this).hasClass("disabled")||popup.confirm(Lang.FOR_ALL_VISITORS,function(){me.pageSettings.page.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"settings/save_default_notification",{ajax:!0,memorial_id:window.AppMemorial_config.memorialId},function(e){e.success?(popup.success(Lang.VISITORS_UPDATED.format(e.count)),me.layoutLoad.subscription()):jsLogger.showInternalError("j76001",e)},"json").fail(function(e){jsLogger.showAjaxFail("j76002",e)}).always(function(){me.pageSettings.page.deleteLoaderLayout()})},!1,!1,!1,{cancel:Lang.FOR_ALL_VISITORS_CANCEL,ok:Lang.FOR_ALL_VISITORS_OK},"apply-to-all-guest"))})},save:function(){if(me.pageSettings.currentEl){if(me.pageSettings.currentEl.hasClass("notification-preferences")){var e="";$(".for-all-guests").addClass("disabled"),$(".notification-preferences").each(function(t,i){$(i).is(":checked")&&(e+=$(i).attr("name")+",")}),$(".notification-preferences-hidden").val(e.slice(0,-1))}me.pageSettings.currentEl.hasClass("notification-preferences-global")&&($(".notification-preferences-global").removeAttr("checked").parent().removeClass("selected"),me.pageSettings.currentEl.prop("checked","checked").parent().addClass("selected"),"custom"==me.pageSettings.currentEl.attr("name")?($("#notification-preferences .radio-custom").addClass("selected"),$("#notification-preferences .notification-preferences-wrapper").removeClass("options-disabled"),$(".notification-preferences").each(function(e,t){$(t).removeAttr("disabled")})):($("#notification-preferences .radio-custom").removeClass("selected"),$("#notification-preferences .notification-preferences-wrapper").addClass("options-disabled"),$(".notification-preferences").each(function(e,t){$(t).prop("checked","checked").prop("disabled","disabled")})),$(".notification-preferences-global-hidden").val(me.pageSettings.currentEl.attr("name")))}var t=$("form",me.pageSettings.page);$.each(t.serializeArray(),function(e,t){me.pageSettings.data[t.name]=t.value});var i=me.pageSettings.privacyChanged&&window.AppMemorial_config.privacy!=$('[name="privacy"]:checked',me.pageSettings.page).val();me.pageSettings.page.addLoaderLayout(),i&&globalLoader.showGlobalLoader(),$.post(window.AppMemorial_config.baseUrl+"settings/save",me.pageSettings.data,function(e){i&&(me.pageSettings.privacyChanged=!1,!0===me.pageSettings.showInviteConfirmation&&(window.location=window.location.href+"#|invite-confirm-dialog"),me.pageSettings.showInviteConfirmation=!1,setTimeout(function(){window.location.reload()},1e3)),$(".for-all-guests").removeClass("disabled")},"json").fail(function(e){jsLogger.showAjaxFail("j76003",e),me.pageSettings.page.deleteLoaderLayout()}).always(function(){me.pageSettings.page.deleteLoaderLayout()})}},me.pageStories={$editForm:!1,title:"",text:"",editMode:!1,editStoryId:-1,is_only_in_story:!1,mediaCheck:!1,media:{},$addFormHTML:"",init:function(e){console.log("pageStories - loaded");var t=$("#page-stories"),i=$(".list-wrapper",t);this.setBaseEvents(t),$(me).trigger("checkGalleryMedia");var o=$("#add_story_box .uploader.story_media");void 0!==o.storyMediaUploaderDestroy&&o.storyMediaUploaderDestroy(),new readMore(t,me.opts.storyShortLength,me.opts.storyShortLines),contentPagination.init({scrollAfterPagination:"#content"});var n=$(".content > .items-list",t).data("sortable");n&&"function"==typeof n.destroy&&n.destroy(),$("#add_story_box .add-form .content").wysiwyg("destroy"),$("#add_story_box .add-form .title").autosave("destroy"),t.off(),_IS_MOBILE_?me.pageStories.addAddFormMobile():me.pageStories.stories_initAddForm(),i.data("can-change-order")&&!_IS_MOBILE_&&this.addSortTableData(i),this.activeColorDraft(),this.checkConverted(),this.afterInit(e)},reload:function(e){var t=$("#page-stories"),i=$(".list-wrapper",t);this.setBaseEvents(t),new readMore(t,me.opts.storyShortLength,me.opts.storyShortLines),contentPagination.init({scrollAfterPagination:"#content"}),i.data("can-change-order")&&!_IS_MOBILE_&&this.addSortTableData(i),_IS_MOBILE_?me.pageStories.addAddFormMobile():me.pageStories.stories_initAddForm(),this.checkConverted(),this.activeColorDraft(),this.afterReload(e)},afterInit:function(e){e&&e()},activeColorDraft:function(){$("body").on("click","#add_story_box ."+autoSave.classPainted,function(){$(this).removeClass(autoSave.classPainted)})},afterReload:function(e){e&&e()},removeExtraLineBreak:function(e){return e.replace(/(<br\s*\/?>){4,}/gi,"<br><br><br><br>").replace(/(<div><br><\/div>?>){4,}/gi,"<div><br></div><div><br></div><div><br></div>")},checkConverted:function(){setInterval(function(){if(meRouter.isCurrentRoute("stories")||meRouter.isCurrentRoute("lifestory")){console.log("convert sound and video checking");var e=$(".item.processing"),t=$(".video a.status-converting"),i=[],o=[];t.length&&(t.each(function(e,t){o.push($(t).data("oid"))}),$.ajax({url:window.AppMemorial_config.baseUrl+"gallery/check",data:{ids:o,fromStory:1,is_checking:1},method:"post",success:function(e){e.success&&jQuery.each(e.states,function(e,t){var i=$("a[data-oid="+t.id+"]").parents(".video");("ok"!=t.status||"user_upload"!=t.state&&"conversion"!=t.state)&&("ok"==t.status&&"ready"==t.state?(i.removeClass("status-converting no-img"),$(".no-img",i).removeClass("no-img"),$("a[data-oid="+t.id+"]").append('<div class="play-overlay"></div>')):"error"==t.status&&(i.removeClass("status-converting").addClass("status-error media-error"),$(".video",i).removeClass("video-ok").addClass("status-error media-error"))),$("a[data-oid="+t.id+"] img").attr("src",t.url),$("a[data-oid="+t.id+"] img.mobile").attr("src",t.urlMob)})}})),e.length&&(e.each(function(e,t){i.push($(t).data("oid"))}),$.ajax({url:window.AppMemorial_config.baseUrl+"gallery/processing",data:{items:i,is_checking:1},method:"post",success:function(e){if(e.success){var t=e.converted;$.each(t,function(e,t){if("processing"!=t.status&&"ok"!=t.status||"user_upload"!=t.state&&"conversion"!=t.state){var i=$($(t.html).html());i.find(".delete").remove(),i.find(".edit-song-name").remove(),i.find(".shared").remove(),i.find(".timeline").remove(),$(".item.processing[data-oid="+e+"]").html(i).attr("data-url",$(t.html).data("url")).removeClass("processing").find(".button.player"),mediaPlayer.setHandlers()}else;})}}}))}},6e4)},addAddFormMobile:function(){if(_IS_MOBILE_){var e=$("#add_story_box",me);e.length&&(me.pageStories.$addFormHTML=e[0].outerHTML,e.remove())}},addFormMobile:function(){if(_IS_MOBILE_&&me.pageStories.$addFormHTML.length){if(!auth.isSignedIn())return auth.open(),!1;me.pageStories.openAddFormMobile()}},openAddFormMobile:function(e){me.pageStories.$editForm=es.$modal=popup.extended({className:"dialog-new-stories-mobile full-height",title:Lang.ADD_A_STORY_DIALOG_TITLE,iconClass:"fmi-story-add",message:me.pageStories.$addFormHTML,onEscape:function(){meRouter.unSetCurrentHashAction(),es.$modal.modal("hide")},buttons:{publish:{label:Lang.PUBLISH_BUTTON,className:"button modal-header-button publish-button large-center-mobile",callback:function(){return meRouter.setIsForceBackToAboutPage(!1),$("form",me.pageStories.$editForm).submit(),!1}}}}).on("shown.bs.modal",function(){me.pageStories.stories_initAddForm(),me.pageStories.editMode=!1,typeof e!=ud&&e(me.pageStories.$editForm)}).on("hide.bs.modal",function(){meRouter.checkForceBackToAboutPage()})},addSortTableData:function(e){me.sortable_reindex(e.find("div.story")),$("div.story").removeClass("ignore-elements"),e.get(0).length&&e.data("sortable",new me.Sortable(e.get(0),{handle:"div.story",draggable:"div.story",scroll:!0,scrollSensitivity:30,scrollSpeed:10,animation:150,ignore:"",filter:".ignore-elements, .user_text, .ordering, .actions",preventOnFilter:!1,forceFallback:!0,fallbackClass:"sortable-fallback",fallbackOnBody:!1,setData:function(e,t){$(t).find(".action-bar").remove()},onStart:function(e){var t=$(e.item);$(".action-bar",t).detach()},onSort:function(t){me.sortable_callback(window.AppMemorial_config.baseUrl+"stories/move",t.item,function(){me.sortable_reindex(e.find("div.story"))},function(){var t=e.children("div.story").detach().sort(function(e,t){return parseInt($(e).data("index"))-parseInt($(t).data("index"))});e.append(t)})}}))},setBaseEvents:function(e){var t=0;me.circleButton.initialize("|add_story_mobile_dialog","fmi-story",Lang.BUTTON_CIRCLE_TEXT_ADD_A_STORY),e.find(".ordering .up").on("click",function(){var e=$(this);me.stories_moveUp(e)}),e.find(".ordering .down").on("click",function(){var e=$(this);me.stories_moveDown(e)}),e.find(".action.delete").on("click",function(){var e=$(this).parents(".rounded-box");me.stories_delete(e)}),e.find(".action.edit").on("click",function(){var e=$(this),i=e.closest(".story").data("oid");meRouter.setHashAction(e),clearTimeout(t),$("#dialog-edit-story").length>0&&$(".edit-form .button.cancel").click(),t=setTimeout(function(){me.pageStories.stories_openEditDialog(i)},500)}),e.find(".add-media-check").on("click",function(){$(this).find("input").trigger("change")}),e.find(".story-media").on("click",function(){if($(this).hasClass("media-error"))return me.showContactUs(this),!1;if($(this).hasClass("audio")){var e=$(this).find("a.button.player");if("processing"==e.attr("data-song-state"))return!1;if("error"==e.attr("data-song-state"))return e.attr("data-url",e.attr("href")),me.showContactUs(e),!1}return me.story_openMedia(this),!1})},stories_initAddForm:function(){me.pageStories.stories_initAddFormAbstract($("#add_story_box"),window.AppMemorial_config.baseUrl+"stories/add",window.AppMemorial_config.baseUrl+"upload/story-media")},stories_initAddFormAbstract:function(e,t,i){var o=$("form",e);if(o.length){var n=o.data("remaining-files");if($(".add-form .title",e).autosave(),$(".form-group .redactor-box",o).length){var a=$(".redactor-box textarea",o).show()[0].outerHTML;$(".form-group .redactor-box",o).parent().html(a)}if($(".add-form .content",e).wysiwyg({disabledLinks:1}),o.data("can-contribute"))"unlimited"==n||n?(me.pageStories.stories_initMediaUploaderAbstract(e,i),o.find(".uploader-wrapper .cancel").click(function(){o.find("#album_file_id").val(""),typeof slideShowActions!==un&&slideShowActions.flushMediaData()})):o.addClass("premium-contribute"),me.addFormValidate(o),o.submit(function(){var i=$("textarea[name=txt]",o);if(i.wysiwyg("sync"),i.val()==i.attr("placeholder")&&i.val(""),!i.val()||0===$($.parseHTML(i.val())).text().trim().length){var n=i.closest(".redactor-box"),a='<div class="story-txt-add-error-container has-error"><span class="help-block form-error">'+Lang.EMPTY_TXT_STORY+"</span></div>";return $("#add_story_box .redactor-box, #add_lifestory_box .redactor-box").addClass("error").after(a),_IS_MOBILE_||me.scrollTop(n.offset().top-120),$("#add_story_box .redactor-editor, #add_lifestory_box .redactor-editor").on("keydown",function(){$("#add_story_box .redactor-box, #add_lifestory_box .redactor-box").removeClass("error"),$(".story-txt-add-error-container").remove()}),!1}$("#add_story_box .redactor-box, #add_lifestory_box .redactor-box").addClass("has-success"),$(".story-txt-add-error-container").remove(),me.setAsideSlideshow();var r="story";meRouter.isCurrentRoute("lifestory")&&(r="life_story_chapter");var s="no_media";return $(".file-preview.photo.success",o).length?s="photo":$(".file-preview.audio.success",o).length?s="song":$(".file-preview.video.success",o).length?s="video":$(".file-preview.youtube.success",o).length?s="youtube":$(".file-preview.doc.success",o).length&&(s="doc"),eventTracking.run(r,"content_additions",s),me.pageStories.isValidProcess(o,t,e),!1});else if("unlimited"==n||n||o.addClass("premium-contribute"),!auth.isSignedIn()){var r=function(){return auth.open(),!1};o.on("submit",r),$("input, .redactor-box-wrapper, .providers .provider",o).on("click",r)}}},isValidProcess:function(e,t,i){var o=e.closest(".rounded-box");if(!o.lockCheck()){o.lockOn().addLoaderLayout();var n={id:$("input[name=id]",e).val(),title:$("input[name=title]",e).val(),album_file_id:$("input[name=album_file_id]",e).val(),item_name:$("input[name=item_name]",$(".file-preview.in",i)).val(),code:$("input[name=code]",e).val(),is_only_in_story:$("input[name=is_only_in_story]",$(".file-preview.in",i)).prop("checked"),txt:me.pageStories.removeExtraLineBreak($("textarea[name=txt]",e).val())};$.post(t,n,function(t){if(App.ajaxError(t,function(e){jsLogger.showInternalError("j77001",e)}))return void 0!==t.message?popup.error(t.message):jsLogger.showInternalError("j77001",t),void o.lockOff().deleteLoaderLayout();1==t.subscription_changed&&me.loadBlock("subscription"),me.pageStories.saveDone(t.id,i,e).always(function(){slideShowActions.mediaFileObj=!1,o.lockOff().deleteLoaderLayout(),_IS_MOBILE_&&es.$modal.modal("hide");var e=Lang.FLASH_STORY_WAS_ADDED;meRouter.isCurrentRoute("lifestory")&&(e=Lang.FLASH_LIFESTORY_WAS_ADDED),me.cleanAboutPageCache(),popup.flash(e,"success"),$(".list-wrapper [data-oid="+t.id+"]").scrollAndHighlight()})},"JSON").fail(function(e){jsLogger.showAjaxFail("j77002",e),o.lockOff().deleteLoaderLayout()})}},saveDone:function(e,t,i,o){void 0===o&&(o=!0);var n=$.Deferred();return $.when($(".add-form .content",t).autosaveClear(),$(".add-form .title",t).autosaveClear()).done(function(){var e=1,t=i.data("storyUploader");t&&"function"==typeof t.removeMedia&&(e=t.removeMedia(1)),$.when(e).done(function(){me.loadBlock("pageContent",function(){me.loadBlock("activities"),n.resolve()},o)}).fail(function(e){jsLogger.showAjaxFail("j77003",e),n.reject()})}).fail(function(e){jsLogger.showAjaxFail("j77004",e),n.reject()}),n},stories_initMediaUploaderAbstract:function(e,t){var i=$(".uploader.story_media",e),o=$("input[type=file]",i);if(i.length&&o.length){var n=o.closest("form"),a=i.storyMediaUploader({signedIn:auth.isSignedIn(),$inputFile:o,dropZone:$("body"),serverUrl:t,limitUploadItems:n.data("remaining-files"),saveCallback:function(){me.runAction("#|content"),me.loadBlock("titlePhoto"),me.loadBlock("mobileInnerPageTitlePhoto"),me.loadBlock("slideshow"),me.loadBlock("pageContent"),me.loadBlock("activities"),$(me).trigger("checkGalleryMedia")},dropHoverCallback:function(){$("#uploader_anchor:visible").length&&i.lockTimeout(1e3,function(){me.scrollTop($("#uploader_anchor").offset().top-200)},"scroller")}});n.data("storyUploader",a),me.pageStories.fillForm(a,e)}},stories_loadEditBundle:function(e){e()},stories_loadTellStoryDialogBundle:function(e){e()},stories_openEditDialog:function(e){globalLoader.showGlobalLoader(),me.pageStories.stories_loadTellStoryDialogBundle(function(){me.vars.saveEditUrl="stories/save",auth.requireLogin(function(){me.pageStories.editMode=!0,me.pageStories.editStoryId=e,me.editStoryDialog.editStory(e)})})},stories_tellStory:function(e){var t=$.Deferred();return globalLoader.showGlobalLoader(),me.pageStories.stories_loadTellStoryDialogBundle(function(){auth.requireLogin(function(){me.editStoryDialog.tellStory(e).done(function(){t.resolve()})})}),t},openPreviousPopup:function(){_IS_MOBILE_&&(me.pageStories.editMode?me.pageStories.editStoryId>0?me.pageStories.stories_openEditDialog(me.pageStories.editStoryId):jsLogger.showInternalError("j77005",me.pageStories):me.pageStories.openAddFormMobile())},fillForm:function(e,t){var i;if(i=meRouter.isCurrentRoute("lifestory")?me.pageLifeStories:me.pageStories,_IS_MOBILE_&&1==i.media.success)$(".uploader-box",t).fadeOut(),e.setFile(i.media),e.showFile(),i.media={},$("input[name='title']",i.$editForm).val(i.title),$("[name='txt']",i.$editForm).val(i.text),$("input[name='is_only_in_story']",i.$editForm).prop("checked",i.is_only_in_story),i.is_only_in_story=!1,i.text="",i.title="";else{var o=$(".add-media-wrapper",t).data("media");o&&($(".uploader-box",t).hide(),e.setFile(o),e.showFile())}}},me.pageTributes={$addFormHTML:{},init:function(e){console.log("pageTributes - loaded"),this.redirectToAbout(),me.pageTributes.addTributeActions(),me.pageTributes.addTributeForm(),me.pageTributes.saveAddTributeMobile(),new readMore($("#page-tributes"),me.opts.tributeShortLength,me.opts.tributeShortLines,!1),contentPagination.init({scrollAfterPagination:"#content"}),this.afterInit(e)},reload:function(e){me.pageTributes.addTributeForm(),me.pageTributes.saveAddTributeMobile(),me.pageTributes.addTributeActions(),new readMore($("#page-tributes"),me.opts.tributeShortLength,me.opts.tributeShortLines,!1),contentPagination.init({scrollAfterPagination:"#content"}),this.afterReload(e)},afterInit:function(e){e&&e()},afterReload:function(e){e&&e()},redirectToAbout:function(){!_IS_MOBILE_&&"object"==typeof meRouter.getAllUrlParams()&&Number(meRouter.getAllUrlParams().entity_id)>0&&(globalLoader.showGlobalLoader(),page("/about?"+window.location.search.substr(1)))},addTributeActions:function(){var e=$("#page-tributes");_IS_MOBILE_&&me.circleButton.initialize("|add_tribute_mobile_dialog","fmi-pen",Lang.BUTTON_CIRCLE_TEXT_ADD_A_TRIBUTE),e.on("click",".tribute a.action.delete",function(){var e=$(this).closest(".tribute");return me.pageTributes.deleteTribute(e),!1}).on("click",".tribute a.action.edit",function(){var e=$(this).closest(".tribute");return meRouter.setHashAction($(this)),me.pageTributes.editTribute(e),!1}).on("click","#new_tribute_form",function(){if(!auth.isSignedIn())return auth.open(),!1}).on("click",".info a.action.edit",function(){$(this).parent().parent().toggleClass("active")}).on("click",".add-tribute-button-wrapper a",function(){var e=$(this).data("add-block-id");_IS_MOBILE_||$("html, body").animate({scrollTop:$($("#"+e).children()[0]).offset().top-80},300)}),$("body").on("click","#new_tribute_form ."+autoSave.classPainted,function(){$(this).removeClass(autoSave.classPainted)})},saveAddTributeMobile:function(){if(_IS_MOBILE_){var e=$("#new_tribute_form",me);e[0]&&(me.pageTributes.$addFormHTML=e[0].outerHTML,e.remove())}},addTributeMobile:function(){if(_IS_MOBILE_&&me.pageTributes.$addFormHTML){if(!auth.isSignedIn())return auth.open(),!1;$editForm=es.$modal=popup.extended({className:"dialog-new-tribute-mobile full-height",iconClass:"fmi-old-pen-writing",title:Lang.LEAVE_A_TRIBUTE_MOBILE_DIALOG_TITLE,message:me.pageTributes.$addFormHTML,onEscape:function(){es.$modal.modal("hide")},buttons:{leave:{label:Lang.LEAVE_A_TRIBUTE_MOBILE_DIALOG_BUTTON_LABEL,className:"button large-center-mobile",callback:function(){return meRouter.setIsForceBackToAboutPage(!1),me.cleanAboutPageCache(),$("form",$editForm).submit(),!1}}}}).on("shown.bs.modal",function(){me.pageTributes.addTributeForm(),me.pageTributes.addTributeActions()}).on("hide.bs.modal",function(){meRouter.checkForceBackToAboutPage()})}},addTributeForm:function(){var e=$("#new_tribute_form form");if(!e.length)return;const t=$("#new_tribute_form .selector").attr("name","type").autosave();e.on("click",".selector label",function(){var e=$(this);$("#new_tribute_form .preview").removeClass("tribute_img0 tribute_img1 tribute_img2").addClass("tribute_img"+e.find("input").val());var i="active";_IS_MOBILE_&&(i+=" active-label-mobile"),$(".active",e.parent()).removeClass(i),e.addClass(i),e.find("input").prop("checked",1),t.autoSaveDB(t.data("autosave"),$(":checked",t).val())});var i=$("#new_tribute_form textarea[name=txt]"),o=e.find(".draft-marker");if(i.data("error-callback",function(){o.html(Lang.DRAFT_ERROR).css("opacity",1).removeClass("ok").addClass("error")}),i.data("success-callback",function(){localStorage.getItem(i.data("autosave"))&&localStorage.getItem(i.data("autosave")).length&&o.html(Lang.DRAFT_SAVED).removeClass("error").addClass("ok").css("opacity",1)}),i.autosave().autosize(),!e.data("can-contribute"))return!1;me.addFormValidate(e),me.cleanAboutPageCache(),e.submit(function(){let t=$("button[type=submit]",e);t.prop("disabled",!0),i.val()==i.attr("placeholder")&&i.val("");let o=e.closest(".rounded-box");if(o.lockCheck())return!1;o.lockOn().addLoaderLayout();let n="candle";switch($(".active input[name='type']",e).val()){case 2:n="flower";break;case 1:n="note"}return eventTracking.run("tribute","content_additions",n),$.post(window.AppMemorial_config.baseUrl+"tributes/create-tribute",e.serialize(),function(e){let t=$("#new_tribute_form").data("msgSuccess");if(e.hasOwnProperty("error"))return jsLogger.showInternalError("j71001",e),e.error;me.pageTributes.tributeAdd(e),me.loadBlock("activities"),1===e.subscription_changed&&me.loadBlock("subscription"),_IS_MOBILE_&&es.$modal.modal("hide"),popup.flash(t,"success")},"JSON").fail(function(e){jsLogger.showAjaxFail("j71002",e)}).always(function(){o.lockOff().deleteLoaderLayout(),t.prop("disabled",!1)}),!1})},tributeAdd:function(e){$("#new_tribute_form textarea[name=txt]").autosaveClear().done(function(){me.cleanAboutPageCache(),me.loadBlock("pageContent",function(){$("#page-tributes .tribute[data-oid="+e.id+"]").scrollAndHighlight().removeSelection()},!0)})},deleteTribute:function(e){e.lockCheck()||(e.lockOn(),popup.confirm(Lang.YOU_ARE_ABOUT_TO_DELETE_CANDLE,function(){e.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"tributes/delete-tribute",{id:e.data("oid")},function(t){App.ajaxError(t)?jsLogger.showInternalError("j71008",t):(me.cleanAboutPageCache(),e.slideUp("slow",function(){e.detach(),popup.flash(Lang.TRIBUTE_WAS_DELETED,"success"),$(".list-wrapper .tribute").length||me.loadBlock("pageContent")}))},"JSON").fail(function(e){jsLogger.showAjaxFail("j71009",e)}).always(function(){e.deleteLoaderLayout()})},!1,function(){e.lockOff()}))},editTribute:function(e){e.lockCheck()||(e.lockOn(),globalLoader.showGlobalLoader(),$.post(window.AppMemorial_config.baseUrl+"tributes/edit-tribute",{id:e.data("oid")},function(t){if(!App.ajaxError(t)){var i={};me.cleanAboutPageCache(),_IS_MOBILE_?i=es.$modal=popup.extended({className:"dialog-edit-tribute full-height",iconClass:"fmi-pen-border",title:Lang.EDIT_TRIBUTE_MOBILE_TILE,message:t.page,onEscape:function(){meRouter.unSetCurrentHashAction(),$("textarea",e).autosaveClear(),es.$modal.modal("hide")},buttons:{save:{label:Lang.SAVE,className:"button save modal-header-button same-size-all",callback:function(){return $("form",i).submit(),!1}}}}).on("shown.bs.modal",function(e){$("textarea",$(this)).autosave()}):($(".txt, ul.actions",e).hide(),$(">div",e).append($(t.page)),i=$(".edit-form",e),$(".button.cancel",e).click(function(){meRouter.unSetCurrentHashAction(),$("textarea",e).wysiwyg("destroy"),$("textarea",e).autosaveClear(),$(".edit-form",e).detach(),$(".txt, ul.actions",e).show()})),me.addFormValidate(i),$("textarea",e).autosave(),i.submit(function(){return meRouter.unSetCurrentHashAction(),me.pageTributes.submitTributeForm(e,i),!1})}},"JSON").fail(function(e){jsLogger.showAjaxFail("j71010",e)}).always(function(){e.lockOff(),globalLoader.hideGlobalLoader()}))},submitTributeForm:function(e,t){globalLoader.showGlobalLoader(),t||(t=$(".edit-form",e)),$.post(window.AppMemorial_config.baseUrl+"tributes/save-tribute",{id:e.data("oid"),text:$("textarea",t).val(),save:1},function(i){App.ajaxError(i,function(e){if(e.error)return jsLogger.showInternalError("j71011",e),e.error})||($("textarea",t).autosaveClear(),$("textarea",e).autosaveClear(),$(".edit-form",e).detach(),es.$modal&&es.$modal.modal("hide"),$(".txt",e).html(i.text).show(),$("ul.actions",e).show(),popup.flash(Lang.EDIT_TRIBUTE_CHANGES_SAVED,"success"))},"JSON").fail(function(e){jsLogger.showAjaxFail("j71012",e)}).always(function(){$(".txt",e).lockOff("txt"),globalLoader.hideGlobalLoader()})}};var visitors=me.visitors=me.pageVisitors={$settingsRow:null,init:function(e){console.log("pageVisitors - loaded"),this.setEvents(),this.changeStarRole(),this.afterInit(e)},reload:function(e){setTimeout(function(){me.pageVisitors.setEvents()},500),this.afterReload(e)},afterInit:function(e){e&&e()},afterReload:function(e){e&&e()},changeStarRole:function(){$(".pointer-mouse, .role-label").on("mouseover",function(){$(".owner-star").addClass("open")}),$(".pointer-mouse, .role-label").on("mouseleave",function(){$(".owner-star").removeClass("open")})},setEvents:function(){var e=$("#pg"),t=function(){$(window).width()>=_MOBILE_?$(".visitors-table tr.settings td.settings-col",e).attr("colspan",5):$(".visitors-table tr.settings td.settings-col",e).attr("colspan",3)};t(),$(window).resize(function(){t()}),visitors.$settingsRow=$(".visitors-table tr.settings"),me.addFormValidate($("form.settings")),$(".visitors-table thead input[name=selectall]",e).click(function(){var e=$(this).prop("checked");$(".visitors-table td.check input[type=checkbox]").each(function(){$(this).prop("checked",e)})}),$("#page-visitors").off().on("click",".invites a",function(){return me.visitors_reload({filter_type:$(this).data("filter")}),!1}).on("click","tbody td.check .not-delivered",function(){return me.visitors_remove($(this).closest("tr")),!1}).on("click","tbody .open-settings-link",function(e){var t=$(this).closest("tr");return t.next()&&t.next().find(".wrapper.open").length?(me.visitors_hideSettings(),$(this).removeClass("fmi-arrow-up3").addClass("fmi-arrow-down3").parent().parent().css({display:"table-row"})):(me.visitors_showSettings(t),$("#page-visitors .open-settings-link.fmi-arrow-up3").removeClass("fmi-arrow-up3").addClass("fmi-arrow-down3"),$("#page-visitors tr").css({display:"table-row"}),$(this).removeClass("fmi-arrow-down3").addClass("fmi-arrow-up3").parent().parent().hide()),!1}).on("click","thead th a",function(){return me.visitors_reload({order:$(this).data("order"),order_dir:$(this).data("order-dir")}),!1}).on("click","tr.settings .button.save",function(){return me.visitors_saveSettings(),!1}).on("click","tr.settings .button.cancel",function(){return me.visitors_hideSettings(),!1}).on("click",".buttons .button.contact",function(){return me.visitors_contactSelected(),!1}).on("click",".buttons .button.resend",function(){var e=[];return $(".visitors-table td.check input[type=checkbox]").each(function(t,i){$(i).prop("checked")&&e.push($(i).closest("tr").data("oid"))}),me.visitors_resendInvitations(e),!1}).on("click",".footer .invite, .empty .invite",function(){return meRouter.setHashAction($(this)),invite.byType("default"),!1}).on("click","tr.settings .invitation-revoke a",function(){var e=$(this).closest("tr").data("oid");return me.canRevokeInvitation()?me.visitors_revokeInvitation(e,$(this).closest("tr")):me.changeSettingsDialog(function(){return me.visitors_revokeInvitation(e,$(this).closest("tr"))},null,["invited"]),!1}).on("click","tr.settings .delete-visitor a",function(){var e=$(this).closest("tr").data("oid");return me.visitors_revokeInvitation(e,$(this).closest("tr")),!1})}};me.visitors_reload=function(e){e||(e={}),void 0===e.order&&(e.order=$("#table-order").val()),void 0===e.order_dir&&(e.order_dir=$("#table-order-dir").val()),void 0===e.filter_type&&(e.filter_type=$("#page-visitors .filters .active [data-filter]").data("filter")),globalLoader.showGlobalLoader(),$.post(window.AppMemorial_config.baseUrl+"visitors",e,function(e){globalLoader.hideGlobalLoader();let t=$("#pg");t.hide().html(e).show(),t.show(400,function(){me.pageVisitors.setEvents()})})},me.visitors_saveSettings=function(){let e=$("form.settings",visitors.$settingsRow),t=window.AppMemorial_config.user.permission,i=function(){e.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"visitors/update",e.serialize()+"&oid="+visitors.$settingsRow.data("oid")+"&uperms="+t,function(e){App.ajaxError(e)?jsLogger.showInternalError("j78001",e):e.data.reloadIsNeeded?window.location.reload():me.visitors_reload()},"JSON").fail(function(e){jsLogger.showAjaxFail("j78002",e)}).always(function(){e.deleteLoaderLayout()})};"superadmin"==$("[name=perms]",e).val()?popup.confirm(Lang.YOU_ARE_NEAR_TRANSFERING.format($(".user-info .form-group.name .val",visitors.$settingsRow).html()),function(){i()}):i()},me.visitors_contactSelected=function(e){var t=[];void 0==e?$(".visitors-table td.check input[type=checkbox]").each(function(e,i){$(i).prop("checked")&&t.push($(i).closest("tr").data("oid"))}):t.push(e),t.length<1?popup.error(Lang.PLEASE_SELECT_ONE_GUEST):(globalLoader.showGlobalLoader(),me.contact.open(null,t),globalLoader.hideGlobalLoader())},me.visitors_showSettings=function(e){var t=$(".wrapper",visitors.$settingsRow);if($(".table tfoot").addClass("hidden"),t.find(".edit-buttons .cancel").click(),$(".close-settings-link",visitors.$settingsRow).off("click").click(function(){visitors.$settingsRow.prev().find(".open-settings-link").click()}),t.hasClass("open"))return t.removeClass("shown"),t.removeClass("open"),void me.visitors_showSettings(e);e.next()&&e.next().hasClass("settings")||visitors.$settingsRow.insertAfter(e),visitors.$settingsRow.show(0,function(){t.addClass("open").addClass("shown"),me.visitors_fillSettings(e)})},me.visitors_fillSettings=function(e){const t=visitors.$settingsRow,i=e.attr("data-role");if(t.data("oid",e.data("oid")),"superadmin"==i)$("#f_perms, #f_perms-guest").hide(),$(".current-user").text(Lang.VISITOR_LIST_OWNER);else if(e.attr("data-acct-id")==AppMemorial_config.uid&&"admin"==i)$("#f_perms, #f_perms-guest").hide(),$(".current-user").text(Lang.VISITOR_LIST_ADMIN);else if(e.hasClass("email-error")){const e={contribute:Lang.VISITOR_LIST_GUEST,admin:Lang.VISITOR_LIST_ADMIN,superadmin:Lang.VISITOR_LIST_OWNER};$("#f_perms, #f_perms-guest").hide(),$(".current-user").text(e[i])}else $("#f_perms, #f_perms-guest").show(),$(".current-user").text("");$("#f_perms",t).val(i),$("td.role",e).attr("data-role",i),$(".delivery-status",t).addClass("hidden"),e.hasClass("email-error")?($(".delivery-fail",t).removeClass("hidden"),t.addClass("email-error-settings")):t.removeClass("email-error-settings"),e.hasClass("invitation-pending")&&(e.hasClass("email-error")||$(".delivery-pending",t).removeClass("hidden"));var o=$(".user-info-edit, .info-separator",t);if(e.data("me")||"superadmin"==i)o.hide();else{o.show();var n=$(".user-info-edit .form-group.name",t);e.data("not-accepted")?n.show():n.hide();var a=$(".user-info-edit .invitation-revoke",t);"superadmin"!=i?a.show():a.hide()}var r=$(".user-info"),s={guest:"contribute",contribute:"contribute",block:"block",admin:"admin",view_only:"view_only",owner:"superadmin"};$.each(["name","email","last_visit","invitation_sent","invited_by","role"],function(i,o){if($("."+o+" div.val",r).html($("td."+o,e).html()),"invited_by"==o){var n="-",a=e.attr("data-inviter-name");a&&(n=a),$("."+o+" div.val",r).html(n)}if("role"==o){let t=$("td."+o,e).attr("data-role");$("#f_perms").val(s[t])}if("name"==o){var l=$(".name",t.prev());if($(".visitors-table .type-visitors").length>0)if(l.attr("data-fname")||l.attr("data-lname")){let e=Lang.ACRONYM_CONFIGURATIONS_ACCOUNT_FULL_NAME.replace("{account_first_name}",l.attr("data-fname")).replace("{account_last_name}",l.attr("data-lname"));$(".first-name .val",t).text(e),$("#f_name",t).val("")}else $(".first-name .val",t).text("-"),$("#f_name",t).val("");else{if(l.attr("data-fname")||l.attr("data-lname")){let e=Lang.ACRONYM_CONFIGURATIONS_ACCOUNT_FULL_NAME.replace("{account_first_name}",l.attr("data-fname")).replace("{account_last_name}",l.attr("data-lname"));$(".first-name .val",t).text(e),$("#f_name",t).val(e)}else $(".first-name .val",t).text("-"),$("#f_name",t).val("");l.attr("data-lname")?($(".last-name .val",t).text(l.attr("data-lname")),$("#l_name",t).val(l.attr("data-lname"))):($(".last-name .val",t).text("-"),$("#l_name",t).val(""))}}"email"==o&&($(".email",t).text()?$("#email",t).val($(".email div",t).html().trim()):$("#email",t).val(""),$(".email .val",t).text().trim().length>0?$(".email",t).show():$(".email",t).hide()),$(".visitors-table .type-visitors").length>0?"last_visit"==o&&$(".last_visit_data",t.prev()).text()&&$(".date-group .val",t).text($(".last_visit_data",t.prev()).text()):"invitation_sent"==o&&$(".invitation_sent",t.prev()).text()&&$(".date-group .val",t).text($(".invitation_sent",t.prev()).text())}),e.data("acct-id")?$(".input-val, .invitation-resend",t).hide():($(".input-val, .edit, .val, invitation-resend",t).show(),$(".save, .cancel, input",t).hide()),$(".edit",t).click(function(){var e=$(this).parents(".edit-block-wrapper");_IS_MOBILE_&&(e.prev().prev().hide(),$(".input-wrapper",e).removeClass("col-xs-6").addClass("col-xs-9"),$(".input-val.edit-buttons",e).removeClass("col-xs-2").addClass("col-xs-3")),$(this).hide(),$(".save, .cancel, input, .input-wrapper",e).show(),e.prev().hide()}),$(".cancel",t).off().on("click",function(){var e=$(this).parents(".edit-block-wrapper"),t=e.prev().text().trim();_IS_MOBILE_&&(e.prev().prev().show(),$(".input-wrapper",e).removeClass("col-xs-9").addClass("col-xs-6"),$(".input-val.edit-buttons",e).removeClass("col-xs-3").addClass("col-xs-2")),$("input",e).val(t),$(".save, .cancel, input, .input-wrapper",e).hide(),$(".edit",e).show(),e.prev().show()}),$(".save",t).off().on("click",function(){me.saveInputData(this);var e=$(this).parents(".edit-block-wrapper");_IS_MOBILE_&&(e.prev().prev().show(),$(".input-wrapper",e).removeClass("col-xs-9").addClass("col-xs-6"),$(".input-val.edit-buttons",e).removeClass("col-xs-3").addClass("col-xs-2"))}),$("#f_perms",t).change(function(){var e=$("tr.settings").prev().find(".name .full-name").text(),o=this,n=Lang.GUEST_ACCESS.replace("{1}",e),a=Lang.GUEST_ACCESS_BUTTON;"admin"==$(this).val()?(n=Lang.ADMIN_ACCESS.replace("{1}",e),a=Lang.ADMIN_ACCESS_BUTTON):"superadmin"==$(this).val()?(n=Lang.OWNER_ACCESS.replace("{1}",e),a=Lang.OWNER_ACCESS_BUTTON):"block"==$(this).val()&&(n=Lang.BLOCK_ACCESS.replace("{1}",e),a=Lang.BLOCK_ACCESS_BUTTON),popup.confirm(n,function(){me.saveInputData(o)},function(){$("#f_perms",t).val(i)},!1,!1,{cancel:Lang.CANCEL,ok:a})}),$(".invitation-resend a",t).off().click(function(){var t=[];t.push(e.data("oid")),me.visitors_resendInvitations(t)}),$(".send-msg a",t).off().click(function(){me.visitors_contactSelected(e.data("oid"))}),$(".hint--top",r).removeClass("hint--top").addClass("hint--bottom"),$(".visitors-table table").hasClass("type-pending")?($("tr.settings .user-info-edit .send-msg").css("display","none"),$("tr.settings .user-info-edit .invitation-resend").show()):($("tr.settings .user-info-edit .invitation-resend").hide(),$("tr.settings .user-info-edit .send-msg").css("display","inline-block"))},me.saveInputData=function(e){if(!1===$("form.settings").isValid())return!1;let t=$(e).parents(".edit-block-wrapper"),i=$("form.settings",visitors.$settingsRow),o=$("input",t).val(),n=i.serialize(),a=window.AppMemorial_config.user.permission;$("#email",t).length&&$("#email",t).val().length<5?popup.error(Lang.FORMVALIDATOR_BAD_EMAIL):(i.addLoaderLayout(),$.post(window.AppMemorial_config.baseUrl+"visitors/update",n+"&oid="+visitors.$settingsRow.data("oid")+"&uperms="+a,function(e){if(App.ajaxError(e))return void(void 0!==e.message?popup.error(e.message):jsLogger.showErrorResponse("j78003",e));if(e.data.reloadIsNeeded)return popup.success(Lang.CHANGES_SAVED),void window.location.reload();let n=t.prev();$(".save, .cancel, input, .input-wrapper",t).hide(),n.text(o).show(),$(".edit",t).show(),n.show(),me.updateVisitorTab(i,e),popup.success(Lang.CHANGES_SAVED),$(".visitors-table .table").hasClass("type-pending")&&popup.confirm(Lang.DO_YOU_WANT_RESEND_INVITE,function(){$(".invitation-resend a",i).click()},!1,!1,!1,{cancel:Lang.CANCEL,ok:Lang.OK})},"JSON").fail(function(e){jsLogger.showAjaxFail("j78004",e)}).always(function(){i.deleteLoaderLayout()}))},me.updateVisitorTab=function(e,t){var i={},o=e.parents("tr.settings").prev();$("input, select",e).each(function(t,o){var n=$(o),a=n.val().trim();"perms"==n.attr("name")&&(i.roleName=$("option[value="+a+"]",e).text()),i[n.attr("name")]=a});var n="";t.data&&(t.data.fnme&&(n=t.data.fnme,i.fnme=t.data.fnme),t.data.lnme&&(n=t.data.lnme,i.lnme=t.data.lnme),t.data.fnme&&t.data.lnme&&(n=t.data.fnme+" "+t.data.lnme)),o.hasClass("email-error")&&t.data.emailChanged&&(o.removeClass("email-error"),visitors.$settingsRow.removeClass("email-error-settings")),o.attr("data-role",i.perms);let a={admin:"admin",superadmin:"owner"},r=i.roleName;"undefined"!=i.perms&&"contribute"!=i.perms&&(r='<strong class="'+a[i.perms]+'">'+i.roleName+"</strong>"),$(".role, .role-mobile",o).html(r),$(".name",o).attr("data-fname",i.fnme).attr("data-lname",i.lnme),$(".name .full-name em",o).length>0?$(".name .full-name em",o).text(n):$(".name .full-name",o).html("<em>"+n+"</em>");var s=$(".email",o).text();i.email?$(".email, .name .email-mobile",o).text(i.email):$(".email, .name .email-mobile",o).text(s)},me.visitors_hideSettings=function(){var e=$(".wrapper",visitors.$settingsRow);e.find(".edit-buttons .cancel").click(),$(".table tfoot").removeClass("hidden"),e.removeClass("shown"),setTimeout(function(){typeof $.support.transition.end!==ud?e.removeClass("open").one($.support.transition.end,function(){visitors.$settingsRow.hide()}).emulateTransitionEnd(0):(e.removeClass("open"),visitors.$settingsRow.hide())},1)},me.visitors_remove=function(e){popup.confirm(Lang.DELETE_SELECTED_GUEST,function(){var t=e.data("oid"),i=e.find("td.check"),o=e.find("td.check input");o.hide(),i.addLoaderLayout();var n=function(){o.show(),i.deleteLoaderLayout()};$.post(window.AppMemorial_config.baseUrl+"visitors/delete",{id:t,order:$("#table-order").val(),order_dir:$("#table-order-dir").val(),filter_type:$("#page-visitors .filters .active [data-filter]").data("filter")},function(t){if(App.ajaxError(t))return jsLogger.showInternalError("j78005",t),void n();e.fadeOut(function(){e.detach()})},"JSON").fail(function(e){jsLogger.showAjaxFail("j78006",e),n()})})},me.visitors_resendInvitations=function(e){if(0==e.length)return popup.error(Lang.PLEASE_SELECT_VISITOR),!1;var t={users:e};$.post(window.AppMemorial_config.baseUrl+"visitors/resendInvitation",t,function(t){globalLoader.hideGlobalLoader(),App.ajaxError(t)?jsLogger.showInternalError("j78009",t):popup.extended({className:"dialog-invite-email extra-wide-dialog full-height",title:Lang.RESEND_INVITATIONS,iconClass:"fmi-add-your",message:t.html,buttons:{save:{label:Lang.SEND_INVITATIONS,className:"button send-button large-center-mobile",callback:function(){var t,i;t=$("#invite_message").val(),i=$("body"),globalLoader.showGlobalLoader(),$.post(window.AppMemorial_config.baseUrl+"invite/resend",{users:e,message:t},"json").done(function(e){App.ajaxError(e)?jsLogger.showInternalError("j78007",e):e.sentCount>1?popup.success(Lang.MULTIPLE_INVITATIONS_SEND.format(e.sentCount)):1==e.sentCount&&popup.success(Lang.INVITATION_HAS_BEEN_SENT)}).fail(function(e){jsLogger.showAjaxFail("j78008",e)}).always(function(){i.lockOff("invite-email"),globalLoader.hideGlobalLoader()}),i.lockCheck("invite-email")||i.lockOn("invite-email")}}}}).on("shown.bs.modal",function(){}).on("hide.bs.modal",function(){})},"json").fail(function(e){jsLogger.showAjaxFail("j78009",e)})},me.visitors_revokeInvitation=function(e,t){var i=$("#pg"),o="";o=$(".type-visitors",i).length?$("tr.settings").prev().find(".full-name").text():$("tr.settings").prev().find(".email").text();var n=Lang.BLOCK_ACCESS.replace("{1}",o),a=Lang.BLOCK_ACCESS_BUTTON;"public"==AppMemorial_config.privacy&&(n=Lang.REMOVE_USER.replace("{1}",o),a=Lang.REMOVE_USER_BUTTON),popup.confirm(n,function(){globalLoader.showGlobalLoader(),$.post(window.AppMemorial_config.baseUrl+"invite/revoke-invitation",{oid:e,order:$("#table-order").val(),order_dir:$("#table-order-dir").val(),filter_type:$("#page-visitors .filters .active [data-filter]").data("filter")},"json").done(function(i){App.ajaxError(i)||(popup.success(Lang.INVITATION_REVOKED_TEXT),t.fadeOut(function(){me.visitors_hideSettings(),$("[data-oid="+e+"]").detach()}))}).fail(function(e){jsLogger.showAjaxFail("j78010",e)}).always(function(){globalLoader.hideGlobalLoader()})},!1,!1,!1,{cancel:Lang.CANCEL,ok:a})};