# See the 'MyDefrag.log' file for information intended for endusers. This is the debug
# logfile. The contents is highly technical and not documented. See the 'Debug' setting
# or the '-d' commandline option to control the level of information in this file.
#
Version: MyDefrag v4.3.1 for X64
Date: 2021/11/17 21:08:30
Windows version: v6.2 build 9200 
Commandline: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily\DefragDevDiskDaily.MyD" 
Working Directory: G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily
Userid: david
InstallPath = C:\Program Files\MyDefrag v4.3.1\
21:08:30 Lexical error in script 'G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily\DefragDevDiskDaily.MyD' at line 30802 column 1.

Unkown symbol.
21:09:40 Script:
  1. # MyDefrag v4.0 script: Development Volume Daily defrag
  2. #
  3. # This script is part of the standard Mdm Volume configuration
  4. # Author: David G. Horsman (DBA MacroDM) (C) 2019
  5. # based on MyDefrag distribution.
  6. 
  7. /* Development Volume Daily*/
  8. SetVariable(RunDescription,"Dev Vol Daily")
  9. SetVariable(RunStepDescription,"Dev Vol Daily")
 10. # Script: DisplaySetRun
 11. 
 12. SetVariable(RunStepDescription,			"!RunStepDescription! - DefragDevDiskDaily")
 13. SetVariable(SeverStepDescription,		"")
 14. SetVariable(VolumeStepDescription,		"")
 15. SetVariable(ZoneStepDescription,		"")
 16. SetVariable(FileStepDescription,		"")
 17. 
 18. SetVariable(VolumeStatisticsDetail, 	"")
 19. 
 20. SetVariable(ZoneListByLine, 			"Run start.")
 21. SetVariable(ZoneStepByLine, 			"")
 22. 
 23. # Script: BannerSet
 24. 
 25. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
 26. 
 27. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
 28. 
 29. Title('!Heading!')
 30. /* pause(1) */
 31. 
 32. /* NOTE: Can't round or truncate to integer precision. */
 33. 
 34. pause(2)
 35. 
 36. # This script is part of the standard  disk configuration
 37. # Author: David G. Horsman (DBA MacroDM) (C) 2019
 38. # based on MyDefrag distribution.
 39. 
 40. # Script: DisplaySetDateTimeRun
 41. 
 42. SetVariable(RunStartDate,				"2021-11-17")
 43. SetVariable(RunStartTime,				"21:08:27")
 44. SetVariable(RunStartDate,				"2021-11-17")
 45. SetVariable(RunDateTime,		"!RunStartDate! !RunStartTime! 0:00:02")
 46. /* Xinclude "..\Display\BannerSet.MyDc"X */
 47. /* pause(1) */
 48. SetVariable(RunId,		"C:\MyDefragLogs\!RunDescription! !RunDateTime!")
 49. SetVariable(Heading,	"Initializing...")
 50. WriteLogfile("!RunId!", "!ZoneStatsData!")
 51. 
 52. ProcessPriority(Normal)
 53. /* ProcessPriority(Normal) */
 54. 
 55. 
 56. ExitIfTimeout(300) // 5 minutes (for old systems), default 120.
 57. /* ExitIfTimeout(300) // 5 minutes (for old systems), default 120. */
 58. 
 59. 
 60. 
 61. WindowSize(minimized) 
 62. DiskmapFlip(no)
 63. 
 64. # Script: DisplayColors
 65. # MyDefrag color palette.
 66. 
 67. # RGB Color pallets. (Red,Green,Blue).
 68. 
 69. # Basics:
 70. 
 71. # Red			255,	0,		0)			// Red
 72. # Green			0,		255,	0)			// Green
 73. # Blue			0,		0,		255)		// Blue
 74. # Shades:
 75. 
 76. /* (White was left unused for the administrator to highlight things.) */
 77. # White 		255,	255,	255)		// White
 78. # Black			0,		0,		0)			// Black
 79. # Grey 			240,	240,	240)		// Grey
 80. 
 81. # Bright colors and shades:
 82. 
 83. # Purple 		170,	89,		221)		// Purple
 84. # Magenta		255, 	5, 		255)		// Magenta (pinkish)
 85. 
 86. # Pure Yellow 	255,	255,	0)			// Pure yellow
 87. # Yellow 		229, 	229, 	0)			// Yellow
 88. # Light Yellow 	255,	255,	224)		// Light Yellow
 89. # Neon Yellow	237,	240,	11)			// Neon Yellow	
 90. 
 91. # Pure Red 		255, 	0, 		0)			// Red
 92. # Red 			204, 	92, 	92)			// Red
 93. # Light red		255,	115,	115)		// Light red
 94. # Orange		255, 	165, 	0)			// Orange
 95. 
 96. # Pure Green	0, 		255, 	0)			// Pure Green (Lime)
 97. # Green			0,		128,	0)			// Green
 98. # Light Green	144,	228, 	144)		// Light Green
 99. # Pale Green	152, 	251, 	152)		// Pale Green
100. 
101. # Dark blue		20,		87,		229)		// Dark blue
102. # Light Blue	175,	198,	247)		// Light Blue
103. # Bright Blue	0, 		223, 	255)		// Bright Blue
104. # Light sky blue 135, 	206, 	250)		// Light sky blue
105. # Deep sky blue	0, 		191, 	255)		// Deep sky blue
106. 
107. # Black			0,		0,		0)
108. # Grey			240,	240,	240)
109. 
110. # Window Colors
111. SetColor(Empty,										240,  	240, 	240)	// Grey
112. # ???
113. SetColor(Allocated,									45, 	72, 	128)	// Black
114. 
115. # Busy Colours
116. SetColor(BusyRead,									255,	54,		154)	// Neon
117. SetColor(BusyWrite,									212, 	0, 		106)	// Red Pinkish
118. 
119. #File Colors
120. SetFileColor(All,									0,		0,		0)		// Black
121. SetFileColor(Movable,								20,		87,		229)	// Dark blue
122. 
123. # Processed
124. SetFileColor(Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
125. SetFileColor(Processed and Fragmented,				170,	89,		221)	// Purple
126. 
127. # Fragmented and NotMovable
128. SetFileColor(Fragmented,							229, 	229, 	0)		// Yellow
129. SetFileColor(not(Movable),							255, 	165, 	0)		// Orange
130. 
131. # Light Green and Yellow
132. SetFileColor(Selected,								152,	251, 	152)	// Light Green
133. SetFileColor(Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
134. SetFileColor(Selected and not(Movable),				255,	115,	115)	// Light red
135. 
136. /* empty */
137. 
138. 
139. 
140. # Processes:
141. 	# This Process
142. 	SetVariable(RunProcessID,ProcessID)
143. 
144. 	# Kill other instances
145. 	/* Kill other MyDefrag Instances. */
146. 	/* Oops! This commits suicide. */
147. 	/* 	RunProgram("..\pskill.exe", "-t MyDefrag.exe") */
148. 	/* Pause(10) */
149. 	
150. 	/* If another instance of MyDefrag is already running then exit. */
151. 	/* Oops again. I don't know if this cause the hidden instance */
152. 	/* to hang around after the run. */
153. 	/* Warning: <alt><Run><Exit> seems to hide the instance not end it. */
154. 	/* The task mananager may be needed. This is under investigation. */
155. 
156. 	# OtherInstances
157. 	
158. OtherInstances(exit)
159. 
160. # OtherInstances
161. 	
162. # OtherInstances(exit)
163. 
164. 
165. 
166. 	# StatusBar
167. 
168. 	/* Debug:
169. 	1 Fatal error messages. 
170. 	2 Warning messages. 
171. 	4 Basic information messages. 
172. 	8 Scripting information messages. 
173. 	16 Scripting high-detail information messages. 
174. 	32 Volume analysis information messages. 
175. 	64 Volume analysis high-detail information messages. 
176. 	128 Moving items information messages. 
177. 	256 Moving items high-detail information messages. 
178. 	*/
179. 	Debug(16)
180. 	
181. 	StatusBar(Status Path MouseOver)
182. 	# Script: DisplayStatusBar
183. # OtherInstances
184. 	
185. # OtherInstances(exit)
186. 
187. 	
188. 	# Power management
189. 	/* SetScreenPowerSaver(off) */
190. 	# Power management
191. 
192. 	/* SetScreenPowerSaver(off) */
193. 
194. 	# Power management
195. 
196. 	/* SetScreenPowerSaver(off) */
197. 
198. 
199. 
200. 
201. /* ---------------------------------------------------------- */
202. # Script Directory Location:
203. SetVariable(ScriptDir,"..\")
204. 
205. /* SetVariable(ScriptDir,"..\") */
206. /* SetVariable(ScriptDir,"G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily") */
207. /* SetVariable(ScriptDir,"E:\Ide\MyDefrag\MyDefrag\MdmScriptMyDefragVs4_3_1\") */
208. 
209. 
210. 
211. /* ---------------------------------------------------------- */
212. # DISPLAY - What text is displayed in Titlebar, data fields and reports.
213. 
214. 
215. /* The variable FileStepDescription get set to */
216. /* the messages below according to the Zone File */
217. /* step the defrag is on. */
218. 
219. /* The titlebar is organized in these areas: */
220. 
221. /* SwProductVs. */
222. /* Volume description. */
223. /* Zone description. */
224. /* File Processing Step (here.) */
225. /* Server and Script names. */
226. /* Run Date, Time and Elapsed (Bug) */
227. 
228. /* Shown in the Title / Banner / App Heading */
229. 
230. SetVariable(SeverStepDescription,	"")
231. SetVariable(VolumeStepDescription,	"")
232. SetVariable(ZoneStepDescription,	"")
233. SetVariable(FileStepDescription,	"")
234. SetVariable(RunStepDescription,		"")
235. 
236. # Display fields you can set for your personal tastes / needs:
237. 
238. /* ---------------------------------------------------------- */
239. # ZONE. Process One Zone (the steps and messages displayed. */
240. 
241. SetVariable(FileStepDescriptionZoneStart, 			"Zone started.")
242. 
243. /* "Your Zone Pre (before)Processing." */
244. SetVariable(FileStepDescriptionYourZonePre, 		"!FileStepDescriptionZoneStart!") 		
245. 
246. SetVariable(FileStepDescriptionFileSelect,			"Selecting Files.")
247. 
248. /* "Your Pre Sort File Actions." */
249. SetVariable(FileStepDescriptionYourFileActionsPre, 	"!FileStepDescriptionFileSelect!")
250. 
251. SetVariable(FileStepDescriptionFileActionStart, 	"File Actions started.")
252. 
253. /* "Your Post Sort File Actions." */
254. SetVariable(FileStepDescriptionYourFileActionsPost, "!FileStepDescriptionFileActionStart!")
255. 
256. SetVariable(FileStepDescriptionFileActionEnd, 		"File Actions completed.")
257. 
258. /* "Your Zone Post (after) Processing." */
259. SetVariable(FileStepDescriptionYourZonePost, 		"!FileStepDescriptionFileActionEnd!") 		
260. 
261. SetVariable(FileStepDescriptionFileActionGap, 		"Calculating Gap.")
262. 
263. SetVariable(FileStepDescriptionZoneEnd, 			"Zone finished.")
264. 
265. /* Pattern: SetVariable(FileStepDescriptionXXX, 	"FileStepDescriptionXXX") */
266. 
267. /* Note: If you add custom script code in the PRE and POST areas then at that */
268. /* time you fill in the messages above as appropriate. */
269. 
270. /* empty */
271. 
272. /* ---------------------------------------------------------- */
273. # Regarding Volume Names/Labels
274. 
275. /* FYI. The Volume names / drive letters need to be correct for your system. */
276. /* It is repeated here for infomation about fields used above. */
277. /* Set your values in "SettingsYours\SettingsYoursVolumeNames.MyDc" */
278. 
279. 	/* SetVariable(VolumeSys,"!VolumeNamePrefix!Sys") */
280. 	/* SetVariable(VolumeDev,"!VolumeNamePrefix!Dev") */
281. 	/* SetVariable(VolumeData,"!VolumeNamePrefix!Data") */
282. 	/* SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive") */
283. 
284. 	/*		or just */
285. 			
286. 	/* SetVariable(VolumeSys,"C:") */
287. 	/* SetVariable(VolumeDev,"E:") */
288. 
289. /* ---------------------------------------------------------- */
290. 
291. # BANNER DEFINITION
292. /* SetVariable(Heading, "Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! || !FileStepDescription! ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskDaily on 2021-11-17 21:08:27 0:00:02") */
293. 
294. # How to build them: (documentation)
295. 
296. /* Here is how is one pattern not used: */
297. /* SetVariable(Heading, "|") */
298. /* SetVariable(Heading, "!Heading! Vol: !VolumeStepDescription!") */
299. /* SetVariable(Heading, "!Heading! Zone: !ZoneStepDescription!") */
300. /* SetVariable(Heading, "!Heading! !FileStepDescription!") */
301. /* SetVariable(Heading, "!Heading!  ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskDaily") */
302. /* SetVariable(Heading, " on 2021-11-17 21:08:27 0:00:02") */
303. /* SetVariable(Heading, "!Heading!|") // spacers. */
304. 
305. /* A typical banner field list: */
306. # Appearing in Title('Vol: !
307. # VolumeCurrent
308. # ! Zone: !
309. # ZoneCurrentDescription
310. # ! !
311. # ZoneCurrent
312. # ! of !
313. # ZoneCount
314. # ! || Free: Vol: !
315. # VolumeFreePerUsed
316. # !% Zone: !
317. # ZoneFreePerUsed
318. # !% || Script: !
319. # ScriptTitle
320. # ! System: !
321. # VolumeNamePrefix
322. # ! !
323. # ServerNameFull
324. # ! !
325. # Date
326. # ! !
327. # Time
328. # ! !
329. # RunTime
330. # !')
331. /* . */
332. 
333. 
334. /* Progress Display */
335. SetVariable(ZoneListByLine, 	"Volume start.")
336. SetVariable(ZoneStepByLine, 	"")
337. 
338. /* There is 6 digit decimal precision so by using */
339. /* 1Mb the full number is displayed in a much more */
340. /* readable form. */
341. 
342. SetVariable(DisplayUnitDivisor, 	1000000) // 1MB.
343. 
344. /* ---------------------------------------------------------- */
345. # SERVER INFORMATION
346. 
347. 	/* ServerName (IE. Computer name or number.) not used. */
348. 	/* System99 */
349. 		# SetVariable(ServerName,"Pc15")
350. 
351. 		# Server Names
352. 
353. # ???
354. 
355. # IMPORTANT: ServerName NAME: 
356. 
357. 	# SetVariable(ServerName,"PcAny")
358. 
359. # IMPORTANT: ServerName NAME: 
360. 
361. 	# SetVariable(ServerName,"PcAny")
362.     /* System99 */
363. # SET
364. SetVariable(ServerName,"RavenPc")
365. 
366. 
367. 	
368. 	/* Descriptive Information so maybe */
369. 	/* VolumeNamePrefix (IE. Person or company initials) not used. */
370. 	/* "Xyz" */
371. 		# SetVariable(VolumeNamePrefix,"Mdm")
372. 
373. 		# VolumeNamePrefix
374. 
375. /* Descriptive Information so maybe */
376. /* VolumeNamePrefix (IE. Person or company initials) not used. */
377. /* "Xyz" */
378. 	SetVariable(VolumeNamePrefix,"VolThis")
379. 
380. 	
381. /* Descriptive Information so maybe */
382. /* VolumeNamePrefix (IE. Person or company initials) not used. */
383. /* "Xyz" */
384. 	SetVariable(VolumeNamePrefix,"Vol")
385. 
386. /* Server name full is usually the server and computer combined. not used. */
387. 	SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
388. 
389. 
390. 	/* Server name full is usually the server and computer combined. not used. */
391. 
392. 		SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
393. 	
394. 	# Script: DisplaySetServer
395. # RunStepDescription
396. # (Volume)
397. SetVariable(SeverStepDescription, 	"!ServerNameFull!")
398. SetVariable(VolumeStepDescription, 	"")
399. SetVariable(ZoneStepDescription, 	"")
400. SetVariable(FileStepDescription, 	"")
401. # Script: BannerSet
402. 
403. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
404. 
405. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
406. 
407. Title('!Heading!')
408. /* pause(1) */
409. 
410. /* NOTE: Can't round or truncate to integer precision. */
411. 
412. /* pause(2) */
413. 
414. /* ---------------------------------------------------------- */
415. # VOLUMES
416. /* ---------------------------------------------------------- */
417. 
418. 	# Volume Do Current Clear
419. 
420. /* ---------------------------------------------------------- */
421. # Current Values.
422. 	SetVariable(VolumeLabel, "NotSet")
423. 	SetVariable(VolumeDescription, "")
424. 
425. 	SetVariable(VolumeCount, 0)
426. 	SetVariable(VolumeNoCurrent, 0)
427. 	SetVariable(VolumeNoAdjCurrent, 0)
428.   	SetVariable(VolumeCurrentAjust, 0) // not used
429. 
430. /* ---------------------------------------------------------- */
431. # OS Disk Usage.
432. 
433. /* Percentage of disk used by OS */
434. 
435. 	SetVariable(OsPer, 0.18)
436. 
437. 	     SetVariable(ZoneCountOs, 5)
438. 
439.        SetVariable(ZoneCountType, 0) // not used
440.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
441. 
442. 	    SetVariable(ZoneCountSys, 2)
443. 	    SetVariable(ZoneCountDev, 7)
444. 
445. 	   SetVariable(ZoneCountData, 0)
446. 	SetVariable(ZoneCountArchive, 0)
447. 	
448. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
449. 
450. /* ---------------------------------------------------------- */
451. # Volume Totals
452. 	# USED:
453. 	/* Current total volume space used */
454. 	SetVariable(VolumeZoneUsed, 			0)
455. 	/* percentage */
456. 	SetVariable(VolumeZoneUsedPer, 			0)
457. 
458. 	# FREE:
459. 	/* Current total of free space used */
460. 	SetVariable(VolumeFreeRequested, 		0)
461. 	/* percentage */
462. 	SetVariable(VolumeFreeRequestedPer, 	0)
463. 
464. 	/* Current total of free space used */
465. 	SetVariable(VolumeFreeUsed, 			0)
466. 	/* percentage */
467. 	SetVariable(VolumeFreeUsedPer, 			0)
468. 	
469. /* ---------------------------------------------------------- */
470. # Volume Free Space Proportional Used Space vs Volume Size.
471. 	/* We only want to use a ratio of the free space relative to the volume. */
472. 	/* We could just use percentages of the total free space as well. */
473. 
474. 	/* SetVariable(VolumeFreeAdj, 		1) */
475. 	
476. 	SetVariable(VolumeFreeAdj,				(VolumeFree * (VolumeUsed / VolumeSize)))
477. 
478. /* ---------------------------------------------------------- */
479. # ZONES
480. 
481. 	SetVariable(ZoneNoCurrent, 0)
482. 	SetVariable(ZoneNoAdjCurrent, 0)
483. 	SetVariable(ZoneCurrentAjust, 0)
484. 
485. 	# Script: ZoneDoCurrentClear
486. 
487. SetVariable(ZoneTypeSelectCurrent, 		"")
488. 
489. SetVariable(ZoneBeginCurrent, 			0)
490. SetVariable(ZoneBeginPerCurrent, 		0)
491. SetVariable(ZoneEndCurrent, 			0)
492. SetVariable(ZoneEndPerCurrent, 			0)
493. 
494. SetVariable(ZoneSizeCurrent,			0)
495. SetVariable(ZoneSizePerCurrent,			0)
496. 
497. SetVariable(ZoneGapRequestedCurrent,	0)
498. SetVariable(ZoneGapRoundedCurrent, 		0)
499. SetVariable(ZoneGapAdjustedCurrent, 	0)
500. SetVariable(ZoneGapAvailableCurrent, 	0)
501. SetVariable(ZoneGapCurrent,				0)
502. SetVariable(ZoneGapUsedCurrent, 		0)
503. 
504. SetVariable(ZoneGapActualCurrent, 		0)
505. SetVariable(ZoneGapActualPerCurrent, 	0)
506. 
507. SetVariable(ZoneSizeActual, 			0)
508. SetVariable(ZoneSizeActualCurrent,		0)
509. 
510. SetVariable(ZoneEndActual, 				0)
511. SetVariable(ZoneEndActualCurrent,		0)			
512. SetVariable(ZoneSizeActualPerCurrent, 	0)
513.       
514. SetVariable(ZoneFilesFolders,			0)
515. SetVariable(ZoneFilesFoldersPer,		0) 
516. 
517. SetVariable(ZoneFragments,				0)
518. SetVariable(ZoneFragmentsPer,			0) 
519. 		
520. SetVariable(ZoneEndActualCurrent, 		0)
521. SetVariable(ZoneEndActualPerCurrent, 	0)
522. 
523. # Gap Calculation Methodology:
524. 	# Requested
525. 	SetVariable(GapRequested, 			0) 
526. 	SetVariable(GapRequestedStd, 		0) 
527. 	SetVariable(GapRequestedMft, 		0) 
528. 	SetVariable(GapRequestedOs, 		0) 
529. 	SetVariable(GapRequestedOriginal, 	0) 
530. 	
531. 	# Gap Adjustments
532. 	SetVariable(GapRounded, 			0)
533. 	# SetVariable(GapAdjusted, 			0)
534. 	SetVariable(GapAvailable, 			0)
535. 	SetVariable(GapCurrent, 			0)
536. 	SetVariable(GapActual, 				0)
537. 	SetVariable(GapUsed, 				0)
538. 	
539. 	# Gap Adjustments
540. 	SetVariable(GapRoundedLoc, 			0)
541. 	# SetVariable(GapAdjustedLoc, 		0)
542. 	SetVariable(GapAvailableLoc, 		0)
543. 	SetVariable(GapCurrentLoc, 			0)
544. 	SetVariable(GapActualLoc,			0)
545. 	SetVariable(GapUsedLoc,				0)
546. 	
547. 	# Space usage
548. 	SetVariable(ZoneFreePerRequested, 	0)
549. 	SetVariable(ZoneFreePerUsed, 		0)
550. 
551. # Gap Size & Rounding
552. 	SetVariable(ZoneGapSizePer, 		0)
553. 	SetVariable(ZoneVolRoundUpPer, 		0)
554. 	
555. 	# Free Space
556. 	SetVariable(ZoneFreeUsedPer, 		0)
557. 	SetVariable(ZoneFreeRequestedPer, 	0)
558. 
559. 
560. 	SetVariable(ZoneLabel, "Volume")
561. 	SetVariable(ZoneDescription, "Analysis...")
562. 	# Script: BannerSet
563. 
564. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
565. 
566. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
567. 
568. Title('!Heading!')
569. /* pause(1) */
570. 
571. /* NOTE: Can't round or truncate to integer precision. */
572. 
573. 
574. 	
575. 	  
576. 	SetVariable(VolumeLabel, "NotSet")
577. 	SetVariable(VolumeDescription, "")
578. 
579. 	SetVariable(FileStepDescription,"Initializing run...")
580. 	# Script: BannerSet
581. 
582. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
583. 
584. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
585. 
586. Title('!Heading!')
587. /* pause(1) */
588. 
589. /* NOTE: Can't round or truncate to integer precision. */
590. 
591. 
592. /* ---------------------------------------------------------- */
593. # VOLUME TYPES
594. 
595. 	/* Volumes */
596. 	/* . */
597. 	/* Only those were fully implemented: */
598. 	/* Sys */
599. 	/* Dev */
600. 	/* . */
601. 	/* Common types of volumes: */
602. 	/* Data */
603. 	/* Archive */
604. 	/* . */
605. 	/* Other historical volumes: */
606. 	/* Test */
607. 	/* Live */
608. 	/* Server */
609. 	/* Client */
610. 	/* SysUtils */
611. 	/* . */
612. 
613. # IMPORTANT: VOLUME NAME: SET YOUR:
614. 	/* VOLUME NAMES IN SettingsYours\SettingsYoursVolumeNames.MyDc */
615. 	/* 		or    			*/
616. 	/* VOLUME NAME (one only for override) in SettingsYours\SettingsYoursVolume.MyDc */
617. 	/* 		or here also 	*/
618. 	SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
619. 	SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
620. 
621. 	/* SetVariable(VolumeSys,"C:") */
622. 	/* SetVariable(VolumeDev,"E:") */
623. 
624. 	/* These are for dedicated disks. */
625. 	/* So it means JUST Data or JUST Archives. */
626. 
627. 	SetVariable(VolumeData,"!VolumeNamePrefix!Data")
628. 	SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
629. 	
630. 	# IMPORTANT: VOLUME NAME: 
631. 
632. 	# SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
633. 	# SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
634. 	# SetVariable(VolumeData,"!VolumeNamePrefix!Data")
635. 	# SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
636. 
637. 	#    or this:
638. 	
639. 	
640. 	SetVariable(VolumeSys,"C:")
641. 	SetVariable(VolumeDev,"C:")
642. 	SetVariable(VolumeData,"C:")
643. 	SetVariable(VolumeArchive,"C:")
644. 
645. 
646. # SET
647. # SetVariable(VolumeSys,"C:")
648. 
649. 
650. 
651. /* ---------------------------------------------------------- */
652. # OS Disk Usage.
653. /* Percentage of disk used by OS */
654. 
655. 	SetVariable(OsPer, 0.18)
656. 
657. 	     SetVariable(ZoneCountOs, 5)
658. 
659.        SetVariable(ZoneCountType, 0) // not used
660.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
661. 
662. 	    SetVariable(ZoneCountSys, 2)
663. 	    SetVariable(ZoneCountDev, 7)
664. 
665. 	   SetVariable(ZoneCountData, 0)
666. 	SetVariable(ZoneCountArchive, 0)
667. 	
668. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
669. 
670. /* ---------------------------------------------------------- */
671. # ZONE TYPES. 
672. /* ---------------------------------------------------------- */
673. 	/* Type Labels, Descriptions, Gaps and Rounding. */
674. 	/* Load the Zone Definitions */
675. 	/* These are file categories basically */
676. 	/* and are maintained in a single file */
677. 	/* for ease of maintenance. Here: */
678. 	
679. 	/* ---------------------------------------------------------- */
680. # ROUNDING factors:
681. 
682. /* HERE if you want to tweak how type the Gaps are if growth is slow. */
683. /* HERE if your DISK IS VERY FULL */
684. /* This is where you can tweak growth rounding if the Volume gets really full. */
685. /* You don't have to use these, you can use actual percentages in the Zone section. */
686. 
687. /* Note: Volume and Gap Sizes are paired to a degree and */
688. /* set relative to each other. */
689. 	
690. 	      SetVariable(VolumeRoundUpNone, 	1) // ??? 1? s/b 0?
691. 	      SetVariable(VolumeRoundUpTiny, 	0.005)
692. 	     SetVariable(VolumeRoundUpSmall, 	0.01)
693. 	    SetVariable(VolumeRoundUpMedium, 	0.02)
694. 	     SetVariable(VolumeRoundUpLarge, 	0.03)
695. 	SetVariable(VolumeRoundUpExtraLarge, 	0.05)
696. 	
697. 	    SetVariable(VolumeRoundUpBlogBu, 	0.10)
698. 	
699. 	      SetVariable(ZoneGapSizeNone, 		0)
700. 	      SetVariable(ZoneGapSizeTiny, 		0.005)
701. 	     SetVariable(ZoneGapSizeSmall, 		0.01)
702. 	    SetVariable(ZoneGapSizeMedium, 		0.05)
703. 	     SetVariable(ZoneGapSizeLarge, 		0.10)
704. 	SetVariable(ZoneGapSizeExtraLarge, 		0.15)
705. 		
706. 	    SetVariable(ZoneGapSizeBlobBu, 		0.10)
707. 
708. /* ---------------------------------------------------------- */
709. # ZONE SETTINGS:
710. /* ---------------------------------------------------------- */
711. /* These are the Zone Names */
712. /* Regular is at the end but otherwise */
713. /* this is in the order they appear on disk */
714. 
715. # Os Programs.
716. SetVariable(ZoneLabelBoot, 					"Boot")
717. SetVariable(ZoneLabelBootData, 				"BootData")
718. SetVariable(ZoneLabelProgramHints,			"ProgramHints")
719. SetVariable(ZoneLabelProgramHintsData,		"ProgramHintsData")
720. SetVariable(ZoneLabelPrograms,				"Programs")
721. SetVariable(ZoneLabelProgramsWindows,		"ProgramsWindows")
722. SetVariable(ZoneLabelProgramsData,			"ProgramsData")
723. # Moved to after Mft & Dir.
724. SetVariable(ZoneLabelPageHiperDump,			"PageHiperDump")
725. 
726. # Os Mft & Directories.
727. SetVariable(ZoneLabelMft,					"MFT")
728. SetVariable(ZoneLabelDir,					"DIR")
729. 
730. # Standard Zones.
731. SetVariable(ZoneLabelIdeScripts, 			"IdeScripts")
732. SetVariable(ZoneLabelDevToDo, 				"DevToDo")
733. SetVariable(ZoneLabelLinksCorp, 			"LinksCorp")
734. SetVariable(ZoneLabelPeople, 				"People")
735. # MFT.
736. # DIR.
737. # Games. 
738. SetVariable(ZoneLabelGames, 				"Games")
739. SetVariable(ZoneLabelShares, 				"Shares")
740. SetVariable(ZoneLabelSystemOtherData, 		"SystemOtherData")
741. SetVariable(ZoneLabelReference, 			"Reference")
742. 
743. 
744. # Sys.
745. # People.
746. # OS, Mft, Dir.
747. # Games.
748. SetVariable(ZoneLabelRegular, 				"Regular")
749. 
750. # Common.
751. SetVariable(ZoneLabelSpaceHogs, 			"SpaceHogs")
752. SetVariable(ZoneLabelArchivesBu, 			"ArchivesBu")
753. 
754. /* ---------------------------------------------------------- */
755. /* Use however you like */
756. 
757. # Os Programs.
758. SetVariable(ZoneDescriptionBoot, 				"!ZoneLabelBoot!")
759. SetVariable(ZoneDescriptionBootData, 			"!ZoneLabelBootData!")
760. SetVariable(ZoneDescriptionProgramHints, 		"!ZoneLabelProgramHints!")
761. SetVariable(ZoneDescriptionProgramHintsData, 	"!ZoneLabelProgramHintsData!")
762. SetVariable(ZoneDescriptionPrograms, 			"!ZoneLabelPrograms!")
763. SetVariable(ZoneDescriptionProgramsWindows, 	"!ZoneLabelProgramsWidows!")
764. SetVariable(ZoneDescriptionProgramsData, 		"!ZoneLabelProgramsData!")
765. SetVariable(ZoneDescriptionPageHiperDump, 		"!ZoneLabelPageHiperDump!")
766. 
767. # Os Mft & Directories.
768. SetVariable(ZoneDescriptionMft, 				"!ZoneLabelMft!")
769. SetVariable(ZoneDescriptionDir, 				"!ZoneLabelDir!")
770. 
771. # Standard Zones:
772. SetVariable(ZoneDescriptionIdeScripts, 			"!ZoneLabelIdeScripts!")
773. SetVariable(ZoneDescriptionDevToDo, 			"!ZoneLabelDevToDo!")
774. SetVariable(ZoneDescriptionLinksCorp, 			"!ZoneLabelLinksCorp!")
775. SetVariable(ZoneDescriptionPeople, 				"!ZoneLabelPeople!")
776. # MFT.
777. # DIR.
778. # Games. 
779. SetVariable(ZoneDescriptionGames, 				"!ZoneLabelGames!")
780. SetVariable(ZoneDescriptionShares, 				"!ZoneLabelShares!")
781. SetVariable(ZoneDescriptionSystemOtherData, 	"!ZoneLabelSystemOtherData!")
782. SetVariable(ZoneDescriptionReference, 			"!ZoneLabelReference!")
783. 
784. # Sys.
785. # People.
786. # OS, Mft, Dir.
787. SetVariable(ZoneDescriptionRegular, 			"!ZoneLabelRegular!")
788. 
789. SetVariable(ZoneDescriptionSpaceHogs, 			"!ZoneLabelSpaceHogs!")
790. SetVariable(ZoneDescriptionArchivesBu, 			"!ZoneLabelArchivesBu!")
791. 
792. /* ---------------------------------------------------------- */
793. /* This rounds up to even locations on the volume to keep */
794. /* the location of data relatively stable during fluctuation. */
795. 
796. /* NOTE: For Volume specifice settings you would have to copy these */
797. /* next two sections and use them in the SettingsYours\SettingsYours for each Volume. */
798. /* You would need a copy of these two to use in a Reset function between Volumes. */
799. 
800. # Os Programs.
801. SetVariable(ZoneVolRoundUpBoot, 			"!VolumeRoundUpSmall!")
802. SetVariable(ZoneVolRoundUpProgramHints, 	"!VolumeRoundUpSmall!")
803. SetVariable(ZoneVolRoundUpPrograms, 		"!VolumeRoundUpMedium!")
804. SetVariable(ZoneVolRoundUpPageHiperDump,	"!VolumeRoundUpSmall!")
805. 
806. # Os Mft & Directories.
807. SetVariable(ZoneVolRoundUpMft,				"!VolumeRoundUpTiny!")
808. SetVariable(ZoneVolRoundUpDir,		 		"!VolumeRoundUpLarge!")
809. 
810. # Standard Zones.
811. SetVariable(ZoneVolRoundUpIdeScripts, 		"!VolumeRoundUpSmall!")
812. SetVariable(ZoneVolRoundUpDevToDo, 			"!VolumeRoundUpSmall!")
813. SetVariable(ZoneVolRoundUpLinksCorp, 		"!VolumeRoundUpSmall!")
814. SetVariable(ZoneVolRoundUpPeople, 			"!VolumeRoundUpMedium!")
815. # MFT.
816. # DIR.
817. # Games. 
818. # ToDo.............
819. SetVariable(ZoneVolRoundUpGames, 			"!VolumeRoundUpSmall!")
820. SetVariable(ZoneVolRoundUpShares, 			"!VolumeRoundUpSmall!")
821. SetVariable(ZoneVolRoundUpSystemOtherData, 	"!VolumeRoundUpSmall!")
822. SetVariable(ZoneVolRoundUpReference, 		"!VolumeRoundUpMedium!")
823. 
824. # Sys.
825. # People.
826. # OS, Mft, Dir.
827. # Games.
828. SetVariable(ZoneVolRoundUpRegular, 			"!VolumeRoundUpMedium!")
829. 
830. # Common.
831. SetVariable(ZoneVolRoundUpSpaceHogs, 		"!VolumeRoundUpMedium!")
832. SetVariable(ZoneVolRoundUpArchivesBu, 		"!VolumeRoundUpTiny!")
833. 
834. /* ---------------------------------------------------------- */
835. /* Your Zone Gap consumption of free space as a percentage. */
836. /* Clearly this can not exceed 100%. Keep it under 99%. */
837. 
838. # Os Programs.
839. SetVariable(ZoneGapSizeBoot, 				"!ZoneGapSizeTiny!")
840. SetVariable(ZoneGapSizeProgramHints,	 	"!ZoneGapSizeTiny!")
841. SetVariable(ZoneGapSizePrograms, 			"!ZoneGapSizeSmall!")
842. SetVariable(ZoneGapSizePageHiperDump, 		"!ZoneGapSizeSmall!")
843. 
844. # Mft & Directories.
845. SetVariable(ZoneGapSizeMft, 				"!ZoneGapSizeTiny!")
846. SetVariable(ZoneGapSizeDir,		 			"!ZoneGapSizeTiny!")
847. 
848. # Standard Zones.
849. SetVariable(ZoneGapSizeIdeScripts, 			"!ZoneGapSizeMedium!")
850. SetVariable(ZoneGapSizeDevToDo, 			"!ZoneGapSizeMedium!")
851. SetVariable(ZoneGapSizeLinksCorp, 			"!ZoneGapSizeMedium!")
852. SetVariable(ZoneGapSizePeople, 				"!ZoneGapSizeMedium!")
853. # MFT.
854. # DIR.
855. # Games. 
856. # ToDo.............
857. SetVariable(ZoneGapSizeGames, 				"!ZoneGapSizeMedium!")
858. SetVariable(ZoneGapSizeShares, 				"!ZoneGapSizeMedium!")
859. SetVariable(ZoneGapSizeSystemOtherData, 	"!ZoneGapSizeMedium!")
860. SetVariable(ZoneGapSizeReference, 			"!ZoneGapSizeSmall!")
861. 
862. # Sys.
863. # People.
864. # OS, Mft, Dir.
865. # Games.
866. SetVariable(ZoneGapSizeRegular, 			"!ZoneGapSizeMedium!")
867. 
868. # Common.
869. SetVariable(ZoneGapSizeSpaceHogs, 			"!ZoneGapSizeMedium!")
870. SetVariable(ZoneGapSizeArchivesBu, 			"!ZoneGapSizeTiny!")
871. 
872. /* ---------------------------------------------------------- */
873. # ZONE CALCULATION METHODS:
874. # OS ZONE SETTINGS:
875. /* ---------------------------------------------------------- */
876. 
877. 	/* ---------------------------------------------------------- */
878. 	# VOLUME MFT Location.
879. 	/* The Volume Location of the MFT as a percentage of the Volume. */
880. 		
881. 		SetVariable(MftVolumeRoundUp, 		"!VolumeRoundUpLarge!")
882. 		SetVariable(MftVolumeGapSize, 		"!ZoneGapSizeTiny!")
883. 		
884. 		# MFT CALCULATION METHODS.
885. 			# STANDARD Method.
886. 			/* IMPORTANT: Standard method currently in use. */
887. 			/* IE: The others below are ignored but instructive. */
888. 			/* None of the following settings are used, hence zero. */
889. 			SetVariable(MftPer, 			0)
890. 			SetVariable(MftLocation, 		0)
891. 			
892. 			# MFT Method.
893. 			/* Place files at X% (MftPerSys) into the data on the Volume. */
894. 			/* This is really tied the ratio of executables to data and blobs. */
895. 			# SetVariable(MftPer, 				0.30)
896. 			# SetVariable(MftLocation, 			1000000000)
897. 			# SetVariable(MftGapSize, 			"!ZoneGapSizeLarge!")
898. 		
899. 			# FIXED Method.
900. 			# SetVariable(MftLocation, 			1000000000) // (IE. Yours)
901. 			# SetVariable(MftPer, 				MftLocation / VolumeSize)
902. 			
903. 			# ORIGINAL Method.
904. 			/* DEPRECIATED, not in use. */
905. 			/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
906. 			# SetVariable(MftPer, 				0.30)
907. 		    # SetVariable(MftSize, 				0)
908. 		
909. 		# ROUNDING.	
910. 		# SetVariable(MftLocation,				RoundUp(MftLocation, VolumeSize * MftVolumeRoundUp))
911. 		
912. 		# MFT ZONE.
913. 		/* Zone Number (not used for locating MFT.) */
914. 		SetVariable(MftZone, 					4) // Insert before this zone, info only.
915. 		/* Zone 10 on the Dev Volume */
916. 	
917. 	/* ---------------------------------------------------------- */
918. 	# VOLUME SPECIFIC MFT.
919. 	/* Note: You may need to set Volume specific values for the MFT location, */
920. 	/* On these volume types do not "push" the data above the MFT table? */
921. 	/* You can use a standard gap instead. */
922. 		
923. 			/* The current Volume Type Mft Percentage */
924. 		    # SetVariable(MftPer, 				0)
925. 		    # SetVariable(MftSize, 				0)
926. 		    # SetVariable(MftSizeDefault,		"                0)
927. 		    # SetVariable(MftPerTypedDefault, 	"!MftPer!")
928. 			# Volume Types:	
929. 			#         SetVariable(MftPerSys, 	0.35)
930. 			# 	    SetVariable(MftPerDev, 		0.10)
931. 			# 	   SetVariable(MftPerData, 		0.35)
932. 			# 	SetVariable(MftPerArchive, 		0.10)
933. 	
934. 	/* ---------------------------------------------------------- */
935. 	# VOLUME DIR Location.
936. 	/* The amount of Gap between Mft and Dir's, the Location of DIR. */
937. 	
938. 		/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
939. 	
940. 		SetVariable(DirVolumeRoundUp, 			"!VolumeRoundUpLarge!")
941. 		SetVariable(DirVolumeGapSize, 			"!ZoneGapSizeLarge!")
942. 		
943. /* ---------------------------------------------------------- */
944. # SETTINGS YOURS
945. /* empty */
946. 
947. /* ---------------------------------------------------------- */
948. 
949. /* ---------------------------------------------------------- */
950. # STATISTICS
951. /* ---------------------------------------------------------- */
952. 
953. /* Xinclude "..\StatisticsInitialization.MyDc"X ToDo */
954. 
955. 
956. /* ---------------------------------------------------------- */
957. # GAPS
958. 	# TEST (FAILED!!!) NO BOOLEAN LOGIC AVAILABLE.
959. 	SetVariable(FlagDoNotVacate, 0)
960.  
961. /* ---------------------------------------------------------- */
962. # ZONE
963. 	SetVariable(ZoneNoCurrent, 		0)
964. 	SetVariable(ZoneNoAdjCurrent, 	0) 
965. 	SetVariable(ZoneCurrentAjust,	0)
966. 
967. 	SetVariable(ZoneListByLine, 		"Volume started.
968. ")
969. 	SetVariable(ZoneStepByLine, 		"Initialize.
970. ")
971. 	SetVariable(ZoneStatisticsDetail, 	"")
972. 
973. /* ---------------------------------------------------------- */
974. # ZONE FILE STEP (ACTIONS)
975. 	/* Nothing to set here */
976. 
977. /* ---------------------------------------------------------- */
978. # BLOB SIZE
979. 
980. 	# Size 10MB
981. 	SetVariable(BlobFileSize, 10000000)
982. 
983. /* ---------------------------------------------------------- */
984. # SKIP BLOCK
985.  
986. /* (important for run efficiency.) */
987. /* FILES: */
988. /* Day Files: 100 */
989. /* Monthly: 500 */
990. /* Yearly: 1M */
991. 
992. 	/* 100 Files - moved most blocks */
993. 	 /* 10 Files - 20211105 (error - not done) */ 
994. 	 /* 10 Files - (20211106) - Current */
995. 	 /* 5 Files - (2021????) - */
996. 	SetVariable(SkipBlockFilesDay, 10)
997. 
998. 	SetVariable(SkipBlockFilesMonth, 500)
999. 	SetVariable(SkipBlockFilesYear, 1000000)
1000. 
1001. 	/* Current: */
1002. 	SetVariable(SkipBlockFiles,"!SkipBlockFilesMonth!")
1003. 
1004. /* BYTES: */
1005. /* Day Bytes: 50MB */
1006. /* Month Bytes: 500MB */
1007. /* Year Bytes: 5GB */
1008. 
1009. 	 /* 50 MB Moved most existing blocks */
1010. 	 /* 5 MB 20211105 (not done) */ 
1011. 	 /* 1 MB 20211105 - Current */
1012. 	SetVariable(SkipBlockBytesDay, 1000000)
1013. 	/* SetVariable(SkipBlockBytesDay, 50000000) */
1014. 
1015. 	SetVariable(SkipBlockBytesMonth, 500000000)
1016. 	SetVariable(SkipBlockBytesYear, 5000000000)
1017. 
1018. 	/* Current: */
1019. 	SetVariable(SkipBlockBytes,"!SkipBlockBytesMonth!")
1020. 
1021. /* ---------------------------------------------------------- */
1022. # ZONE LOCATION METHODS:
1023. 
1024. # No 1) Standard. You can ignore this section
1025. 	/* Gaps between zones are a percentage of */
1026. 	/* free space auto adjusted to pack the used */
1027. 	/* space closely together and for performance. */
1028. 	
1029. 	/* The calculation will clear the Gap */
1030. 	/* and RoundUp to the fixed value present */
1031. 	
1032. 	SetVariable(ZoneMethodStd, 1)
1033. 
1034. /* The following are NOT FULLY IMPLEMENTED OR TESTED */
1035. # No 2) Mft. Relative to its location.
1036. 	SetVariable(ZoneMethodMft, (0-1))
1037. 
1038. # No 3) Os. Percentages are AFTER OsMftDir Space Used.
1039. 	SetVariable(ZoneMethodOs, (0-1))
1040. 
1041. # No 4) Orginal Mft/Os 1-5.
1042. 	SetVariable(ZoneMethodOrginal, (0-1))
1043. 
1044. # No 5) FIXED ZONES if you used them.
1045. 	
1046. 	SetVariable(ZoneMethodFixed, (0-1))
1047. 	SetVariable(ZoneMethodFixedPer, (0-1))
1048. 
1049. 	/* Not recommended */
1050. 	/* However doing all calcs is informative regarding what */
1051. 	/* Types of Volume data (Zones) exist. */
1052. 	
1053. 	/* Your FIXED calculation method, this can be: */
1054. 	SetVariable(ZoneMethodFixedVariantPer, (0-1))
1055. 	
1056. 	/* 1) Percentage. */
1057. 		/* So when it is 1 or On. */
1058. 		/* Not great but easy to use. */
1059. 		 
1060. 	/* 2) Fixed volume location. */
1061. 		/* When 0 or Off it is a volume location. */
1062. 		/* You will have to change: */
1063. 		/* file item xxxxxxxxx??? */
1064. 	
1065. 	/* FIXED VALUES: */
1066. 		/* SetVariable(ZoneMethodFixed, 1) */
1067. 	
1068. 		# Setting the following to a percentage or number:
1069. 		/* OS */
1070. 	    SetVariable(ZoneOsBoot, 0) // 1
1071. 	    SetVariable(ZoneOsProgramHints, 0) // 2
1072. 	    SetVariable(ZoneOsPrograms, 0) // 3
1073. 	    
1074. 	    /* MFT */
1075. 	    SetVariable(ZoneMft, 0) // Volume dependent
1076. 	    SetVariable(ZoneMftDir, 0) // Volume dependent
1077. 	
1078. 		/* Volume Sys */
1079. 	    # Os 3
1080. 	    # Mft + 2
1081. 	    SetVariable(ZoneSysRegular, 0) // 5
1082. 	    SetVariable(ZoneDevSpaceHog, 0) // 6
1083. 	
1084. 		/* Volume Dev */
1085. 	    # Os 3
1086. 	    SetVariable(ZoneDevDevToDo, 0) // 4
1087. 	    SetVariable(ZoneDevIdeScripts, 0) // 5
1088. 	    SetVariable(ZoneDevLinksCorp, 0) // 6
1089. 	    SetVariable(ZoneDevPeople, 0) // 7
1090. 	    # Mft + 2
1091. 	    SetVariable(ZoneDevShares, 0) // 10
1092. 	    SetVariable(ZoneDevSystemOtherData, 0) // 11
1093. 	    SetVariable(ZoneDevReference, 0) // 12
1094. 	    SetVariable(ZoneDevSpaceHogsArchives, 0) // 13
1095. 	
1096. 		/* Volume Archive not used currently */
1097. 		/* Volume Data not used currently */
1098. 
1099. /* ---------------------------------------------------------- */
1100. # LOGGING:
1101. /* ---------------------------------------------------------- */
1102. 
1103. 	# Log File Name:
1104. 	SetVariable(LogFileName,"Defrag !VolumeStepDescription! 2021-11-17_21:08:27")
1105. 	SetVariable(LogFileZoneName,"Defrag !VolumeStepDescription! !ZoneStepDescription! 2021-11-17_21:08:27")
1106. 	
1107. 	#SetVariable(LogFileName,"C:\MyDefragLogs\Defrag !VolumeStepDescription! 2021-11-17_21:08:27")
1108. 	#SetVariable(LogFileZoneName,"C:\MyDefragLogs\Defrag !VolumeStepDescription! !ZoneStepDescription! 2021-11-17_21:08:27")
1109. 	/* SetVariable(LogFileName,"..\Logs\!MdmMyDefrag! 2021-11-17_21:08:27.log") */
1110. 	/* SetVariable(LogFileName,"!ScriptDir!Logs\!MdmMyDefrag! 2021-11-17_21:08:27.log") */
1111. 	/* SetVariable(LogFileName,"Defrag2021-11-17_21:08:27.txt") */
1112. 	/* SetVariable(LogFileName,"$ z Logs\Defrag2021-11-17_21:08:27.txt") */
1113. 	
1114. 	SetVariable(VolumeStatisticsSummary, "Not ready")
1115. 	SetVariable(VolumeStatisticsDetailed, "Not ready")
1116. 
1117. /* ---------------------------------------------------------- */
1118. # OVERRIDES
1119. /* ---------------------------------------------------------- */
1120. 
1121. 	# YOUR SETTINGS Volume overrides:
1122. 	/* empty */
1123. 
1124. 
1125. /* ---------------------------------------------------------- */
1126. # Create Run Log:
1127. 
1128. /* Write the header to the logfile. */
1129. 	# Script: BannerSet
1130. 
1131. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
1132. 
1133. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
1134. 
1135. Title('!Heading!')
1136. /* pause(1) */
1137. 
1138. /* NOTE: Can't round or truncate to integer precision. */
1139. 
1140. 
1141. 	WriteLogfile("!LogFileName!", "Log File: !LogFileName! Started.")
1142. 	# Script: BannerLog
1143. 
1144. AppendLogfile("!LogFileName!", "!Title!")
1145. 
1146. 
1147. 	AppendLogfile("!LogFileName!", ".")
1148. 
1149. /* ---------------------------------------------------------- */
1150. /* Script Information */
1151. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-11-17 21:08:27")
1152. 	AppendLogfile("!LogFileName!", ".")
1153. 	AppendLogfile("!LogFileName!", "Script:")
1154. 	AppendLogfile("!LogFileName!", "DefragDevDiskDaily")
1155. 	AppendLogfile("!LogFileName!", ".")
1156. 	AppendLogfile("!LogFileName!", "Script Directory:")
1157. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1158. 	AppendLogfile("!LogFileName!", ".")
1159. 	AppendLogfile("!LogFileName!", "Log File:")
1160. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1161. 	AppendLogfile("!LogFileName!", ".")
1162. 
1163. /* ---------------------------------------------------------- */
1164. # Run Preprocessing Do Before.
1165. /* empty */
1166. 
1167. 
1168. 
1169. /* SkipBlock Daily: */
1170. SetVariable(SkipBlockFiles,"!SkipBlockFilesDay!")
1171. SetVariable(SkipBlockBytes,"!SkipBlockBytesDay!")
1172. 
1173. # Defrag Development Volume
1174. 
1175. SetVariable(VolumeLabel,"!VolumeDev!")
1176. SetVariable(VolumeDescription,"Development")
1177. # Script: DisplaySetVolume
1178. 
1179. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1180. SetVariable(ZoneStepDescription,	"")
1181. SetVariable(FileStepDescription,	"")
1182. 
1183. SetVariable(ZoneListByLine, 		"Volume started 2021-11-17 21:08:27 0:00:02:
1184. ")
1185. SetVariable(ZoneStepByLine, 		"Pending.")
1186. 
1187. # Script: BannerDescriptionSet
1188. 
1189. # Script: BannerSet
1190. 
1191. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
1192. 
1193. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
1194. 
1195. Title('!Heading!')
1196. /* pause(1) */
1197. 
1198. /* NOTE: Can't round or truncate to integer precision. */
1199. 
1200. # Script: BannerLog
1201. 
1202. AppendLogfile("!LogFileName!", "!Title!")
1203. 
1204. 
1205. 
1206. pause(2)
1207. 
1208. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1209. 
1210. SetVariable(ZoneListByLine, "")
1211. SetVariable(ZoneFooter, "")
1212. 
1213. # This script is part of the standard disk configuration
1214. # Author: David G. Horsman (DBA MacroDM) (C) 2019
1215. # based on MyDefrag distribution.
1216. 
1217. /* Progress Display */
1218. SetVariable(ZoneListByLine, 	"Volume start.
1219. ")
1220. SetVariable(ZoneStepByLine, 	"
1221. ")
1222. 
1223. # VOLUME INFORMATION
1224. 
1225. SetVariable(VolumeNoCurrent, VolumeNoCurrent + 1)
1226. SetVariable(VolumeNoAdjCurrent, VolumeNoCurrent + VolumeCurrentAjust)
1227. 
1228. SetVariable(ZoneNoCurrent, 		0)
1229. SetVariable(ZoneNoAdjCurrent, 	0) 
1230. SetVariable(ZoneCurrentAjust,	0)
1231. 
1232. SetVariable(ZoneListByLine, 		"Volume started.
1233. ")
1234. SetVariable(ZoneStepByLine, 		"Initialize.
1235. ")
1236. SetVariable(ZoneStatisticsDetail, 	"")
1237. 
1238. SetVariable(ZoneStepNoCurrent, 0)
1239. 
1240. 
1241. # Script: ZoneDoCurrentClear
1242. 
1243. SetVariable(ZoneTypeSelectCurrent, 		"")
1244. 
1245. SetVariable(ZoneBeginCurrent, 			0)
1246. SetVariable(ZoneBeginPerCurrent, 		0)
1247. SetVariable(ZoneEndCurrent, 			0)
1248. SetVariable(ZoneEndPerCurrent, 			0)
1249. 
1250. SetVariable(ZoneSizeCurrent,			0)
1251. SetVariable(ZoneSizePerCurrent,			0)
1252. 
1253. SetVariable(ZoneGapRequestedCurrent,	0)
1254. SetVariable(ZoneGapRoundedCurrent, 		0)
1255. SetVariable(ZoneGapAdjustedCurrent, 	0)
1256. SetVariable(ZoneGapAvailableCurrent, 	0)
1257. SetVariable(ZoneGapCurrent,				0)
1258. SetVariable(ZoneGapUsedCurrent, 		0)
1259. 
1260. SetVariable(ZoneGapActualCurrent, 		0)
1261. SetVariable(ZoneGapActualPerCurrent, 	0)
1262. 
1263. SetVariable(ZoneSizeActual, 			0)
1264. SetVariable(ZoneSizeActualCurrent,		0)
1265. 
1266. SetVariable(ZoneEndActual, 				0)
1267. SetVariable(ZoneEndActualCurrent,		0)			
1268. SetVariable(ZoneSizeActualPerCurrent, 	0)
1269.       
1270. SetVariable(ZoneFilesFolders,			0)
1271. SetVariable(ZoneFilesFoldersPer,		0) 
1272. 
1273. SetVariable(ZoneFragments,				0)
1274. SetVariable(ZoneFragmentsPer,			0) 
1275. 		
1276. SetVariable(ZoneEndActualCurrent, 		0)
1277. SetVariable(ZoneEndActualPerCurrent, 	0)
1278. 
1279. # Gap Calculation Methodology:
1280. 	# Requested
1281. 	SetVariable(GapRequested, 			0) 
1282. 	SetVariable(GapRequestedStd, 		0) 
1283. 	SetVariable(GapRequestedMft, 		0) 
1284. 	SetVariable(GapRequestedOs, 		0) 
1285. 	SetVariable(GapRequestedOriginal, 	0) 
1286. 	
1287. 	# Gap Adjustments
1288. 	SetVariable(GapRounded, 			0)
1289. 	# SetVariable(GapAdjusted, 			0)
1290. 	SetVariable(GapAvailable, 			0)
1291. 	SetVariable(GapCurrent, 			0)
1292. 	SetVariable(GapActual, 				0)
1293. 	SetVariable(GapUsed, 				0)
1294. 	
1295. 	# Gap Adjustments
1296. 	SetVariable(GapRoundedLoc, 			0)
1297. 	# SetVariable(GapAdjustedLoc, 		0)
1298. 	SetVariable(GapAvailableLoc, 		0)
1299. 	SetVariable(GapCurrentLoc, 			0)
1300. 	SetVariable(GapActualLoc,			0)
1301. 	SetVariable(GapUsedLoc,				0)
1302. 	
1303. 	# Space usage
1304. 	SetVariable(ZoneFreePerRequested, 	0)
1305. 	SetVariable(ZoneFreePerUsed, 		0)
1306. 
1307. # Gap Size & Rounding
1308. 	SetVariable(ZoneGapSizePer, 		0)
1309. 	SetVariable(ZoneVolRoundUpPer, 		0)
1310. 	
1311. 	# Free Space
1312. 	SetVariable(ZoneFreeUsedPer, 		0)
1313. 	SetVariable(ZoneFreeRequestedPer, 	0)
1314. 
1315. 
1316. # Script: BannerSet
1317. 
1318. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
1319. 
1320. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
1321. 
1322. Title('!Heading!')
1323. /* pause(1) */
1324. 
1325. /* NOTE: Can't round or truncate to integer precision. */
1326. 
1327. 
1328. # OVERRIDES
1329. # YOUR SETTINGS Volume overrides:
1330. 
1331. 
1332. # SET
1333. # SetVariable(VolumeSys,"C:")
1334. 
1335. 
1336. # Script: DisplaySetVolume
1337. 
1338. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1339. SetVariable(ZoneStepDescription,	"")
1340. SetVariable(FileStepDescription,	"")
1341. 
1342. SetVariable(ZoneListByLine, 		"Volume started 2021-11-17 21:08:27 0:00:02:
1343. ")
1344. SetVariable(ZoneStepByLine, 		"Pending.")
1345. 
1346. # Script: BannerDescriptionSet
1347. 
1348. # Script: BannerSet
1349. 
1350. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
1351. 
1352. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
1353. 
1354. Title('!Heading!')
1355. /* pause(1) */
1356. 
1357. /* NOTE: Can't round or truncate to integer precision. */
1358. 
1359. # Script: BannerLog
1360. 
1361. AppendLogfile("!LogFileName!", "!Title!")
1362. 
1363. 
1364. 
1365. pause(2)
1366. 
1367. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1368. 
1369. # LOGGING:
1370. 	# Script: BannerDescriptionSet
1371. 
1372. # Script: BannerSet
1373. 
1374. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
1375. 
1376. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
1377. 
1378. Title('!Heading!')
1379. /* pause(1) */
1380. 
1381. /* NOTE: Can't round or truncate to integer precision. */
1382. 
1383. # Script: BannerLog
1384. 
1385. AppendLogfile("!LogFileName!", "!Title!")
1386. 
1387. 
1388. 
1389. 
1390. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-11-17 21:08:27")
1391. 	AppendLogfile("!LogFileName!", ".")
1392. 	AppendLogfile("!LogFileName!", "Script Directory:")
1393. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1394. 	AppendLogfile("!LogFileName!", ".")
1395. 	AppendLogfile("!LogFileName!", "Log File:")
1396. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1397. 	AppendLogfile("!LogFileName!", ".")
1398. 	/* AppendLogfile("!LogFileName!", "Log Header:") */
1399. 	/* AppendLogfile("!LogFileName!", "!LogHeader!") */
1400. 	/* AppendLogfile("!LogFileName!", "End of Log Header.") */
1401. 	AppendLogfile("!LogFileName!", ".")
1402. 
1403. 	AppendLogfile("!LogFileName!", "MFT Percentage: !MftPer!")
1404. 	AppendLogfile("!LogFileName!", "MFT Volume RoundUp: !MftRoundUp!")
1405. 	AppendLogfile("!LogFileName!", "MFT Gap %: !MftAdjRoundUp!")
1406. 	AppendLogfile("!LogFileName!", ".")
1407. 
1408. /* This file is where you override the above setting for */
1409. /* global settings. */
1410. /* There is a "SettingsYours\SettingsYours???.MyDc" for each volume type */
1411. /* so this is where you set the volume specific settings */
1412. /* or you can put them all in the file below. */
1413. 
1414. # Volume Preprocessing Do Before.
1415. /* empty */
1416. 
1417. 
1418. # BANNER:
1419. /* Xinclude "..\Display\VolumeSizeLog.MyDc"X */
1420. 
1421. /* Missed: ToDo: */
1422. /* Games Zone Type */
1423. 
1424. 
1425. 
1426. 
1427. SetVariable(MftZone, "Shares")
1428. 
1429. /* empty */
1430. 
1431. 
1432. # Script: DefragAnyComplexVolume
1433. /* Complex Volume */
1434. # MyDefrag v4.0 script: Defrag Complex (Mixed or Any) Volume.
1435. 
1436. # Script: VolumeStatisticsDetailGet
1437. 
1438. # Set Volume summary stats:
1439. 
1440. # Cluster, Sector, Block adjust for display.
1441. # Bytes per cluster is volume specific.
1442. 
1443. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1444. 
1445. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1446. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1447. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1448. 
1449. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1450. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1451. 
1452. # Set the display text:
1453. # Script: VolumeStatisticsSummaryDisplay
1454. 
1455. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1456. SUMMARY: !VolumeLabel! !VolumeDescription!
1457.   
1458.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1459.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1460.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1461.          
1462.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1463.       Volume Free Adj:       !VolumeFreeAdj!
1464.     Bytes per cluster:       !BytesPerCluster! bytes
1465. 
1466.    Unfragmented Items:       !FILES200N!
1467.      Fragmented Items:       !FILES210N!
1468. 
1469.     Unfragmented Data:       !FILES202N! bytes
1470.       Fragmented Data:       !FILES212N! bytes
1471. 
1472.              All Gaps:       !GAP00N!
1473.              All gaps:       !GAP10N! bytes
1474.           Average gap:       !GAP13N! bytes
1475.            Median gap:       !GAP14N! bytes
1476.           Biggest gap:       !GAP15N! bytes
1477. 
1478.              MFT Zone:       !MftZone! Location: !MftLocation! 
1479.                  Size:                       0 Gap: !MftGap!
1480. ----------------------------------------------------------
1481. ") 
1482. 
1483. 
1484. 
1485. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1486. VOLUME: !VolumeLabel! !VolumeDescription!
1487. ----------------------------------------------------------
1488. !VolumeStatisticsSummary!
1489. ----------------------------------------------------------
1490. DETAILS: !VolumeLabel! !VolumeDescription!
1491. ----------------------------------------------------------
1492. 
1493. SUMMARY:
1494. 
1495. Volume label/name:          !VolumeLabel!
1496. Volume mountpoint:          !MountPoint!
1497. Volume name:                !VolumeName!
1498. Volume type:                !VolumeType!
1499. 
1500. Total disk space:           !VolumeSize! bytes
1501.                             !VolumeSizeG! gigabytes
1502. 
1503. Bytes per cluster:          !BytesPerCluster! bytes
1504. Average end-begin distance: !AverageBeginEndDistance! clusters
1505.                             !AverageBeginEndDistanceP!% of volume size
1506. 
1507. ----------------------------------------------------------
1508. FRAGMENTS:
1509. 
1510. Unfragmented Items: !FILES200N!
1511.   Fragmented Items: !FILES210N!
1512.  Unfragmented Data: !FILES202N! bytes
1513.    Fragmented Data: !FILES212N! bytes
1514. Gaps:
1515.           All Gaps: !GAP00N!
1516.           All gaps: !GAP10N! bytes
1517.        Average gap: !GAP13N! bytes
1518.         Median gap: !GAP14N! bytes
1519.        Biggest gap: !GAP15N! bytes
1520. 
1521. ----------------------------------------------------------
1522. GAPS:
1523. 
1524.    ----------------------------------------------------------
1525.    Counts:
1526.                        Count      Percentage of all
1527.                 ----------------- -----------------
1528.    Small gaps   !GAP01N! !GAP01P!%
1529.    Big gaps     !GAP02N! !GAP02P!%
1530.                 ----------------- -----------------
1531.    All gaps     !GAP00N! !GAP00P!
1532. 
1533.    ----------------------------------------------------------
1534.    By size:
1535.                       Bytes          Gigabytes      Percentage of all
1536.                 ----------------- ----------------- -----------------
1537.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1538.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1539.                 ----------------- ----------------- -----------------
1540.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1541. 
1542.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1543.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1544.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1545.    ----------------------------------------------------------
1546. 
1547. ----------------------------------------------------------
1548. FILE STATISTICS:
1549. ----------------------------------------------------------
1550. 
1551. ----------------------------------------------------------
1552. ITEM COUNT:
1553. ----------------------------------------------------------
1554. Number of files and folders:
1555. 
1556.               Unfragmented       Fragmented            All
1557.    ------- ----------------- ----------------- -----------------
1558.    Files   !FILES000N! !FILES010N! !FILES020N!
1559.    Folders !FILES100N! !FILES110N! !FILES120N!
1560.    ------- ----------------- ----------------- -----------------
1561.    All     !FILES200N! !FILES210N! !FILES220N!
1562. 
1563. ----------------------------------------------------------
1564. Percentage of total:
1565. 
1566.               Unfragmented       Fragmented            All
1567.    ------- ----------------- ----------------- -----------------
1568.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1569.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1570.    ------- ----------------- ----------------- -----------------
1571.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1572. 
1573. ----------------------------------------------------------
1574. OCCUPIED SIZE on disk:
1575. ----------------------------------------------------------
1576. Bytes:
1577.               Unfragmented       Fragmented            All
1578.    ------- ----------------- ----------------- -----------------
1579.    Files   !FILES002N! !FILES012N! !FILES022N!
1580.    Folders !FILES102N! !FILES112N! !FILES122N!
1581.    ------- ----------------- ----------------- -----------------
1582.    All     !FILES202N! !FILES212N! !FILES222N!
1583. 
1584. ----------------------------------------------------------
1585. Gigabytes:
1586.               Unfragmented       Fragmented            All
1587.    ------- ----------------- ----------------- -----------------
1588.    Files   !FILES002G! !FILES012G! !FILES022G!
1589.    Folders !FILES102G! !FILES112G! !FILES122G!
1590.    ------- ----------------- ----------------- -----------------
1591.    All     !FILES202G! !FILES212G! !FILES222G!
1592. 
1593. ----------------------------------------------------------
1594. Percentage:
1595.               Unfragmented       Fragmented            All
1596.    ------- ----------------- ----------------- -----------------
1597.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1598.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1599.    ------- ----------------- ----------------- -----------------
1600.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1601. 
1602. ----------------------------------------------------------
1603. USED SIZE:
1604. ----------------------------------------------------------
1605. Bytes:
1606.               Unfragmented       Fragmented            All
1607.    ------- ----------------- ----------------- -----------------
1608.    Files   !FILES001N! !FILES011N! !FILES021N!
1609.    Folders !FILES101N! !FILES111N! !FILES121N!
1610.    ------- ----------------- ----------------- -----------------
1611.    All     !FILES201N! !FILES211N! !FILES221N!
1612. 
1613. ----------------------------------------------------------
1614. Gigabytes:
1615.               Unfragmented       Fragmented            All
1616.    ------- ----------------- ----------------- -----------------
1617.    Files   !FILES001G! !FILES011G! !FILES021G!
1618.    Folders !FILES101G! !FILES111G! !FILES121G!
1619.    ------- ----------------- ----------------- -----------------
1620.    All     !FILES201G! !FILES211G! !FILES221G!
1621. 
1622. ----------------------------------------------------------
1623. Percentage:
1624.               Unfragmented       Fragmented            All
1625.    ------- ----------------- ----------------- -----------------
1626.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1627.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1628.    ------- ----------------- ----------------- -----------------
1629.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1630. 
1631. ----------------------------------------------------------
1632. Volume Detailed Statistics end.
1633. ----------------------------------------------------------
1634. ") 
1635. 
1636. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1637. 
1638. RunProgram("..\Commands\WriteDateTime.bat LastVolume")
1639. SetVariable(FileStepDescription,"!VolumeLabel! !VolumeDescription! started: 2021-11-17 21:08:27.")
1640. # Script: DisplaySetFileStep
1641. 
1642. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1643. 
1644. /* add message and move to a new line. */
1645. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1646. ")
1647. 
1648. /* display the line. (hopefully.) */
1649. # Zone Footer Set Statistics Window Text
1650. 
1651. SetStatisticsWindowText("!Heading!
1652. ----------------------------------------------------------
1653. Zones Processed: 
1654. ----------------------------------------------------------
1655. !ZoneListByLine!
1656. ----------------------------------------------------------
1657. Zone Processing Step:
1658. !ZoneStepByLine!    
1659. ----------------------------------------------------------
1660. ----------------------------------------------------------
1661. Current Zone:
1662. !ZoneFooter!
1663. ----------------------------------------------------------
1664. ----------------------------------------------------------
1665. Volume Statistics:
1666. !VolumeStatisticsDetail!
1667. ----------------------------------------------------------
1668. ----------------------------------------------------------
1669. Zone Detailed Report:
1670. ----------------------------------------------------------
1671. !ZoneStatisticsDetail!
1672. ----------------------------------------------------------
1673. ")
1674. 
1675. 
1676. 
1677. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1678. 
1679. # Script: BannerSet
1680. 
1681. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
1682. 
1683. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
1684. 
1685. Title('!Heading!')
1686. /* pause(1) */
1687. 
1688. /* NOTE: Can't round or truncate to integer precision. */
1689. 
1690. pause(1)
1691. 
1692. SetVariable(FileStepDescription,"Analyzing Volume")
1693. # Script: DisplaySetFileStep
1694. 
1695. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1696. 
1697. /* add message and move to a new line. */
1698. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1699. ")
1700. 
1701. /* display the line. (hopefully.) */
1702. # Zone Footer Set Statistics Window Text
1703. 
1704. SetStatisticsWindowText("!Heading!
1705. ----------------------------------------------------------
1706. Zones Processed: 
1707. ----------------------------------------------------------
1708. !ZoneListByLine!
1709. ----------------------------------------------------------
1710. Zone Processing Step:
1711. !ZoneStepByLine!    
1712. ----------------------------------------------------------
1713. ----------------------------------------------------------
1714. Current Zone:
1715. !ZoneFooter!
1716. ----------------------------------------------------------
1717. ----------------------------------------------------------
1718. Volume Statistics:
1719. !VolumeStatisticsDetail!
1720. ----------------------------------------------------------
1721. ----------------------------------------------------------
1722. Zone Detailed Report:
1723. ----------------------------------------------------------
1724. !ZoneStatisticsDetail!
1725. ----------------------------------------------------------
1726. ")
1727. 
1728. 
1729. 
1730. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1731. 
1732. # Script: BannerSet
1733. 
1734. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
1735. 
1736. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
1737. 
1738. Title('!Heading!')
1739. /* pause(1) */
1740. 
1741. /* NOTE: Can't round or truncate to integer precision. */
1742. 
1743. pause(1)
1744. 
1745. /* ---------------------------------------------------------- */
1746. VolumeSelect
1747. 
1748. 	Label("!VolumeLabel!") or Name("!VolumeLabel!")
1749. 
1750. /* ---------------------------------------------------------- */
1751. VolumeActions
1752. 
1753. /* ---------------------------------------------------------- */
1754. /* Volume Init */
1755. # Script: VolumeStatisticsDetailGet
1756. 
1757. # Set Volume summary stats:
1758. 
1759. # Cluster, Sector, Block adjust for display.
1760. # Bytes per cluster is volume specific.
1761. 
1762. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1763. 
1764. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1765. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1766. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1767. 
1768. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1769. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1770. 
1771. # Set the display text:
1772. # Script: VolumeStatisticsSummaryDisplay
1773. 
1774. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1775. SUMMARY: !VolumeLabel! !VolumeDescription!
1776.   
1777.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1778.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1779.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1780.          
1781.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1782.       Volume Free Adj:       !VolumeFreeAdj!
1783.     Bytes per cluster:       !BytesPerCluster! bytes
1784. 
1785.    Unfragmented Items:       !FILES200N!
1786.      Fragmented Items:       !FILES210N!
1787. 
1788.     Unfragmented Data:       !FILES202N! bytes
1789.       Fragmented Data:       !FILES212N! bytes
1790. 
1791.              All Gaps:       !GAP00N!
1792.              All gaps:       !GAP10N! bytes
1793.           Average gap:       !GAP13N! bytes
1794.            Median gap:       !GAP14N! bytes
1795.           Biggest gap:       !GAP15N! bytes
1796. 
1797.              MFT Zone:       !MftZone! Location: !MftLocation! 
1798.                  Size:                       0 Gap: !MftGap!
1799. ----------------------------------------------------------
1800. ") 
1801. 
1802. 
1803. 
1804. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1805. VOLUME: !VolumeLabel! !VolumeDescription!
1806. ----------------------------------------------------------
1807. !VolumeStatisticsSummary!
1808. ----------------------------------------------------------
1809. DETAILS: !VolumeLabel! !VolumeDescription!
1810. ----------------------------------------------------------
1811. 
1812. SUMMARY:
1813. 
1814. Volume label/name:          !VolumeLabel!
1815. Volume mountpoint:          !MountPoint!
1816. Volume name:                !VolumeName!
1817. Volume type:                !VolumeType!
1818. 
1819. Total disk space:           !VolumeSize! bytes
1820.                             !VolumeSizeG! gigabytes
1821. 
1822. Bytes per cluster:          !BytesPerCluster! bytes
1823. Average end-begin distance: !AverageBeginEndDistance! clusters
1824.                             !AverageBeginEndDistanceP!% of volume size
1825. 
1826. ----------------------------------------------------------
1827. FRAGMENTS:
1828. 
1829. Unfragmented Items: !FILES200N!
1830.   Fragmented Items: !FILES210N!
1831.  Unfragmented Data: !FILES202N! bytes
1832.    Fragmented Data: !FILES212N! bytes
1833. Gaps:
1834.           All Gaps: !GAP00N!
1835.           All gaps: !GAP10N! bytes
1836.        Average gap: !GAP13N! bytes
1837.         Median gap: !GAP14N! bytes
1838.        Biggest gap: !GAP15N! bytes
1839. 
1840. ----------------------------------------------------------
1841. GAPS:
1842. 
1843.    ----------------------------------------------------------
1844.    Counts:
1845.                        Count      Percentage of all
1846.                 ----------------- -----------------
1847.    Small gaps   !GAP01N! !GAP01P!%
1848.    Big gaps     !GAP02N! !GAP02P!%
1849.                 ----------------- -----------------
1850.    All gaps     !GAP00N! !GAP00P!
1851. 
1852.    ----------------------------------------------------------
1853.    By size:
1854.                       Bytes          Gigabytes      Percentage of all
1855.                 ----------------- ----------------- -----------------
1856.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1857.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1858.                 ----------------- ----------------- -----------------
1859.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1860. 
1861.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1862.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1863.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1864.    ----------------------------------------------------------
1865. 
1866. ----------------------------------------------------------
1867. FILE STATISTICS:
1868. ----------------------------------------------------------
1869. 
1870. ----------------------------------------------------------
1871. ITEM COUNT:
1872. ----------------------------------------------------------
1873. Number of files and folders:
1874. 
1875.               Unfragmented       Fragmented            All
1876.    ------- ----------------- ----------------- -----------------
1877.    Files   !FILES000N! !FILES010N! !FILES020N!
1878.    Folders !FILES100N! !FILES110N! !FILES120N!
1879.    ------- ----------------- ----------------- -----------------
1880.    All     !FILES200N! !FILES210N! !FILES220N!
1881. 
1882. ----------------------------------------------------------
1883. Percentage of total:
1884. 
1885.               Unfragmented       Fragmented            All
1886.    ------- ----------------- ----------------- -----------------
1887.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1888.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1889.    ------- ----------------- ----------------- -----------------
1890.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1891. 
1892. ----------------------------------------------------------
1893. OCCUPIED SIZE on disk:
1894. ----------------------------------------------------------
1895. Bytes:
1896.               Unfragmented       Fragmented            All
1897.    ------- ----------------- ----------------- -----------------
1898.    Files   !FILES002N! !FILES012N! !FILES022N!
1899.    Folders !FILES102N! !FILES112N! !FILES122N!
1900.    ------- ----------------- ----------------- -----------------
1901.    All     !FILES202N! !FILES212N! !FILES222N!
1902. 
1903. ----------------------------------------------------------
1904. Gigabytes:
1905.               Unfragmented       Fragmented            All
1906.    ------- ----------------- ----------------- -----------------
1907.    Files   !FILES002G! !FILES012G! !FILES022G!
1908.    Folders !FILES102G! !FILES112G! !FILES122G!
1909.    ------- ----------------- ----------------- -----------------
1910.    All     !FILES202G! !FILES212G! !FILES222G!
1911. 
1912. ----------------------------------------------------------
1913. Percentage:
1914.               Unfragmented       Fragmented            All
1915.    ------- ----------------- ----------------- -----------------
1916.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1917.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1918.    ------- ----------------- ----------------- -----------------
1919.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1920. 
1921. ----------------------------------------------------------
1922. USED SIZE:
1923. ----------------------------------------------------------
1924. Bytes:
1925.               Unfragmented       Fragmented            All
1926.    ------- ----------------- ----------------- -----------------
1927.    Files   !FILES001N! !FILES011N! !FILES021N!
1928.    Folders !FILES101N! !FILES111N! !FILES121N!
1929.    ------- ----------------- ----------------- -----------------
1930.    All     !FILES201N! !FILES211N! !FILES221N!
1931. 
1932. ----------------------------------------------------------
1933. Gigabytes:
1934.               Unfragmented       Fragmented            All
1935.    ------- ----------------- ----------------- -----------------
1936.    Files   !FILES001G! !FILES011G! !FILES021G!
1937.    Folders !FILES101G! !FILES111G! !FILES121G!
1938.    ------- ----------------- ----------------- -----------------
1939.    All     !FILES201G! !FILES211G! !FILES221G!
1940. 
1941. ----------------------------------------------------------
1942. Percentage:
1943.               Unfragmented       Fragmented            All
1944.    ------- ----------------- ----------------- -----------------
1945.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1946.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1947.    ------- ----------------- ----------------- -----------------
1948.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1949. 
1950. ----------------------------------------------------------
1951. Volume Detailed Statistics end.
1952. ----------------------------------------------------------
1953. ") 
1954. 
1955. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1956. 
1957. SetVariable(FileStepDescription,"Volume started.")
1958. # Script: DisplaySetFileStep
1959. 
1960. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1961. 
1962. /* add message and move to a new line. */
1963. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1964. ")
1965. 
1966. /* display the line. (hopefully.) */
1967. # Zone Footer Set Statistics Window Text
1968. 
1969. SetStatisticsWindowText("!Heading!
1970. ----------------------------------------------------------
1971. Zones Processed: 
1972. ----------------------------------------------------------
1973. !ZoneListByLine!
1974. ----------------------------------------------------------
1975. Zone Processing Step:
1976. !ZoneStepByLine!    
1977. ----------------------------------------------------------
1978. ----------------------------------------------------------
1979. Current Zone:
1980. !ZoneFooter!
1981. ----------------------------------------------------------
1982. ----------------------------------------------------------
1983. Volume Statistics:
1984. !VolumeStatisticsDetail!
1985. ----------------------------------------------------------
1986. ----------------------------------------------------------
1987. Zone Detailed Report:
1988. ----------------------------------------------------------
1989. !ZoneStatisticsDetail!
1990. ----------------------------------------------------------
1991. ")
1992. 
1993. 
1994. 
1995. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1996. 
1997. # Script: BannerSet
1998. 
1999. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2000. 
2001. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
2002. 
2003. Title('!Heading!')
2004. /* pause(1) */
2005. 
2006. /* NOTE: Can't round or truncate to integer precision. */
2007. 
2008. pause(1)
2009. 
2010. # Script: VolumeWhenStarted
2011. 
2012. SetVariable(VolumeFreeAdj, (VolumeFree * (VolumeUsed / VolumeSize)))
2013. 
2014. SetVariable(MftLocation, RoundUp(VolumeUsed * MftPerDev, VolumeSize * VolumeRoundUpLarge)) 
2015. 
2016. SetVariable(ZoneFooter, "")
2017. SetVariable(ZoneListByLine, 		"Volume started.
2018. ")
2019. SetVariable(ZoneStepByLine, 		"Initialize.
2020. ")
2021. SetVariable(ZoneStatisticsDetail, 	"")
2022. 
2023. SetVariable(ZoneNoCurrent, 		0)
2024. SetVariable(ZoneNoAdjCurrent, 	0) 
2025. SetVariable(ZoneCurrentAjust,	0)
2026. 
2027. # Script: BannerSet
2028. 
2029. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2030. 
2031. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
2032. 
2033. Title('!Heading!')
2034. /* pause(1) */
2035. 
2036. /* NOTE: Can't round or truncate to integer precision. */
2037. 
2038. # Script: BannerLog
2039. 
2040. AppendLogfile("!LogFileName!", "!Title!")
2041. 
2042. 
2043. # Script: VolumeStatisticsDetailGet
2044. 
2045. # Set Volume summary stats:
2046. 
2047. # Cluster, Sector, Block adjust for display.
2048. # Bytes per cluster is volume specific.
2049. 
2050. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
2051. 
2052. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
2053. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
2054. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2055. 
2056. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
2057. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2058. 
2059. # Set the display text:
2060. # Script: VolumeStatisticsSummaryDisplay
2061. 
2062. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
2063. SUMMARY: !VolumeLabel! !VolumeDescription!
2064.   
2065.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
2066.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
2067.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
2068.          
2069.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
2070.       Volume Free Adj:       !VolumeFreeAdj!
2071.     Bytes per cluster:       !BytesPerCluster! bytes
2072. 
2073.    Unfragmented Items:       !FILES200N!
2074.      Fragmented Items:       !FILES210N!
2075. 
2076.     Unfragmented Data:       !FILES202N! bytes
2077.       Fragmented Data:       !FILES212N! bytes
2078. 
2079.              All Gaps:       !GAP00N!
2080.              All gaps:       !GAP10N! bytes
2081.           Average gap:       !GAP13N! bytes
2082.            Median gap:       !GAP14N! bytes
2083.           Biggest gap:       !GAP15N! bytes
2084. 
2085.              MFT Zone:       !MftZone! Location: !MftLocation! 
2086.                  Size:                       0 Gap: !MftGap!
2087. ----------------------------------------------------------
2088. ") 
2089. 
2090. 
2091. 
2092. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
2093. VOLUME: !VolumeLabel! !VolumeDescription!
2094. ----------------------------------------------------------
2095. !VolumeStatisticsSummary!
2096. ----------------------------------------------------------
2097. DETAILS: !VolumeLabel! !VolumeDescription!
2098. ----------------------------------------------------------
2099. 
2100. SUMMARY:
2101. 
2102. Volume label/name:          !VolumeLabel!
2103. Volume mountpoint:          !MountPoint!
2104. Volume name:                !VolumeName!
2105. Volume type:                !VolumeType!
2106. 
2107. Total disk space:           !VolumeSize! bytes
2108.                             !VolumeSizeG! gigabytes
2109. 
2110. Bytes per cluster:          !BytesPerCluster! bytes
2111. Average end-begin distance: !AverageBeginEndDistance! clusters
2112.                             !AverageBeginEndDistanceP!% of volume size
2113. 
2114. ----------------------------------------------------------
2115. FRAGMENTS:
2116. 
2117. Unfragmented Items: !FILES200N!
2118.   Fragmented Items: !FILES210N!
2119.  Unfragmented Data: !FILES202N! bytes
2120.    Fragmented Data: !FILES212N! bytes
2121. Gaps:
2122.           All Gaps: !GAP00N!
2123.           All gaps: !GAP10N! bytes
2124.        Average gap: !GAP13N! bytes
2125.         Median gap: !GAP14N! bytes
2126.        Biggest gap: !GAP15N! bytes
2127. 
2128. ----------------------------------------------------------
2129. GAPS:
2130. 
2131.    ----------------------------------------------------------
2132.    Counts:
2133.                        Count      Percentage of all
2134.                 ----------------- -----------------
2135.    Small gaps   !GAP01N! !GAP01P!%
2136.    Big gaps     !GAP02N! !GAP02P!%
2137.                 ----------------- -----------------
2138.    All gaps     !GAP00N! !GAP00P!
2139. 
2140.    ----------------------------------------------------------
2141.    By size:
2142.                       Bytes          Gigabytes      Percentage of all
2143.                 ----------------- ----------------- -----------------
2144.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
2145.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
2146.                 ----------------- ----------------- -----------------
2147.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
2148. 
2149.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
2150.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
2151.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
2152.    ----------------------------------------------------------
2153. 
2154. ----------------------------------------------------------
2155. FILE STATISTICS:
2156. ----------------------------------------------------------
2157. 
2158. ----------------------------------------------------------
2159. ITEM COUNT:
2160. ----------------------------------------------------------
2161. Number of files and folders:
2162. 
2163.               Unfragmented       Fragmented            All
2164.    ------- ----------------- ----------------- -----------------
2165.    Files   !FILES000N! !FILES010N! !FILES020N!
2166.    Folders !FILES100N! !FILES110N! !FILES120N!
2167.    ------- ----------------- ----------------- -----------------
2168.    All     !FILES200N! !FILES210N! !FILES220N!
2169. 
2170. ----------------------------------------------------------
2171. Percentage of total:
2172. 
2173.               Unfragmented       Fragmented            All
2174.    ------- ----------------- ----------------- -----------------
2175.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
2176.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
2177.    ------- ----------------- ----------------- -----------------
2178.    All     !FILES200P!%!FILES210P!%!FILES220P!%
2179. 
2180. ----------------------------------------------------------
2181. OCCUPIED SIZE on disk:
2182. ----------------------------------------------------------
2183. Bytes:
2184.               Unfragmented       Fragmented            All
2185.    ------- ----------------- ----------------- -----------------
2186.    Files   !FILES002N! !FILES012N! !FILES022N!
2187.    Folders !FILES102N! !FILES112N! !FILES122N!
2188.    ------- ----------------- ----------------- -----------------
2189.    All     !FILES202N! !FILES212N! !FILES222N!
2190. 
2191. ----------------------------------------------------------
2192. Gigabytes:
2193.               Unfragmented       Fragmented            All
2194.    ------- ----------------- ----------------- -----------------
2195.    Files   !FILES002G! !FILES012G! !FILES022G!
2196.    Folders !FILES102G! !FILES112G! !FILES122G!
2197.    ------- ----------------- ----------------- -----------------
2198.    All     !FILES202G! !FILES212G! !FILES222G!
2199. 
2200. ----------------------------------------------------------
2201. Percentage:
2202.               Unfragmented       Fragmented            All
2203.    ------- ----------------- ----------------- -----------------
2204.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
2205.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
2206.    ------- ----------------- ----------------- -----------------
2207.    All     !FILES202P!%!FILES212P!%!FILES222P!%
2208. 
2209. ----------------------------------------------------------
2210. USED SIZE:
2211. ----------------------------------------------------------
2212. Bytes:
2213.               Unfragmented       Fragmented            All
2214.    ------- ----------------- ----------------- -----------------
2215.    Files   !FILES001N! !FILES011N! !FILES021N!
2216.    Folders !FILES101N! !FILES111N! !FILES121N!
2217.    ------- ----------------- ----------------- -----------------
2218.    All     !FILES201N! !FILES211N! !FILES221N!
2219. 
2220. ----------------------------------------------------------
2221. Gigabytes:
2222.               Unfragmented       Fragmented            All
2223.    ------- ----------------- ----------------- -----------------
2224.    Files   !FILES001G! !FILES011G! !FILES021G!
2225.    Folders !FILES101G! !FILES111G! !FILES121G!
2226.    ------- ----------------- ----------------- -----------------
2227.    All     !FILES201G! !FILES211G! !FILES221G!
2228. 
2229. ----------------------------------------------------------
2230. Percentage:
2231.               Unfragmented       Fragmented            All
2232.    ------- ----------------- ----------------- -----------------
2233.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
2234.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
2235.    ------- ----------------- ----------------- -----------------
2236.    All     !FILES201P!%!FILES211P!%!FILES221P!%
2237. 
2238. ----------------------------------------------------------
2239. Volume Detailed Statistics end.
2240. ----------------------------------------------------------
2241. ") 
2242. 
2243. # Script: BannerLog
2244. 
2245. AppendLogfile("!LogFileName!", "!Title!")
2246. 
2247. 
2248. 
2249. /* Write/display stats: */
2250. # Log:
2251. SetVariable(VolumeDescription,"")
2252. SetVariable(VolumeDescription, "!VolumeDescription!!Title! started.")
2253. SetVariable(VolumeDescription, "!VolumeDescription!
2254. 2021-11-17 21:08:27.")
2255. SetVariable(VolumeDescription, "!VolumeDescription
2256. !.")
2257. SetVariable(VolumeDescription, "!VolumeDescription!
2258. .")
2259. SetVariable(VolumeDescription, "!VolumeDescription!
2260. Volume: !VolumeLabel!")
2261. SetVariable(VolumeDescription, "!VolumeDescription!
2262. .")
2263. SetVariable(VolumeDescription, "!VolumeDescription!
2264. !VolumeStatisticsDetail!")
2265. SetVariable(VolumeDescription, "!VolumeDescription!
2266. .")
2267. SetVariable(VolumeDescription, "!VolumeDescription!
2268. !Title! started.")
2269. SetVariable(VolumeDescription, "!VolumeDescription!
2270. 2021-11-17 21:08:27.")
2271. SetVariable(VolumeDescription, "!VolumeDescription!
2272. .")
2273. 
2274. WriteLogfile("!LogFileName! Volume !VolumenName! !RunDescription! 2021-11-17 21:08:27","!VolumeDescription!")
2275. AppendLogfile("!LogFileName!","!VolumeDescription!")
2276. 
2277. # In program statistics window (view):
2278. SetStatisticsWindowText("!VolumeStatisticsDetail!")
2279. 
2280. 
2281. /* ---------------------------------------------------------- */
2282. /* System Zones 1 - 7 */
2283. /* ---------------------------------------------------------- */
2284. 
2285. 	# Script: DefragZoneGroupOs
2286. # Defrag Zones Os
2287. 	/* System Zones */
2288. 
2289. AppendLogfile("!LogFileName!", "!Description! Os Zones started: 2021-11-17 21:08:27")
2290. SetVariable(FileStepDescription,"System Zones.")
2291. # Script: BannerSet
2292. 
2293. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2294. 
2295. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
2296. 
2297. Title('!Heading!')
2298. /* pause(1) */
2299. 
2300. /* NOTE: Can't round or truncate to integer precision. */
2301. 
2302. # Script: BannerLog
2303. 
2304. AppendLogfile("!LogFileName!", "!Title!")
2305. 
2306. 
2307. AppendLogfile("!LogFileName!",".")
2308. 
2309. AppendLogfile("!LogFileName!", "System Disk optimized layout for boot and executables. 2021-11-17 21:08:27")
2310. /* Dgh 20190618 */
2311. 
2312. /* ---------------------------------------------------------- */
2313. /* Defrag the Pagefile.sys on the next boot. */
2314. 
2315. # PagedFrg - Page Defrag.
2316. 
2317. /* Defrag the Pagefile.sys on the next boot. */
2318. # RunProgram("..\Pagedfrg.exe","-o")
2319. 
2320. 
2321. /* ---------------------------------------------------------- */
2322. AppendLogfile("!LogFileName!", "Place files at the beginning of the disk: 2021-11-17 21:08:27")
2323. 
2324. 	MakeGap(0)
2325. 
2326. /* ---------------------------------------------------------- */
2327. # Zone Boot Fixed and Data 
2328. # Os Group Zone 1 & 2
2329. # Script: DefragZoneTypeOsBoot
2330. /* ---------------------------------------------------------- */
2331. # Zone 1 Boot Fixed.
2332. 	# Script: DisplayColors - Zone Dark
2333. # Processed
2334. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
2335. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
2336. 
2337. # Light Green and Yellow
2338. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
2339. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
2340. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
2341. 
2342. 	SetVariable(ZoneLabel, 			"!ZoneLabelBoot!")
2343. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBoot!")
2344. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
2345. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
2346. 	SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectOsBoot
2347. # Boot start.
2348. ImportListFromBootOptimize()
2349. # Boot end.
2350. ')
2351. 
2352. 		# Script: ZoneDoHeader
2353. 
2354. # Script: ZoneWhenStarted
2355. RunProgram("..\Commands\WriteDateTime.bat")
2356. 
2357. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
2358. # Script: DisplaySetZone
2359. 
2360. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
2361. SetVariable(FileStepDescription,	"")
2362. 
2363. SetVariable(ZoneStepByLine, 			"Zone started.
2364. ")
2365. 
2366. # Script: BannerDescriptionSet
2367. 
2368. # Script: BannerSet
2369. 
2370. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2371. 
2372. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
2373. 
2374. Title('!Heading!')
2375. /* pause(1) */
2376. 
2377. /* NOTE: Can't round or truncate to integer precision. */
2378. 
2379. # Script: BannerLog
2380. 
2381. AppendLogfile("!LogFileName!", "!Title!")
2382. 
2383. 
2384. 
2385. pause(1)
2386. 
2387. 
2388. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
2389. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
2390. 
2391. SetVariable(ZoneStepNoCurrent, 0)
2392. 
2393. 
2394. # Script: ZoneDoCurrentClear
2395. 
2396. SetVariable(ZoneTypeSelectCurrent, 		"")
2397. 
2398. SetVariable(ZoneBeginCurrent, 			0)
2399. SetVariable(ZoneBeginPerCurrent, 		0)
2400. SetVariable(ZoneEndCurrent, 			0)
2401. SetVariable(ZoneEndPerCurrent, 			0)
2402. 
2403. SetVariable(ZoneSizeCurrent,			0)
2404. SetVariable(ZoneSizePerCurrent,			0)
2405. 
2406. SetVariable(ZoneGapRequestedCurrent,	0)
2407. SetVariable(ZoneGapRoundedCurrent, 		0)
2408. SetVariable(ZoneGapAdjustedCurrent, 	0)
2409. SetVariable(ZoneGapAvailableCurrent, 	0)
2410. SetVariable(ZoneGapCurrent,				0)
2411. SetVariable(ZoneGapUsedCurrent, 		0)
2412. 
2413. SetVariable(ZoneGapActualCurrent, 		0)
2414. SetVariable(ZoneGapActualPerCurrent, 	0)
2415. 
2416. SetVariable(ZoneSizeActual, 			0)
2417. SetVariable(ZoneSizeActualCurrent,		0)
2418. 
2419. SetVariable(ZoneEndActual, 				0)
2420. SetVariable(ZoneEndActualCurrent,		0)			
2421. SetVariable(ZoneSizeActualPerCurrent, 	0)
2422.       
2423. SetVariable(ZoneFilesFolders,			0)
2424. SetVariable(ZoneFilesFoldersPer,		0) 
2425. 
2426. SetVariable(ZoneFragments,				0)
2427. SetVariable(ZoneFragmentsPer,			0) 
2428. 		
2429. SetVariable(ZoneEndActualCurrent, 		0)
2430. SetVariable(ZoneEndActualPerCurrent, 	0)
2431. 
2432. # Gap Calculation Methodology:
2433. 	# Requested
2434. 	SetVariable(GapRequested, 			0) 
2435. 	SetVariable(GapRequestedStd, 		0) 
2436. 	SetVariable(GapRequestedMft, 		0) 
2437. 	SetVariable(GapRequestedOs, 		0) 
2438. 	SetVariable(GapRequestedOriginal, 	0) 
2439. 	
2440. 	# Gap Adjustments
2441. 	SetVariable(GapRounded, 			0)
2442. 	# SetVariable(GapAdjusted, 			0)
2443. 	SetVariable(GapAvailable, 			0)
2444. 	SetVariable(GapCurrent, 			0)
2445. 	SetVariable(GapActual, 				0)
2446. 	SetVariable(GapUsed, 				0)
2447. 	
2448. 	# Gap Adjustments
2449. 	SetVariable(GapRoundedLoc, 			0)
2450. 	# SetVariable(GapAdjustedLoc, 		0)
2451. 	SetVariable(GapAvailableLoc, 		0)
2452. 	SetVariable(GapCurrentLoc, 			0)
2453. 	SetVariable(GapActualLoc,			0)
2454. 	SetVariable(GapUsedLoc,				0)
2455. 	
2456. 	# Space usage
2457. 	SetVariable(ZoneFreePerRequested, 	0)
2458. 	SetVariable(ZoneFreePerUsed, 		0)
2459. 
2460. # Gap Size & Rounding
2461. 	SetVariable(ZoneGapSizePer, 		0)
2462. 	SetVariable(ZoneVolRoundUpPer, 		0)
2463. 	
2464. 	# Free Space
2465. 	SetVariable(ZoneFreeUsedPer, 		0)
2466. 	SetVariable(ZoneFreeRequestedPer, 	0)
2467. 
2468. 
2469. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
2470. 
2471. # Footer:
2472. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
2473. # 2021-11-17 21:08:27
2474. 
2475. SetVariable(ZoneFooter1, "----------------------------------------------------------
2476. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
2477. #
2478. # Xinclude "..\Commands\DateTimeLastLong.txt"X
2479. #
2480. SetVariable(ZoneFooter2, "Statistics Report:
2481. ------------------
2482.    Size:  
2483.    ------------------------
2484.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2485.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2486.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2487. 
2488.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2489.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2490. 
2491.    Location:
2492.    ------------------------
2493.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2494.             Files End: !ZoneEndCurrent!
2495.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2496.       
2497.    Gap Settings:
2498.    ------------------------
2499.          Gap Requested: !ZoneGapSizePer!%
2500.        Volume Rounding: !ZoneVolRoundUpPer!%
2501.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2502.                  
2503.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
2504.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
2505.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
2506.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
2507.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
2508.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
2509.      
2510.    Free Space after Zone:
2511.    ------------------------
2512.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
2513.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
2514.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
2515. 
2516. Directory and Files Select:
2517. ---------------------------
2518. !ZoneTypeSelectCurrent!               
2519. ---------------------------
2520. ----------------------------------------------------------
2521. ")
2522. 
2523. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
2524. 
2525. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
2526. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
2527. RunProgram("..\Commands\WriteDateTime.bat LastZone")
2528. 
2529. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
2530. 
2531. 
2532. 
2533. # Script: BannerSet
2534. 
2535. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2536. 
2537. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
2538. 
2539. Title('!Heading!')
2540. /* pause(1) */
2541. 
2542. /* NOTE: Can't round or truncate to integer precision. */
2543. 
2544. # Script: BannerLog
2545. 
2546. AppendLogfile("!LogFileName!", "!Title!")
2547. 
2548. 
2549. 
2550. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
2551. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
2552. 
2553. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
2554. 
2555. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:27")
2556. 
2557. # 2021-11-17 21:08:27 
2558. SetVariable(Temp9, DATETIME)
2559. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:02 !ZoneLabel! !ZoneDescription!")
2560. 
2561. SetVariable(ZoneListByLine, "!ZoneListByLine! 
2562. Zone: !ZoneNoCurrent! !Temp9! 0:00:02 !ZoneLabel! !ZoneDescription!")
2563. 
2564. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:02 !ZoneLabel! !ZoneDescription!")
2565. 
2566. 
2567. /* Fixed Zone Position Handling */
2568. /* Literal number: */
2569. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
2570. /* Percentage of disk: */
2571. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
2572. /* Gap */
2573. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
2574. 
2575. /* ---------------------------------------------------------- */
2576. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
2577. # Script: DisplaySetFileStep
2578. 
2579. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2580. 
2581. /* add message and move to a new line. */
2582. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2583. ")
2584. 
2585. /* display the line. (hopefully.) */
2586. # Zone Footer Set Statistics Window Text
2587. 
2588. SetStatisticsWindowText("!Heading!
2589. ----------------------------------------------------------
2590. Zones Processed: 
2591. ----------------------------------------------------------
2592. !ZoneListByLine!
2593. ----------------------------------------------------------
2594. Zone Processing Step:
2595. !ZoneStepByLine!    
2596. ----------------------------------------------------------
2597. ----------------------------------------------------------
2598. Current Zone:
2599. !ZoneFooter!
2600. ----------------------------------------------------------
2601. ----------------------------------------------------------
2602. Volume Statistics:
2603. !VolumeStatisticsDetail!
2604. ----------------------------------------------------------
2605. ----------------------------------------------------------
2606. Zone Detailed Report:
2607. ----------------------------------------------------------
2608. !ZoneStatisticsDetail!
2609. ----------------------------------------------------------
2610. ")
2611. 
2612. 
2613. 
2614. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2615. 
2616. # Script: BannerSet
2617. 
2618. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2619. 
2620. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
2621. 
2622. Title('!Heading!')
2623. /* pause(1) */
2624. 
2625. /* NOTE: Can't round or truncate to integer precision. */
2626. 
2627. pause(1)
2628. 
2629. # your stuff HERE (X)... pre file select code.
2630. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
2631. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
2632. 	# (X)
2633. 
2634. FileSelect
2635. 
2636. 	# your stuff can't really go here (errors.)
2637. 	# maybe for some reason I don't know of...
2638. 	
2639. 	# Actions next...
2640. 		# Script: ZoneDo ZoneTypeSelectOsBoot
2641. # Boot start.
2642. ImportListFromBootOptimize()
2643. # Boot end.
2644. 
2645. 		and not(
2646. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
2647. # Os Data Dynamic start.
2648. (
2649. # Os Data Dynamic start.
2650. (
2651.   FileName("*.dat*")
2652.   or FileName("*.db*")
2653.   or FileName("*.edb*")
2654.   or FileName("*.log*")
2655.   or FileName("DataStore.edb")
2656. )
2657. # Os Data Dynamic end.
2658. 
2659.   or 
2660. # Os PageHiberDump start.
2661. (
2662.   FileName("DataStore.edb")
2663.   or FileName("DUMP*.*")
2664.   or FileName("Hiberfil.sys")
2665.   or FileName("MEMORY.DMP")
2666.   or FileName("Pagefile.sys")
2667. )
2668. # Os PageHiberDump end.
2669. 
2670. # Os Data Dynamic
2671. )
2672. # Os Data Dynamic end.
2673. 
2674. 		)
2675. 
2676. 		FileActions
2677. 		  		/* ---------------------------------------------------------- */
2678. 	# Gap
2679. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
2680. 		# Script: DisplaySetFileStep
2681. 
2682. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2683. 
2684. /* add message and move to a new line. */
2685. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2686. ")
2687. 
2688. /* display the line. (hopefully.) */
2689. # Zone Footer Set Statistics Window Text
2690. 
2691. SetStatisticsWindowText("!Heading!
2692. ----------------------------------------------------------
2693. Zones Processed: 
2694. ----------------------------------------------------------
2695. !ZoneListByLine!
2696. ----------------------------------------------------------
2697. Zone Processing Step:
2698. !ZoneStepByLine!    
2699. ----------------------------------------------------------
2700. ----------------------------------------------------------
2701. Current Zone:
2702. !ZoneFooter!
2703. ----------------------------------------------------------
2704. ----------------------------------------------------------
2705. Volume Statistics:
2706. !VolumeStatisticsDetail!
2707. ----------------------------------------------------------
2708. ----------------------------------------------------------
2709. Zone Detailed Report:
2710. ----------------------------------------------------------
2711. !ZoneStatisticsDetail!
2712. ----------------------------------------------------------
2713. ")
2714. 
2715. 
2716. 
2717. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2718. 
2719. # Script: BannerSet
2720. 
2721. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
2722. 
2723. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
2724. 
2725. Title('!Heading!')
2726. /* pause(1) */
2727. 
2728. /* NOTE: Can't round or truncate to integer precision. */
2729. 
2730. pause(1)
2731. 	
2732. 	# ACTUAL GAP
2733. 		/* AddGap Variant. */
2734. 	  	# Zone Do Gap
2735. # Gap Calculation Methods:
2736. 
2737. /* 1) Anything you need to add first. */
2738. /* empty */
2739. 
2740. /* ---------------------------------------------------------- */
2741. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
2742. 	# GapRequestedStd.
2743. 
2744. 		/* ---------------------------------------------------------- */
2745. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
2746. 
2747. 		# Gap Calculation Methods:
2748. 
2749. /* AddGap Variants */
2750. 
2751. 	/* Standard */
2752. 		# Gap Calculation Methods:
2753. 	/* AddGap Variants */
2754. 	/* Standard */
2755. 
2756. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
2757. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
2758. 
2759. 	SetVariable(GapRequested, GapRequestedStd)
2760. 	
2761. 
2762. 	/* MFT Low High Method */
2763. 		# Gap Calculation Methods:
2764. 	/* AddGap Variants */
2765. 	/* MFT Low High Method */
2766. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
2767. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
2768. 	SetVariable(GapRequested, GapRequestedMft)
2769. 	
2770. 
2771. 	/* OS Volume Type Method */
2772. 		# Gap Calculation Methods:
2773. 	/* AddGap Variants */
2774. 	/* OS Volume Type Method */
2775. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
2776. 	SetVariable(GapRequested, GapRequestedOs)
2777. 
2778. 
2779. 
2780. /* MakeGap Variants */
2781. 
2782. 	/* Original Os 1-3 + MFT 2 */
2783. 		# Gap Calculation Methods:
2784. 	/* MakeGap Variants */
2785. 	/* Original Os 1-3 + MFT 2 */
2786. 	/* plus MFT gap placed inline at the dividing zone. */
2787. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
2788. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
2789. 	SetVariable(GapRequested, GapRequestedOrig)
2790. 	
2791. 	
2792. /* Note: You could comment out the ones not in use */
2793. /* However having the data in the log is useful. */
2794. /* Therefore the following line is otherwise needed. */
2795. 
2796. /* Standard used */
2797. 
2798. SetVariable(GapRequested, GapRequestedStd)
2799. 
2800. # Gap Calculation Methods:
2801. 
2802. /* AddGap Variants */
2803. 	/* Standard */
2804. 	/* MFT Low High Method */
2805. 	/* OS Volume Type Method */
2806. 
2807. /* MakeGap Variants */
2808. 	/* Original Os 1-3 + MFT 2 */
2809. 
2810. /* Note: You could comment out the ones not in use */
2811. /* However having the data in the log is useful. */
2812. /* Therefore the following line is otherwise needed. */
2813. 
2814. /* Standard is used currently */
2815. 
2816. 
2817. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
2818. 
2819. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
2820. 
2821. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
2822. 
2823. /* ---------------------------------------------------------- */
2824. /* 3) SMALL ZONE ADJUSTMENT. */
2825. /* Gab cant be larger than half the Zone Size. */
2826. 
2827. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
2828. 	
2829. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
2830. 
2831. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
2832. 
2833. /* ---------------------------------------------------------- */
2834. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
2835. # Gap Adjustments.
2836. 
2837. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
2838. 	
2839. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
2840. 
2841. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
2842. 
2843. /* ---------------------------------------------------------- */
2844. # BYPASS THIS.
2845. 	/* This is definitely wrong. */
2846. 	/* The question is can we steal gap from the next zone */
2847. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
2848. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
2849. 		# Zone Overflow.
2850. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
2851. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
2852. 
2853. /* ---------------------------------------------------------- */
2854. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
2855. # Remaining free space available.
2856. 
2857. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
2858. 	
2859. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
2860. 
2861. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
2862. 
2863. /* ---------------------------------------------------------- */
2864. # CURRENT gap to use.
2865. 
2866. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
2867. 
2868. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
2869. 
2870. /* ---------------------------------------------------------- */
2871. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
2872. # Debugging.
2873. 
2874. 	SetVariable(GapUsed, GapCurrent) // for debugging
2875. 
2876. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
2877. 
2878. 		# Your code HERE
2879. 
2880. /* ---------------------------------------------------------- */
2881. /* 7) YOUR CODE. */
2882. # YOUR CODE HERE:
2883. 	# INPUT: GapCurrent or GapCurrentLoc
2884. 	# OUTPUT: GapUsed...
2885. 
2886. /* ---------------------------------------------------------- */
2887. # Gap Size.
2888. # Actual Size of Gap.
2889. 
2890. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
2891. 
2892. /* ---------------------------------------------------------- */
2893. /* xxxxxxxxxxxxxxxxxxxxxx */
2894. # ADD THE GAP
2895. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
2896. /* xxxxxxxxxxxxxxxxxxxxxx */
2897. 
2898. 	
2899. 	# Zone Statistics	
2900. 	# Script: ZoneDoStatistics
2901. # Zone / Volume Statistics and Display
2902. 		
2903. 	# Accumulate Totals
2904.   	# Script: ZoneDoVolumeTotals
2905. 
2906. /* Current total space used (by Zones and Gaps) */
2907. 
2908. SetVariable(VolumeZoneUsed, GapUsed)
2909. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
2910. /* Percentage */
2911. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
2912. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
2913. 
2914. /* Current total of free space requested */
2915. 
2916. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
2917. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2918. /* Percent. */
2919. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
2920. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2921. 
2922. /* Current total of free space used */
2923. 
2924. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
2925. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
2926. /* Percent */
2927. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
2928. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
2929. 
2930. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
2931. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
2932. /* Xinclude "..\DebugDisplayPause.MyDc"X */
2933. 
2934. 
2935. 	# Current Values
2936. 	# Script: ZoneDoCurrentSet
2937. 
2938. # Cluster, Sector, Block adjust for display.
2939. 	# Bytes per cluster is volume specific.
2940. 
2941. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
2942. 
2943. # Current Zone values.
2944. 	# Begin, end and size.
2945. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
2946. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
2947. 
2948. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
2949. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
2950. 
2951. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
2952. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
2953. 
2954. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
2955. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
2956. 
2957. 	SetVariable(ZoneFragments,				"!ZONE210N!")
2958. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
2959. 		
2960. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
2961. /* identical code to here: (separation not needed. TEST.) */	
2962. 
2963. # Current Gap, Actual and Free Values
2964. 	# Gap
2965. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
2966. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
2967. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
2968. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
2969. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
2970. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
2971. 	
2972. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
2973. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
2974. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
2975. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
2976. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
2977. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
2978. 	
2979. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
2980. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
2981. 	
2982. 	# Actual Size and End
2983. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
2984. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
2985. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
2986. 	
2987. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
2988. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
2989. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
2990. 
2991. # Gap Size & Rounding
2992. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
2993. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
2994. 	
2995. 	# Free Space
2996. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
2997. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
2998. 
2999. 	# Footer:
3000. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
3001. # 2021-11-17 21:08:27
3002. 
3003. SetVariable(ZoneFooter1, "----------------------------------------------------------
3004. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
3005. #
3006. # Xinclude "..\Commands\DateTimeLastLong.txt"X
3007. #
3008. SetVariable(ZoneFooter2, "Statistics Report:
3009. ------------------
3010.    Size:  
3011.    ------------------------
3012.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3013.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3014.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3015. 
3016.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3017.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3018. 
3019.    Location:
3020.    ------------------------
3021.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3022.             Files End: !ZoneEndCurrent!
3023.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3024.       
3025.    Gap Settings:
3026.    ------------------------
3027.          Gap Requested: !ZoneGapSizePer!%
3028.        Volume Rounding: !ZoneVolRoundUpPer!%
3029.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3030.                  
3031.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
3032.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
3033.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
3034.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
3035.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
3036.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
3037.      
3038.    Free Space after Zone:
3039.    ------------------------
3040.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3041.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3042.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3043. 
3044. Directory and Files Select:
3045. ---------------------------
3046. !ZoneTypeSelectCurrent!               
3047. ---------------------------
3048. ----------------------------------------------------------
3049. ")
3050. 
3051. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
3052. 
3053. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
3054. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
3055. RunProgram("..\Commands\WriteDateTime.bat LastZone")
3056. 
3057. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
3058. 
3059. 
3060. 	# Zone Footer Set Statistics Window Text
3061. 
3062. SetStatisticsWindowText("!Heading!
3063. ----------------------------------------------------------
3064. Zones Processed: 
3065. ----------------------------------------------------------
3066. !ZoneListByLine!
3067. ----------------------------------------------------------
3068. Zone Processing Step:
3069. !ZoneStepByLine!    
3070. ----------------------------------------------------------
3071. ----------------------------------------------------------
3072. Current Zone:
3073. !ZoneFooter!
3074. ----------------------------------------------------------
3075. ----------------------------------------------------------
3076. Volume Statistics:
3077. !VolumeStatisticsDetail!
3078. ----------------------------------------------------------
3079. ----------------------------------------------------------
3080. Zone Detailed Report:
3081. ----------------------------------------------------------
3082. !ZoneStatisticsDetail!
3083. ----------------------------------------------------------
3084. ")
3085. 
3086. 
3087. 	
3088.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
3089. 
3090. 	# Add Zone to list of zones for display.
3091. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
3092. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
3093. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
3094. 	# ??? Free Stats?
3095. 	# Footer:
3096. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
3097. # 2021-11-17 21:08:27
3098. 
3099. SetVariable(ZoneFooter1, "----------------------------------------------------------
3100. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
3101. #
3102. # Xinclude "..\Commands\DateTimeLastLong.txt"X
3103. #
3104. SetVariable(ZoneFooter2, "Statistics Report:
3105. ------------------
3106.    Size:  
3107.    ------------------------
3108.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3109.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3110.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3111. 
3112.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3113.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3114. 
3115.    Location:
3116.    ------------------------
3117.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3118.             Files End: !ZoneEndCurrent!
3119.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3120.       
3121.    Gap Settings:
3122.    ------------------------
3123.          Gap Requested: !ZoneGapSizePer!%
3124.        Volume Rounding: !ZoneVolRoundUpPer!%
3125.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3126.                  
3127.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
3128.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
3129.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
3130.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
3131.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
3132.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
3133.      
3134.    Free Space after Zone:
3135.    ------------------------
3136.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3137.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3138.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3139. 
3140. Directory and Files Select:
3141. ---------------------------
3142. !ZoneTypeSelectCurrent!               
3143. ---------------------------
3144. ----------------------------------------------------------
3145. ")
3146. 
3147. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
3148. 
3149. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
3150. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
3151. RunProgram("..\Commands\WriteDateTime.bat LastZone")
3152. 
3153. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
3154. 
3155. 
3156. 
3157. 	# Add Zone Details to Report.	
3158. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
3159. !ZoneFooter!")
3160. 
3161. 
3162. 	
3163. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionStart!")
3164. 			# Script: DisplaySetFileStep
3165. 
3166. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3167. 
3168. /* add message and move to a new line. */
3169. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3170. ")
3171. 
3172. /* display the line. (hopefully.) */
3173. # Zone Footer Set Statistics Window Text
3174. 
3175. SetStatisticsWindowText("!Heading!
3176. ----------------------------------------------------------
3177. Zones Processed: 
3178. ----------------------------------------------------------
3179. !ZoneListByLine!
3180. ----------------------------------------------------------
3181. Zone Processing Step:
3182. !ZoneStepByLine!    
3183. ----------------------------------------------------------
3184. ----------------------------------------------------------
3185. Current Zone:
3186. !ZoneFooter!
3187. ----------------------------------------------------------
3188. ----------------------------------------------------------
3189. Volume Statistics:
3190. !VolumeStatisticsDetail!
3191. ----------------------------------------------------------
3192. ----------------------------------------------------------
3193. Zone Detailed Report:
3194. ----------------------------------------------------------
3195. !ZoneStatisticsDetail!
3196. ----------------------------------------------------------
3197. ")
3198. 
3199. 
3200. 
3201. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3202. 
3203. # Script: BannerSet
3204. 
3205. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3206. 
3207. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
3208. 
3209. Title('!Heading!')
3210. /* pause(1) */
3211. 
3212. /* NOTE: Can't round or truncate to integer precision. */
3213. 
3214. pause(1)
3215. 	
3216. 			# File Action - Os Boot - Regular -  SortByName.
3217. # File Action - SortByImportSequence.
3218. SortByImportSequence(Ascending ) 
3219. 	
3220. 	
3221. 
3222. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionEnd!")
3223. 			# Script: DisplaySetFileStep
3224. 
3225. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3226. 
3227. /* add message and move to a new line. */
3228. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3229. ")
3230. 
3231. /* display the line. (hopefully.) */
3232. # Zone Footer Set Statistics Window Text
3233. 
3234. SetStatisticsWindowText("!Heading!
3235. ----------------------------------------------------------
3236. Zones Processed: 
3237. ----------------------------------------------------------
3238. !ZoneListByLine!
3239. ----------------------------------------------------------
3240. Zone Processing Step:
3241. !ZoneStepByLine!    
3242. ----------------------------------------------------------
3243. ----------------------------------------------------------
3244. Current Zone:
3245. !ZoneFooter!
3246. ----------------------------------------------------------
3247. ----------------------------------------------------------
3248. Volume Statistics:
3249. !VolumeStatisticsDetail!
3250. ----------------------------------------------------------
3251. ----------------------------------------------------------
3252. Zone Detailed Report:
3253. ----------------------------------------------------------
3254. !ZoneStatisticsDetail!
3255. ----------------------------------------------------------
3256. ")
3257. 
3258. 
3259. 
3260. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3261. 
3262. # Script: BannerSet
3263. 
3264. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3265. 
3266. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
3267. 
3268. Title('!Heading!')
3269. /* pause(1) */
3270. 
3271. /* NOTE: Can't round or truncate to integer precision. */
3272. 
3273. pause(1)
3274. 
3275. 		# Script: ZoneDoFooter
3276. 
3277. /* ---------------------------------------------------------- */
3278. # File Select
3279. 	# Select Statments
3280. # File Actions 
3281. 	# Standard or OS File Actions.
3282. 	# Resume...
3283. 	
3284. 	# your stuff HERE (X)... post zone (file) file actions code.
3285. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
3286. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3287. 		# (X)
3288. 		
3289. 		/* ??? Set window? */
3290. 	
3291. 	# ADD THE GAP
3292. # Vacate (good for diagnostics)
3293. # DoNotVacate - DO NOT Vacate (recommended)
3294. # DoNotVacate - DO NOT Vacate (recommended)
3295. 
3296. # Vacate
3297. /* AddGap(GapUsedLoc) */
3298. 
3299. # DO Not Vacate
3300. AddGap(GapUsedLoc, DoNotVacate) 
3301. 	
3302. 	
3303. # Script: GapZoneCommand
3304. # *** Moved to setting yours ***
3305. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
3306. # Controlled via settings commands
3307. # DoNotVacate - DO NOT Vacate (recommended)
3308. 
3309. # Vacate
3310. /* AddGap(GapUsedLoc) */
3311. 
3312. # DO Not Vacate
3313. AddGap(GapUsedLoc, DoNotVacate) 
3314. 	
3315. 	
3316. # Vacate /* AddGap(GapUsed) */
3317. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
3318. 	
3319. 
3320. 		
3321. # 
3322. FileEnd
3323. /* ---------------------------------------------------------- */
3324. 
3325. # your stuff HERE (X)... post zone (file) code.
3326. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
3327. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3328. 	# (X)
3329. 
3330. SetVariable(FileStepDescription,"Zone finished, reporting.")
3331. # Script: DisplaySetFileStep
3332. 
3333. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3334. 
3335. /* add message and move to a new line. */
3336. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3337. ")
3338. 
3339. /* display the line. (hopefully.) */
3340. # Zone Footer Set Statistics Window Text
3341. 
3342. SetStatisticsWindowText("!Heading!
3343. ----------------------------------------------------------
3344. Zones Processed: 
3345. ----------------------------------------------------------
3346. !ZoneListByLine!
3347. ----------------------------------------------------------
3348. Zone Processing Step:
3349. !ZoneStepByLine!    
3350. ----------------------------------------------------------
3351. ----------------------------------------------------------
3352. Current Zone:
3353. !ZoneFooter!
3354. ----------------------------------------------------------
3355. ----------------------------------------------------------
3356. Volume Statistics:
3357. !VolumeStatisticsDetail!
3358. ----------------------------------------------------------
3359. ----------------------------------------------------------
3360. Zone Detailed Report:
3361. ----------------------------------------------------------
3362. !ZoneStatisticsDetail!
3363. ----------------------------------------------------------
3364. ")
3365. 
3366. 
3367. 
3368. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3369. 
3370. # Script: BannerSet
3371. 
3372. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3373. 
3374. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
3375. 
3376. Title('!Heading!')
3377. /* pause(1) */
3378. 
3379. /* NOTE: Can't round or truncate to integer precision. */
3380. 
3381. pause(1)
3382. 
3383. # Script: ZoneWhenFinished
3384. 
3385. # Script: BannerSet
3386. 
3387. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3388. 
3389. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
3390. 
3391. Title('!Heading!')
3392. /* pause(1) */
3393. 
3394. /* NOTE: Can't round or truncate to integer precision. */
3395. 
3396. # Script: BannerLog
3397. 
3398. AppendLogfile("!LogFileName!", "!Title!")
3399. 
3400. 
3401. 
3402. # Zone Statistics	
3403. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
3404. 
3405. # Footer:
3406. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
3407. # 2021-11-17 21:08:27
3408. 
3409. SetVariable(ZoneFooter1, "----------------------------------------------------------
3410. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
3411. #
3412. # Xinclude "..\Commands\DateTimeLastLong.txt"X
3413. #
3414. SetVariable(ZoneFooter2, "Statistics Report:
3415. ------------------
3416.    Size:  
3417.    ------------------------
3418.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3419.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3420.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3421. 
3422.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3423.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3424. 
3425.    Location:
3426.    ------------------------
3427.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3428.             Files End: !ZoneEndCurrent!
3429.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3430.       
3431.    Gap Settings:
3432.    ------------------------
3433.          Gap Requested: !ZoneGapSizePer!%
3434.        Volume Rounding: !ZoneVolRoundUpPer!%
3435.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3436.                  
3437.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
3438.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
3439.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
3440.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
3441.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
3442.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
3443.      
3444.    Free Space after Zone:
3445.    ------------------------
3446.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3447.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3448.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3449. 
3450. Directory and Files Select:
3451. ---------------------------
3452. !ZoneTypeSelectCurrent!               
3453. ---------------------------
3454. ----------------------------------------------------------
3455. ")
3456. 
3457. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
3458. 
3459. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
3460. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
3461. RunProgram("..\Commands\WriteDateTime.bat LastZone")
3462. 
3463. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
3464. 
3465. 
3466. 
3467. AppendLogfile("!LogFileName!", ".")
3468. AppendLogfile("!LogFileName!", "!ZoneFooter!")
3469. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
3470. AppendLogfile("!LogFileName!", ".")
3471. 
3472. # Zone Footer Set Statistics Window Text
3473. 
3474. SetStatisticsWindowText("!Heading!
3475. ----------------------------------------------------------
3476. Zones Processed: 
3477. ----------------------------------------------------------
3478. !ZoneListByLine!
3479. ----------------------------------------------------------
3480. Zone Processing Step:
3481. !ZoneStepByLine!    
3482. ----------------------------------------------------------
3483. ----------------------------------------------------------
3484. Current Zone:
3485. !ZoneFooter!
3486. ----------------------------------------------------------
3487. ----------------------------------------------------------
3488. Volume Statistics:
3489. !VolumeStatisticsDetail!
3490. ----------------------------------------------------------
3491. ----------------------------------------------------------
3492. Zone Detailed Report:
3493. ----------------------------------------------------------
3494. !ZoneStatisticsDetail!
3495. ----------------------------------------------------------
3496. ")
3497. 
3498. 
3499. 
3500. /* pause() */
3501. /* pause() */
3502. 
3503. 
3504. 
3505. 
3506. /* ---------------------------------------------------------- */
3507. # Zone 2 Boot Data (Variable and other).
3508. 	# Script: DisplayColors - Zone Dark
3509. # Processed
3510. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
3511. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
3512. 
3513. # Light Green and Yellow
3514. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
3515. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
3516. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
3517. 
3518. 	SetVariable(ZoneLabel, 			"!ZoneLabelBootData!")
3519. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBootData!")
3520. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
3521. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
3522. 	SetVariable(ZoneTypeSelect,'
3523.                 # Boot - Data files.
3524.                 not(
3525.                      # Os PageHiberDump start.
3526. (
3527.   FileName("DataStore.edb")
3528.   or FileName("DUMP*.*")
3529.   or FileName("Hiberfil.sys")
3530.   or FileName("MEMORY.DMP")
3531.   or FileName("Pagefile.sys")
3532. )
3533. # Os PageHiberDump end.
3534. 
3535.                 )
3536. ')
3537. 
3538. 		# Script: ZoneDoHeader
3539. 
3540. # Script: ZoneWhenStarted
3541. RunProgram("..\Commands\WriteDateTime.bat")
3542. 
3543. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
3544. # Script: DisplaySetZone
3545. 
3546. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
3547. SetVariable(FileStepDescription,	"")
3548. 
3549. SetVariable(ZoneStepByLine, 			"Zone started.
3550. ")
3551. 
3552. # Script: BannerDescriptionSet
3553. 
3554. # Script: BannerSet
3555. 
3556. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3557. 
3558. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
3559. 
3560. Title('!Heading!')
3561. /* pause(1) */
3562. 
3563. /* NOTE: Can't round or truncate to integer precision. */
3564. 
3565. # Script: BannerLog
3566. 
3567. AppendLogfile("!LogFileName!", "!Title!")
3568. 
3569. 
3570. 
3571. pause(1)
3572. 
3573. 
3574. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
3575. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
3576. 
3577. SetVariable(ZoneStepNoCurrent, 0)
3578. 
3579. 
3580. # Script: ZoneDoCurrentClear
3581. 
3582. SetVariable(ZoneTypeSelectCurrent, 		"")
3583. 
3584. SetVariable(ZoneBeginCurrent, 			0)
3585. SetVariable(ZoneBeginPerCurrent, 		0)
3586. SetVariable(ZoneEndCurrent, 			0)
3587. SetVariable(ZoneEndPerCurrent, 			0)
3588. 
3589. SetVariable(ZoneSizeCurrent,			0)
3590. SetVariable(ZoneSizePerCurrent,			0)
3591. 
3592. SetVariable(ZoneGapRequestedCurrent,	0)
3593. SetVariable(ZoneGapRoundedCurrent, 		0)
3594. SetVariable(ZoneGapAdjustedCurrent, 	0)
3595. SetVariable(ZoneGapAvailableCurrent, 	0)
3596. SetVariable(ZoneGapCurrent,				0)
3597. SetVariable(ZoneGapUsedCurrent, 		0)
3598. 
3599. SetVariable(ZoneGapActualCurrent, 		0)
3600. SetVariable(ZoneGapActualPerCurrent, 	0)
3601. 
3602. SetVariable(ZoneSizeActual, 			0)
3603. SetVariable(ZoneSizeActualCurrent,		0)
3604. 
3605. SetVariable(ZoneEndActual, 				0)
3606. SetVariable(ZoneEndActualCurrent,		0)			
3607. SetVariable(ZoneSizeActualPerCurrent, 	0)
3608.       
3609. SetVariable(ZoneFilesFolders,			0)
3610. SetVariable(ZoneFilesFoldersPer,		0) 
3611. 
3612. SetVariable(ZoneFragments,				0)
3613. SetVariable(ZoneFragmentsPer,			0) 
3614. 		
3615. SetVariable(ZoneEndActualCurrent, 		0)
3616. SetVariable(ZoneEndActualPerCurrent, 	0)
3617. 
3618. # Gap Calculation Methodology:
3619. 	# Requested
3620. 	SetVariable(GapRequested, 			0) 
3621. 	SetVariable(GapRequestedStd, 		0) 
3622. 	SetVariable(GapRequestedMft, 		0) 
3623. 	SetVariable(GapRequestedOs, 		0) 
3624. 	SetVariable(GapRequestedOriginal, 	0) 
3625. 	
3626. 	# Gap Adjustments
3627. 	SetVariable(GapRounded, 			0)
3628. 	# SetVariable(GapAdjusted, 			0)
3629. 	SetVariable(GapAvailable, 			0)
3630. 	SetVariable(GapCurrent, 			0)
3631. 	SetVariable(GapActual, 				0)
3632. 	SetVariable(GapUsed, 				0)
3633. 	
3634. 	# Gap Adjustments
3635. 	SetVariable(GapRoundedLoc, 			0)
3636. 	# SetVariable(GapAdjustedLoc, 		0)
3637. 	SetVariable(GapAvailableLoc, 		0)
3638. 	SetVariable(GapCurrentLoc, 			0)
3639. 	SetVariable(GapActualLoc,			0)
3640. 	SetVariable(GapUsedLoc,				0)
3641. 	
3642. 	# Space usage
3643. 	SetVariable(ZoneFreePerRequested, 	0)
3644. 	SetVariable(ZoneFreePerUsed, 		0)
3645. 
3646. # Gap Size & Rounding
3647. 	SetVariable(ZoneGapSizePer, 		0)
3648. 	SetVariable(ZoneVolRoundUpPer, 		0)
3649. 	
3650. 	# Free Space
3651. 	SetVariable(ZoneFreeUsedPer, 		0)
3652. 	SetVariable(ZoneFreeRequestedPer, 	0)
3653. 
3654. 
3655. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
3656. 
3657. # Footer:
3658. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
3659. # 2021-11-17 21:08:27
3660. 
3661. SetVariable(ZoneFooter1, "----------------------------------------------------------
3662. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
3663. #
3664. # Xinclude "..\Commands\DateTimeLastLong.txt"X
3665. #
3666. SetVariable(ZoneFooter2, "Statistics Report:
3667. ------------------
3668.    Size:  
3669.    ------------------------
3670.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3671.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3672.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3673. 
3674.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3675.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3676. 
3677.    Location:
3678.    ------------------------
3679.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3680.             Files End: !ZoneEndCurrent!
3681.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3682.       
3683.    Gap Settings:
3684.    ------------------------
3685.          Gap Requested: !ZoneGapSizePer!%
3686.        Volume Rounding: !ZoneVolRoundUpPer!%
3687.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3688.                  
3689.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
3690.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
3691.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
3692.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
3693.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
3694.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
3695.      
3696.    Free Space after Zone:
3697.    ------------------------
3698.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3699.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3700.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3701. 
3702. Directory and Files Select:
3703. ---------------------------
3704. !ZoneTypeSelectCurrent!               
3705. ---------------------------
3706. ----------------------------------------------------------
3707. ")
3708. 
3709. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
3710. 
3711. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
3712. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
3713. RunProgram("..\Commands\WriteDateTime.bat LastZone")
3714. 
3715. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
3716. 
3717. 
3718. 
3719. # Script: BannerSet
3720. 
3721. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3722. 
3723. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
3724. 
3725. Title('!Heading!')
3726. /* pause(1) */
3727. 
3728. /* NOTE: Can't round or truncate to integer precision. */
3729. 
3730. # Script: BannerLog
3731. 
3732. AppendLogfile("!LogFileName!", "!Title!")
3733. 
3734. 
3735. 
3736. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
3737. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
3738. 
3739. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
3740. 
3741. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:27")
3742. 
3743. # 2021-11-17 21:08:27 
3744. SetVariable(Temp9, DATETIME)
3745. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:02 !ZoneLabel! !ZoneDescription!")
3746. 
3747. SetVariable(ZoneListByLine, "!ZoneListByLine! 
3748. Zone: !ZoneNoCurrent! !Temp9! 0:00:02 !ZoneLabel! !ZoneDescription!")
3749. 
3750. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:02 !ZoneLabel! !ZoneDescription!")
3751. 
3752. 
3753. /* Fixed Zone Position Handling */
3754. /* Literal number: */
3755. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
3756. /* Percentage of disk: */
3757. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
3758. /* Gap */
3759. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
3760. 
3761. /* ---------------------------------------------------------- */
3762. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
3763. # Script: DisplaySetFileStep
3764. 
3765. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3766. 
3767. /* add message and move to a new line. */
3768. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3769. ")
3770. 
3771. /* display the line. (hopefully.) */
3772. # Zone Footer Set Statistics Window Text
3773. 
3774. SetStatisticsWindowText("!Heading!
3775. ----------------------------------------------------------
3776. Zones Processed: 
3777. ----------------------------------------------------------
3778. !ZoneListByLine!
3779. ----------------------------------------------------------
3780. Zone Processing Step:
3781. !ZoneStepByLine!    
3782. ----------------------------------------------------------
3783. ----------------------------------------------------------
3784. Current Zone:
3785. !ZoneFooter!
3786. ----------------------------------------------------------
3787. ----------------------------------------------------------
3788. Volume Statistics:
3789. !VolumeStatisticsDetail!
3790. ----------------------------------------------------------
3791. ----------------------------------------------------------
3792. Zone Detailed Report:
3793. ----------------------------------------------------------
3794. !ZoneStatisticsDetail!
3795. ----------------------------------------------------------
3796. ")
3797. 
3798. 
3799. 
3800. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3801. 
3802. # Script: BannerSet
3803. 
3804. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3805. 
3806. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
3807. 
3808. Title('!Heading!')
3809. /* pause(1) */
3810. 
3811. /* NOTE: Can't round or truncate to integer precision. */
3812. 
3813. pause(1)
3814. 
3815. # your stuff HERE (X)... pre file select code.
3816. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
3817. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3818. 	# (X)
3819. 
3820. FileSelect
3821. 
3822. 	# your stuff can't really go here (errors.)
3823. 	# maybe for some reason I don't know of...
3824. 	
3825. 	# Actions next...
3826. 		# Script: ZoneDo ZoneTypeSelectOsBoot
3827. # Boot start.
3828. ImportListFromBootOptimize()
3829. # Boot end.
3830. 
3831. 		and not(
3832. 			# Os PageHiberDump start.
3833. (
3834.   FileName("DataStore.edb")
3835.   or FileName("DUMP*.*")
3836.   or FileName("Hiberfil.sys")
3837.   or FileName("MEMORY.DMP")
3838.   or FileName("Pagefile.sys")
3839. )
3840. # Os PageHiberDump end.
3841. 
3842. 		)
3843. 
3844. 	FileActions
3845. 		  		/* ---------------------------------------------------------- */
3846. 	# Gap
3847. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
3848. 		# Script: DisplaySetFileStep
3849. 
3850. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3851. 
3852. /* add message and move to a new line. */
3853. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3854. ")
3855. 
3856. /* display the line. (hopefully.) */
3857. # Zone Footer Set Statistics Window Text
3858. 
3859. SetStatisticsWindowText("!Heading!
3860. ----------------------------------------------------------
3861. Zones Processed: 
3862. ----------------------------------------------------------
3863. !ZoneListByLine!
3864. ----------------------------------------------------------
3865. Zone Processing Step:
3866. !ZoneStepByLine!    
3867. ----------------------------------------------------------
3868. ----------------------------------------------------------
3869. Current Zone:
3870. !ZoneFooter!
3871. ----------------------------------------------------------
3872. ----------------------------------------------------------
3873. Volume Statistics:
3874. !VolumeStatisticsDetail!
3875. ----------------------------------------------------------
3876. ----------------------------------------------------------
3877. Zone Detailed Report:
3878. ----------------------------------------------------------
3879. !ZoneStatisticsDetail!
3880. ----------------------------------------------------------
3881. ")
3882. 
3883. 
3884. 
3885. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3886. 
3887. # Script: BannerSet
3888. 
3889. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
3890. 
3891. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
3892. 
3893. Title('!Heading!')
3894. /* pause(1) */
3895. 
3896. /* NOTE: Can't round or truncate to integer precision. */
3897. 
3898. pause(1)
3899. 	
3900. 	# ACTUAL GAP
3901. 		/* AddGap Variant. */
3902. 	  	# Zone Do Gap
3903. # Gap Calculation Methods:
3904. 
3905. /* 1) Anything you need to add first. */
3906. /* empty */
3907. 
3908. /* ---------------------------------------------------------- */
3909. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
3910. 	# GapRequestedStd.
3911. 
3912. 		/* ---------------------------------------------------------- */
3913. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
3914. 
3915. 		# Gap Calculation Methods:
3916. 
3917. /* AddGap Variants */
3918. 
3919. 	/* Standard */
3920. 		# Gap Calculation Methods:
3921. 	/* AddGap Variants */
3922. 	/* Standard */
3923. 
3924. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
3925. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
3926. 
3927. 	SetVariable(GapRequested, GapRequestedStd)
3928. 	
3929. 
3930. 	/* MFT Low High Method */
3931. 		# Gap Calculation Methods:
3932. 	/* AddGap Variants */
3933. 	/* MFT Low High Method */
3934. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
3935. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
3936. 	SetVariable(GapRequested, GapRequestedMft)
3937. 	
3938. 
3939. 	/* OS Volume Type Method */
3940. 		# Gap Calculation Methods:
3941. 	/* AddGap Variants */
3942. 	/* OS Volume Type Method */
3943. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
3944. 	SetVariable(GapRequested, GapRequestedOs)
3945. 
3946. 
3947. 
3948. /* MakeGap Variants */
3949. 
3950. 	/* Original Os 1-3 + MFT 2 */
3951. 		# Gap Calculation Methods:
3952. 	/* MakeGap Variants */
3953. 	/* Original Os 1-3 + MFT 2 */
3954. 	/* plus MFT gap placed inline at the dividing zone. */
3955. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
3956. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
3957. 	SetVariable(GapRequested, GapRequestedOrig)
3958. 	
3959. 	
3960. /* Note: You could comment out the ones not in use */
3961. /* However having the data in the log is useful. */
3962. /* Therefore the following line is otherwise needed. */
3963. 
3964. /* Standard used */
3965. 
3966. SetVariable(GapRequested, GapRequestedStd)
3967. 
3968. # Gap Calculation Methods:
3969. 
3970. /* AddGap Variants */
3971. 	/* Standard */
3972. 	/* MFT Low High Method */
3973. 	/* OS Volume Type Method */
3974. 
3975. /* MakeGap Variants */
3976. 	/* Original Os 1-3 + MFT 2 */
3977. 
3978. /* Note: You could comment out the ones not in use */
3979. /* However having the data in the log is useful. */
3980. /* Therefore the following line is otherwise needed. */
3981. 
3982. /* Standard is used currently */
3983. 
3984. 
3985. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
3986. 
3987. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
3988. 
3989. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
3990. 
3991. /* ---------------------------------------------------------- */
3992. /* 3) SMALL ZONE ADJUSTMENT. */
3993. /* Gab cant be larger than half the Zone Size. */
3994. 
3995. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
3996. 	
3997. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
3998. 
3999. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
4000. 
4001. /* ---------------------------------------------------------- */
4002. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
4003. # Gap Adjustments.
4004. 
4005. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
4006. 	
4007. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
4008. 
4009. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
4010. 
4011. /* ---------------------------------------------------------- */
4012. # BYPASS THIS.
4013. 	/* This is definitely wrong. */
4014. 	/* The question is can we steal gap from the next zone */
4015. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
4016. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
4017. 		# Zone Overflow.
4018. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
4019. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
4020. 
4021. /* ---------------------------------------------------------- */
4022. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
4023. # Remaining free space available.
4024. 
4025. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
4026. 	
4027. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
4028. 
4029. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
4030. 
4031. /* ---------------------------------------------------------- */
4032. # CURRENT gap to use.
4033. 
4034. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
4035. 
4036. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
4037. 
4038. /* ---------------------------------------------------------- */
4039. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
4040. # Debugging.
4041. 
4042. 	SetVariable(GapUsed, GapCurrent) // for debugging
4043. 
4044. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
4045. 
4046. 		# Your code HERE
4047. 
4048. /* ---------------------------------------------------------- */
4049. /* 7) YOUR CODE. */
4050. # YOUR CODE HERE:
4051. 	# INPUT: GapCurrent or GapCurrentLoc
4052. 	# OUTPUT: GapUsed...
4053. 
4054. /* ---------------------------------------------------------- */
4055. # Gap Size.
4056. # Actual Size of Gap.
4057. 
4058. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
4059. 
4060. /* ---------------------------------------------------------- */
4061. /* xxxxxxxxxxxxxxxxxxxxxx */
4062. # ADD THE GAP
4063. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
4064. /* xxxxxxxxxxxxxxxxxxxxxx */
4065. 
4066. 	
4067. 	# Zone Statistics	
4068. 	# Script: ZoneDoStatistics
4069. # Zone / Volume Statistics and Display
4070. 		
4071. 	# Accumulate Totals
4072.   	# Script: ZoneDoVolumeTotals
4073. 
4074. /* Current total space used (by Zones and Gaps) */
4075. 
4076. SetVariable(VolumeZoneUsed, GapUsed)
4077. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
4078. /* Percentage */
4079. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
4080. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
4081. 
4082. /* Current total of free space requested */
4083. 
4084. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
4085. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
4086. /* Percent. */
4087. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
4088. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
4089. 
4090. /* Current total of free space used */
4091. 
4092. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
4093. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
4094. /* Percent */
4095. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
4096. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
4097. 
4098. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
4099. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
4100. /* Xinclude "..\DebugDisplayPause.MyDc"X */
4101. 
4102. 
4103. 	# Current Values
4104. 	# Script: ZoneDoCurrentSet
4105. 
4106. # Cluster, Sector, Block adjust for display.
4107. 	# Bytes per cluster is volume specific.
4108. 
4109. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
4110. 
4111. # Current Zone values.
4112. 	# Begin, end and size.
4113. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
4114. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
4115. 
4116. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
4117. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
4118. 
4119. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
4120. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
4121. 
4122. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
4123. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
4124. 
4125. 	SetVariable(ZoneFragments,				"!ZONE210N!")
4126. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
4127. 		
4128. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
4129. /* identical code to here: (separation not needed. TEST.) */	
4130. 
4131. # Current Gap, Actual and Free Values
4132. 	# Gap
4133. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
4134. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
4135. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
4136. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
4137. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
4138. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
4139. 	
4140. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
4141. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
4142. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
4143. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
4144. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
4145. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
4146. 	
4147. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
4148. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
4149. 	
4150. 	# Actual Size and End
4151. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
4152. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
4153. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
4154. 	
4155. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
4156. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
4157. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
4158. 
4159. # Gap Size & Rounding
4160. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
4161. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
4162. 	
4163. 	# Free Space
4164. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
4165. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
4166. 
4167. 	# Footer:
4168. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
4169. # 2021-11-17 21:08:27
4170. 
4171. SetVariable(ZoneFooter1, "----------------------------------------------------------
4172. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
4173. #
4174. # Xinclude "..\Commands\DateTimeLastLong.txt"X
4175. #
4176. SetVariable(ZoneFooter2, "Statistics Report:
4177. ------------------
4178.    Size:  
4179.    ------------------------
4180.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4181.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4182.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4183. 
4184.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4185.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4186. 
4187.    Location:
4188.    ------------------------
4189.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4190.             Files End: !ZoneEndCurrent!
4191.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4192.       
4193.    Gap Settings:
4194.    ------------------------
4195.          Gap Requested: !ZoneGapSizePer!%
4196.        Volume Rounding: !ZoneVolRoundUpPer!%
4197.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4198.                  
4199.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
4200.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
4201.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
4202.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
4203.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
4204.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
4205.      
4206.    Free Space after Zone:
4207.    ------------------------
4208.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4209.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4210.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4211. 
4212. Directory and Files Select:
4213. ---------------------------
4214. !ZoneTypeSelectCurrent!               
4215. ---------------------------
4216. ----------------------------------------------------------
4217. ")
4218. 
4219. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
4220. 
4221. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
4222. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
4223. RunProgram("..\Commands\WriteDateTime.bat LastZone")
4224. 
4225. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
4226. 
4227. 
4228. 	# Zone Footer Set Statistics Window Text
4229. 
4230. SetStatisticsWindowText("!Heading!
4231. ----------------------------------------------------------
4232. Zones Processed: 
4233. ----------------------------------------------------------
4234. !ZoneListByLine!
4235. ----------------------------------------------------------
4236. Zone Processing Step:
4237. !ZoneStepByLine!    
4238. ----------------------------------------------------------
4239. ----------------------------------------------------------
4240. Current Zone:
4241. !ZoneFooter!
4242. ----------------------------------------------------------
4243. ----------------------------------------------------------
4244. Volume Statistics:
4245. !VolumeStatisticsDetail!
4246. ----------------------------------------------------------
4247. ----------------------------------------------------------
4248. Zone Detailed Report:
4249. ----------------------------------------------------------
4250. !ZoneStatisticsDetail!
4251. ----------------------------------------------------------
4252. ")
4253. 
4254. 
4255. 	
4256.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
4257. 
4258. 	# Add Zone to list of zones for display.
4259. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
4260. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
4261. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
4262. 	# ??? Free Stats?
4263. 	# Footer:
4264. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
4265. # 2021-11-17 21:08:27
4266. 
4267. SetVariable(ZoneFooter1, "----------------------------------------------------------
4268. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
4269. #
4270. # Xinclude "..\Commands\DateTimeLastLong.txt"X
4271. #
4272. SetVariable(ZoneFooter2, "Statistics Report:
4273. ------------------
4274.    Size:  
4275.    ------------------------
4276.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4277.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4278.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4279. 
4280.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4281.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4282. 
4283.    Location:
4284.    ------------------------
4285.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4286.             Files End: !ZoneEndCurrent!
4287.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4288.       
4289.    Gap Settings:
4290.    ------------------------
4291.          Gap Requested: !ZoneGapSizePer!%
4292.        Volume Rounding: !ZoneVolRoundUpPer!%
4293.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4294.                  
4295.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
4296.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
4297.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
4298.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
4299.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
4300.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
4301.      
4302.    Free Space after Zone:
4303.    ------------------------
4304.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4305.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4306.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4307. 
4308. Directory and Files Select:
4309. ---------------------------
4310. !ZoneTypeSelectCurrent!               
4311. ---------------------------
4312. ----------------------------------------------------------
4313. ")
4314. 
4315. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
4316. 
4317. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
4318. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
4319. RunProgram("..\Commands\WriteDateTime.bat LastZone")
4320. 
4321. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
4322. 
4323. 
4324. 
4325. 	# Add Zone Details to Report.	
4326. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
4327. !ZoneFooter!")
4328. 
4329. 
4330. 	
4331. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
4332. 			# Script: DisplaySetFileStep
4333. 
4334. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4335. 
4336. /* add message and move to a new line. */
4337. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4338. ")
4339. 
4340. /* display the line. (hopefully.) */
4341. # Zone Footer Set Statistics Window Text
4342. 
4343. SetStatisticsWindowText("!Heading!
4344. ----------------------------------------------------------
4345. Zones Processed: 
4346. ----------------------------------------------------------
4347. !ZoneListByLine!
4348. ----------------------------------------------------------
4349. Zone Processing Step:
4350. !ZoneStepByLine!    
4351. ----------------------------------------------------------
4352. ----------------------------------------------------------
4353. Current Zone:
4354. !ZoneFooter!
4355. ----------------------------------------------------------
4356. ----------------------------------------------------------
4357. Volume Statistics:
4358. !VolumeStatisticsDetail!
4359. ----------------------------------------------------------
4360. ----------------------------------------------------------
4361. Zone Detailed Report:
4362. ----------------------------------------------------------
4363. !ZoneStatisticsDetail!
4364. ----------------------------------------------------------
4365. ")
4366. 
4367. 
4368. 
4369. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4370. 
4371. # Script: BannerSet
4372. 
4373. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4374. 
4375. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
4376. 
4377. Title('!Heading!')
4378. /* pause(1) */
4379. 
4380. /* NOTE: Can't round or truncate to integer precision. */
4381. 
4382. pause(1)
4383. 
4384. 			# File Action - Os Boot - Regular -  SortByName.
4385. # File Action - SortByName.
4386. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
4387. 	
4388. 	
4389. 	
4390. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
4391. 			# Script: DisplaySetFileStep
4392. 
4393. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4394. 
4395. /* add message and move to a new line. */
4396. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4397. ")
4398. 
4399. /* display the line. (hopefully.) */
4400. # Zone Footer Set Statistics Window Text
4401. 
4402. SetStatisticsWindowText("!Heading!
4403. ----------------------------------------------------------
4404. Zones Processed: 
4405. ----------------------------------------------------------
4406. !ZoneListByLine!
4407. ----------------------------------------------------------
4408. Zone Processing Step:
4409. !ZoneStepByLine!    
4410. ----------------------------------------------------------
4411. ----------------------------------------------------------
4412. Current Zone:
4413. !ZoneFooter!
4414. ----------------------------------------------------------
4415. ----------------------------------------------------------
4416. Volume Statistics:
4417. !VolumeStatisticsDetail!
4418. ----------------------------------------------------------
4419. ----------------------------------------------------------
4420. Zone Detailed Report:
4421. ----------------------------------------------------------
4422. !ZoneStatisticsDetail!
4423. ----------------------------------------------------------
4424. ")
4425. 
4426. 
4427. 
4428. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4429. 
4430. # Script: BannerSet
4431. 
4432. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4433. 
4434. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
4435. 
4436. Title('!Heading!')
4437. /* pause(1) */
4438. 
4439. /* NOTE: Can't round or truncate to integer precision. */
4440. 
4441. pause(1)
4442. 
4443. 		# Script: ZoneDoFooter
4444. 
4445. /* ---------------------------------------------------------- */
4446. # File Select
4447. 	# Select Statments
4448. # File Actions 
4449. 	# Standard or OS File Actions.
4450. 	# Resume...
4451. 	
4452. 	# your stuff HERE (X)... post zone (file) file actions code.
4453. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
4454. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4455. 		# (X)
4456. 		
4457. 		/* ??? Set window? */
4458. 	
4459. 	# ADD THE GAP
4460. # Vacate (good for diagnostics)
4461. # DoNotVacate - DO NOT Vacate (recommended)
4462. # DoNotVacate - DO NOT Vacate (recommended)
4463. 
4464. # Vacate
4465. /* AddGap(GapUsedLoc) */
4466. 
4467. # DO Not Vacate
4468. AddGap(GapUsedLoc, DoNotVacate) 
4469. 	
4470. 	
4471. # Script: GapZoneCommand
4472. # *** Moved to setting yours ***
4473. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
4474. # Controlled via settings commands
4475. # DoNotVacate - DO NOT Vacate (recommended)
4476. 
4477. # Vacate
4478. /* AddGap(GapUsedLoc) */
4479. 
4480. # DO Not Vacate
4481. AddGap(GapUsedLoc, DoNotVacate) 
4482. 	
4483. 	
4484. # Vacate /* AddGap(GapUsed) */
4485. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
4486. 	
4487. 
4488. 		
4489. # 
4490. FileEnd
4491. /* ---------------------------------------------------------- */
4492. 
4493. # your stuff HERE (X)... post zone (file) code.
4494. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
4495. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4496. 	# (X)
4497. 
4498. SetVariable(FileStepDescription,"Zone finished, reporting.")
4499. # Script: DisplaySetFileStep
4500. 
4501. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4502. 
4503. /* add message and move to a new line. */
4504. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4505. ")
4506. 
4507. /* display the line. (hopefully.) */
4508. # Zone Footer Set Statistics Window Text
4509. 
4510. SetStatisticsWindowText("!Heading!
4511. ----------------------------------------------------------
4512. Zones Processed: 
4513. ----------------------------------------------------------
4514. !ZoneListByLine!
4515. ----------------------------------------------------------
4516. Zone Processing Step:
4517. !ZoneStepByLine!    
4518. ----------------------------------------------------------
4519. ----------------------------------------------------------
4520. Current Zone:
4521. !ZoneFooter!
4522. ----------------------------------------------------------
4523. ----------------------------------------------------------
4524. Volume Statistics:
4525. !VolumeStatisticsDetail!
4526. ----------------------------------------------------------
4527. ----------------------------------------------------------
4528. Zone Detailed Report:
4529. ----------------------------------------------------------
4530. !ZoneStatisticsDetail!
4531. ----------------------------------------------------------
4532. ")
4533. 
4534. 
4535. 
4536. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4537. 
4538. # Script: BannerSet
4539. 
4540. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4541. 
4542. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
4543. 
4544. Title('!Heading!')
4545. /* pause(1) */
4546. 
4547. /* NOTE: Can't round or truncate to integer precision. */
4548. 
4549. pause(1)
4550. 
4551. # Script: ZoneWhenFinished
4552. 
4553. # Script: BannerSet
4554. 
4555. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4556. 
4557. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
4558. 
4559. Title('!Heading!')
4560. /* pause(1) */
4561. 
4562. /* NOTE: Can't round or truncate to integer precision. */
4563. 
4564. # Script: BannerLog
4565. 
4566. AppendLogfile("!LogFileName!", "!Title!")
4567. 
4568. 
4569. 
4570. # Zone Statistics	
4571. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
4572. 
4573. # Footer:
4574. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
4575. # 2021-11-17 21:08:27
4576. 
4577. SetVariable(ZoneFooter1, "----------------------------------------------------------
4578. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
4579. #
4580. # Xinclude "..\Commands\DateTimeLastLong.txt"X
4581. #
4582. SetVariable(ZoneFooter2, "Statistics Report:
4583. ------------------
4584.    Size:  
4585.    ------------------------
4586.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4587.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4588.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4589. 
4590.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4591.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4592. 
4593.    Location:
4594.    ------------------------
4595.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4596.             Files End: !ZoneEndCurrent!
4597.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4598.       
4599.    Gap Settings:
4600.    ------------------------
4601.          Gap Requested: !ZoneGapSizePer!%
4602.        Volume Rounding: !ZoneVolRoundUpPer!%
4603.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4604.                  
4605.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
4606.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
4607.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
4608.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
4609.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
4610.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
4611.      
4612.    Free Space after Zone:
4613.    ------------------------
4614.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4615.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4616.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4617. 
4618. Directory and Files Select:
4619. ---------------------------
4620. !ZoneTypeSelectCurrent!               
4621. ---------------------------
4622. ----------------------------------------------------------
4623. ")
4624. 
4625. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
4626. 
4627. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
4628. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
4629. RunProgram("..\Commands\WriteDateTime.bat LastZone")
4630. 
4631. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
4632. 
4633. 
4634. 
4635. AppendLogfile("!LogFileName!", ".")
4636. AppendLogfile("!LogFileName!", "!ZoneFooter!")
4637. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
4638. AppendLogfile("!LogFileName!", ".")
4639. 
4640. # Zone Footer Set Statistics Window Text
4641. 
4642. SetStatisticsWindowText("!Heading!
4643. ----------------------------------------------------------
4644. Zones Processed: 
4645. ----------------------------------------------------------
4646. !ZoneListByLine!
4647. ----------------------------------------------------------
4648. Zone Processing Step:
4649. !ZoneStepByLine!    
4650. ----------------------------------------------------------
4651. ----------------------------------------------------------
4652. Current Zone:
4653. !ZoneFooter!
4654. ----------------------------------------------------------
4655. ----------------------------------------------------------
4656. Volume Statistics:
4657. !VolumeStatisticsDetail!
4658. ----------------------------------------------------------
4659. ----------------------------------------------------------
4660. Zone Detailed Report:
4661. ----------------------------------------------------------
4662. !ZoneStatisticsDetail!
4663. ----------------------------------------------------------
4664. ")
4665. 
4666. 
4667. 
4668. /* pause() */
4669. /* pause() */
4670. 
4671. 
4672. 
4673. 
4674. /* ---------------------------------------------------------- */
4675. 
4676. 
4677. /* ---------------------------------------------------------- */
4678. # Zone ProgramHints Fixed and Data
4679. # Os Group Zone 3 & 4
4680. # Script: DefragZoneTypeOsProgramHints
4681. /* ---------------------------------------------------------- */
4682. # Zone 1 of 2 ProgramHints Fixed.
4683. 	# Script: DisplayColors - Zone Dark
4684. # Processed
4685. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
4686. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
4687. 
4688. # Light Green and Yellow
4689. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
4690. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
4691. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
4692. 
4693. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHints!")
4694. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHints!")
4695. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
4696. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHints!")
4697. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsProgramHints
4698. # ProgramHints start.
4699. ImportListFromProgramHints("*.pf")
4700. # ProgramHints end.
4701. ')
4702. 
4703. 		# Script: ZoneDoHeader
4704. 
4705. # Script: ZoneWhenStarted
4706. RunProgram("..\Commands\WriteDateTime.bat")
4707. 
4708. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
4709. # Script: DisplaySetZone
4710. 
4711. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
4712. SetVariable(FileStepDescription,	"")
4713. 
4714. SetVariable(ZoneStepByLine, 			"Zone started.
4715. ")
4716. 
4717. # Script: BannerDescriptionSet
4718. 
4719. # Script: BannerSet
4720. 
4721. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4722. 
4723. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
4724. 
4725. Title('!Heading!')
4726. /* pause(1) */
4727. 
4728. /* NOTE: Can't round or truncate to integer precision. */
4729. 
4730. # Script: BannerLog
4731. 
4732. AppendLogfile("!LogFileName!", "!Title!")
4733. 
4734. 
4735. 
4736. pause(1)
4737. 
4738. 
4739. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
4740. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
4741. 
4742. SetVariable(ZoneStepNoCurrent, 0)
4743. 
4744. 
4745. # Script: ZoneDoCurrentClear
4746. 
4747. SetVariable(ZoneTypeSelectCurrent, 		"")
4748. 
4749. SetVariable(ZoneBeginCurrent, 			0)
4750. SetVariable(ZoneBeginPerCurrent, 		0)
4751. SetVariable(ZoneEndCurrent, 			0)
4752. SetVariable(ZoneEndPerCurrent, 			0)
4753. 
4754. SetVariable(ZoneSizeCurrent,			0)
4755. SetVariable(ZoneSizePerCurrent,			0)
4756. 
4757. SetVariable(ZoneGapRequestedCurrent,	0)
4758. SetVariable(ZoneGapRoundedCurrent, 		0)
4759. SetVariable(ZoneGapAdjustedCurrent, 	0)
4760. SetVariable(ZoneGapAvailableCurrent, 	0)
4761. SetVariable(ZoneGapCurrent,				0)
4762. SetVariable(ZoneGapUsedCurrent, 		0)
4763. 
4764. SetVariable(ZoneGapActualCurrent, 		0)
4765. SetVariable(ZoneGapActualPerCurrent, 	0)
4766. 
4767. SetVariable(ZoneSizeActual, 			0)
4768. SetVariable(ZoneSizeActualCurrent,		0)
4769. 
4770. SetVariable(ZoneEndActual, 				0)
4771. SetVariable(ZoneEndActualCurrent,		0)			
4772. SetVariable(ZoneSizeActualPerCurrent, 	0)
4773.       
4774. SetVariable(ZoneFilesFolders,			0)
4775. SetVariable(ZoneFilesFoldersPer,		0) 
4776. 
4777. SetVariable(ZoneFragments,				0)
4778. SetVariable(ZoneFragmentsPer,			0) 
4779. 		
4780. SetVariable(ZoneEndActualCurrent, 		0)
4781. SetVariable(ZoneEndActualPerCurrent, 	0)
4782. 
4783. # Gap Calculation Methodology:
4784. 	# Requested
4785. 	SetVariable(GapRequested, 			0) 
4786. 	SetVariable(GapRequestedStd, 		0) 
4787. 	SetVariable(GapRequestedMft, 		0) 
4788. 	SetVariable(GapRequestedOs, 		0) 
4789. 	SetVariable(GapRequestedOriginal, 	0) 
4790. 	
4791. 	# Gap Adjustments
4792. 	SetVariable(GapRounded, 			0)
4793. 	# SetVariable(GapAdjusted, 			0)
4794. 	SetVariable(GapAvailable, 			0)
4795. 	SetVariable(GapCurrent, 			0)
4796. 	SetVariable(GapActual, 				0)
4797. 	SetVariable(GapUsed, 				0)
4798. 	
4799. 	# Gap Adjustments
4800. 	SetVariable(GapRoundedLoc, 			0)
4801. 	# SetVariable(GapAdjustedLoc, 		0)
4802. 	SetVariable(GapAvailableLoc, 		0)
4803. 	SetVariable(GapCurrentLoc, 			0)
4804. 	SetVariable(GapActualLoc,			0)
4805. 	SetVariable(GapUsedLoc,				0)
4806. 	
4807. 	# Space usage
4808. 	SetVariable(ZoneFreePerRequested, 	0)
4809. 	SetVariable(ZoneFreePerUsed, 		0)
4810. 
4811. # Gap Size & Rounding
4812. 	SetVariable(ZoneGapSizePer, 		0)
4813. 	SetVariable(ZoneVolRoundUpPer, 		0)
4814. 	
4815. 	# Free Space
4816. 	SetVariable(ZoneFreeUsedPer, 		0)
4817. 	SetVariable(ZoneFreeRequestedPer, 	0)
4818. 
4819. 
4820. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
4821. 
4822. # Footer:
4823. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
4824. # 2021-11-17 21:08:27
4825. 
4826. SetVariable(ZoneFooter1, "----------------------------------------------------------
4827. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
4828. #
4829. # Xinclude "..\Commands\DateTimeLastLong.txt"X
4830. #
4831. SetVariable(ZoneFooter2, "Statistics Report:
4832. ------------------
4833.    Size:  
4834.    ------------------------
4835.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4836.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4837.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4838. 
4839.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4840.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4841. 
4842.    Location:
4843.    ------------------------
4844.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4845.             Files End: !ZoneEndCurrent!
4846.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4847.       
4848.    Gap Settings:
4849.    ------------------------
4850.          Gap Requested: !ZoneGapSizePer!%
4851.        Volume Rounding: !ZoneVolRoundUpPer!%
4852.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4853.                  
4854.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
4855.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
4856.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
4857.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
4858.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
4859.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
4860.      
4861.    Free Space after Zone:
4862.    ------------------------
4863.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4864.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4865.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4866. 
4867. Directory and Files Select:
4868. ---------------------------
4869. !ZoneTypeSelectCurrent!               
4870. ---------------------------
4871. ----------------------------------------------------------
4872. ")
4873. 
4874. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
4875. 
4876. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
4877. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
4878. RunProgram("..\Commands\WriteDateTime.bat LastZone")
4879. 
4880. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
4881. 
4882. 
4883. 
4884. # Script: BannerSet
4885. 
4886. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4887. 
4888. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
4889. 
4890. Title('!Heading!')
4891. /* pause(1) */
4892. 
4893. /* NOTE: Can't round or truncate to integer precision. */
4894. 
4895. # Script: BannerLog
4896. 
4897. AppendLogfile("!LogFileName!", "!Title!")
4898. 
4899. 
4900. 
4901. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
4902. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
4903. 
4904. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
4905. 
4906. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:27")
4907. 
4908. # 2021-11-17 21:08:27 
4909. SetVariable(Temp9, DATETIME)
4910. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:02 !ZoneLabel! !ZoneDescription!")
4911. 
4912. SetVariable(ZoneListByLine, "!ZoneListByLine! 
4913. Zone: !ZoneNoCurrent! !Temp9! 0:00:02 !ZoneLabel! !ZoneDescription!")
4914. 
4915. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:02 !ZoneLabel! !ZoneDescription!")
4916. 
4917. 
4918. /* Fixed Zone Position Handling */
4919. /* Literal number: */
4920. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
4921. /* Percentage of disk: */
4922. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
4923. /* Gap */
4924. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
4925. 
4926. /* ---------------------------------------------------------- */
4927. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
4928. # Script: DisplaySetFileStep
4929. 
4930. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4931. 
4932. /* add message and move to a new line. */
4933. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4934. ")
4935. 
4936. /* display the line. (hopefully.) */
4937. # Zone Footer Set Statistics Window Text
4938. 
4939. SetStatisticsWindowText("!Heading!
4940. ----------------------------------------------------------
4941. Zones Processed: 
4942. ----------------------------------------------------------
4943. !ZoneListByLine!
4944. ----------------------------------------------------------
4945. Zone Processing Step:
4946. !ZoneStepByLine!    
4947. ----------------------------------------------------------
4948. ----------------------------------------------------------
4949. Current Zone:
4950. !ZoneFooter!
4951. ----------------------------------------------------------
4952. ----------------------------------------------------------
4953. Volume Statistics:
4954. !VolumeStatisticsDetail!
4955. ----------------------------------------------------------
4956. ----------------------------------------------------------
4957. Zone Detailed Report:
4958. ----------------------------------------------------------
4959. !ZoneStatisticsDetail!
4960. ----------------------------------------------------------
4961. ")
4962. 
4963. 
4964. 
4965. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4966. 
4967. # Script: BannerSet
4968. 
4969. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
4970. 
4971. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
4972. 
4973. Title('!Heading!')
4974. /* pause(1) */
4975. 
4976. /* NOTE: Can't round or truncate to integer precision. */
4977. 
4978. pause(1)
4979. 
4980. # your stuff HERE (X)... pre file select code.
4981. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
4982. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4983. 	# (X)
4984. 
4985. FileSelect
4986. 
4987. 	# your stuff can't really go here (errors.)
4988. 	# maybe for some reason I don't know of...
4989. 	
4990. 	# Actions next...
4991. 		# Script: ZoneDo ZoneTypeSelectOsProgramHints
4992. # ProgramHints start.
4993. ImportListFromProgramHints("*.pf")
4994. # ProgramHints end.
4995. 
4996. 		and not(
4997. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
4998. # Os Data Dynamic start.
4999. (
5000. # Os Data Dynamic start.
5001. (
5002.   FileName("*.dat*")
5003.   or FileName("*.db*")
5004.   or FileName("*.edb*")
5005.   or FileName("*.log*")
5006.   or FileName("DataStore.edb")
5007. )
5008. # Os Data Dynamic end.
5009. 
5010.   or 
5011. # Os PageHiberDump start.
5012. (
5013.   FileName("DataStore.edb")
5014.   or FileName("DUMP*.*")
5015.   or FileName("Hiberfil.sys")
5016.   or FileName("MEMORY.DMP")
5017.   or FileName("Pagefile.sys")
5018. )
5019. # Os PageHiberDump end.
5020. 
5021. # Os Data Dynamic
5022. )
5023. # Os Data Dynamic end.
5024. 
5025. 		)
5026. 
5027. 		FileActions
5028. 		  		/* ---------------------------------------------------------- */
5029. 	# Gap
5030. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
5031. 		# Script: DisplaySetFileStep
5032. 
5033. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5034. 
5035. /* add message and move to a new line. */
5036. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5037. ")
5038. 
5039. /* display the line. (hopefully.) */
5040. # Zone Footer Set Statistics Window Text
5041. 
5042. SetStatisticsWindowText("!Heading!
5043. ----------------------------------------------------------
5044. Zones Processed: 
5045. ----------------------------------------------------------
5046. !ZoneListByLine!
5047. ----------------------------------------------------------
5048. Zone Processing Step:
5049. !ZoneStepByLine!    
5050. ----------------------------------------------------------
5051. ----------------------------------------------------------
5052. Current Zone:
5053. !ZoneFooter!
5054. ----------------------------------------------------------
5055. ----------------------------------------------------------
5056. Volume Statistics:
5057. !VolumeStatisticsDetail!
5058. ----------------------------------------------------------
5059. ----------------------------------------------------------
5060. Zone Detailed Report:
5061. ----------------------------------------------------------
5062. !ZoneStatisticsDetail!
5063. ----------------------------------------------------------
5064. ")
5065. 
5066. 
5067. 
5068. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5069. 
5070. # Script: BannerSet
5071. 
5072. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5073. 
5074. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
5075. 
5076. Title('!Heading!')
5077. /* pause(1) */
5078. 
5079. /* NOTE: Can't round or truncate to integer precision. */
5080. 
5081. pause(1)
5082. 	
5083. 	# ACTUAL GAP
5084. 		/* AddGap Variant. */
5085. 	  	# Zone Do Gap
5086. # Gap Calculation Methods:
5087. 
5088. /* 1) Anything you need to add first. */
5089. /* empty */
5090. 
5091. /* ---------------------------------------------------------- */
5092. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
5093. 	# GapRequestedStd.
5094. 
5095. 		/* ---------------------------------------------------------- */
5096. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
5097. 
5098. 		# Gap Calculation Methods:
5099. 
5100. /* AddGap Variants */
5101. 
5102. 	/* Standard */
5103. 		# Gap Calculation Methods:
5104. 	/* AddGap Variants */
5105. 	/* Standard */
5106. 
5107. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
5108. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
5109. 
5110. 	SetVariable(GapRequested, GapRequestedStd)
5111. 	
5112. 
5113. 	/* MFT Low High Method */
5114. 		# Gap Calculation Methods:
5115. 	/* AddGap Variants */
5116. 	/* MFT Low High Method */
5117. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
5118. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
5119. 	SetVariable(GapRequested, GapRequestedMft)
5120. 	
5121. 
5122. 	/* OS Volume Type Method */
5123. 		# Gap Calculation Methods:
5124. 	/* AddGap Variants */
5125. 	/* OS Volume Type Method */
5126. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
5127. 	SetVariable(GapRequested, GapRequestedOs)
5128. 
5129. 
5130. 
5131. /* MakeGap Variants */
5132. 
5133. 	/* Original Os 1-3 + MFT 2 */
5134. 		# Gap Calculation Methods:
5135. 	/* MakeGap Variants */
5136. 	/* Original Os 1-3 + MFT 2 */
5137. 	/* plus MFT gap placed inline at the dividing zone. */
5138. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
5139. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
5140. 	SetVariable(GapRequested, GapRequestedOrig)
5141. 	
5142. 	
5143. /* Note: You could comment out the ones not in use */
5144. /* However having the data in the log is useful. */
5145. /* Therefore the following line is otherwise needed. */
5146. 
5147. /* Standard used */
5148. 
5149. SetVariable(GapRequested, GapRequestedStd)
5150. 
5151. # Gap Calculation Methods:
5152. 
5153. /* AddGap Variants */
5154. 	/* Standard */
5155. 	/* MFT Low High Method */
5156. 	/* OS Volume Type Method */
5157. 
5158. /* MakeGap Variants */
5159. 	/* Original Os 1-3 + MFT 2 */
5160. 
5161. /* Note: You could comment out the ones not in use */
5162. /* However having the data in the log is useful. */
5163. /* Therefore the following line is otherwise needed. */
5164. 
5165. /* Standard is used currently */
5166. 
5167. 
5168. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
5169. 
5170. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
5171. 
5172. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
5173. 
5174. /* ---------------------------------------------------------- */
5175. /* 3) SMALL ZONE ADJUSTMENT. */
5176. /* Gab cant be larger than half the Zone Size. */
5177. 
5178. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
5179. 	
5180. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
5181. 
5182. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
5183. 
5184. /* ---------------------------------------------------------- */
5185. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
5186. # Gap Adjustments.
5187. 
5188. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
5189. 	
5190. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
5191. 
5192. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
5193. 
5194. /* ---------------------------------------------------------- */
5195. # BYPASS THIS.
5196. 	/* This is definitely wrong. */
5197. 	/* The question is can we steal gap from the next zone */
5198. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
5199. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
5200. 		# Zone Overflow.
5201. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
5202. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
5203. 
5204. /* ---------------------------------------------------------- */
5205. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
5206. # Remaining free space available.
5207. 
5208. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
5209. 	
5210. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
5211. 
5212. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
5213. 
5214. /* ---------------------------------------------------------- */
5215. # CURRENT gap to use.
5216. 
5217. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
5218. 
5219. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
5220. 
5221. /* ---------------------------------------------------------- */
5222. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
5223. # Debugging.
5224. 
5225. 	SetVariable(GapUsed, GapCurrent) // for debugging
5226. 
5227. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
5228. 
5229. 		# Your code HERE
5230. 
5231. /* ---------------------------------------------------------- */
5232. /* 7) YOUR CODE. */
5233. # YOUR CODE HERE:
5234. 	# INPUT: GapCurrent or GapCurrentLoc
5235. 	# OUTPUT: GapUsed...
5236. 
5237. /* ---------------------------------------------------------- */
5238. # Gap Size.
5239. # Actual Size of Gap.
5240. 
5241. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
5242. 
5243. /* ---------------------------------------------------------- */
5244. /* xxxxxxxxxxxxxxxxxxxxxx */
5245. # ADD THE GAP
5246. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
5247. /* xxxxxxxxxxxxxxxxxxxxxx */
5248. 
5249. 	
5250. 	# Zone Statistics	
5251. 	# Script: ZoneDoStatistics
5252. # Zone / Volume Statistics and Display
5253. 		
5254. 	# Accumulate Totals
5255.   	# Script: ZoneDoVolumeTotals
5256. 
5257. /* Current total space used (by Zones and Gaps) */
5258. 
5259. SetVariable(VolumeZoneUsed, GapUsed)
5260. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
5261. /* Percentage */
5262. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
5263. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
5264. 
5265. /* Current total of free space requested */
5266. 
5267. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
5268. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5269. /* Percent. */
5270. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
5271. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5272. 
5273. /* Current total of free space used */
5274. 
5275. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
5276. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
5277. /* Percent */
5278. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
5279. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
5280. 
5281. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
5282. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
5283. /* Xinclude "..\DebugDisplayPause.MyDc"X */
5284. 
5285. 
5286. 	# Current Values
5287. 	# Script: ZoneDoCurrentSet
5288. 
5289. # Cluster, Sector, Block adjust for display.
5290. 	# Bytes per cluster is volume specific.
5291. 
5292. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
5293. 
5294. # Current Zone values.
5295. 	# Begin, end and size.
5296. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
5297. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
5298. 
5299. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
5300. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
5301. 
5302. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
5303. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
5304. 
5305. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
5306. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
5307. 
5308. 	SetVariable(ZoneFragments,				"!ZONE210N!")
5309. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
5310. 		
5311. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
5312. /* identical code to here: (separation not needed. TEST.) */	
5313. 
5314. # Current Gap, Actual and Free Values
5315. 	# Gap
5316. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
5317. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
5318. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
5319. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
5320. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
5321. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
5322. 	
5323. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
5324. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
5325. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
5326. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
5327. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
5328. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
5329. 	
5330. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
5331. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
5332. 	
5333. 	# Actual Size and End
5334. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
5335. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
5336. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
5337. 	
5338. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
5339. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
5340. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
5341. 
5342. # Gap Size & Rounding
5343. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
5344. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
5345. 	
5346. 	# Free Space
5347. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
5348. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
5349. 
5350. 	# Footer:
5351. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
5352. # 2021-11-17 21:08:27
5353. 
5354. SetVariable(ZoneFooter1, "----------------------------------------------------------
5355. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
5356. #
5357. # Xinclude "..\Commands\DateTimeLastLong.txt"X
5358. #
5359. SetVariable(ZoneFooter2, "Statistics Report:
5360. ------------------
5361.    Size:  
5362.    ------------------------
5363.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5364.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5365.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5366. 
5367.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5368.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5369. 
5370.    Location:
5371.    ------------------------
5372.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5373.             Files End: !ZoneEndCurrent!
5374.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5375.       
5376.    Gap Settings:
5377.    ------------------------
5378.          Gap Requested: !ZoneGapSizePer!%
5379.        Volume Rounding: !ZoneVolRoundUpPer!%
5380.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5381.                  
5382.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
5383.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
5384.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
5385.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
5386.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
5387.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
5388.      
5389.    Free Space after Zone:
5390.    ------------------------
5391.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5392.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5393.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5394. 
5395. Directory and Files Select:
5396. ---------------------------
5397. !ZoneTypeSelectCurrent!               
5398. ---------------------------
5399. ----------------------------------------------------------
5400. ")
5401. 
5402. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
5403. 
5404. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
5405. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
5406. RunProgram("..\Commands\WriteDateTime.bat LastZone")
5407. 
5408. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
5409. 
5410. 
5411. 	# Zone Footer Set Statistics Window Text
5412. 
5413. SetStatisticsWindowText("!Heading!
5414. ----------------------------------------------------------
5415. Zones Processed: 
5416. ----------------------------------------------------------
5417. !ZoneListByLine!
5418. ----------------------------------------------------------
5419. Zone Processing Step:
5420. !ZoneStepByLine!    
5421. ----------------------------------------------------------
5422. ----------------------------------------------------------
5423. Current Zone:
5424. !ZoneFooter!
5425. ----------------------------------------------------------
5426. ----------------------------------------------------------
5427. Volume Statistics:
5428. !VolumeStatisticsDetail!
5429. ----------------------------------------------------------
5430. ----------------------------------------------------------
5431. Zone Detailed Report:
5432. ----------------------------------------------------------
5433. !ZoneStatisticsDetail!
5434. ----------------------------------------------------------
5435. ")
5436. 
5437. 
5438. 	
5439.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
5440. 
5441. 	# Add Zone to list of zones for display.
5442. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
5443. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
5444. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
5445. 	# ??? Free Stats?
5446. 	# Footer:
5447. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
5448. # 2021-11-17 21:08:27
5449. 
5450. SetVariable(ZoneFooter1, "----------------------------------------------------------
5451. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
5452. #
5453. # Xinclude "..\Commands\DateTimeLastLong.txt"X
5454. #
5455. SetVariable(ZoneFooter2, "Statistics Report:
5456. ------------------
5457.    Size:  
5458.    ------------------------
5459.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5460.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5461.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5462. 
5463.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5464.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5465. 
5466.    Location:
5467.    ------------------------
5468.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5469.             Files End: !ZoneEndCurrent!
5470.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5471.       
5472.    Gap Settings:
5473.    ------------------------
5474.          Gap Requested: !ZoneGapSizePer!%
5475.        Volume Rounding: !ZoneVolRoundUpPer!%
5476.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5477.                  
5478.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
5479.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
5480.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
5481.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
5482.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
5483.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
5484.      
5485.    Free Space after Zone:
5486.    ------------------------
5487.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5488.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5489.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5490. 
5491. Directory and Files Select:
5492. ---------------------------
5493. !ZoneTypeSelectCurrent!               
5494. ---------------------------
5495. ----------------------------------------------------------
5496. ")
5497. 
5498. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
5499. 
5500. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
5501. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
5502. RunProgram("..\Commands\WriteDateTime.bat LastZone")
5503. 
5504. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
5505. 
5506. 
5507. 
5508. 	# Add Zone Details to Report.	
5509. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
5510. !ZoneFooter!")
5511. 
5512. 
5513. 		
5514. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
5515. 			# Script: DisplaySetFileStep
5516. 
5517. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5518. 
5519. /* add message and move to a new line. */
5520. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5521. ")
5522. 
5523. /* display the line. (hopefully.) */
5524. # Zone Footer Set Statistics Window Text
5525. 
5526. SetStatisticsWindowText("!Heading!
5527. ----------------------------------------------------------
5528. Zones Processed: 
5529. ----------------------------------------------------------
5530. !ZoneListByLine!
5531. ----------------------------------------------------------
5532. Zone Processing Step:
5533. !ZoneStepByLine!    
5534. ----------------------------------------------------------
5535. ----------------------------------------------------------
5536. Current Zone:
5537. !ZoneFooter!
5538. ----------------------------------------------------------
5539. ----------------------------------------------------------
5540. Volume Statistics:
5541. !VolumeStatisticsDetail!
5542. ----------------------------------------------------------
5543. ----------------------------------------------------------
5544. Zone Detailed Report:
5545. ----------------------------------------------------------
5546. !ZoneStatisticsDetail!
5547. ----------------------------------------------------------
5548. ")
5549. 
5550. 
5551. 
5552. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5553. 
5554. # Script: BannerSet
5555. 
5556. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5557. 
5558. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
5559. 
5560. Title('!Heading!')
5561. /* pause(1) */
5562. 
5563. /* NOTE: Can't round or truncate to integer precision. */
5564. 
5565. pause(1)
5566. 	
5567. 			# File Action - Type Os Program Hints Fixed - Regular - ImportSeq.
5568. # File Action - SortByImportSequence with SkipBlock.
5569. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
5570. 	
5571. # change to Skip 20211109
5572. 
5573. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
5574. 			# Script: DisplaySetFileStep
5575. 
5576. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5577. 
5578. /* add message and move to a new line. */
5579. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5580. ")
5581. 
5582. /* display the line. (hopefully.) */
5583. # Zone Footer Set Statistics Window Text
5584. 
5585. SetStatisticsWindowText("!Heading!
5586. ----------------------------------------------------------
5587. Zones Processed: 
5588. ----------------------------------------------------------
5589. !ZoneListByLine!
5590. ----------------------------------------------------------
5591. Zone Processing Step:
5592. !ZoneStepByLine!    
5593. ----------------------------------------------------------
5594. ----------------------------------------------------------
5595. Current Zone:
5596. !ZoneFooter!
5597. ----------------------------------------------------------
5598. ----------------------------------------------------------
5599. Volume Statistics:
5600. !VolumeStatisticsDetail!
5601. ----------------------------------------------------------
5602. ----------------------------------------------------------
5603. Zone Detailed Report:
5604. ----------------------------------------------------------
5605. !ZoneStatisticsDetail!
5606. ----------------------------------------------------------
5607. ")
5608. 
5609. 
5610. 
5611. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5612. 
5613. # Script: BannerSet
5614. 
5615. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5616. 
5617. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
5618. 
5619. Title('!Heading!')
5620. /* pause(1) */
5621. 
5622. /* NOTE: Can't round or truncate to integer precision. */
5623. 
5624. pause(1)
5625. 
5626. 		# Script: ZoneDoFooter
5627. 
5628. /* ---------------------------------------------------------- */
5629. # File Select
5630. 	# Select Statments
5631. # File Actions 
5632. 	# Standard or OS File Actions.
5633. 	# Resume...
5634. 	
5635. 	# your stuff HERE (X)... post zone (file) file actions code.
5636. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
5637. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5638. 		# (X)
5639. 		
5640. 		/* ??? Set window? */
5641. 	
5642. 	# ADD THE GAP
5643. # Vacate (good for diagnostics)
5644. # DoNotVacate - DO NOT Vacate (recommended)
5645. # DoNotVacate - DO NOT Vacate (recommended)
5646. 
5647. # Vacate
5648. /* AddGap(GapUsedLoc) */
5649. 
5650. # DO Not Vacate
5651. AddGap(GapUsedLoc, DoNotVacate) 
5652. 	
5653. 	
5654. # Script: GapZoneCommand
5655. # *** Moved to setting yours ***
5656. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
5657. # Controlled via settings commands
5658. # DoNotVacate - DO NOT Vacate (recommended)
5659. 
5660. # Vacate
5661. /* AddGap(GapUsedLoc) */
5662. 
5663. # DO Not Vacate
5664. AddGap(GapUsedLoc, DoNotVacate) 
5665. 	
5666. 	
5667. # Vacate /* AddGap(GapUsed) */
5668. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
5669. 	
5670. 
5671. 		
5672. # 
5673. FileEnd
5674. /* ---------------------------------------------------------- */
5675. 
5676. # your stuff HERE (X)... post zone (file) code.
5677. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
5678. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5679. 	# (X)
5680. 
5681. SetVariable(FileStepDescription,"Zone finished, reporting.")
5682. # Script: DisplaySetFileStep
5683. 
5684. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5685. 
5686. /* add message and move to a new line. */
5687. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5688. ")
5689. 
5690. /* display the line. (hopefully.) */
5691. # Zone Footer Set Statistics Window Text
5692. 
5693. SetStatisticsWindowText("!Heading!
5694. ----------------------------------------------------------
5695. Zones Processed: 
5696. ----------------------------------------------------------
5697. !ZoneListByLine!
5698. ----------------------------------------------------------
5699. Zone Processing Step:
5700. !ZoneStepByLine!    
5701. ----------------------------------------------------------
5702. ----------------------------------------------------------
5703. Current Zone:
5704. !ZoneFooter!
5705. ----------------------------------------------------------
5706. ----------------------------------------------------------
5707. Volume Statistics:
5708. !VolumeStatisticsDetail!
5709. ----------------------------------------------------------
5710. ----------------------------------------------------------
5711. Zone Detailed Report:
5712. ----------------------------------------------------------
5713. !ZoneStatisticsDetail!
5714. ----------------------------------------------------------
5715. ")
5716. 
5717. 
5718. 
5719. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5720. 
5721. # Script: BannerSet
5722. 
5723. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5724. 
5725. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
5726. 
5727. Title('!Heading!')
5728. /* pause(1) */
5729. 
5730. /* NOTE: Can't round or truncate to integer precision. */
5731. 
5732. pause(1)
5733. 
5734. # Script: ZoneWhenFinished
5735. 
5736. # Script: BannerSet
5737. 
5738. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5739. 
5740. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
5741. 
5742. Title('!Heading!')
5743. /* pause(1) */
5744. 
5745. /* NOTE: Can't round or truncate to integer precision. */
5746. 
5747. # Script: BannerLog
5748. 
5749. AppendLogfile("!LogFileName!", "!Title!")
5750. 
5751. 
5752. 
5753. # Zone Statistics	
5754. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
5755. 
5756. # Footer:
5757. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
5758. # 2021-11-17 21:08:27
5759. 
5760. SetVariable(ZoneFooter1, "----------------------------------------------------------
5761. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
5762. #
5763. # Xinclude "..\Commands\DateTimeLastLong.txt"X
5764. #
5765. SetVariable(ZoneFooter2, "Statistics Report:
5766. ------------------
5767.    Size:  
5768.    ------------------------
5769.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5770.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5771.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5772. 
5773.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5774.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5775. 
5776.    Location:
5777.    ------------------------
5778.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5779.             Files End: !ZoneEndCurrent!
5780.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5781.       
5782.    Gap Settings:
5783.    ------------------------
5784.          Gap Requested: !ZoneGapSizePer!%
5785.        Volume Rounding: !ZoneVolRoundUpPer!%
5786.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5787.                  
5788.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
5789.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
5790.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
5791.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
5792.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
5793.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
5794.      
5795.    Free Space after Zone:
5796.    ------------------------
5797.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5798.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5799.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5800. 
5801. Directory and Files Select:
5802. ---------------------------
5803. !ZoneTypeSelectCurrent!               
5804. ---------------------------
5805. ----------------------------------------------------------
5806. ")
5807. 
5808. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
5809. 
5810. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
5811. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
5812. RunProgram("..\Commands\WriteDateTime.bat LastZone")
5813. 
5814. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
5815. 
5816. 
5817. 
5818. AppendLogfile("!LogFileName!", ".")
5819. AppendLogfile("!LogFileName!", "!ZoneFooter!")
5820. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
5821. AppendLogfile("!LogFileName!", ".")
5822. 
5823. # Zone Footer Set Statistics Window Text
5824. 
5825. SetStatisticsWindowText("!Heading!
5826. ----------------------------------------------------------
5827. Zones Processed: 
5828. ----------------------------------------------------------
5829. !ZoneListByLine!
5830. ----------------------------------------------------------
5831. Zone Processing Step:
5832. !ZoneStepByLine!    
5833. ----------------------------------------------------------
5834. ----------------------------------------------------------
5835. Current Zone:
5836. !ZoneFooter!
5837. ----------------------------------------------------------
5838. ----------------------------------------------------------
5839. Volume Statistics:
5840. !VolumeStatisticsDetail!
5841. ----------------------------------------------------------
5842. ----------------------------------------------------------
5843. Zone Detailed Report:
5844. ----------------------------------------------------------
5845. !ZoneStatisticsDetail!
5846. ----------------------------------------------------------
5847. ")
5848. 
5849. 
5850. 
5851. /* pause() */
5852. /* pause() */
5853. 
5854. 
5855. 
5856. 	
5857. /* ---------------------------------------------------------- */
5858. # Zone 2 of 2 ProgramHints Data.
5859. 	# Script: DisplayColors - Zone Dark
5860. # Processed
5861. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
5862. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
5863. 
5864. # Light Green and Yellow
5865. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
5866. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
5867. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
5868. 
5869. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHintsData!")
5870. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHintsData!")
5871. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
5872. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHints!")
5873. 	SetVariable(ZoneTypeSelect,'
5874.                 # ProgramHints - Data files.
5875.                 not(
5876.                      # Os PageHiberDump start.
5877. (
5878.   FileName("DataStore.edb")
5879.   or FileName("DUMP*.*")
5880.   or FileName("Hiberfil.sys")
5881.   or FileName("MEMORY.DMP")
5882.   or FileName("Pagefile.sys")
5883. )
5884. # Os PageHiberDump end.
5885. 
5886.                 )
5887. ')
5888. 
5889. 		# Script: ZoneDoHeader
5890. 
5891. # Script: ZoneWhenStarted
5892. RunProgram("..\Commands\WriteDateTime.bat")
5893. 
5894. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
5895. # Script: DisplaySetZone
5896. 
5897. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
5898. SetVariable(FileStepDescription,	"")
5899. 
5900. SetVariable(ZoneStepByLine, 			"Zone started.
5901. ")
5902. 
5903. # Script: BannerDescriptionSet
5904. 
5905. # Script: BannerSet
5906. 
5907. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
5908. 
5909. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
5910. 
5911. Title('!Heading!')
5912. /* pause(1) */
5913. 
5914. /* NOTE: Can't round or truncate to integer precision. */
5915. 
5916. # Script: BannerLog
5917. 
5918. AppendLogfile("!LogFileName!", "!Title!")
5919. 
5920. 
5921. 
5922. pause(1)
5923. 
5924. 
5925. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
5926. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
5927. 
5928. SetVariable(ZoneStepNoCurrent, 0)
5929. 
5930. 
5931. # Script: ZoneDoCurrentClear
5932. 
5933. SetVariable(ZoneTypeSelectCurrent, 		"")
5934. 
5935. SetVariable(ZoneBeginCurrent, 			0)
5936. SetVariable(ZoneBeginPerCurrent, 		0)
5937. SetVariable(ZoneEndCurrent, 			0)
5938. SetVariable(ZoneEndPerCurrent, 			0)
5939. 
5940. SetVariable(ZoneSizeCurrent,			0)
5941. SetVariable(ZoneSizePerCurrent,			0)
5942. 
5943. SetVariable(ZoneGapRequestedCurrent,	0)
5944. SetVariable(ZoneGapRoundedCurrent, 		0)
5945. SetVariable(ZoneGapAdjustedCurrent, 	0)
5946. SetVariable(ZoneGapAvailableCurrent, 	0)
5947. SetVariable(ZoneGapCurrent,				0)
5948. SetVariable(ZoneGapUsedCurrent, 		0)
5949. 
5950. SetVariable(ZoneGapActualCurrent, 		0)
5951. SetVariable(ZoneGapActualPerCurrent, 	0)
5952. 
5953. SetVariable(ZoneSizeActual, 			0)
5954. SetVariable(ZoneSizeActualCurrent,		0)
5955. 
5956. SetVariable(ZoneEndActual, 				0)
5957. SetVariable(ZoneEndActualCurrent,		0)			
5958. SetVariable(ZoneSizeActualPerCurrent, 	0)
5959.       
5960. SetVariable(ZoneFilesFolders,			0)
5961. SetVariable(ZoneFilesFoldersPer,		0) 
5962. 
5963. SetVariable(ZoneFragments,				0)
5964. SetVariable(ZoneFragmentsPer,			0) 
5965. 		
5966. SetVariable(ZoneEndActualCurrent, 		0)
5967. SetVariable(ZoneEndActualPerCurrent, 	0)
5968. 
5969. # Gap Calculation Methodology:
5970. 	# Requested
5971. 	SetVariable(GapRequested, 			0) 
5972. 	SetVariable(GapRequestedStd, 		0) 
5973. 	SetVariable(GapRequestedMft, 		0) 
5974. 	SetVariable(GapRequestedOs, 		0) 
5975. 	SetVariable(GapRequestedOriginal, 	0) 
5976. 	
5977. 	# Gap Adjustments
5978. 	SetVariable(GapRounded, 			0)
5979. 	# SetVariable(GapAdjusted, 			0)
5980. 	SetVariable(GapAvailable, 			0)
5981. 	SetVariable(GapCurrent, 			0)
5982. 	SetVariable(GapActual, 				0)
5983. 	SetVariable(GapUsed, 				0)
5984. 	
5985. 	# Gap Adjustments
5986. 	SetVariable(GapRoundedLoc, 			0)
5987. 	# SetVariable(GapAdjustedLoc, 		0)
5988. 	SetVariable(GapAvailableLoc, 		0)
5989. 	SetVariable(GapCurrentLoc, 			0)
5990. 	SetVariable(GapActualLoc,			0)
5991. 	SetVariable(GapUsedLoc,				0)
5992. 	
5993. 	# Space usage
5994. 	SetVariable(ZoneFreePerRequested, 	0)
5995. 	SetVariable(ZoneFreePerUsed, 		0)
5996. 
5997. # Gap Size & Rounding
5998. 	SetVariable(ZoneGapSizePer, 		0)
5999. 	SetVariable(ZoneVolRoundUpPer, 		0)
6000. 	
6001. 	# Free Space
6002. 	SetVariable(ZoneFreeUsedPer, 		0)
6003. 	SetVariable(ZoneFreeRequestedPer, 	0)
6004. 
6005. 
6006. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
6007. 
6008. # Footer:
6009. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
6010. # 2021-11-17 21:08:27
6011. 
6012. SetVariable(ZoneFooter1, "----------------------------------------------------------
6013. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
6014. #
6015. # Xinclude "..\Commands\DateTimeLastLong.txt"X
6016. #
6017. SetVariable(ZoneFooter2, "Statistics Report:
6018. ------------------
6019.    Size:  
6020.    ------------------------
6021.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6022.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6023.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6024. 
6025.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6026.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6027. 
6028.    Location:
6029.    ------------------------
6030.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6031.             Files End: !ZoneEndCurrent!
6032.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6033.       
6034.    Gap Settings:
6035.    ------------------------
6036.          Gap Requested: !ZoneGapSizePer!%
6037.        Volume Rounding: !ZoneVolRoundUpPer!%
6038.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6039.                  
6040.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
6041.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
6042.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
6043.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
6044.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
6045.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
6046.      
6047.    Free Space after Zone:
6048.    ------------------------
6049.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6050.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6051.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6052. 
6053. Directory and Files Select:
6054. ---------------------------
6055. !ZoneTypeSelectCurrent!               
6056. ---------------------------
6057. ----------------------------------------------------------
6058. ")
6059. 
6060. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
6061. 
6062. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
6063. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
6064. RunProgram("..\Commands\WriteDateTime.bat LastZone")
6065. 
6066. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
6067. 
6068. 
6069. 
6070. # Script: BannerSet
6071. 
6072. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6073. 
6074. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
6075. 
6076. Title('!Heading!')
6077. /* pause(1) */
6078. 
6079. /* NOTE: Can't round or truncate to integer precision. */
6080. 
6081. # Script: BannerLog
6082. 
6083. AppendLogfile("!LogFileName!", "!Title!")
6084. 
6085. 
6086. 
6087. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
6088. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
6089. 
6090. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
6091. 
6092. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:27")
6093. 
6094. # 2021-11-17 21:08:27 
6095. SetVariable(Temp9, DATETIME)
6096. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:02 !ZoneLabel! !ZoneDescription!")
6097. 
6098. SetVariable(ZoneListByLine, "!ZoneListByLine! 
6099. Zone: !ZoneNoCurrent! !Temp9! 0:00:02 !ZoneLabel! !ZoneDescription!")
6100. 
6101. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:02 !ZoneLabel! !ZoneDescription!")
6102. 
6103. 
6104. /* Fixed Zone Position Handling */
6105. /* Literal number: */
6106. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
6107. /* Percentage of disk: */
6108. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
6109. /* Gap */
6110. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
6111. 
6112. /* ---------------------------------------------------------- */
6113. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
6114. # Script: DisplaySetFileStep
6115. 
6116. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6117. 
6118. /* add message and move to a new line. */
6119. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6120. ")
6121. 
6122. /* display the line. (hopefully.) */
6123. # Zone Footer Set Statistics Window Text
6124. 
6125. SetStatisticsWindowText("!Heading!
6126. ----------------------------------------------------------
6127. Zones Processed: 
6128. ----------------------------------------------------------
6129. !ZoneListByLine!
6130. ----------------------------------------------------------
6131. Zone Processing Step:
6132. !ZoneStepByLine!    
6133. ----------------------------------------------------------
6134. ----------------------------------------------------------
6135. Current Zone:
6136. !ZoneFooter!
6137. ----------------------------------------------------------
6138. ----------------------------------------------------------
6139. Volume Statistics:
6140. !VolumeStatisticsDetail!
6141. ----------------------------------------------------------
6142. ----------------------------------------------------------
6143. Zone Detailed Report:
6144. ----------------------------------------------------------
6145. !ZoneStatisticsDetail!
6146. ----------------------------------------------------------
6147. ")
6148. 
6149. 
6150. 
6151. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6152. 
6153. # Script: BannerSet
6154. 
6155. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6156. 
6157. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
6158. 
6159. Title('!Heading!')
6160. /* pause(1) */
6161. 
6162. /* NOTE: Can't round or truncate to integer precision. */
6163. 
6164. pause(1)
6165. 
6166. # your stuff HERE (X)... pre file select code.
6167. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
6168. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
6169. 	# (X)
6170. 
6171. FileSelect
6172. 
6173. 	# your stuff can't really go here (errors.)
6174. 	# maybe for some reason I don't know of...
6175. 	
6176. 	# Actions next...
6177. 		# Script: ZoneDo ZoneTypeSelectOsProgramHints
6178. # ProgramHints start.
6179. ImportListFromProgramHints("*.pf")
6180. # ProgramHints end.
6181. 
6182. 		and not(
6183. 			# Os PageHiberDump start.
6184. (
6185.   FileName("DataStore.edb")
6186.   or FileName("DUMP*.*")
6187.   or FileName("Hiberfil.sys")
6188.   or FileName("MEMORY.DMP")
6189.   or FileName("Pagefile.sys")
6190. )
6191. # Os PageHiberDump end.
6192. 
6193. 		)
6194. 		
6195. 		FileActions
6196. 		  		/* ---------------------------------------------------------- */
6197. 	# Gap
6198. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
6199. 		# Script: DisplaySetFileStep
6200. 
6201. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6202. 
6203. /* add message and move to a new line. */
6204. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6205. ")
6206. 
6207. /* display the line. (hopefully.) */
6208. # Zone Footer Set Statistics Window Text
6209. 
6210. SetStatisticsWindowText("!Heading!
6211. ----------------------------------------------------------
6212. Zones Processed: 
6213. ----------------------------------------------------------
6214. !ZoneListByLine!
6215. ----------------------------------------------------------
6216. Zone Processing Step:
6217. !ZoneStepByLine!    
6218. ----------------------------------------------------------
6219. ----------------------------------------------------------
6220. Current Zone:
6221. !ZoneFooter!
6222. ----------------------------------------------------------
6223. ----------------------------------------------------------
6224. Volume Statistics:
6225. !VolumeStatisticsDetail!
6226. ----------------------------------------------------------
6227. ----------------------------------------------------------
6228. Zone Detailed Report:
6229. ----------------------------------------------------------
6230. !ZoneStatisticsDetail!
6231. ----------------------------------------------------------
6232. ")
6233. 
6234. 
6235. 
6236. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6237. 
6238. # Script: BannerSet
6239. 
6240. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6241. 
6242. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
6243. 
6244. Title('!Heading!')
6245. /* pause(1) */
6246. 
6247. /* NOTE: Can't round or truncate to integer precision. */
6248. 
6249. pause(1)
6250. 	
6251. 	# ACTUAL GAP
6252. 		/* AddGap Variant. */
6253. 	  	# Zone Do Gap
6254. # Gap Calculation Methods:
6255. 
6256. /* 1) Anything you need to add first. */
6257. /* empty */
6258. 
6259. /* ---------------------------------------------------------- */
6260. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
6261. 	# GapRequestedStd.
6262. 
6263. 		/* ---------------------------------------------------------- */
6264. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
6265. 
6266. 		# Gap Calculation Methods:
6267. 
6268. /* AddGap Variants */
6269. 
6270. 	/* Standard */
6271. 		# Gap Calculation Methods:
6272. 	/* AddGap Variants */
6273. 	/* Standard */
6274. 
6275. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
6276. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
6277. 
6278. 	SetVariable(GapRequested, GapRequestedStd)
6279. 	
6280. 
6281. 	/* MFT Low High Method */
6282. 		# Gap Calculation Methods:
6283. 	/* AddGap Variants */
6284. 	/* MFT Low High Method */
6285. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
6286. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
6287. 	SetVariable(GapRequested, GapRequestedMft)
6288. 	
6289. 
6290. 	/* OS Volume Type Method */
6291. 		# Gap Calculation Methods:
6292. 	/* AddGap Variants */
6293. 	/* OS Volume Type Method */
6294. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
6295. 	SetVariable(GapRequested, GapRequestedOs)
6296. 
6297. 
6298. 
6299. /* MakeGap Variants */
6300. 
6301. 	/* Original Os 1-3 + MFT 2 */
6302. 		# Gap Calculation Methods:
6303. 	/* MakeGap Variants */
6304. 	/* Original Os 1-3 + MFT 2 */
6305. 	/* plus MFT gap placed inline at the dividing zone. */
6306. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
6307. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
6308. 	SetVariable(GapRequested, GapRequestedOrig)
6309. 	
6310. 	
6311. /* Note: You could comment out the ones not in use */
6312. /* However having the data in the log is useful. */
6313. /* Therefore the following line is otherwise needed. */
6314. 
6315. /* Standard used */
6316. 
6317. SetVariable(GapRequested, GapRequestedStd)
6318. 
6319. # Gap Calculation Methods:
6320. 
6321. /* AddGap Variants */
6322. 	/* Standard */
6323. 	/* MFT Low High Method */
6324. 	/* OS Volume Type Method */
6325. 
6326. /* MakeGap Variants */
6327. 	/* Original Os 1-3 + MFT 2 */
6328. 
6329. /* Note: You could comment out the ones not in use */
6330. /* However having the data in the log is useful. */
6331. /* Therefore the following line is otherwise needed. */
6332. 
6333. /* Standard is used currently */
6334. 
6335. 
6336. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
6337. 
6338. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
6339. 
6340. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
6341. 
6342. /* ---------------------------------------------------------- */
6343. /* 3) SMALL ZONE ADJUSTMENT. */
6344. /* Gab cant be larger than half the Zone Size. */
6345. 
6346. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
6347. 	
6348. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
6349. 
6350. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
6351. 
6352. /* ---------------------------------------------------------- */
6353. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
6354. # Gap Adjustments.
6355. 
6356. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
6357. 	
6358. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
6359. 
6360. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
6361. 
6362. /* ---------------------------------------------------------- */
6363. # BYPASS THIS.
6364. 	/* This is definitely wrong. */
6365. 	/* The question is can we steal gap from the next zone */
6366. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
6367. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
6368. 		# Zone Overflow.
6369. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
6370. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
6371. 
6372. /* ---------------------------------------------------------- */
6373. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
6374. # Remaining free space available.
6375. 
6376. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
6377. 	
6378. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
6379. 
6380. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
6381. 
6382. /* ---------------------------------------------------------- */
6383. # CURRENT gap to use.
6384. 
6385. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
6386. 
6387. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
6388. 
6389. /* ---------------------------------------------------------- */
6390. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
6391. # Debugging.
6392. 
6393. 	SetVariable(GapUsed, GapCurrent) // for debugging
6394. 
6395. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
6396. 
6397. 		# Your code HERE
6398. 
6399. /* ---------------------------------------------------------- */
6400. /* 7) YOUR CODE. */
6401. # YOUR CODE HERE:
6402. 	# INPUT: GapCurrent or GapCurrentLoc
6403. 	# OUTPUT: GapUsed...
6404. 
6405. /* ---------------------------------------------------------- */
6406. # Gap Size.
6407. # Actual Size of Gap.
6408. 
6409. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
6410. 
6411. /* ---------------------------------------------------------- */
6412. /* xxxxxxxxxxxxxxxxxxxxxx */
6413. # ADD THE GAP
6414. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
6415. /* xxxxxxxxxxxxxxxxxxxxxx */
6416. 
6417. 	
6418. 	# Zone Statistics	
6419. 	# Script: ZoneDoStatistics
6420. # Zone / Volume Statistics and Display
6421. 		
6422. 	# Accumulate Totals
6423.   	# Script: ZoneDoVolumeTotals
6424. 
6425. /* Current total space used (by Zones and Gaps) */
6426. 
6427. SetVariable(VolumeZoneUsed, GapUsed)
6428. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
6429. /* Percentage */
6430. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
6431. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
6432. 
6433. /* Current total of free space requested */
6434. 
6435. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
6436. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6437. /* Percent. */
6438. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
6439. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6440. 
6441. /* Current total of free space used */
6442. 
6443. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
6444. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
6445. /* Percent */
6446. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
6447. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
6448. 
6449. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
6450. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
6451. /* Xinclude "..\DebugDisplayPause.MyDc"X */
6452. 
6453. 
6454. 	# Current Values
6455. 	# Script: ZoneDoCurrentSet
6456. 
6457. # Cluster, Sector, Block adjust for display.
6458. 	# Bytes per cluster is volume specific.
6459. 
6460. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
6461. 
6462. # Current Zone values.
6463. 	# Begin, end and size.
6464. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
6465. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
6466. 
6467. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
6468. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
6469. 
6470. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
6471. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
6472. 
6473. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
6474. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
6475. 
6476. 	SetVariable(ZoneFragments,				"!ZONE210N!")
6477. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
6478. 		
6479. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
6480. /* identical code to here: (separation not needed. TEST.) */	
6481. 
6482. # Current Gap, Actual and Free Values
6483. 	# Gap
6484. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
6485. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
6486. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
6487. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
6488. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
6489. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
6490. 	
6491. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
6492. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
6493. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
6494. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
6495. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
6496. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
6497. 	
6498. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
6499. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
6500. 	
6501. 	# Actual Size and End
6502. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
6503. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
6504. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
6505. 	
6506. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
6507. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
6508. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
6509. 
6510. # Gap Size & Rounding
6511. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
6512. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
6513. 	
6514. 	# Free Space
6515. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
6516. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
6517. 
6518. 	# Footer:
6519. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
6520. # 2021-11-17 21:08:27
6521. 
6522. SetVariable(ZoneFooter1, "----------------------------------------------------------
6523. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
6524. #
6525. # Xinclude "..\Commands\DateTimeLastLong.txt"X
6526. #
6527. SetVariable(ZoneFooter2, "Statistics Report:
6528. ------------------
6529.    Size:  
6530.    ------------------------
6531.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6532.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6533.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6534. 
6535.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6536.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6537. 
6538.    Location:
6539.    ------------------------
6540.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6541.             Files End: !ZoneEndCurrent!
6542.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6543.       
6544.    Gap Settings:
6545.    ------------------------
6546.          Gap Requested: !ZoneGapSizePer!%
6547.        Volume Rounding: !ZoneVolRoundUpPer!%
6548.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6549.                  
6550.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
6551.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
6552.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
6553.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
6554.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
6555.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
6556.      
6557.    Free Space after Zone:
6558.    ------------------------
6559.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6560.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6561.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6562. 
6563. Directory and Files Select:
6564. ---------------------------
6565. !ZoneTypeSelectCurrent!               
6566. ---------------------------
6567. ----------------------------------------------------------
6568. ")
6569. 
6570. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
6571. 
6572. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
6573. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
6574. RunProgram("..\Commands\WriteDateTime.bat LastZone")
6575. 
6576. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
6577. 
6578. 
6579. 	# Zone Footer Set Statistics Window Text
6580. 
6581. SetStatisticsWindowText("!Heading!
6582. ----------------------------------------------------------
6583. Zones Processed: 
6584. ----------------------------------------------------------
6585. !ZoneListByLine!
6586. ----------------------------------------------------------
6587. Zone Processing Step:
6588. !ZoneStepByLine!    
6589. ----------------------------------------------------------
6590. ----------------------------------------------------------
6591. Current Zone:
6592. !ZoneFooter!
6593. ----------------------------------------------------------
6594. ----------------------------------------------------------
6595. Volume Statistics:
6596. !VolumeStatisticsDetail!
6597. ----------------------------------------------------------
6598. ----------------------------------------------------------
6599. Zone Detailed Report:
6600. ----------------------------------------------------------
6601. !ZoneStatisticsDetail!
6602. ----------------------------------------------------------
6603. ")
6604. 
6605. 
6606. 	
6607.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
6608. 
6609. 	# Add Zone to list of zones for display.
6610. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
6611. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
6612. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
6613. 	# ??? Free Stats?
6614. 	# Footer:
6615. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
6616. # 2021-11-17 21:08:27
6617. 
6618. SetVariable(ZoneFooter1, "----------------------------------------------------------
6619. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
6620. #
6621. # Xinclude "..\Commands\DateTimeLastLong.txt"X
6622. #
6623. SetVariable(ZoneFooter2, "Statistics Report:
6624. ------------------
6625.    Size:  
6626.    ------------------------
6627.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6628.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6629.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6630. 
6631.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6632.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6633. 
6634.    Location:
6635.    ------------------------
6636.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6637.             Files End: !ZoneEndCurrent!
6638.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6639.       
6640.    Gap Settings:
6641.    ------------------------
6642.          Gap Requested: !ZoneGapSizePer!%
6643.        Volume Rounding: !ZoneVolRoundUpPer!%
6644.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6645.                  
6646.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
6647.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
6648.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
6649.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
6650.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
6651.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
6652.      
6653.    Free Space after Zone:
6654.    ------------------------
6655.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6656.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6657.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6658. 
6659. Directory and Files Select:
6660. ---------------------------
6661. !ZoneTypeSelectCurrent!               
6662. ---------------------------
6663. ----------------------------------------------------------
6664. ")
6665. 
6666. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
6667. 
6668. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
6669. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
6670. RunProgram("..\Commands\WriteDateTime.bat LastZone")
6671. 
6672. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
6673. 
6674. 
6675. 
6676. 	# Add Zone Details to Report.	
6677. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
6678. !ZoneFooter!")
6679. 
6680. 
6681. 	
6682. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
6683. 			# Script: DisplaySetFileStep
6684. 
6685. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6686. 
6687. /* add message and move to a new line. */
6688. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6689. ")
6690. 
6691. /* display the line. (hopefully.) */
6692. # Zone Footer Set Statistics Window Text
6693. 
6694. SetStatisticsWindowText("!Heading!
6695. ----------------------------------------------------------
6696. Zones Processed: 
6697. ----------------------------------------------------------
6698. !ZoneListByLine!
6699. ----------------------------------------------------------
6700. Zone Processing Step:
6701. !ZoneStepByLine!    
6702. ----------------------------------------------------------
6703. ----------------------------------------------------------
6704. Current Zone:
6705. !ZoneFooter!
6706. ----------------------------------------------------------
6707. ----------------------------------------------------------
6708. Volume Statistics:
6709. !VolumeStatisticsDetail!
6710. ----------------------------------------------------------
6711. ----------------------------------------------------------
6712. Zone Detailed Report:
6713. ----------------------------------------------------------
6714. !ZoneStatisticsDetail!
6715. ----------------------------------------------------------
6716. ")
6717. 
6718. 
6719. 
6720. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6721. 
6722. # Script: BannerSet
6723. 
6724. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6725. 
6726. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
6727. 
6728. Title('!Heading!')
6729. /* pause(1) */
6730. 
6731. /* NOTE: Can't round or truncate to integer precision. */
6732. 
6733. pause(1)
6734. 
6735. 			# File Action - Type Os Program Hints Data - Regular - ImportSeq.
6736. # File Action - SortByImportSequence.
6737. SortByImportSequence(Ascending ) 
6738. 	
6739. 	
6740. 	
6741. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
6742. 			# Script: DisplaySetFileStep
6743. 
6744. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6745. 
6746. /* add message and move to a new line. */
6747. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6748. ")
6749. 
6750. /* display the line. (hopefully.) */
6751. # Zone Footer Set Statistics Window Text
6752. 
6753. SetStatisticsWindowText("!Heading!
6754. ----------------------------------------------------------
6755. Zones Processed: 
6756. ----------------------------------------------------------
6757. !ZoneListByLine!
6758. ----------------------------------------------------------
6759. Zone Processing Step:
6760. !ZoneStepByLine!    
6761. ----------------------------------------------------------
6762. ----------------------------------------------------------
6763. Current Zone:
6764. !ZoneFooter!
6765. ----------------------------------------------------------
6766. ----------------------------------------------------------
6767. Volume Statistics:
6768. !VolumeStatisticsDetail!
6769. ----------------------------------------------------------
6770. ----------------------------------------------------------
6771. Zone Detailed Report:
6772. ----------------------------------------------------------
6773. !ZoneStatisticsDetail!
6774. ----------------------------------------------------------
6775. ")
6776. 
6777. 
6778. 
6779. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6780. 
6781. # Script: BannerSet
6782. 
6783. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6784. 
6785. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
6786. 
6787. Title('!Heading!')
6788. /* pause(1) */
6789. 
6790. /* NOTE: Can't round or truncate to integer precision. */
6791. 
6792. pause(1)
6793. 
6794. 		# Script: ZoneDoFooter
6795. 
6796. /* ---------------------------------------------------------- */
6797. # File Select
6798. 	# Select Statments
6799. # File Actions 
6800. 	# Standard or OS File Actions.
6801. 	# Resume...
6802. 	
6803. 	# your stuff HERE (X)... post zone (file) file actions code.
6804. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
6805. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
6806. 		# (X)
6807. 		
6808. 		/* ??? Set window? */
6809. 	
6810. 	# ADD THE GAP
6811. # Vacate (good for diagnostics)
6812. # DoNotVacate - DO NOT Vacate (recommended)
6813. # DoNotVacate - DO NOT Vacate (recommended)
6814. 
6815. # Vacate
6816. /* AddGap(GapUsedLoc) */
6817. 
6818. # DO Not Vacate
6819. AddGap(GapUsedLoc, DoNotVacate) 
6820. 	
6821. 	
6822. # Script: GapZoneCommand
6823. # *** Moved to setting yours ***
6824. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
6825. # Controlled via settings commands
6826. # DoNotVacate - DO NOT Vacate (recommended)
6827. 
6828. # Vacate
6829. /* AddGap(GapUsedLoc) */
6830. 
6831. # DO Not Vacate
6832. AddGap(GapUsedLoc, DoNotVacate) 
6833. 	
6834. 	
6835. # Vacate /* AddGap(GapUsed) */
6836. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
6837. 	
6838. 
6839. 		
6840. # 
6841. FileEnd
6842. /* ---------------------------------------------------------- */
6843. 
6844. # your stuff HERE (X)... post zone (file) code.
6845. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
6846. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
6847. 	# (X)
6848. 
6849. SetVariable(FileStepDescription,"Zone finished, reporting.")
6850. # Script: DisplaySetFileStep
6851. 
6852. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6853. 
6854. /* add message and move to a new line. */
6855. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6856. ")
6857. 
6858. /* display the line. (hopefully.) */
6859. # Zone Footer Set Statistics Window Text
6860. 
6861. SetStatisticsWindowText("!Heading!
6862. ----------------------------------------------------------
6863. Zones Processed: 
6864. ----------------------------------------------------------
6865. !ZoneListByLine!
6866. ----------------------------------------------------------
6867. Zone Processing Step:
6868. !ZoneStepByLine!    
6869. ----------------------------------------------------------
6870. ----------------------------------------------------------
6871. Current Zone:
6872. !ZoneFooter!
6873. ----------------------------------------------------------
6874. ----------------------------------------------------------
6875. Volume Statistics:
6876. !VolumeStatisticsDetail!
6877. ----------------------------------------------------------
6878. ----------------------------------------------------------
6879. Zone Detailed Report:
6880. ----------------------------------------------------------
6881. !ZoneStatisticsDetail!
6882. ----------------------------------------------------------
6883. ")
6884. 
6885. 
6886. 
6887. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6888. 
6889. # Script: BannerSet
6890. 
6891. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6892. 
6893. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
6894. 
6895. Title('!Heading!')
6896. /* pause(1) */
6897. 
6898. /* NOTE: Can't round or truncate to integer precision. */
6899. 
6900. pause(1)
6901. 
6902. # Script: ZoneWhenFinished
6903. 
6904. # Script: BannerSet
6905. 
6906. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
6907. 
6908. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
6909. 
6910. Title('!Heading!')
6911. /* pause(1) */
6912. 
6913. /* NOTE: Can't round or truncate to integer precision. */
6914. 
6915. # Script: BannerLog
6916. 
6917. AppendLogfile("!LogFileName!", "!Title!")
6918. 
6919. 
6920. 
6921. # Zone Statistics	
6922. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
6923. 
6924. # Footer:
6925. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
6926. # 2021-11-17 21:08:27
6927. 
6928. SetVariable(ZoneFooter1, "----------------------------------------------------------
6929. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
6930. #
6931. # Xinclude "..\Commands\DateTimeLastLong.txt"X
6932. #
6933. SetVariable(ZoneFooter2, "Statistics Report:
6934. ------------------
6935.    Size:  
6936.    ------------------------
6937.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6938.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6939.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6940. 
6941.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6942.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6943. 
6944.    Location:
6945.    ------------------------
6946.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6947.             Files End: !ZoneEndCurrent!
6948.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6949.       
6950.    Gap Settings:
6951.    ------------------------
6952.          Gap Requested: !ZoneGapSizePer!%
6953.        Volume Rounding: !ZoneVolRoundUpPer!%
6954.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6955.                  
6956.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
6957.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
6958.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
6959.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
6960.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
6961.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
6962.      
6963.    Free Space after Zone:
6964.    ------------------------
6965.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6966.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6967.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6968. 
6969. Directory and Files Select:
6970. ---------------------------
6971. !ZoneTypeSelectCurrent!               
6972. ---------------------------
6973. ----------------------------------------------------------
6974. ")
6975. 
6976. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
6977. 
6978. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
6979. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
6980. RunProgram("..\Commands\WriteDateTime.bat LastZone")
6981. 
6982. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
6983. 
6984. 
6985. 
6986. AppendLogfile("!LogFileName!", ".")
6987. AppendLogfile("!LogFileName!", "!ZoneFooter!")
6988. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
6989. AppendLogfile("!LogFileName!", ".")
6990. 
6991. # Zone Footer Set Statistics Window Text
6992. 
6993. SetStatisticsWindowText("!Heading!
6994. ----------------------------------------------------------
6995. Zones Processed: 
6996. ----------------------------------------------------------
6997. !ZoneListByLine!
6998. ----------------------------------------------------------
6999. Zone Processing Step:
7000. !ZoneStepByLine!    
7001. ----------------------------------------------------------
7002. ----------------------------------------------------------
7003. Current Zone:
7004. !ZoneFooter!
7005. ----------------------------------------------------------
7006. ----------------------------------------------------------
7007. Volume Statistics:
7008. !VolumeStatisticsDetail!
7009. ----------------------------------------------------------
7010. ----------------------------------------------------------
7011. Zone Detailed Report:
7012. ----------------------------------------------------------
7013. !ZoneStatisticsDetail!
7014. ----------------------------------------------------------
7015. ")
7016. 
7017. 
7018. 
7019. /* pause() */
7020. /* pause() */
7021. 
7022. 
7023. 
7024. 	
7025. /* ---------------------------------------------------------- */
7026. 
7027. 
7028. /* ---------------------------------------------------------- */
7029. # Zone Programs Fixed size but not windows..
7030. # Os Group Zone 5d Fixed, 6l Fixed Windows, 7l Fixed Data
7031. # Script: DefragZoneTypeOsPrograms
7032. /* ---------------------------------------------------------- */
7033. # Zone Programs Fixed size but not windows..
7034. 	# Script: DisplayColors - Zone Dark
7035. # Processed
7036. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
7037. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
7038. 
7039. # Light Green and Yellow
7040. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
7041. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
7042. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
7043. 
7044. 	SetVariable(ZoneLabel, 			"!ZoneLabelPrograms!")
7045. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPrograms!")
7046. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
7047. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
7048. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsPrograms
7049. # Programs start.
7050. # NotBlobsArchivesBu start.
7051. (not (
7052. # Blobs start.
7053. (
7054. # BlobsAndExceptions start.
7055. ( not(
7056.   FileName("*.bat")
7057.   or FileName("*.css")
7058.   or FileName("*.dll")
7059.   or FileName("*.exe")
7060.   or FileName("*.htm*")
7061.   or FileName("*.jar")
7062.   or FileName("*.js")
7063.   or FileName("*.script")
7064.   or FileName("*.wsf")
7065.   or (
7066. # Databases start.
7067. (
7068.   FileName("*.crypt*")
7069.   or FileName("*.db*")
7070.   or FileName("*.rdb*")
7071.   or FileName("*.dc*")
7072.   or FileName("*.dict*")
7073.   or FileName("*.?db*")
7074.   or FileName("*.?rdb*")
7075.   or FileName("*.md*")
7076.   or FileName("*.myd")
7077.   or FileName("*.ndf")
7078.   or FileName("*.ns?")
7079.   or FileName("*.pab")
7080.   or FileName("*.pst")
7081.   or FileName("*.sd?*")
7082.   or FileName("*.sq**")
7083.   or FileName("*.tmd")
7084.   or FileName("*.tps")
7085.   or FileName("*.tr*")
7086. )
7087. # Databases end.
7088. 
7089.     # BlobsAndExceptions
7090.     or 
7091. # Data start.
7092. (
7093.   DirectoryName("Data*")
7094.   or DirectoryName("Device*")
7095.   or DirectoryName("Export*")
7096.   or DirectoryName("Import*")
7097.   or DirectoryName("Log*")
7098.   or DirectoryName("*Log")
7099.   or DirectoryName("Maintenance*")
7100.   or DirectoryName("Rec*")
7101.   or DirectoryName("Sales*")
7102.   or DirectoryName("Search*")
7103.   or DirectoryName("User*")
7104. )
7105. # Data end.
7106. 
7107.     # BlobsAndExceptions
7108.   )
7109. ) )
7110. # BlobsAndExceptions end.
7111. 
7112. # Blobs
7113. ) and (
7114.   Size(BlobFileSize,0)
7115.   or (
7116.     FileName("*.arj")
7117.     or FileName("*.bup")
7118.     or FileName("*.bz2")
7119.     or FileName("*.chm")
7120.     or FileName("*.dvr-ms")
7121.     or FileName("*.gz")
7122.     or FileName("*.ifo")
7123.     or FileName("*.lzh")
7124.     or FileName("*.pdf")
7125.     or FileName("*.rpm")
7126.     or FileName("*.wmv")
7127.     or FileName("*.vob")
7128.     or FileName("*.z")
7129.   ) 
7130. )
7131. # Blobs end.
7132. 
7133. # NotBlobsArchivesBu
7134. or 
7135. # Archives start.
7136. (
7137.   DirectoryName("*Archive*")
7138.   or DirectoryName("*History*")
7139.   or DirectoryName("*Old")
7140.   or DirectoryName("* Old *")
7141.   or DirectoryName("Old *")
7142. 
7143.   or FileName("*.7z")
7144.   or FileName("*.cab")
7145.   or FileName("*.iso")
7146.   or FileName("*.msi")
7147.   or FileName("*.old")
7148.   or FileName("*.rar")
7149.   or FileName("*.tar")
7150.   or FileName("*.zip")
7151.   or
7152. # WinSysLow start.
7153. (
7154.   # Bad idea. This pushed lots of programs and data to archive.
7155.   # DirectoryName("$*")
7156.   # or DirectoryName("0*")
7157.   # or DirectoryName("1*")
7158.   # or DirectoryName("2*")
7159.   # or DirectoryName("3*")
7160.   # or DirectoryName("4*")
7161.   # or DirectoryName("5*")
7162.   # or DirectoryName("6*")
7163.   # or DirectoryName("7*")
7164.   # or DirectoryName("8*")
7165.   # or DirectoryName("9*")
7166.   # or 
7167.   DirectoryName("dllcache")
7168.   or DirectoryName("Downloaded Installations")
7169.   or DirectoryName("Ehome")
7170.   or DirectoryName("Fonts")
7171.   or DirectoryName("Help")
7172.   or DirectoryName("I386")
7173.   or DirectoryName("ie?updates")
7174.   or DirectoryName("Installer")
7175.   or DirectoryName("Installshield Installation Information")
7176.   or DirectoryName("IME")
7177.   or DirectoryName("*RECYCLE*")
7178.   or DirectoryName("ServicePackFiles")
7179.   or DirectoryName("SoftwareDistribution")
7180.   or DirectoryName("Speech")
7181.   or DirectoryName("Symbols")
7182.   or DirectoryName("System Volume Information")
7183.   or DirectoryName("windows.old")
7184. )
7185. # WinSysLow end.
7186. 
7187.   # Archives
7188. )
7189. # Archives end.
7190. 
7191. # NotBlobsArchivesBu
7192. or
7193. # Backups start.
7194. (
7195.   DirectoryName("*Backup*")
7196.   or DirectoryName("*Bu")
7197.   or DirectoryName("* Bu *")
7198.   or DirectoryName("Bu *")
7199. 
7200.   or FileName("*.bak")
7201.   or FileName("* - Copy*")
7202. )
7203. # Backups end.
7204. 
7205. # NotBlobsArchivesBu
7206. ) )
7207. # NotBlobsArchivesBu end.
7208. 
7209. # Programs
7210. and (
7211. # SystemDir start.
7212. (
7213.   DirectoryName("Boot*")
7214.   or DirectoryName("Device*")
7215.   or DirectoryName("DevSupport*")
7216.   or DirectoryName("Program*")
7217.   or DirectoryName("Security*")
7218.   or DirectoryName("SendTo*")
7219.   or DirectoryName("Sw*")
7220.   or DirectoryName("System*")
7221.   or DirectoryName("Toolbars")
7222.   or DirectoryName("Windows*")
7223. )
7224. # SystemDir end.
7225. 
7226. # Programs
7227. )
7228. # Programs end.
7229. 
7230.                 and not(
7231.                      # Script: ZoneDo ZoneTypeSelectOsDataDynamic
7232. # Os Data Dynamic start.
7233. (
7234. # Os Data Dynamic start.
7235. (
7236.   FileName("*.dat*")
7237.   or FileName("*.db*")
7238.   or FileName("*.edb*")
7239.   or FileName("*.log*")
7240.   or FileName("DataStore.edb")
7241. )
7242. # Os Data Dynamic end.
7243. 
7244.   or 
7245. # Os PageHiberDump start.
7246. (
7247.   FileName("DataStore.edb")
7248.   or FileName("DUMP*.*")
7249.   or FileName("Hiberfil.sys")
7250.   or FileName("MEMORY.DMP")
7251.   or FileName("Pagefile.sys")
7252. )
7253. # Os PageHiberDump end.
7254. 
7255. # Os Data Dynamic
7256. )
7257. # Os Data Dynamic end.
7258. 
7259.                      or 
7260.                      DirectoryName("Windows*")
7261.                 )
7262. ')
7263. 
7264. 		# Script: ZoneDoHeader
7265. 
7266. # Script: ZoneWhenStarted
7267. RunProgram("..\Commands\WriteDateTime.bat")
7268. 
7269. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
7270. # Script: DisplaySetZone
7271. 
7272. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
7273. SetVariable(FileStepDescription,	"")
7274. 
7275. SetVariable(ZoneStepByLine, 			"Zone started.
7276. ")
7277. 
7278. # Script: BannerDescriptionSet
7279. 
7280. # Script: BannerSet
7281. 
7282. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
7283. 
7284. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
7285. 
7286. Title('!Heading!')
7287. /* pause(1) */
7288. 
7289. /* NOTE: Can't round or truncate to integer precision. */
7290. 
7291. # Script: BannerLog
7292. 
7293. AppendLogfile("!LogFileName!", "!Title!")
7294. 
7295. 
7296. 
7297. pause(1)
7298. 
7299. 
7300. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
7301. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
7302. 
7303. SetVariable(ZoneStepNoCurrent, 0)
7304. 
7305. 
7306. # Script: ZoneDoCurrentClear
7307. 
7308. SetVariable(ZoneTypeSelectCurrent, 		"")
7309. 
7310. SetVariable(ZoneBeginCurrent, 			0)
7311. SetVariable(ZoneBeginPerCurrent, 		0)
7312. SetVariable(ZoneEndCurrent, 			0)
7313. SetVariable(ZoneEndPerCurrent, 			0)
7314. 
7315. SetVariable(ZoneSizeCurrent,			0)
7316. SetVariable(ZoneSizePerCurrent,			0)
7317. 
7318. SetVariable(ZoneGapRequestedCurrent,	0)
7319. SetVariable(ZoneGapRoundedCurrent, 		0)
7320. SetVariable(ZoneGapAdjustedCurrent, 	0)
7321. SetVariable(ZoneGapAvailableCurrent, 	0)
7322. SetVariable(ZoneGapCurrent,				0)
7323. SetVariable(ZoneGapUsedCurrent, 		0)
7324. 
7325. SetVariable(ZoneGapActualCurrent, 		0)
7326. SetVariable(ZoneGapActualPerCurrent, 	0)
7327. 
7328. SetVariable(ZoneSizeActual, 			0)
7329. SetVariable(ZoneSizeActualCurrent,		0)
7330. 
7331. SetVariable(ZoneEndActual, 				0)
7332. SetVariable(ZoneEndActualCurrent,		0)			
7333. SetVariable(ZoneSizeActualPerCurrent, 	0)
7334.       
7335. SetVariable(ZoneFilesFolders,			0)
7336. SetVariable(ZoneFilesFoldersPer,		0) 
7337. 
7338. SetVariable(ZoneFragments,				0)
7339. SetVariable(ZoneFragmentsPer,			0) 
7340. 		
7341. SetVariable(ZoneEndActualCurrent, 		0)
7342. SetVariable(ZoneEndActualPerCurrent, 	0)
7343. 
7344. # Gap Calculation Methodology:
7345. 	# Requested
7346. 	SetVariable(GapRequested, 			0) 
7347. 	SetVariable(GapRequestedStd, 		0) 
7348. 	SetVariable(GapRequestedMft, 		0) 
7349. 	SetVariable(GapRequestedOs, 		0) 
7350. 	SetVariable(GapRequestedOriginal, 	0) 
7351. 	
7352. 	# Gap Adjustments
7353. 	SetVariable(GapRounded, 			0)
7354. 	# SetVariable(GapAdjusted, 			0)
7355. 	SetVariable(GapAvailable, 			0)
7356. 	SetVariable(GapCurrent, 			0)
7357. 	SetVariable(GapActual, 				0)
7358. 	SetVariable(GapUsed, 				0)
7359. 	
7360. 	# Gap Adjustments
7361. 	SetVariable(GapRoundedLoc, 			0)
7362. 	# SetVariable(GapAdjustedLoc, 		0)
7363. 	SetVariable(GapAvailableLoc, 		0)
7364. 	SetVariable(GapCurrentLoc, 			0)
7365. 	SetVariable(GapActualLoc,			0)
7366. 	SetVariable(GapUsedLoc,				0)
7367. 	
7368. 	# Space usage
7369. 	SetVariable(ZoneFreePerRequested, 	0)
7370. 	SetVariable(ZoneFreePerUsed, 		0)
7371. 
7372. # Gap Size & Rounding
7373. 	SetVariable(ZoneGapSizePer, 		0)
7374. 	SetVariable(ZoneVolRoundUpPer, 		0)
7375. 	
7376. 	# Free Space
7377. 	SetVariable(ZoneFreeUsedPer, 		0)
7378. 	SetVariable(ZoneFreeRequestedPer, 	0)
7379. 
7380. 
7381. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
7382. 
7383. # Footer:
7384. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
7385. # 2021-11-17 21:08:27
7386. 
7387. SetVariable(ZoneFooter1, "----------------------------------------------------------
7388. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
7389. #
7390. # Xinclude "..\Commands\DateTimeLastLong.txt"X
7391. #
7392. SetVariable(ZoneFooter2, "Statistics Report:
7393. ------------------
7394.    Size:  
7395.    ------------------------
7396.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7397.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7398.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7399. 
7400.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7401.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7402. 
7403.    Location:
7404.    ------------------------
7405.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7406.             Files End: !ZoneEndCurrent!
7407.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7408.       
7409.    Gap Settings:
7410.    ------------------------
7411.          Gap Requested: !ZoneGapSizePer!%
7412.        Volume Rounding: !ZoneVolRoundUpPer!%
7413.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7414.                  
7415.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
7416.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
7417.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
7418.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
7419.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
7420.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
7421.      
7422.    Free Space after Zone:
7423.    ------------------------
7424.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7425.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7426.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7427. 
7428. Directory and Files Select:
7429. ---------------------------
7430. !ZoneTypeSelectCurrent!               
7431. ---------------------------
7432. ----------------------------------------------------------
7433. ")
7434. 
7435. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
7436. 
7437. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
7438. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
7439. RunProgram("..\Commands\WriteDateTime.bat LastZone")
7440. 
7441. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
7442. 
7443. 
7444. 
7445. # Script: BannerSet
7446. 
7447. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
7448. 
7449. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
7450. 
7451. Title('!Heading!')
7452. /* pause(1) */
7453. 
7454. /* NOTE: Can't round or truncate to integer precision. */
7455. 
7456. # Script: BannerLog
7457. 
7458. AppendLogfile("!LogFileName!", "!Title!")
7459. 
7460. 
7461. 
7462. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
7463. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
7464. 
7465. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
7466. 
7467. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:27")
7468. 
7469. # 2021-11-17 21:08:27 
7470. SetVariable(Temp9, DATETIME)
7471. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:02 !ZoneLabel! !ZoneDescription!")
7472. 
7473. SetVariable(ZoneListByLine, "!ZoneListByLine! 
7474. Zone: !ZoneNoCurrent! !Temp9! 0:00:02 !ZoneLabel! !ZoneDescription!")
7475. 
7476. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:02 !ZoneLabel! !ZoneDescription!")
7477. 
7478. 
7479. /* Fixed Zone Position Handling */
7480. /* Literal number: */
7481. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
7482. /* Percentage of disk: */
7483. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
7484. /* Gap */
7485. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
7486. 
7487. /* ---------------------------------------------------------- */
7488. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
7489. # Script: DisplaySetFileStep
7490. 
7491. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7492. 
7493. /* add message and move to a new line. */
7494. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7495. ")
7496. 
7497. /* display the line. (hopefully.) */
7498. # Zone Footer Set Statistics Window Text
7499. 
7500. SetStatisticsWindowText("!Heading!
7501. ----------------------------------------------------------
7502. Zones Processed: 
7503. ----------------------------------------------------------
7504. !ZoneListByLine!
7505. ----------------------------------------------------------
7506. Zone Processing Step:
7507. !ZoneStepByLine!    
7508. ----------------------------------------------------------
7509. ----------------------------------------------------------
7510. Current Zone:
7511. !ZoneFooter!
7512. ----------------------------------------------------------
7513. ----------------------------------------------------------
7514. Volume Statistics:
7515. !VolumeStatisticsDetail!
7516. ----------------------------------------------------------
7517. ----------------------------------------------------------
7518. Zone Detailed Report:
7519. ----------------------------------------------------------
7520. !ZoneStatisticsDetail!
7521. ----------------------------------------------------------
7522. ")
7523. 
7524. 
7525. 
7526. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7527. 
7528. # Script: BannerSet
7529. 
7530. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
7531. 
7532. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
7533. 
7534. Title('!Heading!')
7535. /* pause(1) */
7536. 
7537. /* NOTE: Can't round or truncate to integer precision. */
7538. 
7539. pause(1)
7540. 
7541. # your stuff HERE (X)... pre file select code.
7542. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
7543. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
7544. 	# (X)
7545. 
7546. FileSelect
7547. 
7548. 	# your stuff can't really go here (errors.)
7549. 	# maybe for some reason I don't know of...
7550. 	
7551. 	# Actions next...
7552. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
7553. # Programs start.
7554. # NotBlobsArchivesBu start.
7555. (not (
7556. # Blobs start.
7557. (
7558. # BlobsAndExceptions start.
7559. ( not(
7560.   FileName("*.bat")
7561.   or FileName("*.css")
7562.   or FileName("*.dll")
7563.   or FileName("*.exe")
7564.   or FileName("*.htm*")
7565.   or FileName("*.jar")
7566.   or FileName("*.js")
7567.   or FileName("*.script")
7568.   or FileName("*.wsf")
7569.   or (
7570. # Databases start.
7571. (
7572.   FileName("*.crypt*")
7573.   or FileName("*.db*")
7574.   or FileName("*.rdb*")
7575.   or FileName("*.dc*")
7576.   or FileName("*.dict*")
7577.   or FileName("*.?db*")
7578.   or FileName("*.?rdb*")
7579.   or FileName("*.md*")
7580.   or FileName("*.myd")
7581.   or FileName("*.ndf")
7582.   or FileName("*.ns?")
7583.   or FileName("*.pab")
7584.   or FileName("*.pst")
7585.   or FileName("*.sd?*")
7586.   or FileName("*.sq**")
7587.   or FileName("*.tmd")
7588.   or FileName("*.tps")
7589.   or FileName("*.tr*")
7590. )
7591. # Databases end.
7592. 
7593.     # BlobsAndExceptions
7594.     or 
7595. # Data start.
7596. (
7597.   DirectoryName("Data*")
7598.   or DirectoryName("Device*")
7599.   or DirectoryName("Export*")
7600.   or DirectoryName("Import*")
7601.   or DirectoryName("Log*")
7602.   or DirectoryName("*Log")
7603.   or DirectoryName("Maintenance*")
7604.   or DirectoryName("Rec*")
7605.   or DirectoryName("Sales*")
7606.   or DirectoryName("Search*")
7607.   or DirectoryName("User*")
7608. )
7609. # Data end.
7610. 
7611.     # BlobsAndExceptions
7612.   )
7613. ) )
7614. # BlobsAndExceptions end.
7615. 
7616. # Blobs
7617. ) and (
7618.   Size(BlobFileSize,0)
7619.   or (
7620.     FileName("*.arj")
7621.     or FileName("*.bup")
7622.     or FileName("*.bz2")
7623.     or FileName("*.chm")
7624.     or FileName("*.dvr-ms")
7625.     or FileName("*.gz")
7626.     or FileName("*.ifo")
7627.     or FileName("*.lzh")
7628.     or FileName("*.pdf")
7629.     or FileName("*.rpm")
7630.     or FileName("*.wmv")
7631.     or FileName("*.vob")
7632.     or FileName("*.z")
7633.   ) 
7634. )
7635. # Blobs end.
7636. 
7637. # NotBlobsArchivesBu
7638. or 
7639. # Archives start.
7640. (
7641.   DirectoryName("*Archive*")
7642.   or DirectoryName("*History*")
7643.   or DirectoryName("*Old")
7644.   or DirectoryName("* Old *")
7645.   or DirectoryName("Old *")
7646. 
7647.   or FileName("*.7z")
7648.   or FileName("*.cab")
7649.   or FileName("*.iso")
7650.   or FileName("*.msi")
7651.   or FileName("*.old")
7652.   or FileName("*.rar")
7653.   or FileName("*.tar")
7654.   or FileName("*.zip")
7655.   or
7656. # WinSysLow start.
7657. (
7658.   # Bad idea. This pushed lots of programs and data to archive.
7659.   # DirectoryName("$*")
7660.   # or DirectoryName("0*")
7661.   # or DirectoryName("1*")
7662.   # or DirectoryName("2*")
7663.   # or DirectoryName("3*")
7664.   # or DirectoryName("4*")
7665.   # or DirectoryName("5*")
7666.   # or DirectoryName("6*")
7667.   # or DirectoryName("7*")
7668.   # or DirectoryName("8*")
7669.   # or DirectoryName("9*")
7670.   # or 
7671.   DirectoryName("dllcache")
7672.   or DirectoryName("Downloaded Installations")
7673.   or DirectoryName("Ehome")
7674.   or DirectoryName("Fonts")
7675.   or DirectoryName("Help")
7676.   or DirectoryName("I386")
7677.   or DirectoryName("ie?updates")
7678.   or DirectoryName("Installer")
7679.   or DirectoryName("Installshield Installation Information")
7680.   or DirectoryName("IME")
7681.   or DirectoryName("*RECYCLE*")
7682.   or DirectoryName("ServicePackFiles")
7683.   or DirectoryName("SoftwareDistribution")
7684.   or DirectoryName("Speech")
7685.   or DirectoryName("Symbols")
7686.   or DirectoryName("System Volume Information")
7687.   or DirectoryName("windows.old")
7688. )
7689. # WinSysLow end.
7690. 
7691.   # Archives
7692. )
7693. # Archives end.
7694. 
7695. # NotBlobsArchivesBu
7696. or
7697. # Backups start.
7698. (
7699.   DirectoryName("*Backup*")
7700.   or DirectoryName("*Bu")
7701.   or DirectoryName("* Bu *")
7702.   or DirectoryName("Bu *")
7703. 
7704.   or FileName("*.bak")
7705.   or FileName("* - Copy*")
7706. )
7707. # Backups end.
7708. 
7709. # NotBlobsArchivesBu
7710. ) )
7711. # NotBlobsArchivesBu end.
7712. 
7713. # Programs
7714. and (
7715. # SystemDir start.
7716. (
7717.   DirectoryName("Boot*")
7718.   or DirectoryName("Device*")
7719.   or DirectoryName("DevSupport*")
7720.   or DirectoryName("Program*")
7721.   or DirectoryName("Security*")
7722.   or DirectoryName("SendTo*")
7723.   or DirectoryName("Sw*")
7724.   or DirectoryName("System*")
7725.   or DirectoryName("Toolbars")
7726.   or DirectoryName("Windows*")
7727. )
7728. # SystemDir end.
7729. 
7730. # Programs
7731. )
7732. # Programs end.
7733. 
7734. 		and not(
7735. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
7736. # Os Data Dynamic start.
7737. (
7738. # Os Data Dynamic start.
7739. (
7740.   FileName("*.dat*")
7741.   or FileName("*.db*")
7742.   or FileName("*.edb*")
7743.   or FileName("*.log*")
7744.   or FileName("DataStore.edb")
7745. )
7746. # Os Data Dynamic end.
7747. 
7748.   or 
7749. # Os PageHiberDump start.
7750. (
7751.   FileName("DataStore.edb")
7752.   or FileName("DUMP*.*")
7753.   or FileName("Hiberfil.sys")
7754.   or FileName("MEMORY.DMP")
7755.   or FileName("Pagefile.sys")
7756. )
7757. # Os PageHiberDump end.
7758. 
7759. # Os Data Dynamic
7760. )
7761. # Os Data Dynamic end.
7762. 
7763. 			or 
7764. 				DirectoryName("Windows*")
7765. 		)
7766. 		FileActions
7767. 		  		/* ---------------------------------------------------------- */
7768. 	# Gap
7769. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
7770. 		# Script: DisplaySetFileStep
7771. 
7772. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7773. 
7774. /* add message and move to a new line. */
7775. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7776. ")
7777. 
7778. /* display the line. (hopefully.) */
7779. # Zone Footer Set Statistics Window Text
7780. 
7781. SetStatisticsWindowText("!Heading!
7782. ----------------------------------------------------------
7783. Zones Processed: 
7784. ----------------------------------------------------------
7785. !ZoneListByLine!
7786. ----------------------------------------------------------
7787. Zone Processing Step:
7788. !ZoneStepByLine!    
7789. ----------------------------------------------------------
7790. ----------------------------------------------------------
7791. Current Zone:
7792. !ZoneFooter!
7793. ----------------------------------------------------------
7794. ----------------------------------------------------------
7795. Volume Statistics:
7796. !VolumeStatisticsDetail!
7797. ----------------------------------------------------------
7798. ----------------------------------------------------------
7799. Zone Detailed Report:
7800. ----------------------------------------------------------
7801. !ZoneStatisticsDetail!
7802. ----------------------------------------------------------
7803. ")
7804. 
7805. 
7806. 
7807. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7808. 
7809. # Script: BannerSet
7810. 
7811. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
7812. 
7813. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
7814. 
7815. Title('!Heading!')
7816. /* pause(1) */
7817. 
7818. /* NOTE: Can't round or truncate to integer precision. */
7819. 
7820. pause(1)
7821. 	
7822. 	# ACTUAL GAP
7823. 		/* AddGap Variant. */
7824. 	  	# Zone Do Gap
7825. # Gap Calculation Methods:
7826. 
7827. /* 1) Anything you need to add first. */
7828. /* empty */
7829. 
7830. /* ---------------------------------------------------------- */
7831. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
7832. 	# GapRequestedStd.
7833. 
7834. 		/* ---------------------------------------------------------- */
7835. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
7836. 
7837. 		# Gap Calculation Methods:
7838. 
7839. /* AddGap Variants */
7840. 
7841. 	/* Standard */
7842. 		# Gap Calculation Methods:
7843. 	/* AddGap Variants */
7844. 	/* Standard */
7845. 
7846. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
7847. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
7848. 
7849. 	SetVariable(GapRequested, GapRequestedStd)
7850. 	
7851. 
7852. 	/* MFT Low High Method */
7853. 		# Gap Calculation Methods:
7854. 	/* AddGap Variants */
7855. 	/* MFT Low High Method */
7856. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
7857. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
7858. 	SetVariable(GapRequested, GapRequestedMft)
7859. 	
7860. 
7861. 	/* OS Volume Type Method */
7862. 		# Gap Calculation Methods:
7863. 	/* AddGap Variants */
7864. 	/* OS Volume Type Method */
7865. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
7866. 	SetVariable(GapRequested, GapRequestedOs)
7867. 
7868. 
7869. 
7870. /* MakeGap Variants */
7871. 
7872. 	/* Original Os 1-3 + MFT 2 */
7873. 		# Gap Calculation Methods:
7874. 	/* MakeGap Variants */
7875. 	/* Original Os 1-3 + MFT 2 */
7876. 	/* plus MFT gap placed inline at the dividing zone. */
7877. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
7878. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
7879. 	SetVariable(GapRequested, GapRequestedOrig)
7880. 	
7881. 	
7882. /* Note: You could comment out the ones not in use */
7883. /* However having the data in the log is useful. */
7884. /* Therefore the following line is otherwise needed. */
7885. 
7886. /* Standard used */
7887. 
7888. SetVariable(GapRequested, GapRequestedStd)
7889. 
7890. # Gap Calculation Methods:
7891. 
7892. /* AddGap Variants */
7893. 	/* Standard */
7894. 	/* MFT Low High Method */
7895. 	/* OS Volume Type Method */
7896. 
7897. /* MakeGap Variants */
7898. 	/* Original Os 1-3 + MFT 2 */
7899. 
7900. /* Note: You could comment out the ones not in use */
7901. /* However having the data in the log is useful. */
7902. /* Therefore the following line is otherwise needed. */
7903. 
7904. /* Standard is used currently */
7905. 
7906. 
7907. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
7908. 
7909. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
7910. 
7911. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
7912. 
7913. /* ---------------------------------------------------------- */
7914. /* 3) SMALL ZONE ADJUSTMENT. */
7915. /* Gab cant be larger than half the Zone Size. */
7916. 
7917. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
7918. 	
7919. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
7920. 
7921. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
7922. 
7923. /* ---------------------------------------------------------- */
7924. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
7925. # Gap Adjustments.
7926. 
7927. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
7928. 	
7929. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
7930. 
7931. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
7932. 
7933. /* ---------------------------------------------------------- */
7934. # BYPASS THIS.
7935. 	/* This is definitely wrong. */
7936. 	/* The question is can we steal gap from the next zone */
7937. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
7938. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
7939. 		# Zone Overflow.
7940. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
7941. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
7942. 
7943. /* ---------------------------------------------------------- */
7944. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
7945. # Remaining free space available.
7946. 
7947. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
7948. 	
7949. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
7950. 
7951. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
7952. 
7953. /* ---------------------------------------------------------- */
7954. # CURRENT gap to use.
7955. 
7956. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
7957. 
7958. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
7959. 
7960. /* ---------------------------------------------------------- */
7961. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
7962. # Debugging.
7963. 
7964. 	SetVariable(GapUsed, GapCurrent) // for debugging
7965. 
7966. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
7967. 
7968. 		# Your code HERE
7969. 
7970. /* ---------------------------------------------------------- */
7971. /* 7) YOUR CODE. */
7972. # YOUR CODE HERE:
7973. 	# INPUT: GapCurrent or GapCurrentLoc
7974. 	# OUTPUT: GapUsed...
7975. 
7976. /* ---------------------------------------------------------- */
7977. # Gap Size.
7978. # Actual Size of Gap.
7979. 
7980. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
7981. 
7982. /* ---------------------------------------------------------- */
7983. /* xxxxxxxxxxxxxxxxxxxxxx */
7984. # ADD THE GAP
7985. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
7986. /* xxxxxxxxxxxxxxxxxxxxxx */
7987. 
7988. 	
7989. 	# Zone Statistics	
7990. 	# Script: ZoneDoStatistics
7991. # Zone / Volume Statistics and Display
7992. 		
7993. 	# Accumulate Totals
7994.   	# Script: ZoneDoVolumeTotals
7995. 
7996. /* Current total space used (by Zones and Gaps) */
7997. 
7998. SetVariable(VolumeZoneUsed, GapUsed)
7999. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
8000. /* Percentage */
8001. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
8002. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
8003. 
8004. /* Current total of free space requested */
8005. 
8006. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
8007. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
8008. /* Percent. */
8009. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
8010. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
8011. 
8012. /* Current total of free space used */
8013. 
8014. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
8015. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
8016. /* Percent */
8017. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
8018. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
8019. 
8020. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
8021. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
8022. /* Xinclude "..\DebugDisplayPause.MyDc"X */
8023. 
8024. 
8025. 	# Current Values
8026. 	# Script: ZoneDoCurrentSet
8027. 
8028. # Cluster, Sector, Block adjust for display.
8029. 	# Bytes per cluster is volume specific.
8030. 
8031. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
8032. 
8033. # Current Zone values.
8034. 	# Begin, end and size.
8035. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
8036. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
8037. 
8038. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
8039. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
8040. 
8041. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
8042. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
8043. 
8044. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
8045. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
8046. 
8047. 	SetVariable(ZoneFragments,				"!ZONE210N!")
8048. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
8049. 		
8050. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
8051. /* identical code to here: (separation not needed. TEST.) */	
8052. 
8053. # Current Gap, Actual and Free Values
8054. 	# Gap
8055. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
8056. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
8057. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
8058. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
8059. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
8060. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
8061. 	
8062. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
8063. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
8064. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
8065. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
8066. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
8067. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
8068. 	
8069. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
8070. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
8071. 	
8072. 	# Actual Size and End
8073. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
8074. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
8075. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
8076. 	
8077. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
8078. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
8079. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
8080. 
8081. # Gap Size & Rounding
8082. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
8083. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
8084. 	
8085. 	# Free Space
8086. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
8087. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
8088. 
8089. 	# Footer:
8090. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
8091. # 2021-11-17 21:08:27
8092. 
8093. SetVariable(ZoneFooter1, "----------------------------------------------------------
8094. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
8095. #
8096. # Xinclude "..\Commands\DateTimeLastLong.txt"X
8097. #
8098. SetVariable(ZoneFooter2, "Statistics Report:
8099. ------------------
8100.    Size:  
8101.    ------------------------
8102.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8103.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8104.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8105. 
8106.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8107.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8108. 
8109.    Location:
8110.    ------------------------
8111.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8112.             Files End: !ZoneEndCurrent!
8113.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8114.       
8115.    Gap Settings:
8116.    ------------------------
8117.          Gap Requested: !ZoneGapSizePer!%
8118.        Volume Rounding: !ZoneVolRoundUpPer!%
8119.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8120.                  
8121.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
8122.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
8123.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
8124.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
8125.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
8126.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
8127.      
8128.    Free Space after Zone:
8129.    ------------------------
8130.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8131.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8132.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8133. 
8134. Directory and Files Select:
8135. ---------------------------
8136. !ZoneTypeSelectCurrent!               
8137. ---------------------------
8138. ----------------------------------------------------------
8139. ")
8140. 
8141. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
8142. 
8143. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
8144. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
8145. RunProgram("..\Commands\WriteDateTime.bat LastZone")
8146. 
8147. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
8148. 
8149. 
8150. 	# Zone Footer Set Statistics Window Text
8151. 
8152. SetStatisticsWindowText("!Heading!
8153. ----------------------------------------------------------
8154. Zones Processed: 
8155. ----------------------------------------------------------
8156. !ZoneListByLine!
8157. ----------------------------------------------------------
8158. Zone Processing Step:
8159. !ZoneStepByLine!    
8160. ----------------------------------------------------------
8161. ----------------------------------------------------------
8162. Current Zone:
8163. !ZoneFooter!
8164. ----------------------------------------------------------
8165. ----------------------------------------------------------
8166. Volume Statistics:
8167. !VolumeStatisticsDetail!
8168. ----------------------------------------------------------
8169. ----------------------------------------------------------
8170. Zone Detailed Report:
8171. ----------------------------------------------------------
8172. !ZoneStatisticsDetail!
8173. ----------------------------------------------------------
8174. ")
8175. 
8176. 
8177. 	
8178.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
8179. 
8180. 	# Add Zone to list of zones for display.
8181. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
8182. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
8183. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
8184. 	# ??? Free Stats?
8185. 	# Footer:
8186. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
8187. # 2021-11-17 21:08:27
8188. 
8189. SetVariable(ZoneFooter1, "----------------------------------------------------------
8190. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
8191. #
8192. # Xinclude "..\Commands\DateTimeLastLong.txt"X
8193. #
8194. SetVariable(ZoneFooter2, "Statistics Report:
8195. ------------------
8196.    Size:  
8197.    ------------------------
8198.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8199.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8200.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8201. 
8202.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8203.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8204. 
8205.    Location:
8206.    ------------------------
8207.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8208.             Files End: !ZoneEndCurrent!
8209.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8210.       
8211.    Gap Settings:
8212.    ------------------------
8213.          Gap Requested: !ZoneGapSizePer!%
8214.        Volume Rounding: !ZoneVolRoundUpPer!%
8215.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8216.                  
8217.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
8218.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
8219.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
8220.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
8221.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
8222.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
8223.      
8224.    Free Space after Zone:
8225.    ------------------------
8226.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8227.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8228.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8229. 
8230. Directory and Files Select:
8231. ---------------------------
8232. !ZoneTypeSelectCurrent!               
8233. ---------------------------
8234. ----------------------------------------------------------
8235. ")
8236. 
8237. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
8238. 
8239. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
8240. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
8241. RunProgram("..\Commands\WriteDateTime.bat LastZone")
8242. 
8243. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
8244. 
8245. 
8246. 
8247. 	# Add Zone Details to Report.	
8248. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
8249. !ZoneFooter!")
8250. 
8251. 
8252. 	
8253. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
8254. 			# Script: DisplaySetFileStep
8255. 
8256. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8257. 
8258. /* add message and move to a new line. */
8259. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8260. ")
8261. 
8262. /* display the line. (hopefully.) */
8263. # Zone Footer Set Statistics Window Text
8264. 
8265. SetStatisticsWindowText("!Heading!
8266. ----------------------------------------------------------
8267. Zones Processed: 
8268. ----------------------------------------------------------
8269. !ZoneListByLine!
8270. ----------------------------------------------------------
8271. Zone Processing Step:
8272. !ZoneStepByLine!    
8273. ----------------------------------------------------------
8274. ----------------------------------------------------------
8275. Current Zone:
8276. !ZoneFooter!
8277. ----------------------------------------------------------
8278. ----------------------------------------------------------
8279. Volume Statistics:
8280. !VolumeStatisticsDetail!
8281. ----------------------------------------------------------
8282. ----------------------------------------------------------
8283. Zone Detailed Report:
8284. ----------------------------------------------------------
8285. !ZoneStatisticsDetail!
8286. ----------------------------------------------------------
8287. ")
8288. 
8289. 
8290. 
8291. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8292. 
8293. # Script: BannerSet
8294. 
8295. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8296. 
8297. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
8298. 
8299. Title('!Heading!')
8300. /* pause(1) */
8301. 
8302. /* NOTE: Can't round or truncate to integer precision. */
8303. 
8304. pause(1)
8305. 
8306. 			# File Action - SortByImportSequence with SkipBlock.
8307. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
8308. 	
8309. 	
8310. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
8311. 			# Script: DisplaySetFileStep
8312. 
8313. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8314. 
8315. /* add message and move to a new line. */
8316. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8317. ")
8318. 
8319. /* display the line. (hopefully.) */
8320. # Zone Footer Set Statistics Window Text
8321. 
8322. SetStatisticsWindowText("!Heading!
8323. ----------------------------------------------------------
8324. Zones Processed: 
8325. ----------------------------------------------------------
8326. !ZoneListByLine!
8327. ----------------------------------------------------------
8328. Zone Processing Step:
8329. !ZoneStepByLine!    
8330. ----------------------------------------------------------
8331. ----------------------------------------------------------
8332. Current Zone:
8333. !ZoneFooter!
8334. ----------------------------------------------------------
8335. ----------------------------------------------------------
8336. Volume Statistics:
8337. !VolumeStatisticsDetail!
8338. ----------------------------------------------------------
8339. ----------------------------------------------------------
8340. Zone Detailed Report:
8341. ----------------------------------------------------------
8342. !ZoneStatisticsDetail!
8343. ----------------------------------------------------------
8344. ")
8345. 
8346. 
8347. 
8348. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8349. 
8350. # Script: BannerSet
8351. 
8352. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8353. 
8354. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
8355. 
8356. Title('!Heading!')
8357. /* pause(1) */
8358. 
8359. /* NOTE: Can't round or truncate to integer precision. */
8360. 
8361. pause(1)
8362. 
8363. 		# Script: ZoneDoFooter
8364. 
8365. /* ---------------------------------------------------------- */
8366. # File Select
8367. 	# Select Statments
8368. # File Actions 
8369. 	# Standard or OS File Actions.
8370. 	# Resume...
8371. 	
8372. 	# your stuff HERE (X)... post zone (file) file actions code.
8373. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
8374. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8375. 		# (X)
8376. 		
8377. 		/* ??? Set window? */
8378. 	
8379. 	# ADD THE GAP
8380. # Vacate (good for diagnostics)
8381. # DoNotVacate - DO NOT Vacate (recommended)
8382. # DoNotVacate - DO NOT Vacate (recommended)
8383. 
8384. # Vacate
8385. /* AddGap(GapUsedLoc) */
8386. 
8387. # DO Not Vacate
8388. AddGap(GapUsedLoc, DoNotVacate) 
8389. 	
8390. 	
8391. # Script: GapZoneCommand
8392. # *** Moved to setting yours ***
8393. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
8394. # Controlled via settings commands
8395. # DoNotVacate - DO NOT Vacate (recommended)
8396. 
8397. # Vacate
8398. /* AddGap(GapUsedLoc) */
8399. 
8400. # DO Not Vacate
8401. AddGap(GapUsedLoc, DoNotVacate) 
8402. 	
8403. 	
8404. # Vacate /* AddGap(GapUsed) */
8405. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
8406. 	
8407. 
8408. 		
8409. # 
8410. FileEnd
8411. /* ---------------------------------------------------------- */
8412. 
8413. # your stuff HERE (X)... post zone (file) code.
8414. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
8415. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8416. 	# (X)
8417. 
8418. SetVariable(FileStepDescription,"Zone finished, reporting.")
8419. # Script: DisplaySetFileStep
8420. 
8421. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8422. 
8423. /* add message and move to a new line. */
8424. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8425. ")
8426. 
8427. /* display the line. (hopefully.) */
8428. # Zone Footer Set Statistics Window Text
8429. 
8430. SetStatisticsWindowText("!Heading!
8431. ----------------------------------------------------------
8432. Zones Processed: 
8433. ----------------------------------------------------------
8434. !ZoneListByLine!
8435. ----------------------------------------------------------
8436. Zone Processing Step:
8437. !ZoneStepByLine!    
8438. ----------------------------------------------------------
8439. ----------------------------------------------------------
8440. Current Zone:
8441. !ZoneFooter!
8442. ----------------------------------------------------------
8443. ----------------------------------------------------------
8444. Volume Statistics:
8445. !VolumeStatisticsDetail!
8446. ----------------------------------------------------------
8447. ----------------------------------------------------------
8448. Zone Detailed Report:
8449. ----------------------------------------------------------
8450. !ZoneStatisticsDetail!
8451. ----------------------------------------------------------
8452. ")
8453. 
8454. 
8455. 
8456. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8457. 
8458. # Script: BannerSet
8459. 
8460. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8461. 
8462. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
8463. 
8464. Title('!Heading!')
8465. /* pause(1) */
8466. 
8467. /* NOTE: Can't round or truncate to integer precision. */
8468. 
8469. pause(1)
8470. 
8471. # Script: ZoneWhenFinished
8472. 
8473. # Script: BannerSet
8474. 
8475. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8476. 
8477. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
8478. 
8479. Title('!Heading!')
8480. /* pause(1) */
8481. 
8482. /* NOTE: Can't round or truncate to integer precision. */
8483. 
8484. # Script: BannerLog
8485. 
8486. AppendLogfile("!LogFileName!", "!Title!")
8487. 
8488. 
8489. 
8490. # Zone Statistics	
8491. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
8492. 
8493. # Footer:
8494. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
8495. # 2021-11-17 21:08:27
8496. 
8497. SetVariable(ZoneFooter1, "----------------------------------------------------------
8498. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
8499. #
8500. # Xinclude "..\Commands\DateTimeLastLong.txt"X
8501. #
8502. SetVariable(ZoneFooter2, "Statistics Report:
8503. ------------------
8504.    Size:  
8505.    ------------------------
8506.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8507.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8508.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8509. 
8510.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8511.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8512. 
8513.    Location:
8514.    ------------------------
8515.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8516.             Files End: !ZoneEndCurrent!
8517.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8518.       
8519.    Gap Settings:
8520.    ------------------------
8521.          Gap Requested: !ZoneGapSizePer!%
8522.        Volume Rounding: !ZoneVolRoundUpPer!%
8523.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8524.                  
8525.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
8526.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
8527.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
8528.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
8529.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
8530.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
8531.      
8532.    Free Space after Zone:
8533.    ------------------------
8534.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8535.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8536.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8537. 
8538. Directory and Files Select:
8539. ---------------------------
8540. !ZoneTypeSelectCurrent!               
8541. ---------------------------
8542. ----------------------------------------------------------
8543. ")
8544. 
8545. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
8546. 
8547. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
8548. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
8549. RunProgram("..\Commands\WriteDateTime.bat LastZone")
8550. 
8551. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
8552. 
8553. 
8554. 
8555. AppendLogfile("!LogFileName!", ".")
8556. AppendLogfile("!LogFileName!", "!ZoneFooter!")
8557. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
8558. AppendLogfile("!LogFileName!", ".")
8559. 
8560. # Zone Footer Set Statistics Window Text
8561. 
8562. SetStatisticsWindowText("!Heading!
8563. ----------------------------------------------------------
8564. Zones Processed: 
8565. ----------------------------------------------------------
8566. !ZoneListByLine!
8567. ----------------------------------------------------------
8568. Zone Processing Step:
8569. !ZoneStepByLine!    
8570. ----------------------------------------------------------
8571. ----------------------------------------------------------
8572. Current Zone:
8573. !ZoneFooter!
8574. ----------------------------------------------------------
8575. ----------------------------------------------------------
8576. Volume Statistics:
8577. !VolumeStatisticsDetail!
8578. ----------------------------------------------------------
8579. ----------------------------------------------------------
8580. Zone Detailed Report:
8581. ----------------------------------------------------------
8582. !ZoneStatisticsDetail!
8583. ----------------------------------------------------------
8584. ")
8585. 
8586. 
8587. 
8588. /* pause() */
8589. /* pause() */
8590. 
8591. 
8592. 
8593. 	
8594. /* ---------------------------------------------------------- */
8595. # Zone Programs Fixed size just Windows.
8596. 	# Script: DisplayColors - Zone Dark
8597. # Processed
8598. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
8599. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
8600. 
8601. # Light Green and Yellow
8602. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
8603. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
8604. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
8605. 
8606. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsWindows!")
8607. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsWindows!")
8608. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
8609. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
8610. 	SetVariable(ZoneTypeSelect,'
8611.                 # Programs - Windows folder.
8612. 				# Script: ZoneDo ZoneTypeSelectOsPrograms
8613. # Programs start.
8614. # NotBlobsArchivesBu start.
8615. (not (
8616. # Blobs start.
8617. (
8618. # BlobsAndExceptions start.
8619. ( not(
8620.   FileName("*.bat")
8621.   or FileName("*.css")
8622.   or FileName("*.dll")
8623.   or FileName("*.exe")
8624.   or FileName("*.htm*")
8625.   or FileName("*.jar")
8626.   or FileName("*.js")
8627.   or FileName("*.script")
8628.   or FileName("*.wsf")
8629.   or (
8630. # Databases start.
8631. (
8632.   FileName("*.crypt*")
8633.   or FileName("*.db*")
8634.   or FileName("*.rdb*")
8635.   or FileName("*.dc*")
8636.   or FileName("*.dict*")
8637.   or FileName("*.?db*")
8638.   or FileName("*.?rdb*")
8639.   or FileName("*.md*")
8640.   or FileName("*.myd")
8641.   or FileName("*.ndf")
8642.   or FileName("*.ns?")
8643.   or FileName("*.pab")
8644.   or FileName("*.pst")
8645.   or FileName("*.sd?*")
8646.   or FileName("*.sq**")
8647.   or FileName("*.tmd")
8648.   or FileName("*.tps")
8649.   or FileName("*.tr*")
8650. )
8651. # Databases end.
8652. 
8653.     # BlobsAndExceptions
8654.     or 
8655. # Data start.
8656. (
8657.   DirectoryName("Data*")
8658.   or DirectoryName("Device*")
8659.   or DirectoryName("Export*")
8660.   or DirectoryName("Import*")
8661.   or DirectoryName("Log*")
8662.   or DirectoryName("*Log")
8663.   or DirectoryName("Maintenance*")
8664.   or DirectoryName("Rec*")
8665.   or DirectoryName("Sales*")
8666.   or DirectoryName("Search*")
8667.   or DirectoryName("User*")
8668. )
8669. # Data end.
8670. 
8671.     # BlobsAndExceptions
8672.   )
8673. ) )
8674. # BlobsAndExceptions end.
8675. 
8676. # Blobs
8677. ) and (
8678.   Size(BlobFileSize,0)
8679.   or (
8680.     FileName("*.arj")
8681.     or FileName("*.bup")
8682.     or FileName("*.bz2")
8683.     or FileName("*.chm")
8684.     or FileName("*.dvr-ms")
8685.     or FileName("*.gz")
8686.     or FileName("*.ifo")
8687.     or FileName("*.lzh")
8688.     or FileName("*.pdf")
8689.     or FileName("*.rpm")
8690.     or FileName("*.wmv")
8691.     or FileName("*.vob")
8692.     or FileName("*.z")
8693.   ) 
8694. )
8695. # Blobs end.
8696. 
8697. # NotBlobsArchivesBu
8698. or 
8699. # Archives start.
8700. (
8701.   DirectoryName("*Archive*")
8702.   or DirectoryName("*History*")
8703.   or DirectoryName("*Old")
8704.   or DirectoryName("* Old *")
8705.   or DirectoryName("Old *")
8706. 
8707.   or FileName("*.7z")
8708.   or FileName("*.cab")
8709.   or FileName("*.iso")
8710.   or FileName("*.msi")
8711.   or FileName("*.old")
8712.   or FileName("*.rar")
8713.   or FileName("*.tar")
8714.   or FileName("*.zip")
8715.   or
8716. # WinSysLow start.
8717. (
8718.   # Bad idea. This pushed lots of programs and data to archive.
8719.   # DirectoryName("$*")
8720.   # or DirectoryName("0*")
8721.   # or DirectoryName("1*")
8722.   # or DirectoryName("2*")
8723.   # or DirectoryName("3*")
8724.   # or DirectoryName("4*")
8725.   # or DirectoryName("5*")
8726.   # or DirectoryName("6*")
8727.   # or DirectoryName("7*")
8728.   # or DirectoryName("8*")
8729.   # or DirectoryName("9*")
8730.   # or 
8731.   DirectoryName("dllcache")
8732.   or DirectoryName("Downloaded Installations")
8733.   or DirectoryName("Ehome")
8734.   or DirectoryName("Fonts")
8735.   or DirectoryName("Help")
8736.   or DirectoryName("I386")
8737.   or DirectoryName("ie?updates")
8738.   or DirectoryName("Installer")
8739.   or DirectoryName("Installshield Installation Information")
8740.   or DirectoryName("IME")
8741.   or DirectoryName("*RECYCLE*")
8742.   or DirectoryName("ServicePackFiles")
8743.   or DirectoryName("SoftwareDistribution")
8744.   or DirectoryName("Speech")
8745.   or DirectoryName("Symbols")
8746.   or DirectoryName("System Volume Information")
8747.   or DirectoryName("windows.old")
8748. )
8749. # WinSysLow end.
8750. 
8751.   # Archives
8752. )
8753. # Archives end.
8754. 
8755. # NotBlobsArchivesBu
8756. or
8757. # Backups start.
8758. (
8759.   DirectoryName("*Backup*")
8760.   or DirectoryName("*Bu")
8761.   or DirectoryName("* Bu *")
8762.   or DirectoryName("Bu *")
8763. 
8764.   or FileName("*.bak")
8765.   or FileName("* - Copy*")
8766. )
8767. # Backups end.
8768. 
8769. # NotBlobsArchivesBu
8770. ) )
8771. # NotBlobsArchivesBu end.
8772. 
8773. # Programs
8774. and (
8775. # SystemDir start.
8776. (
8777.   DirectoryName("Boot*")
8778.   or DirectoryName("Device*")
8779.   or DirectoryName("DevSupport*")
8780.   or DirectoryName("Program*")
8781.   or DirectoryName("Security*")
8782.   or DirectoryName("SendTo*")
8783.   or DirectoryName("Sw*")
8784.   or DirectoryName("System*")
8785.   or DirectoryName("Toolbars")
8786.   or DirectoryName("Windows*")
8787. )
8788. # SystemDir end.
8789. 
8790. # Programs
8791. )
8792. # Programs end.
8793. 
8794.                 and not(
8795.                 # Script: ZoneDo ZoneTypeSelectOsDataDynamic
8796. # Os Data Dynamic start.
8797. (
8798. # Os Data Dynamic start.
8799. (
8800.   FileName("*.dat*")
8801.   or FileName("*.db*")
8802.   or FileName("*.edb*")
8803.   or FileName("*.log*")
8804.   or FileName("DataStore.edb")
8805. )
8806. # Os Data Dynamic end.
8807. 
8808.   or 
8809. # Os PageHiberDump start.
8810. (
8811.   FileName("DataStore.edb")
8812.   or FileName("DUMP*.*")
8813.   or FileName("Hiberfil.sys")
8814.   or FileName("MEMORY.DMP")
8815.   or FileName("Pagefile.sys")
8816. )
8817. # Os PageHiberDump end.
8818. 
8819. # Os Data Dynamic
8820. )
8821. # Os Data Dynamic end.
8822. 
8823.                 )
8824. ')
8825. 
8826. 		# Script: ZoneDoHeader
8827. 
8828. # Script: ZoneWhenStarted
8829. RunProgram("..\Commands\WriteDateTime.bat")
8830. 
8831. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
8832. # Script: DisplaySetZone
8833. 
8834. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
8835. SetVariable(FileStepDescription,	"")
8836. 
8837. SetVariable(ZoneStepByLine, 			"Zone started.
8838. ")
8839. 
8840. # Script: BannerDescriptionSet
8841. 
8842. # Script: BannerSet
8843. 
8844. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
8845. 
8846. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
8847. 
8848. Title('!Heading!')
8849. /* pause(1) */
8850. 
8851. /* NOTE: Can't round or truncate to integer precision. */
8852. 
8853. # Script: BannerLog
8854. 
8855. AppendLogfile("!LogFileName!", "!Title!")
8856. 
8857. 
8858. 
8859. pause(1)
8860. 
8861. 
8862. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
8863. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
8864. 
8865. SetVariable(ZoneStepNoCurrent, 0)
8866. 
8867. 
8868. # Script: ZoneDoCurrentClear
8869. 
8870. SetVariable(ZoneTypeSelectCurrent, 		"")
8871. 
8872. SetVariable(ZoneBeginCurrent, 			0)
8873. SetVariable(ZoneBeginPerCurrent, 		0)
8874. SetVariable(ZoneEndCurrent, 			0)
8875. SetVariable(ZoneEndPerCurrent, 			0)
8876. 
8877. SetVariable(ZoneSizeCurrent,			0)
8878. SetVariable(ZoneSizePerCurrent,			0)
8879. 
8880. SetVariable(ZoneGapRequestedCurrent,	0)
8881. SetVariable(ZoneGapRoundedCurrent, 		0)
8882. SetVariable(ZoneGapAdjustedCurrent, 	0)
8883. SetVariable(ZoneGapAvailableCurrent, 	0)
8884. SetVariable(ZoneGapCurrent,				0)
8885. SetVariable(ZoneGapUsedCurrent, 		0)
8886. 
8887. SetVariable(ZoneGapActualCurrent, 		0)
8888. SetVariable(ZoneGapActualPerCurrent, 	0)
8889. 
8890. SetVariable(ZoneSizeActual, 			0)
8891. SetVariable(ZoneSizeActualCurrent,		0)
8892. 
8893. SetVariable(ZoneEndActual, 				0)
8894. SetVariable(ZoneEndActualCurrent,		0)			
8895. SetVariable(ZoneSizeActualPerCurrent, 	0)
8896.       
8897. SetVariable(ZoneFilesFolders,			0)
8898. SetVariable(ZoneFilesFoldersPer,		0) 
8899. 
8900. SetVariable(ZoneFragments,				0)
8901. SetVariable(ZoneFragmentsPer,			0) 
8902. 		
8903. SetVariable(ZoneEndActualCurrent, 		0)
8904. SetVariable(ZoneEndActualPerCurrent, 	0)
8905. 
8906. # Gap Calculation Methodology:
8907. 	# Requested
8908. 	SetVariable(GapRequested, 			0) 
8909. 	SetVariable(GapRequestedStd, 		0) 
8910. 	SetVariable(GapRequestedMft, 		0) 
8911. 	SetVariable(GapRequestedOs, 		0) 
8912. 	SetVariable(GapRequestedOriginal, 	0) 
8913. 	
8914. 	# Gap Adjustments
8915. 	SetVariable(GapRounded, 			0)
8916. 	# SetVariable(GapAdjusted, 			0)
8917. 	SetVariable(GapAvailable, 			0)
8918. 	SetVariable(GapCurrent, 			0)
8919. 	SetVariable(GapActual, 				0)
8920. 	SetVariable(GapUsed, 				0)
8921. 	
8922. 	# Gap Adjustments
8923. 	SetVariable(GapRoundedLoc, 			0)
8924. 	# SetVariable(GapAdjustedLoc, 		0)
8925. 	SetVariable(GapAvailableLoc, 		0)
8926. 	SetVariable(GapCurrentLoc, 			0)
8927. 	SetVariable(GapActualLoc,			0)
8928. 	SetVariable(GapUsedLoc,				0)
8929. 	
8930. 	# Space usage
8931. 	SetVariable(ZoneFreePerRequested, 	0)
8932. 	SetVariable(ZoneFreePerUsed, 		0)
8933. 
8934. # Gap Size & Rounding
8935. 	SetVariable(ZoneGapSizePer, 		0)
8936. 	SetVariable(ZoneVolRoundUpPer, 		0)
8937. 	
8938. 	# Free Space
8939. 	SetVariable(ZoneFreeUsedPer, 		0)
8940. 	SetVariable(ZoneFreeRequestedPer, 	0)
8941. 
8942. 
8943. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
8944. 
8945. # Footer:
8946. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
8947. # 2021-11-17 21:08:28
8948. 
8949. SetVariable(ZoneFooter1, "----------------------------------------------------------
8950. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
8951. #
8952. # Xinclude "..\Commands\DateTimeLastLong.txt"X
8953. #
8954. SetVariable(ZoneFooter2, "Statistics Report:
8955. ------------------
8956.    Size:  
8957.    ------------------------
8958.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8959.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8960.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8961. 
8962.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8963.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8964. 
8965.    Location:
8966.    ------------------------
8967.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8968.             Files End: !ZoneEndCurrent!
8969.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8970.       
8971.    Gap Settings:
8972.    ------------------------
8973.          Gap Requested: !ZoneGapSizePer!%
8974.        Volume Rounding: !ZoneVolRoundUpPer!%
8975.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8976.                  
8977.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
8978.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
8979.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
8980.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
8981.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
8982.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
8983.      
8984.    Free Space after Zone:
8985.    ------------------------
8986.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8987.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8988.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8989. 
8990. Directory and Files Select:
8991. ---------------------------
8992. !ZoneTypeSelectCurrent!               
8993. ---------------------------
8994. ----------------------------------------------------------
8995. ")
8996. 
8997. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
8998. 
8999. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
9000. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
9001. RunProgram("..\Commands\WriteDateTime.bat LastZone")
9002. 
9003. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
9004. 
9005. 
9006. 
9007. # Script: BannerSet
9008. 
9009. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
9010. 
9011. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
9012. 
9013. Title('!Heading!')
9014. /* pause(1) */
9015. 
9016. /* NOTE: Can't round or truncate to integer precision. */
9017. 
9018. # Script: BannerLog
9019. 
9020. AppendLogfile("!LogFileName!", "!Title!")
9021. 
9022. 
9023. 
9024. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
9025. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
9026. 
9027. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
9028. 
9029. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:27")
9030. 
9031. # 2021-11-17 21:08:27 
9032. SetVariable(Temp9, DATETIME)
9033. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:02 !ZoneLabel! !ZoneDescription!")
9034. 
9035. SetVariable(ZoneListByLine, "!ZoneListByLine! 
9036. Zone: !ZoneNoCurrent! !Temp9! 0:00:02 !ZoneLabel! !ZoneDescription!")
9037. 
9038. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:02 !ZoneLabel! !ZoneDescription!")
9039. 
9040. 
9041. /* Fixed Zone Position Handling */
9042. /* Literal number: */
9043. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
9044. /* Percentage of disk: */
9045. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
9046. /* Gap */
9047. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
9048. 
9049. /* ---------------------------------------------------------- */
9050. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
9051. # Script: DisplaySetFileStep
9052. 
9053. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9054. 
9055. /* add message and move to a new line. */
9056. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9057. ")
9058. 
9059. /* display the line. (hopefully.) */
9060. # Zone Footer Set Statistics Window Text
9061. 
9062. SetStatisticsWindowText("!Heading!
9063. ----------------------------------------------------------
9064. Zones Processed: 
9065. ----------------------------------------------------------
9066. !ZoneListByLine!
9067. ----------------------------------------------------------
9068. Zone Processing Step:
9069. !ZoneStepByLine!    
9070. ----------------------------------------------------------
9071. ----------------------------------------------------------
9072. Current Zone:
9073. !ZoneFooter!
9074. ----------------------------------------------------------
9075. ----------------------------------------------------------
9076. Volume Statistics:
9077. !VolumeStatisticsDetail!
9078. ----------------------------------------------------------
9079. ----------------------------------------------------------
9080. Zone Detailed Report:
9081. ----------------------------------------------------------
9082. !ZoneStatisticsDetail!
9083. ----------------------------------------------------------
9084. ")
9085. 
9086. 
9087. 
9088. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9089. 
9090. # Script: BannerSet
9091. 
9092. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
9093. 
9094. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
9095. 
9096. Title('!Heading!')
9097. /* pause(1) */
9098. 
9099. /* NOTE: Can't round or truncate to integer precision. */
9100. 
9101. pause(1)
9102. 
9103. # your stuff HERE (X)... pre file select code.
9104. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
9105. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9106. 	# (X)
9107. 
9108. FileSelect
9109. 
9110. 	# your stuff can't really go here (errors.)
9111. 	# maybe for some reason I don't know of...
9112. 	
9113. 	# Actions next...
9114. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
9115. # Programs start.
9116. # NotBlobsArchivesBu start.
9117. (not (
9118. # Blobs start.
9119. (
9120. # BlobsAndExceptions start.
9121. ( not(
9122.   FileName("*.bat")
9123.   or FileName("*.css")
9124.   or FileName("*.dll")
9125.   or FileName("*.exe")
9126.   or FileName("*.htm*")
9127.   or FileName("*.jar")
9128.   or FileName("*.js")
9129.   or FileName("*.script")
9130.   or FileName("*.wsf")
9131.   or (
9132. # Databases start.
9133. (
9134.   FileName("*.crypt*")
9135.   or FileName("*.db*")
9136.   or FileName("*.rdb*")
9137.   or FileName("*.dc*")
9138.   or FileName("*.dict*")
9139.   or FileName("*.?db*")
9140.   or FileName("*.?rdb*")
9141.   or FileName("*.md*")
9142.   or FileName("*.myd")
9143.   or FileName("*.ndf")
9144.   or FileName("*.ns?")
9145.   or FileName("*.pab")
9146.   or FileName("*.pst")
9147.   or FileName("*.sd?*")
9148.   or FileName("*.sq**")
9149.   or FileName("*.tmd")
9150.   or FileName("*.tps")
9151.   or FileName("*.tr*")
9152. )
9153. # Databases end.
9154. 
9155.     # BlobsAndExceptions
9156.     or 
9157. # Data start.
9158. (
9159.   DirectoryName("Data*")
9160.   or DirectoryName("Device*")
9161.   or DirectoryName("Export*")
9162.   or DirectoryName("Import*")
9163.   or DirectoryName("Log*")
9164.   or DirectoryName("*Log")
9165.   or DirectoryName("Maintenance*")
9166.   or DirectoryName("Rec*")
9167.   or DirectoryName("Sales*")
9168.   or DirectoryName("Search*")
9169.   or DirectoryName("User*")
9170. )
9171. # Data end.
9172. 
9173.     # BlobsAndExceptions
9174.   )
9175. ) )
9176. # BlobsAndExceptions end.
9177. 
9178. # Blobs
9179. ) and (
9180.   Size(BlobFileSize,0)
9181.   or (
9182.     FileName("*.arj")
9183.     or FileName("*.bup")
9184.     or FileName("*.bz2")
9185.     or FileName("*.chm")
9186.     or FileName("*.dvr-ms")
9187.     or FileName("*.gz")
9188.     or FileName("*.ifo")
9189.     or FileName("*.lzh")
9190.     or FileName("*.pdf")
9191.     or FileName("*.rpm")
9192.     or FileName("*.wmv")
9193.     or FileName("*.vob")
9194.     or FileName("*.z")
9195.   ) 
9196. )
9197. # Blobs end.
9198. 
9199. # NotBlobsArchivesBu
9200. or 
9201. # Archives start.
9202. (
9203.   DirectoryName("*Archive*")
9204.   or DirectoryName("*History*")
9205.   or DirectoryName("*Old")
9206.   or DirectoryName("* Old *")
9207.   or DirectoryName("Old *")
9208. 
9209.   or FileName("*.7z")
9210.   or FileName("*.cab")
9211.   or FileName("*.iso")
9212.   or FileName("*.msi")
9213.   or FileName("*.old")
9214.   or FileName("*.rar")
9215.   or FileName("*.tar")
9216.   or FileName("*.zip")
9217.   or
9218. # WinSysLow start.
9219. (
9220.   # Bad idea. This pushed lots of programs and data to archive.
9221.   # DirectoryName("$*")
9222.   # or DirectoryName("0*")
9223.   # or DirectoryName("1*")
9224.   # or DirectoryName("2*")
9225.   # or DirectoryName("3*")
9226.   # or DirectoryName("4*")
9227.   # or DirectoryName("5*")
9228.   # or DirectoryName("6*")
9229.   # or DirectoryName("7*")
9230.   # or DirectoryName("8*")
9231.   # or DirectoryName("9*")
9232.   # or 
9233.   DirectoryName("dllcache")
9234.   or DirectoryName("Downloaded Installations")
9235.   or DirectoryName("Ehome")
9236.   or DirectoryName("Fonts")
9237.   or DirectoryName("Help")
9238.   or DirectoryName("I386")
9239.   or DirectoryName("ie?updates")
9240.   or DirectoryName("Installer")
9241.   or DirectoryName("Installshield Installation Information")
9242.   or DirectoryName("IME")
9243.   or DirectoryName("*RECYCLE*")
9244.   or DirectoryName("ServicePackFiles")
9245.   or DirectoryName("SoftwareDistribution")
9246.   or DirectoryName("Speech")
9247.   or DirectoryName("Symbols")
9248.   or DirectoryName("System Volume Information")
9249.   or DirectoryName("windows.old")
9250. )
9251. # WinSysLow end.
9252. 
9253.   # Archives
9254. )
9255. # Archives end.
9256. 
9257. # NotBlobsArchivesBu
9258. or
9259. # Backups start.
9260. (
9261.   DirectoryName("*Backup*")
9262.   or DirectoryName("*Bu")
9263.   or DirectoryName("* Bu *")
9264.   or DirectoryName("Bu *")
9265. 
9266.   or FileName("*.bak")
9267.   or FileName("* - Copy*")
9268. )
9269. # Backups end.
9270. 
9271. # NotBlobsArchivesBu
9272. ) )
9273. # NotBlobsArchivesBu end.
9274. 
9275. # Programs
9276. and (
9277. # SystemDir start.
9278. (
9279.   DirectoryName("Boot*")
9280.   or DirectoryName("Device*")
9281.   or DirectoryName("DevSupport*")
9282.   or DirectoryName("Program*")
9283.   or DirectoryName("Security*")
9284.   or DirectoryName("SendTo*")
9285.   or DirectoryName("Sw*")
9286.   or DirectoryName("System*")
9287.   or DirectoryName("Toolbars")
9288.   or DirectoryName("Windows*")
9289. )
9290. # SystemDir end.
9291. 
9292. # Programs
9293. )
9294. # Programs end.
9295. 
9296. 		and not(
9297. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
9298. # Os Data Dynamic start.
9299. (
9300. # Os Data Dynamic start.
9301. (
9302.   FileName("*.dat*")
9303.   or FileName("*.db*")
9304.   or FileName("*.edb*")
9305.   or FileName("*.log*")
9306.   or FileName("DataStore.edb")
9307. )
9308. # Os Data Dynamic end.
9309. 
9310.   or 
9311. # Os PageHiberDump start.
9312. (
9313.   FileName("DataStore.edb")
9314.   or FileName("DUMP*.*")
9315.   or FileName("Hiberfil.sys")
9316.   or FileName("MEMORY.DMP")
9317.   or FileName("Pagefile.sys")
9318. )
9319. # Os PageHiberDump end.
9320. 
9321. # Os Data Dynamic
9322. )
9323. # Os Data Dynamic end.
9324. 
9325. 		)
9326. 
9327. 		FileActions
9328. 		  		/* ---------------------------------------------------------- */
9329. 	# Gap
9330. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
9331. 		# Script: DisplaySetFileStep
9332. 
9333. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9334. 
9335. /* add message and move to a new line. */
9336. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9337. ")
9338. 
9339. /* display the line. (hopefully.) */
9340. # Zone Footer Set Statistics Window Text
9341. 
9342. SetStatisticsWindowText("!Heading!
9343. ----------------------------------------------------------
9344. Zones Processed: 
9345. ----------------------------------------------------------
9346. !ZoneListByLine!
9347. ----------------------------------------------------------
9348. Zone Processing Step:
9349. !ZoneStepByLine!    
9350. ----------------------------------------------------------
9351. ----------------------------------------------------------
9352. Current Zone:
9353. !ZoneFooter!
9354. ----------------------------------------------------------
9355. ----------------------------------------------------------
9356. Volume Statistics:
9357. !VolumeStatisticsDetail!
9358. ----------------------------------------------------------
9359. ----------------------------------------------------------
9360. Zone Detailed Report:
9361. ----------------------------------------------------------
9362. !ZoneStatisticsDetail!
9363. ----------------------------------------------------------
9364. ")
9365. 
9366. 
9367. 
9368. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9369. 
9370. # Script: BannerSet
9371. 
9372. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
9373. 
9374. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
9375. 
9376. Title('!Heading!')
9377. /* pause(1) */
9378. 
9379. /* NOTE: Can't round or truncate to integer precision. */
9380. 
9381. pause(1)
9382. 	
9383. 	# ACTUAL GAP
9384. 		/* AddGap Variant. */
9385. 	  	# Zone Do Gap
9386. # Gap Calculation Methods:
9387. 
9388. /* 1) Anything you need to add first. */
9389. /* empty */
9390. 
9391. /* ---------------------------------------------------------- */
9392. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
9393. 	# GapRequestedStd.
9394. 
9395. 		/* ---------------------------------------------------------- */
9396. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
9397. 
9398. 		# Gap Calculation Methods:
9399. 
9400. /* AddGap Variants */
9401. 
9402. 	/* Standard */
9403. 		# Gap Calculation Methods:
9404. 	/* AddGap Variants */
9405. 	/* Standard */
9406. 
9407. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
9408. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
9409. 
9410. 	SetVariable(GapRequested, GapRequestedStd)
9411. 	
9412. 
9413. 	/* MFT Low High Method */
9414. 		# Gap Calculation Methods:
9415. 	/* AddGap Variants */
9416. 	/* MFT Low High Method */
9417. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
9418. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
9419. 	SetVariable(GapRequested, GapRequestedMft)
9420. 	
9421. 
9422. 	/* OS Volume Type Method */
9423. 		# Gap Calculation Methods:
9424. 	/* AddGap Variants */
9425. 	/* OS Volume Type Method */
9426. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
9427. 	SetVariable(GapRequested, GapRequestedOs)
9428. 
9429. 
9430. 
9431. /* MakeGap Variants */
9432. 
9433. 	/* Original Os 1-3 + MFT 2 */
9434. 		# Gap Calculation Methods:
9435. 	/* MakeGap Variants */
9436. 	/* Original Os 1-3 + MFT 2 */
9437. 	/* plus MFT gap placed inline at the dividing zone. */
9438. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
9439. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
9440. 	SetVariable(GapRequested, GapRequestedOrig)
9441. 	
9442. 	
9443. /* Note: You could comment out the ones not in use */
9444. /* However having the data in the log is useful. */
9445. /* Therefore the following line is otherwise needed. */
9446. 
9447. /* Standard used */
9448. 
9449. SetVariable(GapRequested, GapRequestedStd)
9450. 
9451. # Gap Calculation Methods:
9452. 
9453. /* AddGap Variants */
9454. 	/* Standard */
9455. 	/* MFT Low High Method */
9456. 	/* OS Volume Type Method */
9457. 
9458. /* MakeGap Variants */
9459. 	/* Original Os 1-3 + MFT 2 */
9460. 
9461. /* Note: You could comment out the ones not in use */
9462. /* However having the data in the log is useful. */
9463. /* Therefore the following line is otherwise needed. */
9464. 
9465. /* Standard is used currently */
9466. 
9467. 
9468. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
9469. 
9470. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
9471. 
9472. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
9473. 
9474. /* ---------------------------------------------------------- */
9475. /* 3) SMALL ZONE ADJUSTMENT. */
9476. /* Gab cant be larger than half the Zone Size. */
9477. 
9478. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
9479. 	
9480. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
9481. 
9482. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
9483. 
9484. /* ---------------------------------------------------------- */
9485. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
9486. # Gap Adjustments.
9487. 
9488. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
9489. 	
9490. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
9491. 
9492. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
9493. 
9494. /* ---------------------------------------------------------- */
9495. # BYPASS THIS.
9496. 	/* This is definitely wrong. */
9497. 	/* The question is can we steal gap from the next zone */
9498. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
9499. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
9500. 		# Zone Overflow.
9501. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
9502. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
9503. 
9504. /* ---------------------------------------------------------- */
9505. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
9506. # Remaining free space available.
9507. 
9508. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
9509. 	
9510. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
9511. 
9512. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
9513. 
9514. /* ---------------------------------------------------------- */
9515. # CURRENT gap to use.
9516. 
9517. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
9518. 
9519. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
9520. 
9521. /* ---------------------------------------------------------- */
9522. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
9523. # Debugging.
9524. 
9525. 	SetVariable(GapUsed, GapCurrent) // for debugging
9526. 
9527. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
9528. 
9529. 		# Your code HERE
9530. 
9531. /* ---------------------------------------------------------- */
9532. /* 7) YOUR CODE. */
9533. # YOUR CODE HERE:
9534. 	# INPUT: GapCurrent or GapCurrentLoc
9535. 	# OUTPUT: GapUsed...
9536. 
9537. /* ---------------------------------------------------------- */
9538. # Gap Size.
9539. # Actual Size of Gap.
9540. 
9541. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
9542. 
9543. /* ---------------------------------------------------------- */
9544. /* xxxxxxxxxxxxxxxxxxxxxx */
9545. # ADD THE GAP
9546. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
9547. /* xxxxxxxxxxxxxxxxxxxxxx */
9548. 
9549. 	
9550. 	# Zone Statistics	
9551. 	# Script: ZoneDoStatistics
9552. # Zone / Volume Statistics and Display
9553. 		
9554. 	# Accumulate Totals
9555.   	# Script: ZoneDoVolumeTotals
9556. 
9557. /* Current total space used (by Zones and Gaps) */
9558. 
9559. SetVariable(VolumeZoneUsed, GapUsed)
9560. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
9561. /* Percentage */
9562. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
9563. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
9564. 
9565. /* Current total of free space requested */
9566. 
9567. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
9568. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
9569. /* Percent. */
9570. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
9571. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
9572. 
9573. /* Current total of free space used */
9574. 
9575. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
9576. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
9577. /* Percent */
9578. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
9579. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
9580. 
9581. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
9582. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
9583. /* Xinclude "..\DebugDisplayPause.MyDc"X */
9584. 
9585. 
9586. 	# Current Values
9587. 	# Script: ZoneDoCurrentSet
9588. 
9589. # Cluster, Sector, Block adjust for display.
9590. 	# Bytes per cluster is volume specific.
9591. 
9592. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
9593. 
9594. # Current Zone values.
9595. 	# Begin, end and size.
9596. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
9597. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
9598. 
9599. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
9600. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
9601. 
9602. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
9603. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
9604. 
9605. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
9606. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
9607. 
9608. 	SetVariable(ZoneFragments,				"!ZONE210N!")
9609. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
9610. 		
9611. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
9612. /* identical code to here: (separation not needed. TEST.) */	
9613. 
9614. # Current Gap, Actual and Free Values
9615. 	# Gap
9616. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
9617. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
9618. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
9619. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
9620. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
9621. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
9622. 	
9623. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
9624. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
9625. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
9626. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
9627. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
9628. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
9629. 	
9630. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
9631. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
9632. 	
9633. 	# Actual Size and End
9634. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
9635. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
9636. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
9637. 	
9638. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
9639. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
9640. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
9641. 
9642. # Gap Size & Rounding
9643. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
9644. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
9645. 	
9646. 	# Free Space
9647. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
9648. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
9649. 
9650. 	# Footer:
9651. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
9652. # 2021-11-17 21:08:28
9653. 
9654. SetVariable(ZoneFooter1, "----------------------------------------------------------
9655. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
9656. #
9657. # Xinclude "..\Commands\DateTimeLastLong.txt"X
9658. #
9659. SetVariable(ZoneFooter2, "Statistics Report:
9660. ------------------
9661.    Size:  
9662.    ------------------------
9663.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9664.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9665.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9666. 
9667.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9668.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9669. 
9670.    Location:
9671.    ------------------------
9672.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9673.             Files End: !ZoneEndCurrent!
9674.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9675.       
9676.    Gap Settings:
9677.    ------------------------
9678.          Gap Requested: !ZoneGapSizePer!%
9679.        Volume Rounding: !ZoneVolRoundUpPer!%
9680.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9681.                  
9682.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
9683.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
9684.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
9685.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
9686.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
9687.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
9688.      
9689.    Free Space after Zone:
9690.    ------------------------
9691.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9692.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9693.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9694. 
9695. Directory and Files Select:
9696. ---------------------------
9697. !ZoneTypeSelectCurrent!               
9698. ---------------------------
9699. ----------------------------------------------------------
9700. ")
9701. 
9702. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
9703. 
9704. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
9705. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
9706. RunProgram("..\Commands\WriteDateTime.bat LastZone")
9707. 
9708. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
9709. 
9710. 
9711. 	# Zone Footer Set Statistics Window Text
9712. 
9713. SetStatisticsWindowText("!Heading!
9714. ----------------------------------------------------------
9715. Zones Processed: 
9716. ----------------------------------------------------------
9717. !ZoneListByLine!
9718. ----------------------------------------------------------
9719. Zone Processing Step:
9720. !ZoneStepByLine!    
9721. ----------------------------------------------------------
9722. ----------------------------------------------------------
9723. Current Zone:
9724. !ZoneFooter!
9725. ----------------------------------------------------------
9726. ----------------------------------------------------------
9727. Volume Statistics:
9728. !VolumeStatisticsDetail!
9729. ----------------------------------------------------------
9730. ----------------------------------------------------------
9731. Zone Detailed Report:
9732. ----------------------------------------------------------
9733. !ZoneStatisticsDetail!
9734. ----------------------------------------------------------
9735. ")
9736. 
9737. 
9738. 	
9739.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
9740. 
9741. 	# Add Zone to list of zones for display.
9742. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
9743. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
9744. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
9745. 	# ??? Free Stats?
9746. 	# Footer:
9747. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
9748. # 2021-11-17 21:08:28
9749. 
9750. SetVariable(ZoneFooter1, "----------------------------------------------------------
9751. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
9752. #
9753. # Xinclude "..\Commands\DateTimeLastLong.txt"X
9754. #
9755. SetVariable(ZoneFooter2, "Statistics Report:
9756. ------------------
9757.    Size:  
9758.    ------------------------
9759.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9760.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9761.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9762. 
9763.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9764.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9765. 
9766.    Location:
9767.    ------------------------
9768.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9769.             Files End: !ZoneEndCurrent!
9770.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9771.       
9772.    Gap Settings:
9773.    ------------------------
9774.          Gap Requested: !ZoneGapSizePer!%
9775.        Volume Rounding: !ZoneVolRoundUpPer!%
9776.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9777.                  
9778.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
9779.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
9780.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
9781.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
9782.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
9783.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
9784.      
9785.    Free Space after Zone:
9786.    ------------------------
9787.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9788.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9789.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9790. 
9791. Directory and Files Select:
9792. ---------------------------
9793. !ZoneTypeSelectCurrent!               
9794. ---------------------------
9795. ----------------------------------------------------------
9796. ")
9797. 
9798. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
9799. 
9800. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
9801. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
9802. RunProgram("..\Commands\WriteDateTime.bat LastZone")
9803. 
9804. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
9805. 
9806. 
9807. 
9808. 	# Add Zone Details to Report.	
9809. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
9810. !ZoneFooter!")
9811. 
9812. 
9813. 	
9814. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
9815. 			# Script: DisplaySetFileStep
9816. 
9817. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9818. 
9819. /* add message and move to a new line. */
9820. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9821. ")
9822. 
9823. /* display the line. (hopefully.) */
9824. # Zone Footer Set Statistics Window Text
9825. 
9826. SetStatisticsWindowText("!Heading!
9827. ----------------------------------------------------------
9828. Zones Processed: 
9829. ----------------------------------------------------------
9830. !ZoneListByLine!
9831. ----------------------------------------------------------
9832. Zone Processing Step:
9833. !ZoneStepByLine!    
9834. ----------------------------------------------------------
9835. ----------------------------------------------------------
9836. Current Zone:
9837. !ZoneFooter!
9838. ----------------------------------------------------------
9839. ----------------------------------------------------------
9840. Volume Statistics:
9841. !VolumeStatisticsDetail!
9842. ----------------------------------------------------------
9843. ----------------------------------------------------------
9844. Zone Detailed Report:
9845. ----------------------------------------------------------
9846. !ZoneStatisticsDetail!
9847. ----------------------------------------------------------
9848. ")
9849. 
9850. 
9851. 
9852. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9853. 
9854. # Script: BannerSet
9855. 
9856. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
9857. 
9858. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
9859. 
9860. Title('!Heading!')
9861. /* pause(1) */
9862. 
9863. /* NOTE: Can't round or truncate to integer precision. */
9864. 
9865. pause(1)
9866. 
9867. 			# File Action - Type Os Programs Fixed - Regular - MoveUpToZone.
9868. # File Action - SortByImportSequence with SkipBlock.
9869. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
9870. 	
9871. 	
9872. 	
9873. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
9874. 			# Script: DisplaySetFileStep
9875. 
9876. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9877. 
9878. /* add message and move to a new line. */
9879. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9880. ")
9881. 
9882. /* display the line. (hopefully.) */
9883. # Zone Footer Set Statistics Window Text
9884. 
9885. SetStatisticsWindowText("!Heading!
9886. ----------------------------------------------------------
9887. Zones Processed: 
9888. ----------------------------------------------------------
9889. !ZoneListByLine!
9890. ----------------------------------------------------------
9891. Zone Processing Step:
9892. !ZoneStepByLine!    
9893. ----------------------------------------------------------
9894. ----------------------------------------------------------
9895. Current Zone:
9896. !ZoneFooter!
9897. ----------------------------------------------------------
9898. ----------------------------------------------------------
9899. Volume Statistics:
9900. !VolumeStatisticsDetail!
9901. ----------------------------------------------------------
9902. ----------------------------------------------------------
9903. Zone Detailed Report:
9904. ----------------------------------------------------------
9905. !ZoneStatisticsDetail!
9906. ----------------------------------------------------------
9907. ")
9908. 
9909. 
9910. 
9911. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9912. 
9913. # Script: BannerSet
9914. 
9915. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
9916. 
9917. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
9918. 
9919. Title('!Heading!')
9920. /* pause(1) */
9921. 
9922. /* NOTE: Can't round or truncate to integer precision. */
9923. 
9924. pause(1)
9925. 
9926. 		# Script: ZoneDoFooter
9927. 
9928. /* ---------------------------------------------------------- */
9929. # File Select
9930. 	# Select Statments
9931. # File Actions 
9932. 	# Standard or OS File Actions.
9933. 	# Resume...
9934. 	
9935. 	# your stuff HERE (X)... post zone (file) file actions code.
9936. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
9937. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9938. 		# (X)
9939. 		
9940. 		/* ??? Set window? */
9941. 	
9942. 	# ADD THE GAP
9943. # Vacate (good for diagnostics)
9944. # DoNotVacate - DO NOT Vacate (recommended)
9945. # DoNotVacate - DO NOT Vacate (recommended)
9946. 
9947. # Vacate
9948. /* AddGap(GapUsedLoc) */
9949. 
9950. # DO Not Vacate
9951. AddGap(GapUsedLoc, DoNotVacate) 
9952. 	
9953. 	
9954. # Script: GapZoneCommand
9955. # *** Moved to setting yours ***
9956. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
9957. # Controlled via settings commands
9958. # DoNotVacate - DO NOT Vacate (recommended)
9959. 
9960. # Vacate
9961. /* AddGap(GapUsedLoc) */
9962. 
9963. # DO Not Vacate
9964. AddGap(GapUsedLoc, DoNotVacate) 
9965. 	
9966. 	
9967. # Vacate /* AddGap(GapUsed) */
9968. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
9969. 	
9970. 
9971. 		
9972. # 
9973. FileEnd
9974. /* ---------------------------------------------------------- */
9975. 
9976. # your stuff HERE (X)... post zone (file) code.
9977. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
9978. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9979. 	# (X)
9980. 
9981. SetVariable(FileStepDescription,"Zone finished, reporting.")
9982. # Script: DisplaySetFileStep
9983. 
9984. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9985. 
9986. /* add message and move to a new line. */
9987. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9988. ")
9989. 
9990. /* display the line. (hopefully.) */
9991. # Zone Footer Set Statistics Window Text
9992. 
9993. SetStatisticsWindowText("!Heading!
9994. ----------------------------------------------------------
9995. Zones Processed: 
9996. ----------------------------------------------------------
9997. !ZoneListByLine!
9998. ----------------------------------------------------------
9999. Zone Processing Step:
10000. !ZoneStepByLine!    
10001. ----------------------------------------------------------
10002. ----------------------------------------------------------
10003. Current Zone:
10004. !ZoneFooter!
10005. ----------------------------------------------------------
10006. ----------------------------------------------------------
10007. Volume Statistics:
10008. !VolumeStatisticsDetail!
10009. ----------------------------------------------------------
10010. ----------------------------------------------------------
10011. Zone Detailed Report:
10012. ----------------------------------------------------------
10013. !ZoneStatisticsDetail!
10014. ----------------------------------------------------------
10015. ")
10016. 
10017. 
10018. 
10019. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10020. 
10021. # Script: BannerSet
10022. 
10023. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10024. 
10025. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
10026. 
10027. Title('!Heading!')
10028. /* pause(1) */
10029. 
10030. /* NOTE: Can't round or truncate to integer precision. */
10031. 
10032. pause(1)
10033. 
10034. # Script: ZoneWhenFinished
10035. 
10036. # Script: BannerSet
10037. 
10038. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10039. 
10040. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
10041. 
10042. Title('!Heading!')
10043. /* pause(1) */
10044. 
10045. /* NOTE: Can't round or truncate to integer precision. */
10046. 
10047. # Script: BannerLog
10048. 
10049. AppendLogfile("!LogFileName!", "!Title!")
10050. 
10051. 
10052. 
10053. # Zone Statistics	
10054. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
10055. 
10056. # Footer:
10057. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
10058. # 2021-11-17 21:08:28
10059. 
10060. SetVariable(ZoneFooter1, "----------------------------------------------------------
10061. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
10062. #
10063. # Xinclude "..\Commands\DateTimeLastLong.txt"X
10064. #
10065. SetVariable(ZoneFooter2, "Statistics Report:
10066. ------------------
10067.    Size:  
10068.    ------------------------
10069.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10070.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10071.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10072. 
10073.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10074.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10075. 
10076.    Location:
10077.    ------------------------
10078.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10079.             Files End: !ZoneEndCurrent!
10080.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10081.       
10082.    Gap Settings:
10083.    ------------------------
10084.          Gap Requested: !ZoneGapSizePer!%
10085.        Volume Rounding: !ZoneVolRoundUpPer!%
10086.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10087.                  
10088.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
10089.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
10090.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
10091.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
10092.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
10093.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
10094.      
10095.    Free Space after Zone:
10096.    ------------------------
10097.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10098.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10099.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10100. 
10101. Directory and Files Select:
10102. ---------------------------
10103. !ZoneTypeSelectCurrent!               
10104. ---------------------------
10105. ----------------------------------------------------------
10106. ")
10107. 
10108. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
10109. 
10110. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
10111. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
10112. RunProgram("..\Commands\WriteDateTime.bat LastZone")
10113. 
10114. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
10115. 
10116. 
10117. 
10118. AppendLogfile("!LogFileName!", ".")
10119. AppendLogfile("!LogFileName!", "!ZoneFooter!")
10120. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
10121. AppendLogfile("!LogFileName!", ".")
10122. 
10123. # Zone Footer Set Statistics Window Text
10124. 
10125. SetStatisticsWindowText("!Heading!
10126. ----------------------------------------------------------
10127. Zones Processed: 
10128. ----------------------------------------------------------
10129. !ZoneListByLine!
10130. ----------------------------------------------------------
10131. Zone Processing Step:
10132. !ZoneStepByLine!    
10133. ----------------------------------------------------------
10134. ----------------------------------------------------------
10135. Current Zone:
10136. !ZoneFooter!
10137. ----------------------------------------------------------
10138. ----------------------------------------------------------
10139. Volume Statistics:
10140. !VolumeStatisticsDetail!
10141. ----------------------------------------------------------
10142. ----------------------------------------------------------
10143. Zone Detailed Report:
10144. ----------------------------------------------------------
10145. !ZoneStatisticsDetail!
10146. ----------------------------------------------------------
10147. ")
10148. 
10149. 
10150. 
10151. /* pause() */
10152. /* pause() */
10153. 
10154. 
10155. 
10156. 	
10157. /* ---------------------------------------------------------- */
10158. # Zone Program Data.
10159. 	# Script: DisplayColors - Zone Dark
10160. # Processed
10161. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
10162. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
10163. 
10164. # Light Green and Yellow
10165. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
10166. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
10167. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
10168. 
10169. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsData!")
10170. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsData!")
10171. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
10172. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
10173. 	SetVariable(ZoneTypeSelect,'
10174.                 # Programs - Data files.
10175.                 not(
10176.                 # Os PageHiberDump start.
10177. (
10178.   FileName("DataStore.edb")
10179.   or FileName("DUMP*.*")
10180.   or FileName("Hiberfil.sys")
10181.   or FileName("MEMORY.DMP")
10182.   or FileName("Pagefile.sys")
10183. )
10184. # Os PageHiberDump end.
10185. 
10186.                 )
10187. ')
10188. 
10189. 		# Script: ZoneDoHeader
10190. 
10191. # Script: ZoneWhenStarted
10192. RunProgram("..\Commands\WriteDateTime.bat")
10193. 
10194. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
10195. # Script: DisplaySetZone
10196. 
10197. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
10198. SetVariable(FileStepDescription,	"")
10199. 
10200. SetVariable(ZoneStepByLine, 			"Zone started.
10201. ")
10202. 
10203. # Script: BannerDescriptionSet
10204. 
10205. # Script: BannerSet
10206. 
10207. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10208. 
10209. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
10210. 
10211. Title('!Heading!')
10212. /* pause(1) */
10213. 
10214. /* NOTE: Can't round or truncate to integer precision. */
10215. 
10216. # Script: BannerLog
10217. 
10218. AppendLogfile("!LogFileName!", "!Title!")
10219. 
10220. 
10221. 
10222. pause(1)
10223. 
10224. 
10225. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
10226. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
10227. 
10228. SetVariable(ZoneStepNoCurrent, 0)
10229. 
10230. 
10231. # Script: ZoneDoCurrentClear
10232. 
10233. SetVariable(ZoneTypeSelectCurrent, 		"")
10234. 
10235. SetVariable(ZoneBeginCurrent, 			0)
10236. SetVariable(ZoneBeginPerCurrent, 		0)
10237. SetVariable(ZoneEndCurrent, 			0)
10238. SetVariable(ZoneEndPerCurrent, 			0)
10239. 
10240. SetVariable(ZoneSizeCurrent,			0)
10241. SetVariable(ZoneSizePerCurrent,			0)
10242. 
10243. SetVariable(ZoneGapRequestedCurrent,	0)
10244. SetVariable(ZoneGapRoundedCurrent, 		0)
10245. SetVariable(ZoneGapAdjustedCurrent, 	0)
10246. SetVariable(ZoneGapAvailableCurrent, 	0)
10247. SetVariable(ZoneGapCurrent,				0)
10248. SetVariable(ZoneGapUsedCurrent, 		0)
10249. 
10250. SetVariable(ZoneGapActualCurrent, 		0)
10251. SetVariable(ZoneGapActualPerCurrent, 	0)
10252. 
10253. SetVariable(ZoneSizeActual, 			0)
10254. SetVariable(ZoneSizeActualCurrent,		0)
10255. 
10256. SetVariable(ZoneEndActual, 				0)
10257. SetVariable(ZoneEndActualCurrent,		0)			
10258. SetVariable(ZoneSizeActualPerCurrent, 	0)
10259.       
10260. SetVariable(ZoneFilesFolders,			0)
10261. SetVariable(ZoneFilesFoldersPer,		0) 
10262. 
10263. SetVariable(ZoneFragments,				0)
10264. SetVariable(ZoneFragmentsPer,			0) 
10265. 		
10266. SetVariable(ZoneEndActualCurrent, 		0)
10267. SetVariable(ZoneEndActualPerCurrent, 	0)
10268. 
10269. # Gap Calculation Methodology:
10270. 	# Requested
10271. 	SetVariable(GapRequested, 			0) 
10272. 	SetVariable(GapRequestedStd, 		0) 
10273. 	SetVariable(GapRequestedMft, 		0) 
10274. 	SetVariable(GapRequestedOs, 		0) 
10275. 	SetVariable(GapRequestedOriginal, 	0) 
10276. 	
10277. 	# Gap Adjustments
10278. 	SetVariable(GapRounded, 			0)
10279. 	# SetVariable(GapAdjusted, 			0)
10280. 	SetVariable(GapAvailable, 			0)
10281. 	SetVariable(GapCurrent, 			0)
10282. 	SetVariable(GapActual, 				0)
10283. 	SetVariable(GapUsed, 				0)
10284. 	
10285. 	# Gap Adjustments
10286. 	SetVariable(GapRoundedLoc, 			0)
10287. 	# SetVariable(GapAdjustedLoc, 		0)
10288. 	SetVariable(GapAvailableLoc, 		0)
10289. 	SetVariable(GapCurrentLoc, 			0)
10290. 	SetVariable(GapActualLoc,			0)
10291. 	SetVariable(GapUsedLoc,				0)
10292. 	
10293. 	# Space usage
10294. 	SetVariable(ZoneFreePerRequested, 	0)
10295. 	SetVariable(ZoneFreePerUsed, 		0)
10296. 
10297. # Gap Size & Rounding
10298. 	SetVariable(ZoneGapSizePer, 		0)
10299. 	SetVariable(ZoneVolRoundUpPer, 		0)
10300. 	
10301. 	# Free Space
10302. 	SetVariable(ZoneFreeUsedPer, 		0)
10303. 	SetVariable(ZoneFreeRequestedPer, 	0)
10304. 
10305. 
10306. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
10307. 
10308. # Footer:
10309. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
10310. # 2021-11-17 21:08:28
10311. 
10312. SetVariable(ZoneFooter1, "----------------------------------------------------------
10313. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
10314. #
10315. # Xinclude "..\Commands\DateTimeLastLong.txt"X
10316. #
10317. SetVariable(ZoneFooter2, "Statistics Report:
10318. ------------------
10319.    Size:  
10320.    ------------------------
10321.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10322.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10323.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10324. 
10325.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10326.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10327. 
10328.    Location:
10329.    ------------------------
10330.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10331.             Files End: !ZoneEndCurrent!
10332.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10333.       
10334.    Gap Settings:
10335.    ------------------------
10336.          Gap Requested: !ZoneGapSizePer!%
10337.        Volume Rounding: !ZoneVolRoundUpPer!%
10338.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10339.                  
10340.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
10341.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
10342.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
10343.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
10344.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
10345.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
10346.      
10347.    Free Space after Zone:
10348.    ------------------------
10349.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10350.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10351.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10352. 
10353. Directory and Files Select:
10354. ---------------------------
10355. !ZoneTypeSelectCurrent!               
10356. ---------------------------
10357. ----------------------------------------------------------
10358. ")
10359. 
10360. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
10361. 
10362. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
10363. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
10364. RunProgram("..\Commands\WriteDateTime.bat LastZone")
10365. 
10366. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
10367. 
10368. 
10369. 
10370. # Script: BannerSet
10371. 
10372. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10373. 
10374. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
10375. 
10376. Title('!Heading!')
10377. /* pause(1) */
10378. 
10379. /* NOTE: Can't round or truncate to integer precision. */
10380. 
10381. # Script: BannerLog
10382. 
10383. AppendLogfile("!LogFileName!", "!Title!")
10384. 
10385. 
10386. 
10387. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
10388. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
10389. 
10390. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
10391. 
10392. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:28")
10393. 
10394. # 2021-11-17 21:08:28 
10395. SetVariable(Temp9, DATETIME)
10396. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:03 !ZoneLabel! !ZoneDescription!")
10397. 
10398. SetVariable(ZoneListByLine, "!ZoneListByLine! 
10399. Zone: !ZoneNoCurrent! !Temp9! 0:00:03 !ZoneLabel! !ZoneDescription!")
10400. 
10401. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:03 !ZoneLabel! !ZoneDescription!")
10402. 
10403. 
10404. /* Fixed Zone Position Handling */
10405. /* Literal number: */
10406. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
10407. /* Percentage of disk: */
10408. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
10409. /* Gap */
10410. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
10411. 
10412. /* ---------------------------------------------------------- */
10413. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
10414. # Script: DisplaySetFileStep
10415. 
10416. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10417. 
10418. /* add message and move to a new line. */
10419. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10420. ")
10421. 
10422. /* display the line. (hopefully.) */
10423. # Zone Footer Set Statistics Window Text
10424. 
10425. SetStatisticsWindowText("!Heading!
10426. ----------------------------------------------------------
10427. Zones Processed: 
10428. ----------------------------------------------------------
10429. !ZoneListByLine!
10430. ----------------------------------------------------------
10431. Zone Processing Step:
10432. !ZoneStepByLine!    
10433. ----------------------------------------------------------
10434. ----------------------------------------------------------
10435. Current Zone:
10436. !ZoneFooter!
10437. ----------------------------------------------------------
10438. ----------------------------------------------------------
10439. Volume Statistics:
10440. !VolumeStatisticsDetail!
10441. ----------------------------------------------------------
10442. ----------------------------------------------------------
10443. Zone Detailed Report:
10444. ----------------------------------------------------------
10445. !ZoneStatisticsDetail!
10446. ----------------------------------------------------------
10447. ")
10448. 
10449. 
10450. 
10451. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10452. 
10453. # Script: BannerSet
10454. 
10455. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10456. 
10457. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
10458. 
10459. Title('!Heading!')
10460. /* pause(1) */
10461. 
10462. /* NOTE: Can't round or truncate to integer precision. */
10463. 
10464. pause(1)
10465. 
10466. # your stuff HERE (X)... pre file select code.
10467. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
10468. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
10469. 	# (X)
10470. 
10471. FileSelect
10472. 
10473. 	# your stuff can't really go here (errors.)
10474. 	# maybe for some reason I don't know of...
10475. 	
10476. 	# Actions next...
10477. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
10478. # Programs start.
10479. # NotBlobsArchivesBu start.
10480. (not (
10481. # Blobs start.
10482. (
10483. # BlobsAndExceptions start.
10484. ( not(
10485.   FileName("*.bat")
10486.   or FileName("*.css")
10487.   or FileName("*.dll")
10488.   or FileName("*.exe")
10489.   or FileName("*.htm*")
10490.   or FileName("*.jar")
10491.   or FileName("*.js")
10492.   or FileName("*.script")
10493.   or FileName("*.wsf")
10494.   or (
10495. # Databases start.
10496. (
10497.   FileName("*.crypt*")
10498.   or FileName("*.db*")
10499.   or FileName("*.rdb*")
10500.   or FileName("*.dc*")
10501.   or FileName("*.dict*")
10502.   or FileName("*.?db*")
10503.   or FileName("*.?rdb*")
10504.   or FileName("*.md*")
10505.   or FileName("*.myd")
10506.   or FileName("*.ndf")
10507.   or FileName("*.ns?")
10508.   or FileName("*.pab")
10509.   or FileName("*.pst")
10510.   or FileName("*.sd?*")
10511.   or FileName("*.sq**")
10512.   or FileName("*.tmd")
10513.   or FileName("*.tps")
10514.   or FileName("*.tr*")
10515. )
10516. # Databases end.
10517. 
10518.     # BlobsAndExceptions
10519.     or 
10520. # Data start.
10521. (
10522.   DirectoryName("Data*")
10523.   or DirectoryName("Device*")
10524.   or DirectoryName("Export*")
10525.   or DirectoryName("Import*")
10526.   or DirectoryName("Log*")
10527.   or DirectoryName("*Log")
10528.   or DirectoryName("Maintenance*")
10529.   or DirectoryName("Rec*")
10530.   or DirectoryName("Sales*")
10531.   or DirectoryName("Search*")
10532.   or DirectoryName("User*")
10533. )
10534. # Data end.
10535. 
10536.     # BlobsAndExceptions
10537.   )
10538. ) )
10539. # BlobsAndExceptions end.
10540. 
10541. # Blobs
10542. ) and (
10543.   Size(BlobFileSize,0)
10544.   or (
10545.     FileName("*.arj")
10546.     or FileName("*.bup")
10547.     or FileName("*.bz2")
10548.     or FileName("*.chm")
10549.     or FileName("*.dvr-ms")
10550.     or FileName("*.gz")
10551.     or FileName("*.ifo")
10552.     or FileName("*.lzh")
10553.     or FileName("*.pdf")
10554.     or FileName("*.rpm")
10555.     or FileName("*.wmv")
10556.     or FileName("*.vob")
10557.     or FileName("*.z")
10558.   ) 
10559. )
10560. # Blobs end.
10561. 
10562. # NotBlobsArchivesBu
10563. or 
10564. # Archives start.
10565. (
10566.   DirectoryName("*Archive*")
10567.   or DirectoryName("*History*")
10568.   or DirectoryName("*Old")
10569.   or DirectoryName("* Old *")
10570.   or DirectoryName("Old *")
10571. 
10572.   or FileName("*.7z")
10573.   or FileName("*.cab")
10574.   or FileName("*.iso")
10575.   or FileName("*.msi")
10576.   or FileName("*.old")
10577.   or FileName("*.rar")
10578.   or FileName("*.tar")
10579.   or FileName("*.zip")
10580.   or
10581. # WinSysLow start.
10582. (
10583.   # Bad idea. This pushed lots of programs and data to archive.
10584.   # DirectoryName("$*")
10585.   # or DirectoryName("0*")
10586.   # or DirectoryName("1*")
10587.   # or DirectoryName("2*")
10588.   # or DirectoryName("3*")
10589.   # or DirectoryName("4*")
10590.   # or DirectoryName("5*")
10591.   # or DirectoryName("6*")
10592.   # or DirectoryName("7*")
10593.   # or DirectoryName("8*")
10594.   # or DirectoryName("9*")
10595.   # or 
10596.   DirectoryName("dllcache")
10597.   or DirectoryName("Downloaded Installations")
10598.   or DirectoryName("Ehome")
10599.   or DirectoryName("Fonts")
10600.   or DirectoryName("Help")
10601.   or DirectoryName("I386")
10602.   or DirectoryName("ie?updates")
10603.   or DirectoryName("Installer")
10604.   or DirectoryName("Installshield Installation Information")
10605.   or DirectoryName("IME")
10606.   or DirectoryName("*RECYCLE*")
10607.   or DirectoryName("ServicePackFiles")
10608.   or DirectoryName("SoftwareDistribution")
10609.   or DirectoryName("Speech")
10610.   or DirectoryName("Symbols")
10611.   or DirectoryName("System Volume Information")
10612.   or DirectoryName("windows.old")
10613. )
10614. # WinSysLow end.
10615. 
10616.   # Archives
10617. )
10618. # Archives end.
10619. 
10620. # NotBlobsArchivesBu
10621. or
10622. # Backups start.
10623. (
10624.   DirectoryName("*Backup*")
10625.   or DirectoryName("*Bu")
10626.   or DirectoryName("* Bu *")
10627.   or DirectoryName("Bu *")
10628. 
10629.   or FileName("*.bak")
10630.   or FileName("* - Copy*")
10631. )
10632. # Backups end.
10633. 
10634. # NotBlobsArchivesBu
10635. ) )
10636. # NotBlobsArchivesBu end.
10637. 
10638. # Programs
10639. and (
10640. # SystemDir start.
10641. (
10642.   DirectoryName("Boot*")
10643.   or DirectoryName("Device*")
10644.   or DirectoryName("DevSupport*")
10645.   or DirectoryName("Program*")
10646.   or DirectoryName("Security*")
10647.   or DirectoryName("SendTo*")
10648.   or DirectoryName("Sw*")
10649.   or DirectoryName("System*")
10650.   or DirectoryName("Toolbars")
10651.   or DirectoryName("Windows*")
10652. )
10653. # SystemDir end.
10654. 
10655. # Programs
10656. )
10657. # Programs end.
10658. 
10659. 		and not(
10660. 			# Os PageHiberDump start.
10661. (
10662.   FileName("DataStore.edb")
10663.   or FileName("DUMP*.*")
10664.   or FileName("Hiberfil.sys")
10665.   or FileName("MEMORY.DMP")
10666.   or FileName("Pagefile.sys")
10667. )
10668. # Os PageHiberDump end.
10669. 
10670. 		)
10671. 
10672. 		FileActions
10673. 		  		/* ---------------------------------------------------------- */
10674. 	# Gap
10675. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
10676. 		# Script: DisplaySetFileStep
10677. 
10678. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10679. 
10680. /* add message and move to a new line. */
10681. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10682. ")
10683. 
10684. /* display the line. (hopefully.) */
10685. # Zone Footer Set Statistics Window Text
10686. 
10687. SetStatisticsWindowText("!Heading!
10688. ----------------------------------------------------------
10689. Zones Processed: 
10690. ----------------------------------------------------------
10691. !ZoneListByLine!
10692. ----------------------------------------------------------
10693. Zone Processing Step:
10694. !ZoneStepByLine!    
10695. ----------------------------------------------------------
10696. ----------------------------------------------------------
10697. Current Zone:
10698. !ZoneFooter!
10699. ----------------------------------------------------------
10700. ----------------------------------------------------------
10701. Volume Statistics:
10702. !VolumeStatisticsDetail!
10703. ----------------------------------------------------------
10704. ----------------------------------------------------------
10705. Zone Detailed Report:
10706. ----------------------------------------------------------
10707. !ZoneStatisticsDetail!
10708. ----------------------------------------------------------
10709. ")
10710. 
10711. 
10712. 
10713. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10714. 
10715. # Script: BannerSet
10716. 
10717. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
10718. 
10719. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
10720. 
10721. Title('!Heading!')
10722. /* pause(1) */
10723. 
10724. /* NOTE: Can't round or truncate to integer precision. */
10725. 
10726. pause(1)
10727. 	
10728. 	# ACTUAL GAP
10729. 		/* AddGap Variant. */
10730. 	  	# Zone Do Gap
10731. # Gap Calculation Methods:
10732. 
10733. /* 1) Anything you need to add first. */
10734. /* empty */
10735. 
10736. /* ---------------------------------------------------------- */
10737. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
10738. 	# GapRequestedStd.
10739. 
10740. 		/* ---------------------------------------------------------- */
10741. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
10742. 
10743. 		# Gap Calculation Methods:
10744. 
10745. /* AddGap Variants */
10746. 
10747. 	/* Standard */
10748. 		# Gap Calculation Methods:
10749. 	/* AddGap Variants */
10750. 	/* Standard */
10751. 
10752. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
10753. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
10754. 
10755. 	SetVariable(GapRequested, GapRequestedStd)
10756. 	
10757. 
10758. 	/* MFT Low High Method */
10759. 		# Gap Calculation Methods:
10760. 	/* AddGap Variants */
10761. 	/* MFT Low High Method */
10762. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
10763. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
10764. 	SetVariable(GapRequested, GapRequestedMft)
10765. 	
10766. 
10767. 	/* OS Volume Type Method */
10768. 		# Gap Calculation Methods:
10769. 	/* AddGap Variants */
10770. 	/* OS Volume Type Method */
10771. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
10772. 	SetVariable(GapRequested, GapRequestedOs)
10773. 
10774. 
10775. 
10776. /* MakeGap Variants */
10777. 
10778. 	/* Original Os 1-3 + MFT 2 */
10779. 		# Gap Calculation Methods:
10780. 	/* MakeGap Variants */
10781. 	/* Original Os 1-3 + MFT 2 */
10782. 	/* plus MFT gap placed inline at the dividing zone. */
10783. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
10784. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
10785. 	SetVariable(GapRequested, GapRequestedOrig)
10786. 	
10787. 	
10788. /* Note: You could comment out the ones not in use */
10789. /* However having the data in the log is useful. */
10790. /* Therefore the following line is otherwise needed. */
10791. 
10792. /* Standard used */
10793. 
10794. SetVariable(GapRequested, GapRequestedStd)
10795. 
10796. # Gap Calculation Methods:
10797. 
10798. /* AddGap Variants */
10799. 	/* Standard */
10800. 	/* MFT Low High Method */
10801. 	/* OS Volume Type Method */
10802. 
10803. /* MakeGap Variants */
10804. 	/* Original Os 1-3 + MFT 2 */
10805. 
10806. /* Note: You could comment out the ones not in use */
10807. /* However having the data in the log is useful. */
10808. /* Therefore the following line is otherwise needed. */
10809. 
10810. /* Standard is used currently */
10811. 
10812. 
10813. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
10814. 
10815. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
10816. 
10817. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
10818. 
10819. /* ---------------------------------------------------------- */
10820. /* 3) SMALL ZONE ADJUSTMENT. */
10821. /* Gab cant be larger than half the Zone Size. */
10822. 
10823. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
10824. 	
10825. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
10826. 
10827. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
10828. 
10829. /* ---------------------------------------------------------- */
10830. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
10831. # Gap Adjustments.
10832. 
10833. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
10834. 	
10835. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
10836. 
10837. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
10838. 
10839. /* ---------------------------------------------------------- */
10840. # BYPASS THIS.
10841. 	/* This is definitely wrong. */
10842. 	/* The question is can we steal gap from the next zone */
10843. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
10844. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
10845. 		# Zone Overflow.
10846. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
10847. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
10848. 
10849. /* ---------------------------------------------------------- */
10850. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
10851. # Remaining free space available.
10852. 
10853. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
10854. 	
10855. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
10856. 
10857. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
10858. 
10859. /* ---------------------------------------------------------- */
10860. # CURRENT gap to use.
10861. 
10862. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
10863. 
10864. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
10865. 
10866. /* ---------------------------------------------------------- */
10867. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
10868. # Debugging.
10869. 
10870. 	SetVariable(GapUsed, GapCurrent) // for debugging
10871. 
10872. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
10873. 
10874. 		# Your code HERE
10875. 
10876. /* ---------------------------------------------------------- */
10877. /* 7) YOUR CODE. */
10878. # YOUR CODE HERE:
10879. 	# INPUT: GapCurrent or GapCurrentLoc
10880. 	# OUTPUT: GapUsed...
10881. 
10882. /* ---------------------------------------------------------- */
10883. # Gap Size.
10884. # Actual Size of Gap.
10885. 
10886. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
10887. 
10888. /* ---------------------------------------------------------- */
10889. /* xxxxxxxxxxxxxxxxxxxxxx */
10890. # ADD THE GAP
10891. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
10892. /* xxxxxxxxxxxxxxxxxxxxxx */
10893. 
10894. 	
10895. 	# Zone Statistics	
10896. 	# Script: ZoneDoStatistics
10897. # Zone / Volume Statistics and Display
10898. 		
10899. 	# Accumulate Totals
10900.   	# Script: ZoneDoVolumeTotals
10901. 
10902. /* Current total space used (by Zones and Gaps) */
10903. 
10904. SetVariable(VolumeZoneUsed, GapUsed)
10905. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
10906. /* Percentage */
10907. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
10908. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
10909. 
10910. /* Current total of free space requested */
10911. 
10912. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
10913. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10914. /* Percent. */
10915. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
10916. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10917. 
10918. /* Current total of free space used */
10919. 
10920. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
10921. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
10922. /* Percent */
10923. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
10924. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
10925. 
10926. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
10927. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
10928. /* Xinclude "..\DebugDisplayPause.MyDc"X */
10929. 
10930. 
10931. 	# Current Values
10932. 	# Script: ZoneDoCurrentSet
10933. 
10934. # Cluster, Sector, Block adjust for display.
10935. 	# Bytes per cluster is volume specific.
10936. 
10937. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
10938. 
10939. # Current Zone values.
10940. 	# Begin, end and size.
10941. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
10942. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
10943. 
10944. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
10945. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
10946. 
10947. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
10948. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
10949. 
10950. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
10951. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
10952. 
10953. 	SetVariable(ZoneFragments,				"!ZONE210N!")
10954. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
10955. 		
10956. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
10957. /* identical code to here: (separation not needed. TEST.) */	
10958. 
10959. # Current Gap, Actual and Free Values
10960. 	# Gap
10961. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
10962. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
10963. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
10964. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
10965. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
10966. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
10967. 	
10968. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
10969. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
10970. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
10971. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
10972. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
10973. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
10974. 	
10975. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
10976. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
10977. 	
10978. 	# Actual Size and End
10979. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
10980. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
10981. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
10982. 	
10983. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
10984. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
10985. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
10986. 
10987. # Gap Size & Rounding
10988. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
10989. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
10990. 	
10991. 	# Free Space
10992. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
10993. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
10994. 
10995. 	# Footer:
10996. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
10997. # 2021-11-17 21:08:28
10998. 
10999. SetVariable(ZoneFooter1, "----------------------------------------------------------
11000. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
11001. #
11002. # Xinclude "..\Commands\DateTimeLastLong.txt"X
11003. #
11004. SetVariable(ZoneFooter2, "Statistics Report:
11005. ------------------
11006.    Size:  
11007.    ------------------------
11008.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11009.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11010.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11011. 
11012.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11013.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11014. 
11015.    Location:
11016.    ------------------------
11017.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11018.             Files End: !ZoneEndCurrent!
11019.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11020.       
11021.    Gap Settings:
11022.    ------------------------
11023.          Gap Requested: !ZoneGapSizePer!%
11024.        Volume Rounding: !ZoneVolRoundUpPer!%
11025.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11026.                  
11027.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
11028.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
11029.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
11030.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
11031.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
11032.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
11033.      
11034.    Free Space after Zone:
11035.    ------------------------
11036.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11037.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11038.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11039. 
11040. Directory and Files Select:
11041. ---------------------------
11042. !ZoneTypeSelectCurrent!               
11043. ---------------------------
11044. ----------------------------------------------------------
11045. ")
11046. 
11047. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
11048. 
11049. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
11050. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
11051. RunProgram("..\Commands\WriteDateTime.bat LastZone")
11052. 
11053. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
11054. 
11055. 
11056. 	# Zone Footer Set Statistics Window Text
11057. 
11058. SetStatisticsWindowText("!Heading!
11059. ----------------------------------------------------------
11060. Zones Processed: 
11061. ----------------------------------------------------------
11062. !ZoneListByLine!
11063. ----------------------------------------------------------
11064. Zone Processing Step:
11065. !ZoneStepByLine!    
11066. ----------------------------------------------------------
11067. ----------------------------------------------------------
11068. Current Zone:
11069. !ZoneFooter!
11070. ----------------------------------------------------------
11071. ----------------------------------------------------------
11072. Volume Statistics:
11073. !VolumeStatisticsDetail!
11074. ----------------------------------------------------------
11075. ----------------------------------------------------------
11076. Zone Detailed Report:
11077. ----------------------------------------------------------
11078. !ZoneStatisticsDetail!
11079. ----------------------------------------------------------
11080. ")
11081. 
11082. 
11083. 	
11084.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
11085. 
11086. 	# Add Zone to list of zones for display.
11087. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
11088. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
11089. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
11090. 	# ??? Free Stats?
11091. 	# Footer:
11092. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
11093. # 2021-11-17 21:08:28
11094. 
11095. SetVariable(ZoneFooter1, "----------------------------------------------------------
11096. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
11097. #
11098. # Xinclude "..\Commands\DateTimeLastLong.txt"X
11099. #
11100. SetVariable(ZoneFooter2, "Statistics Report:
11101. ------------------
11102.    Size:  
11103.    ------------------------
11104.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11105.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11106.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11107. 
11108.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11109.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11110. 
11111.    Location:
11112.    ------------------------
11113.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11114.             Files End: !ZoneEndCurrent!
11115.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11116.       
11117.    Gap Settings:
11118.    ------------------------
11119.          Gap Requested: !ZoneGapSizePer!%
11120.        Volume Rounding: !ZoneVolRoundUpPer!%
11121.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11122.                  
11123.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
11124.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
11125.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
11126.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
11127.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
11128.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
11129.      
11130.    Free Space after Zone:
11131.    ------------------------
11132.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11133.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11134.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11135. 
11136. Directory and Files Select:
11137. ---------------------------
11138. !ZoneTypeSelectCurrent!               
11139. ---------------------------
11140. ----------------------------------------------------------
11141. ")
11142. 
11143. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
11144. 
11145. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
11146. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
11147. RunProgram("..\Commands\WriteDateTime.bat LastZone")
11148. 
11149. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
11150. 
11151. 
11152. 
11153. 	# Add Zone Details to Report.	
11154. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
11155. !ZoneFooter!")
11156. 
11157. 
11158. 	
11159. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
11160. 			# Script: DisplaySetFileStep
11161. 
11162. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11163. 
11164. /* add message and move to a new line. */
11165. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11166. ")
11167. 
11168. /* display the line. (hopefully.) */
11169. # Zone Footer Set Statistics Window Text
11170. 
11171. SetStatisticsWindowText("!Heading!
11172. ----------------------------------------------------------
11173. Zones Processed: 
11174. ----------------------------------------------------------
11175. !ZoneListByLine!
11176. ----------------------------------------------------------
11177. Zone Processing Step:
11178. !ZoneStepByLine!    
11179. ----------------------------------------------------------
11180. ----------------------------------------------------------
11181. Current Zone:
11182. !ZoneFooter!
11183. ----------------------------------------------------------
11184. ----------------------------------------------------------
11185. Volume Statistics:
11186. !VolumeStatisticsDetail!
11187. ----------------------------------------------------------
11188. ----------------------------------------------------------
11189. Zone Detailed Report:
11190. ----------------------------------------------------------
11191. !ZoneStatisticsDetail!
11192. ----------------------------------------------------------
11193. ")
11194. 
11195. 
11196. 
11197. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11198. 
11199. # Script: BannerSet
11200. 
11201. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
11202. 
11203. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
11204. 
11205. Title('!Heading!')
11206. /* pause(1) */
11207. 
11208. /* NOTE: Can't round or truncate to integer precision. */
11209. 
11210. pause(1)
11211. 
11212. 			# File Action - Type Os Programs - Fast - MoveUpToZone.
11213. # File Action - SortByImportSequence with SkipBlock.
11214. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
11215. 	
11216. 	
11217. 	
11218. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
11219. 			# Script: DisplaySetFileStep
11220. 
11221. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11222. 
11223. /* add message and move to a new line. */
11224. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11225. ")
11226. 
11227. /* display the line. (hopefully.) */
11228. # Zone Footer Set Statistics Window Text
11229. 
11230. SetStatisticsWindowText("!Heading!
11231. ----------------------------------------------------------
11232. Zones Processed: 
11233. ----------------------------------------------------------
11234. !ZoneListByLine!
11235. ----------------------------------------------------------
11236. Zone Processing Step:
11237. !ZoneStepByLine!    
11238. ----------------------------------------------------------
11239. ----------------------------------------------------------
11240. Current Zone:
11241. !ZoneFooter!
11242. ----------------------------------------------------------
11243. ----------------------------------------------------------
11244. Volume Statistics:
11245. !VolumeStatisticsDetail!
11246. ----------------------------------------------------------
11247. ----------------------------------------------------------
11248. Zone Detailed Report:
11249. ----------------------------------------------------------
11250. !ZoneStatisticsDetail!
11251. ----------------------------------------------------------
11252. ")
11253. 
11254. 
11255. 
11256. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11257. 
11258. # Script: BannerSet
11259. 
11260. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
11261. 
11262. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
11263. 
11264. Title('!Heading!')
11265. /* pause(1) */
11266. 
11267. /* NOTE: Can't round or truncate to integer precision. */
11268. 
11269. pause(1)
11270. 
11271. 		# Script: ZoneDoFooter
11272. 
11273. /* ---------------------------------------------------------- */
11274. # File Select
11275. 	# Select Statments
11276. # File Actions 
11277. 	# Standard or OS File Actions.
11278. 	# Resume...
11279. 	
11280. 	# your stuff HERE (X)... post zone (file) file actions code.
11281. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
11282. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
11283. 		# (X)
11284. 		
11285. 		/* ??? Set window? */
11286. 	
11287. 	# ADD THE GAP
11288. # Vacate (good for diagnostics)
11289. # DoNotVacate - DO NOT Vacate (recommended)
11290. # DoNotVacate - DO NOT Vacate (recommended)
11291. 
11292. # Vacate
11293. /* AddGap(GapUsedLoc) */
11294. 
11295. # DO Not Vacate
11296. AddGap(GapUsedLoc, DoNotVacate) 
11297. 	
11298. 	
11299. # Script: GapZoneCommand
11300. # *** Moved to setting yours ***
11301. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
11302. # Controlled via settings commands
11303. # DoNotVacate - DO NOT Vacate (recommended)
11304. 
11305. # Vacate
11306. /* AddGap(GapUsedLoc) */
11307. 
11308. # DO Not Vacate
11309. AddGap(GapUsedLoc, DoNotVacate) 
11310. 	
11311. 	
11312. # Vacate /* AddGap(GapUsed) */
11313. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
11314. 	
11315. 
11316. 		
11317. # 
11318. FileEnd
11319. /* ---------------------------------------------------------- */
11320. 
11321. # your stuff HERE (X)... post zone (file) code.
11322. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
11323. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
11324. 	# (X)
11325. 
11326. SetVariable(FileStepDescription,"Zone finished, reporting.")
11327. # Script: DisplaySetFileStep
11328. 
11329. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11330. 
11331. /* add message and move to a new line. */
11332. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11333. ")
11334. 
11335. /* display the line. (hopefully.) */
11336. # Zone Footer Set Statistics Window Text
11337. 
11338. SetStatisticsWindowText("!Heading!
11339. ----------------------------------------------------------
11340. Zones Processed: 
11341. ----------------------------------------------------------
11342. !ZoneListByLine!
11343. ----------------------------------------------------------
11344. Zone Processing Step:
11345. !ZoneStepByLine!    
11346. ----------------------------------------------------------
11347. ----------------------------------------------------------
11348. Current Zone:
11349. !ZoneFooter!
11350. ----------------------------------------------------------
11351. ----------------------------------------------------------
11352. Volume Statistics:
11353. !VolumeStatisticsDetail!
11354. ----------------------------------------------------------
11355. ----------------------------------------------------------
11356. Zone Detailed Report:
11357. ----------------------------------------------------------
11358. !ZoneStatisticsDetail!
11359. ----------------------------------------------------------
11360. ")
11361. 
11362. 
11363. 
11364. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11365. 
11366. # Script: BannerSet
11367. 
11368. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
11369. 
11370. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
11371. 
11372. Title('!Heading!')
11373. /* pause(1) */
11374. 
11375. /* NOTE: Can't round or truncate to integer precision. */
11376. 
11377. pause(1)
11378. 
11379. # Script: ZoneWhenFinished
11380. 
11381. # Script: BannerSet
11382. 
11383. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
11384. 
11385. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
11386. 
11387. Title('!Heading!')
11388. /* pause(1) */
11389. 
11390. /* NOTE: Can't round or truncate to integer precision. */
11391. 
11392. # Script: BannerLog
11393. 
11394. AppendLogfile("!LogFileName!", "!Title!")
11395. 
11396. 
11397. 
11398. # Zone Statistics	
11399. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
11400. 
11401. # Footer:
11402. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
11403. # 2021-11-17 21:08:28
11404. 
11405. SetVariable(ZoneFooter1, "----------------------------------------------------------
11406. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
11407. #
11408. # Xinclude "..\Commands\DateTimeLastLong.txt"X
11409. #
11410. SetVariable(ZoneFooter2, "Statistics Report:
11411. ------------------
11412.    Size:  
11413.    ------------------------
11414.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11415.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11416.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11417. 
11418.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11419.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11420. 
11421.    Location:
11422.    ------------------------
11423.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11424.             Files End: !ZoneEndCurrent!
11425.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11426.       
11427.    Gap Settings:
11428.    ------------------------
11429.          Gap Requested: !ZoneGapSizePer!%
11430.        Volume Rounding: !ZoneVolRoundUpPer!%
11431.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11432.                  
11433.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
11434.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
11435.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
11436.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
11437.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
11438.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
11439.      
11440.    Free Space after Zone:
11441.    ------------------------
11442.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11443.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11444.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11445. 
11446. Directory and Files Select:
11447. ---------------------------
11448. !ZoneTypeSelectCurrent!               
11449. ---------------------------
11450. ----------------------------------------------------------
11451. ")
11452. 
11453. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
11454. 
11455. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
11456. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
11457. RunProgram("..\Commands\WriteDateTime.bat LastZone")
11458. 
11459. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
11460. 
11461. 
11462. 
11463. AppendLogfile("!LogFileName!", ".")
11464. AppendLogfile("!LogFileName!", "!ZoneFooter!")
11465. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
11466. AppendLogfile("!LogFileName!", ".")
11467. 
11468. # Zone Footer Set Statistics Window Text
11469. 
11470. SetStatisticsWindowText("!Heading!
11471. ----------------------------------------------------------
11472. Zones Processed: 
11473. ----------------------------------------------------------
11474. !ZoneListByLine!
11475. ----------------------------------------------------------
11476. Zone Processing Step:
11477. !ZoneStepByLine!    
11478. ----------------------------------------------------------
11479. ----------------------------------------------------------
11480. Current Zone:
11481. !ZoneFooter!
11482. ----------------------------------------------------------
11483. ----------------------------------------------------------
11484. Volume Statistics:
11485. !VolumeStatisticsDetail!
11486. ----------------------------------------------------------
11487. ----------------------------------------------------------
11488. Zone Detailed Report:
11489. ----------------------------------------------------------
11490. !ZoneStatisticsDetail!
11491. ----------------------------------------------------------
11492. ")
11493. 
11494. 
11495. 
11496. /* pause() */
11497. /* pause() */
11498. 
11499. 
11500. 
11501. 	
11502. /* ---------------------------------------------------------- */
11503. 
11504. 
11505. /* ---------------------------------------------------------- */
11506. /* OLD: ToDo */
11507. 	/* Zone 1 and 2 originally */
11508. 	/* Originally the MFT and DIRs were processed first. */
11509. 	/* Zone 4 and 5 normally */
11510. 	/* The MakeGap call is put between which ever zones you want */
11511. 	/* So the actual zone number is unknown */
11512. 	/* SetVariable(ZoneCurrent,"4, 5") */
11513. 	/* MakeGap(RoundUp(VolumeUsed * (!MftPer! + 0.15), VolumeSize * ZoneVolRoundUpLarge), DoNotVacate) */
11514. 
11515. /* ---------------------------------------------------------- */
11516. SetVariable(FileStepDescription,"System Zones completed.")
11517. # Script: DisplaySetFileStep
11518. 
11519. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11520. 
11521. /* add message and move to a new line. */
11522. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11523. ")
11524. 
11525. /* display the line. (hopefully.) */
11526. # Zone Footer Set Statistics Window Text
11527. 
11528. SetStatisticsWindowText("!Heading!
11529. ----------------------------------------------------------
11530. Zones Processed: 
11531. ----------------------------------------------------------
11532. !ZoneListByLine!
11533. ----------------------------------------------------------
11534. Zone Processing Step:
11535. !ZoneStepByLine!    
11536. ----------------------------------------------------------
11537. ----------------------------------------------------------
11538. Current Zone:
11539. !ZoneFooter!
11540. ----------------------------------------------------------
11541. ----------------------------------------------------------
11542. Volume Statistics:
11543. !VolumeStatisticsDetail!
11544. ----------------------------------------------------------
11545. ----------------------------------------------------------
11546. Zone Detailed Report:
11547. ----------------------------------------------------------
11548. !ZoneStatisticsDetail!
11549. ----------------------------------------------------------
11550. ")
11551. 
11552. 
11553. 
11554. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11555. 
11556. # Script: BannerSet
11557. 
11558. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
11559. 
11560. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
11561. 
11562. Title('!Heading!')
11563. /* pause(1) */
11564. 
11565. /* NOTE: Can't round or truncate to integer precision. */
11566. 
11567. pause(1)
11568. 
11569. 
11570. /* ---------------------------------------------------------- */
11571. /* Any Volume Regular Zones */
11572. /* ---------------------------------------------------------- */
11573. 
11574. /* ---------------------------------------------------------- */
11575. /* Zone 8 IdeScripts Ide, Scripts, Support */
11576. # Script: DisplayColors - Zone Dark
11577. # Processed
11578. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
11579. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
11580. 
11581. # Light Green and Yellow
11582. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
11583. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
11584. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
11585. 
11586. # Script: DefragZoneTypeIdeScripts
11587. /* ---------------------------------------------------------- */
11588. /* Zone IdeScripts Ide, Scripts, Support */
11589. 
11590. SetVariable(ZoneLabel, "!ZoneLabelIdeScripts!")
11591. SetVariable(ZoneDescription, "!ZoneDescriptionIdeScripts!")
11592. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpIdeScripts!")
11593. SetVariable(ZoneGapSize, "!ZoneGapSizeIdeScripts!")
11594. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectIdeScripts
11595. # IdeScripts start.
11596. # NotBlobsArchivesBu start.
11597. (not (
11598. # Blobs start.
11599. (
11600. # BlobsAndExceptions start.
11601. ( not(
11602.   FileName("*.bat")
11603.   or FileName("*.css")
11604.   or FileName("*.dll")
11605.   or FileName("*.exe")
11606.   or FileName("*.htm*")
11607.   or FileName("*.jar")
11608.   or FileName("*.js")
11609.   or FileName("*.script")
11610.   or FileName("*.wsf")
11611.   or (
11612. # Databases start.
11613. (
11614.   FileName("*.crypt*")
11615.   or FileName("*.db*")
11616.   or FileName("*.rdb*")
11617.   or FileName("*.dc*")
11618.   or FileName("*.dict*")
11619.   or FileName("*.?db*")
11620.   or FileName("*.?rdb*")
11621.   or FileName("*.md*")
11622.   or FileName("*.myd")
11623.   or FileName("*.ndf")
11624.   or FileName("*.ns?")
11625.   or FileName("*.pab")
11626.   or FileName("*.pst")
11627.   or FileName("*.sd?*")
11628.   or FileName("*.sq**")
11629.   or FileName("*.tmd")
11630.   or FileName("*.tps")
11631.   or FileName("*.tr*")
11632. )
11633. # Databases end.
11634. 
11635.     # BlobsAndExceptions
11636.     or 
11637. # Data start.
11638. (
11639.   DirectoryName("Data*")
11640.   or DirectoryName("Device*")
11641.   or DirectoryName("Export*")
11642.   or DirectoryName("Import*")
11643.   or DirectoryName("Log*")
11644.   or DirectoryName("*Log")
11645.   or DirectoryName("Maintenance*")
11646.   or DirectoryName("Rec*")
11647.   or DirectoryName("Sales*")
11648.   or DirectoryName("Search*")
11649.   or DirectoryName("User*")
11650. )
11651. # Data end.
11652. 
11653.     # BlobsAndExceptions
11654.   )
11655. ) )
11656. # BlobsAndExceptions end.
11657. 
11658. # Blobs
11659. ) and (
11660.   Size(BlobFileSize,0)
11661.   or (
11662.     FileName("*.arj")
11663.     or FileName("*.bup")
11664.     or FileName("*.bz2")
11665.     or FileName("*.chm")
11666.     or FileName("*.dvr-ms")
11667.     or FileName("*.gz")
11668.     or FileName("*.ifo")
11669.     or FileName("*.lzh")
11670.     or FileName("*.pdf")
11671.     or FileName("*.rpm")
11672.     or FileName("*.wmv")
11673.     or FileName("*.vob")
11674.     or FileName("*.z")
11675.   ) 
11676. )
11677. # Blobs end.
11678. 
11679. # NotBlobsArchivesBu
11680. or 
11681. # Archives start.
11682. (
11683.   DirectoryName("*Archive*")
11684.   or DirectoryName("*History*")
11685.   or DirectoryName("*Old")
11686.   or DirectoryName("* Old *")
11687.   or DirectoryName("Old *")
11688. 
11689.   or FileName("*.7z")
11690.   or FileName("*.cab")
11691.   or FileName("*.iso")
11692.   or FileName("*.msi")
11693.   or FileName("*.old")
11694.   or FileName("*.rar")
11695.   or FileName("*.tar")
11696.   or FileName("*.zip")
11697.   or
11698. # WinSysLow start.
11699. (
11700.   # Bad idea. This pushed lots of programs and data to archive.
11701.   # DirectoryName("$*")
11702.   # or DirectoryName("0*")
11703.   # or DirectoryName("1*")
11704.   # or DirectoryName("2*")
11705.   # or DirectoryName("3*")
11706.   # or DirectoryName("4*")
11707.   # or DirectoryName("5*")
11708.   # or DirectoryName("6*")
11709.   # or DirectoryName("7*")
11710.   # or DirectoryName("8*")
11711.   # or DirectoryName("9*")
11712.   # or 
11713.   DirectoryName("dllcache")
11714.   or DirectoryName("Downloaded Installations")
11715.   or DirectoryName("Ehome")
11716.   or DirectoryName("Fonts")
11717.   or DirectoryName("Help")
11718.   or DirectoryName("I386")
11719.   or DirectoryName("ie?updates")
11720.   or DirectoryName("Installer")
11721.   or DirectoryName("Installshield Installation Information")
11722.   or DirectoryName("IME")
11723.   or DirectoryName("*RECYCLE*")
11724.   or DirectoryName("ServicePackFiles")
11725.   or DirectoryName("SoftwareDistribution")
11726.   or DirectoryName("Speech")
11727.   or DirectoryName("Symbols")
11728.   or DirectoryName("System Volume Information")
11729.   or DirectoryName("windows.old")
11730. )
11731. # WinSysLow end.
11732. 
11733.   # Archives
11734. )
11735. # Archives end.
11736. 
11737. # NotBlobsArchivesBu
11738. or
11739. # Backups start.
11740. (
11741.   DirectoryName("*Backup*")
11742.   or DirectoryName("*Bu")
11743.   or DirectoryName("* Bu *")
11744.   or DirectoryName("Bu *")
11745. 
11746.   or FileName("*.bak")
11747.   or FileName("* - Copy*")
11748. )
11749. # Backups end.
11750. 
11751. # NotBlobsArchivesBu
11752. ) )
11753. # NotBlobsArchivesBu end.
11754. 
11755. # IdeScripts
11756. and ( 
11757. # Ide start.
11758. (
11759.     DirectoryName("Ide*")
11760.     or DirectoryName("Java*")
11761.     or DirectoryName("Os")
11762. )
11763. # Ide end.
11764. 
11765. # IdeScripts
11766. or  
11767. # Scripts start.
11768. (
11769.   DirectoryName("*Script*")
11770. )
11771. # Scripts end.
11772. 
11773. # IdeScripts
11774. )
11775. # IdeScripts end.
11776. ')
11777. 
11778. 	# Script: ZoneDoHeader
11779. 
11780. # Script: ZoneWhenStarted
11781. RunProgram("..\Commands\WriteDateTime.bat")
11782. 
11783. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
11784. # Script: DisplaySetZone
11785. 
11786. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
11787. SetVariable(FileStepDescription,	"")
11788. 
11789. SetVariable(ZoneStepByLine, 			"Zone started.
11790. ")
11791. 
11792. # Script: BannerDescriptionSet
11793. 
11794. # Script: BannerSet
11795. 
11796. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
11797. 
11798. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
11799. 
11800. Title('!Heading!')
11801. /* pause(1) */
11802. 
11803. /* NOTE: Can't round or truncate to integer precision. */
11804. 
11805. # Script: BannerLog
11806. 
11807. AppendLogfile("!LogFileName!", "!Title!")
11808. 
11809. 
11810. 
11811. pause(1)
11812. 
11813. 
11814. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
11815. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
11816. 
11817. SetVariable(ZoneStepNoCurrent, 0)
11818. 
11819. 
11820. # Script: ZoneDoCurrentClear
11821. 
11822. SetVariable(ZoneTypeSelectCurrent, 		"")
11823. 
11824. SetVariable(ZoneBeginCurrent, 			0)
11825. SetVariable(ZoneBeginPerCurrent, 		0)
11826. SetVariable(ZoneEndCurrent, 			0)
11827. SetVariable(ZoneEndPerCurrent, 			0)
11828. 
11829. SetVariable(ZoneSizeCurrent,			0)
11830. SetVariable(ZoneSizePerCurrent,			0)
11831. 
11832. SetVariable(ZoneGapRequestedCurrent,	0)
11833. SetVariable(ZoneGapRoundedCurrent, 		0)
11834. SetVariable(ZoneGapAdjustedCurrent, 	0)
11835. SetVariable(ZoneGapAvailableCurrent, 	0)
11836. SetVariable(ZoneGapCurrent,				0)
11837. SetVariable(ZoneGapUsedCurrent, 		0)
11838. 
11839. SetVariable(ZoneGapActualCurrent, 		0)
11840. SetVariable(ZoneGapActualPerCurrent, 	0)
11841. 
11842. SetVariable(ZoneSizeActual, 			0)
11843. SetVariable(ZoneSizeActualCurrent,		0)
11844. 
11845. SetVariable(ZoneEndActual, 				0)
11846. SetVariable(ZoneEndActualCurrent,		0)			
11847. SetVariable(ZoneSizeActualPerCurrent, 	0)
11848.       
11849. SetVariable(ZoneFilesFolders,			0)
11850. SetVariable(ZoneFilesFoldersPer,		0) 
11851. 
11852. SetVariable(ZoneFragments,				0)
11853. SetVariable(ZoneFragmentsPer,			0) 
11854. 		
11855. SetVariable(ZoneEndActualCurrent, 		0)
11856. SetVariable(ZoneEndActualPerCurrent, 	0)
11857. 
11858. # Gap Calculation Methodology:
11859. 	# Requested
11860. 	SetVariable(GapRequested, 			0) 
11861. 	SetVariable(GapRequestedStd, 		0) 
11862. 	SetVariable(GapRequestedMft, 		0) 
11863. 	SetVariable(GapRequestedOs, 		0) 
11864. 	SetVariable(GapRequestedOriginal, 	0) 
11865. 	
11866. 	# Gap Adjustments
11867. 	SetVariable(GapRounded, 			0)
11868. 	# SetVariable(GapAdjusted, 			0)
11869. 	SetVariable(GapAvailable, 			0)
11870. 	SetVariable(GapCurrent, 			0)
11871. 	SetVariable(GapActual, 				0)
11872. 	SetVariable(GapUsed, 				0)
11873. 	
11874. 	# Gap Adjustments
11875. 	SetVariable(GapRoundedLoc, 			0)
11876. 	# SetVariable(GapAdjustedLoc, 		0)
11877. 	SetVariable(GapAvailableLoc, 		0)
11878. 	SetVariable(GapCurrentLoc, 			0)
11879. 	SetVariable(GapActualLoc,			0)
11880. 	SetVariable(GapUsedLoc,				0)
11881. 	
11882. 	# Space usage
11883. 	SetVariable(ZoneFreePerRequested, 	0)
11884. 	SetVariable(ZoneFreePerUsed, 		0)
11885. 
11886. # Gap Size & Rounding
11887. 	SetVariable(ZoneGapSizePer, 		0)
11888. 	SetVariable(ZoneVolRoundUpPer, 		0)
11889. 	
11890. 	# Free Space
11891. 	SetVariable(ZoneFreeUsedPer, 		0)
11892. 	SetVariable(ZoneFreeRequestedPer, 	0)
11893. 
11894. 
11895. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
11896. 
11897. # Footer:
11898. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
11899. # 2021-11-17 21:08:28
11900. 
11901. SetVariable(ZoneFooter1, "----------------------------------------------------------
11902. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
11903. #
11904. # Xinclude "..\Commands\DateTimeLastLong.txt"X
11905. #
11906. SetVariable(ZoneFooter2, "Statistics Report:
11907. ------------------
11908.    Size:  
11909.    ------------------------
11910.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11911.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11912.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11913. 
11914.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11915.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11916. 
11917.    Location:
11918.    ------------------------
11919.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11920.             Files End: !ZoneEndCurrent!
11921.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11922.       
11923.    Gap Settings:
11924.    ------------------------
11925.          Gap Requested: !ZoneGapSizePer!%
11926.        Volume Rounding: !ZoneVolRoundUpPer!%
11927.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11928.                  
11929.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
11930.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
11931.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
11932.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
11933.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
11934.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
11935.      
11936.    Free Space after Zone:
11937.    ------------------------
11938.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11939.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11940.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11941. 
11942. Directory and Files Select:
11943. ---------------------------
11944. !ZoneTypeSelectCurrent!               
11945. ---------------------------
11946. ----------------------------------------------------------
11947. ")
11948. 
11949. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
11950. 
11951. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
11952. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
11953. RunProgram("..\Commands\WriteDateTime.bat LastZone")
11954. 
11955. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
11956. 
11957. 
11958. 
11959. # Script: BannerSet
11960. 
11961. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
11962. 
11963. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
11964. 
11965. Title('!Heading!')
11966. /* pause(1) */
11967. 
11968. /* NOTE: Can't round or truncate to integer precision. */
11969. 
11970. # Script: BannerLog
11971. 
11972. AppendLogfile("!LogFileName!", "!Title!")
11973. 
11974. 
11975. 
11976. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
11977. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
11978. 
11979. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
11980. 
11981. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:28")
11982. 
11983. # 2021-11-17 21:08:28 
11984. SetVariable(Temp9, DATETIME)
11985. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:03 !ZoneLabel! !ZoneDescription!")
11986. 
11987. SetVariable(ZoneListByLine, "!ZoneListByLine! 
11988. Zone: !ZoneNoCurrent! !Temp9! 0:00:03 !ZoneLabel! !ZoneDescription!")
11989. 
11990. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:03 !ZoneLabel! !ZoneDescription!")
11991. 
11992. 
11993. /* Fixed Zone Position Handling */
11994. /* Literal number: */
11995. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
11996. /* Percentage of disk: */
11997. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
11998. /* Gap */
11999. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
12000. 
12001. /* ---------------------------------------------------------- */
12002. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
12003. # Script: DisplaySetFileStep
12004. 
12005. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12006. 
12007. /* add message and move to a new line. */
12008. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12009. ")
12010. 
12011. /* display the line. (hopefully.) */
12012. # Zone Footer Set Statistics Window Text
12013. 
12014. SetStatisticsWindowText("!Heading!
12015. ----------------------------------------------------------
12016. Zones Processed: 
12017. ----------------------------------------------------------
12018. !ZoneListByLine!
12019. ----------------------------------------------------------
12020. Zone Processing Step:
12021. !ZoneStepByLine!    
12022. ----------------------------------------------------------
12023. ----------------------------------------------------------
12024. Current Zone:
12025. !ZoneFooter!
12026. ----------------------------------------------------------
12027. ----------------------------------------------------------
12028. Volume Statistics:
12029. !VolumeStatisticsDetail!
12030. ----------------------------------------------------------
12031. ----------------------------------------------------------
12032. Zone Detailed Report:
12033. ----------------------------------------------------------
12034. !ZoneStatisticsDetail!
12035. ----------------------------------------------------------
12036. ")
12037. 
12038. 
12039. 
12040. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12041. 
12042. # Script: BannerSet
12043. 
12044. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
12045. 
12046. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
12047. 
12048. Title('!Heading!')
12049. /* pause(1) */
12050. 
12051. /* NOTE: Can't round or truncate to integer precision. */
12052. 
12053. pause(1)
12054. 
12055. # your stuff HERE (X)... pre file select code.
12056. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
12057. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12058. 	# (X)
12059. 
12060. FileSelect
12061. 
12062. 	# your stuff can't really go here (errors.)
12063. 	# maybe for some reason I don't know of...
12064. 	
12065. 	# Actions next...
12066. 	# Script: ZoneDo ZoneTypeSelectIdeScripts
12067. # IdeScripts start.
12068. # NotBlobsArchivesBu start.
12069. (not (
12070. # Blobs start.
12071. (
12072. # BlobsAndExceptions start.
12073. ( not(
12074.   FileName("*.bat")
12075.   or FileName("*.css")
12076.   or FileName("*.dll")
12077.   or FileName("*.exe")
12078.   or FileName("*.htm*")
12079.   or FileName("*.jar")
12080.   or FileName("*.js")
12081.   or FileName("*.script")
12082.   or FileName("*.wsf")
12083.   or (
12084. # Databases start.
12085. (
12086.   FileName("*.crypt*")
12087.   or FileName("*.db*")
12088.   or FileName("*.rdb*")
12089.   or FileName("*.dc*")
12090.   or FileName("*.dict*")
12091.   or FileName("*.?db*")
12092.   or FileName("*.?rdb*")
12093.   or FileName("*.md*")
12094.   or FileName("*.myd")
12095.   or FileName("*.ndf")
12096.   or FileName("*.ns?")
12097.   or FileName("*.pab")
12098.   or FileName("*.pst")
12099.   or FileName("*.sd?*")
12100.   or FileName("*.sq**")
12101.   or FileName("*.tmd")
12102.   or FileName("*.tps")
12103.   or FileName("*.tr*")
12104. )
12105. # Databases end.
12106. 
12107.     # BlobsAndExceptions
12108.     or 
12109. # Data start.
12110. (
12111.   DirectoryName("Data*")
12112.   or DirectoryName("Device*")
12113.   or DirectoryName("Export*")
12114.   or DirectoryName("Import*")
12115.   or DirectoryName("Log*")
12116.   or DirectoryName("*Log")
12117.   or DirectoryName("Maintenance*")
12118.   or DirectoryName("Rec*")
12119.   or DirectoryName("Sales*")
12120.   or DirectoryName("Search*")
12121.   or DirectoryName("User*")
12122. )
12123. # Data end.
12124. 
12125.     # BlobsAndExceptions
12126.   )
12127. ) )
12128. # BlobsAndExceptions end.
12129. 
12130. # Blobs
12131. ) and (
12132.   Size(BlobFileSize,0)
12133.   or (
12134.     FileName("*.arj")
12135.     or FileName("*.bup")
12136.     or FileName("*.bz2")
12137.     or FileName("*.chm")
12138.     or FileName("*.dvr-ms")
12139.     or FileName("*.gz")
12140.     or FileName("*.ifo")
12141.     or FileName("*.lzh")
12142.     or FileName("*.pdf")
12143.     or FileName("*.rpm")
12144.     or FileName("*.wmv")
12145.     or FileName("*.vob")
12146.     or FileName("*.z")
12147.   ) 
12148. )
12149. # Blobs end.
12150. 
12151. # NotBlobsArchivesBu
12152. or 
12153. # Archives start.
12154. (
12155.   DirectoryName("*Archive*")
12156.   or DirectoryName("*History*")
12157.   or DirectoryName("*Old")
12158.   or DirectoryName("* Old *")
12159.   or DirectoryName("Old *")
12160. 
12161.   or FileName("*.7z")
12162.   or FileName("*.cab")
12163.   or FileName("*.iso")
12164.   or FileName("*.msi")
12165.   or FileName("*.old")
12166.   or FileName("*.rar")
12167.   or FileName("*.tar")
12168.   or FileName("*.zip")
12169.   or
12170. # WinSysLow start.
12171. (
12172.   # Bad idea. This pushed lots of programs and data to archive.
12173.   # DirectoryName("$*")
12174.   # or DirectoryName("0*")
12175.   # or DirectoryName("1*")
12176.   # or DirectoryName("2*")
12177.   # or DirectoryName("3*")
12178.   # or DirectoryName("4*")
12179.   # or DirectoryName("5*")
12180.   # or DirectoryName("6*")
12181.   # or DirectoryName("7*")
12182.   # or DirectoryName("8*")
12183.   # or DirectoryName("9*")
12184.   # or 
12185.   DirectoryName("dllcache")
12186.   or DirectoryName("Downloaded Installations")
12187.   or DirectoryName("Ehome")
12188.   or DirectoryName("Fonts")
12189.   or DirectoryName("Help")
12190.   or DirectoryName("I386")
12191.   or DirectoryName("ie?updates")
12192.   or DirectoryName("Installer")
12193.   or DirectoryName("Installshield Installation Information")
12194.   or DirectoryName("IME")
12195.   or DirectoryName("*RECYCLE*")
12196.   or DirectoryName("ServicePackFiles")
12197.   or DirectoryName("SoftwareDistribution")
12198.   or DirectoryName("Speech")
12199.   or DirectoryName("Symbols")
12200.   or DirectoryName("System Volume Information")
12201.   or DirectoryName("windows.old")
12202. )
12203. # WinSysLow end.
12204. 
12205.   # Archives
12206. )
12207. # Archives end.
12208. 
12209. # NotBlobsArchivesBu
12210. or
12211. # Backups start.
12212. (
12213.   DirectoryName("*Backup*")
12214.   or DirectoryName("*Bu")
12215.   or DirectoryName("* Bu *")
12216.   or DirectoryName("Bu *")
12217. 
12218.   or FileName("*.bak")
12219.   or FileName("* - Copy*")
12220. )
12221. # Backups end.
12222. 
12223. # NotBlobsArchivesBu
12224. ) )
12225. # NotBlobsArchivesBu end.
12226. 
12227. # IdeScripts
12228. and ( 
12229. # Ide start.
12230. (
12231.     DirectoryName("Ide*")
12232.     or DirectoryName("Java*")
12233.     or DirectoryName("Os")
12234. )
12235. # Ide end.
12236. 
12237. # IdeScripts
12238. or  
12239. # Scripts start.
12240. (
12241.   DirectoryName("*Script*")
12242. )
12243. # Scripts end.
12244. 
12245. # IdeScripts
12246. )
12247. # IdeScripts end.
12248. 
12249. 	# Script: ZoneDoAction
12250. # Zone Do File Action - SortByName.
12251. 
12252. FileActions
12253. 
12254. 		/* ---------------------------------------------------------- */
12255. 	# Gap
12256. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
12257. 		# Script: DisplaySetFileStep
12258. 
12259. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12260. 
12261. /* add message and move to a new line. */
12262. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12263. ")
12264. 
12265. /* display the line. (hopefully.) */
12266. # Zone Footer Set Statistics Window Text
12267. 
12268. SetStatisticsWindowText("!Heading!
12269. ----------------------------------------------------------
12270. Zones Processed: 
12271. ----------------------------------------------------------
12272. !ZoneListByLine!
12273. ----------------------------------------------------------
12274. Zone Processing Step:
12275. !ZoneStepByLine!    
12276. ----------------------------------------------------------
12277. ----------------------------------------------------------
12278. Current Zone:
12279. !ZoneFooter!
12280. ----------------------------------------------------------
12281. ----------------------------------------------------------
12282. Volume Statistics:
12283. !VolumeStatisticsDetail!
12284. ----------------------------------------------------------
12285. ----------------------------------------------------------
12286. Zone Detailed Report:
12287. ----------------------------------------------------------
12288. !ZoneStatisticsDetail!
12289. ----------------------------------------------------------
12290. ")
12291. 
12292. 
12293. 
12294. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12295. 
12296. # Script: BannerSet
12297. 
12298. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
12299. 
12300. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
12301. 
12302. Title('!Heading!')
12303. /* pause(1) */
12304. 
12305. /* NOTE: Can't round or truncate to integer precision. */
12306. 
12307. pause(1)
12308. 	
12309. 	# ACTUAL GAP
12310. 		/* AddGap Variant. */
12311. 	  	# Zone Do Gap
12312. # Gap Calculation Methods:
12313. 
12314. /* 1) Anything you need to add first. */
12315. /* empty */
12316. 
12317. /* ---------------------------------------------------------- */
12318. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
12319. 	# GapRequestedStd.
12320. 
12321. 		/* ---------------------------------------------------------- */
12322. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
12323. 
12324. 		# Gap Calculation Methods:
12325. 
12326. /* AddGap Variants */
12327. 
12328. 	/* Standard */
12329. 		# Gap Calculation Methods:
12330. 	/* AddGap Variants */
12331. 	/* Standard */
12332. 
12333. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
12334. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
12335. 
12336. 	SetVariable(GapRequested, GapRequestedStd)
12337. 	
12338. 
12339. 	/* MFT Low High Method */
12340. 		# Gap Calculation Methods:
12341. 	/* AddGap Variants */
12342. 	/* MFT Low High Method */
12343. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
12344. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
12345. 	SetVariable(GapRequested, GapRequestedMft)
12346. 	
12347. 
12348. 	/* OS Volume Type Method */
12349. 		# Gap Calculation Methods:
12350. 	/* AddGap Variants */
12351. 	/* OS Volume Type Method */
12352. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
12353. 	SetVariable(GapRequested, GapRequestedOs)
12354. 
12355. 
12356. 
12357. /* MakeGap Variants */
12358. 
12359. 	/* Original Os 1-3 + MFT 2 */
12360. 		# Gap Calculation Methods:
12361. 	/* MakeGap Variants */
12362. 	/* Original Os 1-3 + MFT 2 */
12363. 	/* plus MFT gap placed inline at the dividing zone. */
12364. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
12365. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
12366. 	SetVariable(GapRequested, GapRequestedOrig)
12367. 	
12368. 	
12369. /* Note: You could comment out the ones not in use */
12370. /* However having the data in the log is useful. */
12371. /* Therefore the following line is otherwise needed. */
12372. 
12373. /* Standard used */
12374. 
12375. SetVariable(GapRequested, GapRequestedStd)
12376. 
12377. # Gap Calculation Methods:
12378. 
12379. /* AddGap Variants */
12380. 	/* Standard */
12381. 	/* MFT Low High Method */
12382. 	/* OS Volume Type Method */
12383. 
12384. /* MakeGap Variants */
12385. 	/* Original Os 1-3 + MFT 2 */
12386. 
12387. /* Note: You could comment out the ones not in use */
12388. /* However having the data in the log is useful. */
12389. /* Therefore the following line is otherwise needed. */
12390. 
12391. /* Standard is used currently */
12392. 
12393. 
12394. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
12395. 
12396. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
12397. 
12398. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
12399. 
12400. /* ---------------------------------------------------------- */
12401. /* 3) SMALL ZONE ADJUSTMENT. */
12402. /* Gab cant be larger than half the Zone Size. */
12403. 
12404. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
12405. 	
12406. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
12407. 
12408. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
12409. 
12410. /* ---------------------------------------------------------- */
12411. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
12412. # Gap Adjustments.
12413. 
12414. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
12415. 	
12416. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
12417. 
12418. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
12419. 
12420. /* ---------------------------------------------------------- */
12421. # BYPASS THIS.
12422. 	/* This is definitely wrong. */
12423. 	/* The question is can we steal gap from the next zone */
12424. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
12425. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
12426. 		# Zone Overflow.
12427. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
12428. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
12429. 
12430. /* ---------------------------------------------------------- */
12431. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
12432. # Remaining free space available.
12433. 
12434. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
12435. 	
12436. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
12437. 
12438. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
12439. 
12440. /* ---------------------------------------------------------- */
12441. # CURRENT gap to use.
12442. 
12443. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
12444. 
12445. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
12446. 
12447. /* ---------------------------------------------------------- */
12448. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
12449. # Debugging.
12450. 
12451. 	SetVariable(GapUsed, GapCurrent) // for debugging
12452. 
12453. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
12454. 
12455. 		# Your code HERE
12456. 
12457. /* ---------------------------------------------------------- */
12458. /* 7) YOUR CODE. */
12459. # YOUR CODE HERE:
12460. 	# INPUT: GapCurrent or GapCurrentLoc
12461. 	# OUTPUT: GapUsed...
12462. 
12463. /* ---------------------------------------------------------- */
12464. # Gap Size.
12465. # Actual Size of Gap.
12466. 
12467. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
12468. 
12469. /* ---------------------------------------------------------- */
12470. /* xxxxxxxxxxxxxxxxxxxxxx */
12471. # ADD THE GAP
12472. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
12473. /* xxxxxxxxxxxxxxxxxxxxxx */
12474. 
12475. 	
12476. 	# Zone Statistics	
12477. 	# Script: ZoneDoStatistics
12478. # Zone / Volume Statistics and Display
12479. 		
12480. 	# Accumulate Totals
12481.   	# Script: ZoneDoVolumeTotals
12482. 
12483. /* Current total space used (by Zones and Gaps) */
12484. 
12485. SetVariable(VolumeZoneUsed, GapUsed)
12486. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
12487. /* Percentage */
12488. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
12489. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
12490. 
12491. /* Current total of free space requested */
12492. 
12493. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
12494. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
12495. /* Percent. */
12496. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
12497. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
12498. 
12499. /* Current total of free space used */
12500. 
12501. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
12502. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
12503. /* Percent */
12504. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
12505. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
12506. 
12507. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
12508. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
12509. /* Xinclude "..\DebugDisplayPause.MyDc"X */
12510. 
12511. 
12512. 	# Current Values
12513. 	# Script: ZoneDoCurrentSet
12514. 
12515. # Cluster, Sector, Block adjust for display.
12516. 	# Bytes per cluster is volume specific.
12517. 
12518. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
12519. 
12520. # Current Zone values.
12521. 	# Begin, end and size.
12522. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
12523. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
12524. 
12525. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
12526. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
12527. 
12528. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
12529. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
12530. 
12531. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
12532. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
12533. 
12534. 	SetVariable(ZoneFragments,				"!ZONE210N!")
12535. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
12536. 		
12537. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
12538. /* identical code to here: (separation not needed. TEST.) */	
12539. 
12540. # Current Gap, Actual and Free Values
12541. 	# Gap
12542. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
12543. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
12544. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
12545. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
12546. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
12547. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
12548. 	
12549. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
12550. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
12551. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
12552. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
12553. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
12554. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
12555. 	
12556. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
12557. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
12558. 	
12559. 	# Actual Size and End
12560. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
12561. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
12562. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
12563. 	
12564. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
12565. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
12566. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
12567. 
12568. # Gap Size & Rounding
12569. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
12570. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
12571. 	
12572. 	# Free Space
12573. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
12574. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
12575. 
12576. 	# Footer:
12577. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
12578. # 2021-11-17 21:08:28
12579. 
12580. SetVariable(ZoneFooter1, "----------------------------------------------------------
12581. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
12582. #
12583. # Xinclude "..\Commands\DateTimeLastLong.txt"X
12584. #
12585. SetVariable(ZoneFooter2, "Statistics Report:
12586. ------------------
12587.    Size:  
12588.    ------------------------
12589.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12590.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12591.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12592. 
12593.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12594.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12595. 
12596.    Location:
12597.    ------------------------
12598.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12599.             Files End: !ZoneEndCurrent!
12600.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12601.       
12602.    Gap Settings:
12603.    ------------------------
12604.          Gap Requested: !ZoneGapSizePer!%
12605.        Volume Rounding: !ZoneVolRoundUpPer!%
12606.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12607.                  
12608.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
12609.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
12610.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
12611.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
12612.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
12613.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
12614.      
12615.    Free Space after Zone:
12616.    ------------------------
12617.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12618.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12619.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12620. 
12621. Directory and Files Select:
12622. ---------------------------
12623. !ZoneTypeSelectCurrent!               
12624. ---------------------------
12625. ----------------------------------------------------------
12626. ")
12627. 
12628. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
12629. 
12630. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
12631. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
12632. RunProgram("..\Commands\WriteDateTime.bat LastZone")
12633. 
12634. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
12635. 
12636. 
12637. 	# Zone Footer Set Statistics Window Text
12638. 
12639. SetStatisticsWindowText("!Heading!
12640. ----------------------------------------------------------
12641. Zones Processed: 
12642. ----------------------------------------------------------
12643. !ZoneListByLine!
12644. ----------------------------------------------------------
12645. Zone Processing Step:
12646. !ZoneStepByLine!    
12647. ----------------------------------------------------------
12648. ----------------------------------------------------------
12649. Current Zone:
12650. !ZoneFooter!
12651. ----------------------------------------------------------
12652. ----------------------------------------------------------
12653. Volume Statistics:
12654. !VolumeStatisticsDetail!
12655. ----------------------------------------------------------
12656. ----------------------------------------------------------
12657. Zone Detailed Report:
12658. ----------------------------------------------------------
12659. !ZoneStatisticsDetail!
12660. ----------------------------------------------------------
12661. ")
12662. 
12663. 
12664. 	
12665.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
12666. 
12667. 	# Add Zone to list of zones for display.
12668. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
12669. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
12670. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
12671. 	# ??? Free Stats?
12672. 	# Footer:
12673. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
12674. # 2021-11-17 21:08:28
12675. 
12676. SetVariable(ZoneFooter1, "----------------------------------------------------------
12677. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
12678. #
12679. # Xinclude "..\Commands\DateTimeLastLong.txt"X
12680. #
12681. SetVariable(ZoneFooter2, "Statistics Report:
12682. ------------------
12683.    Size:  
12684.    ------------------------
12685.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12686.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12687.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12688. 
12689.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12690.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12691. 
12692.    Location:
12693.    ------------------------
12694.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12695.             Files End: !ZoneEndCurrent!
12696.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12697.       
12698.    Gap Settings:
12699.    ------------------------
12700.          Gap Requested: !ZoneGapSizePer!%
12701.        Volume Rounding: !ZoneVolRoundUpPer!%
12702.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12703.                  
12704.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
12705.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
12706.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
12707.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
12708.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
12709.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
12710.      
12711.    Free Space after Zone:
12712.    ------------------------
12713.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12714.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12715.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12716. 
12717. Directory and Files Select:
12718. ---------------------------
12719. !ZoneTypeSelectCurrent!               
12720. ---------------------------
12721. ----------------------------------------------------------
12722. ")
12723. 
12724. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
12725. 
12726. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
12727. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
12728. RunProgram("..\Commands\WriteDateTime.bat LastZone")
12729. 
12730. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
12731. 
12732. 
12733. 
12734. 	# Add Zone Details to Report.	
12735. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
12736. !ZoneFooter!")
12737. 
12738. 
12739. 	
12740. 	# Footer:
12741. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
12742. # 2021-11-17 21:08:28
12743. 
12744. SetVariable(ZoneFooter1, "----------------------------------------------------------
12745. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
12746. #
12747. # Xinclude "..\Commands\DateTimeLastLong.txt"X
12748. #
12749. SetVariable(ZoneFooter2, "Statistics Report:
12750. ------------------
12751.    Size:  
12752.    ------------------------
12753.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12754.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12755.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12756. 
12757.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12758.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12759. 
12760.    Location:
12761.    ------------------------
12762.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12763.             Files End: !ZoneEndCurrent!
12764.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12765.       
12766.    Gap Settings:
12767.    ------------------------
12768.          Gap Requested: !ZoneGapSizePer!%
12769.        Volume Rounding: !ZoneVolRoundUpPer!%
12770.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12771.                  
12772.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
12773.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
12774.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
12775.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
12776.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
12777.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
12778.      
12779.    Free Space after Zone:
12780.    ------------------------
12781.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12782.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12783.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12784. 
12785. Directory and Files Select:
12786. ---------------------------
12787. !ZoneTypeSelectCurrent!               
12788. ---------------------------
12789. ----------------------------------------------------------
12790. ")
12791. 
12792. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
12793. 
12794. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
12795. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
12796. RunProgram("..\Commands\WriteDateTime.bat LastZone")
12797. 
12798. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
12799. 
12800. 
12801. 	SetStatisticsWindowText("!ZoneFooter!")
12802. 	
12803. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
12804. 	# Script: DisplaySetFileStep
12805. 
12806. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12807. 
12808. /* add message and move to a new line. */
12809. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12810. ")
12811. 
12812. /* display the line. (hopefully.) */
12813. # Zone Footer Set Statistics Window Text
12814. 
12815. SetStatisticsWindowText("!Heading!
12816. ----------------------------------------------------------
12817. Zones Processed: 
12818. ----------------------------------------------------------
12819. !ZoneListByLine!
12820. ----------------------------------------------------------
12821. Zone Processing Step:
12822. !ZoneStepByLine!    
12823. ----------------------------------------------------------
12824. ----------------------------------------------------------
12825. Current Zone:
12826. !ZoneFooter!
12827. ----------------------------------------------------------
12828. ----------------------------------------------------------
12829. Volume Statistics:
12830. !VolumeStatisticsDetail!
12831. ----------------------------------------------------------
12832. ----------------------------------------------------------
12833. Zone Detailed Report:
12834. ----------------------------------------------------------
12835. !ZoneStatisticsDetail!
12836. ----------------------------------------------------------
12837. ")
12838. 
12839. 
12840. 
12841. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12842. 
12843. # Script: BannerSet
12844. 
12845. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
12846. 
12847. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
12848. 
12849. Title('!Heading!')
12850. /* pause(1) */
12851. 
12852. /* NOTE: Can't round or truncate to integer precision. */
12853. 
12854. pause(1)
12855. 
12856. # Commands:
12857. 
12858. /* Moves to Zone or above it. */
12859. # MoveUpToZone()
12860. 
12861. # Defrag
12862. 
12863. # Defragment(OPTIONS)
12864. 
12865. /* Shuffles files around trying to make a big enough gap for fragmented files. */
12866. # Defragment()
12867. 
12868. /* Only does files where a gap will fit it. */
12869. # Defragment(Fast)
12870. 
12871. /* Skips fragmented files larger than the Chunck Size. */
12872. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
12873. # Defragment(Chunk Size)
12874. 
12875. /* Moves down to zone and packs zone to beginning if there are gaps. */
12876. /* Can be similar in performance to doing a SortBy. */
12877. # MoveDownFill()
12878. 
12879. # File Action - All - Regular -  SortByName.
12880. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
12881. 	
12882. 
12883. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
12884. 	# Script: DisplaySetFileStep
12885. 
12886. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12887. 
12888. /* add message and move to a new line. */
12889. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12890. ")
12891. 
12892. /* display the line. (hopefully.) */
12893. # Zone Footer Set Statistics Window Text
12894. 
12895. SetStatisticsWindowText("!Heading!
12896. ----------------------------------------------------------
12897. Zones Processed: 
12898. ----------------------------------------------------------
12899. !ZoneListByLine!
12900. ----------------------------------------------------------
12901. Zone Processing Step:
12902. !ZoneStepByLine!    
12903. ----------------------------------------------------------
12904. ----------------------------------------------------------
12905. Current Zone:
12906. !ZoneFooter!
12907. ----------------------------------------------------------
12908. ----------------------------------------------------------
12909. Volume Statistics:
12910. !VolumeStatisticsDetail!
12911. ----------------------------------------------------------
12912. ----------------------------------------------------------
12913. Zone Detailed Report:
12914. ----------------------------------------------------------
12915. !ZoneStatisticsDetail!
12916. ----------------------------------------------------------
12917. ")
12918. 
12919. 
12920. 
12921. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12922. 
12923. # Script: BannerSet
12924. 
12925. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
12926. 
12927. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
12928. 
12929. Title('!Heading!')
12930. /* pause(1) */
12931. 
12932. /* NOTE: Can't round or truncate to integer precision. */
12933. 
12934. pause(1)
12935. 
12936. 	# Script: ZoneDoFooter
12937. 
12938. /* ---------------------------------------------------------- */
12939. # File Select
12940. 	# Select Statments
12941. # File Actions 
12942. 	# Standard or OS File Actions.
12943. 	# Resume...
12944. 	
12945. 	# your stuff HERE (X)... post zone (file) file actions code.
12946. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
12947. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12948. 		# (X)
12949. 		
12950. 		/* ??? Set window? */
12951. 	
12952. 	# ADD THE GAP
12953. # Vacate (good for diagnostics)
12954. # DoNotVacate - DO NOT Vacate (recommended)
12955. # DoNotVacate - DO NOT Vacate (recommended)
12956. 
12957. # Vacate
12958. /* AddGap(GapUsedLoc) */
12959. 
12960. # DO Not Vacate
12961. AddGap(GapUsedLoc, DoNotVacate) 
12962. 	
12963. 	
12964. # Script: GapZoneCommand
12965. # *** Moved to setting yours ***
12966. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
12967. # Controlled via settings commands
12968. # DoNotVacate - DO NOT Vacate (recommended)
12969. 
12970. # Vacate
12971. /* AddGap(GapUsedLoc) */
12972. 
12973. # DO Not Vacate
12974. AddGap(GapUsedLoc, DoNotVacate) 
12975. 	
12976. 	
12977. # Vacate /* AddGap(GapUsed) */
12978. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
12979. 	
12980. 
12981. 		
12982. # 
12983. FileEnd
12984. /* ---------------------------------------------------------- */
12985. 
12986. # your stuff HERE (X)... post zone (file) code.
12987. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
12988. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12989. 	# (X)
12990. 
12991. SetVariable(FileStepDescription,"Zone finished, reporting.")
12992. # Script: DisplaySetFileStep
12993. 
12994. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12995. 
12996. /* add message and move to a new line. */
12997. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12998. ")
12999. 
13000. /* display the line. (hopefully.) */
13001. # Zone Footer Set Statistics Window Text
13002. 
13003. SetStatisticsWindowText("!Heading!
13004. ----------------------------------------------------------
13005. Zones Processed: 
13006. ----------------------------------------------------------
13007. !ZoneListByLine!
13008. ----------------------------------------------------------
13009. Zone Processing Step:
13010. !ZoneStepByLine!    
13011. ----------------------------------------------------------
13012. ----------------------------------------------------------
13013. Current Zone:
13014. !ZoneFooter!
13015. ----------------------------------------------------------
13016. ----------------------------------------------------------
13017. Volume Statistics:
13018. !VolumeStatisticsDetail!
13019. ----------------------------------------------------------
13020. ----------------------------------------------------------
13021. Zone Detailed Report:
13022. ----------------------------------------------------------
13023. !ZoneStatisticsDetail!
13024. ----------------------------------------------------------
13025. ")
13026. 
13027. 
13028. 
13029. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13030. 
13031. # Script: BannerSet
13032. 
13033. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13034. 
13035. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
13036. 
13037. Title('!Heading!')
13038. /* pause(1) */
13039. 
13040. /* NOTE: Can't round or truncate to integer precision. */
13041. 
13042. pause(1)
13043. 
13044. # Script: ZoneWhenFinished
13045. 
13046. # Script: BannerSet
13047. 
13048. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13049. 
13050. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
13051. 
13052. Title('!Heading!')
13053. /* pause(1) */
13054. 
13055. /* NOTE: Can't round or truncate to integer precision. */
13056. 
13057. # Script: BannerLog
13058. 
13059. AppendLogfile("!LogFileName!", "!Title!")
13060. 
13061. 
13062. 
13063. # Zone Statistics	
13064. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
13065. 
13066. # Footer:
13067. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
13068. # 2021-11-17 21:08:28
13069. 
13070. SetVariable(ZoneFooter1, "----------------------------------------------------------
13071. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
13072. #
13073. # Xinclude "..\Commands\DateTimeLastLong.txt"X
13074. #
13075. SetVariable(ZoneFooter2, "Statistics Report:
13076. ------------------
13077.    Size:  
13078.    ------------------------
13079.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13080.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13081.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13082. 
13083.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13084.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13085. 
13086.    Location:
13087.    ------------------------
13088.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13089.             Files End: !ZoneEndCurrent!
13090.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13091.       
13092.    Gap Settings:
13093.    ------------------------
13094.          Gap Requested: !ZoneGapSizePer!%
13095.        Volume Rounding: !ZoneVolRoundUpPer!%
13096.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13097.                  
13098.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
13099.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
13100.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
13101.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
13102.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
13103.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
13104.      
13105.    Free Space after Zone:
13106.    ------------------------
13107.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13108.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13109.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13110. 
13111. Directory and Files Select:
13112. ---------------------------
13113. !ZoneTypeSelectCurrent!               
13114. ---------------------------
13115. ----------------------------------------------------------
13116. ")
13117. 
13118. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
13119. 
13120. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
13121. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
13122. RunProgram("..\Commands\WriteDateTime.bat LastZone")
13123. 
13124. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
13125. 
13126. 
13127. 
13128. AppendLogfile("!LogFileName!", ".")
13129. AppendLogfile("!LogFileName!", "!ZoneFooter!")
13130. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
13131. AppendLogfile("!LogFileName!", ".")
13132. 
13133. # Zone Footer Set Statistics Window Text
13134. 
13135. SetStatisticsWindowText("!Heading!
13136. ----------------------------------------------------------
13137. Zones Processed: 
13138. ----------------------------------------------------------
13139. !ZoneListByLine!
13140. ----------------------------------------------------------
13141. Zone Processing Step:
13142. !ZoneStepByLine!    
13143. ----------------------------------------------------------
13144. ----------------------------------------------------------
13145. Current Zone:
13146. !ZoneFooter!
13147. ----------------------------------------------------------
13148. ----------------------------------------------------------
13149. Volume Statistics:
13150. !VolumeStatisticsDetail!
13151. ----------------------------------------------------------
13152. ----------------------------------------------------------
13153. Zone Detailed Report:
13154. ----------------------------------------------------------
13155. !ZoneStatisticsDetail!
13156. ----------------------------------------------------------
13157. ")
13158. 
13159. 
13160. 
13161. /* pause() */
13162. /* pause() */
13163. 
13164. 
13165. 
13166. 
13167. /* ---------------------------------------------------------- */
13168. 
13169. /* ---------------------------------------------------------- */
13170. /* Zone 9 DevToDo */
13171. # Script: DisplayColors - Zone Dark
13172. # Processed
13173. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
13174. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
13175. 
13176. # Light Green and Yellow
13177. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
13178. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
13179. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
13180. 
13181. # Script: DefragZoneTypeDevToDo
13182. /* ---------------------------------------------------------- */
13183. /* Zone DevToDo */
13184. 
13185. SetVariable(ZoneLabel, "!ZoneLabelDevToDo!")
13186. SetVariable(ZoneDescription, "!ZoneDescriptionDevToDo!")
13187. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpDevToDo!")
13188. SetVariable(ZoneGapSize, "!ZoneGapSizeDevToDo!")
13189. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectDevToDo
13190. # DevToDo start.
13191. # NotBlobsArchivesBu start.
13192. (not (
13193. # Blobs start.
13194. (
13195. # BlobsAndExceptions start.
13196. ( not(
13197.   FileName("*.bat")
13198.   or FileName("*.css")
13199.   or FileName("*.dll")
13200.   or FileName("*.exe")
13201.   or FileName("*.htm*")
13202.   or FileName("*.jar")
13203.   or FileName("*.js")
13204.   or FileName("*.script")
13205.   or FileName("*.wsf")
13206.   or (
13207. # Databases start.
13208. (
13209.   FileName("*.crypt*")
13210.   or FileName("*.db*")
13211.   or FileName("*.rdb*")
13212.   or FileName("*.dc*")
13213.   or FileName("*.dict*")
13214.   or FileName("*.?db*")
13215.   or FileName("*.?rdb*")
13216.   or FileName("*.md*")
13217.   or FileName("*.myd")
13218.   or FileName("*.ndf")
13219.   or FileName("*.ns?")
13220.   or FileName("*.pab")
13221.   or FileName("*.pst")
13222.   or FileName("*.sd?*")
13223.   or FileName("*.sq**")
13224.   or FileName("*.tmd")
13225.   or FileName("*.tps")
13226.   or FileName("*.tr*")
13227. )
13228. # Databases end.
13229. 
13230.     # BlobsAndExceptions
13231.     or 
13232. # Data start.
13233. (
13234.   DirectoryName("Data*")
13235.   or DirectoryName("Device*")
13236.   or DirectoryName("Export*")
13237.   or DirectoryName("Import*")
13238.   or DirectoryName("Log*")
13239.   or DirectoryName("*Log")
13240.   or DirectoryName("Maintenance*")
13241.   or DirectoryName("Rec*")
13242.   or DirectoryName("Sales*")
13243.   or DirectoryName("Search*")
13244.   or DirectoryName("User*")
13245. )
13246. # Data end.
13247. 
13248.     # BlobsAndExceptions
13249.   )
13250. ) )
13251. # BlobsAndExceptions end.
13252. 
13253. # Blobs
13254. ) and (
13255.   Size(BlobFileSize,0)
13256.   or (
13257.     FileName("*.arj")
13258.     or FileName("*.bup")
13259.     or FileName("*.bz2")
13260.     or FileName("*.chm")
13261.     or FileName("*.dvr-ms")
13262.     or FileName("*.gz")
13263.     or FileName("*.ifo")
13264.     or FileName("*.lzh")
13265.     or FileName("*.pdf")
13266.     or FileName("*.rpm")
13267.     or FileName("*.wmv")
13268.     or FileName("*.vob")
13269.     or FileName("*.z")
13270.   ) 
13271. )
13272. # Blobs end.
13273. 
13274. # NotBlobsArchivesBu
13275. or 
13276. # Archives start.
13277. (
13278.   DirectoryName("*Archive*")
13279.   or DirectoryName("*History*")
13280.   or DirectoryName("*Old")
13281.   or DirectoryName("* Old *")
13282.   or DirectoryName("Old *")
13283. 
13284.   or FileName("*.7z")
13285.   or FileName("*.cab")
13286.   or FileName("*.iso")
13287.   or FileName("*.msi")
13288.   or FileName("*.old")
13289.   or FileName("*.rar")
13290.   or FileName("*.tar")
13291.   or FileName("*.zip")
13292.   or
13293. # WinSysLow start.
13294. (
13295.   # Bad idea. This pushed lots of programs and data to archive.
13296.   # DirectoryName("$*")
13297.   # or DirectoryName("0*")
13298.   # or DirectoryName("1*")
13299.   # or DirectoryName("2*")
13300.   # or DirectoryName("3*")
13301.   # or DirectoryName("4*")
13302.   # or DirectoryName("5*")
13303.   # or DirectoryName("6*")
13304.   # or DirectoryName("7*")
13305.   # or DirectoryName("8*")
13306.   # or DirectoryName("9*")
13307.   # or 
13308.   DirectoryName("dllcache")
13309.   or DirectoryName("Downloaded Installations")
13310.   or DirectoryName("Ehome")
13311.   or DirectoryName("Fonts")
13312.   or DirectoryName("Help")
13313.   or DirectoryName("I386")
13314.   or DirectoryName("ie?updates")
13315.   or DirectoryName("Installer")
13316.   or DirectoryName("Installshield Installation Information")
13317.   or DirectoryName("IME")
13318.   or DirectoryName("*RECYCLE*")
13319.   or DirectoryName("ServicePackFiles")
13320.   or DirectoryName("SoftwareDistribution")
13321.   or DirectoryName("Speech")
13322.   or DirectoryName("Symbols")
13323.   or DirectoryName("System Volume Information")
13324.   or DirectoryName("windows.old")
13325. )
13326. # WinSysLow end.
13327. 
13328.   # Archives
13329. )
13330. # Archives end.
13331. 
13332. # NotBlobsArchivesBu
13333. or
13334. # Backups start.
13335. (
13336.   DirectoryName("*Backup*")
13337.   or DirectoryName("*Bu")
13338.   or DirectoryName("* Bu *")
13339.   or DirectoryName("Bu *")
13340. 
13341.   or FileName("*.bak")
13342.   or FileName("* - Copy*")
13343. )
13344. # Backups end.
13345. 
13346. # NotBlobsArchivesBu
13347. ) )
13348. # NotBlobsArchivesBu end.
13349. 
13350. # DevToDo
13351. and ( 
13352. # Dev start.
13353. (
13354.   DirectoryName("*Dev") 
13355.   or DirectoryName("Dev *") 
13356.   or DirectoryName("*Development*") 
13357.   or DirectoryName("DsVs*") 
13358.   or DirectoryName("Srt*") 
13359. )
13360. # Dev end.
13361. 
13362. # DevToDo
13363. or 
13364. # ToDo start.
13365. (
13366.   DirectoryName("*ToDo*")
13367. )
13368. # ToDo end.
13369. 
13370. # DevToDo
13371. )
13372. # DevToDo end.
13373. ')
13374. 
13375. 	# Script: ZoneDoHeader
13376. 
13377. # Script: ZoneWhenStarted
13378. RunProgram("..\Commands\WriteDateTime.bat")
13379. 
13380. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
13381. # Script: DisplaySetZone
13382. 
13383. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
13384. SetVariable(FileStepDescription,	"")
13385. 
13386. SetVariable(ZoneStepByLine, 			"Zone started.
13387. ")
13388. 
13389. # Script: BannerDescriptionSet
13390. 
13391. # Script: BannerSet
13392. 
13393. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13394. 
13395. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
13396. 
13397. Title('!Heading!')
13398. /* pause(1) */
13399. 
13400. /* NOTE: Can't round or truncate to integer precision. */
13401. 
13402. # Script: BannerLog
13403. 
13404. AppendLogfile("!LogFileName!", "!Title!")
13405. 
13406. 
13407. 
13408. pause(1)
13409. 
13410. 
13411. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
13412. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
13413. 
13414. SetVariable(ZoneStepNoCurrent, 0)
13415. 
13416. 
13417. # Script: ZoneDoCurrentClear
13418. 
13419. SetVariable(ZoneTypeSelectCurrent, 		"")
13420. 
13421. SetVariable(ZoneBeginCurrent, 			0)
13422. SetVariable(ZoneBeginPerCurrent, 		0)
13423. SetVariable(ZoneEndCurrent, 			0)
13424. SetVariable(ZoneEndPerCurrent, 			0)
13425. 
13426. SetVariable(ZoneSizeCurrent,			0)
13427. SetVariable(ZoneSizePerCurrent,			0)
13428. 
13429. SetVariable(ZoneGapRequestedCurrent,	0)
13430. SetVariable(ZoneGapRoundedCurrent, 		0)
13431. SetVariable(ZoneGapAdjustedCurrent, 	0)
13432. SetVariable(ZoneGapAvailableCurrent, 	0)
13433. SetVariable(ZoneGapCurrent,				0)
13434. SetVariable(ZoneGapUsedCurrent, 		0)
13435. 
13436. SetVariable(ZoneGapActualCurrent, 		0)
13437. SetVariable(ZoneGapActualPerCurrent, 	0)
13438. 
13439. SetVariable(ZoneSizeActual, 			0)
13440. SetVariable(ZoneSizeActualCurrent,		0)
13441. 
13442. SetVariable(ZoneEndActual, 				0)
13443. SetVariable(ZoneEndActualCurrent,		0)			
13444. SetVariable(ZoneSizeActualPerCurrent, 	0)
13445.       
13446. SetVariable(ZoneFilesFolders,			0)
13447. SetVariable(ZoneFilesFoldersPer,		0) 
13448. 
13449. SetVariable(ZoneFragments,				0)
13450. SetVariable(ZoneFragmentsPer,			0) 
13451. 		
13452. SetVariable(ZoneEndActualCurrent, 		0)
13453. SetVariable(ZoneEndActualPerCurrent, 	0)
13454. 
13455. # Gap Calculation Methodology:
13456. 	# Requested
13457. 	SetVariable(GapRequested, 			0) 
13458. 	SetVariable(GapRequestedStd, 		0) 
13459. 	SetVariable(GapRequestedMft, 		0) 
13460. 	SetVariable(GapRequestedOs, 		0) 
13461. 	SetVariable(GapRequestedOriginal, 	0) 
13462. 	
13463. 	# Gap Adjustments
13464. 	SetVariable(GapRounded, 			0)
13465. 	# SetVariable(GapAdjusted, 			0)
13466. 	SetVariable(GapAvailable, 			0)
13467. 	SetVariable(GapCurrent, 			0)
13468. 	SetVariable(GapActual, 				0)
13469. 	SetVariable(GapUsed, 				0)
13470. 	
13471. 	# Gap Adjustments
13472. 	SetVariable(GapRoundedLoc, 			0)
13473. 	# SetVariable(GapAdjustedLoc, 		0)
13474. 	SetVariable(GapAvailableLoc, 		0)
13475. 	SetVariable(GapCurrentLoc, 			0)
13476. 	SetVariable(GapActualLoc,			0)
13477. 	SetVariable(GapUsedLoc,				0)
13478. 	
13479. 	# Space usage
13480. 	SetVariable(ZoneFreePerRequested, 	0)
13481. 	SetVariable(ZoneFreePerUsed, 		0)
13482. 
13483. # Gap Size & Rounding
13484. 	SetVariable(ZoneGapSizePer, 		0)
13485. 	SetVariable(ZoneVolRoundUpPer, 		0)
13486. 	
13487. 	# Free Space
13488. 	SetVariable(ZoneFreeUsedPer, 		0)
13489. 	SetVariable(ZoneFreeRequestedPer, 	0)
13490. 
13491. 
13492. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
13493. 
13494. # Footer:
13495. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
13496. # 2021-11-17 21:08:28
13497. 
13498. SetVariable(ZoneFooter1, "----------------------------------------------------------
13499. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
13500. #
13501. # Xinclude "..\Commands\DateTimeLastLong.txt"X
13502. #
13503. SetVariable(ZoneFooter2, "Statistics Report:
13504. ------------------
13505.    Size:  
13506.    ------------------------
13507.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13508.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13509.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13510. 
13511.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13512.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13513. 
13514.    Location:
13515.    ------------------------
13516.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13517.             Files End: !ZoneEndCurrent!
13518.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13519.       
13520.    Gap Settings:
13521.    ------------------------
13522.          Gap Requested: !ZoneGapSizePer!%
13523.        Volume Rounding: !ZoneVolRoundUpPer!%
13524.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13525.                  
13526.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
13527.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
13528.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
13529.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
13530.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
13531.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
13532.      
13533.    Free Space after Zone:
13534.    ------------------------
13535.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13536.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13537.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13538. 
13539. Directory and Files Select:
13540. ---------------------------
13541. !ZoneTypeSelectCurrent!               
13542. ---------------------------
13543. ----------------------------------------------------------
13544. ")
13545. 
13546. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
13547. 
13548. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
13549. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
13550. RunProgram("..\Commands\WriteDateTime.bat LastZone")
13551. 
13552. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
13553. 
13554. 
13555. 
13556. # Script: BannerSet
13557. 
13558. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13559. 
13560. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
13561. 
13562. Title('!Heading!')
13563. /* pause(1) */
13564. 
13565. /* NOTE: Can't round or truncate to integer precision. */
13566. 
13567. # Script: BannerLog
13568. 
13569. AppendLogfile("!LogFileName!", "!Title!")
13570. 
13571. 
13572. 
13573. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
13574. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
13575. 
13576. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
13577. 
13578. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:28")
13579. 
13580. # 2021-11-17 21:08:28 
13581. SetVariable(Temp9, DATETIME)
13582. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:03 !ZoneLabel! !ZoneDescription!")
13583. 
13584. SetVariable(ZoneListByLine, "!ZoneListByLine! 
13585. Zone: !ZoneNoCurrent! !Temp9! 0:00:03 !ZoneLabel! !ZoneDescription!")
13586. 
13587. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:03 !ZoneLabel! !ZoneDescription!")
13588. 
13589. 
13590. /* Fixed Zone Position Handling */
13591. /* Literal number: */
13592. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
13593. /* Percentage of disk: */
13594. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
13595. /* Gap */
13596. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
13597. 
13598. /* ---------------------------------------------------------- */
13599. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
13600. # Script: DisplaySetFileStep
13601. 
13602. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13603. 
13604. /* add message and move to a new line. */
13605. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13606. ")
13607. 
13608. /* display the line. (hopefully.) */
13609. # Zone Footer Set Statistics Window Text
13610. 
13611. SetStatisticsWindowText("!Heading!
13612. ----------------------------------------------------------
13613. Zones Processed: 
13614. ----------------------------------------------------------
13615. !ZoneListByLine!
13616. ----------------------------------------------------------
13617. Zone Processing Step:
13618. !ZoneStepByLine!    
13619. ----------------------------------------------------------
13620. ----------------------------------------------------------
13621. Current Zone:
13622. !ZoneFooter!
13623. ----------------------------------------------------------
13624. ----------------------------------------------------------
13625. Volume Statistics:
13626. !VolumeStatisticsDetail!
13627. ----------------------------------------------------------
13628. ----------------------------------------------------------
13629. Zone Detailed Report:
13630. ----------------------------------------------------------
13631. !ZoneStatisticsDetail!
13632. ----------------------------------------------------------
13633. ")
13634. 
13635. 
13636. 
13637. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13638. 
13639. # Script: BannerSet
13640. 
13641. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13642. 
13643. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
13644. 
13645. Title('!Heading!')
13646. /* pause(1) */
13647. 
13648. /* NOTE: Can't round or truncate to integer precision. */
13649. 
13650. pause(1)
13651. 
13652. # your stuff HERE (X)... pre file select code.
13653. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
13654. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13655. 	# (X)
13656. 
13657. FileSelect
13658. 
13659. 	# your stuff can't really go here (errors.)
13660. 	# maybe for some reason I don't know of...
13661. 	
13662. 	# Actions next...
13663. 	# Script: ZoneDo ZoneTypeSelectDevToDo
13664. # DevToDo start.
13665. # NotBlobsArchivesBu start.
13666. (not (
13667. # Blobs start.
13668. (
13669. # BlobsAndExceptions start.
13670. ( not(
13671.   FileName("*.bat")
13672.   or FileName("*.css")
13673.   or FileName("*.dll")
13674.   or FileName("*.exe")
13675.   or FileName("*.htm*")
13676.   or FileName("*.jar")
13677.   or FileName("*.js")
13678.   or FileName("*.script")
13679.   or FileName("*.wsf")
13680.   or (
13681. # Databases start.
13682. (
13683.   FileName("*.crypt*")
13684.   or FileName("*.db*")
13685.   or FileName("*.rdb*")
13686.   or FileName("*.dc*")
13687.   or FileName("*.dict*")
13688.   or FileName("*.?db*")
13689.   or FileName("*.?rdb*")
13690.   or FileName("*.md*")
13691.   or FileName("*.myd")
13692.   or FileName("*.ndf")
13693.   or FileName("*.ns?")
13694.   or FileName("*.pab")
13695.   or FileName("*.pst")
13696.   or FileName("*.sd?*")
13697.   or FileName("*.sq**")
13698.   or FileName("*.tmd")
13699.   or FileName("*.tps")
13700.   or FileName("*.tr*")
13701. )
13702. # Databases end.
13703. 
13704.     # BlobsAndExceptions
13705.     or 
13706. # Data start.
13707. (
13708.   DirectoryName("Data*")
13709.   or DirectoryName("Device*")
13710.   or DirectoryName("Export*")
13711.   or DirectoryName("Import*")
13712.   or DirectoryName("Log*")
13713.   or DirectoryName("*Log")
13714.   or DirectoryName("Maintenance*")
13715.   or DirectoryName("Rec*")
13716.   or DirectoryName("Sales*")
13717.   or DirectoryName("Search*")
13718.   or DirectoryName("User*")
13719. )
13720. # Data end.
13721. 
13722.     # BlobsAndExceptions
13723.   )
13724. ) )
13725. # BlobsAndExceptions end.
13726. 
13727. # Blobs
13728. ) and (
13729.   Size(BlobFileSize,0)
13730.   or (
13731.     FileName("*.arj")
13732.     or FileName("*.bup")
13733.     or FileName("*.bz2")
13734.     or FileName("*.chm")
13735.     or FileName("*.dvr-ms")
13736.     or FileName("*.gz")
13737.     or FileName("*.ifo")
13738.     or FileName("*.lzh")
13739.     or FileName("*.pdf")
13740.     or FileName("*.rpm")
13741.     or FileName("*.wmv")
13742.     or FileName("*.vob")
13743.     or FileName("*.z")
13744.   ) 
13745. )
13746. # Blobs end.
13747. 
13748. # NotBlobsArchivesBu
13749. or 
13750. # Archives start.
13751. (
13752.   DirectoryName("*Archive*")
13753.   or DirectoryName("*History*")
13754.   or DirectoryName("*Old")
13755.   or DirectoryName("* Old *")
13756.   or DirectoryName("Old *")
13757. 
13758.   or FileName("*.7z")
13759.   or FileName("*.cab")
13760.   or FileName("*.iso")
13761.   or FileName("*.msi")
13762.   or FileName("*.old")
13763.   or FileName("*.rar")
13764.   or FileName("*.tar")
13765.   or FileName("*.zip")
13766.   or
13767. # WinSysLow start.
13768. (
13769.   # Bad idea. This pushed lots of programs and data to archive.
13770.   # DirectoryName("$*")
13771.   # or DirectoryName("0*")
13772.   # or DirectoryName("1*")
13773.   # or DirectoryName("2*")
13774.   # or DirectoryName("3*")
13775.   # or DirectoryName("4*")
13776.   # or DirectoryName("5*")
13777.   # or DirectoryName("6*")
13778.   # or DirectoryName("7*")
13779.   # or DirectoryName("8*")
13780.   # or DirectoryName("9*")
13781.   # or 
13782.   DirectoryName("dllcache")
13783.   or DirectoryName("Downloaded Installations")
13784.   or DirectoryName("Ehome")
13785.   or DirectoryName("Fonts")
13786.   or DirectoryName("Help")
13787.   or DirectoryName("I386")
13788.   or DirectoryName("ie?updates")
13789.   or DirectoryName("Installer")
13790.   or DirectoryName("Installshield Installation Information")
13791.   or DirectoryName("IME")
13792.   or DirectoryName("*RECYCLE*")
13793.   or DirectoryName("ServicePackFiles")
13794.   or DirectoryName("SoftwareDistribution")
13795.   or DirectoryName("Speech")
13796.   or DirectoryName("Symbols")
13797.   or DirectoryName("System Volume Information")
13798.   or DirectoryName("windows.old")
13799. )
13800. # WinSysLow end.
13801. 
13802.   # Archives
13803. )
13804. # Archives end.
13805. 
13806. # NotBlobsArchivesBu
13807. or
13808. # Backups start.
13809. (
13810.   DirectoryName("*Backup*")
13811.   or DirectoryName("*Bu")
13812.   or DirectoryName("* Bu *")
13813.   or DirectoryName("Bu *")
13814. 
13815.   or FileName("*.bak")
13816.   or FileName("* - Copy*")
13817. )
13818. # Backups end.
13819. 
13820. # NotBlobsArchivesBu
13821. ) )
13822. # NotBlobsArchivesBu end.
13823. 
13824. # DevToDo
13825. and ( 
13826. # Dev start.
13827. (
13828.   DirectoryName("*Dev") 
13829.   or DirectoryName("Dev *") 
13830.   or DirectoryName("*Development*") 
13831.   or DirectoryName("DsVs*") 
13832.   or DirectoryName("Srt*") 
13833. )
13834. # Dev end.
13835. 
13836. # DevToDo
13837. or 
13838. # ToDo start.
13839. (
13840.   DirectoryName("*ToDo*")
13841. )
13842. # ToDo end.
13843. 
13844. # DevToDo
13845. )
13846. # DevToDo end.
13847. 
13848. 	# Script: ZoneDoAction
13849. # Zone Do File Action - SortByName.
13850. 
13851. FileActions
13852. 
13853. 		/* ---------------------------------------------------------- */
13854. 	# Gap
13855. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
13856. 		# Script: DisplaySetFileStep
13857. 
13858. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13859. 
13860. /* add message and move to a new line. */
13861. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13862. ")
13863. 
13864. /* display the line. (hopefully.) */
13865. # Zone Footer Set Statistics Window Text
13866. 
13867. SetStatisticsWindowText("!Heading!
13868. ----------------------------------------------------------
13869. Zones Processed: 
13870. ----------------------------------------------------------
13871. !ZoneListByLine!
13872. ----------------------------------------------------------
13873. Zone Processing Step:
13874. !ZoneStepByLine!    
13875. ----------------------------------------------------------
13876. ----------------------------------------------------------
13877. Current Zone:
13878. !ZoneFooter!
13879. ----------------------------------------------------------
13880. ----------------------------------------------------------
13881. Volume Statistics:
13882. !VolumeStatisticsDetail!
13883. ----------------------------------------------------------
13884. ----------------------------------------------------------
13885. Zone Detailed Report:
13886. ----------------------------------------------------------
13887. !ZoneStatisticsDetail!
13888. ----------------------------------------------------------
13889. ")
13890. 
13891. 
13892. 
13893. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13894. 
13895. # Script: BannerSet
13896. 
13897. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
13898. 
13899. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
13900. 
13901. Title('!Heading!')
13902. /* pause(1) */
13903. 
13904. /* NOTE: Can't round or truncate to integer precision. */
13905. 
13906. pause(1)
13907. 	
13908. 	# ACTUAL GAP
13909. 		/* AddGap Variant. */
13910. 	  	# Zone Do Gap
13911. # Gap Calculation Methods:
13912. 
13913. /* 1) Anything you need to add first. */
13914. /* empty */
13915. 
13916. /* ---------------------------------------------------------- */
13917. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
13918. 	# GapRequestedStd.
13919. 
13920. 		/* ---------------------------------------------------------- */
13921. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
13922. 
13923. 		# Gap Calculation Methods:
13924. 
13925. /* AddGap Variants */
13926. 
13927. 	/* Standard */
13928. 		# Gap Calculation Methods:
13929. 	/* AddGap Variants */
13930. 	/* Standard */
13931. 
13932. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
13933. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
13934. 
13935. 	SetVariable(GapRequested, GapRequestedStd)
13936. 	
13937. 
13938. 	/* MFT Low High Method */
13939. 		# Gap Calculation Methods:
13940. 	/* AddGap Variants */
13941. 	/* MFT Low High Method */
13942. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
13943. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
13944. 	SetVariable(GapRequested, GapRequestedMft)
13945. 	
13946. 
13947. 	/* OS Volume Type Method */
13948. 		# Gap Calculation Methods:
13949. 	/* AddGap Variants */
13950. 	/* OS Volume Type Method */
13951. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
13952. 	SetVariable(GapRequested, GapRequestedOs)
13953. 
13954. 
13955. 
13956. /* MakeGap Variants */
13957. 
13958. 	/* Original Os 1-3 + MFT 2 */
13959. 		# Gap Calculation Methods:
13960. 	/* MakeGap Variants */
13961. 	/* Original Os 1-3 + MFT 2 */
13962. 	/* plus MFT gap placed inline at the dividing zone. */
13963. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
13964. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
13965. 	SetVariable(GapRequested, GapRequestedOrig)
13966. 	
13967. 	
13968. /* Note: You could comment out the ones not in use */
13969. /* However having the data in the log is useful. */
13970. /* Therefore the following line is otherwise needed. */
13971. 
13972. /* Standard used */
13973. 
13974. SetVariable(GapRequested, GapRequestedStd)
13975. 
13976. # Gap Calculation Methods:
13977. 
13978. /* AddGap Variants */
13979. 	/* Standard */
13980. 	/* MFT Low High Method */
13981. 	/* OS Volume Type Method */
13982. 
13983. /* MakeGap Variants */
13984. 	/* Original Os 1-3 + MFT 2 */
13985. 
13986. /* Note: You could comment out the ones not in use */
13987. /* However having the data in the log is useful. */
13988. /* Therefore the following line is otherwise needed. */
13989. 
13990. /* Standard is used currently */
13991. 
13992. 
13993. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
13994. 
13995. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
13996. 
13997. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
13998. 
13999. /* ---------------------------------------------------------- */
14000. /* 3) SMALL ZONE ADJUSTMENT. */
14001. /* Gab cant be larger than half the Zone Size. */
14002. 
14003. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
14004. 	
14005. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
14006. 
14007. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
14008. 
14009. /* ---------------------------------------------------------- */
14010. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
14011. # Gap Adjustments.
14012. 
14013. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
14014. 	
14015. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
14016. 
14017. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
14018. 
14019. /* ---------------------------------------------------------- */
14020. # BYPASS THIS.
14021. 	/* This is definitely wrong. */
14022. 	/* The question is can we steal gap from the next zone */
14023. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
14024. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
14025. 		# Zone Overflow.
14026. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
14027. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
14028. 
14029. /* ---------------------------------------------------------- */
14030. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
14031. # Remaining free space available.
14032. 
14033. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
14034. 	
14035. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
14036. 
14037. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
14038. 
14039. /* ---------------------------------------------------------- */
14040. # CURRENT gap to use.
14041. 
14042. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
14043. 
14044. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
14045. 
14046. /* ---------------------------------------------------------- */
14047. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
14048. # Debugging.
14049. 
14050. 	SetVariable(GapUsed, GapCurrent) // for debugging
14051. 
14052. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
14053. 
14054. 		# Your code HERE
14055. 
14056. /* ---------------------------------------------------------- */
14057. /* 7) YOUR CODE. */
14058. # YOUR CODE HERE:
14059. 	# INPUT: GapCurrent or GapCurrentLoc
14060. 	# OUTPUT: GapUsed...
14061. 
14062. /* ---------------------------------------------------------- */
14063. # Gap Size.
14064. # Actual Size of Gap.
14065. 
14066. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
14067. 
14068. /* ---------------------------------------------------------- */
14069. /* xxxxxxxxxxxxxxxxxxxxxx */
14070. # ADD THE GAP
14071. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
14072. /* xxxxxxxxxxxxxxxxxxxxxx */
14073. 
14074. 	
14075. 	# Zone Statistics	
14076. 	# Script: ZoneDoStatistics
14077. # Zone / Volume Statistics and Display
14078. 		
14079. 	# Accumulate Totals
14080.   	# Script: ZoneDoVolumeTotals
14081. 
14082. /* Current total space used (by Zones and Gaps) */
14083. 
14084. SetVariable(VolumeZoneUsed, GapUsed)
14085. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
14086. /* Percentage */
14087. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
14088. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
14089. 
14090. /* Current total of free space requested */
14091. 
14092. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
14093. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
14094. /* Percent. */
14095. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
14096. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
14097. 
14098. /* Current total of free space used */
14099. 
14100. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
14101. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
14102. /* Percent */
14103. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
14104. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
14105. 
14106. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
14107. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
14108. /* Xinclude "..\DebugDisplayPause.MyDc"X */
14109. 
14110. 
14111. 	# Current Values
14112. 	# Script: ZoneDoCurrentSet
14113. 
14114. # Cluster, Sector, Block adjust for display.
14115. 	# Bytes per cluster is volume specific.
14116. 
14117. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
14118. 
14119. # Current Zone values.
14120. 	# Begin, end and size.
14121. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
14122. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
14123. 
14124. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
14125. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
14126. 
14127. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
14128. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
14129. 
14130. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
14131. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
14132. 
14133. 	SetVariable(ZoneFragments,				"!ZONE210N!")
14134. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
14135. 		
14136. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
14137. /* identical code to here: (separation not needed. TEST.) */	
14138. 
14139. # Current Gap, Actual and Free Values
14140. 	# Gap
14141. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
14142. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
14143. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
14144. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
14145. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
14146. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
14147. 	
14148. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
14149. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
14150. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
14151. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
14152. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
14153. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
14154. 	
14155. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
14156. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
14157. 	
14158. 	# Actual Size and End
14159. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
14160. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
14161. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
14162. 	
14163. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
14164. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
14165. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
14166. 
14167. # Gap Size & Rounding
14168. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
14169. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
14170. 	
14171. 	# Free Space
14172. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
14173. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
14174. 
14175. 	# Footer:
14176. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
14177. # 2021-11-17 21:08:28
14178. 
14179. SetVariable(ZoneFooter1, "----------------------------------------------------------
14180. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
14181. #
14182. # Xinclude "..\Commands\DateTimeLastLong.txt"X
14183. #
14184. SetVariable(ZoneFooter2, "Statistics Report:
14185. ------------------
14186.    Size:  
14187.    ------------------------
14188.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14189.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14190.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14191. 
14192.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14193.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14194. 
14195.    Location:
14196.    ------------------------
14197.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14198.             Files End: !ZoneEndCurrent!
14199.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14200.       
14201.    Gap Settings:
14202.    ------------------------
14203.          Gap Requested: !ZoneGapSizePer!%
14204.        Volume Rounding: !ZoneVolRoundUpPer!%
14205.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14206.                  
14207.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
14208.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
14209.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
14210.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
14211.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
14212.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
14213.      
14214.    Free Space after Zone:
14215.    ------------------------
14216.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14217.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14218.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14219. 
14220. Directory and Files Select:
14221. ---------------------------
14222. !ZoneTypeSelectCurrent!               
14223. ---------------------------
14224. ----------------------------------------------------------
14225. ")
14226. 
14227. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
14228. 
14229. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
14230. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
14231. RunProgram("..\Commands\WriteDateTime.bat LastZone")
14232. 
14233. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
14234. 
14235. 
14236. 	# Zone Footer Set Statistics Window Text
14237. 
14238. SetStatisticsWindowText("!Heading!
14239. ----------------------------------------------------------
14240. Zones Processed: 
14241. ----------------------------------------------------------
14242. !ZoneListByLine!
14243. ----------------------------------------------------------
14244. Zone Processing Step:
14245. !ZoneStepByLine!    
14246. ----------------------------------------------------------
14247. ----------------------------------------------------------
14248. Current Zone:
14249. !ZoneFooter!
14250. ----------------------------------------------------------
14251. ----------------------------------------------------------
14252. Volume Statistics:
14253. !VolumeStatisticsDetail!
14254. ----------------------------------------------------------
14255. ----------------------------------------------------------
14256. Zone Detailed Report:
14257. ----------------------------------------------------------
14258. !ZoneStatisticsDetail!
14259. ----------------------------------------------------------
14260. ")
14261. 
14262. 
14263. 	
14264.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
14265. 
14266. 	# Add Zone to list of zones for display.
14267. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
14268. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
14269. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
14270. 	# ??? Free Stats?
14271. 	# Footer:
14272. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
14273. # 2021-11-17 21:08:28
14274. 
14275. SetVariable(ZoneFooter1, "----------------------------------------------------------
14276. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
14277. #
14278. # Xinclude "..\Commands\DateTimeLastLong.txt"X
14279. #
14280. SetVariable(ZoneFooter2, "Statistics Report:
14281. ------------------
14282.    Size:  
14283.    ------------------------
14284.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14285.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14286.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14287. 
14288.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14289.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14290. 
14291.    Location:
14292.    ------------------------
14293.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14294.             Files End: !ZoneEndCurrent!
14295.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14296.       
14297.    Gap Settings:
14298.    ------------------------
14299.          Gap Requested: !ZoneGapSizePer!%
14300.        Volume Rounding: !ZoneVolRoundUpPer!%
14301.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14302.                  
14303.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
14304.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
14305.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
14306.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
14307.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
14308.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
14309.      
14310.    Free Space after Zone:
14311.    ------------------------
14312.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14313.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14314.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14315. 
14316. Directory and Files Select:
14317. ---------------------------
14318. !ZoneTypeSelectCurrent!               
14319. ---------------------------
14320. ----------------------------------------------------------
14321. ")
14322. 
14323. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
14324. 
14325. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
14326. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
14327. RunProgram("..\Commands\WriteDateTime.bat LastZone")
14328. 
14329. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
14330. 
14331. 
14332. 
14333. 	# Add Zone Details to Report.	
14334. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
14335. !ZoneFooter!")
14336. 
14337. 
14338. 	
14339. 	# Footer:
14340. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
14341. # 2021-11-17 21:08:28
14342. 
14343. SetVariable(ZoneFooter1, "----------------------------------------------------------
14344. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
14345. #
14346. # Xinclude "..\Commands\DateTimeLastLong.txt"X
14347. #
14348. SetVariable(ZoneFooter2, "Statistics Report:
14349. ------------------
14350.    Size:  
14351.    ------------------------
14352.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14353.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14354.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14355. 
14356.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14357.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14358. 
14359.    Location:
14360.    ------------------------
14361.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14362.             Files End: !ZoneEndCurrent!
14363.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14364.       
14365.    Gap Settings:
14366.    ------------------------
14367.          Gap Requested: !ZoneGapSizePer!%
14368.        Volume Rounding: !ZoneVolRoundUpPer!%
14369.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14370.                  
14371.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
14372.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
14373.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
14374.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
14375.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
14376.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
14377.      
14378.    Free Space after Zone:
14379.    ------------------------
14380.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14381.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14382.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14383. 
14384. Directory and Files Select:
14385. ---------------------------
14386. !ZoneTypeSelectCurrent!               
14387. ---------------------------
14388. ----------------------------------------------------------
14389. ")
14390. 
14391. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
14392. 
14393. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
14394. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
14395. RunProgram("..\Commands\WriteDateTime.bat LastZone")
14396. 
14397. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
14398. 
14399. 
14400. 	SetStatisticsWindowText("!ZoneFooter!")
14401. 	
14402. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
14403. 	# Script: DisplaySetFileStep
14404. 
14405. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14406. 
14407. /* add message and move to a new line. */
14408. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14409. ")
14410. 
14411. /* display the line. (hopefully.) */
14412. # Zone Footer Set Statistics Window Text
14413. 
14414. SetStatisticsWindowText("!Heading!
14415. ----------------------------------------------------------
14416. Zones Processed: 
14417. ----------------------------------------------------------
14418. !ZoneListByLine!
14419. ----------------------------------------------------------
14420. Zone Processing Step:
14421. !ZoneStepByLine!    
14422. ----------------------------------------------------------
14423. ----------------------------------------------------------
14424. Current Zone:
14425. !ZoneFooter!
14426. ----------------------------------------------------------
14427. ----------------------------------------------------------
14428. Volume Statistics:
14429. !VolumeStatisticsDetail!
14430. ----------------------------------------------------------
14431. ----------------------------------------------------------
14432. Zone Detailed Report:
14433. ----------------------------------------------------------
14434. !ZoneStatisticsDetail!
14435. ----------------------------------------------------------
14436. ")
14437. 
14438. 
14439. 
14440. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14441. 
14442. # Script: BannerSet
14443. 
14444. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
14445. 
14446. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
14447. 
14448. Title('!Heading!')
14449. /* pause(1) */
14450. 
14451. /* NOTE: Can't round or truncate to integer precision. */
14452. 
14453. pause(1)
14454. 
14455. # Commands:
14456. 
14457. /* Moves to Zone or above it. */
14458. # MoveUpToZone()
14459. 
14460. # Defrag
14461. 
14462. # Defragment(OPTIONS)
14463. 
14464. /* Shuffles files around trying to make a big enough gap for fragmented files. */
14465. # Defragment()
14466. 
14467. /* Only does files where a gap will fit it. */
14468. # Defragment(Fast)
14469. 
14470. /* Skips fragmented files larger than the Chunck Size. */
14471. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
14472. # Defragment(Chunk Size)
14473. 
14474. /* Moves down to zone and packs zone to beginning if there are gaps. */
14475. /* Can be similar in performance to doing a SortBy. */
14476. # MoveDownFill()
14477. 
14478. # File Action - All - Regular -  SortByName.
14479. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
14480. 	
14481. 
14482. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
14483. 	# Script: DisplaySetFileStep
14484. 
14485. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14486. 
14487. /* add message and move to a new line. */
14488. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14489. ")
14490. 
14491. /* display the line. (hopefully.) */
14492. # Zone Footer Set Statistics Window Text
14493. 
14494. SetStatisticsWindowText("!Heading!
14495. ----------------------------------------------------------
14496. Zones Processed: 
14497. ----------------------------------------------------------
14498. !ZoneListByLine!
14499. ----------------------------------------------------------
14500. Zone Processing Step:
14501. !ZoneStepByLine!    
14502. ----------------------------------------------------------
14503. ----------------------------------------------------------
14504. Current Zone:
14505. !ZoneFooter!
14506. ----------------------------------------------------------
14507. ----------------------------------------------------------
14508. Volume Statistics:
14509. !VolumeStatisticsDetail!
14510. ----------------------------------------------------------
14511. ----------------------------------------------------------
14512. Zone Detailed Report:
14513. ----------------------------------------------------------
14514. !ZoneStatisticsDetail!
14515. ----------------------------------------------------------
14516. ")
14517. 
14518. 
14519. 
14520. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14521. 
14522. # Script: BannerSet
14523. 
14524. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
14525. 
14526. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
14527. 
14528. Title('!Heading!')
14529. /* pause(1) */
14530. 
14531. /* NOTE: Can't round or truncate to integer precision. */
14532. 
14533. pause(1)
14534. 
14535. 	# Script: ZoneDoFooter
14536. 
14537. /* ---------------------------------------------------------- */
14538. # File Select
14539. 	# Select Statments
14540. # File Actions 
14541. 	# Standard or OS File Actions.
14542. 	# Resume...
14543. 	
14544. 	# your stuff HERE (X)... post zone (file) file actions code.
14545. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
14546. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14547. 		# (X)
14548. 		
14549. 		/* ??? Set window? */
14550. 	
14551. 	# ADD THE GAP
14552. # Vacate (good for diagnostics)
14553. # DoNotVacate - DO NOT Vacate (recommended)
14554. # DoNotVacate - DO NOT Vacate (recommended)
14555. 
14556. # Vacate
14557. /* AddGap(GapUsedLoc) */
14558. 
14559. # DO Not Vacate
14560. AddGap(GapUsedLoc, DoNotVacate) 
14561. 	
14562. 	
14563. # Script: GapZoneCommand
14564. # *** Moved to setting yours ***
14565. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
14566. # Controlled via settings commands
14567. # DoNotVacate - DO NOT Vacate (recommended)
14568. 
14569. # Vacate
14570. /* AddGap(GapUsedLoc) */
14571. 
14572. # DO Not Vacate
14573. AddGap(GapUsedLoc, DoNotVacate) 
14574. 	
14575. 	
14576. # Vacate /* AddGap(GapUsed) */
14577. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
14578. 	
14579. 
14580. 		
14581. # 
14582. FileEnd
14583. /* ---------------------------------------------------------- */
14584. 
14585. # your stuff HERE (X)... post zone (file) code.
14586. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
14587. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14588. 	# (X)
14589. 
14590. SetVariable(FileStepDescription,"Zone finished, reporting.")
14591. # Script: DisplaySetFileStep
14592. 
14593. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14594. 
14595. /* add message and move to a new line. */
14596. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14597. ")
14598. 
14599. /* display the line. (hopefully.) */
14600. # Zone Footer Set Statistics Window Text
14601. 
14602. SetStatisticsWindowText("!Heading!
14603. ----------------------------------------------------------
14604. Zones Processed: 
14605. ----------------------------------------------------------
14606. !ZoneListByLine!
14607. ----------------------------------------------------------
14608. Zone Processing Step:
14609. !ZoneStepByLine!    
14610. ----------------------------------------------------------
14611. ----------------------------------------------------------
14612. Current Zone:
14613. !ZoneFooter!
14614. ----------------------------------------------------------
14615. ----------------------------------------------------------
14616. Volume Statistics:
14617. !VolumeStatisticsDetail!
14618. ----------------------------------------------------------
14619. ----------------------------------------------------------
14620. Zone Detailed Report:
14621. ----------------------------------------------------------
14622. !ZoneStatisticsDetail!
14623. ----------------------------------------------------------
14624. ")
14625. 
14626. 
14627. 
14628. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14629. 
14630. # Script: BannerSet
14631. 
14632. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
14633. 
14634. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
14635. 
14636. Title('!Heading!')
14637. /* pause(1) */
14638. 
14639. /* NOTE: Can't round or truncate to integer precision. */
14640. 
14641. pause(1)
14642. 
14643. # Script: ZoneWhenFinished
14644. 
14645. # Script: BannerSet
14646. 
14647. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
14648. 
14649. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
14650. 
14651. Title('!Heading!')
14652. /* pause(1) */
14653. 
14654. /* NOTE: Can't round or truncate to integer precision. */
14655. 
14656. # Script: BannerLog
14657. 
14658. AppendLogfile("!LogFileName!", "!Title!")
14659. 
14660. 
14661. 
14662. # Zone Statistics	
14663. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
14664. 
14665. # Footer:
14666. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
14667. # 2021-11-17 21:08:28
14668. 
14669. SetVariable(ZoneFooter1, "----------------------------------------------------------
14670. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
14671. #
14672. # Xinclude "..\Commands\DateTimeLastLong.txt"X
14673. #
14674. SetVariable(ZoneFooter2, "Statistics Report:
14675. ------------------
14676.    Size:  
14677.    ------------------------
14678.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14679.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14680.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14681. 
14682.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14683.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14684. 
14685.    Location:
14686.    ------------------------
14687.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14688.             Files End: !ZoneEndCurrent!
14689.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14690.       
14691.    Gap Settings:
14692.    ------------------------
14693.          Gap Requested: !ZoneGapSizePer!%
14694.        Volume Rounding: !ZoneVolRoundUpPer!%
14695.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14696.                  
14697.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
14698.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
14699.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
14700.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
14701.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
14702.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
14703.      
14704.    Free Space after Zone:
14705.    ------------------------
14706.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14707.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14708.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14709. 
14710. Directory and Files Select:
14711. ---------------------------
14712. !ZoneTypeSelectCurrent!               
14713. ---------------------------
14714. ----------------------------------------------------------
14715. ")
14716. 
14717. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
14718. 
14719. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
14720. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
14721. RunProgram("..\Commands\WriteDateTime.bat LastZone")
14722. 
14723. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
14724. 
14725. 
14726. 
14727. AppendLogfile("!LogFileName!", ".")
14728. AppendLogfile("!LogFileName!", "!ZoneFooter!")
14729. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
14730. AppendLogfile("!LogFileName!", ".")
14731. 
14732. # Zone Footer Set Statistics Window Text
14733. 
14734. SetStatisticsWindowText("!Heading!
14735. ----------------------------------------------------------
14736. Zones Processed: 
14737. ----------------------------------------------------------
14738. !ZoneListByLine!
14739. ----------------------------------------------------------
14740. Zone Processing Step:
14741. !ZoneStepByLine!    
14742. ----------------------------------------------------------
14743. ----------------------------------------------------------
14744. Current Zone:
14745. !ZoneFooter!
14746. ----------------------------------------------------------
14747. ----------------------------------------------------------
14748. Volume Statistics:
14749. !VolumeStatisticsDetail!
14750. ----------------------------------------------------------
14751. ----------------------------------------------------------
14752. Zone Detailed Report:
14753. ----------------------------------------------------------
14754. !ZoneStatisticsDetail!
14755. ----------------------------------------------------------
14756. ")
14757. 
14758. 
14759. 
14760. /* pause() */
14761. /* pause() */
14762. 
14763. 
14764. 
14765. 
14766. /* ---------------------------------------------------------- */
14767. 
14768. /* ---------------------------------------------------------- */
14769. /* Zone 10 LinksCorp Links and Corp */
14770. # Script: DisplayColors - Zone Dark
14771. # Processed
14772. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
14773. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
14774. 
14775. # Light Green and Yellow
14776. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
14777. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
14778. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
14779. 
14780. # Script: DefragZoneTypeLinksCorp
14781. /* ---------------------------------------------------------- */
14782. /* Zone LinksCorp Links and Corp */
14783. SetVariable(ZoneLabel, "!ZoneLabelLinksCorp!")
14784. SetVariable(ZoneDescription, "!ZoneDescriptionLinksCorp!")
14785. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpLinksCorp!")
14786. SetVariable(ZoneGapSize, "!ZoneGapSizeLinksCorp!")
14787. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectLinksCorp
14788. # LinksCorp start.
14789. # NotBlobsArchivesBu start.
14790. (not (
14791. # Blobs start.
14792. (
14793. # BlobsAndExceptions start.
14794. ( not(
14795.   FileName("*.bat")
14796.   or FileName("*.css")
14797.   or FileName("*.dll")
14798.   or FileName("*.exe")
14799.   or FileName("*.htm*")
14800.   or FileName("*.jar")
14801.   or FileName("*.js")
14802.   or FileName("*.script")
14803.   or FileName("*.wsf")
14804.   or (
14805. # Databases start.
14806. (
14807.   FileName("*.crypt*")
14808.   or FileName("*.db*")
14809.   or FileName("*.rdb*")
14810.   or FileName("*.dc*")
14811.   or FileName("*.dict*")
14812.   or FileName("*.?db*")
14813.   or FileName("*.?rdb*")
14814.   or FileName("*.md*")
14815.   or FileName("*.myd")
14816.   or FileName("*.ndf")
14817.   or FileName("*.ns?")
14818.   or FileName("*.pab")
14819.   or FileName("*.pst")
14820.   or FileName("*.sd?*")
14821.   or FileName("*.sq**")
14822.   or FileName("*.tmd")
14823.   or FileName("*.tps")
14824.   or FileName("*.tr*")
14825. )
14826. # Databases end.
14827. 
14828.     # BlobsAndExceptions
14829.     or 
14830. # Data start.
14831. (
14832.   DirectoryName("Data*")
14833.   or DirectoryName("Device*")
14834.   or DirectoryName("Export*")
14835.   or DirectoryName("Import*")
14836.   or DirectoryName("Log*")
14837.   or DirectoryName("*Log")
14838.   or DirectoryName("Maintenance*")
14839.   or DirectoryName("Rec*")
14840.   or DirectoryName("Sales*")
14841.   or DirectoryName("Search*")
14842.   or DirectoryName("User*")
14843. )
14844. # Data end.
14845. 
14846.     # BlobsAndExceptions
14847.   )
14848. ) )
14849. # BlobsAndExceptions end.
14850. 
14851. # Blobs
14852. ) and (
14853.   Size(BlobFileSize,0)
14854.   or (
14855.     FileName("*.arj")
14856.     or FileName("*.bup")
14857.     or FileName("*.bz2")
14858.     or FileName("*.chm")
14859.     or FileName("*.dvr-ms")
14860.     or FileName("*.gz")
14861.     or FileName("*.ifo")
14862.     or FileName("*.lzh")
14863.     or FileName("*.pdf")
14864.     or FileName("*.rpm")
14865.     or FileName("*.wmv")
14866.     or FileName("*.vob")
14867.     or FileName("*.z")
14868.   ) 
14869. )
14870. # Blobs end.
14871. 
14872. # NotBlobsArchivesBu
14873. or 
14874. # Archives start.
14875. (
14876.   DirectoryName("*Archive*")
14877.   or DirectoryName("*History*")
14878.   or DirectoryName("*Old")
14879.   or DirectoryName("* Old *")
14880.   or DirectoryName("Old *")
14881. 
14882.   or FileName("*.7z")
14883.   or FileName("*.cab")
14884.   or FileName("*.iso")
14885.   or FileName("*.msi")
14886.   or FileName("*.old")
14887.   or FileName("*.rar")
14888.   or FileName("*.tar")
14889.   or FileName("*.zip")
14890.   or
14891. # WinSysLow start.
14892. (
14893.   # Bad idea. This pushed lots of programs and data to archive.
14894.   # DirectoryName("$*")
14895.   # or DirectoryName("0*")
14896.   # or DirectoryName("1*")
14897.   # or DirectoryName("2*")
14898.   # or DirectoryName("3*")
14899.   # or DirectoryName("4*")
14900.   # or DirectoryName("5*")
14901.   # or DirectoryName("6*")
14902.   # or DirectoryName("7*")
14903.   # or DirectoryName("8*")
14904.   # or DirectoryName("9*")
14905.   # or 
14906.   DirectoryName("dllcache")
14907.   or DirectoryName("Downloaded Installations")
14908.   or DirectoryName("Ehome")
14909.   or DirectoryName("Fonts")
14910.   or DirectoryName("Help")
14911.   or DirectoryName("I386")
14912.   or DirectoryName("ie?updates")
14913.   or DirectoryName("Installer")
14914.   or DirectoryName("Installshield Installation Information")
14915.   or DirectoryName("IME")
14916.   or DirectoryName("*RECYCLE*")
14917.   or DirectoryName("ServicePackFiles")
14918.   or DirectoryName("SoftwareDistribution")
14919.   or DirectoryName("Speech")
14920.   or DirectoryName("Symbols")
14921.   or DirectoryName("System Volume Information")
14922.   or DirectoryName("windows.old")
14923. )
14924. # WinSysLow end.
14925. 
14926.   # Archives
14927. )
14928. # Archives end.
14929. 
14930. # NotBlobsArchivesBu
14931. or
14932. # Backups start.
14933. (
14934.   DirectoryName("*Backup*")
14935.   or DirectoryName("*Bu")
14936.   or DirectoryName("* Bu *")
14937.   or DirectoryName("Bu *")
14938. 
14939.   or FileName("*.bak")
14940.   or FileName("* - Copy*")
14941. )
14942. # Backups end.
14943. 
14944. # NotBlobsArchivesBu
14945. ) )
14946. # NotBlobsArchivesBu end.
14947. 
14948. # LinksCorp
14949. and ( 
14950. # Corp start.
14951. (
14952.     DirectoryName("*Corp*") or
14953.     DirectoryName("*Mdm*")
14954. )
14955. # Corp end.
14956. 
14957. # LinksCorp
14958. or 
14959. # Links start.
14960. (
14961.     DirectoryName("*Favorites*") or
14962.     DirectoryName("*Job*") or
14963.     DirectoryName("*Links*")
14964. )
14965. # Links end.
14966. 
14967. # LinksCorp
14968. or 
14969. # Support start.
14970. (
14971.   DirectoryName("*Logs*") or
14972.   DirectoryName("*Support*") or
14973.   DirectoryName("*Maintenance*")
14974. )
14975. # Support end.
14976. 
14977. # LinksCorp
14978. )
14979. # LinksCorp end.
14980. ')
14981. 
14982. 	# Script: ZoneDoHeader
14983. 
14984. # Script: ZoneWhenStarted
14985. RunProgram("..\Commands\WriteDateTime.bat")
14986. 
14987. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
14988. # Script: DisplaySetZone
14989. 
14990. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
14991. SetVariable(FileStepDescription,	"")
14992. 
14993. SetVariable(ZoneStepByLine, 			"Zone started.
14994. ")
14995. 
14996. # Script: BannerDescriptionSet
14997. 
14998. # Script: BannerSet
14999. 
15000. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
15001. 
15002. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
15003. 
15004. Title('!Heading!')
15005. /* pause(1) */
15006. 
15007. /* NOTE: Can't round or truncate to integer precision. */
15008. 
15009. # Script: BannerLog
15010. 
15011. AppendLogfile("!LogFileName!", "!Title!")
15012. 
15013. 
15014. 
15015. pause(1)
15016. 
15017. 
15018. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
15019. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
15020. 
15021. SetVariable(ZoneStepNoCurrent, 0)
15022. 
15023. 
15024. # Script: ZoneDoCurrentClear
15025. 
15026. SetVariable(ZoneTypeSelectCurrent, 		"")
15027. 
15028. SetVariable(ZoneBeginCurrent, 			0)
15029. SetVariable(ZoneBeginPerCurrent, 		0)
15030. SetVariable(ZoneEndCurrent, 			0)
15031. SetVariable(ZoneEndPerCurrent, 			0)
15032. 
15033. SetVariable(ZoneSizeCurrent,			0)
15034. SetVariable(ZoneSizePerCurrent,			0)
15035. 
15036. SetVariable(ZoneGapRequestedCurrent,	0)
15037. SetVariable(ZoneGapRoundedCurrent, 		0)
15038. SetVariable(ZoneGapAdjustedCurrent, 	0)
15039. SetVariable(ZoneGapAvailableCurrent, 	0)
15040. SetVariable(ZoneGapCurrent,				0)
15041. SetVariable(ZoneGapUsedCurrent, 		0)
15042. 
15043. SetVariable(ZoneGapActualCurrent, 		0)
15044. SetVariable(ZoneGapActualPerCurrent, 	0)
15045. 
15046. SetVariable(ZoneSizeActual, 			0)
15047. SetVariable(ZoneSizeActualCurrent,		0)
15048. 
15049. SetVariable(ZoneEndActual, 				0)
15050. SetVariable(ZoneEndActualCurrent,		0)			
15051. SetVariable(ZoneSizeActualPerCurrent, 	0)
15052.       
15053. SetVariable(ZoneFilesFolders,			0)
15054. SetVariable(ZoneFilesFoldersPer,		0) 
15055. 
15056. SetVariable(ZoneFragments,				0)
15057. SetVariable(ZoneFragmentsPer,			0) 
15058. 		
15059. SetVariable(ZoneEndActualCurrent, 		0)
15060. SetVariable(ZoneEndActualPerCurrent, 	0)
15061. 
15062. # Gap Calculation Methodology:
15063. 	# Requested
15064. 	SetVariable(GapRequested, 			0) 
15065. 	SetVariable(GapRequestedStd, 		0) 
15066. 	SetVariable(GapRequestedMft, 		0) 
15067. 	SetVariable(GapRequestedOs, 		0) 
15068. 	SetVariable(GapRequestedOriginal, 	0) 
15069. 	
15070. 	# Gap Adjustments
15071. 	SetVariable(GapRounded, 			0)
15072. 	# SetVariable(GapAdjusted, 			0)
15073. 	SetVariable(GapAvailable, 			0)
15074. 	SetVariable(GapCurrent, 			0)
15075. 	SetVariable(GapActual, 				0)
15076. 	SetVariable(GapUsed, 				0)
15077. 	
15078. 	# Gap Adjustments
15079. 	SetVariable(GapRoundedLoc, 			0)
15080. 	# SetVariable(GapAdjustedLoc, 		0)
15081. 	SetVariable(GapAvailableLoc, 		0)
15082. 	SetVariable(GapCurrentLoc, 			0)
15083. 	SetVariable(GapActualLoc,			0)
15084. 	SetVariable(GapUsedLoc,				0)
15085. 	
15086. 	# Space usage
15087. 	SetVariable(ZoneFreePerRequested, 	0)
15088. 	SetVariable(ZoneFreePerUsed, 		0)
15089. 
15090. # Gap Size & Rounding
15091. 	SetVariable(ZoneGapSizePer, 		0)
15092. 	SetVariable(ZoneVolRoundUpPer, 		0)
15093. 	
15094. 	# Free Space
15095. 	SetVariable(ZoneFreeUsedPer, 		0)
15096. 	SetVariable(ZoneFreeRequestedPer, 	0)
15097. 
15098. 
15099. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
15100. 
15101. # Footer:
15102. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
15103. # 2021-11-17 21:08:28
15104. 
15105. SetVariable(ZoneFooter1, "----------------------------------------------------------
15106. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
15107. #
15108. # Xinclude "..\Commands\DateTimeLastLong.txt"X
15109. #
15110. SetVariable(ZoneFooter2, "Statistics Report:
15111. ------------------
15112.    Size:  
15113.    ------------------------
15114.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15115.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15116.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15117. 
15118.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15119.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15120. 
15121.    Location:
15122.    ------------------------
15123.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15124.             Files End: !ZoneEndCurrent!
15125.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15126.       
15127.    Gap Settings:
15128.    ------------------------
15129.          Gap Requested: !ZoneGapSizePer!%
15130.        Volume Rounding: !ZoneVolRoundUpPer!%
15131.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15132.                  
15133.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
15134.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
15135.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
15136.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
15137.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
15138.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
15139.      
15140.    Free Space after Zone:
15141.    ------------------------
15142.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15143.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15144.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15145. 
15146. Directory and Files Select:
15147. ---------------------------
15148. !ZoneTypeSelectCurrent!               
15149. ---------------------------
15150. ----------------------------------------------------------
15151. ")
15152. 
15153. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
15154. 
15155. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
15156. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
15157. RunProgram("..\Commands\WriteDateTime.bat LastZone")
15158. 
15159. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
15160. 
15161. 
15162. 
15163. # Script: BannerSet
15164. 
15165. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
15166. 
15167. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
15168. 
15169. Title('!Heading!')
15170. /* pause(1) */
15171. 
15172. /* NOTE: Can't round or truncate to integer precision. */
15173. 
15174. # Script: BannerLog
15175. 
15176. AppendLogfile("!LogFileName!", "!Title!")
15177. 
15178. 
15179. 
15180. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
15181. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
15182. 
15183. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
15184. 
15185. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:28")
15186. 
15187. # 2021-11-17 21:08:28 
15188. SetVariable(Temp9, DATETIME)
15189. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:03 !ZoneLabel! !ZoneDescription!")
15190. 
15191. SetVariable(ZoneListByLine, "!ZoneListByLine! 
15192. Zone: !ZoneNoCurrent! !Temp9! 0:00:03 !ZoneLabel! !ZoneDescription!")
15193. 
15194. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:03 !ZoneLabel! !ZoneDescription!")
15195. 
15196. 
15197. /* Fixed Zone Position Handling */
15198. /* Literal number: */
15199. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
15200. /* Percentage of disk: */
15201. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
15202. /* Gap */
15203. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
15204. 
15205. /* ---------------------------------------------------------- */
15206. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
15207. # Script: DisplaySetFileStep
15208. 
15209. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15210. 
15211. /* add message and move to a new line. */
15212. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15213. ")
15214. 
15215. /* display the line. (hopefully.) */
15216. # Zone Footer Set Statistics Window Text
15217. 
15218. SetStatisticsWindowText("!Heading!
15219. ----------------------------------------------------------
15220. Zones Processed: 
15221. ----------------------------------------------------------
15222. !ZoneListByLine!
15223. ----------------------------------------------------------
15224. Zone Processing Step:
15225. !ZoneStepByLine!    
15226. ----------------------------------------------------------
15227. ----------------------------------------------------------
15228. Current Zone:
15229. !ZoneFooter!
15230. ----------------------------------------------------------
15231. ----------------------------------------------------------
15232. Volume Statistics:
15233. !VolumeStatisticsDetail!
15234. ----------------------------------------------------------
15235. ----------------------------------------------------------
15236. Zone Detailed Report:
15237. ----------------------------------------------------------
15238. !ZoneStatisticsDetail!
15239. ----------------------------------------------------------
15240. ")
15241. 
15242. 
15243. 
15244. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15245. 
15246. # Script: BannerSet
15247. 
15248. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
15249. 
15250. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
15251. 
15252. Title('!Heading!')
15253. /* pause(1) */
15254. 
15255. /* NOTE: Can't round or truncate to integer precision. */
15256. 
15257. pause(1)
15258. 
15259. # your stuff HERE (X)... pre file select code.
15260. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
15261. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15262. 	# (X)
15263. 
15264. FileSelect
15265. 
15266. 	# your stuff can't really go here (errors.)
15267. 	# maybe for some reason I don't know of...
15268. 	
15269. 	# Actions next...
15270. 	# Script: ZoneDo ZoneTypeSelectLinksCorp
15271. # LinksCorp start.
15272. # NotBlobsArchivesBu start.
15273. (not (
15274. # Blobs start.
15275. (
15276. # BlobsAndExceptions start.
15277. ( not(
15278.   FileName("*.bat")
15279.   or FileName("*.css")
15280.   or FileName("*.dll")
15281.   or FileName("*.exe")
15282.   or FileName("*.htm*")
15283.   or FileName("*.jar")
15284.   or FileName("*.js")
15285.   or FileName("*.script")
15286.   or FileName("*.wsf")
15287.   or (
15288. # Databases start.
15289. (
15290.   FileName("*.crypt*")
15291.   or FileName("*.db*")
15292.   or FileName("*.rdb*")
15293.   or FileName("*.dc*")
15294.   or FileName("*.dict*")
15295.   or FileName("*.?db*")
15296.   or FileName("*.?rdb*")
15297.   or FileName("*.md*")
15298.   or FileName("*.myd")
15299.   or FileName("*.ndf")
15300.   or FileName("*.ns?")
15301.   or FileName("*.pab")
15302.   or FileName("*.pst")
15303.   or FileName("*.sd?*")
15304.   or FileName("*.sq**")
15305.   or FileName("*.tmd")
15306.   or FileName("*.tps")
15307.   or FileName("*.tr*")
15308. )
15309. # Databases end.
15310. 
15311.     # BlobsAndExceptions
15312.     or 
15313. # Data start.
15314. (
15315.   DirectoryName("Data*")
15316.   or DirectoryName("Device*")
15317.   or DirectoryName("Export*")
15318.   or DirectoryName("Import*")
15319.   or DirectoryName("Log*")
15320.   or DirectoryName("*Log")
15321.   or DirectoryName("Maintenance*")
15322.   or DirectoryName("Rec*")
15323.   or DirectoryName("Sales*")
15324.   or DirectoryName("Search*")
15325.   or DirectoryName("User*")
15326. )
15327. # Data end.
15328. 
15329.     # BlobsAndExceptions
15330.   )
15331. ) )
15332. # BlobsAndExceptions end.
15333. 
15334. # Blobs
15335. ) and (
15336.   Size(BlobFileSize,0)
15337.   or (
15338.     FileName("*.arj")
15339.     or FileName("*.bup")
15340.     or FileName("*.bz2")
15341.     or FileName("*.chm")
15342.     or FileName("*.dvr-ms")
15343.     or FileName("*.gz")
15344.     or FileName("*.ifo")
15345.     or FileName("*.lzh")
15346.     or FileName("*.pdf")
15347.     or FileName("*.rpm")
15348.     or FileName("*.wmv")
15349.     or FileName("*.vob")
15350.     or FileName("*.z")
15351.   ) 
15352. )
15353. # Blobs end.
15354. 
15355. # NotBlobsArchivesBu
15356. or 
15357. # Archives start.
15358. (
15359.   DirectoryName("*Archive*")
15360.   or DirectoryName("*History*")
15361.   or DirectoryName("*Old")
15362.   or DirectoryName("* Old *")
15363.   or DirectoryName("Old *")
15364. 
15365.   or FileName("*.7z")
15366.   or FileName("*.cab")
15367.   or FileName("*.iso")
15368.   or FileName("*.msi")
15369.   or FileName("*.old")
15370.   or FileName("*.rar")
15371.   or FileName("*.tar")
15372.   or FileName("*.zip")
15373.   or
15374. # WinSysLow start.
15375. (
15376.   # Bad idea. This pushed lots of programs and data to archive.
15377.   # DirectoryName("$*")
15378.   # or DirectoryName("0*")
15379.   # or DirectoryName("1*")
15380.   # or DirectoryName("2*")
15381.   # or DirectoryName("3*")
15382.   # or DirectoryName("4*")
15383.   # or DirectoryName("5*")
15384.   # or DirectoryName("6*")
15385.   # or DirectoryName("7*")
15386.   # or DirectoryName("8*")
15387.   # or DirectoryName("9*")
15388.   # or 
15389.   DirectoryName("dllcache")
15390.   or DirectoryName("Downloaded Installations")
15391.   or DirectoryName("Ehome")
15392.   or DirectoryName("Fonts")
15393.   or DirectoryName("Help")
15394.   or DirectoryName("I386")
15395.   or DirectoryName("ie?updates")
15396.   or DirectoryName("Installer")
15397.   or DirectoryName("Installshield Installation Information")
15398.   or DirectoryName("IME")
15399.   or DirectoryName("*RECYCLE*")
15400.   or DirectoryName("ServicePackFiles")
15401.   or DirectoryName("SoftwareDistribution")
15402.   or DirectoryName("Speech")
15403.   or DirectoryName("Symbols")
15404.   or DirectoryName("System Volume Information")
15405.   or DirectoryName("windows.old")
15406. )
15407. # WinSysLow end.
15408. 
15409.   # Archives
15410. )
15411. # Archives end.
15412. 
15413. # NotBlobsArchivesBu
15414. or
15415. # Backups start.
15416. (
15417.   DirectoryName("*Backup*")
15418.   or DirectoryName("*Bu")
15419.   or DirectoryName("* Bu *")
15420.   or DirectoryName("Bu *")
15421. 
15422.   or FileName("*.bak")
15423.   or FileName("* - Copy*")
15424. )
15425. # Backups end.
15426. 
15427. # NotBlobsArchivesBu
15428. ) )
15429. # NotBlobsArchivesBu end.
15430. 
15431. # LinksCorp
15432. and ( 
15433. # Corp start.
15434. (
15435.     DirectoryName("*Corp*") or
15436.     DirectoryName("*Mdm*")
15437. )
15438. # Corp end.
15439. 
15440. # LinksCorp
15441. or 
15442. # Links start.
15443. (
15444.     DirectoryName("*Favorites*") or
15445.     DirectoryName("*Job*") or
15446.     DirectoryName("*Links*")
15447. )
15448. # Links end.
15449. 
15450. # LinksCorp
15451. or 
15452. # Support start.
15453. (
15454.   DirectoryName("*Logs*") or
15455.   DirectoryName("*Support*") or
15456.   DirectoryName("*Maintenance*")
15457. )
15458. # Support end.
15459. 
15460. # LinksCorp
15461. )
15462. # LinksCorp end.
15463. 
15464. 	# Script: ZoneDoAction
15465. # Zone Do File Action - SortByName.
15466. 
15467. FileActions
15468. 
15469. 		/* ---------------------------------------------------------- */
15470. 	# Gap
15471. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
15472. 		# Script: DisplaySetFileStep
15473. 
15474. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15475. 
15476. /* add message and move to a new line. */
15477. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15478. ")
15479. 
15480. /* display the line. (hopefully.) */
15481. # Zone Footer Set Statistics Window Text
15482. 
15483. SetStatisticsWindowText("!Heading!
15484. ----------------------------------------------------------
15485. Zones Processed: 
15486. ----------------------------------------------------------
15487. !ZoneListByLine!
15488. ----------------------------------------------------------
15489. Zone Processing Step:
15490. !ZoneStepByLine!    
15491. ----------------------------------------------------------
15492. ----------------------------------------------------------
15493. Current Zone:
15494. !ZoneFooter!
15495. ----------------------------------------------------------
15496. ----------------------------------------------------------
15497. Volume Statistics:
15498. !VolumeStatisticsDetail!
15499. ----------------------------------------------------------
15500. ----------------------------------------------------------
15501. Zone Detailed Report:
15502. ----------------------------------------------------------
15503. !ZoneStatisticsDetail!
15504. ----------------------------------------------------------
15505. ")
15506. 
15507. 
15508. 
15509. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15510. 
15511. # Script: BannerSet
15512. 
15513. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
15514. 
15515. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
15516. 
15517. Title('!Heading!')
15518. /* pause(1) */
15519. 
15520. /* NOTE: Can't round or truncate to integer precision. */
15521. 
15522. pause(1)
15523. 	
15524. 	# ACTUAL GAP
15525. 		/* AddGap Variant. */
15526. 	  	# Zone Do Gap
15527. # Gap Calculation Methods:
15528. 
15529. /* 1) Anything you need to add first. */
15530. /* empty */
15531. 
15532. /* ---------------------------------------------------------- */
15533. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
15534. 	# GapRequestedStd.
15535. 
15536. 		/* ---------------------------------------------------------- */
15537. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
15538. 
15539. 		# Gap Calculation Methods:
15540. 
15541. /* AddGap Variants */
15542. 
15543. 	/* Standard */
15544. 		# Gap Calculation Methods:
15545. 	/* AddGap Variants */
15546. 	/* Standard */
15547. 
15548. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
15549. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
15550. 
15551. 	SetVariable(GapRequested, GapRequestedStd)
15552. 	
15553. 
15554. 	/* MFT Low High Method */
15555. 		# Gap Calculation Methods:
15556. 	/* AddGap Variants */
15557. 	/* MFT Low High Method */
15558. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
15559. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
15560. 	SetVariable(GapRequested, GapRequestedMft)
15561. 	
15562. 
15563. 	/* OS Volume Type Method */
15564. 		# Gap Calculation Methods:
15565. 	/* AddGap Variants */
15566. 	/* OS Volume Type Method */
15567. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
15568. 	SetVariable(GapRequested, GapRequestedOs)
15569. 
15570. 
15571. 
15572. /* MakeGap Variants */
15573. 
15574. 	/* Original Os 1-3 + MFT 2 */
15575. 		# Gap Calculation Methods:
15576. 	/* MakeGap Variants */
15577. 	/* Original Os 1-3 + MFT 2 */
15578. 	/* plus MFT gap placed inline at the dividing zone. */
15579. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
15580. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
15581. 	SetVariable(GapRequested, GapRequestedOrig)
15582. 	
15583. 	
15584. /* Note: You could comment out the ones not in use */
15585. /* However having the data in the log is useful. */
15586. /* Therefore the following line is otherwise needed. */
15587. 
15588. /* Standard used */
15589. 
15590. SetVariable(GapRequested, GapRequestedStd)
15591. 
15592. # Gap Calculation Methods:
15593. 
15594. /* AddGap Variants */
15595. 	/* Standard */
15596. 	/* MFT Low High Method */
15597. 	/* OS Volume Type Method */
15598. 
15599. /* MakeGap Variants */
15600. 	/* Original Os 1-3 + MFT 2 */
15601. 
15602. /* Note: You could comment out the ones not in use */
15603. /* However having the data in the log is useful. */
15604. /* Therefore the following line is otherwise needed. */
15605. 
15606. /* Standard is used currently */
15607. 
15608. 
15609. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
15610. 
15611. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
15612. 
15613. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
15614. 
15615. /* ---------------------------------------------------------- */
15616. /* 3) SMALL ZONE ADJUSTMENT. */
15617. /* Gab cant be larger than half the Zone Size. */
15618. 
15619. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
15620. 	
15621. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
15622. 
15623. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
15624. 
15625. /* ---------------------------------------------------------- */
15626. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
15627. # Gap Adjustments.
15628. 
15629. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
15630. 	
15631. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
15632. 
15633. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
15634. 
15635. /* ---------------------------------------------------------- */
15636. # BYPASS THIS.
15637. 	/* This is definitely wrong. */
15638. 	/* The question is can we steal gap from the next zone */
15639. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
15640. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
15641. 		# Zone Overflow.
15642. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
15643. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
15644. 
15645. /* ---------------------------------------------------------- */
15646. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
15647. # Remaining free space available.
15648. 
15649. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
15650. 	
15651. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
15652. 
15653. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
15654. 
15655. /* ---------------------------------------------------------- */
15656. # CURRENT gap to use.
15657. 
15658. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
15659. 
15660. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
15661. 
15662. /* ---------------------------------------------------------- */
15663. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
15664. # Debugging.
15665. 
15666. 	SetVariable(GapUsed, GapCurrent) // for debugging
15667. 
15668. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
15669. 
15670. 		# Your code HERE
15671. 
15672. /* ---------------------------------------------------------- */
15673. /* 7) YOUR CODE. */
15674. # YOUR CODE HERE:
15675. 	# INPUT: GapCurrent or GapCurrentLoc
15676. 	# OUTPUT: GapUsed...
15677. 
15678. /* ---------------------------------------------------------- */
15679. # Gap Size.
15680. # Actual Size of Gap.
15681. 
15682. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
15683. 
15684. /* ---------------------------------------------------------- */
15685. /* xxxxxxxxxxxxxxxxxxxxxx */
15686. # ADD THE GAP
15687. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
15688. /* xxxxxxxxxxxxxxxxxxxxxx */
15689. 
15690. 	
15691. 	# Zone Statistics	
15692. 	# Script: ZoneDoStatistics
15693. # Zone / Volume Statistics and Display
15694. 		
15695. 	# Accumulate Totals
15696.   	# Script: ZoneDoVolumeTotals
15697. 
15698. /* Current total space used (by Zones and Gaps) */
15699. 
15700. SetVariable(VolumeZoneUsed, GapUsed)
15701. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
15702. /* Percentage */
15703. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
15704. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
15705. 
15706. /* Current total of free space requested */
15707. 
15708. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
15709. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
15710. /* Percent. */
15711. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
15712. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
15713. 
15714. /* Current total of free space used */
15715. 
15716. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
15717. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
15718. /* Percent */
15719. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
15720. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
15721. 
15722. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
15723. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
15724. /* Xinclude "..\DebugDisplayPause.MyDc"X */
15725. 
15726. 
15727. 	# Current Values
15728. 	# Script: ZoneDoCurrentSet
15729. 
15730. # Cluster, Sector, Block adjust for display.
15731. 	# Bytes per cluster is volume specific.
15732. 
15733. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
15734. 
15735. # Current Zone values.
15736. 	# Begin, end and size.
15737. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
15738. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
15739. 
15740. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
15741. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
15742. 
15743. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
15744. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
15745. 
15746. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
15747. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
15748. 
15749. 	SetVariable(ZoneFragments,				"!ZONE210N!")
15750. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
15751. 		
15752. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
15753. /* identical code to here: (separation not needed. TEST.) */	
15754. 
15755. # Current Gap, Actual and Free Values
15756. 	# Gap
15757. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
15758. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
15759. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
15760. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
15761. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
15762. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
15763. 	
15764. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
15765. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
15766. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
15767. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
15768. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
15769. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
15770. 	
15771. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
15772. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
15773. 	
15774. 	# Actual Size and End
15775. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
15776. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
15777. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
15778. 	
15779. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
15780. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
15781. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
15782. 
15783. # Gap Size & Rounding
15784. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
15785. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
15786. 	
15787. 	# Free Space
15788. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
15789. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
15790. 
15791. 	# Footer:
15792. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
15793. # 2021-11-17 21:08:28
15794. 
15795. SetVariable(ZoneFooter1, "----------------------------------------------------------
15796. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
15797. #
15798. # Xinclude "..\Commands\DateTimeLastLong.txt"X
15799. #
15800. SetVariable(ZoneFooter2, "Statistics Report:
15801. ------------------
15802.    Size:  
15803.    ------------------------
15804.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15805.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15806.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15807. 
15808.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15809.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15810. 
15811.    Location:
15812.    ------------------------
15813.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15814.             Files End: !ZoneEndCurrent!
15815.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15816.       
15817.    Gap Settings:
15818.    ------------------------
15819.          Gap Requested: !ZoneGapSizePer!%
15820.        Volume Rounding: !ZoneVolRoundUpPer!%
15821.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15822.                  
15823.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
15824.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
15825.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
15826.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
15827.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
15828.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
15829.      
15830.    Free Space after Zone:
15831.    ------------------------
15832.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15833.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15834.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15835. 
15836. Directory and Files Select:
15837. ---------------------------
15838. !ZoneTypeSelectCurrent!               
15839. ---------------------------
15840. ----------------------------------------------------------
15841. ")
15842. 
15843. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
15844. 
15845. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
15846. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
15847. RunProgram("..\Commands\WriteDateTime.bat LastZone")
15848. 
15849. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
15850. 
15851. 
15852. 	# Zone Footer Set Statistics Window Text
15853. 
15854. SetStatisticsWindowText("!Heading!
15855. ----------------------------------------------------------
15856. Zones Processed: 
15857. ----------------------------------------------------------
15858. !ZoneListByLine!
15859. ----------------------------------------------------------
15860. Zone Processing Step:
15861. !ZoneStepByLine!    
15862. ----------------------------------------------------------
15863. ----------------------------------------------------------
15864. Current Zone:
15865. !ZoneFooter!
15866. ----------------------------------------------------------
15867. ----------------------------------------------------------
15868. Volume Statistics:
15869. !VolumeStatisticsDetail!
15870. ----------------------------------------------------------
15871. ----------------------------------------------------------
15872. Zone Detailed Report:
15873. ----------------------------------------------------------
15874. !ZoneStatisticsDetail!
15875. ----------------------------------------------------------
15876. ")
15877. 
15878. 
15879. 	
15880.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
15881. 
15882. 	# Add Zone to list of zones for display.
15883. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
15884. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
15885. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
15886. 	# ??? Free Stats?
15887. 	# Footer:
15888. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
15889. # 2021-11-17 21:08:28
15890. 
15891. SetVariable(ZoneFooter1, "----------------------------------------------------------
15892. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
15893. #
15894. # Xinclude "..\Commands\DateTimeLastLong.txt"X
15895. #
15896. SetVariable(ZoneFooter2, "Statistics Report:
15897. ------------------
15898.    Size:  
15899.    ------------------------
15900.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15901.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15902.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15903. 
15904.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15905.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15906. 
15907.    Location:
15908.    ------------------------
15909.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15910.             Files End: !ZoneEndCurrent!
15911.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15912.       
15913.    Gap Settings:
15914.    ------------------------
15915.          Gap Requested: !ZoneGapSizePer!%
15916.        Volume Rounding: !ZoneVolRoundUpPer!%
15917.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15918.                  
15919.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
15920.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
15921.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
15922.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
15923.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
15924.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
15925.      
15926.    Free Space after Zone:
15927.    ------------------------
15928.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15929.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15930.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15931. 
15932. Directory and Files Select:
15933. ---------------------------
15934. !ZoneTypeSelectCurrent!               
15935. ---------------------------
15936. ----------------------------------------------------------
15937. ")
15938. 
15939. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
15940. 
15941. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
15942. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
15943. RunProgram("..\Commands\WriteDateTime.bat LastZone")
15944. 
15945. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
15946. 
15947. 
15948. 
15949. 	# Add Zone Details to Report.	
15950. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
15951. !ZoneFooter!")
15952. 
15953. 
15954. 	
15955. 	# Footer:
15956. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
15957. # 2021-11-17 21:08:28
15958. 
15959. SetVariable(ZoneFooter1, "----------------------------------------------------------
15960. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
15961. #
15962. # Xinclude "..\Commands\DateTimeLastLong.txt"X
15963. #
15964. SetVariable(ZoneFooter2, "Statistics Report:
15965. ------------------
15966.    Size:  
15967.    ------------------------
15968.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15969.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15970.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15971. 
15972.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15973.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15974. 
15975.    Location:
15976.    ------------------------
15977.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15978.             Files End: !ZoneEndCurrent!
15979.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15980.       
15981.    Gap Settings:
15982.    ------------------------
15983.          Gap Requested: !ZoneGapSizePer!%
15984.        Volume Rounding: !ZoneVolRoundUpPer!%
15985.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15986.                  
15987.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
15988.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
15989.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
15990.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
15991.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
15992.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
15993.      
15994.    Free Space after Zone:
15995.    ------------------------
15996.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15997.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15998.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15999. 
16000. Directory and Files Select:
16001. ---------------------------
16002. !ZoneTypeSelectCurrent!               
16003. ---------------------------
16004. ----------------------------------------------------------
16005. ")
16006. 
16007. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
16008. 
16009. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
16010. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
16011. RunProgram("..\Commands\WriteDateTime.bat LastZone")
16012. 
16013. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
16014. 
16015. 
16016. 	SetStatisticsWindowText("!ZoneFooter!")
16017. 	
16018. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
16019. 	# Script: DisplaySetFileStep
16020. 
16021. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16022. 
16023. /* add message and move to a new line. */
16024. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16025. ")
16026. 
16027. /* display the line. (hopefully.) */
16028. # Zone Footer Set Statistics Window Text
16029. 
16030. SetStatisticsWindowText("!Heading!
16031. ----------------------------------------------------------
16032. Zones Processed: 
16033. ----------------------------------------------------------
16034. !ZoneListByLine!
16035. ----------------------------------------------------------
16036. Zone Processing Step:
16037. !ZoneStepByLine!    
16038. ----------------------------------------------------------
16039. ----------------------------------------------------------
16040. Current Zone:
16041. !ZoneFooter!
16042. ----------------------------------------------------------
16043. ----------------------------------------------------------
16044. Volume Statistics:
16045. !VolumeStatisticsDetail!
16046. ----------------------------------------------------------
16047. ----------------------------------------------------------
16048. Zone Detailed Report:
16049. ----------------------------------------------------------
16050. !ZoneStatisticsDetail!
16051. ----------------------------------------------------------
16052. ")
16053. 
16054. 
16055. 
16056. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16057. 
16058. # Script: BannerSet
16059. 
16060. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16061. 
16062. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
16063. 
16064. Title('!Heading!')
16065. /* pause(1) */
16066. 
16067. /* NOTE: Can't round or truncate to integer precision. */
16068. 
16069. pause(1)
16070. 
16071. # Commands:
16072. 
16073. /* Moves to Zone or above it. */
16074. # MoveUpToZone()
16075. 
16076. # Defrag
16077. 
16078. # Defragment(OPTIONS)
16079. 
16080. /* Shuffles files around trying to make a big enough gap for fragmented files. */
16081. # Defragment()
16082. 
16083. /* Only does files where a gap will fit it. */
16084. # Defragment(Fast)
16085. 
16086. /* Skips fragmented files larger than the Chunck Size. */
16087. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
16088. # Defragment(Chunk Size)
16089. 
16090. /* Moves down to zone and packs zone to beginning if there are gaps. */
16091. /* Can be similar in performance to doing a SortBy. */
16092. # MoveDownFill()
16093. 
16094. # File Action - All - Regular -  SortByName.
16095. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
16096. 	
16097. 
16098. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
16099. 	# Script: DisplaySetFileStep
16100. 
16101. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16102. 
16103. /* add message and move to a new line. */
16104. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16105. ")
16106. 
16107. /* display the line. (hopefully.) */
16108. # Zone Footer Set Statistics Window Text
16109. 
16110. SetStatisticsWindowText("!Heading!
16111. ----------------------------------------------------------
16112. Zones Processed: 
16113. ----------------------------------------------------------
16114. !ZoneListByLine!
16115. ----------------------------------------------------------
16116. Zone Processing Step:
16117. !ZoneStepByLine!    
16118. ----------------------------------------------------------
16119. ----------------------------------------------------------
16120. Current Zone:
16121. !ZoneFooter!
16122. ----------------------------------------------------------
16123. ----------------------------------------------------------
16124. Volume Statistics:
16125. !VolumeStatisticsDetail!
16126. ----------------------------------------------------------
16127. ----------------------------------------------------------
16128. Zone Detailed Report:
16129. ----------------------------------------------------------
16130. !ZoneStatisticsDetail!
16131. ----------------------------------------------------------
16132. ")
16133. 
16134. 
16135. 
16136. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16137. 
16138. # Script: BannerSet
16139. 
16140. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16141. 
16142. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
16143. 
16144. Title('!Heading!')
16145. /* pause(1) */
16146. 
16147. /* NOTE: Can't round or truncate to integer precision. */
16148. 
16149. pause(1)
16150. 
16151. 	# Script: ZoneDoFooter
16152. 
16153. /* ---------------------------------------------------------- */
16154. # File Select
16155. 	# Select Statments
16156. # File Actions 
16157. 	# Standard or OS File Actions.
16158. 	# Resume...
16159. 	
16160. 	# your stuff HERE (X)... post zone (file) file actions code.
16161. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
16162. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16163. 		# (X)
16164. 		
16165. 		/* ??? Set window? */
16166. 	
16167. 	# ADD THE GAP
16168. # Vacate (good for diagnostics)
16169. # DoNotVacate - DO NOT Vacate (recommended)
16170. # DoNotVacate - DO NOT Vacate (recommended)
16171. 
16172. # Vacate
16173. /* AddGap(GapUsedLoc) */
16174. 
16175. # DO Not Vacate
16176. AddGap(GapUsedLoc, DoNotVacate) 
16177. 	
16178. 	
16179. # Script: GapZoneCommand
16180. # *** Moved to setting yours ***
16181. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
16182. # Controlled via settings commands
16183. # DoNotVacate - DO NOT Vacate (recommended)
16184. 
16185. # Vacate
16186. /* AddGap(GapUsedLoc) */
16187. 
16188. # DO Not Vacate
16189. AddGap(GapUsedLoc, DoNotVacate) 
16190. 	
16191. 	
16192. # Vacate /* AddGap(GapUsed) */
16193. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
16194. 	
16195. 
16196. 		
16197. # 
16198. FileEnd
16199. /* ---------------------------------------------------------- */
16200. 
16201. # your stuff HERE (X)... post zone (file) code.
16202. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
16203. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16204. 	# (X)
16205. 
16206. SetVariable(FileStepDescription,"Zone finished, reporting.")
16207. # Script: DisplaySetFileStep
16208. 
16209. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16210. 
16211. /* add message and move to a new line. */
16212. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16213. ")
16214. 
16215. /* display the line. (hopefully.) */
16216. # Zone Footer Set Statistics Window Text
16217. 
16218. SetStatisticsWindowText("!Heading!
16219. ----------------------------------------------------------
16220. Zones Processed: 
16221. ----------------------------------------------------------
16222. !ZoneListByLine!
16223. ----------------------------------------------------------
16224. Zone Processing Step:
16225. !ZoneStepByLine!    
16226. ----------------------------------------------------------
16227. ----------------------------------------------------------
16228. Current Zone:
16229. !ZoneFooter!
16230. ----------------------------------------------------------
16231. ----------------------------------------------------------
16232. Volume Statistics:
16233. !VolumeStatisticsDetail!
16234. ----------------------------------------------------------
16235. ----------------------------------------------------------
16236. Zone Detailed Report:
16237. ----------------------------------------------------------
16238. !ZoneStatisticsDetail!
16239. ----------------------------------------------------------
16240. ")
16241. 
16242. 
16243. 
16244. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16245. 
16246. # Script: BannerSet
16247. 
16248. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16249. 
16250. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
16251. 
16252. Title('!Heading!')
16253. /* pause(1) */
16254. 
16255. /* NOTE: Can't round or truncate to integer precision. */
16256. 
16257. pause(1)
16258. 
16259. # Script: ZoneWhenFinished
16260. 
16261. # Script: BannerSet
16262. 
16263. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16264. 
16265. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
16266. 
16267. Title('!Heading!')
16268. /* pause(1) */
16269. 
16270. /* NOTE: Can't round or truncate to integer precision. */
16271. 
16272. # Script: BannerLog
16273. 
16274. AppendLogfile("!LogFileName!", "!Title!")
16275. 
16276. 
16277. 
16278. # Zone Statistics	
16279. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
16280. 
16281. # Footer:
16282. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
16283. # 2021-11-17 21:08:28
16284. 
16285. SetVariable(ZoneFooter1, "----------------------------------------------------------
16286. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
16287. #
16288. # Xinclude "..\Commands\DateTimeLastLong.txt"X
16289. #
16290. SetVariable(ZoneFooter2, "Statistics Report:
16291. ------------------
16292.    Size:  
16293.    ------------------------
16294.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16295.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16296.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16297. 
16298.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16299.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16300. 
16301.    Location:
16302.    ------------------------
16303.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16304.             Files End: !ZoneEndCurrent!
16305.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16306.       
16307.    Gap Settings:
16308.    ------------------------
16309.          Gap Requested: !ZoneGapSizePer!%
16310.        Volume Rounding: !ZoneVolRoundUpPer!%
16311.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16312.                  
16313.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
16314.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
16315.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
16316.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
16317.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
16318.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
16319.      
16320.    Free Space after Zone:
16321.    ------------------------
16322.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16323.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16324.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16325. 
16326. Directory and Files Select:
16327. ---------------------------
16328. !ZoneTypeSelectCurrent!               
16329. ---------------------------
16330. ----------------------------------------------------------
16331. ")
16332. 
16333. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
16334. 
16335. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
16336. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
16337. RunProgram("..\Commands\WriteDateTime.bat LastZone")
16338. 
16339. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
16340. 
16341. 
16342. 
16343. AppendLogfile("!LogFileName!", ".")
16344. AppendLogfile("!LogFileName!", "!ZoneFooter!")
16345. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
16346. AppendLogfile("!LogFileName!", ".")
16347. 
16348. # Zone Footer Set Statistics Window Text
16349. 
16350. SetStatisticsWindowText("!Heading!
16351. ----------------------------------------------------------
16352. Zones Processed: 
16353. ----------------------------------------------------------
16354. !ZoneListByLine!
16355. ----------------------------------------------------------
16356. Zone Processing Step:
16357. !ZoneStepByLine!    
16358. ----------------------------------------------------------
16359. ----------------------------------------------------------
16360. Current Zone:
16361. !ZoneFooter!
16362. ----------------------------------------------------------
16363. ----------------------------------------------------------
16364. Volume Statistics:
16365. !VolumeStatisticsDetail!
16366. ----------------------------------------------------------
16367. ----------------------------------------------------------
16368. Zone Detailed Report:
16369. ----------------------------------------------------------
16370. !ZoneStatisticsDetail!
16371. ----------------------------------------------------------
16372. ")
16373. 
16374. 
16375. 
16376. /* pause() */
16377. /* pause() */
16378. 
16379. 
16380. 
16381. 
16382. /* ---------------------------------------------------------- */
16383. 
16384. 
16385. /* ---------------------------------------------------------- */
16386. /* Zone 11 People */
16387. # Script: DisplayColors - Zone Dark
16388. # Processed
16389. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
16390. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
16391. 
16392. # Light Green and Yellow
16393. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
16394. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
16395. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
16396. 
16397. # Script: DefragZoneTypePeople
16398. /* ---------------------------------------------------------- */
16399. /* Zone People */
16400. SetVariable(ZoneLabel, "!ZoneLabelPeople!")
16401. SetVariable(ZoneDescription, "!ZoneDescriptionPeople!")
16402. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpPeople!")
16403. SetVariable(ZoneGapSize, "!ZoneGapSizePeople!")
16404. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectPeople
16405. # People start.
16406. # NotBlobsArchivesBu start.
16407. (not (
16408. # Blobs start.
16409. (
16410. # BlobsAndExceptions start.
16411. ( not(
16412.   FileName("*.bat")
16413.   or FileName("*.css")
16414.   or FileName("*.dll")
16415.   or FileName("*.exe")
16416.   or FileName("*.htm*")
16417.   or FileName("*.jar")
16418.   or FileName("*.js")
16419.   or FileName("*.script")
16420.   or FileName("*.wsf")
16421.   or (
16422. # Databases start.
16423. (
16424.   FileName("*.crypt*")
16425.   or FileName("*.db*")
16426.   or FileName("*.rdb*")
16427.   or FileName("*.dc*")
16428.   or FileName("*.dict*")
16429.   or FileName("*.?db*")
16430.   or FileName("*.?rdb*")
16431.   or FileName("*.md*")
16432.   or FileName("*.myd")
16433.   or FileName("*.ndf")
16434.   or FileName("*.ns?")
16435.   or FileName("*.pab")
16436.   or FileName("*.pst")
16437.   or FileName("*.sd?*")
16438.   or FileName("*.sq**")
16439.   or FileName("*.tmd")
16440.   or FileName("*.tps")
16441.   or FileName("*.tr*")
16442. )
16443. # Databases end.
16444. 
16445.     # BlobsAndExceptions
16446.     or 
16447. # Data start.
16448. (
16449.   DirectoryName("Data*")
16450.   or DirectoryName("Device*")
16451.   or DirectoryName("Export*")
16452.   or DirectoryName("Import*")
16453.   or DirectoryName("Log*")
16454.   or DirectoryName("*Log")
16455.   or DirectoryName("Maintenance*")
16456.   or DirectoryName("Rec*")
16457.   or DirectoryName("Sales*")
16458.   or DirectoryName("Search*")
16459.   or DirectoryName("User*")
16460. )
16461. # Data end.
16462. 
16463.     # BlobsAndExceptions
16464.   )
16465. ) )
16466. # BlobsAndExceptions end.
16467. 
16468. # Blobs
16469. ) and (
16470.   Size(BlobFileSize,0)
16471.   or (
16472.     FileName("*.arj")
16473.     or FileName("*.bup")
16474.     or FileName("*.bz2")
16475.     or FileName("*.chm")
16476.     or FileName("*.dvr-ms")
16477.     or FileName("*.gz")
16478.     or FileName("*.ifo")
16479.     or FileName("*.lzh")
16480.     or FileName("*.pdf")
16481.     or FileName("*.rpm")
16482.     or FileName("*.wmv")
16483.     or FileName("*.vob")
16484.     or FileName("*.z")
16485.   ) 
16486. )
16487. # Blobs end.
16488. 
16489. # NotBlobsArchivesBu
16490. or 
16491. # Archives start.
16492. (
16493.   DirectoryName("*Archive*")
16494.   or DirectoryName("*History*")
16495.   or DirectoryName("*Old")
16496.   or DirectoryName("* Old *")
16497.   or DirectoryName("Old *")
16498. 
16499.   or FileName("*.7z")
16500.   or FileName("*.cab")
16501.   or FileName("*.iso")
16502.   or FileName("*.msi")
16503.   or FileName("*.old")
16504.   or FileName("*.rar")
16505.   or FileName("*.tar")
16506.   or FileName("*.zip")
16507.   or
16508. # WinSysLow start.
16509. (
16510.   # Bad idea. This pushed lots of programs and data to archive.
16511.   # DirectoryName("$*")
16512.   # or DirectoryName("0*")
16513.   # or DirectoryName("1*")
16514.   # or DirectoryName("2*")
16515.   # or DirectoryName("3*")
16516.   # or DirectoryName("4*")
16517.   # or DirectoryName("5*")
16518.   # or DirectoryName("6*")
16519.   # or DirectoryName("7*")
16520.   # or DirectoryName("8*")
16521.   # or DirectoryName("9*")
16522.   # or 
16523.   DirectoryName("dllcache")
16524.   or DirectoryName("Downloaded Installations")
16525.   or DirectoryName("Ehome")
16526.   or DirectoryName("Fonts")
16527.   or DirectoryName("Help")
16528.   or DirectoryName("I386")
16529.   or DirectoryName("ie?updates")
16530.   or DirectoryName("Installer")
16531.   or DirectoryName("Installshield Installation Information")
16532.   or DirectoryName("IME")
16533.   or DirectoryName("*RECYCLE*")
16534.   or DirectoryName("ServicePackFiles")
16535.   or DirectoryName("SoftwareDistribution")
16536.   or DirectoryName("Speech")
16537.   or DirectoryName("Symbols")
16538.   or DirectoryName("System Volume Information")
16539.   or DirectoryName("windows.old")
16540. )
16541. # WinSysLow end.
16542. 
16543.   # Archives
16544. )
16545. # Archives end.
16546. 
16547. # NotBlobsArchivesBu
16548. or
16549. # Backups start.
16550. (
16551.   DirectoryName("*Backup*")
16552.   or DirectoryName("*Bu")
16553.   or DirectoryName("* Bu *")
16554.   or DirectoryName("Bu *")
16555. 
16556.   or FileName("*.bak")
16557.   or FileName("* - Copy*")
16558. )
16559. # Backups end.
16560. 
16561. # NotBlobsArchivesBu
16562. ) )
16563. # NotBlobsArchivesBu end.
16564. 
16565. # People
16566. and (
16567. # People start.
16568. (
16569.   DirectoryName("*Capture*")
16570.   or DirectoryName("*Document*")
16571.   or DirectoryName("*Download*")
16572.   or DirectoryName("*Kids*")
16573.   or DirectoryName("Mail*")
16574.   or DirectoryName("*Mail")
16575.   or DirectoryName("My*")
16576.   or DirectoryName("*Person*")
16577.   or DirectoryName("Private*")
16578.   or DirectoryName("Users")
16579.   
16580.   # Individual People HERE:
16581.   or DirectoryName("Dgh*")
16582. )
16583. # People end.
16584. 
16585. # People
16586. )
16587. # People end.
16588. ')
16589. 
16590. 	# Script: ZoneDoHeader
16591. 
16592. # Script: ZoneWhenStarted
16593. RunProgram("..\Commands\WriteDateTime.bat")
16594. 
16595. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
16596. # Script: DisplaySetZone
16597. 
16598. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
16599. SetVariable(FileStepDescription,	"")
16600. 
16601. SetVariable(ZoneStepByLine, 			"Zone started.
16602. ")
16603. 
16604. # Script: BannerDescriptionSet
16605. 
16606. # Script: BannerSet
16607. 
16608. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16609. 
16610. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
16611. 
16612. Title('!Heading!')
16613. /* pause(1) */
16614. 
16615. /* NOTE: Can't round or truncate to integer precision. */
16616. 
16617. # Script: BannerLog
16618. 
16619. AppendLogfile("!LogFileName!", "!Title!")
16620. 
16621. 
16622. 
16623. pause(1)
16624. 
16625. 
16626. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
16627. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
16628. 
16629. SetVariable(ZoneStepNoCurrent, 0)
16630. 
16631. 
16632. # Script: ZoneDoCurrentClear
16633. 
16634. SetVariable(ZoneTypeSelectCurrent, 		"")
16635. 
16636. SetVariable(ZoneBeginCurrent, 			0)
16637. SetVariable(ZoneBeginPerCurrent, 		0)
16638. SetVariable(ZoneEndCurrent, 			0)
16639. SetVariable(ZoneEndPerCurrent, 			0)
16640. 
16641. SetVariable(ZoneSizeCurrent,			0)
16642. SetVariable(ZoneSizePerCurrent,			0)
16643. 
16644. SetVariable(ZoneGapRequestedCurrent,	0)
16645. SetVariable(ZoneGapRoundedCurrent, 		0)
16646. SetVariable(ZoneGapAdjustedCurrent, 	0)
16647. SetVariable(ZoneGapAvailableCurrent, 	0)
16648. SetVariable(ZoneGapCurrent,				0)
16649. SetVariable(ZoneGapUsedCurrent, 		0)
16650. 
16651. SetVariable(ZoneGapActualCurrent, 		0)
16652. SetVariable(ZoneGapActualPerCurrent, 	0)
16653. 
16654. SetVariable(ZoneSizeActual, 			0)
16655. SetVariable(ZoneSizeActualCurrent,		0)
16656. 
16657. SetVariable(ZoneEndActual, 				0)
16658. SetVariable(ZoneEndActualCurrent,		0)			
16659. SetVariable(ZoneSizeActualPerCurrent, 	0)
16660.       
16661. SetVariable(ZoneFilesFolders,			0)
16662. SetVariable(ZoneFilesFoldersPer,		0) 
16663. 
16664. SetVariable(ZoneFragments,				0)
16665. SetVariable(ZoneFragmentsPer,			0) 
16666. 		
16667. SetVariable(ZoneEndActualCurrent, 		0)
16668. SetVariable(ZoneEndActualPerCurrent, 	0)
16669. 
16670. # Gap Calculation Methodology:
16671. 	# Requested
16672. 	SetVariable(GapRequested, 			0) 
16673. 	SetVariable(GapRequestedStd, 		0) 
16674. 	SetVariable(GapRequestedMft, 		0) 
16675. 	SetVariable(GapRequestedOs, 		0) 
16676. 	SetVariable(GapRequestedOriginal, 	0) 
16677. 	
16678. 	# Gap Adjustments
16679. 	SetVariable(GapRounded, 			0)
16680. 	# SetVariable(GapAdjusted, 			0)
16681. 	SetVariable(GapAvailable, 			0)
16682. 	SetVariable(GapCurrent, 			0)
16683. 	SetVariable(GapActual, 				0)
16684. 	SetVariable(GapUsed, 				0)
16685. 	
16686. 	# Gap Adjustments
16687. 	SetVariable(GapRoundedLoc, 			0)
16688. 	# SetVariable(GapAdjustedLoc, 		0)
16689. 	SetVariable(GapAvailableLoc, 		0)
16690. 	SetVariable(GapCurrentLoc, 			0)
16691. 	SetVariable(GapActualLoc,			0)
16692. 	SetVariable(GapUsedLoc,				0)
16693. 	
16694. 	# Space usage
16695. 	SetVariable(ZoneFreePerRequested, 	0)
16696. 	SetVariable(ZoneFreePerUsed, 		0)
16697. 
16698. # Gap Size & Rounding
16699. 	SetVariable(ZoneGapSizePer, 		0)
16700. 	SetVariable(ZoneVolRoundUpPer, 		0)
16701. 	
16702. 	# Free Space
16703. 	SetVariable(ZoneFreeUsedPer, 		0)
16704. 	SetVariable(ZoneFreeRequestedPer, 	0)
16705. 
16706. 
16707. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
16708. 
16709. # Footer:
16710. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
16711. # 2021-11-17 21:08:28
16712. 
16713. SetVariable(ZoneFooter1, "----------------------------------------------------------
16714. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
16715. #
16716. # Xinclude "..\Commands\DateTimeLastLong.txt"X
16717. #
16718. SetVariable(ZoneFooter2, "Statistics Report:
16719. ------------------
16720.    Size:  
16721.    ------------------------
16722.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16723.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16724.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16725. 
16726.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16727.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16728. 
16729.    Location:
16730.    ------------------------
16731.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16732.             Files End: !ZoneEndCurrent!
16733.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16734.       
16735.    Gap Settings:
16736.    ------------------------
16737.          Gap Requested: !ZoneGapSizePer!%
16738.        Volume Rounding: !ZoneVolRoundUpPer!%
16739.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16740.                  
16741.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
16742.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
16743.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
16744.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
16745.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
16746.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
16747.      
16748.    Free Space after Zone:
16749.    ------------------------
16750.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16751.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16752.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16753. 
16754. Directory and Files Select:
16755. ---------------------------
16756. !ZoneTypeSelectCurrent!               
16757. ---------------------------
16758. ----------------------------------------------------------
16759. ")
16760. 
16761. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
16762. 
16763. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
16764. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
16765. RunProgram("..\Commands\WriteDateTime.bat LastZone")
16766. 
16767. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
16768. 
16769. 
16770. 
16771. # Script: BannerSet
16772. 
16773. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16774. 
16775. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
16776. 
16777. Title('!Heading!')
16778. /* pause(1) */
16779. 
16780. /* NOTE: Can't round or truncate to integer precision. */
16781. 
16782. # Script: BannerLog
16783. 
16784. AppendLogfile("!LogFileName!", "!Title!")
16785. 
16786. 
16787. 
16788. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
16789. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
16790. 
16791. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
16792. 
16793. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:28")
16794. 
16795. # 2021-11-17 21:08:28 
16796. SetVariable(Temp9, DATETIME)
16797. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:03 !ZoneLabel! !ZoneDescription!")
16798. 
16799. SetVariable(ZoneListByLine, "!ZoneListByLine! 
16800. Zone: !ZoneNoCurrent! !Temp9! 0:00:03 !ZoneLabel! !ZoneDescription!")
16801. 
16802. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:03 !ZoneLabel! !ZoneDescription!")
16803. 
16804. 
16805. /* Fixed Zone Position Handling */
16806. /* Literal number: */
16807. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
16808. /* Percentage of disk: */
16809. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
16810. /* Gap */
16811. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
16812. 
16813. /* ---------------------------------------------------------- */
16814. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
16815. # Script: DisplaySetFileStep
16816. 
16817. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16818. 
16819. /* add message and move to a new line. */
16820. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16821. ")
16822. 
16823. /* display the line. (hopefully.) */
16824. # Zone Footer Set Statistics Window Text
16825. 
16826. SetStatisticsWindowText("!Heading!
16827. ----------------------------------------------------------
16828. Zones Processed: 
16829. ----------------------------------------------------------
16830. !ZoneListByLine!
16831. ----------------------------------------------------------
16832. Zone Processing Step:
16833. !ZoneStepByLine!    
16834. ----------------------------------------------------------
16835. ----------------------------------------------------------
16836. Current Zone:
16837. !ZoneFooter!
16838. ----------------------------------------------------------
16839. ----------------------------------------------------------
16840. Volume Statistics:
16841. !VolumeStatisticsDetail!
16842. ----------------------------------------------------------
16843. ----------------------------------------------------------
16844. Zone Detailed Report:
16845. ----------------------------------------------------------
16846. !ZoneStatisticsDetail!
16847. ----------------------------------------------------------
16848. ")
16849. 
16850. 
16851. 
16852. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16853. 
16854. # Script: BannerSet
16855. 
16856. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
16857. 
16858. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
16859. 
16860. Title('!Heading!')
16861. /* pause(1) */
16862. 
16863. /* NOTE: Can't round or truncate to integer precision. */
16864. 
16865. pause(1)
16866. 
16867. # your stuff HERE (X)... pre file select code.
16868. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
16869. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16870. 	# (X)
16871. 
16872. FileSelect
16873. 
16874. 	# your stuff can't really go here (errors.)
16875. 	# maybe for some reason I don't know of...
16876. 	
16877. 	# Actions next...
16878. 	# Script: ZoneDo ZoneTypeSelectPeople
16879. # People start.
16880. # NotBlobsArchivesBu start.
16881. (not (
16882. # Blobs start.
16883. (
16884. # BlobsAndExceptions start.
16885. ( not(
16886.   FileName("*.bat")
16887.   or FileName("*.css")
16888.   or FileName("*.dll")
16889.   or FileName("*.exe")
16890.   or FileName("*.htm*")
16891.   or FileName("*.jar")
16892.   or FileName("*.js")
16893.   or FileName("*.script")
16894.   or FileName("*.wsf")
16895.   or (
16896. # Databases start.
16897. (
16898.   FileName("*.crypt*")
16899.   or FileName("*.db*")
16900.   or FileName("*.rdb*")
16901.   or FileName("*.dc*")
16902.   or FileName("*.dict*")
16903.   or FileName("*.?db*")
16904.   or FileName("*.?rdb*")
16905.   or FileName("*.md*")
16906.   or FileName("*.myd")
16907.   or FileName("*.ndf")
16908.   or FileName("*.ns?")
16909.   or FileName("*.pab")
16910.   or FileName("*.pst")
16911.   or FileName("*.sd?*")
16912.   or FileName("*.sq**")
16913.   or FileName("*.tmd")
16914.   or FileName("*.tps")
16915.   or FileName("*.tr*")
16916. )
16917. # Databases end.
16918. 
16919.     # BlobsAndExceptions
16920.     or 
16921. # Data start.
16922. (
16923.   DirectoryName("Data*")
16924.   or DirectoryName("Device*")
16925.   or DirectoryName("Export*")
16926.   or DirectoryName("Import*")
16927.   or DirectoryName("Log*")
16928.   or DirectoryName("*Log")
16929.   or DirectoryName("Maintenance*")
16930.   or DirectoryName("Rec*")
16931.   or DirectoryName("Sales*")
16932.   or DirectoryName("Search*")
16933.   or DirectoryName("User*")
16934. )
16935. # Data end.
16936. 
16937.     # BlobsAndExceptions
16938.   )
16939. ) )
16940. # BlobsAndExceptions end.
16941. 
16942. # Blobs
16943. ) and (
16944.   Size(BlobFileSize,0)
16945.   or (
16946.     FileName("*.arj")
16947.     or FileName("*.bup")
16948.     or FileName("*.bz2")
16949.     or FileName("*.chm")
16950.     or FileName("*.dvr-ms")
16951.     or FileName("*.gz")
16952.     or FileName("*.ifo")
16953.     or FileName("*.lzh")
16954.     or FileName("*.pdf")
16955.     or FileName("*.rpm")
16956.     or FileName("*.wmv")
16957.     or FileName("*.vob")
16958.     or FileName("*.z")
16959.   ) 
16960. )
16961. # Blobs end.
16962. 
16963. # NotBlobsArchivesBu
16964. or 
16965. # Archives start.
16966. (
16967.   DirectoryName("*Archive*")
16968.   or DirectoryName("*History*")
16969.   or DirectoryName("*Old")
16970.   or DirectoryName("* Old *")
16971.   or DirectoryName("Old *")
16972. 
16973.   or FileName("*.7z")
16974.   or FileName("*.cab")
16975.   or FileName("*.iso")
16976.   or FileName("*.msi")
16977.   or FileName("*.old")
16978.   or FileName("*.rar")
16979.   or FileName("*.tar")
16980.   or FileName("*.zip")
16981.   or
16982. # WinSysLow start.
16983. (
16984.   # Bad idea. This pushed lots of programs and data to archive.
16985.   # DirectoryName("$*")
16986.   # or DirectoryName("0*")
16987.   # or DirectoryName("1*")
16988.   # or DirectoryName("2*")
16989.   # or DirectoryName("3*")
16990.   # or DirectoryName("4*")
16991.   # or DirectoryName("5*")
16992.   # or DirectoryName("6*")
16993.   # or DirectoryName("7*")
16994.   # or DirectoryName("8*")
16995.   # or DirectoryName("9*")
16996.   # or 
16997.   DirectoryName("dllcache")
16998.   or DirectoryName("Downloaded Installations")
16999.   or DirectoryName("Ehome")
17000.   or DirectoryName("Fonts")
17001.   or DirectoryName("Help")
17002.   or DirectoryName("I386")
17003.   or DirectoryName("ie?updates")
17004.   or DirectoryName("Installer")
17005.   or DirectoryName("Installshield Installation Information")
17006.   or DirectoryName("IME")
17007.   or DirectoryName("*RECYCLE*")
17008.   or DirectoryName("ServicePackFiles")
17009.   or DirectoryName("SoftwareDistribution")
17010.   or DirectoryName("Speech")
17011.   or DirectoryName("Symbols")
17012.   or DirectoryName("System Volume Information")
17013.   or DirectoryName("windows.old")
17014. )
17015. # WinSysLow end.
17016. 
17017.   # Archives
17018. )
17019. # Archives end.
17020. 
17021. # NotBlobsArchivesBu
17022. or
17023. # Backups start.
17024. (
17025.   DirectoryName("*Backup*")
17026.   or DirectoryName("*Bu")
17027.   or DirectoryName("* Bu *")
17028.   or DirectoryName("Bu *")
17029. 
17030.   or FileName("*.bak")
17031.   or FileName("* - Copy*")
17032. )
17033. # Backups end.
17034. 
17035. # NotBlobsArchivesBu
17036. ) )
17037. # NotBlobsArchivesBu end.
17038. 
17039. # People
17040. and (
17041. # People start.
17042. (
17043.   DirectoryName("*Capture*")
17044.   or DirectoryName("*Document*")
17045.   or DirectoryName("*Download*")
17046.   or DirectoryName("*Kids*")
17047.   or DirectoryName("Mail*")
17048.   or DirectoryName("*Mail")
17049.   or DirectoryName("My*")
17050.   or DirectoryName("*Person*")
17051.   or DirectoryName("Private*")
17052.   or DirectoryName("Users")
17053.   
17054.   # Individual People HERE:
17055.   or DirectoryName("Dgh*")
17056. )
17057. # People end.
17058. 
17059. # People
17060. )
17061. # People end.
17062. 
17063. 	# Script: ZoneDoAction
17064. # Zone Do File Action - SortByName.
17065. 
17066. FileActions
17067. 
17068. 		/* ---------------------------------------------------------- */
17069. 	# Gap
17070. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
17071. 		# Script: DisplaySetFileStep
17072. 
17073. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17074. 
17075. /* add message and move to a new line. */
17076. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17077. ")
17078. 
17079. /* display the line. (hopefully.) */
17080. # Zone Footer Set Statistics Window Text
17081. 
17082. SetStatisticsWindowText("!Heading!
17083. ----------------------------------------------------------
17084. Zones Processed: 
17085. ----------------------------------------------------------
17086. !ZoneListByLine!
17087. ----------------------------------------------------------
17088. Zone Processing Step:
17089. !ZoneStepByLine!    
17090. ----------------------------------------------------------
17091. ----------------------------------------------------------
17092. Current Zone:
17093. !ZoneFooter!
17094. ----------------------------------------------------------
17095. ----------------------------------------------------------
17096. Volume Statistics:
17097. !VolumeStatisticsDetail!
17098. ----------------------------------------------------------
17099. ----------------------------------------------------------
17100. Zone Detailed Report:
17101. ----------------------------------------------------------
17102. !ZoneStatisticsDetail!
17103. ----------------------------------------------------------
17104. ")
17105. 
17106. 
17107. 
17108. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17109. 
17110. # Script: BannerSet
17111. 
17112. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17113. 
17114. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
17115. 
17116. Title('!Heading!')
17117. /* pause(1) */
17118. 
17119. /* NOTE: Can't round or truncate to integer precision. */
17120. 
17121. pause(1)
17122. 	
17123. 	# ACTUAL GAP
17124. 		/* AddGap Variant. */
17125. 	  	# Zone Do Gap
17126. # Gap Calculation Methods:
17127. 
17128. /* 1) Anything you need to add first. */
17129. /* empty */
17130. 
17131. /* ---------------------------------------------------------- */
17132. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
17133. 	# GapRequestedStd.
17134. 
17135. 		/* ---------------------------------------------------------- */
17136. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
17137. 
17138. 		# Gap Calculation Methods:
17139. 
17140. /* AddGap Variants */
17141. 
17142. 	/* Standard */
17143. 		# Gap Calculation Methods:
17144. 	/* AddGap Variants */
17145. 	/* Standard */
17146. 
17147. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
17148. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
17149. 
17150. 	SetVariable(GapRequested, GapRequestedStd)
17151. 	
17152. 
17153. 	/* MFT Low High Method */
17154. 		# Gap Calculation Methods:
17155. 	/* AddGap Variants */
17156. 	/* MFT Low High Method */
17157. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
17158. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
17159. 	SetVariable(GapRequested, GapRequestedMft)
17160. 	
17161. 
17162. 	/* OS Volume Type Method */
17163. 		# Gap Calculation Methods:
17164. 	/* AddGap Variants */
17165. 	/* OS Volume Type Method */
17166. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
17167. 	SetVariable(GapRequested, GapRequestedOs)
17168. 
17169. 
17170. 
17171. /* MakeGap Variants */
17172. 
17173. 	/* Original Os 1-3 + MFT 2 */
17174. 		# Gap Calculation Methods:
17175. 	/* MakeGap Variants */
17176. 	/* Original Os 1-3 + MFT 2 */
17177. 	/* plus MFT gap placed inline at the dividing zone. */
17178. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
17179. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
17180. 	SetVariable(GapRequested, GapRequestedOrig)
17181. 	
17182. 	
17183. /* Note: You could comment out the ones not in use */
17184. /* However having the data in the log is useful. */
17185. /* Therefore the following line is otherwise needed. */
17186. 
17187. /* Standard used */
17188. 
17189. SetVariable(GapRequested, GapRequestedStd)
17190. 
17191. # Gap Calculation Methods:
17192. 
17193. /* AddGap Variants */
17194. 	/* Standard */
17195. 	/* MFT Low High Method */
17196. 	/* OS Volume Type Method */
17197. 
17198. /* MakeGap Variants */
17199. 	/* Original Os 1-3 + MFT 2 */
17200. 
17201. /* Note: You could comment out the ones not in use */
17202. /* However having the data in the log is useful. */
17203. /* Therefore the following line is otherwise needed. */
17204. 
17205. /* Standard is used currently */
17206. 
17207. 
17208. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
17209. 
17210. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
17211. 
17212. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
17213. 
17214. /* ---------------------------------------------------------- */
17215. /* 3) SMALL ZONE ADJUSTMENT. */
17216. /* Gab cant be larger than half the Zone Size. */
17217. 
17218. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
17219. 	
17220. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
17221. 
17222. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
17223. 
17224. /* ---------------------------------------------------------- */
17225. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
17226. # Gap Adjustments.
17227. 
17228. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
17229. 	
17230. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
17231. 
17232. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
17233. 
17234. /* ---------------------------------------------------------- */
17235. # BYPASS THIS.
17236. 	/* This is definitely wrong. */
17237. 	/* The question is can we steal gap from the next zone */
17238. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
17239. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
17240. 		# Zone Overflow.
17241. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
17242. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
17243. 
17244. /* ---------------------------------------------------------- */
17245. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
17246. # Remaining free space available.
17247. 
17248. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
17249. 	
17250. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
17251. 
17252. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
17253. 
17254. /* ---------------------------------------------------------- */
17255. # CURRENT gap to use.
17256. 
17257. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
17258. 
17259. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
17260. 
17261. /* ---------------------------------------------------------- */
17262. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
17263. # Debugging.
17264. 
17265. 	SetVariable(GapUsed, GapCurrent) // for debugging
17266. 
17267. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
17268. 
17269. 		# Your code HERE
17270. 
17271. /* ---------------------------------------------------------- */
17272. /* 7) YOUR CODE. */
17273. # YOUR CODE HERE:
17274. 	# INPUT: GapCurrent or GapCurrentLoc
17275. 	# OUTPUT: GapUsed...
17276. 
17277. /* ---------------------------------------------------------- */
17278. # Gap Size.
17279. # Actual Size of Gap.
17280. 
17281. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
17282. 
17283. /* ---------------------------------------------------------- */
17284. /* xxxxxxxxxxxxxxxxxxxxxx */
17285. # ADD THE GAP
17286. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
17287. /* xxxxxxxxxxxxxxxxxxxxxx */
17288. 
17289. 	
17290. 	# Zone Statistics	
17291. 	# Script: ZoneDoStatistics
17292. # Zone / Volume Statistics and Display
17293. 		
17294. 	# Accumulate Totals
17295.   	# Script: ZoneDoVolumeTotals
17296. 
17297. /* Current total space used (by Zones and Gaps) */
17298. 
17299. SetVariable(VolumeZoneUsed, GapUsed)
17300. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
17301. /* Percentage */
17302. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
17303. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
17304. 
17305. /* Current total of free space requested */
17306. 
17307. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
17308. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17309. /* Percent. */
17310. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
17311. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17312. 
17313. /* Current total of free space used */
17314. 
17315. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
17316. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
17317. /* Percent */
17318. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
17319. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
17320. 
17321. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
17322. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
17323. /* Xinclude "..\DebugDisplayPause.MyDc"X */
17324. 
17325. 
17326. 	# Current Values
17327. 	# Script: ZoneDoCurrentSet
17328. 
17329. # Cluster, Sector, Block adjust for display.
17330. 	# Bytes per cluster is volume specific.
17331. 
17332. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
17333. 
17334. # Current Zone values.
17335. 	# Begin, end and size.
17336. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
17337. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
17338. 
17339. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
17340. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
17341. 
17342. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
17343. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
17344. 
17345. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
17346. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
17347. 
17348. 	SetVariable(ZoneFragments,				"!ZONE210N!")
17349. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
17350. 		
17351. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
17352. /* identical code to here: (separation not needed. TEST.) */	
17353. 
17354. # Current Gap, Actual and Free Values
17355. 	# Gap
17356. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
17357. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
17358. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
17359. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
17360. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
17361. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
17362. 	
17363. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
17364. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
17365. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
17366. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
17367. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
17368. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
17369. 	
17370. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
17371. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
17372. 	
17373. 	# Actual Size and End
17374. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
17375. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
17376. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
17377. 	
17378. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
17379. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
17380. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
17381. 
17382. # Gap Size & Rounding
17383. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
17384. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
17385. 	
17386. 	# Free Space
17387. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
17388. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
17389. 
17390. 	# Footer:
17391. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
17392. # 2021-11-17 21:08:28
17393. 
17394. SetVariable(ZoneFooter1, "----------------------------------------------------------
17395. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
17396. #
17397. # Xinclude "..\Commands\DateTimeLastLong.txt"X
17398. #
17399. SetVariable(ZoneFooter2, "Statistics Report:
17400. ------------------
17401.    Size:  
17402.    ------------------------
17403.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17404.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17405.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17406. 
17407.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17408.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17409. 
17410.    Location:
17411.    ------------------------
17412.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17413.             Files End: !ZoneEndCurrent!
17414.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17415.       
17416.    Gap Settings:
17417.    ------------------------
17418.          Gap Requested: !ZoneGapSizePer!%
17419.        Volume Rounding: !ZoneVolRoundUpPer!%
17420.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17421.                  
17422.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
17423.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
17424.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
17425.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
17426.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
17427.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
17428.      
17429.    Free Space after Zone:
17430.    ------------------------
17431.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17432.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17433.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17434. 
17435. Directory and Files Select:
17436. ---------------------------
17437. !ZoneTypeSelectCurrent!               
17438. ---------------------------
17439. ----------------------------------------------------------
17440. ")
17441. 
17442. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
17443. 
17444. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
17445. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
17446. RunProgram("..\Commands\WriteDateTime.bat LastZone")
17447. 
17448. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
17449. 
17450. 
17451. 	# Zone Footer Set Statistics Window Text
17452. 
17453. SetStatisticsWindowText("!Heading!
17454. ----------------------------------------------------------
17455. Zones Processed: 
17456. ----------------------------------------------------------
17457. !ZoneListByLine!
17458. ----------------------------------------------------------
17459. Zone Processing Step:
17460. !ZoneStepByLine!    
17461. ----------------------------------------------------------
17462. ----------------------------------------------------------
17463. Current Zone:
17464. !ZoneFooter!
17465. ----------------------------------------------------------
17466. ----------------------------------------------------------
17467. Volume Statistics:
17468. !VolumeStatisticsDetail!
17469. ----------------------------------------------------------
17470. ----------------------------------------------------------
17471. Zone Detailed Report:
17472. ----------------------------------------------------------
17473. !ZoneStatisticsDetail!
17474. ----------------------------------------------------------
17475. ")
17476. 
17477. 
17478. 	
17479.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
17480. 
17481. 	# Add Zone to list of zones for display.
17482. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
17483. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
17484. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
17485. 	# ??? Free Stats?
17486. 	# Footer:
17487. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
17488. # 2021-11-17 21:08:28
17489. 
17490. SetVariable(ZoneFooter1, "----------------------------------------------------------
17491. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
17492. #
17493. # Xinclude "..\Commands\DateTimeLastLong.txt"X
17494. #
17495. SetVariable(ZoneFooter2, "Statistics Report:
17496. ------------------
17497.    Size:  
17498.    ------------------------
17499.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17500.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17501.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17502. 
17503.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17504.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17505. 
17506.    Location:
17507.    ------------------------
17508.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17509.             Files End: !ZoneEndCurrent!
17510.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17511.       
17512.    Gap Settings:
17513.    ------------------------
17514.          Gap Requested: !ZoneGapSizePer!%
17515.        Volume Rounding: !ZoneVolRoundUpPer!%
17516.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17517.                  
17518.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
17519.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
17520.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
17521.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
17522.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
17523.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
17524.      
17525.    Free Space after Zone:
17526.    ------------------------
17527.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17528.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17529.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17530. 
17531. Directory and Files Select:
17532. ---------------------------
17533. !ZoneTypeSelectCurrent!               
17534. ---------------------------
17535. ----------------------------------------------------------
17536. ")
17537. 
17538. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
17539. 
17540. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
17541. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
17542. RunProgram("..\Commands\WriteDateTime.bat LastZone")
17543. 
17544. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
17545. 
17546. 
17547. 
17548. 	# Add Zone Details to Report.	
17549. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
17550. !ZoneFooter!")
17551. 
17552. 
17553. 	
17554. 	# Footer:
17555. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
17556. # 2021-11-17 21:08:28
17557. 
17558. SetVariable(ZoneFooter1, "----------------------------------------------------------
17559. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
17560. #
17561. # Xinclude "..\Commands\DateTimeLastLong.txt"X
17562. #
17563. SetVariable(ZoneFooter2, "Statistics Report:
17564. ------------------
17565.    Size:  
17566.    ------------------------
17567.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17568.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17569.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17570. 
17571.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17572.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17573. 
17574.    Location:
17575.    ------------------------
17576.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17577.             Files End: !ZoneEndCurrent!
17578.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17579.       
17580.    Gap Settings:
17581.    ------------------------
17582.          Gap Requested: !ZoneGapSizePer!%
17583.        Volume Rounding: !ZoneVolRoundUpPer!%
17584.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17585.                  
17586.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
17587.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
17588.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
17589.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
17590.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
17591.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
17592.      
17593.    Free Space after Zone:
17594.    ------------------------
17595.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17596.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17597.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17598. 
17599. Directory and Files Select:
17600. ---------------------------
17601. !ZoneTypeSelectCurrent!               
17602. ---------------------------
17603. ----------------------------------------------------------
17604. ")
17605. 
17606. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
17607. 
17608. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
17609. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
17610. RunProgram("..\Commands\WriteDateTime.bat LastZone")
17611. 
17612. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
17613. 
17614. 
17615. 	SetStatisticsWindowText("!ZoneFooter!")
17616. 	
17617. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
17618. 	# Script: DisplaySetFileStep
17619. 
17620. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17621. 
17622. /* add message and move to a new line. */
17623. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17624. ")
17625. 
17626. /* display the line. (hopefully.) */
17627. # Zone Footer Set Statistics Window Text
17628. 
17629. SetStatisticsWindowText("!Heading!
17630. ----------------------------------------------------------
17631. Zones Processed: 
17632. ----------------------------------------------------------
17633. !ZoneListByLine!
17634. ----------------------------------------------------------
17635. Zone Processing Step:
17636. !ZoneStepByLine!    
17637. ----------------------------------------------------------
17638. ----------------------------------------------------------
17639. Current Zone:
17640. !ZoneFooter!
17641. ----------------------------------------------------------
17642. ----------------------------------------------------------
17643. Volume Statistics:
17644. !VolumeStatisticsDetail!
17645. ----------------------------------------------------------
17646. ----------------------------------------------------------
17647. Zone Detailed Report:
17648. ----------------------------------------------------------
17649. !ZoneStatisticsDetail!
17650. ----------------------------------------------------------
17651. ")
17652. 
17653. 
17654. 
17655. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17656. 
17657. # Script: BannerSet
17658. 
17659. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17660. 
17661. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
17662. 
17663. Title('!Heading!')
17664. /* pause(1) */
17665. 
17666. /* NOTE: Can't round or truncate to integer precision. */
17667. 
17668. pause(1)
17669. 
17670. # Commands:
17671. 
17672. /* Moves to Zone or above it. */
17673. # MoveUpToZone()
17674. 
17675. # Defrag
17676. 
17677. # Defragment(OPTIONS)
17678. 
17679. /* Shuffles files around trying to make a big enough gap for fragmented files. */
17680. # Defragment()
17681. 
17682. /* Only does files where a gap will fit it. */
17683. # Defragment(Fast)
17684. 
17685. /* Skips fragmented files larger than the Chunck Size. */
17686. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
17687. # Defragment(Chunk Size)
17688. 
17689. /* Moves down to zone and packs zone to beginning if there are gaps. */
17690. /* Can be similar in performance to doing a SortBy. */
17691. # MoveDownFill()
17692. 
17693. # File Action - All - Regular -  SortByName.
17694. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
17695. 	
17696. 
17697. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
17698. 	# Script: DisplaySetFileStep
17699. 
17700. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17701. 
17702. /* add message and move to a new line. */
17703. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17704. ")
17705. 
17706. /* display the line. (hopefully.) */
17707. # Zone Footer Set Statistics Window Text
17708. 
17709. SetStatisticsWindowText("!Heading!
17710. ----------------------------------------------------------
17711. Zones Processed: 
17712. ----------------------------------------------------------
17713. !ZoneListByLine!
17714. ----------------------------------------------------------
17715. Zone Processing Step:
17716. !ZoneStepByLine!    
17717. ----------------------------------------------------------
17718. ----------------------------------------------------------
17719. Current Zone:
17720. !ZoneFooter!
17721. ----------------------------------------------------------
17722. ----------------------------------------------------------
17723. Volume Statistics:
17724. !VolumeStatisticsDetail!
17725. ----------------------------------------------------------
17726. ----------------------------------------------------------
17727. Zone Detailed Report:
17728. ----------------------------------------------------------
17729. !ZoneStatisticsDetail!
17730. ----------------------------------------------------------
17731. ")
17732. 
17733. 
17734. 
17735. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17736. 
17737. # Script: BannerSet
17738. 
17739. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17740. 
17741. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
17742. 
17743. Title('!Heading!')
17744. /* pause(1) */
17745. 
17746. /* NOTE: Can't round or truncate to integer precision. */
17747. 
17748. pause(1)
17749. 
17750. 	# Script: ZoneDoFooter
17751. 
17752. /* ---------------------------------------------------------- */
17753. # File Select
17754. 	# Select Statments
17755. # File Actions 
17756. 	# Standard or OS File Actions.
17757. 	# Resume...
17758. 	
17759. 	# your stuff HERE (X)... post zone (file) file actions code.
17760. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
17761. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17762. 		# (X)
17763. 		
17764. 		/* ??? Set window? */
17765. 	
17766. 	# ADD THE GAP
17767. # Vacate (good for diagnostics)
17768. # DoNotVacate - DO NOT Vacate (recommended)
17769. # DoNotVacate - DO NOT Vacate (recommended)
17770. 
17771. # Vacate
17772. /* AddGap(GapUsedLoc) */
17773. 
17774. # DO Not Vacate
17775. AddGap(GapUsedLoc, DoNotVacate) 
17776. 	
17777. 	
17778. # Script: GapZoneCommand
17779. # *** Moved to setting yours ***
17780. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
17781. # Controlled via settings commands
17782. # DoNotVacate - DO NOT Vacate (recommended)
17783. 
17784. # Vacate
17785. /* AddGap(GapUsedLoc) */
17786. 
17787. # DO Not Vacate
17788. AddGap(GapUsedLoc, DoNotVacate) 
17789. 	
17790. 	
17791. # Vacate /* AddGap(GapUsed) */
17792. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
17793. 	
17794. 
17795. 		
17796. # 
17797. FileEnd
17798. /* ---------------------------------------------------------- */
17799. 
17800. # your stuff HERE (X)... post zone (file) code.
17801. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
17802. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17803. 	# (X)
17804. 
17805. SetVariable(FileStepDescription,"Zone finished, reporting.")
17806. # Script: DisplaySetFileStep
17807. 
17808. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17809. 
17810. /* add message and move to a new line. */
17811. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17812. ")
17813. 
17814. /* display the line. (hopefully.) */
17815. # Zone Footer Set Statistics Window Text
17816. 
17817. SetStatisticsWindowText("!Heading!
17818. ----------------------------------------------------------
17819. Zones Processed: 
17820. ----------------------------------------------------------
17821. !ZoneListByLine!
17822. ----------------------------------------------------------
17823. Zone Processing Step:
17824. !ZoneStepByLine!    
17825. ----------------------------------------------------------
17826. ----------------------------------------------------------
17827. Current Zone:
17828. !ZoneFooter!
17829. ----------------------------------------------------------
17830. ----------------------------------------------------------
17831. Volume Statistics:
17832. !VolumeStatisticsDetail!
17833. ----------------------------------------------------------
17834. ----------------------------------------------------------
17835. Zone Detailed Report:
17836. ----------------------------------------------------------
17837. !ZoneStatisticsDetail!
17838. ----------------------------------------------------------
17839. ")
17840. 
17841. 
17842. 
17843. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17844. 
17845. # Script: BannerSet
17846. 
17847. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17848. 
17849. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
17850. 
17851. Title('!Heading!')
17852. /* pause(1) */
17853. 
17854. /* NOTE: Can't round or truncate to integer precision. */
17855. 
17856. pause(1)
17857. 
17858. # Script: ZoneWhenFinished
17859. 
17860. # Script: BannerSet
17861. 
17862. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17863. 
17864. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
17865. 
17866. Title('!Heading!')
17867. /* pause(1) */
17868. 
17869. /* NOTE: Can't round or truncate to integer precision. */
17870. 
17871. # Script: BannerLog
17872. 
17873. AppendLogfile("!LogFileName!", "!Title!")
17874. 
17875. 
17876. 
17877. # Zone Statistics	
17878. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
17879. 
17880. # Footer:
17881. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
17882. # 2021-11-17 21:08:28
17883. 
17884. SetVariable(ZoneFooter1, "----------------------------------------------------------
17885. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
17886. #
17887. # Xinclude "..\Commands\DateTimeLastLong.txt"X
17888. #
17889. SetVariable(ZoneFooter2, "Statistics Report:
17890. ------------------
17891.    Size:  
17892.    ------------------------
17893.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17894.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17895.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17896. 
17897.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17898.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17899. 
17900.    Location:
17901.    ------------------------
17902.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17903.             Files End: !ZoneEndCurrent!
17904.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17905.       
17906.    Gap Settings:
17907.    ------------------------
17908.          Gap Requested: !ZoneGapSizePer!%
17909.        Volume Rounding: !ZoneVolRoundUpPer!%
17910.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17911.                  
17912.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
17913.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
17914.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
17915.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
17916.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
17917.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
17918.      
17919.    Free Space after Zone:
17920.    ------------------------
17921.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17922.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17923.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17924. 
17925. Directory and Files Select:
17926. ---------------------------
17927. !ZoneTypeSelectCurrent!               
17928. ---------------------------
17929. ----------------------------------------------------------
17930. ")
17931. 
17932. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
17933. 
17934. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
17935. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
17936. RunProgram("..\Commands\WriteDateTime.bat LastZone")
17937. 
17938. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
17939. 
17940. 
17941. 
17942. AppendLogfile("!LogFileName!", ".")
17943. AppendLogfile("!LogFileName!", "!ZoneFooter!")
17944. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
17945. AppendLogfile("!LogFileName!", ".")
17946. 
17947. # Zone Footer Set Statistics Window Text
17948. 
17949. SetStatisticsWindowText("!Heading!
17950. ----------------------------------------------------------
17951. Zones Processed: 
17952. ----------------------------------------------------------
17953. !ZoneListByLine!
17954. ----------------------------------------------------------
17955. Zone Processing Step:
17956. !ZoneStepByLine!    
17957. ----------------------------------------------------------
17958. ----------------------------------------------------------
17959. Current Zone:
17960. !ZoneFooter!
17961. ----------------------------------------------------------
17962. ----------------------------------------------------------
17963. Volume Statistics:
17964. !VolumeStatisticsDetail!
17965. ----------------------------------------------------------
17966. ----------------------------------------------------------
17967. Zone Detailed Report:
17968. ----------------------------------------------------------
17969. !ZoneStatisticsDetail!
17970. ----------------------------------------------------------
17971. ")
17972. 
17973. 
17974. 
17975. /* pause() */
17976. /* pause() */
17977. 
17978. 
17979. 
17980. 
17981. /* ---------------------------------------------------------- */
17982. 
17983. 
17984. /* ---------------------------------------------------------- */
17985. // "4" & "5" now 13 & 14
17986. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
17987. /* Process MFT & Dir's HERE. */
17988. 	SetVariable(FileStepDescription,"Calculating Gap for MFT and DIR.")
17989. # Script: BannerDescriptionSet
17990. 
17991. # Script: BannerSet
17992. 
17993. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
17994. 
17995. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
17996. 
17997. Title('!Heading!')
17998. /* pause(1) */
17999. 
18000. /* NOTE: Can't round or truncate to integer precision. */
18001. 
18002. # Script: BannerLog
18003. 
18004. AppendLogfile("!LogFileName!", "!Title!")
18005. 
18006. 
18007. 
18008. 
18009. SetVariable(MftReport,"")
18010. 
18011. SetVariable(MftReport, "!MftReport!MftLocation: !MftLocation! 2021-11-17 21:08:28")
18012. # SetVariable(MftSize,                 0)
18013. SetVariable(MftReport, "!MftReport!MftSize:                 0")
18014. 
18015. SetVariable(MftGapSlack, MftLocation - VolumeUsedTotal)
18016. SetVariable(MftReport, "!MftReport!MftGapSlack: !MftGapSlack!")
18017. 
18018. SetVariable(MftGapSlackPerUsed, MftGapSlack / VolumeFreeAdj)
18019. SetVariable(MftReport, "!MftReport!MftGapSlackPerUsed: !MftGapSlackPerUsed!")
18020. 
18021. SetVariable(MftReport, "!MftReport!VolumeUsed before: !VolumeUsedTotal!")
18022. SetVariable(VolumeUsedTotal, MftLocation)
18023. SetVariable(MftReport, "!MftReport!VolumeUsed at location: !VolumeUsedTotal!")
18024. 
18025. SetVariable(VolumeFreePerUsed, VolumeFreePerUsed + (MftGapSlack / VolumeFree))
18026. SetVariable(MftReport, "!MftReport!VolumeFreePerUsed: !VolumeFreePerUsed!")
18027. 
18028. /* ---------------------------------------------------------- */
18029. #  MFT
18030. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
18031. 
18032. # Script: DefragZoneTypeOsMft
18033. /* ---------------------------------------------------------- */
18034. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
18035.   
18036. SetVariable(ZoneLabel,				"MFT") // "4" 
18037. SetVariable(ZoneDescription, 		"MFT - Master File Table")
18038. SetVariable(ZoneCurrentAjust, 		1)
18039. /* and some other special NTFS files. */
18040. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpMft!")
18041. SetVariable(ZoneGapSize, 			"!ZoneGapSizeMft!")
18042. SetVariable(ZoneTypeSelect,			'# Script: ZoneDo ZoneTypeSelectOsMFT
18043. # MFT start.
18044. SelectNtfsSystemFiles(yes)
18045. # MFT end.')
18046. 
18047. 	# Script: ZoneDoHeader
18048. 
18049. # Script: ZoneWhenStarted
18050. RunProgram("..\Commands\WriteDateTime.bat")
18051. 
18052. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
18053. # Script: DisplaySetZone
18054. 
18055. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
18056. SetVariable(FileStepDescription,	"")
18057. 
18058. SetVariable(ZoneStepByLine, 			"Zone started.
18059. ")
18060. 
18061. # Script: BannerDescriptionSet
18062. 
18063. # Script: BannerSet
18064. 
18065. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18066. 
18067. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
18068. 
18069. Title('!Heading!')
18070. /* pause(1) */
18071. 
18072. /* NOTE: Can't round or truncate to integer precision. */
18073. 
18074. # Script: BannerLog
18075. 
18076. AppendLogfile("!LogFileName!", "!Title!")
18077. 
18078. 
18079. 
18080. pause(1)
18081. 
18082. 
18083. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
18084. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
18085. 
18086. SetVariable(ZoneStepNoCurrent, 0)
18087. 
18088. 
18089. # Script: ZoneDoCurrentClear
18090. 
18091. SetVariable(ZoneTypeSelectCurrent, 		"")
18092. 
18093. SetVariable(ZoneBeginCurrent, 			0)
18094. SetVariable(ZoneBeginPerCurrent, 		0)
18095. SetVariable(ZoneEndCurrent, 			0)
18096. SetVariable(ZoneEndPerCurrent, 			0)
18097. 
18098. SetVariable(ZoneSizeCurrent,			0)
18099. SetVariable(ZoneSizePerCurrent,			0)
18100. 
18101. SetVariable(ZoneGapRequestedCurrent,	0)
18102. SetVariable(ZoneGapRoundedCurrent, 		0)
18103. SetVariable(ZoneGapAdjustedCurrent, 	0)
18104. SetVariable(ZoneGapAvailableCurrent, 	0)
18105. SetVariable(ZoneGapCurrent,				0)
18106. SetVariable(ZoneGapUsedCurrent, 		0)
18107. 
18108. SetVariable(ZoneGapActualCurrent, 		0)
18109. SetVariable(ZoneGapActualPerCurrent, 	0)
18110. 
18111. SetVariable(ZoneSizeActual, 			0)
18112. SetVariable(ZoneSizeActualCurrent,		0)
18113. 
18114. SetVariable(ZoneEndActual, 				0)
18115. SetVariable(ZoneEndActualCurrent,		0)			
18116. SetVariable(ZoneSizeActualPerCurrent, 	0)
18117.       
18118. SetVariable(ZoneFilesFolders,			0)
18119. SetVariable(ZoneFilesFoldersPer,		0) 
18120. 
18121. SetVariable(ZoneFragments,				0)
18122. SetVariable(ZoneFragmentsPer,			0) 
18123. 		
18124. SetVariable(ZoneEndActualCurrent, 		0)
18125. SetVariable(ZoneEndActualPerCurrent, 	0)
18126. 
18127. # Gap Calculation Methodology:
18128. 	# Requested
18129. 	SetVariable(GapRequested, 			0) 
18130. 	SetVariable(GapRequestedStd, 		0) 
18131. 	SetVariable(GapRequestedMft, 		0) 
18132. 	SetVariable(GapRequestedOs, 		0) 
18133. 	SetVariable(GapRequestedOriginal, 	0) 
18134. 	
18135. 	# Gap Adjustments
18136. 	SetVariable(GapRounded, 			0)
18137. 	# SetVariable(GapAdjusted, 			0)
18138. 	SetVariable(GapAvailable, 			0)
18139. 	SetVariable(GapCurrent, 			0)
18140. 	SetVariable(GapActual, 				0)
18141. 	SetVariable(GapUsed, 				0)
18142. 	
18143. 	# Gap Adjustments
18144. 	SetVariable(GapRoundedLoc, 			0)
18145. 	# SetVariable(GapAdjustedLoc, 		0)
18146. 	SetVariable(GapAvailableLoc, 		0)
18147. 	SetVariable(GapCurrentLoc, 			0)
18148. 	SetVariable(GapActualLoc,			0)
18149. 	SetVariable(GapUsedLoc,				0)
18150. 	
18151. 	# Space usage
18152. 	SetVariable(ZoneFreePerRequested, 	0)
18153. 	SetVariable(ZoneFreePerUsed, 		0)
18154. 
18155. # Gap Size & Rounding
18156. 	SetVariable(ZoneGapSizePer, 		0)
18157. 	SetVariable(ZoneVolRoundUpPer, 		0)
18158. 	
18159. 	# Free Space
18160. 	SetVariable(ZoneFreeUsedPer, 		0)
18161. 	SetVariable(ZoneFreeRequestedPer, 	0)
18162. 
18163. 
18164. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
18165. 
18166. # Footer:
18167. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
18168. # 2021-11-17 21:08:28
18169. 
18170. SetVariable(ZoneFooter1, "----------------------------------------------------------
18171. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
18172. #
18173. # Xinclude "..\Commands\DateTimeLastLong.txt"X
18174. #
18175. SetVariable(ZoneFooter2, "Statistics Report:
18176. ------------------
18177.    Size:  
18178.    ------------------------
18179.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18180.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18181.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18182. 
18183.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18184.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18185. 
18186.    Location:
18187.    ------------------------
18188.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18189.             Files End: !ZoneEndCurrent!
18190.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18191.       
18192.    Gap Settings:
18193.    ------------------------
18194.          Gap Requested: !ZoneGapSizePer!%
18195.        Volume Rounding: !ZoneVolRoundUpPer!%
18196.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18197.                  
18198.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
18199.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
18200.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
18201.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
18202.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
18203.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
18204.      
18205.    Free Space after Zone:
18206.    ------------------------
18207.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18208.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18209.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18210. 
18211. Directory and Files Select:
18212. ---------------------------
18213. !ZoneTypeSelectCurrent!               
18214. ---------------------------
18215. ----------------------------------------------------------
18216. ")
18217. 
18218. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
18219. 
18220. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
18221. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
18222. RunProgram("..\Commands\WriteDateTime.bat LastZone")
18223. 
18224. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
18225. 
18226. 
18227. 
18228. # Script: BannerSet
18229. 
18230. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18231. 
18232. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
18233. 
18234. Title('!Heading!')
18235. /* pause(1) */
18236. 
18237. /* NOTE: Can't round or truncate to integer precision. */
18238. 
18239. # Script: BannerLog
18240. 
18241. AppendLogfile("!LogFileName!", "!Title!")
18242. 
18243. 
18244. 
18245. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
18246. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
18247. 
18248. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
18249. 
18250. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:28")
18251. 
18252. # 2021-11-17 21:08:28 
18253. SetVariable(Temp9, DATETIME)
18254. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:03 !ZoneLabel! !ZoneDescription!")
18255. 
18256. SetVariable(ZoneListByLine, "!ZoneListByLine! 
18257. Zone: !ZoneNoCurrent! !Temp9! 0:00:03 !ZoneLabel! !ZoneDescription!")
18258. 
18259. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:03 !ZoneLabel! !ZoneDescription!")
18260. 
18261. 
18262. /* Fixed Zone Position Handling */
18263. /* Literal number: */
18264. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
18265. /* Percentage of disk: */
18266. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
18267. /* Gap */
18268. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
18269. 
18270. /* ---------------------------------------------------------- */
18271. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
18272. # Script: DisplaySetFileStep
18273. 
18274. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18275. 
18276. /* add message and move to a new line. */
18277. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18278. ")
18279. 
18280. /* display the line. (hopefully.) */
18281. # Zone Footer Set Statistics Window Text
18282. 
18283. SetStatisticsWindowText("!Heading!
18284. ----------------------------------------------------------
18285. Zones Processed: 
18286. ----------------------------------------------------------
18287. !ZoneListByLine!
18288. ----------------------------------------------------------
18289. Zone Processing Step:
18290. !ZoneStepByLine!    
18291. ----------------------------------------------------------
18292. ----------------------------------------------------------
18293. Current Zone:
18294. !ZoneFooter!
18295. ----------------------------------------------------------
18296. ----------------------------------------------------------
18297. Volume Statistics:
18298. !VolumeStatisticsDetail!
18299. ----------------------------------------------------------
18300. ----------------------------------------------------------
18301. Zone Detailed Report:
18302. ----------------------------------------------------------
18303. !ZoneStatisticsDetail!
18304. ----------------------------------------------------------
18305. ")
18306. 
18307. 
18308. 
18309. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18310. 
18311. # Script: BannerSet
18312. 
18313. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18314. 
18315. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
18316. 
18317. Title('!Heading!')
18318. /* pause(1) */
18319. 
18320. /* NOTE: Can't round or truncate to integer precision. */
18321. 
18322. pause(1)
18323. 
18324. # your stuff HERE (X)... pre file select code.
18325. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
18326. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18327. 	# (X)
18328. 
18329. FileSelect
18330. 
18331. 	# your stuff can't really go here (errors.)
18332. 	# maybe for some reason I don't know of...
18333. 	
18334. 	# Actions next...
18335. 	# Script: ZoneDo ZoneTypeSelectOsMFT
18336. # MFT start.
18337. SelectNtfsSystemFiles(yes)
18338. # MFT end.
18339. 	
18340. 	FileActions
18341. 	  		/* ---------------------------------------------------------- */
18342. 	# Gap
18343. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
18344. 		# Script: DisplaySetFileStep
18345. 
18346. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18347. 
18348. /* add message and move to a new line. */
18349. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18350. ")
18351. 
18352. /* display the line. (hopefully.) */
18353. # Zone Footer Set Statistics Window Text
18354. 
18355. SetStatisticsWindowText("!Heading!
18356. ----------------------------------------------------------
18357. Zones Processed: 
18358. ----------------------------------------------------------
18359. !ZoneListByLine!
18360. ----------------------------------------------------------
18361. Zone Processing Step:
18362. !ZoneStepByLine!    
18363. ----------------------------------------------------------
18364. ----------------------------------------------------------
18365. Current Zone:
18366. !ZoneFooter!
18367. ----------------------------------------------------------
18368. ----------------------------------------------------------
18369. Volume Statistics:
18370. !VolumeStatisticsDetail!
18371. ----------------------------------------------------------
18372. ----------------------------------------------------------
18373. Zone Detailed Report:
18374. ----------------------------------------------------------
18375. !ZoneStatisticsDetail!
18376. ----------------------------------------------------------
18377. ")
18378. 
18379. 
18380. 
18381. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18382. 
18383. # Script: BannerSet
18384. 
18385. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18386. 
18387. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
18388. 
18389. Title('!Heading!')
18390. /* pause(1) */
18391. 
18392. /* NOTE: Can't round or truncate to integer precision. */
18393. 
18394. pause(1)
18395. 	
18396. 	# ACTUAL GAP
18397. 		/* AddGap Variant. */
18398. 	  	# Zone Do Gap
18399. # Gap Calculation Methods:
18400. 
18401. /* 1) Anything you need to add first. */
18402. /* empty */
18403. 
18404. /* ---------------------------------------------------------- */
18405. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
18406. 	# GapRequestedStd.
18407. 
18408. 		/* ---------------------------------------------------------- */
18409. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
18410. 
18411. 		# Gap Calculation Methods:
18412. 
18413. /* AddGap Variants */
18414. 
18415. 	/* Standard */
18416. 		# Gap Calculation Methods:
18417. 	/* AddGap Variants */
18418. 	/* Standard */
18419. 
18420. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
18421. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
18422. 
18423. 	SetVariable(GapRequested, GapRequestedStd)
18424. 	
18425. 
18426. 	/* MFT Low High Method */
18427. 		# Gap Calculation Methods:
18428. 	/* AddGap Variants */
18429. 	/* MFT Low High Method */
18430. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
18431. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
18432. 	SetVariable(GapRequested, GapRequestedMft)
18433. 	
18434. 
18435. 	/* OS Volume Type Method */
18436. 		# Gap Calculation Methods:
18437. 	/* AddGap Variants */
18438. 	/* OS Volume Type Method */
18439. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
18440. 	SetVariable(GapRequested, GapRequestedOs)
18441. 
18442. 
18443. 
18444. /* MakeGap Variants */
18445. 
18446. 	/* Original Os 1-3 + MFT 2 */
18447. 		# Gap Calculation Methods:
18448. 	/* MakeGap Variants */
18449. 	/* Original Os 1-3 + MFT 2 */
18450. 	/* plus MFT gap placed inline at the dividing zone. */
18451. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
18452. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
18453. 	SetVariable(GapRequested, GapRequestedOrig)
18454. 	
18455. 	
18456. /* Note: You could comment out the ones not in use */
18457. /* However having the data in the log is useful. */
18458. /* Therefore the following line is otherwise needed. */
18459. 
18460. /* Standard used */
18461. 
18462. SetVariable(GapRequested, GapRequestedStd)
18463. 
18464. # Gap Calculation Methods:
18465. 
18466. /* AddGap Variants */
18467. 	/* Standard */
18468. 	/* MFT Low High Method */
18469. 	/* OS Volume Type Method */
18470. 
18471. /* MakeGap Variants */
18472. 	/* Original Os 1-3 + MFT 2 */
18473. 
18474. /* Note: You could comment out the ones not in use */
18475. /* However having the data in the log is useful. */
18476. /* Therefore the following line is otherwise needed. */
18477. 
18478. /* Standard is used currently */
18479. 
18480. 
18481. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
18482. 
18483. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
18484. 
18485. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
18486. 
18487. /* ---------------------------------------------------------- */
18488. /* 3) SMALL ZONE ADJUSTMENT. */
18489. /* Gab cant be larger than half the Zone Size. */
18490. 
18491. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
18492. 	
18493. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
18494. 
18495. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
18496. 
18497. /* ---------------------------------------------------------- */
18498. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
18499. # Gap Adjustments.
18500. 
18501. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
18502. 	
18503. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
18504. 
18505. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
18506. 
18507. /* ---------------------------------------------------------- */
18508. # BYPASS THIS.
18509. 	/* This is definitely wrong. */
18510. 	/* The question is can we steal gap from the next zone */
18511. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
18512. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
18513. 		# Zone Overflow.
18514. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
18515. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
18516. 
18517. /* ---------------------------------------------------------- */
18518. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
18519. # Remaining free space available.
18520. 
18521. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
18522. 	
18523. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
18524. 
18525. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
18526. 
18527. /* ---------------------------------------------------------- */
18528. # CURRENT gap to use.
18529. 
18530. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
18531. 
18532. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
18533. 
18534. /* ---------------------------------------------------------- */
18535. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
18536. # Debugging.
18537. 
18538. 	SetVariable(GapUsed, GapCurrent) // for debugging
18539. 
18540. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
18541. 
18542. 		# Your code HERE
18543. 
18544. /* ---------------------------------------------------------- */
18545. /* 7) YOUR CODE. */
18546. # YOUR CODE HERE:
18547. 	# INPUT: GapCurrent or GapCurrentLoc
18548. 	# OUTPUT: GapUsed...
18549. 
18550. /* ---------------------------------------------------------- */
18551. # Gap Size.
18552. # Actual Size of Gap.
18553. 
18554. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
18555. 
18556. /* ---------------------------------------------------------- */
18557. /* xxxxxxxxxxxxxxxxxxxxxx */
18558. # ADD THE GAP
18559. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
18560. /* xxxxxxxxxxxxxxxxxxxxxx */
18561. 
18562. 	
18563. 	# Zone Statistics	
18564. 	# Script: ZoneDoStatistics
18565. # Zone / Volume Statistics and Display
18566. 		
18567. 	# Accumulate Totals
18568.   	# Script: ZoneDoVolumeTotals
18569. 
18570. /* Current total space used (by Zones and Gaps) */
18571. 
18572. SetVariable(VolumeZoneUsed, GapUsed)
18573. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
18574. /* Percentage */
18575. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
18576. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
18577. 
18578. /* Current total of free space requested */
18579. 
18580. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
18581. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18582. /* Percent. */
18583. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
18584. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18585. 
18586. /* Current total of free space used */
18587. 
18588. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
18589. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
18590. /* Percent */
18591. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
18592. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
18593. 
18594. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
18595. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
18596. /* Xinclude "..\DebugDisplayPause.MyDc"X */
18597. 
18598. 
18599. 	# Current Values
18600. 	# Script: ZoneDoCurrentSet
18601. 
18602. # Cluster, Sector, Block adjust for display.
18603. 	# Bytes per cluster is volume specific.
18604. 
18605. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
18606. 
18607. # Current Zone values.
18608. 	# Begin, end and size.
18609. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
18610. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
18611. 
18612. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
18613. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
18614. 
18615. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
18616. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
18617. 
18618. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
18619. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
18620. 
18621. 	SetVariable(ZoneFragments,				"!ZONE210N!")
18622. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
18623. 		
18624. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
18625. /* identical code to here: (separation not needed. TEST.) */	
18626. 
18627. # Current Gap, Actual and Free Values
18628. 	# Gap
18629. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
18630. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
18631. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
18632. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
18633. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
18634. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
18635. 	
18636. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
18637. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
18638. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
18639. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
18640. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
18641. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
18642. 	
18643. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
18644. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
18645. 	
18646. 	# Actual Size and End
18647. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
18648. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
18649. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
18650. 	
18651. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
18652. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
18653. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
18654. 
18655. # Gap Size & Rounding
18656. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
18657. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
18658. 	
18659. 	# Free Space
18660. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
18661. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
18662. 
18663. 	# Footer:
18664. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
18665. # 2021-11-17 21:08:28
18666. 
18667. SetVariable(ZoneFooter1, "----------------------------------------------------------
18668. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
18669. #
18670. # Xinclude "..\Commands\DateTimeLastLong.txt"X
18671. #
18672. SetVariable(ZoneFooter2, "Statistics Report:
18673. ------------------
18674.    Size:  
18675.    ------------------------
18676.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18677.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18678.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18679. 
18680.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18681.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18682. 
18683.    Location:
18684.    ------------------------
18685.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18686.             Files End: !ZoneEndCurrent!
18687.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18688.       
18689.    Gap Settings:
18690.    ------------------------
18691.          Gap Requested: !ZoneGapSizePer!%
18692.        Volume Rounding: !ZoneVolRoundUpPer!%
18693.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18694.                  
18695.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
18696.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
18697.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
18698.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
18699.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
18700.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
18701.      
18702.    Free Space after Zone:
18703.    ------------------------
18704.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18705.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18706.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18707. 
18708. Directory and Files Select:
18709. ---------------------------
18710. !ZoneTypeSelectCurrent!               
18711. ---------------------------
18712. ----------------------------------------------------------
18713. ")
18714. 
18715. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
18716. 
18717. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
18718. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
18719. RunProgram("..\Commands\WriteDateTime.bat LastZone")
18720. 
18721. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
18722. 
18723. 
18724. 	# Zone Footer Set Statistics Window Text
18725. 
18726. SetStatisticsWindowText("!Heading!
18727. ----------------------------------------------------------
18728. Zones Processed: 
18729. ----------------------------------------------------------
18730. !ZoneListByLine!
18731. ----------------------------------------------------------
18732. Zone Processing Step:
18733. !ZoneStepByLine!    
18734. ----------------------------------------------------------
18735. ----------------------------------------------------------
18736. Current Zone:
18737. !ZoneFooter!
18738. ----------------------------------------------------------
18739. ----------------------------------------------------------
18740. Volume Statistics:
18741. !VolumeStatisticsDetail!
18742. ----------------------------------------------------------
18743. ----------------------------------------------------------
18744. Zone Detailed Report:
18745. ----------------------------------------------------------
18746. !ZoneStatisticsDetail!
18747. ----------------------------------------------------------
18748. ")
18749. 
18750. 
18751. 	
18752.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
18753. 
18754. 	# Add Zone to list of zones for display.
18755. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
18756. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
18757. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
18758. 	# ??? Free Stats?
18759. 	# Footer:
18760. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
18761. # 2021-11-17 21:08:28
18762. 
18763. SetVariable(ZoneFooter1, "----------------------------------------------------------
18764. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
18765. #
18766. # Xinclude "..\Commands\DateTimeLastLong.txt"X
18767. #
18768. SetVariable(ZoneFooter2, "Statistics Report:
18769. ------------------
18770.    Size:  
18771.    ------------------------
18772.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18773.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18774.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18775. 
18776.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18777.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18778. 
18779.    Location:
18780.    ------------------------
18781.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18782.             Files End: !ZoneEndCurrent!
18783.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18784.       
18785.    Gap Settings:
18786.    ------------------------
18787.          Gap Requested: !ZoneGapSizePer!%
18788.        Volume Rounding: !ZoneVolRoundUpPer!%
18789.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18790.                  
18791.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
18792.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
18793.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
18794.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
18795.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
18796.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
18797.      
18798.    Free Space after Zone:
18799.    ------------------------
18800.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18801.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18802.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18803. 
18804. Directory and Files Select:
18805. ---------------------------
18806. !ZoneTypeSelectCurrent!               
18807. ---------------------------
18808. ----------------------------------------------------------
18809. ")
18810. 
18811. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
18812. 
18813. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
18814. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
18815. RunProgram("..\Commands\WriteDateTime.bat LastZone")
18816. 
18817. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
18818. 
18819. 
18820. 
18821. 	# Add Zone Details to Report.	
18822. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
18823. !ZoneFooter!")
18824. 
18825. 
18826. 	
18827. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
18828. 		# Script: DisplaySetFileStep
18829. 
18830. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18831. 
18832. /* add message and move to a new line. */
18833. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18834. ")
18835. 
18836. /* display the line. (hopefully.) */
18837. # Zone Footer Set Statistics Window Text
18838. 
18839. SetStatisticsWindowText("!Heading!
18840. ----------------------------------------------------------
18841. Zones Processed: 
18842. ----------------------------------------------------------
18843. !ZoneListByLine!
18844. ----------------------------------------------------------
18845. Zone Processing Step:
18846. !ZoneStepByLine!    
18847. ----------------------------------------------------------
18848. ----------------------------------------------------------
18849. Current Zone:
18850. !ZoneFooter!
18851. ----------------------------------------------------------
18852. ----------------------------------------------------------
18853. Volume Statistics:
18854. !VolumeStatisticsDetail!
18855. ----------------------------------------------------------
18856. ----------------------------------------------------------
18857. Zone Detailed Report:
18858. ----------------------------------------------------------
18859. !ZoneStatisticsDetail!
18860. ----------------------------------------------------------
18861. ")
18862. 
18863. 
18864. 
18865. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18866. 
18867. # Script: BannerSet
18868. 
18869. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18870. 
18871. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
18872. 
18873. Title('!Heading!')
18874. /* pause(1) */
18875. 
18876. /* NOTE: Can't round or truncate to integer precision. */
18877. 
18878. pause(1)
18879. 	
18880. 		SetVariable(MftZone, ZoneCurrent) 
18881. 
18882. 		# File Action - Type Os MFT - Regular - PlaceNtfsSystemFiles.
18883. PlaceNtfsSystemFiles(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes), MftSize * 0.1)
18884. 	
18885. 
18886.   		SetVariable(MftSize,ZoneSize) 
18887. 
18888. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
18889. 		# Script: DisplaySetFileStep
18890. 
18891. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18892. 
18893. /* add message and move to a new line. */
18894. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18895. ")
18896. 
18897. /* display the line. (hopefully.) */
18898. # Zone Footer Set Statistics Window Text
18899. 
18900. SetStatisticsWindowText("!Heading!
18901. ----------------------------------------------------------
18902. Zones Processed: 
18903. ----------------------------------------------------------
18904. !ZoneListByLine!
18905. ----------------------------------------------------------
18906. Zone Processing Step:
18907. !ZoneStepByLine!    
18908. ----------------------------------------------------------
18909. ----------------------------------------------------------
18910. Current Zone:
18911. !ZoneFooter!
18912. ----------------------------------------------------------
18913. ----------------------------------------------------------
18914. Volume Statistics:
18915. !VolumeStatisticsDetail!
18916. ----------------------------------------------------------
18917. ----------------------------------------------------------
18918. Zone Detailed Report:
18919. ----------------------------------------------------------
18920. !ZoneStatisticsDetail!
18921. ----------------------------------------------------------
18922. ")
18923. 
18924. 
18925. 
18926. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18927. 
18928. # Script: BannerSet
18929. 
18930. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
18931. 
18932. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
18933. 
18934. Title('!Heading!')
18935. /* pause(1) */
18936. 
18937. /* NOTE: Can't round or truncate to integer precision. */
18938. 
18939. pause(1)
18940.   	# Script: ZoneDoFooter
18941. 
18942. /* ---------------------------------------------------------- */
18943. # File Select
18944. 	# Select Statments
18945. # File Actions 
18946. 	# Standard or OS File Actions.
18947. 	# Resume...
18948. 	
18949. 	# your stuff HERE (X)... post zone (file) file actions code.
18950. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
18951. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18952. 		# (X)
18953. 		
18954. 		/* ??? Set window? */
18955. 	
18956. 	# ADD THE GAP
18957. # Vacate (good for diagnostics)
18958. # DoNotVacate - DO NOT Vacate (recommended)
18959. # DoNotVacate - DO NOT Vacate (recommended)
18960. 
18961. # Vacate
18962. /* AddGap(GapUsedLoc) */
18963. 
18964. # DO Not Vacate
18965. AddGap(GapUsedLoc, DoNotVacate) 
18966. 	
18967. 	
18968. # Script: GapZoneCommand
18969. # *** Moved to setting yours ***
18970. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
18971. # Controlled via settings commands
18972. # DoNotVacate - DO NOT Vacate (recommended)
18973. 
18974. # Vacate
18975. /* AddGap(GapUsedLoc) */
18976. 
18977. # DO Not Vacate
18978. AddGap(GapUsedLoc, DoNotVacate) 
18979. 	
18980. 	
18981. # Vacate /* AddGap(GapUsed) */
18982. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
18983. 	
18984. 
18985. 		
18986. # 
18987. FileEnd
18988. /* ---------------------------------------------------------- */
18989. 
18990. # your stuff HERE (X)... post zone (file) code.
18991. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
18992. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18993. 	# (X)
18994. 
18995. SetVariable(FileStepDescription,"Zone finished, reporting.")
18996. # Script: DisplaySetFileStep
18997. 
18998. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18999. 
19000. /* add message and move to a new line. */
19001. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19002. ")
19003. 
19004. /* display the line. (hopefully.) */
19005. # Zone Footer Set Statistics Window Text
19006. 
19007. SetStatisticsWindowText("!Heading!
19008. ----------------------------------------------------------
19009. Zones Processed: 
19010. ----------------------------------------------------------
19011. !ZoneListByLine!
19012. ----------------------------------------------------------
19013. Zone Processing Step:
19014. !ZoneStepByLine!    
19015. ----------------------------------------------------------
19016. ----------------------------------------------------------
19017. Current Zone:
19018. !ZoneFooter!
19019. ----------------------------------------------------------
19020. ----------------------------------------------------------
19021. Volume Statistics:
19022. !VolumeStatisticsDetail!
19023. ----------------------------------------------------------
19024. ----------------------------------------------------------
19025. Zone Detailed Report:
19026. ----------------------------------------------------------
19027. !ZoneStatisticsDetail!
19028. ----------------------------------------------------------
19029. ")
19030. 
19031. 
19032. 
19033. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19034. 
19035. # Script: BannerSet
19036. 
19037. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19038. 
19039. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
19040. 
19041. Title('!Heading!')
19042. /* pause(1) */
19043. 
19044. /* NOTE: Can't round or truncate to integer precision. */
19045. 
19046. pause(1)
19047. 
19048. # Script: ZoneWhenFinished
19049. 
19050. # Script: BannerSet
19051. 
19052. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19053. 
19054. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
19055. 
19056. Title('!Heading!')
19057. /* pause(1) */
19058. 
19059. /* NOTE: Can't round or truncate to integer precision. */
19060. 
19061. # Script: BannerLog
19062. 
19063. AppendLogfile("!LogFileName!", "!Title!")
19064. 
19065. 
19066. 
19067. # Zone Statistics	
19068. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
19069. 
19070. # Footer:
19071. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
19072. # 2021-11-17 21:08:28
19073. 
19074. SetVariable(ZoneFooter1, "----------------------------------------------------------
19075. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
19076. #
19077. # Xinclude "..\Commands\DateTimeLastLong.txt"X
19078. #
19079. SetVariable(ZoneFooter2, "Statistics Report:
19080. ------------------
19081.    Size:  
19082.    ------------------------
19083.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19084.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19085.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19086. 
19087.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19088.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19089. 
19090.    Location:
19091.    ------------------------
19092.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19093.             Files End: !ZoneEndCurrent!
19094.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19095.       
19096.    Gap Settings:
19097.    ------------------------
19098.          Gap Requested: !ZoneGapSizePer!%
19099.        Volume Rounding: !ZoneVolRoundUpPer!%
19100.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19101.                  
19102.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
19103.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
19104.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
19105.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
19106.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
19107.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
19108.      
19109.    Free Space after Zone:
19110.    ------------------------
19111.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19112.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19113.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19114. 
19115. Directory and Files Select:
19116. ---------------------------
19117. !ZoneTypeSelectCurrent!               
19118. ---------------------------
19119. ----------------------------------------------------------
19120. ")
19121. 
19122. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
19123. 
19124. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
19125. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
19126. RunProgram("..\Commands\WriteDateTime.bat LastZone")
19127. 
19128. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
19129. 
19130. 
19131. 
19132. AppendLogfile("!LogFileName!", ".")
19133. AppendLogfile("!LogFileName!", "!ZoneFooter!")
19134. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
19135. AppendLogfile("!LogFileName!", ".")
19136. 
19137. # Zone Footer Set Statistics Window Text
19138. 
19139. SetStatisticsWindowText("!Heading!
19140. ----------------------------------------------------------
19141. Zones Processed: 
19142. ----------------------------------------------------------
19143. !ZoneListByLine!
19144. ----------------------------------------------------------
19145. Zone Processing Step:
19146. !ZoneStepByLine!    
19147. ----------------------------------------------------------
19148. ----------------------------------------------------------
19149. Current Zone:
19150. !ZoneFooter!
19151. ----------------------------------------------------------
19152. ----------------------------------------------------------
19153. Volume Statistics:
19154. !VolumeStatisticsDetail!
19155. ----------------------------------------------------------
19156. ----------------------------------------------------------
19157. Zone Detailed Report:
19158. ----------------------------------------------------------
19159. !ZoneStatisticsDetail!
19160. ----------------------------------------------------------
19161. ")
19162. 
19163. 
19164. 
19165. /* pause() */
19166. /* pause() */
19167. 
19168. 
19169. 
19170. /* ---------------------------------------------------------- */
19171. 
19172.   
19173. /* ---------------------------------------------------------- */
19174. # DIR
19175. 
19176. # Script: DefragZoneTypeOsDir
19177. /* ---------------------------------------------------------- */
19178. SetVariable(ZoneLabel,				"DIR") // "5"
19179. SetVariable(ZoneDescription, 		"Directories.")
19180. SetVariable(ZoneCurrentAjust, 		2)
19181. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpDir!")
19182. SetVariable(ZoneGapSize, 			"!ZoneGapSizeDir!")
19183. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectOsDIR
19184. # DIR start.
19185. Directory(yes)
19186. # DIR end.
19187. ')
19188. 
19189. 	# Script: ZoneDoHeader
19190. 
19191. # Script: ZoneWhenStarted
19192. RunProgram("..\Commands\WriteDateTime.bat")
19193. 
19194. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
19195. # Script: DisplaySetZone
19196. 
19197. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
19198. SetVariable(FileStepDescription,	"")
19199. 
19200. SetVariable(ZoneStepByLine, 			"Zone started.
19201. ")
19202. 
19203. # Script: BannerDescriptionSet
19204. 
19205. # Script: BannerSet
19206. 
19207. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19208. 
19209. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
19210. 
19211. Title('!Heading!')
19212. /* pause(1) */
19213. 
19214. /* NOTE: Can't round or truncate to integer precision. */
19215. 
19216. # Script: BannerLog
19217. 
19218. AppendLogfile("!LogFileName!", "!Title!")
19219. 
19220. 
19221. 
19222. pause(1)
19223. 
19224. 
19225. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
19226. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
19227. 
19228. SetVariable(ZoneStepNoCurrent, 0)
19229. 
19230. 
19231. # Script: ZoneDoCurrentClear
19232. 
19233. SetVariable(ZoneTypeSelectCurrent, 		"")
19234. 
19235. SetVariable(ZoneBeginCurrent, 			0)
19236. SetVariable(ZoneBeginPerCurrent, 		0)
19237. SetVariable(ZoneEndCurrent, 			0)
19238. SetVariable(ZoneEndPerCurrent, 			0)
19239. 
19240. SetVariable(ZoneSizeCurrent,			0)
19241. SetVariable(ZoneSizePerCurrent,			0)
19242. 
19243. SetVariable(ZoneGapRequestedCurrent,	0)
19244. SetVariable(ZoneGapRoundedCurrent, 		0)
19245. SetVariable(ZoneGapAdjustedCurrent, 	0)
19246. SetVariable(ZoneGapAvailableCurrent, 	0)
19247. SetVariable(ZoneGapCurrent,				0)
19248. SetVariable(ZoneGapUsedCurrent, 		0)
19249. 
19250. SetVariable(ZoneGapActualCurrent, 		0)
19251. SetVariable(ZoneGapActualPerCurrent, 	0)
19252. 
19253. SetVariable(ZoneSizeActual, 			0)
19254. SetVariable(ZoneSizeActualCurrent,		0)
19255. 
19256. SetVariable(ZoneEndActual, 				0)
19257. SetVariable(ZoneEndActualCurrent,		0)			
19258. SetVariable(ZoneSizeActualPerCurrent, 	0)
19259.       
19260. SetVariable(ZoneFilesFolders,			0)
19261. SetVariable(ZoneFilesFoldersPer,		0) 
19262. 
19263. SetVariable(ZoneFragments,				0)
19264. SetVariable(ZoneFragmentsPer,			0) 
19265. 		
19266. SetVariable(ZoneEndActualCurrent, 		0)
19267. SetVariable(ZoneEndActualPerCurrent, 	0)
19268. 
19269. # Gap Calculation Methodology:
19270. 	# Requested
19271. 	SetVariable(GapRequested, 			0) 
19272. 	SetVariable(GapRequestedStd, 		0) 
19273. 	SetVariable(GapRequestedMft, 		0) 
19274. 	SetVariable(GapRequestedOs, 		0) 
19275. 	SetVariable(GapRequestedOriginal, 	0) 
19276. 	
19277. 	# Gap Adjustments
19278. 	SetVariable(GapRounded, 			0)
19279. 	# SetVariable(GapAdjusted, 			0)
19280. 	SetVariable(GapAvailable, 			0)
19281. 	SetVariable(GapCurrent, 			0)
19282. 	SetVariable(GapActual, 				0)
19283. 	SetVariable(GapUsed, 				0)
19284. 	
19285. 	# Gap Adjustments
19286. 	SetVariable(GapRoundedLoc, 			0)
19287. 	# SetVariable(GapAdjustedLoc, 		0)
19288. 	SetVariable(GapAvailableLoc, 		0)
19289. 	SetVariable(GapCurrentLoc, 			0)
19290. 	SetVariable(GapActualLoc,			0)
19291. 	SetVariable(GapUsedLoc,				0)
19292. 	
19293. 	# Space usage
19294. 	SetVariable(ZoneFreePerRequested, 	0)
19295. 	SetVariable(ZoneFreePerUsed, 		0)
19296. 
19297. # Gap Size & Rounding
19298. 	SetVariable(ZoneGapSizePer, 		0)
19299. 	SetVariable(ZoneVolRoundUpPer, 		0)
19300. 	
19301. 	# Free Space
19302. 	SetVariable(ZoneFreeUsedPer, 		0)
19303. 	SetVariable(ZoneFreeRequestedPer, 	0)
19304. 
19305. 
19306. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
19307. 
19308. # Footer:
19309. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
19310. # 2021-11-17 21:08:28
19311. 
19312. SetVariable(ZoneFooter1, "----------------------------------------------------------
19313. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
19314. #
19315. # Xinclude "..\Commands\DateTimeLastLong.txt"X
19316. #
19317. SetVariable(ZoneFooter2, "Statistics Report:
19318. ------------------
19319.    Size:  
19320.    ------------------------
19321.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19322.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19323.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19324. 
19325.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19326.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19327. 
19328.    Location:
19329.    ------------------------
19330.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19331.             Files End: !ZoneEndCurrent!
19332.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19333.       
19334.    Gap Settings:
19335.    ------------------------
19336.          Gap Requested: !ZoneGapSizePer!%
19337.        Volume Rounding: !ZoneVolRoundUpPer!%
19338.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19339.                  
19340.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
19341.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
19342.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
19343.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
19344.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
19345.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
19346.      
19347.    Free Space after Zone:
19348.    ------------------------
19349.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19350.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19351.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19352. 
19353. Directory and Files Select:
19354. ---------------------------
19355. !ZoneTypeSelectCurrent!               
19356. ---------------------------
19357. ----------------------------------------------------------
19358. ")
19359. 
19360. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
19361. 
19362. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
19363. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
19364. RunProgram("..\Commands\WriteDateTime.bat LastZone")
19365. 
19366. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
19367. 
19368. 
19369. 
19370. # Script: BannerSet
19371. 
19372. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19373. 
19374. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
19375. 
19376. Title('!Heading!')
19377. /* pause(1) */
19378. 
19379. /* NOTE: Can't round or truncate to integer precision. */
19380. 
19381. # Script: BannerLog
19382. 
19383. AppendLogfile("!LogFileName!", "!Title!")
19384. 
19385. 
19386. 
19387. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
19388. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
19389. 
19390. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
19391. 
19392. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:28")
19393. 
19394. # 2021-11-17 21:08:28 
19395. SetVariable(Temp9, DATETIME)
19396. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:03 !ZoneLabel! !ZoneDescription!")
19397. 
19398. SetVariable(ZoneListByLine, "!ZoneListByLine! 
19399. Zone: !ZoneNoCurrent! !Temp9! 0:00:03 !ZoneLabel! !ZoneDescription!")
19400. 
19401. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:03 !ZoneLabel! !ZoneDescription!")
19402. 
19403. 
19404. /* Fixed Zone Position Handling */
19405. /* Literal number: */
19406. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
19407. /* Percentage of disk: */
19408. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
19409. /* Gap */
19410. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
19411. 
19412. /* ---------------------------------------------------------- */
19413. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
19414. # Script: DisplaySetFileStep
19415. 
19416. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19417. 
19418. /* add message and move to a new line. */
19419. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19420. ")
19421. 
19422. /* display the line. (hopefully.) */
19423. # Zone Footer Set Statistics Window Text
19424. 
19425. SetStatisticsWindowText("!Heading!
19426. ----------------------------------------------------------
19427. Zones Processed: 
19428. ----------------------------------------------------------
19429. !ZoneListByLine!
19430. ----------------------------------------------------------
19431. Zone Processing Step:
19432. !ZoneStepByLine!    
19433. ----------------------------------------------------------
19434. ----------------------------------------------------------
19435. Current Zone:
19436. !ZoneFooter!
19437. ----------------------------------------------------------
19438. ----------------------------------------------------------
19439. Volume Statistics:
19440. !VolumeStatisticsDetail!
19441. ----------------------------------------------------------
19442. ----------------------------------------------------------
19443. Zone Detailed Report:
19444. ----------------------------------------------------------
19445. !ZoneStatisticsDetail!
19446. ----------------------------------------------------------
19447. ")
19448. 
19449. 
19450. 
19451. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19452. 
19453. # Script: BannerSet
19454. 
19455. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19456. 
19457. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
19458. 
19459. Title('!Heading!')
19460. /* pause(1) */
19461. 
19462. /* NOTE: Can't round or truncate to integer precision. */
19463. 
19464. pause(1)
19465. 
19466. # your stuff HERE (X)... pre file select code.
19467. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
19468. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19469. 	# (X)
19470. 
19471. FileSelect
19472. 
19473. 	# your stuff can't really go here (errors.)
19474. 	# maybe for some reason I don't know of...
19475. 	
19476. 	# Actions next...
19477. 	# Script: ZoneDo ZoneTypeSelectOsDIR
19478. # DIR start.
19479. Directory(yes)
19480. # DIR end.
19481. 
19482. 
19483. 	FileActions
19484. 	  		/* ---------------------------------------------------------- */
19485. 	# Gap
19486. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
19487. 		# Script: DisplaySetFileStep
19488. 
19489. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19490. 
19491. /* add message and move to a new line. */
19492. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19493. ")
19494. 
19495. /* display the line. (hopefully.) */
19496. # Zone Footer Set Statistics Window Text
19497. 
19498. SetStatisticsWindowText("!Heading!
19499. ----------------------------------------------------------
19500. Zones Processed: 
19501. ----------------------------------------------------------
19502. !ZoneListByLine!
19503. ----------------------------------------------------------
19504. Zone Processing Step:
19505. !ZoneStepByLine!    
19506. ----------------------------------------------------------
19507. ----------------------------------------------------------
19508. Current Zone:
19509. !ZoneFooter!
19510. ----------------------------------------------------------
19511. ----------------------------------------------------------
19512. Volume Statistics:
19513. !VolumeStatisticsDetail!
19514. ----------------------------------------------------------
19515. ----------------------------------------------------------
19516. Zone Detailed Report:
19517. ----------------------------------------------------------
19518. !ZoneStatisticsDetail!
19519. ----------------------------------------------------------
19520. ")
19521. 
19522. 
19523. 
19524. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19525. 
19526. # Script: BannerSet
19527. 
19528. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
19529. 
19530. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
19531. 
19532. Title('!Heading!')
19533. /* pause(1) */
19534. 
19535. /* NOTE: Can't round or truncate to integer precision. */
19536. 
19537. pause(1)
19538. 	
19539. 	# ACTUAL GAP
19540. 		/* AddGap Variant. */
19541. 	  	# Zone Do Gap
19542. # Gap Calculation Methods:
19543. 
19544. /* 1) Anything you need to add first. */
19545. /* empty */
19546. 
19547. /* ---------------------------------------------------------- */
19548. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
19549. 	# GapRequestedStd.
19550. 
19551. 		/* ---------------------------------------------------------- */
19552. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
19553. 
19554. 		# Gap Calculation Methods:
19555. 
19556. /* AddGap Variants */
19557. 
19558. 	/* Standard */
19559. 		# Gap Calculation Methods:
19560. 	/* AddGap Variants */
19561. 	/* Standard */
19562. 
19563. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
19564. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
19565. 
19566. 	SetVariable(GapRequested, GapRequestedStd)
19567. 	
19568. 
19569. 	/* MFT Low High Method */
19570. 		# Gap Calculation Methods:
19571. 	/* AddGap Variants */
19572. 	/* MFT Low High Method */
19573. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
19574. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
19575. 	SetVariable(GapRequested, GapRequestedMft)
19576. 	
19577. 
19578. 	/* OS Volume Type Method */
19579. 		# Gap Calculation Methods:
19580. 	/* AddGap Variants */
19581. 	/* OS Volume Type Method */
19582. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
19583. 	SetVariable(GapRequested, GapRequestedOs)
19584. 
19585. 
19586. 
19587. /* MakeGap Variants */
19588. 
19589. 	/* Original Os 1-3 + MFT 2 */
19590. 		# Gap Calculation Methods:
19591. 	/* MakeGap Variants */
19592. 	/* Original Os 1-3 + MFT 2 */
19593. 	/* plus MFT gap placed inline at the dividing zone. */
19594. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
19595. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
19596. 	SetVariable(GapRequested, GapRequestedOrig)
19597. 	
19598. 	
19599. /* Note: You could comment out the ones not in use */
19600. /* However having the data in the log is useful. */
19601. /* Therefore the following line is otherwise needed. */
19602. 
19603. /* Standard used */
19604. 
19605. SetVariable(GapRequested, GapRequestedStd)
19606. 
19607. # Gap Calculation Methods:
19608. 
19609. /* AddGap Variants */
19610. 	/* Standard */
19611. 	/* MFT Low High Method */
19612. 	/* OS Volume Type Method */
19613. 
19614. /* MakeGap Variants */
19615. 	/* Original Os 1-3 + MFT 2 */
19616. 
19617. /* Note: You could comment out the ones not in use */
19618. /* However having the data in the log is useful. */
19619. /* Therefore the following line is otherwise needed. */
19620. 
19621. /* Standard is used currently */
19622. 
19623. 
19624. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
19625. 
19626. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
19627. 
19628. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
19629. 
19630. /* ---------------------------------------------------------- */
19631. /* 3) SMALL ZONE ADJUSTMENT. */
19632. /* Gab cant be larger than half the Zone Size. */
19633. 
19634. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
19635. 	
19636. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
19637. 
19638. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
19639. 
19640. /* ---------------------------------------------------------- */
19641. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
19642. # Gap Adjustments.
19643. 
19644. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
19645. 	
19646. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
19647. 
19648. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
19649. 
19650. /* ---------------------------------------------------------- */
19651. # BYPASS THIS.
19652. 	/* This is definitely wrong. */
19653. 	/* The question is can we steal gap from the next zone */
19654. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
19655. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
19656. 		# Zone Overflow.
19657. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
19658. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
19659. 
19660. /* ---------------------------------------------------------- */
19661. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
19662. # Remaining free space available.
19663. 
19664. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
19665. 	
19666. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
19667. 
19668. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
19669. 
19670. /* ---------------------------------------------------------- */
19671. # CURRENT gap to use.
19672. 
19673. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
19674. 
19675. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
19676. 
19677. /* ---------------------------------------------------------- */
19678. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
19679. # Debugging.
19680. 
19681. 	SetVariable(GapUsed, GapCurrent) // for debugging
19682. 
19683. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
19684. 
19685. 		# Your code HERE
19686. 
19687. /* ---------------------------------------------------------- */
19688. /* 7) YOUR CODE. */
19689. # YOUR CODE HERE:
19690. 	# INPUT: GapCurrent or GapCurrentLoc
19691. 	# OUTPUT: GapUsed...
19692. 
19693. /* ---------------------------------------------------------- */
19694. # Gap Size.
19695. # Actual Size of Gap.
19696. 
19697. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
19698. 
19699. /* ---------------------------------------------------------- */
19700. /* xxxxxxxxxxxxxxxxxxxxxx */
19701. # ADD THE GAP
19702. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
19703. /* xxxxxxxxxxxxxxxxxxxxxx */
19704. 
19705. 	
19706. 	# Zone Statistics	
19707. 	# Script: ZoneDoStatistics
19708. # Zone / Volume Statistics and Display
19709. 		
19710. 	# Accumulate Totals
19711.   	# Script: ZoneDoVolumeTotals
19712. 
19713. /* Current total space used (by Zones and Gaps) */
19714. 
19715. SetVariable(VolumeZoneUsed, GapUsed)
19716. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
19717. /* Percentage */
19718. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
19719. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
19720. 
19721. /* Current total of free space requested */
19722. 
19723. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
19724. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
19725. /* Percent. */
19726. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
19727. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
19728. 
19729. /* Current total of free space used */
19730. 
19731. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
19732. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
19733. /* Percent */
19734. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
19735. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
19736. 
19737. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
19738. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
19739. /* Xinclude "..\DebugDisplayPause.MyDc"X */
19740. 
19741. 
19742. 	# Current Values
19743. 	# Script: ZoneDoCurrentSet
19744. 
19745. # Cluster, Sector, Block adjust for display.
19746. 	# Bytes per cluster is volume specific.
19747. 
19748. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
19749. 
19750. # Current Zone values.
19751. 	# Begin, end and size.
19752. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
19753. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
19754. 
19755. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
19756. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
19757. 
19758. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
19759. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
19760. 
19761. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
19762. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
19763. 
19764. 	SetVariable(ZoneFragments,				"!ZONE210N!")
19765. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
19766. 		
19767. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
19768. /* identical code to here: (separation not needed. TEST.) */	
19769. 
19770. # Current Gap, Actual and Free Values
19771. 	# Gap
19772. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
19773. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
19774. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
19775. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
19776. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
19777. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
19778. 	
19779. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
19780. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
19781. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
19782. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
19783. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
19784. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
19785. 	
19786. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
19787. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
19788. 	
19789. 	# Actual Size and End
19790. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
19791. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
19792. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
19793. 	
19794. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
19795. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
19796. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
19797. 
19798. # Gap Size & Rounding
19799. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
19800. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
19801. 	
19802. 	# Free Space
19803. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
19804. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
19805. 
19806. 	# Footer:
19807. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
19808. # 2021-11-17 21:08:29
19809. 
19810. SetVariable(ZoneFooter1, "----------------------------------------------------------
19811. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
19812. #
19813. # Xinclude "..\Commands\DateTimeLastLong.txt"X
19814. #
19815. SetVariable(ZoneFooter2, "Statistics Report:
19816. ------------------
19817.    Size:  
19818.    ------------------------
19819.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19820.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19821.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19822. 
19823.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19824.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19825. 
19826.    Location:
19827.    ------------------------
19828.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19829.             Files End: !ZoneEndCurrent!
19830.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19831.       
19832.    Gap Settings:
19833.    ------------------------
19834.          Gap Requested: !ZoneGapSizePer!%
19835.        Volume Rounding: !ZoneVolRoundUpPer!%
19836.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19837.                  
19838.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
19839.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
19840.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
19841.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
19842.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
19843.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
19844.      
19845.    Free Space after Zone:
19846.    ------------------------
19847.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19848.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19849.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19850. 
19851. Directory and Files Select:
19852. ---------------------------
19853. !ZoneTypeSelectCurrent!               
19854. ---------------------------
19855. ----------------------------------------------------------
19856. ")
19857. 
19858. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
19859. 
19860. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
19861. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
19862. RunProgram("..\Commands\WriteDateTime.bat LastZone")
19863. 
19864. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
19865. 
19866. 
19867. 	# Zone Footer Set Statistics Window Text
19868. 
19869. SetStatisticsWindowText("!Heading!
19870. ----------------------------------------------------------
19871. Zones Processed: 
19872. ----------------------------------------------------------
19873. !ZoneListByLine!
19874. ----------------------------------------------------------
19875. Zone Processing Step:
19876. !ZoneStepByLine!    
19877. ----------------------------------------------------------
19878. ----------------------------------------------------------
19879. Current Zone:
19880. !ZoneFooter!
19881. ----------------------------------------------------------
19882. ----------------------------------------------------------
19883. Volume Statistics:
19884. !VolumeStatisticsDetail!
19885. ----------------------------------------------------------
19886. ----------------------------------------------------------
19887. Zone Detailed Report:
19888. ----------------------------------------------------------
19889. !ZoneStatisticsDetail!
19890. ----------------------------------------------------------
19891. ")
19892. 
19893. 
19894. 	
19895.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
19896. 
19897. 	# Add Zone to list of zones for display.
19898. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
19899. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
19900. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
19901. 	# ??? Free Stats?
19902. 	# Footer:
19903. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
19904. # 2021-11-17 21:08:29
19905. 
19906. SetVariable(ZoneFooter1, "----------------------------------------------------------
19907. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
19908. #
19909. # Xinclude "..\Commands\DateTimeLastLong.txt"X
19910. #
19911. SetVariable(ZoneFooter2, "Statistics Report:
19912. ------------------
19913.    Size:  
19914.    ------------------------
19915.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19916.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19917.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19918. 
19919.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19920.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19921. 
19922.    Location:
19923.    ------------------------
19924.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19925.             Files End: !ZoneEndCurrent!
19926.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19927.       
19928.    Gap Settings:
19929.    ------------------------
19930.          Gap Requested: !ZoneGapSizePer!%
19931.        Volume Rounding: !ZoneVolRoundUpPer!%
19932.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19933.                  
19934.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
19935.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
19936.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
19937.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
19938.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
19939.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
19940.      
19941.    Free Space after Zone:
19942.    ------------------------
19943.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19944.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19945.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19946. 
19947. Directory and Files Select:
19948. ---------------------------
19949. !ZoneTypeSelectCurrent!               
19950. ---------------------------
19951. ----------------------------------------------------------
19952. ")
19953. 
19954. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
19955. 
19956. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
19957. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
19958. RunProgram("..\Commands\WriteDateTime.bat LastZone")
19959. 
19960. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
19961. 
19962. 
19963. 
19964. 	# Add Zone Details to Report.	
19965. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
19966. !ZoneFooter!")
19967. 
19968. 
19969. 	
19970. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
19971. 		# Script: DisplaySetFileStep
19972. 
19973. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19974. 
19975. /* add message and move to a new line. */
19976. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19977. ")
19978. 
19979. /* display the line. (hopefully.) */
19980. # Zone Footer Set Statistics Window Text
19981. 
19982. SetStatisticsWindowText("!Heading!
19983. ----------------------------------------------------------
19984. Zones Processed: 
19985. ----------------------------------------------------------
19986. !ZoneListByLine!
19987. ----------------------------------------------------------
19988. Zone Processing Step:
19989. !ZoneStepByLine!    
19990. ----------------------------------------------------------
19991. ----------------------------------------------------------
19992. Current Zone:
19993. !ZoneFooter!
19994. ----------------------------------------------------------
19995. ----------------------------------------------------------
19996. Volume Statistics:
19997. !VolumeStatisticsDetail!
19998. ----------------------------------------------------------
19999. ----------------------------------------------------------
20000. Zone Detailed Report:
20001. ----------------------------------------------------------
20002. !ZoneStatisticsDetail!
20003. ----------------------------------------------------------
20004. ")
20005. 
20006. 
20007. 
20008. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20009. 
20010. # Script: BannerSet
20011. 
20012. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20013. 
20014. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
20015. 
20016. Title('!Heading!')
20017. /* pause(1) */
20018. 
20019. /* NOTE: Can't round or truncate to integer precision. */
20020. 
20021. pause(1)
20022. 	
20023. 		# File Action - Type Os Dir - Regular -  SortByName.
20024. # File Action - SortByName BY 10
20025. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
20026. 	
20027. 
20028. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
20029. 		# Script: DisplaySetFileStep
20030. 
20031. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20032. 
20033. /* add message and move to a new line. */
20034. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20035. ")
20036. 
20037. /* display the line. (hopefully.) */
20038. # Zone Footer Set Statistics Window Text
20039. 
20040. SetStatisticsWindowText("!Heading!
20041. ----------------------------------------------------------
20042. Zones Processed: 
20043. ----------------------------------------------------------
20044. !ZoneListByLine!
20045. ----------------------------------------------------------
20046. Zone Processing Step:
20047. !ZoneStepByLine!    
20048. ----------------------------------------------------------
20049. ----------------------------------------------------------
20050. Current Zone:
20051. !ZoneFooter!
20052. ----------------------------------------------------------
20053. ----------------------------------------------------------
20054. Volume Statistics:
20055. !VolumeStatisticsDetail!
20056. ----------------------------------------------------------
20057. ----------------------------------------------------------
20058. Zone Detailed Report:
20059. ----------------------------------------------------------
20060. !ZoneStatisticsDetail!
20061. ----------------------------------------------------------
20062. ")
20063. 
20064. 
20065. 
20066. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20067. 
20068. # Script: BannerSet
20069. 
20070. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20071. 
20072. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
20073. 
20074. Title('!Heading!')
20075. /* pause(1) */
20076. 
20077. /* NOTE: Can't round or truncate to integer precision. */
20078. 
20079. pause(1)
20080. 	# Script: ZoneDoFooter
20081. 
20082. /* ---------------------------------------------------------- */
20083. # File Select
20084. 	# Select Statments
20085. # File Actions 
20086. 	# Standard or OS File Actions.
20087. 	# Resume...
20088. 	
20089. 	# your stuff HERE (X)... post zone (file) file actions code.
20090. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
20091. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20092. 		# (X)
20093. 		
20094. 		/* ??? Set window? */
20095. 	
20096. 	# ADD THE GAP
20097. # Vacate (good for diagnostics)
20098. # DoNotVacate - DO NOT Vacate (recommended)
20099. # DoNotVacate - DO NOT Vacate (recommended)
20100. 
20101. # Vacate
20102. /* AddGap(GapUsedLoc) */
20103. 
20104. # DO Not Vacate
20105. AddGap(GapUsedLoc, DoNotVacate) 
20106. 	
20107. 	
20108. # Script: GapZoneCommand
20109. # *** Moved to setting yours ***
20110. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
20111. # Controlled via settings commands
20112. # DoNotVacate - DO NOT Vacate (recommended)
20113. 
20114. # Vacate
20115. /* AddGap(GapUsedLoc) */
20116. 
20117. # DO Not Vacate
20118. AddGap(GapUsedLoc, DoNotVacate) 
20119. 	
20120. 	
20121. # Vacate /* AddGap(GapUsed) */
20122. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
20123. 	
20124. 
20125. 		
20126. # 
20127. FileEnd
20128. /* ---------------------------------------------------------- */
20129. 
20130. # your stuff HERE (X)... post zone (file) code.
20131. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
20132. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20133. 	# (X)
20134. 
20135. SetVariable(FileStepDescription,"Zone finished, reporting.")
20136. # Script: DisplaySetFileStep
20137. 
20138. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20139. 
20140. /* add message and move to a new line. */
20141. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20142. ")
20143. 
20144. /* display the line. (hopefully.) */
20145. # Zone Footer Set Statistics Window Text
20146. 
20147. SetStatisticsWindowText("!Heading!
20148. ----------------------------------------------------------
20149. Zones Processed: 
20150. ----------------------------------------------------------
20151. !ZoneListByLine!
20152. ----------------------------------------------------------
20153. Zone Processing Step:
20154. !ZoneStepByLine!    
20155. ----------------------------------------------------------
20156. ----------------------------------------------------------
20157. Current Zone:
20158. !ZoneFooter!
20159. ----------------------------------------------------------
20160. ----------------------------------------------------------
20161. Volume Statistics:
20162. !VolumeStatisticsDetail!
20163. ----------------------------------------------------------
20164. ----------------------------------------------------------
20165. Zone Detailed Report:
20166. ----------------------------------------------------------
20167. !ZoneStatisticsDetail!
20168. ----------------------------------------------------------
20169. ")
20170. 
20171. 
20172. 
20173. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20174. 
20175. # Script: BannerSet
20176. 
20177. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20178. 
20179. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
20180. 
20181. Title('!Heading!')
20182. /* pause(1) */
20183. 
20184. /* NOTE: Can't round or truncate to integer precision. */
20185. 
20186. pause(1)
20187. 
20188. # Script: ZoneWhenFinished
20189. 
20190. # Script: BannerSet
20191. 
20192. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20193. 
20194. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
20195. 
20196. Title('!Heading!')
20197. /* pause(1) */
20198. 
20199. /* NOTE: Can't round or truncate to integer precision. */
20200. 
20201. # Script: BannerLog
20202. 
20203. AppendLogfile("!LogFileName!", "!Title!")
20204. 
20205. 
20206. 
20207. # Zone Statistics	
20208. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
20209. 
20210. # Footer:
20211. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
20212. # 2021-11-17 21:08:29
20213. 
20214. SetVariable(ZoneFooter1, "----------------------------------------------------------
20215. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
20216. #
20217. # Xinclude "..\Commands\DateTimeLastLong.txt"X
20218. #
20219. SetVariable(ZoneFooter2, "Statistics Report:
20220. ------------------
20221.    Size:  
20222.    ------------------------
20223.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20224.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20225.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20226. 
20227.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20228.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20229. 
20230.    Location:
20231.    ------------------------
20232.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20233.             Files End: !ZoneEndCurrent!
20234.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20235.       
20236.    Gap Settings:
20237.    ------------------------
20238.          Gap Requested: !ZoneGapSizePer!%
20239.        Volume Rounding: !ZoneVolRoundUpPer!%
20240.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20241.                  
20242.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
20243.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
20244.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
20245.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
20246.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
20247.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
20248.      
20249.    Free Space after Zone:
20250.    ------------------------
20251.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20252.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20253.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20254. 
20255. Directory and Files Select:
20256. ---------------------------
20257. !ZoneTypeSelectCurrent!               
20258. ---------------------------
20259. ----------------------------------------------------------
20260. ")
20261. 
20262. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
20263. 
20264. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
20265. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
20266. RunProgram("..\Commands\WriteDateTime.bat LastZone")
20267. 
20268. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
20269. 
20270. 
20271. 
20272. AppendLogfile("!LogFileName!", ".")
20273. AppendLogfile("!LogFileName!", "!ZoneFooter!")
20274. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
20275. AppendLogfile("!LogFileName!", ".")
20276. 
20277. # Zone Footer Set Statistics Window Text
20278. 
20279. SetStatisticsWindowText("!Heading!
20280. ----------------------------------------------------------
20281. Zones Processed: 
20282. ----------------------------------------------------------
20283. !ZoneListByLine!
20284. ----------------------------------------------------------
20285. Zone Processing Step:
20286. !ZoneStepByLine!    
20287. ----------------------------------------------------------
20288. ----------------------------------------------------------
20289. Current Zone:
20290. !ZoneFooter!
20291. ----------------------------------------------------------
20292. ----------------------------------------------------------
20293. Volume Statistics:
20294. !VolumeStatisticsDetail!
20295. ----------------------------------------------------------
20296. ----------------------------------------------------------
20297. Zone Detailed Report:
20298. ----------------------------------------------------------
20299. !ZoneStatisticsDetail!
20300. ----------------------------------------------------------
20301. ")
20302. 
20303. 
20304. 
20305. /* pause() */
20306. /* pause() */
20307. 
20308. 
20309. 
20310. 
20311. /* Mft Method: MFT GAP HERE. */
20312. /* For fixed zone locations */
20313. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-11-17 21:08:28")
20314. /* MakeGap(MftGap, DoNotVacate) */
20315. /* ---------------------------------------------------------- */
20316. 
20317. 
20318. /* ---------------------------------------------------------- */
20319. /* Mft Method: MFT GAP HERE. */
20320. /* For fixed zone locations */
20321. WriteLogfile("!LogFileName! Volume !VolumenName! MftReport", "!MftReport!Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-11-17 21:08:28")
20322. /* MakeGap(MftGap, DoNotVacate) */
20323.   
20324. /* ---------------------------------------------------------- */
20325. # PageHiberDump
20326. 
20327. # You cannot move Pagefile or Hiberfil generally speaking.
20328. # This might work in safe mode with preparation.
20329. # Zone PageHiberDump.
20330. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
20331. 
20332. # Script: DefragZoneTypeOsPageHiberDump
20333. /* ---------------------------------------------------------- */
20334. # PageHiberDump
20335. # You cannot move Pagefile or Hiberfil generally speaking.
20336. # This might work in safe mode with preparation.
20337. # Zone PageHiberDump.
20338. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
20339. 
20340. 	SetVariable(ZoneLabel, 			"!ZoneLabelPageHiberDump!")
20341. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPageHiberDump!")
20342. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPageHiberDump!")
20343. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePageHiberDump!")
20344. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsPageHiberDump
20345. # PageHiberDump start.
20346. (
20347. # Os PageHiberDump start.
20348. (
20349.   FileName("DataStore.edb")
20350.   or FileName("DUMP*.*")
20351.   or FileName("Hiberfil.sys")
20352.   or FileName("MEMORY.DMP")
20353.   or FileName("Pagefile.sys")
20354. )
20355. # Os PageHiberDump end.
20356. 
20357. )
20358. # PageHiberDump end.
20359. ')
20360. 
20361. 		# Script: ZoneDoHeader
20362. 
20363. # Script: ZoneWhenStarted
20364. RunProgram("..\Commands\WriteDateTime.bat")
20365. 
20366. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
20367. # Script: DisplaySetZone
20368. 
20369. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
20370. SetVariable(FileStepDescription,	"")
20371. 
20372. SetVariable(ZoneStepByLine, 			"Zone started.
20373. ")
20374. 
20375. # Script: BannerDescriptionSet
20376. 
20377. # Script: BannerSet
20378. 
20379. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20380. 
20381. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
20382. 
20383. Title('!Heading!')
20384. /* pause(1) */
20385. 
20386. /* NOTE: Can't round or truncate to integer precision. */
20387. 
20388. # Script: BannerLog
20389. 
20390. AppendLogfile("!LogFileName!", "!Title!")
20391. 
20392. 
20393. 
20394. pause(1)
20395. 
20396. 
20397. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
20398. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
20399. 
20400. SetVariable(ZoneStepNoCurrent, 0)
20401. 
20402. 
20403. # Script: ZoneDoCurrentClear
20404. 
20405. SetVariable(ZoneTypeSelectCurrent, 		"")
20406. 
20407. SetVariable(ZoneBeginCurrent, 			0)
20408. SetVariable(ZoneBeginPerCurrent, 		0)
20409. SetVariable(ZoneEndCurrent, 			0)
20410. SetVariable(ZoneEndPerCurrent, 			0)
20411. 
20412. SetVariable(ZoneSizeCurrent,			0)
20413. SetVariable(ZoneSizePerCurrent,			0)
20414. 
20415. SetVariable(ZoneGapRequestedCurrent,	0)
20416. SetVariable(ZoneGapRoundedCurrent, 		0)
20417. SetVariable(ZoneGapAdjustedCurrent, 	0)
20418. SetVariable(ZoneGapAvailableCurrent, 	0)
20419. SetVariable(ZoneGapCurrent,				0)
20420. SetVariable(ZoneGapUsedCurrent, 		0)
20421. 
20422. SetVariable(ZoneGapActualCurrent, 		0)
20423. SetVariable(ZoneGapActualPerCurrent, 	0)
20424. 
20425. SetVariable(ZoneSizeActual, 			0)
20426. SetVariable(ZoneSizeActualCurrent,		0)
20427. 
20428. SetVariable(ZoneEndActual, 				0)
20429. SetVariable(ZoneEndActualCurrent,		0)			
20430. SetVariable(ZoneSizeActualPerCurrent, 	0)
20431.       
20432. SetVariable(ZoneFilesFolders,			0)
20433. SetVariable(ZoneFilesFoldersPer,		0) 
20434. 
20435. SetVariable(ZoneFragments,				0)
20436. SetVariable(ZoneFragmentsPer,			0) 
20437. 		
20438. SetVariable(ZoneEndActualCurrent, 		0)
20439. SetVariable(ZoneEndActualPerCurrent, 	0)
20440. 
20441. # Gap Calculation Methodology:
20442. 	# Requested
20443. 	SetVariable(GapRequested, 			0) 
20444. 	SetVariable(GapRequestedStd, 		0) 
20445. 	SetVariable(GapRequestedMft, 		0) 
20446. 	SetVariable(GapRequestedOs, 		0) 
20447. 	SetVariable(GapRequestedOriginal, 	0) 
20448. 	
20449. 	# Gap Adjustments
20450. 	SetVariable(GapRounded, 			0)
20451. 	# SetVariable(GapAdjusted, 			0)
20452. 	SetVariable(GapAvailable, 			0)
20453. 	SetVariable(GapCurrent, 			0)
20454. 	SetVariable(GapActual, 				0)
20455. 	SetVariable(GapUsed, 				0)
20456. 	
20457. 	# Gap Adjustments
20458. 	SetVariable(GapRoundedLoc, 			0)
20459. 	# SetVariable(GapAdjustedLoc, 		0)
20460. 	SetVariable(GapAvailableLoc, 		0)
20461. 	SetVariable(GapCurrentLoc, 			0)
20462. 	SetVariable(GapActualLoc,			0)
20463. 	SetVariable(GapUsedLoc,				0)
20464. 	
20465. 	# Space usage
20466. 	SetVariable(ZoneFreePerRequested, 	0)
20467. 	SetVariable(ZoneFreePerUsed, 		0)
20468. 
20469. # Gap Size & Rounding
20470. 	SetVariable(ZoneGapSizePer, 		0)
20471. 	SetVariable(ZoneVolRoundUpPer, 		0)
20472. 	
20473. 	# Free Space
20474. 	SetVariable(ZoneFreeUsedPer, 		0)
20475. 	SetVariable(ZoneFreeRequestedPer, 	0)
20476. 
20477. 
20478. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
20479. 
20480. # Footer:
20481. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
20482. # 2021-11-17 21:08:29
20483. 
20484. SetVariable(ZoneFooter1, "----------------------------------------------------------
20485. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
20486. #
20487. # Xinclude "..\Commands\DateTimeLastLong.txt"X
20488. #
20489. SetVariable(ZoneFooter2, "Statistics Report:
20490. ------------------
20491.    Size:  
20492.    ------------------------
20493.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20494.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20495.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20496. 
20497.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20498.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20499. 
20500.    Location:
20501.    ------------------------
20502.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20503.             Files End: !ZoneEndCurrent!
20504.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20505.       
20506.    Gap Settings:
20507.    ------------------------
20508.          Gap Requested: !ZoneGapSizePer!%
20509.        Volume Rounding: !ZoneVolRoundUpPer!%
20510.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20511.                  
20512.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
20513.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
20514.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
20515.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
20516.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
20517.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
20518.      
20519.    Free Space after Zone:
20520.    ------------------------
20521.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20522.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20523.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20524. 
20525. Directory and Files Select:
20526. ---------------------------
20527. !ZoneTypeSelectCurrent!               
20528. ---------------------------
20529. ----------------------------------------------------------
20530. ")
20531. 
20532. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
20533. 
20534. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
20535. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
20536. RunProgram("..\Commands\WriteDateTime.bat LastZone")
20537. 
20538. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
20539. 
20540. 
20541. 
20542. # Script: BannerSet
20543. 
20544. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20545. 
20546. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
20547. 
20548. Title('!Heading!')
20549. /* pause(1) */
20550. 
20551. /* NOTE: Can't round or truncate to integer precision. */
20552. 
20553. # Script: BannerLog
20554. 
20555. AppendLogfile("!LogFileName!", "!Title!")
20556. 
20557. 
20558. 
20559. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
20560. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
20561. 
20562. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
20563. 
20564. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:29")
20565. 
20566. # 2021-11-17 21:08:29 
20567. SetVariable(Temp9, DATETIME)
20568. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:04 !ZoneLabel! !ZoneDescription!")
20569. 
20570. SetVariable(ZoneListByLine, "!ZoneListByLine! 
20571. Zone: !ZoneNoCurrent! !Temp9! 0:00:04 !ZoneLabel! !ZoneDescription!")
20572. 
20573. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:04 !ZoneLabel! !ZoneDescription!")
20574. 
20575. 
20576. /* Fixed Zone Position Handling */
20577. /* Literal number: */
20578. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
20579. /* Percentage of disk: */
20580. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
20581. /* Gap */
20582. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
20583. 
20584. /* ---------------------------------------------------------- */
20585. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
20586. # Script: DisplaySetFileStep
20587. 
20588. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20589. 
20590. /* add message and move to a new line. */
20591. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20592. ")
20593. 
20594. /* display the line. (hopefully.) */
20595. # Zone Footer Set Statistics Window Text
20596. 
20597. SetStatisticsWindowText("!Heading!
20598. ----------------------------------------------------------
20599. Zones Processed: 
20600. ----------------------------------------------------------
20601. !ZoneListByLine!
20602. ----------------------------------------------------------
20603. Zone Processing Step:
20604. !ZoneStepByLine!    
20605. ----------------------------------------------------------
20606. ----------------------------------------------------------
20607. Current Zone:
20608. !ZoneFooter!
20609. ----------------------------------------------------------
20610. ----------------------------------------------------------
20611. Volume Statistics:
20612. !VolumeStatisticsDetail!
20613. ----------------------------------------------------------
20614. ----------------------------------------------------------
20615. Zone Detailed Report:
20616. ----------------------------------------------------------
20617. !ZoneStatisticsDetail!
20618. ----------------------------------------------------------
20619. ")
20620. 
20621. 
20622. 
20623. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20624. 
20625. # Script: BannerSet
20626. 
20627. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20628. 
20629. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
20630. 
20631. Title('!Heading!')
20632. /* pause(1) */
20633. 
20634. /* NOTE: Can't round or truncate to integer precision. */
20635. 
20636. pause(1)
20637. 
20638. # your stuff HERE (X)... pre file select code.
20639. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
20640. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20641. 	# (X)
20642. 
20643. FileSelect
20644. 
20645. 	# your stuff can't really go here (errors.)
20646. 	# maybe for some reason I don't know of...
20647. 	
20648. 	# Actions next...
20649. 		# Script: ZoneDo ZoneTypeSelectOsPageHiberDump
20650. # PageHiberDump start.
20651. (
20652. # Os PageHiberDump start.
20653. (
20654.   FileName("DataStore.edb")
20655.   or FileName("DUMP*.*")
20656.   or FileName("Hiberfil.sys")
20657.   or FileName("MEMORY.DMP")
20658.   or FileName("Pagefile.sys")
20659. )
20660. # Os PageHiberDump end.
20661. 
20662. )
20663. # PageHiberDump end.
20664. 
20665. 		
20666. 		FileActions
20667. 		  		/* ---------------------------------------------------------- */
20668. 	# Gap
20669. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
20670. 		# Script: DisplaySetFileStep
20671. 
20672. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20673. 
20674. /* add message and move to a new line. */
20675. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20676. ")
20677. 
20678. /* display the line. (hopefully.) */
20679. # Zone Footer Set Statistics Window Text
20680. 
20681. SetStatisticsWindowText("!Heading!
20682. ----------------------------------------------------------
20683. Zones Processed: 
20684. ----------------------------------------------------------
20685. !ZoneListByLine!
20686. ----------------------------------------------------------
20687. Zone Processing Step:
20688. !ZoneStepByLine!    
20689. ----------------------------------------------------------
20690. ----------------------------------------------------------
20691. Current Zone:
20692. !ZoneFooter!
20693. ----------------------------------------------------------
20694. ----------------------------------------------------------
20695. Volume Statistics:
20696. !VolumeStatisticsDetail!
20697. ----------------------------------------------------------
20698. ----------------------------------------------------------
20699. Zone Detailed Report:
20700. ----------------------------------------------------------
20701. !ZoneStatisticsDetail!
20702. ----------------------------------------------------------
20703. ")
20704. 
20705. 
20706. 
20707. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20708. 
20709. # Script: BannerSet
20710. 
20711. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
20712. 
20713. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
20714. 
20715. Title('!Heading!')
20716. /* pause(1) */
20717. 
20718. /* NOTE: Can't round or truncate to integer precision. */
20719. 
20720. pause(1)
20721. 	
20722. 	# ACTUAL GAP
20723. 		/* AddGap Variant. */
20724. 	  	# Zone Do Gap
20725. # Gap Calculation Methods:
20726. 
20727. /* 1) Anything you need to add first. */
20728. /* empty */
20729. 
20730. /* ---------------------------------------------------------- */
20731. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
20732. 	# GapRequestedStd.
20733. 
20734. 		/* ---------------------------------------------------------- */
20735. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
20736. 
20737. 		# Gap Calculation Methods:
20738. 
20739. /* AddGap Variants */
20740. 
20741. 	/* Standard */
20742. 		# Gap Calculation Methods:
20743. 	/* AddGap Variants */
20744. 	/* Standard */
20745. 
20746. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
20747. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
20748. 
20749. 	SetVariable(GapRequested, GapRequestedStd)
20750. 	
20751. 
20752. 	/* MFT Low High Method */
20753. 		# Gap Calculation Methods:
20754. 	/* AddGap Variants */
20755. 	/* MFT Low High Method */
20756. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
20757. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
20758. 	SetVariable(GapRequested, GapRequestedMft)
20759. 	
20760. 
20761. 	/* OS Volume Type Method */
20762. 		# Gap Calculation Methods:
20763. 	/* AddGap Variants */
20764. 	/* OS Volume Type Method */
20765. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
20766. 	SetVariable(GapRequested, GapRequestedOs)
20767. 
20768. 
20769. 
20770. /* MakeGap Variants */
20771. 
20772. 	/* Original Os 1-3 + MFT 2 */
20773. 		# Gap Calculation Methods:
20774. 	/* MakeGap Variants */
20775. 	/* Original Os 1-3 + MFT 2 */
20776. 	/* plus MFT gap placed inline at the dividing zone. */
20777. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
20778. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
20779. 	SetVariable(GapRequested, GapRequestedOrig)
20780. 	
20781. 	
20782. /* Note: You could comment out the ones not in use */
20783. /* However having the data in the log is useful. */
20784. /* Therefore the following line is otherwise needed. */
20785. 
20786. /* Standard used */
20787. 
20788. SetVariable(GapRequested, GapRequestedStd)
20789. 
20790. # Gap Calculation Methods:
20791. 
20792. /* AddGap Variants */
20793. 	/* Standard */
20794. 	/* MFT Low High Method */
20795. 	/* OS Volume Type Method */
20796. 
20797. /* MakeGap Variants */
20798. 	/* Original Os 1-3 + MFT 2 */
20799. 
20800. /* Note: You could comment out the ones not in use */
20801. /* However having the data in the log is useful. */
20802. /* Therefore the following line is otherwise needed. */
20803. 
20804. /* Standard is used currently */
20805. 
20806. 
20807. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
20808. 
20809. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
20810. 
20811. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
20812. 
20813. /* ---------------------------------------------------------- */
20814. /* 3) SMALL ZONE ADJUSTMENT. */
20815. /* Gab cant be larger than half the Zone Size. */
20816. 
20817. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
20818. 	
20819. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
20820. 
20821. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
20822. 
20823. /* ---------------------------------------------------------- */
20824. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
20825. # Gap Adjustments.
20826. 
20827. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
20828. 	
20829. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
20830. 
20831. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
20832. 
20833. /* ---------------------------------------------------------- */
20834. # BYPASS THIS.
20835. 	/* This is definitely wrong. */
20836. 	/* The question is can we steal gap from the next zone */
20837. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
20838. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
20839. 		# Zone Overflow.
20840. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
20841. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
20842. 
20843. /* ---------------------------------------------------------- */
20844. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
20845. # Remaining free space available.
20846. 
20847. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
20848. 	
20849. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
20850. 
20851. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
20852. 
20853. /* ---------------------------------------------------------- */
20854. # CURRENT gap to use.
20855. 
20856. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
20857. 
20858. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
20859. 
20860. /* ---------------------------------------------------------- */
20861. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
20862. # Debugging.
20863. 
20864. 	SetVariable(GapUsed, GapCurrent) // for debugging
20865. 
20866. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
20867. 
20868. 		# Your code HERE
20869. 
20870. /* ---------------------------------------------------------- */
20871. /* 7) YOUR CODE. */
20872. # YOUR CODE HERE:
20873. 	# INPUT: GapCurrent or GapCurrentLoc
20874. 	# OUTPUT: GapUsed...
20875. 
20876. /* ---------------------------------------------------------- */
20877. # Gap Size.
20878. # Actual Size of Gap.
20879. 
20880. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
20881. 
20882. /* ---------------------------------------------------------- */
20883. /* xxxxxxxxxxxxxxxxxxxxxx */
20884. # ADD THE GAP
20885. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
20886. /* xxxxxxxxxxxxxxxxxxxxxx */
20887. 
20888. 	
20889. 	# Zone Statistics	
20890. 	# Script: ZoneDoStatistics
20891. # Zone / Volume Statistics and Display
20892. 		
20893. 	# Accumulate Totals
20894.   	# Script: ZoneDoVolumeTotals
20895. 
20896. /* Current total space used (by Zones and Gaps) */
20897. 
20898. SetVariable(VolumeZoneUsed, GapUsed)
20899. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
20900. /* Percentage */
20901. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
20902. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
20903. 
20904. /* Current total of free space requested */
20905. 
20906. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
20907. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
20908. /* Percent. */
20909. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
20910. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
20911. 
20912. /* Current total of free space used */
20913. 
20914. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
20915. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
20916. /* Percent */
20917. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
20918. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
20919. 
20920. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
20921. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
20922. /* Xinclude "..\DebugDisplayPause.MyDc"X */
20923. 
20924. 
20925. 	# Current Values
20926. 	# Script: ZoneDoCurrentSet
20927. 
20928. # Cluster, Sector, Block adjust for display.
20929. 	# Bytes per cluster is volume specific.
20930. 
20931. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
20932. 
20933. # Current Zone values.
20934. 	# Begin, end and size.
20935. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
20936. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
20937. 
20938. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
20939. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
20940. 
20941. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
20942. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
20943. 
20944. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
20945. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
20946. 
20947. 	SetVariable(ZoneFragments,				"!ZONE210N!")
20948. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
20949. 		
20950. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
20951. /* identical code to here: (separation not needed. TEST.) */	
20952. 
20953. # Current Gap, Actual and Free Values
20954. 	# Gap
20955. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
20956. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
20957. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
20958. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
20959. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
20960. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
20961. 	
20962. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
20963. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
20964. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
20965. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
20966. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
20967. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
20968. 	
20969. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
20970. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
20971. 	
20972. 	# Actual Size and End
20973. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
20974. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
20975. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
20976. 	
20977. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
20978. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
20979. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
20980. 
20981. # Gap Size & Rounding
20982. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
20983. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
20984. 	
20985. 	# Free Space
20986. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
20987. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
20988. 
20989. 	# Footer:
20990. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
20991. # 2021-11-17 21:08:29
20992. 
20993. SetVariable(ZoneFooter1, "----------------------------------------------------------
20994. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
20995. #
20996. # Xinclude "..\Commands\DateTimeLastLong.txt"X
20997. #
20998. SetVariable(ZoneFooter2, "Statistics Report:
20999. ------------------
21000.    Size:  
21001.    ------------------------
21002.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21003.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21004.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21005. 
21006.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21007.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21008. 
21009.    Location:
21010.    ------------------------
21011.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21012.             Files End: !ZoneEndCurrent!
21013.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21014.       
21015.    Gap Settings:
21016.    ------------------------
21017.          Gap Requested: !ZoneGapSizePer!%
21018.        Volume Rounding: !ZoneVolRoundUpPer!%
21019.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21020.                  
21021.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
21022.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
21023.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
21024.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
21025.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
21026.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
21027.      
21028.    Free Space after Zone:
21029.    ------------------------
21030.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21031.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21032.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21033. 
21034. Directory and Files Select:
21035. ---------------------------
21036. !ZoneTypeSelectCurrent!               
21037. ---------------------------
21038. ----------------------------------------------------------
21039. ")
21040. 
21041. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
21042. 
21043. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
21044. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
21045. RunProgram("..\Commands\WriteDateTime.bat LastZone")
21046. 
21047. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
21048. 
21049. 
21050. 	# Zone Footer Set Statistics Window Text
21051. 
21052. SetStatisticsWindowText("!Heading!
21053. ----------------------------------------------------------
21054. Zones Processed: 
21055. ----------------------------------------------------------
21056. !ZoneListByLine!
21057. ----------------------------------------------------------
21058. Zone Processing Step:
21059. !ZoneStepByLine!    
21060. ----------------------------------------------------------
21061. ----------------------------------------------------------
21062. Current Zone:
21063. !ZoneFooter!
21064. ----------------------------------------------------------
21065. ----------------------------------------------------------
21066. Volume Statistics:
21067. !VolumeStatisticsDetail!
21068. ----------------------------------------------------------
21069. ----------------------------------------------------------
21070. Zone Detailed Report:
21071. ----------------------------------------------------------
21072. !ZoneStatisticsDetail!
21073. ----------------------------------------------------------
21074. ")
21075. 
21076. 
21077. 	
21078.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
21079. 
21080. 	# Add Zone to list of zones for display.
21081. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
21082. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
21083. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
21084. 	# ??? Free Stats?
21085. 	# Footer:
21086. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
21087. # 2021-11-17 21:08:29
21088. 
21089. SetVariable(ZoneFooter1, "----------------------------------------------------------
21090. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
21091. #
21092. # Xinclude "..\Commands\DateTimeLastLong.txt"X
21093. #
21094. SetVariable(ZoneFooter2, "Statistics Report:
21095. ------------------
21096.    Size:  
21097.    ------------------------
21098.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21099.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21100.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21101. 
21102.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21103.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21104. 
21105.    Location:
21106.    ------------------------
21107.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21108.             Files End: !ZoneEndCurrent!
21109.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21110.       
21111.    Gap Settings:
21112.    ------------------------
21113.          Gap Requested: !ZoneGapSizePer!%
21114.        Volume Rounding: !ZoneVolRoundUpPer!%
21115.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21116.                  
21117.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
21118.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
21119.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
21120.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
21121.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
21122.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
21123.      
21124.    Free Space after Zone:
21125.    ------------------------
21126.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21127.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21128.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21129. 
21130. Directory and Files Select:
21131. ---------------------------
21132. !ZoneTypeSelectCurrent!               
21133. ---------------------------
21134. ----------------------------------------------------------
21135. ")
21136. 
21137. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
21138. 
21139. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
21140. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
21141. RunProgram("..\Commands\WriteDateTime.bat LastZone")
21142. 
21143. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
21144. 
21145. 
21146. 
21147. 	# Add Zone Details to Report.	
21148. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
21149. !ZoneFooter!")
21150. 
21151. 
21152. 	
21153. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
21154. 			# Script: DisplaySetFileStep
21155. 
21156. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21157. 
21158. /* add message and move to a new line. */
21159. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21160. ")
21161. 
21162. /* display the line. (hopefully.) */
21163. # Zone Footer Set Statistics Window Text
21164. 
21165. SetStatisticsWindowText("!Heading!
21166. ----------------------------------------------------------
21167. Zones Processed: 
21168. ----------------------------------------------------------
21169. !ZoneListByLine!
21170. ----------------------------------------------------------
21171. Zone Processing Step:
21172. !ZoneStepByLine!    
21173. ----------------------------------------------------------
21174. ----------------------------------------------------------
21175. Current Zone:
21176. !ZoneFooter!
21177. ----------------------------------------------------------
21178. ----------------------------------------------------------
21179. Volume Statistics:
21180. !VolumeStatisticsDetail!
21181. ----------------------------------------------------------
21182. ----------------------------------------------------------
21183. Zone Detailed Report:
21184. ----------------------------------------------------------
21185. !ZoneStatisticsDetail!
21186. ----------------------------------------------------------
21187. ")
21188. 
21189. 
21190. 
21191. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21192. 
21193. # Script: BannerSet
21194. 
21195. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21196. 
21197. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
21198. 
21199. Title('!Heading!')
21200. /* pause(1) */
21201. 
21202. /* NOTE: Can't round or truncate to integer precision. */
21203. 
21204. pause(1)
21205. 
21206. 			# File Action - Type Page Hiber Dump - Regular - SortByImportSequenceSkip.
21207. # File Action - SortByImportSequence with SkipBlock.
21208. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
21209. 	
21210. 	
21211. 
21212. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
21213. 		# Script: DisplaySetFileStep
21214. 
21215. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21216. 
21217. /* add message and move to a new line. */
21218. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21219. ")
21220. 
21221. /* display the line. (hopefully.) */
21222. # Zone Footer Set Statistics Window Text
21223. 
21224. SetStatisticsWindowText("!Heading!
21225. ----------------------------------------------------------
21226. Zones Processed: 
21227. ----------------------------------------------------------
21228. !ZoneListByLine!
21229. ----------------------------------------------------------
21230. Zone Processing Step:
21231. !ZoneStepByLine!    
21232. ----------------------------------------------------------
21233. ----------------------------------------------------------
21234. Current Zone:
21235. !ZoneFooter!
21236. ----------------------------------------------------------
21237. ----------------------------------------------------------
21238. Volume Statistics:
21239. !VolumeStatisticsDetail!
21240. ----------------------------------------------------------
21241. ----------------------------------------------------------
21242. Zone Detailed Report:
21243. ----------------------------------------------------------
21244. !ZoneStatisticsDetail!
21245. ----------------------------------------------------------
21246. ")
21247. 
21248. 
21249. 
21250. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21251. 
21252. # Script: BannerSet
21253. 
21254. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21255. 
21256. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
21257. 
21258. Title('!Heading!')
21259. /* pause(1) */
21260. 
21261. /* NOTE: Can't round or truncate to integer precision. */
21262. 
21263. pause(1)
21264. 
21265. 		# Script: ZoneDoFooter
21266. 
21267. /* ---------------------------------------------------------- */
21268. # File Select
21269. 	# Select Statments
21270. # File Actions 
21271. 	# Standard or OS File Actions.
21272. 	# Resume...
21273. 	
21274. 	# your stuff HERE (X)... post zone (file) file actions code.
21275. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
21276. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21277. 		# (X)
21278. 		
21279. 		/* ??? Set window? */
21280. 	
21281. 	# ADD THE GAP
21282. # Vacate (good for diagnostics)
21283. # DoNotVacate - DO NOT Vacate (recommended)
21284. # DoNotVacate - DO NOT Vacate (recommended)
21285. 
21286. # Vacate
21287. /* AddGap(GapUsedLoc) */
21288. 
21289. # DO Not Vacate
21290. AddGap(GapUsedLoc, DoNotVacate) 
21291. 	
21292. 	
21293. # Script: GapZoneCommand
21294. # *** Moved to setting yours ***
21295. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
21296. # Controlled via settings commands
21297. # DoNotVacate - DO NOT Vacate (recommended)
21298. 
21299. # Vacate
21300. /* AddGap(GapUsedLoc) */
21301. 
21302. # DO Not Vacate
21303. AddGap(GapUsedLoc, DoNotVacate) 
21304. 	
21305. 	
21306. # Vacate /* AddGap(GapUsed) */
21307. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
21308. 	
21309. 
21310. 		
21311. # 
21312. FileEnd
21313. /* ---------------------------------------------------------- */
21314. 
21315. # your stuff HERE (X)... post zone (file) code.
21316. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
21317. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21318. 	# (X)
21319. 
21320. SetVariable(FileStepDescription,"Zone finished, reporting.")
21321. # Script: DisplaySetFileStep
21322. 
21323. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21324. 
21325. /* add message and move to a new line. */
21326. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21327. ")
21328. 
21329. /* display the line. (hopefully.) */
21330. # Zone Footer Set Statistics Window Text
21331. 
21332. SetStatisticsWindowText("!Heading!
21333. ----------------------------------------------------------
21334. Zones Processed: 
21335. ----------------------------------------------------------
21336. !ZoneListByLine!
21337. ----------------------------------------------------------
21338. Zone Processing Step:
21339. !ZoneStepByLine!    
21340. ----------------------------------------------------------
21341. ----------------------------------------------------------
21342. Current Zone:
21343. !ZoneFooter!
21344. ----------------------------------------------------------
21345. ----------------------------------------------------------
21346. Volume Statistics:
21347. !VolumeStatisticsDetail!
21348. ----------------------------------------------------------
21349. ----------------------------------------------------------
21350. Zone Detailed Report:
21351. ----------------------------------------------------------
21352. !ZoneStatisticsDetail!
21353. ----------------------------------------------------------
21354. ")
21355. 
21356. 
21357. 
21358. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21359. 
21360. # Script: BannerSet
21361. 
21362. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21363. 
21364. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
21365. 
21366. Title('!Heading!')
21367. /* pause(1) */
21368. 
21369. /* NOTE: Can't round or truncate to integer precision. */
21370. 
21371. pause(1)
21372. 
21373. # Script: ZoneWhenFinished
21374. 
21375. # Script: BannerSet
21376. 
21377. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21378. 
21379. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
21380. 
21381. Title('!Heading!')
21382. /* pause(1) */
21383. 
21384. /* NOTE: Can't round or truncate to integer precision. */
21385. 
21386. # Script: BannerLog
21387. 
21388. AppendLogfile("!LogFileName!", "!Title!")
21389. 
21390. 
21391. 
21392. # Zone Statistics	
21393. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
21394. 
21395. # Footer:
21396. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
21397. # 2021-11-17 21:08:29
21398. 
21399. SetVariable(ZoneFooter1, "----------------------------------------------------------
21400. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
21401. #
21402. # Xinclude "..\Commands\DateTimeLastLong.txt"X
21403. #
21404. SetVariable(ZoneFooter2, "Statistics Report:
21405. ------------------
21406.    Size:  
21407.    ------------------------
21408.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21409.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21410.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21411. 
21412.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21413.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21414. 
21415.    Location:
21416.    ------------------------
21417.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21418.             Files End: !ZoneEndCurrent!
21419.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21420.       
21421.    Gap Settings:
21422.    ------------------------
21423.          Gap Requested: !ZoneGapSizePer!%
21424.        Volume Rounding: !ZoneVolRoundUpPer!%
21425.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21426.                  
21427.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
21428.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
21429.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
21430.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
21431.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
21432.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
21433.      
21434.    Free Space after Zone:
21435.    ------------------------
21436.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21437.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21438.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21439. 
21440. Directory and Files Select:
21441. ---------------------------
21442. !ZoneTypeSelectCurrent!               
21443. ---------------------------
21444. ----------------------------------------------------------
21445. ")
21446. 
21447. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
21448. 
21449. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
21450. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
21451. RunProgram("..\Commands\WriteDateTime.bat LastZone")
21452. 
21453. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
21454. 
21455. 
21456. 
21457. AppendLogfile("!LogFileName!", ".")
21458. AppendLogfile("!LogFileName!", "!ZoneFooter!")
21459. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
21460. AppendLogfile("!LogFileName!", ".")
21461. 
21462. # Zone Footer Set Statistics Window Text
21463. 
21464. SetStatisticsWindowText("!Heading!
21465. ----------------------------------------------------------
21466. Zones Processed: 
21467. ----------------------------------------------------------
21468. !ZoneListByLine!
21469. ----------------------------------------------------------
21470. Zone Processing Step:
21471. !ZoneStepByLine!    
21472. ----------------------------------------------------------
21473. ----------------------------------------------------------
21474. Current Zone:
21475. !ZoneFooter!
21476. ----------------------------------------------------------
21477. ----------------------------------------------------------
21478. Volume Statistics:
21479. !VolumeStatisticsDetail!
21480. ----------------------------------------------------------
21481. ----------------------------------------------------------
21482. Zone Detailed Report:
21483. ----------------------------------------------------------
21484. !ZoneStatisticsDetail!
21485. ----------------------------------------------------------
21486. ")
21487. 
21488. 
21489. 
21490. /* pause() */
21491. /* pause() */
21492. 
21493. 
21494. 
21495. /* ---------------------------------------------------------- */
21496.   
21497. AppendLogfile("!LogFileName!","!MftReport!")
21498. 
21499. /* ---------------------------------------------------------- */
21500. 
21501. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
21502. 
21503. /* ---------------------------------------------------------- */
21504. /* Zone 15 Games */
21505. # Script: DisplayColors - Zone Dark
21506. # Processed
21507. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
21508. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
21509. 
21510. # Light Green and Yellow
21511. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
21512. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
21513. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
21514. 
21515. # Script: DefragZoneTypeGames
21516. /* ---------------------------------------------------------- */
21517. /* Zone Games */
21518. SetVariable(ZoneLabel, "!ZoneLabelGames!")
21519. SetVariable(ZoneDescription, "!ZoneDescriptionGames!")
21520. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpGames!")
21521. SetVariable(ZoneGapSize, "!ZoneGapSizeGames!")
21522. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectGames
21523. # Games start.
21524. # NotBlobsArchivesBu start.
21525. (not (
21526. # Blobs start.
21527. (
21528. # BlobsAndExceptions start.
21529. ( not(
21530.   FileName("*.bat")
21531.   or FileName("*.css")
21532.   or FileName("*.dll")
21533.   or FileName("*.exe")
21534.   or FileName("*.htm*")
21535.   or FileName("*.jar")
21536.   or FileName("*.js")
21537.   or FileName("*.script")
21538.   or FileName("*.wsf")
21539.   or (
21540. # Databases start.
21541. (
21542.   FileName("*.crypt*")
21543.   or FileName("*.db*")
21544.   or FileName("*.rdb*")
21545.   or FileName("*.dc*")
21546.   or FileName("*.dict*")
21547.   or FileName("*.?db*")
21548.   or FileName("*.?rdb*")
21549.   or FileName("*.md*")
21550.   or FileName("*.myd")
21551.   or FileName("*.ndf")
21552.   or FileName("*.ns?")
21553.   or FileName("*.pab")
21554.   or FileName("*.pst")
21555.   or FileName("*.sd?*")
21556.   or FileName("*.sq**")
21557.   or FileName("*.tmd")
21558.   or FileName("*.tps")
21559.   or FileName("*.tr*")
21560. )
21561. # Databases end.
21562. 
21563.     # BlobsAndExceptions
21564.     or 
21565. # Data start.
21566. (
21567.   DirectoryName("Data*")
21568.   or DirectoryName("Device*")
21569.   or DirectoryName("Export*")
21570.   or DirectoryName("Import*")
21571.   or DirectoryName("Log*")
21572.   or DirectoryName("*Log")
21573.   or DirectoryName("Maintenance*")
21574.   or DirectoryName("Rec*")
21575.   or DirectoryName("Sales*")
21576.   or DirectoryName("Search*")
21577.   or DirectoryName("User*")
21578. )
21579. # Data end.
21580. 
21581.     # BlobsAndExceptions
21582.   )
21583. ) )
21584. # BlobsAndExceptions end.
21585. 
21586. # Blobs
21587. ) and (
21588.   Size(BlobFileSize,0)
21589.   or (
21590.     FileName("*.arj")
21591.     or FileName("*.bup")
21592.     or FileName("*.bz2")
21593.     or FileName("*.chm")
21594.     or FileName("*.dvr-ms")
21595.     or FileName("*.gz")
21596.     or FileName("*.ifo")
21597.     or FileName("*.lzh")
21598.     or FileName("*.pdf")
21599.     or FileName("*.rpm")
21600.     or FileName("*.wmv")
21601.     or FileName("*.vob")
21602.     or FileName("*.z")
21603.   ) 
21604. )
21605. # Blobs end.
21606. 
21607. # NotBlobsArchivesBu
21608. or 
21609. # Archives start.
21610. (
21611.   DirectoryName("*Archive*")
21612.   or DirectoryName("*History*")
21613.   or DirectoryName("*Old")
21614.   or DirectoryName("* Old *")
21615.   or DirectoryName("Old *")
21616. 
21617.   or FileName("*.7z")
21618.   or FileName("*.cab")
21619.   or FileName("*.iso")
21620.   or FileName("*.msi")
21621.   or FileName("*.old")
21622.   or FileName("*.rar")
21623.   or FileName("*.tar")
21624.   or FileName("*.zip")
21625.   or
21626. # WinSysLow start.
21627. (
21628.   # Bad idea. This pushed lots of programs and data to archive.
21629.   # DirectoryName("$*")
21630.   # or DirectoryName("0*")
21631.   # or DirectoryName("1*")
21632.   # or DirectoryName("2*")
21633.   # or DirectoryName("3*")
21634.   # or DirectoryName("4*")
21635.   # or DirectoryName("5*")
21636.   # or DirectoryName("6*")
21637.   # or DirectoryName("7*")
21638.   # or DirectoryName("8*")
21639.   # or DirectoryName("9*")
21640.   # or 
21641.   DirectoryName("dllcache")
21642.   or DirectoryName("Downloaded Installations")
21643.   or DirectoryName("Ehome")
21644.   or DirectoryName("Fonts")
21645.   or DirectoryName("Help")
21646.   or DirectoryName("I386")
21647.   or DirectoryName("ie?updates")
21648.   or DirectoryName("Installer")
21649.   or DirectoryName("Installshield Installation Information")
21650.   or DirectoryName("IME")
21651.   or DirectoryName("*RECYCLE*")
21652.   or DirectoryName("ServicePackFiles")
21653.   or DirectoryName("SoftwareDistribution")
21654.   or DirectoryName("Speech")
21655.   or DirectoryName("Symbols")
21656.   or DirectoryName("System Volume Information")
21657.   or DirectoryName("windows.old")
21658. )
21659. # WinSysLow end.
21660. 
21661.   # Archives
21662. )
21663. # Archives end.
21664. 
21665. # NotBlobsArchivesBu
21666. or
21667. # Backups start.
21668. (
21669.   DirectoryName("*Backup*")
21670.   or DirectoryName("*Bu")
21671.   or DirectoryName("* Bu *")
21672.   or DirectoryName("Bu *")
21673. 
21674.   or FileName("*.bak")
21675.   or FileName("* - Copy*")
21676. )
21677. # Backups end.
21678. 
21679. # NotBlobsArchivesBu
21680. ) )
21681. # NotBlobsArchivesBu end.
21682. 
21683. # People
21684. and (
21685. # Games start.
21686. (
21687.   DirectoryName("Game*")
21688.   or DirectoryName("Epic*")
21689.   or DirectoryName("*XBox*")
21690.   or DirectoryName("*PS2*")
21691. )
21692. # Games end.
21693. 
21694. # People
21695. )
21696. # People end.
21697. ')
21698. 
21699. 	# Script: ZoneDoHeader
21700. 
21701. # Script: ZoneWhenStarted
21702. RunProgram("..\Commands\WriteDateTime.bat")
21703. 
21704. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
21705. # Script: DisplaySetZone
21706. 
21707. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
21708. SetVariable(FileStepDescription,	"")
21709. 
21710. SetVariable(ZoneStepByLine, 			"Zone started.
21711. ")
21712. 
21713. # Script: BannerDescriptionSet
21714. 
21715. # Script: BannerSet
21716. 
21717. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21718. 
21719. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
21720. 
21721. Title('!Heading!')
21722. /* pause(1) */
21723. 
21724. /* NOTE: Can't round or truncate to integer precision. */
21725. 
21726. # Script: BannerLog
21727. 
21728. AppendLogfile("!LogFileName!", "!Title!")
21729. 
21730. 
21731. 
21732. pause(1)
21733. 
21734. 
21735. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
21736. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
21737. 
21738. SetVariable(ZoneStepNoCurrent, 0)
21739. 
21740. 
21741. # Script: ZoneDoCurrentClear
21742. 
21743. SetVariable(ZoneTypeSelectCurrent, 		"")
21744. 
21745. SetVariable(ZoneBeginCurrent, 			0)
21746. SetVariable(ZoneBeginPerCurrent, 		0)
21747. SetVariable(ZoneEndCurrent, 			0)
21748. SetVariable(ZoneEndPerCurrent, 			0)
21749. 
21750. SetVariable(ZoneSizeCurrent,			0)
21751. SetVariable(ZoneSizePerCurrent,			0)
21752. 
21753. SetVariable(ZoneGapRequestedCurrent,	0)
21754. SetVariable(ZoneGapRoundedCurrent, 		0)
21755. SetVariable(ZoneGapAdjustedCurrent, 	0)
21756. SetVariable(ZoneGapAvailableCurrent, 	0)
21757. SetVariable(ZoneGapCurrent,				0)
21758. SetVariable(ZoneGapUsedCurrent, 		0)
21759. 
21760. SetVariable(ZoneGapActualCurrent, 		0)
21761. SetVariable(ZoneGapActualPerCurrent, 	0)
21762. 
21763. SetVariable(ZoneSizeActual, 			0)
21764. SetVariable(ZoneSizeActualCurrent,		0)
21765. 
21766. SetVariable(ZoneEndActual, 				0)
21767. SetVariable(ZoneEndActualCurrent,		0)			
21768. SetVariable(ZoneSizeActualPerCurrent, 	0)
21769.       
21770. SetVariable(ZoneFilesFolders,			0)
21771. SetVariable(ZoneFilesFoldersPer,		0) 
21772. 
21773. SetVariable(ZoneFragments,				0)
21774. SetVariable(ZoneFragmentsPer,			0) 
21775. 		
21776. SetVariable(ZoneEndActualCurrent, 		0)
21777. SetVariable(ZoneEndActualPerCurrent, 	0)
21778. 
21779. # Gap Calculation Methodology:
21780. 	# Requested
21781. 	SetVariable(GapRequested, 			0) 
21782. 	SetVariable(GapRequestedStd, 		0) 
21783. 	SetVariable(GapRequestedMft, 		0) 
21784. 	SetVariable(GapRequestedOs, 		0) 
21785. 	SetVariable(GapRequestedOriginal, 	0) 
21786. 	
21787. 	# Gap Adjustments
21788. 	SetVariable(GapRounded, 			0)
21789. 	# SetVariable(GapAdjusted, 			0)
21790. 	SetVariable(GapAvailable, 			0)
21791. 	SetVariable(GapCurrent, 			0)
21792. 	SetVariable(GapActual, 				0)
21793. 	SetVariable(GapUsed, 				0)
21794. 	
21795. 	# Gap Adjustments
21796. 	SetVariable(GapRoundedLoc, 			0)
21797. 	# SetVariable(GapAdjustedLoc, 		0)
21798. 	SetVariable(GapAvailableLoc, 		0)
21799. 	SetVariable(GapCurrentLoc, 			0)
21800. 	SetVariable(GapActualLoc,			0)
21801. 	SetVariable(GapUsedLoc,				0)
21802. 	
21803. 	# Space usage
21804. 	SetVariable(ZoneFreePerRequested, 	0)
21805. 	SetVariable(ZoneFreePerUsed, 		0)
21806. 
21807. # Gap Size & Rounding
21808. 	SetVariable(ZoneGapSizePer, 		0)
21809. 	SetVariable(ZoneVolRoundUpPer, 		0)
21810. 	
21811. 	# Free Space
21812. 	SetVariable(ZoneFreeUsedPer, 		0)
21813. 	SetVariable(ZoneFreeRequestedPer, 	0)
21814. 
21815. 
21816. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
21817. 
21818. # Footer:
21819. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
21820. # 2021-11-17 21:08:29
21821. 
21822. SetVariable(ZoneFooter1, "----------------------------------------------------------
21823. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
21824. #
21825. # Xinclude "..\Commands\DateTimeLastLong.txt"X
21826. #
21827. SetVariable(ZoneFooter2, "Statistics Report:
21828. ------------------
21829.    Size:  
21830.    ------------------------
21831.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21832.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21833.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21834. 
21835.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21836.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21837. 
21838.    Location:
21839.    ------------------------
21840.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21841.             Files End: !ZoneEndCurrent!
21842.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21843.       
21844.    Gap Settings:
21845.    ------------------------
21846.          Gap Requested: !ZoneGapSizePer!%
21847.        Volume Rounding: !ZoneVolRoundUpPer!%
21848.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21849.                  
21850.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
21851.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
21852.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
21853.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
21854.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
21855.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
21856.      
21857.    Free Space after Zone:
21858.    ------------------------
21859.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21860.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21861.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21862. 
21863. Directory and Files Select:
21864. ---------------------------
21865. !ZoneTypeSelectCurrent!               
21866. ---------------------------
21867. ----------------------------------------------------------
21868. ")
21869. 
21870. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
21871. 
21872. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
21873. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
21874. RunProgram("..\Commands\WriteDateTime.bat LastZone")
21875. 
21876. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
21877. 
21878. 
21879. 
21880. # Script: BannerSet
21881. 
21882. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21883. 
21884. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
21885. 
21886. Title('!Heading!')
21887. /* pause(1) */
21888. 
21889. /* NOTE: Can't round or truncate to integer precision. */
21890. 
21891. # Script: BannerLog
21892. 
21893. AppendLogfile("!LogFileName!", "!Title!")
21894. 
21895. 
21896. 
21897. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
21898. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
21899. 
21900. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
21901. 
21902. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:29")
21903. 
21904. # 2021-11-17 21:08:29 
21905. SetVariable(Temp9, DATETIME)
21906. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:04 !ZoneLabel! !ZoneDescription!")
21907. 
21908. SetVariable(ZoneListByLine, "!ZoneListByLine! 
21909. Zone: !ZoneNoCurrent! !Temp9! 0:00:04 !ZoneLabel! !ZoneDescription!")
21910. 
21911. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:04 !ZoneLabel! !ZoneDescription!")
21912. 
21913. 
21914. /* Fixed Zone Position Handling */
21915. /* Literal number: */
21916. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
21917. /* Percentage of disk: */
21918. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
21919. /* Gap */
21920. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
21921. 
21922. /* ---------------------------------------------------------- */
21923. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
21924. # Script: DisplaySetFileStep
21925. 
21926. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21927. 
21928. /* add message and move to a new line. */
21929. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21930. ")
21931. 
21932. /* display the line. (hopefully.) */
21933. # Zone Footer Set Statistics Window Text
21934. 
21935. SetStatisticsWindowText("!Heading!
21936. ----------------------------------------------------------
21937. Zones Processed: 
21938. ----------------------------------------------------------
21939. !ZoneListByLine!
21940. ----------------------------------------------------------
21941. Zone Processing Step:
21942. !ZoneStepByLine!    
21943. ----------------------------------------------------------
21944. ----------------------------------------------------------
21945. Current Zone:
21946. !ZoneFooter!
21947. ----------------------------------------------------------
21948. ----------------------------------------------------------
21949. Volume Statistics:
21950. !VolumeStatisticsDetail!
21951. ----------------------------------------------------------
21952. ----------------------------------------------------------
21953. Zone Detailed Report:
21954. ----------------------------------------------------------
21955. !ZoneStatisticsDetail!
21956. ----------------------------------------------------------
21957. ")
21958. 
21959. 
21960. 
21961. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21962. 
21963. # Script: BannerSet
21964. 
21965. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
21966. 
21967. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
21968. 
21969. Title('!Heading!')
21970. /* pause(1) */
21971. 
21972. /* NOTE: Can't round or truncate to integer precision. */
21973. 
21974. pause(1)
21975. 
21976. # your stuff HERE (X)... pre file select code.
21977. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
21978. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21979. 	# (X)
21980. 
21981. FileSelect
21982. 
21983. 	# your stuff can't really go here (errors.)
21984. 	# maybe for some reason I don't know of...
21985. 	
21986. 	# Actions next...
21987. 	# Script: ZoneDo ZoneTypeSelectGames
21988. # Games start.
21989. # NotBlobsArchivesBu start.
21990. (not (
21991. # Blobs start.
21992. (
21993. # BlobsAndExceptions start.
21994. ( not(
21995.   FileName("*.bat")
21996.   or FileName("*.css")
21997.   or FileName("*.dll")
21998.   or FileName("*.exe")
21999.   or FileName("*.htm*")
22000.   or FileName("*.jar")
22001.   or FileName("*.js")
22002.   or FileName("*.script")
22003.   or FileName("*.wsf")
22004.   or (
22005. # Databases start.
22006. (
22007.   FileName("*.crypt*")
22008.   or FileName("*.db*")
22009.   or FileName("*.rdb*")
22010.   or FileName("*.dc*")
22011.   or FileName("*.dict*")
22012.   or FileName("*.?db*")
22013.   or FileName("*.?rdb*")
22014.   or FileName("*.md*")
22015.   or FileName("*.myd")
22016.   or FileName("*.ndf")
22017.   or FileName("*.ns?")
22018.   or FileName("*.pab")
22019.   or FileName("*.pst")
22020.   or FileName("*.sd?*")
22021.   or FileName("*.sq**")
22022.   or FileName("*.tmd")
22023.   or FileName("*.tps")
22024.   or FileName("*.tr*")
22025. )
22026. # Databases end.
22027. 
22028.     # BlobsAndExceptions
22029.     or 
22030. # Data start.
22031. (
22032.   DirectoryName("Data*")
22033.   or DirectoryName("Device*")
22034.   or DirectoryName("Export*")
22035.   or DirectoryName("Import*")
22036.   or DirectoryName("Log*")
22037.   or DirectoryName("*Log")
22038.   or DirectoryName("Maintenance*")
22039.   or DirectoryName("Rec*")
22040.   or DirectoryName("Sales*")
22041.   or DirectoryName("Search*")
22042.   or DirectoryName("User*")
22043. )
22044. # Data end.
22045. 
22046.     # BlobsAndExceptions
22047.   )
22048. ) )
22049. # BlobsAndExceptions end.
22050. 
22051. # Blobs
22052. ) and (
22053.   Size(BlobFileSize,0)
22054.   or (
22055.     FileName("*.arj")
22056.     or FileName("*.bup")
22057.     or FileName("*.bz2")
22058.     or FileName("*.chm")
22059.     or FileName("*.dvr-ms")
22060.     or FileName("*.gz")
22061.     or FileName("*.ifo")
22062.     or FileName("*.lzh")
22063.     or FileName("*.pdf")
22064.     or FileName("*.rpm")
22065.     or FileName("*.wmv")
22066.     or FileName("*.vob")
22067.     or FileName("*.z")
22068.   ) 
22069. )
22070. # Blobs end.
22071. 
22072. # NotBlobsArchivesBu
22073. or 
22074. # Archives start.
22075. (
22076.   DirectoryName("*Archive*")
22077.   or DirectoryName("*History*")
22078.   or DirectoryName("*Old")
22079.   or DirectoryName("* Old *")
22080.   or DirectoryName("Old *")
22081. 
22082.   or FileName("*.7z")
22083.   or FileName("*.cab")
22084.   or FileName("*.iso")
22085.   or FileName("*.msi")
22086.   or FileName("*.old")
22087.   or FileName("*.rar")
22088.   or FileName("*.tar")
22089.   or FileName("*.zip")
22090.   or
22091. # WinSysLow start.
22092. (
22093.   # Bad idea. This pushed lots of programs and data to archive.
22094.   # DirectoryName("$*")
22095.   # or DirectoryName("0*")
22096.   # or DirectoryName("1*")
22097.   # or DirectoryName("2*")
22098.   # or DirectoryName("3*")
22099.   # or DirectoryName("4*")
22100.   # or DirectoryName("5*")
22101.   # or DirectoryName("6*")
22102.   # or DirectoryName("7*")
22103.   # or DirectoryName("8*")
22104.   # or DirectoryName("9*")
22105.   # or 
22106.   DirectoryName("dllcache")
22107.   or DirectoryName("Downloaded Installations")
22108.   or DirectoryName("Ehome")
22109.   or DirectoryName("Fonts")
22110.   or DirectoryName("Help")
22111.   or DirectoryName("I386")
22112.   or DirectoryName("ie?updates")
22113.   or DirectoryName("Installer")
22114.   or DirectoryName("Installshield Installation Information")
22115.   or DirectoryName("IME")
22116.   or DirectoryName("*RECYCLE*")
22117.   or DirectoryName("ServicePackFiles")
22118.   or DirectoryName("SoftwareDistribution")
22119.   or DirectoryName("Speech")
22120.   or DirectoryName("Symbols")
22121.   or DirectoryName("System Volume Information")
22122.   or DirectoryName("windows.old")
22123. )
22124. # WinSysLow end.
22125. 
22126.   # Archives
22127. )
22128. # Archives end.
22129. 
22130. # NotBlobsArchivesBu
22131. or
22132. # Backups start.
22133. (
22134.   DirectoryName("*Backup*")
22135.   or DirectoryName("*Bu")
22136.   or DirectoryName("* Bu *")
22137.   or DirectoryName("Bu *")
22138. 
22139.   or FileName("*.bak")
22140.   or FileName("* - Copy*")
22141. )
22142. # Backups end.
22143. 
22144. # NotBlobsArchivesBu
22145. ) )
22146. # NotBlobsArchivesBu end.
22147. 
22148. # People
22149. and (
22150. # Games start.
22151. (
22152.   DirectoryName("Game*")
22153.   or DirectoryName("Epic*")
22154.   or DirectoryName("*XBox*")
22155.   or DirectoryName("*PS2*")
22156. )
22157. # Games end.
22158. 
22159. # People
22160. )
22161. # People end.
22162. 
22163. 	# Script: ZoneDoAction
22164. # Zone Do File Action - SortByName.
22165. 
22166. FileActions
22167. 
22168. 		/* ---------------------------------------------------------- */
22169. 	# Gap
22170. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
22171. 		# Script: DisplaySetFileStep
22172. 
22173. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22174. 
22175. /* add message and move to a new line. */
22176. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22177. ")
22178. 
22179. /* display the line. (hopefully.) */
22180. # Zone Footer Set Statistics Window Text
22181. 
22182. SetStatisticsWindowText("!Heading!
22183. ----------------------------------------------------------
22184. Zones Processed: 
22185. ----------------------------------------------------------
22186. !ZoneListByLine!
22187. ----------------------------------------------------------
22188. Zone Processing Step:
22189. !ZoneStepByLine!    
22190. ----------------------------------------------------------
22191. ----------------------------------------------------------
22192. Current Zone:
22193. !ZoneFooter!
22194. ----------------------------------------------------------
22195. ----------------------------------------------------------
22196. Volume Statistics:
22197. !VolumeStatisticsDetail!
22198. ----------------------------------------------------------
22199. ----------------------------------------------------------
22200. Zone Detailed Report:
22201. ----------------------------------------------------------
22202. !ZoneStatisticsDetail!
22203. ----------------------------------------------------------
22204. ")
22205. 
22206. 
22207. 
22208. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22209. 
22210. # Script: BannerSet
22211. 
22212. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22213. 
22214. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
22215. 
22216. Title('!Heading!')
22217. /* pause(1) */
22218. 
22219. /* NOTE: Can't round or truncate to integer precision. */
22220. 
22221. pause(1)
22222. 	
22223. 	# ACTUAL GAP
22224. 		/* AddGap Variant. */
22225. 	  	# Zone Do Gap
22226. # Gap Calculation Methods:
22227. 
22228. /* 1) Anything you need to add first. */
22229. /* empty */
22230. 
22231. /* ---------------------------------------------------------- */
22232. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
22233. 	# GapRequestedStd.
22234. 
22235. 		/* ---------------------------------------------------------- */
22236. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
22237. 
22238. 		# Gap Calculation Methods:
22239. 
22240. /* AddGap Variants */
22241. 
22242. 	/* Standard */
22243. 		# Gap Calculation Methods:
22244. 	/* AddGap Variants */
22245. 	/* Standard */
22246. 
22247. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
22248. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
22249. 
22250. 	SetVariable(GapRequested, GapRequestedStd)
22251. 	
22252. 
22253. 	/* MFT Low High Method */
22254. 		# Gap Calculation Methods:
22255. 	/* AddGap Variants */
22256. 	/* MFT Low High Method */
22257. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
22258. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
22259. 	SetVariable(GapRequested, GapRequestedMft)
22260. 	
22261. 
22262. 	/* OS Volume Type Method */
22263. 		# Gap Calculation Methods:
22264. 	/* AddGap Variants */
22265. 	/* OS Volume Type Method */
22266. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
22267. 	SetVariable(GapRequested, GapRequestedOs)
22268. 
22269. 
22270. 
22271. /* MakeGap Variants */
22272. 
22273. 	/* Original Os 1-3 + MFT 2 */
22274. 		# Gap Calculation Methods:
22275. 	/* MakeGap Variants */
22276. 	/* Original Os 1-3 + MFT 2 */
22277. 	/* plus MFT gap placed inline at the dividing zone. */
22278. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
22279. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
22280. 	SetVariable(GapRequested, GapRequestedOrig)
22281. 	
22282. 	
22283. /* Note: You could comment out the ones not in use */
22284. /* However having the data in the log is useful. */
22285. /* Therefore the following line is otherwise needed. */
22286. 
22287. /* Standard used */
22288. 
22289. SetVariable(GapRequested, GapRequestedStd)
22290. 
22291. # Gap Calculation Methods:
22292. 
22293. /* AddGap Variants */
22294. 	/* Standard */
22295. 	/* MFT Low High Method */
22296. 	/* OS Volume Type Method */
22297. 
22298. /* MakeGap Variants */
22299. 	/* Original Os 1-3 + MFT 2 */
22300. 
22301. /* Note: You could comment out the ones not in use */
22302. /* However having the data in the log is useful. */
22303. /* Therefore the following line is otherwise needed. */
22304. 
22305. /* Standard is used currently */
22306. 
22307. 
22308. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
22309. 
22310. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
22311. 
22312. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
22313. 
22314. /* ---------------------------------------------------------- */
22315. /* 3) SMALL ZONE ADJUSTMENT. */
22316. /* Gab cant be larger than half the Zone Size. */
22317. 
22318. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
22319. 	
22320. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
22321. 
22322. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
22323. 
22324. /* ---------------------------------------------------------- */
22325. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
22326. # Gap Adjustments.
22327. 
22328. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
22329. 	
22330. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
22331. 
22332. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
22333. 
22334. /* ---------------------------------------------------------- */
22335. # BYPASS THIS.
22336. 	/* This is definitely wrong. */
22337. 	/* The question is can we steal gap from the next zone */
22338. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
22339. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
22340. 		# Zone Overflow.
22341. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
22342. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
22343. 
22344. /* ---------------------------------------------------------- */
22345. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
22346. # Remaining free space available.
22347. 
22348. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
22349. 	
22350. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
22351. 
22352. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
22353. 
22354. /* ---------------------------------------------------------- */
22355. # CURRENT gap to use.
22356. 
22357. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
22358. 
22359. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
22360. 
22361. /* ---------------------------------------------------------- */
22362. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
22363. # Debugging.
22364. 
22365. 	SetVariable(GapUsed, GapCurrent) // for debugging
22366. 
22367. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
22368. 
22369. 		# Your code HERE
22370. 
22371. /* ---------------------------------------------------------- */
22372. /* 7) YOUR CODE. */
22373. # YOUR CODE HERE:
22374. 	# INPUT: GapCurrent or GapCurrentLoc
22375. 	# OUTPUT: GapUsed...
22376. 
22377. /* ---------------------------------------------------------- */
22378. # Gap Size.
22379. # Actual Size of Gap.
22380. 
22381. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
22382. 
22383. /* ---------------------------------------------------------- */
22384. /* xxxxxxxxxxxxxxxxxxxxxx */
22385. # ADD THE GAP
22386. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
22387. /* xxxxxxxxxxxxxxxxxxxxxx */
22388. 
22389. 	
22390. 	# Zone Statistics	
22391. 	# Script: ZoneDoStatistics
22392. # Zone / Volume Statistics and Display
22393. 		
22394. 	# Accumulate Totals
22395.   	# Script: ZoneDoVolumeTotals
22396. 
22397. /* Current total space used (by Zones and Gaps) */
22398. 
22399. SetVariable(VolumeZoneUsed, GapUsed)
22400. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
22401. /* Percentage */
22402. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
22403. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
22404. 
22405. /* Current total of free space requested */
22406. 
22407. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
22408. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
22409. /* Percent. */
22410. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
22411. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
22412. 
22413. /* Current total of free space used */
22414. 
22415. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
22416. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
22417. /* Percent */
22418. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
22419. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
22420. 
22421. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
22422. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
22423. /* Xinclude "..\DebugDisplayPause.MyDc"X */
22424. 
22425. 
22426. 	# Current Values
22427. 	# Script: ZoneDoCurrentSet
22428. 
22429. # Cluster, Sector, Block adjust for display.
22430. 	# Bytes per cluster is volume specific.
22431. 
22432. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
22433. 
22434. # Current Zone values.
22435. 	# Begin, end and size.
22436. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
22437. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
22438. 
22439. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
22440. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
22441. 
22442. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
22443. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
22444. 
22445. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
22446. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
22447. 
22448. 	SetVariable(ZoneFragments,				"!ZONE210N!")
22449. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
22450. 		
22451. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
22452. /* identical code to here: (separation not needed. TEST.) */	
22453. 
22454. # Current Gap, Actual and Free Values
22455. 	# Gap
22456. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
22457. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
22458. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
22459. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
22460. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
22461. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
22462. 	
22463. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
22464. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
22465. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
22466. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
22467. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
22468. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
22469. 	
22470. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
22471. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
22472. 	
22473. 	# Actual Size and End
22474. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
22475. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
22476. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
22477. 	
22478. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
22479. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
22480. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
22481. 
22482. # Gap Size & Rounding
22483. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
22484. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
22485. 	
22486. 	# Free Space
22487. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
22488. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
22489. 
22490. 	# Footer:
22491. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
22492. # 2021-11-17 21:08:29
22493. 
22494. SetVariable(ZoneFooter1, "----------------------------------------------------------
22495. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
22496. #
22497. # Xinclude "..\Commands\DateTimeLastLong.txt"X
22498. #
22499. SetVariable(ZoneFooter2, "Statistics Report:
22500. ------------------
22501.    Size:  
22502.    ------------------------
22503.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22504.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22505.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22506. 
22507.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22508.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22509. 
22510.    Location:
22511.    ------------------------
22512.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22513.             Files End: !ZoneEndCurrent!
22514.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22515.       
22516.    Gap Settings:
22517.    ------------------------
22518.          Gap Requested: !ZoneGapSizePer!%
22519.        Volume Rounding: !ZoneVolRoundUpPer!%
22520.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22521.                  
22522.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
22523.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
22524.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
22525.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
22526.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
22527.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
22528.      
22529.    Free Space after Zone:
22530.    ------------------------
22531.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22532.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22533.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22534. 
22535. Directory and Files Select:
22536. ---------------------------
22537. !ZoneTypeSelectCurrent!               
22538. ---------------------------
22539. ----------------------------------------------------------
22540. ")
22541. 
22542. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
22543. 
22544. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
22545. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
22546. RunProgram("..\Commands\WriteDateTime.bat LastZone")
22547. 
22548. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
22549. 
22550. 
22551. 	# Zone Footer Set Statistics Window Text
22552. 
22553. SetStatisticsWindowText("!Heading!
22554. ----------------------------------------------------------
22555. Zones Processed: 
22556. ----------------------------------------------------------
22557. !ZoneListByLine!
22558. ----------------------------------------------------------
22559. Zone Processing Step:
22560. !ZoneStepByLine!    
22561. ----------------------------------------------------------
22562. ----------------------------------------------------------
22563. Current Zone:
22564. !ZoneFooter!
22565. ----------------------------------------------------------
22566. ----------------------------------------------------------
22567. Volume Statistics:
22568. !VolumeStatisticsDetail!
22569. ----------------------------------------------------------
22570. ----------------------------------------------------------
22571. Zone Detailed Report:
22572. ----------------------------------------------------------
22573. !ZoneStatisticsDetail!
22574. ----------------------------------------------------------
22575. ")
22576. 
22577. 
22578. 	
22579.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
22580. 
22581. 	# Add Zone to list of zones for display.
22582. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
22583. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
22584. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
22585. 	# ??? Free Stats?
22586. 	# Footer:
22587. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
22588. # 2021-11-17 21:08:29
22589. 
22590. SetVariable(ZoneFooter1, "----------------------------------------------------------
22591. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
22592. #
22593. # Xinclude "..\Commands\DateTimeLastLong.txt"X
22594. #
22595. SetVariable(ZoneFooter2, "Statistics Report:
22596. ------------------
22597.    Size:  
22598.    ------------------------
22599.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22600.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22601.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22602. 
22603.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22604.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22605. 
22606.    Location:
22607.    ------------------------
22608.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22609.             Files End: !ZoneEndCurrent!
22610.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22611.       
22612.    Gap Settings:
22613.    ------------------------
22614.          Gap Requested: !ZoneGapSizePer!%
22615.        Volume Rounding: !ZoneVolRoundUpPer!%
22616.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22617.                  
22618.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
22619.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
22620.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
22621.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
22622.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
22623.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
22624.      
22625.    Free Space after Zone:
22626.    ------------------------
22627.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22628.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22629.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22630. 
22631. Directory and Files Select:
22632. ---------------------------
22633. !ZoneTypeSelectCurrent!               
22634. ---------------------------
22635. ----------------------------------------------------------
22636. ")
22637. 
22638. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
22639. 
22640. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
22641. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
22642. RunProgram("..\Commands\WriteDateTime.bat LastZone")
22643. 
22644. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
22645. 
22646. 
22647. 
22648. 	# Add Zone Details to Report.	
22649. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
22650. !ZoneFooter!")
22651. 
22652. 
22653. 	
22654. 	# Footer:
22655. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
22656. # 2021-11-17 21:08:29
22657. 
22658. SetVariable(ZoneFooter1, "----------------------------------------------------------
22659. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
22660. #
22661. # Xinclude "..\Commands\DateTimeLastLong.txt"X
22662. #
22663. SetVariable(ZoneFooter2, "Statistics Report:
22664. ------------------
22665.    Size:  
22666.    ------------------------
22667.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22668.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22669.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22670. 
22671.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22672.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22673. 
22674.    Location:
22675.    ------------------------
22676.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22677.             Files End: !ZoneEndCurrent!
22678.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22679.       
22680.    Gap Settings:
22681.    ------------------------
22682.          Gap Requested: !ZoneGapSizePer!%
22683.        Volume Rounding: !ZoneVolRoundUpPer!%
22684.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22685.                  
22686.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
22687.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
22688.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
22689.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
22690.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
22691.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
22692.      
22693.    Free Space after Zone:
22694.    ------------------------
22695.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22696.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22697.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22698. 
22699. Directory and Files Select:
22700. ---------------------------
22701. !ZoneTypeSelectCurrent!               
22702. ---------------------------
22703. ----------------------------------------------------------
22704. ")
22705. 
22706. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
22707. 
22708. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
22709. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
22710. RunProgram("..\Commands\WriteDateTime.bat LastZone")
22711. 
22712. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
22713. 
22714. 
22715. 	SetStatisticsWindowText("!ZoneFooter!")
22716. 	
22717. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
22718. 	# Script: DisplaySetFileStep
22719. 
22720. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22721. 
22722. /* add message and move to a new line. */
22723. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22724. ")
22725. 
22726. /* display the line. (hopefully.) */
22727. # Zone Footer Set Statistics Window Text
22728. 
22729. SetStatisticsWindowText("!Heading!
22730. ----------------------------------------------------------
22731. Zones Processed: 
22732. ----------------------------------------------------------
22733. !ZoneListByLine!
22734. ----------------------------------------------------------
22735. Zone Processing Step:
22736. !ZoneStepByLine!    
22737. ----------------------------------------------------------
22738. ----------------------------------------------------------
22739. Current Zone:
22740. !ZoneFooter!
22741. ----------------------------------------------------------
22742. ----------------------------------------------------------
22743. Volume Statistics:
22744. !VolumeStatisticsDetail!
22745. ----------------------------------------------------------
22746. ----------------------------------------------------------
22747. Zone Detailed Report:
22748. ----------------------------------------------------------
22749. !ZoneStatisticsDetail!
22750. ----------------------------------------------------------
22751. ")
22752. 
22753. 
22754. 
22755. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22756. 
22757. # Script: BannerSet
22758. 
22759. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22760. 
22761. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
22762. 
22763. Title('!Heading!')
22764. /* pause(1) */
22765. 
22766. /* NOTE: Can't round or truncate to integer precision. */
22767. 
22768. pause(1)
22769. 
22770. # Commands:
22771. 
22772. /* Moves to Zone or above it. */
22773. # MoveUpToZone()
22774. 
22775. # Defrag
22776. 
22777. # Defragment(OPTIONS)
22778. 
22779. /* Shuffles files around trying to make a big enough gap for fragmented files. */
22780. # Defragment()
22781. 
22782. /* Only does files where a gap will fit it. */
22783. # Defragment(Fast)
22784. 
22785. /* Skips fragmented files larger than the Chunck Size. */
22786. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
22787. # Defragment(Chunk Size)
22788. 
22789. /* Moves down to zone and packs zone to beginning if there are gaps. */
22790. /* Can be similar in performance to doing a SortBy. */
22791. # MoveDownFill()
22792. 
22793. # File Action - All - Regular -  SortByName.
22794. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
22795. 	
22796. 
22797. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
22798. 	# Script: DisplaySetFileStep
22799. 
22800. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22801. 
22802. /* add message and move to a new line. */
22803. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22804. ")
22805. 
22806. /* display the line. (hopefully.) */
22807. # Zone Footer Set Statistics Window Text
22808. 
22809. SetStatisticsWindowText("!Heading!
22810. ----------------------------------------------------------
22811. Zones Processed: 
22812. ----------------------------------------------------------
22813. !ZoneListByLine!
22814. ----------------------------------------------------------
22815. Zone Processing Step:
22816. !ZoneStepByLine!    
22817. ----------------------------------------------------------
22818. ----------------------------------------------------------
22819. Current Zone:
22820. !ZoneFooter!
22821. ----------------------------------------------------------
22822. ----------------------------------------------------------
22823. Volume Statistics:
22824. !VolumeStatisticsDetail!
22825. ----------------------------------------------------------
22826. ----------------------------------------------------------
22827. Zone Detailed Report:
22828. ----------------------------------------------------------
22829. !ZoneStatisticsDetail!
22830. ----------------------------------------------------------
22831. ")
22832. 
22833. 
22834. 
22835. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22836. 
22837. # Script: BannerSet
22838. 
22839. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22840. 
22841. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
22842. 
22843. Title('!Heading!')
22844. /* pause(1) */
22845. 
22846. /* NOTE: Can't round or truncate to integer precision. */
22847. 
22848. pause(1)
22849. 
22850. 	# Script: ZoneDoFooter
22851. 
22852. /* ---------------------------------------------------------- */
22853. # File Select
22854. 	# Select Statments
22855. # File Actions 
22856. 	# Standard or OS File Actions.
22857. 	# Resume...
22858. 	
22859. 	# your stuff HERE (X)... post zone (file) file actions code.
22860. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
22861. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22862. 		# (X)
22863. 		
22864. 		/* ??? Set window? */
22865. 	
22866. 	# ADD THE GAP
22867. # Vacate (good for diagnostics)
22868. # DoNotVacate - DO NOT Vacate (recommended)
22869. # DoNotVacate - DO NOT Vacate (recommended)
22870. 
22871. # Vacate
22872. /* AddGap(GapUsedLoc) */
22873. 
22874. # DO Not Vacate
22875. AddGap(GapUsedLoc, DoNotVacate) 
22876. 	
22877. 	
22878. # Script: GapZoneCommand
22879. # *** Moved to setting yours ***
22880. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
22881. # Controlled via settings commands
22882. # DoNotVacate - DO NOT Vacate (recommended)
22883. 
22884. # Vacate
22885. /* AddGap(GapUsedLoc) */
22886. 
22887. # DO Not Vacate
22888. AddGap(GapUsedLoc, DoNotVacate) 
22889. 	
22890. 	
22891. # Vacate /* AddGap(GapUsed) */
22892. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
22893. 	
22894. 
22895. 		
22896. # 
22897. FileEnd
22898. /* ---------------------------------------------------------- */
22899. 
22900. # your stuff HERE (X)... post zone (file) code.
22901. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
22902. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22903. 	# (X)
22904. 
22905. SetVariable(FileStepDescription,"Zone finished, reporting.")
22906. # Script: DisplaySetFileStep
22907. 
22908. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22909. 
22910. /* add message and move to a new line. */
22911. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22912. ")
22913. 
22914. /* display the line. (hopefully.) */
22915. # Zone Footer Set Statistics Window Text
22916. 
22917. SetStatisticsWindowText("!Heading!
22918. ----------------------------------------------------------
22919. Zones Processed: 
22920. ----------------------------------------------------------
22921. !ZoneListByLine!
22922. ----------------------------------------------------------
22923. Zone Processing Step:
22924. !ZoneStepByLine!    
22925. ----------------------------------------------------------
22926. ----------------------------------------------------------
22927. Current Zone:
22928. !ZoneFooter!
22929. ----------------------------------------------------------
22930. ----------------------------------------------------------
22931. Volume Statistics:
22932. !VolumeStatisticsDetail!
22933. ----------------------------------------------------------
22934. ----------------------------------------------------------
22935. Zone Detailed Report:
22936. ----------------------------------------------------------
22937. !ZoneStatisticsDetail!
22938. ----------------------------------------------------------
22939. ")
22940. 
22941. 
22942. 
22943. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22944. 
22945. # Script: BannerSet
22946. 
22947. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22948. 
22949. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
22950. 
22951. Title('!Heading!')
22952. /* pause(1) */
22953. 
22954. /* NOTE: Can't round or truncate to integer precision. */
22955. 
22956. pause(1)
22957. 
22958. # Script: ZoneWhenFinished
22959. 
22960. # Script: BannerSet
22961. 
22962. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
22963. 
22964. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
22965. 
22966. Title('!Heading!')
22967. /* pause(1) */
22968. 
22969. /* NOTE: Can't round or truncate to integer precision. */
22970. 
22971. # Script: BannerLog
22972. 
22973. AppendLogfile("!LogFileName!", "!Title!")
22974. 
22975. 
22976. 
22977. # Zone Statistics	
22978. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
22979. 
22980. # Footer:
22981. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
22982. # 2021-11-17 21:08:29
22983. 
22984. SetVariable(ZoneFooter1, "----------------------------------------------------------
22985. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
22986. #
22987. # Xinclude "..\Commands\DateTimeLastLong.txt"X
22988. #
22989. SetVariable(ZoneFooter2, "Statistics Report:
22990. ------------------
22991.    Size:  
22992.    ------------------------
22993.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22994.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22995.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22996. 
22997.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22998.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22999. 
23000.    Location:
23001.    ------------------------
23002.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23003.             Files End: !ZoneEndCurrent!
23004.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23005.       
23006.    Gap Settings:
23007.    ------------------------
23008.          Gap Requested: !ZoneGapSizePer!%
23009.        Volume Rounding: !ZoneVolRoundUpPer!%
23010.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23011.                  
23012.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
23013.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
23014.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
23015.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
23016.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
23017.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
23018.      
23019.    Free Space after Zone:
23020.    ------------------------
23021.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23022.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23023.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23024. 
23025. Directory and Files Select:
23026. ---------------------------
23027. !ZoneTypeSelectCurrent!               
23028. ---------------------------
23029. ----------------------------------------------------------
23030. ")
23031. 
23032. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
23033. 
23034. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
23035. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
23036. RunProgram("..\Commands\WriteDateTime.bat LastZone")
23037. 
23038. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
23039. 
23040. 
23041. 
23042. AppendLogfile("!LogFileName!", ".")
23043. AppendLogfile("!LogFileName!", "!ZoneFooter!")
23044. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
23045. AppendLogfile("!LogFileName!", ".")
23046. 
23047. # Zone Footer Set Statistics Window Text
23048. 
23049. SetStatisticsWindowText("!Heading!
23050. ----------------------------------------------------------
23051. Zones Processed: 
23052. ----------------------------------------------------------
23053. !ZoneListByLine!
23054. ----------------------------------------------------------
23055. Zone Processing Step:
23056. !ZoneStepByLine!    
23057. ----------------------------------------------------------
23058. ----------------------------------------------------------
23059. Current Zone:
23060. !ZoneFooter!
23061. ----------------------------------------------------------
23062. ----------------------------------------------------------
23063. Volume Statistics:
23064. !VolumeStatisticsDetail!
23065. ----------------------------------------------------------
23066. ----------------------------------------------------------
23067. Zone Detailed Report:
23068. ----------------------------------------------------------
23069. !ZoneStatisticsDetail!
23070. ----------------------------------------------------------
23071. ")
23072. 
23073. 
23074. 
23075. /* pause() */
23076. /* pause() */
23077. 
23078. 
23079. 
23080. 
23081. /* ---------------------------------------------------------- */
23082. 
23083. 
23084. /* ---------------------------------------------------------- */
23085. /* Zone 16 Shares */
23086. # Script: DisplayColors - Zone Dark
23087. # Processed
23088. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
23089. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
23090. 
23091. # Light Green and Yellow
23092. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
23093. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
23094. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
23095. 
23096. # Script: DefragZoneTypeShares
23097. /* ---------------------------------------------------------- */
23098. /* Zone Shares */
23099. SetVariable(ZoneLabel, "!ZoneLabelShares!")
23100. SetVariable(ZoneDescription, "!ZoneDescriptionShares!")
23101. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpShares!")
23102. SetVariable(ZoneGapSize, "!ZoneGapSizeShares!")
23103. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectShares
23104. # Shares start.
23105. # NotBlobsArchivesBu start.
23106. (not (
23107. # Blobs start.
23108. (
23109. # BlobsAndExceptions start.
23110. ( not(
23111.   FileName("*.bat")
23112.   or FileName("*.css")
23113.   or FileName("*.dll")
23114.   or FileName("*.exe")
23115.   or FileName("*.htm*")
23116.   or FileName("*.jar")
23117.   or FileName("*.js")
23118.   or FileName("*.script")
23119.   or FileName("*.wsf")
23120.   or (
23121. # Databases start.
23122. (
23123.   FileName("*.crypt*")
23124.   or FileName("*.db*")
23125.   or FileName("*.rdb*")
23126.   or FileName("*.dc*")
23127.   or FileName("*.dict*")
23128.   or FileName("*.?db*")
23129.   or FileName("*.?rdb*")
23130.   or FileName("*.md*")
23131.   or FileName("*.myd")
23132.   or FileName("*.ndf")
23133.   or FileName("*.ns?")
23134.   or FileName("*.pab")
23135.   or FileName("*.pst")
23136.   or FileName("*.sd?*")
23137.   or FileName("*.sq**")
23138.   or FileName("*.tmd")
23139.   or FileName("*.tps")
23140.   or FileName("*.tr*")
23141. )
23142. # Databases end.
23143. 
23144.     # BlobsAndExceptions
23145.     or 
23146. # Data start.
23147. (
23148.   DirectoryName("Data*")
23149.   or DirectoryName("Device*")
23150.   or DirectoryName("Export*")
23151.   or DirectoryName("Import*")
23152.   or DirectoryName("Log*")
23153.   or DirectoryName("*Log")
23154.   or DirectoryName("Maintenance*")
23155.   or DirectoryName("Rec*")
23156.   or DirectoryName("Sales*")
23157.   or DirectoryName("Search*")
23158.   or DirectoryName("User*")
23159. )
23160. # Data end.
23161. 
23162.     # BlobsAndExceptions
23163.   )
23164. ) )
23165. # BlobsAndExceptions end.
23166. 
23167. # Blobs
23168. ) and (
23169.   Size(BlobFileSize,0)
23170.   or (
23171.     FileName("*.arj")
23172.     or FileName("*.bup")
23173.     or FileName("*.bz2")
23174.     or FileName("*.chm")
23175.     or FileName("*.dvr-ms")
23176.     or FileName("*.gz")
23177.     or FileName("*.ifo")
23178.     or FileName("*.lzh")
23179.     or FileName("*.pdf")
23180.     or FileName("*.rpm")
23181.     or FileName("*.wmv")
23182.     or FileName("*.vob")
23183.     or FileName("*.z")
23184.   ) 
23185. )
23186. # Blobs end.
23187. 
23188. # NotBlobsArchivesBu
23189. or 
23190. # Archives start.
23191. (
23192.   DirectoryName("*Archive*")
23193.   or DirectoryName("*History*")
23194.   or DirectoryName("*Old")
23195.   or DirectoryName("* Old *")
23196.   or DirectoryName("Old *")
23197. 
23198.   or FileName("*.7z")
23199.   or FileName("*.cab")
23200.   or FileName("*.iso")
23201.   or FileName("*.msi")
23202.   or FileName("*.old")
23203.   or FileName("*.rar")
23204.   or FileName("*.tar")
23205.   or FileName("*.zip")
23206.   or
23207. # WinSysLow start.
23208. (
23209.   # Bad idea. This pushed lots of programs and data to archive.
23210.   # DirectoryName("$*")
23211.   # or DirectoryName("0*")
23212.   # or DirectoryName("1*")
23213.   # or DirectoryName("2*")
23214.   # or DirectoryName("3*")
23215.   # or DirectoryName("4*")
23216.   # or DirectoryName("5*")
23217.   # or DirectoryName("6*")
23218.   # or DirectoryName("7*")
23219.   # or DirectoryName("8*")
23220.   # or DirectoryName("9*")
23221.   # or 
23222.   DirectoryName("dllcache")
23223.   or DirectoryName("Downloaded Installations")
23224.   or DirectoryName("Ehome")
23225.   or DirectoryName("Fonts")
23226.   or DirectoryName("Help")
23227.   or DirectoryName("I386")
23228.   or DirectoryName("ie?updates")
23229.   or DirectoryName("Installer")
23230.   or DirectoryName("Installshield Installation Information")
23231.   or DirectoryName("IME")
23232.   or DirectoryName("*RECYCLE*")
23233.   or DirectoryName("ServicePackFiles")
23234.   or DirectoryName("SoftwareDistribution")
23235.   or DirectoryName("Speech")
23236.   or DirectoryName("Symbols")
23237.   or DirectoryName("System Volume Information")
23238.   or DirectoryName("windows.old")
23239. )
23240. # WinSysLow end.
23241. 
23242.   # Archives
23243. )
23244. # Archives end.
23245. 
23246. # NotBlobsArchivesBu
23247. or
23248. # Backups start.
23249. (
23250.   DirectoryName("*Backup*")
23251.   or DirectoryName("*Bu")
23252.   or DirectoryName("* Bu *")
23253.   or DirectoryName("Bu *")
23254. 
23255.   or FileName("*.bak")
23256.   or FileName("* - Copy*")
23257. )
23258. # Backups end.
23259. 
23260. # NotBlobsArchivesBu
23261. ) )
23262. # NotBlobsArchivesBu end.
23263. 
23264. # Shares
23265. and (
23266. # Share start.
23267. (
23268.   DirectoryName("*Common*")
23269.   or DirectoryName("Media*")
23270.   or DirectoryName("Multimedia*")
23271.   or DirectoryName("*Public*")
23272.   or DirectoryName("*Share*")
23273. )
23274. # Share end.
23275. 
23276. # Shares
23277. or 
23278. # Family start.
23279. (
23280.     DirectoryName("*Family*")
23281. )
23282. # Family end.
23283. 
23284. # Shares
23285. )
23286. # Shares end.
23287. ')
23288. 
23289. 	# Script: ZoneDoHeader
23290. 
23291. # Script: ZoneWhenStarted
23292. RunProgram("..\Commands\WriteDateTime.bat")
23293. 
23294. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
23295. # Script: DisplaySetZone
23296. 
23297. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
23298. SetVariable(FileStepDescription,	"")
23299. 
23300. SetVariable(ZoneStepByLine, 			"Zone started.
23301. ")
23302. 
23303. # Script: BannerDescriptionSet
23304. 
23305. # Script: BannerSet
23306. 
23307. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
23308. 
23309. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
23310. 
23311. Title('!Heading!')
23312. /* pause(1) */
23313. 
23314. /* NOTE: Can't round or truncate to integer precision. */
23315. 
23316. # Script: BannerLog
23317. 
23318. AppendLogfile("!LogFileName!", "!Title!")
23319. 
23320. 
23321. 
23322. pause(1)
23323. 
23324. 
23325. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
23326. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
23327. 
23328. SetVariable(ZoneStepNoCurrent, 0)
23329. 
23330. 
23331. # Script: ZoneDoCurrentClear
23332. 
23333. SetVariable(ZoneTypeSelectCurrent, 		"")
23334. 
23335. SetVariable(ZoneBeginCurrent, 			0)
23336. SetVariable(ZoneBeginPerCurrent, 		0)
23337. SetVariable(ZoneEndCurrent, 			0)
23338. SetVariable(ZoneEndPerCurrent, 			0)
23339. 
23340. SetVariable(ZoneSizeCurrent,			0)
23341. SetVariable(ZoneSizePerCurrent,			0)
23342. 
23343. SetVariable(ZoneGapRequestedCurrent,	0)
23344. SetVariable(ZoneGapRoundedCurrent, 		0)
23345. SetVariable(ZoneGapAdjustedCurrent, 	0)
23346. SetVariable(ZoneGapAvailableCurrent, 	0)
23347. SetVariable(ZoneGapCurrent,				0)
23348. SetVariable(ZoneGapUsedCurrent, 		0)
23349. 
23350. SetVariable(ZoneGapActualCurrent, 		0)
23351. SetVariable(ZoneGapActualPerCurrent, 	0)
23352. 
23353. SetVariable(ZoneSizeActual, 			0)
23354. SetVariable(ZoneSizeActualCurrent,		0)
23355. 
23356. SetVariable(ZoneEndActual, 				0)
23357. SetVariable(ZoneEndActualCurrent,		0)			
23358. SetVariable(ZoneSizeActualPerCurrent, 	0)
23359.       
23360. SetVariable(ZoneFilesFolders,			0)
23361. SetVariable(ZoneFilesFoldersPer,		0) 
23362. 
23363. SetVariable(ZoneFragments,				0)
23364. SetVariable(ZoneFragmentsPer,			0) 
23365. 		
23366. SetVariable(ZoneEndActualCurrent, 		0)
23367. SetVariable(ZoneEndActualPerCurrent, 	0)
23368. 
23369. # Gap Calculation Methodology:
23370. 	# Requested
23371. 	SetVariable(GapRequested, 			0) 
23372. 	SetVariable(GapRequestedStd, 		0) 
23373. 	SetVariable(GapRequestedMft, 		0) 
23374. 	SetVariable(GapRequestedOs, 		0) 
23375. 	SetVariable(GapRequestedOriginal, 	0) 
23376. 	
23377. 	# Gap Adjustments
23378. 	SetVariable(GapRounded, 			0)
23379. 	# SetVariable(GapAdjusted, 			0)
23380. 	SetVariable(GapAvailable, 			0)
23381. 	SetVariable(GapCurrent, 			0)
23382. 	SetVariable(GapActual, 				0)
23383. 	SetVariable(GapUsed, 				0)
23384. 	
23385. 	# Gap Adjustments
23386. 	SetVariable(GapRoundedLoc, 			0)
23387. 	# SetVariable(GapAdjustedLoc, 		0)
23388. 	SetVariable(GapAvailableLoc, 		0)
23389. 	SetVariable(GapCurrentLoc, 			0)
23390. 	SetVariable(GapActualLoc,			0)
23391. 	SetVariable(GapUsedLoc,				0)
23392. 	
23393. 	# Space usage
23394. 	SetVariable(ZoneFreePerRequested, 	0)
23395. 	SetVariable(ZoneFreePerUsed, 		0)
23396. 
23397. # Gap Size & Rounding
23398. 	SetVariable(ZoneGapSizePer, 		0)
23399. 	SetVariable(ZoneVolRoundUpPer, 		0)
23400. 	
23401. 	# Free Space
23402. 	SetVariable(ZoneFreeUsedPer, 		0)
23403. 	SetVariable(ZoneFreeRequestedPer, 	0)
23404. 
23405. 
23406. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
23407. 
23408. # Footer:
23409. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
23410. # 2021-11-17 21:08:29
23411. 
23412. SetVariable(ZoneFooter1, "----------------------------------------------------------
23413. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
23414. #
23415. # Xinclude "..\Commands\DateTimeLastLong.txt"X
23416. #
23417. SetVariable(ZoneFooter2, "Statistics Report:
23418. ------------------
23419.    Size:  
23420.    ------------------------
23421.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23422.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23423.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23424. 
23425.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23426.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23427. 
23428.    Location:
23429.    ------------------------
23430.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23431.             Files End: !ZoneEndCurrent!
23432.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23433.       
23434.    Gap Settings:
23435.    ------------------------
23436.          Gap Requested: !ZoneGapSizePer!%
23437.        Volume Rounding: !ZoneVolRoundUpPer!%
23438.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23439.                  
23440.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
23441.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
23442.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
23443.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
23444.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
23445.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
23446.      
23447.    Free Space after Zone:
23448.    ------------------------
23449.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23450.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23451.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23452. 
23453. Directory and Files Select:
23454. ---------------------------
23455. !ZoneTypeSelectCurrent!               
23456. ---------------------------
23457. ----------------------------------------------------------
23458. ")
23459. 
23460. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
23461. 
23462. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
23463. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
23464. RunProgram("..\Commands\WriteDateTime.bat LastZone")
23465. 
23466. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
23467. 
23468. 
23469. 
23470. # Script: BannerSet
23471. 
23472. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
23473. 
23474. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
23475. 
23476. Title('!Heading!')
23477. /* pause(1) */
23478. 
23479. /* NOTE: Can't round or truncate to integer precision. */
23480. 
23481. # Script: BannerLog
23482. 
23483. AppendLogfile("!LogFileName!", "!Title!")
23484. 
23485. 
23486. 
23487. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
23488. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
23489. 
23490. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
23491. 
23492. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:29")
23493. 
23494. # 2021-11-17 21:08:29 
23495. SetVariable(Temp9, DATETIME)
23496. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:04 !ZoneLabel! !ZoneDescription!")
23497. 
23498. SetVariable(ZoneListByLine, "!ZoneListByLine! 
23499. Zone: !ZoneNoCurrent! !Temp9! 0:00:04 !ZoneLabel! !ZoneDescription!")
23500. 
23501. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:04 !ZoneLabel! !ZoneDescription!")
23502. 
23503. 
23504. /* Fixed Zone Position Handling */
23505. /* Literal number: */
23506. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
23507. /* Percentage of disk: */
23508. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
23509. /* Gap */
23510. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
23511. 
23512. /* ---------------------------------------------------------- */
23513. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
23514. # Script: DisplaySetFileStep
23515. 
23516. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23517. 
23518. /* add message and move to a new line. */
23519. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23520. ")
23521. 
23522. /* display the line. (hopefully.) */
23523. # Zone Footer Set Statistics Window Text
23524. 
23525. SetStatisticsWindowText("!Heading!
23526. ----------------------------------------------------------
23527. Zones Processed: 
23528. ----------------------------------------------------------
23529. !ZoneListByLine!
23530. ----------------------------------------------------------
23531. Zone Processing Step:
23532. !ZoneStepByLine!    
23533. ----------------------------------------------------------
23534. ----------------------------------------------------------
23535. Current Zone:
23536. !ZoneFooter!
23537. ----------------------------------------------------------
23538. ----------------------------------------------------------
23539. Volume Statistics:
23540. !VolumeStatisticsDetail!
23541. ----------------------------------------------------------
23542. ----------------------------------------------------------
23543. Zone Detailed Report:
23544. ----------------------------------------------------------
23545. !ZoneStatisticsDetail!
23546. ----------------------------------------------------------
23547. ")
23548. 
23549. 
23550. 
23551. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23552. 
23553. # Script: BannerSet
23554. 
23555. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
23556. 
23557. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
23558. 
23559. Title('!Heading!')
23560. /* pause(1) */
23561. 
23562. /* NOTE: Can't round or truncate to integer precision. */
23563. 
23564. pause(1)
23565. 
23566. # your stuff HERE (X)... pre file select code.
23567. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
23568. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
23569. 	# (X)
23570. 
23571. FileSelect
23572. 
23573. 	# your stuff can't really go here (errors.)
23574. 	# maybe for some reason I don't know of...
23575. 	
23576. 	# Actions next...
23577. 	# Script: ZoneDo ZoneTypeSelectShares
23578. # Shares start.
23579. # NotBlobsArchivesBu start.
23580. (not (
23581. # Blobs start.
23582. (
23583. # BlobsAndExceptions start.
23584. ( not(
23585.   FileName("*.bat")
23586.   or FileName("*.css")
23587.   or FileName("*.dll")
23588.   or FileName("*.exe")
23589.   or FileName("*.htm*")
23590.   or FileName("*.jar")
23591.   or FileName("*.js")
23592.   or FileName("*.script")
23593.   or FileName("*.wsf")
23594.   or (
23595. # Databases start.
23596. (
23597.   FileName("*.crypt*")
23598.   or FileName("*.db*")
23599.   or FileName("*.rdb*")
23600.   or FileName("*.dc*")
23601.   or FileName("*.dict*")
23602.   or FileName("*.?db*")
23603.   or FileName("*.?rdb*")
23604.   or FileName("*.md*")
23605.   or FileName("*.myd")
23606.   or FileName("*.ndf")
23607.   or FileName("*.ns?")
23608.   or FileName("*.pab")
23609.   or FileName("*.pst")
23610.   or FileName("*.sd?*")
23611.   or FileName("*.sq**")
23612.   or FileName("*.tmd")
23613.   or FileName("*.tps")
23614.   or FileName("*.tr*")
23615. )
23616. # Databases end.
23617. 
23618.     # BlobsAndExceptions
23619.     or 
23620. # Data start.
23621. (
23622.   DirectoryName("Data*")
23623.   or DirectoryName("Device*")
23624.   or DirectoryName("Export*")
23625.   or DirectoryName("Import*")
23626.   or DirectoryName("Log*")
23627.   or DirectoryName("*Log")
23628.   or DirectoryName("Maintenance*")
23629.   or DirectoryName("Rec*")
23630.   or DirectoryName("Sales*")
23631.   or DirectoryName("Search*")
23632.   or DirectoryName("User*")
23633. )
23634. # Data end.
23635. 
23636.     # BlobsAndExceptions
23637.   )
23638. ) )
23639. # BlobsAndExceptions end.
23640. 
23641. # Blobs
23642. ) and (
23643.   Size(BlobFileSize,0)
23644.   or (
23645.     FileName("*.arj")
23646.     or FileName("*.bup")
23647.     or FileName("*.bz2")
23648.     or FileName("*.chm")
23649.     or FileName("*.dvr-ms")
23650.     or FileName("*.gz")
23651.     or FileName("*.ifo")
23652.     or FileName("*.lzh")
23653.     or FileName("*.pdf")
23654.     or FileName("*.rpm")
23655.     or FileName("*.wmv")
23656.     or FileName("*.vob")
23657.     or FileName("*.z")
23658.   ) 
23659. )
23660. # Blobs end.
23661. 
23662. # NotBlobsArchivesBu
23663. or 
23664. # Archives start.
23665. (
23666.   DirectoryName("*Archive*")
23667.   or DirectoryName("*History*")
23668.   or DirectoryName("*Old")
23669.   or DirectoryName("* Old *")
23670.   or DirectoryName("Old *")
23671. 
23672.   or FileName("*.7z")
23673.   or FileName("*.cab")
23674.   or FileName("*.iso")
23675.   or FileName("*.msi")
23676.   or FileName("*.old")
23677.   or FileName("*.rar")
23678.   or FileName("*.tar")
23679.   or FileName("*.zip")
23680.   or
23681. # WinSysLow start.
23682. (
23683.   # Bad idea. This pushed lots of programs and data to archive.
23684.   # DirectoryName("$*")
23685.   # or DirectoryName("0*")
23686.   # or DirectoryName("1*")
23687.   # or DirectoryName("2*")
23688.   # or DirectoryName("3*")
23689.   # or DirectoryName("4*")
23690.   # or DirectoryName("5*")
23691.   # or DirectoryName("6*")
23692.   # or DirectoryName("7*")
23693.   # or DirectoryName("8*")
23694.   # or DirectoryName("9*")
23695.   # or 
23696.   DirectoryName("dllcache")
23697.   or DirectoryName("Downloaded Installations")
23698.   or DirectoryName("Ehome")
23699.   or DirectoryName("Fonts")
23700.   or DirectoryName("Help")
23701.   or DirectoryName("I386")
23702.   or DirectoryName("ie?updates")
23703.   or DirectoryName("Installer")
23704.   or DirectoryName("Installshield Installation Information")
23705.   or DirectoryName("IME")
23706.   or DirectoryName("*RECYCLE*")
23707.   or DirectoryName("ServicePackFiles")
23708.   or DirectoryName("SoftwareDistribution")
23709.   or DirectoryName("Speech")
23710.   or DirectoryName("Symbols")
23711.   or DirectoryName("System Volume Information")
23712.   or DirectoryName("windows.old")
23713. )
23714. # WinSysLow end.
23715. 
23716.   # Archives
23717. )
23718. # Archives end.
23719. 
23720. # NotBlobsArchivesBu
23721. or
23722. # Backups start.
23723. (
23724.   DirectoryName("*Backup*")
23725.   or DirectoryName("*Bu")
23726.   or DirectoryName("* Bu *")
23727.   or DirectoryName("Bu *")
23728. 
23729.   or FileName("*.bak")
23730.   or FileName("* - Copy*")
23731. )
23732. # Backups end.
23733. 
23734. # NotBlobsArchivesBu
23735. ) )
23736. # NotBlobsArchivesBu end.
23737. 
23738. # Shares
23739. and (
23740. # Share start.
23741. (
23742.   DirectoryName("*Common*")
23743.   or DirectoryName("Media*")
23744.   or DirectoryName("Multimedia*")
23745.   or DirectoryName("*Public*")
23746.   or DirectoryName("*Share*")
23747. )
23748. # Share end.
23749. 
23750. # Shares
23751. or 
23752. # Family start.
23753. (
23754.     DirectoryName("*Family*")
23755. )
23756. # Family end.
23757. 
23758. # Shares
23759. )
23760. # Shares end.
23761. 
23762. 	# Script: ZoneDoAction
23763. # Zone Do File Action - SortByName.
23764. 
23765. FileActions
23766. 
23767. 		/* ---------------------------------------------------------- */
23768. 	# Gap
23769. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
23770. 		# Script: DisplaySetFileStep
23771. 
23772. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23773. 
23774. /* add message and move to a new line. */
23775. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23776. ")
23777. 
23778. /* display the line. (hopefully.) */
23779. # Zone Footer Set Statistics Window Text
23780. 
23781. SetStatisticsWindowText("!Heading!
23782. ----------------------------------------------------------
23783. Zones Processed: 
23784. ----------------------------------------------------------
23785. !ZoneListByLine!
23786. ----------------------------------------------------------
23787. Zone Processing Step:
23788. !ZoneStepByLine!    
23789. ----------------------------------------------------------
23790. ----------------------------------------------------------
23791. Current Zone:
23792. !ZoneFooter!
23793. ----------------------------------------------------------
23794. ----------------------------------------------------------
23795. Volume Statistics:
23796. !VolumeStatisticsDetail!
23797. ----------------------------------------------------------
23798. ----------------------------------------------------------
23799. Zone Detailed Report:
23800. ----------------------------------------------------------
23801. !ZoneStatisticsDetail!
23802. ----------------------------------------------------------
23803. ")
23804. 
23805. 
23806. 
23807. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23808. 
23809. # Script: BannerSet
23810. 
23811. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
23812. 
23813. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
23814. 
23815. Title('!Heading!')
23816. /* pause(1) */
23817. 
23818. /* NOTE: Can't round or truncate to integer precision. */
23819. 
23820. pause(1)
23821. 	
23822. 	# ACTUAL GAP
23823. 		/* AddGap Variant. */
23824. 	  	# Zone Do Gap
23825. # Gap Calculation Methods:
23826. 
23827. /* 1) Anything you need to add first. */
23828. /* empty */
23829. 
23830. /* ---------------------------------------------------------- */
23831. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
23832. 	# GapRequestedStd.
23833. 
23834. 		/* ---------------------------------------------------------- */
23835. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
23836. 
23837. 		# Gap Calculation Methods:
23838. 
23839. /* AddGap Variants */
23840. 
23841. 	/* Standard */
23842. 		# Gap Calculation Methods:
23843. 	/* AddGap Variants */
23844. 	/* Standard */
23845. 
23846. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
23847. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
23848. 
23849. 	SetVariable(GapRequested, GapRequestedStd)
23850. 	
23851. 
23852. 	/* MFT Low High Method */
23853. 		# Gap Calculation Methods:
23854. 	/* AddGap Variants */
23855. 	/* MFT Low High Method */
23856. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
23857. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
23858. 	SetVariable(GapRequested, GapRequestedMft)
23859. 	
23860. 
23861. 	/* OS Volume Type Method */
23862. 		# Gap Calculation Methods:
23863. 	/* AddGap Variants */
23864. 	/* OS Volume Type Method */
23865. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
23866. 	SetVariable(GapRequested, GapRequestedOs)
23867. 
23868. 
23869. 
23870. /* MakeGap Variants */
23871. 
23872. 	/* Original Os 1-3 + MFT 2 */
23873. 		# Gap Calculation Methods:
23874. 	/* MakeGap Variants */
23875. 	/* Original Os 1-3 + MFT 2 */
23876. 	/* plus MFT gap placed inline at the dividing zone. */
23877. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
23878. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
23879. 	SetVariable(GapRequested, GapRequestedOrig)
23880. 	
23881. 	
23882. /* Note: You could comment out the ones not in use */
23883. /* However having the data in the log is useful. */
23884. /* Therefore the following line is otherwise needed. */
23885. 
23886. /* Standard used */
23887. 
23888. SetVariable(GapRequested, GapRequestedStd)
23889. 
23890. # Gap Calculation Methods:
23891. 
23892. /* AddGap Variants */
23893. 	/* Standard */
23894. 	/* MFT Low High Method */
23895. 	/* OS Volume Type Method */
23896. 
23897. /* MakeGap Variants */
23898. 	/* Original Os 1-3 + MFT 2 */
23899. 
23900. /* Note: You could comment out the ones not in use */
23901. /* However having the data in the log is useful. */
23902. /* Therefore the following line is otherwise needed. */
23903. 
23904. /* Standard is used currently */
23905. 
23906. 
23907. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
23908. 
23909. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
23910. 
23911. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
23912. 
23913. /* ---------------------------------------------------------- */
23914. /* 3) SMALL ZONE ADJUSTMENT. */
23915. /* Gab cant be larger than half the Zone Size. */
23916. 
23917. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
23918. 	
23919. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
23920. 
23921. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
23922. 
23923. /* ---------------------------------------------------------- */
23924. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
23925. # Gap Adjustments.
23926. 
23927. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
23928. 	
23929. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
23930. 
23931. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
23932. 
23933. /* ---------------------------------------------------------- */
23934. # BYPASS THIS.
23935. 	/* This is definitely wrong. */
23936. 	/* The question is can we steal gap from the next zone */
23937. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
23938. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
23939. 		# Zone Overflow.
23940. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
23941. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
23942. 
23943. /* ---------------------------------------------------------- */
23944. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
23945. # Remaining free space available.
23946. 
23947. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
23948. 	
23949. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
23950. 
23951. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
23952. 
23953. /* ---------------------------------------------------------- */
23954. # CURRENT gap to use.
23955. 
23956. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
23957. 
23958. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
23959. 
23960. /* ---------------------------------------------------------- */
23961. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
23962. # Debugging.
23963. 
23964. 	SetVariable(GapUsed, GapCurrent) // for debugging
23965. 
23966. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
23967. 
23968. 		# Your code HERE
23969. 
23970. /* ---------------------------------------------------------- */
23971. /* 7) YOUR CODE. */
23972. # YOUR CODE HERE:
23973. 	# INPUT: GapCurrent or GapCurrentLoc
23974. 	# OUTPUT: GapUsed...
23975. 
23976. /* ---------------------------------------------------------- */
23977. # Gap Size.
23978. # Actual Size of Gap.
23979. 
23980. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
23981. 
23982. /* ---------------------------------------------------------- */
23983. /* xxxxxxxxxxxxxxxxxxxxxx */
23984. # ADD THE GAP
23985. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
23986. /* xxxxxxxxxxxxxxxxxxxxxx */
23987. 
23988. 	
23989. 	# Zone Statistics	
23990. 	# Script: ZoneDoStatistics
23991. # Zone / Volume Statistics and Display
23992. 		
23993. 	# Accumulate Totals
23994.   	# Script: ZoneDoVolumeTotals
23995. 
23996. /* Current total space used (by Zones and Gaps) */
23997. 
23998. SetVariable(VolumeZoneUsed, GapUsed)
23999. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
24000. /* Percentage */
24001. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
24002. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
24003. 
24004. /* Current total of free space requested */
24005. 
24006. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
24007. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
24008. /* Percent. */
24009. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
24010. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
24011. 
24012. /* Current total of free space used */
24013. 
24014. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
24015. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
24016. /* Percent */
24017. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
24018. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
24019. 
24020. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
24021. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
24022. /* Xinclude "..\DebugDisplayPause.MyDc"X */
24023. 
24024. 
24025. 	# Current Values
24026. 	# Script: ZoneDoCurrentSet
24027. 
24028. # Cluster, Sector, Block adjust for display.
24029. 	# Bytes per cluster is volume specific.
24030. 
24031. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
24032. 
24033. # Current Zone values.
24034. 	# Begin, end and size.
24035. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
24036. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
24037. 
24038. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
24039. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
24040. 
24041. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
24042. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
24043. 
24044. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
24045. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
24046. 
24047. 	SetVariable(ZoneFragments,				"!ZONE210N!")
24048. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
24049. 		
24050. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
24051. /* identical code to here: (separation not needed. TEST.) */	
24052. 
24053. # Current Gap, Actual and Free Values
24054. 	# Gap
24055. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
24056. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
24057. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
24058. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
24059. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
24060. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
24061. 	
24062. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
24063. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
24064. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
24065. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
24066. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
24067. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
24068. 	
24069. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
24070. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
24071. 	
24072. 	# Actual Size and End
24073. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
24074. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
24075. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
24076. 	
24077. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
24078. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
24079. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
24080. 
24081. # Gap Size & Rounding
24082. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
24083. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
24084. 	
24085. 	# Free Space
24086. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
24087. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
24088. 
24089. 	# Footer:
24090. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
24091. # 2021-11-17 21:08:29
24092. 
24093. SetVariable(ZoneFooter1, "----------------------------------------------------------
24094. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
24095. #
24096. # Xinclude "..\Commands\DateTimeLastLong.txt"X
24097. #
24098. SetVariable(ZoneFooter2, "Statistics Report:
24099. ------------------
24100.    Size:  
24101.    ------------------------
24102.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24103.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24104.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24105. 
24106.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24107.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24108. 
24109.    Location:
24110.    ------------------------
24111.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24112.             Files End: !ZoneEndCurrent!
24113.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24114.       
24115.    Gap Settings:
24116.    ------------------------
24117.          Gap Requested: !ZoneGapSizePer!%
24118.        Volume Rounding: !ZoneVolRoundUpPer!%
24119.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24120.                  
24121.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
24122.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
24123.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
24124.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
24125.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
24126.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
24127.      
24128.    Free Space after Zone:
24129.    ------------------------
24130.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24131.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24132.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24133. 
24134. Directory and Files Select:
24135. ---------------------------
24136. !ZoneTypeSelectCurrent!               
24137. ---------------------------
24138. ----------------------------------------------------------
24139. ")
24140. 
24141. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
24142. 
24143. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
24144. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
24145. RunProgram("..\Commands\WriteDateTime.bat LastZone")
24146. 
24147. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
24148. 
24149. 
24150. 	# Zone Footer Set Statistics Window Text
24151. 
24152. SetStatisticsWindowText("!Heading!
24153. ----------------------------------------------------------
24154. Zones Processed: 
24155. ----------------------------------------------------------
24156. !ZoneListByLine!
24157. ----------------------------------------------------------
24158. Zone Processing Step:
24159. !ZoneStepByLine!    
24160. ----------------------------------------------------------
24161. ----------------------------------------------------------
24162. Current Zone:
24163. !ZoneFooter!
24164. ----------------------------------------------------------
24165. ----------------------------------------------------------
24166. Volume Statistics:
24167. !VolumeStatisticsDetail!
24168. ----------------------------------------------------------
24169. ----------------------------------------------------------
24170. Zone Detailed Report:
24171. ----------------------------------------------------------
24172. !ZoneStatisticsDetail!
24173. ----------------------------------------------------------
24174. ")
24175. 
24176. 
24177. 	
24178.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
24179. 
24180. 	# Add Zone to list of zones for display.
24181. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
24182. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
24183. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
24184. 	# ??? Free Stats?
24185. 	# Footer:
24186. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
24187. # 2021-11-17 21:08:29
24188. 
24189. SetVariable(ZoneFooter1, "----------------------------------------------------------
24190. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
24191. #
24192. # Xinclude "..\Commands\DateTimeLastLong.txt"X
24193. #
24194. SetVariable(ZoneFooter2, "Statistics Report:
24195. ------------------
24196.    Size:  
24197.    ------------------------
24198.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24199.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24200.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24201. 
24202.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24203.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24204. 
24205.    Location:
24206.    ------------------------
24207.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24208.             Files End: !ZoneEndCurrent!
24209.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24210.       
24211.    Gap Settings:
24212.    ------------------------
24213.          Gap Requested: !ZoneGapSizePer!%
24214.        Volume Rounding: !ZoneVolRoundUpPer!%
24215.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24216.                  
24217.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
24218.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
24219.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
24220.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
24221.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
24222.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
24223.      
24224.    Free Space after Zone:
24225.    ------------------------
24226.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24227.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24228.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24229. 
24230. Directory and Files Select:
24231. ---------------------------
24232. !ZoneTypeSelectCurrent!               
24233. ---------------------------
24234. ----------------------------------------------------------
24235. ")
24236. 
24237. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
24238. 
24239. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
24240. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
24241. RunProgram("..\Commands\WriteDateTime.bat LastZone")
24242. 
24243. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
24244. 
24245. 
24246. 
24247. 	# Add Zone Details to Report.	
24248. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
24249. !ZoneFooter!")
24250. 
24251. 
24252. 	
24253. 	# Footer:
24254. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
24255. # 2021-11-17 21:08:29
24256. 
24257. SetVariable(ZoneFooter1, "----------------------------------------------------------
24258. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
24259. #
24260. # Xinclude "..\Commands\DateTimeLastLong.txt"X
24261. #
24262. SetVariable(ZoneFooter2, "Statistics Report:
24263. ------------------
24264.    Size:  
24265.    ------------------------
24266.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24267.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24268.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24269. 
24270.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24271.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24272. 
24273.    Location:
24274.    ------------------------
24275.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24276.             Files End: !ZoneEndCurrent!
24277.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24278.       
24279.    Gap Settings:
24280.    ------------------------
24281.          Gap Requested: !ZoneGapSizePer!%
24282.        Volume Rounding: !ZoneVolRoundUpPer!%
24283.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24284.                  
24285.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
24286.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
24287.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
24288.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
24289.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
24290.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
24291.      
24292.    Free Space after Zone:
24293.    ------------------------
24294.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24295.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24296.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24297. 
24298. Directory and Files Select:
24299. ---------------------------
24300. !ZoneTypeSelectCurrent!               
24301. ---------------------------
24302. ----------------------------------------------------------
24303. ")
24304. 
24305. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
24306. 
24307. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
24308. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
24309. RunProgram("..\Commands\WriteDateTime.bat LastZone")
24310. 
24311. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
24312. 
24313. 
24314. 	SetStatisticsWindowText("!ZoneFooter!")
24315. 	
24316. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
24317. 	# Script: DisplaySetFileStep
24318. 
24319. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24320. 
24321. /* add message and move to a new line. */
24322. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24323. ")
24324. 
24325. /* display the line. (hopefully.) */
24326. # Zone Footer Set Statistics Window Text
24327. 
24328. SetStatisticsWindowText("!Heading!
24329. ----------------------------------------------------------
24330. Zones Processed: 
24331. ----------------------------------------------------------
24332. !ZoneListByLine!
24333. ----------------------------------------------------------
24334. Zone Processing Step:
24335. !ZoneStepByLine!    
24336. ----------------------------------------------------------
24337. ----------------------------------------------------------
24338. Current Zone:
24339. !ZoneFooter!
24340. ----------------------------------------------------------
24341. ----------------------------------------------------------
24342. Volume Statistics:
24343. !VolumeStatisticsDetail!
24344. ----------------------------------------------------------
24345. ----------------------------------------------------------
24346. Zone Detailed Report:
24347. ----------------------------------------------------------
24348. !ZoneStatisticsDetail!
24349. ----------------------------------------------------------
24350. ")
24351. 
24352. 
24353. 
24354. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24355. 
24356. # Script: BannerSet
24357. 
24358. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
24359. 
24360. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
24361. 
24362. Title('!Heading!')
24363. /* pause(1) */
24364. 
24365. /* NOTE: Can't round or truncate to integer precision. */
24366. 
24367. pause(1)
24368. 
24369. # Commands:
24370. 
24371. /* Moves to Zone or above it. */
24372. # MoveUpToZone()
24373. 
24374. # Defrag
24375. 
24376. # Defragment(OPTIONS)
24377. 
24378. /* Shuffles files around trying to make a big enough gap for fragmented files. */
24379. # Defragment()
24380. 
24381. /* Only does files where a gap will fit it. */
24382. # Defragment(Fast)
24383. 
24384. /* Skips fragmented files larger than the Chunck Size. */
24385. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
24386. # Defragment(Chunk Size)
24387. 
24388. /* Moves down to zone and packs zone to beginning if there are gaps. */
24389. /* Can be similar in performance to doing a SortBy. */
24390. # MoveDownFill()
24391. 
24392. # File Action - All - Regular -  SortByName.
24393. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
24394. 	
24395. 
24396. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
24397. 	# Script: DisplaySetFileStep
24398. 
24399. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24400. 
24401. /* add message and move to a new line. */
24402. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24403. ")
24404. 
24405. /* display the line. (hopefully.) */
24406. # Zone Footer Set Statistics Window Text
24407. 
24408. SetStatisticsWindowText("!Heading!
24409. ----------------------------------------------------------
24410. Zones Processed: 
24411. ----------------------------------------------------------
24412. !ZoneListByLine!
24413. ----------------------------------------------------------
24414. Zone Processing Step:
24415. !ZoneStepByLine!    
24416. ----------------------------------------------------------
24417. ----------------------------------------------------------
24418. Current Zone:
24419. !ZoneFooter!
24420. ----------------------------------------------------------
24421. ----------------------------------------------------------
24422. Volume Statistics:
24423. !VolumeStatisticsDetail!
24424. ----------------------------------------------------------
24425. ----------------------------------------------------------
24426. Zone Detailed Report:
24427. ----------------------------------------------------------
24428. !ZoneStatisticsDetail!
24429. ----------------------------------------------------------
24430. ")
24431. 
24432. 
24433. 
24434. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24435. 
24436. # Script: BannerSet
24437. 
24438. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
24439. 
24440. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
24441. 
24442. Title('!Heading!')
24443. /* pause(1) */
24444. 
24445. /* NOTE: Can't round or truncate to integer precision. */
24446. 
24447. pause(1)
24448. 
24449. 	# Script: ZoneDoFooter
24450. 
24451. /* ---------------------------------------------------------- */
24452. # File Select
24453. 	# Select Statments
24454. # File Actions 
24455. 	# Standard or OS File Actions.
24456. 	# Resume...
24457. 	
24458. 	# your stuff HERE (X)... post zone (file) file actions code.
24459. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
24460. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24461. 		# (X)
24462. 		
24463. 		/* ??? Set window? */
24464. 	
24465. 	# ADD THE GAP
24466. # Vacate (good for diagnostics)
24467. # DoNotVacate - DO NOT Vacate (recommended)
24468. # DoNotVacate - DO NOT Vacate (recommended)
24469. 
24470. # Vacate
24471. /* AddGap(GapUsedLoc) */
24472. 
24473. # DO Not Vacate
24474. AddGap(GapUsedLoc, DoNotVacate) 
24475. 	
24476. 	
24477. # Script: GapZoneCommand
24478. # *** Moved to setting yours ***
24479. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
24480. # Controlled via settings commands
24481. # DoNotVacate - DO NOT Vacate (recommended)
24482. 
24483. # Vacate
24484. /* AddGap(GapUsedLoc) */
24485. 
24486. # DO Not Vacate
24487. AddGap(GapUsedLoc, DoNotVacate) 
24488. 	
24489. 	
24490. # Vacate /* AddGap(GapUsed) */
24491. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
24492. 	
24493. 
24494. 		
24495. # 
24496. FileEnd
24497. /* ---------------------------------------------------------- */
24498. 
24499. # your stuff HERE (X)... post zone (file) code.
24500. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
24501. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24502. 	# (X)
24503. 
24504. SetVariable(FileStepDescription,"Zone finished, reporting.")
24505. # Script: DisplaySetFileStep
24506. 
24507. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24508. 
24509. /* add message and move to a new line. */
24510. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24511. ")
24512. 
24513. /* display the line. (hopefully.) */
24514. # Zone Footer Set Statistics Window Text
24515. 
24516. SetStatisticsWindowText("!Heading!
24517. ----------------------------------------------------------
24518. Zones Processed: 
24519. ----------------------------------------------------------
24520. !ZoneListByLine!
24521. ----------------------------------------------------------
24522. Zone Processing Step:
24523. !ZoneStepByLine!    
24524. ----------------------------------------------------------
24525. ----------------------------------------------------------
24526. Current Zone:
24527. !ZoneFooter!
24528. ----------------------------------------------------------
24529. ----------------------------------------------------------
24530. Volume Statistics:
24531. !VolumeStatisticsDetail!
24532. ----------------------------------------------------------
24533. ----------------------------------------------------------
24534. Zone Detailed Report:
24535. ----------------------------------------------------------
24536. !ZoneStatisticsDetail!
24537. ----------------------------------------------------------
24538. ")
24539. 
24540. 
24541. 
24542. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24543. 
24544. # Script: BannerSet
24545. 
24546. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
24547. 
24548. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
24549. 
24550. Title('!Heading!')
24551. /* pause(1) */
24552. 
24553. /* NOTE: Can't round or truncate to integer precision. */
24554. 
24555. pause(1)
24556. 
24557. # Script: ZoneWhenFinished
24558. 
24559. # Script: BannerSet
24560. 
24561. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
24562. 
24563. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
24564. 
24565. Title('!Heading!')
24566. /* pause(1) */
24567. 
24568. /* NOTE: Can't round or truncate to integer precision. */
24569. 
24570. # Script: BannerLog
24571. 
24572. AppendLogfile("!LogFileName!", "!Title!")
24573. 
24574. 
24575. 
24576. # Zone Statistics	
24577. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
24578. 
24579. # Footer:
24580. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
24581. # 2021-11-17 21:08:29
24582. 
24583. SetVariable(ZoneFooter1, "----------------------------------------------------------
24584. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
24585. #
24586. # Xinclude "..\Commands\DateTimeLastLong.txt"X
24587. #
24588. SetVariable(ZoneFooter2, "Statistics Report:
24589. ------------------
24590.    Size:  
24591.    ------------------------
24592.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24593.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24594.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24595. 
24596.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24597.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24598. 
24599.    Location:
24600.    ------------------------
24601.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24602.             Files End: !ZoneEndCurrent!
24603.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24604.       
24605.    Gap Settings:
24606.    ------------------------
24607.          Gap Requested: !ZoneGapSizePer!%
24608.        Volume Rounding: !ZoneVolRoundUpPer!%
24609.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24610.                  
24611.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
24612.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
24613.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
24614.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
24615.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
24616.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
24617.      
24618.    Free Space after Zone:
24619.    ------------------------
24620.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24621.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24622.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24623. 
24624. Directory and Files Select:
24625. ---------------------------
24626. !ZoneTypeSelectCurrent!               
24627. ---------------------------
24628. ----------------------------------------------------------
24629. ")
24630. 
24631. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
24632. 
24633. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
24634. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
24635. RunProgram("..\Commands\WriteDateTime.bat LastZone")
24636. 
24637. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
24638. 
24639. 
24640. 
24641. AppendLogfile("!LogFileName!", ".")
24642. AppendLogfile("!LogFileName!", "!ZoneFooter!")
24643. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
24644. AppendLogfile("!LogFileName!", ".")
24645. 
24646. # Zone Footer Set Statistics Window Text
24647. 
24648. SetStatisticsWindowText("!Heading!
24649. ----------------------------------------------------------
24650. Zones Processed: 
24651. ----------------------------------------------------------
24652. !ZoneListByLine!
24653. ----------------------------------------------------------
24654. Zone Processing Step:
24655. !ZoneStepByLine!    
24656. ----------------------------------------------------------
24657. ----------------------------------------------------------
24658. Current Zone:
24659. !ZoneFooter!
24660. ----------------------------------------------------------
24661. ----------------------------------------------------------
24662. Volume Statistics:
24663. !VolumeStatisticsDetail!
24664. ----------------------------------------------------------
24665. ----------------------------------------------------------
24666. Zone Detailed Report:
24667. ----------------------------------------------------------
24668. !ZoneStatisticsDetail!
24669. ----------------------------------------------------------
24670. ")
24671. 
24672. 
24673. 
24674. /* pause() */
24675. /* pause() */
24676. 
24677. 
24678. 
24679. 
24680. /* ---------------------------------------------------------- */
24681. 
24682. 
24683. /* ---------------------------------------------------------- */
24684. /* Zone 17 SystemOtherData System Other and Data */
24685. # Script: DisplayColors - Zone Dark
24686. # Processed
24687. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
24688. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
24689. 
24690. # Light Green and Yellow
24691. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
24692. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
24693. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
24694. 
24695. # Script: DefragZoneTypeSystemOtherData
24696. /* ---------------------------------------------------------- */
24697. /* Zone SystemOtherData System Other and Data */
24698. SetVariable(ZoneLabel, "!ZoneLabelSystemOtherData!")
24699. SetVariable(ZoneDescription, "!ZoneDescriptionSystemOtherData!")
24700. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSystemOtherData!")
24701. SetVariable(ZoneGapSize, "!ZoneGapSizeSystemOtherData!")
24702. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectSystemOtherData
24703. # SystemOtherData start.
24704. # NotBlobsArchivesBu start.
24705. (not (
24706. # Blobs start.
24707. (
24708. # BlobsAndExceptions start.
24709. ( not(
24710.   FileName("*.bat")
24711.   or FileName("*.css")
24712.   or FileName("*.dll")
24713.   or FileName("*.exe")
24714.   or FileName("*.htm*")
24715.   or FileName("*.jar")
24716.   or FileName("*.js")
24717.   or FileName("*.script")
24718.   or FileName("*.wsf")
24719.   or (
24720. # Databases start.
24721. (
24722.   FileName("*.crypt*")
24723.   or FileName("*.db*")
24724.   or FileName("*.rdb*")
24725.   or FileName("*.dc*")
24726.   or FileName("*.dict*")
24727.   or FileName("*.?db*")
24728.   or FileName("*.?rdb*")
24729.   or FileName("*.md*")
24730.   or FileName("*.myd")
24731.   or FileName("*.ndf")
24732.   or FileName("*.ns?")
24733.   or FileName("*.pab")
24734.   or FileName("*.pst")
24735.   or FileName("*.sd?*")
24736.   or FileName("*.sq**")
24737.   or FileName("*.tmd")
24738.   or FileName("*.tps")
24739.   or FileName("*.tr*")
24740. )
24741. # Databases end.
24742. 
24743.     # BlobsAndExceptions
24744.     or 
24745. # Data start.
24746. (
24747.   DirectoryName("Data*")
24748.   or DirectoryName("Device*")
24749.   or DirectoryName("Export*")
24750.   or DirectoryName("Import*")
24751.   or DirectoryName("Log*")
24752.   or DirectoryName("*Log")
24753.   or DirectoryName("Maintenance*")
24754.   or DirectoryName("Rec*")
24755.   or DirectoryName("Sales*")
24756.   or DirectoryName("Search*")
24757.   or DirectoryName("User*")
24758. )
24759. # Data end.
24760. 
24761.     # BlobsAndExceptions
24762.   )
24763. ) )
24764. # BlobsAndExceptions end.
24765. 
24766. # Blobs
24767. ) and (
24768.   Size(BlobFileSize,0)
24769.   or (
24770.     FileName("*.arj")
24771.     or FileName("*.bup")
24772.     or FileName("*.bz2")
24773.     or FileName("*.chm")
24774.     or FileName("*.dvr-ms")
24775.     or FileName("*.gz")
24776.     or FileName("*.ifo")
24777.     or FileName("*.lzh")
24778.     or FileName("*.pdf")
24779.     or FileName("*.rpm")
24780.     or FileName("*.wmv")
24781.     or FileName("*.vob")
24782.     or FileName("*.z")
24783.   ) 
24784. )
24785. # Blobs end.
24786. 
24787. # NotBlobsArchivesBu
24788. or 
24789. # Archives start.
24790. (
24791.   DirectoryName("*Archive*")
24792.   or DirectoryName("*History*")
24793.   or DirectoryName("*Old")
24794.   or DirectoryName("* Old *")
24795.   or DirectoryName("Old *")
24796. 
24797.   or FileName("*.7z")
24798.   or FileName("*.cab")
24799.   or FileName("*.iso")
24800.   or FileName("*.msi")
24801.   or FileName("*.old")
24802.   or FileName("*.rar")
24803.   or FileName("*.tar")
24804.   or FileName("*.zip")
24805.   or
24806. # WinSysLow start.
24807. (
24808.   # Bad idea. This pushed lots of programs and data to archive.
24809.   # DirectoryName("$*")
24810.   # or DirectoryName("0*")
24811.   # or DirectoryName("1*")
24812.   # or DirectoryName("2*")
24813.   # or DirectoryName("3*")
24814.   # or DirectoryName("4*")
24815.   # or DirectoryName("5*")
24816.   # or DirectoryName("6*")
24817.   # or DirectoryName("7*")
24818.   # or DirectoryName("8*")
24819.   # or DirectoryName("9*")
24820.   # or 
24821.   DirectoryName("dllcache")
24822.   or DirectoryName("Downloaded Installations")
24823.   or DirectoryName("Ehome")
24824.   or DirectoryName("Fonts")
24825.   or DirectoryName("Help")
24826.   or DirectoryName("I386")
24827.   or DirectoryName("ie?updates")
24828.   or DirectoryName("Installer")
24829.   or DirectoryName("Installshield Installation Information")
24830.   or DirectoryName("IME")
24831.   or DirectoryName("*RECYCLE*")
24832.   or DirectoryName("ServicePackFiles")
24833.   or DirectoryName("SoftwareDistribution")
24834.   or DirectoryName("Speech")
24835.   or DirectoryName("Symbols")
24836.   or DirectoryName("System Volume Information")
24837.   or DirectoryName("windows.old")
24838. )
24839. # WinSysLow end.
24840. 
24841.   # Archives
24842. )
24843. # Archives end.
24844. 
24845. # NotBlobsArchivesBu
24846. or
24847. # Backups start.
24848. (
24849.   DirectoryName("*Backup*")
24850.   or DirectoryName("*Bu")
24851.   or DirectoryName("* Bu *")
24852.   or DirectoryName("Bu *")
24853. 
24854.   or FileName("*.bak")
24855.   or FileName("* - Copy*")
24856. )
24857. # Backups end.
24858. 
24859. # NotBlobsArchivesBu
24860. ) )
24861. # NotBlobsArchivesBu end.
24862. 
24863. # SystemOtherData
24864. and ( 
24865. # Data start.
24866. (
24867.   DirectoryName("Data*")
24868.   or DirectoryName("Device*")
24869.   or DirectoryName("Export*")
24870.   or DirectoryName("Import*")
24871.   or DirectoryName("Log*")
24872.   or DirectoryName("*Log")
24873.   or DirectoryName("Maintenance*")
24874.   or DirectoryName("Rec*")
24875.   or DirectoryName("Sales*")
24876.   or DirectoryName("Search*")
24877.   or DirectoryName("User*")
24878. )
24879. # Data end.
24880.  
24881. # SystemOtherData
24882. or  
24883. # Databases start.
24884. (
24885.   FileName("*.crypt*")
24886.   or FileName("*.db*")
24887.   or FileName("*.rdb*")
24888.   or FileName("*.dc*")
24889.   or FileName("*.dict*")
24890.   or FileName("*.?db*")
24891.   or FileName("*.?rdb*")
24892.   or FileName("*.md*")
24893.   or FileName("*.myd")
24894.   or FileName("*.ndf")
24895.   or FileName("*.ns?")
24896.   or FileName("*.pab")
24897.   or FileName("*.pst")
24898.   or FileName("*.sd?*")
24899.   or FileName("*.sq**")
24900.   or FileName("*.tmd")
24901.   or FileName("*.tps")
24902.   or FileName("*.tr*")
24903. )
24904. # Databases end.
24905. 
24906. # SystemOtherData
24907. )
24908. # SystemOtherData end.
24909. ')
24910. 
24911. 	# Script: ZoneDoHeader
24912. 
24913. # Script: ZoneWhenStarted
24914. RunProgram("..\Commands\WriteDateTime.bat")
24915. 
24916. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
24917. # Script: DisplaySetZone
24918. 
24919. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
24920. SetVariable(FileStepDescription,	"")
24921. 
24922. SetVariable(ZoneStepByLine, 			"Zone started.
24923. ")
24924. 
24925. # Script: BannerDescriptionSet
24926. 
24927. # Script: BannerSet
24928. 
24929. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
24930. 
24931. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
24932. 
24933. Title('!Heading!')
24934. /* pause(1) */
24935. 
24936. /* NOTE: Can't round or truncate to integer precision. */
24937. 
24938. # Script: BannerLog
24939. 
24940. AppendLogfile("!LogFileName!", "!Title!")
24941. 
24942. 
24943. 
24944. pause(1)
24945. 
24946. 
24947. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
24948. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
24949. 
24950. SetVariable(ZoneStepNoCurrent, 0)
24951. 
24952. 
24953. # Script: ZoneDoCurrentClear
24954. 
24955. SetVariable(ZoneTypeSelectCurrent, 		"")
24956. 
24957. SetVariable(ZoneBeginCurrent, 			0)
24958. SetVariable(ZoneBeginPerCurrent, 		0)
24959. SetVariable(ZoneEndCurrent, 			0)
24960. SetVariable(ZoneEndPerCurrent, 			0)
24961. 
24962. SetVariable(ZoneSizeCurrent,			0)
24963. SetVariable(ZoneSizePerCurrent,			0)
24964. 
24965. SetVariable(ZoneGapRequestedCurrent,	0)
24966. SetVariable(ZoneGapRoundedCurrent, 		0)
24967. SetVariable(ZoneGapAdjustedCurrent, 	0)
24968. SetVariable(ZoneGapAvailableCurrent, 	0)
24969. SetVariable(ZoneGapCurrent,				0)
24970. SetVariable(ZoneGapUsedCurrent, 		0)
24971. 
24972. SetVariable(ZoneGapActualCurrent, 		0)
24973. SetVariable(ZoneGapActualPerCurrent, 	0)
24974. 
24975. SetVariable(ZoneSizeActual, 			0)
24976. SetVariable(ZoneSizeActualCurrent,		0)
24977. 
24978. SetVariable(ZoneEndActual, 				0)
24979. SetVariable(ZoneEndActualCurrent,		0)			
24980. SetVariable(ZoneSizeActualPerCurrent, 	0)
24981.       
24982. SetVariable(ZoneFilesFolders,			0)
24983. SetVariable(ZoneFilesFoldersPer,		0) 
24984. 
24985. SetVariable(ZoneFragments,				0)
24986. SetVariable(ZoneFragmentsPer,			0) 
24987. 		
24988. SetVariable(ZoneEndActualCurrent, 		0)
24989. SetVariable(ZoneEndActualPerCurrent, 	0)
24990. 
24991. # Gap Calculation Methodology:
24992. 	# Requested
24993. 	SetVariable(GapRequested, 			0) 
24994. 	SetVariable(GapRequestedStd, 		0) 
24995. 	SetVariable(GapRequestedMft, 		0) 
24996. 	SetVariable(GapRequestedOs, 		0) 
24997. 	SetVariable(GapRequestedOriginal, 	0) 
24998. 	
24999. 	# Gap Adjustments
25000. 	SetVariable(GapRounded, 			0)
25001. 	# SetVariable(GapAdjusted, 			0)
25002. 	SetVariable(GapAvailable, 			0)
25003. 	SetVariable(GapCurrent, 			0)
25004. 	SetVariable(GapActual, 				0)
25005. 	SetVariable(GapUsed, 				0)
25006. 	
25007. 	# Gap Adjustments
25008. 	SetVariable(GapRoundedLoc, 			0)
25009. 	# SetVariable(GapAdjustedLoc, 		0)
25010. 	SetVariable(GapAvailableLoc, 		0)
25011. 	SetVariable(GapCurrentLoc, 			0)
25012. 	SetVariable(GapActualLoc,			0)
25013. 	SetVariable(GapUsedLoc,				0)
25014. 	
25015. 	# Space usage
25016. 	SetVariable(ZoneFreePerRequested, 	0)
25017. 	SetVariable(ZoneFreePerUsed, 		0)
25018. 
25019. # Gap Size & Rounding
25020. 	SetVariable(ZoneGapSizePer, 		0)
25021. 	SetVariable(ZoneVolRoundUpPer, 		0)
25022. 	
25023. 	# Free Space
25024. 	SetVariable(ZoneFreeUsedPer, 		0)
25025. 	SetVariable(ZoneFreeRequestedPer, 	0)
25026. 
25027. 
25028. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
25029. 
25030. # Footer:
25031. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
25032. # 2021-11-17 21:08:29
25033. 
25034. SetVariable(ZoneFooter1, "----------------------------------------------------------
25035. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
25036. #
25037. # Xinclude "..\Commands\DateTimeLastLong.txt"X
25038. #
25039. SetVariable(ZoneFooter2, "Statistics Report:
25040. ------------------
25041.    Size:  
25042.    ------------------------
25043.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
25044.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
25045.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
25046. 
25047.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
25048.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
25049. 
25050.    Location:
25051.    ------------------------
25052.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
25053.             Files End: !ZoneEndCurrent!
25054.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
25055.       
25056.    Gap Settings:
25057.    ------------------------
25058.          Gap Requested: !ZoneGapSizePer!%
25059.        Volume Rounding: !ZoneVolRoundUpPer!%
25060.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
25061.                  
25062.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
25063.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
25064.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
25065.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
25066.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
25067.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
25068.      
25069.    Free Space after Zone:
25070.    ------------------------
25071.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
25072.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
25073.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
25074. 
25075. Directory and Files Select:
25076. ---------------------------
25077. !ZoneTypeSelectCurrent!               
25078. ---------------------------
25079. ----------------------------------------------------------
25080. ")
25081. 
25082. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
25083. 
25084. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
25085. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
25086. RunProgram("..\Commands\WriteDateTime.bat LastZone")
25087. 
25088. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
25089. 
25090. 
25091. 
25092. # Script: BannerSet
25093. 
25094. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25095. 
25096. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
25097. 
25098. Title('!Heading!')
25099. /* pause(1) */
25100. 
25101. /* NOTE: Can't round or truncate to integer precision. */
25102. 
25103. # Script: BannerLog
25104. 
25105. AppendLogfile("!LogFileName!", "!Title!")
25106. 
25107. 
25108. 
25109. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
25110. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
25111. 
25112. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
25113. 
25114. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:29")
25115. 
25116. # 2021-11-17 21:08:29 
25117. SetVariable(Temp9, DATETIME)
25118. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:04 !ZoneLabel! !ZoneDescription!")
25119. 
25120. SetVariable(ZoneListByLine, "!ZoneListByLine! 
25121. Zone: !ZoneNoCurrent! !Temp9! 0:00:04 !ZoneLabel! !ZoneDescription!")
25122. 
25123. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:04 !ZoneLabel! !ZoneDescription!")
25124. 
25125. 
25126. /* Fixed Zone Position Handling */
25127. /* Literal number: */
25128. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
25129. /* Percentage of disk: */
25130. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
25131. /* Gap */
25132. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
25133. 
25134. /* ---------------------------------------------------------- */
25135. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
25136. # Script: DisplaySetFileStep
25137. 
25138. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25139. 
25140. /* add message and move to a new line. */
25141. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
25142. ")
25143. 
25144. /* display the line. (hopefully.) */
25145. # Zone Footer Set Statistics Window Text
25146. 
25147. SetStatisticsWindowText("!Heading!
25148. ----------------------------------------------------------
25149. Zones Processed: 
25150. ----------------------------------------------------------
25151. !ZoneListByLine!
25152. ----------------------------------------------------------
25153. Zone Processing Step:
25154. !ZoneStepByLine!    
25155. ----------------------------------------------------------
25156. ----------------------------------------------------------
25157. Current Zone:
25158. !ZoneFooter!
25159. ----------------------------------------------------------
25160. ----------------------------------------------------------
25161. Volume Statistics:
25162. !VolumeStatisticsDetail!
25163. ----------------------------------------------------------
25164. ----------------------------------------------------------
25165. Zone Detailed Report:
25166. ----------------------------------------------------------
25167. !ZoneStatisticsDetail!
25168. ----------------------------------------------------------
25169. ")
25170. 
25171. 
25172. 
25173. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
25174. 
25175. # Script: BannerSet
25176. 
25177. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25178. 
25179. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
25180. 
25181. Title('!Heading!')
25182. /* pause(1) */
25183. 
25184. /* NOTE: Can't round or truncate to integer precision. */
25185. 
25186. pause(1)
25187. 
25188. # your stuff HERE (X)... pre file select code.
25189. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
25190. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
25191. 	# (X)
25192. 
25193. FileSelect
25194. 
25195. 	# your stuff can't really go here (errors.)
25196. 	# maybe for some reason I don't know of...
25197. 	
25198. 	# Actions next...
25199. 	# Script: ZoneDo ZoneTypeSelectSystemOtherData
25200. # SystemOtherData start.
25201. # NotBlobsArchivesBu start.
25202. (not (
25203. # Blobs start.
25204. (
25205. # BlobsAndExceptions start.
25206. ( not(
25207.   FileName("*.bat")
25208.   or FileName("*.css")
25209.   or FileName("*.dll")
25210.   or FileName("*.exe")
25211.   or FileName("*.htm*")
25212.   or FileName("*.jar")
25213.   or FileName("*.js")
25214.   or FileName("*.script")
25215.   or FileName("*.wsf")
25216.   or (
25217. # Databases start.
25218. (
25219.   FileName("*.crypt*")
25220.   or FileName("*.db*")
25221.   or FileName("*.rdb*")
25222.   or FileName("*.dc*")
25223.   or FileName("*.dict*")
25224.   or FileName("*.?db*")
25225.   or FileName("*.?rdb*")
25226.   or FileName("*.md*")
25227.   or FileName("*.myd")
25228.   or FileName("*.ndf")
25229.   or FileName("*.ns?")
25230.   or FileName("*.pab")
25231.   or FileName("*.pst")
25232.   or FileName("*.sd?*")
25233.   or FileName("*.sq**")
25234.   or FileName("*.tmd")
25235.   or FileName("*.tps")
25236.   or FileName("*.tr*")
25237. )
25238. # Databases end.
25239. 
25240.     # BlobsAndExceptions
25241.     or 
25242. # Data start.
25243. (
25244.   DirectoryName("Data*")
25245.   or DirectoryName("Device*")
25246.   or DirectoryName("Export*")
25247.   or DirectoryName("Import*")
25248.   or DirectoryName("Log*")
25249.   or DirectoryName("*Log")
25250.   or DirectoryName("Maintenance*")
25251.   or DirectoryName("Rec*")
25252.   or DirectoryName("Sales*")
25253.   or DirectoryName("Search*")
25254.   or DirectoryName("User*")
25255. )
25256. # Data end.
25257. 
25258.     # BlobsAndExceptions
25259.   )
25260. ) )
25261. # BlobsAndExceptions end.
25262. 
25263. # Blobs
25264. ) and (
25265.   Size(BlobFileSize,0)
25266.   or (
25267.     FileName("*.arj")
25268.     or FileName("*.bup")
25269.     or FileName("*.bz2")
25270.     or FileName("*.chm")
25271.     or FileName("*.dvr-ms")
25272.     or FileName("*.gz")
25273.     or FileName("*.ifo")
25274.     or FileName("*.lzh")
25275.     or FileName("*.pdf")
25276.     or FileName("*.rpm")
25277.     or FileName("*.wmv")
25278.     or FileName("*.vob")
25279.     or FileName("*.z")
25280.   ) 
25281. )
25282. # Blobs end.
25283. 
25284. # NotBlobsArchivesBu
25285. or 
25286. # Archives start.
25287. (
25288.   DirectoryName("*Archive*")
25289.   or DirectoryName("*History*")
25290.   or DirectoryName("*Old")
25291.   or DirectoryName("* Old *")
25292.   or DirectoryName("Old *")
25293. 
25294.   or FileName("*.7z")
25295.   or FileName("*.cab")
25296.   or FileName("*.iso")
25297.   or FileName("*.msi")
25298.   or FileName("*.old")
25299.   or FileName("*.rar")
25300.   or FileName("*.tar")
25301.   or FileName("*.zip")
25302.   or
25303. # WinSysLow start.
25304. (
25305.   # Bad idea. This pushed lots of programs and data to archive.
25306.   # DirectoryName("$*")
25307.   # or DirectoryName("0*")
25308.   # or DirectoryName("1*")
25309.   # or DirectoryName("2*")
25310.   # or DirectoryName("3*")
25311.   # or DirectoryName("4*")
25312.   # or DirectoryName("5*")
25313.   # or DirectoryName("6*")
25314.   # or DirectoryName("7*")
25315.   # or DirectoryName("8*")
25316.   # or DirectoryName("9*")
25317.   # or 
25318.   DirectoryName("dllcache")
25319.   or DirectoryName("Downloaded Installations")
25320.   or DirectoryName("Ehome")
25321.   or DirectoryName("Fonts")
25322.   or DirectoryName("Help")
25323.   or DirectoryName("I386")
25324.   or DirectoryName("ie?updates")
25325.   or DirectoryName("Installer")
25326.   or DirectoryName("Installshield Installation Information")
25327.   or DirectoryName("IME")
25328.   or DirectoryName("*RECYCLE*")
25329.   or DirectoryName("ServicePackFiles")
25330.   or DirectoryName("SoftwareDistribution")
25331.   or DirectoryName("Speech")
25332.   or DirectoryName("Symbols")
25333.   or DirectoryName("System Volume Information")
25334.   or DirectoryName("windows.old")
25335. )
25336. # WinSysLow end.
25337. 
25338.   # Archives
25339. )
25340. # Archives end.
25341. 
25342. # NotBlobsArchivesBu
25343. or
25344. # Backups start.
25345. (
25346.   DirectoryName("*Backup*")
25347.   or DirectoryName("*Bu")
25348.   or DirectoryName("* Bu *")
25349.   or DirectoryName("Bu *")
25350. 
25351.   or FileName("*.bak")
25352.   or FileName("* - Copy*")
25353. )
25354. # Backups end.
25355. 
25356. # NotBlobsArchivesBu
25357. ) )
25358. # NotBlobsArchivesBu end.
25359. 
25360. # SystemOtherData
25361. and ( 
25362. # Data start.
25363. (
25364.   DirectoryName("Data*")
25365.   or DirectoryName("Device*")
25366.   or DirectoryName("Export*")
25367.   or DirectoryName("Import*")
25368.   or DirectoryName("Log*")
25369.   or DirectoryName("*Log")
25370.   or DirectoryName("Maintenance*")
25371.   or DirectoryName("Rec*")
25372.   or DirectoryName("Sales*")
25373.   or DirectoryName("Search*")
25374.   or DirectoryName("User*")
25375. )
25376. # Data end.
25377.  
25378. # SystemOtherData
25379. or  
25380. # Databases start.
25381. (
25382.   FileName("*.crypt*")
25383.   or FileName("*.db*")
25384.   or FileName("*.rdb*")
25385.   or FileName("*.dc*")
25386.   or FileName("*.dict*")
25387.   or FileName("*.?db*")
25388.   or FileName("*.?rdb*")
25389.   or FileName("*.md*")
25390.   or FileName("*.myd")
25391.   or FileName("*.ndf")
25392.   or FileName("*.ns?")
25393.   or FileName("*.pab")
25394.   or FileName("*.pst")
25395.   or FileName("*.sd?*")
25396.   or FileName("*.sq**")
25397.   or FileName("*.tmd")
25398.   or FileName("*.tps")
25399.   or FileName("*.tr*")
25400. )
25401. # Databases end.
25402. 
25403. # SystemOtherData
25404. )
25405. # SystemOtherData end.
25406. 
25407. 	# Script: ZoneDoAction
25408. # Zone Do File Action - SortByName.
25409. 
25410. FileActions
25411. 
25412. 		/* ---------------------------------------------------------- */
25413. 	# Gap
25414. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
25415. 		# Script: DisplaySetFileStep
25416. 
25417. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25418. 
25419. /* add message and move to a new line. */
25420. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
25421. ")
25422. 
25423. /* display the line. (hopefully.) */
25424. # Zone Footer Set Statistics Window Text
25425. 
25426. SetStatisticsWindowText("!Heading!
25427. ----------------------------------------------------------
25428. Zones Processed: 
25429. ----------------------------------------------------------
25430. !ZoneListByLine!
25431. ----------------------------------------------------------
25432. Zone Processing Step:
25433. !ZoneStepByLine!    
25434. ----------------------------------------------------------
25435. ----------------------------------------------------------
25436. Current Zone:
25437. !ZoneFooter!
25438. ----------------------------------------------------------
25439. ----------------------------------------------------------
25440. Volume Statistics:
25441. !VolumeStatisticsDetail!
25442. ----------------------------------------------------------
25443. ----------------------------------------------------------
25444. Zone Detailed Report:
25445. ----------------------------------------------------------
25446. !ZoneStatisticsDetail!
25447. ----------------------------------------------------------
25448. ")
25449. 
25450. 
25451. 
25452. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
25453. 
25454. # Script: BannerSet
25455. 
25456. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
25457. 
25458. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
25459. 
25460. Title('!Heading!')
25461. /* pause(1) */
25462. 
25463. /* NOTE: Can't round or truncate to integer precision. */
25464. 
25465. pause(1)
25466. 	
25467. 	# ACTUAL GAP
25468. 		/* AddGap Variant. */
25469. 	  	# Zone Do Gap
25470. # Gap Calculation Methods:
25471. 
25472. /* 1) Anything you need to add first. */
25473. /* empty */
25474. 
25475. /* ---------------------------------------------------------- */
25476. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
25477. 	# GapRequestedStd.
25478. 
25479. 		/* ---------------------------------------------------------- */
25480. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
25481. 
25482. 		# Gap Calculation Methods:
25483. 
25484. /* AddGap Variants */
25485. 
25486. 	/* Standard */
25487. 		# Gap Calculation Methods:
25488. 	/* AddGap Variants */
25489. 	/* Standard */
25490. 
25491. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
25492. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
25493. 
25494. 	SetVariable(GapRequested, GapRequestedStd)
25495. 	
25496. 
25497. 	/* MFT Low High Method */
25498. 		# Gap Calculation Methods:
25499. 	/* AddGap Variants */
25500. 	/* MFT Low High Method */
25501. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
25502. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
25503. 	SetVariable(GapRequested, GapRequestedMft)
25504. 	
25505. 
25506. 	/* OS Volume Type Method */
25507. 		# Gap Calculation Methods:
25508. 	/* AddGap Variants */
25509. 	/* OS Volume Type Method */
25510. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
25511. 	SetVariable(GapRequested, GapRequestedOs)
25512. 
25513. 
25514. 
25515. /* MakeGap Variants */
25516. 
25517. 	/* Original Os 1-3 + MFT 2 */
25518. 		# Gap Calculation Methods:
25519. 	/* MakeGap Variants */
25520. 	/* Original Os 1-3 + MFT 2 */
25521. 	/* plus MFT gap placed inline at the dividing zone. */
25522. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
25523. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
25524. 	SetVariable(GapRequested, GapRequestedOrig)
25525. 	
25526. 	
25527. /* Note: You could comment out the ones not in use */
25528. /* However having the data in the log is useful. */
25529. /* Therefore the following line is otherwise needed. */
25530. 
25531. /* Standard used */
25532. 
25533. SetVariable(GapRequested, GapRequestedStd)
25534. 
25535. # Gap Calculation Methods:
25536. 
25537. /* AddGap Variants */
25538. 	/* Standard */
25539. 	/* MFT Low High Method */
25540. 	/* OS Volume Type Method */
25541. 
25542. /* MakeGap Variants */
25543. 	/* Original Os 1-3 + MFT 2 */
25544. 
25545. /* Note: You could comment out the ones not in use */
25546. /* However having the data in the log is useful. */
25547. /* Therefore the following line is otherwise needed. */
25548. 
25549. /* Standard is used currently */
25550. 
25551. 
25552. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
25553. 
25554. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
25555. 
25556. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
25557. 
25558. /* ---------------------------------------------------------- */
25559. /* 3) SMALL ZONE ADJUSTMENT. */
25560. /* Gab cant be larger than half the Zone Size. */
25561. 
25562. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
25563. 	
25564. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
25565. 
25566. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
25567. 
25568. /* ---------------------------------------------------------- */
25569. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
25570. # Gap Adjustments.
25571. 
25572. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
25573. 	
25574. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
25575. 
25576. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
25577. 
25578. /* ---------------------------------------------------------- */
25579. # BYPASS THIS.
25580. 	/* This is definitely wrong. */
25581. 	/* The question is can we steal gap from the next zone */
25582. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
25583. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
25584. 		# Zone Overflow.
25585. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
25586. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
25587. 
25588. /* ---------------------------------------------------------- */
25589. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
25590. # Remaining free space available.
25591. 
25592. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
25593. 	
25594. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
25595. 
25596. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
25597. 
25598. /* ---------------------------------------------------------- */
25599. # CURRENT gap to use.
25600. 
25601. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
25602. 
25603. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
25604. 
25605. /* ---------------------------------------------------------- */
25606. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
25607. # Debugging.
25608. 
25609. 	SetVariable(GapUsed, GapCurrent) // for debugging
25610. 
25611. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
25612. 
25613. 		# Your code HERE
25614. 
25615. /* ---------------------------------------------------------- */
25616. /* 7) YOUR CODE. */
25617. # YOUR CODE HERE:
25618. 	# INPUT: GapCurrent or GapCurrentLoc
25619. 	# OUTPUT: GapUsed...
25620. 
25621. /* ---------------------------------------------------------- */
25622. # Gap Size.
25623. # Actual Size of Gap.
25624. 
25625. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
25626. 
25627. /* ---------------------------------------------------------- */
25628. /* xxxxxxxxxxxxxxxxxxxxxx */
25629. # ADD THE GAP
25630. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
25631. /* xxxxxxxxxxxxxxxxxxxxxx */
25632. 
25633. 	
25634. 	# Zone Statistics	
25635. 	# Script: ZoneDoStatistics
25636. # Zone / Volume Statistics and Display
25637. 		
25638. 	# Accumulate Totals
25639.   	# Script: ZoneDoVolumeTotals
25640. 
25641. /* Current total space used (by Zones and Gaps) */
25642. 
25643. SetVariable(VolumeZoneUsed, GapUsed)
25644. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
25645. /* Percentage */
25646. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
25647. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
25648. 
25649. /* Current total of free space requested */
25650. 
25651. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
25652. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
25653. /* Percent. */
25654. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
25655. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
25656. 
25657. /* Current total of free space used */
25658. 
25659. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
25660. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
25661. /* Percent */
25662. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
25663. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
25664. 
25665. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
25666. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
25667. /* Xinclude "..\DebugDisplayPause.MyDc"X */
25668. 
25669. 
25670. 	# Current Values
25671. 	# Script: ZoneDoCurrentSet
25672. 
25673. # Cluster, Sector, Block adjust for display.
25674. 	# Bytes per cluster is volume specific.
25675. 
25676. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
25677. 
25678. # Current Zone values.
25679. 	# Begin, end and size.
25680. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
25681. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
25682. 
25683. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
25684. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
25685. 
25686. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
25687. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
25688. 
25689. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
25690. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
25691. 
25692. 	SetVariable(ZoneFragments,				"!ZONE210N!")
25693. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
25694. 		
25695. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
25696. /* identical code to here: (separation not needed. TEST.) */	
25697. 
25698. # Current Gap, Actual and Free Values
25699. 	# Gap
25700. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
25701. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
25702. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
25703. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
25704. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
25705. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
25706. 	
25707. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
25708. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
25709. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
25710. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
25711. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
25712. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
25713. 	
25714. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
25715. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
25716. 	
25717. 	# Actual Size and End
25718. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
25719. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
25720. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
25721. 	
25722. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
25723. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
25724. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
25725. 
25726. # Gap Size & Rounding
25727. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
25728. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
25729. 	
25730. 	# Free Space
25731. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
25732. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
25733. 
25734. 	# Footer:
25735. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
25736. # 2021-11-17 21:08:29
25737. 
25738. SetVariable(ZoneFooter1, "----------------------------------------------------------
25739. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
25740. #
25741. # Xinclude "..\Commands\DateTimeLastLong.txt"X
25742. #
25743. SetVariable(ZoneFooter2, "Statistics Report:
25744. ------------------
25745.    Size:  
25746.    ------------------------
25747.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
25748.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
25749.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
25750. 
25751.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
25752.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
25753. 
25754.    Location:
25755.    ------------------------
25756.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
25757.             Files End: !ZoneEndCurrent!
25758.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
25759.       
25760.    Gap Settings:
25761.    ------------------------
25762.          Gap Requested: !ZoneGapSizePer!%
25763.        Volume Rounding: !ZoneVolRoundUpPer!%
25764.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
25765.                  
25766.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
25767.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
25768.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
25769.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
25770.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
25771.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
25772.      
25773.    Free Space after Zone:
25774.    ------------------------
25775.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
25776.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
25777.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
25778. 
25779. Directory and Files Select:
25780. ---------------------------
25781. !ZoneTypeSelectCurrent!               
25782. ---------------------------
25783. ----------------------------------------------------------
25784. ")
25785. 
25786. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
25787. 
25788. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
25789. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
25790. RunProgram("..\Commands\WriteDateTime.bat LastZone")
25791. 
25792. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
25793. 
25794. 
25795. 	# Zone Footer Set Statistics Window Text
25796. 
25797. SetStatisticsWindowText("!Heading!
25798. ----------------------------------------------------------
25799. Zones Processed: 
25800. ----------------------------------------------------------
25801. !ZoneListByLine!
25802. ----------------------------------------------------------
25803. Zone Processing Step:
25804. !ZoneStepByLine!    
25805. ----------------------------------------------------------
25806. ----------------------------------------------------------
25807. Current Zone:
25808. !ZoneFooter!
25809. ----------------------------------------------------------
25810. ----------------------------------------------------------
25811. Volume Statistics:
25812. !VolumeStatisticsDetail!
25813. ----------------------------------------------------------
25814. ----------------------------------------------------------
25815. Zone Detailed Report:
25816. ----------------------------------------------------------
25817. !ZoneStatisticsDetail!
25818. ----------------------------------------------------------
25819. ")
25820. 
25821. 
25822. 	
25823.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
25824. 
25825. 	# Add Zone to list of zones for display.
25826. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
25827. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
25828. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
25829. 	# ??? Free Stats?
25830. 	# Footer:
25831. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
25832. # 2021-11-17 21:08:29
25833. 
25834. SetVariable(ZoneFooter1, "----------------------------------------------------------
25835. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
25836. #
25837. # Xinclude "..\Commands\DateTimeLastLong.txt"X
25838. #
25839. SetVariable(ZoneFooter2, "Statistics Report:
25840. ------------------
25841.    Size:  
25842.    ------------------------
25843.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
25844.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
25845.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
25846. 
25847.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
25848.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
25849. 
25850.    Location:
25851.    ------------------------
25852.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
25853.             Files End: !ZoneEndCurrent!
25854.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
25855.       
25856.    Gap Settings:
25857.    ------------------------
25858.          Gap Requested: !ZoneGapSizePer!%
25859.        Volume Rounding: !ZoneVolRoundUpPer!%
25860.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
25861.                  
25862.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
25863.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
25864.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
25865.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
25866.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
25867.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
25868.      
25869.    Free Space after Zone:
25870.    ------------------------
25871.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
25872.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
25873.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
25874. 
25875. Directory and Files Select:
25876. ---------------------------
25877. !ZoneTypeSelectCurrent!               
25878. ---------------------------
25879. ----------------------------------------------------------
25880. ")
25881. 
25882. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
25883. 
25884. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
25885. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
25886. RunProgram("..\Commands\WriteDateTime.bat LastZone")
25887. 
25888. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
25889. 
25890. 
25891. 
25892. 	# Add Zone Details to Report.	
25893. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
25894. !ZoneFooter!")
25895. 
25896. 
25897. 	
25898. 	# Footer:
25899. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
25900. # 2021-11-17 21:08:29
25901. 
25902. SetVariable(ZoneFooter1, "----------------------------------------------------------
25903. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
25904. #
25905. # Xinclude "..\Commands\DateTimeLastLong.txt"X
25906. #
25907. SetVariable(ZoneFooter2, "Statistics Report:
25908. ------------------
25909.    Size:  
25910.    ------------------------
25911.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
25912.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
25913.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
25914. 
25915.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
25916.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
25917. 
25918.    Location:
25919.    ------------------------
25920.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
25921.             Files End: !ZoneEndCurrent!
25922.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
25923.       
25924.    Gap Settings:
25925.    ------------------------
25926.          Gap Requested: !ZoneGapSizePer!%
25927.        Volume Rounding: !ZoneVolRoundUpPer!%
25928.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
25929.                  
25930.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
25931.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
25932.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
25933.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
25934.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
25935.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
25936.      
25937.    Free Space after Zone:
25938.    ------------------------
25939.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
25940.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
25941.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
25942. 
25943. Directory and Files Select:
25944. ---------------------------
25945. !ZoneTypeSelectCurrent!               
25946. ---------------------------
25947. ----------------------------------------------------------
25948. ")
25949. 
25950. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
25951. 
25952. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
25953. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
25954. RunProgram("..\Commands\WriteDateTime.bat LastZone")
25955. 
25956. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
25957. 
25958. 
25959. 	SetStatisticsWindowText("!ZoneFooter!")
25960. 	
25961. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
25962. 	# Script: DisplaySetFileStep
25963. 
25964. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25965. 
25966. /* add message and move to a new line. */
25967. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
25968. ")
25969. 
25970. /* display the line. (hopefully.) */
25971. # Zone Footer Set Statistics Window Text
25972. 
25973. SetStatisticsWindowText("!Heading!
25974. ----------------------------------------------------------
25975. Zones Processed: 
25976. ----------------------------------------------------------
25977. !ZoneListByLine!
25978. ----------------------------------------------------------
25979. Zone Processing Step:
25980. !ZoneStepByLine!    
25981. ----------------------------------------------------------
25982. ----------------------------------------------------------
25983. Current Zone:
25984. !ZoneFooter!
25985. ----------------------------------------------------------
25986. ----------------------------------------------------------
25987. Volume Statistics:
25988. !VolumeStatisticsDetail!
25989. ----------------------------------------------------------
25990. ----------------------------------------------------------
25991. Zone Detailed Report:
25992. ----------------------------------------------------------
25993. !ZoneStatisticsDetail!
25994. ----------------------------------------------------------
25995. ")
25996. 
25997. 
25998. 
25999. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
26000. 
26001. # Script: BannerSet
26002. 
26003. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26004. 
26005. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
26006. 
26007. Title('!Heading!')
26008. /* pause(1) */
26009. 
26010. /* NOTE: Can't round or truncate to integer precision. */
26011. 
26012. pause(1)
26013. 
26014. # Commands:
26015. 
26016. /* Moves to Zone or above it. */
26017. # MoveUpToZone()
26018. 
26019. # Defrag
26020. 
26021. # Defragment(OPTIONS)
26022. 
26023. /* Shuffles files around trying to make a big enough gap for fragmented files. */
26024. # Defragment()
26025. 
26026. /* Only does files where a gap will fit it. */
26027. # Defragment(Fast)
26028. 
26029. /* Skips fragmented files larger than the Chunck Size. */
26030. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
26031. # Defragment(Chunk Size)
26032. 
26033. /* Moves down to zone and packs zone to beginning if there are gaps. */
26034. /* Can be similar in performance to doing a SortBy. */
26035. # MoveDownFill()
26036. 
26037. # File Action - All - Regular -  SortByName.
26038. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
26039. 	
26040. 
26041. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
26042. 	# Script: DisplaySetFileStep
26043. 
26044. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26045. 
26046. /* add message and move to a new line. */
26047. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
26048. ")
26049. 
26050. /* display the line. (hopefully.) */
26051. # Zone Footer Set Statistics Window Text
26052. 
26053. SetStatisticsWindowText("!Heading!
26054. ----------------------------------------------------------
26055. Zones Processed: 
26056. ----------------------------------------------------------
26057. !ZoneListByLine!
26058. ----------------------------------------------------------
26059. Zone Processing Step:
26060. !ZoneStepByLine!    
26061. ----------------------------------------------------------
26062. ----------------------------------------------------------
26063. Current Zone:
26064. !ZoneFooter!
26065. ----------------------------------------------------------
26066. ----------------------------------------------------------
26067. Volume Statistics:
26068. !VolumeStatisticsDetail!
26069. ----------------------------------------------------------
26070. ----------------------------------------------------------
26071. Zone Detailed Report:
26072. ----------------------------------------------------------
26073. !ZoneStatisticsDetail!
26074. ----------------------------------------------------------
26075. ")
26076. 
26077. 
26078. 
26079. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
26080. 
26081. # Script: BannerSet
26082. 
26083. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26084. 
26085. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
26086. 
26087. Title('!Heading!')
26088. /* pause(1) */
26089. 
26090. /* NOTE: Can't round or truncate to integer precision. */
26091. 
26092. pause(1)
26093. 
26094. 	# Script: ZoneDoFooter
26095. 
26096. /* ---------------------------------------------------------- */
26097. # File Select
26098. 	# Select Statments
26099. # File Actions 
26100. 	# Standard or OS File Actions.
26101. 	# Resume...
26102. 	
26103. 	# your stuff HERE (X)... post zone (file) file actions code.
26104. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
26105. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
26106. 		# (X)
26107. 		
26108. 		/* ??? Set window? */
26109. 	
26110. 	# ADD THE GAP
26111. # Vacate (good for diagnostics)
26112. # DoNotVacate - DO NOT Vacate (recommended)
26113. # DoNotVacate - DO NOT Vacate (recommended)
26114. 
26115. # Vacate
26116. /* AddGap(GapUsedLoc) */
26117. 
26118. # DO Not Vacate
26119. AddGap(GapUsedLoc, DoNotVacate) 
26120. 	
26121. 	
26122. # Script: GapZoneCommand
26123. # *** Moved to setting yours ***
26124. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
26125. # Controlled via settings commands
26126. # DoNotVacate - DO NOT Vacate (recommended)
26127. 
26128. # Vacate
26129. /* AddGap(GapUsedLoc) */
26130. 
26131. # DO Not Vacate
26132. AddGap(GapUsedLoc, DoNotVacate) 
26133. 	
26134. 	
26135. # Vacate /* AddGap(GapUsed) */
26136. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
26137. 	
26138. 
26139. 		
26140. # 
26141. FileEnd
26142. /* ---------------------------------------------------------- */
26143. 
26144. # your stuff HERE (X)... post zone (file) code.
26145. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
26146. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
26147. 	# (X)
26148. 
26149. SetVariable(FileStepDescription,"Zone finished, reporting.")
26150. # Script: DisplaySetFileStep
26151. 
26152. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26153. 
26154. /* add message and move to a new line. */
26155. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
26156. ")
26157. 
26158. /* display the line. (hopefully.) */
26159. # Zone Footer Set Statistics Window Text
26160. 
26161. SetStatisticsWindowText("!Heading!
26162. ----------------------------------------------------------
26163. Zones Processed: 
26164. ----------------------------------------------------------
26165. !ZoneListByLine!
26166. ----------------------------------------------------------
26167. Zone Processing Step:
26168. !ZoneStepByLine!    
26169. ----------------------------------------------------------
26170. ----------------------------------------------------------
26171. Current Zone:
26172. !ZoneFooter!
26173. ----------------------------------------------------------
26174. ----------------------------------------------------------
26175. Volume Statistics:
26176. !VolumeStatisticsDetail!
26177. ----------------------------------------------------------
26178. ----------------------------------------------------------
26179. Zone Detailed Report:
26180. ----------------------------------------------------------
26181. !ZoneStatisticsDetail!
26182. ----------------------------------------------------------
26183. ")
26184. 
26185. 
26186. 
26187. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
26188. 
26189. # Script: BannerSet
26190. 
26191. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26192. 
26193. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
26194. 
26195. Title('!Heading!')
26196. /* pause(1) */
26197. 
26198. /* NOTE: Can't round or truncate to integer precision. */
26199. 
26200. pause(1)
26201. 
26202. # Script: ZoneWhenFinished
26203. 
26204. # Script: BannerSet
26205. 
26206. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26207. 
26208. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
26209. 
26210. Title('!Heading!')
26211. /* pause(1) */
26212. 
26213. /* NOTE: Can't round or truncate to integer precision. */
26214. 
26215. # Script: BannerLog
26216. 
26217. AppendLogfile("!LogFileName!", "!Title!")
26218. 
26219. 
26220. 
26221. # Zone Statistics	
26222. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
26223. 
26224. # Footer:
26225. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
26226. # 2021-11-17 21:08:29
26227. 
26228. SetVariable(ZoneFooter1, "----------------------------------------------------------
26229. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
26230. #
26231. # Xinclude "..\Commands\DateTimeLastLong.txt"X
26232. #
26233. SetVariable(ZoneFooter2, "Statistics Report:
26234. ------------------
26235.    Size:  
26236.    ------------------------
26237.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
26238.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
26239.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
26240. 
26241.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
26242.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
26243. 
26244.    Location:
26245.    ------------------------
26246.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
26247.             Files End: !ZoneEndCurrent!
26248.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
26249.       
26250.    Gap Settings:
26251.    ------------------------
26252.          Gap Requested: !ZoneGapSizePer!%
26253.        Volume Rounding: !ZoneVolRoundUpPer!%
26254.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
26255.                  
26256.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
26257.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
26258.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
26259.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
26260.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
26261.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
26262.      
26263.    Free Space after Zone:
26264.    ------------------------
26265.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
26266.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
26267.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
26268. 
26269. Directory and Files Select:
26270. ---------------------------
26271. !ZoneTypeSelectCurrent!               
26272. ---------------------------
26273. ----------------------------------------------------------
26274. ")
26275. 
26276. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
26277. 
26278. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
26279. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
26280. RunProgram("..\Commands\WriteDateTime.bat LastZone")
26281. 
26282. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
26283. 
26284. 
26285. 
26286. AppendLogfile("!LogFileName!", ".")
26287. AppendLogfile("!LogFileName!", "!ZoneFooter!")
26288. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
26289. AppendLogfile("!LogFileName!", ".")
26290. 
26291. # Zone Footer Set Statistics Window Text
26292. 
26293. SetStatisticsWindowText("!Heading!
26294. ----------------------------------------------------------
26295. Zones Processed: 
26296. ----------------------------------------------------------
26297. !ZoneListByLine!
26298. ----------------------------------------------------------
26299. Zone Processing Step:
26300. !ZoneStepByLine!    
26301. ----------------------------------------------------------
26302. ----------------------------------------------------------
26303. Current Zone:
26304. !ZoneFooter!
26305. ----------------------------------------------------------
26306. ----------------------------------------------------------
26307. Volume Statistics:
26308. !VolumeStatisticsDetail!
26309. ----------------------------------------------------------
26310. ----------------------------------------------------------
26311. Zone Detailed Report:
26312. ----------------------------------------------------------
26313. !ZoneStatisticsDetail!
26314. ----------------------------------------------------------
26315. ")
26316. 
26317. 
26318. 
26319. /* pause() */
26320. /* pause() */
26321. 
26322. 
26323. 
26324. 
26325. /* ---------------------------------------------------------- */
26326. 
26327. 
26328. /* ---------------------------------------------------------- */
26329. /* Zone 18 Reference & World */
26330. # Script: DisplayColors - Zone Dark
26331. # Processed
26332. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
26333. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
26334. 
26335. # Light Green and Yellow
26336. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
26337. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
26338. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
26339. 
26340. # Script: DefragZoneTypeReference
26341. /* ---------------------------------------------------------- */
26342. /* Zone Reference & World */
26343. SetVariable(ZoneLabel, "!ZoneLabelReference!")
26344. SetVariable(ZoneDescription, "!ZoneDescriptionReference!")
26345. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpReference!")
26346. SetVariable(ZoneGapSize, "!ZoneGapSizeReference!")
26347. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectReference
26348. # Reference start.
26349. # NotBlobsArchivesBu start.
26350. (not (
26351. # Blobs start.
26352. (
26353. # BlobsAndExceptions start.
26354. ( not(
26355.   FileName("*.bat")
26356.   or FileName("*.css")
26357.   or FileName("*.dll")
26358.   or FileName("*.exe")
26359.   or FileName("*.htm*")
26360.   or FileName("*.jar")
26361.   or FileName("*.js")
26362.   or FileName("*.script")
26363.   or FileName("*.wsf")
26364.   or (
26365. # Databases start.
26366. (
26367.   FileName("*.crypt*")
26368.   or FileName("*.db*")
26369.   or FileName("*.rdb*")
26370.   or FileName("*.dc*")
26371.   or FileName("*.dict*")
26372.   or FileName("*.?db*")
26373.   or FileName("*.?rdb*")
26374.   or FileName("*.md*")
26375.   or FileName("*.myd")
26376.   or FileName("*.ndf")
26377.   or FileName("*.ns?")
26378.   or FileName("*.pab")
26379.   or FileName("*.pst")
26380.   or FileName("*.sd?*")
26381.   or FileName("*.sq**")
26382.   or FileName("*.tmd")
26383.   or FileName("*.tps")
26384.   or FileName("*.tr*")
26385. )
26386. # Databases end.
26387. 
26388.     # BlobsAndExceptions
26389.     or 
26390. # Data start.
26391. (
26392.   DirectoryName("Data*")
26393.   or DirectoryName("Device*")
26394.   or DirectoryName("Export*")
26395.   or DirectoryName("Import*")
26396.   or DirectoryName("Log*")
26397.   or DirectoryName("*Log")
26398.   or DirectoryName("Maintenance*")
26399.   or DirectoryName("Rec*")
26400.   or DirectoryName("Sales*")
26401.   or DirectoryName("Search*")
26402.   or DirectoryName("User*")
26403. )
26404. # Data end.
26405. 
26406.     # BlobsAndExceptions
26407.   )
26408. ) )
26409. # BlobsAndExceptions end.
26410. 
26411. # Blobs
26412. ) and (
26413.   Size(BlobFileSize,0)
26414.   or (
26415.     FileName("*.arj")
26416.     or FileName("*.bup")
26417.     or FileName("*.bz2")
26418.     or FileName("*.chm")
26419.     or FileName("*.dvr-ms")
26420.     or FileName("*.gz")
26421.     or FileName("*.ifo")
26422.     or FileName("*.lzh")
26423.     or FileName("*.pdf")
26424.     or FileName("*.rpm")
26425.     or FileName("*.wmv")
26426.     or FileName("*.vob")
26427.     or FileName("*.z")
26428.   ) 
26429. )
26430. # Blobs end.
26431. 
26432. # NotBlobsArchivesBu
26433. or 
26434. # Archives start.
26435. (
26436.   DirectoryName("*Archive*")
26437.   or DirectoryName("*History*")
26438.   or DirectoryName("*Old")
26439.   or DirectoryName("* Old *")
26440.   or DirectoryName("Old *")
26441. 
26442.   or FileName("*.7z")
26443.   or FileName("*.cab")
26444.   or FileName("*.iso")
26445.   or FileName("*.msi")
26446.   or FileName("*.old")
26447.   or FileName("*.rar")
26448.   or FileName("*.tar")
26449.   or FileName("*.zip")
26450.   or
26451. # WinSysLow start.
26452. (
26453.   # Bad idea. This pushed lots of programs and data to archive.
26454.   # DirectoryName("$*")
26455.   # or DirectoryName("0*")
26456.   # or DirectoryName("1*")
26457.   # or DirectoryName("2*")
26458.   # or DirectoryName("3*")
26459.   # or DirectoryName("4*")
26460.   # or DirectoryName("5*")
26461.   # or DirectoryName("6*")
26462.   # or DirectoryName("7*")
26463.   # or DirectoryName("8*")
26464.   # or DirectoryName("9*")
26465.   # or 
26466.   DirectoryName("dllcache")
26467.   or DirectoryName("Downloaded Installations")
26468.   or DirectoryName("Ehome")
26469.   or DirectoryName("Fonts")
26470.   or DirectoryName("Help")
26471.   or DirectoryName("I386")
26472.   or DirectoryName("ie?updates")
26473.   or DirectoryName("Installer")
26474.   or DirectoryName("Installshield Installation Information")
26475.   or DirectoryName("IME")
26476.   or DirectoryName("*RECYCLE*")
26477.   or DirectoryName("ServicePackFiles")
26478.   or DirectoryName("SoftwareDistribution")
26479.   or DirectoryName("Speech")
26480.   or DirectoryName("Symbols")
26481.   or DirectoryName("System Volume Information")
26482.   or DirectoryName("windows.old")
26483. )
26484. # WinSysLow end.
26485. 
26486.   # Archives
26487. )
26488. # Archives end.
26489. 
26490. # NotBlobsArchivesBu
26491. or
26492. # Backups start.
26493. (
26494.   DirectoryName("*Backup*")
26495.   or DirectoryName("*Bu")
26496.   or DirectoryName("* Bu *")
26497.   or DirectoryName("Bu *")
26498. 
26499.   or FileName("*.bak")
26500.   or FileName("* - Copy*")
26501. )
26502. # Backups end.
26503. 
26504. # NotBlobsArchivesBu
26505. ) )
26506. # NotBlobsArchivesBu end.
26507. 
26508. # Reference
26509. and (
26510. # Reference start.
26511. (
26512.   DirectoryName("World*") or
26513.   DirectoryName("Education*") or
26514.   DirectoryName("Entertainment*") or
26515.   DirectoryName("Food*") or
26516.   DirectoryName("Geography*") or
26517.   DirectoryName("Help*") or
26518.   DirectoryName("Humo*") or
26519.   DirectoryName("Internet*") or
26520.   DirectoryName("Legal*") or
26521.   DirectoryName("Linquistics*") or
26522.   DirectoryName("Media*") or
26523.   DirectoryName("Multimedia*") or
26524.   DirectoryName("Reference*") or
26525.   DirectoryName("Sales*") or
26526.   DirectoryName("Science*") or
26527.   DirectoryName("Social*") or
26528.   DirectoryName("Technology*")
26529. )
26530. # Reference end.
26531. 
26532. # Reference
26533. )
26534. # Reference end.
26535. ')
26536. 
26537. 	# Script: ZoneDoHeader
26538. 
26539. # Script: ZoneWhenStarted
26540. RunProgram("..\Commands\WriteDateTime.bat")
26541. 
26542. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
26543. # Script: DisplaySetZone
26544. 
26545. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
26546. SetVariable(FileStepDescription,	"")
26547. 
26548. SetVariable(ZoneStepByLine, 			"Zone started.
26549. ")
26550. 
26551. # Script: BannerDescriptionSet
26552. 
26553. # Script: BannerSet
26554. 
26555. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26556. 
26557. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
26558. 
26559. Title('!Heading!')
26560. /* pause(1) */
26561. 
26562. /* NOTE: Can't round or truncate to integer precision. */
26563. 
26564. # Script: BannerLog
26565. 
26566. AppendLogfile("!LogFileName!", "!Title!")
26567. 
26568. 
26569. 
26570. pause(1)
26571. 
26572. 
26573. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
26574. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
26575. 
26576. SetVariable(ZoneStepNoCurrent, 0)
26577. 
26578. 
26579. # Script: ZoneDoCurrentClear
26580. 
26581. SetVariable(ZoneTypeSelectCurrent, 		"")
26582. 
26583. SetVariable(ZoneBeginCurrent, 			0)
26584. SetVariable(ZoneBeginPerCurrent, 		0)
26585. SetVariable(ZoneEndCurrent, 			0)
26586. SetVariable(ZoneEndPerCurrent, 			0)
26587. 
26588. SetVariable(ZoneSizeCurrent,			0)
26589. SetVariable(ZoneSizePerCurrent,			0)
26590. 
26591. SetVariable(ZoneGapRequestedCurrent,	0)
26592. SetVariable(ZoneGapRoundedCurrent, 		0)
26593. SetVariable(ZoneGapAdjustedCurrent, 	0)
26594. SetVariable(ZoneGapAvailableCurrent, 	0)
26595. SetVariable(ZoneGapCurrent,				0)
26596. SetVariable(ZoneGapUsedCurrent, 		0)
26597. 
26598. SetVariable(ZoneGapActualCurrent, 		0)
26599. SetVariable(ZoneGapActualPerCurrent, 	0)
26600. 
26601. SetVariable(ZoneSizeActual, 			0)
26602. SetVariable(ZoneSizeActualCurrent,		0)
26603. 
26604. SetVariable(ZoneEndActual, 				0)
26605. SetVariable(ZoneEndActualCurrent,		0)			
26606. SetVariable(ZoneSizeActualPerCurrent, 	0)
26607.       
26608. SetVariable(ZoneFilesFolders,			0)
26609. SetVariable(ZoneFilesFoldersPer,		0) 
26610. 
26611. SetVariable(ZoneFragments,				0)
26612. SetVariable(ZoneFragmentsPer,			0) 
26613. 		
26614. SetVariable(ZoneEndActualCurrent, 		0)
26615. SetVariable(ZoneEndActualPerCurrent, 	0)
26616. 
26617. # Gap Calculation Methodology:
26618. 	# Requested
26619. 	SetVariable(GapRequested, 			0) 
26620. 	SetVariable(GapRequestedStd, 		0) 
26621. 	SetVariable(GapRequestedMft, 		0) 
26622. 	SetVariable(GapRequestedOs, 		0) 
26623. 	SetVariable(GapRequestedOriginal, 	0) 
26624. 	
26625. 	# Gap Adjustments
26626. 	SetVariable(GapRounded, 			0)
26627. 	# SetVariable(GapAdjusted, 			0)
26628. 	SetVariable(GapAvailable, 			0)
26629. 	SetVariable(GapCurrent, 			0)
26630. 	SetVariable(GapActual, 				0)
26631. 	SetVariable(GapUsed, 				0)
26632. 	
26633. 	# Gap Adjustments
26634. 	SetVariable(GapRoundedLoc, 			0)
26635. 	# SetVariable(GapAdjustedLoc, 		0)
26636. 	SetVariable(GapAvailableLoc, 		0)
26637. 	SetVariable(GapCurrentLoc, 			0)
26638. 	SetVariable(GapActualLoc,			0)
26639. 	SetVariable(GapUsedLoc,				0)
26640. 	
26641. 	# Space usage
26642. 	SetVariable(ZoneFreePerRequested, 	0)
26643. 	SetVariable(ZoneFreePerUsed, 		0)
26644. 
26645. # Gap Size & Rounding
26646. 	SetVariable(ZoneGapSizePer, 		0)
26647. 	SetVariable(ZoneVolRoundUpPer, 		0)
26648. 	
26649. 	# Free Space
26650. 	SetVariable(ZoneFreeUsedPer, 		0)
26651. 	SetVariable(ZoneFreeRequestedPer, 	0)
26652. 
26653. 
26654. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
26655. 
26656. # Footer:
26657. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
26658. # 2021-11-17 21:08:29
26659. 
26660. SetVariable(ZoneFooter1, "----------------------------------------------------------
26661. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
26662. #
26663. # Xinclude "..\Commands\DateTimeLastLong.txt"X
26664. #
26665. SetVariable(ZoneFooter2, "Statistics Report:
26666. ------------------
26667.    Size:  
26668.    ------------------------
26669.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
26670.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
26671.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
26672. 
26673.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
26674.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
26675. 
26676.    Location:
26677.    ------------------------
26678.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
26679.             Files End: !ZoneEndCurrent!
26680.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
26681.       
26682.    Gap Settings:
26683.    ------------------------
26684.          Gap Requested: !ZoneGapSizePer!%
26685.        Volume Rounding: !ZoneVolRoundUpPer!%
26686.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
26687.                  
26688.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
26689.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
26690.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
26691.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
26692.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
26693.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
26694.      
26695.    Free Space after Zone:
26696.    ------------------------
26697.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
26698.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
26699.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
26700. 
26701. Directory and Files Select:
26702. ---------------------------
26703. !ZoneTypeSelectCurrent!               
26704. ---------------------------
26705. ----------------------------------------------------------
26706. ")
26707. 
26708. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
26709. 
26710. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
26711. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
26712. RunProgram("..\Commands\WriteDateTime.bat LastZone")
26713. 
26714. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
26715. 
26716. 
26717. 
26718. # Script: BannerSet
26719. 
26720. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26721. 
26722. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
26723. 
26724. Title('!Heading!')
26725. /* pause(1) */
26726. 
26727. /* NOTE: Can't round or truncate to integer precision. */
26728. 
26729. # Script: BannerLog
26730. 
26731. AppendLogfile("!LogFileName!", "!Title!")
26732. 
26733. 
26734. 
26735. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
26736. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
26737. 
26738. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
26739. 
26740. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:29")
26741. 
26742. # 2021-11-17 21:08:29 
26743. SetVariable(Temp9, DATETIME)
26744. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:04 !ZoneLabel! !ZoneDescription!")
26745. 
26746. SetVariable(ZoneListByLine, "!ZoneListByLine! 
26747. Zone: !ZoneNoCurrent! !Temp9! 0:00:04 !ZoneLabel! !ZoneDescription!")
26748. 
26749. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:04 !ZoneLabel! !ZoneDescription!")
26750. 
26751. 
26752. /* Fixed Zone Position Handling */
26753. /* Literal number: */
26754. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
26755. /* Percentage of disk: */
26756. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
26757. /* Gap */
26758. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
26759. 
26760. /* ---------------------------------------------------------- */
26761. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
26762. # Script: DisplaySetFileStep
26763. 
26764. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26765. 
26766. /* add message and move to a new line. */
26767. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
26768. ")
26769. 
26770. /* display the line. (hopefully.) */
26771. # Zone Footer Set Statistics Window Text
26772. 
26773. SetStatisticsWindowText("!Heading!
26774. ----------------------------------------------------------
26775. Zones Processed: 
26776. ----------------------------------------------------------
26777. !ZoneListByLine!
26778. ----------------------------------------------------------
26779. Zone Processing Step:
26780. !ZoneStepByLine!    
26781. ----------------------------------------------------------
26782. ----------------------------------------------------------
26783. Current Zone:
26784. !ZoneFooter!
26785. ----------------------------------------------------------
26786. ----------------------------------------------------------
26787. Volume Statistics:
26788. !VolumeStatisticsDetail!
26789. ----------------------------------------------------------
26790. ----------------------------------------------------------
26791. Zone Detailed Report:
26792. ----------------------------------------------------------
26793. !ZoneStatisticsDetail!
26794. ----------------------------------------------------------
26795. ")
26796. 
26797. 
26798. 
26799. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
26800. 
26801. # Script: BannerSet
26802. 
26803. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
26804. 
26805. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
26806. 
26807. Title('!Heading!')
26808. /* pause(1) */
26809. 
26810. /* NOTE: Can't round or truncate to integer precision. */
26811. 
26812. pause(1)
26813. 
26814. # your stuff HERE (X)... pre file select code.
26815. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
26816. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
26817. 	# (X)
26818. 
26819. FileSelect
26820. 
26821. 	# your stuff can't really go here (errors.)
26822. 	# maybe for some reason I don't know of...
26823. 	
26824. 	# Actions next...
26825. 	# Script: ZoneDo ZoneTypeSelectReference
26826. # Reference start.
26827. # NotBlobsArchivesBu start.
26828. (not (
26829. # Blobs start.
26830. (
26831. # BlobsAndExceptions start.
26832. ( not(
26833.   FileName("*.bat")
26834.   or FileName("*.css")
26835.   or FileName("*.dll")
26836.   or FileName("*.exe")
26837.   or FileName("*.htm*")
26838.   or FileName("*.jar")
26839.   or FileName("*.js")
26840.   or FileName("*.script")
26841.   or FileName("*.wsf")
26842.   or (
26843. # Databases start.
26844. (
26845.   FileName("*.crypt*")
26846.   or FileName("*.db*")
26847.   or FileName("*.rdb*")
26848.   or FileName("*.dc*")
26849.   or FileName("*.dict*")
26850.   or FileName("*.?db*")
26851.   or FileName("*.?rdb*")
26852.   or FileName("*.md*")
26853.   or FileName("*.myd")
26854.   or FileName("*.ndf")
26855.   or FileName("*.ns?")
26856.   or FileName("*.pab")
26857.   or FileName("*.pst")
26858.   or FileName("*.sd?*")
26859.   or FileName("*.sq**")
26860.   or FileName("*.tmd")
26861.   or FileName("*.tps")
26862.   or FileName("*.tr*")
26863. )
26864. # Databases end.
26865. 
26866.     # BlobsAndExceptions
26867.     or 
26868. # Data start.
26869. (
26870.   DirectoryName("Data*")
26871.   or DirectoryName("Device*")
26872.   or DirectoryName("Export*")
26873.   or DirectoryName("Import*")
26874.   or DirectoryName("Log*")
26875.   or DirectoryName("*Log")
26876.   or DirectoryName("Maintenance*")
26877.   or DirectoryName("Rec*")
26878.   or DirectoryName("Sales*")
26879.   or DirectoryName("Search*")
26880.   or DirectoryName("User*")
26881. )
26882. # Data end.
26883. 
26884.     # BlobsAndExceptions
26885.   )
26886. ) )
26887. # BlobsAndExceptions end.
26888. 
26889. # Blobs
26890. ) and (
26891.   Size(BlobFileSize,0)
26892.   or (
26893.     FileName("*.arj")
26894.     or FileName("*.bup")
26895.     or FileName("*.bz2")
26896.     or FileName("*.chm")
26897.     or FileName("*.dvr-ms")
26898.     or FileName("*.gz")
26899.     or FileName("*.ifo")
26900.     or FileName("*.lzh")
26901.     or FileName("*.pdf")
26902.     or FileName("*.rpm")
26903.     or FileName("*.wmv")
26904.     or FileName("*.vob")
26905.     or FileName("*.z")
26906.   ) 
26907. )
26908. # Blobs end.
26909. 
26910. # NotBlobsArchivesBu
26911. or 
26912. # Archives start.
26913. (
26914.   DirectoryName("*Archive*")
26915.   or DirectoryName("*History*")
26916.   or DirectoryName("*Old")
26917.   or DirectoryName("* Old *")
26918.   or DirectoryName("Old *")
26919. 
26920.   or FileName("*.7z")
26921.   or FileName("*.cab")
26922.   or FileName("*.iso")
26923.   or FileName("*.msi")
26924.   or FileName("*.old")
26925.   or FileName("*.rar")
26926.   or FileName("*.tar")
26927.   or FileName("*.zip")
26928.   or
26929. # WinSysLow start.
26930. (
26931.   # Bad idea. This pushed lots of programs and data to archive.
26932.   # DirectoryName("$*")
26933.   # or DirectoryName("0*")
26934.   # or DirectoryName("1*")
26935.   # or DirectoryName("2*")
26936.   # or DirectoryName("3*")
26937.   # or DirectoryName("4*")
26938.   # or DirectoryName("5*")
26939.   # or DirectoryName("6*")
26940.   # or DirectoryName("7*")
26941.   # or DirectoryName("8*")
26942.   # or DirectoryName("9*")
26943.   # or 
26944.   DirectoryName("dllcache")
26945.   or DirectoryName("Downloaded Installations")
26946.   or DirectoryName("Ehome")
26947.   or DirectoryName("Fonts")
26948.   or DirectoryName("Help")
26949.   or DirectoryName("I386")
26950.   or DirectoryName("ie?updates")
26951.   or DirectoryName("Installer")
26952.   or DirectoryName("Installshield Installation Information")
26953.   or DirectoryName("IME")
26954.   or DirectoryName("*RECYCLE*")
26955.   or DirectoryName("ServicePackFiles")
26956.   or DirectoryName("SoftwareDistribution")
26957.   or DirectoryName("Speech")
26958.   or DirectoryName("Symbols")
26959.   or DirectoryName("System Volume Information")
26960.   or DirectoryName("windows.old")
26961. )
26962. # WinSysLow end.
26963. 
26964.   # Archives
26965. )
26966. # Archives end.
26967. 
26968. # NotBlobsArchivesBu
26969. or
26970. # Backups start.
26971. (
26972.   DirectoryName("*Backup*")
26973.   or DirectoryName("*Bu")
26974.   or DirectoryName("* Bu *")
26975.   or DirectoryName("Bu *")
26976. 
26977.   or FileName("*.bak")
26978.   or FileName("* - Copy*")
26979. )
26980. # Backups end.
26981. 
26982. # NotBlobsArchivesBu
26983. ) )
26984. # NotBlobsArchivesBu end.
26985. 
26986. # Reference
26987. and (
26988. # Reference start.
26989. (
26990.   DirectoryName("World*") or
26991.   DirectoryName("Education*") or
26992.   DirectoryName("Entertainment*") or
26993.   DirectoryName("Food*") or
26994.   DirectoryName("Geography*") or
26995.   DirectoryName("Help*") or
26996.   DirectoryName("Humo*") or
26997.   DirectoryName("Internet*") or
26998.   DirectoryName("Legal*") or
26999.   DirectoryName("Linquistics*") or
27000.   DirectoryName("Media*") or
27001.   DirectoryName("Multimedia*") or
27002.   DirectoryName("Reference*") or
27003.   DirectoryName("Sales*") or
27004.   DirectoryName("Science*") or
27005.   DirectoryName("Social*") or
27006.   DirectoryName("Technology*")
27007. )
27008. # Reference end.
27009. 
27010. # Reference
27011. )
27012. # Reference end.
27013. 
27014. 	# Script: ZoneDoAction
27015. # Zone Do File Action - SortByName.
27016. 
27017. FileActions
27018. 
27019. 		/* ---------------------------------------------------------- */
27020. 	# Gap
27021. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
27022. 		# Script: DisplaySetFileStep
27023. 
27024. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27025. 
27026. /* add message and move to a new line. */
27027. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27028. ")
27029. 
27030. /* display the line. (hopefully.) */
27031. # Zone Footer Set Statistics Window Text
27032. 
27033. SetStatisticsWindowText("!Heading!
27034. ----------------------------------------------------------
27035. Zones Processed: 
27036. ----------------------------------------------------------
27037. !ZoneListByLine!
27038. ----------------------------------------------------------
27039. Zone Processing Step:
27040. !ZoneStepByLine!    
27041. ----------------------------------------------------------
27042. ----------------------------------------------------------
27043. Current Zone:
27044. !ZoneFooter!
27045. ----------------------------------------------------------
27046. ----------------------------------------------------------
27047. Volume Statistics:
27048. !VolumeStatisticsDetail!
27049. ----------------------------------------------------------
27050. ----------------------------------------------------------
27051. Zone Detailed Report:
27052. ----------------------------------------------------------
27053. !ZoneStatisticsDetail!
27054. ----------------------------------------------------------
27055. ")
27056. 
27057. 
27058. 
27059. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27060. 
27061. # Script: BannerSet
27062. 
27063. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
27064. 
27065. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
27066. 
27067. Title('!Heading!')
27068. /* pause(1) */
27069. 
27070. /* NOTE: Can't round or truncate to integer precision. */
27071. 
27072. pause(1)
27073. 	
27074. 	# ACTUAL GAP
27075. 		/* AddGap Variant. */
27076. 	  	# Zone Do Gap
27077. # Gap Calculation Methods:
27078. 
27079. /* 1) Anything you need to add first. */
27080. /* empty */
27081. 
27082. /* ---------------------------------------------------------- */
27083. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
27084. 	# GapRequestedStd.
27085. 
27086. 		/* ---------------------------------------------------------- */
27087. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
27088. 
27089. 		# Gap Calculation Methods:
27090. 
27091. /* AddGap Variants */
27092. 
27093. 	/* Standard */
27094. 		# Gap Calculation Methods:
27095. 	/* AddGap Variants */
27096. 	/* Standard */
27097. 
27098. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
27099. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
27100. 
27101. 	SetVariable(GapRequested, GapRequestedStd)
27102. 	
27103. 
27104. 	/* MFT Low High Method */
27105. 		# Gap Calculation Methods:
27106. 	/* AddGap Variants */
27107. 	/* MFT Low High Method */
27108. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
27109. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
27110. 	SetVariable(GapRequested, GapRequestedMft)
27111. 	
27112. 
27113. 	/* OS Volume Type Method */
27114. 		# Gap Calculation Methods:
27115. 	/* AddGap Variants */
27116. 	/* OS Volume Type Method */
27117. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
27118. 	SetVariable(GapRequested, GapRequestedOs)
27119. 
27120. 
27121. 
27122. /* MakeGap Variants */
27123. 
27124. 	/* Original Os 1-3 + MFT 2 */
27125. 		# Gap Calculation Methods:
27126. 	/* MakeGap Variants */
27127. 	/* Original Os 1-3 + MFT 2 */
27128. 	/* plus MFT gap placed inline at the dividing zone. */
27129. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
27130. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
27131. 	SetVariable(GapRequested, GapRequestedOrig)
27132. 	
27133. 	
27134. /* Note: You could comment out the ones not in use */
27135. /* However having the data in the log is useful. */
27136. /* Therefore the following line is otherwise needed. */
27137. 
27138. /* Standard used */
27139. 
27140. SetVariable(GapRequested, GapRequestedStd)
27141. 
27142. # Gap Calculation Methods:
27143. 
27144. /* AddGap Variants */
27145. 	/* Standard */
27146. 	/* MFT Low High Method */
27147. 	/* OS Volume Type Method */
27148. 
27149. /* MakeGap Variants */
27150. 	/* Original Os 1-3 + MFT 2 */
27151. 
27152. /* Note: You could comment out the ones not in use */
27153. /* However having the data in the log is useful. */
27154. /* Therefore the following line is otherwise needed. */
27155. 
27156. /* Standard is used currently */
27157. 
27158. 
27159. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
27160. 
27161. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
27162. 
27163. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
27164. 
27165. /* ---------------------------------------------------------- */
27166. /* 3) SMALL ZONE ADJUSTMENT. */
27167. /* Gab cant be larger than half the Zone Size. */
27168. 
27169. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
27170. 	
27171. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
27172. 
27173. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
27174. 
27175. /* ---------------------------------------------------------- */
27176. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
27177. # Gap Adjustments.
27178. 
27179. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
27180. 	
27181. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
27182. 
27183. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
27184. 
27185. /* ---------------------------------------------------------- */
27186. # BYPASS THIS.
27187. 	/* This is definitely wrong. */
27188. 	/* The question is can we steal gap from the next zone */
27189. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
27190. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
27191. 		# Zone Overflow.
27192. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
27193. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
27194. 
27195. /* ---------------------------------------------------------- */
27196. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
27197. # Remaining free space available.
27198. 
27199. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
27200. 	
27201. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
27202. 
27203. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
27204. 
27205. /* ---------------------------------------------------------- */
27206. # CURRENT gap to use.
27207. 
27208. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
27209. 
27210. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
27211. 
27212. /* ---------------------------------------------------------- */
27213. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
27214. # Debugging.
27215. 
27216. 	SetVariable(GapUsed, GapCurrent) // for debugging
27217. 
27218. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
27219. 
27220. 		# Your code HERE
27221. 
27222. /* ---------------------------------------------------------- */
27223. /* 7) YOUR CODE. */
27224. # YOUR CODE HERE:
27225. 	# INPUT: GapCurrent or GapCurrentLoc
27226. 	# OUTPUT: GapUsed...
27227. 
27228. /* ---------------------------------------------------------- */
27229. # Gap Size.
27230. # Actual Size of Gap.
27231. 
27232. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
27233. 
27234. /* ---------------------------------------------------------- */
27235. /* xxxxxxxxxxxxxxxxxxxxxx */
27236. # ADD THE GAP
27237. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
27238. /* xxxxxxxxxxxxxxxxxxxxxx */
27239. 
27240. 	
27241. 	# Zone Statistics	
27242. 	# Script: ZoneDoStatistics
27243. # Zone / Volume Statistics and Display
27244. 		
27245. 	# Accumulate Totals
27246.   	# Script: ZoneDoVolumeTotals
27247. 
27248. /* Current total space used (by Zones and Gaps) */
27249. 
27250. SetVariable(VolumeZoneUsed, GapUsed)
27251. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
27252. /* Percentage */
27253. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
27254. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
27255. 
27256. /* Current total of free space requested */
27257. 
27258. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
27259. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
27260. /* Percent. */
27261. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
27262. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
27263. 
27264. /* Current total of free space used */
27265. 
27266. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
27267. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
27268. /* Percent */
27269. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
27270. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
27271. 
27272. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
27273. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
27274. /* Xinclude "..\DebugDisplayPause.MyDc"X */
27275. 
27276. 
27277. 	# Current Values
27278. 	# Script: ZoneDoCurrentSet
27279. 
27280. # Cluster, Sector, Block adjust for display.
27281. 	# Bytes per cluster is volume specific.
27282. 
27283. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
27284. 
27285. # Current Zone values.
27286. 	# Begin, end and size.
27287. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
27288. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
27289. 
27290. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
27291. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
27292. 
27293. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
27294. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
27295. 
27296. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
27297. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
27298. 
27299. 	SetVariable(ZoneFragments,				"!ZONE210N!")
27300. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
27301. 		
27302. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
27303. /* identical code to here: (separation not needed. TEST.) */	
27304. 
27305. # Current Gap, Actual and Free Values
27306. 	# Gap
27307. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
27308. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
27309. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
27310. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
27311. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
27312. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
27313. 	
27314. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
27315. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
27316. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
27317. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
27318. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
27319. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
27320. 	
27321. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
27322. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
27323. 	
27324. 	# Actual Size and End
27325. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
27326. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
27327. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
27328. 	
27329. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
27330. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
27331. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
27332. 
27333. # Gap Size & Rounding
27334. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
27335. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
27336. 	
27337. 	# Free Space
27338. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
27339. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
27340. 
27341. 	# Footer:
27342. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
27343. # 2021-11-17 21:08:29
27344. 
27345. SetVariable(ZoneFooter1, "----------------------------------------------------------
27346. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
27347. #
27348. # Xinclude "..\Commands\DateTimeLastLong.txt"X
27349. #
27350. SetVariable(ZoneFooter2, "Statistics Report:
27351. ------------------
27352.    Size:  
27353.    ------------------------
27354.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27355.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27356.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27357. 
27358.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27359.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27360. 
27361.    Location:
27362.    ------------------------
27363.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27364.             Files End: !ZoneEndCurrent!
27365.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27366.       
27367.    Gap Settings:
27368.    ------------------------
27369.          Gap Requested: !ZoneGapSizePer!%
27370.        Volume Rounding: !ZoneVolRoundUpPer!%
27371.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27372.                  
27373.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
27374.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
27375.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
27376.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
27377.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
27378.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
27379.      
27380.    Free Space after Zone:
27381.    ------------------------
27382.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27383.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27384.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27385. 
27386. Directory and Files Select:
27387. ---------------------------
27388. !ZoneTypeSelectCurrent!               
27389. ---------------------------
27390. ----------------------------------------------------------
27391. ")
27392. 
27393. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
27394. 
27395. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
27396. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
27397. RunProgram("..\Commands\WriteDateTime.bat LastZone")
27398. 
27399. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
27400. 
27401. 
27402. 	# Zone Footer Set Statistics Window Text
27403. 
27404. SetStatisticsWindowText("!Heading!
27405. ----------------------------------------------------------
27406. Zones Processed: 
27407. ----------------------------------------------------------
27408. !ZoneListByLine!
27409. ----------------------------------------------------------
27410. Zone Processing Step:
27411. !ZoneStepByLine!    
27412. ----------------------------------------------------------
27413. ----------------------------------------------------------
27414. Current Zone:
27415. !ZoneFooter!
27416. ----------------------------------------------------------
27417. ----------------------------------------------------------
27418. Volume Statistics:
27419. !VolumeStatisticsDetail!
27420. ----------------------------------------------------------
27421. ----------------------------------------------------------
27422. Zone Detailed Report:
27423. ----------------------------------------------------------
27424. !ZoneStatisticsDetail!
27425. ----------------------------------------------------------
27426. ")
27427. 
27428. 
27429. 	
27430.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
27431. 
27432. 	# Add Zone to list of zones for display.
27433. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
27434. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
27435. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
27436. 	# ??? Free Stats?
27437. 	# Footer:
27438. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
27439. # 2021-11-17 21:08:29
27440. 
27441. SetVariable(ZoneFooter1, "----------------------------------------------------------
27442. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
27443. #
27444. # Xinclude "..\Commands\DateTimeLastLong.txt"X
27445. #
27446. SetVariable(ZoneFooter2, "Statistics Report:
27447. ------------------
27448.    Size:  
27449.    ------------------------
27450.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27451.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27452.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27453. 
27454.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27455.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27456. 
27457.    Location:
27458.    ------------------------
27459.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27460.             Files End: !ZoneEndCurrent!
27461.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27462.       
27463.    Gap Settings:
27464.    ------------------------
27465.          Gap Requested: !ZoneGapSizePer!%
27466.        Volume Rounding: !ZoneVolRoundUpPer!%
27467.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27468.                  
27469.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
27470.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
27471.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
27472.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
27473.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
27474.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
27475.      
27476.    Free Space after Zone:
27477.    ------------------------
27478.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27479.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27480.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27481. 
27482. Directory and Files Select:
27483. ---------------------------
27484. !ZoneTypeSelectCurrent!               
27485. ---------------------------
27486. ----------------------------------------------------------
27487. ")
27488. 
27489. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
27490. 
27491. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
27492. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
27493. RunProgram("..\Commands\WriteDateTime.bat LastZone")
27494. 
27495. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
27496. 
27497. 
27498. 
27499. 	# Add Zone Details to Report.	
27500. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
27501. !ZoneFooter!")
27502. 
27503. 
27504. 	
27505. 	# Footer:
27506. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
27507. # 2021-11-17 21:08:29
27508. 
27509. SetVariable(ZoneFooter1, "----------------------------------------------------------
27510. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
27511. #
27512. # Xinclude "..\Commands\DateTimeLastLong.txt"X
27513. #
27514. SetVariable(ZoneFooter2, "Statistics Report:
27515. ------------------
27516.    Size:  
27517.    ------------------------
27518.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27519.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27520.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27521. 
27522.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27523.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27524. 
27525.    Location:
27526.    ------------------------
27527.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27528.             Files End: !ZoneEndCurrent!
27529.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27530.       
27531.    Gap Settings:
27532.    ------------------------
27533.          Gap Requested: !ZoneGapSizePer!%
27534.        Volume Rounding: !ZoneVolRoundUpPer!%
27535.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27536.                  
27537.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
27538.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
27539.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
27540.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
27541.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
27542.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
27543.      
27544.    Free Space after Zone:
27545.    ------------------------
27546.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27547.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27548.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27549. 
27550. Directory and Files Select:
27551. ---------------------------
27552. !ZoneTypeSelectCurrent!               
27553. ---------------------------
27554. ----------------------------------------------------------
27555. ")
27556. 
27557. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
27558. 
27559. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
27560. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
27561. RunProgram("..\Commands\WriteDateTime.bat LastZone")
27562. 
27563. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
27564. 
27565. 
27566. 	SetStatisticsWindowText("!ZoneFooter!")
27567. 	
27568. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
27569. 	# Script: DisplaySetFileStep
27570. 
27571. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27572. 
27573. /* add message and move to a new line. */
27574. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27575. ")
27576. 
27577. /* display the line. (hopefully.) */
27578. # Zone Footer Set Statistics Window Text
27579. 
27580. SetStatisticsWindowText("!Heading!
27581. ----------------------------------------------------------
27582. Zones Processed: 
27583. ----------------------------------------------------------
27584. !ZoneListByLine!
27585. ----------------------------------------------------------
27586. Zone Processing Step:
27587. !ZoneStepByLine!    
27588. ----------------------------------------------------------
27589. ----------------------------------------------------------
27590. Current Zone:
27591. !ZoneFooter!
27592. ----------------------------------------------------------
27593. ----------------------------------------------------------
27594. Volume Statistics:
27595. !VolumeStatisticsDetail!
27596. ----------------------------------------------------------
27597. ----------------------------------------------------------
27598. Zone Detailed Report:
27599. ----------------------------------------------------------
27600. !ZoneStatisticsDetail!
27601. ----------------------------------------------------------
27602. ")
27603. 
27604. 
27605. 
27606. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27607. 
27608. # Script: BannerSet
27609. 
27610. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
27611. 
27612. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
27613. 
27614. Title('!Heading!')
27615. /* pause(1) */
27616. 
27617. /* NOTE: Can't round or truncate to integer precision. */
27618. 
27619. pause(1)
27620. 
27621. # Commands:
27622. 
27623. /* Moves to Zone or above it. */
27624. # MoveUpToZone()
27625. 
27626. # Defrag
27627. 
27628. # Defragment(OPTIONS)
27629. 
27630. /* Shuffles files around trying to make a big enough gap for fragmented files. */
27631. # Defragment()
27632. 
27633. /* Only does files where a gap will fit it. */
27634. # Defragment(Fast)
27635. 
27636. /* Skips fragmented files larger than the Chunck Size. */
27637. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
27638. # Defragment(Chunk Size)
27639. 
27640. /* Moves down to zone and packs zone to beginning if there are gaps. */
27641. /* Can be similar in performance to doing a SortBy. */
27642. # MoveDownFill()
27643. 
27644. # File Action - All - Regular -  SortByName.
27645. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
27646. 	
27647. 
27648. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
27649. 	# Script: DisplaySetFileStep
27650. 
27651. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27652. 
27653. /* add message and move to a new line. */
27654. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27655. ")
27656. 
27657. /* display the line. (hopefully.) */
27658. # Zone Footer Set Statistics Window Text
27659. 
27660. SetStatisticsWindowText("!Heading!
27661. ----------------------------------------------------------
27662. Zones Processed: 
27663. ----------------------------------------------------------
27664. !ZoneListByLine!
27665. ----------------------------------------------------------
27666. Zone Processing Step:
27667. !ZoneStepByLine!    
27668. ----------------------------------------------------------
27669. ----------------------------------------------------------
27670. Current Zone:
27671. !ZoneFooter!
27672. ----------------------------------------------------------
27673. ----------------------------------------------------------
27674. Volume Statistics:
27675. !VolumeStatisticsDetail!
27676. ----------------------------------------------------------
27677. ----------------------------------------------------------
27678. Zone Detailed Report:
27679. ----------------------------------------------------------
27680. !ZoneStatisticsDetail!
27681. ----------------------------------------------------------
27682. ")
27683. 
27684. 
27685. 
27686. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27687. 
27688. # Script: BannerSet
27689. 
27690. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
27691. 
27692. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
27693. 
27694. Title('!Heading!')
27695. /* pause(1) */
27696. 
27697. /* NOTE: Can't round or truncate to integer precision. */
27698. 
27699. pause(1)
27700. 
27701. 	# Script: ZoneDoFooter
27702. 
27703. /* ---------------------------------------------------------- */
27704. # File Select
27705. 	# Select Statments
27706. # File Actions 
27707. 	# Standard or OS File Actions.
27708. 	# Resume...
27709. 	
27710. 	# your stuff HERE (X)... post zone (file) file actions code.
27711. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
27712. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
27713. 		# (X)
27714. 		
27715. 		/* ??? Set window? */
27716. 	
27717. 	# ADD THE GAP
27718. # Vacate (good for diagnostics)
27719. # DoNotVacate - DO NOT Vacate (recommended)
27720. # DoNotVacate - DO NOT Vacate (recommended)
27721. 
27722. # Vacate
27723. /* AddGap(GapUsedLoc) */
27724. 
27725. # DO Not Vacate
27726. AddGap(GapUsedLoc, DoNotVacate) 
27727. 	
27728. 	
27729. # Script: GapZoneCommand
27730. # *** Moved to setting yours ***
27731. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
27732. # Controlled via settings commands
27733. # DoNotVacate - DO NOT Vacate (recommended)
27734. 
27735. # Vacate
27736. /* AddGap(GapUsedLoc) */
27737. 
27738. # DO Not Vacate
27739. AddGap(GapUsedLoc, DoNotVacate) 
27740. 	
27741. 	
27742. # Vacate /* AddGap(GapUsed) */
27743. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
27744. 	
27745. 
27746. 		
27747. # 
27748. FileEnd
27749. /* ---------------------------------------------------------- */
27750. 
27751. # your stuff HERE (X)... post zone (file) code.
27752. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
27753. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
27754. 	# (X)
27755. 
27756. SetVariable(FileStepDescription,"Zone finished, reporting.")
27757. # Script: DisplaySetFileStep
27758. 
27759. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27760. 
27761. /* add message and move to a new line. */
27762. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27763. ")
27764. 
27765. /* display the line. (hopefully.) */
27766. # Zone Footer Set Statistics Window Text
27767. 
27768. SetStatisticsWindowText("!Heading!
27769. ----------------------------------------------------------
27770. Zones Processed: 
27771. ----------------------------------------------------------
27772. !ZoneListByLine!
27773. ----------------------------------------------------------
27774. Zone Processing Step:
27775. !ZoneStepByLine!    
27776. ----------------------------------------------------------
27777. ----------------------------------------------------------
27778. Current Zone:
27779. !ZoneFooter!
27780. ----------------------------------------------------------
27781. ----------------------------------------------------------
27782. Volume Statistics:
27783. !VolumeStatisticsDetail!
27784. ----------------------------------------------------------
27785. ----------------------------------------------------------
27786. Zone Detailed Report:
27787. ----------------------------------------------------------
27788. !ZoneStatisticsDetail!
27789. ----------------------------------------------------------
27790. ")
27791. 
27792. 
27793. 
27794. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27795. 
27796. # Script: BannerSet
27797. 
27798. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
27799. 
27800. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
27801. 
27802. Title('!Heading!')
27803. /* pause(1) */
27804. 
27805. /* NOTE: Can't round or truncate to integer precision. */
27806. 
27807. pause(1)
27808. 
27809. # Script: ZoneWhenFinished
27810. 
27811. # Script: BannerSet
27812. 
27813. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
27814. 
27815. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
27816. 
27817. Title('!Heading!')
27818. /* pause(1) */
27819. 
27820. /* NOTE: Can't round or truncate to integer precision. */
27821. 
27822. # Script: BannerLog
27823. 
27824. AppendLogfile("!LogFileName!", "!Title!")
27825. 
27826. 
27827. 
27828. # Zone Statistics	
27829. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
27830. 
27831. # Footer:
27832. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
27833. # 2021-11-17 21:08:29
27834. 
27835. SetVariable(ZoneFooter1, "----------------------------------------------------------
27836. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
27837. #
27838. # Xinclude "..\Commands\DateTimeLastLong.txt"X
27839. #
27840. SetVariable(ZoneFooter2, "Statistics Report:
27841. ------------------
27842.    Size:  
27843.    ------------------------
27844.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27845.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27846.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27847. 
27848.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27849.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27850. 
27851.    Location:
27852.    ------------------------
27853.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27854.             Files End: !ZoneEndCurrent!
27855.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27856.       
27857.    Gap Settings:
27858.    ------------------------
27859.          Gap Requested: !ZoneGapSizePer!%
27860.        Volume Rounding: !ZoneVolRoundUpPer!%
27861.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27862.                  
27863.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
27864.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
27865.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
27866.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
27867.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
27868.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
27869.      
27870.    Free Space after Zone:
27871.    ------------------------
27872.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27873.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27874.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27875. 
27876. Directory and Files Select:
27877. ---------------------------
27878. !ZoneTypeSelectCurrent!               
27879. ---------------------------
27880. ----------------------------------------------------------
27881. ")
27882. 
27883. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
27884. 
27885. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
27886. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
27887. RunProgram("..\Commands\WriteDateTime.bat LastZone")
27888. 
27889. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
27890. 
27891. 
27892. 
27893. AppendLogfile("!LogFileName!", ".")
27894. AppendLogfile("!LogFileName!", "!ZoneFooter!")
27895. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
27896. AppendLogfile("!LogFileName!", ".")
27897. 
27898. # Zone Footer Set Statistics Window Text
27899. 
27900. SetStatisticsWindowText("!Heading!
27901. ----------------------------------------------------------
27902. Zones Processed: 
27903. ----------------------------------------------------------
27904. !ZoneListByLine!
27905. ----------------------------------------------------------
27906. Zone Processing Step:
27907. !ZoneStepByLine!    
27908. ----------------------------------------------------------
27909. ----------------------------------------------------------
27910. Current Zone:
27911. !ZoneFooter!
27912. ----------------------------------------------------------
27913. ----------------------------------------------------------
27914. Volume Statistics:
27915. !VolumeStatisticsDetail!
27916. ----------------------------------------------------------
27917. ----------------------------------------------------------
27918. Zone Detailed Report:
27919. ----------------------------------------------------------
27920. !ZoneStatisticsDetail!
27921. ----------------------------------------------------------
27922. ")
27923. 
27924. 
27925. 
27926. /* pause() */
27927. /* pause() */
27928. 
27929. 
27930. 
27931. 
27932. /* ---------------------------------------------------------- */
27933. 
27934. 
27935. /* ---------------------------------------------------------- */
27936. /* Zone 19 SpaceHogs (BLOBS) */
27937. # Script: DisplayColors - Zone Dark
27938. # Processed
27939. SetFileColor(All, Processed and not(Fragmented),		0, 		191, 	255)	// Deep sky blue
27940. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
27941. 
27942. # Light Green and Yellow
27943. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
27944. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
27945. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
27946. 
27947. # Script: DefragZoneTypeSpaceHogs
27948. /* ---------------------------------------------------------- */
27949. /* Zone SpaceHogs (BLOBS) */
27950. SetVariable(ZoneLabel, "!ZoneLabelSpaceHogs!")
27951. SetVariable(ZoneDescription, "!ZoneDescriptionSpaceHogs!")
27952. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSpaceHogs!")
27953. SetVariable(ZoneGapSize, "!ZoneGapSizeSpaceHogs!")
27954. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectSpaceHogs
27955. # SpaceHogs start.
27956. not(
27957. # Archives start.
27958. (
27959.   DirectoryName("*Archive*")
27960.   or DirectoryName("*History*")
27961.   or DirectoryName("*Old")
27962.   or DirectoryName("* Old *")
27963.   or DirectoryName("Old *")
27964. 
27965.   or FileName("*.7z")
27966.   or FileName("*.cab")
27967.   or FileName("*.iso")
27968.   or FileName("*.msi")
27969.   or FileName("*.old")
27970.   or FileName("*.rar")
27971.   or FileName("*.tar")
27972.   or FileName("*.zip")
27973.   or
27974. # WinSysLow start.
27975. (
27976.   # Bad idea. This pushed lots of programs and data to archive.
27977.   # DirectoryName("$*")
27978.   # or DirectoryName("0*")
27979.   # or DirectoryName("1*")
27980.   # or DirectoryName("2*")
27981.   # or DirectoryName("3*")
27982.   # or DirectoryName("4*")
27983.   # or DirectoryName("5*")
27984.   # or DirectoryName("6*")
27985.   # or DirectoryName("7*")
27986.   # or DirectoryName("8*")
27987.   # or DirectoryName("9*")
27988.   # or 
27989.   DirectoryName("dllcache")
27990.   or DirectoryName("Downloaded Installations")
27991.   or DirectoryName("Ehome")
27992.   or DirectoryName("Fonts")
27993.   or DirectoryName("Help")
27994.   or DirectoryName("I386")
27995.   or DirectoryName("ie?updates")
27996.   or DirectoryName("Installer")
27997.   or DirectoryName("Installshield Installation Information")
27998.   or DirectoryName("IME")
27999.   or DirectoryName("*RECYCLE*")
28000.   or DirectoryName("ServicePackFiles")
28001.   or DirectoryName("SoftwareDistribution")
28002.   or DirectoryName("Speech")
28003.   or DirectoryName("Symbols")
28004.   or DirectoryName("System Volume Information")
28005.   or DirectoryName("windows.old")
28006. )
28007. # WinSysLow end.
28008. 
28009.   # Archives
28010. )
28011. # Archives end.
28012. 
28013. or 
28014. # Backups start.
28015. (
28016.   DirectoryName("*Backup*")
28017.   or DirectoryName("*Bu")
28018.   or DirectoryName("* Bu *")
28019.   or DirectoryName("Bu *")
28020. 
28021.   or FileName("*.bak")
28022.   or FileName("* - Copy*")
28023. )
28024. # Backups end.
28025. 
28026. # SpaceHogs
28027. ) and (
28028. # Blobs start.
28029. (
28030. # BlobsAndExceptions start.
28031. ( not(
28032.   FileName("*.bat")
28033.   or FileName("*.css")
28034.   or FileName("*.dll")
28035.   or FileName("*.exe")
28036.   or FileName("*.htm*")
28037.   or FileName("*.jar")
28038.   or FileName("*.js")
28039.   or FileName("*.script")
28040.   or FileName("*.wsf")
28041.   or (
28042. # Databases start.
28043. (
28044.   FileName("*.crypt*")
28045.   or FileName("*.db*")
28046.   or FileName("*.rdb*")
28047.   or FileName("*.dc*")
28048.   or FileName("*.dict*")
28049.   or FileName("*.?db*")
28050.   or FileName("*.?rdb*")
28051.   or FileName("*.md*")
28052.   or FileName("*.myd")
28053.   or FileName("*.ndf")
28054.   or FileName("*.ns?")
28055.   or FileName("*.pab")
28056.   or FileName("*.pst")
28057.   or FileName("*.sd?*")
28058.   or FileName("*.sq**")
28059.   or FileName("*.tmd")
28060.   or FileName("*.tps")
28061.   or FileName("*.tr*")
28062. )
28063. # Databases end.
28064. 
28065.     # BlobsAndExceptions
28066.     or 
28067. # Data start.
28068. (
28069.   DirectoryName("Data*")
28070.   or DirectoryName("Device*")
28071.   or DirectoryName("Export*")
28072.   or DirectoryName("Import*")
28073.   or DirectoryName("Log*")
28074.   or DirectoryName("*Log")
28075.   or DirectoryName("Maintenance*")
28076.   or DirectoryName("Rec*")
28077.   or DirectoryName("Sales*")
28078.   or DirectoryName("Search*")
28079.   or DirectoryName("User*")
28080. )
28081. # Data end.
28082. 
28083.     # BlobsAndExceptions
28084.   )
28085. ) )
28086. # BlobsAndExceptions end.
28087. 
28088. # Blobs
28089. ) and (
28090.   Size(BlobFileSize,0)
28091.   or (
28092.     FileName("*.arj")
28093.     or FileName("*.bup")
28094.     or FileName("*.bz2")
28095.     or FileName("*.chm")
28096.     or FileName("*.dvr-ms")
28097.     or FileName("*.gz")
28098.     or FileName("*.ifo")
28099.     or FileName("*.lzh")
28100.     or FileName("*.pdf")
28101.     or FileName("*.rpm")
28102.     or FileName("*.wmv")
28103.     or FileName("*.vob")
28104.     or FileName("*.z")
28105.   ) 
28106. )
28107. # Blobs end.
28108. 
28109. # SpaceHogs
28110. ) 
28111. # SpaceHogs end.
28112. ')
28113. 
28114. /* Note: This should be all Blob Files but not archives and backups */
28115. /* It does not matter in my case because given the sorting the */
28116. /* "z Archive", "z Bu" and "z Backup" directories sort to the end. */
28117. 
28118. 	# Script: ZoneDoHeader
28119. 
28120. # Script: ZoneWhenStarted
28121. RunProgram("..\Commands\WriteDateTime.bat")
28122. 
28123. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
28124. # Script: DisplaySetZone
28125. 
28126. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
28127. SetVariable(FileStepDescription,	"")
28128. 
28129. SetVariable(ZoneStepByLine, 			"Zone started.
28130. ")
28131. 
28132. # Script: BannerDescriptionSet
28133. 
28134. # Script: BannerSet
28135. 
28136. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
28137. 
28138. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
28139. 
28140. Title('!Heading!')
28141. /* pause(1) */
28142. 
28143. /* NOTE: Can't round or truncate to integer precision. */
28144. 
28145. # Script: BannerLog
28146. 
28147. AppendLogfile("!LogFileName!", "!Title!")
28148. 
28149. 
28150. 
28151. pause(1)
28152. 
28153. 
28154. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
28155. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
28156. 
28157. SetVariable(ZoneStepNoCurrent, 0)
28158. 
28159. 
28160. # Script: ZoneDoCurrentClear
28161. 
28162. SetVariable(ZoneTypeSelectCurrent, 		"")
28163. 
28164. SetVariable(ZoneBeginCurrent, 			0)
28165. SetVariable(ZoneBeginPerCurrent, 		0)
28166. SetVariable(ZoneEndCurrent, 			0)
28167. SetVariable(ZoneEndPerCurrent, 			0)
28168. 
28169. SetVariable(ZoneSizeCurrent,			0)
28170. SetVariable(ZoneSizePerCurrent,			0)
28171. 
28172. SetVariable(ZoneGapRequestedCurrent,	0)
28173. SetVariable(ZoneGapRoundedCurrent, 		0)
28174. SetVariable(ZoneGapAdjustedCurrent, 	0)
28175. SetVariable(ZoneGapAvailableCurrent, 	0)
28176. SetVariable(ZoneGapCurrent,				0)
28177. SetVariable(ZoneGapUsedCurrent, 		0)
28178. 
28179. SetVariable(ZoneGapActualCurrent, 		0)
28180. SetVariable(ZoneGapActualPerCurrent, 	0)
28181. 
28182. SetVariable(ZoneSizeActual, 			0)
28183. SetVariable(ZoneSizeActualCurrent,		0)
28184. 
28185. SetVariable(ZoneEndActual, 				0)
28186. SetVariable(ZoneEndActualCurrent,		0)			
28187. SetVariable(ZoneSizeActualPerCurrent, 	0)
28188.       
28189. SetVariable(ZoneFilesFolders,			0)
28190. SetVariable(ZoneFilesFoldersPer,		0) 
28191. 
28192. SetVariable(ZoneFragments,				0)
28193. SetVariable(ZoneFragmentsPer,			0) 
28194. 		
28195. SetVariable(ZoneEndActualCurrent, 		0)
28196. SetVariable(ZoneEndActualPerCurrent, 	0)
28197. 
28198. # Gap Calculation Methodology:
28199. 	# Requested
28200. 	SetVariable(GapRequested, 			0) 
28201. 	SetVariable(GapRequestedStd, 		0) 
28202. 	SetVariable(GapRequestedMft, 		0) 
28203. 	SetVariable(GapRequestedOs, 		0) 
28204. 	SetVariable(GapRequestedOriginal, 	0) 
28205. 	
28206. 	# Gap Adjustments
28207. 	SetVariable(GapRounded, 			0)
28208. 	# SetVariable(GapAdjusted, 			0)
28209. 	SetVariable(GapAvailable, 			0)
28210. 	SetVariable(GapCurrent, 			0)
28211. 	SetVariable(GapActual, 				0)
28212. 	SetVariable(GapUsed, 				0)
28213. 	
28214. 	# Gap Adjustments
28215. 	SetVariable(GapRoundedLoc, 			0)
28216. 	# SetVariable(GapAdjustedLoc, 		0)
28217. 	SetVariable(GapAvailableLoc, 		0)
28218. 	SetVariable(GapCurrentLoc, 			0)
28219. 	SetVariable(GapActualLoc,			0)
28220. 	SetVariable(GapUsedLoc,				0)
28221. 	
28222. 	# Space usage
28223. 	SetVariable(ZoneFreePerRequested, 	0)
28224. 	SetVariable(ZoneFreePerUsed, 		0)
28225. 
28226. # Gap Size & Rounding
28227. 	SetVariable(ZoneGapSizePer, 		0)
28228. 	SetVariable(ZoneVolRoundUpPer, 		0)
28229. 	
28230. 	# Free Space
28231. 	SetVariable(ZoneFreeUsedPer, 		0)
28232. 	SetVariable(ZoneFreeRequestedPer, 	0)
28233. 
28234. 
28235. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
28236. 
28237. # Footer:
28238. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
28239. # 2021-11-17 21:08:29
28240. 
28241. SetVariable(ZoneFooter1, "----------------------------------------------------------
28242. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
28243. #
28244. # Xinclude "..\Commands\DateTimeLastLong.txt"X
28245. #
28246. SetVariable(ZoneFooter2, "Statistics Report:
28247. ------------------
28248.    Size:  
28249.    ------------------------
28250.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
28251.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
28252.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
28253. 
28254.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
28255.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
28256. 
28257.    Location:
28258.    ------------------------
28259.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
28260.             Files End: !ZoneEndCurrent!
28261.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
28262.       
28263.    Gap Settings:
28264.    ------------------------
28265.          Gap Requested: !ZoneGapSizePer!%
28266.        Volume Rounding: !ZoneVolRoundUpPer!%
28267.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
28268.                  
28269.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
28270.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
28271.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
28272.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
28273.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
28274.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
28275.      
28276.    Free Space after Zone:
28277.    ------------------------
28278.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
28279.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
28280.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
28281. 
28282. Directory and Files Select:
28283. ---------------------------
28284. !ZoneTypeSelectCurrent!               
28285. ---------------------------
28286. ----------------------------------------------------------
28287. ")
28288. 
28289. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
28290. 
28291. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
28292. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
28293. RunProgram("..\Commands\WriteDateTime.bat LastZone")
28294. 
28295. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
28296. 
28297. 
28298. 
28299. # Script: BannerSet
28300. 
28301. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
28302. 
28303. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
28304. 
28305. Title('!Heading!')
28306. /* pause(1) */
28307. 
28308. /* NOTE: Can't round or truncate to integer precision. */
28309. 
28310. # Script: BannerLog
28311. 
28312. AppendLogfile("!LogFileName!", "!Title!")
28313. 
28314. 
28315. 
28316. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
28317. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
28318. 
28319. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
28320. 
28321. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:29")
28322. 
28323. # 2021-11-17 21:08:29 
28324. SetVariable(Temp9, DATETIME)
28325. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:04 !ZoneLabel! !ZoneDescription!")
28326. 
28327. SetVariable(ZoneListByLine, "!ZoneListByLine! 
28328. Zone: !ZoneNoCurrent! !Temp9! 0:00:04 !ZoneLabel! !ZoneDescription!")
28329. 
28330. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:04 !ZoneLabel! !ZoneDescription!")
28331. 
28332. 
28333. /* Fixed Zone Position Handling */
28334. /* Literal number: */
28335. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
28336. /* Percentage of disk: */
28337. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
28338. /* Gap */
28339. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
28340. 
28341. /* ---------------------------------------------------------- */
28342. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
28343. # Script: DisplaySetFileStep
28344. 
28345. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
28346. 
28347. /* add message and move to a new line. */
28348. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
28349. ")
28350. 
28351. /* display the line. (hopefully.) */
28352. # Zone Footer Set Statistics Window Text
28353. 
28354. SetStatisticsWindowText("!Heading!
28355. ----------------------------------------------------------
28356. Zones Processed: 
28357. ----------------------------------------------------------
28358. !ZoneListByLine!
28359. ----------------------------------------------------------
28360. Zone Processing Step:
28361. !ZoneStepByLine!    
28362. ----------------------------------------------------------
28363. ----------------------------------------------------------
28364. Current Zone:
28365. !ZoneFooter!
28366. ----------------------------------------------------------
28367. ----------------------------------------------------------
28368. Volume Statistics:
28369. !VolumeStatisticsDetail!
28370. ----------------------------------------------------------
28371. ----------------------------------------------------------
28372. Zone Detailed Report:
28373. ----------------------------------------------------------
28374. !ZoneStatisticsDetail!
28375. ----------------------------------------------------------
28376. ")
28377. 
28378. 
28379. 
28380. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
28381. 
28382. # Script: BannerSet
28383. 
28384. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
28385. 
28386. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
28387. 
28388. Title('!Heading!')
28389. /* pause(1) */
28390. 
28391. /* NOTE: Can't round or truncate to integer precision. */
28392. 
28393. pause(1)
28394. 
28395. # your stuff HERE (X)... pre file select code.
28396. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
28397. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
28398. 	# (X)
28399. 
28400. FileSelect
28401. 
28402. 	# your stuff can't really go here (errors.)
28403. 	# maybe for some reason I don't know of...
28404. 	
28405. 	# Actions next...
28406. 	# Script: ZoneDo ZoneTypeSelectSpaceHogs
28407. # SpaceHogs start.
28408. not(
28409. # Archives start.
28410. (
28411.   DirectoryName("*Archive*")
28412.   or DirectoryName("*History*")
28413.   or DirectoryName("*Old")
28414.   or DirectoryName("* Old *")
28415.   or DirectoryName("Old *")
28416. 
28417.   or FileName("*.7z")
28418.   or FileName("*.cab")
28419.   or FileName("*.iso")
28420.   or FileName("*.msi")
28421.   or FileName("*.old")
28422.   or FileName("*.rar")
28423.   or FileName("*.tar")
28424.   or FileName("*.zip")
28425.   or
28426. # WinSysLow start.
28427. (
28428.   # Bad idea. This pushed lots of programs and data to archive.
28429.   # DirectoryName("$*")
28430.   # or DirectoryName("0*")
28431.   # or DirectoryName("1*")
28432.   # or DirectoryName("2*")
28433.   # or DirectoryName("3*")
28434.   # or DirectoryName("4*")
28435.   # or DirectoryName("5*")
28436.   # or DirectoryName("6*")
28437.   # or DirectoryName("7*")
28438.   # or DirectoryName("8*")
28439.   # or DirectoryName("9*")
28440.   # or 
28441.   DirectoryName("dllcache")
28442.   or DirectoryName("Downloaded Installations")
28443.   or DirectoryName("Ehome")
28444.   or DirectoryName("Fonts")
28445.   or DirectoryName("Help")
28446.   or DirectoryName("I386")
28447.   or DirectoryName("ie?updates")
28448.   or DirectoryName("Installer")
28449.   or DirectoryName("Installshield Installation Information")
28450.   or DirectoryName("IME")
28451.   or DirectoryName("*RECYCLE*")
28452.   or DirectoryName("ServicePackFiles")
28453.   or DirectoryName("SoftwareDistribution")
28454.   or DirectoryName("Speech")
28455.   or DirectoryName("Symbols")
28456.   or DirectoryName("System Volume Information")
28457.   or DirectoryName("windows.old")
28458. )
28459. # WinSysLow end.
28460. 
28461.   # Archives
28462. )
28463. # Archives end.
28464. 
28465. or 
28466. # Backups start.
28467. (
28468.   DirectoryName("*Backup*")
28469.   or DirectoryName("*Bu")
28470.   or DirectoryName("* Bu *")
28471.   or DirectoryName("Bu *")
28472. 
28473.   or FileName("*.bak")
28474.   or FileName("* - Copy*")
28475. )
28476. # Backups end.
28477. 
28478. # SpaceHogs
28479. ) and (
28480. # Blobs start.
28481. (
28482. # BlobsAndExceptions start.
28483. ( not(
28484.   FileName("*.bat")
28485.   or FileName("*.css")
28486.   or FileName("*.dll")
28487.   or FileName("*.exe")
28488.   or FileName("*.htm*")
28489.   or FileName("*.jar")
28490.   or FileName("*.js")
28491.   or FileName("*.script")
28492.   or FileName("*.wsf")
28493.   or (
28494. # Databases start.
28495. (
28496.   FileName("*.crypt*")
28497.   or FileName("*.db*")
28498.   or FileName("*.rdb*")
28499.   or FileName("*.dc*")
28500.   or FileName("*.dict*")
28501.   or FileName("*.?db*")
28502.   or FileName("*.?rdb*")
28503.   or FileName("*.md*")
28504.   or FileName("*.myd")
28505.   or FileName("*.ndf")
28506.   or FileName("*.ns?")
28507.   or FileName("*.pab")
28508.   or FileName("*.pst")
28509.   or FileName("*.sd?*")
28510.   or FileName("*.sq**")
28511.   or FileName("*.tmd")
28512.   or FileName("*.tps")
28513.   or FileName("*.tr*")
28514. )
28515. # Databases end.
28516. 
28517.     # BlobsAndExceptions
28518.     or 
28519. # Data start.
28520. (
28521.   DirectoryName("Data*")
28522.   or DirectoryName("Device*")
28523.   or DirectoryName("Export*")
28524.   or DirectoryName("Import*")
28525.   or DirectoryName("Log*")
28526.   or DirectoryName("*Log")
28527.   or DirectoryName("Maintenance*")
28528.   or DirectoryName("Rec*")
28529.   or DirectoryName("Sales*")
28530.   or DirectoryName("Search*")
28531.   or DirectoryName("User*")
28532. )
28533. # Data end.
28534. 
28535.     # BlobsAndExceptions
28536.   )
28537. ) )
28538. # BlobsAndExceptions end.
28539. 
28540. # Blobs
28541. ) and (
28542.   Size(BlobFileSize,0)
28543.   or (
28544.     FileName("*.arj")
28545.     or FileName("*.bup")
28546.     or FileName("*.bz2")
28547.     or FileName("*.chm")
28548.     or FileName("*.dvr-ms")
28549.     or FileName("*.gz")
28550.     or FileName("*.ifo")
28551.     or FileName("*.lzh")
28552.     or FileName("*.pdf")
28553.     or FileName("*.rpm")
28554.     or FileName("*.wmv")
28555.     or FileName("*.vob")
28556.     or FileName("*.z")
28557.   ) 
28558. )
28559. # Blobs end.
28560. 
28561. # SpaceHogs
28562. ) 
28563. # SpaceHogs end.
28564. 
28565. 	# Script: ZoneDoAction
28566. # Zone Do File Action - SortByName.
28567. 
28568. FileActions
28569. 
28570. 		/* ---------------------------------------------------------- */
28571. 	# Gap
28572. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
28573. 		# Script: DisplaySetFileStep
28574. 
28575. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
28576. 
28577. /* add message and move to a new line. */
28578. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
28579. ")
28580. 
28581. /* display the line. (hopefully.) */
28582. # Zone Footer Set Statistics Window Text
28583. 
28584. SetStatisticsWindowText("!Heading!
28585. ----------------------------------------------------------
28586. Zones Processed: 
28587. ----------------------------------------------------------
28588. !ZoneListByLine!
28589. ----------------------------------------------------------
28590. Zone Processing Step:
28591. !ZoneStepByLine!    
28592. ----------------------------------------------------------
28593. ----------------------------------------------------------
28594. Current Zone:
28595. !ZoneFooter!
28596. ----------------------------------------------------------
28597. ----------------------------------------------------------
28598. Volume Statistics:
28599. !VolumeStatisticsDetail!
28600. ----------------------------------------------------------
28601. ----------------------------------------------------------
28602. Zone Detailed Report:
28603. ----------------------------------------------------------
28604. !ZoneStatisticsDetail!
28605. ----------------------------------------------------------
28606. ")
28607. 
28608. 
28609. 
28610. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
28611. 
28612. # Script: BannerSet
28613. 
28614. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
28615. 
28616. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
28617. 
28618. Title('!Heading!')
28619. /* pause(1) */
28620. 
28621. /* NOTE: Can't round or truncate to integer precision. */
28622. 
28623. pause(1)
28624. 	
28625. 	# ACTUAL GAP
28626. 		/* AddGap Variant. */
28627. 	  	# Zone Do Gap
28628. # Gap Calculation Methods:
28629. 
28630. /* 1) Anything you need to add first. */
28631. /* empty */
28632. 
28633. /* ---------------------------------------------------------- */
28634. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
28635. 	# GapRequestedStd.
28636. 
28637. 		/* ---------------------------------------------------------- */
28638. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
28639. 
28640. 		# Gap Calculation Methods:
28641. 
28642. /* AddGap Variants */
28643. 
28644. 	/* Standard */
28645. 		# Gap Calculation Methods:
28646. 	/* AddGap Variants */
28647. 	/* Standard */
28648. 
28649. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
28650. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
28651. 
28652. 	SetVariable(GapRequested, GapRequestedStd)
28653. 	
28654. 
28655. 	/* MFT Low High Method */
28656. 		# Gap Calculation Methods:
28657. 	/* AddGap Variants */
28658. 	/* MFT Low High Method */
28659. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
28660. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
28661. 	SetVariable(GapRequested, GapRequestedMft)
28662. 	
28663. 
28664. 	/* OS Volume Type Method */
28665. 		# Gap Calculation Methods:
28666. 	/* AddGap Variants */
28667. 	/* OS Volume Type Method */
28668. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
28669. 	SetVariable(GapRequested, GapRequestedOs)
28670. 
28671. 
28672. 
28673. /* MakeGap Variants */
28674. 
28675. 	/* Original Os 1-3 + MFT 2 */
28676. 		# Gap Calculation Methods:
28677. 	/* MakeGap Variants */
28678. 	/* Original Os 1-3 + MFT 2 */
28679. 	/* plus MFT gap placed inline at the dividing zone. */
28680. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
28681. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
28682. 	SetVariable(GapRequested, GapRequestedOrig)
28683. 	
28684. 	
28685. /* Note: You could comment out the ones not in use */
28686. /* However having the data in the log is useful. */
28687. /* Therefore the following line is otherwise needed. */
28688. 
28689. /* Standard used */
28690. 
28691. SetVariable(GapRequested, GapRequestedStd)
28692. 
28693. # Gap Calculation Methods:
28694. 
28695. /* AddGap Variants */
28696. 	/* Standard */
28697. 	/* MFT Low High Method */
28698. 	/* OS Volume Type Method */
28699. 
28700. /* MakeGap Variants */
28701. 	/* Original Os 1-3 + MFT 2 */
28702. 
28703. /* Note: You could comment out the ones not in use */
28704. /* However having the data in the log is useful. */
28705. /* Therefore the following line is otherwise needed. */
28706. 
28707. /* Standard is used currently */
28708. 
28709. 
28710. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
28711. 
28712. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
28713. 
28714. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
28715. 
28716. /* ---------------------------------------------------------- */
28717. /* 3) SMALL ZONE ADJUSTMENT. */
28718. /* Gab cant be larger than half the Zone Size. */
28719. 
28720. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
28721. 	
28722. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
28723. 
28724. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
28725. 
28726. /* ---------------------------------------------------------- */
28727. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
28728. # Gap Adjustments.
28729. 
28730. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
28731. 	
28732. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
28733. 
28734. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
28735. 
28736. /* ---------------------------------------------------------- */
28737. # BYPASS THIS.
28738. 	/* This is definitely wrong. */
28739. 	/* The question is can we steal gap from the next zone */
28740. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
28741. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
28742. 		# Zone Overflow.
28743. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
28744. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
28745. 
28746. /* ---------------------------------------------------------- */
28747. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
28748. # Remaining free space available.
28749. 
28750. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
28751. 	
28752. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
28753. 
28754. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
28755. 
28756. /* ---------------------------------------------------------- */
28757. # CURRENT gap to use.
28758. 
28759. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
28760. 
28761. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
28762. 
28763. /* ---------------------------------------------------------- */
28764. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
28765. # Debugging.
28766. 
28767. 	SetVariable(GapUsed, GapCurrent) // for debugging
28768. 
28769. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
28770. 
28771. 		# Your code HERE
28772. 
28773. /* ---------------------------------------------------------- */
28774. /* 7) YOUR CODE. */
28775. # YOUR CODE HERE:
28776. 	# INPUT: GapCurrent or GapCurrentLoc
28777. 	# OUTPUT: GapUsed...
28778. 
28779. /* ---------------------------------------------------------- */
28780. # Gap Size.
28781. # Actual Size of Gap.
28782. 
28783. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
28784. 
28785. /* ---------------------------------------------------------- */
28786. /* xxxxxxxxxxxxxxxxxxxxxx */
28787. # ADD THE GAP
28788. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
28789. /* xxxxxxxxxxxxxxxxxxxxxx */
28790. 
28791. 	
28792. 	# Zone Statistics	
28793. 	# Script: ZoneDoStatistics
28794. # Zone / Volume Statistics and Display
28795. 		
28796. 	# Accumulate Totals
28797.   	# Script: ZoneDoVolumeTotals
28798. 
28799. /* Current total space used (by Zones and Gaps) */
28800. 
28801. SetVariable(VolumeZoneUsed, GapUsed)
28802. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
28803. /* Percentage */
28804. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
28805. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
28806. 
28807. /* Current total of free space requested */
28808. 
28809. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
28810. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
28811. /* Percent. */
28812. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
28813. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
28814. 
28815. /* Current total of free space used */
28816. 
28817. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
28818. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
28819. /* Percent */
28820. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
28821. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
28822. 
28823. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
28824. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
28825. /* Xinclude "..\DebugDisplayPause.MyDc"X */
28826. 
28827. 
28828. 	# Current Values
28829. 	# Script: ZoneDoCurrentSet
28830. 
28831. # Cluster, Sector, Block adjust for display.
28832. 	# Bytes per cluster is volume specific.
28833. 
28834. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
28835. 
28836. # Current Zone values.
28837. 	# Begin, end and size.
28838. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
28839. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
28840. 
28841. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
28842. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
28843. 
28844. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
28845. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
28846. 
28847. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
28848. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
28849. 
28850. 	SetVariable(ZoneFragments,				"!ZONE210N!")
28851. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
28852. 		
28853. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
28854. /* identical code to here: (separation not needed. TEST.) */	
28855. 
28856. # Current Gap, Actual and Free Values
28857. 	# Gap
28858. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
28859. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
28860. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
28861. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
28862. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
28863. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
28864. 	
28865. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
28866. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
28867. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
28868. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
28869. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
28870. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
28871. 	
28872. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
28873. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
28874. 	
28875. 	# Actual Size and End
28876. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
28877. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
28878. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
28879. 	
28880. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
28881. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
28882. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
28883. 
28884. # Gap Size & Rounding
28885. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
28886. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
28887. 	
28888. 	# Free Space
28889. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
28890. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
28891. 
28892. 	# Footer:
28893. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
28894. # 2021-11-17 21:08:29
28895. 
28896. SetVariable(ZoneFooter1, "----------------------------------------------------------
28897. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
28898. #
28899. # Xinclude "..\Commands\DateTimeLastLong.txt"X
28900. #
28901. SetVariable(ZoneFooter2, "Statistics Report:
28902. ------------------
28903.    Size:  
28904.    ------------------------
28905.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
28906.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
28907.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
28908. 
28909.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
28910.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
28911. 
28912.    Location:
28913.    ------------------------
28914.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
28915.             Files End: !ZoneEndCurrent!
28916.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
28917.       
28918.    Gap Settings:
28919.    ------------------------
28920.          Gap Requested: !ZoneGapSizePer!%
28921.        Volume Rounding: !ZoneVolRoundUpPer!%
28922.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
28923.                  
28924.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
28925.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
28926.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
28927.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
28928.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
28929.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
28930.      
28931.    Free Space after Zone:
28932.    ------------------------
28933.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
28934.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
28935.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
28936. 
28937. Directory and Files Select:
28938. ---------------------------
28939. !ZoneTypeSelectCurrent!               
28940. ---------------------------
28941. ----------------------------------------------------------
28942. ")
28943. 
28944. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
28945. 
28946. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
28947. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
28948. RunProgram("..\Commands\WriteDateTime.bat LastZone")
28949. 
28950. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
28951. 
28952. 
28953. 	# Zone Footer Set Statistics Window Text
28954. 
28955. SetStatisticsWindowText("!Heading!
28956. ----------------------------------------------------------
28957. Zones Processed: 
28958. ----------------------------------------------------------
28959. !ZoneListByLine!
28960. ----------------------------------------------------------
28961. Zone Processing Step:
28962. !ZoneStepByLine!    
28963. ----------------------------------------------------------
28964. ----------------------------------------------------------
28965. Current Zone:
28966. !ZoneFooter!
28967. ----------------------------------------------------------
28968. ----------------------------------------------------------
28969. Volume Statistics:
28970. !VolumeStatisticsDetail!
28971. ----------------------------------------------------------
28972. ----------------------------------------------------------
28973. Zone Detailed Report:
28974. ----------------------------------------------------------
28975. !ZoneStatisticsDetail!
28976. ----------------------------------------------------------
28977. ")
28978. 
28979. 
28980. 	
28981.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
28982. 
28983. 	# Add Zone to list of zones for display.
28984. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
28985. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
28986. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
28987. 	# ??? Free Stats?
28988. 	# Footer:
28989. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
28990. # 2021-11-17 21:08:29
28991. 
28992. SetVariable(ZoneFooter1, "----------------------------------------------------------
28993. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
28994. #
28995. # Xinclude "..\Commands\DateTimeLastLong.txt"X
28996. #
28997. SetVariable(ZoneFooter2, "Statistics Report:
28998. ------------------
28999.    Size:  
29000.    ------------------------
29001.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
29002.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
29003.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
29004. 
29005.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
29006.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
29007. 
29008.    Location:
29009.    ------------------------
29010.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
29011.             Files End: !ZoneEndCurrent!
29012.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
29013.       
29014.    Gap Settings:
29015.    ------------------------
29016.          Gap Requested: !ZoneGapSizePer!%
29017.        Volume Rounding: !ZoneVolRoundUpPer!%
29018.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
29019.                  
29020.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
29021.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
29022.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
29023.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
29024.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
29025.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
29026.      
29027.    Free Space after Zone:
29028.    ------------------------
29029.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
29030.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
29031.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
29032. 
29033. Directory and Files Select:
29034. ---------------------------
29035. !ZoneTypeSelectCurrent!               
29036. ---------------------------
29037. ----------------------------------------------------------
29038. ")
29039. 
29040. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
29041. 
29042. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
29043. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
29044. RunProgram("..\Commands\WriteDateTime.bat LastZone")
29045. 
29046. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
29047. 
29048. 
29049. 
29050. 	# Add Zone Details to Report.	
29051. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
29052. !ZoneFooter!")
29053. 
29054. 
29055. 	
29056. 	# Footer:
29057. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
29058. # 2021-11-17 21:08:29
29059. 
29060. SetVariable(ZoneFooter1, "----------------------------------------------------------
29061. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
29062. #
29063. # Xinclude "..\Commands\DateTimeLastLong.txt"X
29064. #
29065. SetVariable(ZoneFooter2, "Statistics Report:
29066. ------------------
29067.    Size:  
29068.    ------------------------
29069.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
29070.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
29071.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
29072. 
29073.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
29074.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
29075. 
29076.    Location:
29077.    ------------------------
29078.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
29079.             Files End: !ZoneEndCurrent!
29080.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
29081.       
29082.    Gap Settings:
29083.    ------------------------
29084.          Gap Requested: !ZoneGapSizePer!%
29085.        Volume Rounding: !ZoneVolRoundUpPer!%
29086.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
29087.                  
29088.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
29089.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
29090.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
29091.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
29092.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
29093.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
29094.      
29095.    Free Space after Zone:
29096.    ------------------------
29097.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
29098.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
29099.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
29100. 
29101. Directory and Files Select:
29102. ---------------------------
29103. !ZoneTypeSelectCurrent!               
29104. ---------------------------
29105. ----------------------------------------------------------
29106. ")
29107. 
29108. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
29109. 
29110. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
29111. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
29112. RunProgram("..\Commands\WriteDateTime.bat LastZone")
29113. 
29114. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
29115. 
29116. 
29117. 	SetStatisticsWindowText("!ZoneFooter!")
29118. 	
29119. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
29120. 	# Script: DisplaySetFileStep
29121. 
29122. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29123. 
29124. /* add message and move to a new line. */
29125. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
29126. ")
29127. 
29128. /* display the line. (hopefully.) */
29129. # Zone Footer Set Statistics Window Text
29130. 
29131. SetStatisticsWindowText("!Heading!
29132. ----------------------------------------------------------
29133. Zones Processed: 
29134. ----------------------------------------------------------
29135. !ZoneListByLine!
29136. ----------------------------------------------------------
29137. Zone Processing Step:
29138. !ZoneStepByLine!    
29139. ----------------------------------------------------------
29140. ----------------------------------------------------------
29141. Current Zone:
29142. !ZoneFooter!
29143. ----------------------------------------------------------
29144. ----------------------------------------------------------
29145. Volume Statistics:
29146. !VolumeStatisticsDetail!
29147. ----------------------------------------------------------
29148. ----------------------------------------------------------
29149. Zone Detailed Report:
29150. ----------------------------------------------------------
29151. !ZoneStatisticsDetail!
29152. ----------------------------------------------------------
29153. ")
29154. 
29155. 
29156. 
29157. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
29158. 
29159. # Script: BannerSet
29160. 
29161. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29162. 
29163. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
29164. 
29165. Title('!Heading!')
29166. /* pause(1) */
29167. 
29168. /* NOTE: Can't round or truncate to integer precision. */
29169. 
29170. pause(1)
29171. 
29172. # Commands:
29173. 
29174. /* Moves to Zone or above it. */
29175. # MoveUpToZone()
29176. 
29177. # Defrag
29178. 
29179. # Defragment(OPTIONS)
29180. 
29181. /* Shuffles files around trying to make a big enough gap for fragmented files. */
29182. # Defragment()
29183. 
29184. /* Only does files where a gap will fit it. */
29185. # Defragment(Fast)
29186. 
29187. /* Skips fragmented files larger than the Chunck Size. */
29188. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
29189. # Defragment(Chunk Size)
29190. 
29191. /* Moves down to zone and packs zone to beginning if there are gaps. */
29192. /* Can be similar in performance to doing a SortBy. */
29193. # MoveDownFill()
29194. 
29195. # File Action - All - Regular -  SortByName.
29196. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
29197. 	
29198. 
29199. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
29200. 	# Script: DisplaySetFileStep
29201. 
29202. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29203. 
29204. /* add message and move to a new line. */
29205. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
29206. ")
29207. 
29208. /* display the line. (hopefully.) */
29209. # Zone Footer Set Statistics Window Text
29210. 
29211. SetStatisticsWindowText("!Heading!
29212. ----------------------------------------------------------
29213. Zones Processed: 
29214. ----------------------------------------------------------
29215. !ZoneListByLine!
29216. ----------------------------------------------------------
29217. Zone Processing Step:
29218. !ZoneStepByLine!    
29219. ----------------------------------------------------------
29220. ----------------------------------------------------------
29221. Current Zone:
29222. !ZoneFooter!
29223. ----------------------------------------------------------
29224. ----------------------------------------------------------
29225. Volume Statistics:
29226. !VolumeStatisticsDetail!
29227. ----------------------------------------------------------
29228. ----------------------------------------------------------
29229. Zone Detailed Report:
29230. ----------------------------------------------------------
29231. !ZoneStatisticsDetail!
29232. ----------------------------------------------------------
29233. ")
29234. 
29235. 
29236. 
29237. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
29238. 
29239. # Script: BannerSet
29240. 
29241. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29242. 
29243. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
29244. 
29245. Title('!Heading!')
29246. /* pause(1) */
29247. 
29248. /* NOTE: Can't round or truncate to integer precision. */
29249. 
29250. pause(1)
29251. 
29252. 	# Script: ZoneDoFooter
29253. 
29254. /* ---------------------------------------------------------- */
29255. # File Select
29256. 	# Select Statments
29257. # File Actions 
29258. 	# Standard or OS File Actions.
29259. 	# Resume...
29260. 	
29261. 	# your stuff HERE (X)... post zone (file) file actions code.
29262. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
29263. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
29264. 		# (X)
29265. 		
29266. 		/* ??? Set window? */
29267. 	
29268. 	# ADD THE GAP
29269. # Vacate (good for diagnostics)
29270. # DoNotVacate - DO NOT Vacate (recommended)
29271. # DoNotVacate - DO NOT Vacate (recommended)
29272. 
29273. # Vacate
29274. /* AddGap(GapUsedLoc) */
29275. 
29276. # DO Not Vacate
29277. AddGap(GapUsedLoc, DoNotVacate) 
29278. 	
29279. 	
29280. # Script: GapZoneCommand
29281. # *** Moved to setting yours ***
29282. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
29283. # Controlled via settings commands
29284. # DoNotVacate - DO NOT Vacate (recommended)
29285. 
29286. # Vacate
29287. /* AddGap(GapUsedLoc) */
29288. 
29289. # DO Not Vacate
29290. AddGap(GapUsedLoc, DoNotVacate) 
29291. 	
29292. 	
29293. # Vacate /* AddGap(GapUsed) */
29294. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
29295. 	
29296. 
29297. 		
29298. # 
29299. FileEnd
29300. /* ---------------------------------------------------------- */
29301. 
29302. # your stuff HERE (X)... post zone (file) code.
29303. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
29304. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
29305. 	# (X)
29306. 
29307. SetVariable(FileStepDescription,"Zone finished, reporting.")
29308. # Script: DisplaySetFileStep
29309. 
29310. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29311. 
29312. /* add message and move to a new line. */
29313. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
29314. ")
29315. 
29316. /* display the line. (hopefully.) */
29317. # Zone Footer Set Statistics Window Text
29318. 
29319. SetStatisticsWindowText("!Heading!
29320. ----------------------------------------------------------
29321. Zones Processed: 
29322. ----------------------------------------------------------
29323. !ZoneListByLine!
29324. ----------------------------------------------------------
29325. Zone Processing Step:
29326. !ZoneStepByLine!    
29327. ----------------------------------------------------------
29328. ----------------------------------------------------------
29329. Current Zone:
29330. !ZoneFooter!
29331. ----------------------------------------------------------
29332. ----------------------------------------------------------
29333. Volume Statistics:
29334. !VolumeStatisticsDetail!
29335. ----------------------------------------------------------
29336. ----------------------------------------------------------
29337. Zone Detailed Report:
29338. ----------------------------------------------------------
29339. !ZoneStatisticsDetail!
29340. ----------------------------------------------------------
29341. ")
29342. 
29343. 
29344. 
29345. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
29346. 
29347. # Script: BannerSet
29348. 
29349. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29350. 
29351. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
29352. 
29353. Title('!Heading!')
29354. /* pause(1) */
29355. 
29356. /* NOTE: Can't round or truncate to integer precision. */
29357. 
29358. pause(1)
29359. 
29360. # Script: ZoneWhenFinished
29361. 
29362. # Script: BannerSet
29363. 
29364. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29365. 
29366. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
29367. 
29368. Title('!Heading!')
29369. /* pause(1) */
29370. 
29371. /* NOTE: Can't round or truncate to integer precision. */
29372. 
29373. # Script: BannerLog
29374. 
29375. AppendLogfile("!LogFileName!", "!Title!")
29376. 
29377. 
29378. 
29379. # Zone Statistics	
29380. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
29381. 
29382. # Footer:
29383. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
29384. # 2021-11-17 21:08:29
29385. 
29386. SetVariable(ZoneFooter1, "----------------------------------------------------------
29387. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
29388. #
29389. # Xinclude "..\Commands\DateTimeLastLong.txt"X
29390. #
29391. SetVariable(ZoneFooter2, "Statistics Report:
29392. ------------------
29393.    Size:  
29394.    ------------------------
29395.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
29396.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
29397.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
29398. 
29399.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
29400.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
29401. 
29402.    Location:
29403.    ------------------------
29404.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
29405.             Files End: !ZoneEndCurrent!
29406.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
29407.       
29408.    Gap Settings:
29409.    ------------------------
29410.          Gap Requested: !ZoneGapSizePer!%
29411.        Volume Rounding: !ZoneVolRoundUpPer!%
29412.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
29413.                  
29414.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
29415.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
29416.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
29417.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
29418.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
29419.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
29420.      
29421.    Free Space after Zone:
29422.    ------------------------
29423.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
29424.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
29425.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
29426. 
29427. Directory and Files Select:
29428. ---------------------------
29429. !ZoneTypeSelectCurrent!               
29430. ---------------------------
29431. ----------------------------------------------------------
29432. ")
29433. 
29434. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
29435. 
29436. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
29437. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
29438. RunProgram("..\Commands\WriteDateTime.bat LastZone")
29439. 
29440. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
29441. 
29442. 
29443. 
29444. AppendLogfile("!LogFileName!", ".")
29445. AppendLogfile("!LogFileName!", "!ZoneFooter!")
29446. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
29447. AppendLogfile("!LogFileName!", ".")
29448. 
29449. # Zone Footer Set Statistics Window Text
29450. 
29451. SetStatisticsWindowText("!Heading!
29452. ----------------------------------------------------------
29453. Zones Processed: 
29454. ----------------------------------------------------------
29455. !ZoneListByLine!
29456. ----------------------------------------------------------
29457. Zone Processing Step:
29458. !ZoneStepByLine!    
29459. ----------------------------------------------------------
29460. ----------------------------------------------------------
29461. Current Zone:
29462. !ZoneFooter!
29463. ----------------------------------------------------------
29464. ----------------------------------------------------------
29465. Volume Statistics:
29466. !VolumeStatisticsDetail!
29467. ----------------------------------------------------------
29468. ----------------------------------------------------------
29469. Zone Detailed Report:
29470. ----------------------------------------------------------
29471. !ZoneStatisticsDetail!
29472. ----------------------------------------------------------
29473. ")
29474. 
29475. 
29476. 
29477. /* pause() */
29478. /* pause() */
29479. 
29480. 
29481. 
29482. 
29483. /* ---------------------------------------------------------- */
29484. 
29485. 
29486. /* ---------------------------------------------------------- */
29487. /* Zone 20 ArchivesBu (All) Archives and Backups*/
29488. # Script: DisplayColors - Zone Dark
29489. # Processed
29490. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
29491. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
29492. 
29493. # Light Green and Yellow
29494. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
29495. SetFileColor(All, Selected and Fragmented,				237,	240,	11)		// Neon Yellow 
29496. SetFileColor(All, Selected and not(Movable),			255,	115,	115)	// Light red
29497. 
29498. # Script: DefragZoneTypeArchivesBu
29499. /* ---------------------------------------------------------- */
29500. /* Zone ArchivesBu (All) Archives and Backups*/
29501. 
29502. SetVariable(ZoneLabel, "!ZoneLabelArchivesBu!")
29503. SetVariable(ZoneDescription, "!ZoneDescriptionArchivesBu!")
29504. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpArchivesBu!")
29505. SetVariable(ZoneGapSize, "!ZoneGapSizeArchivesBu!")
29506. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectArchivesBu
29507. # ArchivesBu start.
29508. all
29509. # ArchivesBu end.
29510. ')
29511. 
29512. /* Note: This should be all Blob archives and backups */
29513. /* The sorting the "z Archive", "z Bu" and "z Backup" directories */
29514. /* sort to the very end of the Volume. */
29515. 
29516. 	# Script: ZoneDoHeader
29517. 
29518. # Script: ZoneWhenStarted
29519. RunProgram("..\Commands\WriteDateTime.bat")
29520. 
29521. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
29522. # Script: DisplaySetZone
29523. 
29524. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
29525. SetVariable(FileStepDescription,	"")
29526. 
29527. SetVariable(ZoneStepByLine, 			"Zone started.
29528. ")
29529. 
29530. # Script: BannerDescriptionSet
29531. 
29532. # Script: BannerSet
29533. 
29534. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29535. 
29536. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
29537. 
29538. Title('!Heading!')
29539. /* pause(1) */
29540. 
29541. /* NOTE: Can't round or truncate to integer precision. */
29542. 
29543. # Script: BannerLog
29544. 
29545. AppendLogfile("!LogFileName!", "!Title!")
29546. 
29547. 
29548. 
29549. pause(1)
29550. 
29551. 
29552. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
29553. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
29554. 
29555. SetVariable(ZoneStepNoCurrent, 0)
29556. 
29557. 
29558. # Script: ZoneDoCurrentClear
29559. 
29560. SetVariable(ZoneTypeSelectCurrent, 		"")
29561. 
29562. SetVariable(ZoneBeginCurrent, 			0)
29563. SetVariable(ZoneBeginPerCurrent, 		0)
29564. SetVariable(ZoneEndCurrent, 			0)
29565. SetVariable(ZoneEndPerCurrent, 			0)
29566. 
29567. SetVariable(ZoneSizeCurrent,			0)
29568. SetVariable(ZoneSizePerCurrent,			0)
29569. 
29570. SetVariable(ZoneGapRequestedCurrent,	0)
29571. SetVariable(ZoneGapRoundedCurrent, 		0)
29572. SetVariable(ZoneGapAdjustedCurrent, 	0)
29573. SetVariable(ZoneGapAvailableCurrent, 	0)
29574. SetVariable(ZoneGapCurrent,				0)
29575. SetVariable(ZoneGapUsedCurrent, 		0)
29576. 
29577. SetVariable(ZoneGapActualCurrent, 		0)
29578. SetVariable(ZoneGapActualPerCurrent, 	0)
29579. 
29580. SetVariable(ZoneSizeActual, 			0)
29581. SetVariable(ZoneSizeActualCurrent,		0)
29582. 
29583. SetVariable(ZoneEndActual, 				0)
29584. SetVariable(ZoneEndActualCurrent,		0)			
29585. SetVariable(ZoneSizeActualPerCurrent, 	0)
29586.       
29587. SetVariable(ZoneFilesFolders,			0)
29588. SetVariable(ZoneFilesFoldersPer,		0) 
29589. 
29590. SetVariable(ZoneFragments,				0)
29591. SetVariable(ZoneFragmentsPer,			0) 
29592. 		
29593. SetVariable(ZoneEndActualCurrent, 		0)
29594. SetVariable(ZoneEndActualPerCurrent, 	0)
29595. 
29596. # Gap Calculation Methodology:
29597. 	# Requested
29598. 	SetVariable(GapRequested, 			0) 
29599. 	SetVariable(GapRequestedStd, 		0) 
29600. 	SetVariable(GapRequestedMft, 		0) 
29601. 	SetVariable(GapRequestedOs, 		0) 
29602. 	SetVariable(GapRequestedOriginal, 	0) 
29603. 	
29604. 	# Gap Adjustments
29605. 	SetVariable(GapRounded, 			0)
29606. 	# SetVariable(GapAdjusted, 			0)
29607. 	SetVariable(GapAvailable, 			0)
29608. 	SetVariable(GapCurrent, 			0)
29609. 	SetVariable(GapActual, 				0)
29610. 	SetVariable(GapUsed, 				0)
29611. 	
29612. 	# Gap Adjustments
29613. 	SetVariable(GapRoundedLoc, 			0)
29614. 	# SetVariable(GapAdjustedLoc, 		0)
29615. 	SetVariable(GapAvailableLoc, 		0)
29616. 	SetVariable(GapCurrentLoc, 			0)
29617. 	SetVariable(GapActualLoc,			0)
29618. 	SetVariable(GapUsedLoc,				0)
29619. 	
29620. 	# Space usage
29621. 	SetVariable(ZoneFreePerRequested, 	0)
29622. 	SetVariable(ZoneFreePerUsed, 		0)
29623. 
29624. # Gap Size & Rounding
29625. 	SetVariable(ZoneGapSizePer, 		0)
29626. 	SetVariable(ZoneVolRoundUpPer, 		0)
29627. 	
29628. 	# Free Space
29629. 	SetVariable(ZoneFreeUsedPer, 		0)
29630. 	SetVariable(ZoneFreeRequestedPer, 	0)
29631. 
29632. 
29633. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
29634. 
29635. # Footer:
29636. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
29637. # 2021-11-17 21:08:29
29638. 
29639. SetVariable(ZoneFooter1, "----------------------------------------------------------
29640. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
29641. #
29642. # Xinclude "..\Commands\DateTimeLastLong.txt"X
29643. #
29644. SetVariable(ZoneFooter2, "Statistics Report:
29645. ------------------
29646.    Size:  
29647.    ------------------------
29648.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
29649.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
29650.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
29651. 
29652.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
29653.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
29654. 
29655.    Location:
29656.    ------------------------
29657.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
29658.             Files End: !ZoneEndCurrent!
29659.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
29660.       
29661.    Gap Settings:
29662.    ------------------------
29663.          Gap Requested: !ZoneGapSizePer!%
29664.        Volume Rounding: !ZoneVolRoundUpPer!%
29665.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
29666.                  
29667.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
29668.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
29669.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
29670.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
29671.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
29672.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
29673.      
29674.    Free Space after Zone:
29675.    ------------------------
29676.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
29677.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
29678.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
29679. 
29680. Directory and Files Select:
29681. ---------------------------
29682. !ZoneTypeSelectCurrent!               
29683. ---------------------------
29684. ----------------------------------------------------------
29685. ")
29686. 
29687. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
29688. 
29689. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
29690. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
29691. RunProgram("..\Commands\WriteDateTime.bat LastZone")
29692. 
29693. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
29694. 
29695. 
29696. 
29697. # Script: BannerSet
29698. 
29699. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29700. 
29701. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
29702. 
29703. Title('!Heading!')
29704. /* pause(1) */
29705. 
29706. /* NOTE: Can't round or truncate to integer precision. */
29707. 
29708. # Script: BannerLog
29709. 
29710. AppendLogfile("!LogFileName!", "!Title!")
29711. 
29712. 
29713. 
29714. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
29715. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
29716. 
29717. RunProgram("copy","!LogFileName!","+","DateTimeLast.txt","!LogFileName!","/y","/v")
29718. 
29719. AppendLogfile("!LogFileName!", "Time: 2021-11-17 21:08:29")
29720. 
29721. # 2021-11-17 21:08:29 
29722. SetVariable(Temp9, DATETIME)
29723. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! !DATETIME! 0:00:04 !ZoneLabel! !ZoneDescription!")
29724. 
29725. SetVariable(ZoneListByLine, "!ZoneListByLine! 
29726. Zone: !ZoneNoCurrent! !Temp9! 0:00:04 !ZoneLabel! !ZoneDescription!")
29727. 
29728. # SetVariable(ZoneListByLine, "!ZoneListByLine! Zone: !ZoneNoCurrent! Xinclude "..\Commands\DateTimeLastLong.txt"X 0:00:04 !ZoneLabel! !ZoneDescription!")
29729. 
29730. 
29731. /* Fixed Zone Position Handling */
29732. /* Literal number: */
29733. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
29734. /* Percentage of disk: */
29735. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
29736. /* Gap */
29737. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
29738. 
29739. /* ---------------------------------------------------------- */
29740. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
29741. # Script: DisplaySetFileStep
29742. 
29743. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29744. 
29745. /* add message and move to a new line. */
29746. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
29747. ")
29748. 
29749. /* display the line. (hopefully.) */
29750. # Zone Footer Set Statistics Window Text
29751. 
29752. SetStatisticsWindowText("!Heading!
29753. ----------------------------------------------------------
29754. Zones Processed: 
29755. ----------------------------------------------------------
29756. !ZoneListByLine!
29757. ----------------------------------------------------------
29758. Zone Processing Step:
29759. !ZoneStepByLine!    
29760. ----------------------------------------------------------
29761. ----------------------------------------------------------
29762. Current Zone:
29763. !ZoneFooter!
29764. ----------------------------------------------------------
29765. ----------------------------------------------------------
29766. Volume Statistics:
29767. !VolumeStatisticsDetail!
29768. ----------------------------------------------------------
29769. ----------------------------------------------------------
29770. Zone Detailed Report:
29771. ----------------------------------------------------------
29772. !ZoneStatisticsDetail!
29773. ----------------------------------------------------------
29774. ")
29775. 
29776. 
29777. 
29778. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
29779. 
29780. # Script: BannerSet
29781. 
29782. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29783. 
29784. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
29785. 
29786. Title('!Heading!')
29787. /* pause(1) */
29788. 
29789. /* NOTE: Can't round or truncate to integer precision. */
29790. 
29791. pause(1)
29792. 
29793. # your stuff HERE (X)... pre file select code.
29794. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
29795. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
29796. 	# (X)
29797. 
29798. FileSelect
29799. 
29800. 	# your stuff can't really go here (errors.)
29801. 	# maybe for some reason I don't know of...
29802. 	
29803. 	# Actions next...
29804. 	# Script: ZoneDo ZoneTypeSelectArchivesBu
29805. # ArchivesBu start.
29806. all
29807. # ArchivesBu end.
29808. 
29809. 	# Script: ZoneDoAction
29810. # Zone Do File Action - SortByName.
29811. 
29812. FileActions
29813. 
29814. 		/* ---------------------------------------------------------- */
29815. 	# Gap
29816. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
29817. 		# Script: DisplaySetFileStep
29818. 
29819. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29820. 
29821. /* add message and move to a new line. */
29822. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
29823. ")
29824. 
29825. /* display the line. (hopefully.) */
29826. # Zone Footer Set Statistics Window Text
29827. 
29828. SetStatisticsWindowText("!Heading!
29829. ----------------------------------------------------------
29830. Zones Processed: 
29831. ----------------------------------------------------------
29832. !ZoneListByLine!
29833. ----------------------------------------------------------
29834. Zone Processing Step:
29835. !ZoneStepByLine!    
29836. ----------------------------------------------------------
29837. ----------------------------------------------------------
29838. Current Zone:
29839. !ZoneFooter!
29840. ----------------------------------------------------------
29841. ----------------------------------------------------------
29842. Volume Statistics:
29843. !VolumeStatisticsDetail!
29844. ----------------------------------------------------------
29845. ----------------------------------------------------------
29846. Zone Detailed Report:
29847. ----------------------------------------------------------
29848. !ZoneStatisticsDetail!
29849. ----------------------------------------------------------
29850. ")
29851. 
29852. 
29853. 
29854. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
29855. 
29856. # Script: BannerSet
29857. 
29858. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
29859. 
29860. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
29861. 
29862. Title('!Heading!')
29863. /* pause(1) */
29864. 
29865. /* NOTE: Can't round or truncate to integer precision. */
29866. 
29867. pause(1)
29868. 	
29869. 	# ACTUAL GAP
29870. 		/* AddGap Variant. */
29871. 	  	# Zone Do Gap
29872. # Gap Calculation Methods:
29873. 
29874. /* 1) Anything you need to add first. */
29875. /* empty */
29876. 
29877. /* ---------------------------------------------------------- */
29878. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
29879. 	# GapRequestedStd.
29880. 
29881. 		/* ---------------------------------------------------------- */
29882. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
29883. 
29884. 		# Gap Calculation Methods:
29885. 
29886. /* AddGap Variants */
29887. 
29888. 	/* Standard */
29889. 		# Gap Calculation Methods:
29890. 	/* AddGap Variants */
29891. 	/* Standard */
29892. 
29893. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
29894. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
29895. 
29896. 	SetVariable(GapRequested, GapRequestedStd)
29897. 	
29898. 
29899. 	/* MFT Low High Method */
29900. 		# Gap Calculation Methods:
29901. 	/* AddGap Variants */
29902. 	/* MFT Low High Method */
29903. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
29904. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
29905. 	SetVariable(GapRequested, GapRequestedMft)
29906. 	
29907. 
29908. 	/* OS Volume Type Method */
29909. 		# Gap Calculation Methods:
29910. 	/* AddGap Variants */
29911. 	/* OS Volume Type Method */
29912. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
29913. 	SetVariable(GapRequested, GapRequestedOs)
29914. 
29915. 
29916. 
29917. /* MakeGap Variants */
29918. 
29919. 	/* Original Os 1-3 + MFT 2 */
29920. 		# Gap Calculation Methods:
29921. 	/* MakeGap Variants */
29922. 	/* Original Os 1-3 + MFT 2 */
29923. 	/* plus MFT gap placed inline at the dividing zone. */
29924. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
29925. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
29926. 	SetVariable(GapRequested, GapRequestedOrig)
29927. 	
29928. 	
29929. /* Note: You could comment out the ones not in use */
29930. /* However having the data in the log is useful. */
29931. /* Therefore the following line is otherwise needed. */
29932. 
29933. /* Standard used */
29934. 
29935. SetVariable(GapRequested, GapRequestedStd)
29936. 
29937. # Gap Calculation Methods:
29938. 
29939. /* AddGap Variants */
29940. 	/* Standard */
29941. 	/* MFT Low High Method */
29942. 	/* OS Volume Type Method */
29943. 
29944. /* MakeGap Variants */
29945. 	/* Original Os 1-3 + MFT 2 */
29946. 
29947. /* Note: You could comment out the ones not in use */
29948. /* However having the data in the log is useful. */
29949. /* Therefore the following line is otherwise needed. */
29950. 
29951. /* Standard is used currently */
29952. 
29953. 
29954. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
29955. 
29956. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
29957. 
29958. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
29959. 
29960. /* ---------------------------------------------------------- */
29961. /* 3) SMALL ZONE ADJUSTMENT. */
29962. /* Gab cant be larger than half the Zone Size. */
29963. 
29964. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
29965. 	
29966. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
29967. 
29968. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
29969. 
29970. /* ---------------------------------------------------------- */
29971. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
29972. # Gap Adjustments.
29973. 
29974. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
29975. 	
29976. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
29977. 
29978. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
29979. 
29980. /* ---------------------------------------------------------- */
29981. # BYPASS THIS.
29982. 	/* This is definitely wrong. */
29983. 	/* The question is can we steal gap from the next zone */
29984. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
29985. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
29986. 		# Zone Overflow.
29987. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
29988. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
29989. 
29990. /* ---------------------------------------------------------- */
29991. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
29992. # Remaining free space available.
29993. 
29994. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
29995. 	
29996. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
29997. 
29998. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
29999. 
30000. /* ---------------------------------------------------------- */
30001. # CURRENT gap to use.
30002. 
30003. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
30004. 
30005. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
30006. 
30007. /* ---------------------------------------------------------- */
30008. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
30009. # Debugging.
30010. 
30011. 	SetVariable(GapUsed, GapCurrent) // for debugging
30012. 
30013. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
30014. 
30015. 		# Your code HERE
30016. 
30017. /* ---------------------------------------------------------- */
30018. /* 7) YOUR CODE. */
30019. # YOUR CODE HERE:
30020. 	# INPUT: GapCurrent or GapCurrentLoc
30021. 	# OUTPUT: GapUsed...
30022. 
30023. /* ---------------------------------------------------------- */
30024. # Gap Size.
30025. # Actual Size of Gap.
30026. 
30027. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
30028. 
30029. /* ---------------------------------------------------------- */
30030. /* xxxxxxxxxxxxxxxxxxxxxx */
30031. # ADD THE GAP
30032. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
30033. /* xxxxxxxxxxxxxxxxxxxxxx */
30034. 
30035. 	
30036. 	# Zone Statistics	
30037. 	# Script: ZoneDoStatistics
30038. # Zone / Volume Statistics and Display
30039. 		
30040. 	# Accumulate Totals
30041.   	# Script: ZoneDoVolumeTotals
30042. 
30043. /* Current total space used (by Zones and Gaps) */
30044. 
30045. SetVariable(VolumeZoneUsed, GapUsed)
30046. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
30047. /* Percentage */
30048. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
30049. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
30050. 
30051. /* Current total of free space requested */
30052. 
30053. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
30054. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
30055. /* Percent. */
30056. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
30057. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
30058. 
30059. /* Current total of free space used */
30060. 
30061. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
30062. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
30063. /* Percent */
30064. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
30065. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
30066. 
30067. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
30068. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
30069. /* Xinclude "..\DebugDisplayPause.MyDc"X */
30070. 
30071. 
30072. 	# Current Values
30073. 	# Script: ZoneDoCurrentSet
30074. 
30075. # Cluster, Sector, Block adjust for display.
30076. 	# Bytes per cluster is volume specific.
30077. 
30078. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
30079. 
30080. # Current Zone values.
30081. 	# Begin, end and size.
30082. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
30083. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
30084. 
30085. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
30086. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
30087. 
30088. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
30089. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
30090. 
30091. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
30092. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
30093. 
30094. 	SetVariable(ZoneFragments,				"!ZONE210N!")
30095. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
30096. 		
30097. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
30098. /* identical code to here: (separation not needed. TEST.) */	
30099. 
30100. # Current Gap, Actual and Free Values
30101. 	# Gap
30102. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
30103. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
30104. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
30105. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
30106. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
30107. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
30108. 	
30109. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
30110. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
30111. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
30112. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
30113. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
30114. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
30115. 	
30116. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
30117. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
30118. 	
30119. 	# Actual Size and End
30120. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
30121. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
30122. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
30123. 	
30124. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
30125. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
30126. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
30127. 
30128. # Gap Size & Rounding
30129. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
30130. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
30131. 	
30132. 	# Free Space
30133. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
30134. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
30135. 
30136. 	# Footer:
30137. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
30138. # 2021-11-17 21:08:30
30139. 
30140. SetVariable(ZoneFooter1, "----------------------------------------------------------
30141. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
30142. #
30143. # Xinclude "..\Commands\DateTimeLastLong.txt"X
30144. #
30145. SetVariable(ZoneFooter2, "Statistics Report:
30146. ------------------
30147.    Size:  
30148.    ------------------------
30149.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
30150.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
30151.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
30152. 
30153.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
30154.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
30155. 
30156.    Location:
30157.    ------------------------
30158.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
30159.             Files End: !ZoneEndCurrent!
30160.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
30161.       
30162.    Gap Settings:
30163.    ------------------------
30164.          Gap Requested: !ZoneGapSizePer!%
30165.        Volume Rounding: !ZoneVolRoundUpPer!%
30166.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
30167.                  
30168.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
30169.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
30170.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
30171.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
30172.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
30173.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
30174.      
30175.    Free Space after Zone:
30176.    ------------------------
30177.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
30178.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
30179.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
30180. 
30181. Directory and Files Select:
30182. ---------------------------
30183. !ZoneTypeSelectCurrent!               
30184. ---------------------------
30185. ----------------------------------------------------------
30186. ")
30187. 
30188. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
30189. 
30190. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
30191. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
30192. RunProgram("..\Commands\WriteDateTime.bat LastZone")
30193. 
30194. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
30195. 
30196. 
30197. 	# Zone Footer Set Statistics Window Text
30198. 
30199. SetStatisticsWindowText("!Heading!
30200. ----------------------------------------------------------
30201. Zones Processed: 
30202. ----------------------------------------------------------
30203. !ZoneListByLine!
30204. ----------------------------------------------------------
30205. Zone Processing Step:
30206. !ZoneStepByLine!    
30207. ----------------------------------------------------------
30208. ----------------------------------------------------------
30209. Current Zone:
30210. !ZoneFooter!
30211. ----------------------------------------------------------
30212. ----------------------------------------------------------
30213. Volume Statistics:
30214. !VolumeStatisticsDetail!
30215. ----------------------------------------------------------
30216. ----------------------------------------------------------
30217. Zone Detailed Report:
30218. ----------------------------------------------------------
30219. !ZoneStatisticsDetail!
30220. ----------------------------------------------------------
30221. ")
30222. 
30223. 
30224. 	
30225.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
30226. 
30227. 	# Add Zone to list of zones for display.
30228. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
30229. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
30230. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
30231. 	# ??? Free Stats?
30232. 	# Footer:
30233. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
30234. # 2021-11-17 21:08:30
30235. 
30236. SetVariable(ZoneFooter1, "----------------------------------------------------------
30237. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
30238. #
30239. # Xinclude "..\Commands\DateTimeLastLong.txt"X
30240. #
30241. SetVariable(ZoneFooter2, "Statistics Report:
30242. ------------------
30243.    Size:  
30244.    ------------------------
30245.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
30246.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
30247.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
30248. 
30249.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
30250.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
30251. 
30252.    Location:
30253.    ------------------------
30254.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
30255.             Files End: !ZoneEndCurrent!
30256.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
30257.       
30258.    Gap Settings:
30259.    ------------------------
30260.          Gap Requested: !ZoneGapSizePer!%
30261.        Volume Rounding: !ZoneVolRoundUpPer!%
30262.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
30263.                  
30264.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
30265.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
30266.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
30267.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
30268.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
30269.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
30270.      
30271.    Free Space after Zone:
30272.    ------------------------
30273.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
30274.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
30275.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
30276. 
30277. Directory and Files Select:
30278. ---------------------------
30279. !ZoneTypeSelectCurrent!               
30280. ---------------------------
30281. ----------------------------------------------------------
30282. ")
30283. 
30284. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
30285. 
30286. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
30287. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
30288. RunProgram("..\Commands\WriteDateTime.bat LastZone")
30289. 
30290. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
30291. 
30292. 
30293. 
30294. 	# Add Zone Details to Report.	
30295. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
30296. !ZoneFooter!")
30297. 
30298. 
30299. 	
30300. 	# Footer:
30301. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
30302. # 2021-11-17 21:08:30
30303. 
30304. SetVariable(ZoneFooter1, "----------------------------------------------------------
30305. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
30306. #
30307. # Xinclude "..\Commands\DateTimeLastLong.txt"X
30308. #
30309. SetVariable(ZoneFooter2, "Statistics Report:
30310. ------------------
30311.    Size:  
30312.    ------------------------
30313.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
30314.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
30315.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
30316. 
30317.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
30318.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
30319. 
30320.    Location:
30321.    ------------------------
30322.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
30323.             Files End: !ZoneEndCurrent!
30324.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
30325.       
30326.    Gap Settings:
30327.    ------------------------
30328.          Gap Requested: !ZoneGapSizePer!%
30329.        Volume Rounding: !ZoneVolRoundUpPer!%
30330.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
30331.                  
30332.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
30333.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
30334.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
30335.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
30336.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
30337.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
30338.      
30339.    Free Space after Zone:
30340.    ------------------------
30341.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
30342.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
30343.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
30344. 
30345. Directory and Files Select:
30346. ---------------------------
30347. !ZoneTypeSelectCurrent!               
30348. ---------------------------
30349. ----------------------------------------------------------
30350. ")
30351. 
30352. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
30353. 
30354. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
30355. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
30356. RunProgram("..\Commands\WriteDateTime.bat LastZone")
30357. 
30358. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
30359. 
30360. 
30361. 	SetStatisticsWindowText("!ZoneFooter!")
30362. 	
30363. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
30364. 	# Script: DisplaySetFileStep
30365. 
30366. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
30367. 
30368. /* add message and move to a new line. */
30369. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
30370. ")
30371. 
30372. /* display the line. (hopefully.) */
30373. # Zone Footer Set Statistics Window Text
30374. 
30375. SetStatisticsWindowText("!Heading!
30376. ----------------------------------------------------------
30377. Zones Processed: 
30378. ----------------------------------------------------------
30379. !ZoneListByLine!
30380. ----------------------------------------------------------
30381. Zone Processing Step:
30382. !ZoneStepByLine!    
30383. ----------------------------------------------------------
30384. ----------------------------------------------------------
30385. Current Zone:
30386. !ZoneFooter!
30387. ----------------------------------------------------------
30388. ----------------------------------------------------------
30389. Volume Statistics:
30390. !VolumeStatisticsDetail!
30391. ----------------------------------------------------------
30392. ----------------------------------------------------------
30393. Zone Detailed Report:
30394. ----------------------------------------------------------
30395. !ZoneStatisticsDetail!
30396. ----------------------------------------------------------
30397. ")
30398. 
30399. 
30400. 
30401. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
30402. 
30403. # Script: BannerSet
30404. 
30405. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30406. 
30407. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
30408. 
30409. Title('!Heading!')
30410. /* pause(1) */
30411. 
30412. /* NOTE: Can't round or truncate to integer precision. */
30413. 
30414. pause(1)
30415. 
30416. # Commands:
30417. 
30418. /* Moves to Zone or above it. */
30419. # MoveUpToZone()
30420. 
30421. # Defrag
30422. 
30423. # Defragment(OPTIONS)
30424. 
30425. /* Shuffles files around trying to make a big enough gap for fragmented files. */
30426. # Defragment()
30427. 
30428. /* Only does files where a gap will fit it. */
30429. # Defragment(Fast)
30430. 
30431. /* Skips fragmented files larger than the Chunck Size. */
30432. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
30433. # Defragment(Chunk Size)
30434. 
30435. /* Moves down to zone and packs zone to beginning if there are gaps. */
30436. /* Can be similar in performance to doing a SortBy. */
30437. # MoveDownFill()
30438. 
30439. # File Action - All - Regular -  SortByName.
30440. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
30441. 	
30442. 
30443. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
30444. 	# Script: DisplaySetFileStep
30445. 
30446. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
30447. 
30448. /* add message and move to a new line. */
30449. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
30450. ")
30451. 
30452. /* display the line. (hopefully.) */
30453. # Zone Footer Set Statistics Window Text
30454. 
30455. SetStatisticsWindowText("!Heading!
30456. ----------------------------------------------------------
30457. Zones Processed: 
30458. ----------------------------------------------------------
30459. !ZoneListByLine!
30460. ----------------------------------------------------------
30461. Zone Processing Step:
30462. !ZoneStepByLine!    
30463. ----------------------------------------------------------
30464. ----------------------------------------------------------
30465. Current Zone:
30466. !ZoneFooter!
30467. ----------------------------------------------------------
30468. ----------------------------------------------------------
30469. Volume Statistics:
30470. !VolumeStatisticsDetail!
30471. ----------------------------------------------------------
30472. ----------------------------------------------------------
30473. Zone Detailed Report:
30474. ----------------------------------------------------------
30475. !ZoneStatisticsDetail!
30476. ----------------------------------------------------------
30477. ")
30478. 
30479. 
30480. 
30481. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
30482. 
30483. # Script: BannerSet
30484. 
30485. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30486. 
30487. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
30488. 
30489. Title('!Heading!')
30490. /* pause(1) */
30491. 
30492. /* NOTE: Can't round or truncate to integer precision. */
30493. 
30494. pause(1)
30495. 
30496. 	# Script: ZoneDoFooter
30497. 
30498. /* ---------------------------------------------------------- */
30499. # File Select
30500. 	# Select Statments
30501. # File Actions 
30502. 	# Standard or OS File Actions.
30503. 	# Resume...
30504. 	
30505. 	# your stuff HERE (X)... post zone (file) file actions code.
30506. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
30507. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
30508. 		# (X)
30509. 		
30510. 		/* ??? Set window? */
30511. 	
30512. 	# ADD THE GAP
30513. # Vacate (good for diagnostics)
30514. # DoNotVacate - DO NOT Vacate (recommended)
30515. # DoNotVacate - DO NOT Vacate (recommended)
30516. 
30517. # Vacate
30518. /* AddGap(GapUsedLoc) */
30519. 
30520. # DO Not Vacate
30521. AddGap(GapUsedLoc, DoNotVacate) 
30522. 	
30523. 	
30524. # Script: GapZoneCommand
30525. # *** Moved to setting yours ***
30526. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
30527. # Controlled via settings commands
30528. # DoNotVacate - DO NOT Vacate (recommended)
30529. 
30530. # Vacate
30531. /* AddGap(GapUsedLoc) */
30532. 
30533. # DO Not Vacate
30534. AddGap(GapUsedLoc, DoNotVacate) 
30535. 	
30536. 	
30537. # Vacate /* AddGap(GapUsed) */
30538. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
30539. 	
30540. 
30541. 		
30542. # 
30543. FileEnd
30544. /* ---------------------------------------------------------- */
30545. 
30546. # your stuff HERE (X)... post zone (file) code.
30547. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
30548. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
30549. 	# (X)
30550. 
30551. SetVariable(FileStepDescription,"Zone finished, reporting.")
30552. # Script: DisplaySetFileStep
30553. 
30554. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
30555. 
30556. /* add message and move to a new line. */
30557. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
30558. ")
30559. 
30560. /* display the line. (hopefully.) */
30561. # Zone Footer Set Statistics Window Text
30562. 
30563. SetStatisticsWindowText("!Heading!
30564. ----------------------------------------------------------
30565. Zones Processed: 
30566. ----------------------------------------------------------
30567. !ZoneListByLine!
30568. ----------------------------------------------------------
30569. Zone Processing Step:
30570. !ZoneStepByLine!    
30571. ----------------------------------------------------------
30572. ----------------------------------------------------------
30573. Current Zone:
30574. !ZoneFooter!
30575. ----------------------------------------------------------
30576. ----------------------------------------------------------
30577. Volume Statistics:
30578. !VolumeStatisticsDetail!
30579. ----------------------------------------------------------
30580. ----------------------------------------------------------
30581. Zone Detailed Report:
30582. ----------------------------------------------------------
30583. !ZoneStatisticsDetail!
30584. ----------------------------------------------------------
30585. ")
30586. 
30587. 
30588. 
30589. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
30590. 
30591. # Script: BannerSet
30592. 
30593. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30594. 
30595. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
30596. 
30597. Title('!Heading!')
30598. /* pause(1) */
30599. 
30600. /* NOTE: Can't round or truncate to integer precision. */
30601. 
30602. pause(1)
30603. 
30604. # Script: ZoneWhenFinished
30605. 
30606. # Script: BannerSet
30607. 
30608. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30609. 
30610. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
30611. 
30612. Title('!Heading!')
30613. /* pause(1) */
30614. 
30615. /* NOTE: Can't round or truncate to integer precision. */
30616. 
30617. # Script: BannerLog
30618. 
30619. AppendLogfile("!LogFileName!", "!Title!")
30620. 
30621. 
30622. 
30623. # Zone Statistics	
30624. /* Xinclude "..\Zone\ZoneDoStatistics.MyDc"X */
30625. 
30626. # Footer:
30627. SetVariable(ZoneKeyCurr, "!LogFileName! !ZoneCurrentDescription!")
30628. # 2021-11-17 21:08:30
30629. 
30630. SetVariable(ZoneFooter1, "----------------------------------------------------------
30631. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! ")
30632. #
30633. # Xinclude "..\Commands\DateTimeLastLong.txt"X
30634. #
30635. SetVariable(ZoneFooter2, "Statistics Report:
30636. ------------------
30637.    Size:  
30638.    ------------------------
30639.                 Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
30640.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
30641.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
30642. 
30643.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
30644.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
30645. 
30646.    Location:
30647.    ------------------------
30648.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
30649.             Files End: !ZoneEndCurrent!
30650.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
30651.       
30652.    Gap Settings:
30653.    ------------------------
30654.          Gap Requested: !ZoneGapSizePer!%
30655.        Volume Rounding: !ZoneVolRoundUpPer!%
30656.             Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
30657.                  
30658.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
30659.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  (---) !ZoneGapAdjustedLocCurrent!
30660.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent!  (---) !ZoneGapRoundedLocCurrent!
30661.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent!  (---) !ZoneGapAvailableLocCurrent!
30662.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent!  (---) !ZoneGapLocCurrent!
30663.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent!  (---) !ZoneGapUsedLocCurrent!
30664.      
30665.    Free Space after Zone:
30666.    ------------------------
30667.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
30668.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
30669.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
30670. 
30671. Directory and Files Select:
30672. ---------------------------
30673. !ZoneTypeSelectCurrent!               
30674. ---------------------------
30675. ----------------------------------------------------------
30676. ")
30677. 
30678. SetVariable(ZoneFooter,     "!ZoneFooter1!!ZoneFooter2!")
30679. 
30680. WriteLogfile("!ZoneKeyCurr! part1", "!ZoneFooter1!")
30681. WriteLogfile("!ZoneKeyCurr! part2", "!ZoneFooter2!")
30682. RunProgram("..\Commands\WriteDateTime.bat LastZone")
30683. 
30684. RunProgram("copy","'!ZoneKeyCurr! part1'+'DateTimeLastZone'+'!ZoneKeyCurr! part2'","!ZoneKeyCurr!","/Y")
30685. 
30686. 
30687. 
30688. AppendLogfile("!LogFileName!", ".")
30689. AppendLogfile("!LogFileName!", "!ZoneFooter!")
30690. WriteLogfile("!LogFileName! Volume !VolumenName! Zone !ZoneNoCurrent! !ZoneCurrentDescription!",  "!ZoneFooter!")
30691. AppendLogfile("!LogFileName!", ".")
30692. 
30693. # Zone Footer Set Statistics Window Text
30694. 
30695. SetStatisticsWindowText("!Heading!
30696. ----------------------------------------------------------
30697. Zones Processed: 
30698. ----------------------------------------------------------
30699. !ZoneListByLine!
30700. ----------------------------------------------------------
30701. Zone Processing Step:
30702. !ZoneStepByLine!    
30703. ----------------------------------------------------------
30704. ----------------------------------------------------------
30705. Current Zone:
30706. !ZoneFooter!
30707. ----------------------------------------------------------
30708. ----------------------------------------------------------
30709. Volume Statistics:
30710. !VolumeStatisticsDetail!
30711. ----------------------------------------------------------
30712. ----------------------------------------------------------
30713. Zone Detailed Report:
30714. ----------------------------------------------------------
30715. !ZoneStatisticsDetail!
30716. ----------------------------------------------------------
30717. ")
30718. 
30719. 
30720. 
30721. /* pause() */
30722. /* pause() */
30723. 
30724. 
30725. 
30726. 
30727. /* ---------------------------------------------------------- */
30728. 
30729. 
30730. /* ---------------------------------------------------------- */
30731. /* Volume End */
30732. # Script: VolumeWhenFinished
30733. 
30734. /* Write the "after" statistics to the logfile. */
30735. 
30736. # Script: BannerSet
30737. 
30738. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
30739. 
30740. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
30741. 
30742. Title('!Heading!')
30743. /* pause(1) */
30744. 
30745. /* NOTE: Can't round or truncate to integer precision. */
30746. 
30747. # Script: BannerLog
30748. 
30749. AppendLogfile("!LogFileName!", "!Title!")
30750. 
30751. 
30752. 
30753. # Script: 
30754. # Set Volume summary stats:
30755. 
30756. # Cluster, Sector, Block adjust for display.
30757. # Bytes per cluster is volume specific.
30758. 
30759. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
30760. 
30761. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
30762. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
30763. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
30764. 
30765. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
30766. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
30767. 
30768. # Set the display text:
30769. # Script: VolumeStatisticsSummaryDisplay
30770. 
30771. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
30772. SUMMARY: !VolumeLabel! !VolumeDescription!
30773.   
30774.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
30775.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
30776.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
30777.          
30778.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
30779.       Volume Free Adj:       !VolumeFreeAdj!
30780.     Bytes per cluster:       !BytesPerCluster! bytes
30781. 
30782.    Unfragmented Items:       !FILES200N!
30783.      Fragmented Items:       !FILES210N!
30784. 
30785.     Unfragmented Data:       !FILES202N! bytes
30786.       Fragmented Data:       !FILES212N! bytes
30787. 
30788.              All Gaps:       !GAP00N!
30789.              All gaps:       !GAP10N! bytes
30790.           Average gap:       !GAP13N! bytes
30791.            Median gap:       !GAP14N! bytes
30792.           Biggest gap:       !GAP15N! bytes
30793. 
30794.              MFT Zone:       !MftZone! Location: !MftLocation! 
30795.                  Size:                       0 Gap: !MftGap!
30796. ----------------------------------------------------------
30797. ") 
30798. 
30799. 
30800. SetVariable(VolumeFooter, "!VolumeStatisticsSummary!")
30801. # Write to log
30802. ;lf;slj
30803. 
30804. # Script: VolumeSizeLog
30805. AppendLogfile("!LogFileName!", ".")
30806. AppendLogfile("!LogFileName!", "      Volume Size: !VolumeSize!")
30807. AppendLogfile("!LogFileName!", "      Volume Used: !VolumeUsed!")
30808. AppendLogfile("!LogFileName!", "Volume Used Total: !VolumeUsedTotal!")
30809. AppendLogfile("!LogFileName!", "      Volume Free: !VolumeFree!")
30810. AppendLogfile("!LogFileName!", "  Volume Free Adj: !VolumeFreeAdj!")
30811. AppendLogfile("!LogFileName!", ".")
30812. AppendLogfile("!LogFileName!", "MFT Zone: !MftZone! Location: !MftLocation! Size:                 0 Gap: !MftGap!")
30813. AppendLogfile("!LogFileName!", ".")
30814. 
30815. 
30816. /* Write/display stats: */
30817. 
30818. # Log:  
30819. 
30820. # Script: VolumeStatisticsDetailGet
30821. 
30822. # Set Volume summary stats:
30823. 
30824. # Cluster, Sector, Block adjust for display.
30825. # Bytes per cluster is volume specific.
30826. 
30827. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
30828. 
30829. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
30830. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
30831. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
30832. 
30833. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
30834. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
30835. 
30836. # Set the display text:
30837. # Script: VolumeStatisticsSummaryDisplay
30838. 
30839. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
30840. SUMMARY: !VolumeLabel! !VolumeDescription!
30841.   
30842.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
30843.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
30844.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
30845.          
30846.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
30847.       Volume Free Adj:       !VolumeFreeAdj!
30848.     Bytes per cluster:       !BytesPerCluster! bytes
30849. 
30850.    Unfragmented Items:       !FILES200N!
30851.      Fragmented Items:       !FILES210N!
30852. 
30853.     Unfragmented Data:       !FILES202N! bytes
30854.       Fragmented Data:       !FILES212N! bytes
30855. 
30856.              All Gaps:       !GAP00N!
30857.              All gaps:       !GAP10N! bytes
30858.           Average gap:       !GAP13N! bytes
30859.            Median gap:       !GAP14N! bytes
30860.           Biggest gap:       !GAP15N! bytes
30861. 
30862.              MFT Zone:       !MftZone! Location: !MftLocation! 
30863.                  Size:                       0 Gap: !MftGap!
30864. ----------------------------------------------------------
30865. ") 
30866. 
30867. 
30868. 
30869. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
30870. VOLUME: !VolumeLabel! !VolumeDescription!
30871. ----------------------------------------------------------
30872. !VolumeStatisticsSummary!
30873. ----------------------------------------------------------
30874. DETAILS: !VolumeLabel! !VolumeDescription!
30875. ----------------------------------------------------------
30876. 
30877. SUMMARY:
30878. 
30879. Volume label/name:          !VolumeLabel!
30880. Volume mountpoint:          !MountPoint!
30881. Volume name:                !VolumeName!
30882. Volume type:                !VolumeType!
30883. 
30884. Total disk space:           !VolumeSize! bytes
30885.                             !VolumeSizeG! gigabytes
30886. 
30887. Bytes per cluster:          !BytesPerCluster! bytes
30888. Average end-begin distance: !AverageBeginEndDistance! clusters
30889.                             !AverageBeginEndDistanceP!% of volume size
30890. 
30891. ----------------------------------------------------------
30892. FRAGMENTS:
30893. 
30894. Unfragmented Items: !FILES200N!
30895.   Fragmented Items: !FILES210N!
30896.  Unfragmented Data: !FILES202N! bytes
30897.    Fragmented Data: !FILES212N! bytes
30898. Gaps:
30899.           All Gaps: !GAP00N!
30900.           All gaps: !GAP10N! bytes
30901.        Average gap: !GAP13N! bytes
30902.         Median gap: !GAP14N! bytes
30903.        Biggest gap: !GAP15N! bytes
30904. 
30905. ----------------------------------------------------------
30906. GAPS:
30907. 
30908.    ----------------------------------------------------------
30909.    Counts:
30910.                        Count      Percentage of all
30911.                 ----------------- -----------------
30912.    Small gaps   !GAP01N! !GAP01P!%
30913.    Big gaps     !GAP02N! !GAP02P!%
30914.                 ----------------- -----------------
30915.    All gaps     !GAP00N! !GAP00P!
30916. 
30917.    ----------------------------------------------------------
30918.    By size:
30919.                       Bytes          Gigabytes      Percentage of all
30920.                 ----------------- ----------------- -----------------
30921.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
30922.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
30923.                 ----------------- ----------------- -----------------
30924.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
30925. 
30926.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
30927.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
30928.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
30929.    ----------------------------------------------------------
30930. 
30931. ----------------------------------------------------------
30932. FILE STATISTICS:
30933. ----------------------------------------------------------
30934. 
30935. ----------------------------------------------------------
30936. ITEM COUNT:
30937. ----------------------------------------------------------
30938. Number of files and folders:
30939. 
30940.               Unfragmented       Fragmented            All
30941.    ------- ----------------- ----------------- -----------------
30942.    Files   !FILES000N! !FILES010N! !FILES020N!
30943.    Folders !FILES100N! !FILES110N! !FILES120N!
30944.    ------- ----------------- ----------------- -----------------
30945.    All     !FILES200N! !FILES210N! !FILES220N!
30946. 
30947. ----------------------------------------------------------
30948. Percentage of total:
30949. 
30950.               Unfragmented       Fragmented            All
30951.    ------- ----------------- ----------------- -----------------
30952.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
30953.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
30954.    ------- ----------------- ----------------- -----------------
30955.    All     !FILES200P!%!FILES210P!%!FILES220P!%
30956. 
30957. ----------------------------------------------------------
30958. OCCUPIED SIZE on disk:
30959. ----------------------------------------------------------
30960. Bytes:
30961.               Unfragmented       Fragmented            All
30962.    ------- ----------------- ----------------- -----------------
30963.    Files   !FILES002N! !FILES012N! !FILES022N!
30964.    Folders !FILES102N! !FILES112N! !FILES122N!
30965.    ------- ----------------- ----------------- -----------------
30966.    All     !FILES202N! !FILES212N! !FILES222N!
30967. 
30968. ----------------------------------------------------------
30969. Gigabytes:
30970.               Unfragmented       Fragmented            All
30971.    ------- ----------------- ----------------- -----------------
30972.    Files   !FILES002G! !FILES012G! !FILES022G!
30973.    Folders !FILES102G! !FILES112G! !FILES122G!
30974.    ------- ----------------- ----------------- -----------------
30975.    All     !FILES202G! !FILES212G! !FILES222G!
30976. 
30977. ----------------------------------------------------------
30978. Percentage:
30979.               Unfragmented       Fragmented            All
30980.    ------- ----------------- ----------------- -----------------
30981.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
30982.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
30983.    ------- ----------------- ----------------- -----------------
30984.    All     !FILES202P!%!FILES212P!%!FILES222P!%
30985. 
30986. ----------------------------------------------------------
30987. USED SIZE:
30988. ----------------------------------------------------------
30989. Bytes:
30990.               Unfragmented       Fragmented            All
30991.    ------- ----------------- ----------------- -----------------
30992.    Files   !FILES001N! !FILES011N! !FILES021N!
30993.    Folders !FILES101N! !FILES111N! !FILES121N!
30994.    ------- ----------------- ----------------- -----------------
30995.    All     !FILES201N! !FILES211N! !FILES221N!
30996. 
30997. ----------------------------------------------------------
30998. Gigabytes:
30999.               Unfragmented       Fragmented            All
31000.    ------- ----------------- ----------------- -----------------
31001.    Files   !FILES001G! !FILES011G! !FILES021G!
31002.    Folders !FILES101G! !FILES111G! !FILES121G!
31003.    ------- ----------------- ----------------- -----------------
31004.    All     !FILES201G! !FILES211G! !FILES221G!
31005. 
31006. ----------------------------------------------------------
31007. Percentage:
31008.               Unfragmented       Fragmented            All
31009.    ------- ----------------- ----------------- -----------------
31010.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
31011.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
31012.    ------- ----------------- ----------------- -----------------
31013.    All     !FILES201P!%!FILES211P!%!FILES221P!%
31014. 
31015. ----------------------------------------------------------
31016. Volume Detailed Statistics end.
31017. ----------------------------------------------------------
31018. ") 
31019. 
31020. 
31021. WriteLogfile("!LogFileName! 0 Volume !VolumeDescription!", "!VolumeStatisticsDetail!")
31022. AppendLogfile("!LogFileName!", ".")
31023. AppendLogfile("!LogFileName!", "!VolumeStatisticsDetail!")
31024. AppendLogfile("!LogFileName!", ".")
31025. AppendLogfile("!LogFileName!", "Volume End.")	
31026. 
31027. # SetStatisticsWindowText("!VolumeStatisticsDetail!")
31028. 
31029. /* pause() */
31030. /* pause() */
31031. 
31032.   
31033. 
31034. VolumeEnd
31035. 
31036. /* ---------------------------------------------------------- */
31037. 
31038. AppendLogfile("!LogFileName!",".")
31039. SetVariable(FileStepDescription,"!Description! Complex Volume end: 2021-11-17 21:08:27.")
31040. # Script: BannerDescriptionSet
31041. 
31042. # Script: BannerSet
31043. 
31044. # Xinclude "..\Display\DisplaySetDateTimeRun.MyDc"X
31045. 
31046. SetVariable(Heading, '!RunDescription! Regular ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !RunDateTime!')
31047. 
31048. Title('!Heading!')
31049. /* pause(1) */
31050. 
31051. /* NOTE: Can't round or truncate to integer precision. */
31052. 
31053. # Script: BannerLog
31054. 
31055. AppendLogfile("!LogFileName!", "!Title!")
31056. 
31057. 
31058. 
31059. AppendLogfile("!LogFileName!",".")
31060. 
31061. /* ---------------------------------------------------------- */
31062. # End. ;-) (Return to caller lovely nubes, only MyD's get executed.)
31063. 
31064. 
