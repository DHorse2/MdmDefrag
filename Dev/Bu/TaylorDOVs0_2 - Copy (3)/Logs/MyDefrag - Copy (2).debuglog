# See the 'MyDefrag.log' file for information intended for endusers. This is the debug
# logfile. The contents is highly technical and not documented. See the 'Debug' setting
# or the '-d' commandline option to control the level of information in this file.
#
Version: MyDefrag v4.3.1 for X64
Date: 2021/11/13 20:31:22
Windows version: v6.2 build 9200 
Commandline: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily\DefragDevDiskDaily.MyD" 
Working Directory: G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily
Userid: david
InstallPath = C:\Program Files\MyDefrag v4.3.1\
20:31:22 Syntax error in script 'G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily\DefragDevDiskDaily.MyD' at line 30 column 35.

The command '||' is invalid, only the following commands are valid at this point:

	)

20:32:23 Script:
  1. # MyDefrag v4.0 script: Development Volume Daily defrag
  2. #
  3. # This script is part of the standard Mdm Volume configuration
  4. # Author: David G. Horsman (DBA MacroDM) (C) 2019
  5. # based on MyDefrag distribution.
  6. 
  7. /* Development Volume Daily*/
  8. SetVariable(RunStepDescription,"Dev Vol Daily")
  9. # Script: DisplaySetRun
 10. 
 11. SetVariable(RunStepDescription,			"!RunStepDescription! - DefragDevDiskDaily")
 12. SetVariable(SeverStepDescription,		"")
 13. SetVariable(VolumeStepDescription,		"")
 14. SetVariable(ZoneStepDescription,		"")
 15. SetVariable(FileStepDescription,		"")
 16. 
 17. SetVariable(VolumeStatisticsDetail, 	"")
 18. 
 19. SetVariable(ZoneListByLine, 			"Run start.")
 20. SetVariable(ZoneStepByLine, 			"")
 21. 
 22. # Script: BannerSet
 23. 
 24. # Script: DisplaySetDateTimeRun
 25. 
 26. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
 27. /* Xinclude "..\Display\BannerSet.MyDc"X */
 28. /* pause(1) */
 29. 
 30. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
 31. 
 32. Title('!Heading!')
 33. /* pause(1) */
 34. 
 35. /* NOTE: Can't round or truncate to integer precision. */
 36. 
 37. pause(2)
 38. 
 39. # This script is part of the standard  disk configuration
 40. # Author: David G. Horsman (DBA MacroDM) (C) 2019
 41. # based on MyDefrag distribution.
 42. 
 43. SetVariable(Heading,"Initializing...")
 44. 
 45. ProcessPriority(Normal)
 46. /* ProcessPriority(Normal) */
 47. 
 48. 
 49. 
 50. ExitIfTimeout(300) // 5 minutes (for old systems), default 120.
 51. /* ExitIfTimeout(300) // 5 minutes (for old systems), default 120. */
 52. 
 53. 
 54. 
 55. # Script: DisplayColors
 56. # MyDefrag color palette.
 57. 
 58. # RGB Color pallets. (Red,Green,Blue).
 59. 
 60. # Basics:
 61. 
 62. # Red			255,	0,		0)			// Red
 63. # Green			0,		255,	0)			// Green
 64. # Blue			0,		0,		255)		// Blue
 65. # Shades:
 66. 
 67. /* (White was left unused for the administrator to highlight things.) */
 68. # White 		255,	255,	255)		// White
 69. # Black			0,		0,		0)			// Black
 70. # Grey 			240,	240,	240)		// Grey
 71. 
 72. # Bright colors and shades:
 73. 
 74. # Purple 		170,	89,		221)		// Purple
 75. # Magenta		255, 	5, 		255)		// Magenta (pinkish)
 76. 
 77. # Pure Yellow 	255,	255,	0)			// Pure yellow
 78. # Yellow 		229, 	229, 	0)			// Yellow
 79. # Light Yellow 	255,	255,	224)		// Light Yellow
 80. 
 81. # Pure Red 		255, 	0, 		0)			// Red
 82. # Red 			204, 	92, 	92)			// Red
 83. # Light red		255,	115,	115)		// Light red
 84. # Orange		255, 	165, 	0)			// Orange
 85. 
 86. # Pure Green	0, 		255, 	0)			// Pure Green (Lime)
 87. # Green			0,		128,	0)			// Green
 88. # Light Green	144,	228, 	144)		// Light Green
 89. # Pale Green	152, 	251, 	152)		// Pale Green
 90. 
 91. # Dark blue		20,		87,		229)		// Dark blue
 92. # Light Blue	175,	198,	247)		// Light Blue
 93. # Bright Blue	0, 		223, 	255)		// Bright Blue
 94. # Light sky blue 135, 	206, 	250)		// Light sky blue
 95. # Deep sky blue	0, 		191, 	255)		// Deep sky blue
 96. 
 97. # Black			0,		0,		0)
 98. # Grey			240,	240,	240)
 99. 
100. # Window Colors
101. SetColor(Empty,										240,  	240, 	240)	// Grey
102. # ???
103. SetColor(Allocated,									45, 	72, 	128)	// Black
104. 
105. # Busy Colours
106. SetColor(BusyRead,									255,	54,		154)	// Neon
107. SetColor(BusyWrite,									212, 	0, 		106)	// Red Pinkish
108. 
109. #File Colors
110. SetFileColor(All,									0,		0,		0)		// Black
111. SetFileColor(Movable,								20,		87,		229)	// Dark blue
112. 
113. # Processed
114. SetFileColor(Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
115. SetFileColor(Processed and Fragmented,				170,	89,		221)	// Purple
116. 
117. # Fragmented and NotMovable
118. SetFileColor(Fragmented,							229, 	229, 	0)		// Yellow
119. SetFileColor(not(Movable),							255, 	165, 	0)		// Orange
120. 
121. # Light Green and Yellow
122. SetFileColor(Selected,								152,	251, 	152)	// Light Green
123. SetFileColor(Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
124. SetFileColor(Selected and not(Movable),				255,	115,	115)	// Light red
125. 
126. /* empty */
127. 
128. 
129. 
130. # Processes:
131. 	# This Process
132. 	SetVariable(RunProcessID,ProcessID)
133. 
134. 	# Kill other instances
135. 	/* Kill other MyDefrag Instances. */
136. 	/* Oops! This commits suicide. */
137. 	/* 	RunProgram("..\pskill.exe", "-t MyDefrag.exe") */
138. 	/* Pause(10) */
139. 	
140. 	/* If another instance of MyDefrag is already running then exit. */
141. 	/* Oops again. I don't know if this cause the hidden instance */
142. 	/* to hang around after the run. */
143. 	/* Warning: <alt><Run><Exit> seems to hide the instance not end it. */
144. 	/* The task mananager may be needed. This is under investigation. */
145. 
146. 	# OtherInstances
147. 	
148. OtherInstances(exit)
149. 
150. # OtherInstances
151. 	
152. # OtherInstances(exit)
153. 
154. 
155. 
156. 	# StatusBar
157. 	StatusBar(Status Path MouseOver)
158. 	# Script: DisplayStatusBar
159. # OtherInstances
160. 	
161. # OtherInstances(exit)
162. 
163. 	
164. 	# Power management
165. 	/* SetScreenPowerSaver(off) */
166. 	# Power management
167. 
168. 	/* SetScreenPowerSaver(off) */
169. 
170. 	# Power management
171. 
172. 	/* SetScreenPowerSaver(off) */
173. 
174. 
175. 
176. 
177. /* ---------------------------------------------------------- */
178. # Script Directory Location:
179. SetVariable(ScriptDir,"..\")
180. 
181. /* SetVariable(ScriptDir,"..\") */
182. /* SetVariable(ScriptDir,"G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily") */
183. /* SetVariable(ScriptDir,"E:\Ide\MyDefrag\MyDefrag\MdmScriptMyDefragVs4_3_1\") */
184. 
185. 
186. 
187. /* ---------------------------------------------------------- */
188. # DISPLAY - What text is displayed in Titlebar, data fields and reports.
189. 
190. 
191. /* The variable FileStepDescription get set to */
192. /* the messages below according to the Zone File */
193. /* step the defrag is on. */
194. 
195. /* The titlebar is organized in these areas: */
196. 
197. /* SwProductVs. */
198. /* Volume description. */
199. /* Zone description. */
200. /* File Processing Step (here.) */
201. /* Server and Script names. */
202. /* Run Date, Time and Elapsed (Bug) */
203. 
204. /* Shown in the Title / Banner / App Heading */
205. 
206. SetVariable(SeverStepDescription,	"")
207. SetVariable(VolumeStepDescription,	"")
208. SetVariable(ZoneStepDescription,	"")
209. SetVariable(FileStepDescription,	"")
210. SetVariable(RunStepDescription,		"")
211. 
212. # Display fields you can set for your personal tastes / needs:
213. 
214. /* ---------------------------------------------------------- */
215. # ZONE. Process One Zone (the steps and messages displayed. */
216. 
217. SetVariable(FileStepDescriptionZoneStart, 			"Zone started.")
218. 
219. /* "Your Zone Pre (before)Processing." */
220. SetVariable(FileStepDescriptionYourZonePre, 		"!FileStepDescriptionZoneStart!") 		
221. 
222. SetVariable(FileStepDescriptionFileSelect,			"Selecting Files.")
223. 
224. /* "Your Pre Sort File Actions." */
225. SetVariable(FileStepDescriptionYourFileActionsPre, 	"!FileStepDescriptionFileSelect!")
226. 
227. SetVariable(FileStepDescriptionFileActionStart, 	"File Actions started.")
228. 
229. /* "Your Post Sort File Actions." */
230. SetVariable(FileStepDescriptionYourFileActionsPost, "!FileStepDescriptionFileActionStart!")
231. 
232. SetVariable(FileStepDescriptionFileActionEnd, 		"File Actions completed.")
233. 
234. /* "Your Zone Post (after) Processing." */
235. SetVariable(FileStepDescriptionYourZonePost, 		"!FileStepDescriptionFileActionEnd!") 		
236. 
237. SetVariable(FileStepDescriptionFileActionGap, 		"Calculating Gap.")
238. 
239. SetVariable(FileStepDescriptionZoneEnd, 			"Zone finished.")
240. 
241. /* Pattern: SetVariable(FileStepDescriptionXXX, 	"FileStepDescriptionXXX") */
242. 
243. /* Note: If you add custom script code in the PRE and POST areas then at that */
244. /* time you fill in the messages above as appropriate. */
245. 
246. /* empty */
247. 
248. /* ---------------------------------------------------------- */
249. # Regarding Volume Names/Labels
250. 
251. /* FYI. The Volume names / drive letters need to be correct for your system. */
252. /* It is repeated here for infomation about fields used above. */
253. /* Set your values in "SettingsYours\SettingsYoursVolumeNames.MyDc" */
254. 
255. 	/* SetVariable(VolumeSys,"!VolumeNamePrefix!Sys") */
256. 	/* SetVariable(VolumeDev,"!VolumeNamePrefix!Dev") */
257. 	/* SetVariable(VolumeData,"!VolumeNamePrefix!Data") */
258. 	/* SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive") */
259. 
260. 	/*		or just */
261. 			
262. 	/* SetVariable(VolumeSys,"C:") */
263. 	/* SetVariable(VolumeDev,"E:") */
264. 
265. /* ---------------------------------------------------------- */
266. # BANNER DEFINITION
267. /* SetVariable(Heading, "Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! || !FileStepDescription! ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskDaily on 2021-11-13 20:31:18 0:00:01") */
268. 
269. # How to build them: (documentation)
270. 
271. /* Here is how is one pattern not used: */
272. /* SetVariable(Heading, "|") */
273. /* SetVariable(Heading, "!Heading! Vol: !VolumeStepDescription!") */
274. /* SetVariable(Heading, "!Heading! Zone: !ZoneStepDescription!") */
275. /* SetVariable(Heading, "!Heading! !FileStepDescription!") */
276. /* SetVariable(Heading, "!Heading!  ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskDaily") */
277. /* SetVariable(Heading, " on 2021-11-13 20:31:18 0:00:01") */
278. /* SetVariable(Heading, "!Heading!|") // spacers. */
279. 
280. /* A typical banner field list: */
281. # Appearing in Title('Vol: !
282. # VolumeCurrent
283. # ! Zone: !
284. # ZoneCurrentDescription
285. # ! !
286. # ZoneCurrent
287. # ! of !
288. # ZoneCount
289. # ! || Free: Vol: !
290. # VolumeFreePerUsed
291. # !% Zone: !
292. # ZoneFreePerUsed
293. # !% || Script: !
294. # ScriptTitle
295. # ! System: !
296. # VolumeNamePrefix
297. # ! !
298. # ServerNameFull
299. # ! !
300. # Date
301. # ! !
302. # Time
303. # ! !
304. # RunTime
305. # !')
306. /* . */
307. 
308. 
309. /* Progress Display */
310. SetVariable(ZoneListByLine, 	"Volume start.")
311. SetVariable(ZoneStepByLine, 	"")
312. 
313. /* There is 6 digit decimal precision so by using */
314. /* 1Mb the full number is displayed in a much more */
315. /* readable form. */
316. 
317. SetVariable(DisplayUnitDivisor, 	1000000) // 1MB.
318. 
319. /* ---------------------------------------------------------- */
320. # SERVER INFORMATION
321. 
322. 	/* ServerName (IE. Computer name or number.) not used. */
323. 	/* System99 */
324. 		# SetVariable(ServerName,"Pc15")
325. 
326. 		# Server Names
327. 
328. # ???
329. 
330. # IMPORTANT: ServerName NAME: 
331. 
332. 	# SetVariable(ServerName,"PcAny")
333. 
334. # IMPORTANT: ServerName NAME: 
335. 
336. 	# SetVariable(ServerName,"PcAny")
337.     /* System99 */
338. # SET
339. SetVariable(ServerName,"RavenPc")
340. 
341. 
342. 	
343. 	/* Descriptive Information so maybe */
344. 	/* VolumeNamePrefix (IE. Person or company initials) not used. */
345. 	/* "Xyz" */
346. 		# SetVariable(VolumeNamePrefix,"Mdm")
347. 
348. 		# VolumeNamePrefix
349. 
350. /* Descriptive Information so maybe */
351. /* VolumeNamePrefix (IE. Person or company initials) not used. */
352. /* "Xyz" */
353. 	SetVariable(VolumeNamePrefix,"VolThis")
354. 
355. 	
356. /* Descriptive Information so maybe */
357. /* VolumeNamePrefix (IE. Person or company initials) not used. */
358. /* "Xyz" */
359. 	SetVariable(VolumeNamePrefix,"Vol")
360. 
361. /* Server name full is usually the server and computer combined. not used. */
362. 	SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
363. 
364. 
365. 	/* Server name full is usually the server and computer combined. not used. */
366. 
367. 		SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
368. 	
369. 	# Script: DisplaySetServer
370. # (Volume)
371. SetVariable(SeverStepDescription, 	"!ServerNameFull!")
372. SetVariable(VolumeStepDescription, 	"")
373. SetVariable(ZoneStepDescription, 	"")
374. SetVariable(FileStepDescription, 	"")
375. # Script: BannerSet
376. 
377. # Script: DisplaySetDateTimeRun
378. 
379. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
380. /* Xinclude "..\Display\BannerSet.MyDc"X */
381. /* pause(1) */
382. 
383. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
384. 
385. Title('!Heading!')
386. /* pause(1) */
387. 
388. /* NOTE: Can't round or truncate to integer precision. */
389. 
390. /* pause(2) */
391. 
392. /* ---------------------------------------------------------- */
393. # VOLUMES
394. /* ---------------------------------------------------------- */
395. 
396. 	# Volume Do Current Clear
397. 
398. /* ---------------------------------------------------------- */
399. # Current Values.
400. 	SetVariable(VolumeLabel, "NotSet")
401. 	SetVariable(VolumeDescription, "")
402. 
403. 	SetVariable(VolumeCount, 0)
404. 	SetVariable(VolumeNoCurrent, 0)
405. 	SetVariable(VolumeNoAdjCurrent, 0)
406.   	SetVariable(VolumeCurrentAjust, 0) // not used
407. 
408. /* ---------------------------------------------------------- */
409. # OS Disk Usage.
410. 
411. /* Percentage of disk used by OS */
412. 
413. 	SetVariable(OsPer, 0.18)
414. 
415. 	     SetVariable(ZoneCountOs, 5)
416. 
417.        SetVariable(ZoneCountType, 0) // not used
418.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
419. 
420. 	    SetVariable(ZoneCountSys, 2)
421. 	    SetVariable(ZoneCountDev, 7)
422. 
423. 	   SetVariable(ZoneCountData, 0)
424. 	SetVariable(ZoneCountArchive, 0)
425. 	
426. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
427. 
428. /* ---------------------------------------------------------- */
429. # Volume Totals
430. 	# USED:
431. 	/* Current total volume space used */
432. 	SetVariable(VolumeZoneUsed, 			0)
433. 	/* percentage */
434. 	SetVariable(VolumeZoneUsedPer, 			0)
435. 
436. 	# FREE:
437. 	/* Current total of free space used */
438. 	SetVariable(VolumeFreeRequested, 		0)
439. 	/* percentage */
440. 	SetVariable(VolumeFreeRequestedPer, 	0)
441. 
442. 	/* Current total of free space used */
443. 	SetVariable(VolumeFreeUsed, 			0)
444. 	/* percentage */
445. 	SetVariable(VolumeFreeUsedPer, 			0)
446. 	
447. /* ---------------------------------------------------------- */
448. # Volume Free Space Proportional Used Space vs Volume Size.
449. 	/* We only want to use a ratio of the free space relative to the volume. */
450. 	/* We could just use percentages of the total free space as well. */
451. 
452. 	/* SetVariable(VolumeFreeAdj, 		1) */
453. 	
454. 	SetVariable(VolumeFreeAdj,				(VolumeFree * (VolumeUsed / VolumeSize)))
455. 
456. /* ---------------------------------------------------------- */
457. # ZONES
458. 
459. 	SetVariable(ZoneNoCurrent, 0)
460. 	SetVariable(ZoneNoAdjCurrent, 0)
461. 	SetVariable(ZoneCurrentAjust, 0)
462. 
463. 	# Script: ZoneDoCurrentClear
464. 
465. SetVariable(ZoneTypeSelectCurrent, 		"")
466. 
467. SetVariable(ZoneBeginCurrent, 			0)
468. SetVariable(ZoneBeginPerCurrent, 		0)
469. SetVariable(ZoneEndCurrent, 			0)
470. SetVariable(ZoneEndPerCurrent, 			0)
471. 
472. SetVariable(ZoneSizeCurrent,			0)
473. SetVariable(ZoneSizePerCurrent,			0)
474. 
475. SetVariable(ZoneGapRequestedCurrent,	0)
476. SetVariable(ZoneGapRoundedCurrent, 		0)
477. SetVariable(ZoneGapAdjustedCurrent, 	0)
478. SetVariable(ZoneGapAvailableCurrent, 	0)
479. SetVariable(ZoneGapCurrent,				0)
480. SetVariable(ZoneGapUsedCurrent, 		0)
481. 
482. SetVariable(ZoneGapActualCurrent, 		0)
483. SetVariable(ZoneGapActualPerCurrent, 	0)
484. 
485. SetVariable(ZoneSizeActual, 			0)
486. SetVariable(ZoneSizeActualCurrent,		0)
487. 
488. SetVariable(ZoneEndActual, 				0)
489. SetVariable(ZoneEndActualCurrent,		0)			
490. SetVariable(ZoneSizeActualPerCurrent, 	0)
491.       
492. SetVariable(ZoneFilesFolders,			0)
493. SetVariable(ZoneFilesFoldersPer,		0) 
494. 
495. SetVariable(ZoneFragments,				0)
496. SetVariable(ZoneFragmentsPer,			0) 
497. 		
498. SetVariable(ZoneEndActualCurrent, 		0)
499. SetVariable(ZoneEndActualPerCurrent, 	0)
500. 
501. # Gap Calculation Methodology:
502. 	# Requested
503. 	SetVariable(GapRequested, 			0) 
504. 	SetVariable(GapRequestedStd, 		0) 
505. 	SetVariable(GapRequestedMft, 		0) 
506. 	SetVariable(GapRequestedOs, 		0) 
507. 	SetVariable(GapRequestedOriginal, 	0) 
508. 	
509. 	# Gap Adjustments
510. 	SetVariable(GapRounded, 			0)
511. 	# SetVariable(GapAdjusted, 			0)
512. 	SetVariable(GapAvailable, 			0)
513. 	SetVariable(GapCurrent, 			0)
514. 	SetVariable(GapActual, 				0)
515. 	SetVariable(GapUsed, 				0)
516. 	
517. 	# Gap Adjustments
518. 	SetVariable(GapRoundedLoc, 			0)
519. 	# SetVariable(GapAdjustedLoc, 		0)
520. 	SetVariable(GapAvailableLoc, 		0)
521. 	SetVariable(GapCurrentLoc, 			0)
522. 	SetVariable(GapActualLoc,			0)
523. 	SetVariable(GapUsedLoc,				0)
524. 	
525. 	# Space usage
526. 	SetVariable(ZoneFreePerRequested, 	0)
527. 	SetVariable(ZoneFreePerUsed, 		0)
528. 
529. # Gap Size & Rounding
530. 	SetVariable(ZoneGapSizePer, 		0)
531. 	SetVariable(ZoneVolRoundUpPer, 		0)
532. 	
533. 	# Free Space
534. 	SetVariable(ZoneFreeUsedPer, 		0)
535. 	SetVariable(ZoneFreeRequestedPer, 	0)
536. 
537. 
538. 	SetVariable(ZoneLabel, "Volume")
539. 	SetVariable(ZoneDescription, "Analysis...")
540. 	# Script: BannerSet
541. 
542. # Script: DisplaySetDateTimeRun
543. 
544. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
545. /* Xinclude "..\Display\BannerSet.MyDc"X */
546. /* pause(1) */
547. 
548. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
549. 
550. Title('!Heading!')
551. /* pause(1) */
552. 
553. /* NOTE: Can't round or truncate to integer precision. */
554. 
555. 
556. 	
557. 	  
558. 	SetVariable(VolumeLabel, "NotSet")
559. 	SetVariable(VolumeDescription, "")
560. 
561. 	SetVariable(FileStepDescription,"Initializing run...")
562. 	# Script: BannerSet
563. 
564. # Script: DisplaySetDateTimeRun
565. 
566. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
567. /* Xinclude "..\Display\BannerSet.MyDc"X */
568. /* pause(1) */
569. 
570. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
571. 
572. Title('!Heading!')
573. /* pause(1) */
574. 
575. /* NOTE: Can't round or truncate to integer precision. */
576. 
577. 
578. /* ---------------------------------------------------------- */
579. # VOLUME TYPES
580. 
581. 	/* Volumes */
582. 	/* . */
583. 	/* Only those were fully implemented: */
584. 	/* Sys */
585. 	/* Dev */
586. 	/* . */
587. 	/* Common types of volumes: */
588. 	/* Data */
589. 	/* Archive */
590. 	/* . */
591. 	/* Other historical volumes: */
592. 	/* Test */
593. 	/* Live */
594. 	/* Server */
595. 	/* Client */
596. 	/* SysUtils */
597. 	/* . */
598. 
599. # IMPORTANT: VOLUME NAME: SET YOUR:
600. 	/* VOLUME NAMES IN SettingsYours\SettingsYoursVolumeNames.MyDc */
601. 	/* 		or    			*/
602. 	/* VOLUME NAME (one only for override) in SettingsYours\SettingsYoursVolume.MyDc */
603. 	/* 		or here also 	*/
604. 	SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
605. 	SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
606. 
607. 	/* SetVariable(VolumeSys,"C:") */
608. 	/* SetVariable(VolumeDev,"E:") */
609. 
610. 	/* These are for dedicated disks. */
611. 	/* So it means JUST Data or JUST Archives. */
612. 
613. 	SetVariable(VolumeData,"!VolumeNamePrefix!Data")
614. 	SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
615. 	
616. 	# IMPORTANT: VOLUME NAME: 
617. 
618. 	# SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
619. 	# SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
620. 	# SetVariable(VolumeData,"!VolumeNamePrefix!Data")
621. 	# SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
622. 
623. 	#    or this:
624. 	
625. 	
626. 	SetVariable(VolumeSys,"C:")
627. 	SetVariable(VolumeDev,"C:")
628. 	SetVariable(VolumeData,"C:")
629. 	SetVariable(VolumeArchive,"C:")
630. 
631. 
632. # SET
633. # SetVariable(VolumeSys,"C:")
634. 
635. 
636. 
637. /* ---------------------------------------------------------- */
638. # OS Disk Usage.
639. /* Percentage of disk used by OS */
640. 
641. 	SetVariable(OsPer, 0.18)
642. 
643. 	     SetVariable(ZoneCountOs, 5)
644. 
645.        SetVariable(ZoneCountType, 0) // not used
646.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
647. 
648. 	    SetVariable(ZoneCountSys, 2)
649. 	    SetVariable(ZoneCountDev, 7)
650. 
651. 	   SetVariable(ZoneCountData, 0)
652. 	SetVariable(ZoneCountArchive, 0)
653. 	
654. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
655. 
656. /* ---------------------------------------------------------- */
657. # ZONE TYPES. 
658. /* ---------------------------------------------------------- */
659. 	/* Type Labels, Descriptions, Gaps and Rounding. */
660. 	/* Load the Zone Definitions */
661. 	/* These are file categories basically */
662. 	/* and are maintained in a single file */
663. 	/* for ease of maintenance. Here: */
664. 	
665. 	/* ---------------------------------------------------------- */
666. # ROUNDING factors:
667. 
668. /* HERE if you want to tweak how type the Gaps are if growth is slow. */
669. /* HERE if your DISK IS VERY FULL */
670. /* This is where you can tweak growth rounding if the Volume gets really full. */
671. /* You don't have to use these, you can use actual percentages in the Zone section. */
672. 
673. /* Note: Volume and Gap Sizes are paired to a degree and */
674. /* set relative to each other. */
675. 	
676. 	      SetVariable(VolumeRoundUpNone, 	1)
677. 	      SetVariable(VolumeRoundUpTiny, 	0.005)
678. 	     SetVariable(VolumeRoundUpSmall, 	0.01)
679. 	    SetVariable(VolumeRoundUpMedium, 	0.02)
680. 	     SetVariable(VolumeRoundUpLarge, 	0.03)
681. 	SetVariable(VolumeRoundUpExtraLarge, 	0.05)
682. 	
683. 	    SetVariable(VolumeRoundUpBlogBu, 	0.10)
684. 	
685. 	      SetVariable(ZoneGapSizeNone, 		0)
686. 	      SetVariable(ZoneGapSizeTiny, 		0.005)
687. 	     SetVariable(ZoneGapSizeSmall, 		0.01)
688. 	    SetVariable(ZoneGapSizeMedium, 		0.05)
689. 	     SetVariable(ZoneGapSizeLarge, 		0.10)
690. 	SetVariable(ZoneGapSizeExtraLarge, 		0.15)
691. 		
692. 	    SetVariable(ZoneGapSizeBlobBu, 		0.10)
693. 
694. /* ---------------------------------------------------------- */
695. # ZONE SETTINGS:
696. /* ---------------------------------------------------------- */
697. /* These are the Zone Names */
698. /* Regular is at the end but otherwise */
699. /* this is in the order they appear on disk */
700. 
701. # Os Programs.
702. SetVariable(ZoneLabelBoot, 				"Boot")
703. SetVariable(ZoneLabelBootData, 				"BootData")
704. SetVariable(ZoneLabelProgramHints,			"ProgramHints")
705. SetVariable(ZoneLabelProgramHintsData,			"ProgramHintsData")
706. SetVariable(ZoneLabelPrograms,				"Programs")
707. SetVariable(ZoneLabelProgramsWindows,			"ProgramsWindows")
708. SetVariable(ZoneLabelProgramsData,			"ProgramsData")
709. # Moved to after Mft & Dir.
710. SetVariable(ZoneLabelPageHiperDump,			"PageHiperDump")
711. 
712. # Os Mft & Directories.
713. SetVariable(ZoneLabelMft,				"MFT")
714. SetVariable(ZoneLabelDir,				"DIR")
715. 
716. # Standard Zones.
717. SetVariable(ZoneLabelIdeScripts, 			"IdeScripts")
718. SetVariable(ZoneLabelDevToDo, 				"DevToDo")
719. SetVariable(ZoneLabelLinksCorp, 			"LinksCorp")
720. SetVariable(ZoneLabelPeople, 				"People")
721. # MFT.
722. # DIR.
723. # Games. 
724. SetVariable(ZoneLabelGames, 				"Games")
725. SetVariable(ZoneLabelShares, 				"Shares")
726. SetVariable(ZoneLabelSystemOtherData, 			"SystemOtherData")
727. SetVariable(ZoneLabelReference, 			"Reference")
728. 
729. 
730. # Sys.
731. # People.
732. # OS, Mft, Dir.
733. # Games.
734. SetVariable(ZoneLabelRegular, 				"Regular")
735. 
736. # Common.
737. SetVariable(ZoneLabelSpaceHogs, 			"SpaceHogs")
738. SetVariable(ZoneLabelArchivesBu, 			"ArchivesBu")
739. 
740. /* ---------------------------------------------------------- */
741. /* Use however you like */
742. 
743. # Os Programs.
744. SetVariable(ZoneDescriptionBoot, 			"!ZoneLabelBoot!")
745. SetVariable(ZoneDescriptionBootData, 			"!ZoneLabelBootData!")
746. SetVariable(ZoneDescriptionProgramHints, 		"!ZoneLabelProgramHints!")
747. SetVariable(ZoneDescriptionProgramHintsData, 		"!ZoneLabelProgramHintsData!")
748. SetVariable(ZoneDescriptionPrograms, 			"!ZoneLabelPrograms!")
749. SetVariable(ZoneDescriptionProgramsWindows, 		"!ZoneLabelProgramsWidows!")
750. SetVariable(ZoneDescriptionProgramsData, 		"!ZoneLabelProgramsData!")
751. SetVariable(ZoneDescriptionPageHiperDump, 		"!ZoneLabelPageHiperDump!")
752. 
753. # Os Mft & Directories.
754. SetVariable(ZoneDescriptionMft, 			"!ZoneLabelMft!")
755. SetVariable(ZoneDescriptionDir, 			"!ZoneLabelDir!")
756. 
757. # Standard Zones:
758. SetVariable(ZoneDescriptionIdeScripts, 			"!ZoneLabelIdeScripts!")
759. SetVariable(ZoneDescriptionDevToDo, 			"!ZoneLabelDevToDo!")
760. SetVariable(ZoneDescriptionLinksCorp, 			"!ZoneLabelLinksCorp!")
761. SetVariable(ZoneDescriptionPeople, 			"!ZoneLabelPeople!")
762. # MFT.
763. # DIR.
764. # Games. 
765. SetVariable(ZoneDescriptionGames, 			"!ZoneLabelGames!")
766. SetVariable(ZoneDescriptionShares, 			"!ZoneLabelShares!")
767. SetVariable(ZoneDescriptionSystemOtherData, 		"!ZoneLabelSystemOtherData!")
768. SetVariable(ZoneDescriptionReference, 			"!ZoneLabelReference!")
769. 
770. # Sys.
771. # People.
772. # OS, Mft, Dir.
773. SetVariable(ZoneDescriptionRegular, 			"!ZoneLabelRegular!")
774. 
775. SetVariable(ZoneDescriptionSpaceHogs, 			"!ZoneLabelSpaceHogs!")
776. SetVariable(ZoneDescriptionArchivesBu, 			"!ZoneLabelArchivesBu!")
777. 
778. /* ---------------------------------------------------------- */
779. /* This rounds up to even locations on the volume to keep */
780. /* the location of data relatively stable during fluctuation. */
781. 
782. /* NOTE: For Volume specifice settings you would have to copy these */
783. /* next two sections and use them in the SettingsYours\SettingsYours for each Volume. */
784. /* You would need a copy of these two to use in a Reset function between Volumes. */
785. 
786. # Os Programs.
787. SetVariable(ZoneVolRoundUpBoot, 		"!VolumeRoundUpSmall!")
788. SetVariable(ZoneVolRoundUpProgramHints, 	"!VolumeRoundUpSmall!")
789. SetVariable(ZoneVolRoundUpPrograms, 		"!VolumeRoundUpMedium!")
790. SetVariable(ZoneVolRoundUpPageHiperDump,	"!VolumeRoundUpSmall!")
791. 
792. # Os Mft & Directories.
793. SetVariable(ZoneVolRoundUpMft,			"!VolumeRoundUpTiny!")
794. SetVariable(ZoneVolRoundUpDir,		 	"!VolumeRoundUpLarge!")
795. 
796. # Standard Zones.
797. SetVariable(ZoneVolRoundUpIdeScripts, 		"!VolumeRoundUpSmall!")
798. SetVariable(ZoneVolRoundUpDevToDo, 		"!VolumeRoundUpSmall!")
799. SetVariable(ZoneVolRoundUpLinksCorp, 		"!VolumeRoundUpSmall!")
800. SetVariable(ZoneVolRoundUpPeople, 		"!VolumeRoundUpMedium!")
801. # MFT.
802. # DIR.
803. # Games. 
804. # ToDo.............
805. SetVariable(ZoneVolRoundUpGames, 		"!VolumeRoundUpSmall!")
806. SetVariable(ZoneVolRoundUpShares, 		"!VolumeRoundUpSmall!")
807. SetVariable(ZoneVolRoundUpSystemOtherData, 	"!VolumeRoundUpSmall!")
808. SetVariable(ZoneVolRoundUpReference, 		"!VolumeRoundUpMedium!")
809. 
810. # Sys.
811. # People.
812. # OS, Mft, Dir.
813. # Games.
814. SetVariable(ZoneVolRoundUpRegular, 		"!VolumeRoundUpMedium!")
815. 
816. # Common.
817. SetVariable(ZoneVolRoundUpSpaceHogs, 		"!VolumeRoundUpMedium!")
818. SetVariable(ZoneVolRoundUpArchivesBu, 		"!VolumeRoundUpTiny!")
819. 
820. /* ---------------------------------------------------------- */
821. /* Your Zone Gap consumption of free space as a percentage. */
822. /* Clearly this can not exceed 100%. Keep it under 99%. */
823. 
824. # Os Programs.
825. SetVariable(ZoneGapSizeBoot, 				"!ZoneGapSizeTiny!")
826. SetVariable(ZoneGapSizeProgramHints,	 		"!ZoneGapSizeTiny!")
827. SetVariable(ZoneGapSizePrograms, 			"!ZoneGapSizeSmall!")
828. SetVariable(ZoneGapSizePageHiperDump, 			"!ZoneGapSizeSmall!")
829. 
830. # Mft & Directories.
831. SetVariable(ZoneGapSizeMft, 				"!ZoneGapSizeTiny!")
832. SetVariable(ZoneGapSizeDir,		 		"!ZoneGapSizeTiny!")
833. 
834. # Standard Zones.
835. SetVariable(ZoneGapSizeIdeScripts, 			"!ZoneGapSizeMedium!")
836. SetVariable(ZoneGapSizeDevToDo, 			"!ZoneGapSizeMedium!")
837. SetVariable(ZoneGapSizeLinksCorp, 			"!ZoneGapSizeMedium!")
838. SetVariable(ZoneGapSizePeople, 				"!ZoneGapSizeMedium!")
839. # MFT.
840. # DIR.
841. # Games. 
842. # ToDo.............
843. SetVariable(ZoneGapSizeGames, 				"!ZoneGapSizeMedium!")
844. SetVariable(ZoneGapSizeShares, 				"!ZoneGapSizeMedium!")
845. SetVariable(ZoneGapSizeSystemOtherData, 		"!ZoneGapSizeMedium!")
846. SetVariable(ZoneGapSizeReference, 			"!ZoneGapSizeSmall!")
847. 
848. # Sys.
849. # People.
850. # OS, Mft, Dir.
851. # Games.
852. SetVariable(ZoneGapSizeRegular, 			"!ZoneGapSizeMedium!")
853. 
854. # Common.
855. SetVariable(ZoneGapSizeSpaceHogs, 			"!ZoneGapSizeMedium!")
856. SetVariable(ZoneGapSizeArchivesBu, 			"!ZoneGapSizeTiny!")
857. 
858. /* ---------------------------------------------------------- */
859. # ZONE CALCULATION METHODS:
860. # OS ZONE SETTINGS:
861. /* ---------------------------------------------------------- */
862. 
863. 	/* ---------------------------------------------------------- */
864. 	# VOLUME MFT Location.
865. 	/* The Volume Location of the MFT as a percentage of the Volume. */
866. 		
867. 		SetVariable(MftVolumeRoundUp, 		"!VolumeRoundUpLarge!")
868. 		SetVariable(MftVolumeGapSize, 		"!ZoneGapSizeTiny!")
869. 		
870. 		# MFT CALCULATION METHODS.
871. 			# STANDARD Method.
872. 			/* IMPORTANT: Standard method currently in use. */
873. 			/* IE: The others below are ignored but instructive. */
874. 			/* None of the following settings are used, hence zero. */
875. 			SetVariable(MftPer, 			0)
876. 			SetVariable(MftLocation, 		0)
877. 			
878. 			# MFT Method.
879. 			/* Place files at X% (MftPerSys) into the data on the Volume. */
880. 			/* This is really tied the ratio of executables to data and blobs. */
881. 			# SetVariable(MftPer, 			0.30)
882. 			# SetVariable(MftLocation, 		1000000000)
883. 			# SetVariable(MftGapSize, 		"!ZoneGapSizeLarge!")
884. 		
885. 			# FIXED Method.
886. 			# SetVariable(MftLocation, 		1000000000) // (IE. Yours)
887. 			# SetVariable(MftPer, 			MftLocation / VolumeSize)
888. 			
889. 			# ORIGINAL Method.
890. 			/* DEPRECIATED, not in use. */
891. 			/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
892. 			# SetVariable(MftPer, 			0.30)
893. 		
894. 		# ROUNDING.	
895. 		# SetVariable(MftLocation,			RoundUp(MftLocation, VolumeSize * MftVolumeRoundUp))
896. 		
897. 		# MFT ZONE.
898. 		/* Zone Number (not used for locating MFT.) */
899. 		SetVariable(MftZone, 				4) // Insert before this zone, info only.
900. 		/* Zone 10 on the Dev Volume */
901. 	
902. 	/* ---------------------------------------------------------- */
903. 	# VOLUME SPECIFIC MFT.
904. 	/* Note: You may need to set Volume specific values for the MFT location, */
905. 	/* On these volume types do not "push" the data above the MFT table? */
906. 	/* You can use a standard gap instead. */
907. 		
908. 			/* The current Volume Type Mft Percentage */
909. 		    # SetVariable(MftPer, 				0)
910. 		    # SetVariable(MftPerTypedDefault, 			"!MftPer!")
911. 			# Volume Types:	
912. 			#         SetVariable(MftPerSys, 		0.35)
913. 			# 	    SetVariable(MftPerDev, 		0.10)
914. 			# 	   SetVariable(MftPerData, 		0.35)
915. 			# 	SetVariable(MftPerArchive, 		0.10)
916. 	
917. 	/* ---------------------------------------------------------- */
918. 	# VOLUME DIR Location.
919. 	/* The amount of Gap between Mft and Dir's, the Location of DIR. */
920. 	
921. 		/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
922. 	
923. 		SetVariable(DirVolumeRoundUp, 		"!VolumeRoundUpLarge!")
924. 		SetVariable(DirVolumeGapSize, 		"!ZoneGapSizeLarge!")
925. 		
926. /* ---------------------------------------------------------- */
927. # SETTINGS YOURS
928. /* empty */
929. 
930. /* ---------------------------------------------------------- */
931. 
932. /* ---------------------------------------------------------- */
933. # STATISTICS
934. /* ---------------------------------------------------------- */
935. 
936. /* Xinclude "..\StatisticsInitialization.MyDc"X ToDo */
937. 
938. 
939. /* ---------------------------------------------------------- */
940. # GAPS
941. 	# TEST (FAILED!!!) NO BOOLEAN LOGIC AVAILABLE.
942. 	SetVariable(FlagDoNotVacate, 0)
943.  
944. /* ---------------------------------------------------------- */
945. # ZONE
946. 	SetVariable(ZoneNoCurrent, 		0)
947. 	SetVariable(ZoneNoAdjCurrent, 	0) 
948. 	SetVariable(ZoneCurrentAjust,	0)
949. 
950. 	SetVariable(ZoneListByLine, 		"Volume started.
951. ")
952. 	SetVariable(ZoneStepByLine, 		"Initialize.
953. ")
954. 	SetVariable(ZoneStatisticsDetail, 	"")
955. 
956. /* ---------------------------------------------------------- */
957. # ZONE FILE STEP (ACTIONS)
958. 	/* Nothing to set here */
959. 
960. /* ---------------------------------------------------------- */
961. # BLOB SIZE
962. 
963. 	# Size 10MB
964. 	SetVariable(BlobFileSize, 10000000)
965. 
966. /* ---------------------------------------------------------- */
967. # SKIP BLOCK
968.  
969. /* (important for run efficiency.) */
970. /* FILES: */
971. /* Day Files: 100 */
972. /* Monthly: 500 */
973. /* Yearly: 1M */
974. 
975. 	/* 100 Files - moved most blocks */
976. 	 /* 10 Files - 20211105 (error - not done) */ 
977. 	 /* 10 Files - (20211106) - Current */
978. 	 /* 5 Files - (2021????) - */
979. 	SetVariable(SkipBlockFilesDay, 10)
980. 
981. 	SetVariable(SkipBlockFilesMonth, 500)
982. 	SetVariable(SkipBlockFilesYear, 1000000)
983. 
984. 	/* Current: */
985. 	SetVariable(SkipBlockFiles,"!SkipBlockFilesMonth!")
986. 
987. /* BYTES: */
988. /* Day Bytes: 50MB */
989. /* Month Bytes: 500MB */
990. /* Year Bytes: 5GB */
991. 
992. 	 /* 50 MB Moved most existing blocks */
993. 	 /* 5 MB 20211105 (not done) */ 
994. 	 /* 1 MB 20211105 - Current */
995. 	SetVariable(SkipBlockBytesDay, 1000000)
996. 	/* SetVariable(SkipBlockBytesDay, 50000000) */
997. 
998. 	SetVariable(SkipBlockBytesMonth, 500000000)
999. 	SetVariable(SkipBlockBytesYear, 5000000000)
1000. 
1001. 	/* Current: */
1002. 	SetVariable(SkipBlockBytes,"!SkipBlockBytesMonth!")
1003. 
1004. /* ---------------------------------------------------------- */
1005. # ZONE LOCATION METHODS:
1006. 
1007. # No 1) Standard. You can ignore this section
1008. 	/* Gaps between zones are a percentage of */
1009. 	/* free space auto adjusted to pack the used */
1010. 	/* space closely together and for performance. */
1011. 	
1012. 	/* The calculation will clear the Gap */
1013. 	/* and RoundUp to the fixed value present */
1014. 	
1015. 	SetVariable(ZoneMethodStd, 1)
1016. 
1017. /* The following are NOT FULLY IMPLEMENTED OR TESTED */
1018. # No 2) Mft. Relative to its location.
1019. 	SetVariable(ZoneMethodMft, (0-1))
1020. 
1021. # No 3) Os. Percentages are AFTER OsMftDir Space Used.
1022. 	SetVariable(ZoneMethodOs, (0-1))
1023. 
1024. # No 4) Orginal Mft/Os 1-5.
1025. 	SetVariable(ZoneMethodOrginal, (0-1))
1026. 
1027. # No 5) FIXED ZONES if you used them.
1028. 	
1029. 	SetVariable(ZoneMethodFixed, (0-1))
1030. 	SetVariable(ZoneMethodFixedPer, (0-1))
1031. 
1032. 	/* Not recommended */
1033. 	/* However doing all calcs is informative regarding what */
1034. 	/* Types of Volume data (Zones) exist. */
1035. 	
1036. 	/* Your FIXED calculation method, this can be: */
1037. 	SetVariable(ZoneMethodFixedVariantPer, (0-1))
1038. 	
1039. 	/* 1) Percentage. */
1040. 		/* So when it is 1 or On. */
1041. 		/* Not great but easy to use. */
1042. 		 
1043. 	/* 2) Fixed volume location. */
1044. 		/* When 0 or Off it is a volume location. */
1045. 		/* You will have to change: */
1046. 		/* file item xxxxxxxxx??? */
1047. 	
1048. 	/* FIXED VALUES: */
1049. 		/* SetVariable(ZoneMethodFixed, 1) */
1050. 	
1051. 		# Setting the following to a percentage or number:
1052. 		/* OS */
1053. 	    SetVariable(ZoneOsBoot, 0) // 1
1054. 	    SetVariable(ZoneOsProgramHints, 0) // 2
1055. 	    SetVariable(ZoneOsPrograms, 0) // 3
1056. 	    
1057. 	    /* MFT */
1058. 	    SetVariable(ZoneMft, 0) // Volume dependent
1059. 	    SetVariable(ZoneMftDir, 0) // Volume dependent
1060. 	
1061. 		/* Volume Sys */
1062. 	    # Os 3
1063. 	    # Mft + 2
1064. 	    SetVariable(ZoneSysRegular, 0) // 5
1065. 	    SetVariable(ZoneDevSpaceHog, 0) // 6
1066. 	
1067. 		/* Volume Dev */
1068. 	    # Os 3
1069. 	    SetVariable(ZoneDevDevToDo, 0) // 4
1070. 	    SetVariable(ZoneDevIdeScripts, 0) // 5
1071. 	    SetVariable(ZoneDevLinksCorp, 0) // 6
1072. 	    SetVariable(ZoneDevPeople, 0) // 7
1073. 	    # Mft + 2
1074. 	    SetVariable(ZoneDevShares, 0) // 10
1075. 	    SetVariable(ZoneDevSystemOtherData, 0) // 11
1076. 	    SetVariable(ZoneDevReference, 0) // 12
1077. 	    SetVariable(ZoneDevSpaceHogsArchives, 0) // 13
1078. 	
1079. 		/* Volume Archive not used currently */
1080. 		/* Volume Data not used currently */
1081. 
1082. /* ---------------------------------------------------------- */
1083. # LOGGING:
1084. /* ---------------------------------------------------------- */
1085. 
1086. 	# Log File Name:
1087. 	SetVariable(LogFileName,"Defrag !MdmMyDefrag! 2021-11-13_20:31:18.log")
1088. 	/* SetVariable(LogFileName,"..\Logs\!MdmMyDefrag! 2021-11-13_20:31:18.log") */
1089. 	/* SetVariable(LogFileName,"!ScriptDir!Logs\!MdmMyDefrag! 2021-11-13_20:31:18.log") */
1090. 	/* SetVariable(LogFileName,"Defrag2021-11-13_20:31:18.txt") */
1091. 	/* SetVariable(LogFileName,"$ z Logs\Defrag2021-11-13_20:31:18.txt") */
1092. 	
1093. 	SetVariable(VolumeStatisticsSummary, "Not ready")
1094. 	SetVariable(VolumeStatisticsDetailed, "Not ready")
1095. 
1096. /* ---------------------------------------------------------- */
1097. # OVERRIDES
1098. /* ---------------------------------------------------------- */
1099. 
1100. 	# YOUR SETTINGS Volume overrides:
1101. 	/* empty */
1102. 
1103. 
1104. /* ---------------------------------------------------------- */
1105. # Create Run Log:
1106. 
1107. /* Write the header to the logfile. */
1108. 	# Script: BannerSet
1109. 
1110. # Script: DisplaySetDateTimeRun
1111. 
1112. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
1113. /* Xinclude "..\Display\BannerSet.MyDc"X */
1114. /* pause(1) */
1115. 
1116. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
1117. 
1118. Title('!Heading!')
1119. /* pause(1) */
1120. 
1121. /* NOTE: Can't round or truncate to integer precision. */
1122. 
1123. 
1124. 	WriteLogfile("!LogFileName!", "Started.")
1125. 	AppendLogfile("!LogFileName!", ".")
1126. 	# Script: BannerLog
1127. 
1128. AppendLogfile("!LogFileName!", "!Title!")
1129. 
1130. 
1131. 	AppendLogfile("!LogFileName!", ".")
1132. 
1133. /* ---------------------------------------------------------- */
1134. /* Script Information */
1135. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-11-13 20:31:18")
1136. 	AppendLogfile("!LogFileName!", ".")
1137. 	AppendLogfile("!LogFileName!", "Script:")
1138. 	AppendLogfile("!LogFileName!", "DefragDevDiskDaily")
1139. 	AppendLogfile("!LogFileName!", ".")
1140. 	AppendLogfile("!LogFileName!", "Script Directory:")
1141. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1142. 	AppendLogfile("!LogFileName!", ".")
1143. 	AppendLogfile("!LogFileName!", "Log File:")
1144. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1145. 	AppendLogfile("!LogFileName!", ".")
1146. 
1147. /* ---------------------------------------------------------- */
1148. # Run Preprocessing Do Before.
1149. /* empty */
1150. 
1151. 
1152. 
1153. /* SkipBlock Daily: */
1154. SetVariable(SkipBlockFiles,"!SkipBlockFilesDay!")
1155. SetVariable(SkipBlockBytes,"!SkipBlockBytesDay!")
1156. 
1157. # Defrag Development Volume
1158. 
1159. SetVariable(VolumeLabel,"!VolumeDev!")
1160. SetVariable(VolumeDescription,"Development")
1161. # Script: DisplaySetVolume
1162. 
1163. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1164. SetVariable(ZoneStepDescription,	"")
1165. SetVariable(FileStepDescription,	"")
1166. 
1167. SetVariable(ZoneListByLine, 		"Volume started 2021-11-13 20:31:18 0:00:01:
1168. ")
1169. SetVariable(ZoneStepByLine, 		"Pending.")
1170. 
1171. # Script: BannerDescriptionSet
1172. 
1173. # Script: BannerSet
1174. 
1175. # Script: DisplaySetDateTimeRun
1176. 
1177. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
1178. /* Xinclude "..\Display\BannerSet.MyDc"X */
1179. /* pause(1) */
1180. 
1181. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
1182. 
1183. Title('!Heading!')
1184. /* pause(1) */
1185. 
1186. /* NOTE: Can't round or truncate to integer precision. */
1187. 
1188. # Script: BannerLog
1189. 
1190. AppendLogfile("!LogFileName!", "!Title!")
1191. 
1192. 
1193. 
1194. pause(2)
1195. 
1196. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1197. 
1198. SetVariable(ZoneListByLine, "")
1199. SetVariable(ZoneFooter, "")
1200. 
1201. # This script is part of the standard disk configuration
1202. # Author: David G. Horsman (DBA MacroDM) (C) 2019
1203. # based on MyDefrag distribution.
1204. 
1205. /* Progress Display */
1206. SetVariable(ZoneListByLine, 	"Volume start.
1207. ")
1208. SetVariable(ZoneStepByLine, 	"
1209. ")
1210. 
1211. # VOLUME INFORMATION
1212. 
1213. SetVariable(VolumeNoCurrent, VolumeNoCurrent + 1)
1214. SetVariable(VolumeNoAdjCurrent, VolumeNoCurrent + VolumeCurrentAjust)
1215. 
1216. SetVariable(ZoneNoCurrent, 		0)
1217. SetVariable(ZoneNoAdjCurrent, 	0) 
1218. SetVariable(ZoneCurrentAjust,	0)
1219. 
1220. SetVariable(ZoneListByLine, 		"Volume started.
1221. ")
1222. SetVariable(ZoneStepByLine, 		"Initialize.
1223. ")
1224. SetVariable(ZoneStatisticsDetail, 	"")
1225. 
1226. SetVariable(ZoneStepNoCurrent, 0)
1227. 
1228. 
1229. # Script: ZoneDoCurrentClear
1230. 
1231. SetVariable(ZoneTypeSelectCurrent, 		"")
1232. 
1233. SetVariable(ZoneBeginCurrent, 			0)
1234. SetVariable(ZoneBeginPerCurrent, 		0)
1235. SetVariable(ZoneEndCurrent, 			0)
1236. SetVariable(ZoneEndPerCurrent, 			0)
1237. 
1238. SetVariable(ZoneSizeCurrent,			0)
1239. SetVariable(ZoneSizePerCurrent,			0)
1240. 
1241. SetVariable(ZoneGapRequestedCurrent,	0)
1242. SetVariable(ZoneGapRoundedCurrent, 		0)
1243. SetVariable(ZoneGapAdjustedCurrent, 	0)
1244. SetVariable(ZoneGapAvailableCurrent, 	0)
1245. SetVariable(ZoneGapCurrent,				0)
1246. SetVariable(ZoneGapUsedCurrent, 		0)
1247. 
1248. SetVariable(ZoneGapActualCurrent, 		0)
1249. SetVariable(ZoneGapActualPerCurrent, 	0)
1250. 
1251. SetVariable(ZoneSizeActual, 			0)
1252. SetVariable(ZoneSizeActualCurrent,		0)
1253. 
1254. SetVariable(ZoneEndActual, 				0)
1255. SetVariable(ZoneEndActualCurrent,		0)			
1256. SetVariable(ZoneSizeActualPerCurrent, 	0)
1257.       
1258. SetVariable(ZoneFilesFolders,			0)
1259. SetVariable(ZoneFilesFoldersPer,		0) 
1260. 
1261. SetVariable(ZoneFragments,				0)
1262. SetVariable(ZoneFragmentsPer,			0) 
1263. 		
1264. SetVariable(ZoneEndActualCurrent, 		0)
1265. SetVariable(ZoneEndActualPerCurrent, 	0)
1266. 
1267. # Gap Calculation Methodology:
1268. 	# Requested
1269. 	SetVariable(GapRequested, 			0) 
1270. 	SetVariable(GapRequestedStd, 		0) 
1271. 	SetVariable(GapRequestedMft, 		0) 
1272. 	SetVariable(GapRequestedOs, 		0) 
1273. 	SetVariable(GapRequestedOriginal, 	0) 
1274. 	
1275. 	# Gap Adjustments
1276. 	SetVariable(GapRounded, 			0)
1277. 	# SetVariable(GapAdjusted, 			0)
1278. 	SetVariable(GapAvailable, 			0)
1279. 	SetVariable(GapCurrent, 			0)
1280. 	SetVariable(GapActual, 				0)
1281. 	SetVariable(GapUsed, 				0)
1282. 	
1283. 	# Gap Adjustments
1284. 	SetVariable(GapRoundedLoc, 			0)
1285. 	# SetVariable(GapAdjustedLoc, 		0)
1286. 	SetVariable(GapAvailableLoc, 		0)
1287. 	SetVariable(GapCurrentLoc, 			0)
1288. 	SetVariable(GapActualLoc,			0)
1289. 	SetVariable(GapUsedLoc,				0)
1290. 	
1291. 	# Space usage
1292. 	SetVariable(ZoneFreePerRequested, 	0)
1293. 	SetVariable(ZoneFreePerUsed, 		0)
1294. 
1295. # Gap Size & Rounding
1296. 	SetVariable(ZoneGapSizePer, 		0)
1297. 	SetVariable(ZoneVolRoundUpPer, 		0)
1298. 	
1299. 	# Free Space
1300. 	SetVariable(ZoneFreeUsedPer, 		0)
1301. 	SetVariable(ZoneFreeRequestedPer, 	0)
1302. 
1303. 
1304. # Script: BannerSet
1305. 
1306. # Script: DisplaySetDateTimeRun
1307. 
1308. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
1309. /* Xinclude "..\Display\BannerSet.MyDc"X */
1310. /* pause(1) */
1311. 
1312. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
1313. 
1314. Title('!Heading!')
1315. /* pause(1) */
1316. 
1317. /* NOTE: Can't round or truncate to integer precision. */
1318. 
1319. 
1320. # OVERRIDES
1321. # YOUR SETTINGS Volume overrides:
1322. 
1323. 
1324. # SET
1325. # SetVariable(VolumeSys,"C:")
1326. 
1327. 
1328. # Script: DisplaySetVolume
1329. 
1330. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1331. SetVariable(ZoneStepDescription,	"")
1332. SetVariable(FileStepDescription,	"")
1333. 
1334. SetVariable(ZoneListByLine, 		"Volume started 2021-11-13 20:31:18 0:00:01:
1335. ")
1336. SetVariable(ZoneStepByLine, 		"Pending.")
1337. 
1338. # Script: BannerDescriptionSet
1339. 
1340. # Script: BannerSet
1341. 
1342. # Script: DisplaySetDateTimeRun
1343. 
1344. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
1345. /* Xinclude "..\Display\BannerSet.MyDc"X */
1346. /* pause(1) */
1347. 
1348. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
1349. 
1350. Title('!Heading!')
1351. /* pause(1) */
1352. 
1353. /* NOTE: Can't round or truncate to integer precision. */
1354. 
1355. # Script: BannerLog
1356. 
1357. AppendLogfile("!LogFileName!", "!Title!")
1358. 
1359. 
1360. 
1361. pause(2)
1362. 
1363. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1364. 
1365. # LOGGING:
1366. 	# Script: BannerDescriptionSet
1367. 
1368. # Script: BannerSet
1369. 
1370. # Script: DisplaySetDateTimeRun
1371. 
1372. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
1373. /* Xinclude "..\Display\BannerSet.MyDc"X */
1374. /* pause(1) */
1375. 
1376. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
1377. 
1378. Title('!Heading!')
1379. /* pause(1) */
1380. 
1381. /* NOTE: Can't round or truncate to integer precision. */
1382. 
1383. # Script: BannerLog
1384. 
1385. AppendLogfile("!LogFileName!", "!Title!")
1386. 
1387. 
1388. 
1389. 
1390. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-11-13 20:31:18")
1391. 	AppendLogfile("!LogFileName!", ".")
1392. 	AppendLogfile("!LogFileName!", "Script Directory:")
1393. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1394. 	AppendLogfile("!LogFileName!", ".")
1395. 	AppendLogfile("!LogFileName!", "Log File:")
1396. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1397. 	AppendLogfile("!LogFileName!", ".")
1398. 	/* AppendLogfile("!LogFileName!", "Log Header:") */
1399. 	/* AppendLogfile("!LogFileName!", "!LogHeader!") */
1400. 	/* AppendLogfile("!LogFileName!", "End of Log Header.") */
1401. 	AppendLogfile("!LogFileName!", ".")
1402. 
1403. 	AppendLogfile("!LogFileName!", "MFT Percentage: !MftPer!")
1404. 	AppendLogfile("!LogFileName!", "MFT Volume RoundUp: !MftRoundUp!")
1405. 	AppendLogfile("!LogFileName!", "MFT Gap %: !MftAdjRoundUp!")
1406. 	AppendLogfile("!LogFileName!", ".")
1407. 
1408. /* This file is where you override the above setting for */
1409. /* global settings. */
1410. /* There is a "SettingsYours\SettingsYours???.MyDc" for each volume type */
1411. /* so this is where you set the volume specific settings */
1412. /* or you can put them all in the file below. */
1413. 
1414. # Volume Preprocessing Do Before.
1415. /* empty */
1416. 
1417. 
1418. # BANNER:
1419. /* Xinclude "..\Display\VolumeSizeLog.MyDc"X */
1420. 
1421. /* Missed: ToDo: */
1422. /* Games Zone Type */
1423. 
1424. 
1425. 
1426. 
1427. SetVariable(MftZone, "Shares")
1428. 
1429. /* empty */
1430. 
1431. 
1432. # Script: DefragAnyComplexVolume
1433. /* Complex Volume */
1434. # MyDefrag v4.0 script: Defrag Complex (Mixed or Any) Volume.
1435. 
1436. # Script: VolumeStatisticsDetailGet
1437. 
1438. # Set Volume summary stats:
1439. 
1440. # Cluster, Sector, Block adjust for display.
1441. # Bytes per cluster is volume specific.
1442. 
1443. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1444. 
1445. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1446. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1447. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1448. 
1449. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1450. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1451. 
1452. # Set the display text:
1453. # Script: VolumeStatisticsSummaryDisplay
1454. 
1455. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1456. SUMMARY: !VolumeLabel! !VolumeDescription!
1457.   
1458.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1459.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1460.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1461.          
1462.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1463.       Volume Free Adj:       !VolumeFreeAdj!
1464.     Bytes per cluster:       !BytesPerCluster! bytes
1465. 
1466.    Unfragmented Items:       !FILES200N!
1467.      Fragmented Items:       !FILES210N!
1468. 
1469.     Unfragmented Data:       !FILES202N! bytes
1470.       Fragmented Data:       !FILES212N! bytes
1471. 
1472.              All Gaps:       !GAP00N!
1473.              All gaps:       !GAP10N! bytes
1474.           Average gap:       !GAP13N! bytes
1475.            Median gap:       !GAP14N! bytes
1476.           Biggest gap:       !GAP15N! bytes
1477. ----------------------------------------------------------
1478. ") 
1479. 
1480. 
1481. 
1482. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1483. VOLUME: !VolumeLabel! !VolumeDescription!
1484. ----------------------------------------------------------
1485. !VolumeStatisticsSummary!
1486. ----------------------------------------------------------
1487. DETAILS: !VolumeLabel! !VolumeDescription!
1488. ----------------------------------------------------------
1489. 
1490. SUMMARY:
1491. 
1492. Volume label/name:          !VolumeLabel!
1493. Volume mountpoint:          !MountPoint!
1494. Volume name:                !VolumeName!
1495. Volume type:                !VolumeType!
1496. 
1497. Total disk space:           !VolumeSize! bytes
1498.                             !VolumeSizeG! gigabytes
1499. 
1500. Bytes per cluster:          !BytesPerCluster! bytes
1501. Average end-begin distance: !AverageBeginEndDistance! clusters
1502.                             !AverageBeginEndDistanceP!% of volume size
1503. 
1504. ----------------------------------------------------------
1505. FRAGMENTS:
1506. 
1507. Unfragmented Items: !FILES200N!
1508.   Fragmented Items: !FILES210N!
1509.  Unfragmented Data: !FILES202N! bytes
1510.    Fragmented Data: !FILES212N! bytes
1511. Gaps:
1512.           All Gaps: !GAP00N!
1513.           All gaps: !GAP10N! bytes
1514.        Average gap: !GAP13N! bytes
1515.         Median gap: !GAP14N! bytes
1516.        Biggest gap: !GAP15N! bytes
1517. 
1518. ----------------------------------------------------------
1519. GAPS:
1520. 
1521.    ----------------------------------------------------------
1522.    Counts:
1523.                        Count      Percentage of all
1524.                 ----------------- -----------------
1525.    Small gaps   !GAP01N! !GAP01P!%
1526.    Big gaps     !GAP02N! !GAP02P!%
1527.                 ----------------- -----------------
1528.    All gaps     !GAP00N! !GAP00P!
1529. 
1530.    ----------------------------------------------------------
1531.    By size:
1532.                       Bytes          Gigabytes      Percentage of all
1533.                 ----------------- ----------------- -----------------
1534.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1535.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1536.                 ----------------- ----------------- -----------------
1537.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1538. 
1539.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1540.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1541.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1542.    ----------------------------------------------------------
1543. 
1544. ----------------------------------------------------------
1545. FILE STATISTICS:
1546. ----------------------------------------------------------
1547. 
1548. ----------------------------------------------------------
1549. ITEM COUNT:
1550. ----------------------------------------------------------
1551. Number of files and folders:
1552. 
1553.               Unfragmented       Fragmented            All
1554.    ------- ----------------- ----------------- -----------------
1555.    Files   !FILES000N! !FILES010N! !FILES020N!
1556.    Folders !FILES100N! !FILES110N! !FILES120N!
1557.    ------- ----------------- ----------------- -----------------
1558.    All     !FILES200N! !FILES210N! !FILES220N!
1559. 
1560. ----------------------------------------------------------
1561. Percentage of total:
1562. 
1563.               Unfragmented       Fragmented            All
1564.    ------- ----------------- ----------------- -----------------
1565.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1566.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1567.    ------- ----------------- ----------------- -----------------
1568.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1569. 
1570. ----------------------------------------------------------
1571. OCCUPIED SIZE on disk:
1572. ----------------------------------------------------------
1573. Bytes:
1574.               Unfragmented       Fragmented            All
1575.    ------- ----------------- ----------------- -----------------
1576.    Files   !FILES002N! !FILES012N! !FILES022N!
1577.    Folders !FILES102N! !FILES112N! !FILES122N!
1578.    ------- ----------------- ----------------- -----------------
1579.    All     !FILES202N! !FILES212N! !FILES222N!
1580. 
1581. ----------------------------------------------------------
1582. Gigabytes:
1583.               Unfragmented       Fragmented            All
1584.    ------- ----------------- ----------------- -----------------
1585.    Files   !FILES002G! !FILES012G! !FILES022G!
1586.    Folders !FILES102G! !FILES112G! !FILES122G!
1587.    ------- ----------------- ----------------- -----------------
1588.    All     !FILES202G! !FILES212G! !FILES222G!
1589. 
1590. ----------------------------------------------------------
1591. Percentage:
1592.               Unfragmented       Fragmented            All
1593.    ------- ----------------- ----------------- -----------------
1594.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1595.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1596.    ------- ----------------- ----------------- -----------------
1597.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1598. 
1599. ----------------------------------------------------------
1600. USED SIZE:
1601. ----------------------------------------------------------
1602. Bytes:
1603.               Unfragmented       Fragmented            All
1604.    ------- ----------------- ----------------- -----------------
1605.    Files   !FILES001N! !FILES011N! !FILES021N!
1606.    Folders !FILES101N! !FILES111N! !FILES121N!
1607.    ------- ----------------- ----------------- -----------------
1608.    All     !FILES201N! !FILES211N! !FILES221N!
1609. 
1610. ----------------------------------------------------------
1611. Gigabytes:
1612.               Unfragmented       Fragmented            All
1613.    ------- ----------------- ----------------- -----------------
1614.    Files   !FILES001G! !FILES011G! !FILES021G!
1615.    Folders !FILES101G! !FILES111G! !FILES121G!
1616.    ------- ----------------- ----------------- -----------------
1617.    All     !FILES201G! !FILES211G! !FILES221G!
1618. 
1619. ----------------------------------------------------------
1620. Percentage:
1621.               Unfragmented       Fragmented            All
1622.    ------- ----------------- ----------------- -----------------
1623.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1624.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1625.    ------- ----------------- ----------------- -----------------
1626.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1627. 
1628. ----------------------------------------------------------
1629. Volume Detailed Statistics end.
1630. ----------------------------------------------------------
1631. ") 
1632. 
1633. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1634. 
1635. SetVariable(FileStepDescription,"!VolumeLabel! !VolumeDescription! started: 2021-11-13 20:31:18.")
1636. # Script: DisplaySetFileStep
1637. 
1638. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1639. 
1640. /* add message and move to a new line. */
1641. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1642. ")
1643. 
1644. /* display the line. (hopefully.) */
1645. # Zone Footer Set Statistics Window Text
1646. 
1647. SetStatisticsWindowText("!Heading!
1648. ----------------------------------------------------------
1649. Zones Processed: 
1650. ----------------------------------------------------------
1651. !ZoneListByLine!
1652. ----------------------------------------------------------
1653. Zone Processing Step:
1654. !ZoneStepByLine!    
1655. ----------------------------------------------------------
1656. Current Zone:
1657. !ZoneFooter!
1658. ----------------------------------------------------------
1659. Volume Statistics:
1660. !VolumeStatisticsDetail!
1661. ----------------------------------------------------------
1662. Zone Detailed Report:
1663. ----------------------------------------------------------
1664. !ZoneStatisticsDetail!
1665. ----------------------------------------------------------
1666. ")
1667. 
1668. 
1669. 
1670. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1671. 
1672. # Script: BannerSet
1673. 
1674. # Script: DisplaySetDateTimeRun
1675. 
1676. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
1677. /* Xinclude "..\Display\BannerSet.MyDc"X */
1678. /* pause(1) */
1679. 
1680. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
1681. 
1682. Title('!Heading!')
1683. /* pause(1) */
1684. 
1685. /* NOTE: Can't round or truncate to integer precision. */
1686. 
1687. pause(1)
1688. 
1689. SetVariable(FileStepDescription,"Analyzing Volume")
1690. # Script: DisplaySetFileStep
1691. 
1692. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1693. 
1694. /* add message and move to a new line. */
1695. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1696. ")
1697. 
1698. /* display the line. (hopefully.) */
1699. # Zone Footer Set Statistics Window Text
1700. 
1701. SetStatisticsWindowText("!Heading!
1702. ----------------------------------------------------------
1703. Zones Processed: 
1704. ----------------------------------------------------------
1705. !ZoneListByLine!
1706. ----------------------------------------------------------
1707. Zone Processing Step:
1708. !ZoneStepByLine!    
1709. ----------------------------------------------------------
1710. Current Zone:
1711. !ZoneFooter!
1712. ----------------------------------------------------------
1713. Volume Statistics:
1714. !VolumeStatisticsDetail!
1715. ----------------------------------------------------------
1716. Zone Detailed Report:
1717. ----------------------------------------------------------
1718. !ZoneStatisticsDetail!
1719. ----------------------------------------------------------
1720. ")
1721. 
1722. 
1723. 
1724. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1725. 
1726. # Script: BannerSet
1727. 
1728. # Script: DisplaySetDateTimeRun
1729. 
1730. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
1731. /* Xinclude "..\Display\BannerSet.MyDc"X */
1732. /* pause(1) */
1733. 
1734. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
1735. 
1736. Title('!Heading!')
1737. /* pause(1) */
1738. 
1739. /* NOTE: Can't round or truncate to integer precision. */
1740. 
1741. pause(1)
1742. 
1743. /* ---------------------------------------------------------- */
1744. VolumeSelect
1745. 
1746. 	Label("!VolumeLabel!") or Name("!VolumeLabel!")
1747. 
1748. /* ---------------------------------------------------------- */
1749. VolumeActions
1750. 
1751. /* ---------------------------------------------------------- */
1752. /* Volume Init */
1753. # Script: VolumeStatisticsDetailGet
1754. 
1755. # Set Volume summary stats:
1756. 
1757. # Cluster, Sector, Block adjust for display.
1758. # Bytes per cluster is volume specific.
1759. 
1760. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1761. 
1762. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1763. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1764. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1765. 
1766. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1767. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1768. 
1769. # Set the display text:
1770. # Script: VolumeStatisticsSummaryDisplay
1771. 
1772. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1773. SUMMARY: !VolumeLabel! !VolumeDescription!
1774.   
1775.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1776.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1777.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1778.          
1779.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1780.       Volume Free Adj:       !VolumeFreeAdj!
1781.     Bytes per cluster:       !BytesPerCluster! bytes
1782. 
1783.    Unfragmented Items:       !FILES200N!
1784.      Fragmented Items:       !FILES210N!
1785. 
1786.     Unfragmented Data:       !FILES202N! bytes
1787.       Fragmented Data:       !FILES212N! bytes
1788. 
1789.              All Gaps:       !GAP00N!
1790.              All gaps:       !GAP10N! bytes
1791.           Average gap:       !GAP13N! bytes
1792.            Median gap:       !GAP14N! bytes
1793.           Biggest gap:       !GAP15N! bytes
1794. ----------------------------------------------------------
1795. ") 
1796. 
1797. 
1798. 
1799. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1800. VOLUME: !VolumeLabel! !VolumeDescription!
1801. ----------------------------------------------------------
1802. !VolumeStatisticsSummary!
1803. ----------------------------------------------------------
1804. DETAILS: !VolumeLabel! !VolumeDescription!
1805. ----------------------------------------------------------
1806. 
1807. SUMMARY:
1808. 
1809. Volume label/name:          !VolumeLabel!
1810. Volume mountpoint:          !MountPoint!
1811. Volume name:                !VolumeName!
1812. Volume type:                !VolumeType!
1813. 
1814. Total disk space:           !VolumeSize! bytes
1815.                             !VolumeSizeG! gigabytes
1816. 
1817. Bytes per cluster:          !BytesPerCluster! bytes
1818. Average end-begin distance: !AverageBeginEndDistance! clusters
1819.                             !AverageBeginEndDistanceP!% of volume size
1820. 
1821. ----------------------------------------------------------
1822. FRAGMENTS:
1823. 
1824. Unfragmented Items: !FILES200N!
1825.   Fragmented Items: !FILES210N!
1826.  Unfragmented Data: !FILES202N! bytes
1827.    Fragmented Data: !FILES212N! bytes
1828. Gaps:
1829.           All Gaps: !GAP00N!
1830.           All gaps: !GAP10N! bytes
1831.        Average gap: !GAP13N! bytes
1832.         Median gap: !GAP14N! bytes
1833.        Biggest gap: !GAP15N! bytes
1834. 
1835. ----------------------------------------------------------
1836. GAPS:
1837. 
1838.    ----------------------------------------------------------
1839.    Counts:
1840.                        Count      Percentage of all
1841.                 ----------------- -----------------
1842.    Small gaps   !GAP01N! !GAP01P!%
1843.    Big gaps     !GAP02N! !GAP02P!%
1844.                 ----------------- -----------------
1845.    All gaps     !GAP00N! !GAP00P!
1846. 
1847.    ----------------------------------------------------------
1848.    By size:
1849.                       Bytes          Gigabytes      Percentage of all
1850.                 ----------------- ----------------- -----------------
1851.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1852.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1853.                 ----------------- ----------------- -----------------
1854.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1855. 
1856.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1857.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1858.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1859.    ----------------------------------------------------------
1860. 
1861. ----------------------------------------------------------
1862. FILE STATISTICS:
1863. ----------------------------------------------------------
1864. 
1865. ----------------------------------------------------------
1866. ITEM COUNT:
1867. ----------------------------------------------------------
1868. Number of files and folders:
1869. 
1870.               Unfragmented       Fragmented            All
1871.    ------- ----------------- ----------------- -----------------
1872.    Files   !FILES000N! !FILES010N! !FILES020N!
1873.    Folders !FILES100N! !FILES110N! !FILES120N!
1874.    ------- ----------------- ----------------- -----------------
1875.    All     !FILES200N! !FILES210N! !FILES220N!
1876. 
1877. ----------------------------------------------------------
1878. Percentage of total:
1879. 
1880.               Unfragmented       Fragmented            All
1881.    ------- ----------------- ----------------- -----------------
1882.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1883.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1884.    ------- ----------------- ----------------- -----------------
1885.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1886. 
1887. ----------------------------------------------------------
1888. OCCUPIED SIZE on disk:
1889. ----------------------------------------------------------
1890. Bytes:
1891.               Unfragmented       Fragmented            All
1892.    ------- ----------------- ----------------- -----------------
1893.    Files   !FILES002N! !FILES012N! !FILES022N!
1894.    Folders !FILES102N! !FILES112N! !FILES122N!
1895.    ------- ----------------- ----------------- -----------------
1896.    All     !FILES202N! !FILES212N! !FILES222N!
1897. 
1898. ----------------------------------------------------------
1899. Gigabytes:
1900.               Unfragmented       Fragmented            All
1901.    ------- ----------------- ----------------- -----------------
1902.    Files   !FILES002G! !FILES012G! !FILES022G!
1903.    Folders !FILES102G! !FILES112G! !FILES122G!
1904.    ------- ----------------- ----------------- -----------------
1905.    All     !FILES202G! !FILES212G! !FILES222G!
1906. 
1907. ----------------------------------------------------------
1908. Percentage:
1909.               Unfragmented       Fragmented            All
1910.    ------- ----------------- ----------------- -----------------
1911.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1912.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1913.    ------- ----------------- ----------------- -----------------
1914.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1915. 
1916. ----------------------------------------------------------
1917. USED SIZE:
1918. ----------------------------------------------------------
1919. Bytes:
1920.               Unfragmented       Fragmented            All
1921.    ------- ----------------- ----------------- -----------------
1922.    Files   !FILES001N! !FILES011N! !FILES021N!
1923.    Folders !FILES101N! !FILES111N! !FILES121N!
1924.    ------- ----------------- ----------------- -----------------
1925.    All     !FILES201N! !FILES211N! !FILES221N!
1926. 
1927. ----------------------------------------------------------
1928. Gigabytes:
1929.               Unfragmented       Fragmented            All
1930.    ------- ----------------- ----------------- -----------------
1931.    Files   !FILES001G! !FILES011G! !FILES021G!
1932.    Folders !FILES101G! !FILES111G! !FILES121G!
1933.    ------- ----------------- ----------------- -----------------
1934.    All     !FILES201G! !FILES211G! !FILES221G!
1935. 
1936. ----------------------------------------------------------
1937. Percentage:
1938.               Unfragmented       Fragmented            All
1939.    ------- ----------------- ----------------- -----------------
1940.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1941.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1942.    ------- ----------------- ----------------- -----------------
1943.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1944. 
1945. ----------------------------------------------------------
1946. Volume Detailed Statistics end.
1947. ----------------------------------------------------------
1948. ") 
1949. 
1950. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1951. 
1952. SetVariable(FileStepDescription,"Volume started.")
1953. # Script: DisplaySetFileStep
1954. 
1955. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1956. 
1957. /* add message and move to a new line. */
1958. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1959. ")
1960. 
1961. /* display the line. (hopefully.) */
1962. # Zone Footer Set Statistics Window Text
1963. 
1964. SetStatisticsWindowText("!Heading!
1965. ----------------------------------------------------------
1966. Zones Processed: 
1967. ----------------------------------------------------------
1968. !ZoneListByLine!
1969. ----------------------------------------------------------
1970. Zone Processing Step:
1971. !ZoneStepByLine!    
1972. ----------------------------------------------------------
1973. Current Zone:
1974. !ZoneFooter!
1975. ----------------------------------------------------------
1976. Volume Statistics:
1977. !VolumeStatisticsDetail!
1978. ----------------------------------------------------------
1979. Zone Detailed Report:
1980. ----------------------------------------------------------
1981. !ZoneStatisticsDetail!
1982. ----------------------------------------------------------
1983. ")
1984. 
1985. 
1986. 
1987. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1988. 
1989. # Script: BannerSet
1990. 
1991. # Script: DisplaySetDateTimeRun
1992. 
1993. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
1994. /* Xinclude "..\Display\BannerSet.MyDc"X */
1995. /* pause(1) */
1996. 
1997. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
1998. 
1999. Title('!Heading!')
2000. /* pause(1) */
2001. 
2002. /* NOTE: Can't round or truncate to integer precision. */
2003. 
2004. pause(1)
2005. 
2006. # Script: VolumeWhenStarted
2007. 
2008. SetVariable(VolumeFreeAdj, (VolumeFree * (VolumeUsed / VolumeSize)))
2009. 
2010. SetVariable(MftLocation, RoundUp(VolumeUsed * MftPerDev, VolumeSize * VolumeRoundUpLarge)) 
2011. 
2012. SetVariable(ZoneListByLine, 		"Volume started.
2013. ")
2014. SetVariable(ZoneStepByLine, 		"Initialize.
2015. ")
2016. SetVariable(ZoneStatisticsDetail, 	"")
2017. 
2018. SetVariable(ZoneNoCurrent, 		0)
2019. SetVariable(ZoneNoAdjCurrent, 	0) 
2020. SetVariable(ZoneCurrentAjust,	0)
2021. 
2022. # Script: BannerSet
2023. 
2024. # Script: DisplaySetDateTimeRun
2025. 
2026. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
2027. /* Xinclude "..\Display\BannerSet.MyDc"X */
2028. /* pause(1) */
2029. 
2030. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
2031. 
2032. Title('!Heading!')
2033. /* pause(1) */
2034. 
2035. /* NOTE: Can't round or truncate to integer precision. */
2036. 
2037. # Script: BannerLog
2038. 
2039. AppendLogfile("!LogFileName!", "!Title!")
2040. 
2041. 
2042. # Script: VolumeStatisticsDetailGet
2043. 
2044. # Set Volume summary stats:
2045. 
2046. # Cluster, Sector, Block adjust for display.
2047. # Bytes per cluster is volume specific.
2048. 
2049. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
2050. 
2051. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
2052. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
2053. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2054. 
2055. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
2056. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2057. 
2058. # Set the display text:
2059. # Script: VolumeStatisticsSummaryDisplay
2060. 
2061. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
2062. SUMMARY: !VolumeLabel! !VolumeDescription!
2063.   
2064.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
2065.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
2066.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
2067.          
2068.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
2069.       Volume Free Adj:       !VolumeFreeAdj!
2070.     Bytes per cluster:       !BytesPerCluster! bytes
2071. 
2072.    Unfragmented Items:       !FILES200N!
2073.      Fragmented Items:       !FILES210N!
2074. 
2075.     Unfragmented Data:       !FILES202N! bytes
2076.       Fragmented Data:       !FILES212N! bytes
2077. 
2078.              All Gaps:       !GAP00N!
2079.              All gaps:       !GAP10N! bytes
2080.           Average gap:       !GAP13N! bytes
2081.            Median gap:       !GAP14N! bytes
2082.           Biggest gap:       !GAP15N! bytes
2083. ----------------------------------------------------------
2084. ") 
2085. 
2086. 
2087. 
2088. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
2089. VOLUME: !VolumeLabel! !VolumeDescription!
2090. ----------------------------------------------------------
2091. !VolumeStatisticsSummary!
2092. ----------------------------------------------------------
2093. DETAILS: !VolumeLabel! !VolumeDescription!
2094. ----------------------------------------------------------
2095. 
2096. SUMMARY:
2097. 
2098. Volume label/name:          !VolumeLabel!
2099. Volume mountpoint:          !MountPoint!
2100. Volume name:                !VolumeName!
2101. Volume type:                !VolumeType!
2102. 
2103. Total disk space:           !VolumeSize! bytes
2104.                             !VolumeSizeG! gigabytes
2105. 
2106. Bytes per cluster:          !BytesPerCluster! bytes
2107. Average end-begin distance: !AverageBeginEndDistance! clusters
2108.                             !AverageBeginEndDistanceP!% of volume size
2109. 
2110. ----------------------------------------------------------
2111. FRAGMENTS:
2112. 
2113. Unfragmented Items: !FILES200N!
2114.   Fragmented Items: !FILES210N!
2115.  Unfragmented Data: !FILES202N! bytes
2116.    Fragmented Data: !FILES212N! bytes
2117. Gaps:
2118.           All Gaps: !GAP00N!
2119.           All gaps: !GAP10N! bytes
2120.        Average gap: !GAP13N! bytes
2121.         Median gap: !GAP14N! bytes
2122.        Biggest gap: !GAP15N! bytes
2123. 
2124. ----------------------------------------------------------
2125. GAPS:
2126. 
2127.    ----------------------------------------------------------
2128.    Counts:
2129.                        Count      Percentage of all
2130.                 ----------------- -----------------
2131.    Small gaps   !GAP01N! !GAP01P!%
2132.    Big gaps     !GAP02N! !GAP02P!%
2133.                 ----------------- -----------------
2134.    All gaps     !GAP00N! !GAP00P!
2135. 
2136.    ----------------------------------------------------------
2137.    By size:
2138.                       Bytes          Gigabytes      Percentage of all
2139.                 ----------------- ----------------- -----------------
2140.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
2141.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
2142.                 ----------------- ----------------- -----------------
2143.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
2144. 
2145.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
2146.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
2147.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
2148.    ----------------------------------------------------------
2149. 
2150. ----------------------------------------------------------
2151. FILE STATISTICS:
2152. ----------------------------------------------------------
2153. 
2154. ----------------------------------------------------------
2155. ITEM COUNT:
2156. ----------------------------------------------------------
2157. Number of files and folders:
2158. 
2159.               Unfragmented       Fragmented            All
2160.    ------- ----------------- ----------------- -----------------
2161.    Files   !FILES000N! !FILES010N! !FILES020N!
2162.    Folders !FILES100N! !FILES110N! !FILES120N!
2163.    ------- ----------------- ----------------- -----------------
2164.    All     !FILES200N! !FILES210N! !FILES220N!
2165. 
2166. ----------------------------------------------------------
2167. Percentage of total:
2168. 
2169.               Unfragmented       Fragmented            All
2170.    ------- ----------------- ----------------- -----------------
2171.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
2172.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
2173.    ------- ----------------- ----------------- -----------------
2174.    All     !FILES200P!%!FILES210P!%!FILES220P!%
2175. 
2176. ----------------------------------------------------------
2177. OCCUPIED SIZE on disk:
2178. ----------------------------------------------------------
2179. Bytes:
2180.               Unfragmented       Fragmented            All
2181.    ------- ----------------- ----------------- -----------------
2182.    Files   !FILES002N! !FILES012N! !FILES022N!
2183.    Folders !FILES102N! !FILES112N! !FILES122N!
2184.    ------- ----------------- ----------------- -----------------
2185.    All     !FILES202N! !FILES212N! !FILES222N!
2186. 
2187. ----------------------------------------------------------
2188. Gigabytes:
2189.               Unfragmented       Fragmented            All
2190.    ------- ----------------- ----------------- -----------------
2191.    Files   !FILES002G! !FILES012G! !FILES022G!
2192.    Folders !FILES102G! !FILES112G! !FILES122G!
2193.    ------- ----------------- ----------------- -----------------
2194.    All     !FILES202G! !FILES212G! !FILES222G!
2195. 
2196. ----------------------------------------------------------
2197. Percentage:
2198.               Unfragmented       Fragmented            All
2199.    ------- ----------------- ----------------- -----------------
2200.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
2201.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
2202.    ------- ----------------- ----------------- -----------------
2203.    All     !FILES202P!%!FILES212P!%!FILES222P!%
2204. 
2205. ----------------------------------------------------------
2206. USED SIZE:
2207. ----------------------------------------------------------
2208. Bytes:
2209.               Unfragmented       Fragmented            All
2210.    ------- ----------------- ----------------- -----------------
2211.    Files   !FILES001N! !FILES011N! !FILES021N!
2212.    Folders !FILES101N! !FILES111N! !FILES121N!
2213.    ------- ----------------- ----------------- -----------------
2214.    All     !FILES201N! !FILES211N! !FILES221N!
2215. 
2216. ----------------------------------------------------------
2217. Gigabytes:
2218.               Unfragmented       Fragmented            All
2219.    ------- ----------------- ----------------- -----------------
2220.    Files   !FILES001G! !FILES011G! !FILES021G!
2221.    Folders !FILES101G! !FILES111G! !FILES121G!
2222.    ------- ----------------- ----------------- -----------------
2223.    All     !FILES201G! !FILES211G! !FILES221G!
2224. 
2225. ----------------------------------------------------------
2226. Percentage:
2227.               Unfragmented       Fragmented            All
2228.    ------- ----------------- ----------------- -----------------
2229.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
2230.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
2231.    ------- ----------------- ----------------- -----------------
2232.    All     !FILES201P!%!FILES211P!%!FILES221P!%
2233. 
2234. ----------------------------------------------------------
2235. Volume Detailed Statistics end.
2236. ----------------------------------------------------------
2237. ") 
2238. 
2239. # Script: BannerLog
2240. 
2241. AppendLogfile("!LogFileName!", "!Title!")
2242. 
2243. 
2244. 
2245. /* Write/display stats: */
2246. # Log:
2247. AppendLogfile("!LogFileName!", "!Title! started.")
2248. AppendLogfile("!LogFileName!", "2021-11-13 20:31:18.")
2249. AppendLogfile("!LogFileName!",".")
2250. AppendLogfile("!LogFileName!", ".")
2251. AppendLogfile("!LogFileName!", "Volume: !VolumeLabel!")
2252. AppendLogfile("!LogFileName!",".")
2253. AppendLogfile("!LogFileName!","!VolumeStatisticsDetail!")
2254. AppendLogfile("!LogFileName!",".")
2255. AppendLogfile("!LogFileName!", "!Title! started.")
2256. AppendLogfile("!LogFileName!", "2021-11-13 20:31:18.")
2257. AppendLogfile("!LogFileName!",".")
2258. 
2259. # In program statistics window (view):
2260. SetStatisticsWindowText("!VolumeStatisticsDetail!")
2261. 
2262. 
2263. /* ---------------------------------------------------------- */
2264. /* System Zones 1 - 7 */
2265. /* ---------------------------------------------------------- */
2266. 
2267. 	# Script: DefragZoneGroupOs
2268. # Defrag Zones Os
2269. 	/* System Zones */
2270. 
2271. AppendLogfile("!LogFileName!", "!Description! Os Zones started: 2021-11-13 20:31:18")
2272. SetVariable(FileStepDescription,"System Zones.")
2273. # Script: BannerSet
2274. 
2275. # Script: DisplaySetDateTimeRun
2276. 
2277. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
2278. /* Xinclude "..\Display\BannerSet.MyDc"X */
2279. /* pause(1) */
2280. 
2281. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
2282. 
2283. Title('!Heading!')
2284. /* pause(1) */
2285. 
2286. /* NOTE: Can't round or truncate to integer precision. */
2287. 
2288. # Script: BannerLog
2289. 
2290. AppendLogfile("!LogFileName!", "!Title!")
2291. 
2292. 
2293. AppendLogfile("!LogFileName!",".")
2294. 
2295. AppendLogfile("!LogFileName!", "System Disk optimized layout for boot and executables. 2021-11-13 20:31:18")
2296. /* Dgh 20190618 */
2297. 
2298. /* ---------------------------------------------------------- */
2299. /* Defrag the Pagefile.sys on the next boot. */
2300. 
2301. # PagedFrg - Page Defrag.
2302. 
2303. /* Defrag the Pagefile.sys on the next boot. */
2304. # RunProgram("..\Pagedfrg.exe","-o")
2305. 
2306. 
2307. /* ---------------------------------------------------------- */
2308. AppendLogfile("!LogFileName!", "Place files at the beginning of the disk: 2021-11-13 20:31:18")
2309. 
2310. 	MakeGap(0)
2311. 
2312. /* ---------------------------------------------------------- */
2313. # Zone Boot Fixed and Data 
2314. # Os Group Zone 1 & 2
2315. # Script: DefragZoneTypeOsBoot
2316. /* ---------------------------------------------------------- */
2317. # Zone 1 Boot Fixed.
2318. 	# Script: DisplayColors - Zone Dark
2319. # Processed
2320. SetFileColor(All, Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
2321. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
2322. 
2323. # Light Green and Yellow
2324. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
2325. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
2326. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
2327. 
2328. 	SetVariable(ZoneLabel, 			"!ZoneLabelBoot!")
2329. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBoot!")
2330. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
2331. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
2332. 	SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectOsBoot
2333. # Boot start.
2334. ImportListFromBootOptimize()
2335. # Boot end.
2336. ')
2337. 
2338. 		# Script: ZoneDoHeader
2339. 
2340. # Script: ZoneWhenStarted
2341. 
2342. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
2343. # Script: DisplaySetZone
2344. 
2345. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
2346. SetVariable(FileStepDescription,	"")
2347. 
2348. SetVariable(ZoneStepByLine, 			"Zone started.
2349. ")
2350. 
2351. # Script: BannerDescriptionSet
2352. 
2353. # Script: BannerSet
2354. 
2355. # Script: DisplaySetDateTimeRun
2356. 
2357. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
2358. /* Xinclude "..\Display\BannerSet.MyDc"X */
2359. /* pause(1) */
2360. 
2361. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
2362. 
2363. Title('!Heading!')
2364. /* pause(1) */
2365. 
2366. /* NOTE: Can't round or truncate to integer precision. */
2367. 
2368. # Script: BannerLog
2369. 
2370. AppendLogfile("!LogFileName!", "!Title!")
2371. 
2372. 
2373. 
2374. pause(1)
2375. 
2376. 
2377. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
2378. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
2379. 
2380. SetVariable(ZoneStepNoCurrent, 0)
2381. 
2382. 
2383. # Script: ZoneDoCurrentClear
2384. 
2385. SetVariable(ZoneTypeSelectCurrent, 		"")
2386. 
2387. SetVariable(ZoneBeginCurrent, 			0)
2388. SetVariable(ZoneBeginPerCurrent, 		0)
2389. SetVariable(ZoneEndCurrent, 			0)
2390. SetVariable(ZoneEndPerCurrent, 			0)
2391. 
2392. SetVariable(ZoneSizeCurrent,			0)
2393. SetVariable(ZoneSizePerCurrent,			0)
2394. 
2395. SetVariable(ZoneGapRequestedCurrent,	0)
2396. SetVariable(ZoneGapRoundedCurrent, 		0)
2397. SetVariable(ZoneGapAdjustedCurrent, 	0)
2398. SetVariable(ZoneGapAvailableCurrent, 	0)
2399. SetVariable(ZoneGapCurrent,				0)
2400. SetVariable(ZoneGapUsedCurrent, 		0)
2401. 
2402. SetVariable(ZoneGapActualCurrent, 		0)
2403. SetVariable(ZoneGapActualPerCurrent, 	0)
2404. 
2405. SetVariable(ZoneSizeActual, 			0)
2406. SetVariable(ZoneSizeActualCurrent,		0)
2407. 
2408. SetVariable(ZoneEndActual, 				0)
2409. SetVariable(ZoneEndActualCurrent,		0)			
2410. SetVariable(ZoneSizeActualPerCurrent, 	0)
2411.       
2412. SetVariable(ZoneFilesFolders,			0)
2413. SetVariable(ZoneFilesFoldersPer,		0) 
2414. 
2415. SetVariable(ZoneFragments,				0)
2416. SetVariable(ZoneFragmentsPer,			0) 
2417. 		
2418. SetVariable(ZoneEndActualCurrent, 		0)
2419. SetVariable(ZoneEndActualPerCurrent, 	0)
2420. 
2421. # Gap Calculation Methodology:
2422. 	# Requested
2423. 	SetVariable(GapRequested, 			0) 
2424. 	SetVariable(GapRequestedStd, 		0) 
2425. 	SetVariable(GapRequestedMft, 		0) 
2426. 	SetVariable(GapRequestedOs, 		0) 
2427. 	SetVariable(GapRequestedOriginal, 	0) 
2428. 	
2429. 	# Gap Adjustments
2430. 	SetVariable(GapRounded, 			0)
2431. 	# SetVariable(GapAdjusted, 			0)
2432. 	SetVariable(GapAvailable, 			0)
2433. 	SetVariable(GapCurrent, 			0)
2434. 	SetVariable(GapActual, 				0)
2435. 	SetVariable(GapUsed, 				0)
2436. 	
2437. 	# Gap Adjustments
2438. 	SetVariable(GapRoundedLoc, 			0)
2439. 	# SetVariable(GapAdjustedLoc, 		0)
2440. 	SetVariable(GapAvailableLoc, 		0)
2441. 	SetVariable(GapCurrentLoc, 			0)
2442. 	SetVariable(GapActualLoc,			0)
2443. 	SetVariable(GapUsedLoc,				0)
2444. 	
2445. 	# Space usage
2446. 	SetVariable(ZoneFreePerRequested, 	0)
2447. 	SetVariable(ZoneFreePerUsed, 		0)
2448. 
2449. # Gap Size & Rounding
2450. 	SetVariable(ZoneGapSizePer, 		0)
2451. 	SetVariable(ZoneVolRoundUpPer, 		0)
2452. 	
2453. 	# Free Space
2454. 	SetVariable(ZoneFreeUsedPer, 		0)
2455. 	SetVariable(ZoneFreeRequestedPer, 	0)
2456. 
2457. 
2458. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
2459. 
2460. # Footer:
2461. SetVariable(ZoneFooter, "----------------------------------------------------------
2462. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:18
2463. 
2464. Statistics Report:
2465. ------------------
2466.    Size:  
2467.    ------------------------
2468.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2469.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2470.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2471. 
2472.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2473.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2474. 
2475.    Location:
2476.    ------------------------
2477.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2478.              Files End: !ZoneEndCurrent!
2479.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2480.       
2481.    Gap Settings:
2482.    ------------------------
2483.          Gap Requested: !ZoneGapSizePer!%
2484.       Volume Rounding: !ZoneVolRoundUpPer!%
2485.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2486.                  
2487.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
2488.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
2489.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
2490.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
2491.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
2492.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
2493.      
2494.    Free Space after Zone:
2495.    ------------------------
2496.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
2497.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
2498.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
2499. 
2500. Directory and Files Select:
2501. ---------------------------
2502. !ZoneTypeSelectCurrent!               
2503. ---------------------------
2504. ----------------------------------------------------------
2505. ")
2506. 
2507. # Script: BannerSet
2508. 
2509. # Script: DisplaySetDateTimeRun
2510. 
2511. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
2512. /* Xinclude "..\Display\BannerSet.MyDc"X */
2513. /* pause(1) */
2514. 
2515. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
2516. 
2517. Title('!Heading!')
2518. /* pause(1) */
2519. 
2520. /* NOTE: Can't round or truncate to integer precision. */
2521. 
2522. # Script: BannerLog
2523. 
2524. AppendLogfile("!LogFileName!", "!Title!")
2525. 
2526. 
2527. 
2528. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
2529. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
2530. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:18")
2531. 
2532. SetVariable(ZoneListByLine, "!ZoneListByLine!
2533. Zone: !ZoneNoCurrent! 2021-11-13 20:31:18 0:00:01 !ZoneLabel! !ZoneDescription!")
2534. 
2535. 
2536. /* Fixed Zone Position Handling */
2537. /* Literal number: */
2538. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
2539. /* Percentage of disk: */
2540. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
2541. /* Gap */
2542. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
2543. 
2544. /* ---------------------------------------------------------- */
2545. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
2546. # Script: DisplaySetFileStep
2547. 
2548. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2549. 
2550. /* add message and move to a new line. */
2551. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2552. ")
2553. 
2554. /* display the line. (hopefully.) */
2555. # Zone Footer Set Statistics Window Text
2556. 
2557. SetStatisticsWindowText("!Heading!
2558. ----------------------------------------------------------
2559. Zones Processed: 
2560. ----------------------------------------------------------
2561. !ZoneListByLine!
2562. ----------------------------------------------------------
2563. Zone Processing Step:
2564. !ZoneStepByLine!    
2565. ----------------------------------------------------------
2566. Current Zone:
2567. !ZoneFooter!
2568. ----------------------------------------------------------
2569. Volume Statistics:
2570. !VolumeStatisticsDetail!
2571. ----------------------------------------------------------
2572. Zone Detailed Report:
2573. ----------------------------------------------------------
2574. !ZoneStatisticsDetail!
2575. ----------------------------------------------------------
2576. ")
2577. 
2578. 
2579. 
2580. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2581. 
2582. # Script: BannerSet
2583. 
2584. # Script: DisplaySetDateTimeRun
2585. 
2586. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
2587. /* Xinclude "..\Display\BannerSet.MyDc"X */
2588. /* pause(1) */
2589. 
2590. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
2591. 
2592. Title('!Heading!')
2593. /* pause(1) */
2594. 
2595. /* NOTE: Can't round or truncate to integer precision. */
2596. 
2597. pause(1)
2598. 
2599. # your stuff HERE (X)... pre file select code.
2600. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
2601. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
2602. 	# (X)
2603. 
2604. FileSelect
2605. 
2606. 	# your stuff can't really go here (errors.)
2607. 	# maybe for some reason I don't know of...
2608. 	
2609. 	# Actions next...
2610. 		# Script: ZoneDo ZoneTypeSelectOsBoot
2611. # Boot start.
2612. ImportListFromBootOptimize()
2613. # Boot end.
2614. 
2615. 		and not(
2616. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
2617. # Os Data Dynamic start.
2618. (
2619. # Os Data Dynamic start.
2620. (
2621.   FileName("*.dat*")
2622.   or FileName("*.db*")
2623.   or FileName("*.edb*")
2624.   or FileName("*.log*")
2625.   or FileName("DataStore.edb")
2626. )
2627. # Os Data Dynamic end.
2628. 
2629.   or 
2630. # Os PageHiberDump start.
2631. (
2632.   FileName("DataStore.edb")
2633.   or FileName("DUMP*.*")
2634.   or FileName("Hiberfil.sys")
2635.   or FileName("MEMORY.DMP")
2636.   or FileName("Pagefile.sys")
2637. )
2638. # Os PageHiberDump end.
2639. 
2640. # Os Data Dynamic
2641. )
2642. # Os Data Dynamic end.
2643. 
2644. 		)
2645. 
2646. 		FileActions
2647. 		  		/* ---------------------------------------------------------- */
2648. 	# Gap
2649. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
2650. 		# Script: DisplaySetFileStep
2651. 
2652. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2653. 
2654. /* add message and move to a new line. */
2655. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2656. ")
2657. 
2658. /* display the line. (hopefully.) */
2659. # Zone Footer Set Statistics Window Text
2660. 
2661. SetStatisticsWindowText("!Heading!
2662. ----------------------------------------------------------
2663. Zones Processed: 
2664. ----------------------------------------------------------
2665. !ZoneListByLine!
2666. ----------------------------------------------------------
2667. Zone Processing Step:
2668. !ZoneStepByLine!    
2669. ----------------------------------------------------------
2670. Current Zone:
2671. !ZoneFooter!
2672. ----------------------------------------------------------
2673. Volume Statistics:
2674. !VolumeStatisticsDetail!
2675. ----------------------------------------------------------
2676. Zone Detailed Report:
2677. ----------------------------------------------------------
2678. !ZoneStatisticsDetail!
2679. ----------------------------------------------------------
2680. ")
2681. 
2682. 
2683. 
2684. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2685. 
2686. # Script: BannerSet
2687. 
2688. # Script: DisplaySetDateTimeRun
2689. 
2690. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
2691. /* Xinclude "..\Display\BannerSet.MyDc"X */
2692. /* pause(1) */
2693. 
2694. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
2695. 
2696. Title('!Heading!')
2697. /* pause(1) */
2698. 
2699. /* NOTE: Can't round or truncate to integer precision. */
2700. 
2701. pause(1)
2702. 	
2703. 	# ACTUAL GAP
2704. 		/* AddGap Variant. */
2705. 	  	# Zone Do Gap
2706. # Gap Calculation Methods:
2707. 
2708. /* 1) Anything you need to add first. */
2709. /* empty */
2710. 
2711. /* ---------------------------------------------------------- */
2712. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
2713. 	# GapRequestedStd.
2714. 
2715. 		/* ---------------------------------------------------------- */
2716. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
2717. 
2718. 		# Gap Calculation Methods:
2719. 
2720. /* AddGap Variants */
2721. 
2722. 	/* Standard */
2723. 		# Gap Calculation Methods:
2724. 	/* AddGap Variants */
2725. 	/* Standard */
2726. 
2727. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
2728. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
2729. 
2730. 	SetVariable(GapRequested, GapRequestedStd)
2731. 	
2732. 
2733. 	/* MFT Low High Method */
2734. 		# Gap Calculation Methods:
2735. 	/* AddGap Variants */
2736. 	/* MFT Low High Method */
2737. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
2738. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
2739. 	SetVariable(GapRequested, GapRequestedMft)
2740. 	
2741. 
2742. 	/* OS Volume Type Method */
2743. 		# Gap Calculation Methods:
2744. 	/* AddGap Variants */
2745. 	/* OS Volume Type Method */
2746. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
2747. 	SetVariable(GapRequested, GapRequestedOs)
2748. 
2749. 
2750. 
2751. /* MakeGap Variants */
2752. 
2753. 	/* Original Os 1-3 + MFT 2 */
2754. 		# Gap Calculation Methods:
2755. 	/* MakeGap Variants */
2756. 	/* Original Os 1-3 + MFT 2 */
2757. 	/* plus MFT gap placed inline at the dividing zone. */
2758. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
2759. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
2760. 	SetVariable(GapRequested, GapRequestedOrig)
2761. 	
2762. 	
2763. /* Note: You could comment out the ones not in use */
2764. /* However having the data in the log is useful. */
2765. /* Therefore the following line is otherwise needed. */
2766. 
2767. /* Standard used */
2768. 
2769. SetVariable(GapRequested, GapRequestedStd)
2770. 
2771. # Gap Calculation Methods:
2772. 
2773. /* AddGap Variants */
2774. 	/* Standard */
2775. 	/* MFT Low High Method */
2776. 	/* OS Volume Type Method */
2777. 
2778. /* MakeGap Variants */
2779. 	/* Original Os 1-3 + MFT 2 */
2780. 
2781. /* Note: You could comment out the ones not in use */
2782. /* However having the data in the log is useful. */
2783. /* Therefore the following line is otherwise needed. */
2784. 
2785. /* Standard is used currently */
2786. 
2787. 
2788. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
2789. 
2790. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
2791. 
2792. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
2793. 
2794. /* ---------------------------------------------------------- */
2795. /* 3) SMALL ZONE ADJUSTMENT. */
2796. /* Gab cant be larger than half the Zone Size. */
2797. 
2798. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
2799. 	
2800. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
2801. 
2802. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
2803. 
2804. /* ---------------------------------------------------------- */
2805. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
2806. # Gap Adjustments.
2807. 
2808. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
2809. 	
2810. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
2811. 
2812. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
2813. 
2814. /* ---------------------------------------------------------- */
2815. # BYPASS THIS.
2816. 	/* This is definitely wrong. */
2817. 	/* The question is can we steal gap from the next zone */
2818. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
2819. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
2820. 		# Zone Overflow.
2821. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
2822. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
2823. 
2824. /* ---------------------------------------------------------- */
2825. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
2826. # Remaining free space available.
2827. 
2828. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
2829. 	
2830. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
2831. 
2832. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
2833. 
2834. /* ---------------------------------------------------------- */
2835. # CURRENT gap to use.
2836. 
2837. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
2838. 
2839. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
2840. 
2841. /* ---------------------------------------------------------- */
2842. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
2843. # Debugging.
2844. 
2845. 	SetVariable(GapUsed, GapCurrent) // for debugging
2846. 
2847. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
2848. 
2849. 		# Your code HERE
2850. 
2851. /* ---------------------------------------------------------- */
2852. /* 7) YOUR CODE. */
2853. # YOUR CODE HERE:
2854. 	# INPUT: GapCurrent or GapCurrentLoc
2855. 	# OUTPUT: GapUsed...
2856. 
2857. /* ---------------------------------------------------------- */
2858. # Gap Size.
2859. # Actual Size of Gap.
2860. 
2861. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
2862. 
2863. /* ---------------------------------------------------------- */
2864. /* xxxxxxxxxxxxxxxxxxxxxx */
2865. # ADD THE GAP
2866. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
2867. /* xxxxxxxxxxxxxxxxxxxxxx */
2868. 
2869. 	
2870. 	# Zone Statistics	
2871. 	# Script: ZoneDoStatistics
2872. # Zone / Volume Statistics and Display
2873. 		
2874. 	# Accumulate Totals
2875.   	# Script: ZoneDoVolumeTotals
2876. 
2877. /* Current total space used (by Zones and Gaps) */
2878. 
2879. SetVariable(VolumeZoneUsed, GapUsed)
2880. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
2881. /* Percentage */
2882. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
2883. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
2884. 
2885. /* Current total of free space requested */
2886. 
2887. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
2888. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2889. /* Percent. */
2890. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
2891. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2892. 
2893. /* Current total of free space used */
2894. 
2895. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
2896. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
2897. /* Percent */
2898. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
2899. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
2900. 
2901. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
2902. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
2903. /* Xinclude "..\DebugDisplayPause.MyDc"X */
2904. 
2905. 
2906. 	# Current Values
2907. 	# Script: ZoneDoCurrentSet
2908. 
2909. # Cluster, Sector, Block adjust for display.
2910. 	# Bytes per cluster is volume specific.
2911. 
2912. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
2913. 
2914. # Current Zone values.
2915. 	# Begin, end and size.
2916. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
2917. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
2918. 
2919. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
2920. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
2921. 
2922. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
2923. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
2924. 
2925. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
2926. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
2927. 
2928. 	SetVariable(ZoneFragments,				"!ZONE210N!")
2929. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
2930. 		
2931. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
2932. /* identical code to here: (separation not needed. TEST.) */	
2933. 
2934. # Current Gap, Actual and Free Values
2935. 	# Gap
2936. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
2937. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
2938. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
2939. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
2940. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
2941. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
2942. 	
2943. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
2944. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
2945. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
2946. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
2947. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
2948. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
2949. 	
2950. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
2951. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
2952. 	
2953. 	# Actual Size and End
2954. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
2955. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
2956. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
2957. 	
2958. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
2959. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
2960. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
2961. 
2962. # Gap Size & Rounding
2963. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
2964. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
2965. 	
2966. 	# Free Space
2967. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
2968. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
2969. 
2970. 	# Footer:
2971. SetVariable(ZoneFooter, "----------------------------------------------------------
2972. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:18
2973. 
2974. Statistics Report:
2975. ------------------
2976.    Size:  
2977.    ------------------------
2978.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2979.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2980.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2981. 
2982.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2983.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2984. 
2985.    Location:
2986.    ------------------------
2987.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2988.              Files End: !ZoneEndCurrent!
2989.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2990.       
2991.    Gap Settings:
2992.    ------------------------
2993.          Gap Requested: !ZoneGapSizePer!%
2994.       Volume Rounding: !ZoneVolRoundUpPer!%
2995.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2996.                  
2997.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
2998.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
2999.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
3000.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
3001.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
3002.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
3003.      
3004.    Free Space after Zone:
3005.    ------------------------
3006.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3007.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3008.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3009. 
3010. Directory and Files Select:
3011. ---------------------------
3012. !ZoneTypeSelectCurrent!               
3013. ---------------------------
3014. ----------------------------------------------------------
3015. ")
3016. 	# Zone Footer Set Statistics Window Text
3017. 
3018. SetStatisticsWindowText("!Heading!
3019. ----------------------------------------------------------
3020. Zones Processed: 
3021. ----------------------------------------------------------
3022. !ZoneListByLine!
3023. ----------------------------------------------------------
3024. Zone Processing Step:
3025. !ZoneStepByLine!    
3026. ----------------------------------------------------------
3027. Current Zone:
3028. !ZoneFooter!
3029. ----------------------------------------------------------
3030. Volume Statistics:
3031. !VolumeStatisticsDetail!
3032. ----------------------------------------------------------
3033. Zone Detailed Report:
3034. ----------------------------------------------------------
3035. !ZoneStatisticsDetail!
3036. ----------------------------------------------------------
3037. ")
3038. 
3039. 
3040. 	
3041.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
3042. 
3043. 	# Add Zone to list of zones for display.
3044. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
3045. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
3046. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
3047. 	# ??? Free Stats?
3048. 	# Footer:
3049. SetVariable(ZoneFooter, "----------------------------------------------------------
3050. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:18
3051. 
3052. Statistics Report:
3053. ------------------
3054.    Size:  
3055.    ------------------------
3056.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3057.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3058.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3059. 
3060.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3061.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3062. 
3063.    Location:
3064.    ------------------------
3065.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3066.              Files End: !ZoneEndCurrent!
3067.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3068.       
3069.    Gap Settings:
3070.    ------------------------
3071.          Gap Requested: !ZoneGapSizePer!%
3072.       Volume Rounding: !ZoneVolRoundUpPer!%
3073.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3074.                  
3075.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
3076.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
3077.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
3078.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
3079.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
3080.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
3081.      
3082.    Free Space after Zone:
3083.    ------------------------
3084.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3085.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3086.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3087. 
3088. Directory and Files Select:
3089. ---------------------------
3090. !ZoneTypeSelectCurrent!               
3091. ---------------------------
3092. ----------------------------------------------------------
3093. ")
3094. 
3095. 	# Add Zone Details to Report.	
3096. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
3097. !ZoneFooter!")
3098. 
3099. 
3100. 	
3101. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionStart!")
3102. 			# Script: DisplaySetFileStep
3103. 
3104. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3105. 
3106. /* add message and move to a new line. */
3107. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3108. ")
3109. 
3110. /* display the line. (hopefully.) */
3111. # Zone Footer Set Statistics Window Text
3112. 
3113. SetStatisticsWindowText("!Heading!
3114. ----------------------------------------------------------
3115. Zones Processed: 
3116. ----------------------------------------------------------
3117. !ZoneListByLine!
3118. ----------------------------------------------------------
3119. Zone Processing Step:
3120. !ZoneStepByLine!    
3121. ----------------------------------------------------------
3122. Current Zone:
3123. !ZoneFooter!
3124. ----------------------------------------------------------
3125. Volume Statistics:
3126. !VolumeStatisticsDetail!
3127. ----------------------------------------------------------
3128. Zone Detailed Report:
3129. ----------------------------------------------------------
3130. !ZoneStatisticsDetail!
3131. ----------------------------------------------------------
3132. ")
3133. 
3134. 
3135. 
3136. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3137. 
3138. # Script: BannerSet
3139. 
3140. # Script: DisplaySetDateTimeRun
3141. 
3142. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
3143. /* Xinclude "..\Display\BannerSet.MyDc"X */
3144. /* pause(1) */
3145. 
3146. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
3147. 
3148. Title('!Heading!')
3149. /* pause(1) */
3150. 
3151. /* NOTE: Can't round or truncate to integer precision. */
3152. 
3153. pause(1)
3154. 	
3155. 			# File Action - Os Boot - Fast - MoveUpToZone.
3156. 	MoveUpToZone()
3157. 	
3158. 
3159. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionEnd!")
3160. 			# Script: DisplaySetFileStep
3161. 
3162. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3163. 
3164. /* add message and move to a new line. */
3165. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3166. ")
3167. 
3168. /* display the line. (hopefully.) */
3169. # Zone Footer Set Statistics Window Text
3170. 
3171. SetStatisticsWindowText("!Heading!
3172. ----------------------------------------------------------
3173. Zones Processed: 
3174. ----------------------------------------------------------
3175. !ZoneListByLine!
3176. ----------------------------------------------------------
3177. Zone Processing Step:
3178. !ZoneStepByLine!    
3179. ----------------------------------------------------------
3180. Current Zone:
3181. !ZoneFooter!
3182. ----------------------------------------------------------
3183. Volume Statistics:
3184. !VolumeStatisticsDetail!
3185. ----------------------------------------------------------
3186. Zone Detailed Report:
3187. ----------------------------------------------------------
3188. !ZoneStatisticsDetail!
3189. ----------------------------------------------------------
3190. ")
3191. 
3192. 
3193. 
3194. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3195. 
3196. # Script: BannerSet
3197. 
3198. # Script: DisplaySetDateTimeRun
3199. 
3200. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
3201. /* Xinclude "..\Display\BannerSet.MyDc"X */
3202. /* pause(1) */
3203. 
3204. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
3205. 
3206. Title('!Heading!')
3207. /* pause(1) */
3208. 
3209. /* NOTE: Can't round or truncate to integer precision. */
3210. 
3211. pause(1)
3212. 
3213. 		# Script: ZoneDoFooter
3214. 
3215. /* ---------------------------------------------------------- */
3216. # File Select
3217. 	# Select Statments
3218. # File Actions 
3219. 	# Standard or OS File Actions.
3220. 	# Resume...
3221. 	
3222. 	# your stuff HERE (X)... post zone (file) file actions code.
3223. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
3224. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3225. 		# (X)
3226. 		
3227. 		/* ??? Set window? */
3228. 	
3229. 	# ADD THE GAP
3230. # Vacate (good for diagnostics)
3231. # DoNotVacate - DO NOT Vacate (recommended)
3232. # DoNotVacate - DO NOT Vacate (recommended)
3233. 
3234. # Vacate
3235. /* AddGap(GapUsedLoc) */
3236. 
3237. # DO Not Vacate
3238. AddGap(GapUsedLoc, DoNotVacate) 
3239. 	
3240. 	
3241. # Script: GapZoneCommand
3242. # *** Moved to setting yours ***
3243. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
3244. # Controlled via settings commands
3245. # DoNotVacate - DO NOT Vacate (recommended)
3246. 
3247. # Vacate
3248. /* AddGap(GapUsedLoc) */
3249. 
3250. # DO Not Vacate
3251. AddGap(GapUsedLoc, DoNotVacate) 
3252. 	
3253. 	
3254. # Vacate /* AddGap(GapUsed) */
3255. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
3256. 	
3257. 
3258. 		
3259. # 
3260. FileEnd
3261. /* ---------------------------------------------------------- */
3262. 
3263. # your stuff HERE (X)... post zone (file) code.
3264. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
3265. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3266. 	# (X)
3267. 
3268. SetVariable(FileStepDescription,"Zone finished, reporting.")
3269. # Script: DisplaySetFileStep
3270. 
3271. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3272. 
3273. /* add message and move to a new line. */
3274. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3275. ")
3276. 
3277. /* display the line. (hopefully.) */
3278. # Zone Footer Set Statistics Window Text
3279. 
3280. SetStatisticsWindowText("!Heading!
3281. ----------------------------------------------------------
3282. Zones Processed: 
3283. ----------------------------------------------------------
3284. !ZoneListByLine!
3285. ----------------------------------------------------------
3286. Zone Processing Step:
3287. !ZoneStepByLine!    
3288. ----------------------------------------------------------
3289. Current Zone:
3290. !ZoneFooter!
3291. ----------------------------------------------------------
3292. Volume Statistics:
3293. !VolumeStatisticsDetail!
3294. ----------------------------------------------------------
3295. Zone Detailed Report:
3296. ----------------------------------------------------------
3297. !ZoneStatisticsDetail!
3298. ----------------------------------------------------------
3299. ")
3300. 
3301. 
3302. 
3303. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3304. 
3305. # Script: BannerSet
3306. 
3307. # Script: DisplaySetDateTimeRun
3308. 
3309. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
3310. /* Xinclude "..\Display\BannerSet.MyDc"X */
3311. /* pause(1) */
3312. 
3313. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
3314. 
3315. Title('!Heading!')
3316. /* pause(1) */
3317. 
3318. /* NOTE: Can't round or truncate to integer precision. */
3319. 
3320. pause(1)
3321. 
3322. # Script: ZoneWhenFinished
3323. 
3324. # Script: BannerSet
3325. 
3326. # Script: DisplaySetDateTimeRun
3327. 
3328. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
3329. /* Xinclude "..\Display\BannerSet.MyDc"X */
3330. /* pause(1) */
3331. 
3332. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
3333. 
3334. Title('!Heading!')
3335. /* pause(1) */
3336. 
3337. /* NOTE: Can't round or truncate to integer precision. */
3338. 
3339. # Script: BannerLog
3340. 
3341. AppendLogfile("!LogFileName!", "!Title!")
3342. 
3343. 
3344. 
3345. # Zone Statistics	
3346. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
3347. 
3348. # Footer:
3349. SetVariable(ZoneFooter, "----------------------------------------------------------
3350. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:18
3351. 
3352. Statistics Report:
3353. ------------------
3354.    Size:  
3355.    ------------------------
3356.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3357.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3358.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3359. 
3360.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3361.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3362. 
3363.    Location:
3364.    ------------------------
3365.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3366.              Files End: !ZoneEndCurrent!
3367.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3368.       
3369.    Gap Settings:
3370.    ------------------------
3371.          Gap Requested: !ZoneGapSizePer!%
3372.       Volume Rounding: !ZoneVolRoundUpPer!%
3373.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3374.                  
3375.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
3376.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
3377.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
3378.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
3379.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
3380.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
3381.      
3382.    Free Space after Zone:
3383.    ------------------------
3384.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3385.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3386.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3387. 
3388. Directory and Files Select:
3389. ---------------------------
3390. !ZoneTypeSelectCurrent!               
3391. ---------------------------
3392. ----------------------------------------------------------
3393. ")
3394. 
3395. AppendLogfile("!LogFileName!", ".")
3396. AppendLogfile("!LogFileName!", "!ZoneFooter!")
3397. AppendLogfile("!LogFileName!", ".")
3398. 
3399. # Zone Footer Set Statistics Window Text
3400. 
3401. SetStatisticsWindowText("!Heading!
3402. ----------------------------------------------------------
3403. Zones Processed: 
3404. ----------------------------------------------------------
3405. !ZoneListByLine!
3406. ----------------------------------------------------------
3407. Zone Processing Step:
3408. !ZoneStepByLine!    
3409. ----------------------------------------------------------
3410. Current Zone:
3411. !ZoneFooter!
3412. ----------------------------------------------------------
3413. Volume Statistics:
3414. !VolumeStatisticsDetail!
3415. ----------------------------------------------------------
3416. Zone Detailed Report:
3417. ----------------------------------------------------------
3418. !ZoneStatisticsDetail!
3419. ----------------------------------------------------------
3420. ")
3421. 
3422. 
3423. 
3424. /* pause() */
3425. /* pause() */
3426. 
3427. 
3428. 
3429. 
3430. /* ---------------------------------------------------------- */
3431. # Zone 2 Boot Data (Variable and other).
3432. 	# Script: DisplayColors - Zone Dark
3433. # Processed
3434. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
3435. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
3436. 
3437. # Light Green and Yellow
3438. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
3439. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
3440. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
3441. 
3442. 	SetVariable(ZoneLabel, 			"!ZoneLabelBootData!")
3443. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBootData!")
3444. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
3445. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
3446. 	SetVariable(ZoneTypeSelect,'
3447.                 # Boot - Data files.
3448.                 not(
3449.                      # Os PageHiberDump start.
3450. (
3451.   FileName("DataStore.edb")
3452.   or FileName("DUMP*.*")
3453.   or FileName("Hiberfil.sys")
3454.   or FileName("MEMORY.DMP")
3455.   or FileName("Pagefile.sys")
3456. )
3457. # Os PageHiberDump end.
3458. 
3459.                 )
3460. ')
3461. 
3462. 		# Script: ZoneDoHeader
3463. 
3464. # Script: ZoneWhenStarted
3465. 
3466. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
3467. # Script: DisplaySetZone
3468. 
3469. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
3470. SetVariable(FileStepDescription,	"")
3471. 
3472. SetVariable(ZoneStepByLine, 			"Zone started.
3473. ")
3474. 
3475. # Script: BannerDescriptionSet
3476. 
3477. # Script: BannerSet
3478. 
3479. # Script: DisplaySetDateTimeRun
3480. 
3481. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
3482. /* Xinclude "..\Display\BannerSet.MyDc"X */
3483. /* pause(1) */
3484. 
3485. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
3486. 
3487. Title('!Heading!')
3488. /* pause(1) */
3489. 
3490. /* NOTE: Can't round or truncate to integer precision. */
3491. 
3492. # Script: BannerLog
3493. 
3494. AppendLogfile("!LogFileName!", "!Title!")
3495. 
3496. 
3497. 
3498. pause(1)
3499. 
3500. 
3501. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
3502. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
3503. 
3504. SetVariable(ZoneStepNoCurrent, 0)
3505. 
3506. 
3507. # Script: ZoneDoCurrentClear
3508. 
3509. SetVariable(ZoneTypeSelectCurrent, 		"")
3510. 
3511. SetVariable(ZoneBeginCurrent, 			0)
3512. SetVariable(ZoneBeginPerCurrent, 		0)
3513. SetVariable(ZoneEndCurrent, 			0)
3514. SetVariable(ZoneEndPerCurrent, 			0)
3515. 
3516. SetVariable(ZoneSizeCurrent,			0)
3517. SetVariable(ZoneSizePerCurrent,			0)
3518. 
3519. SetVariable(ZoneGapRequestedCurrent,	0)
3520. SetVariable(ZoneGapRoundedCurrent, 		0)
3521. SetVariable(ZoneGapAdjustedCurrent, 	0)
3522. SetVariable(ZoneGapAvailableCurrent, 	0)
3523. SetVariable(ZoneGapCurrent,				0)
3524. SetVariable(ZoneGapUsedCurrent, 		0)
3525. 
3526. SetVariable(ZoneGapActualCurrent, 		0)
3527. SetVariable(ZoneGapActualPerCurrent, 	0)
3528. 
3529. SetVariable(ZoneSizeActual, 			0)
3530. SetVariable(ZoneSizeActualCurrent,		0)
3531. 
3532. SetVariable(ZoneEndActual, 				0)
3533. SetVariable(ZoneEndActualCurrent,		0)			
3534. SetVariable(ZoneSizeActualPerCurrent, 	0)
3535.       
3536. SetVariable(ZoneFilesFolders,			0)
3537. SetVariable(ZoneFilesFoldersPer,		0) 
3538. 
3539. SetVariable(ZoneFragments,				0)
3540. SetVariable(ZoneFragmentsPer,			0) 
3541. 		
3542. SetVariable(ZoneEndActualCurrent, 		0)
3543. SetVariable(ZoneEndActualPerCurrent, 	0)
3544. 
3545. # Gap Calculation Methodology:
3546. 	# Requested
3547. 	SetVariable(GapRequested, 			0) 
3548. 	SetVariable(GapRequestedStd, 		0) 
3549. 	SetVariable(GapRequestedMft, 		0) 
3550. 	SetVariable(GapRequestedOs, 		0) 
3551. 	SetVariable(GapRequestedOriginal, 	0) 
3552. 	
3553. 	# Gap Adjustments
3554. 	SetVariable(GapRounded, 			0)
3555. 	# SetVariable(GapAdjusted, 			0)
3556. 	SetVariable(GapAvailable, 			0)
3557. 	SetVariable(GapCurrent, 			0)
3558. 	SetVariable(GapActual, 				0)
3559. 	SetVariable(GapUsed, 				0)
3560. 	
3561. 	# Gap Adjustments
3562. 	SetVariable(GapRoundedLoc, 			0)
3563. 	# SetVariable(GapAdjustedLoc, 		0)
3564. 	SetVariable(GapAvailableLoc, 		0)
3565. 	SetVariable(GapCurrentLoc, 			0)
3566. 	SetVariable(GapActualLoc,			0)
3567. 	SetVariable(GapUsedLoc,				0)
3568. 	
3569. 	# Space usage
3570. 	SetVariable(ZoneFreePerRequested, 	0)
3571. 	SetVariable(ZoneFreePerUsed, 		0)
3572. 
3573. # Gap Size & Rounding
3574. 	SetVariable(ZoneGapSizePer, 		0)
3575. 	SetVariable(ZoneVolRoundUpPer, 		0)
3576. 	
3577. 	# Free Space
3578. 	SetVariable(ZoneFreeUsedPer, 		0)
3579. 	SetVariable(ZoneFreeRequestedPer, 	0)
3580. 
3581. 
3582. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
3583. 
3584. # Footer:
3585. SetVariable(ZoneFooter, "----------------------------------------------------------
3586. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:18
3587. 
3588. Statistics Report:
3589. ------------------
3590.    Size:  
3591.    ------------------------
3592.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3593.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3594.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3595. 
3596.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3597.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3598. 
3599.    Location:
3600.    ------------------------
3601.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3602.              Files End: !ZoneEndCurrent!
3603.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3604.       
3605.    Gap Settings:
3606.    ------------------------
3607.          Gap Requested: !ZoneGapSizePer!%
3608.       Volume Rounding: !ZoneVolRoundUpPer!%
3609.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3610.                  
3611.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
3612.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
3613.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
3614.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
3615.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
3616.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
3617.      
3618.    Free Space after Zone:
3619.    ------------------------
3620.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3621.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3622.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3623. 
3624. Directory and Files Select:
3625. ---------------------------
3626. !ZoneTypeSelectCurrent!               
3627. ---------------------------
3628. ----------------------------------------------------------
3629. ")
3630. 
3631. # Script: BannerSet
3632. 
3633. # Script: DisplaySetDateTimeRun
3634. 
3635. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
3636. /* Xinclude "..\Display\BannerSet.MyDc"X */
3637. /* pause(1) */
3638. 
3639. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
3640. 
3641. Title('!Heading!')
3642. /* pause(1) */
3643. 
3644. /* NOTE: Can't round or truncate to integer precision. */
3645. 
3646. # Script: BannerLog
3647. 
3648. AppendLogfile("!LogFileName!", "!Title!")
3649. 
3650. 
3651. 
3652. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
3653. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
3654. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:18")
3655. 
3656. SetVariable(ZoneListByLine, "!ZoneListByLine!
3657. Zone: !ZoneNoCurrent! 2021-11-13 20:31:18 0:00:01 !ZoneLabel! !ZoneDescription!")
3658. 
3659. 
3660. /* Fixed Zone Position Handling */
3661. /* Literal number: */
3662. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
3663. /* Percentage of disk: */
3664. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
3665. /* Gap */
3666. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
3667. 
3668. /* ---------------------------------------------------------- */
3669. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
3670. # Script: DisplaySetFileStep
3671. 
3672. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3673. 
3674. /* add message and move to a new line. */
3675. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3676. ")
3677. 
3678. /* display the line. (hopefully.) */
3679. # Zone Footer Set Statistics Window Text
3680. 
3681. SetStatisticsWindowText("!Heading!
3682. ----------------------------------------------------------
3683. Zones Processed: 
3684. ----------------------------------------------------------
3685. !ZoneListByLine!
3686. ----------------------------------------------------------
3687. Zone Processing Step:
3688. !ZoneStepByLine!    
3689. ----------------------------------------------------------
3690. Current Zone:
3691. !ZoneFooter!
3692. ----------------------------------------------------------
3693. Volume Statistics:
3694. !VolumeStatisticsDetail!
3695. ----------------------------------------------------------
3696. Zone Detailed Report:
3697. ----------------------------------------------------------
3698. !ZoneStatisticsDetail!
3699. ----------------------------------------------------------
3700. ")
3701. 
3702. 
3703. 
3704. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3705. 
3706. # Script: BannerSet
3707. 
3708. # Script: DisplaySetDateTimeRun
3709. 
3710. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
3711. /* Xinclude "..\Display\BannerSet.MyDc"X */
3712. /* pause(1) */
3713. 
3714. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
3715. 
3716. Title('!Heading!')
3717. /* pause(1) */
3718. 
3719. /* NOTE: Can't round or truncate to integer precision. */
3720. 
3721. pause(1)
3722. 
3723. # your stuff HERE (X)... pre file select code.
3724. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
3725. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3726. 	# (X)
3727. 
3728. FileSelect
3729. 
3730. 	# your stuff can't really go here (errors.)
3731. 	# maybe for some reason I don't know of...
3732. 	
3733. 	# Actions next...
3734. 		# Script: ZoneDo ZoneTypeSelectOsBoot
3735. # Boot start.
3736. ImportListFromBootOptimize()
3737. # Boot end.
3738. 
3739. 		and not(
3740. 			# Os PageHiberDump start.
3741. (
3742.   FileName("DataStore.edb")
3743.   or FileName("DUMP*.*")
3744.   or FileName("Hiberfil.sys")
3745.   or FileName("MEMORY.DMP")
3746.   or FileName("Pagefile.sys")
3747. )
3748. # Os PageHiberDump end.
3749. 
3750. 		)
3751. 
3752. 	FileActions
3753. 		  		/* ---------------------------------------------------------- */
3754. 	# Gap
3755. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
3756. 		# Script: DisplaySetFileStep
3757. 
3758. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3759. 
3760. /* add message and move to a new line. */
3761. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3762. ")
3763. 
3764. /* display the line. (hopefully.) */
3765. # Zone Footer Set Statistics Window Text
3766. 
3767. SetStatisticsWindowText("!Heading!
3768. ----------------------------------------------------------
3769. Zones Processed: 
3770. ----------------------------------------------------------
3771. !ZoneListByLine!
3772. ----------------------------------------------------------
3773. Zone Processing Step:
3774. !ZoneStepByLine!    
3775. ----------------------------------------------------------
3776. Current Zone:
3777. !ZoneFooter!
3778. ----------------------------------------------------------
3779. Volume Statistics:
3780. !VolumeStatisticsDetail!
3781. ----------------------------------------------------------
3782. Zone Detailed Report:
3783. ----------------------------------------------------------
3784. !ZoneStatisticsDetail!
3785. ----------------------------------------------------------
3786. ")
3787. 
3788. 
3789. 
3790. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3791. 
3792. # Script: BannerSet
3793. 
3794. # Script: DisplaySetDateTimeRun
3795. 
3796. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
3797. /* Xinclude "..\Display\BannerSet.MyDc"X */
3798. /* pause(1) */
3799. 
3800. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
3801. 
3802. Title('!Heading!')
3803. /* pause(1) */
3804. 
3805. /* NOTE: Can't round or truncate to integer precision. */
3806. 
3807. pause(1)
3808. 	
3809. 	# ACTUAL GAP
3810. 		/* AddGap Variant. */
3811. 	  	# Zone Do Gap
3812. # Gap Calculation Methods:
3813. 
3814. /* 1) Anything you need to add first. */
3815. /* empty */
3816. 
3817. /* ---------------------------------------------------------- */
3818. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
3819. 	# GapRequestedStd.
3820. 
3821. 		/* ---------------------------------------------------------- */
3822. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
3823. 
3824. 		# Gap Calculation Methods:
3825. 
3826. /* AddGap Variants */
3827. 
3828. 	/* Standard */
3829. 		# Gap Calculation Methods:
3830. 	/* AddGap Variants */
3831. 	/* Standard */
3832. 
3833. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
3834. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
3835. 
3836. 	SetVariable(GapRequested, GapRequestedStd)
3837. 	
3838. 
3839. 	/* MFT Low High Method */
3840. 		# Gap Calculation Methods:
3841. 	/* AddGap Variants */
3842. 	/* MFT Low High Method */
3843. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
3844. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
3845. 	SetVariable(GapRequested, GapRequestedMft)
3846. 	
3847. 
3848. 	/* OS Volume Type Method */
3849. 		# Gap Calculation Methods:
3850. 	/* AddGap Variants */
3851. 	/* OS Volume Type Method */
3852. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
3853. 	SetVariable(GapRequested, GapRequestedOs)
3854. 
3855. 
3856. 
3857. /* MakeGap Variants */
3858. 
3859. 	/* Original Os 1-3 + MFT 2 */
3860. 		# Gap Calculation Methods:
3861. 	/* MakeGap Variants */
3862. 	/* Original Os 1-3 + MFT 2 */
3863. 	/* plus MFT gap placed inline at the dividing zone. */
3864. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
3865. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
3866. 	SetVariable(GapRequested, GapRequestedOrig)
3867. 	
3868. 	
3869. /* Note: You could comment out the ones not in use */
3870. /* However having the data in the log is useful. */
3871. /* Therefore the following line is otherwise needed. */
3872. 
3873. /* Standard used */
3874. 
3875. SetVariable(GapRequested, GapRequestedStd)
3876. 
3877. # Gap Calculation Methods:
3878. 
3879. /* AddGap Variants */
3880. 	/* Standard */
3881. 	/* MFT Low High Method */
3882. 	/* OS Volume Type Method */
3883. 
3884. /* MakeGap Variants */
3885. 	/* Original Os 1-3 + MFT 2 */
3886. 
3887. /* Note: You could comment out the ones not in use */
3888. /* However having the data in the log is useful. */
3889. /* Therefore the following line is otherwise needed. */
3890. 
3891. /* Standard is used currently */
3892. 
3893. 
3894. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
3895. 
3896. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
3897. 
3898. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
3899. 
3900. /* ---------------------------------------------------------- */
3901. /* 3) SMALL ZONE ADJUSTMENT. */
3902. /* Gab cant be larger than half the Zone Size. */
3903. 
3904. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
3905. 	
3906. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
3907. 
3908. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
3909. 
3910. /* ---------------------------------------------------------- */
3911. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
3912. # Gap Adjustments.
3913. 
3914. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
3915. 	
3916. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
3917. 
3918. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
3919. 
3920. /* ---------------------------------------------------------- */
3921. # BYPASS THIS.
3922. 	/* This is definitely wrong. */
3923. 	/* The question is can we steal gap from the next zone */
3924. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
3925. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
3926. 		# Zone Overflow.
3927. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
3928. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
3929. 
3930. /* ---------------------------------------------------------- */
3931. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
3932. # Remaining free space available.
3933. 
3934. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
3935. 	
3936. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
3937. 
3938. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
3939. 
3940. /* ---------------------------------------------------------- */
3941. # CURRENT gap to use.
3942. 
3943. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
3944. 
3945. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
3946. 
3947. /* ---------------------------------------------------------- */
3948. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
3949. # Debugging.
3950. 
3951. 	SetVariable(GapUsed, GapCurrent) // for debugging
3952. 
3953. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
3954. 
3955. 		# Your code HERE
3956. 
3957. /* ---------------------------------------------------------- */
3958. /* 7) YOUR CODE. */
3959. # YOUR CODE HERE:
3960. 	# INPUT: GapCurrent or GapCurrentLoc
3961. 	# OUTPUT: GapUsed...
3962. 
3963. /* ---------------------------------------------------------- */
3964. # Gap Size.
3965. # Actual Size of Gap.
3966. 
3967. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
3968. 
3969. /* ---------------------------------------------------------- */
3970. /* xxxxxxxxxxxxxxxxxxxxxx */
3971. # ADD THE GAP
3972. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
3973. /* xxxxxxxxxxxxxxxxxxxxxx */
3974. 
3975. 	
3976. 	# Zone Statistics	
3977. 	# Script: ZoneDoStatistics
3978. # Zone / Volume Statistics and Display
3979. 		
3980. 	# Accumulate Totals
3981.   	# Script: ZoneDoVolumeTotals
3982. 
3983. /* Current total space used (by Zones and Gaps) */
3984. 
3985. SetVariable(VolumeZoneUsed, GapUsed)
3986. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
3987. /* Percentage */
3988. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
3989. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
3990. 
3991. /* Current total of free space requested */
3992. 
3993. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
3994. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3995. /* Percent. */
3996. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
3997. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3998. 
3999. /* Current total of free space used */
4000. 
4001. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
4002. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
4003. /* Percent */
4004. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
4005. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
4006. 
4007. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
4008. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
4009. /* Xinclude "..\DebugDisplayPause.MyDc"X */
4010. 
4011. 
4012. 	# Current Values
4013. 	# Script: ZoneDoCurrentSet
4014. 
4015. # Cluster, Sector, Block adjust for display.
4016. 	# Bytes per cluster is volume specific.
4017. 
4018. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
4019. 
4020. # Current Zone values.
4021. 	# Begin, end and size.
4022. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
4023. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
4024. 
4025. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
4026. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
4027. 
4028. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
4029. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
4030. 
4031. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
4032. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
4033. 
4034. 	SetVariable(ZoneFragments,				"!ZONE210N!")
4035. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
4036. 		
4037. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
4038. /* identical code to here: (separation not needed. TEST.) */	
4039. 
4040. # Current Gap, Actual and Free Values
4041. 	# Gap
4042. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
4043. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
4044. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
4045. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
4046. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
4047. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
4048. 	
4049. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
4050. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
4051. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
4052. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
4053. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
4054. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
4055. 	
4056. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
4057. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
4058. 	
4059. 	# Actual Size and End
4060. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
4061. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
4062. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
4063. 	
4064. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
4065. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
4066. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
4067. 
4068. # Gap Size & Rounding
4069. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
4070. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
4071. 	
4072. 	# Free Space
4073. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
4074. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
4075. 
4076. 	# Footer:
4077. SetVariable(ZoneFooter, "----------------------------------------------------------
4078. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:18
4079. 
4080. Statistics Report:
4081. ------------------
4082.    Size:  
4083.    ------------------------
4084.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4085.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4086.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4087. 
4088.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4089.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4090. 
4091.    Location:
4092.    ------------------------
4093.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4094.              Files End: !ZoneEndCurrent!
4095.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4096.       
4097.    Gap Settings:
4098.    ------------------------
4099.          Gap Requested: !ZoneGapSizePer!%
4100.       Volume Rounding: !ZoneVolRoundUpPer!%
4101.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4102.                  
4103.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
4104.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
4105.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
4106.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
4107.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
4108.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
4109.      
4110.    Free Space after Zone:
4111.    ------------------------
4112.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4113.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4114.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4115. 
4116. Directory and Files Select:
4117. ---------------------------
4118. !ZoneTypeSelectCurrent!               
4119. ---------------------------
4120. ----------------------------------------------------------
4121. ")
4122. 	# Zone Footer Set Statistics Window Text
4123. 
4124. SetStatisticsWindowText("!Heading!
4125. ----------------------------------------------------------
4126. Zones Processed: 
4127. ----------------------------------------------------------
4128. !ZoneListByLine!
4129. ----------------------------------------------------------
4130. Zone Processing Step:
4131. !ZoneStepByLine!    
4132. ----------------------------------------------------------
4133. Current Zone:
4134. !ZoneFooter!
4135. ----------------------------------------------------------
4136. Volume Statistics:
4137. !VolumeStatisticsDetail!
4138. ----------------------------------------------------------
4139. Zone Detailed Report:
4140. ----------------------------------------------------------
4141. !ZoneStatisticsDetail!
4142. ----------------------------------------------------------
4143. ")
4144. 
4145. 
4146. 	
4147.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
4148. 
4149. 	# Add Zone to list of zones for display.
4150. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
4151. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
4152. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
4153. 	# ??? Free Stats?
4154. 	# Footer:
4155. SetVariable(ZoneFooter, "----------------------------------------------------------
4156. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:18
4157. 
4158. Statistics Report:
4159. ------------------
4160.    Size:  
4161.    ------------------------
4162.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4163.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4164.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4165. 
4166.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4167.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4168. 
4169.    Location:
4170.    ------------------------
4171.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4172.              Files End: !ZoneEndCurrent!
4173.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4174.       
4175.    Gap Settings:
4176.    ------------------------
4177.          Gap Requested: !ZoneGapSizePer!%
4178.       Volume Rounding: !ZoneVolRoundUpPer!%
4179.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4180.                  
4181.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
4182.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
4183.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
4184.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
4185.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
4186.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
4187.      
4188.    Free Space after Zone:
4189.    ------------------------
4190.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4191.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4192.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4193. 
4194. Directory and Files Select:
4195. ---------------------------
4196. !ZoneTypeSelectCurrent!               
4197. ---------------------------
4198. ----------------------------------------------------------
4199. ")
4200. 
4201. 	# Add Zone Details to Report.	
4202. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
4203. !ZoneFooter!")
4204. 
4205. 
4206. 	
4207. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
4208. 			# Script: DisplaySetFileStep
4209. 
4210. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4211. 
4212. /* add message and move to a new line. */
4213. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4214. ")
4215. 
4216. /* display the line. (hopefully.) */
4217. # Zone Footer Set Statistics Window Text
4218. 
4219. SetStatisticsWindowText("!Heading!
4220. ----------------------------------------------------------
4221. Zones Processed: 
4222. ----------------------------------------------------------
4223. !ZoneListByLine!
4224. ----------------------------------------------------------
4225. Zone Processing Step:
4226. !ZoneStepByLine!    
4227. ----------------------------------------------------------
4228. Current Zone:
4229. !ZoneFooter!
4230. ----------------------------------------------------------
4231. Volume Statistics:
4232. !VolumeStatisticsDetail!
4233. ----------------------------------------------------------
4234. Zone Detailed Report:
4235. ----------------------------------------------------------
4236. !ZoneStatisticsDetail!
4237. ----------------------------------------------------------
4238. ")
4239. 
4240. 
4241. 
4242. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4243. 
4244. # Script: BannerSet
4245. 
4246. # Script: DisplaySetDateTimeRun
4247. 
4248. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:18 0:00:01")
4249. /* Xinclude "..\Display\BannerSet.MyDc"X */
4250. /* pause(1) */
4251. 
4252. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
4253. 
4254. Title('!Heading!')
4255. /* pause(1) */
4256. 
4257. /* NOTE: Can't round or truncate to integer precision. */
4258. 
4259. pause(1)
4260. 
4261. 			# File Action - Os Boot - Fast - MoveUpToZone.
4262. 	MoveUpToZone()
4263. 	
4264. 	
4265. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
4266. 			# Script: DisplaySetFileStep
4267. 
4268. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4269. 
4270. /* add message and move to a new line. */
4271. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4272. ")
4273. 
4274. /* display the line. (hopefully.) */
4275. # Zone Footer Set Statistics Window Text
4276. 
4277. SetStatisticsWindowText("!Heading!
4278. ----------------------------------------------------------
4279. Zones Processed: 
4280. ----------------------------------------------------------
4281. !ZoneListByLine!
4282. ----------------------------------------------------------
4283. Zone Processing Step:
4284. !ZoneStepByLine!    
4285. ----------------------------------------------------------
4286. Current Zone:
4287. !ZoneFooter!
4288. ----------------------------------------------------------
4289. Volume Statistics:
4290. !VolumeStatisticsDetail!
4291. ----------------------------------------------------------
4292. Zone Detailed Report:
4293. ----------------------------------------------------------
4294. !ZoneStatisticsDetail!
4295. ----------------------------------------------------------
4296. ")
4297. 
4298. 
4299. 
4300. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4301. 
4302. # Script: BannerSet
4303. 
4304. # Script: DisplaySetDateTimeRun
4305. 
4306. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
4307. /* Xinclude "..\Display\BannerSet.MyDc"X */
4308. /* pause(1) */
4309. 
4310. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
4311. 
4312. Title('!Heading!')
4313. /* pause(1) */
4314. 
4315. /* NOTE: Can't round or truncate to integer precision. */
4316. 
4317. pause(1)
4318. 
4319. 		# Script: ZoneDoFooter
4320. 
4321. /* ---------------------------------------------------------- */
4322. # File Select
4323. 	# Select Statments
4324. # File Actions 
4325. 	# Standard or OS File Actions.
4326. 	# Resume...
4327. 	
4328. 	# your stuff HERE (X)... post zone (file) file actions code.
4329. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
4330. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4331. 		# (X)
4332. 		
4333. 		/* ??? Set window? */
4334. 	
4335. 	# ADD THE GAP
4336. # Vacate (good for diagnostics)
4337. # DoNotVacate - DO NOT Vacate (recommended)
4338. # DoNotVacate - DO NOT Vacate (recommended)
4339. 
4340. # Vacate
4341. /* AddGap(GapUsedLoc) */
4342. 
4343. # DO Not Vacate
4344. AddGap(GapUsedLoc, DoNotVacate) 
4345. 	
4346. 	
4347. # Script: GapZoneCommand
4348. # *** Moved to setting yours ***
4349. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
4350. # Controlled via settings commands
4351. # DoNotVacate - DO NOT Vacate (recommended)
4352. 
4353. # Vacate
4354. /* AddGap(GapUsedLoc) */
4355. 
4356. # DO Not Vacate
4357. AddGap(GapUsedLoc, DoNotVacate) 
4358. 	
4359. 	
4360. # Vacate /* AddGap(GapUsed) */
4361. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
4362. 	
4363. 
4364. 		
4365. # 
4366. FileEnd
4367. /* ---------------------------------------------------------- */
4368. 
4369. # your stuff HERE (X)... post zone (file) code.
4370. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
4371. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4372. 	# (X)
4373. 
4374. SetVariable(FileStepDescription,"Zone finished, reporting.")
4375. # Script: DisplaySetFileStep
4376. 
4377. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4378. 
4379. /* add message and move to a new line. */
4380. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4381. ")
4382. 
4383. /* display the line. (hopefully.) */
4384. # Zone Footer Set Statistics Window Text
4385. 
4386. SetStatisticsWindowText("!Heading!
4387. ----------------------------------------------------------
4388. Zones Processed: 
4389. ----------------------------------------------------------
4390. !ZoneListByLine!
4391. ----------------------------------------------------------
4392. Zone Processing Step:
4393. !ZoneStepByLine!    
4394. ----------------------------------------------------------
4395. Current Zone:
4396. !ZoneFooter!
4397. ----------------------------------------------------------
4398. Volume Statistics:
4399. !VolumeStatisticsDetail!
4400. ----------------------------------------------------------
4401. Zone Detailed Report:
4402. ----------------------------------------------------------
4403. !ZoneStatisticsDetail!
4404. ----------------------------------------------------------
4405. ")
4406. 
4407. 
4408. 
4409. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4410. 
4411. # Script: BannerSet
4412. 
4413. # Script: DisplaySetDateTimeRun
4414. 
4415. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
4416. /* Xinclude "..\Display\BannerSet.MyDc"X */
4417. /* pause(1) */
4418. 
4419. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
4420. 
4421. Title('!Heading!')
4422. /* pause(1) */
4423. 
4424. /* NOTE: Can't round or truncate to integer precision. */
4425. 
4426. pause(1)
4427. 
4428. # Script: ZoneWhenFinished
4429. 
4430. # Script: BannerSet
4431. 
4432. # Script: DisplaySetDateTimeRun
4433. 
4434. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
4435. /* Xinclude "..\Display\BannerSet.MyDc"X */
4436. /* pause(1) */
4437. 
4438. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
4439. 
4440. Title('!Heading!')
4441. /* pause(1) */
4442. 
4443. /* NOTE: Can't round or truncate to integer precision. */
4444. 
4445. # Script: BannerLog
4446. 
4447. AppendLogfile("!LogFileName!", "!Title!")
4448. 
4449. 
4450. 
4451. # Zone Statistics	
4452. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
4453. 
4454. # Footer:
4455. SetVariable(ZoneFooter, "----------------------------------------------------------
4456. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:19
4457. 
4458. Statistics Report:
4459. ------------------
4460.    Size:  
4461.    ------------------------
4462.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4463.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4464.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4465. 
4466.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4467.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4468. 
4469.    Location:
4470.    ------------------------
4471.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4472.              Files End: !ZoneEndCurrent!
4473.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4474.       
4475.    Gap Settings:
4476.    ------------------------
4477.          Gap Requested: !ZoneGapSizePer!%
4478.       Volume Rounding: !ZoneVolRoundUpPer!%
4479.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4480.                  
4481.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
4482.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
4483.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
4484.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
4485.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
4486.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
4487.      
4488.    Free Space after Zone:
4489.    ------------------------
4490.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4491.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4492.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4493. 
4494. Directory and Files Select:
4495. ---------------------------
4496. !ZoneTypeSelectCurrent!               
4497. ---------------------------
4498. ----------------------------------------------------------
4499. ")
4500. 
4501. AppendLogfile("!LogFileName!", ".")
4502. AppendLogfile("!LogFileName!", "!ZoneFooter!")
4503. AppendLogfile("!LogFileName!", ".")
4504. 
4505. # Zone Footer Set Statistics Window Text
4506. 
4507. SetStatisticsWindowText("!Heading!
4508. ----------------------------------------------------------
4509. Zones Processed: 
4510. ----------------------------------------------------------
4511. !ZoneListByLine!
4512. ----------------------------------------------------------
4513. Zone Processing Step:
4514. !ZoneStepByLine!    
4515. ----------------------------------------------------------
4516. Current Zone:
4517. !ZoneFooter!
4518. ----------------------------------------------------------
4519. Volume Statistics:
4520. !VolumeStatisticsDetail!
4521. ----------------------------------------------------------
4522. Zone Detailed Report:
4523. ----------------------------------------------------------
4524. !ZoneStatisticsDetail!
4525. ----------------------------------------------------------
4526. ")
4527. 
4528. 
4529. 
4530. /* pause() */
4531. /* pause() */
4532. 
4533. 
4534. 
4535. 
4536. /* ---------------------------------------------------------- */
4537. 
4538. 
4539. /* ---------------------------------------------------------- */
4540. # Zone ProgramHints Fixed and Data
4541. # Os Group Zone 3 & 4
4542. # Script: DefragZoneTypeOsProgramHints
4543. /* ---------------------------------------------------------- */
4544. # Zone 1 of 2 ProgramHints Fixed.
4545. 	# Script: DisplayColors - Zone Dark
4546. # Processed
4547. SetFileColor(All, Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
4548. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
4549. 
4550. # Light Green and Yellow
4551. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
4552. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
4553. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
4554. 
4555. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHints!")
4556. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHints!")
4557. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
4558. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHints!")
4559. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsProgramHints
4560. # ProgramHints start.
4561. ImportListFromProgramHints("*.pf")
4562. # ProgramHints end.
4563. ')
4564. 
4565. 		# Script: ZoneDoHeader
4566. 
4567. # Script: ZoneWhenStarted
4568. 
4569. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
4570. # Script: DisplaySetZone
4571. 
4572. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
4573. SetVariable(FileStepDescription,	"")
4574. 
4575. SetVariable(ZoneStepByLine, 			"Zone started.
4576. ")
4577. 
4578. # Script: BannerDescriptionSet
4579. 
4580. # Script: BannerSet
4581. 
4582. # Script: DisplaySetDateTimeRun
4583. 
4584. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
4585. /* Xinclude "..\Display\BannerSet.MyDc"X */
4586. /* pause(1) */
4587. 
4588. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
4589. 
4590. Title('!Heading!')
4591. /* pause(1) */
4592. 
4593. /* NOTE: Can't round or truncate to integer precision. */
4594. 
4595. # Script: BannerLog
4596. 
4597. AppendLogfile("!LogFileName!", "!Title!")
4598. 
4599. 
4600. 
4601. pause(1)
4602. 
4603. 
4604. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
4605. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
4606. 
4607. SetVariable(ZoneStepNoCurrent, 0)
4608. 
4609. 
4610. # Script: ZoneDoCurrentClear
4611. 
4612. SetVariable(ZoneTypeSelectCurrent, 		"")
4613. 
4614. SetVariable(ZoneBeginCurrent, 			0)
4615. SetVariable(ZoneBeginPerCurrent, 		0)
4616. SetVariable(ZoneEndCurrent, 			0)
4617. SetVariable(ZoneEndPerCurrent, 			0)
4618. 
4619. SetVariable(ZoneSizeCurrent,			0)
4620. SetVariable(ZoneSizePerCurrent,			0)
4621. 
4622. SetVariable(ZoneGapRequestedCurrent,	0)
4623. SetVariable(ZoneGapRoundedCurrent, 		0)
4624. SetVariable(ZoneGapAdjustedCurrent, 	0)
4625. SetVariable(ZoneGapAvailableCurrent, 	0)
4626. SetVariable(ZoneGapCurrent,				0)
4627. SetVariable(ZoneGapUsedCurrent, 		0)
4628. 
4629. SetVariable(ZoneGapActualCurrent, 		0)
4630. SetVariable(ZoneGapActualPerCurrent, 	0)
4631. 
4632. SetVariable(ZoneSizeActual, 			0)
4633. SetVariable(ZoneSizeActualCurrent,		0)
4634. 
4635. SetVariable(ZoneEndActual, 				0)
4636. SetVariable(ZoneEndActualCurrent,		0)			
4637. SetVariable(ZoneSizeActualPerCurrent, 	0)
4638.       
4639. SetVariable(ZoneFilesFolders,			0)
4640. SetVariable(ZoneFilesFoldersPer,		0) 
4641. 
4642. SetVariable(ZoneFragments,				0)
4643. SetVariable(ZoneFragmentsPer,			0) 
4644. 		
4645. SetVariable(ZoneEndActualCurrent, 		0)
4646. SetVariable(ZoneEndActualPerCurrent, 	0)
4647. 
4648. # Gap Calculation Methodology:
4649. 	# Requested
4650. 	SetVariable(GapRequested, 			0) 
4651. 	SetVariable(GapRequestedStd, 		0) 
4652. 	SetVariable(GapRequestedMft, 		0) 
4653. 	SetVariable(GapRequestedOs, 		0) 
4654. 	SetVariable(GapRequestedOriginal, 	0) 
4655. 	
4656. 	# Gap Adjustments
4657. 	SetVariable(GapRounded, 			0)
4658. 	# SetVariable(GapAdjusted, 			0)
4659. 	SetVariable(GapAvailable, 			0)
4660. 	SetVariable(GapCurrent, 			0)
4661. 	SetVariable(GapActual, 				0)
4662. 	SetVariable(GapUsed, 				0)
4663. 	
4664. 	# Gap Adjustments
4665. 	SetVariable(GapRoundedLoc, 			0)
4666. 	# SetVariable(GapAdjustedLoc, 		0)
4667. 	SetVariable(GapAvailableLoc, 		0)
4668. 	SetVariable(GapCurrentLoc, 			0)
4669. 	SetVariable(GapActualLoc,			0)
4670. 	SetVariable(GapUsedLoc,				0)
4671. 	
4672. 	# Space usage
4673. 	SetVariable(ZoneFreePerRequested, 	0)
4674. 	SetVariable(ZoneFreePerUsed, 		0)
4675. 
4676. # Gap Size & Rounding
4677. 	SetVariable(ZoneGapSizePer, 		0)
4678. 	SetVariable(ZoneVolRoundUpPer, 		0)
4679. 	
4680. 	# Free Space
4681. 	SetVariable(ZoneFreeUsedPer, 		0)
4682. 	SetVariable(ZoneFreeRequestedPer, 	0)
4683. 
4684. 
4685. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
4686. 
4687. # Footer:
4688. SetVariable(ZoneFooter, "----------------------------------------------------------
4689. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:19
4690. 
4691. Statistics Report:
4692. ------------------
4693.    Size:  
4694.    ------------------------
4695.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4696.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4697.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4698. 
4699.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4700.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4701. 
4702.    Location:
4703.    ------------------------
4704.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4705.              Files End: !ZoneEndCurrent!
4706.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4707.       
4708.    Gap Settings:
4709.    ------------------------
4710.          Gap Requested: !ZoneGapSizePer!%
4711.       Volume Rounding: !ZoneVolRoundUpPer!%
4712.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4713.                  
4714.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
4715.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
4716.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
4717.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
4718.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
4719.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
4720.      
4721.    Free Space after Zone:
4722.    ------------------------
4723.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4724.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4725.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4726. 
4727. Directory and Files Select:
4728. ---------------------------
4729. !ZoneTypeSelectCurrent!               
4730. ---------------------------
4731. ----------------------------------------------------------
4732. ")
4733. 
4734. # Script: BannerSet
4735. 
4736. # Script: DisplaySetDateTimeRun
4737. 
4738. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
4739. /* Xinclude "..\Display\BannerSet.MyDc"X */
4740. /* pause(1) */
4741. 
4742. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
4743. 
4744. Title('!Heading!')
4745. /* pause(1) */
4746. 
4747. /* NOTE: Can't round or truncate to integer precision. */
4748. 
4749. # Script: BannerLog
4750. 
4751. AppendLogfile("!LogFileName!", "!Title!")
4752. 
4753. 
4754. 
4755. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
4756. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
4757. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:19")
4758. 
4759. SetVariable(ZoneListByLine, "!ZoneListByLine!
4760. Zone: !ZoneNoCurrent! 2021-11-13 20:31:19 0:00:02 !ZoneLabel! !ZoneDescription!")
4761. 
4762. 
4763. /* Fixed Zone Position Handling */
4764. /* Literal number: */
4765. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
4766. /* Percentage of disk: */
4767. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
4768. /* Gap */
4769. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
4770. 
4771. /* ---------------------------------------------------------- */
4772. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
4773. # Script: DisplaySetFileStep
4774. 
4775. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4776. 
4777. /* add message and move to a new line. */
4778. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4779. ")
4780. 
4781. /* display the line. (hopefully.) */
4782. # Zone Footer Set Statistics Window Text
4783. 
4784. SetStatisticsWindowText("!Heading!
4785. ----------------------------------------------------------
4786. Zones Processed: 
4787. ----------------------------------------------------------
4788. !ZoneListByLine!
4789. ----------------------------------------------------------
4790. Zone Processing Step:
4791. !ZoneStepByLine!    
4792. ----------------------------------------------------------
4793. Current Zone:
4794. !ZoneFooter!
4795. ----------------------------------------------------------
4796. Volume Statistics:
4797. !VolumeStatisticsDetail!
4798. ----------------------------------------------------------
4799. Zone Detailed Report:
4800. ----------------------------------------------------------
4801. !ZoneStatisticsDetail!
4802. ----------------------------------------------------------
4803. ")
4804. 
4805. 
4806. 
4807. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4808. 
4809. # Script: BannerSet
4810. 
4811. # Script: DisplaySetDateTimeRun
4812. 
4813. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
4814. /* Xinclude "..\Display\BannerSet.MyDc"X */
4815. /* pause(1) */
4816. 
4817. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
4818. 
4819. Title('!Heading!')
4820. /* pause(1) */
4821. 
4822. /* NOTE: Can't round or truncate to integer precision. */
4823. 
4824. pause(1)
4825. 
4826. # your stuff HERE (X)... pre file select code.
4827. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
4828. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4829. 	# (X)
4830. 
4831. FileSelect
4832. 
4833. 	# your stuff can't really go here (errors.)
4834. 	# maybe for some reason I don't know of...
4835. 	
4836. 	# Actions next...
4837. 		# Script: ZoneDo ZoneTypeSelectOsProgramHints
4838. # ProgramHints start.
4839. ImportListFromProgramHints("*.pf")
4840. # ProgramHints end.
4841. 
4842. 		and not(
4843. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
4844. # Os Data Dynamic start.
4845. (
4846. # Os Data Dynamic start.
4847. (
4848.   FileName("*.dat*")
4849.   or FileName("*.db*")
4850.   or FileName("*.edb*")
4851.   or FileName("*.log*")
4852.   or FileName("DataStore.edb")
4853. )
4854. # Os Data Dynamic end.
4855. 
4856.   or 
4857. # Os PageHiberDump start.
4858. (
4859.   FileName("DataStore.edb")
4860.   or FileName("DUMP*.*")
4861.   or FileName("Hiberfil.sys")
4862.   or FileName("MEMORY.DMP")
4863.   or FileName("Pagefile.sys")
4864. )
4865. # Os PageHiberDump end.
4866. 
4867. # Os Data Dynamic
4868. )
4869. # Os Data Dynamic end.
4870. 
4871. 		)
4872. 
4873. 		FileActions
4874. 		  		/* ---------------------------------------------------------- */
4875. 	# Gap
4876. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
4877. 		# Script: DisplaySetFileStep
4878. 
4879. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4880. 
4881. /* add message and move to a new line. */
4882. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4883. ")
4884. 
4885. /* display the line. (hopefully.) */
4886. # Zone Footer Set Statistics Window Text
4887. 
4888. SetStatisticsWindowText("!Heading!
4889. ----------------------------------------------------------
4890. Zones Processed: 
4891. ----------------------------------------------------------
4892. !ZoneListByLine!
4893. ----------------------------------------------------------
4894. Zone Processing Step:
4895. !ZoneStepByLine!    
4896. ----------------------------------------------------------
4897. Current Zone:
4898. !ZoneFooter!
4899. ----------------------------------------------------------
4900. Volume Statistics:
4901. !VolumeStatisticsDetail!
4902. ----------------------------------------------------------
4903. Zone Detailed Report:
4904. ----------------------------------------------------------
4905. !ZoneStatisticsDetail!
4906. ----------------------------------------------------------
4907. ")
4908. 
4909. 
4910. 
4911. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4912. 
4913. # Script: BannerSet
4914. 
4915. # Script: DisplaySetDateTimeRun
4916. 
4917. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
4918. /* Xinclude "..\Display\BannerSet.MyDc"X */
4919. /* pause(1) */
4920. 
4921. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
4922. 
4923. Title('!Heading!')
4924. /* pause(1) */
4925. 
4926. /* NOTE: Can't round or truncate to integer precision. */
4927. 
4928. pause(1)
4929. 	
4930. 	# ACTUAL GAP
4931. 		/* AddGap Variant. */
4932. 	  	# Zone Do Gap
4933. # Gap Calculation Methods:
4934. 
4935. /* 1) Anything you need to add first. */
4936. /* empty */
4937. 
4938. /* ---------------------------------------------------------- */
4939. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
4940. 	# GapRequestedStd.
4941. 
4942. 		/* ---------------------------------------------------------- */
4943. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
4944. 
4945. 		# Gap Calculation Methods:
4946. 
4947. /* AddGap Variants */
4948. 
4949. 	/* Standard */
4950. 		# Gap Calculation Methods:
4951. 	/* AddGap Variants */
4952. 	/* Standard */
4953. 
4954. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
4955. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
4956. 
4957. 	SetVariable(GapRequested, GapRequestedStd)
4958. 	
4959. 
4960. 	/* MFT Low High Method */
4961. 		# Gap Calculation Methods:
4962. 	/* AddGap Variants */
4963. 	/* MFT Low High Method */
4964. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
4965. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
4966. 	SetVariable(GapRequested, GapRequestedMft)
4967. 	
4968. 
4969. 	/* OS Volume Type Method */
4970. 		# Gap Calculation Methods:
4971. 	/* AddGap Variants */
4972. 	/* OS Volume Type Method */
4973. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
4974. 	SetVariable(GapRequested, GapRequestedOs)
4975. 
4976. 
4977. 
4978. /* MakeGap Variants */
4979. 
4980. 	/* Original Os 1-3 + MFT 2 */
4981. 		# Gap Calculation Methods:
4982. 	/* MakeGap Variants */
4983. 	/* Original Os 1-3 + MFT 2 */
4984. 	/* plus MFT gap placed inline at the dividing zone. */
4985. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
4986. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
4987. 	SetVariable(GapRequested, GapRequestedOrig)
4988. 	
4989. 	
4990. /* Note: You could comment out the ones not in use */
4991. /* However having the data in the log is useful. */
4992. /* Therefore the following line is otherwise needed. */
4993. 
4994. /* Standard used */
4995. 
4996. SetVariable(GapRequested, GapRequestedStd)
4997. 
4998. # Gap Calculation Methods:
4999. 
5000. /* AddGap Variants */
5001. 	/* Standard */
5002. 	/* MFT Low High Method */
5003. 	/* OS Volume Type Method */
5004. 
5005. /* MakeGap Variants */
5006. 	/* Original Os 1-3 + MFT 2 */
5007. 
5008. /* Note: You could comment out the ones not in use */
5009. /* However having the data in the log is useful. */
5010. /* Therefore the following line is otherwise needed. */
5011. 
5012. /* Standard is used currently */
5013. 
5014. 
5015. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
5016. 
5017. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
5018. 
5019. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
5020. 
5021. /* ---------------------------------------------------------- */
5022. /* 3) SMALL ZONE ADJUSTMENT. */
5023. /* Gab cant be larger than half the Zone Size. */
5024. 
5025. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
5026. 	
5027. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
5028. 
5029. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
5030. 
5031. /* ---------------------------------------------------------- */
5032. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
5033. # Gap Adjustments.
5034. 
5035. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
5036. 	
5037. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
5038. 
5039. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
5040. 
5041. /* ---------------------------------------------------------- */
5042. # BYPASS THIS.
5043. 	/* This is definitely wrong. */
5044. 	/* The question is can we steal gap from the next zone */
5045. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
5046. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
5047. 		# Zone Overflow.
5048. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
5049. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
5050. 
5051. /* ---------------------------------------------------------- */
5052. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
5053. # Remaining free space available.
5054. 
5055. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
5056. 	
5057. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
5058. 
5059. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
5060. 
5061. /* ---------------------------------------------------------- */
5062. # CURRENT gap to use.
5063. 
5064. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
5065. 
5066. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
5067. 
5068. /* ---------------------------------------------------------- */
5069. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
5070. # Debugging.
5071. 
5072. 	SetVariable(GapUsed, GapCurrent) // for debugging
5073. 
5074. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
5075. 
5076. 		# Your code HERE
5077. 
5078. /* ---------------------------------------------------------- */
5079. /* 7) YOUR CODE. */
5080. # YOUR CODE HERE:
5081. 	# INPUT: GapCurrent or GapCurrentLoc
5082. 	# OUTPUT: GapUsed...
5083. 
5084. /* ---------------------------------------------------------- */
5085. # Gap Size.
5086. # Actual Size of Gap.
5087. 
5088. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
5089. 
5090. /* ---------------------------------------------------------- */
5091. /* xxxxxxxxxxxxxxxxxxxxxx */
5092. # ADD THE GAP
5093. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
5094. /* xxxxxxxxxxxxxxxxxxxxxx */
5095. 
5096. 	
5097. 	# Zone Statistics	
5098. 	# Script: ZoneDoStatistics
5099. # Zone / Volume Statistics and Display
5100. 		
5101. 	# Accumulate Totals
5102.   	# Script: ZoneDoVolumeTotals
5103. 
5104. /* Current total space used (by Zones and Gaps) */
5105. 
5106. SetVariable(VolumeZoneUsed, GapUsed)
5107. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
5108. /* Percentage */
5109. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
5110. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
5111. 
5112. /* Current total of free space requested */
5113. 
5114. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
5115. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5116. /* Percent. */
5117. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
5118. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5119. 
5120. /* Current total of free space used */
5121. 
5122. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
5123. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
5124. /* Percent */
5125. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
5126. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
5127. 
5128. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
5129. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
5130. /* Xinclude "..\DebugDisplayPause.MyDc"X */
5131. 
5132. 
5133. 	# Current Values
5134. 	# Script: ZoneDoCurrentSet
5135. 
5136. # Cluster, Sector, Block adjust for display.
5137. 	# Bytes per cluster is volume specific.
5138. 
5139. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
5140. 
5141. # Current Zone values.
5142. 	# Begin, end and size.
5143. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
5144. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
5145. 
5146. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
5147. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
5148. 
5149. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
5150. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
5151. 
5152. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
5153. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
5154. 
5155. 	SetVariable(ZoneFragments,				"!ZONE210N!")
5156. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
5157. 		
5158. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
5159. /* identical code to here: (separation not needed. TEST.) */	
5160. 
5161. # Current Gap, Actual and Free Values
5162. 	# Gap
5163. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
5164. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
5165. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
5166. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
5167. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
5168. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
5169. 	
5170. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
5171. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
5172. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
5173. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
5174. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
5175. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
5176. 	
5177. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
5178. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
5179. 	
5180. 	# Actual Size and End
5181. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
5182. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
5183. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
5184. 	
5185. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
5186. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
5187. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
5188. 
5189. # Gap Size & Rounding
5190. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
5191. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
5192. 	
5193. 	# Free Space
5194. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
5195. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
5196. 
5197. 	# Footer:
5198. SetVariable(ZoneFooter, "----------------------------------------------------------
5199. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:19
5200. 
5201. Statistics Report:
5202. ------------------
5203.    Size:  
5204.    ------------------------
5205.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5206.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5207.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5208. 
5209.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5210.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5211. 
5212.    Location:
5213.    ------------------------
5214.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5215.              Files End: !ZoneEndCurrent!
5216.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5217.       
5218.    Gap Settings:
5219.    ------------------------
5220.          Gap Requested: !ZoneGapSizePer!%
5221.       Volume Rounding: !ZoneVolRoundUpPer!%
5222.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5223.                  
5224.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
5225.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
5226.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
5227.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
5228.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
5229.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
5230.      
5231.    Free Space after Zone:
5232.    ------------------------
5233.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5234.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5235.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5236. 
5237. Directory and Files Select:
5238. ---------------------------
5239. !ZoneTypeSelectCurrent!               
5240. ---------------------------
5241. ----------------------------------------------------------
5242. ")
5243. 	# Zone Footer Set Statistics Window Text
5244. 
5245. SetStatisticsWindowText("!Heading!
5246. ----------------------------------------------------------
5247. Zones Processed: 
5248. ----------------------------------------------------------
5249. !ZoneListByLine!
5250. ----------------------------------------------------------
5251. Zone Processing Step:
5252. !ZoneStepByLine!    
5253. ----------------------------------------------------------
5254. Current Zone:
5255. !ZoneFooter!
5256. ----------------------------------------------------------
5257. Volume Statistics:
5258. !VolumeStatisticsDetail!
5259. ----------------------------------------------------------
5260. Zone Detailed Report:
5261. ----------------------------------------------------------
5262. !ZoneStatisticsDetail!
5263. ----------------------------------------------------------
5264. ")
5265. 
5266. 
5267. 	
5268.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
5269. 
5270. 	# Add Zone to list of zones for display.
5271. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
5272. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
5273. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
5274. 	# ??? Free Stats?
5275. 	# Footer:
5276. SetVariable(ZoneFooter, "----------------------------------------------------------
5277. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:19
5278. 
5279. Statistics Report:
5280. ------------------
5281.    Size:  
5282.    ------------------------
5283.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5284.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5285.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5286. 
5287.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5288.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5289. 
5290.    Location:
5291.    ------------------------
5292.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5293.              Files End: !ZoneEndCurrent!
5294.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5295.       
5296.    Gap Settings:
5297.    ------------------------
5298.          Gap Requested: !ZoneGapSizePer!%
5299.       Volume Rounding: !ZoneVolRoundUpPer!%
5300.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5301.                  
5302.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
5303.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
5304.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
5305.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
5306.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
5307.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
5308.      
5309.    Free Space after Zone:
5310.    ------------------------
5311.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5312.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5313.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5314. 
5315. Directory and Files Select:
5316. ---------------------------
5317. !ZoneTypeSelectCurrent!               
5318. ---------------------------
5319. ----------------------------------------------------------
5320. ")
5321. 
5322. 	# Add Zone Details to Report.	
5323. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
5324. !ZoneFooter!")
5325. 
5326. 
5327. 		
5328. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
5329. 			# Script: DisplaySetFileStep
5330. 
5331. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5332. 
5333. /* add message and move to a new line. */
5334. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5335. ")
5336. 
5337. /* display the line. (hopefully.) */
5338. # Zone Footer Set Statistics Window Text
5339. 
5340. SetStatisticsWindowText("!Heading!
5341. ----------------------------------------------------------
5342. Zones Processed: 
5343. ----------------------------------------------------------
5344. !ZoneListByLine!
5345. ----------------------------------------------------------
5346. Zone Processing Step:
5347. !ZoneStepByLine!    
5348. ----------------------------------------------------------
5349. Current Zone:
5350. !ZoneFooter!
5351. ----------------------------------------------------------
5352. Volume Statistics:
5353. !VolumeStatisticsDetail!
5354. ----------------------------------------------------------
5355. Zone Detailed Report:
5356. ----------------------------------------------------------
5357. !ZoneStatisticsDetail!
5358. ----------------------------------------------------------
5359. ")
5360. 
5361. 
5362. 
5363. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5364. 
5365. # Script: BannerSet
5366. 
5367. # Script: DisplaySetDateTimeRun
5368. 
5369. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
5370. /* Xinclude "..\Display\BannerSet.MyDc"X */
5371. /* pause(1) */
5372. 
5373. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
5374. 
5375. Title('!Heading!')
5376. /* pause(1) */
5377. 
5378. /* NOTE: Can't round or truncate to integer precision. */
5379. 
5380. pause(1)
5381. 	
5382. 			# File Action - Type Os Program Hints Fixed - Fast - ImportSeq.
5383. 	MoveUpToZone()
5384. 	
5385. 
5386. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
5387. 			# Script: DisplaySetFileStep
5388. 
5389. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5390. 
5391. /* add message and move to a new line. */
5392. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5393. ")
5394. 
5395. /* display the line. (hopefully.) */
5396. # Zone Footer Set Statistics Window Text
5397. 
5398. SetStatisticsWindowText("!Heading!
5399. ----------------------------------------------------------
5400. Zones Processed: 
5401. ----------------------------------------------------------
5402. !ZoneListByLine!
5403. ----------------------------------------------------------
5404. Zone Processing Step:
5405. !ZoneStepByLine!    
5406. ----------------------------------------------------------
5407. Current Zone:
5408. !ZoneFooter!
5409. ----------------------------------------------------------
5410. Volume Statistics:
5411. !VolumeStatisticsDetail!
5412. ----------------------------------------------------------
5413. Zone Detailed Report:
5414. ----------------------------------------------------------
5415. !ZoneStatisticsDetail!
5416. ----------------------------------------------------------
5417. ")
5418. 
5419. 
5420. 
5421. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5422. 
5423. # Script: BannerSet
5424. 
5425. # Script: DisplaySetDateTimeRun
5426. 
5427. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
5428. /* Xinclude "..\Display\BannerSet.MyDc"X */
5429. /* pause(1) */
5430. 
5431. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
5432. 
5433. Title('!Heading!')
5434. /* pause(1) */
5435. 
5436. /* NOTE: Can't round or truncate to integer precision. */
5437. 
5438. pause(1)
5439. 
5440. 		# Script: ZoneDoFooter
5441. 
5442. /* ---------------------------------------------------------- */
5443. # File Select
5444. 	# Select Statments
5445. # File Actions 
5446. 	# Standard or OS File Actions.
5447. 	# Resume...
5448. 	
5449. 	# your stuff HERE (X)... post zone (file) file actions code.
5450. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
5451. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5452. 		# (X)
5453. 		
5454. 		/* ??? Set window? */
5455. 	
5456. 	# ADD THE GAP
5457. # Vacate (good for diagnostics)
5458. # DoNotVacate - DO NOT Vacate (recommended)
5459. # DoNotVacate - DO NOT Vacate (recommended)
5460. 
5461. # Vacate
5462. /* AddGap(GapUsedLoc) */
5463. 
5464. # DO Not Vacate
5465. AddGap(GapUsedLoc, DoNotVacate) 
5466. 	
5467. 	
5468. # Script: GapZoneCommand
5469. # *** Moved to setting yours ***
5470. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
5471. # Controlled via settings commands
5472. # DoNotVacate - DO NOT Vacate (recommended)
5473. 
5474. # Vacate
5475. /* AddGap(GapUsedLoc) */
5476. 
5477. # DO Not Vacate
5478. AddGap(GapUsedLoc, DoNotVacate) 
5479. 	
5480. 	
5481. # Vacate /* AddGap(GapUsed) */
5482. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
5483. 	
5484. 
5485. 		
5486. # 
5487. FileEnd
5488. /* ---------------------------------------------------------- */
5489. 
5490. # your stuff HERE (X)... post zone (file) code.
5491. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
5492. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5493. 	# (X)
5494. 
5495. SetVariable(FileStepDescription,"Zone finished, reporting.")
5496. # Script: DisplaySetFileStep
5497. 
5498. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5499. 
5500. /* add message and move to a new line. */
5501. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5502. ")
5503. 
5504. /* display the line. (hopefully.) */
5505. # Zone Footer Set Statistics Window Text
5506. 
5507. SetStatisticsWindowText("!Heading!
5508. ----------------------------------------------------------
5509. Zones Processed: 
5510. ----------------------------------------------------------
5511. !ZoneListByLine!
5512. ----------------------------------------------------------
5513. Zone Processing Step:
5514. !ZoneStepByLine!    
5515. ----------------------------------------------------------
5516. Current Zone:
5517. !ZoneFooter!
5518. ----------------------------------------------------------
5519. Volume Statistics:
5520. !VolumeStatisticsDetail!
5521. ----------------------------------------------------------
5522. Zone Detailed Report:
5523. ----------------------------------------------------------
5524. !ZoneStatisticsDetail!
5525. ----------------------------------------------------------
5526. ")
5527. 
5528. 
5529. 
5530. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5531. 
5532. # Script: BannerSet
5533. 
5534. # Script: DisplaySetDateTimeRun
5535. 
5536. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
5537. /* Xinclude "..\Display\BannerSet.MyDc"X */
5538. /* pause(1) */
5539. 
5540. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
5541. 
5542. Title('!Heading!')
5543. /* pause(1) */
5544. 
5545. /* NOTE: Can't round or truncate to integer precision. */
5546. 
5547. pause(1)
5548. 
5549. # Script: ZoneWhenFinished
5550. 
5551. # Script: BannerSet
5552. 
5553. # Script: DisplaySetDateTimeRun
5554. 
5555. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
5556. /* Xinclude "..\Display\BannerSet.MyDc"X */
5557. /* pause(1) */
5558. 
5559. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
5560. 
5561. Title('!Heading!')
5562. /* pause(1) */
5563. 
5564. /* NOTE: Can't round or truncate to integer precision. */
5565. 
5566. # Script: BannerLog
5567. 
5568. AppendLogfile("!LogFileName!", "!Title!")
5569. 
5570. 
5571. 
5572. # Zone Statistics	
5573. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
5574. 
5575. # Footer:
5576. SetVariable(ZoneFooter, "----------------------------------------------------------
5577. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:19
5578. 
5579. Statistics Report:
5580. ------------------
5581.    Size:  
5582.    ------------------------
5583.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5584.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5585.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5586. 
5587.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5588.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5589. 
5590.    Location:
5591.    ------------------------
5592.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5593.              Files End: !ZoneEndCurrent!
5594.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5595.       
5596.    Gap Settings:
5597.    ------------------------
5598.          Gap Requested: !ZoneGapSizePer!%
5599.       Volume Rounding: !ZoneVolRoundUpPer!%
5600.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5601.                  
5602.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
5603.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
5604.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
5605.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
5606.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
5607.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
5608.      
5609.    Free Space after Zone:
5610.    ------------------------
5611.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5612.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5613.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5614. 
5615. Directory and Files Select:
5616. ---------------------------
5617. !ZoneTypeSelectCurrent!               
5618. ---------------------------
5619. ----------------------------------------------------------
5620. ")
5621. 
5622. AppendLogfile("!LogFileName!", ".")
5623. AppendLogfile("!LogFileName!", "!ZoneFooter!")
5624. AppendLogfile("!LogFileName!", ".")
5625. 
5626. # Zone Footer Set Statistics Window Text
5627. 
5628. SetStatisticsWindowText("!Heading!
5629. ----------------------------------------------------------
5630. Zones Processed: 
5631. ----------------------------------------------------------
5632. !ZoneListByLine!
5633. ----------------------------------------------------------
5634. Zone Processing Step:
5635. !ZoneStepByLine!    
5636. ----------------------------------------------------------
5637. Current Zone:
5638. !ZoneFooter!
5639. ----------------------------------------------------------
5640. Volume Statistics:
5641. !VolumeStatisticsDetail!
5642. ----------------------------------------------------------
5643. Zone Detailed Report:
5644. ----------------------------------------------------------
5645. !ZoneStatisticsDetail!
5646. ----------------------------------------------------------
5647. ")
5648. 
5649. 
5650. 
5651. /* pause() */
5652. /* pause() */
5653. 
5654. 
5655. 
5656. 	
5657. /* ---------------------------------------------------------- */
5658. # Zone 2 of 2 ProgramHints Data.
5659. 	# Script: DisplayColors - Zone Dark
5660. # Processed
5661. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
5662. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
5663. 
5664. # Light Green and Yellow
5665. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
5666. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
5667. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
5668. 
5669. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHintsData!")
5670. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHintsData!")
5671. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
5672. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHints!")
5673. 	SetVariable(ZoneTypeSelect,'
5674.                 # ProgramHints - Data files.
5675.                 not(
5676.                      # Os PageHiberDump start.
5677. (
5678.   FileName("DataStore.edb")
5679.   or FileName("DUMP*.*")
5680.   or FileName("Hiberfil.sys")
5681.   or FileName("MEMORY.DMP")
5682.   or FileName("Pagefile.sys")
5683. )
5684. # Os PageHiberDump end.
5685. 
5686.                 )
5687. ')
5688. 
5689. 		# Script: ZoneDoHeader
5690. 
5691. # Script: ZoneWhenStarted
5692. 
5693. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
5694. # Script: DisplaySetZone
5695. 
5696. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
5697. SetVariable(FileStepDescription,	"")
5698. 
5699. SetVariable(ZoneStepByLine, 			"Zone started.
5700. ")
5701. 
5702. # Script: BannerDescriptionSet
5703. 
5704. # Script: BannerSet
5705. 
5706. # Script: DisplaySetDateTimeRun
5707. 
5708. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
5709. /* Xinclude "..\Display\BannerSet.MyDc"X */
5710. /* pause(1) */
5711. 
5712. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
5713. 
5714. Title('!Heading!')
5715. /* pause(1) */
5716. 
5717. /* NOTE: Can't round or truncate to integer precision. */
5718. 
5719. # Script: BannerLog
5720. 
5721. AppendLogfile("!LogFileName!", "!Title!")
5722. 
5723. 
5724. 
5725. pause(1)
5726. 
5727. 
5728. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
5729. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
5730. 
5731. SetVariable(ZoneStepNoCurrent, 0)
5732. 
5733. 
5734. # Script: ZoneDoCurrentClear
5735. 
5736. SetVariable(ZoneTypeSelectCurrent, 		"")
5737. 
5738. SetVariable(ZoneBeginCurrent, 			0)
5739. SetVariable(ZoneBeginPerCurrent, 		0)
5740. SetVariable(ZoneEndCurrent, 			0)
5741. SetVariable(ZoneEndPerCurrent, 			0)
5742. 
5743. SetVariable(ZoneSizeCurrent,			0)
5744. SetVariable(ZoneSizePerCurrent,			0)
5745. 
5746. SetVariable(ZoneGapRequestedCurrent,	0)
5747. SetVariable(ZoneGapRoundedCurrent, 		0)
5748. SetVariable(ZoneGapAdjustedCurrent, 	0)
5749. SetVariable(ZoneGapAvailableCurrent, 	0)
5750. SetVariable(ZoneGapCurrent,				0)
5751. SetVariable(ZoneGapUsedCurrent, 		0)
5752. 
5753. SetVariable(ZoneGapActualCurrent, 		0)
5754. SetVariable(ZoneGapActualPerCurrent, 	0)
5755. 
5756. SetVariable(ZoneSizeActual, 			0)
5757. SetVariable(ZoneSizeActualCurrent,		0)
5758. 
5759. SetVariable(ZoneEndActual, 				0)
5760. SetVariable(ZoneEndActualCurrent,		0)			
5761. SetVariable(ZoneSizeActualPerCurrent, 	0)
5762.       
5763. SetVariable(ZoneFilesFolders,			0)
5764. SetVariable(ZoneFilesFoldersPer,		0) 
5765. 
5766. SetVariable(ZoneFragments,				0)
5767. SetVariable(ZoneFragmentsPer,			0) 
5768. 		
5769. SetVariable(ZoneEndActualCurrent, 		0)
5770. SetVariable(ZoneEndActualPerCurrent, 	0)
5771. 
5772. # Gap Calculation Methodology:
5773. 	# Requested
5774. 	SetVariable(GapRequested, 			0) 
5775. 	SetVariable(GapRequestedStd, 		0) 
5776. 	SetVariable(GapRequestedMft, 		0) 
5777. 	SetVariable(GapRequestedOs, 		0) 
5778. 	SetVariable(GapRequestedOriginal, 	0) 
5779. 	
5780. 	# Gap Adjustments
5781. 	SetVariable(GapRounded, 			0)
5782. 	# SetVariable(GapAdjusted, 			0)
5783. 	SetVariable(GapAvailable, 			0)
5784. 	SetVariable(GapCurrent, 			0)
5785. 	SetVariable(GapActual, 				0)
5786. 	SetVariable(GapUsed, 				0)
5787. 	
5788. 	# Gap Adjustments
5789. 	SetVariable(GapRoundedLoc, 			0)
5790. 	# SetVariable(GapAdjustedLoc, 		0)
5791. 	SetVariable(GapAvailableLoc, 		0)
5792. 	SetVariable(GapCurrentLoc, 			0)
5793. 	SetVariable(GapActualLoc,			0)
5794. 	SetVariable(GapUsedLoc,				0)
5795. 	
5796. 	# Space usage
5797. 	SetVariable(ZoneFreePerRequested, 	0)
5798. 	SetVariable(ZoneFreePerUsed, 		0)
5799. 
5800. # Gap Size & Rounding
5801. 	SetVariable(ZoneGapSizePer, 		0)
5802. 	SetVariable(ZoneVolRoundUpPer, 		0)
5803. 	
5804. 	# Free Space
5805. 	SetVariable(ZoneFreeUsedPer, 		0)
5806. 	SetVariable(ZoneFreeRequestedPer, 	0)
5807. 
5808. 
5809. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
5810. 
5811. # Footer:
5812. SetVariable(ZoneFooter, "----------------------------------------------------------
5813. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:19
5814. 
5815. Statistics Report:
5816. ------------------
5817.    Size:  
5818.    ------------------------
5819.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5820.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5821.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5822. 
5823.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5824.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5825. 
5826.    Location:
5827.    ------------------------
5828.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5829.              Files End: !ZoneEndCurrent!
5830.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5831.       
5832.    Gap Settings:
5833.    ------------------------
5834.          Gap Requested: !ZoneGapSizePer!%
5835.       Volume Rounding: !ZoneVolRoundUpPer!%
5836.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5837.                  
5838.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
5839.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
5840.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
5841.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
5842.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
5843.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
5844.      
5845.    Free Space after Zone:
5846.    ------------------------
5847.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5848.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5849.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5850. 
5851. Directory and Files Select:
5852. ---------------------------
5853. !ZoneTypeSelectCurrent!               
5854. ---------------------------
5855. ----------------------------------------------------------
5856. ")
5857. 
5858. # Script: BannerSet
5859. 
5860. # Script: DisplaySetDateTimeRun
5861. 
5862. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
5863. /* Xinclude "..\Display\BannerSet.MyDc"X */
5864. /* pause(1) */
5865. 
5866. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
5867. 
5868. Title('!Heading!')
5869. /* pause(1) */
5870. 
5871. /* NOTE: Can't round or truncate to integer precision. */
5872. 
5873. # Script: BannerLog
5874. 
5875. AppendLogfile("!LogFileName!", "!Title!")
5876. 
5877. 
5878. 
5879. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
5880. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
5881. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:19")
5882. 
5883. SetVariable(ZoneListByLine, "!ZoneListByLine!
5884. Zone: !ZoneNoCurrent! 2021-11-13 20:31:19 0:00:02 !ZoneLabel! !ZoneDescription!")
5885. 
5886. 
5887. /* Fixed Zone Position Handling */
5888. /* Literal number: */
5889. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
5890. /* Percentage of disk: */
5891. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
5892. /* Gap */
5893. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
5894. 
5895. /* ---------------------------------------------------------- */
5896. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
5897. # Script: DisplaySetFileStep
5898. 
5899. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5900. 
5901. /* add message and move to a new line. */
5902. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5903. ")
5904. 
5905. /* display the line. (hopefully.) */
5906. # Zone Footer Set Statistics Window Text
5907. 
5908. SetStatisticsWindowText("!Heading!
5909. ----------------------------------------------------------
5910. Zones Processed: 
5911. ----------------------------------------------------------
5912. !ZoneListByLine!
5913. ----------------------------------------------------------
5914. Zone Processing Step:
5915. !ZoneStepByLine!    
5916. ----------------------------------------------------------
5917. Current Zone:
5918. !ZoneFooter!
5919. ----------------------------------------------------------
5920. Volume Statistics:
5921. !VolumeStatisticsDetail!
5922. ----------------------------------------------------------
5923. Zone Detailed Report:
5924. ----------------------------------------------------------
5925. !ZoneStatisticsDetail!
5926. ----------------------------------------------------------
5927. ")
5928. 
5929. 
5930. 
5931. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5932. 
5933. # Script: BannerSet
5934. 
5935. # Script: DisplaySetDateTimeRun
5936. 
5937. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
5938. /* Xinclude "..\Display\BannerSet.MyDc"X */
5939. /* pause(1) */
5940. 
5941. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
5942. 
5943. Title('!Heading!')
5944. /* pause(1) */
5945. 
5946. /* NOTE: Can't round or truncate to integer precision. */
5947. 
5948. pause(1)
5949. 
5950. # your stuff HERE (X)... pre file select code.
5951. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
5952. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5953. 	# (X)
5954. 
5955. FileSelect
5956. 
5957. 	# your stuff can't really go here (errors.)
5958. 	# maybe for some reason I don't know of...
5959. 	
5960. 	# Actions next...
5961. 		# Script: ZoneDo ZoneTypeSelectOsProgramHints
5962. # ProgramHints start.
5963. ImportListFromProgramHints("*.pf")
5964. # ProgramHints end.
5965. 
5966. 		and not(
5967. 			# Os PageHiberDump start.
5968. (
5969.   FileName("DataStore.edb")
5970.   or FileName("DUMP*.*")
5971.   or FileName("Hiberfil.sys")
5972.   or FileName("MEMORY.DMP")
5973.   or FileName("Pagefile.sys")
5974. )
5975. # Os PageHiberDump end.
5976. 
5977. 		)
5978. 		
5979. 		FileActions
5980. 		  		/* ---------------------------------------------------------- */
5981. 	# Gap
5982. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
5983. 		# Script: DisplaySetFileStep
5984. 
5985. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5986. 
5987. /* add message and move to a new line. */
5988. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5989. ")
5990. 
5991. /* display the line. (hopefully.) */
5992. # Zone Footer Set Statistics Window Text
5993. 
5994. SetStatisticsWindowText("!Heading!
5995. ----------------------------------------------------------
5996. Zones Processed: 
5997. ----------------------------------------------------------
5998. !ZoneListByLine!
5999. ----------------------------------------------------------
6000. Zone Processing Step:
6001. !ZoneStepByLine!    
6002. ----------------------------------------------------------
6003. Current Zone:
6004. !ZoneFooter!
6005. ----------------------------------------------------------
6006. Volume Statistics:
6007. !VolumeStatisticsDetail!
6008. ----------------------------------------------------------
6009. Zone Detailed Report:
6010. ----------------------------------------------------------
6011. !ZoneStatisticsDetail!
6012. ----------------------------------------------------------
6013. ")
6014. 
6015. 
6016. 
6017. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6018. 
6019. # Script: BannerSet
6020. 
6021. # Script: DisplaySetDateTimeRun
6022. 
6023. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
6024. /* Xinclude "..\Display\BannerSet.MyDc"X */
6025. /* pause(1) */
6026. 
6027. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
6028. 
6029. Title('!Heading!')
6030. /* pause(1) */
6031. 
6032. /* NOTE: Can't round or truncate to integer precision. */
6033. 
6034. pause(1)
6035. 	
6036. 	# ACTUAL GAP
6037. 		/* AddGap Variant. */
6038. 	  	# Zone Do Gap
6039. # Gap Calculation Methods:
6040. 
6041. /* 1) Anything you need to add first. */
6042. /* empty */
6043. 
6044. /* ---------------------------------------------------------- */
6045. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
6046. 	# GapRequestedStd.
6047. 
6048. 		/* ---------------------------------------------------------- */
6049. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
6050. 
6051. 		# Gap Calculation Methods:
6052. 
6053. /* AddGap Variants */
6054. 
6055. 	/* Standard */
6056. 		# Gap Calculation Methods:
6057. 	/* AddGap Variants */
6058. 	/* Standard */
6059. 
6060. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
6061. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
6062. 
6063. 	SetVariable(GapRequested, GapRequestedStd)
6064. 	
6065. 
6066. 	/* MFT Low High Method */
6067. 		# Gap Calculation Methods:
6068. 	/* AddGap Variants */
6069. 	/* MFT Low High Method */
6070. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
6071. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
6072. 	SetVariable(GapRequested, GapRequestedMft)
6073. 	
6074. 
6075. 	/* OS Volume Type Method */
6076. 		# Gap Calculation Methods:
6077. 	/* AddGap Variants */
6078. 	/* OS Volume Type Method */
6079. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
6080. 	SetVariable(GapRequested, GapRequestedOs)
6081. 
6082. 
6083. 
6084. /* MakeGap Variants */
6085. 
6086. 	/* Original Os 1-3 + MFT 2 */
6087. 		# Gap Calculation Methods:
6088. 	/* MakeGap Variants */
6089. 	/* Original Os 1-3 + MFT 2 */
6090. 	/* plus MFT gap placed inline at the dividing zone. */
6091. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
6092. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
6093. 	SetVariable(GapRequested, GapRequestedOrig)
6094. 	
6095. 	
6096. /* Note: You could comment out the ones not in use */
6097. /* However having the data in the log is useful. */
6098. /* Therefore the following line is otherwise needed. */
6099. 
6100. /* Standard used */
6101. 
6102. SetVariable(GapRequested, GapRequestedStd)
6103. 
6104. # Gap Calculation Methods:
6105. 
6106. /* AddGap Variants */
6107. 	/* Standard */
6108. 	/* MFT Low High Method */
6109. 	/* OS Volume Type Method */
6110. 
6111. /* MakeGap Variants */
6112. 	/* Original Os 1-3 + MFT 2 */
6113. 
6114. /* Note: You could comment out the ones not in use */
6115. /* However having the data in the log is useful. */
6116. /* Therefore the following line is otherwise needed. */
6117. 
6118. /* Standard is used currently */
6119. 
6120. 
6121. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
6122. 
6123. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
6124. 
6125. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
6126. 
6127. /* ---------------------------------------------------------- */
6128. /* 3) SMALL ZONE ADJUSTMENT. */
6129. /* Gab cant be larger than half the Zone Size. */
6130. 
6131. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
6132. 	
6133. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
6134. 
6135. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
6136. 
6137. /* ---------------------------------------------------------- */
6138. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
6139. # Gap Adjustments.
6140. 
6141. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
6142. 	
6143. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
6144. 
6145. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
6146. 
6147. /* ---------------------------------------------------------- */
6148. # BYPASS THIS.
6149. 	/* This is definitely wrong. */
6150. 	/* The question is can we steal gap from the next zone */
6151. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
6152. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
6153. 		# Zone Overflow.
6154. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
6155. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
6156. 
6157. /* ---------------------------------------------------------- */
6158. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
6159. # Remaining free space available.
6160. 
6161. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
6162. 	
6163. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
6164. 
6165. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
6166. 
6167. /* ---------------------------------------------------------- */
6168. # CURRENT gap to use.
6169. 
6170. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
6171. 
6172. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
6173. 
6174. /* ---------------------------------------------------------- */
6175. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
6176. # Debugging.
6177. 
6178. 	SetVariable(GapUsed, GapCurrent) // for debugging
6179. 
6180. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
6181. 
6182. 		# Your code HERE
6183. 
6184. /* ---------------------------------------------------------- */
6185. /* 7) YOUR CODE. */
6186. # YOUR CODE HERE:
6187. 	# INPUT: GapCurrent or GapCurrentLoc
6188. 	# OUTPUT: GapUsed...
6189. 
6190. /* ---------------------------------------------------------- */
6191. # Gap Size.
6192. # Actual Size of Gap.
6193. 
6194. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
6195. 
6196. /* ---------------------------------------------------------- */
6197. /* xxxxxxxxxxxxxxxxxxxxxx */
6198. # ADD THE GAP
6199. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
6200. /* xxxxxxxxxxxxxxxxxxxxxx */
6201. 
6202. 	
6203. 	# Zone Statistics	
6204. 	# Script: ZoneDoStatistics
6205. # Zone / Volume Statistics and Display
6206. 		
6207. 	# Accumulate Totals
6208.   	# Script: ZoneDoVolumeTotals
6209. 
6210. /* Current total space used (by Zones and Gaps) */
6211. 
6212. SetVariable(VolumeZoneUsed, GapUsed)
6213. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
6214. /* Percentage */
6215. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
6216. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
6217. 
6218. /* Current total of free space requested */
6219. 
6220. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
6221. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6222. /* Percent. */
6223. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
6224. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6225. 
6226. /* Current total of free space used */
6227. 
6228. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
6229. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
6230. /* Percent */
6231. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
6232. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
6233. 
6234. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
6235. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
6236. /* Xinclude "..\DebugDisplayPause.MyDc"X */
6237. 
6238. 
6239. 	# Current Values
6240. 	# Script: ZoneDoCurrentSet
6241. 
6242. # Cluster, Sector, Block adjust for display.
6243. 	# Bytes per cluster is volume specific.
6244. 
6245. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
6246. 
6247. # Current Zone values.
6248. 	# Begin, end and size.
6249. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
6250. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
6251. 
6252. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
6253. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
6254. 
6255. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
6256. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
6257. 
6258. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
6259. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
6260. 
6261. 	SetVariable(ZoneFragments,				"!ZONE210N!")
6262. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
6263. 		
6264. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
6265. /* identical code to here: (separation not needed. TEST.) */	
6266. 
6267. # Current Gap, Actual and Free Values
6268. 	# Gap
6269. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
6270. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
6271. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
6272. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
6273. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
6274. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
6275. 	
6276. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
6277. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
6278. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
6279. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
6280. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
6281. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
6282. 	
6283. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
6284. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
6285. 	
6286. 	# Actual Size and End
6287. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
6288. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
6289. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
6290. 	
6291. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
6292. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
6293. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
6294. 
6295. # Gap Size & Rounding
6296. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
6297. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
6298. 	
6299. 	# Free Space
6300. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
6301. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
6302. 
6303. 	# Footer:
6304. SetVariable(ZoneFooter, "----------------------------------------------------------
6305. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:19
6306. 
6307. Statistics Report:
6308. ------------------
6309.    Size:  
6310.    ------------------------
6311.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6312.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6313.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6314. 
6315.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6316.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6317. 
6318.    Location:
6319.    ------------------------
6320.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6321.              Files End: !ZoneEndCurrent!
6322.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6323.       
6324.    Gap Settings:
6325.    ------------------------
6326.          Gap Requested: !ZoneGapSizePer!%
6327.       Volume Rounding: !ZoneVolRoundUpPer!%
6328.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6329.                  
6330.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
6331.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
6332.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
6333.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
6334.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
6335.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
6336.      
6337.    Free Space after Zone:
6338.    ------------------------
6339.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6340.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6341.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6342. 
6343. Directory and Files Select:
6344. ---------------------------
6345. !ZoneTypeSelectCurrent!               
6346. ---------------------------
6347. ----------------------------------------------------------
6348. ")
6349. 	# Zone Footer Set Statistics Window Text
6350. 
6351. SetStatisticsWindowText("!Heading!
6352. ----------------------------------------------------------
6353. Zones Processed: 
6354. ----------------------------------------------------------
6355. !ZoneListByLine!
6356. ----------------------------------------------------------
6357. Zone Processing Step:
6358. !ZoneStepByLine!    
6359. ----------------------------------------------------------
6360. Current Zone:
6361. !ZoneFooter!
6362. ----------------------------------------------------------
6363. Volume Statistics:
6364. !VolumeStatisticsDetail!
6365. ----------------------------------------------------------
6366. Zone Detailed Report:
6367. ----------------------------------------------------------
6368. !ZoneStatisticsDetail!
6369. ----------------------------------------------------------
6370. ")
6371. 
6372. 
6373. 	
6374.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
6375. 
6376. 	# Add Zone to list of zones for display.
6377. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
6378. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
6379. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
6380. 	# ??? Free Stats?
6381. 	# Footer:
6382. SetVariable(ZoneFooter, "----------------------------------------------------------
6383. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:19
6384. 
6385. Statistics Report:
6386. ------------------
6387.    Size:  
6388.    ------------------------
6389.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6390.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6391.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6392. 
6393.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6394.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6395. 
6396.    Location:
6397.    ------------------------
6398.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6399.              Files End: !ZoneEndCurrent!
6400.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6401.       
6402.    Gap Settings:
6403.    ------------------------
6404.          Gap Requested: !ZoneGapSizePer!%
6405.       Volume Rounding: !ZoneVolRoundUpPer!%
6406.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6407.                  
6408.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
6409.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
6410.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
6411.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
6412.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
6413.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
6414.      
6415.    Free Space after Zone:
6416.    ------------------------
6417.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6418.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6419.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6420. 
6421. Directory and Files Select:
6422. ---------------------------
6423. !ZoneTypeSelectCurrent!               
6424. ---------------------------
6425. ----------------------------------------------------------
6426. ")
6427. 
6428. 	# Add Zone Details to Report.	
6429. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
6430. !ZoneFooter!")
6431. 
6432. 
6433. 	
6434. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
6435. 			# Script: DisplaySetFileStep
6436. 
6437. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6438. 
6439. /* add message and move to a new line. */
6440. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6441. ")
6442. 
6443. /* display the line. (hopefully.) */
6444. # Zone Footer Set Statistics Window Text
6445. 
6446. SetStatisticsWindowText("!Heading!
6447. ----------------------------------------------------------
6448. Zones Processed: 
6449. ----------------------------------------------------------
6450. !ZoneListByLine!
6451. ----------------------------------------------------------
6452. Zone Processing Step:
6453. !ZoneStepByLine!    
6454. ----------------------------------------------------------
6455. Current Zone:
6456. !ZoneFooter!
6457. ----------------------------------------------------------
6458. Volume Statistics:
6459. !VolumeStatisticsDetail!
6460. ----------------------------------------------------------
6461. Zone Detailed Report:
6462. ----------------------------------------------------------
6463. !ZoneStatisticsDetail!
6464. ----------------------------------------------------------
6465. ")
6466. 
6467. 
6468. 
6469. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6470. 
6471. # Script: BannerSet
6472. 
6473. # Script: DisplaySetDateTimeRun
6474. 
6475. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
6476. /* Xinclude "..\Display\BannerSet.MyDc"X */
6477. /* pause(1) */
6478. 
6479. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
6480. 
6481. Title('!Heading!')
6482. /* pause(1) */
6483. 
6484. /* NOTE: Can't round or truncate to integer precision. */
6485. 
6486. pause(1)
6487. 
6488. 			# File Action - Type Os Program Hints Data - Regular - ImportSeq.
6489. # File Action - SortByImportSequence.
6490. SortByImportSequence(Ascending ) 
6491. 	
6492. 	
6493. 	
6494. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
6495. 			# Script: DisplaySetFileStep
6496. 
6497. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6498. 
6499. /* add message and move to a new line. */
6500. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6501. ")
6502. 
6503. /* display the line. (hopefully.) */
6504. # Zone Footer Set Statistics Window Text
6505. 
6506. SetStatisticsWindowText("!Heading!
6507. ----------------------------------------------------------
6508. Zones Processed: 
6509. ----------------------------------------------------------
6510. !ZoneListByLine!
6511. ----------------------------------------------------------
6512. Zone Processing Step:
6513. !ZoneStepByLine!    
6514. ----------------------------------------------------------
6515. Current Zone:
6516. !ZoneFooter!
6517. ----------------------------------------------------------
6518. Volume Statistics:
6519. !VolumeStatisticsDetail!
6520. ----------------------------------------------------------
6521. Zone Detailed Report:
6522. ----------------------------------------------------------
6523. !ZoneStatisticsDetail!
6524. ----------------------------------------------------------
6525. ")
6526. 
6527. 
6528. 
6529. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6530. 
6531. # Script: BannerSet
6532. 
6533. # Script: DisplaySetDateTimeRun
6534. 
6535. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
6536. /* Xinclude "..\Display\BannerSet.MyDc"X */
6537. /* pause(1) */
6538. 
6539. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
6540. 
6541. Title('!Heading!')
6542. /* pause(1) */
6543. 
6544. /* NOTE: Can't round or truncate to integer precision. */
6545. 
6546. pause(1)
6547. 
6548. 		# Script: ZoneDoFooter
6549. 
6550. /* ---------------------------------------------------------- */
6551. # File Select
6552. 	# Select Statments
6553. # File Actions 
6554. 	# Standard or OS File Actions.
6555. 	# Resume...
6556. 	
6557. 	# your stuff HERE (X)... post zone (file) file actions code.
6558. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
6559. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
6560. 		# (X)
6561. 		
6562. 		/* ??? Set window? */
6563. 	
6564. 	# ADD THE GAP
6565. # Vacate (good for diagnostics)
6566. # DoNotVacate - DO NOT Vacate (recommended)
6567. # DoNotVacate - DO NOT Vacate (recommended)
6568. 
6569. # Vacate
6570. /* AddGap(GapUsedLoc) */
6571. 
6572. # DO Not Vacate
6573. AddGap(GapUsedLoc, DoNotVacate) 
6574. 	
6575. 	
6576. # Script: GapZoneCommand
6577. # *** Moved to setting yours ***
6578. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
6579. # Controlled via settings commands
6580. # DoNotVacate - DO NOT Vacate (recommended)
6581. 
6582. # Vacate
6583. /* AddGap(GapUsedLoc) */
6584. 
6585. # DO Not Vacate
6586. AddGap(GapUsedLoc, DoNotVacate) 
6587. 	
6588. 	
6589. # Vacate /* AddGap(GapUsed) */
6590. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
6591. 	
6592. 
6593. 		
6594. # 
6595. FileEnd
6596. /* ---------------------------------------------------------- */
6597. 
6598. # your stuff HERE (X)... post zone (file) code.
6599. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
6600. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
6601. 	# (X)
6602. 
6603. SetVariable(FileStepDescription,"Zone finished, reporting.")
6604. # Script: DisplaySetFileStep
6605. 
6606. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6607. 
6608. /* add message and move to a new line. */
6609. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6610. ")
6611. 
6612. /* display the line. (hopefully.) */
6613. # Zone Footer Set Statistics Window Text
6614. 
6615. SetStatisticsWindowText("!Heading!
6616. ----------------------------------------------------------
6617. Zones Processed: 
6618. ----------------------------------------------------------
6619. !ZoneListByLine!
6620. ----------------------------------------------------------
6621. Zone Processing Step:
6622. !ZoneStepByLine!    
6623. ----------------------------------------------------------
6624. Current Zone:
6625. !ZoneFooter!
6626. ----------------------------------------------------------
6627. Volume Statistics:
6628. !VolumeStatisticsDetail!
6629. ----------------------------------------------------------
6630. Zone Detailed Report:
6631. ----------------------------------------------------------
6632. !ZoneStatisticsDetail!
6633. ----------------------------------------------------------
6634. ")
6635. 
6636. 
6637. 
6638. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6639. 
6640. # Script: BannerSet
6641. 
6642. # Script: DisplaySetDateTimeRun
6643. 
6644. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
6645. /* Xinclude "..\Display\BannerSet.MyDc"X */
6646. /* pause(1) */
6647. 
6648. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
6649. 
6650. Title('!Heading!')
6651. /* pause(1) */
6652. 
6653. /* NOTE: Can't round or truncate to integer precision. */
6654. 
6655. pause(1)
6656. 
6657. # Script: ZoneWhenFinished
6658. 
6659. # Script: BannerSet
6660. 
6661. # Script: DisplaySetDateTimeRun
6662. 
6663. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
6664. /* Xinclude "..\Display\BannerSet.MyDc"X */
6665. /* pause(1) */
6666. 
6667. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
6668. 
6669. Title('!Heading!')
6670. /* pause(1) */
6671. 
6672. /* NOTE: Can't round or truncate to integer precision. */
6673. 
6674. # Script: BannerLog
6675. 
6676. AppendLogfile("!LogFileName!", "!Title!")
6677. 
6678. 
6679. 
6680. # Zone Statistics	
6681. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
6682. 
6683. # Footer:
6684. SetVariable(ZoneFooter, "----------------------------------------------------------
6685. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:19
6686. 
6687. Statistics Report:
6688. ------------------
6689.    Size:  
6690.    ------------------------
6691.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6692.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6693.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6694. 
6695.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6696.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6697. 
6698.    Location:
6699.    ------------------------
6700.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6701.              Files End: !ZoneEndCurrent!
6702.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6703.       
6704.    Gap Settings:
6705.    ------------------------
6706.          Gap Requested: !ZoneGapSizePer!%
6707.       Volume Rounding: !ZoneVolRoundUpPer!%
6708.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6709.                  
6710.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
6711.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
6712.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
6713.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
6714.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
6715.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
6716.      
6717.    Free Space after Zone:
6718.    ------------------------
6719.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6720.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6721.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6722. 
6723. Directory and Files Select:
6724. ---------------------------
6725. !ZoneTypeSelectCurrent!               
6726. ---------------------------
6727. ----------------------------------------------------------
6728. ")
6729. 
6730. AppendLogfile("!LogFileName!", ".")
6731. AppendLogfile("!LogFileName!", "!ZoneFooter!")
6732. AppendLogfile("!LogFileName!", ".")
6733. 
6734. # Zone Footer Set Statistics Window Text
6735. 
6736. SetStatisticsWindowText("!Heading!
6737. ----------------------------------------------------------
6738. Zones Processed: 
6739. ----------------------------------------------------------
6740. !ZoneListByLine!
6741. ----------------------------------------------------------
6742. Zone Processing Step:
6743. !ZoneStepByLine!    
6744. ----------------------------------------------------------
6745. Current Zone:
6746. !ZoneFooter!
6747. ----------------------------------------------------------
6748. Volume Statistics:
6749. !VolumeStatisticsDetail!
6750. ----------------------------------------------------------
6751. Zone Detailed Report:
6752. ----------------------------------------------------------
6753. !ZoneStatisticsDetail!
6754. ----------------------------------------------------------
6755. ")
6756. 
6757. 
6758. 
6759. /* pause() */
6760. /* pause() */
6761. 
6762. 
6763. 
6764. 	
6765. /* ---------------------------------------------------------- */
6766. 
6767. 
6768. /* ---------------------------------------------------------- */
6769. # Zone Programs Fixed size but not windows..
6770. # Os Group Zone 5d Fixed, 6l Fixed Windows, 7l Fixed Data
6771. # Script: DefragZoneTypeOsPrograms
6772. /* ---------------------------------------------------------- */
6773. # Zone Programs Fixed size but not windows..
6774. 	# Script: DisplayColors - Zone Dark
6775. # Processed
6776. SetFileColor(All, Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
6777. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
6778. 
6779. # Light Green and Yellow
6780. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
6781. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
6782. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
6783. 
6784. 	SetVariable(ZoneLabel, 			"!ZoneLabelPrograms!")
6785. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPrograms!")
6786. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
6787. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
6788. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsPrograms
6789. # Programs start.
6790. # NotBlobsArchivesBu start.
6791. (not (
6792. # Blobs start.
6793. (
6794. # BlobsAndExceptions start.
6795. ( not(
6796.   FileName("*.bat")
6797.   or FileName("*.css")
6798.   or FileName("*.dll")
6799.   or FileName("*.exe")
6800.   or FileName("*.htm*")
6801.   or FileName("*.jar")
6802.   or FileName("*.js")
6803.   or FileName("*.script")
6804.   or FileName("*.wsf")
6805.   or (
6806. # Databases start.
6807. (
6808.   FileName("*.crypt*")
6809.   or FileName("*.db*")
6810.   or FileName("*.rdb*")
6811.   or FileName("*.dc*")
6812.   or FileName("*.dict*")
6813.   or FileName("*.?db*")
6814.   or FileName("*.?rdb*")
6815.   or FileName("*.md*")
6816.   or FileName("*.myd")
6817.   or FileName("*.ndf")
6818.   or FileName("*.ns?")
6819.   or FileName("*.pab")
6820.   or FileName("*.pst")
6821.   or FileName("*.sd?*")
6822.   or FileName("*.sq**")
6823.   or FileName("*.tmd")
6824.   or FileName("*.tps")
6825.   or FileName("*.tr*")
6826. )
6827. # Databases end.
6828. 
6829.     # BlobsAndExceptions
6830.     or 
6831. # Data start.
6832. (
6833.   DirectoryName("Data*")
6834.   or DirectoryName("Device*")
6835.   or DirectoryName("Export*")
6836.   or DirectoryName("Import*")
6837.   or DirectoryName("Log*")
6838.   or DirectoryName("*Log")
6839.   or DirectoryName("Maintenance*")
6840.   or DirectoryName("Rec*")
6841.   or DirectoryName("Sales*")
6842.   or DirectoryName("Search*")
6843.   or DirectoryName("User*")
6844. )
6845. # Data end.
6846. 
6847.     # BlobsAndExceptions
6848.   )
6849. ) )
6850. # BlobsAndExceptions end.
6851. 
6852. # Blobs
6853. ) and (
6854.   Size(BlobFileSize,0)
6855.   or (
6856.     FileName("*.arj")
6857.     or FileName("*.bup")
6858.     or FileName("*.bz2")
6859.     or FileName("*.chm")
6860.     or FileName("*.dvr-ms")
6861.     or FileName("*.gz")
6862.     or FileName("*.ifo")
6863.     or FileName("*.lzh")
6864.     or FileName("*.pdf")
6865.     or FileName("*.rpm")
6866.     or FileName("*.wmv")
6867.     or FileName("*.vob")
6868.     or FileName("*.z")
6869.   ) 
6870. )
6871. # Blobs end.
6872. 
6873. # NotBlobsArchivesBu
6874. or 
6875. # Archives start.
6876. (
6877.   DirectoryName("*Archive*")
6878.   or DirectoryName("*History*")
6879.   or DirectoryName("*Old")
6880.   or DirectoryName("* Old *")
6881.   or DirectoryName("Old *")
6882. 
6883.   or FileName("*.7z")
6884.   or FileName("*.cab")
6885.   or FileName("*.iso")
6886.   or FileName("*.msi")
6887.   or FileName("*.old")
6888.   or FileName("*.rar")
6889.   or FileName("*.tar")
6890.   or FileName("*.zip")
6891.   or
6892. # WinSysLow start.
6893. (
6894.   DirectoryName("$*")
6895.   or DirectoryName("0*")
6896.   or DirectoryName("1*")
6897.   or DirectoryName("2*")
6898.   or DirectoryName("3*")
6899.   or DirectoryName("4*")
6900.   or DirectoryName("5*")
6901.   or DirectoryName("6*")
6902.   or DirectoryName("7*")
6903.   or DirectoryName("8*")
6904.   or DirectoryName("9*")
6905. 
6906.   or DirectoryName("dllcache")
6907.   or DirectoryName("Downloaded Installations")
6908.   or DirectoryName("Ehome")
6909.   or DirectoryName("Fonts")
6910.   or DirectoryName("Help")
6911.   or DirectoryName("I386")
6912.   or DirectoryName("ie?updates")
6913.   or DirectoryName("Installer")
6914.   or DirectoryName("Installshield Installation Information")
6915.   or DirectoryName("IME")
6916.   or DirectoryName("*RECYCLE*")
6917.   or DirectoryName("ServicePackFiles")
6918.   or DirectoryName("SoftwareDistribution")
6919.   or DirectoryName("Speech")
6920.   or DirectoryName("Symbols")
6921.   or DirectoryName("System Volume Information")
6922.   or DirectoryName("windows.old")
6923. )
6924. # WinSysLow end.
6925. 
6926.   # Archives
6927. )
6928. # Archives end.
6929. 
6930. # NotBlobsArchivesBu
6931. or
6932. # Backups start.
6933. (
6934.   DirectoryName("*Backup*")
6935.   or DirectoryName("*Bu")
6936.   or DirectoryName("* Bu *")
6937.   or DirectoryName("Bu *")
6938. 
6939.   or FileName("*.bak")
6940.   or FileName("* - Copy*")
6941. )
6942. # Backups end.
6943. 
6944. # NotBlobsArchivesBu
6945. ) )
6946. # NotBlobsArchivesBu end.
6947. 
6948. # Programs
6949. and (
6950. # SystemDir start.
6951. (
6952.   DirectoryName("Boot*")
6953.   or DirectoryName("Device*")
6954.   or DirectoryName("DevSupport*")
6955.   or DirectoryName("Program*")
6956.   or DirectoryName("Security*")
6957.   or DirectoryName("SendTo*")
6958.   or DirectoryName("Sw*")
6959.   or DirectoryName("System*")
6960.   or DirectoryName("Toolbars")
6961.   or DirectoryName("Windows*")
6962. )
6963. # SystemDir end.
6964. 
6965. # Programs
6966. )
6967. # Programs end.
6968. 
6969.                 and not(
6970.                      # Script: ZoneDo ZoneTypeSelectOsDataDynamic
6971. # Os Data Dynamic start.
6972. (
6973. # Os Data Dynamic start.
6974. (
6975.   FileName("*.dat*")
6976.   or FileName("*.db*")
6977.   or FileName("*.edb*")
6978.   or FileName("*.log*")
6979.   or FileName("DataStore.edb")
6980. )
6981. # Os Data Dynamic end.
6982. 
6983.   or 
6984. # Os PageHiberDump start.
6985. (
6986.   FileName("DataStore.edb")
6987.   or FileName("DUMP*.*")
6988.   or FileName("Hiberfil.sys")
6989.   or FileName("MEMORY.DMP")
6990.   or FileName("Pagefile.sys")
6991. )
6992. # Os PageHiberDump end.
6993. 
6994. # Os Data Dynamic
6995. )
6996. # Os Data Dynamic end.
6997. 
6998.                      or 
6999.                      DirectoryName("Windows*")
7000.                 )
7001. ')
7002. 
7003. 		# Script: ZoneDoHeader
7004. 
7005. # Script: ZoneWhenStarted
7006. 
7007. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
7008. # Script: DisplaySetZone
7009. 
7010. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
7011. SetVariable(FileStepDescription,	"")
7012. 
7013. SetVariable(ZoneStepByLine, 			"Zone started.
7014. ")
7015. 
7016. # Script: BannerDescriptionSet
7017. 
7018. # Script: BannerSet
7019. 
7020. # Script: DisplaySetDateTimeRun
7021. 
7022. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
7023. /* Xinclude "..\Display\BannerSet.MyDc"X */
7024. /* pause(1) */
7025. 
7026. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
7027. 
7028. Title('!Heading!')
7029. /* pause(1) */
7030. 
7031. /* NOTE: Can't round or truncate to integer precision. */
7032. 
7033. # Script: BannerLog
7034. 
7035. AppendLogfile("!LogFileName!", "!Title!")
7036. 
7037. 
7038. 
7039. pause(1)
7040. 
7041. 
7042. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
7043. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
7044. 
7045. SetVariable(ZoneStepNoCurrent, 0)
7046. 
7047. 
7048. # Script: ZoneDoCurrentClear
7049. 
7050. SetVariable(ZoneTypeSelectCurrent, 		"")
7051. 
7052. SetVariable(ZoneBeginCurrent, 			0)
7053. SetVariable(ZoneBeginPerCurrent, 		0)
7054. SetVariable(ZoneEndCurrent, 			0)
7055. SetVariable(ZoneEndPerCurrent, 			0)
7056. 
7057. SetVariable(ZoneSizeCurrent,			0)
7058. SetVariable(ZoneSizePerCurrent,			0)
7059. 
7060. SetVariable(ZoneGapRequestedCurrent,	0)
7061. SetVariable(ZoneGapRoundedCurrent, 		0)
7062. SetVariable(ZoneGapAdjustedCurrent, 	0)
7063. SetVariable(ZoneGapAvailableCurrent, 	0)
7064. SetVariable(ZoneGapCurrent,				0)
7065. SetVariable(ZoneGapUsedCurrent, 		0)
7066. 
7067. SetVariable(ZoneGapActualCurrent, 		0)
7068. SetVariable(ZoneGapActualPerCurrent, 	0)
7069. 
7070. SetVariable(ZoneSizeActual, 			0)
7071. SetVariable(ZoneSizeActualCurrent,		0)
7072. 
7073. SetVariable(ZoneEndActual, 				0)
7074. SetVariable(ZoneEndActualCurrent,		0)			
7075. SetVariable(ZoneSizeActualPerCurrent, 	0)
7076.       
7077. SetVariable(ZoneFilesFolders,			0)
7078. SetVariable(ZoneFilesFoldersPer,		0) 
7079. 
7080. SetVariable(ZoneFragments,				0)
7081. SetVariable(ZoneFragmentsPer,			0) 
7082. 		
7083. SetVariable(ZoneEndActualCurrent, 		0)
7084. SetVariable(ZoneEndActualPerCurrent, 	0)
7085. 
7086. # Gap Calculation Methodology:
7087. 	# Requested
7088. 	SetVariable(GapRequested, 			0) 
7089. 	SetVariable(GapRequestedStd, 		0) 
7090. 	SetVariable(GapRequestedMft, 		0) 
7091. 	SetVariable(GapRequestedOs, 		0) 
7092. 	SetVariable(GapRequestedOriginal, 	0) 
7093. 	
7094. 	# Gap Adjustments
7095. 	SetVariable(GapRounded, 			0)
7096. 	# SetVariable(GapAdjusted, 			0)
7097. 	SetVariable(GapAvailable, 			0)
7098. 	SetVariable(GapCurrent, 			0)
7099. 	SetVariable(GapActual, 				0)
7100. 	SetVariable(GapUsed, 				0)
7101. 	
7102. 	# Gap Adjustments
7103. 	SetVariable(GapRoundedLoc, 			0)
7104. 	# SetVariable(GapAdjustedLoc, 		0)
7105. 	SetVariable(GapAvailableLoc, 		0)
7106. 	SetVariable(GapCurrentLoc, 			0)
7107. 	SetVariable(GapActualLoc,			0)
7108. 	SetVariable(GapUsedLoc,				0)
7109. 	
7110. 	# Space usage
7111. 	SetVariable(ZoneFreePerRequested, 	0)
7112. 	SetVariable(ZoneFreePerUsed, 		0)
7113. 
7114. # Gap Size & Rounding
7115. 	SetVariable(ZoneGapSizePer, 		0)
7116. 	SetVariable(ZoneVolRoundUpPer, 		0)
7117. 	
7118. 	# Free Space
7119. 	SetVariable(ZoneFreeUsedPer, 		0)
7120. 	SetVariable(ZoneFreeRequestedPer, 	0)
7121. 
7122. 
7123. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
7124. 
7125. # Footer:
7126. SetVariable(ZoneFooter, "----------------------------------------------------------
7127. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:19
7128. 
7129. Statistics Report:
7130. ------------------
7131.    Size:  
7132.    ------------------------
7133.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7134.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7135.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7136. 
7137.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7138.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7139. 
7140.    Location:
7141.    ------------------------
7142.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7143.              Files End: !ZoneEndCurrent!
7144.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7145.       
7146.    Gap Settings:
7147.    ------------------------
7148.          Gap Requested: !ZoneGapSizePer!%
7149.       Volume Rounding: !ZoneVolRoundUpPer!%
7150.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7151.                  
7152.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
7153.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
7154.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
7155.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
7156.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
7157.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
7158.      
7159.    Free Space after Zone:
7160.    ------------------------
7161.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7162.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7163.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7164. 
7165. Directory and Files Select:
7166. ---------------------------
7167. !ZoneTypeSelectCurrent!               
7168. ---------------------------
7169. ----------------------------------------------------------
7170. ")
7171. 
7172. # Script: BannerSet
7173. 
7174. # Script: DisplaySetDateTimeRun
7175. 
7176. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
7177. /* Xinclude "..\Display\BannerSet.MyDc"X */
7178. /* pause(1) */
7179. 
7180. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
7181. 
7182. Title('!Heading!')
7183. /* pause(1) */
7184. 
7185. /* NOTE: Can't round or truncate to integer precision. */
7186. 
7187. # Script: BannerLog
7188. 
7189. AppendLogfile("!LogFileName!", "!Title!")
7190. 
7191. 
7192. 
7193. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
7194. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
7195. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:19")
7196. 
7197. SetVariable(ZoneListByLine, "!ZoneListByLine!
7198. Zone: !ZoneNoCurrent! 2021-11-13 20:31:19 0:00:02 !ZoneLabel! !ZoneDescription!")
7199. 
7200. 
7201. /* Fixed Zone Position Handling */
7202. /* Literal number: */
7203. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
7204. /* Percentage of disk: */
7205. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
7206. /* Gap */
7207. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
7208. 
7209. /* ---------------------------------------------------------- */
7210. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
7211. # Script: DisplaySetFileStep
7212. 
7213. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7214. 
7215. /* add message and move to a new line. */
7216. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7217. ")
7218. 
7219. /* display the line. (hopefully.) */
7220. # Zone Footer Set Statistics Window Text
7221. 
7222. SetStatisticsWindowText("!Heading!
7223. ----------------------------------------------------------
7224. Zones Processed: 
7225. ----------------------------------------------------------
7226. !ZoneListByLine!
7227. ----------------------------------------------------------
7228. Zone Processing Step:
7229. !ZoneStepByLine!    
7230. ----------------------------------------------------------
7231. Current Zone:
7232. !ZoneFooter!
7233. ----------------------------------------------------------
7234. Volume Statistics:
7235. !VolumeStatisticsDetail!
7236. ----------------------------------------------------------
7237. Zone Detailed Report:
7238. ----------------------------------------------------------
7239. !ZoneStatisticsDetail!
7240. ----------------------------------------------------------
7241. ")
7242. 
7243. 
7244. 
7245. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7246. 
7247. # Script: BannerSet
7248. 
7249. # Script: DisplaySetDateTimeRun
7250. 
7251. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:19 0:00:02")
7252. /* Xinclude "..\Display\BannerSet.MyDc"X */
7253. /* pause(1) */
7254. 
7255. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
7256. 
7257. Title('!Heading!')
7258. /* pause(1) */
7259. 
7260. /* NOTE: Can't round or truncate to integer precision. */
7261. 
7262. pause(1)
7263. 
7264. # your stuff HERE (X)... pre file select code.
7265. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
7266. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
7267. 	# (X)
7268. 
7269. FileSelect
7270. 
7271. 	# your stuff can't really go here (errors.)
7272. 	# maybe for some reason I don't know of...
7273. 	
7274. 	# Actions next...
7275. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
7276. # Programs start.
7277. # NotBlobsArchivesBu start.
7278. (not (
7279. # Blobs start.
7280. (
7281. # BlobsAndExceptions start.
7282. ( not(
7283.   FileName("*.bat")
7284.   or FileName("*.css")
7285.   or FileName("*.dll")
7286.   or FileName("*.exe")
7287.   or FileName("*.htm*")
7288.   or FileName("*.jar")
7289.   or FileName("*.js")
7290.   or FileName("*.script")
7291.   or FileName("*.wsf")
7292.   or (
7293. # Databases start.
7294. (
7295.   FileName("*.crypt*")
7296.   or FileName("*.db*")
7297.   or FileName("*.rdb*")
7298.   or FileName("*.dc*")
7299.   or FileName("*.dict*")
7300.   or FileName("*.?db*")
7301.   or FileName("*.?rdb*")
7302.   or FileName("*.md*")
7303.   or FileName("*.myd")
7304.   or FileName("*.ndf")
7305.   or FileName("*.ns?")
7306.   or FileName("*.pab")
7307.   or FileName("*.pst")
7308.   or FileName("*.sd?*")
7309.   or FileName("*.sq**")
7310.   or FileName("*.tmd")
7311.   or FileName("*.tps")
7312.   or FileName("*.tr*")
7313. )
7314. # Databases end.
7315. 
7316.     # BlobsAndExceptions
7317.     or 
7318. # Data start.
7319. (
7320.   DirectoryName("Data*")
7321.   or DirectoryName("Device*")
7322.   or DirectoryName("Export*")
7323.   or DirectoryName("Import*")
7324.   or DirectoryName("Log*")
7325.   or DirectoryName("*Log")
7326.   or DirectoryName("Maintenance*")
7327.   or DirectoryName("Rec*")
7328.   or DirectoryName("Sales*")
7329.   or DirectoryName("Search*")
7330.   or DirectoryName("User*")
7331. )
7332. # Data end.
7333. 
7334.     # BlobsAndExceptions
7335.   )
7336. ) )
7337. # BlobsAndExceptions end.
7338. 
7339. # Blobs
7340. ) and (
7341.   Size(BlobFileSize,0)
7342.   or (
7343.     FileName("*.arj")
7344.     or FileName("*.bup")
7345.     or FileName("*.bz2")
7346.     or FileName("*.chm")
7347.     or FileName("*.dvr-ms")
7348.     or FileName("*.gz")
7349.     or FileName("*.ifo")
7350.     or FileName("*.lzh")
7351.     or FileName("*.pdf")
7352.     or FileName("*.rpm")
7353.     or FileName("*.wmv")
7354.     or FileName("*.vob")
7355.     or FileName("*.z")
7356.   ) 
7357. )
7358. # Blobs end.
7359. 
7360. # NotBlobsArchivesBu
7361. or 
7362. # Archives start.
7363. (
7364.   DirectoryName("*Archive*")
7365.   or DirectoryName("*History*")
7366.   or DirectoryName("*Old")
7367.   or DirectoryName("* Old *")
7368.   or DirectoryName("Old *")
7369. 
7370.   or FileName("*.7z")
7371.   or FileName("*.cab")
7372.   or FileName("*.iso")
7373.   or FileName("*.msi")
7374.   or FileName("*.old")
7375.   or FileName("*.rar")
7376.   or FileName("*.tar")
7377.   or FileName("*.zip")
7378.   or
7379. # WinSysLow start.
7380. (
7381.   DirectoryName("$*")
7382.   or DirectoryName("0*")
7383.   or DirectoryName("1*")
7384.   or DirectoryName("2*")
7385.   or DirectoryName("3*")
7386.   or DirectoryName("4*")
7387.   or DirectoryName("5*")
7388.   or DirectoryName("6*")
7389.   or DirectoryName("7*")
7390.   or DirectoryName("8*")
7391.   or DirectoryName("9*")
7392. 
7393.   or DirectoryName("dllcache")
7394.   or DirectoryName("Downloaded Installations")
7395.   or DirectoryName("Ehome")
7396.   or DirectoryName("Fonts")
7397.   or DirectoryName("Help")
7398.   or DirectoryName("I386")
7399.   or DirectoryName("ie?updates")
7400.   or DirectoryName("Installer")
7401.   or DirectoryName("Installshield Installation Information")
7402.   or DirectoryName("IME")
7403.   or DirectoryName("*RECYCLE*")
7404.   or DirectoryName("ServicePackFiles")
7405.   or DirectoryName("SoftwareDistribution")
7406.   or DirectoryName("Speech")
7407.   or DirectoryName("Symbols")
7408.   or DirectoryName("System Volume Information")
7409.   or DirectoryName("windows.old")
7410. )
7411. # WinSysLow end.
7412. 
7413.   # Archives
7414. )
7415. # Archives end.
7416. 
7417. # NotBlobsArchivesBu
7418. or
7419. # Backups start.
7420. (
7421.   DirectoryName("*Backup*")
7422.   or DirectoryName("*Bu")
7423.   or DirectoryName("* Bu *")
7424.   or DirectoryName("Bu *")
7425. 
7426.   or FileName("*.bak")
7427.   or FileName("* - Copy*")
7428. )
7429. # Backups end.
7430. 
7431. # NotBlobsArchivesBu
7432. ) )
7433. # NotBlobsArchivesBu end.
7434. 
7435. # Programs
7436. and (
7437. # SystemDir start.
7438. (
7439.   DirectoryName("Boot*")
7440.   or DirectoryName("Device*")
7441.   or DirectoryName("DevSupport*")
7442.   or DirectoryName("Program*")
7443.   or DirectoryName("Security*")
7444.   or DirectoryName("SendTo*")
7445.   or DirectoryName("Sw*")
7446.   or DirectoryName("System*")
7447.   or DirectoryName("Toolbars")
7448.   or DirectoryName("Windows*")
7449. )
7450. # SystemDir end.
7451. 
7452. # Programs
7453. )
7454. # Programs end.
7455. 
7456. 		and not(
7457. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
7458. # Os Data Dynamic start.
7459. (
7460. # Os Data Dynamic start.
7461. (
7462.   FileName("*.dat*")
7463.   or FileName("*.db*")
7464.   or FileName("*.edb*")
7465.   or FileName("*.log*")
7466.   or FileName("DataStore.edb")
7467. )
7468. # Os Data Dynamic end.
7469. 
7470.   or 
7471. # Os PageHiberDump start.
7472. (
7473.   FileName("DataStore.edb")
7474.   or FileName("DUMP*.*")
7475.   or FileName("Hiberfil.sys")
7476.   or FileName("MEMORY.DMP")
7477.   or FileName("Pagefile.sys")
7478. )
7479. # Os PageHiberDump end.
7480. 
7481. # Os Data Dynamic
7482. )
7483. # Os Data Dynamic end.
7484. 
7485. 			or 
7486. 				DirectoryName("Windows*")
7487. 		)
7488. 		FileActions
7489. 		  		/* ---------------------------------------------------------- */
7490. 	# Gap
7491. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
7492. 		# Script: DisplaySetFileStep
7493. 
7494. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7495. 
7496. /* add message and move to a new line. */
7497. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7498. ")
7499. 
7500. /* display the line. (hopefully.) */
7501. # Zone Footer Set Statistics Window Text
7502. 
7503. SetStatisticsWindowText("!Heading!
7504. ----------------------------------------------------------
7505. Zones Processed: 
7506. ----------------------------------------------------------
7507. !ZoneListByLine!
7508. ----------------------------------------------------------
7509. Zone Processing Step:
7510. !ZoneStepByLine!    
7511. ----------------------------------------------------------
7512. Current Zone:
7513. !ZoneFooter!
7514. ----------------------------------------------------------
7515. Volume Statistics:
7516. !VolumeStatisticsDetail!
7517. ----------------------------------------------------------
7518. Zone Detailed Report:
7519. ----------------------------------------------------------
7520. !ZoneStatisticsDetail!
7521. ----------------------------------------------------------
7522. ")
7523. 
7524. 
7525. 
7526. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7527. 
7528. # Script: BannerSet
7529. 
7530. # Script: DisplaySetDateTimeRun
7531. 
7532. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
7533. /* Xinclude "..\Display\BannerSet.MyDc"X */
7534. /* pause(1) */
7535. 
7536. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
7537. 
7538. Title('!Heading!')
7539. /* pause(1) */
7540. 
7541. /* NOTE: Can't round or truncate to integer precision. */
7542. 
7543. pause(1)
7544. 	
7545. 	# ACTUAL GAP
7546. 		/* AddGap Variant. */
7547. 	  	# Zone Do Gap
7548. # Gap Calculation Methods:
7549. 
7550. /* 1) Anything you need to add first. */
7551. /* empty */
7552. 
7553. /* ---------------------------------------------------------- */
7554. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
7555. 	# GapRequestedStd.
7556. 
7557. 		/* ---------------------------------------------------------- */
7558. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
7559. 
7560. 		# Gap Calculation Methods:
7561. 
7562. /* AddGap Variants */
7563. 
7564. 	/* Standard */
7565. 		# Gap Calculation Methods:
7566. 	/* AddGap Variants */
7567. 	/* Standard */
7568. 
7569. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
7570. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
7571. 
7572. 	SetVariable(GapRequested, GapRequestedStd)
7573. 	
7574. 
7575. 	/* MFT Low High Method */
7576. 		# Gap Calculation Methods:
7577. 	/* AddGap Variants */
7578. 	/* MFT Low High Method */
7579. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
7580. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
7581. 	SetVariable(GapRequested, GapRequestedMft)
7582. 	
7583. 
7584. 	/* OS Volume Type Method */
7585. 		# Gap Calculation Methods:
7586. 	/* AddGap Variants */
7587. 	/* OS Volume Type Method */
7588. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
7589. 	SetVariable(GapRequested, GapRequestedOs)
7590. 
7591. 
7592. 
7593. /* MakeGap Variants */
7594. 
7595. 	/* Original Os 1-3 + MFT 2 */
7596. 		# Gap Calculation Methods:
7597. 	/* MakeGap Variants */
7598. 	/* Original Os 1-3 + MFT 2 */
7599. 	/* plus MFT gap placed inline at the dividing zone. */
7600. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
7601. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
7602. 	SetVariable(GapRequested, GapRequestedOrig)
7603. 	
7604. 	
7605. /* Note: You could comment out the ones not in use */
7606. /* However having the data in the log is useful. */
7607. /* Therefore the following line is otherwise needed. */
7608. 
7609. /* Standard used */
7610. 
7611. SetVariable(GapRequested, GapRequestedStd)
7612. 
7613. # Gap Calculation Methods:
7614. 
7615. /* AddGap Variants */
7616. 	/* Standard */
7617. 	/* MFT Low High Method */
7618. 	/* OS Volume Type Method */
7619. 
7620. /* MakeGap Variants */
7621. 	/* Original Os 1-3 + MFT 2 */
7622. 
7623. /* Note: You could comment out the ones not in use */
7624. /* However having the data in the log is useful. */
7625. /* Therefore the following line is otherwise needed. */
7626. 
7627. /* Standard is used currently */
7628. 
7629. 
7630. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
7631. 
7632. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
7633. 
7634. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
7635. 
7636. /* ---------------------------------------------------------- */
7637. /* 3) SMALL ZONE ADJUSTMENT. */
7638. /* Gab cant be larger than half the Zone Size. */
7639. 
7640. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
7641. 	
7642. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
7643. 
7644. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
7645. 
7646. /* ---------------------------------------------------------- */
7647. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
7648. # Gap Adjustments.
7649. 
7650. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
7651. 	
7652. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
7653. 
7654. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
7655. 
7656. /* ---------------------------------------------------------- */
7657. # BYPASS THIS.
7658. 	/* This is definitely wrong. */
7659. 	/* The question is can we steal gap from the next zone */
7660. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
7661. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
7662. 		# Zone Overflow.
7663. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
7664. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
7665. 
7666. /* ---------------------------------------------------------- */
7667. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
7668. # Remaining free space available.
7669. 
7670. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
7671. 	
7672. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
7673. 
7674. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
7675. 
7676. /* ---------------------------------------------------------- */
7677. # CURRENT gap to use.
7678. 
7679. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
7680. 
7681. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
7682. 
7683. /* ---------------------------------------------------------- */
7684. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
7685. # Debugging.
7686. 
7687. 	SetVariable(GapUsed, GapCurrent) // for debugging
7688. 
7689. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
7690. 
7691. 		# Your code HERE
7692. 
7693. /* ---------------------------------------------------------- */
7694. /* 7) YOUR CODE. */
7695. # YOUR CODE HERE:
7696. 	# INPUT: GapCurrent or GapCurrentLoc
7697. 	# OUTPUT: GapUsed...
7698. 
7699. /* ---------------------------------------------------------- */
7700. # Gap Size.
7701. # Actual Size of Gap.
7702. 
7703. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
7704. 
7705. /* ---------------------------------------------------------- */
7706. /* xxxxxxxxxxxxxxxxxxxxxx */
7707. # ADD THE GAP
7708. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
7709. /* xxxxxxxxxxxxxxxxxxxxxx */
7710. 
7711. 	
7712. 	# Zone Statistics	
7713. 	# Script: ZoneDoStatistics
7714. # Zone / Volume Statistics and Display
7715. 		
7716. 	# Accumulate Totals
7717.   	# Script: ZoneDoVolumeTotals
7718. 
7719. /* Current total space used (by Zones and Gaps) */
7720. 
7721. SetVariable(VolumeZoneUsed, GapUsed)
7722. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
7723. /* Percentage */
7724. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
7725. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
7726. 
7727. /* Current total of free space requested */
7728. 
7729. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
7730. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7731. /* Percent. */
7732. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
7733. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7734. 
7735. /* Current total of free space used */
7736. 
7737. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
7738. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
7739. /* Percent */
7740. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
7741. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
7742. 
7743. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
7744. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
7745. /* Xinclude "..\DebugDisplayPause.MyDc"X */
7746. 
7747. 
7748. 	# Current Values
7749. 	# Script: ZoneDoCurrentSet
7750. 
7751. # Cluster, Sector, Block adjust for display.
7752. 	# Bytes per cluster is volume specific.
7753. 
7754. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
7755. 
7756. # Current Zone values.
7757. 	# Begin, end and size.
7758. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
7759. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
7760. 
7761. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
7762. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
7763. 
7764. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
7765. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
7766. 
7767. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
7768. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
7769. 
7770. 	SetVariable(ZoneFragments,				"!ZONE210N!")
7771. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
7772. 		
7773. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
7774. /* identical code to here: (separation not needed. TEST.) */	
7775. 
7776. # Current Gap, Actual and Free Values
7777. 	# Gap
7778. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
7779. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
7780. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
7781. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
7782. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
7783. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
7784. 	
7785. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
7786. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
7787. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
7788. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
7789. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
7790. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
7791. 	
7792. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
7793. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
7794. 	
7795. 	# Actual Size and End
7796. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
7797. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
7798. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
7799. 	
7800. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
7801. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
7802. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
7803. 
7804. # Gap Size & Rounding
7805. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
7806. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
7807. 	
7808. 	# Free Space
7809. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
7810. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
7811. 
7812. 	# Footer:
7813. SetVariable(ZoneFooter, "----------------------------------------------------------
7814. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
7815. 
7816. Statistics Report:
7817. ------------------
7818.    Size:  
7819.    ------------------------
7820.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7821.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7822.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7823. 
7824.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7825.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7826. 
7827.    Location:
7828.    ------------------------
7829.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7830.              Files End: !ZoneEndCurrent!
7831.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7832.       
7833.    Gap Settings:
7834.    ------------------------
7835.          Gap Requested: !ZoneGapSizePer!%
7836.       Volume Rounding: !ZoneVolRoundUpPer!%
7837.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7838.                  
7839.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
7840.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
7841.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
7842.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
7843.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
7844.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
7845.      
7846.    Free Space after Zone:
7847.    ------------------------
7848.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7849.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7850.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7851. 
7852. Directory and Files Select:
7853. ---------------------------
7854. !ZoneTypeSelectCurrent!               
7855. ---------------------------
7856. ----------------------------------------------------------
7857. ")
7858. 	# Zone Footer Set Statistics Window Text
7859. 
7860. SetStatisticsWindowText("!Heading!
7861. ----------------------------------------------------------
7862. Zones Processed: 
7863. ----------------------------------------------------------
7864. !ZoneListByLine!
7865. ----------------------------------------------------------
7866. Zone Processing Step:
7867. !ZoneStepByLine!    
7868. ----------------------------------------------------------
7869. Current Zone:
7870. !ZoneFooter!
7871. ----------------------------------------------------------
7872. Volume Statistics:
7873. !VolumeStatisticsDetail!
7874. ----------------------------------------------------------
7875. Zone Detailed Report:
7876. ----------------------------------------------------------
7877. !ZoneStatisticsDetail!
7878. ----------------------------------------------------------
7879. ")
7880. 
7881. 
7882. 	
7883.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
7884. 
7885. 	# Add Zone to list of zones for display.
7886. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
7887. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
7888. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
7889. 	# ??? Free Stats?
7890. 	# Footer:
7891. SetVariable(ZoneFooter, "----------------------------------------------------------
7892. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
7893. 
7894. Statistics Report:
7895. ------------------
7896.    Size:  
7897.    ------------------------
7898.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7899.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7900.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7901. 
7902.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7903.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7904. 
7905.    Location:
7906.    ------------------------
7907.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7908.              Files End: !ZoneEndCurrent!
7909.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7910.       
7911.    Gap Settings:
7912.    ------------------------
7913.          Gap Requested: !ZoneGapSizePer!%
7914.       Volume Rounding: !ZoneVolRoundUpPer!%
7915.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7916.                  
7917.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
7918.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
7919.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
7920.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
7921.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
7922.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
7923.      
7924.    Free Space after Zone:
7925.    ------------------------
7926.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7927.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7928.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7929. 
7930. Directory and Files Select:
7931. ---------------------------
7932. !ZoneTypeSelectCurrent!               
7933. ---------------------------
7934. ----------------------------------------------------------
7935. ")
7936. 
7937. 	# Add Zone Details to Report.	
7938. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
7939. !ZoneFooter!")
7940. 
7941. 
7942. 	
7943. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
7944. 			# Script: DisplaySetFileStep
7945. 
7946. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7947. 
7948. /* add message and move to a new line. */
7949. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7950. ")
7951. 
7952. /* display the line. (hopefully.) */
7953. # Zone Footer Set Statistics Window Text
7954. 
7955. SetStatisticsWindowText("!Heading!
7956. ----------------------------------------------------------
7957. Zones Processed: 
7958. ----------------------------------------------------------
7959. !ZoneListByLine!
7960. ----------------------------------------------------------
7961. Zone Processing Step:
7962. !ZoneStepByLine!    
7963. ----------------------------------------------------------
7964. Current Zone:
7965. !ZoneFooter!
7966. ----------------------------------------------------------
7967. Volume Statistics:
7968. !VolumeStatisticsDetail!
7969. ----------------------------------------------------------
7970. Zone Detailed Report:
7971. ----------------------------------------------------------
7972. !ZoneStatisticsDetail!
7973. ----------------------------------------------------------
7974. ")
7975. 
7976. 
7977. 
7978. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7979. 
7980. # Script: BannerSet
7981. 
7982. # Script: DisplaySetDateTimeRun
7983. 
7984. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
7985. /* Xinclude "..\Display\BannerSet.MyDc"X */
7986. /* pause(1) */
7987. 
7988. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
7989. 
7990. Title('!Heading!')
7991. /* pause(1) */
7992. 
7993. /* NOTE: Can't round or truncate to integer precision. */
7994. 
7995. pause(1)
7996. 
7997. 			# File Action - SortByImportSequence with SkipBlock.
7998. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
7999. 	
8000. 	
8001. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
8002. 			# Script: DisplaySetFileStep
8003. 
8004. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8005. 
8006. /* add message and move to a new line. */
8007. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8008. ")
8009. 
8010. /* display the line. (hopefully.) */
8011. # Zone Footer Set Statistics Window Text
8012. 
8013. SetStatisticsWindowText("!Heading!
8014. ----------------------------------------------------------
8015. Zones Processed: 
8016. ----------------------------------------------------------
8017. !ZoneListByLine!
8018. ----------------------------------------------------------
8019. Zone Processing Step:
8020. !ZoneStepByLine!    
8021. ----------------------------------------------------------
8022. Current Zone:
8023. !ZoneFooter!
8024. ----------------------------------------------------------
8025. Volume Statistics:
8026. !VolumeStatisticsDetail!
8027. ----------------------------------------------------------
8028. Zone Detailed Report:
8029. ----------------------------------------------------------
8030. !ZoneStatisticsDetail!
8031. ----------------------------------------------------------
8032. ")
8033. 
8034. 
8035. 
8036. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8037. 
8038. # Script: BannerSet
8039. 
8040. # Script: DisplaySetDateTimeRun
8041. 
8042. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
8043. /* Xinclude "..\Display\BannerSet.MyDc"X */
8044. /* pause(1) */
8045. 
8046. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
8047. 
8048. Title('!Heading!')
8049. /* pause(1) */
8050. 
8051. /* NOTE: Can't round or truncate to integer precision. */
8052. 
8053. pause(1)
8054. 
8055. 		# Script: ZoneDoFooter
8056. 
8057. /* ---------------------------------------------------------- */
8058. # File Select
8059. 	# Select Statments
8060. # File Actions 
8061. 	# Standard or OS File Actions.
8062. 	# Resume...
8063. 	
8064. 	# your stuff HERE (X)... post zone (file) file actions code.
8065. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
8066. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8067. 		# (X)
8068. 		
8069. 		/* ??? Set window? */
8070. 	
8071. 	# ADD THE GAP
8072. # Vacate (good for diagnostics)
8073. # DoNotVacate - DO NOT Vacate (recommended)
8074. # DoNotVacate - DO NOT Vacate (recommended)
8075. 
8076. # Vacate
8077. /* AddGap(GapUsedLoc) */
8078. 
8079. # DO Not Vacate
8080. AddGap(GapUsedLoc, DoNotVacate) 
8081. 	
8082. 	
8083. # Script: GapZoneCommand
8084. # *** Moved to setting yours ***
8085. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
8086. # Controlled via settings commands
8087. # DoNotVacate - DO NOT Vacate (recommended)
8088. 
8089. # Vacate
8090. /* AddGap(GapUsedLoc) */
8091. 
8092. # DO Not Vacate
8093. AddGap(GapUsedLoc, DoNotVacate) 
8094. 	
8095. 	
8096. # Vacate /* AddGap(GapUsed) */
8097. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
8098. 	
8099. 
8100. 		
8101. # 
8102. FileEnd
8103. /* ---------------------------------------------------------- */
8104. 
8105. # your stuff HERE (X)... post zone (file) code.
8106. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
8107. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8108. 	# (X)
8109. 
8110. SetVariable(FileStepDescription,"Zone finished, reporting.")
8111. # Script: DisplaySetFileStep
8112. 
8113. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8114. 
8115. /* add message and move to a new line. */
8116. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8117. ")
8118. 
8119. /* display the line. (hopefully.) */
8120. # Zone Footer Set Statistics Window Text
8121. 
8122. SetStatisticsWindowText("!Heading!
8123. ----------------------------------------------------------
8124. Zones Processed: 
8125. ----------------------------------------------------------
8126. !ZoneListByLine!
8127. ----------------------------------------------------------
8128. Zone Processing Step:
8129. !ZoneStepByLine!    
8130. ----------------------------------------------------------
8131. Current Zone:
8132. !ZoneFooter!
8133. ----------------------------------------------------------
8134. Volume Statistics:
8135. !VolumeStatisticsDetail!
8136. ----------------------------------------------------------
8137. Zone Detailed Report:
8138. ----------------------------------------------------------
8139. !ZoneStatisticsDetail!
8140. ----------------------------------------------------------
8141. ")
8142. 
8143. 
8144. 
8145. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8146. 
8147. # Script: BannerSet
8148. 
8149. # Script: DisplaySetDateTimeRun
8150. 
8151. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
8152. /* Xinclude "..\Display\BannerSet.MyDc"X */
8153. /* pause(1) */
8154. 
8155. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
8156. 
8157. Title('!Heading!')
8158. /* pause(1) */
8159. 
8160. /* NOTE: Can't round or truncate to integer precision. */
8161. 
8162. pause(1)
8163. 
8164. # Script: ZoneWhenFinished
8165. 
8166. # Script: BannerSet
8167. 
8168. # Script: DisplaySetDateTimeRun
8169. 
8170. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
8171. /* Xinclude "..\Display\BannerSet.MyDc"X */
8172. /* pause(1) */
8173. 
8174. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
8175. 
8176. Title('!Heading!')
8177. /* pause(1) */
8178. 
8179. /* NOTE: Can't round or truncate to integer precision. */
8180. 
8181. # Script: BannerLog
8182. 
8183. AppendLogfile("!LogFileName!", "!Title!")
8184. 
8185. 
8186. 
8187. # Zone Statistics	
8188. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
8189. 
8190. # Footer:
8191. SetVariable(ZoneFooter, "----------------------------------------------------------
8192. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
8193. 
8194. Statistics Report:
8195. ------------------
8196.    Size:  
8197.    ------------------------
8198.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8199.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8200.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8201. 
8202.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8203.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8204. 
8205.    Location:
8206.    ------------------------
8207.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8208.              Files End: !ZoneEndCurrent!
8209.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8210.       
8211.    Gap Settings:
8212.    ------------------------
8213.          Gap Requested: !ZoneGapSizePer!%
8214.       Volume Rounding: !ZoneVolRoundUpPer!%
8215.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8216.                  
8217.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
8218.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
8219.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
8220.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
8221.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
8222.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
8223.      
8224.    Free Space after Zone:
8225.    ------------------------
8226.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8227.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8228.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8229. 
8230. Directory and Files Select:
8231. ---------------------------
8232. !ZoneTypeSelectCurrent!               
8233. ---------------------------
8234. ----------------------------------------------------------
8235. ")
8236. 
8237. AppendLogfile("!LogFileName!", ".")
8238. AppendLogfile("!LogFileName!", "!ZoneFooter!")
8239. AppendLogfile("!LogFileName!", ".")
8240. 
8241. # Zone Footer Set Statistics Window Text
8242. 
8243. SetStatisticsWindowText("!Heading!
8244. ----------------------------------------------------------
8245. Zones Processed: 
8246. ----------------------------------------------------------
8247. !ZoneListByLine!
8248. ----------------------------------------------------------
8249. Zone Processing Step:
8250. !ZoneStepByLine!    
8251. ----------------------------------------------------------
8252. Current Zone:
8253. !ZoneFooter!
8254. ----------------------------------------------------------
8255. Volume Statistics:
8256. !VolumeStatisticsDetail!
8257. ----------------------------------------------------------
8258. Zone Detailed Report:
8259. ----------------------------------------------------------
8260. !ZoneStatisticsDetail!
8261. ----------------------------------------------------------
8262. ")
8263. 
8264. 
8265. 
8266. /* pause() */
8267. /* pause() */
8268. 
8269. 
8270. 
8271. 	
8272. /* ---------------------------------------------------------- */
8273. # Zone Programs Fixed size just Windows.
8274. 	# Script: DisplayColors - Zone Dark
8275. # Processed
8276. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
8277. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
8278. 
8279. # Light Green and Yellow
8280. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
8281. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
8282. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
8283. 
8284. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsWindows!")
8285. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsWindows!")
8286. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
8287. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
8288. 	SetVariable(ZoneTypeSelect,'
8289.                 # Programs - Windows folder.
8290. 				# Script: ZoneDo ZoneTypeSelectOsPrograms
8291. # Programs start.
8292. # NotBlobsArchivesBu start.
8293. (not (
8294. # Blobs start.
8295. (
8296. # BlobsAndExceptions start.
8297. ( not(
8298.   FileName("*.bat")
8299.   or FileName("*.css")
8300.   or FileName("*.dll")
8301.   or FileName("*.exe")
8302.   or FileName("*.htm*")
8303.   or FileName("*.jar")
8304.   or FileName("*.js")
8305.   or FileName("*.script")
8306.   or FileName("*.wsf")
8307.   or (
8308. # Databases start.
8309. (
8310.   FileName("*.crypt*")
8311.   or FileName("*.db*")
8312.   or FileName("*.rdb*")
8313.   or FileName("*.dc*")
8314.   or FileName("*.dict*")
8315.   or FileName("*.?db*")
8316.   or FileName("*.?rdb*")
8317.   or FileName("*.md*")
8318.   or FileName("*.myd")
8319.   or FileName("*.ndf")
8320.   or FileName("*.ns?")
8321.   or FileName("*.pab")
8322.   or FileName("*.pst")
8323.   or FileName("*.sd?*")
8324.   or FileName("*.sq**")
8325.   or FileName("*.tmd")
8326.   or FileName("*.tps")
8327.   or FileName("*.tr*")
8328. )
8329. # Databases end.
8330. 
8331.     # BlobsAndExceptions
8332.     or 
8333. # Data start.
8334. (
8335.   DirectoryName("Data*")
8336.   or DirectoryName("Device*")
8337.   or DirectoryName("Export*")
8338.   or DirectoryName("Import*")
8339.   or DirectoryName("Log*")
8340.   or DirectoryName("*Log")
8341.   or DirectoryName("Maintenance*")
8342.   or DirectoryName("Rec*")
8343.   or DirectoryName("Sales*")
8344.   or DirectoryName("Search*")
8345.   or DirectoryName("User*")
8346. )
8347. # Data end.
8348. 
8349.     # BlobsAndExceptions
8350.   )
8351. ) )
8352. # BlobsAndExceptions end.
8353. 
8354. # Blobs
8355. ) and (
8356.   Size(BlobFileSize,0)
8357.   or (
8358.     FileName("*.arj")
8359.     or FileName("*.bup")
8360.     or FileName("*.bz2")
8361.     or FileName("*.chm")
8362.     or FileName("*.dvr-ms")
8363.     or FileName("*.gz")
8364.     or FileName("*.ifo")
8365.     or FileName("*.lzh")
8366.     or FileName("*.pdf")
8367.     or FileName("*.rpm")
8368.     or FileName("*.wmv")
8369.     or FileName("*.vob")
8370.     or FileName("*.z")
8371.   ) 
8372. )
8373. # Blobs end.
8374. 
8375. # NotBlobsArchivesBu
8376. or 
8377. # Archives start.
8378. (
8379.   DirectoryName("*Archive*")
8380.   or DirectoryName("*History*")
8381.   or DirectoryName("*Old")
8382.   or DirectoryName("* Old *")
8383.   or DirectoryName("Old *")
8384. 
8385.   or FileName("*.7z")
8386.   or FileName("*.cab")
8387.   or FileName("*.iso")
8388.   or FileName("*.msi")
8389.   or FileName("*.old")
8390.   or FileName("*.rar")
8391.   or FileName("*.tar")
8392.   or FileName("*.zip")
8393.   or
8394. # WinSysLow start.
8395. (
8396.   DirectoryName("$*")
8397.   or DirectoryName("0*")
8398.   or DirectoryName("1*")
8399.   or DirectoryName("2*")
8400.   or DirectoryName("3*")
8401.   or DirectoryName("4*")
8402.   or DirectoryName("5*")
8403.   or DirectoryName("6*")
8404.   or DirectoryName("7*")
8405.   or DirectoryName("8*")
8406.   or DirectoryName("9*")
8407. 
8408.   or DirectoryName("dllcache")
8409.   or DirectoryName("Downloaded Installations")
8410.   or DirectoryName("Ehome")
8411.   or DirectoryName("Fonts")
8412.   or DirectoryName("Help")
8413.   or DirectoryName("I386")
8414.   or DirectoryName("ie?updates")
8415.   or DirectoryName("Installer")
8416.   or DirectoryName("Installshield Installation Information")
8417.   or DirectoryName("IME")
8418.   or DirectoryName("*RECYCLE*")
8419.   or DirectoryName("ServicePackFiles")
8420.   or DirectoryName("SoftwareDistribution")
8421.   or DirectoryName("Speech")
8422.   or DirectoryName("Symbols")
8423.   or DirectoryName("System Volume Information")
8424.   or DirectoryName("windows.old")
8425. )
8426. # WinSysLow end.
8427. 
8428.   # Archives
8429. )
8430. # Archives end.
8431. 
8432. # NotBlobsArchivesBu
8433. or
8434. # Backups start.
8435. (
8436.   DirectoryName("*Backup*")
8437.   or DirectoryName("*Bu")
8438.   or DirectoryName("* Bu *")
8439.   or DirectoryName("Bu *")
8440. 
8441.   or FileName("*.bak")
8442.   or FileName("* - Copy*")
8443. )
8444. # Backups end.
8445. 
8446. # NotBlobsArchivesBu
8447. ) )
8448. # NotBlobsArchivesBu end.
8449. 
8450. # Programs
8451. and (
8452. # SystemDir start.
8453. (
8454.   DirectoryName("Boot*")
8455.   or DirectoryName("Device*")
8456.   or DirectoryName("DevSupport*")
8457.   or DirectoryName("Program*")
8458.   or DirectoryName("Security*")
8459.   or DirectoryName("SendTo*")
8460.   or DirectoryName("Sw*")
8461.   or DirectoryName("System*")
8462.   or DirectoryName("Toolbars")
8463.   or DirectoryName("Windows*")
8464. )
8465. # SystemDir end.
8466. 
8467. # Programs
8468. )
8469. # Programs end.
8470. 
8471.                 and not(
8472.                 # Script: ZoneDo ZoneTypeSelectOsDataDynamic
8473. # Os Data Dynamic start.
8474. (
8475. # Os Data Dynamic start.
8476. (
8477.   FileName("*.dat*")
8478.   or FileName("*.db*")
8479.   or FileName("*.edb*")
8480.   or FileName("*.log*")
8481.   or FileName("DataStore.edb")
8482. )
8483. # Os Data Dynamic end.
8484. 
8485.   or 
8486. # Os PageHiberDump start.
8487. (
8488.   FileName("DataStore.edb")
8489.   or FileName("DUMP*.*")
8490.   or FileName("Hiberfil.sys")
8491.   or FileName("MEMORY.DMP")
8492.   or FileName("Pagefile.sys")
8493. )
8494. # Os PageHiberDump end.
8495. 
8496. # Os Data Dynamic
8497. )
8498. # Os Data Dynamic end.
8499. 
8500.                 )
8501. ')
8502. 
8503. 		# Script: ZoneDoHeader
8504. 
8505. # Script: ZoneWhenStarted
8506. 
8507. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
8508. # Script: DisplaySetZone
8509. 
8510. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
8511. SetVariable(FileStepDescription,	"")
8512. 
8513. SetVariable(ZoneStepByLine, 			"Zone started.
8514. ")
8515. 
8516. # Script: BannerDescriptionSet
8517. 
8518. # Script: BannerSet
8519. 
8520. # Script: DisplaySetDateTimeRun
8521. 
8522. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
8523. /* Xinclude "..\Display\BannerSet.MyDc"X */
8524. /* pause(1) */
8525. 
8526. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
8527. 
8528. Title('!Heading!')
8529. /* pause(1) */
8530. 
8531. /* NOTE: Can't round or truncate to integer precision. */
8532. 
8533. # Script: BannerLog
8534. 
8535. AppendLogfile("!LogFileName!", "!Title!")
8536. 
8537. 
8538. 
8539. pause(1)
8540. 
8541. 
8542. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
8543. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
8544. 
8545. SetVariable(ZoneStepNoCurrent, 0)
8546. 
8547. 
8548. # Script: ZoneDoCurrentClear
8549. 
8550. SetVariable(ZoneTypeSelectCurrent, 		"")
8551. 
8552. SetVariable(ZoneBeginCurrent, 			0)
8553. SetVariable(ZoneBeginPerCurrent, 		0)
8554. SetVariable(ZoneEndCurrent, 			0)
8555. SetVariable(ZoneEndPerCurrent, 			0)
8556. 
8557. SetVariable(ZoneSizeCurrent,			0)
8558. SetVariable(ZoneSizePerCurrent,			0)
8559. 
8560. SetVariable(ZoneGapRequestedCurrent,	0)
8561. SetVariable(ZoneGapRoundedCurrent, 		0)
8562. SetVariable(ZoneGapAdjustedCurrent, 	0)
8563. SetVariable(ZoneGapAvailableCurrent, 	0)
8564. SetVariable(ZoneGapCurrent,				0)
8565. SetVariable(ZoneGapUsedCurrent, 		0)
8566. 
8567. SetVariable(ZoneGapActualCurrent, 		0)
8568. SetVariable(ZoneGapActualPerCurrent, 	0)
8569. 
8570. SetVariable(ZoneSizeActual, 			0)
8571. SetVariable(ZoneSizeActualCurrent,		0)
8572. 
8573. SetVariable(ZoneEndActual, 				0)
8574. SetVariable(ZoneEndActualCurrent,		0)			
8575. SetVariable(ZoneSizeActualPerCurrent, 	0)
8576.       
8577. SetVariable(ZoneFilesFolders,			0)
8578. SetVariable(ZoneFilesFoldersPer,		0) 
8579. 
8580. SetVariable(ZoneFragments,				0)
8581. SetVariable(ZoneFragmentsPer,			0) 
8582. 		
8583. SetVariable(ZoneEndActualCurrent, 		0)
8584. SetVariable(ZoneEndActualPerCurrent, 	0)
8585. 
8586. # Gap Calculation Methodology:
8587. 	# Requested
8588. 	SetVariable(GapRequested, 			0) 
8589. 	SetVariable(GapRequestedStd, 		0) 
8590. 	SetVariable(GapRequestedMft, 		0) 
8591. 	SetVariable(GapRequestedOs, 		0) 
8592. 	SetVariable(GapRequestedOriginal, 	0) 
8593. 	
8594. 	# Gap Adjustments
8595. 	SetVariable(GapRounded, 			0)
8596. 	# SetVariable(GapAdjusted, 			0)
8597. 	SetVariable(GapAvailable, 			0)
8598. 	SetVariable(GapCurrent, 			0)
8599. 	SetVariable(GapActual, 				0)
8600. 	SetVariable(GapUsed, 				0)
8601. 	
8602. 	# Gap Adjustments
8603. 	SetVariable(GapRoundedLoc, 			0)
8604. 	# SetVariable(GapAdjustedLoc, 		0)
8605. 	SetVariable(GapAvailableLoc, 		0)
8606. 	SetVariable(GapCurrentLoc, 			0)
8607. 	SetVariable(GapActualLoc,			0)
8608. 	SetVariable(GapUsedLoc,				0)
8609. 	
8610. 	# Space usage
8611. 	SetVariable(ZoneFreePerRequested, 	0)
8612. 	SetVariable(ZoneFreePerUsed, 		0)
8613. 
8614. # Gap Size & Rounding
8615. 	SetVariable(ZoneGapSizePer, 		0)
8616. 	SetVariable(ZoneVolRoundUpPer, 		0)
8617. 	
8618. 	# Free Space
8619. 	SetVariable(ZoneFreeUsedPer, 		0)
8620. 	SetVariable(ZoneFreeRequestedPer, 	0)
8621. 
8622. 
8623. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
8624. 
8625. # Footer:
8626. SetVariable(ZoneFooter, "----------------------------------------------------------
8627. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
8628. 
8629. Statistics Report:
8630. ------------------
8631.    Size:  
8632.    ------------------------
8633.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8634.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8635.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8636. 
8637.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8638.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8639. 
8640.    Location:
8641.    ------------------------
8642.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8643.              Files End: !ZoneEndCurrent!
8644.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8645.       
8646.    Gap Settings:
8647.    ------------------------
8648.          Gap Requested: !ZoneGapSizePer!%
8649.       Volume Rounding: !ZoneVolRoundUpPer!%
8650.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8651.                  
8652.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
8653.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
8654.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
8655.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
8656.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
8657.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
8658.      
8659.    Free Space after Zone:
8660.    ------------------------
8661.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8662.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8663.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8664. 
8665. Directory and Files Select:
8666. ---------------------------
8667. !ZoneTypeSelectCurrent!               
8668. ---------------------------
8669. ----------------------------------------------------------
8670. ")
8671. 
8672. # Script: BannerSet
8673. 
8674. # Script: DisplaySetDateTimeRun
8675. 
8676. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
8677. /* Xinclude "..\Display\BannerSet.MyDc"X */
8678. /* pause(1) */
8679. 
8680. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
8681. 
8682. Title('!Heading!')
8683. /* pause(1) */
8684. 
8685. /* NOTE: Can't round or truncate to integer precision. */
8686. 
8687. # Script: BannerLog
8688. 
8689. AppendLogfile("!LogFileName!", "!Title!")
8690. 
8691. 
8692. 
8693. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
8694. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
8695. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:20")
8696. 
8697. SetVariable(ZoneListByLine, "!ZoneListByLine!
8698. Zone: !ZoneNoCurrent! 2021-11-13 20:31:20 0:00:03 !ZoneLabel! !ZoneDescription!")
8699. 
8700. 
8701. /* Fixed Zone Position Handling */
8702. /* Literal number: */
8703. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
8704. /* Percentage of disk: */
8705. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
8706. /* Gap */
8707. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
8708. 
8709. /* ---------------------------------------------------------- */
8710. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
8711. # Script: DisplaySetFileStep
8712. 
8713. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8714. 
8715. /* add message and move to a new line. */
8716. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8717. ")
8718. 
8719. /* display the line. (hopefully.) */
8720. # Zone Footer Set Statistics Window Text
8721. 
8722. SetStatisticsWindowText("!Heading!
8723. ----------------------------------------------------------
8724. Zones Processed: 
8725. ----------------------------------------------------------
8726. !ZoneListByLine!
8727. ----------------------------------------------------------
8728. Zone Processing Step:
8729. !ZoneStepByLine!    
8730. ----------------------------------------------------------
8731. Current Zone:
8732. !ZoneFooter!
8733. ----------------------------------------------------------
8734. Volume Statistics:
8735. !VolumeStatisticsDetail!
8736. ----------------------------------------------------------
8737. Zone Detailed Report:
8738. ----------------------------------------------------------
8739. !ZoneStatisticsDetail!
8740. ----------------------------------------------------------
8741. ")
8742. 
8743. 
8744. 
8745. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8746. 
8747. # Script: BannerSet
8748. 
8749. # Script: DisplaySetDateTimeRun
8750. 
8751. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
8752. /* Xinclude "..\Display\BannerSet.MyDc"X */
8753. /* pause(1) */
8754. 
8755. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
8756. 
8757. Title('!Heading!')
8758. /* pause(1) */
8759. 
8760. /* NOTE: Can't round or truncate to integer precision. */
8761. 
8762. pause(1)
8763. 
8764. # your stuff HERE (X)... pre file select code.
8765. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
8766. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8767. 	# (X)
8768. 
8769. FileSelect
8770. 
8771. 	# your stuff can't really go here (errors.)
8772. 	# maybe for some reason I don't know of...
8773. 	
8774. 	# Actions next...
8775. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
8776. # Programs start.
8777. # NotBlobsArchivesBu start.
8778. (not (
8779. # Blobs start.
8780. (
8781. # BlobsAndExceptions start.
8782. ( not(
8783.   FileName("*.bat")
8784.   or FileName("*.css")
8785.   or FileName("*.dll")
8786.   or FileName("*.exe")
8787.   or FileName("*.htm*")
8788.   or FileName("*.jar")
8789.   or FileName("*.js")
8790.   or FileName("*.script")
8791.   or FileName("*.wsf")
8792.   or (
8793. # Databases start.
8794. (
8795.   FileName("*.crypt*")
8796.   or FileName("*.db*")
8797.   or FileName("*.rdb*")
8798.   or FileName("*.dc*")
8799.   or FileName("*.dict*")
8800.   or FileName("*.?db*")
8801.   or FileName("*.?rdb*")
8802.   or FileName("*.md*")
8803.   or FileName("*.myd")
8804.   or FileName("*.ndf")
8805.   or FileName("*.ns?")
8806.   or FileName("*.pab")
8807.   or FileName("*.pst")
8808.   or FileName("*.sd?*")
8809.   or FileName("*.sq**")
8810.   or FileName("*.tmd")
8811.   or FileName("*.tps")
8812.   or FileName("*.tr*")
8813. )
8814. # Databases end.
8815. 
8816.     # BlobsAndExceptions
8817.     or 
8818. # Data start.
8819. (
8820.   DirectoryName("Data*")
8821.   or DirectoryName("Device*")
8822.   or DirectoryName("Export*")
8823.   or DirectoryName("Import*")
8824.   or DirectoryName("Log*")
8825.   or DirectoryName("*Log")
8826.   or DirectoryName("Maintenance*")
8827.   or DirectoryName("Rec*")
8828.   or DirectoryName("Sales*")
8829.   or DirectoryName("Search*")
8830.   or DirectoryName("User*")
8831. )
8832. # Data end.
8833. 
8834.     # BlobsAndExceptions
8835.   )
8836. ) )
8837. # BlobsAndExceptions end.
8838. 
8839. # Blobs
8840. ) and (
8841.   Size(BlobFileSize,0)
8842.   or (
8843.     FileName("*.arj")
8844.     or FileName("*.bup")
8845.     or FileName("*.bz2")
8846.     or FileName("*.chm")
8847.     or FileName("*.dvr-ms")
8848.     or FileName("*.gz")
8849.     or FileName("*.ifo")
8850.     or FileName("*.lzh")
8851.     or FileName("*.pdf")
8852.     or FileName("*.rpm")
8853.     or FileName("*.wmv")
8854.     or FileName("*.vob")
8855.     or FileName("*.z")
8856.   ) 
8857. )
8858. # Blobs end.
8859. 
8860. # NotBlobsArchivesBu
8861. or 
8862. # Archives start.
8863. (
8864.   DirectoryName("*Archive*")
8865.   or DirectoryName("*History*")
8866.   or DirectoryName("*Old")
8867.   or DirectoryName("* Old *")
8868.   or DirectoryName("Old *")
8869. 
8870.   or FileName("*.7z")
8871.   or FileName("*.cab")
8872.   or FileName("*.iso")
8873.   or FileName("*.msi")
8874.   or FileName("*.old")
8875.   or FileName("*.rar")
8876.   or FileName("*.tar")
8877.   or FileName("*.zip")
8878.   or
8879. # WinSysLow start.
8880. (
8881.   DirectoryName("$*")
8882.   or DirectoryName("0*")
8883.   or DirectoryName("1*")
8884.   or DirectoryName("2*")
8885.   or DirectoryName("3*")
8886.   or DirectoryName("4*")
8887.   or DirectoryName("5*")
8888.   or DirectoryName("6*")
8889.   or DirectoryName("7*")
8890.   or DirectoryName("8*")
8891.   or DirectoryName("9*")
8892. 
8893.   or DirectoryName("dllcache")
8894.   or DirectoryName("Downloaded Installations")
8895.   or DirectoryName("Ehome")
8896.   or DirectoryName("Fonts")
8897.   or DirectoryName("Help")
8898.   or DirectoryName("I386")
8899.   or DirectoryName("ie?updates")
8900.   or DirectoryName("Installer")
8901.   or DirectoryName("Installshield Installation Information")
8902.   or DirectoryName("IME")
8903.   or DirectoryName("*RECYCLE*")
8904.   or DirectoryName("ServicePackFiles")
8905.   or DirectoryName("SoftwareDistribution")
8906.   or DirectoryName("Speech")
8907.   or DirectoryName("Symbols")
8908.   or DirectoryName("System Volume Information")
8909.   or DirectoryName("windows.old")
8910. )
8911. # WinSysLow end.
8912. 
8913.   # Archives
8914. )
8915. # Archives end.
8916. 
8917. # NotBlobsArchivesBu
8918. or
8919. # Backups start.
8920. (
8921.   DirectoryName("*Backup*")
8922.   or DirectoryName("*Bu")
8923.   or DirectoryName("* Bu *")
8924.   or DirectoryName("Bu *")
8925. 
8926.   or FileName("*.bak")
8927.   or FileName("* - Copy*")
8928. )
8929. # Backups end.
8930. 
8931. # NotBlobsArchivesBu
8932. ) )
8933. # NotBlobsArchivesBu end.
8934. 
8935. # Programs
8936. and (
8937. # SystemDir start.
8938. (
8939.   DirectoryName("Boot*")
8940.   or DirectoryName("Device*")
8941.   or DirectoryName("DevSupport*")
8942.   or DirectoryName("Program*")
8943.   or DirectoryName("Security*")
8944.   or DirectoryName("SendTo*")
8945.   or DirectoryName("Sw*")
8946.   or DirectoryName("System*")
8947.   or DirectoryName("Toolbars")
8948.   or DirectoryName("Windows*")
8949. )
8950. # SystemDir end.
8951. 
8952. # Programs
8953. )
8954. # Programs end.
8955. 
8956. 		and not(
8957. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
8958. # Os Data Dynamic start.
8959. (
8960. # Os Data Dynamic start.
8961. (
8962.   FileName("*.dat*")
8963.   or FileName("*.db*")
8964.   or FileName("*.edb*")
8965.   or FileName("*.log*")
8966.   or FileName("DataStore.edb")
8967. )
8968. # Os Data Dynamic end.
8969. 
8970.   or 
8971. # Os PageHiberDump start.
8972. (
8973.   FileName("DataStore.edb")
8974.   or FileName("DUMP*.*")
8975.   or FileName("Hiberfil.sys")
8976.   or FileName("MEMORY.DMP")
8977.   or FileName("Pagefile.sys")
8978. )
8979. # Os PageHiberDump end.
8980. 
8981. # Os Data Dynamic
8982. )
8983. # Os Data Dynamic end.
8984. 
8985. 		)
8986. 
8987. 		FileActions
8988. 		  		/* ---------------------------------------------------------- */
8989. 	# Gap
8990. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
8991. 		# Script: DisplaySetFileStep
8992. 
8993. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8994. 
8995. /* add message and move to a new line. */
8996. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8997. ")
8998. 
8999. /* display the line. (hopefully.) */
9000. # Zone Footer Set Statistics Window Text
9001. 
9002. SetStatisticsWindowText("!Heading!
9003. ----------------------------------------------------------
9004. Zones Processed: 
9005. ----------------------------------------------------------
9006. !ZoneListByLine!
9007. ----------------------------------------------------------
9008. Zone Processing Step:
9009. !ZoneStepByLine!    
9010. ----------------------------------------------------------
9011. Current Zone:
9012. !ZoneFooter!
9013. ----------------------------------------------------------
9014. Volume Statistics:
9015. !VolumeStatisticsDetail!
9016. ----------------------------------------------------------
9017. Zone Detailed Report:
9018. ----------------------------------------------------------
9019. !ZoneStatisticsDetail!
9020. ----------------------------------------------------------
9021. ")
9022. 
9023. 
9024. 
9025. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9026. 
9027. # Script: BannerSet
9028. 
9029. # Script: DisplaySetDateTimeRun
9030. 
9031. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
9032. /* Xinclude "..\Display\BannerSet.MyDc"X */
9033. /* pause(1) */
9034. 
9035. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
9036. 
9037. Title('!Heading!')
9038. /* pause(1) */
9039. 
9040. /* NOTE: Can't round or truncate to integer precision. */
9041. 
9042. pause(1)
9043. 	
9044. 	# ACTUAL GAP
9045. 		/* AddGap Variant. */
9046. 	  	# Zone Do Gap
9047. # Gap Calculation Methods:
9048. 
9049. /* 1) Anything you need to add first. */
9050. /* empty */
9051. 
9052. /* ---------------------------------------------------------- */
9053. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
9054. 	# GapRequestedStd.
9055. 
9056. 		/* ---------------------------------------------------------- */
9057. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
9058. 
9059. 		# Gap Calculation Methods:
9060. 
9061. /* AddGap Variants */
9062. 
9063. 	/* Standard */
9064. 		# Gap Calculation Methods:
9065. 	/* AddGap Variants */
9066. 	/* Standard */
9067. 
9068. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
9069. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
9070. 
9071. 	SetVariable(GapRequested, GapRequestedStd)
9072. 	
9073. 
9074. 	/* MFT Low High Method */
9075. 		# Gap Calculation Methods:
9076. 	/* AddGap Variants */
9077. 	/* MFT Low High Method */
9078. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
9079. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
9080. 	SetVariable(GapRequested, GapRequestedMft)
9081. 	
9082. 
9083. 	/* OS Volume Type Method */
9084. 		# Gap Calculation Methods:
9085. 	/* AddGap Variants */
9086. 	/* OS Volume Type Method */
9087. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
9088. 	SetVariable(GapRequested, GapRequestedOs)
9089. 
9090. 
9091. 
9092. /* MakeGap Variants */
9093. 
9094. 	/* Original Os 1-3 + MFT 2 */
9095. 		# Gap Calculation Methods:
9096. 	/* MakeGap Variants */
9097. 	/* Original Os 1-3 + MFT 2 */
9098. 	/* plus MFT gap placed inline at the dividing zone. */
9099. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
9100. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
9101. 	SetVariable(GapRequested, GapRequestedOrig)
9102. 	
9103. 	
9104. /* Note: You could comment out the ones not in use */
9105. /* However having the data in the log is useful. */
9106. /* Therefore the following line is otherwise needed. */
9107. 
9108. /* Standard used */
9109. 
9110. SetVariable(GapRequested, GapRequestedStd)
9111. 
9112. # Gap Calculation Methods:
9113. 
9114. /* AddGap Variants */
9115. 	/* Standard */
9116. 	/* MFT Low High Method */
9117. 	/* OS Volume Type Method */
9118. 
9119. /* MakeGap Variants */
9120. 	/* Original Os 1-3 + MFT 2 */
9121. 
9122. /* Note: You could comment out the ones not in use */
9123. /* However having the data in the log is useful. */
9124. /* Therefore the following line is otherwise needed. */
9125. 
9126. /* Standard is used currently */
9127. 
9128. 
9129. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
9130. 
9131. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
9132. 
9133. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
9134. 
9135. /* ---------------------------------------------------------- */
9136. /* 3) SMALL ZONE ADJUSTMENT. */
9137. /* Gab cant be larger than half the Zone Size. */
9138. 
9139. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
9140. 	
9141. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
9142. 
9143. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
9144. 
9145. /* ---------------------------------------------------------- */
9146. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
9147. # Gap Adjustments.
9148. 
9149. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
9150. 	
9151. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
9152. 
9153. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
9154. 
9155. /* ---------------------------------------------------------- */
9156. # BYPASS THIS.
9157. 	/* This is definitely wrong. */
9158. 	/* The question is can we steal gap from the next zone */
9159. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
9160. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
9161. 		# Zone Overflow.
9162. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
9163. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
9164. 
9165. /* ---------------------------------------------------------- */
9166. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
9167. # Remaining free space available.
9168. 
9169. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
9170. 	
9171. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
9172. 
9173. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
9174. 
9175. /* ---------------------------------------------------------- */
9176. # CURRENT gap to use.
9177. 
9178. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
9179. 
9180. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
9181. 
9182. /* ---------------------------------------------------------- */
9183. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
9184. # Debugging.
9185. 
9186. 	SetVariable(GapUsed, GapCurrent) // for debugging
9187. 
9188. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
9189. 
9190. 		# Your code HERE
9191. 
9192. /* ---------------------------------------------------------- */
9193. /* 7) YOUR CODE. */
9194. # YOUR CODE HERE:
9195. 	# INPUT: GapCurrent or GapCurrentLoc
9196. 	# OUTPUT: GapUsed...
9197. 
9198. /* ---------------------------------------------------------- */
9199. # Gap Size.
9200. # Actual Size of Gap.
9201. 
9202. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
9203. 
9204. /* ---------------------------------------------------------- */
9205. /* xxxxxxxxxxxxxxxxxxxxxx */
9206. # ADD THE GAP
9207. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
9208. /* xxxxxxxxxxxxxxxxxxxxxx */
9209. 
9210. 	
9211. 	# Zone Statistics	
9212. 	# Script: ZoneDoStatistics
9213. # Zone / Volume Statistics and Display
9214. 		
9215. 	# Accumulate Totals
9216.   	# Script: ZoneDoVolumeTotals
9217. 
9218. /* Current total space used (by Zones and Gaps) */
9219. 
9220. SetVariable(VolumeZoneUsed, GapUsed)
9221. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
9222. /* Percentage */
9223. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
9224. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
9225. 
9226. /* Current total of free space requested */
9227. 
9228. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
9229. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
9230. /* Percent. */
9231. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
9232. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
9233. 
9234. /* Current total of free space used */
9235. 
9236. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
9237. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
9238. /* Percent */
9239. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
9240. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
9241. 
9242. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
9243. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
9244. /* Xinclude "..\DebugDisplayPause.MyDc"X */
9245. 
9246. 
9247. 	# Current Values
9248. 	# Script: ZoneDoCurrentSet
9249. 
9250. # Cluster, Sector, Block adjust for display.
9251. 	# Bytes per cluster is volume specific.
9252. 
9253. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
9254. 
9255. # Current Zone values.
9256. 	# Begin, end and size.
9257. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
9258. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
9259. 
9260. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
9261. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
9262. 
9263. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
9264. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
9265. 
9266. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
9267. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
9268. 
9269. 	SetVariable(ZoneFragments,				"!ZONE210N!")
9270. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
9271. 		
9272. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
9273. /* identical code to here: (separation not needed. TEST.) */	
9274. 
9275. # Current Gap, Actual and Free Values
9276. 	# Gap
9277. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
9278. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
9279. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
9280. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
9281. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
9282. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
9283. 	
9284. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
9285. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
9286. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
9287. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
9288. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
9289. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
9290. 	
9291. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
9292. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
9293. 	
9294. 	# Actual Size and End
9295. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
9296. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
9297. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
9298. 	
9299. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
9300. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
9301. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
9302. 
9303. # Gap Size & Rounding
9304. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
9305. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
9306. 	
9307. 	# Free Space
9308. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
9309. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
9310. 
9311. 	# Footer:
9312. SetVariable(ZoneFooter, "----------------------------------------------------------
9313. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
9314. 
9315. Statistics Report:
9316. ------------------
9317.    Size:  
9318.    ------------------------
9319.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9320.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9321.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9322. 
9323.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9324.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9325. 
9326.    Location:
9327.    ------------------------
9328.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9329.              Files End: !ZoneEndCurrent!
9330.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9331.       
9332.    Gap Settings:
9333.    ------------------------
9334.          Gap Requested: !ZoneGapSizePer!%
9335.       Volume Rounding: !ZoneVolRoundUpPer!%
9336.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9337.                  
9338.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
9339.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
9340.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
9341.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
9342.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
9343.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
9344.      
9345.    Free Space after Zone:
9346.    ------------------------
9347.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9348.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9349.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9350. 
9351. Directory and Files Select:
9352. ---------------------------
9353. !ZoneTypeSelectCurrent!               
9354. ---------------------------
9355. ----------------------------------------------------------
9356. ")
9357. 	# Zone Footer Set Statistics Window Text
9358. 
9359. SetStatisticsWindowText("!Heading!
9360. ----------------------------------------------------------
9361. Zones Processed: 
9362. ----------------------------------------------------------
9363. !ZoneListByLine!
9364. ----------------------------------------------------------
9365. Zone Processing Step:
9366. !ZoneStepByLine!    
9367. ----------------------------------------------------------
9368. Current Zone:
9369. !ZoneFooter!
9370. ----------------------------------------------------------
9371. Volume Statistics:
9372. !VolumeStatisticsDetail!
9373. ----------------------------------------------------------
9374. Zone Detailed Report:
9375. ----------------------------------------------------------
9376. !ZoneStatisticsDetail!
9377. ----------------------------------------------------------
9378. ")
9379. 
9380. 
9381. 	
9382.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
9383. 
9384. 	# Add Zone to list of zones for display.
9385. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
9386. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
9387. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
9388. 	# ??? Free Stats?
9389. 	# Footer:
9390. SetVariable(ZoneFooter, "----------------------------------------------------------
9391. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
9392. 
9393. Statistics Report:
9394. ------------------
9395.    Size:  
9396.    ------------------------
9397.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9398.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9399.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9400. 
9401.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9402.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9403. 
9404.    Location:
9405.    ------------------------
9406.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9407.              Files End: !ZoneEndCurrent!
9408.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9409.       
9410.    Gap Settings:
9411.    ------------------------
9412.          Gap Requested: !ZoneGapSizePer!%
9413.       Volume Rounding: !ZoneVolRoundUpPer!%
9414.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9415.                  
9416.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
9417.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
9418.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
9419.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
9420.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
9421.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
9422.      
9423.    Free Space after Zone:
9424.    ------------------------
9425.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9426.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9427.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9428. 
9429. Directory and Files Select:
9430. ---------------------------
9431. !ZoneTypeSelectCurrent!               
9432. ---------------------------
9433. ----------------------------------------------------------
9434. ")
9435. 
9436. 	# Add Zone Details to Report.	
9437. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
9438. !ZoneFooter!")
9439. 
9440. 
9441. 	
9442. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
9443. 			# Script: DisplaySetFileStep
9444. 
9445. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9446. 
9447. /* add message and move to a new line. */
9448. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9449. ")
9450. 
9451. /* display the line. (hopefully.) */
9452. # Zone Footer Set Statistics Window Text
9453. 
9454. SetStatisticsWindowText("!Heading!
9455. ----------------------------------------------------------
9456. Zones Processed: 
9457. ----------------------------------------------------------
9458. !ZoneListByLine!
9459. ----------------------------------------------------------
9460. Zone Processing Step:
9461. !ZoneStepByLine!    
9462. ----------------------------------------------------------
9463. Current Zone:
9464. !ZoneFooter!
9465. ----------------------------------------------------------
9466. Volume Statistics:
9467. !VolumeStatisticsDetail!
9468. ----------------------------------------------------------
9469. Zone Detailed Report:
9470. ----------------------------------------------------------
9471. !ZoneStatisticsDetail!
9472. ----------------------------------------------------------
9473. ")
9474. 
9475. 
9476. 
9477. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9478. 
9479. # Script: BannerSet
9480. 
9481. # Script: DisplaySetDateTimeRun
9482. 
9483. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
9484. /* Xinclude "..\Display\BannerSet.MyDc"X */
9485. /* pause(1) */
9486. 
9487. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
9488. 
9489. Title('!Heading!')
9490. /* pause(1) */
9491. 
9492. /* NOTE: Can't round or truncate to integer precision. */
9493. 
9494. pause(1)
9495. 
9496. 			# File Action - Type Os Programs Fixed - Fast - MoveUpToZone.
9497. 	MoveUpToZone()
9498. 	
9499. 	
9500. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
9501. 			# Script: DisplaySetFileStep
9502. 
9503. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9504. 
9505. /* add message and move to a new line. */
9506. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9507. ")
9508. 
9509. /* display the line. (hopefully.) */
9510. # Zone Footer Set Statistics Window Text
9511. 
9512. SetStatisticsWindowText("!Heading!
9513. ----------------------------------------------------------
9514. Zones Processed: 
9515. ----------------------------------------------------------
9516. !ZoneListByLine!
9517. ----------------------------------------------------------
9518. Zone Processing Step:
9519. !ZoneStepByLine!    
9520. ----------------------------------------------------------
9521. Current Zone:
9522. !ZoneFooter!
9523. ----------------------------------------------------------
9524. Volume Statistics:
9525. !VolumeStatisticsDetail!
9526. ----------------------------------------------------------
9527. Zone Detailed Report:
9528. ----------------------------------------------------------
9529. !ZoneStatisticsDetail!
9530. ----------------------------------------------------------
9531. ")
9532. 
9533. 
9534. 
9535. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9536. 
9537. # Script: BannerSet
9538. 
9539. # Script: DisplaySetDateTimeRun
9540. 
9541. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
9542. /* Xinclude "..\Display\BannerSet.MyDc"X */
9543. /* pause(1) */
9544. 
9545. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
9546. 
9547. Title('!Heading!')
9548. /* pause(1) */
9549. 
9550. /* NOTE: Can't round or truncate to integer precision. */
9551. 
9552. pause(1)
9553. 
9554. 		# Script: ZoneDoFooter
9555. 
9556. /* ---------------------------------------------------------- */
9557. # File Select
9558. 	# Select Statments
9559. # File Actions 
9560. 	# Standard or OS File Actions.
9561. 	# Resume...
9562. 	
9563. 	# your stuff HERE (X)... post zone (file) file actions code.
9564. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
9565. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9566. 		# (X)
9567. 		
9568. 		/* ??? Set window? */
9569. 	
9570. 	# ADD THE GAP
9571. # Vacate (good for diagnostics)
9572. # DoNotVacate - DO NOT Vacate (recommended)
9573. # DoNotVacate - DO NOT Vacate (recommended)
9574. 
9575. # Vacate
9576. /* AddGap(GapUsedLoc) */
9577. 
9578. # DO Not Vacate
9579. AddGap(GapUsedLoc, DoNotVacate) 
9580. 	
9581. 	
9582. # Script: GapZoneCommand
9583. # *** Moved to setting yours ***
9584. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
9585. # Controlled via settings commands
9586. # DoNotVacate - DO NOT Vacate (recommended)
9587. 
9588. # Vacate
9589. /* AddGap(GapUsedLoc) */
9590. 
9591. # DO Not Vacate
9592. AddGap(GapUsedLoc, DoNotVacate) 
9593. 	
9594. 	
9595. # Vacate /* AddGap(GapUsed) */
9596. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
9597. 	
9598. 
9599. 		
9600. # 
9601. FileEnd
9602. /* ---------------------------------------------------------- */
9603. 
9604. # your stuff HERE (X)... post zone (file) code.
9605. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
9606. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9607. 	# (X)
9608. 
9609. SetVariable(FileStepDescription,"Zone finished, reporting.")
9610. # Script: DisplaySetFileStep
9611. 
9612. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9613. 
9614. /* add message and move to a new line. */
9615. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9616. ")
9617. 
9618. /* display the line. (hopefully.) */
9619. # Zone Footer Set Statistics Window Text
9620. 
9621. SetStatisticsWindowText("!Heading!
9622. ----------------------------------------------------------
9623. Zones Processed: 
9624. ----------------------------------------------------------
9625. !ZoneListByLine!
9626. ----------------------------------------------------------
9627. Zone Processing Step:
9628. !ZoneStepByLine!    
9629. ----------------------------------------------------------
9630. Current Zone:
9631. !ZoneFooter!
9632. ----------------------------------------------------------
9633. Volume Statistics:
9634. !VolumeStatisticsDetail!
9635. ----------------------------------------------------------
9636. Zone Detailed Report:
9637. ----------------------------------------------------------
9638. !ZoneStatisticsDetail!
9639. ----------------------------------------------------------
9640. ")
9641. 
9642. 
9643. 
9644. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9645. 
9646. # Script: BannerSet
9647. 
9648. # Script: DisplaySetDateTimeRun
9649. 
9650. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
9651. /* Xinclude "..\Display\BannerSet.MyDc"X */
9652. /* pause(1) */
9653. 
9654. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
9655. 
9656. Title('!Heading!')
9657. /* pause(1) */
9658. 
9659. /* NOTE: Can't round or truncate to integer precision. */
9660. 
9661. pause(1)
9662. 
9663. # Script: ZoneWhenFinished
9664. 
9665. # Script: BannerSet
9666. 
9667. # Script: DisplaySetDateTimeRun
9668. 
9669. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
9670. /* Xinclude "..\Display\BannerSet.MyDc"X */
9671. /* pause(1) */
9672. 
9673. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
9674. 
9675. Title('!Heading!')
9676. /* pause(1) */
9677. 
9678. /* NOTE: Can't round or truncate to integer precision. */
9679. 
9680. # Script: BannerLog
9681. 
9682. AppendLogfile("!LogFileName!", "!Title!")
9683. 
9684. 
9685. 
9686. # Zone Statistics	
9687. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
9688. 
9689. # Footer:
9690. SetVariable(ZoneFooter, "----------------------------------------------------------
9691. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
9692. 
9693. Statistics Report:
9694. ------------------
9695.    Size:  
9696.    ------------------------
9697.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9698.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9699.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9700. 
9701.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9702.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9703. 
9704.    Location:
9705.    ------------------------
9706.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9707.              Files End: !ZoneEndCurrent!
9708.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9709.       
9710.    Gap Settings:
9711.    ------------------------
9712.          Gap Requested: !ZoneGapSizePer!%
9713.       Volume Rounding: !ZoneVolRoundUpPer!%
9714.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9715.                  
9716.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
9717.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
9718.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
9719.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
9720.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
9721.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
9722.      
9723.    Free Space after Zone:
9724.    ------------------------
9725.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9726.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9727.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9728. 
9729. Directory and Files Select:
9730. ---------------------------
9731. !ZoneTypeSelectCurrent!               
9732. ---------------------------
9733. ----------------------------------------------------------
9734. ")
9735. 
9736. AppendLogfile("!LogFileName!", ".")
9737. AppendLogfile("!LogFileName!", "!ZoneFooter!")
9738. AppendLogfile("!LogFileName!", ".")
9739. 
9740. # Zone Footer Set Statistics Window Text
9741. 
9742. SetStatisticsWindowText("!Heading!
9743. ----------------------------------------------------------
9744. Zones Processed: 
9745. ----------------------------------------------------------
9746. !ZoneListByLine!
9747. ----------------------------------------------------------
9748. Zone Processing Step:
9749. !ZoneStepByLine!    
9750. ----------------------------------------------------------
9751. Current Zone:
9752. !ZoneFooter!
9753. ----------------------------------------------------------
9754. Volume Statistics:
9755. !VolumeStatisticsDetail!
9756. ----------------------------------------------------------
9757. Zone Detailed Report:
9758. ----------------------------------------------------------
9759. !ZoneStatisticsDetail!
9760. ----------------------------------------------------------
9761. ")
9762. 
9763. 
9764. 
9765. /* pause() */
9766. /* pause() */
9767. 
9768. 
9769. 
9770. 	
9771. /* ---------------------------------------------------------- */
9772. # Zone Program Data.
9773. 	# Script: DisplayColors - Zone Dark
9774. # Processed
9775. SetFileColor(All, Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
9776. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
9777. 
9778. # Light Green and Yellow
9779. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
9780. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
9781. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
9782. 
9783. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsData!")
9784. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsData!")
9785. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
9786. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
9787. 	SetVariable(ZoneTypeSelect,'
9788.                 # Programs - Data files.
9789.                 not(
9790.                 # Os PageHiberDump start.
9791. (
9792.   FileName("DataStore.edb")
9793.   or FileName("DUMP*.*")
9794.   or FileName("Hiberfil.sys")
9795.   or FileName("MEMORY.DMP")
9796.   or FileName("Pagefile.sys")
9797. )
9798. # Os PageHiberDump end.
9799. 
9800.                 )
9801. ')
9802. 
9803. 		# Script: ZoneDoHeader
9804. 
9805. # Script: ZoneWhenStarted
9806. 
9807. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
9808. # Script: DisplaySetZone
9809. 
9810. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
9811. SetVariable(FileStepDescription,	"")
9812. 
9813. SetVariable(ZoneStepByLine, 			"Zone started.
9814. ")
9815. 
9816. # Script: BannerDescriptionSet
9817. 
9818. # Script: BannerSet
9819. 
9820. # Script: DisplaySetDateTimeRun
9821. 
9822. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
9823. /* Xinclude "..\Display\BannerSet.MyDc"X */
9824. /* pause(1) */
9825. 
9826. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
9827. 
9828. Title('!Heading!')
9829. /* pause(1) */
9830. 
9831. /* NOTE: Can't round or truncate to integer precision. */
9832. 
9833. # Script: BannerLog
9834. 
9835. AppendLogfile("!LogFileName!", "!Title!")
9836. 
9837. 
9838. 
9839. pause(1)
9840. 
9841. 
9842. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
9843. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
9844. 
9845. SetVariable(ZoneStepNoCurrent, 0)
9846. 
9847. 
9848. # Script: ZoneDoCurrentClear
9849. 
9850. SetVariable(ZoneTypeSelectCurrent, 		"")
9851. 
9852. SetVariable(ZoneBeginCurrent, 			0)
9853. SetVariable(ZoneBeginPerCurrent, 		0)
9854. SetVariable(ZoneEndCurrent, 			0)
9855. SetVariable(ZoneEndPerCurrent, 			0)
9856. 
9857. SetVariable(ZoneSizeCurrent,			0)
9858. SetVariable(ZoneSizePerCurrent,			0)
9859. 
9860. SetVariable(ZoneGapRequestedCurrent,	0)
9861. SetVariable(ZoneGapRoundedCurrent, 		0)
9862. SetVariable(ZoneGapAdjustedCurrent, 	0)
9863. SetVariable(ZoneGapAvailableCurrent, 	0)
9864. SetVariable(ZoneGapCurrent,				0)
9865. SetVariable(ZoneGapUsedCurrent, 		0)
9866. 
9867. SetVariable(ZoneGapActualCurrent, 		0)
9868. SetVariable(ZoneGapActualPerCurrent, 	0)
9869. 
9870. SetVariable(ZoneSizeActual, 			0)
9871. SetVariable(ZoneSizeActualCurrent,		0)
9872. 
9873. SetVariable(ZoneEndActual, 				0)
9874. SetVariable(ZoneEndActualCurrent,		0)			
9875. SetVariable(ZoneSizeActualPerCurrent, 	0)
9876.       
9877. SetVariable(ZoneFilesFolders,			0)
9878. SetVariable(ZoneFilesFoldersPer,		0) 
9879. 
9880. SetVariable(ZoneFragments,				0)
9881. SetVariable(ZoneFragmentsPer,			0) 
9882. 		
9883. SetVariable(ZoneEndActualCurrent, 		0)
9884. SetVariable(ZoneEndActualPerCurrent, 	0)
9885. 
9886. # Gap Calculation Methodology:
9887. 	# Requested
9888. 	SetVariable(GapRequested, 			0) 
9889. 	SetVariable(GapRequestedStd, 		0) 
9890. 	SetVariable(GapRequestedMft, 		0) 
9891. 	SetVariable(GapRequestedOs, 		0) 
9892. 	SetVariable(GapRequestedOriginal, 	0) 
9893. 	
9894. 	# Gap Adjustments
9895. 	SetVariable(GapRounded, 			0)
9896. 	# SetVariable(GapAdjusted, 			0)
9897. 	SetVariable(GapAvailable, 			0)
9898. 	SetVariable(GapCurrent, 			0)
9899. 	SetVariable(GapActual, 				0)
9900. 	SetVariable(GapUsed, 				0)
9901. 	
9902. 	# Gap Adjustments
9903. 	SetVariable(GapRoundedLoc, 			0)
9904. 	# SetVariable(GapAdjustedLoc, 		0)
9905. 	SetVariable(GapAvailableLoc, 		0)
9906. 	SetVariable(GapCurrentLoc, 			0)
9907. 	SetVariable(GapActualLoc,			0)
9908. 	SetVariable(GapUsedLoc,				0)
9909. 	
9910. 	# Space usage
9911. 	SetVariable(ZoneFreePerRequested, 	0)
9912. 	SetVariable(ZoneFreePerUsed, 		0)
9913. 
9914. # Gap Size & Rounding
9915. 	SetVariable(ZoneGapSizePer, 		0)
9916. 	SetVariable(ZoneVolRoundUpPer, 		0)
9917. 	
9918. 	# Free Space
9919. 	SetVariable(ZoneFreeUsedPer, 		0)
9920. 	SetVariable(ZoneFreeRequestedPer, 	0)
9921. 
9922. 
9923. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
9924. 
9925. # Footer:
9926. SetVariable(ZoneFooter, "----------------------------------------------------------
9927. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
9928. 
9929. Statistics Report:
9930. ------------------
9931.    Size:  
9932.    ------------------------
9933.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9934.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9935.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9936. 
9937.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9938.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9939. 
9940.    Location:
9941.    ------------------------
9942.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9943.              Files End: !ZoneEndCurrent!
9944.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9945.       
9946.    Gap Settings:
9947.    ------------------------
9948.          Gap Requested: !ZoneGapSizePer!%
9949.       Volume Rounding: !ZoneVolRoundUpPer!%
9950.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9951.                  
9952.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
9953.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
9954.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
9955.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
9956.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
9957.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
9958.      
9959.    Free Space after Zone:
9960.    ------------------------
9961.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9962.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9963.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9964. 
9965. Directory and Files Select:
9966. ---------------------------
9967. !ZoneTypeSelectCurrent!               
9968. ---------------------------
9969. ----------------------------------------------------------
9970. ")
9971. 
9972. # Script: BannerSet
9973. 
9974. # Script: DisplaySetDateTimeRun
9975. 
9976. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
9977. /* Xinclude "..\Display\BannerSet.MyDc"X */
9978. /* pause(1) */
9979. 
9980. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
9981. 
9982. Title('!Heading!')
9983. /* pause(1) */
9984. 
9985. /* NOTE: Can't round or truncate to integer precision. */
9986. 
9987. # Script: BannerLog
9988. 
9989. AppendLogfile("!LogFileName!", "!Title!")
9990. 
9991. 
9992. 
9993. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
9994. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
9995. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:20")
9996. 
9997. SetVariable(ZoneListByLine, "!ZoneListByLine!
9998. Zone: !ZoneNoCurrent! 2021-11-13 20:31:20 0:00:03 !ZoneLabel! !ZoneDescription!")
9999. 
10000. 
10001. /* Fixed Zone Position Handling */
10002. /* Literal number: */
10003. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
10004. /* Percentage of disk: */
10005. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
10006. /* Gap */
10007. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
10008. 
10009. /* ---------------------------------------------------------- */
10010. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
10011. # Script: DisplaySetFileStep
10012. 
10013. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10014. 
10015. /* add message and move to a new line. */
10016. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10017. ")
10018. 
10019. /* display the line. (hopefully.) */
10020. # Zone Footer Set Statistics Window Text
10021. 
10022. SetStatisticsWindowText("!Heading!
10023. ----------------------------------------------------------
10024. Zones Processed: 
10025. ----------------------------------------------------------
10026. !ZoneListByLine!
10027. ----------------------------------------------------------
10028. Zone Processing Step:
10029. !ZoneStepByLine!    
10030. ----------------------------------------------------------
10031. Current Zone:
10032. !ZoneFooter!
10033. ----------------------------------------------------------
10034. Volume Statistics:
10035. !VolumeStatisticsDetail!
10036. ----------------------------------------------------------
10037. Zone Detailed Report:
10038. ----------------------------------------------------------
10039. !ZoneStatisticsDetail!
10040. ----------------------------------------------------------
10041. ")
10042. 
10043. 
10044. 
10045. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10046. 
10047. # Script: BannerSet
10048. 
10049. # Script: DisplaySetDateTimeRun
10050. 
10051. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
10052. /* Xinclude "..\Display\BannerSet.MyDc"X */
10053. /* pause(1) */
10054. 
10055. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
10056. 
10057. Title('!Heading!')
10058. /* pause(1) */
10059. 
10060. /* NOTE: Can't round or truncate to integer precision. */
10061. 
10062. pause(1)
10063. 
10064. # your stuff HERE (X)... pre file select code.
10065. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
10066. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
10067. 	# (X)
10068. 
10069. FileSelect
10070. 
10071. 	# your stuff can't really go here (errors.)
10072. 	# maybe for some reason I don't know of...
10073. 	
10074. 	# Actions next...
10075. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
10076. # Programs start.
10077. # NotBlobsArchivesBu start.
10078. (not (
10079. # Blobs start.
10080. (
10081. # BlobsAndExceptions start.
10082. ( not(
10083.   FileName("*.bat")
10084.   or FileName("*.css")
10085.   or FileName("*.dll")
10086.   or FileName("*.exe")
10087.   or FileName("*.htm*")
10088.   or FileName("*.jar")
10089.   or FileName("*.js")
10090.   or FileName("*.script")
10091.   or FileName("*.wsf")
10092.   or (
10093. # Databases start.
10094. (
10095.   FileName("*.crypt*")
10096.   or FileName("*.db*")
10097.   or FileName("*.rdb*")
10098.   or FileName("*.dc*")
10099.   or FileName("*.dict*")
10100.   or FileName("*.?db*")
10101.   or FileName("*.?rdb*")
10102.   or FileName("*.md*")
10103.   or FileName("*.myd")
10104.   or FileName("*.ndf")
10105.   or FileName("*.ns?")
10106.   or FileName("*.pab")
10107.   or FileName("*.pst")
10108.   or FileName("*.sd?*")
10109.   or FileName("*.sq**")
10110.   or FileName("*.tmd")
10111.   or FileName("*.tps")
10112.   or FileName("*.tr*")
10113. )
10114. # Databases end.
10115. 
10116.     # BlobsAndExceptions
10117.     or 
10118. # Data start.
10119. (
10120.   DirectoryName("Data*")
10121.   or DirectoryName("Device*")
10122.   or DirectoryName("Export*")
10123.   or DirectoryName("Import*")
10124.   or DirectoryName("Log*")
10125.   or DirectoryName("*Log")
10126.   or DirectoryName("Maintenance*")
10127.   or DirectoryName("Rec*")
10128.   or DirectoryName("Sales*")
10129.   or DirectoryName("Search*")
10130.   or DirectoryName("User*")
10131. )
10132. # Data end.
10133. 
10134.     # BlobsAndExceptions
10135.   )
10136. ) )
10137. # BlobsAndExceptions end.
10138. 
10139. # Blobs
10140. ) and (
10141.   Size(BlobFileSize,0)
10142.   or (
10143.     FileName("*.arj")
10144.     or FileName("*.bup")
10145.     or FileName("*.bz2")
10146.     or FileName("*.chm")
10147.     or FileName("*.dvr-ms")
10148.     or FileName("*.gz")
10149.     or FileName("*.ifo")
10150.     or FileName("*.lzh")
10151.     or FileName("*.pdf")
10152.     or FileName("*.rpm")
10153.     or FileName("*.wmv")
10154.     or FileName("*.vob")
10155.     or FileName("*.z")
10156.   ) 
10157. )
10158. # Blobs end.
10159. 
10160. # NotBlobsArchivesBu
10161. or 
10162. # Archives start.
10163. (
10164.   DirectoryName("*Archive*")
10165.   or DirectoryName("*History*")
10166.   or DirectoryName("*Old")
10167.   or DirectoryName("* Old *")
10168.   or DirectoryName("Old *")
10169. 
10170.   or FileName("*.7z")
10171.   or FileName("*.cab")
10172.   or FileName("*.iso")
10173.   or FileName("*.msi")
10174.   or FileName("*.old")
10175.   or FileName("*.rar")
10176.   or FileName("*.tar")
10177.   or FileName("*.zip")
10178.   or
10179. # WinSysLow start.
10180. (
10181.   DirectoryName("$*")
10182.   or DirectoryName("0*")
10183.   or DirectoryName("1*")
10184.   or DirectoryName("2*")
10185.   or DirectoryName("3*")
10186.   or DirectoryName("4*")
10187.   or DirectoryName("5*")
10188.   or DirectoryName("6*")
10189.   or DirectoryName("7*")
10190.   or DirectoryName("8*")
10191.   or DirectoryName("9*")
10192. 
10193.   or DirectoryName("dllcache")
10194.   or DirectoryName("Downloaded Installations")
10195.   or DirectoryName("Ehome")
10196.   or DirectoryName("Fonts")
10197.   or DirectoryName("Help")
10198.   or DirectoryName("I386")
10199.   or DirectoryName("ie?updates")
10200.   or DirectoryName("Installer")
10201.   or DirectoryName("Installshield Installation Information")
10202.   or DirectoryName("IME")
10203.   or DirectoryName("*RECYCLE*")
10204.   or DirectoryName("ServicePackFiles")
10205.   or DirectoryName("SoftwareDistribution")
10206.   or DirectoryName("Speech")
10207.   or DirectoryName("Symbols")
10208.   or DirectoryName("System Volume Information")
10209.   or DirectoryName("windows.old")
10210. )
10211. # WinSysLow end.
10212. 
10213.   # Archives
10214. )
10215. # Archives end.
10216. 
10217. # NotBlobsArchivesBu
10218. or
10219. # Backups start.
10220. (
10221.   DirectoryName("*Backup*")
10222.   or DirectoryName("*Bu")
10223.   or DirectoryName("* Bu *")
10224.   or DirectoryName("Bu *")
10225. 
10226.   or FileName("*.bak")
10227.   or FileName("* - Copy*")
10228. )
10229. # Backups end.
10230. 
10231. # NotBlobsArchivesBu
10232. ) )
10233. # NotBlobsArchivesBu end.
10234. 
10235. # Programs
10236. and (
10237. # SystemDir start.
10238. (
10239.   DirectoryName("Boot*")
10240.   or DirectoryName("Device*")
10241.   or DirectoryName("DevSupport*")
10242.   or DirectoryName("Program*")
10243.   or DirectoryName("Security*")
10244.   or DirectoryName("SendTo*")
10245.   or DirectoryName("Sw*")
10246.   or DirectoryName("System*")
10247.   or DirectoryName("Toolbars")
10248.   or DirectoryName("Windows*")
10249. )
10250. # SystemDir end.
10251. 
10252. # Programs
10253. )
10254. # Programs end.
10255. 
10256. 		and not(
10257. 			# Os PageHiberDump start.
10258. (
10259.   FileName("DataStore.edb")
10260.   or FileName("DUMP*.*")
10261.   or FileName("Hiberfil.sys")
10262.   or FileName("MEMORY.DMP")
10263.   or FileName("Pagefile.sys")
10264. )
10265. # Os PageHiberDump end.
10266. 
10267. 		)
10268. 
10269. 		FileActions
10270. 		  		/* ---------------------------------------------------------- */
10271. 	# Gap
10272. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
10273. 		# Script: DisplaySetFileStep
10274. 
10275. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10276. 
10277. /* add message and move to a new line. */
10278. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10279. ")
10280. 
10281. /* display the line. (hopefully.) */
10282. # Zone Footer Set Statistics Window Text
10283. 
10284. SetStatisticsWindowText("!Heading!
10285. ----------------------------------------------------------
10286. Zones Processed: 
10287. ----------------------------------------------------------
10288. !ZoneListByLine!
10289. ----------------------------------------------------------
10290. Zone Processing Step:
10291. !ZoneStepByLine!    
10292. ----------------------------------------------------------
10293. Current Zone:
10294. !ZoneFooter!
10295. ----------------------------------------------------------
10296. Volume Statistics:
10297. !VolumeStatisticsDetail!
10298. ----------------------------------------------------------
10299. Zone Detailed Report:
10300. ----------------------------------------------------------
10301. !ZoneStatisticsDetail!
10302. ----------------------------------------------------------
10303. ")
10304. 
10305. 
10306. 
10307. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10308. 
10309. # Script: BannerSet
10310. 
10311. # Script: DisplaySetDateTimeRun
10312. 
10313. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
10314. /* Xinclude "..\Display\BannerSet.MyDc"X */
10315. /* pause(1) */
10316. 
10317. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
10318. 
10319. Title('!Heading!')
10320. /* pause(1) */
10321. 
10322. /* NOTE: Can't round or truncate to integer precision. */
10323. 
10324. pause(1)
10325. 	
10326. 	# ACTUAL GAP
10327. 		/* AddGap Variant. */
10328. 	  	# Zone Do Gap
10329. # Gap Calculation Methods:
10330. 
10331. /* 1) Anything you need to add first. */
10332. /* empty */
10333. 
10334. /* ---------------------------------------------------------- */
10335. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
10336. 	# GapRequestedStd.
10337. 
10338. 		/* ---------------------------------------------------------- */
10339. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
10340. 
10341. 		# Gap Calculation Methods:
10342. 
10343. /* AddGap Variants */
10344. 
10345. 	/* Standard */
10346. 		# Gap Calculation Methods:
10347. 	/* AddGap Variants */
10348. 	/* Standard */
10349. 
10350. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
10351. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
10352. 
10353. 	SetVariable(GapRequested, GapRequestedStd)
10354. 	
10355. 
10356. 	/* MFT Low High Method */
10357. 		# Gap Calculation Methods:
10358. 	/* AddGap Variants */
10359. 	/* MFT Low High Method */
10360. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
10361. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
10362. 	SetVariable(GapRequested, GapRequestedMft)
10363. 	
10364. 
10365. 	/* OS Volume Type Method */
10366. 		# Gap Calculation Methods:
10367. 	/* AddGap Variants */
10368. 	/* OS Volume Type Method */
10369. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
10370. 	SetVariable(GapRequested, GapRequestedOs)
10371. 
10372. 
10373. 
10374. /* MakeGap Variants */
10375. 
10376. 	/* Original Os 1-3 + MFT 2 */
10377. 		# Gap Calculation Methods:
10378. 	/* MakeGap Variants */
10379. 	/* Original Os 1-3 + MFT 2 */
10380. 	/* plus MFT gap placed inline at the dividing zone. */
10381. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
10382. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
10383. 	SetVariable(GapRequested, GapRequestedOrig)
10384. 	
10385. 	
10386. /* Note: You could comment out the ones not in use */
10387. /* However having the data in the log is useful. */
10388. /* Therefore the following line is otherwise needed. */
10389. 
10390. /* Standard used */
10391. 
10392. SetVariable(GapRequested, GapRequestedStd)
10393. 
10394. # Gap Calculation Methods:
10395. 
10396. /* AddGap Variants */
10397. 	/* Standard */
10398. 	/* MFT Low High Method */
10399. 	/* OS Volume Type Method */
10400. 
10401. /* MakeGap Variants */
10402. 	/* Original Os 1-3 + MFT 2 */
10403. 
10404. /* Note: You could comment out the ones not in use */
10405. /* However having the data in the log is useful. */
10406. /* Therefore the following line is otherwise needed. */
10407. 
10408. /* Standard is used currently */
10409. 
10410. 
10411. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
10412. 
10413. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
10414. 
10415. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
10416. 
10417. /* ---------------------------------------------------------- */
10418. /* 3) SMALL ZONE ADJUSTMENT. */
10419. /* Gab cant be larger than half the Zone Size. */
10420. 
10421. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
10422. 	
10423. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
10424. 
10425. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
10426. 
10427. /* ---------------------------------------------------------- */
10428. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
10429. # Gap Adjustments.
10430. 
10431. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
10432. 	
10433. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
10434. 
10435. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
10436. 
10437. /* ---------------------------------------------------------- */
10438. # BYPASS THIS.
10439. 	/* This is definitely wrong. */
10440. 	/* The question is can we steal gap from the next zone */
10441. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
10442. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
10443. 		# Zone Overflow.
10444. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
10445. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
10446. 
10447. /* ---------------------------------------------------------- */
10448. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
10449. # Remaining free space available.
10450. 
10451. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
10452. 	
10453. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
10454. 
10455. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
10456. 
10457. /* ---------------------------------------------------------- */
10458. # CURRENT gap to use.
10459. 
10460. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
10461. 
10462. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
10463. 
10464. /* ---------------------------------------------------------- */
10465. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
10466. # Debugging.
10467. 
10468. 	SetVariable(GapUsed, GapCurrent) // for debugging
10469. 
10470. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
10471. 
10472. 		# Your code HERE
10473. 
10474. /* ---------------------------------------------------------- */
10475. /* 7) YOUR CODE. */
10476. # YOUR CODE HERE:
10477. 	# INPUT: GapCurrent or GapCurrentLoc
10478. 	# OUTPUT: GapUsed...
10479. 
10480. /* ---------------------------------------------------------- */
10481. # Gap Size.
10482. # Actual Size of Gap.
10483. 
10484. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
10485. 
10486. /* ---------------------------------------------------------- */
10487. /* xxxxxxxxxxxxxxxxxxxxxx */
10488. # ADD THE GAP
10489. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
10490. /* xxxxxxxxxxxxxxxxxxxxxx */
10491. 
10492. 	
10493. 	# Zone Statistics	
10494. 	# Script: ZoneDoStatistics
10495. # Zone / Volume Statistics and Display
10496. 		
10497. 	# Accumulate Totals
10498.   	# Script: ZoneDoVolumeTotals
10499. 
10500. /* Current total space used (by Zones and Gaps) */
10501. 
10502. SetVariable(VolumeZoneUsed, GapUsed)
10503. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
10504. /* Percentage */
10505. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
10506. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
10507. 
10508. /* Current total of free space requested */
10509. 
10510. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
10511. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10512. /* Percent. */
10513. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
10514. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10515. 
10516. /* Current total of free space used */
10517. 
10518. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
10519. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
10520. /* Percent */
10521. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
10522. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
10523. 
10524. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
10525. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
10526. /* Xinclude "..\DebugDisplayPause.MyDc"X */
10527. 
10528. 
10529. 	# Current Values
10530. 	# Script: ZoneDoCurrentSet
10531. 
10532. # Cluster, Sector, Block adjust for display.
10533. 	# Bytes per cluster is volume specific.
10534. 
10535. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
10536. 
10537. # Current Zone values.
10538. 	# Begin, end and size.
10539. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
10540. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
10541. 
10542. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
10543. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
10544. 
10545. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
10546. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
10547. 
10548. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
10549. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
10550. 
10551. 	SetVariable(ZoneFragments,				"!ZONE210N!")
10552. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
10553. 		
10554. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
10555. /* identical code to here: (separation not needed. TEST.) */	
10556. 
10557. # Current Gap, Actual and Free Values
10558. 	# Gap
10559. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
10560. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
10561. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
10562. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
10563. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
10564. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
10565. 	
10566. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
10567. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
10568. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
10569. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
10570. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
10571. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
10572. 	
10573. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
10574. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
10575. 	
10576. 	# Actual Size and End
10577. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
10578. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
10579. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
10580. 	
10581. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
10582. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
10583. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
10584. 
10585. # Gap Size & Rounding
10586. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
10587. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
10588. 	
10589. 	# Free Space
10590. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
10591. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
10592. 
10593. 	# Footer:
10594. SetVariable(ZoneFooter, "----------------------------------------------------------
10595. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
10596. 
10597. Statistics Report:
10598. ------------------
10599.    Size:  
10600.    ------------------------
10601.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10602.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10603.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10604. 
10605.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10606.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10607. 
10608.    Location:
10609.    ------------------------
10610.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10611.              Files End: !ZoneEndCurrent!
10612.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10613.       
10614.    Gap Settings:
10615.    ------------------------
10616.          Gap Requested: !ZoneGapSizePer!%
10617.       Volume Rounding: !ZoneVolRoundUpPer!%
10618.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10619.                  
10620.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
10621.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
10622.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
10623.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
10624.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
10625.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
10626.      
10627.    Free Space after Zone:
10628.    ------------------------
10629.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10630.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10631.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10632. 
10633. Directory and Files Select:
10634. ---------------------------
10635. !ZoneTypeSelectCurrent!               
10636. ---------------------------
10637. ----------------------------------------------------------
10638. ")
10639. 	# Zone Footer Set Statistics Window Text
10640. 
10641. SetStatisticsWindowText("!Heading!
10642. ----------------------------------------------------------
10643. Zones Processed: 
10644. ----------------------------------------------------------
10645. !ZoneListByLine!
10646. ----------------------------------------------------------
10647. Zone Processing Step:
10648. !ZoneStepByLine!    
10649. ----------------------------------------------------------
10650. Current Zone:
10651. !ZoneFooter!
10652. ----------------------------------------------------------
10653. Volume Statistics:
10654. !VolumeStatisticsDetail!
10655. ----------------------------------------------------------
10656. Zone Detailed Report:
10657. ----------------------------------------------------------
10658. !ZoneStatisticsDetail!
10659. ----------------------------------------------------------
10660. ")
10661. 
10662. 
10663. 	
10664.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
10665. 
10666. 	# Add Zone to list of zones for display.
10667. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
10668. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
10669. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
10670. 	# ??? Free Stats?
10671. 	# Footer:
10672. SetVariable(ZoneFooter, "----------------------------------------------------------
10673. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
10674. 
10675. Statistics Report:
10676. ------------------
10677.    Size:  
10678.    ------------------------
10679.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10680.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10681.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10682. 
10683.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10684.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10685. 
10686.    Location:
10687.    ------------------------
10688.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10689.              Files End: !ZoneEndCurrent!
10690.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10691.       
10692.    Gap Settings:
10693.    ------------------------
10694.          Gap Requested: !ZoneGapSizePer!%
10695.       Volume Rounding: !ZoneVolRoundUpPer!%
10696.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10697.                  
10698.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
10699.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
10700.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
10701.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
10702.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
10703.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
10704.      
10705.    Free Space after Zone:
10706.    ------------------------
10707.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10708.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10709.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10710. 
10711. Directory and Files Select:
10712. ---------------------------
10713. !ZoneTypeSelectCurrent!               
10714. ---------------------------
10715. ----------------------------------------------------------
10716. ")
10717. 
10718. 	# Add Zone Details to Report.	
10719. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
10720. !ZoneFooter!")
10721. 
10722. 
10723. 	
10724. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
10725. 			# Script: DisplaySetFileStep
10726. 
10727. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10728. 
10729. /* add message and move to a new line. */
10730. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10731. ")
10732. 
10733. /* display the line. (hopefully.) */
10734. # Zone Footer Set Statistics Window Text
10735. 
10736. SetStatisticsWindowText("!Heading!
10737. ----------------------------------------------------------
10738. Zones Processed: 
10739. ----------------------------------------------------------
10740. !ZoneListByLine!
10741. ----------------------------------------------------------
10742. Zone Processing Step:
10743. !ZoneStepByLine!    
10744. ----------------------------------------------------------
10745. Current Zone:
10746. !ZoneFooter!
10747. ----------------------------------------------------------
10748. Volume Statistics:
10749. !VolumeStatisticsDetail!
10750. ----------------------------------------------------------
10751. Zone Detailed Report:
10752. ----------------------------------------------------------
10753. !ZoneStatisticsDetail!
10754. ----------------------------------------------------------
10755. ")
10756. 
10757. 
10758. 
10759. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10760. 
10761. # Script: BannerSet
10762. 
10763. # Script: DisplaySetDateTimeRun
10764. 
10765. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
10766. /* Xinclude "..\Display\BannerSet.MyDc"X */
10767. /* pause(1) */
10768. 
10769. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
10770. 
10771. Title('!Heading!')
10772. /* pause(1) */
10773. 
10774. /* NOTE: Can't round or truncate to integer precision. */
10775. 
10776. pause(1)
10777. 
10778. 			# File Action - Type Os Programs - Fast - MoveUpToZone.
10779. # File Action - SortByImportSequence with SkipBlock.
10780. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
10781. 	
10782. 	
10783. 	
10784. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
10785. 			# Script: DisplaySetFileStep
10786. 
10787. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10788. 
10789. /* add message and move to a new line. */
10790. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10791. ")
10792. 
10793. /* display the line. (hopefully.) */
10794. # Zone Footer Set Statistics Window Text
10795. 
10796. SetStatisticsWindowText("!Heading!
10797. ----------------------------------------------------------
10798. Zones Processed: 
10799. ----------------------------------------------------------
10800. !ZoneListByLine!
10801. ----------------------------------------------------------
10802. Zone Processing Step:
10803. !ZoneStepByLine!    
10804. ----------------------------------------------------------
10805. Current Zone:
10806. !ZoneFooter!
10807. ----------------------------------------------------------
10808. Volume Statistics:
10809. !VolumeStatisticsDetail!
10810. ----------------------------------------------------------
10811. Zone Detailed Report:
10812. ----------------------------------------------------------
10813. !ZoneStatisticsDetail!
10814. ----------------------------------------------------------
10815. ")
10816. 
10817. 
10818. 
10819. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10820. 
10821. # Script: BannerSet
10822. 
10823. # Script: DisplaySetDateTimeRun
10824. 
10825. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
10826. /* Xinclude "..\Display\BannerSet.MyDc"X */
10827. /* pause(1) */
10828. 
10829. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
10830. 
10831. Title('!Heading!')
10832. /* pause(1) */
10833. 
10834. /* NOTE: Can't round or truncate to integer precision. */
10835. 
10836. pause(1)
10837. 
10838. 		# Script: ZoneDoFooter
10839. 
10840. /* ---------------------------------------------------------- */
10841. # File Select
10842. 	# Select Statments
10843. # File Actions 
10844. 	# Standard or OS File Actions.
10845. 	# Resume...
10846. 	
10847. 	# your stuff HERE (X)... post zone (file) file actions code.
10848. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
10849. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
10850. 		# (X)
10851. 		
10852. 		/* ??? Set window? */
10853. 	
10854. 	# ADD THE GAP
10855. # Vacate (good for diagnostics)
10856. # DoNotVacate - DO NOT Vacate (recommended)
10857. # DoNotVacate - DO NOT Vacate (recommended)
10858. 
10859. # Vacate
10860. /* AddGap(GapUsedLoc) */
10861. 
10862. # DO Not Vacate
10863. AddGap(GapUsedLoc, DoNotVacate) 
10864. 	
10865. 	
10866. # Script: GapZoneCommand
10867. # *** Moved to setting yours ***
10868. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
10869. # Controlled via settings commands
10870. # DoNotVacate - DO NOT Vacate (recommended)
10871. 
10872. # Vacate
10873. /* AddGap(GapUsedLoc) */
10874. 
10875. # DO Not Vacate
10876. AddGap(GapUsedLoc, DoNotVacate) 
10877. 	
10878. 	
10879. # Vacate /* AddGap(GapUsed) */
10880. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
10881. 	
10882. 
10883. 		
10884. # 
10885. FileEnd
10886. /* ---------------------------------------------------------- */
10887. 
10888. # your stuff HERE (X)... post zone (file) code.
10889. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
10890. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
10891. 	# (X)
10892. 
10893. SetVariable(FileStepDescription,"Zone finished, reporting.")
10894. # Script: DisplaySetFileStep
10895. 
10896. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10897. 
10898. /* add message and move to a new line. */
10899. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10900. ")
10901. 
10902. /* display the line. (hopefully.) */
10903. # Zone Footer Set Statistics Window Text
10904. 
10905. SetStatisticsWindowText("!Heading!
10906. ----------------------------------------------------------
10907. Zones Processed: 
10908. ----------------------------------------------------------
10909. !ZoneListByLine!
10910. ----------------------------------------------------------
10911. Zone Processing Step:
10912. !ZoneStepByLine!    
10913. ----------------------------------------------------------
10914. Current Zone:
10915. !ZoneFooter!
10916. ----------------------------------------------------------
10917. Volume Statistics:
10918. !VolumeStatisticsDetail!
10919. ----------------------------------------------------------
10920. Zone Detailed Report:
10921. ----------------------------------------------------------
10922. !ZoneStatisticsDetail!
10923. ----------------------------------------------------------
10924. ")
10925. 
10926. 
10927. 
10928. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10929. 
10930. # Script: BannerSet
10931. 
10932. # Script: DisplaySetDateTimeRun
10933. 
10934. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
10935. /* Xinclude "..\Display\BannerSet.MyDc"X */
10936. /* pause(1) */
10937. 
10938. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
10939. 
10940. Title('!Heading!')
10941. /* pause(1) */
10942. 
10943. /* NOTE: Can't round or truncate to integer precision. */
10944. 
10945. pause(1)
10946. 
10947. # Script: ZoneWhenFinished
10948. 
10949. # Script: BannerSet
10950. 
10951. # Script: DisplaySetDateTimeRun
10952. 
10953. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
10954. /* Xinclude "..\Display\BannerSet.MyDc"X */
10955. /* pause(1) */
10956. 
10957. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
10958. 
10959. Title('!Heading!')
10960. /* pause(1) */
10961. 
10962. /* NOTE: Can't round or truncate to integer precision. */
10963. 
10964. # Script: BannerLog
10965. 
10966. AppendLogfile("!LogFileName!", "!Title!")
10967. 
10968. 
10969. 
10970. # Zone Statistics	
10971. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
10972. 
10973. # Footer:
10974. SetVariable(ZoneFooter, "----------------------------------------------------------
10975. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
10976. 
10977. Statistics Report:
10978. ------------------
10979.    Size:  
10980.    ------------------------
10981.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10982.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10983.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10984. 
10985.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10986.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10987. 
10988.    Location:
10989.    ------------------------
10990.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10991.              Files End: !ZoneEndCurrent!
10992.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10993.       
10994.    Gap Settings:
10995.    ------------------------
10996.          Gap Requested: !ZoneGapSizePer!%
10997.       Volume Rounding: !ZoneVolRoundUpPer!%
10998.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10999.                  
11000.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
11001.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
11002.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
11003.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
11004.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
11005.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
11006.      
11007.    Free Space after Zone:
11008.    ------------------------
11009.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11010.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11011.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11012. 
11013. Directory and Files Select:
11014. ---------------------------
11015. !ZoneTypeSelectCurrent!               
11016. ---------------------------
11017. ----------------------------------------------------------
11018. ")
11019. 
11020. AppendLogfile("!LogFileName!", ".")
11021. AppendLogfile("!LogFileName!", "!ZoneFooter!")
11022. AppendLogfile("!LogFileName!", ".")
11023. 
11024. # Zone Footer Set Statistics Window Text
11025. 
11026. SetStatisticsWindowText("!Heading!
11027. ----------------------------------------------------------
11028. Zones Processed: 
11029. ----------------------------------------------------------
11030. !ZoneListByLine!
11031. ----------------------------------------------------------
11032. Zone Processing Step:
11033. !ZoneStepByLine!    
11034. ----------------------------------------------------------
11035. Current Zone:
11036. !ZoneFooter!
11037. ----------------------------------------------------------
11038. Volume Statistics:
11039. !VolumeStatisticsDetail!
11040. ----------------------------------------------------------
11041. Zone Detailed Report:
11042. ----------------------------------------------------------
11043. !ZoneStatisticsDetail!
11044. ----------------------------------------------------------
11045. ")
11046. 
11047. 
11048. 
11049. /* pause() */
11050. /* pause() */
11051. 
11052. 
11053. 
11054. 	
11055. /* ---------------------------------------------------------- */
11056. 
11057. 
11058. /* ---------------------------------------------------------- */
11059. /* OLD: ToDo */
11060. 	/* Zone 1 and 2 originally */
11061. 	/* Originally the MFT and DIRs were processed first. */
11062. 	/* Zone 4 and 5 normally */
11063. 	/* The MakeGap call is put between which ever zones you want */
11064. 	/* So the actual zone number is unknown */
11065. 	/* SetVariable(ZoneCurrent,"4, 5") */
11066. 	/* MakeGap(RoundUp(VolumeUsed * (!MftPer! + 0.15), VolumeSize * ZoneVolRoundUpLarge), DoNotVacate) */
11067. 
11068. /* ---------------------------------------------------------- */
11069. SetVariable(FileStepDescription,"System Zones completed.")
11070. # Script: DisplaySetFileStep
11071. 
11072. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11073. 
11074. /* add message and move to a new line. */
11075. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11076. ")
11077. 
11078. /* display the line. (hopefully.) */
11079. # Zone Footer Set Statistics Window Text
11080. 
11081. SetStatisticsWindowText("!Heading!
11082. ----------------------------------------------------------
11083. Zones Processed: 
11084. ----------------------------------------------------------
11085. !ZoneListByLine!
11086. ----------------------------------------------------------
11087. Zone Processing Step:
11088. !ZoneStepByLine!    
11089. ----------------------------------------------------------
11090. Current Zone:
11091. !ZoneFooter!
11092. ----------------------------------------------------------
11093. Volume Statistics:
11094. !VolumeStatisticsDetail!
11095. ----------------------------------------------------------
11096. Zone Detailed Report:
11097. ----------------------------------------------------------
11098. !ZoneStatisticsDetail!
11099. ----------------------------------------------------------
11100. ")
11101. 
11102. 
11103. 
11104. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11105. 
11106. # Script: BannerSet
11107. 
11108. # Script: DisplaySetDateTimeRun
11109. 
11110. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
11111. /* Xinclude "..\Display\BannerSet.MyDc"X */
11112. /* pause(1) */
11113. 
11114. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
11115. 
11116. Title('!Heading!')
11117. /* pause(1) */
11118. 
11119. /* NOTE: Can't round or truncate to integer precision. */
11120. 
11121. pause(1)
11122. 
11123. 
11124. /* ---------------------------------------------------------- */
11125. /* Any Volume Regular Zones */
11126. /* ---------------------------------------------------------- */
11127. 
11128. /* ---------------------------------------------------------- */
11129. /* Zone 8 IdeScripts Ide, Scripts, Support */
11130. # Script: DisplayColors - Zone Dark
11131. # Processed
11132. SetFileColor(All, Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
11133. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
11134. 
11135. # Light Green and Yellow
11136. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
11137. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
11138. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
11139. 
11140. # Script: DefragZoneTypeIdeScripts
11141. /* ---------------------------------------------------------- */
11142. /* Zone IdeScripts Ide, Scripts, Support */
11143. 
11144. SetVariable(ZoneLabel, "!ZoneLabelIdeScripts!")
11145. SetVariable(ZoneDescription, "!ZoneDescriptionIdeScripts!")
11146. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpIdeScripts!")
11147. SetVariable(ZoneGapSize, "!ZoneGapSizeIdeScripts!")
11148. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectIdeScripts
11149. # IdeScripts start.
11150. # NotBlobsArchivesBu start.
11151. (not (
11152. # Blobs start.
11153. (
11154. # BlobsAndExceptions start.
11155. ( not(
11156.   FileName("*.bat")
11157.   or FileName("*.css")
11158.   or FileName("*.dll")
11159.   or FileName("*.exe")
11160.   or FileName("*.htm*")
11161.   or FileName("*.jar")
11162.   or FileName("*.js")
11163.   or FileName("*.script")
11164.   or FileName("*.wsf")
11165.   or (
11166. # Databases start.
11167. (
11168.   FileName("*.crypt*")
11169.   or FileName("*.db*")
11170.   or FileName("*.rdb*")
11171.   or FileName("*.dc*")
11172.   or FileName("*.dict*")
11173.   or FileName("*.?db*")
11174.   or FileName("*.?rdb*")
11175.   or FileName("*.md*")
11176.   or FileName("*.myd")
11177.   or FileName("*.ndf")
11178.   or FileName("*.ns?")
11179.   or FileName("*.pab")
11180.   or FileName("*.pst")
11181.   or FileName("*.sd?*")
11182.   or FileName("*.sq**")
11183.   or FileName("*.tmd")
11184.   or FileName("*.tps")
11185.   or FileName("*.tr*")
11186. )
11187. # Databases end.
11188. 
11189.     # BlobsAndExceptions
11190.     or 
11191. # Data start.
11192. (
11193.   DirectoryName("Data*")
11194.   or DirectoryName("Device*")
11195.   or DirectoryName("Export*")
11196.   or DirectoryName("Import*")
11197.   or DirectoryName("Log*")
11198.   or DirectoryName("*Log")
11199.   or DirectoryName("Maintenance*")
11200.   or DirectoryName("Rec*")
11201.   or DirectoryName("Sales*")
11202.   or DirectoryName("Search*")
11203.   or DirectoryName("User*")
11204. )
11205. # Data end.
11206. 
11207.     # BlobsAndExceptions
11208.   )
11209. ) )
11210. # BlobsAndExceptions end.
11211. 
11212. # Blobs
11213. ) and (
11214.   Size(BlobFileSize,0)
11215.   or (
11216.     FileName("*.arj")
11217.     or FileName("*.bup")
11218.     or FileName("*.bz2")
11219.     or FileName("*.chm")
11220.     or FileName("*.dvr-ms")
11221.     or FileName("*.gz")
11222.     or FileName("*.ifo")
11223.     or FileName("*.lzh")
11224.     or FileName("*.pdf")
11225.     or FileName("*.rpm")
11226.     or FileName("*.wmv")
11227.     or FileName("*.vob")
11228.     or FileName("*.z")
11229.   ) 
11230. )
11231. # Blobs end.
11232. 
11233. # NotBlobsArchivesBu
11234. or 
11235. # Archives start.
11236. (
11237.   DirectoryName("*Archive*")
11238.   or DirectoryName("*History*")
11239.   or DirectoryName("*Old")
11240.   or DirectoryName("* Old *")
11241.   or DirectoryName("Old *")
11242. 
11243.   or FileName("*.7z")
11244.   or FileName("*.cab")
11245.   or FileName("*.iso")
11246.   or FileName("*.msi")
11247.   or FileName("*.old")
11248.   or FileName("*.rar")
11249.   or FileName("*.tar")
11250.   or FileName("*.zip")
11251.   or
11252. # WinSysLow start.
11253. (
11254.   DirectoryName("$*")
11255.   or DirectoryName("0*")
11256.   or DirectoryName("1*")
11257.   or DirectoryName("2*")
11258.   or DirectoryName("3*")
11259.   or DirectoryName("4*")
11260.   or DirectoryName("5*")
11261.   or DirectoryName("6*")
11262.   or DirectoryName("7*")
11263.   or DirectoryName("8*")
11264.   or DirectoryName("9*")
11265. 
11266.   or DirectoryName("dllcache")
11267.   or DirectoryName("Downloaded Installations")
11268.   or DirectoryName("Ehome")
11269.   or DirectoryName("Fonts")
11270.   or DirectoryName("Help")
11271.   or DirectoryName("I386")
11272.   or DirectoryName("ie?updates")
11273.   or DirectoryName("Installer")
11274.   or DirectoryName("Installshield Installation Information")
11275.   or DirectoryName("IME")
11276.   or DirectoryName("*RECYCLE*")
11277.   or DirectoryName("ServicePackFiles")
11278.   or DirectoryName("SoftwareDistribution")
11279.   or DirectoryName("Speech")
11280.   or DirectoryName("Symbols")
11281.   or DirectoryName("System Volume Information")
11282.   or DirectoryName("windows.old")
11283. )
11284. # WinSysLow end.
11285. 
11286.   # Archives
11287. )
11288. # Archives end.
11289. 
11290. # NotBlobsArchivesBu
11291. or
11292. # Backups start.
11293. (
11294.   DirectoryName("*Backup*")
11295.   or DirectoryName("*Bu")
11296.   or DirectoryName("* Bu *")
11297.   or DirectoryName("Bu *")
11298. 
11299.   or FileName("*.bak")
11300.   or FileName("* - Copy*")
11301. )
11302. # Backups end.
11303. 
11304. # NotBlobsArchivesBu
11305. ) )
11306. # NotBlobsArchivesBu end.
11307. 
11308. # IdeScripts
11309. and ( 
11310. # Ide start.
11311. (
11312.     DirectoryName("Ide*")
11313.     or DirectoryName("Java*")
11314.     or DirectoryName("Os")
11315. )
11316. # Ide end.
11317. 
11318. # IdeScripts
11319. or  
11320. # Scripts start.
11321. (
11322.   DirectoryName("*Script*")
11323. )
11324. # Scripts end.
11325. 
11326. # IdeScripts
11327. )
11328. # IdeScripts end.
11329. ')
11330. 
11331. 	# Script: ZoneDoHeader
11332. 
11333. # Script: ZoneWhenStarted
11334. 
11335. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
11336. # Script: DisplaySetZone
11337. 
11338. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
11339. SetVariable(FileStepDescription,	"")
11340. 
11341. SetVariable(ZoneStepByLine, 			"Zone started.
11342. ")
11343. 
11344. # Script: BannerDescriptionSet
11345. 
11346. # Script: BannerSet
11347. 
11348. # Script: DisplaySetDateTimeRun
11349. 
11350. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
11351. /* Xinclude "..\Display\BannerSet.MyDc"X */
11352. /* pause(1) */
11353. 
11354. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
11355. 
11356. Title('!Heading!')
11357. /* pause(1) */
11358. 
11359. /* NOTE: Can't round or truncate to integer precision. */
11360. 
11361. # Script: BannerLog
11362. 
11363. AppendLogfile("!LogFileName!", "!Title!")
11364. 
11365. 
11366. 
11367. pause(1)
11368. 
11369. 
11370. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
11371. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
11372. 
11373. SetVariable(ZoneStepNoCurrent, 0)
11374. 
11375. 
11376. # Script: ZoneDoCurrentClear
11377. 
11378. SetVariable(ZoneTypeSelectCurrent, 		"")
11379. 
11380. SetVariable(ZoneBeginCurrent, 			0)
11381. SetVariable(ZoneBeginPerCurrent, 		0)
11382. SetVariable(ZoneEndCurrent, 			0)
11383. SetVariable(ZoneEndPerCurrent, 			0)
11384. 
11385. SetVariable(ZoneSizeCurrent,			0)
11386. SetVariable(ZoneSizePerCurrent,			0)
11387. 
11388. SetVariable(ZoneGapRequestedCurrent,	0)
11389. SetVariable(ZoneGapRoundedCurrent, 		0)
11390. SetVariable(ZoneGapAdjustedCurrent, 	0)
11391. SetVariable(ZoneGapAvailableCurrent, 	0)
11392. SetVariable(ZoneGapCurrent,				0)
11393. SetVariable(ZoneGapUsedCurrent, 		0)
11394. 
11395. SetVariable(ZoneGapActualCurrent, 		0)
11396. SetVariable(ZoneGapActualPerCurrent, 	0)
11397. 
11398. SetVariable(ZoneSizeActual, 			0)
11399. SetVariable(ZoneSizeActualCurrent,		0)
11400. 
11401. SetVariable(ZoneEndActual, 				0)
11402. SetVariable(ZoneEndActualCurrent,		0)			
11403. SetVariable(ZoneSizeActualPerCurrent, 	0)
11404.       
11405. SetVariable(ZoneFilesFolders,			0)
11406. SetVariable(ZoneFilesFoldersPer,		0) 
11407. 
11408. SetVariable(ZoneFragments,				0)
11409. SetVariable(ZoneFragmentsPer,			0) 
11410. 		
11411. SetVariable(ZoneEndActualCurrent, 		0)
11412. SetVariable(ZoneEndActualPerCurrent, 	0)
11413. 
11414. # Gap Calculation Methodology:
11415. 	# Requested
11416. 	SetVariable(GapRequested, 			0) 
11417. 	SetVariable(GapRequestedStd, 		0) 
11418. 	SetVariable(GapRequestedMft, 		0) 
11419. 	SetVariable(GapRequestedOs, 		0) 
11420. 	SetVariable(GapRequestedOriginal, 	0) 
11421. 	
11422. 	# Gap Adjustments
11423. 	SetVariable(GapRounded, 			0)
11424. 	# SetVariable(GapAdjusted, 			0)
11425. 	SetVariable(GapAvailable, 			0)
11426. 	SetVariable(GapCurrent, 			0)
11427. 	SetVariable(GapActual, 				0)
11428. 	SetVariable(GapUsed, 				0)
11429. 	
11430. 	# Gap Adjustments
11431. 	SetVariable(GapRoundedLoc, 			0)
11432. 	# SetVariable(GapAdjustedLoc, 		0)
11433. 	SetVariable(GapAvailableLoc, 		0)
11434. 	SetVariable(GapCurrentLoc, 			0)
11435. 	SetVariable(GapActualLoc,			0)
11436. 	SetVariable(GapUsedLoc,				0)
11437. 	
11438. 	# Space usage
11439. 	SetVariable(ZoneFreePerRequested, 	0)
11440. 	SetVariable(ZoneFreePerUsed, 		0)
11441. 
11442. # Gap Size & Rounding
11443. 	SetVariable(ZoneGapSizePer, 		0)
11444. 	SetVariable(ZoneVolRoundUpPer, 		0)
11445. 	
11446. 	# Free Space
11447. 	SetVariable(ZoneFreeUsedPer, 		0)
11448. 	SetVariable(ZoneFreeRequestedPer, 	0)
11449. 
11450. 
11451. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
11452. 
11453. # Footer:
11454. SetVariable(ZoneFooter, "----------------------------------------------------------
11455. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
11456. 
11457. Statistics Report:
11458. ------------------
11459.    Size:  
11460.    ------------------------
11461.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11462.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11463.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11464. 
11465.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11466.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11467. 
11468.    Location:
11469.    ------------------------
11470.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11471.              Files End: !ZoneEndCurrent!
11472.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11473.       
11474.    Gap Settings:
11475.    ------------------------
11476.          Gap Requested: !ZoneGapSizePer!%
11477.       Volume Rounding: !ZoneVolRoundUpPer!%
11478.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11479.                  
11480.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
11481.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
11482.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
11483.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
11484.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
11485.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
11486.      
11487.    Free Space after Zone:
11488.    ------------------------
11489.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11490.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11491.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11492. 
11493. Directory and Files Select:
11494. ---------------------------
11495. !ZoneTypeSelectCurrent!               
11496. ---------------------------
11497. ----------------------------------------------------------
11498. ")
11499. 
11500. # Script: BannerSet
11501. 
11502. # Script: DisplaySetDateTimeRun
11503. 
11504. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
11505. /* Xinclude "..\Display\BannerSet.MyDc"X */
11506. /* pause(1) */
11507. 
11508. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
11509. 
11510. Title('!Heading!')
11511. /* pause(1) */
11512. 
11513. /* NOTE: Can't round or truncate to integer precision. */
11514. 
11515. # Script: BannerLog
11516. 
11517. AppendLogfile("!LogFileName!", "!Title!")
11518. 
11519. 
11520. 
11521. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
11522. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
11523. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:20")
11524. 
11525. SetVariable(ZoneListByLine, "!ZoneListByLine!
11526. Zone: !ZoneNoCurrent! 2021-11-13 20:31:20 0:00:03 !ZoneLabel! !ZoneDescription!")
11527. 
11528. 
11529. /* Fixed Zone Position Handling */
11530. /* Literal number: */
11531. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
11532. /* Percentage of disk: */
11533. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
11534. /* Gap */
11535. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
11536. 
11537. /* ---------------------------------------------------------- */
11538. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
11539. # Script: DisplaySetFileStep
11540. 
11541. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11542. 
11543. /* add message and move to a new line. */
11544. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11545. ")
11546. 
11547. /* display the line. (hopefully.) */
11548. # Zone Footer Set Statistics Window Text
11549. 
11550. SetStatisticsWindowText("!Heading!
11551. ----------------------------------------------------------
11552. Zones Processed: 
11553. ----------------------------------------------------------
11554. !ZoneListByLine!
11555. ----------------------------------------------------------
11556. Zone Processing Step:
11557. !ZoneStepByLine!    
11558. ----------------------------------------------------------
11559. Current Zone:
11560. !ZoneFooter!
11561. ----------------------------------------------------------
11562. Volume Statistics:
11563. !VolumeStatisticsDetail!
11564. ----------------------------------------------------------
11565. Zone Detailed Report:
11566. ----------------------------------------------------------
11567. !ZoneStatisticsDetail!
11568. ----------------------------------------------------------
11569. ")
11570. 
11571. 
11572. 
11573. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11574. 
11575. # Script: BannerSet
11576. 
11577. # Script: DisplaySetDateTimeRun
11578. 
11579. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
11580. /* Xinclude "..\Display\BannerSet.MyDc"X */
11581. /* pause(1) */
11582. 
11583. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
11584. 
11585. Title('!Heading!')
11586. /* pause(1) */
11587. 
11588. /* NOTE: Can't round or truncate to integer precision. */
11589. 
11590. pause(1)
11591. 
11592. # your stuff HERE (X)... pre file select code.
11593. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
11594. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
11595. 	# (X)
11596. 
11597. FileSelect
11598. 
11599. 	# your stuff can't really go here (errors.)
11600. 	# maybe for some reason I don't know of...
11601. 	
11602. 	# Actions next...
11603. 	# Script: ZoneDo ZoneTypeSelectIdeScripts
11604. # IdeScripts start.
11605. # NotBlobsArchivesBu start.
11606. (not (
11607. # Blobs start.
11608. (
11609. # BlobsAndExceptions start.
11610. ( not(
11611.   FileName("*.bat")
11612.   or FileName("*.css")
11613.   or FileName("*.dll")
11614.   or FileName("*.exe")
11615.   or FileName("*.htm*")
11616.   or FileName("*.jar")
11617.   or FileName("*.js")
11618.   or FileName("*.script")
11619.   or FileName("*.wsf")
11620.   or (
11621. # Databases start.
11622. (
11623.   FileName("*.crypt*")
11624.   or FileName("*.db*")
11625.   or FileName("*.rdb*")
11626.   or FileName("*.dc*")
11627.   or FileName("*.dict*")
11628.   or FileName("*.?db*")
11629.   or FileName("*.?rdb*")
11630.   or FileName("*.md*")
11631.   or FileName("*.myd")
11632.   or FileName("*.ndf")
11633.   or FileName("*.ns?")
11634.   or FileName("*.pab")
11635.   or FileName("*.pst")
11636.   or FileName("*.sd?*")
11637.   or FileName("*.sq**")
11638.   or FileName("*.tmd")
11639.   or FileName("*.tps")
11640.   or FileName("*.tr*")
11641. )
11642. # Databases end.
11643. 
11644.     # BlobsAndExceptions
11645.     or 
11646. # Data start.
11647. (
11648.   DirectoryName("Data*")
11649.   or DirectoryName("Device*")
11650.   or DirectoryName("Export*")
11651.   or DirectoryName("Import*")
11652.   or DirectoryName("Log*")
11653.   or DirectoryName("*Log")
11654.   or DirectoryName("Maintenance*")
11655.   or DirectoryName("Rec*")
11656.   or DirectoryName("Sales*")
11657.   or DirectoryName("Search*")
11658.   or DirectoryName("User*")
11659. )
11660. # Data end.
11661. 
11662.     # BlobsAndExceptions
11663.   )
11664. ) )
11665. # BlobsAndExceptions end.
11666. 
11667. # Blobs
11668. ) and (
11669.   Size(BlobFileSize,0)
11670.   or (
11671.     FileName("*.arj")
11672.     or FileName("*.bup")
11673.     or FileName("*.bz2")
11674.     or FileName("*.chm")
11675.     or FileName("*.dvr-ms")
11676.     or FileName("*.gz")
11677.     or FileName("*.ifo")
11678.     or FileName("*.lzh")
11679.     or FileName("*.pdf")
11680.     or FileName("*.rpm")
11681.     or FileName("*.wmv")
11682.     or FileName("*.vob")
11683.     or FileName("*.z")
11684.   ) 
11685. )
11686. # Blobs end.
11687. 
11688. # NotBlobsArchivesBu
11689. or 
11690. # Archives start.
11691. (
11692.   DirectoryName("*Archive*")
11693.   or DirectoryName("*History*")
11694.   or DirectoryName("*Old")
11695.   or DirectoryName("* Old *")
11696.   or DirectoryName("Old *")
11697. 
11698.   or FileName("*.7z")
11699.   or FileName("*.cab")
11700.   or FileName("*.iso")
11701.   or FileName("*.msi")
11702.   or FileName("*.old")
11703.   or FileName("*.rar")
11704.   or FileName("*.tar")
11705.   or FileName("*.zip")
11706.   or
11707. # WinSysLow start.
11708. (
11709.   DirectoryName("$*")
11710.   or DirectoryName("0*")
11711.   or DirectoryName("1*")
11712.   or DirectoryName("2*")
11713.   or DirectoryName("3*")
11714.   or DirectoryName("4*")
11715.   or DirectoryName("5*")
11716.   or DirectoryName("6*")
11717.   or DirectoryName("7*")
11718.   or DirectoryName("8*")
11719.   or DirectoryName("9*")
11720. 
11721.   or DirectoryName("dllcache")
11722.   or DirectoryName("Downloaded Installations")
11723.   or DirectoryName("Ehome")
11724.   or DirectoryName("Fonts")
11725.   or DirectoryName("Help")
11726.   or DirectoryName("I386")
11727.   or DirectoryName("ie?updates")
11728.   or DirectoryName("Installer")
11729.   or DirectoryName("Installshield Installation Information")
11730.   or DirectoryName("IME")
11731.   or DirectoryName("*RECYCLE*")
11732.   or DirectoryName("ServicePackFiles")
11733.   or DirectoryName("SoftwareDistribution")
11734.   or DirectoryName("Speech")
11735.   or DirectoryName("Symbols")
11736.   or DirectoryName("System Volume Information")
11737.   or DirectoryName("windows.old")
11738. )
11739. # WinSysLow end.
11740. 
11741.   # Archives
11742. )
11743. # Archives end.
11744. 
11745. # NotBlobsArchivesBu
11746. or
11747. # Backups start.
11748. (
11749.   DirectoryName("*Backup*")
11750.   or DirectoryName("*Bu")
11751.   or DirectoryName("* Bu *")
11752.   or DirectoryName("Bu *")
11753. 
11754.   or FileName("*.bak")
11755.   or FileName("* - Copy*")
11756. )
11757. # Backups end.
11758. 
11759. # NotBlobsArchivesBu
11760. ) )
11761. # NotBlobsArchivesBu end.
11762. 
11763. # IdeScripts
11764. and ( 
11765. # Ide start.
11766. (
11767.     DirectoryName("Ide*")
11768.     or DirectoryName("Java*")
11769.     or DirectoryName("Os")
11770. )
11771. # Ide end.
11772. 
11773. # IdeScripts
11774. or  
11775. # Scripts start.
11776. (
11777.   DirectoryName("*Script*")
11778. )
11779. # Scripts end.
11780. 
11781. # IdeScripts
11782. )
11783. # IdeScripts end.
11784. 
11785. 	# Script: ZoneDoAction
11786. # Zone Do File Action - SortByName.
11787. 
11788. FileActions
11789. 
11790. 		/* ---------------------------------------------------------- */
11791. 	# Gap
11792. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
11793. 		# Script: DisplaySetFileStep
11794. 
11795. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11796. 
11797. /* add message and move to a new line. */
11798. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11799. ")
11800. 
11801. /* display the line. (hopefully.) */
11802. # Zone Footer Set Statistics Window Text
11803. 
11804. SetStatisticsWindowText("!Heading!
11805. ----------------------------------------------------------
11806. Zones Processed: 
11807. ----------------------------------------------------------
11808. !ZoneListByLine!
11809. ----------------------------------------------------------
11810. Zone Processing Step:
11811. !ZoneStepByLine!    
11812. ----------------------------------------------------------
11813. Current Zone:
11814. !ZoneFooter!
11815. ----------------------------------------------------------
11816. Volume Statistics:
11817. !VolumeStatisticsDetail!
11818. ----------------------------------------------------------
11819. Zone Detailed Report:
11820. ----------------------------------------------------------
11821. !ZoneStatisticsDetail!
11822. ----------------------------------------------------------
11823. ")
11824. 
11825. 
11826. 
11827. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11828. 
11829. # Script: BannerSet
11830. 
11831. # Script: DisplaySetDateTimeRun
11832. 
11833. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
11834. /* Xinclude "..\Display\BannerSet.MyDc"X */
11835. /* pause(1) */
11836. 
11837. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
11838. 
11839. Title('!Heading!')
11840. /* pause(1) */
11841. 
11842. /* NOTE: Can't round or truncate to integer precision. */
11843. 
11844. pause(1)
11845. 	
11846. 	# ACTUAL GAP
11847. 		/* AddGap Variant. */
11848. 	  	# Zone Do Gap
11849. # Gap Calculation Methods:
11850. 
11851. /* 1) Anything you need to add first. */
11852. /* empty */
11853. 
11854. /* ---------------------------------------------------------- */
11855. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
11856. 	# GapRequestedStd.
11857. 
11858. 		/* ---------------------------------------------------------- */
11859. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
11860. 
11861. 		# Gap Calculation Methods:
11862. 
11863. /* AddGap Variants */
11864. 
11865. 	/* Standard */
11866. 		# Gap Calculation Methods:
11867. 	/* AddGap Variants */
11868. 	/* Standard */
11869. 
11870. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
11871. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
11872. 
11873. 	SetVariable(GapRequested, GapRequestedStd)
11874. 	
11875. 
11876. 	/* MFT Low High Method */
11877. 		# Gap Calculation Methods:
11878. 	/* AddGap Variants */
11879. 	/* MFT Low High Method */
11880. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
11881. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
11882. 	SetVariable(GapRequested, GapRequestedMft)
11883. 	
11884. 
11885. 	/* OS Volume Type Method */
11886. 		# Gap Calculation Methods:
11887. 	/* AddGap Variants */
11888. 	/* OS Volume Type Method */
11889. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
11890. 	SetVariable(GapRequested, GapRequestedOs)
11891. 
11892. 
11893. 
11894. /* MakeGap Variants */
11895. 
11896. 	/* Original Os 1-3 + MFT 2 */
11897. 		# Gap Calculation Methods:
11898. 	/* MakeGap Variants */
11899. 	/* Original Os 1-3 + MFT 2 */
11900. 	/* plus MFT gap placed inline at the dividing zone. */
11901. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
11902. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
11903. 	SetVariable(GapRequested, GapRequestedOrig)
11904. 	
11905. 	
11906. /* Note: You could comment out the ones not in use */
11907. /* However having the data in the log is useful. */
11908. /* Therefore the following line is otherwise needed. */
11909. 
11910. /* Standard used */
11911. 
11912. SetVariable(GapRequested, GapRequestedStd)
11913. 
11914. # Gap Calculation Methods:
11915. 
11916. /* AddGap Variants */
11917. 	/* Standard */
11918. 	/* MFT Low High Method */
11919. 	/* OS Volume Type Method */
11920. 
11921. /* MakeGap Variants */
11922. 	/* Original Os 1-3 + MFT 2 */
11923. 
11924. /* Note: You could comment out the ones not in use */
11925. /* However having the data in the log is useful. */
11926. /* Therefore the following line is otherwise needed. */
11927. 
11928. /* Standard is used currently */
11929. 
11930. 
11931. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
11932. 
11933. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
11934. 
11935. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
11936. 
11937. /* ---------------------------------------------------------- */
11938. /* 3) SMALL ZONE ADJUSTMENT. */
11939. /* Gab cant be larger than half the Zone Size. */
11940. 
11941. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
11942. 	
11943. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
11944. 
11945. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
11946. 
11947. /* ---------------------------------------------------------- */
11948. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
11949. # Gap Adjustments.
11950. 
11951. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
11952. 	
11953. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
11954. 
11955. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
11956. 
11957. /* ---------------------------------------------------------- */
11958. # BYPASS THIS.
11959. 	/* This is definitely wrong. */
11960. 	/* The question is can we steal gap from the next zone */
11961. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
11962. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
11963. 		# Zone Overflow.
11964. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
11965. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
11966. 
11967. /* ---------------------------------------------------------- */
11968. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
11969. # Remaining free space available.
11970. 
11971. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
11972. 	
11973. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
11974. 
11975. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
11976. 
11977. /* ---------------------------------------------------------- */
11978. # CURRENT gap to use.
11979. 
11980. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
11981. 
11982. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
11983. 
11984. /* ---------------------------------------------------------- */
11985. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
11986. # Debugging.
11987. 
11988. 	SetVariable(GapUsed, GapCurrent) // for debugging
11989. 
11990. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
11991. 
11992. 		# Your code HERE
11993. 
11994. /* ---------------------------------------------------------- */
11995. /* 7) YOUR CODE. */
11996. # YOUR CODE HERE:
11997. 	# INPUT: GapCurrent or GapCurrentLoc
11998. 	# OUTPUT: GapUsed...
11999. 
12000. /* ---------------------------------------------------------- */
12001. # Gap Size.
12002. # Actual Size of Gap.
12003. 
12004. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
12005. 
12006. /* ---------------------------------------------------------- */
12007. /* xxxxxxxxxxxxxxxxxxxxxx */
12008. # ADD THE GAP
12009. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
12010. /* xxxxxxxxxxxxxxxxxxxxxx */
12011. 
12012. 	
12013. 	# Zone Statistics	
12014. 	# Script: ZoneDoStatistics
12015. # Zone / Volume Statistics and Display
12016. 		
12017. 	# Accumulate Totals
12018.   	# Script: ZoneDoVolumeTotals
12019. 
12020. /* Current total space used (by Zones and Gaps) */
12021. 
12022. SetVariable(VolumeZoneUsed, GapUsed)
12023. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
12024. /* Percentage */
12025. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
12026. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
12027. 
12028. /* Current total of free space requested */
12029. 
12030. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
12031. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
12032. /* Percent. */
12033. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
12034. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
12035. 
12036. /* Current total of free space used */
12037. 
12038. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
12039. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
12040. /* Percent */
12041. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
12042. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
12043. 
12044. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
12045. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
12046. /* Xinclude "..\DebugDisplayPause.MyDc"X */
12047. 
12048. 
12049. 	# Current Values
12050. 	# Script: ZoneDoCurrentSet
12051. 
12052. # Cluster, Sector, Block adjust for display.
12053. 	# Bytes per cluster is volume specific.
12054. 
12055. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
12056. 
12057. # Current Zone values.
12058. 	# Begin, end and size.
12059. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
12060. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
12061. 
12062. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
12063. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
12064. 
12065. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
12066. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
12067. 
12068. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
12069. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
12070. 
12071. 	SetVariable(ZoneFragments,				"!ZONE210N!")
12072. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
12073. 		
12074. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
12075. /* identical code to here: (separation not needed. TEST.) */	
12076. 
12077. # Current Gap, Actual and Free Values
12078. 	# Gap
12079. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
12080. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
12081. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
12082. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
12083. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
12084. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
12085. 	
12086. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
12087. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
12088. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
12089. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
12090. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
12091. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
12092. 	
12093. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
12094. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
12095. 	
12096. 	# Actual Size and End
12097. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
12098. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
12099. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
12100. 	
12101. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
12102. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
12103. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
12104. 
12105. # Gap Size & Rounding
12106. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
12107. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
12108. 	
12109. 	# Free Space
12110. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
12111. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
12112. 
12113. 	# Footer:
12114. SetVariable(ZoneFooter, "----------------------------------------------------------
12115. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
12116. 
12117. Statistics Report:
12118. ------------------
12119.    Size:  
12120.    ------------------------
12121.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12122.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12123.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12124. 
12125.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12126.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12127. 
12128.    Location:
12129.    ------------------------
12130.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12131.              Files End: !ZoneEndCurrent!
12132.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12133.       
12134.    Gap Settings:
12135.    ------------------------
12136.          Gap Requested: !ZoneGapSizePer!%
12137.       Volume Rounding: !ZoneVolRoundUpPer!%
12138.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12139.                  
12140.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
12141.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
12142.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
12143.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
12144.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
12145.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
12146.      
12147.    Free Space after Zone:
12148.    ------------------------
12149.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12150.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12151.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12152. 
12153. Directory and Files Select:
12154. ---------------------------
12155. !ZoneTypeSelectCurrent!               
12156. ---------------------------
12157. ----------------------------------------------------------
12158. ")
12159. 	# Zone Footer Set Statistics Window Text
12160. 
12161. SetStatisticsWindowText("!Heading!
12162. ----------------------------------------------------------
12163. Zones Processed: 
12164. ----------------------------------------------------------
12165. !ZoneListByLine!
12166. ----------------------------------------------------------
12167. Zone Processing Step:
12168. !ZoneStepByLine!    
12169. ----------------------------------------------------------
12170. Current Zone:
12171. !ZoneFooter!
12172. ----------------------------------------------------------
12173. Volume Statistics:
12174. !VolumeStatisticsDetail!
12175. ----------------------------------------------------------
12176. Zone Detailed Report:
12177. ----------------------------------------------------------
12178. !ZoneStatisticsDetail!
12179. ----------------------------------------------------------
12180. ")
12181. 
12182. 
12183. 	
12184.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
12185. 
12186. 	# Add Zone to list of zones for display.
12187. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
12188. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
12189. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
12190. 	# ??? Free Stats?
12191. 	# Footer:
12192. SetVariable(ZoneFooter, "----------------------------------------------------------
12193. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
12194. 
12195. Statistics Report:
12196. ------------------
12197.    Size:  
12198.    ------------------------
12199.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12200.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12201.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12202. 
12203.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12204.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12205. 
12206.    Location:
12207.    ------------------------
12208.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12209.              Files End: !ZoneEndCurrent!
12210.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12211.       
12212.    Gap Settings:
12213.    ------------------------
12214.          Gap Requested: !ZoneGapSizePer!%
12215.       Volume Rounding: !ZoneVolRoundUpPer!%
12216.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12217.                  
12218.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
12219.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
12220.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
12221.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
12222.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
12223.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
12224.      
12225.    Free Space after Zone:
12226.    ------------------------
12227.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12228.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12229.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12230. 
12231. Directory and Files Select:
12232. ---------------------------
12233. !ZoneTypeSelectCurrent!               
12234. ---------------------------
12235. ----------------------------------------------------------
12236. ")
12237. 
12238. 	# Add Zone Details to Report.	
12239. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
12240. !ZoneFooter!")
12241. 
12242. 
12243. 	
12244. 	# Footer:
12245. SetVariable(ZoneFooter, "----------------------------------------------------------
12246. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
12247. 
12248. Statistics Report:
12249. ------------------
12250.    Size:  
12251.    ------------------------
12252.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12253.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12254.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12255. 
12256.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12257.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12258. 
12259.    Location:
12260.    ------------------------
12261.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12262.              Files End: !ZoneEndCurrent!
12263.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12264.       
12265.    Gap Settings:
12266.    ------------------------
12267.          Gap Requested: !ZoneGapSizePer!%
12268.       Volume Rounding: !ZoneVolRoundUpPer!%
12269.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12270.                  
12271.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
12272.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
12273.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
12274.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
12275.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
12276.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
12277.      
12278.    Free Space after Zone:
12279.    ------------------------
12280.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12281.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12282.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12283. 
12284. Directory and Files Select:
12285. ---------------------------
12286. !ZoneTypeSelectCurrent!               
12287. ---------------------------
12288. ----------------------------------------------------------
12289. ")
12290. 	SetStatisticsWindowText("!ZoneFooter!")
12291. 	
12292. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
12293. 	# Script: DisplaySetFileStep
12294. 
12295. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12296. 
12297. /* add message and move to a new line. */
12298. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12299. ")
12300. 
12301. /* display the line. (hopefully.) */
12302. # Zone Footer Set Statistics Window Text
12303. 
12304. SetStatisticsWindowText("!Heading!
12305. ----------------------------------------------------------
12306. Zones Processed: 
12307. ----------------------------------------------------------
12308. !ZoneListByLine!
12309. ----------------------------------------------------------
12310. Zone Processing Step:
12311. !ZoneStepByLine!    
12312. ----------------------------------------------------------
12313. Current Zone:
12314. !ZoneFooter!
12315. ----------------------------------------------------------
12316. Volume Statistics:
12317. !VolumeStatisticsDetail!
12318. ----------------------------------------------------------
12319. Zone Detailed Report:
12320. ----------------------------------------------------------
12321. !ZoneStatisticsDetail!
12322. ----------------------------------------------------------
12323. ")
12324. 
12325. 
12326. 
12327. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12328. 
12329. # Script: BannerSet
12330. 
12331. # Script: DisplaySetDateTimeRun
12332. 
12333. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
12334. /* Xinclude "..\Display\BannerSet.MyDc"X */
12335. /* pause(1) */
12336. 
12337. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
12338. 
12339. Title('!Heading!')
12340. /* pause(1) */
12341. 
12342. /* NOTE: Can't round or truncate to integer precision. */
12343. 
12344. pause(1)
12345. 
12346. # Commands:
12347. 
12348. /* Moves to Zone or above it. */
12349. # MoveUpToZone()
12350. 
12351. # Defrag
12352. 
12353. # Defragment(OPTIONS)
12354. 
12355. /* Shuffles files around trying to make a big enough gap for fragmented files. */
12356. # Defragment()
12357. 
12358. /* Only does files where a gap will fit it. */
12359. # Defragment(Fast)
12360. 
12361. /* Skips fragmented files larger than the Chunck Size. */
12362. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
12363. # Defragment(Chunk Size)
12364. 
12365. /* Moves down to zone and packs zone to beginning if there are gaps. */
12366. /* Can be similar in performance to doing a SortBy. */
12367. # MoveDownFill()
12368. 
12369. # File Action - All - Fast - MoveUpToZone.
12370. 	MoveUpToZone()
12371. 	
12372. 
12373. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
12374. 	# Script: DisplaySetFileStep
12375. 
12376. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12377. 
12378. /* add message and move to a new line. */
12379. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12380. ")
12381. 
12382. /* display the line. (hopefully.) */
12383. # Zone Footer Set Statistics Window Text
12384. 
12385. SetStatisticsWindowText("!Heading!
12386. ----------------------------------------------------------
12387. Zones Processed: 
12388. ----------------------------------------------------------
12389. !ZoneListByLine!
12390. ----------------------------------------------------------
12391. Zone Processing Step:
12392. !ZoneStepByLine!    
12393. ----------------------------------------------------------
12394. Current Zone:
12395. !ZoneFooter!
12396. ----------------------------------------------------------
12397. Volume Statistics:
12398. !VolumeStatisticsDetail!
12399. ----------------------------------------------------------
12400. Zone Detailed Report:
12401. ----------------------------------------------------------
12402. !ZoneStatisticsDetail!
12403. ----------------------------------------------------------
12404. ")
12405. 
12406. 
12407. 
12408. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12409. 
12410. # Script: BannerSet
12411. 
12412. # Script: DisplaySetDateTimeRun
12413. 
12414. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
12415. /* Xinclude "..\Display\BannerSet.MyDc"X */
12416. /* pause(1) */
12417. 
12418. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
12419. 
12420. Title('!Heading!')
12421. /* pause(1) */
12422. 
12423. /* NOTE: Can't round or truncate to integer precision. */
12424. 
12425. pause(1)
12426. 
12427. 	# Script: ZoneDoFooter
12428. 
12429. /* ---------------------------------------------------------- */
12430. # File Select
12431. 	# Select Statments
12432. # File Actions 
12433. 	# Standard or OS File Actions.
12434. 	# Resume...
12435. 	
12436. 	# your stuff HERE (X)... post zone (file) file actions code.
12437. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
12438. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12439. 		# (X)
12440. 		
12441. 		/* ??? Set window? */
12442. 	
12443. 	# ADD THE GAP
12444. # Vacate (good for diagnostics)
12445. # DoNotVacate - DO NOT Vacate (recommended)
12446. # DoNotVacate - DO NOT Vacate (recommended)
12447. 
12448. # Vacate
12449. /* AddGap(GapUsedLoc) */
12450. 
12451. # DO Not Vacate
12452. AddGap(GapUsedLoc, DoNotVacate) 
12453. 	
12454. 	
12455. # Script: GapZoneCommand
12456. # *** Moved to setting yours ***
12457. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
12458. # Controlled via settings commands
12459. # DoNotVacate - DO NOT Vacate (recommended)
12460. 
12461. # Vacate
12462. /* AddGap(GapUsedLoc) */
12463. 
12464. # DO Not Vacate
12465. AddGap(GapUsedLoc, DoNotVacate) 
12466. 	
12467. 	
12468. # Vacate /* AddGap(GapUsed) */
12469. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
12470. 	
12471. 
12472. 		
12473. # 
12474. FileEnd
12475. /* ---------------------------------------------------------- */
12476. 
12477. # your stuff HERE (X)... post zone (file) code.
12478. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
12479. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12480. 	# (X)
12481. 
12482. SetVariable(FileStepDescription,"Zone finished, reporting.")
12483. # Script: DisplaySetFileStep
12484. 
12485. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12486. 
12487. /* add message and move to a new line. */
12488. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12489. ")
12490. 
12491. /* display the line. (hopefully.) */
12492. # Zone Footer Set Statistics Window Text
12493. 
12494. SetStatisticsWindowText("!Heading!
12495. ----------------------------------------------------------
12496. Zones Processed: 
12497. ----------------------------------------------------------
12498. !ZoneListByLine!
12499. ----------------------------------------------------------
12500. Zone Processing Step:
12501. !ZoneStepByLine!    
12502. ----------------------------------------------------------
12503. Current Zone:
12504. !ZoneFooter!
12505. ----------------------------------------------------------
12506. Volume Statistics:
12507. !VolumeStatisticsDetail!
12508. ----------------------------------------------------------
12509. Zone Detailed Report:
12510. ----------------------------------------------------------
12511. !ZoneStatisticsDetail!
12512. ----------------------------------------------------------
12513. ")
12514. 
12515. 
12516. 
12517. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12518. 
12519. # Script: BannerSet
12520. 
12521. # Script: DisplaySetDateTimeRun
12522. 
12523. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
12524. /* Xinclude "..\Display\BannerSet.MyDc"X */
12525. /* pause(1) */
12526. 
12527. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
12528. 
12529. Title('!Heading!')
12530. /* pause(1) */
12531. 
12532. /* NOTE: Can't round or truncate to integer precision. */
12533. 
12534. pause(1)
12535. 
12536. # Script: ZoneWhenFinished
12537. 
12538. # Script: BannerSet
12539. 
12540. # Script: DisplaySetDateTimeRun
12541. 
12542. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
12543. /* Xinclude "..\Display\BannerSet.MyDc"X */
12544. /* pause(1) */
12545. 
12546. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
12547. 
12548. Title('!Heading!')
12549. /* pause(1) */
12550. 
12551. /* NOTE: Can't round or truncate to integer precision. */
12552. 
12553. # Script: BannerLog
12554. 
12555. AppendLogfile("!LogFileName!", "!Title!")
12556. 
12557. 
12558. 
12559. # Zone Statistics	
12560. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
12561. 
12562. # Footer:
12563. SetVariable(ZoneFooter, "----------------------------------------------------------
12564. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
12565. 
12566. Statistics Report:
12567. ------------------
12568.    Size:  
12569.    ------------------------
12570.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12571.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12572.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12573. 
12574.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12575.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12576. 
12577.    Location:
12578.    ------------------------
12579.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12580.              Files End: !ZoneEndCurrent!
12581.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12582.       
12583.    Gap Settings:
12584.    ------------------------
12585.          Gap Requested: !ZoneGapSizePer!%
12586.       Volume Rounding: !ZoneVolRoundUpPer!%
12587.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12588.                  
12589.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
12590.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
12591.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
12592.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
12593.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
12594.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
12595.      
12596.    Free Space after Zone:
12597.    ------------------------
12598.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12599.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12600.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12601. 
12602. Directory and Files Select:
12603. ---------------------------
12604. !ZoneTypeSelectCurrent!               
12605. ---------------------------
12606. ----------------------------------------------------------
12607. ")
12608. 
12609. AppendLogfile("!LogFileName!", ".")
12610. AppendLogfile("!LogFileName!", "!ZoneFooter!")
12611. AppendLogfile("!LogFileName!", ".")
12612. 
12613. # Zone Footer Set Statistics Window Text
12614. 
12615. SetStatisticsWindowText("!Heading!
12616. ----------------------------------------------------------
12617. Zones Processed: 
12618. ----------------------------------------------------------
12619. !ZoneListByLine!
12620. ----------------------------------------------------------
12621. Zone Processing Step:
12622. !ZoneStepByLine!    
12623. ----------------------------------------------------------
12624. Current Zone:
12625. !ZoneFooter!
12626. ----------------------------------------------------------
12627. Volume Statistics:
12628. !VolumeStatisticsDetail!
12629. ----------------------------------------------------------
12630. Zone Detailed Report:
12631. ----------------------------------------------------------
12632. !ZoneStatisticsDetail!
12633. ----------------------------------------------------------
12634. ")
12635. 
12636. 
12637. 
12638. /* pause() */
12639. /* pause() */
12640. 
12641. 
12642. 
12643. 
12644. /* ---------------------------------------------------------- */
12645. 
12646. /* ---------------------------------------------------------- */
12647. /* Zone 9 DevToDo */
12648. # Script: DisplayColors - Zone Dark
12649. # Processed
12650. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
12651. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
12652. 
12653. # Light Green and Yellow
12654. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
12655. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
12656. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
12657. 
12658. # Script: DefragZoneTypeDevToDo
12659. /* ---------------------------------------------------------- */
12660. /* Zone DevToDo */
12661. 
12662. SetVariable(ZoneLabel, "!ZoneLabelDevToDo!")
12663. SetVariable(ZoneDescription, "!ZoneDescriptionDevToDo!")
12664. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpDevToDo!")
12665. SetVariable(ZoneGapSize, "!ZoneGapSizeDevToDo!")
12666. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectDevToDo
12667. # DevToDo start.
12668. # NotBlobsArchivesBu start.
12669. (not (
12670. # Blobs start.
12671. (
12672. # BlobsAndExceptions start.
12673. ( not(
12674.   FileName("*.bat")
12675.   or FileName("*.css")
12676.   or FileName("*.dll")
12677.   or FileName("*.exe")
12678.   or FileName("*.htm*")
12679.   or FileName("*.jar")
12680.   or FileName("*.js")
12681.   or FileName("*.script")
12682.   or FileName("*.wsf")
12683.   or (
12684. # Databases start.
12685. (
12686.   FileName("*.crypt*")
12687.   or FileName("*.db*")
12688.   or FileName("*.rdb*")
12689.   or FileName("*.dc*")
12690.   or FileName("*.dict*")
12691.   or FileName("*.?db*")
12692.   or FileName("*.?rdb*")
12693.   or FileName("*.md*")
12694.   or FileName("*.myd")
12695.   or FileName("*.ndf")
12696.   or FileName("*.ns?")
12697.   or FileName("*.pab")
12698.   or FileName("*.pst")
12699.   or FileName("*.sd?*")
12700.   or FileName("*.sq**")
12701.   or FileName("*.tmd")
12702.   or FileName("*.tps")
12703.   or FileName("*.tr*")
12704. )
12705. # Databases end.
12706. 
12707.     # BlobsAndExceptions
12708.     or 
12709. # Data start.
12710. (
12711.   DirectoryName("Data*")
12712.   or DirectoryName("Device*")
12713.   or DirectoryName("Export*")
12714.   or DirectoryName("Import*")
12715.   or DirectoryName("Log*")
12716.   or DirectoryName("*Log")
12717.   or DirectoryName("Maintenance*")
12718.   or DirectoryName("Rec*")
12719.   or DirectoryName("Sales*")
12720.   or DirectoryName("Search*")
12721.   or DirectoryName("User*")
12722. )
12723. # Data end.
12724. 
12725.     # BlobsAndExceptions
12726.   )
12727. ) )
12728. # BlobsAndExceptions end.
12729. 
12730. # Blobs
12731. ) and (
12732.   Size(BlobFileSize,0)
12733.   or (
12734.     FileName("*.arj")
12735.     or FileName("*.bup")
12736.     or FileName("*.bz2")
12737.     or FileName("*.chm")
12738.     or FileName("*.dvr-ms")
12739.     or FileName("*.gz")
12740.     or FileName("*.ifo")
12741.     or FileName("*.lzh")
12742.     or FileName("*.pdf")
12743.     or FileName("*.rpm")
12744.     or FileName("*.wmv")
12745.     or FileName("*.vob")
12746.     or FileName("*.z")
12747.   ) 
12748. )
12749. # Blobs end.
12750. 
12751. # NotBlobsArchivesBu
12752. or 
12753. # Archives start.
12754. (
12755.   DirectoryName("*Archive*")
12756.   or DirectoryName("*History*")
12757.   or DirectoryName("*Old")
12758.   or DirectoryName("* Old *")
12759.   or DirectoryName("Old *")
12760. 
12761.   or FileName("*.7z")
12762.   or FileName("*.cab")
12763.   or FileName("*.iso")
12764.   or FileName("*.msi")
12765.   or FileName("*.old")
12766.   or FileName("*.rar")
12767.   or FileName("*.tar")
12768.   or FileName("*.zip")
12769.   or
12770. # WinSysLow start.
12771. (
12772.   DirectoryName("$*")
12773.   or DirectoryName("0*")
12774.   or DirectoryName("1*")
12775.   or DirectoryName("2*")
12776.   or DirectoryName("3*")
12777.   or DirectoryName("4*")
12778.   or DirectoryName("5*")
12779.   or DirectoryName("6*")
12780.   or DirectoryName("7*")
12781.   or DirectoryName("8*")
12782.   or DirectoryName("9*")
12783. 
12784.   or DirectoryName("dllcache")
12785.   or DirectoryName("Downloaded Installations")
12786.   or DirectoryName("Ehome")
12787.   or DirectoryName("Fonts")
12788.   or DirectoryName("Help")
12789.   or DirectoryName("I386")
12790.   or DirectoryName("ie?updates")
12791.   or DirectoryName("Installer")
12792.   or DirectoryName("Installshield Installation Information")
12793.   or DirectoryName("IME")
12794.   or DirectoryName("*RECYCLE*")
12795.   or DirectoryName("ServicePackFiles")
12796.   or DirectoryName("SoftwareDistribution")
12797.   or DirectoryName("Speech")
12798.   or DirectoryName("Symbols")
12799.   or DirectoryName("System Volume Information")
12800.   or DirectoryName("windows.old")
12801. )
12802. # WinSysLow end.
12803. 
12804.   # Archives
12805. )
12806. # Archives end.
12807. 
12808. # NotBlobsArchivesBu
12809. or
12810. # Backups start.
12811. (
12812.   DirectoryName("*Backup*")
12813.   or DirectoryName("*Bu")
12814.   or DirectoryName("* Bu *")
12815.   or DirectoryName("Bu *")
12816. 
12817.   or FileName("*.bak")
12818.   or FileName("* - Copy*")
12819. )
12820. # Backups end.
12821. 
12822. # NotBlobsArchivesBu
12823. ) )
12824. # NotBlobsArchivesBu end.
12825. 
12826. # DevToDo
12827. and ( 
12828. # Dev start.
12829. (
12830.   DirectoryName("*Dev") 
12831.   or DirectoryName("Dev *") 
12832.   or DirectoryName("*Development*") 
12833.   or DirectoryName("DsVs*") 
12834.   or DirectoryName("Srt*") 
12835. )
12836. # Dev end.
12837. 
12838. # DevToDo
12839. or 
12840. # ToDo start.
12841. (
12842.   DirectoryName("*ToDo*")
12843. )
12844. # ToDo end.
12845. 
12846. # DevToDo
12847. )
12848. # DevToDo end.
12849. ')
12850. 
12851. 	# Script: ZoneDoHeader
12852. 
12853. # Script: ZoneWhenStarted
12854. 
12855. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
12856. # Script: DisplaySetZone
12857. 
12858. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
12859. SetVariable(FileStepDescription,	"")
12860. 
12861. SetVariable(ZoneStepByLine, 			"Zone started.
12862. ")
12863. 
12864. # Script: BannerDescriptionSet
12865. 
12866. # Script: BannerSet
12867. 
12868. # Script: DisplaySetDateTimeRun
12869. 
12870. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
12871. /* Xinclude "..\Display\BannerSet.MyDc"X */
12872. /* pause(1) */
12873. 
12874. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
12875. 
12876. Title('!Heading!')
12877. /* pause(1) */
12878. 
12879. /* NOTE: Can't round or truncate to integer precision. */
12880. 
12881. # Script: BannerLog
12882. 
12883. AppendLogfile("!LogFileName!", "!Title!")
12884. 
12885. 
12886. 
12887. pause(1)
12888. 
12889. 
12890. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
12891. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
12892. 
12893. SetVariable(ZoneStepNoCurrent, 0)
12894. 
12895. 
12896. # Script: ZoneDoCurrentClear
12897. 
12898. SetVariable(ZoneTypeSelectCurrent, 		"")
12899. 
12900. SetVariable(ZoneBeginCurrent, 			0)
12901. SetVariable(ZoneBeginPerCurrent, 		0)
12902. SetVariable(ZoneEndCurrent, 			0)
12903. SetVariable(ZoneEndPerCurrent, 			0)
12904. 
12905. SetVariable(ZoneSizeCurrent,			0)
12906. SetVariable(ZoneSizePerCurrent,			0)
12907. 
12908. SetVariable(ZoneGapRequestedCurrent,	0)
12909. SetVariable(ZoneGapRoundedCurrent, 		0)
12910. SetVariable(ZoneGapAdjustedCurrent, 	0)
12911. SetVariable(ZoneGapAvailableCurrent, 	0)
12912. SetVariable(ZoneGapCurrent,				0)
12913. SetVariable(ZoneGapUsedCurrent, 		0)
12914. 
12915. SetVariable(ZoneGapActualCurrent, 		0)
12916. SetVariable(ZoneGapActualPerCurrent, 	0)
12917. 
12918. SetVariable(ZoneSizeActual, 			0)
12919. SetVariable(ZoneSizeActualCurrent,		0)
12920. 
12921. SetVariable(ZoneEndActual, 				0)
12922. SetVariable(ZoneEndActualCurrent,		0)			
12923. SetVariable(ZoneSizeActualPerCurrent, 	0)
12924.       
12925. SetVariable(ZoneFilesFolders,			0)
12926. SetVariable(ZoneFilesFoldersPer,		0) 
12927. 
12928. SetVariable(ZoneFragments,				0)
12929. SetVariable(ZoneFragmentsPer,			0) 
12930. 		
12931. SetVariable(ZoneEndActualCurrent, 		0)
12932. SetVariable(ZoneEndActualPerCurrent, 	0)
12933. 
12934. # Gap Calculation Methodology:
12935. 	# Requested
12936. 	SetVariable(GapRequested, 			0) 
12937. 	SetVariable(GapRequestedStd, 		0) 
12938. 	SetVariable(GapRequestedMft, 		0) 
12939. 	SetVariable(GapRequestedOs, 		0) 
12940. 	SetVariable(GapRequestedOriginal, 	0) 
12941. 	
12942. 	# Gap Adjustments
12943. 	SetVariable(GapRounded, 			0)
12944. 	# SetVariable(GapAdjusted, 			0)
12945. 	SetVariable(GapAvailable, 			0)
12946. 	SetVariable(GapCurrent, 			0)
12947. 	SetVariable(GapActual, 				0)
12948. 	SetVariable(GapUsed, 				0)
12949. 	
12950. 	# Gap Adjustments
12951. 	SetVariable(GapRoundedLoc, 			0)
12952. 	# SetVariable(GapAdjustedLoc, 		0)
12953. 	SetVariable(GapAvailableLoc, 		0)
12954. 	SetVariable(GapCurrentLoc, 			0)
12955. 	SetVariable(GapActualLoc,			0)
12956. 	SetVariable(GapUsedLoc,				0)
12957. 	
12958. 	# Space usage
12959. 	SetVariable(ZoneFreePerRequested, 	0)
12960. 	SetVariable(ZoneFreePerUsed, 		0)
12961. 
12962. # Gap Size & Rounding
12963. 	SetVariable(ZoneGapSizePer, 		0)
12964. 	SetVariable(ZoneVolRoundUpPer, 		0)
12965. 	
12966. 	# Free Space
12967. 	SetVariable(ZoneFreeUsedPer, 		0)
12968. 	SetVariable(ZoneFreeRequestedPer, 	0)
12969. 
12970. 
12971. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
12972. 
12973. # Footer:
12974. SetVariable(ZoneFooter, "----------------------------------------------------------
12975. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
12976. 
12977. Statistics Report:
12978. ------------------
12979.    Size:  
12980.    ------------------------
12981.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12982.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12983.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12984. 
12985.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12986.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12987. 
12988.    Location:
12989.    ------------------------
12990.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12991.              Files End: !ZoneEndCurrent!
12992.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12993.       
12994.    Gap Settings:
12995.    ------------------------
12996.          Gap Requested: !ZoneGapSizePer!%
12997.       Volume Rounding: !ZoneVolRoundUpPer!%
12998.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12999.                  
13000.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
13001.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
13002.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
13003.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
13004.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
13005.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
13006.      
13007.    Free Space after Zone:
13008.    ------------------------
13009.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13010.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13011.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13012. 
13013. Directory and Files Select:
13014. ---------------------------
13015. !ZoneTypeSelectCurrent!               
13016. ---------------------------
13017. ----------------------------------------------------------
13018. ")
13019. 
13020. # Script: BannerSet
13021. 
13022. # Script: DisplaySetDateTimeRun
13023. 
13024. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
13025. /* Xinclude "..\Display\BannerSet.MyDc"X */
13026. /* pause(1) */
13027. 
13028. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
13029. 
13030. Title('!Heading!')
13031. /* pause(1) */
13032. 
13033. /* NOTE: Can't round or truncate to integer precision. */
13034. 
13035. # Script: BannerLog
13036. 
13037. AppendLogfile("!LogFileName!", "!Title!")
13038. 
13039. 
13040. 
13041. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
13042. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
13043. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:20")
13044. 
13045. SetVariable(ZoneListByLine, "!ZoneListByLine!
13046. Zone: !ZoneNoCurrent! 2021-11-13 20:31:20 0:00:03 !ZoneLabel! !ZoneDescription!")
13047. 
13048. 
13049. /* Fixed Zone Position Handling */
13050. /* Literal number: */
13051. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
13052. /* Percentage of disk: */
13053. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
13054. /* Gap */
13055. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
13056. 
13057. /* ---------------------------------------------------------- */
13058. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
13059. # Script: DisplaySetFileStep
13060. 
13061. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13062. 
13063. /* add message and move to a new line. */
13064. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13065. ")
13066. 
13067. /* display the line. (hopefully.) */
13068. # Zone Footer Set Statistics Window Text
13069. 
13070. SetStatisticsWindowText("!Heading!
13071. ----------------------------------------------------------
13072. Zones Processed: 
13073. ----------------------------------------------------------
13074. !ZoneListByLine!
13075. ----------------------------------------------------------
13076. Zone Processing Step:
13077. !ZoneStepByLine!    
13078. ----------------------------------------------------------
13079. Current Zone:
13080. !ZoneFooter!
13081. ----------------------------------------------------------
13082. Volume Statistics:
13083. !VolumeStatisticsDetail!
13084. ----------------------------------------------------------
13085. Zone Detailed Report:
13086. ----------------------------------------------------------
13087. !ZoneStatisticsDetail!
13088. ----------------------------------------------------------
13089. ")
13090. 
13091. 
13092. 
13093. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13094. 
13095. # Script: BannerSet
13096. 
13097. # Script: DisplaySetDateTimeRun
13098. 
13099. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
13100. /* Xinclude "..\Display\BannerSet.MyDc"X */
13101. /* pause(1) */
13102. 
13103. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
13104. 
13105. Title('!Heading!')
13106. /* pause(1) */
13107. 
13108. /* NOTE: Can't round or truncate to integer precision. */
13109. 
13110. pause(1)
13111. 
13112. # your stuff HERE (X)... pre file select code.
13113. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
13114. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13115. 	# (X)
13116. 
13117. FileSelect
13118. 
13119. 	# your stuff can't really go here (errors.)
13120. 	# maybe for some reason I don't know of...
13121. 	
13122. 	# Actions next...
13123. 	# Script: ZoneDo ZoneTypeSelectDevToDo
13124. # DevToDo start.
13125. # NotBlobsArchivesBu start.
13126. (not (
13127. # Blobs start.
13128. (
13129. # BlobsAndExceptions start.
13130. ( not(
13131.   FileName("*.bat")
13132.   or FileName("*.css")
13133.   or FileName("*.dll")
13134.   or FileName("*.exe")
13135.   or FileName("*.htm*")
13136.   or FileName("*.jar")
13137.   or FileName("*.js")
13138.   or FileName("*.script")
13139.   or FileName("*.wsf")
13140.   or (
13141. # Databases start.
13142. (
13143.   FileName("*.crypt*")
13144.   or FileName("*.db*")
13145.   or FileName("*.rdb*")
13146.   or FileName("*.dc*")
13147.   or FileName("*.dict*")
13148.   or FileName("*.?db*")
13149.   or FileName("*.?rdb*")
13150.   or FileName("*.md*")
13151.   or FileName("*.myd")
13152.   or FileName("*.ndf")
13153.   or FileName("*.ns?")
13154.   or FileName("*.pab")
13155.   or FileName("*.pst")
13156.   or FileName("*.sd?*")
13157.   or FileName("*.sq**")
13158.   or FileName("*.tmd")
13159.   or FileName("*.tps")
13160.   or FileName("*.tr*")
13161. )
13162. # Databases end.
13163. 
13164.     # BlobsAndExceptions
13165.     or 
13166. # Data start.
13167. (
13168.   DirectoryName("Data*")
13169.   or DirectoryName("Device*")
13170.   or DirectoryName("Export*")
13171.   or DirectoryName("Import*")
13172.   or DirectoryName("Log*")
13173.   or DirectoryName("*Log")
13174.   or DirectoryName("Maintenance*")
13175.   or DirectoryName("Rec*")
13176.   or DirectoryName("Sales*")
13177.   or DirectoryName("Search*")
13178.   or DirectoryName("User*")
13179. )
13180. # Data end.
13181. 
13182.     # BlobsAndExceptions
13183.   )
13184. ) )
13185. # BlobsAndExceptions end.
13186. 
13187. # Blobs
13188. ) and (
13189.   Size(BlobFileSize,0)
13190.   or (
13191.     FileName("*.arj")
13192.     or FileName("*.bup")
13193.     or FileName("*.bz2")
13194.     or FileName("*.chm")
13195.     or FileName("*.dvr-ms")
13196.     or FileName("*.gz")
13197.     or FileName("*.ifo")
13198.     or FileName("*.lzh")
13199.     or FileName("*.pdf")
13200.     or FileName("*.rpm")
13201.     or FileName("*.wmv")
13202.     or FileName("*.vob")
13203.     or FileName("*.z")
13204.   ) 
13205. )
13206. # Blobs end.
13207. 
13208. # NotBlobsArchivesBu
13209. or 
13210. # Archives start.
13211. (
13212.   DirectoryName("*Archive*")
13213.   or DirectoryName("*History*")
13214.   or DirectoryName("*Old")
13215.   or DirectoryName("* Old *")
13216.   or DirectoryName("Old *")
13217. 
13218.   or FileName("*.7z")
13219.   or FileName("*.cab")
13220.   or FileName("*.iso")
13221.   or FileName("*.msi")
13222.   or FileName("*.old")
13223.   or FileName("*.rar")
13224.   or FileName("*.tar")
13225.   or FileName("*.zip")
13226.   or
13227. # WinSysLow start.
13228. (
13229.   DirectoryName("$*")
13230.   or DirectoryName("0*")
13231.   or DirectoryName("1*")
13232.   or DirectoryName("2*")
13233.   or DirectoryName("3*")
13234.   or DirectoryName("4*")
13235.   or DirectoryName("5*")
13236.   or DirectoryName("6*")
13237.   or DirectoryName("7*")
13238.   or DirectoryName("8*")
13239.   or DirectoryName("9*")
13240. 
13241.   or DirectoryName("dllcache")
13242.   or DirectoryName("Downloaded Installations")
13243.   or DirectoryName("Ehome")
13244.   or DirectoryName("Fonts")
13245.   or DirectoryName("Help")
13246.   or DirectoryName("I386")
13247.   or DirectoryName("ie?updates")
13248.   or DirectoryName("Installer")
13249.   or DirectoryName("Installshield Installation Information")
13250.   or DirectoryName("IME")
13251.   or DirectoryName("*RECYCLE*")
13252.   or DirectoryName("ServicePackFiles")
13253.   or DirectoryName("SoftwareDistribution")
13254.   or DirectoryName("Speech")
13255.   or DirectoryName("Symbols")
13256.   or DirectoryName("System Volume Information")
13257.   or DirectoryName("windows.old")
13258. )
13259. # WinSysLow end.
13260. 
13261.   # Archives
13262. )
13263. # Archives end.
13264. 
13265. # NotBlobsArchivesBu
13266. or
13267. # Backups start.
13268. (
13269.   DirectoryName("*Backup*")
13270.   or DirectoryName("*Bu")
13271.   or DirectoryName("* Bu *")
13272.   or DirectoryName("Bu *")
13273. 
13274.   or FileName("*.bak")
13275.   or FileName("* - Copy*")
13276. )
13277. # Backups end.
13278. 
13279. # NotBlobsArchivesBu
13280. ) )
13281. # NotBlobsArchivesBu end.
13282. 
13283. # DevToDo
13284. and ( 
13285. # Dev start.
13286. (
13287.   DirectoryName("*Dev") 
13288.   or DirectoryName("Dev *") 
13289.   or DirectoryName("*Development*") 
13290.   or DirectoryName("DsVs*") 
13291.   or DirectoryName("Srt*") 
13292. )
13293. # Dev end.
13294. 
13295. # DevToDo
13296. or 
13297. # ToDo start.
13298. (
13299.   DirectoryName("*ToDo*")
13300. )
13301. # ToDo end.
13302. 
13303. # DevToDo
13304. )
13305. # DevToDo end.
13306. 
13307. 	# Script: ZoneDoAction
13308. # Zone Do File Action - SortByName.
13309. 
13310. FileActions
13311. 
13312. 		/* ---------------------------------------------------------- */
13313. 	# Gap
13314. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
13315. 		# Script: DisplaySetFileStep
13316. 
13317. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13318. 
13319. /* add message and move to a new line. */
13320. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13321. ")
13322. 
13323. /* display the line. (hopefully.) */
13324. # Zone Footer Set Statistics Window Text
13325. 
13326. SetStatisticsWindowText("!Heading!
13327. ----------------------------------------------------------
13328. Zones Processed: 
13329. ----------------------------------------------------------
13330. !ZoneListByLine!
13331. ----------------------------------------------------------
13332. Zone Processing Step:
13333. !ZoneStepByLine!    
13334. ----------------------------------------------------------
13335. Current Zone:
13336. !ZoneFooter!
13337. ----------------------------------------------------------
13338. Volume Statistics:
13339. !VolumeStatisticsDetail!
13340. ----------------------------------------------------------
13341. Zone Detailed Report:
13342. ----------------------------------------------------------
13343. !ZoneStatisticsDetail!
13344. ----------------------------------------------------------
13345. ")
13346. 
13347. 
13348. 
13349. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13350. 
13351. # Script: BannerSet
13352. 
13353. # Script: DisplaySetDateTimeRun
13354. 
13355. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
13356. /* Xinclude "..\Display\BannerSet.MyDc"X */
13357. /* pause(1) */
13358. 
13359. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
13360. 
13361. Title('!Heading!')
13362. /* pause(1) */
13363. 
13364. /* NOTE: Can't round or truncate to integer precision. */
13365. 
13366. pause(1)
13367. 	
13368. 	# ACTUAL GAP
13369. 		/* AddGap Variant. */
13370. 	  	# Zone Do Gap
13371. # Gap Calculation Methods:
13372. 
13373. /* 1) Anything you need to add first. */
13374. /* empty */
13375. 
13376. /* ---------------------------------------------------------- */
13377. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
13378. 	# GapRequestedStd.
13379. 
13380. 		/* ---------------------------------------------------------- */
13381. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
13382. 
13383. 		# Gap Calculation Methods:
13384. 
13385. /* AddGap Variants */
13386. 
13387. 	/* Standard */
13388. 		# Gap Calculation Methods:
13389. 	/* AddGap Variants */
13390. 	/* Standard */
13391. 
13392. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
13393. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
13394. 
13395. 	SetVariable(GapRequested, GapRequestedStd)
13396. 	
13397. 
13398. 	/* MFT Low High Method */
13399. 		# Gap Calculation Methods:
13400. 	/* AddGap Variants */
13401. 	/* MFT Low High Method */
13402. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
13403. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
13404. 	SetVariable(GapRequested, GapRequestedMft)
13405. 	
13406. 
13407. 	/* OS Volume Type Method */
13408. 		# Gap Calculation Methods:
13409. 	/* AddGap Variants */
13410. 	/* OS Volume Type Method */
13411. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
13412. 	SetVariable(GapRequested, GapRequestedOs)
13413. 
13414. 
13415. 
13416. /* MakeGap Variants */
13417. 
13418. 	/* Original Os 1-3 + MFT 2 */
13419. 		# Gap Calculation Methods:
13420. 	/* MakeGap Variants */
13421. 	/* Original Os 1-3 + MFT 2 */
13422. 	/* plus MFT gap placed inline at the dividing zone. */
13423. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
13424. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
13425. 	SetVariable(GapRequested, GapRequestedOrig)
13426. 	
13427. 	
13428. /* Note: You could comment out the ones not in use */
13429. /* However having the data in the log is useful. */
13430. /* Therefore the following line is otherwise needed. */
13431. 
13432. /* Standard used */
13433. 
13434. SetVariable(GapRequested, GapRequestedStd)
13435. 
13436. # Gap Calculation Methods:
13437. 
13438. /* AddGap Variants */
13439. 	/* Standard */
13440. 	/* MFT Low High Method */
13441. 	/* OS Volume Type Method */
13442. 
13443. /* MakeGap Variants */
13444. 	/* Original Os 1-3 + MFT 2 */
13445. 
13446. /* Note: You could comment out the ones not in use */
13447. /* However having the data in the log is useful. */
13448. /* Therefore the following line is otherwise needed. */
13449. 
13450. /* Standard is used currently */
13451. 
13452. 
13453. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
13454. 
13455. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
13456. 
13457. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
13458. 
13459. /* ---------------------------------------------------------- */
13460. /* 3) SMALL ZONE ADJUSTMENT. */
13461. /* Gab cant be larger than half the Zone Size. */
13462. 
13463. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
13464. 	
13465. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
13466. 
13467. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
13468. 
13469. /* ---------------------------------------------------------- */
13470. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
13471. # Gap Adjustments.
13472. 
13473. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
13474. 	
13475. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
13476. 
13477. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
13478. 
13479. /* ---------------------------------------------------------- */
13480. # BYPASS THIS.
13481. 	/* This is definitely wrong. */
13482. 	/* The question is can we steal gap from the next zone */
13483. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
13484. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
13485. 		# Zone Overflow.
13486. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
13487. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
13488. 
13489. /* ---------------------------------------------------------- */
13490. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
13491. # Remaining free space available.
13492. 
13493. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
13494. 	
13495. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
13496. 
13497. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
13498. 
13499. /* ---------------------------------------------------------- */
13500. # CURRENT gap to use.
13501. 
13502. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
13503. 
13504. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
13505. 
13506. /* ---------------------------------------------------------- */
13507. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
13508. # Debugging.
13509. 
13510. 	SetVariable(GapUsed, GapCurrent) // for debugging
13511. 
13512. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
13513. 
13514. 		# Your code HERE
13515. 
13516. /* ---------------------------------------------------------- */
13517. /* 7) YOUR CODE. */
13518. # YOUR CODE HERE:
13519. 	# INPUT: GapCurrent or GapCurrentLoc
13520. 	# OUTPUT: GapUsed...
13521. 
13522. /* ---------------------------------------------------------- */
13523. # Gap Size.
13524. # Actual Size of Gap.
13525. 
13526. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
13527. 
13528. /* ---------------------------------------------------------- */
13529. /* xxxxxxxxxxxxxxxxxxxxxx */
13530. # ADD THE GAP
13531. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
13532. /* xxxxxxxxxxxxxxxxxxxxxx */
13533. 
13534. 	
13535. 	# Zone Statistics	
13536. 	# Script: ZoneDoStatistics
13537. # Zone / Volume Statistics and Display
13538. 		
13539. 	# Accumulate Totals
13540.   	# Script: ZoneDoVolumeTotals
13541. 
13542. /* Current total space used (by Zones and Gaps) */
13543. 
13544. SetVariable(VolumeZoneUsed, GapUsed)
13545. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
13546. /* Percentage */
13547. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
13548. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
13549. 
13550. /* Current total of free space requested */
13551. 
13552. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
13553. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
13554. /* Percent. */
13555. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
13556. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
13557. 
13558. /* Current total of free space used */
13559. 
13560. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
13561. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
13562. /* Percent */
13563. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
13564. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
13565. 
13566. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
13567. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
13568. /* Xinclude "..\DebugDisplayPause.MyDc"X */
13569. 
13570. 
13571. 	# Current Values
13572. 	# Script: ZoneDoCurrentSet
13573. 
13574. # Cluster, Sector, Block adjust for display.
13575. 	# Bytes per cluster is volume specific.
13576. 
13577. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
13578. 
13579. # Current Zone values.
13580. 	# Begin, end and size.
13581. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
13582. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
13583. 
13584. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
13585. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
13586. 
13587. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
13588. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
13589. 
13590. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
13591. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
13592. 
13593. 	SetVariable(ZoneFragments,				"!ZONE210N!")
13594. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
13595. 		
13596. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
13597. /* identical code to here: (separation not needed. TEST.) */	
13598. 
13599. # Current Gap, Actual and Free Values
13600. 	# Gap
13601. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
13602. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
13603. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
13604. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
13605. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
13606. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
13607. 	
13608. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
13609. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
13610. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
13611. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
13612. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
13613. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
13614. 	
13615. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
13616. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
13617. 	
13618. 	# Actual Size and End
13619. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
13620. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
13621. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
13622. 	
13623. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
13624. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
13625. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
13626. 
13627. # Gap Size & Rounding
13628. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
13629. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
13630. 	
13631. 	# Free Space
13632. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
13633. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
13634. 
13635. 	# Footer:
13636. SetVariable(ZoneFooter, "----------------------------------------------------------
13637. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
13638. 
13639. Statistics Report:
13640. ------------------
13641.    Size:  
13642.    ------------------------
13643.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13644.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13645.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13646. 
13647.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13648.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13649. 
13650.    Location:
13651.    ------------------------
13652.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13653.              Files End: !ZoneEndCurrent!
13654.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13655.       
13656.    Gap Settings:
13657.    ------------------------
13658.          Gap Requested: !ZoneGapSizePer!%
13659.       Volume Rounding: !ZoneVolRoundUpPer!%
13660.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13661.                  
13662.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
13663.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
13664.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
13665.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
13666.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
13667.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
13668.      
13669.    Free Space after Zone:
13670.    ------------------------
13671.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13672.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13673.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13674. 
13675. Directory and Files Select:
13676. ---------------------------
13677. !ZoneTypeSelectCurrent!               
13678. ---------------------------
13679. ----------------------------------------------------------
13680. ")
13681. 	# Zone Footer Set Statistics Window Text
13682. 
13683. SetStatisticsWindowText("!Heading!
13684. ----------------------------------------------------------
13685. Zones Processed: 
13686. ----------------------------------------------------------
13687. !ZoneListByLine!
13688. ----------------------------------------------------------
13689. Zone Processing Step:
13690. !ZoneStepByLine!    
13691. ----------------------------------------------------------
13692. Current Zone:
13693. !ZoneFooter!
13694. ----------------------------------------------------------
13695. Volume Statistics:
13696. !VolumeStatisticsDetail!
13697. ----------------------------------------------------------
13698. Zone Detailed Report:
13699. ----------------------------------------------------------
13700. !ZoneStatisticsDetail!
13701. ----------------------------------------------------------
13702. ")
13703. 
13704. 
13705. 	
13706.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
13707. 
13708. 	# Add Zone to list of zones for display.
13709. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
13710. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
13711. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
13712. 	# ??? Free Stats?
13713. 	# Footer:
13714. SetVariable(ZoneFooter, "----------------------------------------------------------
13715. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
13716. 
13717. Statistics Report:
13718. ------------------
13719.    Size:  
13720.    ------------------------
13721.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13722.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13723.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13724. 
13725.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13726.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13727. 
13728.    Location:
13729.    ------------------------
13730.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13731.              Files End: !ZoneEndCurrent!
13732.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13733.       
13734.    Gap Settings:
13735.    ------------------------
13736.          Gap Requested: !ZoneGapSizePer!%
13737.       Volume Rounding: !ZoneVolRoundUpPer!%
13738.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13739.                  
13740.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
13741.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
13742.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
13743.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
13744.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
13745.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
13746.      
13747.    Free Space after Zone:
13748.    ------------------------
13749.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13750.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13751.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13752. 
13753. Directory and Files Select:
13754. ---------------------------
13755. !ZoneTypeSelectCurrent!               
13756. ---------------------------
13757. ----------------------------------------------------------
13758. ")
13759. 
13760. 	# Add Zone Details to Report.	
13761. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
13762. !ZoneFooter!")
13763. 
13764. 
13765. 	
13766. 	# Footer:
13767. SetVariable(ZoneFooter, "----------------------------------------------------------
13768. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
13769. 
13770. Statistics Report:
13771. ------------------
13772.    Size:  
13773.    ------------------------
13774.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13775.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13776.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13777. 
13778.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13779.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13780. 
13781.    Location:
13782.    ------------------------
13783.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13784.              Files End: !ZoneEndCurrent!
13785.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13786.       
13787.    Gap Settings:
13788.    ------------------------
13789.          Gap Requested: !ZoneGapSizePer!%
13790.       Volume Rounding: !ZoneVolRoundUpPer!%
13791.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13792.                  
13793.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
13794.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
13795.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
13796.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
13797.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
13798.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
13799.      
13800.    Free Space after Zone:
13801.    ------------------------
13802.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13803.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13804.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13805. 
13806. Directory and Files Select:
13807. ---------------------------
13808. !ZoneTypeSelectCurrent!               
13809. ---------------------------
13810. ----------------------------------------------------------
13811. ")
13812. 	SetStatisticsWindowText("!ZoneFooter!")
13813. 	
13814. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
13815. 	# Script: DisplaySetFileStep
13816. 
13817. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13818. 
13819. /* add message and move to a new line. */
13820. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13821. ")
13822. 
13823. /* display the line. (hopefully.) */
13824. # Zone Footer Set Statistics Window Text
13825. 
13826. SetStatisticsWindowText("!Heading!
13827. ----------------------------------------------------------
13828. Zones Processed: 
13829. ----------------------------------------------------------
13830. !ZoneListByLine!
13831. ----------------------------------------------------------
13832. Zone Processing Step:
13833. !ZoneStepByLine!    
13834. ----------------------------------------------------------
13835. Current Zone:
13836. !ZoneFooter!
13837. ----------------------------------------------------------
13838. Volume Statistics:
13839. !VolumeStatisticsDetail!
13840. ----------------------------------------------------------
13841. Zone Detailed Report:
13842. ----------------------------------------------------------
13843. !ZoneStatisticsDetail!
13844. ----------------------------------------------------------
13845. ")
13846. 
13847. 
13848. 
13849. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13850. 
13851. # Script: BannerSet
13852. 
13853. # Script: DisplaySetDateTimeRun
13854. 
13855. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
13856. /* Xinclude "..\Display\BannerSet.MyDc"X */
13857. /* pause(1) */
13858. 
13859. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
13860. 
13861. Title('!Heading!')
13862. /* pause(1) */
13863. 
13864. /* NOTE: Can't round or truncate to integer precision. */
13865. 
13866. pause(1)
13867. 
13868. # Commands:
13869. 
13870. /* Moves to Zone or above it. */
13871. # MoveUpToZone()
13872. 
13873. # Defrag
13874. 
13875. # Defragment(OPTIONS)
13876. 
13877. /* Shuffles files around trying to make a big enough gap for fragmented files. */
13878. # Defragment()
13879. 
13880. /* Only does files where a gap will fit it. */
13881. # Defragment(Fast)
13882. 
13883. /* Skips fragmented files larger than the Chunck Size. */
13884. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
13885. # Defragment(Chunk Size)
13886. 
13887. /* Moves down to zone and packs zone to beginning if there are gaps. */
13888. /* Can be similar in performance to doing a SortBy. */
13889. # MoveDownFill()
13890. 
13891. # File Action - All - Fast - MoveUpToZone.
13892. 	MoveUpToZone()
13893. 	
13894. 
13895. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
13896. 	# Script: DisplaySetFileStep
13897. 
13898. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13899. 
13900. /* add message and move to a new line. */
13901. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13902. ")
13903. 
13904. /* display the line. (hopefully.) */
13905. # Zone Footer Set Statistics Window Text
13906. 
13907. SetStatisticsWindowText("!Heading!
13908. ----------------------------------------------------------
13909. Zones Processed: 
13910. ----------------------------------------------------------
13911. !ZoneListByLine!
13912. ----------------------------------------------------------
13913. Zone Processing Step:
13914. !ZoneStepByLine!    
13915. ----------------------------------------------------------
13916. Current Zone:
13917. !ZoneFooter!
13918. ----------------------------------------------------------
13919. Volume Statistics:
13920. !VolumeStatisticsDetail!
13921. ----------------------------------------------------------
13922. Zone Detailed Report:
13923. ----------------------------------------------------------
13924. !ZoneStatisticsDetail!
13925. ----------------------------------------------------------
13926. ")
13927. 
13928. 
13929. 
13930. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13931. 
13932. # Script: BannerSet
13933. 
13934. # Script: DisplaySetDateTimeRun
13935. 
13936. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
13937. /* Xinclude "..\Display\BannerSet.MyDc"X */
13938. /* pause(1) */
13939. 
13940. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
13941. 
13942. Title('!Heading!')
13943. /* pause(1) */
13944. 
13945. /* NOTE: Can't round or truncate to integer precision. */
13946. 
13947. pause(1)
13948. 
13949. 	# Script: ZoneDoFooter
13950. 
13951. /* ---------------------------------------------------------- */
13952. # File Select
13953. 	# Select Statments
13954. # File Actions 
13955. 	# Standard or OS File Actions.
13956. 	# Resume...
13957. 	
13958. 	# your stuff HERE (X)... post zone (file) file actions code.
13959. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
13960. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13961. 		# (X)
13962. 		
13963. 		/* ??? Set window? */
13964. 	
13965. 	# ADD THE GAP
13966. # Vacate (good for diagnostics)
13967. # DoNotVacate - DO NOT Vacate (recommended)
13968. # DoNotVacate - DO NOT Vacate (recommended)
13969. 
13970. # Vacate
13971. /* AddGap(GapUsedLoc) */
13972. 
13973. # DO Not Vacate
13974. AddGap(GapUsedLoc, DoNotVacate) 
13975. 	
13976. 	
13977. # Script: GapZoneCommand
13978. # *** Moved to setting yours ***
13979. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
13980. # Controlled via settings commands
13981. # DoNotVacate - DO NOT Vacate (recommended)
13982. 
13983. # Vacate
13984. /* AddGap(GapUsedLoc) */
13985. 
13986. # DO Not Vacate
13987. AddGap(GapUsedLoc, DoNotVacate) 
13988. 	
13989. 	
13990. # Vacate /* AddGap(GapUsed) */
13991. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
13992. 	
13993. 
13994. 		
13995. # 
13996. FileEnd
13997. /* ---------------------------------------------------------- */
13998. 
13999. # your stuff HERE (X)... post zone (file) code.
14000. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
14001. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14002. 	# (X)
14003. 
14004. SetVariable(FileStepDescription,"Zone finished, reporting.")
14005. # Script: DisplaySetFileStep
14006. 
14007. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14008. 
14009. /* add message and move to a new line. */
14010. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14011. ")
14012. 
14013. /* display the line. (hopefully.) */
14014. # Zone Footer Set Statistics Window Text
14015. 
14016. SetStatisticsWindowText("!Heading!
14017. ----------------------------------------------------------
14018. Zones Processed: 
14019. ----------------------------------------------------------
14020. !ZoneListByLine!
14021. ----------------------------------------------------------
14022. Zone Processing Step:
14023. !ZoneStepByLine!    
14024. ----------------------------------------------------------
14025. Current Zone:
14026. !ZoneFooter!
14027. ----------------------------------------------------------
14028. Volume Statistics:
14029. !VolumeStatisticsDetail!
14030. ----------------------------------------------------------
14031. Zone Detailed Report:
14032. ----------------------------------------------------------
14033. !ZoneStatisticsDetail!
14034. ----------------------------------------------------------
14035. ")
14036. 
14037. 
14038. 
14039. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14040. 
14041. # Script: BannerSet
14042. 
14043. # Script: DisplaySetDateTimeRun
14044. 
14045. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
14046. /* Xinclude "..\Display\BannerSet.MyDc"X */
14047. /* pause(1) */
14048. 
14049. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
14050. 
14051. Title('!Heading!')
14052. /* pause(1) */
14053. 
14054. /* NOTE: Can't round or truncate to integer precision. */
14055. 
14056. pause(1)
14057. 
14058. # Script: ZoneWhenFinished
14059. 
14060. # Script: BannerSet
14061. 
14062. # Script: DisplaySetDateTimeRun
14063. 
14064. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
14065. /* Xinclude "..\Display\BannerSet.MyDc"X */
14066. /* pause(1) */
14067. 
14068. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
14069. 
14070. Title('!Heading!')
14071. /* pause(1) */
14072. 
14073. /* NOTE: Can't round or truncate to integer precision. */
14074. 
14075. # Script: BannerLog
14076. 
14077. AppendLogfile("!LogFileName!", "!Title!")
14078. 
14079. 
14080. 
14081. # Zone Statistics	
14082. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
14083. 
14084. # Footer:
14085. SetVariable(ZoneFooter, "----------------------------------------------------------
14086. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
14087. 
14088. Statistics Report:
14089. ------------------
14090.    Size:  
14091.    ------------------------
14092.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14093.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14094.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14095. 
14096.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14097.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14098. 
14099.    Location:
14100.    ------------------------
14101.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14102.              Files End: !ZoneEndCurrent!
14103.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14104.       
14105.    Gap Settings:
14106.    ------------------------
14107.          Gap Requested: !ZoneGapSizePer!%
14108.       Volume Rounding: !ZoneVolRoundUpPer!%
14109.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14110.                  
14111.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
14112.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
14113.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
14114.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
14115.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
14116.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
14117.      
14118.    Free Space after Zone:
14119.    ------------------------
14120.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14121.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14122.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14123. 
14124. Directory and Files Select:
14125. ---------------------------
14126. !ZoneTypeSelectCurrent!               
14127. ---------------------------
14128. ----------------------------------------------------------
14129. ")
14130. 
14131. AppendLogfile("!LogFileName!", ".")
14132. AppendLogfile("!LogFileName!", "!ZoneFooter!")
14133. AppendLogfile("!LogFileName!", ".")
14134. 
14135. # Zone Footer Set Statistics Window Text
14136. 
14137. SetStatisticsWindowText("!Heading!
14138. ----------------------------------------------------------
14139. Zones Processed: 
14140. ----------------------------------------------------------
14141. !ZoneListByLine!
14142. ----------------------------------------------------------
14143. Zone Processing Step:
14144. !ZoneStepByLine!    
14145. ----------------------------------------------------------
14146. Current Zone:
14147. !ZoneFooter!
14148. ----------------------------------------------------------
14149. Volume Statistics:
14150. !VolumeStatisticsDetail!
14151. ----------------------------------------------------------
14152. Zone Detailed Report:
14153. ----------------------------------------------------------
14154. !ZoneStatisticsDetail!
14155. ----------------------------------------------------------
14156. ")
14157. 
14158. 
14159. 
14160. /* pause() */
14161. /* pause() */
14162. 
14163. 
14164. 
14165. 
14166. /* ---------------------------------------------------------- */
14167. 
14168. /* ---------------------------------------------------------- */
14169. /* Zone 10 LinksCorp Links and Corp */
14170. # Script: DisplayColors - Zone Dark
14171. # Processed
14172. SetFileColor(All, Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
14173. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
14174. 
14175. # Light Green and Yellow
14176. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
14177. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
14178. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
14179. 
14180. # Script: DefragZoneTypeLinksCorp
14181. /* ---------------------------------------------------------- */
14182. /* Zone LinksCorp Links and Corp */
14183. SetVariable(ZoneLabel, "!ZoneLabelLinksCorp!")
14184. SetVariable(ZoneDescription, "!ZoneDescriptionLinksCorp!")
14185. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpLinksCorp!")
14186. SetVariable(ZoneGapSize, "!ZoneGapSizeLinksCorp!")
14187. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectLinksCorp
14188. # LinksCorp start.
14189. # NotBlobsArchivesBu start.
14190. (not (
14191. # Blobs start.
14192. (
14193. # BlobsAndExceptions start.
14194. ( not(
14195.   FileName("*.bat")
14196.   or FileName("*.css")
14197.   or FileName("*.dll")
14198.   or FileName("*.exe")
14199.   or FileName("*.htm*")
14200.   or FileName("*.jar")
14201.   or FileName("*.js")
14202.   or FileName("*.script")
14203.   or FileName("*.wsf")
14204.   or (
14205. # Databases start.
14206. (
14207.   FileName("*.crypt*")
14208.   or FileName("*.db*")
14209.   or FileName("*.rdb*")
14210.   or FileName("*.dc*")
14211.   or FileName("*.dict*")
14212.   or FileName("*.?db*")
14213.   or FileName("*.?rdb*")
14214.   or FileName("*.md*")
14215.   or FileName("*.myd")
14216.   or FileName("*.ndf")
14217.   or FileName("*.ns?")
14218.   or FileName("*.pab")
14219.   or FileName("*.pst")
14220.   or FileName("*.sd?*")
14221.   or FileName("*.sq**")
14222.   or FileName("*.tmd")
14223.   or FileName("*.tps")
14224.   or FileName("*.tr*")
14225. )
14226. # Databases end.
14227. 
14228.     # BlobsAndExceptions
14229.     or 
14230. # Data start.
14231. (
14232.   DirectoryName("Data*")
14233.   or DirectoryName("Device*")
14234.   or DirectoryName("Export*")
14235.   or DirectoryName("Import*")
14236.   or DirectoryName("Log*")
14237.   or DirectoryName("*Log")
14238.   or DirectoryName("Maintenance*")
14239.   or DirectoryName("Rec*")
14240.   or DirectoryName("Sales*")
14241.   or DirectoryName("Search*")
14242.   or DirectoryName("User*")
14243. )
14244. # Data end.
14245. 
14246.     # BlobsAndExceptions
14247.   )
14248. ) )
14249. # BlobsAndExceptions end.
14250. 
14251. # Blobs
14252. ) and (
14253.   Size(BlobFileSize,0)
14254.   or (
14255.     FileName("*.arj")
14256.     or FileName("*.bup")
14257.     or FileName("*.bz2")
14258.     or FileName("*.chm")
14259.     or FileName("*.dvr-ms")
14260.     or FileName("*.gz")
14261.     or FileName("*.ifo")
14262.     or FileName("*.lzh")
14263.     or FileName("*.pdf")
14264.     or FileName("*.rpm")
14265.     or FileName("*.wmv")
14266.     or FileName("*.vob")
14267.     or FileName("*.z")
14268.   ) 
14269. )
14270. # Blobs end.
14271. 
14272. # NotBlobsArchivesBu
14273. or 
14274. # Archives start.
14275. (
14276.   DirectoryName("*Archive*")
14277.   or DirectoryName("*History*")
14278.   or DirectoryName("*Old")
14279.   or DirectoryName("* Old *")
14280.   or DirectoryName("Old *")
14281. 
14282.   or FileName("*.7z")
14283.   or FileName("*.cab")
14284.   or FileName("*.iso")
14285.   or FileName("*.msi")
14286.   or FileName("*.old")
14287.   or FileName("*.rar")
14288.   or FileName("*.tar")
14289.   or FileName("*.zip")
14290.   or
14291. # WinSysLow start.
14292. (
14293.   DirectoryName("$*")
14294.   or DirectoryName("0*")
14295.   or DirectoryName("1*")
14296.   or DirectoryName("2*")
14297.   or DirectoryName("3*")
14298.   or DirectoryName("4*")
14299.   or DirectoryName("5*")
14300.   or DirectoryName("6*")
14301.   or DirectoryName("7*")
14302.   or DirectoryName("8*")
14303.   or DirectoryName("9*")
14304. 
14305.   or DirectoryName("dllcache")
14306.   or DirectoryName("Downloaded Installations")
14307.   or DirectoryName("Ehome")
14308.   or DirectoryName("Fonts")
14309.   or DirectoryName("Help")
14310.   or DirectoryName("I386")
14311.   or DirectoryName("ie?updates")
14312.   or DirectoryName("Installer")
14313.   or DirectoryName("Installshield Installation Information")
14314.   or DirectoryName("IME")
14315.   or DirectoryName("*RECYCLE*")
14316.   or DirectoryName("ServicePackFiles")
14317.   or DirectoryName("SoftwareDistribution")
14318.   or DirectoryName("Speech")
14319.   or DirectoryName("Symbols")
14320.   or DirectoryName("System Volume Information")
14321.   or DirectoryName("windows.old")
14322. )
14323. # WinSysLow end.
14324. 
14325.   # Archives
14326. )
14327. # Archives end.
14328. 
14329. # NotBlobsArchivesBu
14330. or
14331. # Backups start.
14332. (
14333.   DirectoryName("*Backup*")
14334.   or DirectoryName("*Bu")
14335.   or DirectoryName("* Bu *")
14336.   or DirectoryName("Bu *")
14337. 
14338.   or FileName("*.bak")
14339.   or FileName("* - Copy*")
14340. )
14341. # Backups end.
14342. 
14343. # NotBlobsArchivesBu
14344. ) )
14345. # NotBlobsArchivesBu end.
14346. 
14347. # LinksCorp
14348. and ( 
14349. # Corp start.
14350. (
14351.     DirectoryName("*Corp*") or
14352.     DirectoryName("*Mdm*")
14353. )
14354. # Corp end.
14355. 
14356. # LinksCorp
14357. or 
14358. # Links start.
14359. (
14360.     DirectoryName("*Favorites*") or
14361.     DirectoryName("*Job*") or
14362.     DirectoryName("*Links*")
14363. )
14364. # Links end.
14365. 
14366. # LinksCorp
14367. or 
14368. # Support start.
14369. (
14370.   DirectoryName("*Logs*") or
14371.   DirectoryName("*Support*") or
14372.   DirectoryName("*Maintenance*")
14373. )
14374. # Support end.
14375. 
14376. # LinksCorp
14377. )
14378. # LinksCorp end.
14379. ')
14380. 
14381. 	# Script: ZoneDoHeader
14382. 
14383. # Script: ZoneWhenStarted
14384. 
14385. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
14386. # Script: DisplaySetZone
14387. 
14388. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
14389. SetVariable(FileStepDescription,	"")
14390. 
14391. SetVariable(ZoneStepByLine, 			"Zone started.
14392. ")
14393. 
14394. # Script: BannerDescriptionSet
14395. 
14396. # Script: BannerSet
14397. 
14398. # Script: DisplaySetDateTimeRun
14399. 
14400. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
14401. /* Xinclude "..\Display\BannerSet.MyDc"X */
14402. /* pause(1) */
14403. 
14404. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
14405. 
14406. Title('!Heading!')
14407. /* pause(1) */
14408. 
14409. /* NOTE: Can't round or truncate to integer precision. */
14410. 
14411. # Script: BannerLog
14412. 
14413. AppendLogfile("!LogFileName!", "!Title!")
14414. 
14415. 
14416. 
14417. pause(1)
14418. 
14419. 
14420. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
14421. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
14422. 
14423. SetVariable(ZoneStepNoCurrent, 0)
14424. 
14425. 
14426. # Script: ZoneDoCurrentClear
14427. 
14428. SetVariable(ZoneTypeSelectCurrent, 		"")
14429. 
14430. SetVariable(ZoneBeginCurrent, 			0)
14431. SetVariable(ZoneBeginPerCurrent, 		0)
14432. SetVariable(ZoneEndCurrent, 			0)
14433. SetVariable(ZoneEndPerCurrent, 			0)
14434. 
14435. SetVariable(ZoneSizeCurrent,			0)
14436. SetVariable(ZoneSizePerCurrent,			0)
14437. 
14438. SetVariable(ZoneGapRequestedCurrent,	0)
14439. SetVariable(ZoneGapRoundedCurrent, 		0)
14440. SetVariable(ZoneGapAdjustedCurrent, 	0)
14441. SetVariable(ZoneGapAvailableCurrent, 	0)
14442. SetVariable(ZoneGapCurrent,				0)
14443. SetVariable(ZoneGapUsedCurrent, 		0)
14444. 
14445. SetVariable(ZoneGapActualCurrent, 		0)
14446. SetVariable(ZoneGapActualPerCurrent, 	0)
14447. 
14448. SetVariable(ZoneSizeActual, 			0)
14449. SetVariable(ZoneSizeActualCurrent,		0)
14450. 
14451. SetVariable(ZoneEndActual, 				0)
14452. SetVariable(ZoneEndActualCurrent,		0)			
14453. SetVariable(ZoneSizeActualPerCurrent, 	0)
14454.       
14455. SetVariable(ZoneFilesFolders,			0)
14456. SetVariable(ZoneFilesFoldersPer,		0) 
14457. 
14458. SetVariable(ZoneFragments,				0)
14459. SetVariable(ZoneFragmentsPer,			0) 
14460. 		
14461. SetVariable(ZoneEndActualCurrent, 		0)
14462. SetVariable(ZoneEndActualPerCurrent, 	0)
14463. 
14464. # Gap Calculation Methodology:
14465. 	# Requested
14466. 	SetVariable(GapRequested, 			0) 
14467. 	SetVariable(GapRequestedStd, 		0) 
14468. 	SetVariable(GapRequestedMft, 		0) 
14469. 	SetVariable(GapRequestedOs, 		0) 
14470. 	SetVariable(GapRequestedOriginal, 	0) 
14471. 	
14472. 	# Gap Adjustments
14473. 	SetVariable(GapRounded, 			0)
14474. 	# SetVariable(GapAdjusted, 			0)
14475. 	SetVariable(GapAvailable, 			0)
14476. 	SetVariable(GapCurrent, 			0)
14477. 	SetVariable(GapActual, 				0)
14478. 	SetVariable(GapUsed, 				0)
14479. 	
14480. 	# Gap Adjustments
14481. 	SetVariable(GapRoundedLoc, 			0)
14482. 	# SetVariable(GapAdjustedLoc, 		0)
14483. 	SetVariable(GapAvailableLoc, 		0)
14484. 	SetVariable(GapCurrentLoc, 			0)
14485. 	SetVariable(GapActualLoc,			0)
14486. 	SetVariable(GapUsedLoc,				0)
14487. 	
14488. 	# Space usage
14489. 	SetVariable(ZoneFreePerRequested, 	0)
14490. 	SetVariable(ZoneFreePerUsed, 		0)
14491. 
14492. # Gap Size & Rounding
14493. 	SetVariable(ZoneGapSizePer, 		0)
14494. 	SetVariable(ZoneVolRoundUpPer, 		0)
14495. 	
14496. 	# Free Space
14497. 	SetVariable(ZoneFreeUsedPer, 		0)
14498. 	SetVariable(ZoneFreeRequestedPer, 	0)
14499. 
14500. 
14501. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
14502. 
14503. # Footer:
14504. SetVariable(ZoneFooter, "----------------------------------------------------------
14505. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
14506. 
14507. Statistics Report:
14508. ------------------
14509.    Size:  
14510.    ------------------------
14511.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14512.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14513.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14514. 
14515.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14516.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14517. 
14518.    Location:
14519.    ------------------------
14520.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14521.              Files End: !ZoneEndCurrent!
14522.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14523.       
14524.    Gap Settings:
14525.    ------------------------
14526.          Gap Requested: !ZoneGapSizePer!%
14527.       Volume Rounding: !ZoneVolRoundUpPer!%
14528.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14529.                  
14530.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
14531.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
14532.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
14533.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
14534.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
14535.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
14536.      
14537.    Free Space after Zone:
14538.    ------------------------
14539.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14540.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14541.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14542. 
14543. Directory and Files Select:
14544. ---------------------------
14545. !ZoneTypeSelectCurrent!               
14546. ---------------------------
14547. ----------------------------------------------------------
14548. ")
14549. 
14550. # Script: BannerSet
14551. 
14552. # Script: DisplaySetDateTimeRun
14553. 
14554. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
14555. /* Xinclude "..\Display\BannerSet.MyDc"X */
14556. /* pause(1) */
14557. 
14558. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
14559. 
14560. Title('!Heading!')
14561. /* pause(1) */
14562. 
14563. /* NOTE: Can't round or truncate to integer precision. */
14564. 
14565. # Script: BannerLog
14566. 
14567. AppendLogfile("!LogFileName!", "!Title!")
14568. 
14569. 
14570. 
14571. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
14572. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
14573. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:20")
14574. 
14575. SetVariable(ZoneListByLine, "!ZoneListByLine!
14576. Zone: !ZoneNoCurrent! 2021-11-13 20:31:20 0:00:03 !ZoneLabel! !ZoneDescription!")
14577. 
14578. 
14579. /* Fixed Zone Position Handling */
14580. /* Literal number: */
14581. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
14582. /* Percentage of disk: */
14583. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
14584. /* Gap */
14585. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
14586. 
14587. /* ---------------------------------------------------------- */
14588. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
14589. # Script: DisplaySetFileStep
14590. 
14591. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14592. 
14593. /* add message and move to a new line. */
14594. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14595. ")
14596. 
14597. /* display the line. (hopefully.) */
14598. # Zone Footer Set Statistics Window Text
14599. 
14600. SetStatisticsWindowText("!Heading!
14601. ----------------------------------------------------------
14602. Zones Processed: 
14603. ----------------------------------------------------------
14604. !ZoneListByLine!
14605. ----------------------------------------------------------
14606. Zone Processing Step:
14607. !ZoneStepByLine!    
14608. ----------------------------------------------------------
14609. Current Zone:
14610. !ZoneFooter!
14611. ----------------------------------------------------------
14612. Volume Statistics:
14613. !VolumeStatisticsDetail!
14614. ----------------------------------------------------------
14615. Zone Detailed Report:
14616. ----------------------------------------------------------
14617. !ZoneStatisticsDetail!
14618. ----------------------------------------------------------
14619. ")
14620. 
14621. 
14622. 
14623. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14624. 
14625. # Script: BannerSet
14626. 
14627. # Script: DisplaySetDateTimeRun
14628. 
14629. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
14630. /* Xinclude "..\Display\BannerSet.MyDc"X */
14631. /* pause(1) */
14632. 
14633. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
14634. 
14635. Title('!Heading!')
14636. /* pause(1) */
14637. 
14638. /* NOTE: Can't round or truncate to integer precision. */
14639. 
14640. pause(1)
14641. 
14642. # your stuff HERE (X)... pre file select code.
14643. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
14644. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14645. 	# (X)
14646. 
14647. FileSelect
14648. 
14649. 	# your stuff can't really go here (errors.)
14650. 	# maybe for some reason I don't know of...
14651. 	
14652. 	# Actions next...
14653. 	# Script: ZoneDo ZoneTypeSelectLinksCorp
14654. # LinksCorp start.
14655. # NotBlobsArchivesBu start.
14656. (not (
14657. # Blobs start.
14658. (
14659. # BlobsAndExceptions start.
14660. ( not(
14661.   FileName("*.bat")
14662.   or FileName("*.css")
14663.   or FileName("*.dll")
14664.   or FileName("*.exe")
14665.   or FileName("*.htm*")
14666.   or FileName("*.jar")
14667.   or FileName("*.js")
14668.   or FileName("*.script")
14669.   or FileName("*.wsf")
14670.   or (
14671. # Databases start.
14672. (
14673.   FileName("*.crypt*")
14674.   or FileName("*.db*")
14675.   or FileName("*.rdb*")
14676.   or FileName("*.dc*")
14677.   or FileName("*.dict*")
14678.   or FileName("*.?db*")
14679.   or FileName("*.?rdb*")
14680.   or FileName("*.md*")
14681.   or FileName("*.myd")
14682.   or FileName("*.ndf")
14683.   or FileName("*.ns?")
14684.   or FileName("*.pab")
14685.   or FileName("*.pst")
14686.   or FileName("*.sd?*")
14687.   or FileName("*.sq**")
14688.   or FileName("*.tmd")
14689.   or FileName("*.tps")
14690.   or FileName("*.tr*")
14691. )
14692. # Databases end.
14693. 
14694.     # BlobsAndExceptions
14695.     or 
14696. # Data start.
14697. (
14698.   DirectoryName("Data*")
14699.   or DirectoryName("Device*")
14700.   or DirectoryName("Export*")
14701.   or DirectoryName("Import*")
14702.   or DirectoryName("Log*")
14703.   or DirectoryName("*Log")
14704.   or DirectoryName("Maintenance*")
14705.   or DirectoryName("Rec*")
14706.   or DirectoryName("Sales*")
14707.   or DirectoryName("Search*")
14708.   or DirectoryName("User*")
14709. )
14710. # Data end.
14711. 
14712.     # BlobsAndExceptions
14713.   )
14714. ) )
14715. # BlobsAndExceptions end.
14716. 
14717. # Blobs
14718. ) and (
14719.   Size(BlobFileSize,0)
14720.   or (
14721.     FileName("*.arj")
14722.     or FileName("*.bup")
14723.     or FileName("*.bz2")
14724.     or FileName("*.chm")
14725.     or FileName("*.dvr-ms")
14726.     or FileName("*.gz")
14727.     or FileName("*.ifo")
14728.     or FileName("*.lzh")
14729.     or FileName("*.pdf")
14730.     or FileName("*.rpm")
14731.     or FileName("*.wmv")
14732.     or FileName("*.vob")
14733.     or FileName("*.z")
14734.   ) 
14735. )
14736. # Blobs end.
14737. 
14738. # NotBlobsArchivesBu
14739. or 
14740. # Archives start.
14741. (
14742.   DirectoryName("*Archive*")
14743.   or DirectoryName("*History*")
14744.   or DirectoryName("*Old")
14745.   or DirectoryName("* Old *")
14746.   or DirectoryName("Old *")
14747. 
14748.   or FileName("*.7z")
14749.   or FileName("*.cab")
14750.   or FileName("*.iso")
14751.   or FileName("*.msi")
14752.   or FileName("*.old")
14753.   or FileName("*.rar")
14754.   or FileName("*.tar")
14755.   or FileName("*.zip")
14756.   or
14757. # WinSysLow start.
14758. (
14759.   DirectoryName("$*")
14760.   or DirectoryName("0*")
14761.   or DirectoryName("1*")
14762.   or DirectoryName("2*")
14763.   or DirectoryName("3*")
14764.   or DirectoryName("4*")
14765.   or DirectoryName("5*")
14766.   or DirectoryName("6*")
14767.   or DirectoryName("7*")
14768.   or DirectoryName("8*")
14769.   or DirectoryName("9*")
14770. 
14771.   or DirectoryName("dllcache")
14772.   or DirectoryName("Downloaded Installations")
14773.   or DirectoryName("Ehome")
14774.   or DirectoryName("Fonts")
14775.   or DirectoryName("Help")
14776.   or DirectoryName("I386")
14777.   or DirectoryName("ie?updates")
14778.   or DirectoryName("Installer")
14779.   or DirectoryName("Installshield Installation Information")
14780.   or DirectoryName("IME")
14781.   or DirectoryName("*RECYCLE*")
14782.   or DirectoryName("ServicePackFiles")
14783.   or DirectoryName("SoftwareDistribution")
14784.   or DirectoryName("Speech")
14785.   or DirectoryName("Symbols")
14786.   or DirectoryName("System Volume Information")
14787.   or DirectoryName("windows.old")
14788. )
14789. # WinSysLow end.
14790. 
14791.   # Archives
14792. )
14793. # Archives end.
14794. 
14795. # NotBlobsArchivesBu
14796. or
14797. # Backups start.
14798. (
14799.   DirectoryName("*Backup*")
14800.   or DirectoryName("*Bu")
14801.   or DirectoryName("* Bu *")
14802.   or DirectoryName("Bu *")
14803. 
14804.   or FileName("*.bak")
14805.   or FileName("* - Copy*")
14806. )
14807. # Backups end.
14808. 
14809. # NotBlobsArchivesBu
14810. ) )
14811. # NotBlobsArchivesBu end.
14812. 
14813. # LinksCorp
14814. and ( 
14815. # Corp start.
14816. (
14817.     DirectoryName("*Corp*") or
14818.     DirectoryName("*Mdm*")
14819. )
14820. # Corp end.
14821. 
14822. # LinksCorp
14823. or 
14824. # Links start.
14825. (
14826.     DirectoryName("*Favorites*") or
14827.     DirectoryName("*Job*") or
14828.     DirectoryName("*Links*")
14829. )
14830. # Links end.
14831. 
14832. # LinksCorp
14833. or 
14834. # Support start.
14835. (
14836.   DirectoryName("*Logs*") or
14837.   DirectoryName("*Support*") or
14838.   DirectoryName("*Maintenance*")
14839. )
14840. # Support end.
14841. 
14842. # LinksCorp
14843. )
14844. # LinksCorp end.
14845. 
14846. 	# Script: ZoneDoAction
14847. # Zone Do File Action - SortByName.
14848. 
14849. FileActions
14850. 
14851. 		/* ---------------------------------------------------------- */
14852. 	# Gap
14853. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
14854. 		# Script: DisplaySetFileStep
14855. 
14856. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14857. 
14858. /* add message and move to a new line. */
14859. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14860. ")
14861. 
14862. /* display the line. (hopefully.) */
14863. # Zone Footer Set Statistics Window Text
14864. 
14865. SetStatisticsWindowText("!Heading!
14866. ----------------------------------------------------------
14867. Zones Processed: 
14868. ----------------------------------------------------------
14869. !ZoneListByLine!
14870. ----------------------------------------------------------
14871. Zone Processing Step:
14872. !ZoneStepByLine!    
14873. ----------------------------------------------------------
14874. Current Zone:
14875. !ZoneFooter!
14876. ----------------------------------------------------------
14877. Volume Statistics:
14878. !VolumeStatisticsDetail!
14879. ----------------------------------------------------------
14880. Zone Detailed Report:
14881. ----------------------------------------------------------
14882. !ZoneStatisticsDetail!
14883. ----------------------------------------------------------
14884. ")
14885. 
14886. 
14887. 
14888. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14889. 
14890. # Script: BannerSet
14891. 
14892. # Script: DisplaySetDateTimeRun
14893. 
14894. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:20 0:00:03")
14895. /* Xinclude "..\Display\BannerSet.MyDc"X */
14896. /* pause(1) */
14897. 
14898. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
14899. 
14900. Title('!Heading!')
14901. /* pause(1) */
14902. 
14903. /* NOTE: Can't round or truncate to integer precision. */
14904. 
14905. pause(1)
14906. 	
14907. 	# ACTUAL GAP
14908. 		/* AddGap Variant. */
14909. 	  	# Zone Do Gap
14910. # Gap Calculation Methods:
14911. 
14912. /* 1) Anything you need to add first. */
14913. /* empty */
14914. 
14915. /* ---------------------------------------------------------- */
14916. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
14917. 	# GapRequestedStd.
14918. 
14919. 		/* ---------------------------------------------------------- */
14920. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
14921. 
14922. 		# Gap Calculation Methods:
14923. 
14924. /* AddGap Variants */
14925. 
14926. 	/* Standard */
14927. 		# Gap Calculation Methods:
14928. 	/* AddGap Variants */
14929. 	/* Standard */
14930. 
14931. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
14932. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
14933. 
14934. 	SetVariable(GapRequested, GapRequestedStd)
14935. 	
14936. 
14937. 	/* MFT Low High Method */
14938. 		# Gap Calculation Methods:
14939. 	/* AddGap Variants */
14940. 	/* MFT Low High Method */
14941. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
14942. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
14943. 	SetVariable(GapRequested, GapRequestedMft)
14944. 	
14945. 
14946. 	/* OS Volume Type Method */
14947. 		# Gap Calculation Methods:
14948. 	/* AddGap Variants */
14949. 	/* OS Volume Type Method */
14950. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
14951. 	SetVariable(GapRequested, GapRequestedOs)
14952. 
14953. 
14954. 
14955. /* MakeGap Variants */
14956. 
14957. 	/* Original Os 1-3 + MFT 2 */
14958. 		# Gap Calculation Methods:
14959. 	/* MakeGap Variants */
14960. 	/* Original Os 1-3 + MFT 2 */
14961. 	/* plus MFT gap placed inline at the dividing zone. */
14962. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
14963. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
14964. 	SetVariable(GapRequested, GapRequestedOrig)
14965. 	
14966. 	
14967. /* Note: You could comment out the ones not in use */
14968. /* However having the data in the log is useful. */
14969. /* Therefore the following line is otherwise needed. */
14970. 
14971. /* Standard used */
14972. 
14973. SetVariable(GapRequested, GapRequestedStd)
14974. 
14975. # Gap Calculation Methods:
14976. 
14977. /* AddGap Variants */
14978. 	/* Standard */
14979. 	/* MFT Low High Method */
14980. 	/* OS Volume Type Method */
14981. 
14982. /* MakeGap Variants */
14983. 	/* Original Os 1-3 + MFT 2 */
14984. 
14985. /* Note: You could comment out the ones not in use */
14986. /* However having the data in the log is useful. */
14987. /* Therefore the following line is otherwise needed. */
14988. 
14989. /* Standard is used currently */
14990. 
14991. 
14992. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
14993. 
14994. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
14995. 
14996. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
14997. 
14998. /* ---------------------------------------------------------- */
14999. /* 3) SMALL ZONE ADJUSTMENT. */
15000. /* Gab cant be larger than half the Zone Size. */
15001. 
15002. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
15003. 	
15004. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
15005. 
15006. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
15007. 
15008. /* ---------------------------------------------------------- */
15009. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
15010. # Gap Adjustments.
15011. 
15012. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
15013. 	
15014. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
15015. 
15016. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
15017. 
15018. /* ---------------------------------------------------------- */
15019. # BYPASS THIS.
15020. 	/* This is definitely wrong. */
15021. 	/* The question is can we steal gap from the next zone */
15022. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
15023. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
15024. 		# Zone Overflow.
15025. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
15026. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
15027. 
15028. /* ---------------------------------------------------------- */
15029. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
15030. # Remaining free space available.
15031. 
15032. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
15033. 	
15034. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
15035. 
15036. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
15037. 
15038. /* ---------------------------------------------------------- */
15039. # CURRENT gap to use.
15040. 
15041. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
15042. 
15043. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
15044. 
15045. /* ---------------------------------------------------------- */
15046. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
15047. # Debugging.
15048. 
15049. 	SetVariable(GapUsed, GapCurrent) // for debugging
15050. 
15051. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
15052. 
15053. 		# Your code HERE
15054. 
15055. /* ---------------------------------------------------------- */
15056. /* 7) YOUR CODE. */
15057. # YOUR CODE HERE:
15058. 	# INPUT: GapCurrent or GapCurrentLoc
15059. 	# OUTPUT: GapUsed...
15060. 
15061. /* ---------------------------------------------------------- */
15062. # Gap Size.
15063. # Actual Size of Gap.
15064. 
15065. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
15066. 
15067. /* ---------------------------------------------------------- */
15068. /* xxxxxxxxxxxxxxxxxxxxxx */
15069. # ADD THE GAP
15070. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
15071. /* xxxxxxxxxxxxxxxxxxxxxx */
15072. 
15073. 	
15074. 	# Zone Statistics	
15075. 	# Script: ZoneDoStatistics
15076. # Zone / Volume Statistics and Display
15077. 		
15078. 	# Accumulate Totals
15079.   	# Script: ZoneDoVolumeTotals
15080. 
15081. /* Current total space used (by Zones and Gaps) */
15082. 
15083. SetVariable(VolumeZoneUsed, GapUsed)
15084. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
15085. /* Percentage */
15086. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
15087. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
15088. 
15089. /* Current total of free space requested */
15090. 
15091. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
15092. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
15093. /* Percent. */
15094. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
15095. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
15096. 
15097. /* Current total of free space used */
15098. 
15099. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
15100. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
15101. /* Percent */
15102. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
15103. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
15104. 
15105. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
15106. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
15107. /* Xinclude "..\DebugDisplayPause.MyDc"X */
15108. 
15109. 
15110. 	# Current Values
15111. 	# Script: ZoneDoCurrentSet
15112. 
15113. # Cluster, Sector, Block adjust for display.
15114. 	# Bytes per cluster is volume specific.
15115. 
15116. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
15117. 
15118. # Current Zone values.
15119. 	# Begin, end and size.
15120. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
15121. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
15122. 
15123. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
15124. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
15125. 
15126. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
15127. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
15128. 
15129. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
15130. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
15131. 
15132. 	SetVariable(ZoneFragments,				"!ZONE210N!")
15133. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
15134. 		
15135. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
15136. /* identical code to here: (separation not needed. TEST.) */	
15137. 
15138. # Current Gap, Actual and Free Values
15139. 	# Gap
15140. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
15141. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
15142. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
15143. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
15144. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
15145. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
15146. 	
15147. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
15148. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
15149. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
15150. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
15151. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
15152. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
15153. 	
15154. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
15155. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
15156. 	
15157. 	# Actual Size and End
15158. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
15159. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
15160. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
15161. 	
15162. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
15163. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
15164. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
15165. 
15166. # Gap Size & Rounding
15167. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
15168. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
15169. 	
15170. 	# Free Space
15171. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
15172. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
15173. 
15174. 	# Footer:
15175. SetVariable(ZoneFooter, "----------------------------------------------------------
15176. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
15177. 
15178. Statistics Report:
15179. ------------------
15180.    Size:  
15181.    ------------------------
15182.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15183.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15184.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15185. 
15186.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15187.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15188. 
15189.    Location:
15190.    ------------------------
15191.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15192.              Files End: !ZoneEndCurrent!
15193.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15194.       
15195.    Gap Settings:
15196.    ------------------------
15197.          Gap Requested: !ZoneGapSizePer!%
15198.       Volume Rounding: !ZoneVolRoundUpPer!%
15199.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15200.                  
15201.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
15202.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
15203.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
15204.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
15205.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
15206.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
15207.      
15208.    Free Space after Zone:
15209.    ------------------------
15210.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15211.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15212.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15213. 
15214. Directory and Files Select:
15215. ---------------------------
15216. !ZoneTypeSelectCurrent!               
15217. ---------------------------
15218. ----------------------------------------------------------
15219. ")
15220. 	# Zone Footer Set Statistics Window Text
15221. 
15222. SetStatisticsWindowText("!Heading!
15223. ----------------------------------------------------------
15224. Zones Processed: 
15225. ----------------------------------------------------------
15226. !ZoneListByLine!
15227. ----------------------------------------------------------
15228. Zone Processing Step:
15229. !ZoneStepByLine!    
15230. ----------------------------------------------------------
15231. Current Zone:
15232. !ZoneFooter!
15233. ----------------------------------------------------------
15234. Volume Statistics:
15235. !VolumeStatisticsDetail!
15236. ----------------------------------------------------------
15237. Zone Detailed Report:
15238. ----------------------------------------------------------
15239. !ZoneStatisticsDetail!
15240. ----------------------------------------------------------
15241. ")
15242. 
15243. 
15244. 	
15245.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
15246. 
15247. 	# Add Zone to list of zones for display.
15248. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
15249. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
15250. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
15251. 	# ??? Free Stats?
15252. 	# Footer:
15253. SetVariable(ZoneFooter, "----------------------------------------------------------
15254. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
15255. 
15256. Statistics Report:
15257. ------------------
15258.    Size:  
15259.    ------------------------
15260.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15261.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15262.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15263. 
15264.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15265.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15266. 
15267.    Location:
15268.    ------------------------
15269.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15270.              Files End: !ZoneEndCurrent!
15271.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15272.       
15273.    Gap Settings:
15274.    ------------------------
15275.          Gap Requested: !ZoneGapSizePer!%
15276.       Volume Rounding: !ZoneVolRoundUpPer!%
15277.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15278.                  
15279.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
15280.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
15281.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
15282.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
15283.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
15284.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
15285.      
15286.    Free Space after Zone:
15287.    ------------------------
15288.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15289.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15290.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15291. 
15292. Directory and Files Select:
15293. ---------------------------
15294. !ZoneTypeSelectCurrent!               
15295. ---------------------------
15296. ----------------------------------------------------------
15297. ")
15298. 
15299. 	# Add Zone Details to Report.	
15300. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
15301. !ZoneFooter!")
15302. 
15303. 
15304. 	
15305. 	# Footer:
15306. SetVariable(ZoneFooter, "----------------------------------------------------------
15307. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:20
15308. 
15309. Statistics Report:
15310. ------------------
15311.    Size:  
15312.    ------------------------
15313.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15314.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15315.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15316. 
15317.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15318.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15319. 
15320.    Location:
15321.    ------------------------
15322.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15323.              Files End: !ZoneEndCurrent!
15324.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15325.       
15326.    Gap Settings:
15327.    ------------------------
15328.          Gap Requested: !ZoneGapSizePer!%
15329.       Volume Rounding: !ZoneVolRoundUpPer!%
15330.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15331.                  
15332.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
15333.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
15334.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
15335.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
15336.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
15337.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
15338.      
15339.    Free Space after Zone:
15340.    ------------------------
15341.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15342.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15343.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15344. 
15345. Directory and Files Select:
15346. ---------------------------
15347. !ZoneTypeSelectCurrent!               
15348. ---------------------------
15349. ----------------------------------------------------------
15350. ")
15351. 	SetStatisticsWindowText("!ZoneFooter!")
15352. 	
15353. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
15354. 	# Script: DisplaySetFileStep
15355. 
15356. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15357. 
15358. /* add message and move to a new line. */
15359. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15360. ")
15361. 
15362. /* display the line. (hopefully.) */
15363. # Zone Footer Set Statistics Window Text
15364. 
15365. SetStatisticsWindowText("!Heading!
15366. ----------------------------------------------------------
15367. Zones Processed: 
15368. ----------------------------------------------------------
15369. !ZoneListByLine!
15370. ----------------------------------------------------------
15371. Zone Processing Step:
15372. !ZoneStepByLine!    
15373. ----------------------------------------------------------
15374. Current Zone:
15375. !ZoneFooter!
15376. ----------------------------------------------------------
15377. Volume Statistics:
15378. !VolumeStatisticsDetail!
15379. ----------------------------------------------------------
15380. Zone Detailed Report:
15381. ----------------------------------------------------------
15382. !ZoneStatisticsDetail!
15383. ----------------------------------------------------------
15384. ")
15385. 
15386. 
15387. 
15388. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15389. 
15390. # Script: BannerSet
15391. 
15392. # Script: DisplaySetDateTimeRun
15393. 
15394. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
15395. /* Xinclude "..\Display\BannerSet.MyDc"X */
15396. /* pause(1) */
15397. 
15398. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
15399. 
15400. Title('!Heading!')
15401. /* pause(1) */
15402. 
15403. /* NOTE: Can't round or truncate to integer precision. */
15404. 
15405. pause(1)
15406. 
15407. # Commands:
15408. 
15409. /* Moves to Zone or above it. */
15410. # MoveUpToZone()
15411. 
15412. # Defrag
15413. 
15414. # Defragment(OPTIONS)
15415. 
15416. /* Shuffles files around trying to make a big enough gap for fragmented files. */
15417. # Defragment()
15418. 
15419. /* Only does files where a gap will fit it. */
15420. # Defragment(Fast)
15421. 
15422. /* Skips fragmented files larger than the Chunck Size. */
15423. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
15424. # Defragment(Chunk Size)
15425. 
15426. /* Moves down to zone and packs zone to beginning if there are gaps. */
15427. /* Can be similar in performance to doing a SortBy. */
15428. # MoveDownFill()
15429. 
15430. # File Action - All - Fast - MoveUpToZone.
15431. 	MoveUpToZone()
15432. 	
15433. 
15434. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
15435. 	# Script: DisplaySetFileStep
15436. 
15437. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15438. 
15439. /* add message and move to a new line. */
15440. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15441. ")
15442. 
15443. /* display the line. (hopefully.) */
15444. # Zone Footer Set Statistics Window Text
15445. 
15446. SetStatisticsWindowText("!Heading!
15447. ----------------------------------------------------------
15448. Zones Processed: 
15449. ----------------------------------------------------------
15450. !ZoneListByLine!
15451. ----------------------------------------------------------
15452. Zone Processing Step:
15453. !ZoneStepByLine!    
15454. ----------------------------------------------------------
15455. Current Zone:
15456. !ZoneFooter!
15457. ----------------------------------------------------------
15458. Volume Statistics:
15459. !VolumeStatisticsDetail!
15460. ----------------------------------------------------------
15461. Zone Detailed Report:
15462. ----------------------------------------------------------
15463. !ZoneStatisticsDetail!
15464. ----------------------------------------------------------
15465. ")
15466. 
15467. 
15468. 
15469. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15470. 
15471. # Script: BannerSet
15472. 
15473. # Script: DisplaySetDateTimeRun
15474. 
15475. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
15476. /* Xinclude "..\Display\BannerSet.MyDc"X */
15477. /* pause(1) */
15478. 
15479. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
15480. 
15481. Title('!Heading!')
15482. /* pause(1) */
15483. 
15484. /* NOTE: Can't round or truncate to integer precision. */
15485. 
15486. pause(1)
15487. 
15488. 	# Script: ZoneDoFooter
15489. 
15490. /* ---------------------------------------------------------- */
15491. # File Select
15492. 	# Select Statments
15493. # File Actions 
15494. 	# Standard or OS File Actions.
15495. 	# Resume...
15496. 	
15497. 	# your stuff HERE (X)... post zone (file) file actions code.
15498. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
15499. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15500. 		# (X)
15501. 		
15502. 		/* ??? Set window? */
15503. 	
15504. 	# ADD THE GAP
15505. # Vacate (good for diagnostics)
15506. # DoNotVacate - DO NOT Vacate (recommended)
15507. # DoNotVacate - DO NOT Vacate (recommended)
15508. 
15509. # Vacate
15510. /* AddGap(GapUsedLoc) */
15511. 
15512. # DO Not Vacate
15513. AddGap(GapUsedLoc, DoNotVacate) 
15514. 	
15515. 	
15516. # Script: GapZoneCommand
15517. # *** Moved to setting yours ***
15518. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
15519. # Controlled via settings commands
15520. # DoNotVacate - DO NOT Vacate (recommended)
15521. 
15522. # Vacate
15523. /* AddGap(GapUsedLoc) */
15524. 
15525. # DO Not Vacate
15526. AddGap(GapUsedLoc, DoNotVacate) 
15527. 	
15528. 	
15529. # Vacate /* AddGap(GapUsed) */
15530. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
15531. 	
15532. 
15533. 		
15534. # 
15535. FileEnd
15536. /* ---------------------------------------------------------- */
15537. 
15538. # your stuff HERE (X)... post zone (file) code.
15539. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
15540. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15541. 	# (X)
15542. 
15543. SetVariable(FileStepDescription,"Zone finished, reporting.")
15544. # Script: DisplaySetFileStep
15545. 
15546. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15547. 
15548. /* add message and move to a new line. */
15549. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15550. ")
15551. 
15552. /* display the line. (hopefully.) */
15553. # Zone Footer Set Statistics Window Text
15554. 
15555. SetStatisticsWindowText("!Heading!
15556. ----------------------------------------------------------
15557. Zones Processed: 
15558. ----------------------------------------------------------
15559. !ZoneListByLine!
15560. ----------------------------------------------------------
15561. Zone Processing Step:
15562. !ZoneStepByLine!    
15563. ----------------------------------------------------------
15564. Current Zone:
15565. !ZoneFooter!
15566. ----------------------------------------------------------
15567. Volume Statistics:
15568. !VolumeStatisticsDetail!
15569. ----------------------------------------------------------
15570. Zone Detailed Report:
15571. ----------------------------------------------------------
15572. !ZoneStatisticsDetail!
15573. ----------------------------------------------------------
15574. ")
15575. 
15576. 
15577. 
15578. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15579. 
15580. # Script: BannerSet
15581. 
15582. # Script: DisplaySetDateTimeRun
15583. 
15584. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
15585. /* Xinclude "..\Display\BannerSet.MyDc"X */
15586. /* pause(1) */
15587. 
15588. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
15589. 
15590. Title('!Heading!')
15591. /* pause(1) */
15592. 
15593. /* NOTE: Can't round or truncate to integer precision. */
15594. 
15595. pause(1)
15596. 
15597. # Script: ZoneWhenFinished
15598. 
15599. # Script: BannerSet
15600. 
15601. # Script: DisplaySetDateTimeRun
15602. 
15603. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
15604. /* Xinclude "..\Display\BannerSet.MyDc"X */
15605. /* pause(1) */
15606. 
15607. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
15608. 
15609. Title('!Heading!')
15610. /* pause(1) */
15611. 
15612. /* NOTE: Can't round or truncate to integer precision. */
15613. 
15614. # Script: BannerLog
15615. 
15616. AppendLogfile("!LogFileName!", "!Title!")
15617. 
15618. 
15619. 
15620. # Zone Statistics	
15621. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
15622. 
15623. # Footer:
15624. SetVariable(ZoneFooter, "----------------------------------------------------------
15625. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
15626. 
15627. Statistics Report:
15628. ------------------
15629.    Size:  
15630.    ------------------------
15631.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15632.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15633.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15634. 
15635.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15636.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15637. 
15638.    Location:
15639.    ------------------------
15640.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15641.              Files End: !ZoneEndCurrent!
15642.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15643.       
15644.    Gap Settings:
15645.    ------------------------
15646.          Gap Requested: !ZoneGapSizePer!%
15647.       Volume Rounding: !ZoneVolRoundUpPer!%
15648.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15649.                  
15650.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
15651.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
15652.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
15653.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
15654.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
15655.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
15656.      
15657.    Free Space after Zone:
15658.    ------------------------
15659.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15660.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15661.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15662. 
15663. Directory and Files Select:
15664. ---------------------------
15665. !ZoneTypeSelectCurrent!               
15666. ---------------------------
15667. ----------------------------------------------------------
15668. ")
15669. 
15670. AppendLogfile("!LogFileName!", ".")
15671. AppendLogfile("!LogFileName!", "!ZoneFooter!")
15672. AppendLogfile("!LogFileName!", ".")
15673. 
15674. # Zone Footer Set Statistics Window Text
15675. 
15676. SetStatisticsWindowText("!Heading!
15677. ----------------------------------------------------------
15678. Zones Processed: 
15679. ----------------------------------------------------------
15680. !ZoneListByLine!
15681. ----------------------------------------------------------
15682. Zone Processing Step:
15683. !ZoneStepByLine!    
15684. ----------------------------------------------------------
15685. Current Zone:
15686. !ZoneFooter!
15687. ----------------------------------------------------------
15688. Volume Statistics:
15689. !VolumeStatisticsDetail!
15690. ----------------------------------------------------------
15691. Zone Detailed Report:
15692. ----------------------------------------------------------
15693. !ZoneStatisticsDetail!
15694. ----------------------------------------------------------
15695. ")
15696. 
15697. 
15698. 
15699. /* pause() */
15700. /* pause() */
15701. 
15702. 
15703. 
15704. 
15705. /* ---------------------------------------------------------- */
15706. 
15707. 
15708. /* ---------------------------------------------------------- */
15709. /* Zone 11 People */
15710. # Script: DisplayColors - Zone Dark
15711. # Processed
15712. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
15713. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
15714. 
15715. # Light Green and Yellow
15716. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
15717. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
15718. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
15719. 
15720. # Script: DefragZoneTypePeople
15721. /* ---------------------------------------------------------- */
15722. /* Zone People */
15723. SetVariable(ZoneLabel, "!ZoneLabelPeople!")
15724. SetVariable(ZoneDescription, "!ZoneDescriptionPeople!")
15725. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpPeople!")
15726. SetVariable(ZoneGapSize, "!ZoneGapSizePeople!")
15727. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectPeople
15728. # People start.
15729. # NotBlobsArchivesBu start.
15730. (not (
15731. # Blobs start.
15732. (
15733. # BlobsAndExceptions start.
15734. ( not(
15735.   FileName("*.bat")
15736.   or FileName("*.css")
15737.   or FileName("*.dll")
15738.   or FileName("*.exe")
15739.   or FileName("*.htm*")
15740.   or FileName("*.jar")
15741.   or FileName("*.js")
15742.   or FileName("*.script")
15743.   or FileName("*.wsf")
15744.   or (
15745. # Databases start.
15746. (
15747.   FileName("*.crypt*")
15748.   or FileName("*.db*")
15749.   or FileName("*.rdb*")
15750.   or FileName("*.dc*")
15751.   or FileName("*.dict*")
15752.   or FileName("*.?db*")
15753.   or FileName("*.?rdb*")
15754.   or FileName("*.md*")
15755.   or FileName("*.myd")
15756.   or FileName("*.ndf")
15757.   or FileName("*.ns?")
15758.   or FileName("*.pab")
15759.   or FileName("*.pst")
15760.   or FileName("*.sd?*")
15761.   or FileName("*.sq**")
15762.   or FileName("*.tmd")
15763.   or FileName("*.tps")
15764.   or FileName("*.tr*")
15765. )
15766. # Databases end.
15767. 
15768.     # BlobsAndExceptions
15769.     or 
15770. # Data start.
15771. (
15772.   DirectoryName("Data*")
15773.   or DirectoryName("Device*")
15774.   or DirectoryName("Export*")
15775.   or DirectoryName("Import*")
15776.   or DirectoryName("Log*")
15777.   or DirectoryName("*Log")
15778.   or DirectoryName("Maintenance*")
15779.   or DirectoryName("Rec*")
15780.   or DirectoryName("Sales*")
15781.   or DirectoryName("Search*")
15782.   or DirectoryName("User*")
15783. )
15784. # Data end.
15785. 
15786.     # BlobsAndExceptions
15787.   )
15788. ) )
15789. # BlobsAndExceptions end.
15790. 
15791. # Blobs
15792. ) and (
15793.   Size(BlobFileSize,0)
15794.   or (
15795.     FileName("*.arj")
15796.     or FileName("*.bup")
15797.     or FileName("*.bz2")
15798.     or FileName("*.chm")
15799.     or FileName("*.dvr-ms")
15800.     or FileName("*.gz")
15801.     or FileName("*.ifo")
15802.     or FileName("*.lzh")
15803.     or FileName("*.pdf")
15804.     or FileName("*.rpm")
15805.     or FileName("*.wmv")
15806.     or FileName("*.vob")
15807.     or FileName("*.z")
15808.   ) 
15809. )
15810. # Blobs end.
15811. 
15812. # NotBlobsArchivesBu
15813. or 
15814. # Archives start.
15815. (
15816.   DirectoryName("*Archive*")
15817.   or DirectoryName("*History*")
15818.   or DirectoryName("*Old")
15819.   or DirectoryName("* Old *")
15820.   or DirectoryName("Old *")
15821. 
15822.   or FileName("*.7z")
15823.   or FileName("*.cab")
15824.   or FileName("*.iso")
15825.   or FileName("*.msi")
15826.   or FileName("*.old")
15827.   or FileName("*.rar")
15828.   or FileName("*.tar")
15829.   or FileName("*.zip")
15830.   or
15831. # WinSysLow start.
15832. (
15833.   DirectoryName("$*")
15834.   or DirectoryName("0*")
15835.   or DirectoryName("1*")
15836.   or DirectoryName("2*")
15837.   or DirectoryName("3*")
15838.   or DirectoryName("4*")
15839.   or DirectoryName("5*")
15840.   or DirectoryName("6*")
15841.   or DirectoryName("7*")
15842.   or DirectoryName("8*")
15843.   or DirectoryName("9*")
15844. 
15845.   or DirectoryName("dllcache")
15846.   or DirectoryName("Downloaded Installations")
15847.   or DirectoryName("Ehome")
15848.   or DirectoryName("Fonts")
15849.   or DirectoryName("Help")
15850.   or DirectoryName("I386")
15851.   or DirectoryName("ie?updates")
15852.   or DirectoryName("Installer")
15853.   or DirectoryName("Installshield Installation Information")
15854.   or DirectoryName("IME")
15855.   or DirectoryName("*RECYCLE*")
15856.   or DirectoryName("ServicePackFiles")
15857.   or DirectoryName("SoftwareDistribution")
15858.   or DirectoryName("Speech")
15859.   or DirectoryName("Symbols")
15860.   or DirectoryName("System Volume Information")
15861.   or DirectoryName("windows.old")
15862. )
15863. # WinSysLow end.
15864. 
15865.   # Archives
15866. )
15867. # Archives end.
15868. 
15869. # NotBlobsArchivesBu
15870. or
15871. # Backups start.
15872. (
15873.   DirectoryName("*Backup*")
15874.   or DirectoryName("*Bu")
15875.   or DirectoryName("* Bu *")
15876.   or DirectoryName("Bu *")
15877. 
15878.   or FileName("*.bak")
15879.   or FileName("* - Copy*")
15880. )
15881. # Backups end.
15882. 
15883. # NotBlobsArchivesBu
15884. ) )
15885. # NotBlobsArchivesBu end.
15886. 
15887. # People
15888. and (
15889. # People start.
15890. (
15891.   DirectoryName("*Capture*")
15892.   or DirectoryName("*Document*")
15893.   or DirectoryName("*Download*")
15894.   or DirectoryName("*Kids*")
15895.   or DirectoryName("Mail*")
15896.   or DirectoryName("*Mail")
15897.   or DirectoryName("My*")
15898.   or DirectoryName("*Person*")
15899.   or DirectoryName("Private*")
15900.   or DirectoryName("Users")
15901.   
15902.   # Individual People HERE:
15903.   or DirectoryName("Dgh*")
15904. )
15905. # People end.
15906. 
15907. # People
15908. )
15909. # People end.
15910. ')
15911. 
15912. 	# Script: ZoneDoHeader
15913. 
15914. # Script: ZoneWhenStarted
15915. 
15916. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
15917. # Script: DisplaySetZone
15918. 
15919. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
15920. SetVariable(FileStepDescription,	"")
15921. 
15922. SetVariable(ZoneStepByLine, 			"Zone started.
15923. ")
15924. 
15925. # Script: BannerDescriptionSet
15926. 
15927. # Script: BannerSet
15928. 
15929. # Script: DisplaySetDateTimeRun
15930. 
15931. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
15932. /* Xinclude "..\Display\BannerSet.MyDc"X */
15933. /* pause(1) */
15934. 
15935. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
15936. 
15937. Title('!Heading!')
15938. /* pause(1) */
15939. 
15940. /* NOTE: Can't round or truncate to integer precision. */
15941. 
15942. # Script: BannerLog
15943. 
15944. AppendLogfile("!LogFileName!", "!Title!")
15945. 
15946. 
15947. 
15948. pause(1)
15949. 
15950. 
15951. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
15952. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
15953. 
15954. SetVariable(ZoneStepNoCurrent, 0)
15955. 
15956. 
15957. # Script: ZoneDoCurrentClear
15958. 
15959. SetVariable(ZoneTypeSelectCurrent, 		"")
15960. 
15961. SetVariable(ZoneBeginCurrent, 			0)
15962. SetVariable(ZoneBeginPerCurrent, 		0)
15963. SetVariable(ZoneEndCurrent, 			0)
15964. SetVariable(ZoneEndPerCurrent, 			0)
15965. 
15966. SetVariable(ZoneSizeCurrent,			0)
15967. SetVariable(ZoneSizePerCurrent,			0)
15968. 
15969. SetVariable(ZoneGapRequestedCurrent,	0)
15970. SetVariable(ZoneGapRoundedCurrent, 		0)
15971. SetVariable(ZoneGapAdjustedCurrent, 	0)
15972. SetVariable(ZoneGapAvailableCurrent, 	0)
15973. SetVariable(ZoneGapCurrent,				0)
15974. SetVariable(ZoneGapUsedCurrent, 		0)
15975. 
15976. SetVariable(ZoneGapActualCurrent, 		0)
15977. SetVariable(ZoneGapActualPerCurrent, 	0)
15978. 
15979. SetVariable(ZoneSizeActual, 			0)
15980. SetVariable(ZoneSizeActualCurrent,		0)
15981. 
15982. SetVariable(ZoneEndActual, 				0)
15983. SetVariable(ZoneEndActualCurrent,		0)			
15984. SetVariable(ZoneSizeActualPerCurrent, 	0)
15985.       
15986. SetVariable(ZoneFilesFolders,			0)
15987. SetVariable(ZoneFilesFoldersPer,		0) 
15988. 
15989. SetVariable(ZoneFragments,				0)
15990. SetVariable(ZoneFragmentsPer,			0) 
15991. 		
15992. SetVariable(ZoneEndActualCurrent, 		0)
15993. SetVariable(ZoneEndActualPerCurrent, 	0)
15994. 
15995. # Gap Calculation Methodology:
15996. 	# Requested
15997. 	SetVariable(GapRequested, 			0) 
15998. 	SetVariable(GapRequestedStd, 		0) 
15999. 	SetVariable(GapRequestedMft, 		0) 
16000. 	SetVariable(GapRequestedOs, 		0) 
16001. 	SetVariable(GapRequestedOriginal, 	0) 
16002. 	
16003. 	# Gap Adjustments
16004. 	SetVariable(GapRounded, 			0)
16005. 	# SetVariable(GapAdjusted, 			0)
16006. 	SetVariable(GapAvailable, 			0)
16007. 	SetVariable(GapCurrent, 			0)
16008. 	SetVariable(GapActual, 				0)
16009. 	SetVariable(GapUsed, 				0)
16010. 	
16011. 	# Gap Adjustments
16012. 	SetVariable(GapRoundedLoc, 			0)
16013. 	# SetVariable(GapAdjustedLoc, 		0)
16014. 	SetVariable(GapAvailableLoc, 		0)
16015. 	SetVariable(GapCurrentLoc, 			0)
16016. 	SetVariable(GapActualLoc,			0)
16017. 	SetVariable(GapUsedLoc,				0)
16018. 	
16019. 	# Space usage
16020. 	SetVariable(ZoneFreePerRequested, 	0)
16021. 	SetVariable(ZoneFreePerUsed, 		0)
16022. 
16023. # Gap Size & Rounding
16024. 	SetVariable(ZoneGapSizePer, 		0)
16025. 	SetVariable(ZoneVolRoundUpPer, 		0)
16026. 	
16027. 	# Free Space
16028. 	SetVariable(ZoneFreeUsedPer, 		0)
16029. 	SetVariable(ZoneFreeRequestedPer, 	0)
16030. 
16031. 
16032. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
16033. 
16034. # Footer:
16035. SetVariable(ZoneFooter, "----------------------------------------------------------
16036. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
16037. 
16038. Statistics Report:
16039. ------------------
16040.    Size:  
16041.    ------------------------
16042.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16043.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16044.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16045. 
16046.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16047.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16048. 
16049.    Location:
16050.    ------------------------
16051.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16052.              Files End: !ZoneEndCurrent!
16053.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16054.       
16055.    Gap Settings:
16056.    ------------------------
16057.          Gap Requested: !ZoneGapSizePer!%
16058.       Volume Rounding: !ZoneVolRoundUpPer!%
16059.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16060.                  
16061.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
16062.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
16063.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
16064.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
16065.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
16066.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
16067.      
16068.    Free Space after Zone:
16069.    ------------------------
16070.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16071.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16072.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16073. 
16074. Directory and Files Select:
16075. ---------------------------
16076. !ZoneTypeSelectCurrent!               
16077. ---------------------------
16078. ----------------------------------------------------------
16079. ")
16080. 
16081. # Script: BannerSet
16082. 
16083. # Script: DisplaySetDateTimeRun
16084. 
16085. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
16086. /* Xinclude "..\Display\BannerSet.MyDc"X */
16087. /* pause(1) */
16088. 
16089. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
16090. 
16091. Title('!Heading!')
16092. /* pause(1) */
16093. 
16094. /* NOTE: Can't round or truncate to integer precision. */
16095. 
16096. # Script: BannerLog
16097. 
16098. AppendLogfile("!LogFileName!", "!Title!")
16099. 
16100. 
16101. 
16102. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
16103. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
16104. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:21")
16105. 
16106. SetVariable(ZoneListByLine, "!ZoneListByLine!
16107. Zone: !ZoneNoCurrent! 2021-11-13 20:31:21 0:00:04 !ZoneLabel! !ZoneDescription!")
16108. 
16109. 
16110. /* Fixed Zone Position Handling */
16111. /* Literal number: */
16112. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
16113. /* Percentage of disk: */
16114. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
16115. /* Gap */
16116. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
16117. 
16118. /* ---------------------------------------------------------- */
16119. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
16120. # Script: DisplaySetFileStep
16121. 
16122. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16123. 
16124. /* add message and move to a new line. */
16125. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16126. ")
16127. 
16128. /* display the line. (hopefully.) */
16129. # Zone Footer Set Statistics Window Text
16130. 
16131. SetStatisticsWindowText("!Heading!
16132. ----------------------------------------------------------
16133. Zones Processed: 
16134. ----------------------------------------------------------
16135. !ZoneListByLine!
16136. ----------------------------------------------------------
16137. Zone Processing Step:
16138. !ZoneStepByLine!    
16139. ----------------------------------------------------------
16140. Current Zone:
16141. !ZoneFooter!
16142. ----------------------------------------------------------
16143. Volume Statistics:
16144. !VolumeStatisticsDetail!
16145. ----------------------------------------------------------
16146. Zone Detailed Report:
16147. ----------------------------------------------------------
16148. !ZoneStatisticsDetail!
16149. ----------------------------------------------------------
16150. ")
16151. 
16152. 
16153. 
16154. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16155. 
16156. # Script: BannerSet
16157. 
16158. # Script: DisplaySetDateTimeRun
16159. 
16160. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
16161. /* Xinclude "..\Display\BannerSet.MyDc"X */
16162. /* pause(1) */
16163. 
16164. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
16165. 
16166. Title('!Heading!')
16167. /* pause(1) */
16168. 
16169. /* NOTE: Can't round or truncate to integer precision. */
16170. 
16171. pause(1)
16172. 
16173. # your stuff HERE (X)... pre file select code.
16174. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
16175. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16176. 	# (X)
16177. 
16178. FileSelect
16179. 
16180. 	# your stuff can't really go here (errors.)
16181. 	# maybe for some reason I don't know of...
16182. 	
16183. 	# Actions next...
16184. 	# Script: ZoneDo ZoneTypeSelectPeople
16185. # People start.
16186. # NotBlobsArchivesBu start.
16187. (not (
16188. # Blobs start.
16189. (
16190. # BlobsAndExceptions start.
16191. ( not(
16192.   FileName("*.bat")
16193.   or FileName("*.css")
16194.   or FileName("*.dll")
16195.   or FileName("*.exe")
16196.   or FileName("*.htm*")
16197.   or FileName("*.jar")
16198.   or FileName("*.js")
16199.   or FileName("*.script")
16200.   or FileName("*.wsf")
16201.   or (
16202. # Databases start.
16203. (
16204.   FileName("*.crypt*")
16205.   or FileName("*.db*")
16206.   or FileName("*.rdb*")
16207.   or FileName("*.dc*")
16208.   or FileName("*.dict*")
16209.   or FileName("*.?db*")
16210.   or FileName("*.?rdb*")
16211.   or FileName("*.md*")
16212.   or FileName("*.myd")
16213.   or FileName("*.ndf")
16214.   or FileName("*.ns?")
16215.   or FileName("*.pab")
16216.   or FileName("*.pst")
16217.   or FileName("*.sd?*")
16218.   or FileName("*.sq**")
16219.   or FileName("*.tmd")
16220.   or FileName("*.tps")
16221.   or FileName("*.tr*")
16222. )
16223. # Databases end.
16224. 
16225.     # BlobsAndExceptions
16226.     or 
16227. # Data start.
16228. (
16229.   DirectoryName("Data*")
16230.   or DirectoryName("Device*")
16231.   or DirectoryName("Export*")
16232.   or DirectoryName("Import*")
16233.   or DirectoryName("Log*")
16234.   or DirectoryName("*Log")
16235.   or DirectoryName("Maintenance*")
16236.   or DirectoryName("Rec*")
16237.   or DirectoryName("Sales*")
16238.   or DirectoryName("Search*")
16239.   or DirectoryName("User*")
16240. )
16241. # Data end.
16242. 
16243.     # BlobsAndExceptions
16244.   )
16245. ) )
16246. # BlobsAndExceptions end.
16247. 
16248. # Blobs
16249. ) and (
16250.   Size(BlobFileSize,0)
16251.   or (
16252.     FileName("*.arj")
16253.     or FileName("*.bup")
16254.     or FileName("*.bz2")
16255.     or FileName("*.chm")
16256.     or FileName("*.dvr-ms")
16257.     or FileName("*.gz")
16258.     or FileName("*.ifo")
16259.     or FileName("*.lzh")
16260.     or FileName("*.pdf")
16261.     or FileName("*.rpm")
16262.     or FileName("*.wmv")
16263.     or FileName("*.vob")
16264.     or FileName("*.z")
16265.   ) 
16266. )
16267. # Blobs end.
16268. 
16269. # NotBlobsArchivesBu
16270. or 
16271. # Archives start.
16272. (
16273.   DirectoryName("*Archive*")
16274.   or DirectoryName("*History*")
16275.   or DirectoryName("*Old")
16276.   or DirectoryName("* Old *")
16277.   or DirectoryName("Old *")
16278. 
16279.   or FileName("*.7z")
16280.   or FileName("*.cab")
16281.   or FileName("*.iso")
16282.   or FileName("*.msi")
16283.   or FileName("*.old")
16284.   or FileName("*.rar")
16285.   or FileName("*.tar")
16286.   or FileName("*.zip")
16287.   or
16288. # WinSysLow start.
16289. (
16290.   DirectoryName("$*")
16291.   or DirectoryName("0*")
16292.   or DirectoryName("1*")
16293.   or DirectoryName("2*")
16294.   or DirectoryName("3*")
16295.   or DirectoryName("4*")
16296.   or DirectoryName("5*")
16297.   or DirectoryName("6*")
16298.   or DirectoryName("7*")
16299.   or DirectoryName("8*")
16300.   or DirectoryName("9*")
16301. 
16302.   or DirectoryName("dllcache")
16303.   or DirectoryName("Downloaded Installations")
16304.   or DirectoryName("Ehome")
16305.   or DirectoryName("Fonts")
16306.   or DirectoryName("Help")
16307.   or DirectoryName("I386")
16308.   or DirectoryName("ie?updates")
16309.   or DirectoryName("Installer")
16310.   or DirectoryName("Installshield Installation Information")
16311.   or DirectoryName("IME")
16312.   or DirectoryName("*RECYCLE*")
16313.   or DirectoryName("ServicePackFiles")
16314.   or DirectoryName("SoftwareDistribution")
16315.   or DirectoryName("Speech")
16316.   or DirectoryName("Symbols")
16317.   or DirectoryName("System Volume Information")
16318.   or DirectoryName("windows.old")
16319. )
16320. # WinSysLow end.
16321. 
16322.   # Archives
16323. )
16324. # Archives end.
16325. 
16326. # NotBlobsArchivesBu
16327. or
16328. # Backups start.
16329. (
16330.   DirectoryName("*Backup*")
16331.   or DirectoryName("*Bu")
16332.   or DirectoryName("* Bu *")
16333.   or DirectoryName("Bu *")
16334. 
16335.   or FileName("*.bak")
16336.   or FileName("* - Copy*")
16337. )
16338. # Backups end.
16339. 
16340. # NotBlobsArchivesBu
16341. ) )
16342. # NotBlobsArchivesBu end.
16343. 
16344. # People
16345. and (
16346. # People start.
16347. (
16348.   DirectoryName("*Capture*")
16349.   or DirectoryName("*Document*")
16350.   or DirectoryName("*Download*")
16351.   or DirectoryName("*Kids*")
16352.   or DirectoryName("Mail*")
16353.   or DirectoryName("*Mail")
16354.   or DirectoryName("My*")
16355.   or DirectoryName("*Person*")
16356.   or DirectoryName("Private*")
16357.   or DirectoryName("Users")
16358.   
16359.   # Individual People HERE:
16360.   or DirectoryName("Dgh*")
16361. )
16362. # People end.
16363. 
16364. # People
16365. )
16366. # People end.
16367. 
16368. 	# Script: ZoneDoAction
16369. # Zone Do File Action - SortByName.
16370. 
16371. FileActions
16372. 
16373. 		/* ---------------------------------------------------------- */
16374. 	# Gap
16375. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
16376. 		# Script: DisplaySetFileStep
16377. 
16378. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16379. 
16380. /* add message and move to a new line. */
16381. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16382. ")
16383. 
16384. /* display the line. (hopefully.) */
16385. # Zone Footer Set Statistics Window Text
16386. 
16387. SetStatisticsWindowText("!Heading!
16388. ----------------------------------------------------------
16389. Zones Processed: 
16390. ----------------------------------------------------------
16391. !ZoneListByLine!
16392. ----------------------------------------------------------
16393. Zone Processing Step:
16394. !ZoneStepByLine!    
16395. ----------------------------------------------------------
16396. Current Zone:
16397. !ZoneFooter!
16398. ----------------------------------------------------------
16399. Volume Statistics:
16400. !VolumeStatisticsDetail!
16401. ----------------------------------------------------------
16402. Zone Detailed Report:
16403. ----------------------------------------------------------
16404. !ZoneStatisticsDetail!
16405. ----------------------------------------------------------
16406. ")
16407. 
16408. 
16409. 
16410. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16411. 
16412. # Script: BannerSet
16413. 
16414. # Script: DisplaySetDateTimeRun
16415. 
16416. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
16417. /* Xinclude "..\Display\BannerSet.MyDc"X */
16418. /* pause(1) */
16419. 
16420. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
16421. 
16422. Title('!Heading!')
16423. /* pause(1) */
16424. 
16425. /* NOTE: Can't round or truncate to integer precision. */
16426. 
16427. pause(1)
16428. 	
16429. 	# ACTUAL GAP
16430. 		/* AddGap Variant. */
16431. 	  	# Zone Do Gap
16432. # Gap Calculation Methods:
16433. 
16434. /* 1) Anything you need to add first. */
16435. /* empty */
16436. 
16437. /* ---------------------------------------------------------- */
16438. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
16439. 	# GapRequestedStd.
16440. 
16441. 		/* ---------------------------------------------------------- */
16442. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
16443. 
16444. 		# Gap Calculation Methods:
16445. 
16446. /* AddGap Variants */
16447. 
16448. 	/* Standard */
16449. 		# Gap Calculation Methods:
16450. 	/* AddGap Variants */
16451. 	/* Standard */
16452. 
16453. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
16454. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
16455. 
16456. 	SetVariable(GapRequested, GapRequestedStd)
16457. 	
16458. 
16459. 	/* MFT Low High Method */
16460. 		# Gap Calculation Methods:
16461. 	/* AddGap Variants */
16462. 	/* MFT Low High Method */
16463. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
16464. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
16465. 	SetVariable(GapRequested, GapRequestedMft)
16466. 	
16467. 
16468. 	/* OS Volume Type Method */
16469. 		# Gap Calculation Methods:
16470. 	/* AddGap Variants */
16471. 	/* OS Volume Type Method */
16472. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
16473. 	SetVariable(GapRequested, GapRequestedOs)
16474. 
16475. 
16476. 
16477. /* MakeGap Variants */
16478. 
16479. 	/* Original Os 1-3 + MFT 2 */
16480. 		# Gap Calculation Methods:
16481. 	/* MakeGap Variants */
16482. 	/* Original Os 1-3 + MFT 2 */
16483. 	/* plus MFT gap placed inline at the dividing zone. */
16484. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
16485. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
16486. 	SetVariable(GapRequested, GapRequestedOrig)
16487. 	
16488. 	
16489. /* Note: You could comment out the ones not in use */
16490. /* However having the data in the log is useful. */
16491. /* Therefore the following line is otherwise needed. */
16492. 
16493. /* Standard used */
16494. 
16495. SetVariable(GapRequested, GapRequestedStd)
16496. 
16497. # Gap Calculation Methods:
16498. 
16499. /* AddGap Variants */
16500. 	/* Standard */
16501. 	/* MFT Low High Method */
16502. 	/* OS Volume Type Method */
16503. 
16504. /* MakeGap Variants */
16505. 	/* Original Os 1-3 + MFT 2 */
16506. 
16507. /* Note: You could comment out the ones not in use */
16508. /* However having the data in the log is useful. */
16509. /* Therefore the following line is otherwise needed. */
16510. 
16511. /* Standard is used currently */
16512. 
16513. 
16514. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
16515. 
16516. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
16517. 
16518. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
16519. 
16520. /* ---------------------------------------------------------- */
16521. /* 3) SMALL ZONE ADJUSTMENT. */
16522. /* Gab cant be larger than half the Zone Size. */
16523. 
16524. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
16525. 	
16526. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
16527. 
16528. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
16529. 
16530. /* ---------------------------------------------------------- */
16531. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
16532. # Gap Adjustments.
16533. 
16534. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
16535. 	
16536. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
16537. 
16538. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
16539. 
16540. /* ---------------------------------------------------------- */
16541. # BYPASS THIS.
16542. 	/* This is definitely wrong. */
16543. 	/* The question is can we steal gap from the next zone */
16544. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
16545. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
16546. 		# Zone Overflow.
16547. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
16548. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
16549. 
16550. /* ---------------------------------------------------------- */
16551. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
16552. # Remaining free space available.
16553. 
16554. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
16555. 	
16556. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
16557. 
16558. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
16559. 
16560. /* ---------------------------------------------------------- */
16561. # CURRENT gap to use.
16562. 
16563. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
16564. 
16565. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
16566. 
16567. /* ---------------------------------------------------------- */
16568. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
16569. # Debugging.
16570. 
16571. 	SetVariable(GapUsed, GapCurrent) // for debugging
16572. 
16573. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
16574. 
16575. 		# Your code HERE
16576. 
16577. /* ---------------------------------------------------------- */
16578. /* 7) YOUR CODE. */
16579. # YOUR CODE HERE:
16580. 	# INPUT: GapCurrent or GapCurrentLoc
16581. 	# OUTPUT: GapUsed...
16582. 
16583. /* ---------------------------------------------------------- */
16584. # Gap Size.
16585. # Actual Size of Gap.
16586. 
16587. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
16588. 
16589. /* ---------------------------------------------------------- */
16590. /* xxxxxxxxxxxxxxxxxxxxxx */
16591. # ADD THE GAP
16592. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
16593. /* xxxxxxxxxxxxxxxxxxxxxx */
16594. 
16595. 	
16596. 	# Zone Statistics	
16597. 	# Script: ZoneDoStatistics
16598. # Zone / Volume Statistics and Display
16599. 		
16600. 	# Accumulate Totals
16601.   	# Script: ZoneDoVolumeTotals
16602. 
16603. /* Current total space used (by Zones and Gaps) */
16604. 
16605. SetVariable(VolumeZoneUsed, GapUsed)
16606. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
16607. /* Percentage */
16608. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
16609. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
16610. 
16611. /* Current total of free space requested */
16612. 
16613. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
16614. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16615. /* Percent. */
16616. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
16617. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16618. 
16619. /* Current total of free space used */
16620. 
16621. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
16622. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
16623. /* Percent */
16624. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
16625. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
16626. 
16627. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
16628. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
16629. /* Xinclude "..\DebugDisplayPause.MyDc"X */
16630. 
16631. 
16632. 	# Current Values
16633. 	# Script: ZoneDoCurrentSet
16634. 
16635. # Cluster, Sector, Block adjust for display.
16636. 	# Bytes per cluster is volume specific.
16637. 
16638. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
16639. 
16640. # Current Zone values.
16641. 	# Begin, end and size.
16642. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
16643. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
16644. 
16645. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
16646. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
16647. 
16648. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
16649. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
16650. 
16651. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
16652. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
16653. 
16654. 	SetVariable(ZoneFragments,				"!ZONE210N!")
16655. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
16656. 		
16657. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
16658. /* identical code to here: (separation not needed. TEST.) */	
16659. 
16660. # Current Gap, Actual and Free Values
16661. 	# Gap
16662. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
16663. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
16664. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
16665. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
16666. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
16667. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
16668. 	
16669. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
16670. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
16671. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
16672. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
16673. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
16674. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
16675. 	
16676. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
16677. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
16678. 	
16679. 	# Actual Size and End
16680. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
16681. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
16682. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
16683. 	
16684. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
16685. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
16686. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
16687. 
16688. # Gap Size & Rounding
16689. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
16690. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
16691. 	
16692. 	# Free Space
16693. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
16694. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
16695. 
16696. 	# Footer:
16697. SetVariable(ZoneFooter, "----------------------------------------------------------
16698. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
16699. 
16700. Statistics Report:
16701. ------------------
16702.    Size:  
16703.    ------------------------
16704.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16705.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16706.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16707. 
16708.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16709.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16710. 
16711.    Location:
16712.    ------------------------
16713.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16714.              Files End: !ZoneEndCurrent!
16715.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16716.       
16717.    Gap Settings:
16718.    ------------------------
16719.          Gap Requested: !ZoneGapSizePer!%
16720.       Volume Rounding: !ZoneVolRoundUpPer!%
16721.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16722.                  
16723.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
16724.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
16725.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
16726.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
16727.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
16728.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
16729.      
16730.    Free Space after Zone:
16731.    ------------------------
16732.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16733.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16734.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16735. 
16736. Directory and Files Select:
16737. ---------------------------
16738. !ZoneTypeSelectCurrent!               
16739. ---------------------------
16740. ----------------------------------------------------------
16741. ")
16742. 	# Zone Footer Set Statistics Window Text
16743. 
16744. SetStatisticsWindowText("!Heading!
16745. ----------------------------------------------------------
16746. Zones Processed: 
16747. ----------------------------------------------------------
16748. !ZoneListByLine!
16749. ----------------------------------------------------------
16750. Zone Processing Step:
16751. !ZoneStepByLine!    
16752. ----------------------------------------------------------
16753. Current Zone:
16754. !ZoneFooter!
16755. ----------------------------------------------------------
16756. Volume Statistics:
16757. !VolumeStatisticsDetail!
16758. ----------------------------------------------------------
16759. Zone Detailed Report:
16760. ----------------------------------------------------------
16761. !ZoneStatisticsDetail!
16762. ----------------------------------------------------------
16763. ")
16764. 
16765. 
16766. 	
16767.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
16768. 
16769. 	# Add Zone to list of zones for display.
16770. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
16771. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
16772. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
16773. 	# ??? Free Stats?
16774. 	# Footer:
16775. SetVariable(ZoneFooter, "----------------------------------------------------------
16776. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
16777. 
16778. Statistics Report:
16779. ------------------
16780.    Size:  
16781.    ------------------------
16782.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16783.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16784.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16785. 
16786.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16787.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16788. 
16789.    Location:
16790.    ------------------------
16791.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16792.              Files End: !ZoneEndCurrent!
16793.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16794.       
16795.    Gap Settings:
16796.    ------------------------
16797.          Gap Requested: !ZoneGapSizePer!%
16798.       Volume Rounding: !ZoneVolRoundUpPer!%
16799.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16800.                  
16801.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
16802.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
16803.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
16804.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
16805.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
16806.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
16807.      
16808.    Free Space after Zone:
16809.    ------------------------
16810.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16811.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16812.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16813. 
16814. Directory and Files Select:
16815. ---------------------------
16816. !ZoneTypeSelectCurrent!               
16817. ---------------------------
16818. ----------------------------------------------------------
16819. ")
16820. 
16821. 	# Add Zone Details to Report.	
16822. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
16823. !ZoneFooter!")
16824. 
16825. 
16826. 	
16827. 	# Footer:
16828. SetVariable(ZoneFooter, "----------------------------------------------------------
16829. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
16830. 
16831. Statistics Report:
16832. ------------------
16833.    Size:  
16834.    ------------------------
16835.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16836.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16837.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16838. 
16839.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16840.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16841. 
16842.    Location:
16843.    ------------------------
16844.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16845.              Files End: !ZoneEndCurrent!
16846.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16847.       
16848.    Gap Settings:
16849.    ------------------------
16850.          Gap Requested: !ZoneGapSizePer!%
16851.       Volume Rounding: !ZoneVolRoundUpPer!%
16852.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16853.                  
16854.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
16855.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
16856.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
16857.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
16858.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
16859.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
16860.      
16861.    Free Space after Zone:
16862.    ------------------------
16863.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16864.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16865.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16866. 
16867. Directory and Files Select:
16868. ---------------------------
16869. !ZoneTypeSelectCurrent!               
16870. ---------------------------
16871. ----------------------------------------------------------
16872. ")
16873. 	SetStatisticsWindowText("!ZoneFooter!")
16874. 	
16875. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
16876. 	# Script: DisplaySetFileStep
16877. 
16878. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16879. 
16880. /* add message and move to a new line. */
16881. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16882. ")
16883. 
16884. /* display the line. (hopefully.) */
16885. # Zone Footer Set Statistics Window Text
16886. 
16887. SetStatisticsWindowText("!Heading!
16888. ----------------------------------------------------------
16889. Zones Processed: 
16890. ----------------------------------------------------------
16891. !ZoneListByLine!
16892. ----------------------------------------------------------
16893. Zone Processing Step:
16894. !ZoneStepByLine!    
16895. ----------------------------------------------------------
16896. Current Zone:
16897. !ZoneFooter!
16898. ----------------------------------------------------------
16899. Volume Statistics:
16900. !VolumeStatisticsDetail!
16901. ----------------------------------------------------------
16902. Zone Detailed Report:
16903. ----------------------------------------------------------
16904. !ZoneStatisticsDetail!
16905. ----------------------------------------------------------
16906. ")
16907. 
16908. 
16909. 
16910. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16911. 
16912. # Script: BannerSet
16913. 
16914. # Script: DisplaySetDateTimeRun
16915. 
16916. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
16917. /* Xinclude "..\Display\BannerSet.MyDc"X */
16918. /* pause(1) */
16919. 
16920. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
16921. 
16922. Title('!Heading!')
16923. /* pause(1) */
16924. 
16925. /* NOTE: Can't round or truncate to integer precision. */
16926. 
16927. pause(1)
16928. 
16929. # Commands:
16930. 
16931. /* Moves to Zone or above it. */
16932. # MoveUpToZone()
16933. 
16934. # Defrag
16935. 
16936. # Defragment(OPTIONS)
16937. 
16938. /* Shuffles files around trying to make a big enough gap for fragmented files. */
16939. # Defragment()
16940. 
16941. /* Only does files where a gap will fit it. */
16942. # Defragment(Fast)
16943. 
16944. /* Skips fragmented files larger than the Chunck Size. */
16945. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
16946. # Defragment(Chunk Size)
16947. 
16948. /* Moves down to zone and packs zone to beginning if there are gaps. */
16949. /* Can be similar in performance to doing a SortBy. */
16950. # MoveDownFill()
16951. 
16952. # File Action - All - Fast - MoveUpToZone.
16953. 	MoveUpToZone()
16954. 	
16955. 
16956. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
16957. 	# Script: DisplaySetFileStep
16958. 
16959. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16960. 
16961. /* add message and move to a new line. */
16962. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16963. ")
16964. 
16965. /* display the line. (hopefully.) */
16966. # Zone Footer Set Statistics Window Text
16967. 
16968. SetStatisticsWindowText("!Heading!
16969. ----------------------------------------------------------
16970. Zones Processed: 
16971. ----------------------------------------------------------
16972. !ZoneListByLine!
16973. ----------------------------------------------------------
16974. Zone Processing Step:
16975. !ZoneStepByLine!    
16976. ----------------------------------------------------------
16977. Current Zone:
16978. !ZoneFooter!
16979. ----------------------------------------------------------
16980. Volume Statistics:
16981. !VolumeStatisticsDetail!
16982. ----------------------------------------------------------
16983. Zone Detailed Report:
16984. ----------------------------------------------------------
16985. !ZoneStatisticsDetail!
16986. ----------------------------------------------------------
16987. ")
16988. 
16989. 
16990. 
16991. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16992. 
16993. # Script: BannerSet
16994. 
16995. # Script: DisplaySetDateTimeRun
16996. 
16997. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
16998. /* Xinclude "..\Display\BannerSet.MyDc"X */
16999. /* pause(1) */
17000. 
17001. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
17002. 
17003. Title('!Heading!')
17004. /* pause(1) */
17005. 
17006. /* NOTE: Can't round or truncate to integer precision. */
17007. 
17008. pause(1)
17009. 
17010. 	# Script: ZoneDoFooter
17011. 
17012. /* ---------------------------------------------------------- */
17013. # File Select
17014. 	# Select Statments
17015. # File Actions 
17016. 	# Standard or OS File Actions.
17017. 	# Resume...
17018. 	
17019. 	# your stuff HERE (X)... post zone (file) file actions code.
17020. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
17021. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17022. 		# (X)
17023. 		
17024. 		/* ??? Set window? */
17025. 	
17026. 	# ADD THE GAP
17027. # Vacate (good for diagnostics)
17028. # DoNotVacate - DO NOT Vacate (recommended)
17029. # DoNotVacate - DO NOT Vacate (recommended)
17030. 
17031. # Vacate
17032. /* AddGap(GapUsedLoc) */
17033. 
17034. # DO Not Vacate
17035. AddGap(GapUsedLoc, DoNotVacate) 
17036. 	
17037. 	
17038. # Script: GapZoneCommand
17039. # *** Moved to setting yours ***
17040. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
17041. # Controlled via settings commands
17042. # DoNotVacate - DO NOT Vacate (recommended)
17043. 
17044. # Vacate
17045. /* AddGap(GapUsedLoc) */
17046. 
17047. # DO Not Vacate
17048. AddGap(GapUsedLoc, DoNotVacate) 
17049. 	
17050. 	
17051. # Vacate /* AddGap(GapUsed) */
17052. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
17053. 	
17054. 
17055. 		
17056. # 
17057. FileEnd
17058. /* ---------------------------------------------------------- */
17059. 
17060. # your stuff HERE (X)... post zone (file) code.
17061. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
17062. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17063. 	# (X)
17064. 
17065. SetVariable(FileStepDescription,"Zone finished, reporting.")
17066. # Script: DisplaySetFileStep
17067. 
17068. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17069. 
17070. /* add message and move to a new line. */
17071. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17072. ")
17073. 
17074. /* display the line. (hopefully.) */
17075. # Zone Footer Set Statistics Window Text
17076. 
17077. SetStatisticsWindowText("!Heading!
17078. ----------------------------------------------------------
17079. Zones Processed: 
17080. ----------------------------------------------------------
17081. !ZoneListByLine!
17082. ----------------------------------------------------------
17083. Zone Processing Step:
17084. !ZoneStepByLine!    
17085. ----------------------------------------------------------
17086. Current Zone:
17087. !ZoneFooter!
17088. ----------------------------------------------------------
17089. Volume Statistics:
17090. !VolumeStatisticsDetail!
17091. ----------------------------------------------------------
17092. Zone Detailed Report:
17093. ----------------------------------------------------------
17094. !ZoneStatisticsDetail!
17095. ----------------------------------------------------------
17096. ")
17097. 
17098. 
17099. 
17100. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17101. 
17102. # Script: BannerSet
17103. 
17104. # Script: DisplaySetDateTimeRun
17105. 
17106. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
17107. /* Xinclude "..\Display\BannerSet.MyDc"X */
17108. /* pause(1) */
17109. 
17110. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
17111. 
17112. Title('!Heading!')
17113. /* pause(1) */
17114. 
17115. /* NOTE: Can't round or truncate to integer precision. */
17116. 
17117. pause(1)
17118. 
17119. # Script: ZoneWhenFinished
17120. 
17121. # Script: BannerSet
17122. 
17123. # Script: DisplaySetDateTimeRun
17124. 
17125. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
17126. /* Xinclude "..\Display\BannerSet.MyDc"X */
17127. /* pause(1) */
17128. 
17129. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
17130. 
17131. Title('!Heading!')
17132. /* pause(1) */
17133. 
17134. /* NOTE: Can't round or truncate to integer precision. */
17135. 
17136. # Script: BannerLog
17137. 
17138. AppendLogfile("!LogFileName!", "!Title!")
17139. 
17140. 
17141. 
17142. # Zone Statistics	
17143. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
17144. 
17145. # Footer:
17146. SetVariable(ZoneFooter, "----------------------------------------------------------
17147. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
17148. 
17149. Statistics Report:
17150. ------------------
17151.    Size:  
17152.    ------------------------
17153.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17154.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17155.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17156. 
17157.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17158.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17159. 
17160.    Location:
17161.    ------------------------
17162.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17163.              Files End: !ZoneEndCurrent!
17164.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17165.       
17166.    Gap Settings:
17167.    ------------------------
17168.          Gap Requested: !ZoneGapSizePer!%
17169.       Volume Rounding: !ZoneVolRoundUpPer!%
17170.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17171.                  
17172.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
17173.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
17174.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
17175.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
17176.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
17177.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
17178.      
17179.    Free Space after Zone:
17180.    ------------------------
17181.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17182.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17183.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17184. 
17185. Directory and Files Select:
17186. ---------------------------
17187. !ZoneTypeSelectCurrent!               
17188. ---------------------------
17189. ----------------------------------------------------------
17190. ")
17191. 
17192. AppendLogfile("!LogFileName!", ".")
17193. AppendLogfile("!LogFileName!", "!ZoneFooter!")
17194. AppendLogfile("!LogFileName!", ".")
17195. 
17196. # Zone Footer Set Statistics Window Text
17197. 
17198. SetStatisticsWindowText("!Heading!
17199. ----------------------------------------------------------
17200. Zones Processed: 
17201. ----------------------------------------------------------
17202. !ZoneListByLine!
17203. ----------------------------------------------------------
17204. Zone Processing Step:
17205. !ZoneStepByLine!    
17206. ----------------------------------------------------------
17207. Current Zone:
17208. !ZoneFooter!
17209. ----------------------------------------------------------
17210. Volume Statistics:
17211. !VolumeStatisticsDetail!
17212. ----------------------------------------------------------
17213. Zone Detailed Report:
17214. ----------------------------------------------------------
17215. !ZoneStatisticsDetail!
17216. ----------------------------------------------------------
17217. ")
17218. 
17219. 
17220. 
17221. /* pause() */
17222. /* pause() */
17223. 
17224. 
17225. 
17226. 
17227. /* ---------------------------------------------------------- */
17228. 
17229. 
17230. /* ---------------------------------------------------------- */
17231. // "4" & "5" now 13 & 14
17232. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
17233. /* Process MFT & Dir's HERE. */
17234. 	SetVariable(FileStepDescription,"Calculating Gap for MFT and DIR.")
17235. # Script: BannerDescriptionSet
17236. 
17237. # Script: BannerSet
17238. 
17239. # Script: DisplaySetDateTimeRun
17240. 
17241. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
17242. /* Xinclude "..\Display\BannerSet.MyDc"X */
17243. /* pause(1) */
17244. 
17245. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
17246. 
17247. Title('!Heading!')
17248. /* pause(1) */
17249. 
17250. /* NOTE: Can't round or truncate to integer precision. */
17251. 
17252. # Script: BannerLog
17253. 
17254. AppendLogfile("!LogFileName!", "!Title!")
17255. 
17256. 
17257. 
17258. 
17259. AppendLogfile("!LogFileName!", "MftLocation: !MftLocation! DoNotVacate 2021-11-13 20:31:21")
17260. 
17261. SetVariable(MftGapSlack, MftLocation - VolumeUsedTotal)
17262. AppendLogfile("!LogFileName!", "MftGapSlack: !MftGapSlack!")
17263. 
17264. SetVariable(MftGapSlackPerUsed, MftGapSlack / VolumeFreeAdj)
17265. AppendLogfile("!LogFileName!", "MftGapSlackPerUsed: !MftGapSlackPerUsed!")
17266. 
17267. AppendLogfile("!LogFileName!", "VolumeUsed before: !VolumeUsedTotal!")
17268. SetVariable(VolumeUsedTotal, MftLocation)
17269. AppendLogfile("!LogFileName!", "VolumeUsed at location: !VolumeUsedTotal!")
17270. 
17271. SetVariable(VolumeFreePerUsed, VolumeFreePerUsed + (MftGapSlack / VolumeFree))
17272. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!")
17273. 
17274. /* ---------------------------------------------------------- */
17275. #  MFT
17276. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
17277. 
17278. # Script: DefragZoneTypeOsMft
17279. /* ---------------------------------------------------------- */
17280. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
17281.   
17282. SetVariable(ZoneLabel,				"MFT") // "4" 
17283. SetVariable(ZoneDescription, 		"MFT - Master File Table")
17284. SetVariable(ZoneCurrentAjust, 		1)
17285. /* and some other special NTFS files. */
17286. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpMft!")
17287. SetVariable(ZoneGapSize, 			"!ZoneGapSizeMft!")
17288. SetVariable(ZoneTypeSelect,			'# Script: ZoneDo ZoneTypeSelectOsMFT
17289. # MFT start.
17290. SelectNtfsSystemFiles(yes)
17291. # MFT end.')
17292. 
17293. 	# Script: ZoneDoHeader
17294. 
17295. # Script: ZoneWhenStarted
17296. 
17297. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
17298. # Script: DisplaySetZone
17299. 
17300. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
17301. SetVariable(FileStepDescription,	"")
17302. 
17303. SetVariable(ZoneStepByLine, 			"Zone started.
17304. ")
17305. 
17306. # Script: BannerDescriptionSet
17307. 
17308. # Script: BannerSet
17309. 
17310. # Script: DisplaySetDateTimeRun
17311. 
17312. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
17313. /* Xinclude "..\Display\BannerSet.MyDc"X */
17314. /* pause(1) */
17315. 
17316. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
17317. 
17318. Title('!Heading!')
17319. /* pause(1) */
17320. 
17321. /* NOTE: Can't round or truncate to integer precision. */
17322. 
17323. # Script: BannerLog
17324. 
17325. AppendLogfile("!LogFileName!", "!Title!")
17326. 
17327. 
17328. 
17329. pause(1)
17330. 
17331. 
17332. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
17333. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
17334. 
17335. SetVariable(ZoneStepNoCurrent, 0)
17336. 
17337. 
17338. # Script: ZoneDoCurrentClear
17339. 
17340. SetVariable(ZoneTypeSelectCurrent, 		"")
17341. 
17342. SetVariable(ZoneBeginCurrent, 			0)
17343. SetVariable(ZoneBeginPerCurrent, 		0)
17344. SetVariable(ZoneEndCurrent, 			0)
17345. SetVariable(ZoneEndPerCurrent, 			0)
17346. 
17347. SetVariable(ZoneSizeCurrent,			0)
17348. SetVariable(ZoneSizePerCurrent,			0)
17349. 
17350. SetVariable(ZoneGapRequestedCurrent,	0)
17351. SetVariable(ZoneGapRoundedCurrent, 		0)
17352. SetVariable(ZoneGapAdjustedCurrent, 	0)
17353. SetVariable(ZoneGapAvailableCurrent, 	0)
17354. SetVariable(ZoneGapCurrent,				0)
17355. SetVariable(ZoneGapUsedCurrent, 		0)
17356. 
17357. SetVariable(ZoneGapActualCurrent, 		0)
17358. SetVariable(ZoneGapActualPerCurrent, 	0)
17359. 
17360. SetVariable(ZoneSizeActual, 			0)
17361. SetVariable(ZoneSizeActualCurrent,		0)
17362. 
17363. SetVariable(ZoneEndActual, 				0)
17364. SetVariable(ZoneEndActualCurrent,		0)			
17365. SetVariable(ZoneSizeActualPerCurrent, 	0)
17366.       
17367. SetVariable(ZoneFilesFolders,			0)
17368. SetVariable(ZoneFilesFoldersPer,		0) 
17369. 
17370. SetVariable(ZoneFragments,				0)
17371. SetVariable(ZoneFragmentsPer,			0) 
17372. 		
17373. SetVariable(ZoneEndActualCurrent, 		0)
17374. SetVariable(ZoneEndActualPerCurrent, 	0)
17375. 
17376. # Gap Calculation Methodology:
17377. 	# Requested
17378. 	SetVariable(GapRequested, 			0) 
17379. 	SetVariable(GapRequestedStd, 		0) 
17380. 	SetVariable(GapRequestedMft, 		0) 
17381. 	SetVariable(GapRequestedOs, 		0) 
17382. 	SetVariable(GapRequestedOriginal, 	0) 
17383. 	
17384. 	# Gap Adjustments
17385. 	SetVariable(GapRounded, 			0)
17386. 	# SetVariable(GapAdjusted, 			0)
17387. 	SetVariable(GapAvailable, 			0)
17388. 	SetVariable(GapCurrent, 			0)
17389. 	SetVariable(GapActual, 				0)
17390. 	SetVariable(GapUsed, 				0)
17391. 	
17392. 	# Gap Adjustments
17393. 	SetVariable(GapRoundedLoc, 			0)
17394. 	# SetVariable(GapAdjustedLoc, 		0)
17395. 	SetVariable(GapAvailableLoc, 		0)
17396. 	SetVariable(GapCurrentLoc, 			0)
17397. 	SetVariable(GapActualLoc,			0)
17398. 	SetVariable(GapUsedLoc,				0)
17399. 	
17400. 	# Space usage
17401. 	SetVariable(ZoneFreePerRequested, 	0)
17402. 	SetVariable(ZoneFreePerUsed, 		0)
17403. 
17404. # Gap Size & Rounding
17405. 	SetVariable(ZoneGapSizePer, 		0)
17406. 	SetVariable(ZoneVolRoundUpPer, 		0)
17407. 	
17408. 	# Free Space
17409. 	SetVariable(ZoneFreeUsedPer, 		0)
17410. 	SetVariable(ZoneFreeRequestedPer, 	0)
17411. 
17412. 
17413. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
17414. 
17415. # Footer:
17416. SetVariable(ZoneFooter, "----------------------------------------------------------
17417. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
17418. 
17419. Statistics Report:
17420. ------------------
17421.    Size:  
17422.    ------------------------
17423.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17424.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17425.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17426. 
17427.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17428.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17429. 
17430.    Location:
17431.    ------------------------
17432.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17433.              Files End: !ZoneEndCurrent!
17434.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17435.       
17436.    Gap Settings:
17437.    ------------------------
17438.          Gap Requested: !ZoneGapSizePer!%
17439.       Volume Rounding: !ZoneVolRoundUpPer!%
17440.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17441.                  
17442.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
17443.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
17444.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
17445.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
17446.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
17447.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
17448.      
17449.    Free Space after Zone:
17450.    ------------------------
17451.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17452.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17453.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17454. 
17455. Directory and Files Select:
17456. ---------------------------
17457. !ZoneTypeSelectCurrent!               
17458. ---------------------------
17459. ----------------------------------------------------------
17460. ")
17461. 
17462. # Script: BannerSet
17463. 
17464. # Script: DisplaySetDateTimeRun
17465. 
17466. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
17467. /* Xinclude "..\Display\BannerSet.MyDc"X */
17468. /* pause(1) */
17469. 
17470. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
17471. 
17472. Title('!Heading!')
17473. /* pause(1) */
17474. 
17475. /* NOTE: Can't round or truncate to integer precision. */
17476. 
17477. # Script: BannerLog
17478. 
17479. AppendLogfile("!LogFileName!", "!Title!")
17480. 
17481. 
17482. 
17483. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
17484. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
17485. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:21")
17486. 
17487. SetVariable(ZoneListByLine, "!ZoneListByLine!
17488. Zone: !ZoneNoCurrent! 2021-11-13 20:31:21 0:00:04 !ZoneLabel! !ZoneDescription!")
17489. 
17490. 
17491. /* Fixed Zone Position Handling */
17492. /* Literal number: */
17493. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
17494. /* Percentage of disk: */
17495. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
17496. /* Gap */
17497. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
17498. 
17499. /* ---------------------------------------------------------- */
17500. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
17501. # Script: DisplaySetFileStep
17502. 
17503. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17504. 
17505. /* add message and move to a new line. */
17506. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17507. ")
17508. 
17509. /* display the line. (hopefully.) */
17510. # Zone Footer Set Statistics Window Text
17511. 
17512. SetStatisticsWindowText("!Heading!
17513. ----------------------------------------------------------
17514. Zones Processed: 
17515. ----------------------------------------------------------
17516. !ZoneListByLine!
17517. ----------------------------------------------------------
17518. Zone Processing Step:
17519. !ZoneStepByLine!    
17520. ----------------------------------------------------------
17521. Current Zone:
17522. !ZoneFooter!
17523. ----------------------------------------------------------
17524. Volume Statistics:
17525. !VolumeStatisticsDetail!
17526. ----------------------------------------------------------
17527. Zone Detailed Report:
17528. ----------------------------------------------------------
17529. !ZoneStatisticsDetail!
17530. ----------------------------------------------------------
17531. ")
17532. 
17533. 
17534. 
17535. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17536. 
17537. # Script: BannerSet
17538. 
17539. # Script: DisplaySetDateTimeRun
17540. 
17541. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
17542. /* Xinclude "..\Display\BannerSet.MyDc"X */
17543. /* pause(1) */
17544. 
17545. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
17546. 
17547. Title('!Heading!')
17548. /* pause(1) */
17549. 
17550. /* NOTE: Can't round or truncate to integer precision. */
17551. 
17552. pause(1)
17553. 
17554. # your stuff HERE (X)... pre file select code.
17555. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
17556. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17557. 	# (X)
17558. 
17559. FileSelect
17560. 
17561. 	# your stuff can't really go here (errors.)
17562. 	# maybe for some reason I don't know of...
17563. 	
17564. 	# Actions next...
17565. 	# Script: ZoneDo ZoneTypeSelectOsMFT
17566. # MFT start.
17567. SelectNtfsSystemFiles(yes)
17568. # MFT end.
17569. 	
17570. 	FileActions
17571. 	  		/* ---------------------------------------------------------- */
17572. 	# Gap
17573. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
17574. 		# Script: DisplaySetFileStep
17575. 
17576. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17577. 
17578. /* add message and move to a new line. */
17579. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17580. ")
17581. 
17582. /* display the line. (hopefully.) */
17583. # Zone Footer Set Statistics Window Text
17584. 
17585. SetStatisticsWindowText("!Heading!
17586. ----------------------------------------------------------
17587. Zones Processed: 
17588. ----------------------------------------------------------
17589. !ZoneListByLine!
17590. ----------------------------------------------------------
17591. Zone Processing Step:
17592. !ZoneStepByLine!    
17593. ----------------------------------------------------------
17594. Current Zone:
17595. !ZoneFooter!
17596. ----------------------------------------------------------
17597. Volume Statistics:
17598. !VolumeStatisticsDetail!
17599. ----------------------------------------------------------
17600. Zone Detailed Report:
17601. ----------------------------------------------------------
17602. !ZoneStatisticsDetail!
17603. ----------------------------------------------------------
17604. ")
17605. 
17606. 
17607. 
17608. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17609. 
17610. # Script: BannerSet
17611. 
17612. # Script: DisplaySetDateTimeRun
17613. 
17614. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
17615. /* Xinclude "..\Display\BannerSet.MyDc"X */
17616. /* pause(1) */
17617. 
17618. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
17619. 
17620. Title('!Heading!')
17621. /* pause(1) */
17622. 
17623. /* NOTE: Can't round or truncate to integer precision. */
17624. 
17625. pause(1)
17626. 	
17627. 	# ACTUAL GAP
17628. 		/* AddGap Variant. */
17629. 	  	# Zone Do Gap
17630. # Gap Calculation Methods:
17631. 
17632. /* 1) Anything you need to add first. */
17633. /* empty */
17634. 
17635. /* ---------------------------------------------------------- */
17636. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
17637. 	# GapRequestedStd.
17638. 
17639. 		/* ---------------------------------------------------------- */
17640. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
17641. 
17642. 		# Gap Calculation Methods:
17643. 
17644. /* AddGap Variants */
17645. 
17646. 	/* Standard */
17647. 		# Gap Calculation Methods:
17648. 	/* AddGap Variants */
17649. 	/* Standard */
17650. 
17651. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
17652. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
17653. 
17654. 	SetVariable(GapRequested, GapRequestedStd)
17655. 	
17656. 
17657. 	/* MFT Low High Method */
17658. 		# Gap Calculation Methods:
17659. 	/* AddGap Variants */
17660. 	/* MFT Low High Method */
17661. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
17662. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
17663. 	SetVariable(GapRequested, GapRequestedMft)
17664. 	
17665. 
17666. 	/* OS Volume Type Method */
17667. 		# Gap Calculation Methods:
17668. 	/* AddGap Variants */
17669. 	/* OS Volume Type Method */
17670. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
17671. 	SetVariable(GapRequested, GapRequestedOs)
17672. 
17673. 
17674. 
17675. /* MakeGap Variants */
17676. 
17677. 	/* Original Os 1-3 + MFT 2 */
17678. 		# Gap Calculation Methods:
17679. 	/* MakeGap Variants */
17680. 	/* Original Os 1-3 + MFT 2 */
17681. 	/* plus MFT gap placed inline at the dividing zone. */
17682. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
17683. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
17684. 	SetVariable(GapRequested, GapRequestedOrig)
17685. 	
17686. 	
17687. /* Note: You could comment out the ones not in use */
17688. /* However having the data in the log is useful. */
17689. /* Therefore the following line is otherwise needed. */
17690. 
17691. /* Standard used */
17692. 
17693. SetVariable(GapRequested, GapRequestedStd)
17694. 
17695. # Gap Calculation Methods:
17696. 
17697. /* AddGap Variants */
17698. 	/* Standard */
17699. 	/* MFT Low High Method */
17700. 	/* OS Volume Type Method */
17701. 
17702. /* MakeGap Variants */
17703. 	/* Original Os 1-3 + MFT 2 */
17704. 
17705. /* Note: You could comment out the ones not in use */
17706. /* However having the data in the log is useful. */
17707. /* Therefore the following line is otherwise needed. */
17708. 
17709. /* Standard is used currently */
17710. 
17711. 
17712. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
17713. 
17714. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
17715. 
17716. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
17717. 
17718. /* ---------------------------------------------------------- */
17719. /* 3) SMALL ZONE ADJUSTMENT. */
17720. /* Gab cant be larger than half the Zone Size. */
17721. 
17722. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
17723. 	
17724. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
17725. 
17726. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
17727. 
17728. /* ---------------------------------------------------------- */
17729. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
17730. # Gap Adjustments.
17731. 
17732. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
17733. 	
17734. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
17735. 
17736. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
17737. 
17738. /* ---------------------------------------------------------- */
17739. # BYPASS THIS.
17740. 	/* This is definitely wrong. */
17741. 	/* The question is can we steal gap from the next zone */
17742. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
17743. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
17744. 		# Zone Overflow.
17745. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
17746. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
17747. 
17748. /* ---------------------------------------------------------- */
17749. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
17750. # Remaining free space available.
17751. 
17752. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
17753. 	
17754. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
17755. 
17756. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
17757. 
17758. /* ---------------------------------------------------------- */
17759. # CURRENT gap to use.
17760. 
17761. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
17762. 
17763. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
17764. 
17765. /* ---------------------------------------------------------- */
17766. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
17767. # Debugging.
17768. 
17769. 	SetVariable(GapUsed, GapCurrent) // for debugging
17770. 
17771. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
17772. 
17773. 		# Your code HERE
17774. 
17775. /* ---------------------------------------------------------- */
17776. /* 7) YOUR CODE. */
17777. # YOUR CODE HERE:
17778. 	# INPUT: GapCurrent or GapCurrentLoc
17779. 	# OUTPUT: GapUsed...
17780. 
17781. /* ---------------------------------------------------------- */
17782. # Gap Size.
17783. # Actual Size of Gap.
17784. 
17785. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
17786. 
17787. /* ---------------------------------------------------------- */
17788. /* xxxxxxxxxxxxxxxxxxxxxx */
17789. # ADD THE GAP
17790. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
17791. /* xxxxxxxxxxxxxxxxxxxxxx */
17792. 
17793. 	
17794. 	# Zone Statistics	
17795. 	# Script: ZoneDoStatistics
17796. # Zone / Volume Statistics and Display
17797. 		
17798. 	# Accumulate Totals
17799.   	# Script: ZoneDoVolumeTotals
17800. 
17801. /* Current total space used (by Zones and Gaps) */
17802. 
17803. SetVariable(VolumeZoneUsed, GapUsed)
17804. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
17805. /* Percentage */
17806. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
17807. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
17808. 
17809. /* Current total of free space requested */
17810. 
17811. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
17812. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17813. /* Percent. */
17814. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
17815. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17816. 
17817. /* Current total of free space used */
17818. 
17819. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
17820. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
17821. /* Percent */
17822. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
17823. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
17824. 
17825. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
17826. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
17827. /* Xinclude "..\DebugDisplayPause.MyDc"X */
17828. 
17829. 
17830. 	# Current Values
17831. 	# Script: ZoneDoCurrentSet
17832. 
17833. # Cluster, Sector, Block adjust for display.
17834. 	# Bytes per cluster is volume specific.
17835. 
17836. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
17837. 
17838. # Current Zone values.
17839. 	# Begin, end and size.
17840. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
17841. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
17842. 
17843. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
17844. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
17845. 
17846. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
17847. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
17848. 
17849. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
17850. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
17851. 
17852. 	SetVariable(ZoneFragments,				"!ZONE210N!")
17853. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
17854. 		
17855. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
17856. /* identical code to here: (separation not needed. TEST.) */	
17857. 
17858. # Current Gap, Actual and Free Values
17859. 	# Gap
17860. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
17861. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
17862. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
17863. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
17864. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
17865. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
17866. 	
17867. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
17868. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
17869. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
17870. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
17871. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
17872. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
17873. 	
17874. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
17875. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
17876. 	
17877. 	# Actual Size and End
17878. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
17879. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
17880. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
17881. 	
17882. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
17883. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
17884. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
17885. 
17886. # Gap Size & Rounding
17887. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
17888. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
17889. 	
17890. 	# Free Space
17891. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
17892. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
17893. 
17894. 	# Footer:
17895. SetVariable(ZoneFooter, "----------------------------------------------------------
17896. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
17897. 
17898. Statistics Report:
17899. ------------------
17900.    Size:  
17901.    ------------------------
17902.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17903.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17904.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17905. 
17906.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17907.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17908. 
17909.    Location:
17910.    ------------------------
17911.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17912.              Files End: !ZoneEndCurrent!
17913.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17914.       
17915.    Gap Settings:
17916.    ------------------------
17917.          Gap Requested: !ZoneGapSizePer!%
17918.       Volume Rounding: !ZoneVolRoundUpPer!%
17919.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17920.                  
17921.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
17922.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
17923.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
17924.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
17925.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
17926.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
17927.      
17928.    Free Space after Zone:
17929.    ------------------------
17930.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17931.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17932.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17933. 
17934. Directory and Files Select:
17935. ---------------------------
17936. !ZoneTypeSelectCurrent!               
17937. ---------------------------
17938. ----------------------------------------------------------
17939. ")
17940. 	# Zone Footer Set Statistics Window Text
17941. 
17942. SetStatisticsWindowText("!Heading!
17943. ----------------------------------------------------------
17944. Zones Processed: 
17945. ----------------------------------------------------------
17946. !ZoneListByLine!
17947. ----------------------------------------------------------
17948. Zone Processing Step:
17949. !ZoneStepByLine!    
17950. ----------------------------------------------------------
17951. Current Zone:
17952. !ZoneFooter!
17953. ----------------------------------------------------------
17954. Volume Statistics:
17955. !VolumeStatisticsDetail!
17956. ----------------------------------------------------------
17957. Zone Detailed Report:
17958. ----------------------------------------------------------
17959. !ZoneStatisticsDetail!
17960. ----------------------------------------------------------
17961. ")
17962. 
17963. 
17964. 	
17965.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
17966. 
17967. 	# Add Zone to list of zones for display.
17968. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
17969. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
17970. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
17971. 	# ??? Free Stats?
17972. 	# Footer:
17973. SetVariable(ZoneFooter, "----------------------------------------------------------
17974. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
17975. 
17976. Statistics Report:
17977. ------------------
17978.    Size:  
17979.    ------------------------
17980.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17981.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17982.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17983. 
17984.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17985.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17986. 
17987.    Location:
17988.    ------------------------
17989.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17990.              Files End: !ZoneEndCurrent!
17991.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17992.       
17993.    Gap Settings:
17994.    ------------------------
17995.          Gap Requested: !ZoneGapSizePer!%
17996.       Volume Rounding: !ZoneVolRoundUpPer!%
17997.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17998.                  
17999.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
18000.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
18001.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
18002.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
18003.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
18004.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
18005.      
18006.    Free Space after Zone:
18007.    ------------------------
18008.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18009.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18010.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18011. 
18012. Directory and Files Select:
18013. ---------------------------
18014. !ZoneTypeSelectCurrent!               
18015. ---------------------------
18016. ----------------------------------------------------------
18017. ")
18018. 
18019. 	# Add Zone Details to Report.	
18020. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
18021. !ZoneFooter!")
18022. 
18023. 
18024. 	
18025. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
18026. 		# Script: DisplaySetFileStep
18027. 
18028. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18029. 
18030. /* add message and move to a new line. */
18031. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18032. ")
18033. 
18034. /* display the line. (hopefully.) */
18035. # Zone Footer Set Statistics Window Text
18036. 
18037. SetStatisticsWindowText("!Heading!
18038. ----------------------------------------------------------
18039. Zones Processed: 
18040. ----------------------------------------------------------
18041. !ZoneListByLine!
18042. ----------------------------------------------------------
18043. Zone Processing Step:
18044. !ZoneStepByLine!    
18045. ----------------------------------------------------------
18046. Current Zone:
18047. !ZoneFooter!
18048. ----------------------------------------------------------
18049. Volume Statistics:
18050. !VolumeStatisticsDetail!
18051. ----------------------------------------------------------
18052. Zone Detailed Report:
18053. ----------------------------------------------------------
18054. !ZoneStatisticsDetail!
18055. ----------------------------------------------------------
18056. ")
18057. 
18058. 
18059. 
18060. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18061. 
18062. # Script: BannerSet
18063. 
18064. # Script: DisplaySetDateTimeRun
18065. 
18066. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
18067. /* Xinclude "..\Display\BannerSet.MyDc"X */
18068. /* pause(1) */
18069. 
18070. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
18071. 
18072. Title('!Heading!')
18073. /* pause(1) */
18074. 
18075. /* NOTE: Can't round or truncate to integer precision. */
18076. 
18077. pause(1)
18078. 	
18079. 		SetVariable(MftZone, ZoneCurrent) 
18080. 
18081. 		# File Action - Type Os MFT - Fast - PlaceNtfsSystemFiles.
18082. PlaceNtfsSystemFiles(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes), MftSize * 0.1)
18083. 	
18084. 
18085.   		SetVariable(MftSize,ZoneSize) 
18086. 
18087. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
18088. 		# Script: DisplaySetFileStep
18089. 
18090. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18091. 
18092. /* add message and move to a new line. */
18093. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18094. ")
18095. 
18096. /* display the line. (hopefully.) */
18097. # Zone Footer Set Statistics Window Text
18098. 
18099. SetStatisticsWindowText("!Heading!
18100. ----------------------------------------------------------
18101. Zones Processed: 
18102. ----------------------------------------------------------
18103. !ZoneListByLine!
18104. ----------------------------------------------------------
18105. Zone Processing Step:
18106. !ZoneStepByLine!    
18107. ----------------------------------------------------------
18108. Current Zone:
18109. !ZoneFooter!
18110. ----------------------------------------------------------
18111. Volume Statistics:
18112. !VolumeStatisticsDetail!
18113. ----------------------------------------------------------
18114. Zone Detailed Report:
18115. ----------------------------------------------------------
18116. !ZoneStatisticsDetail!
18117. ----------------------------------------------------------
18118. ")
18119. 
18120. 
18121. 
18122. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18123. 
18124. # Script: BannerSet
18125. 
18126. # Script: DisplaySetDateTimeRun
18127. 
18128. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
18129. /* Xinclude "..\Display\BannerSet.MyDc"X */
18130. /* pause(1) */
18131. 
18132. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
18133. 
18134. Title('!Heading!')
18135. /* pause(1) */
18136. 
18137. /* NOTE: Can't round or truncate to integer precision. */
18138. 
18139. pause(1)
18140.   	# Script: ZoneDoFooter
18141. 
18142. /* ---------------------------------------------------------- */
18143. # File Select
18144. 	# Select Statments
18145. # File Actions 
18146. 	# Standard or OS File Actions.
18147. 	# Resume...
18148. 	
18149. 	# your stuff HERE (X)... post zone (file) file actions code.
18150. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
18151. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18152. 		# (X)
18153. 		
18154. 		/* ??? Set window? */
18155. 	
18156. 	# ADD THE GAP
18157. # Vacate (good for diagnostics)
18158. # DoNotVacate - DO NOT Vacate (recommended)
18159. # DoNotVacate - DO NOT Vacate (recommended)
18160. 
18161. # Vacate
18162. /* AddGap(GapUsedLoc) */
18163. 
18164. # DO Not Vacate
18165. AddGap(GapUsedLoc, DoNotVacate) 
18166. 	
18167. 	
18168. # Script: GapZoneCommand
18169. # *** Moved to setting yours ***
18170. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
18171. # Controlled via settings commands
18172. # DoNotVacate - DO NOT Vacate (recommended)
18173. 
18174. # Vacate
18175. /* AddGap(GapUsedLoc) */
18176. 
18177. # DO Not Vacate
18178. AddGap(GapUsedLoc, DoNotVacate) 
18179. 	
18180. 	
18181. # Vacate /* AddGap(GapUsed) */
18182. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
18183. 	
18184. 
18185. 		
18186. # 
18187. FileEnd
18188. /* ---------------------------------------------------------- */
18189. 
18190. # your stuff HERE (X)... post zone (file) code.
18191. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
18192. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18193. 	# (X)
18194. 
18195. SetVariable(FileStepDescription,"Zone finished, reporting.")
18196. # Script: DisplaySetFileStep
18197. 
18198. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18199. 
18200. /* add message and move to a new line. */
18201. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18202. ")
18203. 
18204. /* display the line. (hopefully.) */
18205. # Zone Footer Set Statistics Window Text
18206. 
18207. SetStatisticsWindowText("!Heading!
18208. ----------------------------------------------------------
18209. Zones Processed: 
18210. ----------------------------------------------------------
18211. !ZoneListByLine!
18212. ----------------------------------------------------------
18213. Zone Processing Step:
18214. !ZoneStepByLine!    
18215. ----------------------------------------------------------
18216. Current Zone:
18217. !ZoneFooter!
18218. ----------------------------------------------------------
18219. Volume Statistics:
18220. !VolumeStatisticsDetail!
18221. ----------------------------------------------------------
18222. Zone Detailed Report:
18223. ----------------------------------------------------------
18224. !ZoneStatisticsDetail!
18225. ----------------------------------------------------------
18226. ")
18227. 
18228. 
18229. 
18230. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18231. 
18232. # Script: BannerSet
18233. 
18234. # Script: DisplaySetDateTimeRun
18235. 
18236. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
18237. /* Xinclude "..\Display\BannerSet.MyDc"X */
18238. /* pause(1) */
18239. 
18240. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
18241. 
18242. Title('!Heading!')
18243. /* pause(1) */
18244. 
18245. /* NOTE: Can't round or truncate to integer precision. */
18246. 
18247. pause(1)
18248. 
18249. # Script: ZoneWhenFinished
18250. 
18251. # Script: BannerSet
18252. 
18253. # Script: DisplaySetDateTimeRun
18254. 
18255. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
18256. /* Xinclude "..\Display\BannerSet.MyDc"X */
18257. /* pause(1) */
18258. 
18259. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
18260. 
18261. Title('!Heading!')
18262. /* pause(1) */
18263. 
18264. /* NOTE: Can't round or truncate to integer precision. */
18265. 
18266. # Script: BannerLog
18267. 
18268. AppendLogfile("!LogFileName!", "!Title!")
18269. 
18270. 
18271. 
18272. # Zone Statistics	
18273. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
18274. 
18275. # Footer:
18276. SetVariable(ZoneFooter, "----------------------------------------------------------
18277. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
18278. 
18279. Statistics Report:
18280. ------------------
18281.    Size:  
18282.    ------------------------
18283.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18284.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18285.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18286. 
18287.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18288.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18289. 
18290.    Location:
18291.    ------------------------
18292.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18293.              Files End: !ZoneEndCurrent!
18294.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18295.       
18296.    Gap Settings:
18297.    ------------------------
18298.          Gap Requested: !ZoneGapSizePer!%
18299.       Volume Rounding: !ZoneVolRoundUpPer!%
18300.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18301.                  
18302.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
18303.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
18304.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
18305.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
18306.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
18307.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
18308.      
18309.    Free Space after Zone:
18310.    ------------------------
18311.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18312.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18313.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18314. 
18315. Directory and Files Select:
18316. ---------------------------
18317. !ZoneTypeSelectCurrent!               
18318. ---------------------------
18319. ----------------------------------------------------------
18320. ")
18321. 
18322. AppendLogfile("!LogFileName!", ".")
18323. AppendLogfile("!LogFileName!", "!ZoneFooter!")
18324. AppendLogfile("!LogFileName!", ".")
18325. 
18326. # Zone Footer Set Statistics Window Text
18327. 
18328. SetStatisticsWindowText("!Heading!
18329. ----------------------------------------------------------
18330. Zones Processed: 
18331. ----------------------------------------------------------
18332. !ZoneListByLine!
18333. ----------------------------------------------------------
18334. Zone Processing Step:
18335. !ZoneStepByLine!    
18336. ----------------------------------------------------------
18337. Current Zone:
18338. !ZoneFooter!
18339. ----------------------------------------------------------
18340. Volume Statistics:
18341. !VolumeStatisticsDetail!
18342. ----------------------------------------------------------
18343. Zone Detailed Report:
18344. ----------------------------------------------------------
18345. !ZoneStatisticsDetail!
18346. ----------------------------------------------------------
18347. ")
18348. 
18349. 
18350. 
18351. /* pause() */
18352. /* pause() */
18353. 
18354. 
18355. 
18356. /* ---------------------------------------------------------- */
18357. 
18358.   
18359. /* ---------------------------------------------------------- */
18360. # DIR
18361. 
18362. # Script: DefragZoneTypeOsDir
18363. /* ---------------------------------------------------------- */
18364. SetVariable(ZoneLabel,				"DIR") // "5"
18365. SetVariable(ZoneDescription, 		"Directories.")
18366. SetVariable(ZoneCurrentAjust, 		2)
18367. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpDir!")
18368. SetVariable(ZoneGapSize, 			"!ZoneGapSizeDir!")
18369. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectOsDIR
18370. # DIR start.
18371. Directory(yes)
18372. # DIR end.
18373. ')
18374. 
18375. 	# Script: ZoneDoHeader
18376. 
18377. # Script: ZoneWhenStarted
18378. 
18379. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
18380. # Script: DisplaySetZone
18381. 
18382. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
18383. SetVariable(FileStepDescription,	"")
18384. 
18385. SetVariable(ZoneStepByLine, 			"Zone started.
18386. ")
18387. 
18388. # Script: BannerDescriptionSet
18389. 
18390. # Script: BannerSet
18391. 
18392. # Script: DisplaySetDateTimeRun
18393. 
18394. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
18395. /* Xinclude "..\Display\BannerSet.MyDc"X */
18396. /* pause(1) */
18397. 
18398. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
18399. 
18400. Title('!Heading!')
18401. /* pause(1) */
18402. 
18403. /* NOTE: Can't round or truncate to integer precision. */
18404. 
18405. # Script: BannerLog
18406. 
18407. AppendLogfile("!LogFileName!", "!Title!")
18408. 
18409. 
18410. 
18411. pause(1)
18412. 
18413. 
18414. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
18415. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
18416. 
18417. SetVariable(ZoneStepNoCurrent, 0)
18418. 
18419. 
18420. # Script: ZoneDoCurrentClear
18421. 
18422. SetVariable(ZoneTypeSelectCurrent, 		"")
18423. 
18424. SetVariable(ZoneBeginCurrent, 			0)
18425. SetVariable(ZoneBeginPerCurrent, 		0)
18426. SetVariable(ZoneEndCurrent, 			0)
18427. SetVariable(ZoneEndPerCurrent, 			0)
18428. 
18429. SetVariable(ZoneSizeCurrent,			0)
18430. SetVariable(ZoneSizePerCurrent,			0)
18431. 
18432. SetVariable(ZoneGapRequestedCurrent,	0)
18433. SetVariable(ZoneGapRoundedCurrent, 		0)
18434. SetVariable(ZoneGapAdjustedCurrent, 	0)
18435. SetVariable(ZoneGapAvailableCurrent, 	0)
18436. SetVariable(ZoneGapCurrent,				0)
18437. SetVariable(ZoneGapUsedCurrent, 		0)
18438. 
18439. SetVariable(ZoneGapActualCurrent, 		0)
18440. SetVariable(ZoneGapActualPerCurrent, 	0)
18441. 
18442. SetVariable(ZoneSizeActual, 			0)
18443. SetVariable(ZoneSizeActualCurrent,		0)
18444. 
18445. SetVariable(ZoneEndActual, 				0)
18446. SetVariable(ZoneEndActualCurrent,		0)			
18447. SetVariable(ZoneSizeActualPerCurrent, 	0)
18448.       
18449. SetVariable(ZoneFilesFolders,			0)
18450. SetVariable(ZoneFilesFoldersPer,		0) 
18451. 
18452. SetVariable(ZoneFragments,				0)
18453. SetVariable(ZoneFragmentsPer,			0) 
18454. 		
18455. SetVariable(ZoneEndActualCurrent, 		0)
18456. SetVariable(ZoneEndActualPerCurrent, 	0)
18457. 
18458. # Gap Calculation Methodology:
18459. 	# Requested
18460. 	SetVariable(GapRequested, 			0) 
18461. 	SetVariable(GapRequestedStd, 		0) 
18462. 	SetVariable(GapRequestedMft, 		0) 
18463. 	SetVariable(GapRequestedOs, 		0) 
18464. 	SetVariable(GapRequestedOriginal, 	0) 
18465. 	
18466. 	# Gap Adjustments
18467. 	SetVariable(GapRounded, 			0)
18468. 	# SetVariable(GapAdjusted, 			0)
18469. 	SetVariable(GapAvailable, 			0)
18470. 	SetVariable(GapCurrent, 			0)
18471. 	SetVariable(GapActual, 				0)
18472. 	SetVariable(GapUsed, 				0)
18473. 	
18474. 	# Gap Adjustments
18475. 	SetVariable(GapRoundedLoc, 			0)
18476. 	# SetVariable(GapAdjustedLoc, 		0)
18477. 	SetVariable(GapAvailableLoc, 		0)
18478. 	SetVariable(GapCurrentLoc, 			0)
18479. 	SetVariable(GapActualLoc,			0)
18480. 	SetVariable(GapUsedLoc,				0)
18481. 	
18482. 	# Space usage
18483. 	SetVariable(ZoneFreePerRequested, 	0)
18484. 	SetVariable(ZoneFreePerUsed, 		0)
18485. 
18486. # Gap Size & Rounding
18487. 	SetVariable(ZoneGapSizePer, 		0)
18488. 	SetVariable(ZoneVolRoundUpPer, 		0)
18489. 	
18490. 	# Free Space
18491. 	SetVariable(ZoneFreeUsedPer, 		0)
18492. 	SetVariable(ZoneFreeRequestedPer, 	0)
18493. 
18494. 
18495. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
18496. 
18497. # Footer:
18498. SetVariable(ZoneFooter, "----------------------------------------------------------
18499. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
18500. 
18501. Statistics Report:
18502. ------------------
18503.    Size:  
18504.    ------------------------
18505.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18506.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18507.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18508. 
18509.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18510.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18511. 
18512.    Location:
18513.    ------------------------
18514.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18515.              Files End: !ZoneEndCurrent!
18516.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18517.       
18518.    Gap Settings:
18519.    ------------------------
18520.          Gap Requested: !ZoneGapSizePer!%
18521.       Volume Rounding: !ZoneVolRoundUpPer!%
18522.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18523.                  
18524.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
18525.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
18526.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
18527.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
18528.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
18529.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
18530.      
18531.    Free Space after Zone:
18532.    ------------------------
18533.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18534.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18535.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18536. 
18537. Directory and Files Select:
18538. ---------------------------
18539. !ZoneTypeSelectCurrent!               
18540. ---------------------------
18541. ----------------------------------------------------------
18542. ")
18543. 
18544. # Script: BannerSet
18545. 
18546. # Script: DisplaySetDateTimeRun
18547. 
18548. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
18549. /* Xinclude "..\Display\BannerSet.MyDc"X */
18550. /* pause(1) */
18551. 
18552. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
18553. 
18554. Title('!Heading!')
18555. /* pause(1) */
18556. 
18557. /* NOTE: Can't round or truncate to integer precision. */
18558. 
18559. # Script: BannerLog
18560. 
18561. AppendLogfile("!LogFileName!", "!Title!")
18562. 
18563. 
18564. 
18565. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
18566. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
18567. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:21")
18568. 
18569. SetVariable(ZoneListByLine, "!ZoneListByLine!
18570. Zone: !ZoneNoCurrent! 2021-11-13 20:31:21 0:00:04 !ZoneLabel! !ZoneDescription!")
18571. 
18572. 
18573. /* Fixed Zone Position Handling */
18574. /* Literal number: */
18575. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
18576. /* Percentage of disk: */
18577. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
18578. /* Gap */
18579. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
18580. 
18581. /* ---------------------------------------------------------- */
18582. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
18583. # Script: DisplaySetFileStep
18584. 
18585. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18586. 
18587. /* add message and move to a new line. */
18588. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18589. ")
18590. 
18591. /* display the line. (hopefully.) */
18592. # Zone Footer Set Statistics Window Text
18593. 
18594. SetStatisticsWindowText("!Heading!
18595. ----------------------------------------------------------
18596. Zones Processed: 
18597. ----------------------------------------------------------
18598. !ZoneListByLine!
18599. ----------------------------------------------------------
18600. Zone Processing Step:
18601. !ZoneStepByLine!    
18602. ----------------------------------------------------------
18603. Current Zone:
18604. !ZoneFooter!
18605. ----------------------------------------------------------
18606. Volume Statistics:
18607. !VolumeStatisticsDetail!
18608. ----------------------------------------------------------
18609. Zone Detailed Report:
18610. ----------------------------------------------------------
18611. !ZoneStatisticsDetail!
18612. ----------------------------------------------------------
18613. ")
18614. 
18615. 
18616. 
18617. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18618. 
18619. # Script: BannerSet
18620. 
18621. # Script: DisplaySetDateTimeRun
18622. 
18623. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
18624. /* Xinclude "..\Display\BannerSet.MyDc"X */
18625. /* pause(1) */
18626. 
18627. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
18628. 
18629. Title('!Heading!')
18630. /* pause(1) */
18631. 
18632. /* NOTE: Can't round or truncate to integer precision. */
18633. 
18634. pause(1)
18635. 
18636. # your stuff HERE (X)... pre file select code.
18637. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
18638. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18639. 	# (X)
18640. 
18641. FileSelect
18642. 
18643. 	# your stuff can't really go here (errors.)
18644. 	# maybe for some reason I don't know of...
18645. 	
18646. 	# Actions next...
18647. 	# Script: ZoneDo ZoneTypeSelectOsDIR
18648. # DIR start.
18649. Directory(yes)
18650. # DIR end.
18651. 
18652. 
18653. 	FileActions
18654. 	  		/* ---------------------------------------------------------- */
18655. 	# Gap
18656. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
18657. 		# Script: DisplaySetFileStep
18658. 
18659. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18660. 
18661. /* add message and move to a new line. */
18662. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18663. ")
18664. 
18665. /* display the line. (hopefully.) */
18666. # Zone Footer Set Statistics Window Text
18667. 
18668. SetStatisticsWindowText("!Heading!
18669. ----------------------------------------------------------
18670. Zones Processed: 
18671. ----------------------------------------------------------
18672. !ZoneListByLine!
18673. ----------------------------------------------------------
18674. Zone Processing Step:
18675. !ZoneStepByLine!    
18676. ----------------------------------------------------------
18677. Current Zone:
18678. !ZoneFooter!
18679. ----------------------------------------------------------
18680. Volume Statistics:
18681. !VolumeStatisticsDetail!
18682. ----------------------------------------------------------
18683. Zone Detailed Report:
18684. ----------------------------------------------------------
18685. !ZoneStatisticsDetail!
18686. ----------------------------------------------------------
18687. ")
18688. 
18689. 
18690. 
18691. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18692. 
18693. # Script: BannerSet
18694. 
18695. # Script: DisplaySetDateTimeRun
18696. 
18697. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
18698. /* Xinclude "..\Display\BannerSet.MyDc"X */
18699. /* pause(1) */
18700. 
18701. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
18702. 
18703. Title('!Heading!')
18704. /* pause(1) */
18705. 
18706. /* NOTE: Can't round or truncate to integer precision. */
18707. 
18708. pause(1)
18709. 	
18710. 	# ACTUAL GAP
18711. 		/* AddGap Variant. */
18712. 	  	# Zone Do Gap
18713. # Gap Calculation Methods:
18714. 
18715. /* 1) Anything you need to add first. */
18716. /* empty */
18717. 
18718. /* ---------------------------------------------------------- */
18719. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
18720. 	# GapRequestedStd.
18721. 
18722. 		/* ---------------------------------------------------------- */
18723. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
18724. 
18725. 		# Gap Calculation Methods:
18726. 
18727. /* AddGap Variants */
18728. 
18729. 	/* Standard */
18730. 		# Gap Calculation Methods:
18731. 	/* AddGap Variants */
18732. 	/* Standard */
18733. 
18734. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
18735. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
18736. 
18737. 	SetVariable(GapRequested, GapRequestedStd)
18738. 	
18739. 
18740. 	/* MFT Low High Method */
18741. 		# Gap Calculation Methods:
18742. 	/* AddGap Variants */
18743. 	/* MFT Low High Method */
18744. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
18745. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
18746. 	SetVariable(GapRequested, GapRequestedMft)
18747. 	
18748. 
18749. 	/* OS Volume Type Method */
18750. 		# Gap Calculation Methods:
18751. 	/* AddGap Variants */
18752. 	/* OS Volume Type Method */
18753. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
18754. 	SetVariable(GapRequested, GapRequestedOs)
18755. 
18756. 
18757. 
18758. /* MakeGap Variants */
18759. 
18760. 	/* Original Os 1-3 + MFT 2 */
18761. 		# Gap Calculation Methods:
18762. 	/* MakeGap Variants */
18763. 	/* Original Os 1-3 + MFT 2 */
18764. 	/* plus MFT gap placed inline at the dividing zone. */
18765. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
18766. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
18767. 	SetVariable(GapRequested, GapRequestedOrig)
18768. 	
18769. 	
18770. /* Note: You could comment out the ones not in use */
18771. /* However having the data in the log is useful. */
18772. /* Therefore the following line is otherwise needed. */
18773. 
18774. /* Standard used */
18775. 
18776. SetVariable(GapRequested, GapRequestedStd)
18777. 
18778. # Gap Calculation Methods:
18779. 
18780. /* AddGap Variants */
18781. 	/* Standard */
18782. 	/* MFT Low High Method */
18783. 	/* OS Volume Type Method */
18784. 
18785. /* MakeGap Variants */
18786. 	/* Original Os 1-3 + MFT 2 */
18787. 
18788. /* Note: You could comment out the ones not in use */
18789. /* However having the data in the log is useful. */
18790. /* Therefore the following line is otherwise needed. */
18791. 
18792. /* Standard is used currently */
18793. 
18794. 
18795. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
18796. 
18797. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
18798. 
18799. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
18800. 
18801. /* ---------------------------------------------------------- */
18802. /* 3) SMALL ZONE ADJUSTMENT. */
18803. /* Gab cant be larger than half the Zone Size. */
18804. 
18805. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
18806. 	
18807. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
18808. 
18809. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
18810. 
18811. /* ---------------------------------------------------------- */
18812. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
18813. # Gap Adjustments.
18814. 
18815. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
18816. 	
18817. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
18818. 
18819. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
18820. 
18821. /* ---------------------------------------------------------- */
18822. # BYPASS THIS.
18823. 	/* This is definitely wrong. */
18824. 	/* The question is can we steal gap from the next zone */
18825. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
18826. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
18827. 		# Zone Overflow.
18828. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
18829. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
18830. 
18831. /* ---------------------------------------------------------- */
18832. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
18833. # Remaining free space available.
18834. 
18835. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
18836. 	
18837. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
18838. 
18839. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
18840. 
18841. /* ---------------------------------------------------------- */
18842. # CURRENT gap to use.
18843. 
18844. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
18845. 
18846. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
18847. 
18848. /* ---------------------------------------------------------- */
18849. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
18850. # Debugging.
18851. 
18852. 	SetVariable(GapUsed, GapCurrent) // for debugging
18853. 
18854. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
18855. 
18856. 		# Your code HERE
18857. 
18858. /* ---------------------------------------------------------- */
18859. /* 7) YOUR CODE. */
18860. # YOUR CODE HERE:
18861. 	# INPUT: GapCurrent or GapCurrentLoc
18862. 	# OUTPUT: GapUsed...
18863. 
18864. /* ---------------------------------------------------------- */
18865. # Gap Size.
18866. # Actual Size of Gap.
18867. 
18868. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
18869. 
18870. /* ---------------------------------------------------------- */
18871. /* xxxxxxxxxxxxxxxxxxxxxx */
18872. # ADD THE GAP
18873. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
18874. /* xxxxxxxxxxxxxxxxxxxxxx */
18875. 
18876. 	
18877. 	# Zone Statistics	
18878. 	# Script: ZoneDoStatistics
18879. # Zone / Volume Statistics and Display
18880. 		
18881. 	# Accumulate Totals
18882.   	# Script: ZoneDoVolumeTotals
18883. 
18884. /* Current total space used (by Zones and Gaps) */
18885. 
18886. SetVariable(VolumeZoneUsed, GapUsed)
18887. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
18888. /* Percentage */
18889. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
18890. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
18891. 
18892. /* Current total of free space requested */
18893. 
18894. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
18895. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18896. /* Percent. */
18897. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
18898. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18899. 
18900. /* Current total of free space used */
18901. 
18902. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
18903. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
18904. /* Percent */
18905. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
18906. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
18907. 
18908. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
18909. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
18910. /* Xinclude "..\DebugDisplayPause.MyDc"X */
18911. 
18912. 
18913. 	# Current Values
18914. 	# Script: ZoneDoCurrentSet
18915. 
18916. # Cluster, Sector, Block adjust for display.
18917. 	# Bytes per cluster is volume specific.
18918. 
18919. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
18920. 
18921. # Current Zone values.
18922. 	# Begin, end and size.
18923. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
18924. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
18925. 
18926. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
18927. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
18928. 
18929. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
18930. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
18931. 
18932. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
18933. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
18934. 
18935. 	SetVariable(ZoneFragments,				"!ZONE210N!")
18936. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
18937. 		
18938. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
18939. /* identical code to here: (separation not needed. TEST.) */	
18940. 
18941. # Current Gap, Actual and Free Values
18942. 	# Gap
18943. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
18944. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
18945. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
18946. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
18947. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
18948. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
18949. 	
18950. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
18951. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
18952. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
18953. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
18954. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
18955. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
18956. 	
18957. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
18958. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
18959. 	
18960. 	# Actual Size and End
18961. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
18962. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
18963. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
18964. 	
18965. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
18966. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
18967. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
18968. 
18969. # Gap Size & Rounding
18970. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
18971. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
18972. 	
18973. 	# Free Space
18974. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
18975. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
18976. 
18977. 	# Footer:
18978. SetVariable(ZoneFooter, "----------------------------------------------------------
18979. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
18980. 
18981. Statistics Report:
18982. ------------------
18983.    Size:  
18984.    ------------------------
18985.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18986.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18987.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18988. 
18989.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18990.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18991. 
18992.    Location:
18993.    ------------------------
18994.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18995.              Files End: !ZoneEndCurrent!
18996.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18997.       
18998.    Gap Settings:
18999.    ------------------------
19000.          Gap Requested: !ZoneGapSizePer!%
19001.       Volume Rounding: !ZoneVolRoundUpPer!%
19002.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19003.                  
19004.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
19005.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
19006.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
19007.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
19008.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
19009.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
19010.      
19011.    Free Space after Zone:
19012.    ------------------------
19013.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19014.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19015.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19016. 
19017. Directory and Files Select:
19018. ---------------------------
19019. !ZoneTypeSelectCurrent!               
19020. ---------------------------
19021. ----------------------------------------------------------
19022. ")
19023. 	# Zone Footer Set Statistics Window Text
19024. 
19025. SetStatisticsWindowText("!Heading!
19026. ----------------------------------------------------------
19027. Zones Processed: 
19028. ----------------------------------------------------------
19029. !ZoneListByLine!
19030. ----------------------------------------------------------
19031. Zone Processing Step:
19032. !ZoneStepByLine!    
19033. ----------------------------------------------------------
19034. Current Zone:
19035. !ZoneFooter!
19036. ----------------------------------------------------------
19037. Volume Statistics:
19038. !VolumeStatisticsDetail!
19039. ----------------------------------------------------------
19040. Zone Detailed Report:
19041. ----------------------------------------------------------
19042. !ZoneStatisticsDetail!
19043. ----------------------------------------------------------
19044. ")
19045. 
19046. 
19047. 	
19048.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
19049. 
19050. 	# Add Zone to list of zones for display.
19051. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
19052. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
19053. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
19054. 	# ??? Free Stats?
19055. 	# Footer:
19056. SetVariable(ZoneFooter, "----------------------------------------------------------
19057. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
19058. 
19059. Statistics Report:
19060. ------------------
19061.    Size:  
19062.    ------------------------
19063.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19064.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19065.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19066. 
19067.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19068.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19069. 
19070.    Location:
19071.    ------------------------
19072.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19073.              Files End: !ZoneEndCurrent!
19074.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19075.       
19076.    Gap Settings:
19077.    ------------------------
19078.          Gap Requested: !ZoneGapSizePer!%
19079.       Volume Rounding: !ZoneVolRoundUpPer!%
19080.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19081.                  
19082.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
19083.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
19084.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
19085.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
19086.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
19087.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
19088.      
19089.    Free Space after Zone:
19090.    ------------------------
19091.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19092.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19093.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19094. 
19095. Directory and Files Select:
19096. ---------------------------
19097. !ZoneTypeSelectCurrent!               
19098. ---------------------------
19099. ----------------------------------------------------------
19100. ")
19101. 
19102. 	# Add Zone Details to Report.	
19103. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
19104. !ZoneFooter!")
19105. 
19106. 
19107. 	
19108. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
19109. 		# Script: DisplaySetFileStep
19110. 
19111. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19112. 
19113. /* add message and move to a new line. */
19114. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19115. ")
19116. 
19117. /* display the line. (hopefully.) */
19118. # Zone Footer Set Statistics Window Text
19119. 
19120. SetStatisticsWindowText("!Heading!
19121. ----------------------------------------------------------
19122. Zones Processed: 
19123. ----------------------------------------------------------
19124. !ZoneListByLine!
19125. ----------------------------------------------------------
19126. Zone Processing Step:
19127. !ZoneStepByLine!    
19128. ----------------------------------------------------------
19129. Current Zone:
19130. !ZoneFooter!
19131. ----------------------------------------------------------
19132. Volume Statistics:
19133. !VolumeStatisticsDetail!
19134. ----------------------------------------------------------
19135. Zone Detailed Report:
19136. ----------------------------------------------------------
19137. !ZoneStatisticsDetail!
19138. ----------------------------------------------------------
19139. ")
19140. 
19141. 
19142. 
19143. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19144. 
19145. # Script: BannerSet
19146. 
19147. # Script: DisplaySetDateTimeRun
19148. 
19149. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
19150. /* Xinclude "..\Display\BannerSet.MyDc"X */
19151. /* pause(1) */
19152. 
19153. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
19154. 
19155. Title('!Heading!')
19156. /* pause(1) */
19157. 
19158. /* NOTE: Can't round or truncate to integer precision. */
19159. 
19160. pause(1)
19161. 	
19162. 		# File Action - Type Os Dir - Fast -  SortByName.
19163. # BY 10
19164. # SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
19165. 	MoveUpToZone()
19166. 
19167. 
19168. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
19169. 		# Script: DisplaySetFileStep
19170. 
19171. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19172. 
19173. /* add message and move to a new line. */
19174. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19175. ")
19176. 
19177. /* display the line. (hopefully.) */
19178. # Zone Footer Set Statistics Window Text
19179. 
19180. SetStatisticsWindowText("!Heading!
19181. ----------------------------------------------------------
19182. Zones Processed: 
19183. ----------------------------------------------------------
19184. !ZoneListByLine!
19185. ----------------------------------------------------------
19186. Zone Processing Step:
19187. !ZoneStepByLine!    
19188. ----------------------------------------------------------
19189. Current Zone:
19190. !ZoneFooter!
19191. ----------------------------------------------------------
19192. Volume Statistics:
19193. !VolumeStatisticsDetail!
19194. ----------------------------------------------------------
19195. Zone Detailed Report:
19196. ----------------------------------------------------------
19197. !ZoneStatisticsDetail!
19198. ----------------------------------------------------------
19199. ")
19200. 
19201. 
19202. 
19203. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19204. 
19205. # Script: BannerSet
19206. 
19207. # Script: DisplaySetDateTimeRun
19208. 
19209. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
19210. /* Xinclude "..\Display\BannerSet.MyDc"X */
19211. /* pause(1) */
19212. 
19213. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
19214. 
19215. Title('!Heading!')
19216. /* pause(1) */
19217. 
19218. /* NOTE: Can't round or truncate to integer precision. */
19219. 
19220. pause(1)
19221. 	# Script: ZoneDoFooter
19222. 
19223. /* ---------------------------------------------------------- */
19224. # File Select
19225. 	# Select Statments
19226. # File Actions 
19227. 	# Standard or OS File Actions.
19228. 	# Resume...
19229. 	
19230. 	# your stuff HERE (X)... post zone (file) file actions code.
19231. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
19232. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19233. 		# (X)
19234. 		
19235. 		/* ??? Set window? */
19236. 	
19237. 	# ADD THE GAP
19238. # Vacate (good for diagnostics)
19239. # DoNotVacate - DO NOT Vacate (recommended)
19240. # DoNotVacate - DO NOT Vacate (recommended)
19241. 
19242. # Vacate
19243. /* AddGap(GapUsedLoc) */
19244. 
19245. # DO Not Vacate
19246. AddGap(GapUsedLoc, DoNotVacate) 
19247. 	
19248. 	
19249. # Script: GapZoneCommand
19250. # *** Moved to setting yours ***
19251. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
19252. # Controlled via settings commands
19253. # DoNotVacate - DO NOT Vacate (recommended)
19254. 
19255. # Vacate
19256. /* AddGap(GapUsedLoc) */
19257. 
19258. # DO Not Vacate
19259. AddGap(GapUsedLoc, DoNotVacate) 
19260. 	
19261. 	
19262. # Vacate /* AddGap(GapUsed) */
19263. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
19264. 	
19265. 
19266. 		
19267. # 
19268. FileEnd
19269. /* ---------------------------------------------------------- */
19270. 
19271. # your stuff HERE (X)... post zone (file) code.
19272. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
19273. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19274. 	# (X)
19275. 
19276. SetVariable(FileStepDescription,"Zone finished, reporting.")
19277. # Script: DisplaySetFileStep
19278. 
19279. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19280. 
19281. /* add message and move to a new line. */
19282. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19283. ")
19284. 
19285. /* display the line. (hopefully.) */
19286. # Zone Footer Set Statistics Window Text
19287. 
19288. SetStatisticsWindowText("!Heading!
19289. ----------------------------------------------------------
19290. Zones Processed: 
19291. ----------------------------------------------------------
19292. !ZoneListByLine!
19293. ----------------------------------------------------------
19294. Zone Processing Step:
19295. !ZoneStepByLine!    
19296. ----------------------------------------------------------
19297. Current Zone:
19298. !ZoneFooter!
19299. ----------------------------------------------------------
19300. Volume Statistics:
19301. !VolumeStatisticsDetail!
19302. ----------------------------------------------------------
19303. Zone Detailed Report:
19304. ----------------------------------------------------------
19305. !ZoneStatisticsDetail!
19306. ----------------------------------------------------------
19307. ")
19308. 
19309. 
19310. 
19311. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19312. 
19313. # Script: BannerSet
19314. 
19315. # Script: DisplaySetDateTimeRun
19316. 
19317. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
19318. /* Xinclude "..\Display\BannerSet.MyDc"X */
19319. /* pause(1) */
19320. 
19321. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
19322. 
19323. Title('!Heading!')
19324. /* pause(1) */
19325. 
19326. /* NOTE: Can't round or truncate to integer precision. */
19327. 
19328. pause(1)
19329. 
19330. # Script: ZoneWhenFinished
19331. 
19332. # Script: BannerSet
19333. 
19334. # Script: DisplaySetDateTimeRun
19335. 
19336. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
19337. /* Xinclude "..\Display\BannerSet.MyDc"X */
19338. /* pause(1) */
19339. 
19340. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
19341. 
19342. Title('!Heading!')
19343. /* pause(1) */
19344. 
19345. /* NOTE: Can't round or truncate to integer precision. */
19346. 
19347. # Script: BannerLog
19348. 
19349. AppendLogfile("!LogFileName!", "!Title!")
19350. 
19351. 
19352. 
19353. # Zone Statistics	
19354. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
19355. 
19356. # Footer:
19357. SetVariable(ZoneFooter, "----------------------------------------------------------
19358. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
19359. 
19360. Statistics Report:
19361. ------------------
19362.    Size:  
19363.    ------------------------
19364.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19365.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19366.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19367. 
19368.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19369.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19370. 
19371.    Location:
19372.    ------------------------
19373.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19374.              Files End: !ZoneEndCurrent!
19375.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19376.       
19377.    Gap Settings:
19378.    ------------------------
19379.          Gap Requested: !ZoneGapSizePer!%
19380.       Volume Rounding: !ZoneVolRoundUpPer!%
19381.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19382.                  
19383.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
19384.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
19385.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
19386.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
19387.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
19388.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
19389.      
19390.    Free Space after Zone:
19391.    ------------------------
19392.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19393.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19394.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19395. 
19396. Directory and Files Select:
19397. ---------------------------
19398. !ZoneTypeSelectCurrent!               
19399. ---------------------------
19400. ----------------------------------------------------------
19401. ")
19402. 
19403. AppendLogfile("!LogFileName!", ".")
19404. AppendLogfile("!LogFileName!", "!ZoneFooter!")
19405. AppendLogfile("!LogFileName!", ".")
19406. 
19407. # Zone Footer Set Statistics Window Text
19408. 
19409. SetStatisticsWindowText("!Heading!
19410. ----------------------------------------------------------
19411. Zones Processed: 
19412. ----------------------------------------------------------
19413. !ZoneListByLine!
19414. ----------------------------------------------------------
19415. Zone Processing Step:
19416. !ZoneStepByLine!    
19417. ----------------------------------------------------------
19418. Current Zone:
19419. !ZoneFooter!
19420. ----------------------------------------------------------
19421. Volume Statistics:
19422. !VolumeStatisticsDetail!
19423. ----------------------------------------------------------
19424. Zone Detailed Report:
19425. ----------------------------------------------------------
19426. !ZoneStatisticsDetail!
19427. ----------------------------------------------------------
19428. ")
19429. 
19430. 
19431. 
19432. /* pause() */
19433. /* pause() */
19434. 
19435. 
19436. 
19437. 
19438. /* Mft Method: MFT GAP HERE. */
19439. /* For fixed zone locations */
19440. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-11-13 20:31:21")
19441. /* MakeGap(MftGap, DoNotVacate) */
19442. /* ---------------------------------------------------------- */
19443. 
19444. 
19445. /* ---------------------------------------------------------- */
19446. /* Mft Method: MFT GAP HERE. */
19447. /* For fixed zone locations */
19448. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-11-13 20:31:21")
19449. /* MakeGap(MftGap, DoNotVacate) */
19450.   
19451. /* ---------------------------------------------------------- */
19452. # PageHiberDump
19453. 
19454. # You cannot move Pagefile or Hiberfil generally speaking.
19455. # This might work in safe mode with preparation.
19456. # Zone PageHiberDump.
19457. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
19458. 
19459. # Script: DefragZoneTypeOsPageHiberDump
19460. /* ---------------------------------------------------------- */
19461. # PageHiberDump
19462. # You cannot move Pagefile or Hiberfil generally speaking.
19463. # This might work in safe mode with preparation.
19464. # Zone PageHiberDump.
19465. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
19466. 
19467. 	SetVariable(ZoneLabel, 			"!ZoneLabelPageHiberDump!")
19468. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPageHiberDump!")
19469. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPageHiberDump!")
19470. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePageHiberDump!")
19471. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsPageHiberDump
19472. # PageHiberDump start.
19473. (
19474. # Os PageHiberDump start.
19475. (
19476.   FileName("DataStore.edb")
19477.   or FileName("DUMP*.*")
19478.   or FileName("Hiberfil.sys")
19479.   or FileName("MEMORY.DMP")
19480.   or FileName("Pagefile.sys")
19481. )
19482. # Os PageHiberDump end.
19483. 
19484. )
19485. # PageHiberDump end.
19486. ')
19487. 
19488. 		# Script: ZoneDoHeader
19489. 
19490. # Script: ZoneWhenStarted
19491. 
19492. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
19493. # Script: DisplaySetZone
19494. 
19495. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
19496. SetVariable(FileStepDescription,	"")
19497. 
19498. SetVariable(ZoneStepByLine, 			"Zone started.
19499. ")
19500. 
19501. # Script: BannerDescriptionSet
19502. 
19503. # Script: BannerSet
19504. 
19505. # Script: DisplaySetDateTimeRun
19506. 
19507. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
19508. /* Xinclude "..\Display\BannerSet.MyDc"X */
19509. /* pause(1) */
19510. 
19511. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
19512. 
19513. Title('!Heading!')
19514. /* pause(1) */
19515. 
19516. /* NOTE: Can't round or truncate to integer precision. */
19517. 
19518. # Script: BannerLog
19519. 
19520. AppendLogfile("!LogFileName!", "!Title!")
19521. 
19522. 
19523. 
19524. pause(1)
19525. 
19526. 
19527. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
19528. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
19529. 
19530. SetVariable(ZoneStepNoCurrent, 0)
19531. 
19532. 
19533. # Script: ZoneDoCurrentClear
19534. 
19535. SetVariable(ZoneTypeSelectCurrent, 		"")
19536. 
19537. SetVariable(ZoneBeginCurrent, 			0)
19538. SetVariable(ZoneBeginPerCurrent, 		0)
19539. SetVariable(ZoneEndCurrent, 			0)
19540. SetVariable(ZoneEndPerCurrent, 			0)
19541. 
19542. SetVariable(ZoneSizeCurrent,			0)
19543. SetVariable(ZoneSizePerCurrent,			0)
19544. 
19545. SetVariable(ZoneGapRequestedCurrent,	0)
19546. SetVariable(ZoneGapRoundedCurrent, 		0)
19547. SetVariable(ZoneGapAdjustedCurrent, 	0)
19548. SetVariable(ZoneGapAvailableCurrent, 	0)
19549. SetVariable(ZoneGapCurrent,				0)
19550. SetVariable(ZoneGapUsedCurrent, 		0)
19551. 
19552. SetVariable(ZoneGapActualCurrent, 		0)
19553. SetVariable(ZoneGapActualPerCurrent, 	0)
19554. 
19555. SetVariable(ZoneSizeActual, 			0)
19556. SetVariable(ZoneSizeActualCurrent,		0)
19557. 
19558. SetVariable(ZoneEndActual, 				0)
19559. SetVariable(ZoneEndActualCurrent,		0)			
19560. SetVariable(ZoneSizeActualPerCurrent, 	0)
19561.       
19562. SetVariable(ZoneFilesFolders,			0)
19563. SetVariable(ZoneFilesFoldersPer,		0) 
19564. 
19565. SetVariable(ZoneFragments,				0)
19566. SetVariable(ZoneFragmentsPer,			0) 
19567. 		
19568. SetVariable(ZoneEndActualCurrent, 		0)
19569. SetVariable(ZoneEndActualPerCurrent, 	0)
19570. 
19571. # Gap Calculation Methodology:
19572. 	# Requested
19573. 	SetVariable(GapRequested, 			0) 
19574. 	SetVariable(GapRequestedStd, 		0) 
19575. 	SetVariable(GapRequestedMft, 		0) 
19576. 	SetVariable(GapRequestedOs, 		0) 
19577. 	SetVariable(GapRequestedOriginal, 	0) 
19578. 	
19579. 	# Gap Adjustments
19580. 	SetVariable(GapRounded, 			0)
19581. 	# SetVariable(GapAdjusted, 			0)
19582. 	SetVariable(GapAvailable, 			0)
19583. 	SetVariable(GapCurrent, 			0)
19584. 	SetVariable(GapActual, 				0)
19585. 	SetVariable(GapUsed, 				0)
19586. 	
19587. 	# Gap Adjustments
19588. 	SetVariable(GapRoundedLoc, 			0)
19589. 	# SetVariable(GapAdjustedLoc, 		0)
19590. 	SetVariable(GapAvailableLoc, 		0)
19591. 	SetVariable(GapCurrentLoc, 			0)
19592. 	SetVariable(GapActualLoc,			0)
19593. 	SetVariable(GapUsedLoc,				0)
19594. 	
19595. 	# Space usage
19596. 	SetVariable(ZoneFreePerRequested, 	0)
19597. 	SetVariable(ZoneFreePerUsed, 		0)
19598. 
19599. # Gap Size & Rounding
19600. 	SetVariable(ZoneGapSizePer, 		0)
19601. 	SetVariable(ZoneVolRoundUpPer, 		0)
19602. 	
19603. 	# Free Space
19604. 	SetVariable(ZoneFreeUsedPer, 		0)
19605. 	SetVariable(ZoneFreeRequestedPer, 	0)
19606. 
19607. 
19608. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
19609. 
19610. # Footer:
19611. SetVariable(ZoneFooter, "----------------------------------------------------------
19612. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
19613. 
19614. Statistics Report:
19615. ------------------
19616.    Size:  
19617.    ------------------------
19618.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19619.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19620.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19621. 
19622.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19623.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19624. 
19625.    Location:
19626.    ------------------------
19627.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19628.              Files End: !ZoneEndCurrent!
19629.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19630.       
19631.    Gap Settings:
19632.    ------------------------
19633.          Gap Requested: !ZoneGapSizePer!%
19634.       Volume Rounding: !ZoneVolRoundUpPer!%
19635.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19636.                  
19637.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
19638.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
19639.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
19640.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
19641.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
19642.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
19643.      
19644.    Free Space after Zone:
19645.    ------------------------
19646.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19647.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19648.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19649. 
19650. Directory and Files Select:
19651. ---------------------------
19652. !ZoneTypeSelectCurrent!               
19653. ---------------------------
19654. ----------------------------------------------------------
19655. ")
19656. 
19657. # Script: BannerSet
19658. 
19659. # Script: DisplaySetDateTimeRun
19660. 
19661. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
19662. /* Xinclude "..\Display\BannerSet.MyDc"X */
19663. /* pause(1) */
19664. 
19665. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
19666. 
19667. Title('!Heading!')
19668. /* pause(1) */
19669. 
19670. /* NOTE: Can't round or truncate to integer precision. */
19671. 
19672. # Script: BannerLog
19673. 
19674. AppendLogfile("!LogFileName!", "!Title!")
19675. 
19676. 
19677. 
19678. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
19679. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
19680. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:21")
19681. 
19682. SetVariable(ZoneListByLine, "!ZoneListByLine!
19683. Zone: !ZoneNoCurrent! 2021-11-13 20:31:21 0:00:04 !ZoneLabel! !ZoneDescription!")
19684. 
19685. 
19686. /* Fixed Zone Position Handling */
19687. /* Literal number: */
19688. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
19689. /* Percentage of disk: */
19690. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
19691. /* Gap */
19692. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
19693. 
19694. /* ---------------------------------------------------------- */
19695. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
19696. # Script: DisplaySetFileStep
19697. 
19698. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19699. 
19700. /* add message and move to a new line. */
19701. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19702. ")
19703. 
19704. /* display the line. (hopefully.) */
19705. # Zone Footer Set Statistics Window Text
19706. 
19707. SetStatisticsWindowText("!Heading!
19708. ----------------------------------------------------------
19709. Zones Processed: 
19710. ----------------------------------------------------------
19711. !ZoneListByLine!
19712. ----------------------------------------------------------
19713. Zone Processing Step:
19714. !ZoneStepByLine!    
19715. ----------------------------------------------------------
19716. Current Zone:
19717. !ZoneFooter!
19718. ----------------------------------------------------------
19719. Volume Statistics:
19720. !VolumeStatisticsDetail!
19721. ----------------------------------------------------------
19722. Zone Detailed Report:
19723. ----------------------------------------------------------
19724. !ZoneStatisticsDetail!
19725. ----------------------------------------------------------
19726. ")
19727. 
19728. 
19729. 
19730. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19731. 
19732. # Script: BannerSet
19733. 
19734. # Script: DisplaySetDateTimeRun
19735. 
19736. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
19737. /* Xinclude "..\Display\BannerSet.MyDc"X */
19738. /* pause(1) */
19739. 
19740. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
19741. 
19742. Title('!Heading!')
19743. /* pause(1) */
19744. 
19745. /* NOTE: Can't round or truncate to integer precision. */
19746. 
19747. pause(1)
19748. 
19749. # your stuff HERE (X)... pre file select code.
19750. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
19751. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19752. 	# (X)
19753. 
19754. FileSelect
19755. 
19756. 	# your stuff can't really go here (errors.)
19757. 	# maybe for some reason I don't know of...
19758. 	
19759. 	# Actions next...
19760. 		# Script: ZoneDo ZoneTypeSelectOsPageHiberDump
19761. # PageHiberDump start.
19762. (
19763. # Os PageHiberDump start.
19764. (
19765.   FileName("DataStore.edb")
19766.   or FileName("DUMP*.*")
19767.   or FileName("Hiberfil.sys")
19768.   or FileName("MEMORY.DMP")
19769.   or FileName("Pagefile.sys")
19770. )
19771. # Os PageHiberDump end.
19772. 
19773. )
19774. # PageHiberDump end.
19775. 
19776. 		
19777. 		FileActions
19778. 		  		/* ---------------------------------------------------------- */
19779. 	# Gap
19780. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
19781. 		# Script: DisplaySetFileStep
19782. 
19783. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19784. 
19785. /* add message and move to a new line. */
19786. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19787. ")
19788. 
19789. /* display the line. (hopefully.) */
19790. # Zone Footer Set Statistics Window Text
19791. 
19792. SetStatisticsWindowText("!Heading!
19793. ----------------------------------------------------------
19794. Zones Processed: 
19795. ----------------------------------------------------------
19796. !ZoneListByLine!
19797. ----------------------------------------------------------
19798. Zone Processing Step:
19799. !ZoneStepByLine!    
19800. ----------------------------------------------------------
19801. Current Zone:
19802. !ZoneFooter!
19803. ----------------------------------------------------------
19804. Volume Statistics:
19805. !VolumeStatisticsDetail!
19806. ----------------------------------------------------------
19807. Zone Detailed Report:
19808. ----------------------------------------------------------
19809. !ZoneStatisticsDetail!
19810. ----------------------------------------------------------
19811. ")
19812. 
19813. 
19814. 
19815. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19816. 
19817. # Script: BannerSet
19818. 
19819. # Script: DisplaySetDateTimeRun
19820. 
19821. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
19822. /* Xinclude "..\Display\BannerSet.MyDc"X */
19823. /* pause(1) */
19824. 
19825. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
19826. 
19827. Title('!Heading!')
19828. /* pause(1) */
19829. 
19830. /* NOTE: Can't round or truncate to integer precision. */
19831. 
19832. pause(1)
19833. 	
19834. 	# ACTUAL GAP
19835. 		/* AddGap Variant. */
19836. 	  	# Zone Do Gap
19837. # Gap Calculation Methods:
19838. 
19839. /* 1) Anything you need to add first. */
19840. /* empty */
19841. 
19842. /* ---------------------------------------------------------- */
19843. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
19844. 	# GapRequestedStd.
19845. 
19846. 		/* ---------------------------------------------------------- */
19847. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
19848. 
19849. 		# Gap Calculation Methods:
19850. 
19851. /* AddGap Variants */
19852. 
19853. 	/* Standard */
19854. 		# Gap Calculation Methods:
19855. 	/* AddGap Variants */
19856. 	/* Standard */
19857. 
19858. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
19859. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
19860. 
19861. 	SetVariable(GapRequested, GapRequestedStd)
19862. 	
19863. 
19864. 	/* MFT Low High Method */
19865. 		# Gap Calculation Methods:
19866. 	/* AddGap Variants */
19867. 	/* MFT Low High Method */
19868. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
19869. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
19870. 	SetVariable(GapRequested, GapRequestedMft)
19871. 	
19872. 
19873. 	/* OS Volume Type Method */
19874. 		# Gap Calculation Methods:
19875. 	/* AddGap Variants */
19876. 	/* OS Volume Type Method */
19877. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
19878. 	SetVariable(GapRequested, GapRequestedOs)
19879. 
19880. 
19881. 
19882. /* MakeGap Variants */
19883. 
19884. 	/* Original Os 1-3 + MFT 2 */
19885. 		# Gap Calculation Methods:
19886. 	/* MakeGap Variants */
19887. 	/* Original Os 1-3 + MFT 2 */
19888. 	/* plus MFT gap placed inline at the dividing zone. */
19889. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
19890. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
19891. 	SetVariable(GapRequested, GapRequestedOrig)
19892. 	
19893. 	
19894. /* Note: You could comment out the ones not in use */
19895. /* However having the data in the log is useful. */
19896. /* Therefore the following line is otherwise needed. */
19897. 
19898. /* Standard used */
19899. 
19900. SetVariable(GapRequested, GapRequestedStd)
19901. 
19902. # Gap Calculation Methods:
19903. 
19904. /* AddGap Variants */
19905. 	/* Standard */
19906. 	/* MFT Low High Method */
19907. 	/* OS Volume Type Method */
19908. 
19909. /* MakeGap Variants */
19910. 	/* Original Os 1-3 + MFT 2 */
19911. 
19912. /* Note: You could comment out the ones not in use */
19913. /* However having the data in the log is useful. */
19914. /* Therefore the following line is otherwise needed. */
19915. 
19916. /* Standard is used currently */
19917. 
19918. 
19919. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
19920. 
19921. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
19922. 
19923. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
19924. 
19925. /* ---------------------------------------------------------- */
19926. /* 3) SMALL ZONE ADJUSTMENT. */
19927. /* Gab cant be larger than half the Zone Size. */
19928. 
19929. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
19930. 	
19931. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
19932. 
19933. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
19934. 
19935. /* ---------------------------------------------------------- */
19936. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
19937. # Gap Adjustments.
19938. 
19939. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
19940. 	
19941. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
19942. 
19943. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
19944. 
19945. /* ---------------------------------------------------------- */
19946. # BYPASS THIS.
19947. 	/* This is definitely wrong. */
19948. 	/* The question is can we steal gap from the next zone */
19949. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
19950. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
19951. 		# Zone Overflow.
19952. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
19953. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
19954. 
19955. /* ---------------------------------------------------------- */
19956. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
19957. # Remaining free space available.
19958. 
19959. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
19960. 	
19961. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
19962. 
19963. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
19964. 
19965. /* ---------------------------------------------------------- */
19966. # CURRENT gap to use.
19967. 
19968. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
19969. 
19970. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
19971. 
19972. /* ---------------------------------------------------------- */
19973. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
19974. # Debugging.
19975. 
19976. 	SetVariable(GapUsed, GapCurrent) // for debugging
19977. 
19978. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
19979. 
19980. 		# Your code HERE
19981. 
19982. /* ---------------------------------------------------------- */
19983. /* 7) YOUR CODE. */
19984. # YOUR CODE HERE:
19985. 	# INPUT: GapCurrent or GapCurrentLoc
19986. 	# OUTPUT: GapUsed...
19987. 
19988. /* ---------------------------------------------------------- */
19989. # Gap Size.
19990. # Actual Size of Gap.
19991. 
19992. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
19993. 
19994. /* ---------------------------------------------------------- */
19995. /* xxxxxxxxxxxxxxxxxxxxxx */
19996. # ADD THE GAP
19997. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
19998. /* xxxxxxxxxxxxxxxxxxxxxx */
19999. 
20000. 	
20001. 	# Zone Statistics	
20002. 	# Script: ZoneDoStatistics
20003. # Zone / Volume Statistics and Display
20004. 		
20005. 	# Accumulate Totals
20006.   	# Script: ZoneDoVolumeTotals
20007. 
20008. /* Current total space used (by Zones and Gaps) */
20009. 
20010. SetVariable(VolumeZoneUsed, GapUsed)
20011. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
20012. /* Percentage */
20013. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
20014. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
20015. 
20016. /* Current total of free space requested */
20017. 
20018. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
20019. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
20020. /* Percent. */
20021. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
20022. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
20023. 
20024. /* Current total of free space used */
20025. 
20026. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
20027. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
20028. /* Percent */
20029. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
20030. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
20031. 
20032. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
20033. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
20034. /* Xinclude "..\DebugDisplayPause.MyDc"X */
20035. 
20036. 
20037. 	# Current Values
20038. 	# Script: ZoneDoCurrentSet
20039. 
20040. # Cluster, Sector, Block adjust for display.
20041. 	# Bytes per cluster is volume specific.
20042. 
20043. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
20044. 
20045. # Current Zone values.
20046. 	# Begin, end and size.
20047. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
20048. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
20049. 
20050. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
20051. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
20052. 
20053. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
20054. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
20055. 
20056. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
20057. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
20058. 
20059. 	SetVariable(ZoneFragments,				"!ZONE210N!")
20060. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
20061. 		
20062. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
20063. /* identical code to here: (separation not needed. TEST.) */	
20064. 
20065. # Current Gap, Actual and Free Values
20066. 	# Gap
20067. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
20068. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
20069. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
20070. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
20071. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
20072. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
20073. 	
20074. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
20075. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
20076. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
20077. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
20078. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
20079. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
20080. 	
20081. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
20082. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
20083. 	
20084. 	# Actual Size and End
20085. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
20086. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
20087. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
20088. 	
20089. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
20090. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
20091. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
20092. 
20093. # Gap Size & Rounding
20094. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
20095. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
20096. 	
20097. 	# Free Space
20098. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
20099. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
20100. 
20101. 	# Footer:
20102. SetVariable(ZoneFooter, "----------------------------------------------------------
20103. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
20104. 
20105. Statistics Report:
20106. ------------------
20107.    Size:  
20108.    ------------------------
20109.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20110.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20111.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20112. 
20113.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20114.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20115. 
20116.    Location:
20117.    ------------------------
20118.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20119.              Files End: !ZoneEndCurrent!
20120.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20121.       
20122.    Gap Settings:
20123.    ------------------------
20124.          Gap Requested: !ZoneGapSizePer!%
20125.       Volume Rounding: !ZoneVolRoundUpPer!%
20126.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20127.                  
20128.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
20129.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
20130.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
20131.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
20132.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
20133.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
20134.      
20135.    Free Space after Zone:
20136.    ------------------------
20137.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20138.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20139.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20140. 
20141. Directory and Files Select:
20142. ---------------------------
20143. !ZoneTypeSelectCurrent!               
20144. ---------------------------
20145. ----------------------------------------------------------
20146. ")
20147. 	# Zone Footer Set Statistics Window Text
20148. 
20149. SetStatisticsWindowText("!Heading!
20150. ----------------------------------------------------------
20151. Zones Processed: 
20152. ----------------------------------------------------------
20153. !ZoneListByLine!
20154. ----------------------------------------------------------
20155. Zone Processing Step:
20156. !ZoneStepByLine!    
20157. ----------------------------------------------------------
20158. Current Zone:
20159. !ZoneFooter!
20160. ----------------------------------------------------------
20161. Volume Statistics:
20162. !VolumeStatisticsDetail!
20163. ----------------------------------------------------------
20164. Zone Detailed Report:
20165. ----------------------------------------------------------
20166. !ZoneStatisticsDetail!
20167. ----------------------------------------------------------
20168. ")
20169. 
20170. 
20171. 	
20172.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
20173. 
20174. 	# Add Zone to list of zones for display.
20175. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
20176. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
20177. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
20178. 	# ??? Free Stats?
20179. 	# Footer:
20180. SetVariable(ZoneFooter, "----------------------------------------------------------
20181. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
20182. 
20183. Statistics Report:
20184. ------------------
20185.    Size:  
20186.    ------------------------
20187.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20188.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20189.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20190. 
20191.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20192.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20193. 
20194.    Location:
20195.    ------------------------
20196.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20197.              Files End: !ZoneEndCurrent!
20198.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20199.       
20200.    Gap Settings:
20201.    ------------------------
20202.          Gap Requested: !ZoneGapSizePer!%
20203.       Volume Rounding: !ZoneVolRoundUpPer!%
20204.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20205.                  
20206.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
20207.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
20208.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
20209.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
20210.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
20211.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
20212.      
20213.    Free Space after Zone:
20214.    ------------------------
20215.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20216.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20217.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20218. 
20219. Directory and Files Select:
20220. ---------------------------
20221. !ZoneTypeSelectCurrent!               
20222. ---------------------------
20223. ----------------------------------------------------------
20224. ")
20225. 
20226. 	# Add Zone Details to Report.	
20227. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
20228. !ZoneFooter!")
20229. 
20230. 
20231. 	
20232. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
20233. 			# Script: DisplaySetFileStep
20234. 
20235. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20236. 
20237. /* add message and move to a new line. */
20238. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20239. ")
20240. 
20241. /* display the line. (hopefully.) */
20242. # Zone Footer Set Statistics Window Text
20243. 
20244. SetStatisticsWindowText("!Heading!
20245. ----------------------------------------------------------
20246. Zones Processed: 
20247. ----------------------------------------------------------
20248. !ZoneListByLine!
20249. ----------------------------------------------------------
20250. Zone Processing Step:
20251. !ZoneStepByLine!    
20252. ----------------------------------------------------------
20253. Current Zone:
20254. !ZoneFooter!
20255. ----------------------------------------------------------
20256. Volume Statistics:
20257. !VolumeStatisticsDetail!
20258. ----------------------------------------------------------
20259. Zone Detailed Report:
20260. ----------------------------------------------------------
20261. !ZoneStatisticsDetail!
20262. ----------------------------------------------------------
20263. ")
20264. 
20265. 
20266. 
20267. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20268. 
20269. # Script: BannerSet
20270. 
20271. # Script: DisplaySetDateTimeRun
20272. 
20273. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
20274. /* Xinclude "..\Display\BannerSet.MyDc"X */
20275. /* pause(1) */
20276. 
20277. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
20278. 
20279. Title('!Heading!')
20280. /* pause(1) */
20281. 
20282. /* NOTE: Can't round or truncate to integer precision. */
20283. 
20284. pause(1)
20285. 
20286. 			# File Action - Type Os Programs - Fast - MoveUpToZone.
20287. 	MoveUpToZone()
20288. 	
20289. 
20290. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
20291. 		# Script: DisplaySetFileStep
20292. 
20293. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20294. 
20295. /* add message and move to a new line. */
20296. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20297. ")
20298. 
20299. /* display the line. (hopefully.) */
20300. # Zone Footer Set Statistics Window Text
20301. 
20302. SetStatisticsWindowText("!Heading!
20303. ----------------------------------------------------------
20304. Zones Processed: 
20305. ----------------------------------------------------------
20306. !ZoneListByLine!
20307. ----------------------------------------------------------
20308. Zone Processing Step:
20309. !ZoneStepByLine!    
20310. ----------------------------------------------------------
20311. Current Zone:
20312. !ZoneFooter!
20313. ----------------------------------------------------------
20314. Volume Statistics:
20315. !VolumeStatisticsDetail!
20316. ----------------------------------------------------------
20317. Zone Detailed Report:
20318. ----------------------------------------------------------
20319. !ZoneStatisticsDetail!
20320. ----------------------------------------------------------
20321. ")
20322. 
20323. 
20324. 
20325. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20326. 
20327. # Script: BannerSet
20328. 
20329. # Script: DisplaySetDateTimeRun
20330. 
20331. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
20332. /* Xinclude "..\Display\BannerSet.MyDc"X */
20333. /* pause(1) */
20334. 
20335. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
20336. 
20337. Title('!Heading!')
20338. /* pause(1) */
20339. 
20340. /* NOTE: Can't round or truncate to integer precision. */
20341. 
20342. pause(1)
20343. 
20344. 		# Script: ZoneDoFooter
20345. 
20346. /* ---------------------------------------------------------- */
20347. # File Select
20348. 	# Select Statments
20349. # File Actions 
20350. 	# Standard or OS File Actions.
20351. 	# Resume...
20352. 	
20353. 	# your stuff HERE (X)... post zone (file) file actions code.
20354. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
20355. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20356. 		# (X)
20357. 		
20358. 		/* ??? Set window? */
20359. 	
20360. 	# ADD THE GAP
20361. # Vacate (good for diagnostics)
20362. # DoNotVacate - DO NOT Vacate (recommended)
20363. # DoNotVacate - DO NOT Vacate (recommended)
20364. 
20365. # Vacate
20366. /* AddGap(GapUsedLoc) */
20367. 
20368. # DO Not Vacate
20369. AddGap(GapUsedLoc, DoNotVacate) 
20370. 	
20371. 	
20372. # Script: GapZoneCommand
20373. # *** Moved to setting yours ***
20374. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
20375. # Controlled via settings commands
20376. # DoNotVacate - DO NOT Vacate (recommended)
20377. 
20378. # Vacate
20379. /* AddGap(GapUsedLoc) */
20380. 
20381. # DO Not Vacate
20382. AddGap(GapUsedLoc, DoNotVacate) 
20383. 	
20384. 	
20385. # Vacate /* AddGap(GapUsed) */
20386. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
20387. 	
20388. 
20389. 		
20390. # 
20391. FileEnd
20392. /* ---------------------------------------------------------- */
20393. 
20394. # your stuff HERE (X)... post zone (file) code.
20395. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
20396. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20397. 	# (X)
20398. 
20399. SetVariable(FileStepDescription,"Zone finished, reporting.")
20400. # Script: DisplaySetFileStep
20401. 
20402. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20403. 
20404. /* add message and move to a new line. */
20405. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20406. ")
20407. 
20408. /* display the line. (hopefully.) */
20409. # Zone Footer Set Statistics Window Text
20410. 
20411. SetStatisticsWindowText("!Heading!
20412. ----------------------------------------------------------
20413. Zones Processed: 
20414. ----------------------------------------------------------
20415. !ZoneListByLine!
20416. ----------------------------------------------------------
20417. Zone Processing Step:
20418. !ZoneStepByLine!    
20419. ----------------------------------------------------------
20420. Current Zone:
20421. !ZoneFooter!
20422. ----------------------------------------------------------
20423. Volume Statistics:
20424. !VolumeStatisticsDetail!
20425. ----------------------------------------------------------
20426. Zone Detailed Report:
20427. ----------------------------------------------------------
20428. !ZoneStatisticsDetail!
20429. ----------------------------------------------------------
20430. ")
20431. 
20432. 
20433. 
20434. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20435. 
20436. # Script: BannerSet
20437. 
20438. # Script: DisplaySetDateTimeRun
20439. 
20440. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
20441. /* Xinclude "..\Display\BannerSet.MyDc"X */
20442. /* pause(1) */
20443. 
20444. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
20445. 
20446. Title('!Heading!')
20447. /* pause(1) */
20448. 
20449. /* NOTE: Can't round or truncate to integer precision. */
20450. 
20451. pause(1)
20452. 
20453. # Script: ZoneWhenFinished
20454. 
20455. # Script: BannerSet
20456. 
20457. # Script: DisplaySetDateTimeRun
20458. 
20459. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
20460. /* Xinclude "..\Display\BannerSet.MyDc"X */
20461. /* pause(1) */
20462. 
20463. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
20464. 
20465. Title('!Heading!')
20466. /* pause(1) */
20467. 
20468. /* NOTE: Can't round or truncate to integer precision. */
20469. 
20470. # Script: BannerLog
20471. 
20472. AppendLogfile("!LogFileName!", "!Title!")
20473. 
20474. 
20475. 
20476. # Zone Statistics	
20477. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
20478. 
20479. # Footer:
20480. SetVariable(ZoneFooter, "----------------------------------------------------------
20481. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
20482. 
20483. Statistics Report:
20484. ------------------
20485.    Size:  
20486.    ------------------------
20487.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20488.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20489.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20490. 
20491.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20492.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20493. 
20494.    Location:
20495.    ------------------------
20496.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20497.              Files End: !ZoneEndCurrent!
20498.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20499.       
20500.    Gap Settings:
20501.    ------------------------
20502.          Gap Requested: !ZoneGapSizePer!%
20503.       Volume Rounding: !ZoneVolRoundUpPer!%
20504.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20505.                  
20506.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
20507.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
20508.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
20509.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
20510.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
20511.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
20512.      
20513.    Free Space after Zone:
20514.    ------------------------
20515.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20516.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20517.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20518. 
20519. Directory and Files Select:
20520. ---------------------------
20521. !ZoneTypeSelectCurrent!               
20522. ---------------------------
20523. ----------------------------------------------------------
20524. ")
20525. 
20526. AppendLogfile("!LogFileName!", ".")
20527. AppendLogfile("!LogFileName!", "!ZoneFooter!")
20528. AppendLogfile("!LogFileName!", ".")
20529. 
20530. # Zone Footer Set Statistics Window Text
20531. 
20532. SetStatisticsWindowText("!Heading!
20533. ----------------------------------------------------------
20534. Zones Processed: 
20535. ----------------------------------------------------------
20536. !ZoneListByLine!
20537. ----------------------------------------------------------
20538. Zone Processing Step:
20539. !ZoneStepByLine!    
20540. ----------------------------------------------------------
20541. Current Zone:
20542. !ZoneFooter!
20543. ----------------------------------------------------------
20544. Volume Statistics:
20545. !VolumeStatisticsDetail!
20546. ----------------------------------------------------------
20547. Zone Detailed Report:
20548. ----------------------------------------------------------
20549. !ZoneStatisticsDetail!
20550. ----------------------------------------------------------
20551. ")
20552. 
20553. 
20554. 
20555. /* pause() */
20556. /* pause() */
20557. 
20558. 
20559. 
20560. /* ---------------------------------------------------------- */
20561.   
20562. 
20563. /* ---------------------------------------------------------- */
20564. 
20565. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
20566. 
20567. /* ---------------------------------------------------------- */
20568. /* Zone 15 Games */
20569. # Script: DisplayColors - Zone Dark
20570. # Processed
20571. SetFileColor(All, Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
20572. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
20573. 
20574. # Light Green and Yellow
20575. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
20576. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
20577. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
20578. 
20579. # Script: DefragZoneTypeGames
20580. /* ---------------------------------------------------------- */
20581. /* Zone Games */
20582. SetVariable(ZoneLabel, "!ZoneLabelGames!")
20583. SetVariable(ZoneDescription, "!ZoneDescriptionGames!")
20584. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpGames!")
20585. SetVariable(ZoneGapSize, "!ZoneGapSizeGames!")
20586. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectGames
20587. # Games start.
20588. # NotBlobsArchivesBu start.
20589. (not (
20590. # Blobs start.
20591. (
20592. # BlobsAndExceptions start.
20593. ( not(
20594.   FileName("*.bat")
20595.   or FileName("*.css")
20596.   or FileName("*.dll")
20597.   or FileName("*.exe")
20598.   or FileName("*.htm*")
20599.   or FileName("*.jar")
20600.   or FileName("*.js")
20601.   or FileName("*.script")
20602.   or FileName("*.wsf")
20603.   or (
20604. # Databases start.
20605. (
20606.   FileName("*.crypt*")
20607.   or FileName("*.db*")
20608.   or FileName("*.rdb*")
20609.   or FileName("*.dc*")
20610.   or FileName("*.dict*")
20611.   or FileName("*.?db*")
20612.   or FileName("*.?rdb*")
20613.   or FileName("*.md*")
20614.   or FileName("*.myd")
20615.   or FileName("*.ndf")
20616.   or FileName("*.ns?")
20617.   or FileName("*.pab")
20618.   or FileName("*.pst")
20619.   or FileName("*.sd?*")
20620.   or FileName("*.sq**")
20621.   or FileName("*.tmd")
20622.   or FileName("*.tps")
20623.   or FileName("*.tr*")
20624. )
20625. # Databases end.
20626. 
20627.     # BlobsAndExceptions
20628.     or 
20629. # Data start.
20630. (
20631.   DirectoryName("Data*")
20632.   or DirectoryName("Device*")
20633.   or DirectoryName("Export*")
20634.   or DirectoryName("Import*")
20635.   or DirectoryName("Log*")
20636.   or DirectoryName("*Log")
20637.   or DirectoryName("Maintenance*")
20638.   or DirectoryName("Rec*")
20639.   or DirectoryName("Sales*")
20640.   or DirectoryName("Search*")
20641.   or DirectoryName("User*")
20642. )
20643. # Data end.
20644. 
20645.     # BlobsAndExceptions
20646.   )
20647. ) )
20648. # BlobsAndExceptions end.
20649. 
20650. # Blobs
20651. ) and (
20652.   Size(BlobFileSize,0)
20653.   or (
20654.     FileName("*.arj")
20655.     or FileName("*.bup")
20656.     or FileName("*.bz2")
20657.     or FileName("*.chm")
20658.     or FileName("*.dvr-ms")
20659.     or FileName("*.gz")
20660.     or FileName("*.ifo")
20661.     or FileName("*.lzh")
20662.     or FileName("*.pdf")
20663.     or FileName("*.rpm")
20664.     or FileName("*.wmv")
20665.     or FileName("*.vob")
20666.     or FileName("*.z")
20667.   ) 
20668. )
20669. # Blobs end.
20670. 
20671. # NotBlobsArchivesBu
20672. or 
20673. # Archives start.
20674. (
20675.   DirectoryName("*Archive*")
20676.   or DirectoryName("*History*")
20677.   or DirectoryName("*Old")
20678.   or DirectoryName("* Old *")
20679.   or DirectoryName("Old *")
20680. 
20681.   or FileName("*.7z")
20682.   or FileName("*.cab")
20683.   or FileName("*.iso")
20684.   or FileName("*.msi")
20685.   or FileName("*.old")
20686.   or FileName("*.rar")
20687.   or FileName("*.tar")
20688.   or FileName("*.zip")
20689.   or
20690. # WinSysLow start.
20691. (
20692.   DirectoryName("$*")
20693.   or DirectoryName("0*")
20694.   or DirectoryName("1*")
20695.   or DirectoryName("2*")
20696.   or DirectoryName("3*")
20697.   or DirectoryName("4*")
20698.   or DirectoryName("5*")
20699.   or DirectoryName("6*")
20700.   or DirectoryName("7*")
20701.   or DirectoryName("8*")
20702.   or DirectoryName("9*")
20703. 
20704.   or DirectoryName("dllcache")
20705.   or DirectoryName("Downloaded Installations")
20706.   or DirectoryName("Ehome")
20707.   or DirectoryName("Fonts")
20708.   or DirectoryName("Help")
20709.   or DirectoryName("I386")
20710.   or DirectoryName("ie?updates")
20711.   or DirectoryName("Installer")
20712.   or DirectoryName("Installshield Installation Information")
20713.   or DirectoryName("IME")
20714.   or DirectoryName("*RECYCLE*")
20715.   or DirectoryName("ServicePackFiles")
20716.   or DirectoryName("SoftwareDistribution")
20717.   or DirectoryName("Speech")
20718.   or DirectoryName("Symbols")
20719.   or DirectoryName("System Volume Information")
20720.   or DirectoryName("windows.old")
20721. )
20722. # WinSysLow end.
20723. 
20724.   # Archives
20725. )
20726. # Archives end.
20727. 
20728. # NotBlobsArchivesBu
20729. or
20730. # Backups start.
20731. (
20732.   DirectoryName("*Backup*")
20733.   or DirectoryName("*Bu")
20734.   or DirectoryName("* Bu *")
20735.   or DirectoryName("Bu *")
20736. 
20737.   or FileName("*.bak")
20738.   or FileName("* - Copy*")
20739. )
20740. # Backups end.
20741. 
20742. # NotBlobsArchivesBu
20743. ) )
20744. # NotBlobsArchivesBu end.
20745. 
20746. # People
20747. and (
20748. # Games start.
20749. (
20750.   DirectoryName("Game*")
20751.   or DirectoryName("Epic*")
20752.   or DirectoryName("*XBox*")
20753.   or DirectoryName("*PS2*")
20754. )
20755. # Games end.
20756. 
20757. # People
20758. )
20759. # People end.
20760. ')
20761. 
20762. 	# Script: ZoneDoHeader
20763. 
20764. # Script: ZoneWhenStarted
20765. 
20766. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
20767. # Script: DisplaySetZone
20768. 
20769. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
20770. SetVariable(FileStepDescription,	"")
20771. 
20772. SetVariable(ZoneStepByLine, 			"Zone started.
20773. ")
20774. 
20775. # Script: BannerDescriptionSet
20776. 
20777. # Script: BannerSet
20778. 
20779. # Script: DisplaySetDateTimeRun
20780. 
20781. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
20782. /* Xinclude "..\Display\BannerSet.MyDc"X */
20783. /* pause(1) */
20784. 
20785. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
20786. 
20787. Title('!Heading!')
20788. /* pause(1) */
20789. 
20790. /* NOTE: Can't round or truncate to integer precision. */
20791. 
20792. # Script: BannerLog
20793. 
20794. AppendLogfile("!LogFileName!", "!Title!")
20795. 
20796. 
20797. 
20798. pause(1)
20799. 
20800. 
20801. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
20802. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
20803. 
20804. SetVariable(ZoneStepNoCurrent, 0)
20805. 
20806. 
20807. # Script: ZoneDoCurrentClear
20808. 
20809. SetVariable(ZoneTypeSelectCurrent, 		"")
20810. 
20811. SetVariable(ZoneBeginCurrent, 			0)
20812. SetVariable(ZoneBeginPerCurrent, 		0)
20813. SetVariable(ZoneEndCurrent, 			0)
20814. SetVariable(ZoneEndPerCurrent, 			0)
20815. 
20816. SetVariable(ZoneSizeCurrent,			0)
20817. SetVariable(ZoneSizePerCurrent,			0)
20818. 
20819. SetVariable(ZoneGapRequestedCurrent,	0)
20820. SetVariable(ZoneGapRoundedCurrent, 		0)
20821. SetVariable(ZoneGapAdjustedCurrent, 	0)
20822. SetVariable(ZoneGapAvailableCurrent, 	0)
20823. SetVariable(ZoneGapCurrent,				0)
20824. SetVariable(ZoneGapUsedCurrent, 		0)
20825. 
20826. SetVariable(ZoneGapActualCurrent, 		0)
20827. SetVariable(ZoneGapActualPerCurrent, 	0)
20828. 
20829. SetVariable(ZoneSizeActual, 			0)
20830. SetVariable(ZoneSizeActualCurrent,		0)
20831. 
20832. SetVariable(ZoneEndActual, 				0)
20833. SetVariable(ZoneEndActualCurrent,		0)			
20834. SetVariable(ZoneSizeActualPerCurrent, 	0)
20835.       
20836. SetVariable(ZoneFilesFolders,			0)
20837. SetVariable(ZoneFilesFoldersPer,		0) 
20838. 
20839. SetVariable(ZoneFragments,				0)
20840. SetVariable(ZoneFragmentsPer,			0) 
20841. 		
20842. SetVariable(ZoneEndActualCurrent, 		0)
20843. SetVariable(ZoneEndActualPerCurrent, 	0)
20844. 
20845. # Gap Calculation Methodology:
20846. 	# Requested
20847. 	SetVariable(GapRequested, 			0) 
20848. 	SetVariable(GapRequestedStd, 		0) 
20849. 	SetVariable(GapRequestedMft, 		0) 
20850. 	SetVariable(GapRequestedOs, 		0) 
20851. 	SetVariable(GapRequestedOriginal, 	0) 
20852. 	
20853. 	# Gap Adjustments
20854. 	SetVariable(GapRounded, 			0)
20855. 	# SetVariable(GapAdjusted, 			0)
20856. 	SetVariable(GapAvailable, 			0)
20857. 	SetVariable(GapCurrent, 			0)
20858. 	SetVariable(GapActual, 				0)
20859. 	SetVariable(GapUsed, 				0)
20860. 	
20861. 	# Gap Adjustments
20862. 	SetVariable(GapRoundedLoc, 			0)
20863. 	# SetVariable(GapAdjustedLoc, 		0)
20864. 	SetVariable(GapAvailableLoc, 		0)
20865. 	SetVariable(GapCurrentLoc, 			0)
20866. 	SetVariable(GapActualLoc,			0)
20867. 	SetVariable(GapUsedLoc,				0)
20868. 	
20869. 	# Space usage
20870. 	SetVariable(ZoneFreePerRequested, 	0)
20871. 	SetVariable(ZoneFreePerUsed, 		0)
20872. 
20873. # Gap Size & Rounding
20874. 	SetVariable(ZoneGapSizePer, 		0)
20875. 	SetVariable(ZoneVolRoundUpPer, 		0)
20876. 	
20877. 	# Free Space
20878. 	SetVariable(ZoneFreeUsedPer, 		0)
20879. 	SetVariable(ZoneFreeRequestedPer, 	0)
20880. 
20881. 
20882. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
20883. 
20884. # Footer:
20885. SetVariable(ZoneFooter, "----------------------------------------------------------
20886. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
20887. 
20888. Statistics Report:
20889. ------------------
20890.    Size:  
20891.    ------------------------
20892.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20893.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20894.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20895. 
20896.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20897.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20898. 
20899.    Location:
20900.    ------------------------
20901.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20902.              Files End: !ZoneEndCurrent!
20903.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20904.       
20905.    Gap Settings:
20906.    ------------------------
20907.          Gap Requested: !ZoneGapSizePer!%
20908.       Volume Rounding: !ZoneVolRoundUpPer!%
20909.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20910.                  
20911.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
20912.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
20913.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
20914.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
20915.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
20916.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
20917.      
20918.    Free Space after Zone:
20919.    ------------------------
20920.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20921.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20922.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20923. 
20924. Directory and Files Select:
20925. ---------------------------
20926. !ZoneTypeSelectCurrent!               
20927. ---------------------------
20928. ----------------------------------------------------------
20929. ")
20930. 
20931. # Script: BannerSet
20932. 
20933. # Script: DisplaySetDateTimeRun
20934. 
20935. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
20936. /* Xinclude "..\Display\BannerSet.MyDc"X */
20937. /* pause(1) */
20938. 
20939. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
20940. 
20941. Title('!Heading!')
20942. /* pause(1) */
20943. 
20944. /* NOTE: Can't round or truncate to integer precision. */
20945. 
20946. # Script: BannerLog
20947. 
20948. AppendLogfile("!LogFileName!", "!Title!")
20949. 
20950. 
20951. 
20952. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
20953. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
20954. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:21")
20955. 
20956. SetVariable(ZoneListByLine, "!ZoneListByLine!
20957. Zone: !ZoneNoCurrent! 2021-11-13 20:31:21 0:00:04 !ZoneLabel! !ZoneDescription!")
20958. 
20959. 
20960. /* Fixed Zone Position Handling */
20961. /* Literal number: */
20962. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
20963. /* Percentage of disk: */
20964. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
20965. /* Gap */
20966. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
20967. 
20968. /* ---------------------------------------------------------- */
20969. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
20970. # Script: DisplaySetFileStep
20971. 
20972. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20973. 
20974. /* add message and move to a new line. */
20975. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20976. ")
20977. 
20978. /* display the line. (hopefully.) */
20979. # Zone Footer Set Statistics Window Text
20980. 
20981. SetStatisticsWindowText("!Heading!
20982. ----------------------------------------------------------
20983. Zones Processed: 
20984. ----------------------------------------------------------
20985. !ZoneListByLine!
20986. ----------------------------------------------------------
20987. Zone Processing Step:
20988. !ZoneStepByLine!    
20989. ----------------------------------------------------------
20990. Current Zone:
20991. !ZoneFooter!
20992. ----------------------------------------------------------
20993. Volume Statistics:
20994. !VolumeStatisticsDetail!
20995. ----------------------------------------------------------
20996. Zone Detailed Report:
20997. ----------------------------------------------------------
20998. !ZoneStatisticsDetail!
20999. ----------------------------------------------------------
21000. ")
21001. 
21002. 
21003. 
21004. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21005. 
21006. # Script: BannerSet
21007. 
21008. # Script: DisplaySetDateTimeRun
21009. 
21010. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
21011. /* Xinclude "..\Display\BannerSet.MyDc"X */
21012. /* pause(1) */
21013. 
21014. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
21015. 
21016. Title('!Heading!')
21017. /* pause(1) */
21018. 
21019. /* NOTE: Can't round or truncate to integer precision. */
21020. 
21021. pause(1)
21022. 
21023. # your stuff HERE (X)... pre file select code.
21024. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
21025. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21026. 	# (X)
21027. 
21028. FileSelect
21029. 
21030. 	# your stuff can't really go here (errors.)
21031. 	# maybe for some reason I don't know of...
21032. 	
21033. 	# Actions next...
21034. 	# Script: ZoneDo ZoneTypeSelectGames
21035. # Games start.
21036. # NotBlobsArchivesBu start.
21037. (not (
21038. # Blobs start.
21039. (
21040. # BlobsAndExceptions start.
21041. ( not(
21042.   FileName("*.bat")
21043.   or FileName("*.css")
21044.   or FileName("*.dll")
21045.   or FileName("*.exe")
21046.   or FileName("*.htm*")
21047.   or FileName("*.jar")
21048.   or FileName("*.js")
21049.   or FileName("*.script")
21050.   or FileName("*.wsf")
21051.   or (
21052. # Databases start.
21053. (
21054.   FileName("*.crypt*")
21055.   or FileName("*.db*")
21056.   or FileName("*.rdb*")
21057.   or FileName("*.dc*")
21058.   or FileName("*.dict*")
21059.   or FileName("*.?db*")
21060.   or FileName("*.?rdb*")
21061.   or FileName("*.md*")
21062.   or FileName("*.myd")
21063.   or FileName("*.ndf")
21064.   or FileName("*.ns?")
21065.   or FileName("*.pab")
21066.   or FileName("*.pst")
21067.   or FileName("*.sd?*")
21068.   or FileName("*.sq**")
21069.   or FileName("*.tmd")
21070.   or FileName("*.tps")
21071.   or FileName("*.tr*")
21072. )
21073. # Databases end.
21074. 
21075.     # BlobsAndExceptions
21076.     or 
21077. # Data start.
21078. (
21079.   DirectoryName("Data*")
21080.   or DirectoryName("Device*")
21081.   or DirectoryName("Export*")
21082.   or DirectoryName("Import*")
21083.   or DirectoryName("Log*")
21084.   or DirectoryName("*Log")
21085.   or DirectoryName("Maintenance*")
21086.   or DirectoryName("Rec*")
21087.   or DirectoryName("Sales*")
21088.   or DirectoryName("Search*")
21089.   or DirectoryName("User*")
21090. )
21091. # Data end.
21092. 
21093.     # BlobsAndExceptions
21094.   )
21095. ) )
21096. # BlobsAndExceptions end.
21097. 
21098. # Blobs
21099. ) and (
21100.   Size(BlobFileSize,0)
21101.   or (
21102.     FileName("*.arj")
21103.     or FileName("*.bup")
21104.     or FileName("*.bz2")
21105.     or FileName("*.chm")
21106.     or FileName("*.dvr-ms")
21107.     or FileName("*.gz")
21108.     or FileName("*.ifo")
21109.     or FileName("*.lzh")
21110.     or FileName("*.pdf")
21111.     or FileName("*.rpm")
21112.     or FileName("*.wmv")
21113.     or FileName("*.vob")
21114.     or FileName("*.z")
21115.   ) 
21116. )
21117. # Blobs end.
21118. 
21119. # NotBlobsArchivesBu
21120. or 
21121. # Archives start.
21122. (
21123.   DirectoryName("*Archive*")
21124.   or DirectoryName("*History*")
21125.   or DirectoryName("*Old")
21126.   or DirectoryName("* Old *")
21127.   or DirectoryName("Old *")
21128. 
21129.   or FileName("*.7z")
21130.   or FileName("*.cab")
21131.   or FileName("*.iso")
21132.   or FileName("*.msi")
21133.   or FileName("*.old")
21134.   or FileName("*.rar")
21135.   or FileName("*.tar")
21136.   or FileName("*.zip")
21137.   or
21138. # WinSysLow start.
21139. (
21140.   DirectoryName("$*")
21141.   or DirectoryName("0*")
21142.   or DirectoryName("1*")
21143.   or DirectoryName("2*")
21144.   or DirectoryName("3*")
21145.   or DirectoryName("4*")
21146.   or DirectoryName("5*")
21147.   or DirectoryName("6*")
21148.   or DirectoryName("7*")
21149.   or DirectoryName("8*")
21150.   or DirectoryName("9*")
21151. 
21152.   or DirectoryName("dllcache")
21153.   or DirectoryName("Downloaded Installations")
21154.   or DirectoryName("Ehome")
21155.   or DirectoryName("Fonts")
21156.   or DirectoryName("Help")
21157.   or DirectoryName("I386")
21158.   or DirectoryName("ie?updates")
21159.   or DirectoryName("Installer")
21160.   or DirectoryName("Installshield Installation Information")
21161.   or DirectoryName("IME")
21162.   or DirectoryName("*RECYCLE*")
21163.   or DirectoryName("ServicePackFiles")
21164.   or DirectoryName("SoftwareDistribution")
21165.   or DirectoryName("Speech")
21166.   or DirectoryName("Symbols")
21167.   or DirectoryName("System Volume Information")
21168.   or DirectoryName("windows.old")
21169. )
21170. # WinSysLow end.
21171. 
21172.   # Archives
21173. )
21174. # Archives end.
21175. 
21176. # NotBlobsArchivesBu
21177. or
21178. # Backups start.
21179. (
21180.   DirectoryName("*Backup*")
21181.   or DirectoryName("*Bu")
21182.   or DirectoryName("* Bu *")
21183.   or DirectoryName("Bu *")
21184. 
21185.   or FileName("*.bak")
21186.   or FileName("* - Copy*")
21187. )
21188. # Backups end.
21189. 
21190. # NotBlobsArchivesBu
21191. ) )
21192. # NotBlobsArchivesBu end.
21193. 
21194. # People
21195. and (
21196. # Games start.
21197. (
21198.   DirectoryName("Game*")
21199.   or DirectoryName("Epic*")
21200.   or DirectoryName("*XBox*")
21201.   or DirectoryName("*PS2*")
21202. )
21203. # Games end.
21204. 
21205. # People
21206. )
21207. # People end.
21208. 
21209. 	# Script: ZoneDoAction
21210. # Zone Do File Action - SortByName.
21211. 
21212. FileActions
21213. 
21214. 		/* ---------------------------------------------------------- */
21215. 	# Gap
21216. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
21217. 		# Script: DisplaySetFileStep
21218. 
21219. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21220. 
21221. /* add message and move to a new line. */
21222. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21223. ")
21224. 
21225. /* display the line. (hopefully.) */
21226. # Zone Footer Set Statistics Window Text
21227. 
21228. SetStatisticsWindowText("!Heading!
21229. ----------------------------------------------------------
21230. Zones Processed: 
21231. ----------------------------------------------------------
21232. !ZoneListByLine!
21233. ----------------------------------------------------------
21234. Zone Processing Step:
21235. !ZoneStepByLine!    
21236. ----------------------------------------------------------
21237. Current Zone:
21238. !ZoneFooter!
21239. ----------------------------------------------------------
21240. Volume Statistics:
21241. !VolumeStatisticsDetail!
21242. ----------------------------------------------------------
21243. Zone Detailed Report:
21244. ----------------------------------------------------------
21245. !ZoneStatisticsDetail!
21246. ----------------------------------------------------------
21247. ")
21248. 
21249. 
21250. 
21251. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21252. 
21253. # Script: BannerSet
21254. 
21255. # Script: DisplaySetDateTimeRun
21256. 
21257. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
21258. /* Xinclude "..\Display\BannerSet.MyDc"X */
21259. /* pause(1) */
21260. 
21261. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
21262. 
21263. Title('!Heading!')
21264. /* pause(1) */
21265. 
21266. /* NOTE: Can't round or truncate to integer precision. */
21267. 
21268. pause(1)
21269. 	
21270. 	# ACTUAL GAP
21271. 		/* AddGap Variant. */
21272. 	  	# Zone Do Gap
21273. # Gap Calculation Methods:
21274. 
21275. /* 1) Anything you need to add first. */
21276. /* empty */
21277. 
21278. /* ---------------------------------------------------------- */
21279. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
21280. 	# GapRequestedStd.
21281. 
21282. 		/* ---------------------------------------------------------- */
21283. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
21284. 
21285. 		# Gap Calculation Methods:
21286. 
21287. /* AddGap Variants */
21288. 
21289. 	/* Standard */
21290. 		# Gap Calculation Methods:
21291. 	/* AddGap Variants */
21292. 	/* Standard */
21293. 
21294. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
21295. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
21296. 
21297. 	SetVariable(GapRequested, GapRequestedStd)
21298. 	
21299. 
21300. 	/* MFT Low High Method */
21301. 		# Gap Calculation Methods:
21302. 	/* AddGap Variants */
21303. 	/* MFT Low High Method */
21304. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
21305. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
21306. 	SetVariable(GapRequested, GapRequestedMft)
21307. 	
21308. 
21309. 	/* OS Volume Type Method */
21310. 		# Gap Calculation Methods:
21311. 	/* AddGap Variants */
21312. 	/* OS Volume Type Method */
21313. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
21314. 	SetVariable(GapRequested, GapRequestedOs)
21315. 
21316. 
21317. 
21318. /* MakeGap Variants */
21319. 
21320. 	/* Original Os 1-3 + MFT 2 */
21321. 		# Gap Calculation Methods:
21322. 	/* MakeGap Variants */
21323. 	/* Original Os 1-3 + MFT 2 */
21324. 	/* plus MFT gap placed inline at the dividing zone. */
21325. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
21326. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
21327. 	SetVariable(GapRequested, GapRequestedOrig)
21328. 	
21329. 	
21330. /* Note: You could comment out the ones not in use */
21331. /* However having the data in the log is useful. */
21332. /* Therefore the following line is otherwise needed. */
21333. 
21334. /* Standard used */
21335. 
21336. SetVariable(GapRequested, GapRequestedStd)
21337. 
21338. # Gap Calculation Methods:
21339. 
21340. /* AddGap Variants */
21341. 	/* Standard */
21342. 	/* MFT Low High Method */
21343. 	/* OS Volume Type Method */
21344. 
21345. /* MakeGap Variants */
21346. 	/* Original Os 1-3 + MFT 2 */
21347. 
21348. /* Note: You could comment out the ones not in use */
21349. /* However having the data in the log is useful. */
21350. /* Therefore the following line is otherwise needed. */
21351. 
21352. /* Standard is used currently */
21353. 
21354. 
21355. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
21356. 
21357. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
21358. 
21359. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
21360. 
21361. /* ---------------------------------------------------------- */
21362. /* 3) SMALL ZONE ADJUSTMENT. */
21363. /* Gab cant be larger than half the Zone Size. */
21364. 
21365. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
21366. 	
21367. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
21368. 
21369. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
21370. 
21371. /* ---------------------------------------------------------- */
21372. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
21373. # Gap Adjustments.
21374. 
21375. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
21376. 	
21377. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
21378. 
21379. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
21380. 
21381. /* ---------------------------------------------------------- */
21382. # BYPASS THIS.
21383. 	/* This is definitely wrong. */
21384. 	/* The question is can we steal gap from the next zone */
21385. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
21386. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
21387. 		# Zone Overflow.
21388. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
21389. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
21390. 
21391. /* ---------------------------------------------------------- */
21392. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
21393. # Remaining free space available.
21394. 
21395. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
21396. 	
21397. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
21398. 
21399. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
21400. 
21401. /* ---------------------------------------------------------- */
21402. # CURRENT gap to use.
21403. 
21404. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
21405. 
21406. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
21407. 
21408. /* ---------------------------------------------------------- */
21409. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
21410. # Debugging.
21411. 
21412. 	SetVariable(GapUsed, GapCurrent) // for debugging
21413. 
21414. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
21415. 
21416. 		# Your code HERE
21417. 
21418. /* ---------------------------------------------------------- */
21419. /* 7) YOUR CODE. */
21420. # YOUR CODE HERE:
21421. 	# INPUT: GapCurrent or GapCurrentLoc
21422. 	# OUTPUT: GapUsed...
21423. 
21424. /* ---------------------------------------------------------- */
21425. # Gap Size.
21426. # Actual Size of Gap.
21427. 
21428. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
21429. 
21430. /* ---------------------------------------------------------- */
21431. /* xxxxxxxxxxxxxxxxxxxxxx */
21432. # ADD THE GAP
21433. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
21434. /* xxxxxxxxxxxxxxxxxxxxxx */
21435. 
21436. 	
21437. 	# Zone Statistics	
21438. 	# Script: ZoneDoStatistics
21439. # Zone / Volume Statistics and Display
21440. 		
21441. 	# Accumulate Totals
21442.   	# Script: ZoneDoVolumeTotals
21443. 
21444. /* Current total space used (by Zones and Gaps) */
21445. 
21446. SetVariable(VolumeZoneUsed, GapUsed)
21447. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
21448. /* Percentage */
21449. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
21450. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
21451. 
21452. /* Current total of free space requested */
21453. 
21454. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
21455. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
21456. /* Percent. */
21457. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
21458. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
21459. 
21460. /* Current total of free space used */
21461. 
21462. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
21463. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
21464. /* Percent */
21465. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
21466. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
21467. 
21468. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
21469. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
21470. /* Xinclude "..\DebugDisplayPause.MyDc"X */
21471. 
21472. 
21473. 	# Current Values
21474. 	# Script: ZoneDoCurrentSet
21475. 
21476. # Cluster, Sector, Block adjust for display.
21477. 	# Bytes per cluster is volume specific.
21478. 
21479. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
21480. 
21481. # Current Zone values.
21482. 	# Begin, end and size.
21483. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
21484. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
21485. 
21486. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
21487. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
21488. 
21489. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
21490. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
21491. 
21492. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
21493. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
21494. 
21495. 	SetVariable(ZoneFragments,				"!ZONE210N!")
21496. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
21497. 		
21498. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
21499. /* identical code to here: (separation not needed. TEST.) */	
21500. 
21501. # Current Gap, Actual and Free Values
21502. 	# Gap
21503. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
21504. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
21505. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
21506. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
21507. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
21508. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
21509. 	
21510. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
21511. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
21512. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
21513. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
21514. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
21515. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
21516. 	
21517. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
21518. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
21519. 	
21520. 	# Actual Size and End
21521. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
21522. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
21523. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
21524. 	
21525. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
21526. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
21527. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
21528. 
21529. # Gap Size & Rounding
21530. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
21531. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
21532. 	
21533. 	# Free Space
21534. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
21535. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
21536. 
21537. 	# Footer:
21538. SetVariable(ZoneFooter, "----------------------------------------------------------
21539. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
21540. 
21541. Statistics Report:
21542. ------------------
21543.    Size:  
21544.    ------------------------
21545.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21546.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21547.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21548. 
21549.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21550.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21551. 
21552.    Location:
21553.    ------------------------
21554.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21555.              Files End: !ZoneEndCurrent!
21556.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21557.       
21558.    Gap Settings:
21559.    ------------------------
21560.          Gap Requested: !ZoneGapSizePer!%
21561.       Volume Rounding: !ZoneVolRoundUpPer!%
21562.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21563.                  
21564.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
21565.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
21566.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
21567.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
21568.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
21569.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
21570.      
21571.    Free Space after Zone:
21572.    ------------------------
21573.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21574.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21575.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21576. 
21577. Directory and Files Select:
21578. ---------------------------
21579. !ZoneTypeSelectCurrent!               
21580. ---------------------------
21581. ----------------------------------------------------------
21582. ")
21583. 	# Zone Footer Set Statistics Window Text
21584. 
21585. SetStatisticsWindowText("!Heading!
21586. ----------------------------------------------------------
21587. Zones Processed: 
21588. ----------------------------------------------------------
21589. !ZoneListByLine!
21590. ----------------------------------------------------------
21591. Zone Processing Step:
21592. !ZoneStepByLine!    
21593. ----------------------------------------------------------
21594. Current Zone:
21595. !ZoneFooter!
21596. ----------------------------------------------------------
21597. Volume Statistics:
21598. !VolumeStatisticsDetail!
21599. ----------------------------------------------------------
21600. Zone Detailed Report:
21601. ----------------------------------------------------------
21602. !ZoneStatisticsDetail!
21603. ----------------------------------------------------------
21604. ")
21605. 
21606. 
21607. 	
21608.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
21609. 
21610. 	# Add Zone to list of zones for display.
21611. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
21612. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
21613. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
21614. 	# ??? Free Stats?
21615. 	# Footer:
21616. SetVariable(ZoneFooter, "----------------------------------------------------------
21617. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
21618. 
21619. Statistics Report:
21620. ------------------
21621.    Size:  
21622.    ------------------------
21623.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21624.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21625.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21626. 
21627.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21628.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21629. 
21630.    Location:
21631.    ------------------------
21632.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21633.              Files End: !ZoneEndCurrent!
21634.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21635.       
21636.    Gap Settings:
21637.    ------------------------
21638.          Gap Requested: !ZoneGapSizePer!%
21639.       Volume Rounding: !ZoneVolRoundUpPer!%
21640.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21641.                  
21642.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
21643.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
21644.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
21645.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
21646.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
21647.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
21648.      
21649.    Free Space after Zone:
21650.    ------------------------
21651.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21652.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21653.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21654. 
21655. Directory and Files Select:
21656. ---------------------------
21657. !ZoneTypeSelectCurrent!               
21658. ---------------------------
21659. ----------------------------------------------------------
21660. ")
21661. 
21662. 	# Add Zone Details to Report.	
21663. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
21664. !ZoneFooter!")
21665. 
21666. 
21667. 	
21668. 	# Footer:
21669. SetVariable(ZoneFooter, "----------------------------------------------------------
21670. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
21671. 
21672. Statistics Report:
21673. ------------------
21674.    Size:  
21675.    ------------------------
21676.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21677.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21678.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21679. 
21680.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21681.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21682. 
21683.    Location:
21684.    ------------------------
21685.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21686.              Files End: !ZoneEndCurrent!
21687.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21688.       
21689.    Gap Settings:
21690.    ------------------------
21691.          Gap Requested: !ZoneGapSizePer!%
21692.       Volume Rounding: !ZoneVolRoundUpPer!%
21693.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21694.                  
21695.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
21696.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
21697.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
21698.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
21699.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
21700.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
21701.      
21702.    Free Space after Zone:
21703.    ------------------------
21704.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21705.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21706.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21707. 
21708. Directory and Files Select:
21709. ---------------------------
21710. !ZoneTypeSelectCurrent!               
21711. ---------------------------
21712. ----------------------------------------------------------
21713. ")
21714. 	SetStatisticsWindowText("!ZoneFooter!")
21715. 	
21716. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
21717. 	# Script: DisplaySetFileStep
21718. 
21719. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21720. 
21721. /* add message and move to a new line. */
21722. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21723. ")
21724. 
21725. /* display the line. (hopefully.) */
21726. # Zone Footer Set Statistics Window Text
21727. 
21728. SetStatisticsWindowText("!Heading!
21729. ----------------------------------------------------------
21730. Zones Processed: 
21731. ----------------------------------------------------------
21732. !ZoneListByLine!
21733. ----------------------------------------------------------
21734. Zone Processing Step:
21735. !ZoneStepByLine!    
21736. ----------------------------------------------------------
21737. Current Zone:
21738. !ZoneFooter!
21739. ----------------------------------------------------------
21740. Volume Statistics:
21741. !VolumeStatisticsDetail!
21742. ----------------------------------------------------------
21743. Zone Detailed Report:
21744. ----------------------------------------------------------
21745. !ZoneStatisticsDetail!
21746. ----------------------------------------------------------
21747. ")
21748. 
21749. 
21750. 
21751. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21752. 
21753. # Script: BannerSet
21754. 
21755. # Script: DisplaySetDateTimeRun
21756. 
21757. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
21758. /* Xinclude "..\Display\BannerSet.MyDc"X */
21759. /* pause(1) */
21760. 
21761. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
21762. 
21763. Title('!Heading!')
21764. /* pause(1) */
21765. 
21766. /* NOTE: Can't round or truncate to integer precision. */
21767. 
21768. pause(1)
21769. 
21770. # Commands:
21771. 
21772. /* Moves to Zone or above it. */
21773. # MoveUpToZone()
21774. 
21775. # Defrag
21776. 
21777. # Defragment(OPTIONS)
21778. 
21779. /* Shuffles files around trying to make a big enough gap for fragmented files. */
21780. # Defragment()
21781. 
21782. /* Only does files where a gap will fit it. */
21783. # Defragment(Fast)
21784. 
21785. /* Skips fragmented files larger than the Chunck Size. */
21786. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
21787. # Defragment(Chunk Size)
21788. 
21789. /* Moves down to zone and packs zone to beginning if there are gaps. */
21790. /* Can be similar in performance to doing a SortBy. */
21791. # MoveDownFill()
21792. 
21793. # File Action - All - Fast - MoveUpToZone.
21794. 	MoveUpToZone()
21795. 	
21796. 
21797. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
21798. 	# Script: DisplaySetFileStep
21799. 
21800. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21801. 
21802. /* add message and move to a new line. */
21803. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21804. ")
21805. 
21806. /* display the line. (hopefully.) */
21807. # Zone Footer Set Statistics Window Text
21808. 
21809. SetStatisticsWindowText("!Heading!
21810. ----------------------------------------------------------
21811. Zones Processed: 
21812. ----------------------------------------------------------
21813. !ZoneListByLine!
21814. ----------------------------------------------------------
21815. Zone Processing Step:
21816. !ZoneStepByLine!    
21817. ----------------------------------------------------------
21818. Current Zone:
21819. !ZoneFooter!
21820. ----------------------------------------------------------
21821. Volume Statistics:
21822. !VolumeStatisticsDetail!
21823. ----------------------------------------------------------
21824. Zone Detailed Report:
21825. ----------------------------------------------------------
21826. !ZoneStatisticsDetail!
21827. ----------------------------------------------------------
21828. ")
21829. 
21830. 
21831. 
21832. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21833. 
21834. # Script: BannerSet
21835. 
21836. # Script: DisplaySetDateTimeRun
21837. 
21838. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
21839. /* Xinclude "..\Display\BannerSet.MyDc"X */
21840. /* pause(1) */
21841. 
21842. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
21843. 
21844. Title('!Heading!')
21845. /* pause(1) */
21846. 
21847. /* NOTE: Can't round or truncate to integer precision. */
21848. 
21849. pause(1)
21850. 
21851. 	# Script: ZoneDoFooter
21852. 
21853. /* ---------------------------------------------------------- */
21854. # File Select
21855. 	# Select Statments
21856. # File Actions 
21857. 	# Standard or OS File Actions.
21858. 	# Resume...
21859. 	
21860. 	# your stuff HERE (X)... post zone (file) file actions code.
21861. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
21862. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21863. 		# (X)
21864. 		
21865. 		/* ??? Set window? */
21866. 	
21867. 	# ADD THE GAP
21868. # Vacate (good for diagnostics)
21869. # DoNotVacate - DO NOT Vacate (recommended)
21870. # DoNotVacate - DO NOT Vacate (recommended)
21871. 
21872. # Vacate
21873. /* AddGap(GapUsedLoc) */
21874. 
21875. # DO Not Vacate
21876. AddGap(GapUsedLoc, DoNotVacate) 
21877. 	
21878. 	
21879. # Script: GapZoneCommand
21880. # *** Moved to setting yours ***
21881. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
21882. # Controlled via settings commands
21883. # DoNotVacate - DO NOT Vacate (recommended)
21884. 
21885. # Vacate
21886. /* AddGap(GapUsedLoc) */
21887. 
21888. # DO Not Vacate
21889. AddGap(GapUsedLoc, DoNotVacate) 
21890. 	
21891. 	
21892. # Vacate /* AddGap(GapUsed) */
21893. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
21894. 	
21895. 
21896. 		
21897. # 
21898. FileEnd
21899. /* ---------------------------------------------------------- */
21900. 
21901. # your stuff HERE (X)... post zone (file) code.
21902. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
21903. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21904. 	# (X)
21905. 
21906. SetVariable(FileStepDescription,"Zone finished, reporting.")
21907. # Script: DisplaySetFileStep
21908. 
21909. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21910. 
21911. /* add message and move to a new line. */
21912. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21913. ")
21914. 
21915. /* display the line. (hopefully.) */
21916. # Zone Footer Set Statistics Window Text
21917. 
21918. SetStatisticsWindowText("!Heading!
21919. ----------------------------------------------------------
21920. Zones Processed: 
21921. ----------------------------------------------------------
21922. !ZoneListByLine!
21923. ----------------------------------------------------------
21924. Zone Processing Step:
21925. !ZoneStepByLine!    
21926. ----------------------------------------------------------
21927. Current Zone:
21928. !ZoneFooter!
21929. ----------------------------------------------------------
21930. Volume Statistics:
21931. !VolumeStatisticsDetail!
21932. ----------------------------------------------------------
21933. Zone Detailed Report:
21934. ----------------------------------------------------------
21935. !ZoneStatisticsDetail!
21936. ----------------------------------------------------------
21937. ")
21938. 
21939. 
21940. 
21941. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21942. 
21943. # Script: BannerSet
21944. 
21945. # Script: DisplaySetDateTimeRun
21946. 
21947. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
21948. /* Xinclude "..\Display\BannerSet.MyDc"X */
21949. /* pause(1) */
21950. 
21951. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
21952. 
21953. Title('!Heading!')
21954. /* pause(1) */
21955. 
21956. /* NOTE: Can't round or truncate to integer precision. */
21957. 
21958. pause(1)
21959. 
21960. # Script: ZoneWhenFinished
21961. 
21962. # Script: BannerSet
21963. 
21964. # Script: DisplaySetDateTimeRun
21965. 
21966. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
21967. /* Xinclude "..\Display\BannerSet.MyDc"X */
21968. /* pause(1) */
21969. 
21970. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
21971. 
21972. Title('!Heading!')
21973. /* pause(1) */
21974. 
21975. /* NOTE: Can't round or truncate to integer precision. */
21976. 
21977. # Script: BannerLog
21978. 
21979. AppendLogfile("!LogFileName!", "!Title!")
21980. 
21981. 
21982. 
21983. # Zone Statistics	
21984. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
21985. 
21986. # Footer:
21987. SetVariable(ZoneFooter, "----------------------------------------------------------
21988. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
21989. 
21990. Statistics Report:
21991. ------------------
21992.    Size:  
21993.    ------------------------
21994.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21995.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21996.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21997. 
21998.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21999.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22000. 
22001.    Location:
22002.    ------------------------
22003.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22004.              Files End: !ZoneEndCurrent!
22005.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22006.       
22007.    Gap Settings:
22008.    ------------------------
22009.          Gap Requested: !ZoneGapSizePer!%
22010.       Volume Rounding: !ZoneVolRoundUpPer!%
22011.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22012.                  
22013.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
22014.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
22015.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
22016.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
22017.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
22018.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
22019.      
22020.    Free Space after Zone:
22021.    ------------------------
22022.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22023.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22024.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22025. 
22026. Directory and Files Select:
22027. ---------------------------
22028. !ZoneTypeSelectCurrent!               
22029. ---------------------------
22030. ----------------------------------------------------------
22031. ")
22032. 
22033. AppendLogfile("!LogFileName!", ".")
22034. AppendLogfile("!LogFileName!", "!ZoneFooter!")
22035. AppendLogfile("!LogFileName!", ".")
22036. 
22037. # Zone Footer Set Statistics Window Text
22038. 
22039. SetStatisticsWindowText("!Heading!
22040. ----------------------------------------------------------
22041. Zones Processed: 
22042. ----------------------------------------------------------
22043. !ZoneListByLine!
22044. ----------------------------------------------------------
22045. Zone Processing Step:
22046. !ZoneStepByLine!    
22047. ----------------------------------------------------------
22048. Current Zone:
22049. !ZoneFooter!
22050. ----------------------------------------------------------
22051. Volume Statistics:
22052. !VolumeStatisticsDetail!
22053. ----------------------------------------------------------
22054. Zone Detailed Report:
22055. ----------------------------------------------------------
22056. !ZoneStatisticsDetail!
22057. ----------------------------------------------------------
22058. ")
22059. 
22060. 
22061. 
22062. /* pause() */
22063. /* pause() */
22064. 
22065. 
22066. 
22067. 
22068. /* ---------------------------------------------------------- */
22069. 
22070. 
22071. /* ---------------------------------------------------------- */
22072. /* Zone 16 Shares */
22073. # Script: DisplayColors - Zone Dark
22074. # Processed
22075. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
22076. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
22077. 
22078. # Light Green and Yellow
22079. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
22080. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
22081. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
22082. 
22083. # Script: DefragZoneTypeShares
22084. /* ---------------------------------------------------------- */
22085. /* Zone Shares */
22086. SetVariable(ZoneLabel, "!ZoneLabelShares!")
22087. SetVariable(ZoneDescription, "!ZoneDescriptionShares!")
22088. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpShares!")
22089. SetVariable(ZoneGapSize, "!ZoneGapSizeShares!")
22090. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectShares
22091. # Shares start.
22092. # NotBlobsArchivesBu start.
22093. (not (
22094. # Blobs start.
22095. (
22096. # BlobsAndExceptions start.
22097. ( not(
22098.   FileName("*.bat")
22099.   or FileName("*.css")
22100.   or FileName("*.dll")
22101.   or FileName("*.exe")
22102.   or FileName("*.htm*")
22103.   or FileName("*.jar")
22104.   or FileName("*.js")
22105.   or FileName("*.script")
22106.   or FileName("*.wsf")
22107.   or (
22108. # Databases start.
22109. (
22110.   FileName("*.crypt*")
22111.   or FileName("*.db*")
22112.   or FileName("*.rdb*")
22113.   or FileName("*.dc*")
22114.   or FileName("*.dict*")
22115.   or FileName("*.?db*")
22116.   or FileName("*.?rdb*")
22117.   or FileName("*.md*")
22118.   or FileName("*.myd")
22119.   or FileName("*.ndf")
22120.   or FileName("*.ns?")
22121.   or FileName("*.pab")
22122.   or FileName("*.pst")
22123.   or FileName("*.sd?*")
22124.   or FileName("*.sq**")
22125.   or FileName("*.tmd")
22126.   or FileName("*.tps")
22127.   or FileName("*.tr*")
22128. )
22129. # Databases end.
22130. 
22131.     # BlobsAndExceptions
22132.     or 
22133. # Data start.
22134. (
22135.   DirectoryName("Data*")
22136.   or DirectoryName("Device*")
22137.   or DirectoryName("Export*")
22138.   or DirectoryName("Import*")
22139.   or DirectoryName("Log*")
22140.   or DirectoryName("*Log")
22141.   or DirectoryName("Maintenance*")
22142.   or DirectoryName("Rec*")
22143.   or DirectoryName("Sales*")
22144.   or DirectoryName("Search*")
22145.   or DirectoryName("User*")
22146. )
22147. # Data end.
22148. 
22149.     # BlobsAndExceptions
22150.   )
22151. ) )
22152. # BlobsAndExceptions end.
22153. 
22154. # Blobs
22155. ) and (
22156.   Size(BlobFileSize,0)
22157.   or (
22158.     FileName("*.arj")
22159.     or FileName("*.bup")
22160.     or FileName("*.bz2")
22161.     or FileName("*.chm")
22162.     or FileName("*.dvr-ms")
22163.     or FileName("*.gz")
22164.     or FileName("*.ifo")
22165.     or FileName("*.lzh")
22166.     or FileName("*.pdf")
22167.     or FileName("*.rpm")
22168.     or FileName("*.wmv")
22169.     or FileName("*.vob")
22170.     or FileName("*.z")
22171.   ) 
22172. )
22173. # Blobs end.
22174. 
22175. # NotBlobsArchivesBu
22176. or 
22177. # Archives start.
22178. (
22179.   DirectoryName("*Archive*")
22180.   or DirectoryName("*History*")
22181.   or DirectoryName("*Old")
22182.   or DirectoryName("* Old *")
22183.   or DirectoryName("Old *")
22184. 
22185.   or FileName("*.7z")
22186.   or FileName("*.cab")
22187.   or FileName("*.iso")
22188.   or FileName("*.msi")
22189.   or FileName("*.old")
22190.   or FileName("*.rar")
22191.   or FileName("*.tar")
22192.   or FileName("*.zip")
22193.   or
22194. # WinSysLow start.
22195. (
22196.   DirectoryName("$*")
22197.   or DirectoryName("0*")
22198.   or DirectoryName("1*")
22199.   or DirectoryName("2*")
22200.   or DirectoryName("3*")
22201.   or DirectoryName("4*")
22202.   or DirectoryName("5*")
22203.   or DirectoryName("6*")
22204.   or DirectoryName("7*")
22205.   or DirectoryName("8*")
22206.   or DirectoryName("9*")
22207. 
22208.   or DirectoryName("dllcache")
22209.   or DirectoryName("Downloaded Installations")
22210.   or DirectoryName("Ehome")
22211.   or DirectoryName("Fonts")
22212.   or DirectoryName("Help")
22213.   or DirectoryName("I386")
22214.   or DirectoryName("ie?updates")
22215.   or DirectoryName("Installer")
22216.   or DirectoryName("Installshield Installation Information")
22217.   or DirectoryName("IME")
22218.   or DirectoryName("*RECYCLE*")
22219.   or DirectoryName("ServicePackFiles")
22220.   or DirectoryName("SoftwareDistribution")
22221.   or DirectoryName("Speech")
22222.   or DirectoryName("Symbols")
22223.   or DirectoryName("System Volume Information")
22224.   or DirectoryName("windows.old")
22225. )
22226. # WinSysLow end.
22227. 
22228.   # Archives
22229. )
22230. # Archives end.
22231. 
22232. # NotBlobsArchivesBu
22233. or
22234. # Backups start.
22235. (
22236.   DirectoryName("*Backup*")
22237.   or DirectoryName("*Bu")
22238.   or DirectoryName("* Bu *")
22239.   or DirectoryName("Bu *")
22240. 
22241.   or FileName("*.bak")
22242.   or FileName("* - Copy*")
22243. )
22244. # Backups end.
22245. 
22246. # NotBlobsArchivesBu
22247. ) )
22248. # NotBlobsArchivesBu end.
22249. 
22250. # Shares
22251. and (
22252. # Share start.
22253. (
22254.   DirectoryName("*Common*")
22255.   or DirectoryName("Media*")
22256.   or DirectoryName("Multimedia*")
22257.   or DirectoryName("*Public*")
22258.   or DirectoryName("*Share*")
22259. )
22260. # Share end.
22261. 
22262. # Shares
22263. or 
22264. # Family start.
22265. (
22266.     DirectoryName("*Family*")
22267. )
22268. # Family end.
22269. 
22270. # Shares
22271. )
22272. # Shares end.
22273. ')
22274. 
22275. 	# Script: ZoneDoHeader
22276. 
22277. # Script: ZoneWhenStarted
22278. 
22279. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
22280. # Script: DisplaySetZone
22281. 
22282. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
22283. SetVariable(FileStepDescription,	"")
22284. 
22285. SetVariable(ZoneStepByLine, 			"Zone started.
22286. ")
22287. 
22288. # Script: BannerDescriptionSet
22289. 
22290. # Script: BannerSet
22291. 
22292. # Script: DisplaySetDateTimeRun
22293. 
22294. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
22295. /* Xinclude "..\Display\BannerSet.MyDc"X */
22296. /* pause(1) */
22297. 
22298. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
22299. 
22300. Title('!Heading!')
22301. /* pause(1) */
22302. 
22303. /* NOTE: Can't round or truncate to integer precision. */
22304. 
22305. # Script: BannerLog
22306. 
22307. AppendLogfile("!LogFileName!", "!Title!")
22308. 
22309. 
22310. 
22311. pause(1)
22312. 
22313. 
22314. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
22315. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
22316. 
22317. SetVariable(ZoneStepNoCurrent, 0)
22318. 
22319. 
22320. # Script: ZoneDoCurrentClear
22321. 
22322. SetVariable(ZoneTypeSelectCurrent, 		"")
22323. 
22324. SetVariable(ZoneBeginCurrent, 			0)
22325. SetVariable(ZoneBeginPerCurrent, 		0)
22326. SetVariable(ZoneEndCurrent, 			0)
22327. SetVariable(ZoneEndPerCurrent, 			0)
22328. 
22329. SetVariable(ZoneSizeCurrent,			0)
22330. SetVariable(ZoneSizePerCurrent,			0)
22331. 
22332. SetVariable(ZoneGapRequestedCurrent,	0)
22333. SetVariable(ZoneGapRoundedCurrent, 		0)
22334. SetVariable(ZoneGapAdjustedCurrent, 	0)
22335. SetVariable(ZoneGapAvailableCurrent, 	0)
22336. SetVariable(ZoneGapCurrent,				0)
22337. SetVariable(ZoneGapUsedCurrent, 		0)
22338. 
22339. SetVariable(ZoneGapActualCurrent, 		0)
22340. SetVariable(ZoneGapActualPerCurrent, 	0)
22341. 
22342. SetVariable(ZoneSizeActual, 			0)
22343. SetVariable(ZoneSizeActualCurrent,		0)
22344. 
22345. SetVariable(ZoneEndActual, 				0)
22346. SetVariable(ZoneEndActualCurrent,		0)			
22347. SetVariable(ZoneSizeActualPerCurrent, 	0)
22348.       
22349. SetVariable(ZoneFilesFolders,			0)
22350. SetVariable(ZoneFilesFoldersPer,		0) 
22351. 
22352. SetVariable(ZoneFragments,				0)
22353. SetVariable(ZoneFragmentsPer,			0) 
22354. 		
22355. SetVariable(ZoneEndActualCurrent, 		0)
22356. SetVariable(ZoneEndActualPerCurrent, 	0)
22357. 
22358. # Gap Calculation Methodology:
22359. 	# Requested
22360. 	SetVariable(GapRequested, 			0) 
22361. 	SetVariable(GapRequestedStd, 		0) 
22362. 	SetVariable(GapRequestedMft, 		0) 
22363. 	SetVariable(GapRequestedOs, 		0) 
22364. 	SetVariable(GapRequestedOriginal, 	0) 
22365. 	
22366. 	# Gap Adjustments
22367. 	SetVariable(GapRounded, 			0)
22368. 	# SetVariable(GapAdjusted, 			0)
22369. 	SetVariable(GapAvailable, 			0)
22370. 	SetVariable(GapCurrent, 			0)
22371. 	SetVariable(GapActual, 				0)
22372. 	SetVariable(GapUsed, 				0)
22373. 	
22374. 	# Gap Adjustments
22375. 	SetVariable(GapRoundedLoc, 			0)
22376. 	# SetVariable(GapAdjustedLoc, 		0)
22377. 	SetVariable(GapAvailableLoc, 		0)
22378. 	SetVariable(GapCurrentLoc, 			0)
22379. 	SetVariable(GapActualLoc,			0)
22380. 	SetVariable(GapUsedLoc,				0)
22381. 	
22382. 	# Space usage
22383. 	SetVariable(ZoneFreePerRequested, 	0)
22384. 	SetVariable(ZoneFreePerUsed, 		0)
22385. 
22386. # Gap Size & Rounding
22387. 	SetVariable(ZoneGapSizePer, 		0)
22388. 	SetVariable(ZoneVolRoundUpPer, 		0)
22389. 	
22390. 	# Free Space
22391. 	SetVariable(ZoneFreeUsedPer, 		0)
22392. 	SetVariable(ZoneFreeRequestedPer, 	0)
22393. 
22394. 
22395. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
22396. 
22397. # Footer:
22398. SetVariable(ZoneFooter, "----------------------------------------------------------
22399. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
22400. 
22401. Statistics Report:
22402. ------------------
22403.    Size:  
22404.    ------------------------
22405.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22406.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22407.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22408. 
22409.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22410.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22411. 
22412.    Location:
22413.    ------------------------
22414.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22415.              Files End: !ZoneEndCurrent!
22416.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22417.       
22418.    Gap Settings:
22419.    ------------------------
22420.          Gap Requested: !ZoneGapSizePer!%
22421.       Volume Rounding: !ZoneVolRoundUpPer!%
22422.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22423.                  
22424.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
22425.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
22426.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
22427.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
22428.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
22429.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
22430.      
22431.    Free Space after Zone:
22432.    ------------------------
22433.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22434.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22435.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22436. 
22437. Directory and Files Select:
22438. ---------------------------
22439. !ZoneTypeSelectCurrent!               
22440. ---------------------------
22441. ----------------------------------------------------------
22442. ")
22443. 
22444. # Script: BannerSet
22445. 
22446. # Script: DisplaySetDateTimeRun
22447. 
22448. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
22449. /* Xinclude "..\Display\BannerSet.MyDc"X */
22450. /* pause(1) */
22451. 
22452. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
22453. 
22454. Title('!Heading!')
22455. /* pause(1) */
22456. 
22457. /* NOTE: Can't round or truncate to integer precision. */
22458. 
22459. # Script: BannerLog
22460. 
22461. AppendLogfile("!LogFileName!", "!Title!")
22462. 
22463. 
22464. 
22465. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
22466. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
22467. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:21")
22468. 
22469. SetVariable(ZoneListByLine, "!ZoneListByLine!
22470. Zone: !ZoneNoCurrent! 2021-11-13 20:31:21 0:00:04 !ZoneLabel! !ZoneDescription!")
22471. 
22472. 
22473. /* Fixed Zone Position Handling */
22474. /* Literal number: */
22475. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
22476. /* Percentage of disk: */
22477. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
22478. /* Gap */
22479. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
22480. 
22481. /* ---------------------------------------------------------- */
22482. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
22483. # Script: DisplaySetFileStep
22484. 
22485. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22486. 
22487. /* add message and move to a new line. */
22488. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22489. ")
22490. 
22491. /* display the line. (hopefully.) */
22492. # Zone Footer Set Statistics Window Text
22493. 
22494. SetStatisticsWindowText("!Heading!
22495. ----------------------------------------------------------
22496. Zones Processed: 
22497. ----------------------------------------------------------
22498. !ZoneListByLine!
22499. ----------------------------------------------------------
22500. Zone Processing Step:
22501. !ZoneStepByLine!    
22502. ----------------------------------------------------------
22503. Current Zone:
22504. !ZoneFooter!
22505. ----------------------------------------------------------
22506. Volume Statistics:
22507. !VolumeStatisticsDetail!
22508. ----------------------------------------------------------
22509. Zone Detailed Report:
22510. ----------------------------------------------------------
22511. !ZoneStatisticsDetail!
22512. ----------------------------------------------------------
22513. ")
22514. 
22515. 
22516. 
22517. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22518. 
22519. # Script: BannerSet
22520. 
22521. # Script: DisplaySetDateTimeRun
22522. 
22523. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
22524. /* Xinclude "..\Display\BannerSet.MyDc"X */
22525. /* pause(1) */
22526. 
22527. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
22528. 
22529. Title('!Heading!')
22530. /* pause(1) */
22531. 
22532. /* NOTE: Can't round or truncate to integer precision. */
22533. 
22534. pause(1)
22535. 
22536. # your stuff HERE (X)... pre file select code.
22537. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
22538. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22539. 	# (X)
22540. 
22541. FileSelect
22542. 
22543. 	# your stuff can't really go here (errors.)
22544. 	# maybe for some reason I don't know of...
22545. 	
22546. 	# Actions next...
22547. 	# Script: ZoneDo ZoneTypeSelectShares
22548. # Shares start.
22549. # NotBlobsArchivesBu start.
22550. (not (
22551. # Blobs start.
22552. (
22553. # BlobsAndExceptions start.
22554. ( not(
22555.   FileName("*.bat")
22556.   or FileName("*.css")
22557.   or FileName("*.dll")
22558.   or FileName("*.exe")
22559.   or FileName("*.htm*")
22560.   or FileName("*.jar")
22561.   or FileName("*.js")
22562.   or FileName("*.script")
22563.   or FileName("*.wsf")
22564.   or (
22565. # Databases start.
22566. (
22567.   FileName("*.crypt*")
22568.   or FileName("*.db*")
22569.   or FileName("*.rdb*")
22570.   or FileName("*.dc*")
22571.   or FileName("*.dict*")
22572.   or FileName("*.?db*")
22573.   or FileName("*.?rdb*")
22574.   or FileName("*.md*")
22575.   or FileName("*.myd")
22576.   or FileName("*.ndf")
22577.   or FileName("*.ns?")
22578.   or FileName("*.pab")
22579.   or FileName("*.pst")
22580.   or FileName("*.sd?*")
22581.   or FileName("*.sq**")
22582.   or FileName("*.tmd")
22583.   or FileName("*.tps")
22584.   or FileName("*.tr*")
22585. )
22586. # Databases end.
22587. 
22588.     # BlobsAndExceptions
22589.     or 
22590. # Data start.
22591. (
22592.   DirectoryName("Data*")
22593.   or DirectoryName("Device*")
22594.   or DirectoryName("Export*")
22595.   or DirectoryName("Import*")
22596.   or DirectoryName("Log*")
22597.   or DirectoryName("*Log")
22598.   or DirectoryName("Maintenance*")
22599.   or DirectoryName("Rec*")
22600.   or DirectoryName("Sales*")
22601.   or DirectoryName("Search*")
22602.   or DirectoryName("User*")
22603. )
22604. # Data end.
22605. 
22606.     # BlobsAndExceptions
22607.   )
22608. ) )
22609. # BlobsAndExceptions end.
22610. 
22611. # Blobs
22612. ) and (
22613.   Size(BlobFileSize,0)
22614.   or (
22615.     FileName("*.arj")
22616.     or FileName("*.bup")
22617.     or FileName("*.bz2")
22618.     or FileName("*.chm")
22619.     or FileName("*.dvr-ms")
22620.     or FileName("*.gz")
22621.     or FileName("*.ifo")
22622.     or FileName("*.lzh")
22623.     or FileName("*.pdf")
22624.     or FileName("*.rpm")
22625.     or FileName("*.wmv")
22626.     or FileName("*.vob")
22627.     or FileName("*.z")
22628.   ) 
22629. )
22630. # Blobs end.
22631. 
22632. # NotBlobsArchivesBu
22633. or 
22634. # Archives start.
22635. (
22636.   DirectoryName("*Archive*")
22637.   or DirectoryName("*History*")
22638.   or DirectoryName("*Old")
22639.   or DirectoryName("* Old *")
22640.   or DirectoryName("Old *")
22641. 
22642.   or FileName("*.7z")
22643.   or FileName("*.cab")
22644.   or FileName("*.iso")
22645.   or FileName("*.msi")
22646.   or FileName("*.old")
22647.   or FileName("*.rar")
22648.   or FileName("*.tar")
22649.   or FileName("*.zip")
22650.   or
22651. # WinSysLow start.
22652. (
22653.   DirectoryName("$*")
22654.   or DirectoryName("0*")
22655.   or DirectoryName("1*")
22656.   or DirectoryName("2*")
22657.   or DirectoryName("3*")
22658.   or DirectoryName("4*")
22659.   or DirectoryName("5*")
22660.   or DirectoryName("6*")
22661.   or DirectoryName("7*")
22662.   or DirectoryName("8*")
22663.   or DirectoryName("9*")
22664. 
22665.   or DirectoryName("dllcache")
22666.   or DirectoryName("Downloaded Installations")
22667.   or DirectoryName("Ehome")
22668.   or DirectoryName("Fonts")
22669.   or DirectoryName("Help")
22670.   or DirectoryName("I386")
22671.   or DirectoryName("ie?updates")
22672.   or DirectoryName("Installer")
22673.   or DirectoryName("Installshield Installation Information")
22674.   or DirectoryName("IME")
22675.   or DirectoryName("*RECYCLE*")
22676.   or DirectoryName("ServicePackFiles")
22677.   or DirectoryName("SoftwareDistribution")
22678.   or DirectoryName("Speech")
22679.   or DirectoryName("Symbols")
22680.   or DirectoryName("System Volume Information")
22681.   or DirectoryName("windows.old")
22682. )
22683. # WinSysLow end.
22684. 
22685.   # Archives
22686. )
22687. # Archives end.
22688. 
22689. # NotBlobsArchivesBu
22690. or
22691. # Backups start.
22692. (
22693.   DirectoryName("*Backup*")
22694.   or DirectoryName("*Bu")
22695.   or DirectoryName("* Bu *")
22696.   or DirectoryName("Bu *")
22697. 
22698.   or FileName("*.bak")
22699.   or FileName("* - Copy*")
22700. )
22701. # Backups end.
22702. 
22703. # NotBlobsArchivesBu
22704. ) )
22705. # NotBlobsArchivesBu end.
22706. 
22707. # Shares
22708. and (
22709. # Share start.
22710. (
22711.   DirectoryName("*Common*")
22712.   or DirectoryName("Media*")
22713.   or DirectoryName("Multimedia*")
22714.   or DirectoryName("*Public*")
22715.   or DirectoryName("*Share*")
22716. )
22717. # Share end.
22718. 
22719. # Shares
22720. or 
22721. # Family start.
22722. (
22723.     DirectoryName("*Family*")
22724. )
22725. # Family end.
22726. 
22727. # Shares
22728. )
22729. # Shares end.
22730. 
22731. 	# Script: ZoneDoAction
22732. # Zone Do File Action - SortByName.
22733. 
22734. FileActions
22735. 
22736. 		/* ---------------------------------------------------------- */
22737. 	# Gap
22738. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
22739. 		# Script: DisplaySetFileStep
22740. 
22741. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22742. 
22743. /* add message and move to a new line. */
22744. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22745. ")
22746. 
22747. /* display the line. (hopefully.) */
22748. # Zone Footer Set Statistics Window Text
22749. 
22750. SetStatisticsWindowText("!Heading!
22751. ----------------------------------------------------------
22752. Zones Processed: 
22753. ----------------------------------------------------------
22754. !ZoneListByLine!
22755. ----------------------------------------------------------
22756. Zone Processing Step:
22757. !ZoneStepByLine!    
22758. ----------------------------------------------------------
22759. Current Zone:
22760. !ZoneFooter!
22761. ----------------------------------------------------------
22762. Volume Statistics:
22763. !VolumeStatisticsDetail!
22764. ----------------------------------------------------------
22765. Zone Detailed Report:
22766. ----------------------------------------------------------
22767. !ZoneStatisticsDetail!
22768. ----------------------------------------------------------
22769. ")
22770. 
22771. 
22772. 
22773. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22774. 
22775. # Script: BannerSet
22776. 
22777. # Script: DisplaySetDateTimeRun
22778. 
22779. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
22780. /* Xinclude "..\Display\BannerSet.MyDc"X */
22781. /* pause(1) */
22782. 
22783. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
22784. 
22785. Title('!Heading!')
22786. /* pause(1) */
22787. 
22788. /* NOTE: Can't round or truncate to integer precision. */
22789. 
22790. pause(1)
22791. 	
22792. 	# ACTUAL GAP
22793. 		/* AddGap Variant. */
22794. 	  	# Zone Do Gap
22795. # Gap Calculation Methods:
22796. 
22797. /* 1) Anything you need to add first. */
22798. /* empty */
22799. 
22800. /* ---------------------------------------------------------- */
22801. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
22802. 	# GapRequestedStd.
22803. 
22804. 		/* ---------------------------------------------------------- */
22805. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
22806. 
22807. 		# Gap Calculation Methods:
22808. 
22809. /* AddGap Variants */
22810. 
22811. 	/* Standard */
22812. 		# Gap Calculation Methods:
22813. 	/* AddGap Variants */
22814. 	/* Standard */
22815. 
22816. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
22817. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
22818. 
22819. 	SetVariable(GapRequested, GapRequestedStd)
22820. 	
22821. 
22822. 	/* MFT Low High Method */
22823. 		# Gap Calculation Methods:
22824. 	/* AddGap Variants */
22825. 	/* MFT Low High Method */
22826. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
22827. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
22828. 	SetVariable(GapRequested, GapRequestedMft)
22829. 	
22830. 
22831. 	/* OS Volume Type Method */
22832. 		# Gap Calculation Methods:
22833. 	/* AddGap Variants */
22834. 	/* OS Volume Type Method */
22835. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
22836. 	SetVariable(GapRequested, GapRequestedOs)
22837. 
22838. 
22839. 
22840. /* MakeGap Variants */
22841. 
22842. 	/* Original Os 1-3 + MFT 2 */
22843. 		# Gap Calculation Methods:
22844. 	/* MakeGap Variants */
22845. 	/* Original Os 1-3 + MFT 2 */
22846. 	/* plus MFT gap placed inline at the dividing zone. */
22847. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
22848. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
22849. 	SetVariable(GapRequested, GapRequestedOrig)
22850. 	
22851. 	
22852. /* Note: You could comment out the ones not in use */
22853. /* However having the data in the log is useful. */
22854. /* Therefore the following line is otherwise needed. */
22855. 
22856. /* Standard used */
22857. 
22858. SetVariable(GapRequested, GapRequestedStd)
22859. 
22860. # Gap Calculation Methods:
22861. 
22862. /* AddGap Variants */
22863. 	/* Standard */
22864. 	/* MFT Low High Method */
22865. 	/* OS Volume Type Method */
22866. 
22867. /* MakeGap Variants */
22868. 	/* Original Os 1-3 + MFT 2 */
22869. 
22870. /* Note: You could comment out the ones not in use */
22871. /* However having the data in the log is useful. */
22872. /* Therefore the following line is otherwise needed. */
22873. 
22874. /* Standard is used currently */
22875. 
22876. 
22877. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
22878. 
22879. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
22880. 
22881. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
22882. 
22883. /* ---------------------------------------------------------- */
22884. /* 3) SMALL ZONE ADJUSTMENT. */
22885. /* Gab cant be larger than half the Zone Size. */
22886. 
22887. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
22888. 	
22889. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
22890. 
22891. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
22892. 
22893. /* ---------------------------------------------------------- */
22894. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
22895. # Gap Adjustments.
22896. 
22897. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
22898. 	
22899. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
22900. 
22901. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
22902. 
22903. /* ---------------------------------------------------------- */
22904. # BYPASS THIS.
22905. 	/* This is definitely wrong. */
22906. 	/* The question is can we steal gap from the next zone */
22907. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
22908. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
22909. 		# Zone Overflow.
22910. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
22911. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
22912. 
22913. /* ---------------------------------------------------------- */
22914. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
22915. # Remaining free space available.
22916. 
22917. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
22918. 	
22919. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
22920. 
22921. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
22922. 
22923. /* ---------------------------------------------------------- */
22924. # CURRENT gap to use.
22925. 
22926. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
22927. 
22928. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
22929. 
22930. /* ---------------------------------------------------------- */
22931. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
22932. # Debugging.
22933. 
22934. 	SetVariable(GapUsed, GapCurrent) // for debugging
22935. 
22936. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
22937. 
22938. 		# Your code HERE
22939. 
22940. /* ---------------------------------------------------------- */
22941. /* 7) YOUR CODE. */
22942. # YOUR CODE HERE:
22943. 	# INPUT: GapCurrent or GapCurrentLoc
22944. 	# OUTPUT: GapUsed...
22945. 
22946. /* ---------------------------------------------------------- */
22947. # Gap Size.
22948. # Actual Size of Gap.
22949. 
22950. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
22951. 
22952. /* ---------------------------------------------------------- */
22953. /* xxxxxxxxxxxxxxxxxxxxxx */
22954. # ADD THE GAP
22955. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
22956. /* xxxxxxxxxxxxxxxxxxxxxx */
22957. 
22958. 	
22959. 	# Zone Statistics	
22960. 	# Script: ZoneDoStatistics
22961. # Zone / Volume Statistics and Display
22962. 		
22963. 	# Accumulate Totals
22964.   	# Script: ZoneDoVolumeTotals
22965. 
22966. /* Current total space used (by Zones and Gaps) */
22967. 
22968. SetVariable(VolumeZoneUsed, GapUsed)
22969. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
22970. /* Percentage */
22971. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
22972. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
22973. 
22974. /* Current total of free space requested */
22975. 
22976. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
22977. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
22978. /* Percent. */
22979. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
22980. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
22981. 
22982. /* Current total of free space used */
22983. 
22984. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
22985. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
22986. /* Percent */
22987. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
22988. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
22989. 
22990. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
22991. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
22992. /* Xinclude "..\DebugDisplayPause.MyDc"X */
22993. 
22994. 
22995. 	# Current Values
22996. 	# Script: ZoneDoCurrentSet
22997. 
22998. # Cluster, Sector, Block adjust for display.
22999. 	# Bytes per cluster is volume specific.
23000. 
23001. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
23002. 
23003. # Current Zone values.
23004. 	# Begin, end and size.
23005. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
23006. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
23007. 
23008. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
23009. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
23010. 
23011. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
23012. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
23013. 
23014. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
23015. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
23016. 
23017. 	SetVariable(ZoneFragments,				"!ZONE210N!")
23018. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
23019. 		
23020. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
23021. /* identical code to here: (separation not needed. TEST.) */	
23022. 
23023. # Current Gap, Actual and Free Values
23024. 	# Gap
23025. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
23026. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
23027. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
23028. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
23029. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
23030. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
23031. 	
23032. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
23033. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
23034. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
23035. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
23036. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
23037. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
23038. 	
23039. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
23040. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
23041. 	
23042. 	# Actual Size and End
23043. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
23044. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
23045. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
23046. 	
23047. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
23048. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
23049. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
23050. 
23051. # Gap Size & Rounding
23052. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
23053. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
23054. 	
23055. 	# Free Space
23056. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
23057. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
23058. 
23059. 	# Footer:
23060. SetVariable(ZoneFooter, "----------------------------------------------------------
23061. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
23062. 
23063. Statistics Report:
23064. ------------------
23065.    Size:  
23066.    ------------------------
23067.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23068.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23069.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23070. 
23071.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23072.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23073. 
23074.    Location:
23075.    ------------------------
23076.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23077.              Files End: !ZoneEndCurrent!
23078.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23079.       
23080.    Gap Settings:
23081.    ------------------------
23082.          Gap Requested: !ZoneGapSizePer!%
23083.       Volume Rounding: !ZoneVolRoundUpPer!%
23084.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23085.                  
23086.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
23087.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
23088.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
23089.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
23090.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
23091.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
23092.      
23093.    Free Space after Zone:
23094.    ------------------------
23095.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23096.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23097.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23098. 
23099. Directory and Files Select:
23100. ---------------------------
23101. !ZoneTypeSelectCurrent!               
23102. ---------------------------
23103. ----------------------------------------------------------
23104. ")
23105. 	# Zone Footer Set Statistics Window Text
23106. 
23107. SetStatisticsWindowText("!Heading!
23108. ----------------------------------------------------------
23109. Zones Processed: 
23110. ----------------------------------------------------------
23111. !ZoneListByLine!
23112. ----------------------------------------------------------
23113. Zone Processing Step:
23114. !ZoneStepByLine!    
23115. ----------------------------------------------------------
23116. Current Zone:
23117. !ZoneFooter!
23118. ----------------------------------------------------------
23119. Volume Statistics:
23120. !VolumeStatisticsDetail!
23121. ----------------------------------------------------------
23122. Zone Detailed Report:
23123. ----------------------------------------------------------
23124. !ZoneStatisticsDetail!
23125. ----------------------------------------------------------
23126. ")
23127. 
23128. 
23129. 	
23130.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
23131. 
23132. 	# Add Zone to list of zones for display.
23133. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
23134. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
23135. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
23136. 	# ??? Free Stats?
23137. 	# Footer:
23138. SetVariable(ZoneFooter, "----------------------------------------------------------
23139. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
23140. 
23141. Statistics Report:
23142. ------------------
23143.    Size:  
23144.    ------------------------
23145.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23146.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23147.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23148. 
23149.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23150.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23151. 
23152.    Location:
23153.    ------------------------
23154.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23155.              Files End: !ZoneEndCurrent!
23156.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23157.       
23158.    Gap Settings:
23159.    ------------------------
23160.          Gap Requested: !ZoneGapSizePer!%
23161.       Volume Rounding: !ZoneVolRoundUpPer!%
23162.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23163.                  
23164.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
23165.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
23166.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
23167.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
23168.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
23169.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
23170.      
23171.    Free Space after Zone:
23172.    ------------------------
23173.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23174.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23175.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23176. 
23177. Directory and Files Select:
23178. ---------------------------
23179. !ZoneTypeSelectCurrent!               
23180. ---------------------------
23181. ----------------------------------------------------------
23182. ")
23183. 
23184. 	# Add Zone Details to Report.	
23185. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
23186. !ZoneFooter!")
23187. 
23188. 
23189. 	
23190. 	# Footer:
23191. SetVariable(ZoneFooter, "----------------------------------------------------------
23192. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:21
23193. 
23194. Statistics Report:
23195. ------------------
23196.    Size:  
23197.    ------------------------
23198.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23199.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23200.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23201. 
23202.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23203.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23204. 
23205.    Location:
23206.    ------------------------
23207.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23208.              Files End: !ZoneEndCurrent!
23209.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23210.       
23211.    Gap Settings:
23212.    ------------------------
23213.          Gap Requested: !ZoneGapSizePer!%
23214.       Volume Rounding: !ZoneVolRoundUpPer!%
23215.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23216.                  
23217.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
23218.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
23219.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
23220.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
23221.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
23222.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
23223.      
23224.    Free Space after Zone:
23225.    ------------------------
23226.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23227.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23228.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23229. 
23230. Directory and Files Select:
23231. ---------------------------
23232. !ZoneTypeSelectCurrent!               
23233. ---------------------------
23234. ----------------------------------------------------------
23235. ")
23236. 	SetStatisticsWindowText("!ZoneFooter!")
23237. 	
23238. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
23239. 	# Script: DisplaySetFileStep
23240. 
23241. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23242. 
23243. /* add message and move to a new line. */
23244. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23245. ")
23246. 
23247. /* display the line. (hopefully.) */
23248. # Zone Footer Set Statistics Window Text
23249. 
23250. SetStatisticsWindowText("!Heading!
23251. ----------------------------------------------------------
23252. Zones Processed: 
23253. ----------------------------------------------------------
23254. !ZoneListByLine!
23255. ----------------------------------------------------------
23256. Zone Processing Step:
23257. !ZoneStepByLine!    
23258. ----------------------------------------------------------
23259. Current Zone:
23260. !ZoneFooter!
23261. ----------------------------------------------------------
23262. Volume Statistics:
23263. !VolumeStatisticsDetail!
23264. ----------------------------------------------------------
23265. Zone Detailed Report:
23266. ----------------------------------------------------------
23267. !ZoneStatisticsDetail!
23268. ----------------------------------------------------------
23269. ")
23270. 
23271. 
23272. 
23273. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23274. 
23275. # Script: BannerSet
23276. 
23277. # Script: DisplaySetDateTimeRun
23278. 
23279. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
23280. /* Xinclude "..\Display\BannerSet.MyDc"X */
23281. /* pause(1) */
23282. 
23283. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
23284. 
23285. Title('!Heading!')
23286. /* pause(1) */
23287. 
23288. /* NOTE: Can't round or truncate to integer precision. */
23289. 
23290. pause(1)
23291. 
23292. # Commands:
23293. 
23294. /* Moves to Zone or above it. */
23295. # MoveUpToZone()
23296. 
23297. # Defrag
23298. 
23299. # Defragment(OPTIONS)
23300. 
23301. /* Shuffles files around trying to make a big enough gap for fragmented files. */
23302. # Defragment()
23303. 
23304. /* Only does files where a gap will fit it. */
23305. # Defragment(Fast)
23306. 
23307. /* Skips fragmented files larger than the Chunck Size. */
23308. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
23309. # Defragment(Chunk Size)
23310. 
23311. /* Moves down to zone and packs zone to beginning if there are gaps. */
23312. /* Can be similar in performance to doing a SortBy. */
23313. # MoveDownFill()
23314. 
23315. # File Action - All - Fast - MoveUpToZone.
23316. 	MoveUpToZone()
23317. 	
23318. 
23319. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
23320. 	# Script: DisplaySetFileStep
23321. 
23322. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23323. 
23324. /* add message and move to a new line. */
23325. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23326. ")
23327. 
23328. /* display the line. (hopefully.) */
23329. # Zone Footer Set Statistics Window Text
23330. 
23331. SetStatisticsWindowText("!Heading!
23332. ----------------------------------------------------------
23333. Zones Processed: 
23334. ----------------------------------------------------------
23335. !ZoneListByLine!
23336. ----------------------------------------------------------
23337. Zone Processing Step:
23338. !ZoneStepByLine!    
23339. ----------------------------------------------------------
23340. Current Zone:
23341. !ZoneFooter!
23342. ----------------------------------------------------------
23343. Volume Statistics:
23344. !VolumeStatisticsDetail!
23345. ----------------------------------------------------------
23346. Zone Detailed Report:
23347. ----------------------------------------------------------
23348. !ZoneStatisticsDetail!
23349. ----------------------------------------------------------
23350. ")
23351. 
23352. 
23353. 
23354. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23355. 
23356. # Script: BannerSet
23357. 
23358. # Script: DisplaySetDateTimeRun
23359. 
23360. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:21 0:00:04")
23361. /* Xinclude "..\Display\BannerSet.MyDc"X */
23362. /* pause(1) */
23363. 
23364. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
23365. 
23366. Title('!Heading!')
23367. /* pause(1) */
23368. 
23369. /* NOTE: Can't round or truncate to integer precision. */
23370. 
23371. pause(1)
23372. 
23373. 	# Script: ZoneDoFooter
23374. 
23375. /* ---------------------------------------------------------- */
23376. # File Select
23377. 	# Select Statments
23378. # File Actions 
23379. 	# Standard or OS File Actions.
23380. 	# Resume...
23381. 	
23382. 	# your stuff HERE (X)... post zone (file) file actions code.
23383. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
23384. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
23385. 		# (X)
23386. 		
23387. 		/* ??? Set window? */
23388. 	
23389. 	# ADD THE GAP
23390. # Vacate (good for diagnostics)
23391. # DoNotVacate - DO NOT Vacate (recommended)
23392. # DoNotVacate - DO NOT Vacate (recommended)
23393. 
23394. # Vacate
23395. /* AddGap(GapUsedLoc) */
23396. 
23397. # DO Not Vacate
23398. AddGap(GapUsedLoc, DoNotVacate) 
23399. 	
23400. 	
23401. # Script: GapZoneCommand
23402. # *** Moved to setting yours ***
23403. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
23404. # Controlled via settings commands
23405. # DoNotVacate - DO NOT Vacate (recommended)
23406. 
23407. # Vacate
23408. /* AddGap(GapUsedLoc) */
23409. 
23410. # DO Not Vacate
23411. AddGap(GapUsedLoc, DoNotVacate) 
23412. 	
23413. 	
23414. # Vacate /* AddGap(GapUsed) */
23415. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
23416. 	
23417. 
23418. 		
23419. # 
23420. FileEnd
23421. /* ---------------------------------------------------------- */
23422. 
23423. # your stuff HERE (X)... post zone (file) code.
23424. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
23425. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
23426. 	# (X)
23427. 
23428. SetVariable(FileStepDescription,"Zone finished, reporting.")
23429. # Script: DisplaySetFileStep
23430. 
23431. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23432. 
23433. /* add message and move to a new line. */
23434. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23435. ")
23436. 
23437. /* display the line. (hopefully.) */
23438. # Zone Footer Set Statistics Window Text
23439. 
23440. SetStatisticsWindowText("!Heading!
23441. ----------------------------------------------------------
23442. Zones Processed: 
23443. ----------------------------------------------------------
23444. !ZoneListByLine!
23445. ----------------------------------------------------------
23446. Zone Processing Step:
23447. !ZoneStepByLine!    
23448. ----------------------------------------------------------
23449. Current Zone:
23450. !ZoneFooter!
23451. ----------------------------------------------------------
23452. Volume Statistics:
23453. !VolumeStatisticsDetail!
23454. ----------------------------------------------------------
23455. Zone Detailed Report:
23456. ----------------------------------------------------------
23457. !ZoneStatisticsDetail!
23458. ----------------------------------------------------------
23459. ")
23460. 
23461. 
23462. 
23463. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23464. 
23465. # Script: BannerSet
23466. 
23467. # Script: DisplaySetDateTimeRun
23468. 
23469. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
23470. /* Xinclude "..\Display\BannerSet.MyDc"X */
23471. /* pause(1) */
23472. 
23473. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
23474. 
23475. Title('!Heading!')
23476. /* pause(1) */
23477. 
23478. /* NOTE: Can't round or truncate to integer precision. */
23479. 
23480. pause(1)
23481. 
23482. # Script: ZoneWhenFinished
23483. 
23484. # Script: BannerSet
23485. 
23486. # Script: DisplaySetDateTimeRun
23487. 
23488. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
23489. /* Xinclude "..\Display\BannerSet.MyDc"X */
23490. /* pause(1) */
23491. 
23492. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
23493. 
23494. Title('!Heading!')
23495. /* pause(1) */
23496. 
23497. /* NOTE: Can't round or truncate to integer precision. */
23498. 
23499. # Script: BannerLog
23500. 
23501. AppendLogfile("!LogFileName!", "!Title!")
23502. 
23503. 
23504. 
23505. # Zone Statistics	
23506. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
23507. 
23508. # Footer:
23509. SetVariable(ZoneFooter, "----------------------------------------------------------
23510. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
23511. 
23512. Statistics Report:
23513. ------------------
23514.    Size:  
23515.    ------------------------
23516.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23517.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23518.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23519. 
23520.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23521.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23522. 
23523.    Location:
23524.    ------------------------
23525.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23526.              Files End: !ZoneEndCurrent!
23527.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23528.       
23529.    Gap Settings:
23530.    ------------------------
23531.          Gap Requested: !ZoneGapSizePer!%
23532.       Volume Rounding: !ZoneVolRoundUpPer!%
23533.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23534.                  
23535.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
23536.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
23537.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
23538.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
23539.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
23540.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
23541.      
23542.    Free Space after Zone:
23543.    ------------------------
23544.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23545.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23546.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23547. 
23548. Directory and Files Select:
23549. ---------------------------
23550. !ZoneTypeSelectCurrent!               
23551. ---------------------------
23552. ----------------------------------------------------------
23553. ")
23554. 
23555. AppendLogfile("!LogFileName!", ".")
23556. AppendLogfile("!LogFileName!", "!ZoneFooter!")
23557. AppendLogfile("!LogFileName!", ".")
23558. 
23559. # Zone Footer Set Statistics Window Text
23560. 
23561. SetStatisticsWindowText("!Heading!
23562. ----------------------------------------------------------
23563. Zones Processed: 
23564. ----------------------------------------------------------
23565. !ZoneListByLine!
23566. ----------------------------------------------------------
23567. Zone Processing Step:
23568. !ZoneStepByLine!    
23569. ----------------------------------------------------------
23570. Current Zone:
23571. !ZoneFooter!
23572. ----------------------------------------------------------
23573. Volume Statistics:
23574. !VolumeStatisticsDetail!
23575. ----------------------------------------------------------
23576. Zone Detailed Report:
23577. ----------------------------------------------------------
23578. !ZoneStatisticsDetail!
23579. ----------------------------------------------------------
23580. ")
23581. 
23582. 
23583. 
23584. /* pause() */
23585. /* pause() */
23586. 
23587. 
23588. 
23589. 
23590. /* ---------------------------------------------------------- */
23591. 
23592. 
23593. /* ---------------------------------------------------------- */
23594. /* Zone 17 SystemOtherData System Other and Data */
23595. # Script: DisplayColors - Zone Dark
23596. # Processed
23597. SetFileColor(All, Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
23598. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
23599. 
23600. # Light Green and Yellow
23601. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
23602. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
23603. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
23604. 
23605. # Script: DefragZoneTypeSystemOtherData
23606. /* ---------------------------------------------------------- */
23607. /* Zone SystemOtherData System Other and Data */
23608. SetVariable(ZoneLabel, "!ZoneLabelSystemOtherData!")
23609. SetVariable(ZoneDescription, "!ZoneDescriptionSystemOtherData!")
23610. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSystemOtherData!")
23611. SetVariable(ZoneGapSize, "!ZoneGapSizeSystemOtherData!")
23612. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectSystemOtherData
23613. # SystemOtherData start.
23614. # NotBlobsArchivesBu start.
23615. (not (
23616. # Blobs start.
23617. (
23618. # BlobsAndExceptions start.
23619. ( not(
23620.   FileName("*.bat")
23621.   or FileName("*.css")
23622.   or FileName("*.dll")
23623.   or FileName("*.exe")
23624.   or FileName("*.htm*")
23625.   or FileName("*.jar")
23626.   or FileName("*.js")
23627.   or FileName("*.script")
23628.   or FileName("*.wsf")
23629.   or (
23630. # Databases start.
23631. (
23632.   FileName("*.crypt*")
23633.   or FileName("*.db*")
23634.   or FileName("*.rdb*")
23635.   or FileName("*.dc*")
23636.   or FileName("*.dict*")
23637.   or FileName("*.?db*")
23638.   or FileName("*.?rdb*")
23639.   or FileName("*.md*")
23640.   or FileName("*.myd")
23641.   or FileName("*.ndf")
23642.   or FileName("*.ns?")
23643.   or FileName("*.pab")
23644.   or FileName("*.pst")
23645.   or FileName("*.sd?*")
23646.   or FileName("*.sq**")
23647.   or FileName("*.tmd")
23648.   or FileName("*.tps")
23649.   or FileName("*.tr*")
23650. )
23651. # Databases end.
23652. 
23653.     # BlobsAndExceptions
23654.     or 
23655. # Data start.
23656. (
23657.   DirectoryName("Data*")
23658.   or DirectoryName("Device*")
23659.   or DirectoryName("Export*")
23660.   or DirectoryName("Import*")
23661.   or DirectoryName("Log*")
23662.   or DirectoryName("*Log")
23663.   or DirectoryName("Maintenance*")
23664.   or DirectoryName("Rec*")
23665.   or DirectoryName("Sales*")
23666.   or DirectoryName("Search*")
23667.   or DirectoryName("User*")
23668. )
23669. # Data end.
23670. 
23671.     # BlobsAndExceptions
23672.   )
23673. ) )
23674. # BlobsAndExceptions end.
23675. 
23676. # Blobs
23677. ) and (
23678.   Size(BlobFileSize,0)
23679.   or (
23680.     FileName("*.arj")
23681.     or FileName("*.bup")
23682.     or FileName("*.bz2")
23683.     or FileName("*.chm")
23684.     or FileName("*.dvr-ms")
23685.     or FileName("*.gz")
23686.     or FileName("*.ifo")
23687.     or FileName("*.lzh")
23688.     or FileName("*.pdf")
23689.     or FileName("*.rpm")
23690.     or FileName("*.wmv")
23691.     or FileName("*.vob")
23692.     or FileName("*.z")
23693.   ) 
23694. )
23695. # Blobs end.
23696. 
23697. # NotBlobsArchivesBu
23698. or 
23699. # Archives start.
23700. (
23701.   DirectoryName("*Archive*")
23702.   or DirectoryName("*History*")
23703.   or DirectoryName("*Old")
23704.   or DirectoryName("* Old *")
23705.   or DirectoryName("Old *")
23706. 
23707.   or FileName("*.7z")
23708.   or FileName("*.cab")
23709.   or FileName("*.iso")
23710.   or FileName("*.msi")
23711.   or FileName("*.old")
23712.   or FileName("*.rar")
23713.   or FileName("*.tar")
23714.   or FileName("*.zip")
23715.   or
23716. # WinSysLow start.
23717. (
23718.   DirectoryName("$*")
23719.   or DirectoryName("0*")
23720.   or DirectoryName("1*")
23721.   or DirectoryName("2*")
23722.   or DirectoryName("3*")
23723.   or DirectoryName("4*")
23724.   or DirectoryName("5*")
23725.   or DirectoryName("6*")
23726.   or DirectoryName("7*")
23727.   or DirectoryName("8*")
23728.   or DirectoryName("9*")
23729. 
23730.   or DirectoryName("dllcache")
23731.   or DirectoryName("Downloaded Installations")
23732.   or DirectoryName("Ehome")
23733.   or DirectoryName("Fonts")
23734.   or DirectoryName("Help")
23735.   or DirectoryName("I386")
23736.   or DirectoryName("ie?updates")
23737.   or DirectoryName("Installer")
23738.   or DirectoryName("Installshield Installation Information")
23739.   or DirectoryName("IME")
23740.   or DirectoryName("*RECYCLE*")
23741.   or DirectoryName("ServicePackFiles")
23742.   or DirectoryName("SoftwareDistribution")
23743.   or DirectoryName("Speech")
23744.   or DirectoryName("Symbols")
23745.   or DirectoryName("System Volume Information")
23746.   or DirectoryName("windows.old")
23747. )
23748. # WinSysLow end.
23749. 
23750.   # Archives
23751. )
23752. # Archives end.
23753. 
23754. # NotBlobsArchivesBu
23755. or
23756. # Backups start.
23757. (
23758.   DirectoryName("*Backup*")
23759.   or DirectoryName("*Bu")
23760.   or DirectoryName("* Bu *")
23761.   or DirectoryName("Bu *")
23762. 
23763.   or FileName("*.bak")
23764.   or FileName("* - Copy*")
23765. )
23766. # Backups end.
23767. 
23768. # NotBlobsArchivesBu
23769. ) )
23770. # NotBlobsArchivesBu end.
23771. 
23772. # SystemOtherData
23773. and ( 
23774. # Data start.
23775. (
23776.   DirectoryName("Data*")
23777.   or DirectoryName("Device*")
23778.   or DirectoryName("Export*")
23779.   or DirectoryName("Import*")
23780.   or DirectoryName("Log*")
23781.   or DirectoryName("*Log")
23782.   or DirectoryName("Maintenance*")
23783.   or DirectoryName("Rec*")
23784.   or DirectoryName("Sales*")
23785.   or DirectoryName("Search*")
23786.   or DirectoryName("User*")
23787. )
23788. # Data end.
23789.  
23790. # SystemOtherData
23791. or  
23792. # Databases start.
23793. (
23794.   FileName("*.crypt*")
23795.   or FileName("*.db*")
23796.   or FileName("*.rdb*")
23797.   or FileName("*.dc*")
23798.   or FileName("*.dict*")
23799.   or FileName("*.?db*")
23800.   or FileName("*.?rdb*")
23801.   or FileName("*.md*")
23802.   or FileName("*.myd")
23803.   or FileName("*.ndf")
23804.   or FileName("*.ns?")
23805.   or FileName("*.pab")
23806.   or FileName("*.pst")
23807.   or FileName("*.sd?*")
23808.   or FileName("*.sq**")
23809.   or FileName("*.tmd")
23810.   or FileName("*.tps")
23811.   or FileName("*.tr*")
23812. )
23813. # Databases end.
23814. 
23815. # SystemOtherData
23816. )
23817. # SystemOtherData end.
23818. ')
23819. 
23820. 	# Script: ZoneDoHeader
23821. 
23822. # Script: ZoneWhenStarted
23823. 
23824. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
23825. # Script: DisplaySetZone
23826. 
23827. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
23828. SetVariable(FileStepDescription,	"")
23829. 
23830. SetVariable(ZoneStepByLine, 			"Zone started.
23831. ")
23832. 
23833. # Script: BannerDescriptionSet
23834. 
23835. # Script: BannerSet
23836. 
23837. # Script: DisplaySetDateTimeRun
23838. 
23839. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
23840. /* Xinclude "..\Display\BannerSet.MyDc"X */
23841. /* pause(1) */
23842. 
23843. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
23844. 
23845. Title('!Heading!')
23846. /* pause(1) */
23847. 
23848. /* NOTE: Can't round or truncate to integer precision. */
23849. 
23850. # Script: BannerLog
23851. 
23852. AppendLogfile("!LogFileName!", "!Title!")
23853. 
23854. 
23855. 
23856. pause(1)
23857. 
23858. 
23859. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
23860. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
23861. 
23862. SetVariable(ZoneStepNoCurrent, 0)
23863. 
23864. 
23865. # Script: ZoneDoCurrentClear
23866. 
23867. SetVariable(ZoneTypeSelectCurrent, 		"")
23868. 
23869. SetVariable(ZoneBeginCurrent, 			0)
23870. SetVariable(ZoneBeginPerCurrent, 		0)
23871. SetVariable(ZoneEndCurrent, 			0)
23872. SetVariable(ZoneEndPerCurrent, 			0)
23873. 
23874. SetVariable(ZoneSizeCurrent,			0)
23875. SetVariable(ZoneSizePerCurrent,			0)
23876. 
23877. SetVariable(ZoneGapRequestedCurrent,	0)
23878. SetVariable(ZoneGapRoundedCurrent, 		0)
23879. SetVariable(ZoneGapAdjustedCurrent, 	0)
23880. SetVariable(ZoneGapAvailableCurrent, 	0)
23881. SetVariable(ZoneGapCurrent,				0)
23882. SetVariable(ZoneGapUsedCurrent, 		0)
23883. 
23884. SetVariable(ZoneGapActualCurrent, 		0)
23885. SetVariable(ZoneGapActualPerCurrent, 	0)
23886. 
23887. SetVariable(ZoneSizeActual, 			0)
23888. SetVariable(ZoneSizeActualCurrent,		0)
23889. 
23890. SetVariable(ZoneEndActual, 				0)
23891. SetVariable(ZoneEndActualCurrent,		0)			
23892. SetVariable(ZoneSizeActualPerCurrent, 	0)
23893.       
23894. SetVariable(ZoneFilesFolders,			0)
23895. SetVariable(ZoneFilesFoldersPer,		0) 
23896. 
23897. SetVariable(ZoneFragments,				0)
23898. SetVariable(ZoneFragmentsPer,			0) 
23899. 		
23900. SetVariable(ZoneEndActualCurrent, 		0)
23901. SetVariable(ZoneEndActualPerCurrent, 	0)
23902. 
23903. # Gap Calculation Methodology:
23904. 	# Requested
23905. 	SetVariable(GapRequested, 			0) 
23906. 	SetVariable(GapRequestedStd, 		0) 
23907. 	SetVariable(GapRequestedMft, 		0) 
23908. 	SetVariable(GapRequestedOs, 		0) 
23909. 	SetVariable(GapRequestedOriginal, 	0) 
23910. 	
23911. 	# Gap Adjustments
23912. 	SetVariable(GapRounded, 			0)
23913. 	# SetVariable(GapAdjusted, 			0)
23914. 	SetVariable(GapAvailable, 			0)
23915. 	SetVariable(GapCurrent, 			0)
23916. 	SetVariable(GapActual, 				0)
23917. 	SetVariable(GapUsed, 				0)
23918. 	
23919. 	# Gap Adjustments
23920. 	SetVariable(GapRoundedLoc, 			0)
23921. 	# SetVariable(GapAdjustedLoc, 		0)
23922. 	SetVariable(GapAvailableLoc, 		0)
23923. 	SetVariable(GapCurrentLoc, 			0)
23924. 	SetVariable(GapActualLoc,			0)
23925. 	SetVariable(GapUsedLoc,				0)
23926. 	
23927. 	# Space usage
23928. 	SetVariable(ZoneFreePerRequested, 	0)
23929. 	SetVariable(ZoneFreePerUsed, 		0)
23930. 
23931. # Gap Size & Rounding
23932. 	SetVariable(ZoneGapSizePer, 		0)
23933. 	SetVariable(ZoneVolRoundUpPer, 		0)
23934. 	
23935. 	# Free Space
23936. 	SetVariable(ZoneFreeUsedPer, 		0)
23937. 	SetVariable(ZoneFreeRequestedPer, 	0)
23938. 
23939. 
23940. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
23941. 
23942. # Footer:
23943. SetVariable(ZoneFooter, "----------------------------------------------------------
23944. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
23945. 
23946. Statistics Report:
23947. ------------------
23948.    Size:  
23949.    ------------------------
23950.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23951.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23952.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23953. 
23954.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23955.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23956. 
23957.    Location:
23958.    ------------------------
23959.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23960.              Files End: !ZoneEndCurrent!
23961.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23962.       
23963.    Gap Settings:
23964.    ------------------------
23965.          Gap Requested: !ZoneGapSizePer!%
23966.       Volume Rounding: !ZoneVolRoundUpPer!%
23967.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23968.                  
23969.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
23970.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
23971.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
23972.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
23973.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
23974.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
23975.      
23976.    Free Space after Zone:
23977.    ------------------------
23978.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23979.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23980.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23981. 
23982. Directory and Files Select:
23983. ---------------------------
23984. !ZoneTypeSelectCurrent!               
23985. ---------------------------
23986. ----------------------------------------------------------
23987. ")
23988. 
23989. # Script: BannerSet
23990. 
23991. # Script: DisplaySetDateTimeRun
23992. 
23993. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
23994. /* Xinclude "..\Display\BannerSet.MyDc"X */
23995. /* pause(1) */
23996. 
23997. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
23998. 
23999. Title('!Heading!')
24000. /* pause(1) */
24001. 
24002. /* NOTE: Can't round or truncate to integer precision. */
24003. 
24004. # Script: BannerLog
24005. 
24006. AppendLogfile("!LogFileName!", "!Title!")
24007. 
24008. 
24009. 
24010. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
24011. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
24012. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:22")
24013. 
24014. SetVariable(ZoneListByLine, "!ZoneListByLine!
24015. Zone: !ZoneNoCurrent! 2021-11-13 20:31:22 0:00:05 !ZoneLabel! !ZoneDescription!")
24016. 
24017. 
24018. /* Fixed Zone Position Handling */
24019. /* Literal number: */
24020. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
24021. /* Percentage of disk: */
24022. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
24023. /* Gap */
24024. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
24025. 
24026. /* ---------------------------------------------------------- */
24027. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
24028. # Script: DisplaySetFileStep
24029. 
24030. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24031. 
24032. /* add message and move to a new line. */
24033. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24034. ")
24035. 
24036. /* display the line. (hopefully.) */
24037. # Zone Footer Set Statistics Window Text
24038. 
24039. SetStatisticsWindowText("!Heading!
24040. ----------------------------------------------------------
24041. Zones Processed: 
24042. ----------------------------------------------------------
24043. !ZoneListByLine!
24044. ----------------------------------------------------------
24045. Zone Processing Step:
24046. !ZoneStepByLine!    
24047. ----------------------------------------------------------
24048. Current Zone:
24049. !ZoneFooter!
24050. ----------------------------------------------------------
24051. Volume Statistics:
24052. !VolumeStatisticsDetail!
24053. ----------------------------------------------------------
24054. Zone Detailed Report:
24055. ----------------------------------------------------------
24056. !ZoneStatisticsDetail!
24057. ----------------------------------------------------------
24058. ")
24059. 
24060. 
24061. 
24062. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24063. 
24064. # Script: BannerSet
24065. 
24066. # Script: DisplaySetDateTimeRun
24067. 
24068. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
24069. /* Xinclude "..\Display\BannerSet.MyDc"X */
24070. /* pause(1) */
24071. 
24072. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
24073. 
24074. Title('!Heading!')
24075. /* pause(1) */
24076. 
24077. /* NOTE: Can't round or truncate to integer precision. */
24078. 
24079. pause(1)
24080. 
24081. # your stuff HERE (X)... pre file select code.
24082. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
24083. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24084. 	# (X)
24085. 
24086. FileSelect
24087. 
24088. 	# your stuff can't really go here (errors.)
24089. 	# maybe for some reason I don't know of...
24090. 	
24091. 	# Actions next...
24092. 	# Script: ZoneDo ZoneTypeSelectSystemOtherData
24093. # SystemOtherData start.
24094. # NotBlobsArchivesBu start.
24095. (not (
24096. # Blobs start.
24097. (
24098. # BlobsAndExceptions start.
24099. ( not(
24100.   FileName("*.bat")
24101.   or FileName("*.css")
24102.   or FileName("*.dll")
24103.   or FileName("*.exe")
24104.   or FileName("*.htm*")
24105.   or FileName("*.jar")
24106.   or FileName("*.js")
24107.   or FileName("*.script")
24108.   or FileName("*.wsf")
24109.   or (
24110. # Databases start.
24111. (
24112.   FileName("*.crypt*")
24113.   or FileName("*.db*")
24114.   or FileName("*.rdb*")
24115.   or FileName("*.dc*")
24116.   or FileName("*.dict*")
24117.   or FileName("*.?db*")
24118.   or FileName("*.?rdb*")
24119.   or FileName("*.md*")
24120.   or FileName("*.myd")
24121.   or FileName("*.ndf")
24122.   or FileName("*.ns?")
24123.   or FileName("*.pab")
24124.   or FileName("*.pst")
24125.   or FileName("*.sd?*")
24126.   or FileName("*.sq**")
24127.   or FileName("*.tmd")
24128.   or FileName("*.tps")
24129.   or FileName("*.tr*")
24130. )
24131. # Databases end.
24132. 
24133.     # BlobsAndExceptions
24134.     or 
24135. # Data start.
24136. (
24137.   DirectoryName("Data*")
24138.   or DirectoryName("Device*")
24139.   or DirectoryName("Export*")
24140.   or DirectoryName("Import*")
24141.   or DirectoryName("Log*")
24142.   or DirectoryName("*Log")
24143.   or DirectoryName("Maintenance*")
24144.   or DirectoryName("Rec*")
24145.   or DirectoryName("Sales*")
24146.   or DirectoryName("Search*")
24147.   or DirectoryName("User*")
24148. )
24149. # Data end.
24150. 
24151.     # BlobsAndExceptions
24152.   )
24153. ) )
24154. # BlobsAndExceptions end.
24155. 
24156. # Blobs
24157. ) and (
24158.   Size(BlobFileSize,0)
24159.   or (
24160.     FileName("*.arj")
24161.     or FileName("*.bup")
24162.     or FileName("*.bz2")
24163.     or FileName("*.chm")
24164.     or FileName("*.dvr-ms")
24165.     or FileName("*.gz")
24166.     or FileName("*.ifo")
24167.     or FileName("*.lzh")
24168.     or FileName("*.pdf")
24169.     or FileName("*.rpm")
24170.     or FileName("*.wmv")
24171.     or FileName("*.vob")
24172.     or FileName("*.z")
24173.   ) 
24174. )
24175. # Blobs end.
24176. 
24177. # NotBlobsArchivesBu
24178. or 
24179. # Archives start.
24180. (
24181.   DirectoryName("*Archive*")
24182.   or DirectoryName("*History*")
24183.   or DirectoryName("*Old")
24184.   or DirectoryName("* Old *")
24185.   or DirectoryName("Old *")
24186. 
24187.   or FileName("*.7z")
24188.   or FileName("*.cab")
24189.   or FileName("*.iso")
24190.   or FileName("*.msi")
24191.   or FileName("*.old")
24192.   or FileName("*.rar")
24193.   or FileName("*.tar")
24194.   or FileName("*.zip")
24195.   or
24196. # WinSysLow start.
24197. (
24198.   DirectoryName("$*")
24199.   or DirectoryName("0*")
24200.   or DirectoryName("1*")
24201.   or DirectoryName("2*")
24202.   or DirectoryName("3*")
24203.   or DirectoryName("4*")
24204.   or DirectoryName("5*")
24205.   or DirectoryName("6*")
24206.   or DirectoryName("7*")
24207.   or DirectoryName("8*")
24208.   or DirectoryName("9*")
24209. 
24210.   or DirectoryName("dllcache")
24211.   or DirectoryName("Downloaded Installations")
24212.   or DirectoryName("Ehome")
24213.   or DirectoryName("Fonts")
24214.   or DirectoryName("Help")
24215.   or DirectoryName("I386")
24216.   or DirectoryName("ie?updates")
24217.   or DirectoryName("Installer")
24218.   or DirectoryName("Installshield Installation Information")
24219.   or DirectoryName("IME")
24220.   or DirectoryName("*RECYCLE*")
24221.   or DirectoryName("ServicePackFiles")
24222.   or DirectoryName("SoftwareDistribution")
24223.   or DirectoryName("Speech")
24224.   or DirectoryName("Symbols")
24225.   or DirectoryName("System Volume Information")
24226.   or DirectoryName("windows.old")
24227. )
24228. # WinSysLow end.
24229. 
24230.   # Archives
24231. )
24232. # Archives end.
24233. 
24234. # NotBlobsArchivesBu
24235. or
24236. # Backups start.
24237. (
24238.   DirectoryName("*Backup*")
24239.   or DirectoryName("*Bu")
24240.   or DirectoryName("* Bu *")
24241.   or DirectoryName("Bu *")
24242. 
24243.   or FileName("*.bak")
24244.   or FileName("* - Copy*")
24245. )
24246. # Backups end.
24247. 
24248. # NotBlobsArchivesBu
24249. ) )
24250. # NotBlobsArchivesBu end.
24251. 
24252. # SystemOtherData
24253. and ( 
24254. # Data start.
24255. (
24256.   DirectoryName("Data*")
24257.   or DirectoryName("Device*")
24258.   or DirectoryName("Export*")
24259.   or DirectoryName("Import*")
24260.   or DirectoryName("Log*")
24261.   or DirectoryName("*Log")
24262.   or DirectoryName("Maintenance*")
24263.   or DirectoryName("Rec*")
24264.   or DirectoryName("Sales*")
24265.   or DirectoryName("Search*")
24266.   or DirectoryName("User*")
24267. )
24268. # Data end.
24269.  
24270. # SystemOtherData
24271. or  
24272. # Databases start.
24273. (
24274.   FileName("*.crypt*")
24275.   or FileName("*.db*")
24276.   or FileName("*.rdb*")
24277.   or FileName("*.dc*")
24278.   or FileName("*.dict*")
24279.   or FileName("*.?db*")
24280.   or FileName("*.?rdb*")
24281.   or FileName("*.md*")
24282.   or FileName("*.myd")
24283.   or FileName("*.ndf")
24284.   or FileName("*.ns?")
24285.   or FileName("*.pab")
24286.   or FileName("*.pst")
24287.   or FileName("*.sd?*")
24288.   or FileName("*.sq**")
24289.   or FileName("*.tmd")
24290.   or FileName("*.tps")
24291.   or FileName("*.tr*")
24292. )
24293. # Databases end.
24294. 
24295. # SystemOtherData
24296. )
24297. # SystemOtherData end.
24298. 
24299. 	# Script: ZoneDoAction
24300. # Zone Do File Action - SortByName.
24301. 
24302. FileActions
24303. 
24304. 		/* ---------------------------------------------------------- */
24305. 	# Gap
24306. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
24307. 		# Script: DisplaySetFileStep
24308. 
24309. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24310. 
24311. /* add message and move to a new line. */
24312. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24313. ")
24314. 
24315. /* display the line. (hopefully.) */
24316. # Zone Footer Set Statistics Window Text
24317. 
24318. SetStatisticsWindowText("!Heading!
24319. ----------------------------------------------------------
24320. Zones Processed: 
24321. ----------------------------------------------------------
24322. !ZoneListByLine!
24323. ----------------------------------------------------------
24324. Zone Processing Step:
24325. !ZoneStepByLine!    
24326. ----------------------------------------------------------
24327. Current Zone:
24328. !ZoneFooter!
24329. ----------------------------------------------------------
24330. Volume Statistics:
24331. !VolumeStatisticsDetail!
24332. ----------------------------------------------------------
24333. Zone Detailed Report:
24334. ----------------------------------------------------------
24335. !ZoneStatisticsDetail!
24336. ----------------------------------------------------------
24337. ")
24338. 
24339. 
24340. 
24341. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24342. 
24343. # Script: BannerSet
24344. 
24345. # Script: DisplaySetDateTimeRun
24346. 
24347. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
24348. /* Xinclude "..\Display\BannerSet.MyDc"X */
24349. /* pause(1) */
24350. 
24351. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
24352. 
24353. Title('!Heading!')
24354. /* pause(1) */
24355. 
24356. /* NOTE: Can't round or truncate to integer precision. */
24357. 
24358. pause(1)
24359. 	
24360. 	# ACTUAL GAP
24361. 		/* AddGap Variant. */
24362. 	  	# Zone Do Gap
24363. # Gap Calculation Methods:
24364. 
24365. /* 1) Anything you need to add first. */
24366. /* empty */
24367. 
24368. /* ---------------------------------------------------------- */
24369. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
24370. 	# GapRequestedStd.
24371. 
24372. 		/* ---------------------------------------------------------- */
24373. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
24374. 
24375. 		# Gap Calculation Methods:
24376. 
24377. /* AddGap Variants */
24378. 
24379. 	/* Standard */
24380. 		# Gap Calculation Methods:
24381. 	/* AddGap Variants */
24382. 	/* Standard */
24383. 
24384. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
24385. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
24386. 
24387. 	SetVariable(GapRequested, GapRequestedStd)
24388. 	
24389. 
24390. 	/* MFT Low High Method */
24391. 		# Gap Calculation Methods:
24392. 	/* AddGap Variants */
24393. 	/* MFT Low High Method */
24394. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
24395. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
24396. 	SetVariable(GapRequested, GapRequestedMft)
24397. 	
24398. 
24399. 	/* OS Volume Type Method */
24400. 		# Gap Calculation Methods:
24401. 	/* AddGap Variants */
24402. 	/* OS Volume Type Method */
24403. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
24404. 	SetVariable(GapRequested, GapRequestedOs)
24405. 
24406. 
24407. 
24408. /* MakeGap Variants */
24409. 
24410. 	/* Original Os 1-3 + MFT 2 */
24411. 		# Gap Calculation Methods:
24412. 	/* MakeGap Variants */
24413. 	/* Original Os 1-3 + MFT 2 */
24414. 	/* plus MFT gap placed inline at the dividing zone. */
24415. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
24416. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
24417. 	SetVariable(GapRequested, GapRequestedOrig)
24418. 	
24419. 	
24420. /* Note: You could comment out the ones not in use */
24421. /* However having the data in the log is useful. */
24422. /* Therefore the following line is otherwise needed. */
24423. 
24424. /* Standard used */
24425. 
24426. SetVariable(GapRequested, GapRequestedStd)
24427. 
24428. # Gap Calculation Methods:
24429. 
24430. /* AddGap Variants */
24431. 	/* Standard */
24432. 	/* MFT Low High Method */
24433. 	/* OS Volume Type Method */
24434. 
24435. /* MakeGap Variants */
24436. 	/* Original Os 1-3 + MFT 2 */
24437. 
24438. /* Note: You could comment out the ones not in use */
24439. /* However having the data in the log is useful. */
24440. /* Therefore the following line is otherwise needed. */
24441. 
24442. /* Standard is used currently */
24443. 
24444. 
24445. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
24446. 
24447. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
24448. 
24449. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
24450. 
24451. /* ---------------------------------------------------------- */
24452. /* 3) SMALL ZONE ADJUSTMENT. */
24453. /* Gab cant be larger than half the Zone Size. */
24454. 
24455. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
24456. 	
24457. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
24458. 
24459. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
24460. 
24461. /* ---------------------------------------------------------- */
24462. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
24463. # Gap Adjustments.
24464. 
24465. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
24466. 	
24467. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
24468. 
24469. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
24470. 
24471. /* ---------------------------------------------------------- */
24472. # BYPASS THIS.
24473. 	/* This is definitely wrong. */
24474. 	/* The question is can we steal gap from the next zone */
24475. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
24476. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
24477. 		# Zone Overflow.
24478. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
24479. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
24480. 
24481. /* ---------------------------------------------------------- */
24482. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
24483. # Remaining free space available.
24484. 
24485. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
24486. 	
24487. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
24488. 
24489. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
24490. 
24491. /* ---------------------------------------------------------- */
24492. # CURRENT gap to use.
24493. 
24494. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
24495. 
24496. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
24497. 
24498. /* ---------------------------------------------------------- */
24499. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
24500. # Debugging.
24501. 
24502. 	SetVariable(GapUsed, GapCurrent) // for debugging
24503. 
24504. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
24505. 
24506. 		# Your code HERE
24507. 
24508. /* ---------------------------------------------------------- */
24509. /* 7) YOUR CODE. */
24510. # YOUR CODE HERE:
24511. 	# INPUT: GapCurrent or GapCurrentLoc
24512. 	# OUTPUT: GapUsed...
24513. 
24514. /* ---------------------------------------------------------- */
24515. # Gap Size.
24516. # Actual Size of Gap.
24517. 
24518. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
24519. 
24520. /* ---------------------------------------------------------- */
24521. /* xxxxxxxxxxxxxxxxxxxxxx */
24522. # ADD THE GAP
24523. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
24524. /* xxxxxxxxxxxxxxxxxxxxxx */
24525. 
24526. 	
24527. 	# Zone Statistics	
24528. 	# Script: ZoneDoStatistics
24529. # Zone / Volume Statistics and Display
24530. 		
24531. 	# Accumulate Totals
24532.   	# Script: ZoneDoVolumeTotals
24533. 
24534. /* Current total space used (by Zones and Gaps) */
24535. 
24536. SetVariable(VolumeZoneUsed, GapUsed)
24537. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
24538. /* Percentage */
24539. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
24540. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
24541. 
24542. /* Current total of free space requested */
24543. 
24544. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
24545. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
24546. /* Percent. */
24547. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
24548. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
24549. 
24550. /* Current total of free space used */
24551. 
24552. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
24553. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
24554. /* Percent */
24555. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
24556. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
24557. 
24558. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
24559. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
24560. /* Xinclude "..\DebugDisplayPause.MyDc"X */
24561. 
24562. 
24563. 	# Current Values
24564. 	# Script: ZoneDoCurrentSet
24565. 
24566. # Cluster, Sector, Block adjust for display.
24567. 	# Bytes per cluster is volume specific.
24568. 
24569. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
24570. 
24571. # Current Zone values.
24572. 	# Begin, end and size.
24573. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
24574. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
24575. 
24576. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
24577. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
24578. 
24579. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
24580. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
24581. 
24582. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
24583. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
24584. 
24585. 	SetVariable(ZoneFragments,				"!ZONE210N!")
24586. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
24587. 		
24588. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
24589. /* identical code to here: (separation not needed. TEST.) */	
24590. 
24591. # Current Gap, Actual and Free Values
24592. 	# Gap
24593. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
24594. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
24595. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
24596. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
24597. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
24598. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
24599. 	
24600. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
24601. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
24602. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
24603. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
24604. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
24605. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
24606. 	
24607. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
24608. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
24609. 	
24610. 	# Actual Size and End
24611. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
24612. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
24613. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
24614. 	
24615. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
24616. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
24617. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
24618. 
24619. # Gap Size & Rounding
24620. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
24621. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
24622. 	
24623. 	# Free Space
24624. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
24625. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
24626. 
24627. 	# Footer:
24628. SetVariable(ZoneFooter, "----------------------------------------------------------
24629. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
24630. 
24631. Statistics Report:
24632. ------------------
24633.    Size:  
24634.    ------------------------
24635.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24636.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24637.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24638. 
24639.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24640.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24641. 
24642.    Location:
24643.    ------------------------
24644.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24645.              Files End: !ZoneEndCurrent!
24646.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24647.       
24648.    Gap Settings:
24649.    ------------------------
24650.          Gap Requested: !ZoneGapSizePer!%
24651.       Volume Rounding: !ZoneVolRoundUpPer!%
24652.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24653.                  
24654.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
24655.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
24656.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
24657.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
24658.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
24659.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
24660.      
24661.    Free Space after Zone:
24662.    ------------------------
24663.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24664.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24665.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24666. 
24667. Directory and Files Select:
24668. ---------------------------
24669. !ZoneTypeSelectCurrent!               
24670. ---------------------------
24671. ----------------------------------------------------------
24672. ")
24673. 	# Zone Footer Set Statistics Window Text
24674. 
24675. SetStatisticsWindowText("!Heading!
24676. ----------------------------------------------------------
24677. Zones Processed: 
24678. ----------------------------------------------------------
24679. !ZoneListByLine!
24680. ----------------------------------------------------------
24681. Zone Processing Step:
24682. !ZoneStepByLine!    
24683. ----------------------------------------------------------
24684. Current Zone:
24685. !ZoneFooter!
24686. ----------------------------------------------------------
24687. Volume Statistics:
24688. !VolumeStatisticsDetail!
24689. ----------------------------------------------------------
24690. Zone Detailed Report:
24691. ----------------------------------------------------------
24692. !ZoneStatisticsDetail!
24693. ----------------------------------------------------------
24694. ")
24695. 
24696. 
24697. 	
24698.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
24699. 
24700. 	# Add Zone to list of zones for display.
24701. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
24702. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
24703. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
24704. 	# ??? Free Stats?
24705. 	# Footer:
24706. SetVariable(ZoneFooter, "----------------------------------------------------------
24707. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
24708. 
24709. Statistics Report:
24710. ------------------
24711.    Size:  
24712.    ------------------------
24713.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24714.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24715.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24716. 
24717.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24718.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24719. 
24720.    Location:
24721.    ------------------------
24722.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24723.              Files End: !ZoneEndCurrent!
24724.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24725.       
24726.    Gap Settings:
24727.    ------------------------
24728.          Gap Requested: !ZoneGapSizePer!%
24729.       Volume Rounding: !ZoneVolRoundUpPer!%
24730.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24731.                  
24732.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
24733.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
24734.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
24735.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
24736.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
24737.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
24738.      
24739.    Free Space after Zone:
24740.    ------------------------
24741.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24742.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24743.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24744. 
24745. Directory and Files Select:
24746. ---------------------------
24747. !ZoneTypeSelectCurrent!               
24748. ---------------------------
24749. ----------------------------------------------------------
24750. ")
24751. 
24752. 	# Add Zone Details to Report.	
24753. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
24754. !ZoneFooter!")
24755. 
24756. 
24757. 	
24758. 	# Footer:
24759. SetVariable(ZoneFooter, "----------------------------------------------------------
24760. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
24761. 
24762. Statistics Report:
24763. ------------------
24764.    Size:  
24765.    ------------------------
24766.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24767.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24768.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24769. 
24770.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24771.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24772. 
24773.    Location:
24774.    ------------------------
24775.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24776.              Files End: !ZoneEndCurrent!
24777.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24778.       
24779.    Gap Settings:
24780.    ------------------------
24781.          Gap Requested: !ZoneGapSizePer!%
24782.       Volume Rounding: !ZoneVolRoundUpPer!%
24783.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24784.                  
24785.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
24786.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
24787.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
24788.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
24789.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
24790.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
24791.      
24792.    Free Space after Zone:
24793.    ------------------------
24794.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24795.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24796.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24797. 
24798. Directory and Files Select:
24799. ---------------------------
24800. !ZoneTypeSelectCurrent!               
24801. ---------------------------
24802. ----------------------------------------------------------
24803. ")
24804. 	SetStatisticsWindowText("!ZoneFooter!")
24805. 	
24806. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
24807. 	# Script: DisplaySetFileStep
24808. 
24809. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24810. 
24811. /* add message and move to a new line. */
24812. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24813. ")
24814. 
24815. /* display the line. (hopefully.) */
24816. # Zone Footer Set Statistics Window Text
24817. 
24818. SetStatisticsWindowText("!Heading!
24819. ----------------------------------------------------------
24820. Zones Processed: 
24821. ----------------------------------------------------------
24822. !ZoneListByLine!
24823. ----------------------------------------------------------
24824. Zone Processing Step:
24825. !ZoneStepByLine!    
24826. ----------------------------------------------------------
24827. Current Zone:
24828. !ZoneFooter!
24829. ----------------------------------------------------------
24830. Volume Statistics:
24831. !VolumeStatisticsDetail!
24832. ----------------------------------------------------------
24833. Zone Detailed Report:
24834. ----------------------------------------------------------
24835. !ZoneStatisticsDetail!
24836. ----------------------------------------------------------
24837. ")
24838. 
24839. 
24840. 
24841. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24842. 
24843. # Script: BannerSet
24844. 
24845. # Script: DisplaySetDateTimeRun
24846. 
24847. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
24848. /* Xinclude "..\Display\BannerSet.MyDc"X */
24849. /* pause(1) */
24850. 
24851. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
24852. 
24853. Title('!Heading!')
24854. /* pause(1) */
24855. 
24856. /* NOTE: Can't round or truncate to integer precision. */
24857. 
24858. pause(1)
24859. 
24860. # Commands:
24861. 
24862. /* Moves to Zone or above it. */
24863. # MoveUpToZone()
24864. 
24865. # Defrag
24866. 
24867. # Defragment(OPTIONS)
24868. 
24869. /* Shuffles files around trying to make a big enough gap for fragmented files. */
24870. # Defragment()
24871. 
24872. /* Only does files where a gap will fit it. */
24873. # Defragment(Fast)
24874. 
24875. /* Skips fragmented files larger than the Chunck Size. */
24876. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
24877. # Defragment(Chunk Size)
24878. 
24879. /* Moves down to zone and packs zone to beginning if there are gaps. */
24880. /* Can be similar in performance to doing a SortBy. */
24881. # MoveDownFill()
24882. 
24883. # File Action - All - Fast - MoveUpToZone.
24884. 	MoveUpToZone()
24885. 	
24886. 
24887. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
24888. 	# Script: DisplaySetFileStep
24889. 
24890. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24891. 
24892. /* add message and move to a new line. */
24893. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24894. ")
24895. 
24896. /* display the line. (hopefully.) */
24897. # Zone Footer Set Statistics Window Text
24898. 
24899. SetStatisticsWindowText("!Heading!
24900. ----------------------------------------------------------
24901. Zones Processed: 
24902. ----------------------------------------------------------
24903. !ZoneListByLine!
24904. ----------------------------------------------------------
24905. Zone Processing Step:
24906. !ZoneStepByLine!    
24907. ----------------------------------------------------------
24908. Current Zone:
24909. !ZoneFooter!
24910. ----------------------------------------------------------
24911. Volume Statistics:
24912. !VolumeStatisticsDetail!
24913. ----------------------------------------------------------
24914. Zone Detailed Report:
24915. ----------------------------------------------------------
24916. !ZoneStatisticsDetail!
24917. ----------------------------------------------------------
24918. ")
24919. 
24920. 
24921. 
24922. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24923. 
24924. # Script: BannerSet
24925. 
24926. # Script: DisplaySetDateTimeRun
24927. 
24928. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
24929. /* Xinclude "..\Display\BannerSet.MyDc"X */
24930. /* pause(1) */
24931. 
24932. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
24933. 
24934. Title('!Heading!')
24935. /* pause(1) */
24936. 
24937. /* NOTE: Can't round or truncate to integer precision. */
24938. 
24939. pause(1)
24940. 
24941. 	# Script: ZoneDoFooter
24942. 
24943. /* ---------------------------------------------------------- */
24944. # File Select
24945. 	# Select Statments
24946. # File Actions 
24947. 	# Standard or OS File Actions.
24948. 	# Resume...
24949. 	
24950. 	# your stuff HERE (X)... post zone (file) file actions code.
24951. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
24952. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24953. 		# (X)
24954. 		
24955. 		/* ??? Set window? */
24956. 	
24957. 	# ADD THE GAP
24958. # Vacate (good for diagnostics)
24959. # DoNotVacate - DO NOT Vacate (recommended)
24960. # DoNotVacate - DO NOT Vacate (recommended)
24961. 
24962. # Vacate
24963. /* AddGap(GapUsedLoc) */
24964. 
24965. # DO Not Vacate
24966. AddGap(GapUsedLoc, DoNotVacate) 
24967. 	
24968. 	
24969. # Script: GapZoneCommand
24970. # *** Moved to setting yours ***
24971. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
24972. # Controlled via settings commands
24973. # DoNotVacate - DO NOT Vacate (recommended)
24974. 
24975. # Vacate
24976. /* AddGap(GapUsedLoc) */
24977. 
24978. # DO Not Vacate
24979. AddGap(GapUsedLoc, DoNotVacate) 
24980. 	
24981. 	
24982. # Vacate /* AddGap(GapUsed) */
24983. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
24984. 	
24985. 
24986. 		
24987. # 
24988. FileEnd
24989. /* ---------------------------------------------------------- */
24990. 
24991. # your stuff HERE (X)... post zone (file) code.
24992. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
24993. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24994. 	# (X)
24995. 
24996. SetVariable(FileStepDescription,"Zone finished, reporting.")
24997. # Script: DisplaySetFileStep
24998. 
24999. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25000. 
25001. /* add message and move to a new line. */
25002. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
25003. ")
25004. 
25005. /* display the line. (hopefully.) */
25006. # Zone Footer Set Statistics Window Text
25007. 
25008. SetStatisticsWindowText("!Heading!
25009. ----------------------------------------------------------
25010. Zones Processed: 
25011. ----------------------------------------------------------
25012. !ZoneListByLine!
25013. ----------------------------------------------------------
25014. Zone Processing Step:
25015. !ZoneStepByLine!    
25016. ----------------------------------------------------------
25017. Current Zone:
25018. !ZoneFooter!
25019. ----------------------------------------------------------
25020. Volume Statistics:
25021. !VolumeStatisticsDetail!
25022. ----------------------------------------------------------
25023. Zone Detailed Report:
25024. ----------------------------------------------------------
25025. !ZoneStatisticsDetail!
25026. ----------------------------------------------------------
25027. ")
25028. 
25029. 
25030. 
25031. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
25032. 
25033. # Script: BannerSet
25034. 
25035. # Script: DisplaySetDateTimeRun
25036. 
25037. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
25038. /* Xinclude "..\Display\BannerSet.MyDc"X */
25039. /* pause(1) */
25040. 
25041. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
25042. 
25043. Title('!Heading!')
25044. /* pause(1) */
25045. 
25046. /* NOTE: Can't round or truncate to integer precision. */
25047. 
25048. pause(1)
25049. 
25050. # Script: ZoneWhenFinished
25051. 
25052. # Script: BannerSet
25053. 
25054. # Script: DisplaySetDateTimeRun
25055. 
25056. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
25057. /* Xinclude "..\Display\BannerSet.MyDc"X */
25058. /* pause(1) */
25059. 
25060. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
25061. 
25062. Title('!Heading!')
25063. /* pause(1) */
25064. 
25065. /* NOTE: Can't round or truncate to integer precision. */
25066. 
25067. # Script: BannerLog
25068. 
25069. AppendLogfile("!LogFileName!", "!Title!")
25070. 
25071. 
25072. 
25073. # Zone Statistics	
25074. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
25075. 
25076. # Footer:
25077. SetVariable(ZoneFooter, "----------------------------------------------------------
25078. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
25079. 
25080. Statistics Report:
25081. ------------------
25082.    Size:  
25083.    ------------------------
25084.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
25085.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
25086.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
25087. 
25088.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
25089.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
25090. 
25091.    Location:
25092.    ------------------------
25093.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
25094.              Files End: !ZoneEndCurrent!
25095.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
25096.       
25097.    Gap Settings:
25098.    ------------------------
25099.          Gap Requested: !ZoneGapSizePer!%
25100.       Volume Rounding: !ZoneVolRoundUpPer!%
25101.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
25102.                  
25103.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
25104.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
25105.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
25106.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
25107.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
25108.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
25109.      
25110.    Free Space after Zone:
25111.    ------------------------
25112.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
25113.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
25114.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
25115. 
25116. Directory and Files Select:
25117. ---------------------------
25118. !ZoneTypeSelectCurrent!               
25119. ---------------------------
25120. ----------------------------------------------------------
25121. ")
25122. 
25123. AppendLogfile("!LogFileName!", ".")
25124. AppendLogfile("!LogFileName!", "!ZoneFooter!")
25125. AppendLogfile("!LogFileName!", ".")
25126. 
25127. # Zone Footer Set Statistics Window Text
25128. 
25129. SetStatisticsWindowText("!Heading!
25130. ----------------------------------------------------------
25131. Zones Processed: 
25132. ----------------------------------------------------------
25133. !ZoneListByLine!
25134. ----------------------------------------------------------
25135. Zone Processing Step:
25136. !ZoneStepByLine!    
25137. ----------------------------------------------------------
25138. Current Zone:
25139. !ZoneFooter!
25140. ----------------------------------------------------------
25141. Volume Statistics:
25142. !VolumeStatisticsDetail!
25143. ----------------------------------------------------------
25144. Zone Detailed Report:
25145. ----------------------------------------------------------
25146. !ZoneStatisticsDetail!
25147. ----------------------------------------------------------
25148. ")
25149. 
25150. 
25151. 
25152. /* pause() */
25153. /* pause() */
25154. 
25155. 
25156. 
25157. 
25158. /* ---------------------------------------------------------- */
25159. 
25160. 
25161. /* ---------------------------------------------------------- */
25162. /* Zone 18 Reference & World */
25163. # Script: DisplayColors - Zone Dark
25164. # Processed
25165. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
25166. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
25167. 
25168. # Light Green and Yellow
25169. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
25170. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
25171. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
25172. 
25173. # Script: DefragZoneTypeReference
25174. /* ---------------------------------------------------------- */
25175. /* Zone Reference & World */
25176. SetVariable(ZoneLabel, "!ZoneLabelReference!")
25177. SetVariable(ZoneDescription, "!ZoneDescriptionReference!")
25178. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpReference!")
25179. SetVariable(ZoneGapSize, "!ZoneGapSizeReference!")
25180. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectReference
25181. # Reference start.
25182. # NotBlobsArchivesBu start.
25183. (not (
25184. # Blobs start.
25185. (
25186. # BlobsAndExceptions start.
25187. ( not(
25188.   FileName("*.bat")
25189.   or FileName("*.css")
25190.   or FileName("*.dll")
25191.   or FileName("*.exe")
25192.   or FileName("*.htm*")
25193.   or FileName("*.jar")
25194.   or FileName("*.js")
25195.   or FileName("*.script")
25196.   or FileName("*.wsf")
25197.   or (
25198. # Databases start.
25199. (
25200.   FileName("*.crypt*")
25201.   or FileName("*.db*")
25202.   or FileName("*.rdb*")
25203.   or FileName("*.dc*")
25204.   or FileName("*.dict*")
25205.   or FileName("*.?db*")
25206.   or FileName("*.?rdb*")
25207.   or FileName("*.md*")
25208.   or FileName("*.myd")
25209.   or FileName("*.ndf")
25210.   or FileName("*.ns?")
25211.   or FileName("*.pab")
25212.   or FileName("*.pst")
25213.   or FileName("*.sd?*")
25214.   or FileName("*.sq**")
25215.   or FileName("*.tmd")
25216.   or FileName("*.tps")
25217.   or FileName("*.tr*")
25218. )
25219. # Databases end.
25220. 
25221.     # BlobsAndExceptions
25222.     or 
25223. # Data start.
25224. (
25225.   DirectoryName("Data*")
25226.   or DirectoryName("Device*")
25227.   or DirectoryName("Export*")
25228.   or DirectoryName("Import*")
25229.   or DirectoryName("Log*")
25230.   or DirectoryName("*Log")
25231.   or DirectoryName("Maintenance*")
25232.   or DirectoryName("Rec*")
25233.   or DirectoryName("Sales*")
25234.   or DirectoryName("Search*")
25235.   or DirectoryName("User*")
25236. )
25237. # Data end.
25238. 
25239.     # BlobsAndExceptions
25240.   )
25241. ) )
25242. # BlobsAndExceptions end.
25243. 
25244. # Blobs
25245. ) and (
25246.   Size(BlobFileSize,0)
25247.   or (
25248.     FileName("*.arj")
25249.     or FileName("*.bup")
25250.     or FileName("*.bz2")
25251.     or FileName("*.chm")
25252.     or FileName("*.dvr-ms")
25253.     or FileName("*.gz")
25254.     or FileName("*.ifo")
25255.     or FileName("*.lzh")
25256.     or FileName("*.pdf")
25257.     or FileName("*.rpm")
25258.     or FileName("*.wmv")
25259.     or FileName("*.vob")
25260.     or FileName("*.z")
25261.   ) 
25262. )
25263. # Blobs end.
25264. 
25265. # NotBlobsArchivesBu
25266. or 
25267. # Archives start.
25268. (
25269.   DirectoryName("*Archive*")
25270.   or DirectoryName("*History*")
25271.   or DirectoryName("*Old")
25272.   or DirectoryName("* Old *")
25273.   or DirectoryName("Old *")
25274. 
25275.   or FileName("*.7z")
25276.   or FileName("*.cab")
25277.   or FileName("*.iso")
25278.   or FileName("*.msi")
25279.   or FileName("*.old")
25280.   or FileName("*.rar")
25281.   or FileName("*.tar")
25282.   or FileName("*.zip")
25283.   or
25284. # WinSysLow start.
25285. (
25286.   DirectoryName("$*")
25287.   or DirectoryName("0*")
25288.   or DirectoryName("1*")
25289.   or DirectoryName("2*")
25290.   or DirectoryName("3*")
25291.   or DirectoryName("4*")
25292.   or DirectoryName("5*")
25293.   or DirectoryName("6*")
25294.   or DirectoryName("7*")
25295.   or DirectoryName("8*")
25296.   or DirectoryName("9*")
25297. 
25298.   or DirectoryName("dllcache")
25299.   or DirectoryName("Downloaded Installations")
25300.   or DirectoryName("Ehome")
25301.   or DirectoryName("Fonts")
25302.   or DirectoryName("Help")
25303.   or DirectoryName("I386")
25304.   or DirectoryName("ie?updates")
25305.   or DirectoryName("Installer")
25306.   or DirectoryName("Installshield Installation Information")
25307.   or DirectoryName("IME")
25308.   or DirectoryName("*RECYCLE*")
25309.   or DirectoryName("ServicePackFiles")
25310.   or DirectoryName("SoftwareDistribution")
25311.   or DirectoryName("Speech")
25312.   or DirectoryName("Symbols")
25313.   or DirectoryName("System Volume Information")
25314.   or DirectoryName("windows.old")
25315. )
25316. # WinSysLow end.
25317. 
25318.   # Archives
25319. )
25320. # Archives end.
25321. 
25322. # NotBlobsArchivesBu
25323. or
25324. # Backups start.
25325. (
25326.   DirectoryName("*Backup*")
25327.   or DirectoryName("*Bu")
25328.   or DirectoryName("* Bu *")
25329.   or DirectoryName("Bu *")
25330. 
25331.   or FileName("*.bak")
25332.   or FileName("* - Copy*")
25333. )
25334. # Backups end.
25335. 
25336. # NotBlobsArchivesBu
25337. ) )
25338. # NotBlobsArchivesBu end.
25339. 
25340. # Reference
25341. and (
25342. # Reference start.
25343. (
25344.   DirectoryName("World*") or
25345.   DirectoryName("Education*") or
25346.   DirectoryName("Entertainment*") or
25347.   DirectoryName("Food*") or
25348.   DirectoryName("Geography*") or
25349.   DirectoryName("Help*") or
25350.   DirectoryName("Humo*") or
25351.   DirectoryName("Internet*") or
25352.   DirectoryName("Legal*") or
25353.   DirectoryName("Linquistics*") or
25354.   DirectoryName("Media*") or
25355.   DirectoryName("Multimedia*") or
25356.   DirectoryName("Reference*") or
25357.   DirectoryName("Sales*") or
25358.   DirectoryName("Science*") or
25359.   DirectoryName("Social*") or
25360.   DirectoryName("Technology*")
25361. )
25362. # Reference end.
25363. 
25364. # Reference
25365. )
25366. # Reference end.
25367. ')
25368. 
25369. 	# Script: ZoneDoHeader
25370. 
25371. # Script: ZoneWhenStarted
25372. 
25373. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
25374. # Script: DisplaySetZone
25375. 
25376. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
25377. SetVariable(FileStepDescription,	"")
25378. 
25379. SetVariable(ZoneStepByLine, 			"Zone started.
25380. ")
25381. 
25382. # Script: BannerDescriptionSet
25383. 
25384. # Script: BannerSet
25385. 
25386. # Script: DisplaySetDateTimeRun
25387. 
25388. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
25389. /* Xinclude "..\Display\BannerSet.MyDc"X */
25390. /* pause(1) */
25391. 
25392. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
25393. 
25394. Title('!Heading!')
25395. /* pause(1) */
25396. 
25397. /* NOTE: Can't round or truncate to integer precision. */
25398. 
25399. # Script: BannerLog
25400. 
25401. AppendLogfile("!LogFileName!", "!Title!")
25402. 
25403. 
25404. 
25405. pause(1)
25406. 
25407. 
25408. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
25409. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
25410. 
25411. SetVariable(ZoneStepNoCurrent, 0)
25412. 
25413. 
25414. # Script: ZoneDoCurrentClear
25415. 
25416. SetVariable(ZoneTypeSelectCurrent, 		"")
25417. 
25418. SetVariable(ZoneBeginCurrent, 			0)
25419. SetVariable(ZoneBeginPerCurrent, 		0)
25420. SetVariable(ZoneEndCurrent, 			0)
25421. SetVariable(ZoneEndPerCurrent, 			0)
25422. 
25423. SetVariable(ZoneSizeCurrent,			0)
25424. SetVariable(ZoneSizePerCurrent,			0)
25425. 
25426. SetVariable(ZoneGapRequestedCurrent,	0)
25427. SetVariable(ZoneGapRoundedCurrent, 		0)
25428. SetVariable(ZoneGapAdjustedCurrent, 	0)
25429. SetVariable(ZoneGapAvailableCurrent, 	0)
25430. SetVariable(ZoneGapCurrent,				0)
25431. SetVariable(ZoneGapUsedCurrent, 		0)
25432. 
25433. SetVariable(ZoneGapActualCurrent, 		0)
25434. SetVariable(ZoneGapActualPerCurrent, 	0)
25435. 
25436. SetVariable(ZoneSizeActual, 			0)
25437. SetVariable(ZoneSizeActualCurrent,		0)
25438. 
25439. SetVariable(ZoneEndActual, 				0)
25440. SetVariable(ZoneEndActualCurrent,		0)			
25441. SetVariable(ZoneSizeActualPerCurrent, 	0)
25442.       
25443. SetVariable(ZoneFilesFolders,			0)
25444. SetVariable(ZoneFilesFoldersPer,		0) 
25445. 
25446. SetVariable(ZoneFragments,				0)
25447. SetVariable(ZoneFragmentsPer,			0) 
25448. 		
25449. SetVariable(ZoneEndActualCurrent, 		0)
25450. SetVariable(ZoneEndActualPerCurrent, 	0)
25451. 
25452. # Gap Calculation Methodology:
25453. 	# Requested
25454. 	SetVariable(GapRequested, 			0) 
25455. 	SetVariable(GapRequestedStd, 		0) 
25456. 	SetVariable(GapRequestedMft, 		0) 
25457. 	SetVariable(GapRequestedOs, 		0) 
25458. 	SetVariable(GapRequestedOriginal, 	0) 
25459. 	
25460. 	# Gap Adjustments
25461. 	SetVariable(GapRounded, 			0)
25462. 	# SetVariable(GapAdjusted, 			0)
25463. 	SetVariable(GapAvailable, 			0)
25464. 	SetVariable(GapCurrent, 			0)
25465. 	SetVariable(GapActual, 				0)
25466. 	SetVariable(GapUsed, 				0)
25467. 	
25468. 	# Gap Adjustments
25469. 	SetVariable(GapRoundedLoc, 			0)
25470. 	# SetVariable(GapAdjustedLoc, 		0)
25471. 	SetVariable(GapAvailableLoc, 		0)
25472. 	SetVariable(GapCurrentLoc, 			0)
25473. 	SetVariable(GapActualLoc,			0)
25474. 	SetVariable(GapUsedLoc,				0)
25475. 	
25476. 	# Space usage
25477. 	SetVariable(ZoneFreePerRequested, 	0)
25478. 	SetVariable(ZoneFreePerUsed, 		0)
25479. 
25480. # Gap Size & Rounding
25481. 	SetVariable(ZoneGapSizePer, 		0)
25482. 	SetVariable(ZoneVolRoundUpPer, 		0)
25483. 	
25484. 	# Free Space
25485. 	SetVariable(ZoneFreeUsedPer, 		0)
25486. 	SetVariable(ZoneFreeRequestedPer, 	0)
25487. 
25488. 
25489. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
25490. 
25491. # Footer:
25492. SetVariable(ZoneFooter, "----------------------------------------------------------
25493. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
25494. 
25495. Statistics Report:
25496. ------------------
25497.    Size:  
25498.    ------------------------
25499.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
25500.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
25501.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
25502. 
25503.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
25504.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
25505. 
25506.    Location:
25507.    ------------------------
25508.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
25509.              Files End: !ZoneEndCurrent!
25510.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
25511.       
25512.    Gap Settings:
25513.    ------------------------
25514.          Gap Requested: !ZoneGapSizePer!%
25515.       Volume Rounding: !ZoneVolRoundUpPer!%
25516.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
25517.                  
25518.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
25519.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
25520.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
25521.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
25522.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
25523.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
25524.      
25525.    Free Space after Zone:
25526.    ------------------------
25527.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
25528.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
25529.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
25530. 
25531. Directory and Files Select:
25532. ---------------------------
25533. !ZoneTypeSelectCurrent!               
25534. ---------------------------
25535. ----------------------------------------------------------
25536. ")
25537. 
25538. # Script: BannerSet
25539. 
25540. # Script: DisplaySetDateTimeRun
25541. 
25542. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
25543. /* Xinclude "..\Display\BannerSet.MyDc"X */
25544. /* pause(1) */
25545. 
25546. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
25547. 
25548. Title('!Heading!')
25549. /* pause(1) */
25550. 
25551. /* NOTE: Can't round or truncate to integer precision. */
25552. 
25553. # Script: BannerLog
25554. 
25555. AppendLogfile("!LogFileName!", "!Title!")
25556. 
25557. 
25558. 
25559. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
25560. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
25561. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:22")
25562. 
25563. SetVariable(ZoneListByLine, "!ZoneListByLine!
25564. Zone: !ZoneNoCurrent! 2021-11-13 20:31:22 0:00:05 !ZoneLabel! !ZoneDescription!")
25565. 
25566. 
25567. /* Fixed Zone Position Handling */
25568. /* Literal number: */
25569. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
25570. /* Percentage of disk: */
25571. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
25572. /* Gap */
25573. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
25574. 
25575. /* ---------------------------------------------------------- */
25576. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
25577. # Script: DisplaySetFileStep
25578. 
25579. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25580. 
25581. /* add message and move to a new line. */
25582. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
25583. ")
25584. 
25585. /* display the line. (hopefully.) */
25586. # Zone Footer Set Statistics Window Text
25587. 
25588. SetStatisticsWindowText("!Heading!
25589. ----------------------------------------------------------
25590. Zones Processed: 
25591. ----------------------------------------------------------
25592. !ZoneListByLine!
25593. ----------------------------------------------------------
25594. Zone Processing Step:
25595. !ZoneStepByLine!    
25596. ----------------------------------------------------------
25597. Current Zone:
25598. !ZoneFooter!
25599. ----------------------------------------------------------
25600. Volume Statistics:
25601. !VolumeStatisticsDetail!
25602. ----------------------------------------------------------
25603. Zone Detailed Report:
25604. ----------------------------------------------------------
25605. !ZoneStatisticsDetail!
25606. ----------------------------------------------------------
25607. ")
25608. 
25609. 
25610. 
25611. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
25612. 
25613. # Script: BannerSet
25614. 
25615. # Script: DisplaySetDateTimeRun
25616. 
25617. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
25618. /* Xinclude "..\Display\BannerSet.MyDc"X */
25619. /* pause(1) */
25620. 
25621. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
25622. 
25623. Title('!Heading!')
25624. /* pause(1) */
25625. 
25626. /* NOTE: Can't round or truncate to integer precision. */
25627. 
25628. pause(1)
25629. 
25630. # your stuff HERE (X)... pre file select code.
25631. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
25632. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
25633. 	# (X)
25634. 
25635. FileSelect
25636. 
25637. 	# your stuff can't really go here (errors.)
25638. 	# maybe for some reason I don't know of...
25639. 	
25640. 	# Actions next...
25641. 	# Script: ZoneDo ZoneTypeSelectReference
25642. # Reference start.
25643. # NotBlobsArchivesBu start.
25644. (not (
25645. # Blobs start.
25646. (
25647. # BlobsAndExceptions start.
25648. ( not(
25649.   FileName("*.bat")
25650.   or FileName("*.css")
25651.   or FileName("*.dll")
25652.   or FileName("*.exe")
25653.   or FileName("*.htm*")
25654.   or FileName("*.jar")
25655.   or FileName("*.js")
25656.   or FileName("*.script")
25657.   or FileName("*.wsf")
25658.   or (
25659. # Databases start.
25660. (
25661.   FileName("*.crypt*")
25662.   or FileName("*.db*")
25663.   or FileName("*.rdb*")
25664.   or FileName("*.dc*")
25665.   or FileName("*.dict*")
25666.   or FileName("*.?db*")
25667.   or FileName("*.?rdb*")
25668.   or FileName("*.md*")
25669.   or FileName("*.myd")
25670.   or FileName("*.ndf")
25671.   or FileName("*.ns?")
25672.   or FileName("*.pab")
25673.   or FileName("*.pst")
25674.   or FileName("*.sd?*")
25675.   or FileName("*.sq**")
25676.   or FileName("*.tmd")
25677.   or FileName("*.tps")
25678.   or FileName("*.tr*")
25679. )
25680. # Databases end.
25681. 
25682.     # BlobsAndExceptions
25683.     or 
25684. # Data start.
25685. (
25686.   DirectoryName("Data*")
25687.   or DirectoryName("Device*")
25688.   or DirectoryName("Export*")
25689.   or DirectoryName("Import*")
25690.   or DirectoryName("Log*")
25691.   or DirectoryName("*Log")
25692.   or DirectoryName("Maintenance*")
25693.   or DirectoryName("Rec*")
25694.   or DirectoryName("Sales*")
25695.   or DirectoryName("Search*")
25696.   or DirectoryName("User*")
25697. )
25698. # Data end.
25699. 
25700.     # BlobsAndExceptions
25701.   )
25702. ) )
25703. # BlobsAndExceptions end.
25704. 
25705. # Blobs
25706. ) and (
25707.   Size(BlobFileSize,0)
25708.   or (
25709.     FileName("*.arj")
25710.     or FileName("*.bup")
25711.     or FileName("*.bz2")
25712.     or FileName("*.chm")
25713.     or FileName("*.dvr-ms")
25714.     or FileName("*.gz")
25715.     or FileName("*.ifo")
25716.     or FileName("*.lzh")
25717.     or FileName("*.pdf")
25718.     or FileName("*.rpm")
25719.     or FileName("*.wmv")
25720.     or FileName("*.vob")
25721.     or FileName("*.z")
25722.   ) 
25723. )
25724. # Blobs end.
25725. 
25726. # NotBlobsArchivesBu
25727. or 
25728. # Archives start.
25729. (
25730.   DirectoryName("*Archive*")
25731.   or DirectoryName("*History*")
25732.   or DirectoryName("*Old")
25733.   or DirectoryName("* Old *")
25734.   or DirectoryName("Old *")
25735. 
25736.   or FileName("*.7z")
25737.   or FileName("*.cab")
25738.   or FileName("*.iso")
25739.   or FileName("*.msi")
25740.   or FileName("*.old")
25741.   or FileName("*.rar")
25742.   or FileName("*.tar")
25743.   or FileName("*.zip")
25744.   or
25745. # WinSysLow start.
25746. (
25747.   DirectoryName("$*")
25748.   or DirectoryName("0*")
25749.   or DirectoryName("1*")
25750.   or DirectoryName("2*")
25751.   or DirectoryName("3*")
25752.   or DirectoryName("4*")
25753.   or DirectoryName("5*")
25754.   or DirectoryName("6*")
25755.   or DirectoryName("7*")
25756.   or DirectoryName("8*")
25757.   or DirectoryName("9*")
25758. 
25759.   or DirectoryName("dllcache")
25760.   or DirectoryName("Downloaded Installations")
25761.   or DirectoryName("Ehome")
25762.   or DirectoryName("Fonts")
25763.   or DirectoryName("Help")
25764.   or DirectoryName("I386")
25765.   or DirectoryName("ie?updates")
25766.   or DirectoryName("Installer")
25767.   or DirectoryName("Installshield Installation Information")
25768.   or DirectoryName("IME")
25769.   or DirectoryName("*RECYCLE*")
25770.   or DirectoryName("ServicePackFiles")
25771.   or DirectoryName("SoftwareDistribution")
25772.   or DirectoryName("Speech")
25773.   or DirectoryName("Symbols")
25774.   or DirectoryName("System Volume Information")
25775.   or DirectoryName("windows.old")
25776. )
25777. # WinSysLow end.
25778. 
25779.   # Archives
25780. )
25781. # Archives end.
25782. 
25783. # NotBlobsArchivesBu
25784. or
25785. # Backups start.
25786. (
25787.   DirectoryName("*Backup*")
25788.   or DirectoryName("*Bu")
25789.   or DirectoryName("* Bu *")
25790.   or DirectoryName("Bu *")
25791. 
25792.   or FileName("*.bak")
25793.   or FileName("* - Copy*")
25794. )
25795. # Backups end.
25796. 
25797. # NotBlobsArchivesBu
25798. ) )
25799. # NotBlobsArchivesBu end.
25800. 
25801. # Reference
25802. and (
25803. # Reference start.
25804. (
25805.   DirectoryName("World*") or
25806.   DirectoryName("Education*") or
25807.   DirectoryName("Entertainment*") or
25808.   DirectoryName("Food*") or
25809.   DirectoryName("Geography*") or
25810.   DirectoryName("Help*") or
25811.   DirectoryName("Humo*") or
25812.   DirectoryName("Internet*") or
25813.   DirectoryName("Legal*") or
25814.   DirectoryName("Linquistics*") or
25815.   DirectoryName("Media*") or
25816.   DirectoryName("Multimedia*") or
25817.   DirectoryName("Reference*") or
25818.   DirectoryName("Sales*") or
25819.   DirectoryName("Science*") or
25820.   DirectoryName("Social*") or
25821.   DirectoryName("Technology*")
25822. )
25823. # Reference end.
25824. 
25825. # Reference
25826. )
25827. # Reference end.
25828. 
25829. 	# Script: ZoneDoAction
25830. # Zone Do File Action - SortByName.
25831. 
25832. FileActions
25833. 
25834. 		/* ---------------------------------------------------------- */
25835. 	# Gap
25836. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
25837. 		# Script: DisplaySetFileStep
25838. 
25839. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25840. 
25841. /* add message and move to a new line. */
25842. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
25843. ")
25844. 
25845. /* display the line. (hopefully.) */
25846. # Zone Footer Set Statistics Window Text
25847. 
25848. SetStatisticsWindowText("!Heading!
25849. ----------------------------------------------------------
25850. Zones Processed: 
25851. ----------------------------------------------------------
25852. !ZoneListByLine!
25853. ----------------------------------------------------------
25854. Zone Processing Step:
25855. !ZoneStepByLine!    
25856. ----------------------------------------------------------
25857. Current Zone:
25858. !ZoneFooter!
25859. ----------------------------------------------------------
25860. Volume Statistics:
25861. !VolumeStatisticsDetail!
25862. ----------------------------------------------------------
25863. Zone Detailed Report:
25864. ----------------------------------------------------------
25865. !ZoneStatisticsDetail!
25866. ----------------------------------------------------------
25867. ")
25868. 
25869. 
25870. 
25871. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
25872. 
25873. # Script: BannerSet
25874. 
25875. # Script: DisplaySetDateTimeRun
25876. 
25877. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
25878. /* Xinclude "..\Display\BannerSet.MyDc"X */
25879. /* pause(1) */
25880. 
25881. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
25882. 
25883. Title('!Heading!')
25884. /* pause(1) */
25885. 
25886. /* NOTE: Can't round or truncate to integer precision. */
25887. 
25888. pause(1)
25889. 	
25890. 	# ACTUAL GAP
25891. 		/* AddGap Variant. */
25892. 	  	# Zone Do Gap
25893. # Gap Calculation Methods:
25894. 
25895. /* 1) Anything you need to add first. */
25896. /* empty */
25897. 
25898. /* ---------------------------------------------------------- */
25899. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
25900. 	# GapRequestedStd.
25901. 
25902. 		/* ---------------------------------------------------------- */
25903. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
25904. 
25905. 		# Gap Calculation Methods:
25906. 
25907. /* AddGap Variants */
25908. 
25909. 	/* Standard */
25910. 		# Gap Calculation Methods:
25911. 	/* AddGap Variants */
25912. 	/* Standard */
25913. 
25914. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
25915. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
25916. 
25917. 	SetVariable(GapRequested, GapRequestedStd)
25918. 	
25919. 
25920. 	/* MFT Low High Method */
25921. 		# Gap Calculation Methods:
25922. 	/* AddGap Variants */
25923. 	/* MFT Low High Method */
25924. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
25925. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
25926. 	SetVariable(GapRequested, GapRequestedMft)
25927. 	
25928. 
25929. 	/* OS Volume Type Method */
25930. 		# Gap Calculation Methods:
25931. 	/* AddGap Variants */
25932. 	/* OS Volume Type Method */
25933. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
25934. 	SetVariable(GapRequested, GapRequestedOs)
25935. 
25936. 
25937. 
25938. /* MakeGap Variants */
25939. 
25940. 	/* Original Os 1-3 + MFT 2 */
25941. 		# Gap Calculation Methods:
25942. 	/* MakeGap Variants */
25943. 	/* Original Os 1-3 + MFT 2 */
25944. 	/* plus MFT gap placed inline at the dividing zone. */
25945. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
25946. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
25947. 	SetVariable(GapRequested, GapRequestedOrig)
25948. 	
25949. 	
25950. /* Note: You could comment out the ones not in use */
25951. /* However having the data in the log is useful. */
25952. /* Therefore the following line is otherwise needed. */
25953. 
25954. /* Standard used */
25955. 
25956. SetVariable(GapRequested, GapRequestedStd)
25957. 
25958. # Gap Calculation Methods:
25959. 
25960. /* AddGap Variants */
25961. 	/* Standard */
25962. 	/* MFT Low High Method */
25963. 	/* OS Volume Type Method */
25964. 
25965. /* MakeGap Variants */
25966. 	/* Original Os 1-3 + MFT 2 */
25967. 
25968. /* Note: You could comment out the ones not in use */
25969. /* However having the data in the log is useful. */
25970. /* Therefore the following line is otherwise needed. */
25971. 
25972. /* Standard is used currently */
25973. 
25974. 
25975. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
25976. 
25977. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
25978. 
25979. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
25980. 
25981. /* ---------------------------------------------------------- */
25982. /* 3) SMALL ZONE ADJUSTMENT. */
25983. /* Gab cant be larger than half the Zone Size. */
25984. 
25985. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
25986. 	
25987. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
25988. 
25989. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
25990. 
25991. /* ---------------------------------------------------------- */
25992. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
25993. # Gap Adjustments.
25994. 
25995. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
25996. 	
25997. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
25998. 
25999. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
26000. 
26001. /* ---------------------------------------------------------- */
26002. # BYPASS THIS.
26003. 	/* This is definitely wrong. */
26004. 	/* The question is can we steal gap from the next zone */
26005. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
26006. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
26007. 		# Zone Overflow.
26008. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
26009. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
26010. 
26011. /* ---------------------------------------------------------- */
26012. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
26013. # Remaining free space available.
26014. 
26015. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
26016. 	
26017. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
26018. 
26019. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
26020. 
26021. /* ---------------------------------------------------------- */
26022. # CURRENT gap to use.
26023. 
26024. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
26025. 
26026. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
26027. 
26028. /* ---------------------------------------------------------- */
26029. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
26030. # Debugging.
26031. 
26032. 	SetVariable(GapUsed, GapCurrent) // for debugging
26033. 
26034. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
26035. 
26036. 		# Your code HERE
26037. 
26038. /* ---------------------------------------------------------- */
26039. /* 7) YOUR CODE. */
26040. # YOUR CODE HERE:
26041. 	# INPUT: GapCurrent or GapCurrentLoc
26042. 	# OUTPUT: GapUsed...
26043. 
26044. /* ---------------------------------------------------------- */
26045. # Gap Size.
26046. # Actual Size of Gap.
26047. 
26048. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
26049. 
26050. /* ---------------------------------------------------------- */
26051. /* xxxxxxxxxxxxxxxxxxxxxx */
26052. # ADD THE GAP
26053. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
26054. /* xxxxxxxxxxxxxxxxxxxxxx */
26055. 
26056. 	
26057. 	# Zone Statistics	
26058. 	# Script: ZoneDoStatistics
26059. # Zone / Volume Statistics and Display
26060. 		
26061. 	# Accumulate Totals
26062.   	# Script: ZoneDoVolumeTotals
26063. 
26064. /* Current total space used (by Zones and Gaps) */
26065. 
26066. SetVariable(VolumeZoneUsed, GapUsed)
26067. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
26068. /* Percentage */
26069. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
26070. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
26071. 
26072. /* Current total of free space requested */
26073. 
26074. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
26075. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
26076. /* Percent. */
26077. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
26078. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
26079. 
26080. /* Current total of free space used */
26081. 
26082. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
26083. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
26084. /* Percent */
26085. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
26086. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
26087. 
26088. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
26089. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
26090. /* Xinclude "..\DebugDisplayPause.MyDc"X */
26091. 
26092. 
26093. 	# Current Values
26094. 	# Script: ZoneDoCurrentSet
26095. 
26096. # Cluster, Sector, Block adjust for display.
26097. 	# Bytes per cluster is volume specific.
26098. 
26099. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
26100. 
26101. # Current Zone values.
26102. 	# Begin, end and size.
26103. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
26104. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
26105. 
26106. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
26107. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
26108. 
26109. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
26110. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
26111. 
26112. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
26113. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
26114. 
26115. 	SetVariable(ZoneFragments,				"!ZONE210N!")
26116. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
26117. 		
26118. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
26119. /* identical code to here: (separation not needed. TEST.) */	
26120. 
26121. # Current Gap, Actual and Free Values
26122. 	# Gap
26123. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
26124. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
26125. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
26126. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
26127. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
26128. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
26129. 	
26130. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
26131. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
26132. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
26133. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
26134. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
26135. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
26136. 	
26137. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
26138. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
26139. 	
26140. 	# Actual Size and End
26141. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
26142. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
26143. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
26144. 	
26145. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
26146. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
26147. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
26148. 
26149. # Gap Size & Rounding
26150. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
26151. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
26152. 	
26153. 	# Free Space
26154. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
26155. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
26156. 
26157. 	# Footer:
26158. SetVariable(ZoneFooter, "----------------------------------------------------------
26159. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
26160. 
26161. Statistics Report:
26162. ------------------
26163.    Size:  
26164.    ------------------------
26165.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
26166.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
26167.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
26168. 
26169.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
26170.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
26171. 
26172.    Location:
26173.    ------------------------
26174.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
26175.              Files End: !ZoneEndCurrent!
26176.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
26177.       
26178.    Gap Settings:
26179.    ------------------------
26180.          Gap Requested: !ZoneGapSizePer!%
26181.       Volume Rounding: !ZoneVolRoundUpPer!%
26182.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
26183.                  
26184.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
26185.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
26186.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
26187.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
26188.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
26189.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
26190.      
26191.    Free Space after Zone:
26192.    ------------------------
26193.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
26194.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
26195.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
26196. 
26197. Directory and Files Select:
26198. ---------------------------
26199. !ZoneTypeSelectCurrent!               
26200. ---------------------------
26201. ----------------------------------------------------------
26202. ")
26203. 	# Zone Footer Set Statistics Window Text
26204. 
26205. SetStatisticsWindowText("!Heading!
26206. ----------------------------------------------------------
26207. Zones Processed: 
26208. ----------------------------------------------------------
26209. !ZoneListByLine!
26210. ----------------------------------------------------------
26211. Zone Processing Step:
26212. !ZoneStepByLine!    
26213. ----------------------------------------------------------
26214. Current Zone:
26215. !ZoneFooter!
26216. ----------------------------------------------------------
26217. Volume Statistics:
26218. !VolumeStatisticsDetail!
26219. ----------------------------------------------------------
26220. Zone Detailed Report:
26221. ----------------------------------------------------------
26222. !ZoneStatisticsDetail!
26223. ----------------------------------------------------------
26224. ")
26225. 
26226. 
26227. 	
26228.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
26229. 
26230. 	# Add Zone to list of zones for display.
26231. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
26232. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
26233. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
26234. 	# ??? Free Stats?
26235. 	# Footer:
26236. SetVariable(ZoneFooter, "----------------------------------------------------------
26237. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
26238. 
26239. Statistics Report:
26240. ------------------
26241.    Size:  
26242.    ------------------------
26243.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
26244.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
26245.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
26246. 
26247.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
26248.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
26249. 
26250.    Location:
26251.    ------------------------
26252.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
26253.              Files End: !ZoneEndCurrent!
26254.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
26255.       
26256.    Gap Settings:
26257.    ------------------------
26258.          Gap Requested: !ZoneGapSizePer!%
26259.       Volume Rounding: !ZoneVolRoundUpPer!%
26260.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
26261.                  
26262.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
26263.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
26264.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
26265.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
26266.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
26267.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
26268.      
26269.    Free Space after Zone:
26270.    ------------------------
26271.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
26272.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
26273.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
26274. 
26275. Directory and Files Select:
26276. ---------------------------
26277. !ZoneTypeSelectCurrent!               
26278. ---------------------------
26279. ----------------------------------------------------------
26280. ")
26281. 
26282. 	# Add Zone Details to Report.	
26283. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
26284. !ZoneFooter!")
26285. 
26286. 
26287. 	
26288. 	# Footer:
26289. SetVariable(ZoneFooter, "----------------------------------------------------------
26290. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
26291. 
26292. Statistics Report:
26293. ------------------
26294.    Size:  
26295.    ------------------------
26296.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
26297.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
26298.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
26299. 
26300.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
26301.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
26302. 
26303.    Location:
26304.    ------------------------
26305.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
26306.              Files End: !ZoneEndCurrent!
26307.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
26308.       
26309.    Gap Settings:
26310.    ------------------------
26311.          Gap Requested: !ZoneGapSizePer!%
26312.       Volume Rounding: !ZoneVolRoundUpPer!%
26313.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
26314.                  
26315.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
26316.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
26317.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
26318.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
26319.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
26320.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
26321.      
26322.    Free Space after Zone:
26323.    ------------------------
26324.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
26325.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
26326.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
26327. 
26328. Directory and Files Select:
26329. ---------------------------
26330. !ZoneTypeSelectCurrent!               
26331. ---------------------------
26332. ----------------------------------------------------------
26333. ")
26334. 	SetStatisticsWindowText("!ZoneFooter!")
26335. 	
26336. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
26337. 	# Script: DisplaySetFileStep
26338. 
26339. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26340. 
26341. /* add message and move to a new line. */
26342. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
26343. ")
26344. 
26345. /* display the line. (hopefully.) */
26346. # Zone Footer Set Statistics Window Text
26347. 
26348. SetStatisticsWindowText("!Heading!
26349. ----------------------------------------------------------
26350. Zones Processed: 
26351. ----------------------------------------------------------
26352. !ZoneListByLine!
26353. ----------------------------------------------------------
26354. Zone Processing Step:
26355. !ZoneStepByLine!    
26356. ----------------------------------------------------------
26357. Current Zone:
26358. !ZoneFooter!
26359. ----------------------------------------------------------
26360. Volume Statistics:
26361. !VolumeStatisticsDetail!
26362. ----------------------------------------------------------
26363. Zone Detailed Report:
26364. ----------------------------------------------------------
26365. !ZoneStatisticsDetail!
26366. ----------------------------------------------------------
26367. ")
26368. 
26369. 
26370. 
26371. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
26372. 
26373. # Script: BannerSet
26374. 
26375. # Script: DisplaySetDateTimeRun
26376. 
26377. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
26378. /* Xinclude "..\Display\BannerSet.MyDc"X */
26379. /* pause(1) */
26380. 
26381. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
26382. 
26383. Title('!Heading!')
26384. /* pause(1) */
26385. 
26386. /* NOTE: Can't round or truncate to integer precision. */
26387. 
26388. pause(1)
26389. 
26390. # Commands:
26391. 
26392. /* Moves to Zone or above it. */
26393. # MoveUpToZone()
26394. 
26395. # Defrag
26396. 
26397. # Defragment(OPTIONS)
26398. 
26399. /* Shuffles files around trying to make a big enough gap for fragmented files. */
26400. # Defragment()
26401. 
26402. /* Only does files where a gap will fit it. */
26403. # Defragment(Fast)
26404. 
26405. /* Skips fragmented files larger than the Chunck Size. */
26406. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
26407. # Defragment(Chunk Size)
26408. 
26409. /* Moves down to zone and packs zone to beginning if there are gaps. */
26410. /* Can be similar in performance to doing a SortBy. */
26411. # MoveDownFill()
26412. 
26413. # File Action - All - Fast - MoveUpToZone.
26414. 	MoveUpToZone()
26415. 	
26416. 
26417. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
26418. 	# Script: DisplaySetFileStep
26419. 
26420. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26421. 
26422. /* add message and move to a new line. */
26423. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
26424. ")
26425. 
26426. /* display the line. (hopefully.) */
26427. # Zone Footer Set Statistics Window Text
26428. 
26429. SetStatisticsWindowText("!Heading!
26430. ----------------------------------------------------------
26431. Zones Processed: 
26432. ----------------------------------------------------------
26433. !ZoneListByLine!
26434. ----------------------------------------------------------
26435. Zone Processing Step:
26436. !ZoneStepByLine!    
26437. ----------------------------------------------------------
26438. Current Zone:
26439. !ZoneFooter!
26440. ----------------------------------------------------------
26441. Volume Statistics:
26442. !VolumeStatisticsDetail!
26443. ----------------------------------------------------------
26444. Zone Detailed Report:
26445. ----------------------------------------------------------
26446. !ZoneStatisticsDetail!
26447. ----------------------------------------------------------
26448. ")
26449. 
26450. 
26451. 
26452. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
26453. 
26454. # Script: BannerSet
26455. 
26456. # Script: DisplaySetDateTimeRun
26457. 
26458. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
26459. /* Xinclude "..\Display\BannerSet.MyDc"X */
26460. /* pause(1) */
26461. 
26462. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
26463. 
26464. Title('!Heading!')
26465. /* pause(1) */
26466. 
26467. /* NOTE: Can't round or truncate to integer precision. */
26468. 
26469. pause(1)
26470. 
26471. 	# Script: ZoneDoFooter
26472. 
26473. /* ---------------------------------------------------------- */
26474. # File Select
26475. 	# Select Statments
26476. # File Actions 
26477. 	# Standard or OS File Actions.
26478. 	# Resume...
26479. 	
26480. 	# your stuff HERE (X)... post zone (file) file actions code.
26481. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
26482. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
26483. 		# (X)
26484. 		
26485. 		/* ??? Set window? */
26486. 	
26487. 	# ADD THE GAP
26488. # Vacate (good for diagnostics)
26489. # DoNotVacate - DO NOT Vacate (recommended)
26490. # DoNotVacate - DO NOT Vacate (recommended)
26491. 
26492. # Vacate
26493. /* AddGap(GapUsedLoc) */
26494. 
26495. # DO Not Vacate
26496. AddGap(GapUsedLoc, DoNotVacate) 
26497. 	
26498. 	
26499. # Script: GapZoneCommand
26500. # *** Moved to setting yours ***
26501. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
26502. # Controlled via settings commands
26503. # DoNotVacate - DO NOT Vacate (recommended)
26504. 
26505. # Vacate
26506. /* AddGap(GapUsedLoc) */
26507. 
26508. # DO Not Vacate
26509. AddGap(GapUsedLoc, DoNotVacate) 
26510. 	
26511. 	
26512. # Vacate /* AddGap(GapUsed) */
26513. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
26514. 	
26515. 
26516. 		
26517. # 
26518. FileEnd
26519. /* ---------------------------------------------------------- */
26520. 
26521. # your stuff HERE (X)... post zone (file) code.
26522. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
26523. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
26524. 	# (X)
26525. 
26526. SetVariable(FileStepDescription,"Zone finished, reporting.")
26527. # Script: DisplaySetFileStep
26528. 
26529. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26530. 
26531. /* add message and move to a new line. */
26532. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
26533. ")
26534. 
26535. /* display the line. (hopefully.) */
26536. # Zone Footer Set Statistics Window Text
26537. 
26538. SetStatisticsWindowText("!Heading!
26539. ----------------------------------------------------------
26540. Zones Processed: 
26541. ----------------------------------------------------------
26542. !ZoneListByLine!
26543. ----------------------------------------------------------
26544. Zone Processing Step:
26545. !ZoneStepByLine!    
26546. ----------------------------------------------------------
26547. Current Zone:
26548. !ZoneFooter!
26549. ----------------------------------------------------------
26550. Volume Statistics:
26551. !VolumeStatisticsDetail!
26552. ----------------------------------------------------------
26553. Zone Detailed Report:
26554. ----------------------------------------------------------
26555. !ZoneStatisticsDetail!
26556. ----------------------------------------------------------
26557. ")
26558. 
26559. 
26560. 
26561. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
26562. 
26563. # Script: BannerSet
26564. 
26565. # Script: DisplaySetDateTimeRun
26566. 
26567. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
26568. /* Xinclude "..\Display\BannerSet.MyDc"X */
26569. /* pause(1) */
26570. 
26571. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
26572. 
26573. Title('!Heading!')
26574. /* pause(1) */
26575. 
26576. /* NOTE: Can't round or truncate to integer precision. */
26577. 
26578. pause(1)
26579. 
26580. # Script: ZoneWhenFinished
26581. 
26582. # Script: BannerSet
26583. 
26584. # Script: DisplaySetDateTimeRun
26585. 
26586. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
26587. /* Xinclude "..\Display\BannerSet.MyDc"X */
26588. /* pause(1) */
26589. 
26590. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
26591. 
26592. Title('!Heading!')
26593. /* pause(1) */
26594. 
26595. /* NOTE: Can't round or truncate to integer precision. */
26596. 
26597. # Script: BannerLog
26598. 
26599. AppendLogfile("!LogFileName!", "!Title!")
26600. 
26601. 
26602. 
26603. # Zone Statistics	
26604. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
26605. 
26606. # Footer:
26607. SetVariable(ZoneFooter, "----------------------------------------------------------
26608. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
26609. 
26610. Statistics Report:
26611. ------------------
26612.    Size:  
26613.    ------------------------
26614.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
26615.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
26616.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
26617. 
26618.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
26619.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
26620. 
26621.    Location:
26622.    ------------------------
26623.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
26624.              Files End: !ZoneEndCurrent!
26625.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
26626.       
26627.    Gap Settings:
26628.    ------------------------
26629.          Gap Requested: !ZoneGapSizePer!%
26630.       Volume Rounding: !ZoneVolRoundUpPer!%
26631.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
26632.                  
26633.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
26634.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
26635.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
26636.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
26637.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
26638.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
26639.      
26640.    Free Space after Zone:
26641.    ------------------------
26642.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
26643.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
26644.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
26645. 
26646. Directory and Files Select:
26647. ---------------------------
26648. !ZoneTypeSelectCurrent!               
26649. ---------------------------
26650. ----------------------------------------------------------
26651. ")
26652. 
26653. AppendLogfile("!LogFileName!", ".")
26654. AppendLogfile("!LogFileName!", "!ZoneFooter!")
26655. AppendLogfile("!LogFileName!", ".")
26656. 
26657. # Zone Footer Set Statistics Window Text
26658. 
26659. SetStatisticsWindowText("!Heading!
26660. ----------------------------------------------------------
26661. Zones Processed: 
26662. ----------------------------------------------------------
26663. !ZoneListByLine!
26664. ----------------------------------------------------------
26665. Zone Processing Step:
26666. !ZoneStepByLine!    
26667. ----------------------------------------------------------
26668. Current Zone:
26669. !ZoneFooter!
26670. ----------------------------------------------------------
26671. Volume Statistics:
26672. !VolumeStatisticsDetail!
26673. ----------------------------------------------------------
26674. Zone Detailed Report:
26675. ----------------------------------------------------------
26676. !ZoneStatisticsDetail!
26677. ----------------------------------------------------------
26678. ")
26679. 
26680. 
26681. 
26682. /* pause() */
26683. /* pause() */
26684. 
26685. 
26686. 
26687. 
26688. /* ---------------------------------------------------------- */
26689. 
26690. 
26691. /* ---------------------------------------------------------- */
26692. /* Zone 19 SpaceHogs (BLOBS) */
26693. # Script: DisplayColors - Zone Dark
26694. # Processed
26695. SetFileColor(All, Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
26696. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
26697. 
26698. # Light Green and Yellow
26699. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
26700. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
26701. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
26702. 
26703. # Script: DefragZoneTypeSpaceHogs
26704. /* ---------------------------------------------------------- */
26705. /* Zone SpaceHogs (BLOBS) */
26706. SetVariable(ZoneLabel, "!ZoneLabelSpaceHogs!")
26707. SetVariable(ZoneDescription, "!ZoneDescriptionSpaceHogs!")
26708. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSpaceHogs!")
26709. SetVariable(ZoneGapSize, "!ZoneGapSizeSpaceHogs!")
26710. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectSpaceHogs
26711. # SpaceHogs start.
26712. not(
26713. # Archives start.
26714. (
26715.   DirectoryName("*Archive*")
26716.   or DirectoryName("*History*")
26717.   or DirectoryName("*Old")
26718.   or DirectoryName("* Old *")
26719.   or DirectoryName("Old *")
26720. 
26721.   or FileName("*.7z")
26722.   or FileName("*.cab")
26723.   or FileName("*.iso")
26724.   or FileName("*.msi")
26725.   or FileName("*.old")
26726.   or FileName("*.rar")
26727.   or FileName("*.tar")
26728.   or FileName("*.zip")
26729.   or
26730. # WinSysLow start.
26731. (
26732.   DirectoryName("$*")
26733.   or DirectoryName("0*")
26734.   or DirectoryName("1*")
26735.   or DirectoryName("2*")
26736.   or DirectoryName("3*")
26737.   or DirectoryName("4*")
26738.   or DirectoryName("5*")
26739.   or DirectoryName("6*")
26740.   or DirectoryName("7*")
26741.   or DirectoryName("8*")
26742.   or DirectoryName("9*")
26743. 
26744.   or DirectoryName("dllcache")
26745.   or DirectoryName("Downloaded Installations")
26746.   or DirectoryName("Ehome")
26747.   or DirectoryName("Fonts")
26748.   or DirectoryName("Help")
26749.   or DirectoryName("I386")
26750.   or DirectoryName("ie?updates")
26751.   or DirectoryName("Installer")
26752.   or DirectoryName("Installshield Installation Information")
26753.   or DirectoryName("IME")
26754.   or DirectoryName("*RECYCLE*")
26755.   or DirectoryName("ServicePackFiles")
26756.   or DirectoryName("SoftwareDistribution")
26757.   or DirectoryName("Speech")
26758.   or DirectoryName("Symbols")
26759.   or DirectoryName("System Volume Information")
26760.   or DirectoryName("windows.old")
26761. )
26762. # WinSysLow end.
26763. 
26764.   # Archives
26765. )
26766. # Archives end.
26767. 
26768. or 
26769. # Backups start.
26770. (
26771.   DirectoryName("*Backup*")
26772.   or DirectoryName("*Bu")
26773.   or DirectoryName("* Bu *")
26774.   or DirectoryName("Bu *")
26775. 
26776.   or FileName("*.bak")
26777.   or FileName("* - Copy*")
26778. )
26779. # Backups end.
26780. 
26781. # SpaceHogs
26782. ) and (
26783. # Blobs start.
26784. (
26785. # BlobsAndExceptions start.
26786. ( not(
26787.   FileName("*.bat")
26788.   or FileName("*.css")
26789.   or FileName("*.dll")
26790.   or FileName("*.exe")
26791.   or FileName("*.htm*")
26792.   or FileName("*.jar")
26793.   or FileName("*.js")
26794.   or FileName("*.script")
26795.   or FileName("*.wsf")
26796.   or (
26797. # Databases start.
26798. (
26799.   FileName("*.crypt*")
26800.   or FileName("*.db*")
26801.   or FileName("*.rdb*")
26802.   or FileName("*.dc*")
26803.   or FileName("*.dict*")
26804.   or FileName("*.?db*")
26805.   or FileName("*.?rdb*")
26806.   or FileName("*.md*")
26807.   or FileName("*.myd")
26808.   or FileName("*.ndf")
26809.   or FileName("*.ns?")
26810.   or FileName("*.pab")
26811.   or FileName("*.pst")
26812.   or FileName("*.sd?*")
26813.   or FileName("*.sq**")
26814.   or FileName("*.tmd")
26815.   or FileName("*.tps")
26816.   or FileName("*.tr*")
26817. )
26818. # Databases end.
26819. 
26820.     # BlobsAndExceptions
26821.     or 
26822. # Data start.
26823. (
26824.   DirectoryName("Data*")
26825.   or DirectoryName("Device*")
26826.   or DirectoryName("Export*")
26827.   or DirectoryName("Import*")
26828.   or DirectoryName("Log*")
26829.   or DirectoryName("*Log")
26830.   or DirectoryName("Maintenance*")
26831.   or DirectoryName("Rec*")
26832.   or DirectoryName("Sales*")
26833.   or DirectoryName("Search*")
26834.   or DirectoryName("User*")
26835. )
26836. # Data end.
26837. 
26838.     # BlobsAndExceptions
26839.   )
26840. ) )
26841. # BlobsAndExceptions end.
26842. 
26843. # Blobs
26844. ) and (
26845.   Size(BlobFileSize,0)
26846.   or (
26847.     FileName("*.arj")
26848.     or FileName("*.bup")
26849.     or FileName("*.bz2")
26850.     or FileName("*.chm")
26851.     or FileName("*.dvr-ms")
26852.     or FileName("*.gz")
26853.     or FileName("*.ifo")
26854.     or FileName("*.lzh")
26855.     or FileName("*.pdf")
26856.     or FileName("*.rpm")
26857.     or FileName("*.wmv")
26858.     or FileName("*.vob")
26859.     or FileName("*.z")
26860.   ) 
26861. )
26862. # Blobs end.
26863. 
26864. # SpaceHogs
26865. ) 
26866. # SpaceHogs end.
26867. ')
26868. 
26869. /* Note: This should be all Blob Files but not archives and backups */
26870. /* It does not matter in my case because given the sorting the */
26871. /* "z Archive", "z Bu" and "z Backup" directories sort to the end. */
26872. 
26873. 	# Script: ZoneDoHeader
26874. 
26875. # Script: ZoneWhenStarted
26876. 
26877. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
26878. # Script: DisplaySetZone
26879. 
26880. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
26881. SetVariable(FileStepDescription,	"")
26882. 
26883. SetVariable(ZoneStepByLine, 			"Zone started.
26884. ")
26885. 
26886. # Script: BannerDescriptionSet
26887. 
26888. # Script: BannerSet
26889. 
26890. # Script: DisplaySetDateTimeRun
26891. 
26892. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
26893. /* Xinclude "..\Display\BannerSet.MyDc"X */
26894. /* pause(1) */
26895. 
26896. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
26897. 
26898. Title('!Heading!')
26899. /* pause(1) */
26900. 
26901. /* NOTE: Can't round or truncate to integer precision. */
26902. 
26903. # Script: BannerLog
26904. 
26905. AppendLogfile("!LogFileName!", "!Title!")
26906. 
26907. 
26908. 
26909. pause(1)
26910. 
26911. 
26912. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
26913. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
26914. 
26915. SetVariable(ZoneStepNoCurrent, 0)
26916. 
26917. 
26918. # Script: ZoneDoCurrentClear
26919. 
26920. SetVariable(ZoneTypeSelectCurrent, 		"")
26921. 
26922. SetVariable(ZoneBeginCurrent, 			0)
26923. SetVariable(ZoneBeginPerCurrent, 		0)
26924. SetVariable(ZoneEndCurrent, 			0)
26925. SetVariable(ZoneEndPerCurrent, 			0)
26926. 
26927. SetVariable(ZoneSizeCurrent,			0)
26928. SetVariable(ZoneSizePerCurrent,			0)
26929. 
26930. SetVariable(ZoneGapRequestedCurrent,	0)
26931. SetVariable(ZoneGapRoundedCurrent, 		0)
26932. SetVariable(ZoneGapAdjustedCurrent, 	0)
26933. SetVariable(ZoneGapAvailableCurrent, 	0)
26934. SetVariable(ZoneGapCurrent,				0)
26935. SetVariable(ZoneGapUsedCurrent, 		0)
26936. 
26937. SetVariable(ZoneGapActualCurrent, 		0)
26938. SetVariable(ZoneGapActualPerCurrent, 	0)
26939. 
26940. SetVariable(ZoneSizeActual, 			0)
26941. SetVariable(ZoneSizeActualCurrent,		0)
26942. 
26943. SetVariable(ZoneEndActual, 				0)
26944. SetVariable(ZoneEndActualCurrent,		0)			
26945. SetVariable(ZoneSizeActualPerCurrent, 	0)
26946.       
26947. SetVariable(ZoneFilesFolders,			0)
26948. SetVariable(ZoneFilesFoldersPer,		0) 
26949. 
26950. SetVariable(ZoneFragments,				0)
26951. SetVariable(ZoneFragmentsPer,			0) 
26952. 		
26953. SetVariable(ZoneEndActualCurrent, 		0)
26954. SetVariable(ZoneEndActualPerCurrent, 	0)
26955. 
26956. # Gap Calculation Methodology:
26957. 	# Requested
26958. 	SetVariable(GapRequested, 			0) 
26959. 	SetVariable(GapRequestedStd, 		0) 
26960. 	SetVariable(GapRequestedMft, 		0) 
26961. 	SetVariable(GapRequestedOs, 		0) 
26962. 	SetVariable(GapRequestedOriginal, 	0) 
26963. 	
26964. 	# Gap Adjustments
26965. 	SetVariable(GapRounded, 			0)
26966. 	# SetVariable(GapAdjusted, 			0)
26967. 	SetVariable(GapAvailable, 			0)
26968. 	SetVariable(GapCurrent, 			0)
26969. 	SetVariable(GapActual, 				0)
26970. 	SetVariable(GapUsed, 				0)
26971. 	
26972. 	# Gap Adjustments
26973. 	SetVariable(GapRoundedLoc, 			0)
26974. 	# SetVariable(GapAdjustedLoc, 		0)
26975. 	SetVariable(GapAvailableLoc, 		0)
26976. 	SetVariable(GapCurrentLoc, 			0)
26977. 	SetVariable(GapActualLoc,			0)
26978. 	SetVariable(GapUsedLoc,				0)
26979. 	
26980. 	# Space usage
26981. 	SetVariable(ZoneFreePerRequested, 	0)
26982. 	SetVariable(ZoneFreePerUsed, 		0)
26983. 
26984. # Gap Size & Rounding
26985. 	SetVariable(ZoneGapSizePer, 		0)
26986. 	SetVariable(ZoneVolRoundUpPer, 		0)
26987. 	
26988. 	# Free Space
26989. 	SetVariable(ZoneFreeUsedPer, 		0)
26990. 	SetVariable(ZoneFreeRequestedPer, 	0)
26991. 
26992. 
26993. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
26994. 
26995. # Footer:
26996. SetVariable(ZoneFooter, "----------------------------------------------------------
26997. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
26998. 
26999. Statistics Report:
27000. ------------------
27001.    Size:  
27002.    ------------------------
27003.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27004.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27005.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27006. 
27007.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27008.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27009. 
27010.    Location:
27011.    ------------------------
27012.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27013.              Files End: !ZoneEndCurrent!
27014.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27015.       
27016.    Gap Settings:
27017.    ------------------------
27018.          Gap Requested: !ZoneGapSizePer!%
27019.       Volume Rounding: !ZoneVolRoundUpPer!%
27020.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27021.                  
27022.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
27023.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
27024.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
27025.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
27026.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
27027.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
27028.      
27029.    Free Space after Zone:
27030.    ------------------------
27031.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27032.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27033.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27034. 
27035. Directory and Files Select:
27036. ---------------------------
27037. !ZoneTypeSelectCurrent!               
27038. ---------------------------
27039. ----------------------------------------------------------
27040. ")
27041. 
27042. # Script: BannerSet
27043. 
27044. # Script: DisplaySetDateTimeRun
27045. 
27046. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
27047. /* Xinclude "..\Display\BannerSet.MyDc"X */
27048. /* pause(1) */
27049. 
27050. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
27051. 
27052. Title('!Heading!')
27053. /* pause(1) */
27054. 
27055. /* NOTE: Can't round or truncate to integer precision. */
27056. 
27057. # Script: BannerLog
27058. 
27059. AppendLogfile("!LogFileName!", "!Title!")
27060. 
27061. 
27062. 
27063. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
27064. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
27065. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:22")
27066. 
27067. SetVariable(ZoneListByLine, "!ZoneListByLine!
27068. Zone: !ZoneNoCurrent! 2021-11-13 20:31:22 0:00:05 !ZoneLabel! !ZoneDescription!")
27069. 
27070. 
27071. /* Fixed Zone Position Handling */
27072. /* Literal number: */
27073. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
27074. /* Percentage of disk: */
27075. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
27076. /* Gap */
27077. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
27078. 
27079. /* ---------------------------------------------------------- */
27080. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
27081. # Script: DisplaySetFileStep
27082. 
27083. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27084. 
27085. /* add message and move to a new line. */
27086. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27087. ")
27088. 
27089. /* display the line. (hopefully.) */
27090. # Zone Footer Set Statistics Window Text
27091. 
27092. SetStatisticsWindowText("!Heading!
27093. ----------------------------------------------------------
27094. Zones Processed: 
27095. ----------------------------------------------------------
27096. !ZoneListByLine!
27097. ----------------------------------------------------------
27098. Zone Processing Step:
27099. !ZoneStepByLine!    
27100. ----------------------------------------------------------
27101. Current Zone:
27102. !ZoneFooter!
27103. ----------------------------------------------------------
27104. Volume Statistics:
27105. !VolumeStatisticsDetail!
27106. ----------------------------------------------------------
27107. Zone Detailed Report:
27108. ----------------------------------------------------------
27109. !ZoneStatisticsDetail!
27110. ----------------------------------------------------------
27111. ")
27112. 
27113. 
27114. 
27115. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27116. 
27117. # Script: BannerSet
27118. 
27119. # Script: DisplaySetDateTimeRun
27120. 
27121. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
27122. /* Xinclude "..\Display\BannerSet.MyDc"X */
27123. /* pause(1) */
27124. 
27125. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
27126. 
27127. Title('!Heading!')
27128. /* pause(1) */
27129. 
27130. /* NOTE: Can't round or truncate to integer precision. */
27131. 
27132. pause(1)
27133. 
27134. # your stuff HERE (X)... pre file select code.
27135. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
27136. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
27137. 	# (X)
27138. 
27139. FileSelect
27140. 
27141. 	# your stuff can't really go here (errors.)
27142. 	# maybe for some reason I don't know of...
27143. 	
27144. 	# Actions next...
27145. 	# Script: ZoneDo ZoneTypeSelectSpaceHogs
27146. # SpaceHogs start.
27147. not(
27148. # Archives start.
27149. (
27150.   DirectoryName("*Archive*")
27151.   or DirectoryName("*History*")
27152.   or DirectoryName("*Old")
27153.   or DirectoryName("* Old *")
27154.   or DirectoryName("Old *")
27155. 
27156.   or FileName("*.7z")
27157.   or FileName("*.cab")
27158.   or FileName("*.iso")
27159.   or FileName("*.msi")
27160.   or FileName("*.old")
27161.   or FileName("*.rar")
27162.   or FileName("*.tar")
27163.   or FileName("*.zip")
27164.   or
27165. # WinSysLow start.
27166. (
27167.   DirectoryName("$*")
27168.   or DirectoryName("0*")
27169.   or DirectoryName("1*")
27170.   or DirectoryName("2*")
27171.   or DirectoryName("3*")
27172.   or DirectoryName("4*")
27173.   or DirectoryName("5*")
27174.   or DirectoryName("6*")
27175.   or DirectoryName("7*")
27176.   or DirectoryName("8*")
27177.   or DirectoryName("9*")
27178. 
27179.   or DirectoryName("dllcache")
27180.   or DirectoryName("Downloaded Installations")
27181.   or DirectoryName("Ehome")
27182.   or DirectoryName("Fonts")
27183.   or DirectoryName("Help")
27184.   or DirectoryName("I386")
27185.   or DirectoryName("ie?updates")
27186.   or DirectoryName("Installer")
27187.   or DirectoryName("Installshield Installation Information")
27188.   or DirectoryName("IME")
27189.   or DirectoryName("*RECYCLE*")
27190.   or DirectoryName("ServicePackFiles")
27191.   or DirectoryName("SoftwareDistribution")
27192.   or DirectoryName("Speech")
27193.   or DirectoryName("Symbols")
27194.   or DirectoryName("System Volume Information")
27195.   or DirectoryName("windows.old")
27196. )
27197. # WinSysLow end.
27198. 
27199.   # Archives
27200. )
27201. # Archives end.
27202. 
27203. or 
27204. # Backups start.
27205. (
27206.   DirectoryName("*Backup*")
27207.   or DirectoryName("*Bu")
27208.   or DirectoryName("* Bu *")
27209.   or DirectoryName("Bu *")
27210. 
27211.   or FileName("*.bak")
27212.   or FileName("* - Copy*")
27213. )
27214. # Backups end.
27215. 
27216. # SpaceHogs
27217. ) and (
27218. # Blobs start.
27219. (
27220. # BlobsAndExceptions start.
27221. ( not(
27222.   FileName("*.bat")
27223.   or FileName("*.css")
27224.   or FileName("*.dll")
27225.   or FileName("*.exe")
27226.   or FileName("*.htm*")
27227.   or FileName("*.jar")
27228.   or FileName("*.js")
27229.   or FileName("*.script")
27230.   or FileName("*.wsf")
27231.   or (
27232. # Databases start.
27233. (
27234.   FileName("*.crypt*")
27235.   or FileName("*.db*")
27236.   or FileName("*.rdb*")
27237.   or FileName("*.dc*")
27238.   or FileName("*.dict*")
27239.   or FileName("*.?db*")
27240.   or FileName("*.?rdb*")
27241.   or FileName("*.md*")
27242.   or FileName("*.myd")
27243.   or FileName("*.ndf")
27244.   or FileName("*.ns?")
27245.   or FileName("*.pab")
27246.   or FileName("*.pst")
27247.   or FileName("*.sd?*")
27248.   or FileName("*.sq**")
27249.   or FileName("*.tmd")
27250.   or FileName("*.tps")
27251.   or FileName("*.tr*")
27252. )
27253. # Databases end.
27254. 
27255.     # BlobsAndExceptions
27256.     or 
27257. # Data start.
27258. (
27259.   DirectoryName("Data*")
27260.   or DirectoryName("Device*")
27261.   or DirectoryName("Export*")
27262.   or DirectoryName("Import*")
27263.   or DirectoryName("Log*")
27264.   or DirectoryName("*Log")
27265.   or DirectoryName("Maintenance*")
27266.   or DirectoryName("Rec*")
27267.   or DirectoryName("Sales*")
27268.   or DirectoryName("Search*")
27269.   or DirectoryName("User*")
27270. )
27271. # Data end.
27272. 
27273.     # BlobsAndExceptions
27274.   )
27275. ) )
27276. # BlobsAndExceptions end.
27277. 
27278. # Blobs
27279. ) and (
27280.   Size(BlobFileSize,0)
27281.   or (
27282.     FileName("*.arj")
27283.     or FileName("*.bup")
27284.     or FileName("*.bz2")
27285.     or FileName("*.chm")
27286.     or FileName("*.dvr-ms")
27287.     or FileName("*.gz")
27288.     or FileName("*.ifo")
27289.     or FileName("*.lzh")
27290.     or FileName("*.pdf")
27291.     or FileName("*.rpm")
27292.     or FileName("*.wmv")
27293.     or FileName("*.vob")
27294.     or FileName("*.z")
27295.   ) 
27296. )
27297. # Blobs end.
27298. 
27299. # SpaceHogs
27300. ) 
27301. # SpaceHogs end.
27302. 
27303. 	# Script: ZoneDoAction
27304. # Zone Do File Action - SortByName.
27305. 
27306. FileActions
27307. 
27308. 		/* ---------------------------------------------------------- */
27309. 	# Gap
27310. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
27311. 		# Script: DisplaySetFileStep
27312. 
27313. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27314. 
27315. /* add message and move to a new line. */
27316. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27317. ")
27318. 
27319. /* display the line. (hopefully.) */
27320. # Zone Footer Set Statistics Window Text
27321. 
27322. SetStatisticsWindowText("!Heading!
27323. ----------------------------------------------------------
27324. Zones Processed: 
27325. ----------------------------------------------------------
27326. !ZoneListByLine!
27327. ----------------------------------------------------------
27328. Zone Processing Step:
27329. !ZoneStepByLine!    
27330. ----------------------------------------------------------
27331. Current Zone:
27332. !ZoneFooter!
27333. ----------------------------------------------------------
27334. Volume Statistics:
27335. !VolumeStatisticsDetail!
27336. ----------------------------------------------------------
27337. Zone Detailed Report:
27338. ----------------------------------------------------------
27339. !ZoneStatisticsDetail!
27340. ----------------------------------------------------------
27341. ")
27342. 
27343. 
27344. 
27345. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27346. 
27347. # Script: BannerSet
27348. 
27349. # Script: DisplaySetDateTimeRun
27350. 
27351. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
27352. /* Xinclude "..\Display\BannerSet.MyDc"X */
27353. /* pause(1) */
27354. 
27355. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
27356. 
27357. Title('!Heading!')
27358. /* pause(1) */
27359. 
27360. /* NOTE: Can't round or truncate to integer precision. */
27361. 
27362. pause(1)
27363. 	
27364. 	# ACTUAL GAP
27365. 		/* AddGap Variant. */
27366. 	  	# Zone Do Gap
27367. # Gap Calculation Methods:
27368. 
27369. /* 1) Anything you need to add first. */
27370. /* empty */
27371. 
27372. /* ---------------------------------------------------------- */
27373. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
27374. 	# GapRequestedStd.
27375. 
27376. 		/* ---------------------------------------------------------- */
27377. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
27378. 
27379. 		# Gap Calculation Methods:
27380. 
27381. /* AddGap Variants */
27382. 
27383. 	/* Standard */
27384. 		# Gap Calculation Methods:
27385. 	/* AddGap Variants */
27386. 	/* Standard */
27387. 
27388. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
27389. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
27390. 
27391. 	SetVariable(GapRequested, GapRequestedStd)
27392. 	
27393. 
27394. 	/* MFT Low High Method */
27395. 		# Gap Calculation Methods:
27396. 	/* AddGap Variants */
27397. 	/* MFT Low High Method */
27398. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
27399. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
27400. 	SetVariable(GapRequested, GapRequestedMft)
27401. 	
27402. 
27403. 	/* OS Volume Type Method */
27404. 		# Gap Calculation Methods:
27405. 	/* AddGap Variants */
27406. 	/* OS Volume Type Method */
27407. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
27408. 	SetVariable(GapRequested, GapRequestedOs)
27409. 
27410. 
27411. 
27412. /* MakeGap Variants */
27413. 
27414. 	/* Original Os 1-3 + MFT 2 */
27415. 		# Gap Calculation Methods:
27416. 	/* MakeGap Variants */
27417. 	/* Original Os 1-3 + MFT 2 */
27418. 	/* plus MFT gap placed inline at the dividing zone. */
27419. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
27420. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
27421. 	SetVariable(GapRequested, GapRequestedOrig)
27422. 	
27423. 	
27424. /* Note: You could comment out the ones not in use */
27425. /* However having the data in the log is useful. */
27426. /* Therefore the following line is otherwise needed. */
27427. 
27428. /* Standard used */
27429. 
27430. SetVariable(GapRequested, GapRequestedStd)
27431. 
27432. # Gap Calculation Methods:
27433. 
27434. /* AddGap Variants */
27435. 	/* Standard */
27436. 	/* MFT Low High Method */
27437. 	/* OS Volume Type Method */
27438. 
27439. /* MakeGap Variants */
27440. 	/* Original Os 1-3 + MFT 2 */
27441. 
27442. /* Note: You could comment out the ones not in use */
27443. /* However having the data in the log is useful. */
27444. /* Therefore the following line is otherwise needed. */
27445. 
27446. /* Standard is used currently */
27447. 
27448. 
27449. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
27450. 
27451. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
27452. 
27453. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
27454. 
27455. /* ---------------------------------------------------------- */
27456. /* 3) SMALL ZONE ADJUSTMENT. */
27457. /* Gab cant be larger than half the Zone Size. */
27458. 
27459. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
27460. 	
27461. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
27462. 
27463. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
27464. 
27465. /* ---------------------------------------------------------- */
27466. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
27467. # Gap Adjustments.
27468. 
27469. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
27470. 	
27471. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
27472. 
27473. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
27474. 
27475. /* ---------------------------------------------------------- */
27476. # BYPASS THIS.
27477. 	/* This is definitely wrong. */
27478. 	/* The question is can we steal gap from the next zone */
27479. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
27480. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
27481. 		# Zone Overflow.
27482. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
27483. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
27484. 
27485. /* ---------------------------------------------------------- */
27486. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
27487. # Remaining free space available.
27488. 
27489. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
27490. 	
27491. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
27492. 
27493. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
27494. 
27495. /* ---------------------------------------------------------- */
27496. # CURRENT gap to use.
27497. 
27498. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
27499. 
27500. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
27501. 
27502. /* ---------------------------------------------------------- */
27503. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
27504. # Debugging.
27505. 
27506. 	SetVariable(GapUsed, GapCurrent) // for debugging
27507. 
27508. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
27509. 
27510. 		# Your code HERE
27511. 
27512. /* ---------------------------------------------------------- */
27513. /* 7) YOUR CODE. */
27514. # YOUR CODE HERE:
27515. 	# INPUT: GapCurrent or GapCurrentLoc
27516. 	# OUTPUT: GapUsed...
27517. 
27518. /* ---------------------------------------------------------- */
27519. # Gap Size.
27520. # Actual Size of Gap.
27521. 
27522. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
27523. 
27524. /* ---------------------------------------------------------- */
27525. /* xxxxxxxxxxxxxxxxxxxxxx */
27526. # ADD THE GAP
27527. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
27528. /* xxxxxxxxxxxxxxxxxxxxxx */
27529. 
27530. 	
27531. 	# Zone Statistics	
27532. 	# Script: ZoneDoStatistics
27533. # Zone / Volume Statistics and Display
27534. 		
27535. 	# Accumulate Totals
27536.   	# Script: ZoneDoVolumeTotals
27537. 
27538. /* Current total space used (by Zones and Gaps) */
27539. 
27540. SetVariable(VolumeZoneUsed, GapUsed)
27541. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
27542. /* Percentage */
27543. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
27544. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
27545. 
27546. /* Current total of free space requested */
27547. 
27548. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
27549. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
27550. /* Percent. */
27551. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
27552. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
27553. 
27554. /* Current total of free space used */
27555. 
27556. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
27557. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
27558. /* Percent */
27559. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
27560. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
27561. 
27562. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
27563. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
27564. /* Xinclude "..\DebugDisplayPause.MyDc"X */
27565. 
27566. 
27567. 	# Current Values
27568. 	# Script: ZoneDoCurrentSet
27569. 
27570. # Cluster, Sector, Block adjust for display.
27571. 	# Bytes per cluster is volume specific.
27572. 
27573. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
27574. 
27575. # Current Zone values.
27576. 	# Begin, end and size.
27577. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
27578. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
27579. 
27580. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
27581. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
27582. 
27583. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
27584. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
27585. 
27586. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
27587. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
27588. 
27589. 	SetVariable(ZoneFragments,				"!ZONE210N!")
27590. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
27591. 		
27592. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
27593. /* identical code to here: (separation not needed. TEST.) */	
27594. 
27595. # Current Gap, Actual and Free Values
27596. 	# Gap
27597. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
27598. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
27599. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
27600. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
27601. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
27602. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
27603. 	
27604. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
27605. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
27606. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
27607. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
27608. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
27609. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
27610. 	
27611. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
27612. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
27613. 	
27614. 	# Actual Size and End
27615. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
27616. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
27617. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
27618. 	
27619. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
27620. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
27621. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
27622. 
27623. # Gap Size & Rounding
27624. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
27625. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
27626. 	
27627. 	# Free Space
27628. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
27629. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
27630. 
27631. 	# Footer:
27632. SetVariable(ZoneFooter, "----------------------------------------------------------
27633. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
27634. 
27635. Statistics Report:
27636. ------------------
27637.    Size:  
27638.    ------------------------
27639.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27640.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27641.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27642. 
27643.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27644.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27645. 
27646.    Location:
27647.    ------------------------
27648.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27649.              Files End: !ZoneEndCurrent!
27650.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27651.       
27652.    Gap Settings:
27653.    ------------------------
27654.          Gap Requested: !ZoneGapSizePer!%
27655.       Volume Rounding: !ZoneVolRoundUpPer!%
27656.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27657.                  
27658.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
27659.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
27660.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
27661.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
27662.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
27663.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
27664.      
27665.    Free Space after Zone:
27666.    ------------------------
27667.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27668.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27669.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27670. 
27671. Directory and Files Select:
27672. ---------------------------
27673. !ZoneTypeSelectCurrent!               
27674. ---------------------------
27675. ----------------------------------------------------------
27676. ")
27677. 	# Zone Footer Set Statistics Window Text
27678. 
27679. SetStatisticsWindowText("!Heading!
27680. ----------------------------------------------------------
27681. Zones Processed: 
27682. ----------------------------------------------------------
27683. !ZoneListByLine!
27684. ----------------------------------------------------------
27685. Zone Processing Step:
27686. !ZoneStepByLine!    
27687. ----------------------------------------------------------
27688. Current Zone:
27689. !ZoneFooter!
27690. ----------------------------------------------------------
27691. Volume Statistics:
27692. !VolumeStatisticsDetail!
27693. ----------------------------------------------------------
27694. Zone Detailed Report:
27695. ----------------------------------------------------------
27696. !ZoneStatisticsDetail!
27697. ----------------------------------------------------------
27698. ")
27699. 
27700. 
27701. 	
27702.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
27703. 
27704. 	# Add Zone to list of zones for display.
27705. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
27706. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
27707. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
27708. 	# ??? Free Stats?
27709. 	# Footer:
27710. SetVariable(ZoneFooter, "----------------------------------------------------------
27711. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
27712. 
27713. Statistics Report:
27714. ------------------
27715.    Size:  
27716.    ------------------------
27717.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27718.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27719.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27720. 
27721.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27722.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27723. 
27724.    Location:
27725.    ------------------------
27726.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27727.              Files End: !ZoneEndCurrent!
27728.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27729.       
27730.    Gap Settings:
27731.    ------------------------
27732.          Gap Requested: !ZoneGapSizePer!%
27733.       Volume Rounding: !ZoneVolRoundUpPer!%
27734.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27735.                  
27736.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
27737.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
27738.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
27739.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
27740.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
27741.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
27742.      
27743.    Free Space after Zone:
27744.    ------------------------
27745.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27746.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27747.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27748. 
27749. Directory and Files Select:
27750. ---------------------------
27751. !ZoneTypeSelectCurrent!               
27752. ---------------------------
27753. ----------------------------------------------------------
27754. ")
27755. 
27756. 	# Add Zone Details to Report.	
27757. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
27758. !ZoneFooter!")
27759. 
27760. 
27761. 	
27762. 	# Footer:
27763. SetVariable(ZoneFooter, "----------------------------------------------------------
27764. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
27765. 
27766. Statistics Report:
27767. ------------------
27768.    Size:  
27769.    ------------------------
27770.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27771.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27772.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27773. 
27774.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27775.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27776. 
27777.    Location:
27778.    ------------------------
27779.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27780.              Files End: !ZoneEndCurrent!
27781.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27782.       
27783.    Gap Settings:
27784.    ------------------------
27785.          Gap Requested: !ZoneGapSizePer!%
27786.       Volume Rounding: !ZoneVolRoundUpPer!%
27787.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27788.                  
27789.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
27790.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
27791.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
27792.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
27793.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
27794.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
27795.      
27796.    Free Space after Zone:
27797.    ------------------------
27798.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27799.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27800.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27801. 
27802. Directory and Files Select:
27803. ---------------------------
27804. !ZoneTypeSelectCurrent!               
27805. ---------------------------
27806. ----------------------------------------------------------
27807. ")
27808. 	SetStatisticsWindowText("!ZoneFooter!")
27809. 	
27810. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
27811. 	# Script: DisplaySetFileStep
27812. 
27813. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27814. 
27815. /* add message and move to a new line. */
27816. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27817. ")
27818. 
27819. /* display the line. (hopefully.) */
27820. # Zone Footer Set Statistics Window Text
27821. 
27822. SetStatisticsWindowText("!Heading!
27823. ----------------------------------------------------------
27824. Zones Processed: 
27825. ----------------------------------------------------------
27826. !ZoneListByLine!
27827. ----------------------------------------------------------
27828. Zone Processing Step:
27829. !ZoneStepByLine!    
27830. ----------------------------------------------------------
27831. Current Zone:
27832. !ZoneFooter!
27833. ----------------------------------------------------------
27834. Volume Statistics:
27835. !VolumeStatisticsDetail!
27836. ----------------------------------------------------------
27837. Zone Detailed Report:
27838. ----------------------------------------------------------
27839. !ZoneStatisticsDetail!
27840. ----------------------------------------------------------
27841. ")
27842. 
27843. 
27844. 
27845. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27846. 
27847. # Script: BannerSet
27848. 
27849. # Script: DisplaySetDateTimeRun
27850. 
27851. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
27852. /* Xinclude "..\Display\BannerSet.MyDc"X */
27853. /* pause(1) */
27854. 
27855. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
27856. 
27857. Title('!Heading!')
27858. /* pause(1) */
27859. 
27860. /* NOTE: Can't round or truncate to integer precision. */
27861. 
27862. pause(1)
27863. 
27864. # Commands:
27865. 
27866. /* Moves to Zone or above it. */
27867. # MoveUpToZone()
27868. 
27869. # Defrag
27870. 
27871. # Defragment(OPTIONS)
27872. 
27873. /* Shuffles files around trying to make a big enough gap for fragmented files. */
27874. # Defragment()
27875. 
27876. /* Only does files where a gap will fit it. */
27877. # Defragment(Fast)
27878. 
27879. /* Skips fragmented files larger than the Chunck Size. */
27880. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
27881. # Defragment(Chunk Size)
27882. 
27883. /* Moves down to zone and packs zone to beginning if there are gaps. */
27884. /* Can be similar in performance to doing a SortBy. */
27885. # MoveDownFill()
27886. 
27887. # File Action - All - Fast - MoveUpToZone.
27888. 	MoveUpToZone()
27889. 	
27890. 
27891. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
27892. 	# Script: DisplaySetFileStep
27893. 
27894. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27895. 
27896. /* add message and move to a new line. */
27897. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27898. ")
27899. 
27900. /* display the line. (hopefully.) */
27901. # Zone Footer Set Statistics Window Text
27902. 
27903. SetStatisticsWindowText("!Heading!
27904. ----------------------------------------------------------
27905. Zones Processed: 
27906. ----------------------------------------------------------
27907. !ZoneListByLine!
27908. ----------------------------------------------------------
27909. Zone Processing Step:
27910. !ZoneStepByLine!    
27911. ----------------------------------------------------------
27912. Current Zone:
27913. !ZoneFooter!
27914. ----------------------------------------------------------
27915. Volume Statistics:
27916. !VolumeStatisticsDetail!
27917. ----------------------------------------------------------
27918. Zone Detailed Report:
27919. ----------------------------------------------------------
27920. !ZoneStatisticsDetail!
27921. ----------------------------------------------------------
27922. ")
27923. 
27924. 
27925. 
27926. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27927. 
27928. # Script: BannerSet
27929. 
27930. # Script: DisplaySetDateTimeRun
27931. 
27932. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
27933. /* Xinclude "..\Display\BannerSet.MyDc"X */
27934. /* pause(1) */
27935. 
27936. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
27937. 
27938. Title('!Heading!')
27939. /* pause(1) */
27940. 
27941. /* NOTE: Can't round or truncate to integer precision. */
27942. 
27943. pause(1)
27944. 
27945. 	# Script: ZoneDoFooter
27946. 
27947. /* ---------------------------------------------------------- */
27948. # File Select
27949. 	# Select Statments
27950. # File Actions 
27951. 	# Standard or OS File Actions.
27952. 	# Resume...
27953. 	
27954. 	# your stuff HERE (X)... post zone (file) file actions code.
27955. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
27956. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
27957. 		# (X)
27958. 		
27959. 		/* ??? Set window? */
27960. 	
27961. 	# ADD THE GAP
27962. # Vacate (good for diagnostics)
27963. # DoNotVacate - DO NOT Vacate (recommended)
27964. # DoNotVacate - DO NOT Vacate (recommended)
27965. 
27966. # Vacate
27967. /* AddGap(GapUsedLoc) */
27968. 
27969. # DO Not Vacate
27970. AddGap(GapUsedLoc, DoNotVacate) 
27971. 	
27972. 	
27973. # Script: GapZoneCommand
27974. # *** Moved to setting yours ***
27975. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
27976. # Controlled via settings commands
27977. # DoNotVacate - DO NOT Vacate (recommended)
27978. 
27979. # Vacate
27980. /* AddGap(GapUsedLoc) */
27981. 
27982. # DO Not Vacate
27983. AddGap(GapUsedLoc, DoNotVacate) 
27984. 	
27985. 	
27986. # Vacate /* AddGap(GapUsed) */
27987. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
27988. 	
27989. 
27990. 		
27991. # 
27992. FileEnd
27993. /* ---------------------------------------------------------- */
27994. 
27995. # your stuff HERE (X)... post zone (file) code.
27996. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
27997. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
27998. 	# (X)
27999. 
28000. SetVariable(FileStepDescription,"Zone finished, reporting.")
28001. # Script: DisplaySetFileStep
28002. 
28003. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
28004. 
28005. /* add message and move to a new line. */
28006. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
28007. ")
28008. 
28009. /* display the line. (hopefully.) */
28010. # Zone Footer Set Statistics Window Text
28011. 
28012. SetStatisticsWindowText("!Heading!
28013. ----------------------------------------------------------
28014. Zones Processed: 
28015. ----------------------------------------------------------
28016. !ZoneListByLine!
28017. ----------------------------------------------------------
28018. Zone Processing Step:
28019. !ZoneStepByLine!    
28020. ----------------------------------------------------------
28021. Current Zone:
28022. !ZoneFooter!
28023. ----------------------------------------------------------
28024. Volume Statistics:
28025. !VolumeStatisticsDetail!
28026. ----------------------------------------------------------
28027. Zone Detailed Report:
28028. ----------------------------------------------------------
28029. !ZoneStatisticsDetail!
28030. ----------------------------------------------------------
28031. ")
28032. 
28033. 
28034. 
28035. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
28036. 
28037. # Script: BannerSet
28038. 
28039. # Script: DisplaySetDateTimeRun
28040. 
28041. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
28042. /* Xinclude "..\Display\BannerSet.MyDc"X */
28043. /* pause(1) */
28044. 
28045. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
28046. 
28047. Title('!Heading!')
28048. /* pause(1) */
28049. 
28050. /* NOTE: Can't round or truncate to integer precision. */
28051. 
28052. pause(1)
28053. 
28054. # Script: ZoneWhenFinished
28055. 
28056. # Script: BannerSet
28057. 
28058. # Script: DisplaySetDateTimeRun
28059. 
28060. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
28061. /* Xinclude "..\Display\BannerSet.MyDc"X */
28062. /* pause(1) */
28063. 
28064. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
28065. 
28066. Title('!Heading!')
28067. /* pause(1) */
28068. 
28069. /* NOTE: Can't round or truncate to integer precision. */
28070. 
28071. # Script: BannerLog
28072. 
28073. AppendLogfile("!LogFileName!", "!Title!")
28074. 
28075. 
28076. 
28077. # Zone Statistics	
28078. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
28079. 
28080. # Footer:
28081. SetVariable(ZoneFooter, "----------------------------------------------------------
28082. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
28083. 
28084. Statistics Report:
28085. ------------------
28086.    Size:  
28087.    ------------------------
28088.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
28089.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
28090.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
28091. 
28092.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
28093.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
28094. 
28095.    Location:
28096.    ------------------------
28097.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
28098.              Files End: !ZoneEndCurrent!
28099.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
28100.       
28101.    Gap Settings:
28102.    ------------------------
28103.          Gap Requested: !ZoneGapSizePer!%
28104.       Volume Rounding: !ZoneVolRoundUpPer!%
28105.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
28106.                  
28107.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
28108.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
28109.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
28110.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
28111.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
28112.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
28113.      
28114.    Free Space after Zone:
28115.    ------------------------
28116.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
28117.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
28118.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
28119. 
28120. Directory and Files Select:
28121. ---------------------------
28122. !ZoneTypeSelectCurrent!               
28123. ---------------------------
28124. ----------------------------------------------------------
28125. ")
28126. 
28127. AppendLogfile("!LogFileName!", ".")
28128. AppendLogfile("!LogFileName!", "!ZoneFooter!")
28129. AppendLogfile("!LogFileName!", ".")
28130. 
28131. # Zone Footer Set Statistics Window Text
28132. 
28133. SetStatisticsWindowText("!Heading!
28134. ----------------------------------------------------------
28135. Zones Processed: 
28136. ----------------------------------------------------------
28137. !ZoneListByLine!
28138. ----------------------------------------------------------
28139. Zone Processing Step:
28140. !ZoneStepByLine!    
28141. ----------------------------------------------------------
28142. Current Zone:
28143. !ZoneFooter!
28144. ----------------------------------------------------------
28145. Volume Statistics:
28146. !VolumeStatisticsDetail!
28147. ----------------------------------------------------------
28148. Zone Detailed Report:
28149. ----------------------------------------------------------
28150. !ZoneStatisticsDetail!
28151. ----------------------------------------------------------
28152. ")
28153. 
28154. 
28155. 
28156. /* pause() */
28157. /* pause() */
28158. 
28159. 
28160. 
28161. 
28162. /* ---------------------------------------------------------- */
28163. 
28164. 
28165. /* ---------------------------------------------------------- */
28166. /* Zone 20 ArchivesBu (All) Archives and Backups*/
28167. # Script: DisplayColors - Zone Dark
28168. # Processed
28169. SetFileColor(All, Processed and not(Fragmented),			0, 		255, 	255)	// Deep sky blue (Light)
28170. SetFileColor(All, Processed and Fragmented,				170,	89,		221)	// Purple
28171. 
28172. # Light Green and Yellow
28173. SetFileColor(All, Selected,								152,	251, 	152)	// Light Green
28174. SetFileColor(All, Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
28175. SetFileColor(All, Selected and not(Movable),				255,	115,	115)	// Light red
28176. 
28177. # Script: DefragZoneTypeArchivesBu
28178. /* ---------------------------------------------------------- */
28179. /* Zone ArchivesBu (All) Archives and Backups*/
28180. 
28181. SetVariable(ZoneLabel, "!ZoneLabelArchivesBu!")
28182. SetVariable(ZoneDescription, "!ZoneDescriptionArchivesBu!")
28183. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpArchivesBu!")
28184. SetVariable(ZoneGapSize, "!ZoneGapSizeArchivesBu!")
28185. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectArchivesBu
28186. # ArchivesBu start.
28187. all
28188. # ArchivesBu end.
28189. ')
28190. 
28191. /* Note: This should be all Blob archives and backups */
28192. /* The sorting the "z Archive", "z Bu" and "z Backup" directories */
28193. /* sort to the very end of the Volume. */
28194. 
28195. 	# Script: ZoneDoHeader
28196. 
28197. # Script: ZoneWhenStarted
28198. 
28199. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
28200. # Script: DisplaySetZone
28201. 
28202. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
28203. SetVariable(FileStepDescription,	"")
28204. 
28205. SetVariable(ZoneStepByLine, 			"Zone started.
28206. ")
28207. 
28208. # Script: BannerDescriptionSet
28209. 
28210. # Script: BannerSet
28211. 
28212. # Script: DisplaySetDateTimeRun
28213. 
28214. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
28215. /* Xinclude "..\Display\BannerSet.MyDc"X */
28216. /* pause(1) */
28217. 
28218. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
28219. 
28220. Title('!Heading!')
28221. /* pause(1) */
28222. 
28223. /* NOTE: Can't round or truncate to integer precision. */
28224. 
28225. # Script: BannerLog
28226. 
28227. AppendLogfile("!LogFileName!", "!Title!")
28228. 
28229. 
28230. 
28231. pause(1)
28232. 
28233. 
28234. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
28235. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
28236. 
28237. SetVariable(ZoneStepNoCurrent, 0)
28238. 
28239. 
28240. # Script: ZoneDoCurrentClear
28241. 
28242. SetVariable(ZoneTypeSelectCurrent, 		"")
28243. 
28244. SetVariable(ZoneBeginCurrent, 			0)
28245. SetVariable(ZoneBeginPerCurrent, 		0)
28246. SetVariable(ZoneEndCurrent, 			0)
28247. SetVariable(ZoneEndPerCurrent, 			0)
28248. 
28249. SetVariable(ZoneSizeCurrent,			0)
28250. SetVariable(ZoneSizePerCurrent,			0)
28251. 
28252. SetVariable(ZoneGapRequestedCurrent,	0)
28253. SetVariable(ZoneGapRoundedCurrent, 		0)
28254. SetVariable(ZoneGapAdjustedCurrent, 	0)
28255. SetVariable(ZoneGapAvailableCurrent, 	0)
28256. SetVariable(ZoneGapCurrent,				0)
28257. SetVariable(ZoneGapUsedCurrent, 		0)
28258. 
28259. SetVariable(ZoneGapActualCurrent, 		0)
28260. SetVariable(ZoneGapActualPerCurrent, 	0)
28261. 
28262. SetVariable(ZoneSizeActual, 			0)
28263. SetVariable(ZoneSizeActualCurrent,		0)
28264. 
28265. SetVariable(ZoneEndActual, 				0)
28266. SetVariable(ZoneEndActualCurrent,		0)			
28267. SetVariable(ZoneSizeActualPerCurrent, 	0)
28268.       
28269. SetVariable(ZoneFilesFolders,			0)
28270. SetVariable(ZoneFilesFoldersPer,		0) 
28271. 
28272. SetVariable(ZoneFragments,				0)
28273. SetVariable(ZoneFragmentsPer,			0) 
28274. 		
28275. SetVariable(ZoneEndActualCurrent, 		0)
28276. SetVariable(ZoneEndActualPerCurrent, 	0)
28277. 
28278. # Gap Calculation Methodology:
28279. 	# Requested
28280. 	SetVariable(GapRequested, 			0) 
28281. 	SetVariable(GapRequestedStd, 		0) 
28282. 	SetVariable(GapRequestedMft, 		0) 
28283. 	SetVariable(GapRequestedOs, 		0) 
28284. 	SetVariable(GapRequestedOriginal, 	0) 
28285. 	
28286. 	# Gap Adjustments
28287. 	SetVariable(GapRounded, 			0)
28288. 	# SetVariable(GapAdjusted, 			0)
28289. 	SetVariable(GapAvailable, 			0)
28290. 	SetVariable(GapCurrent, 			0)
28291. 	SetVariable(GapActual, 				0)
28292. 	SetVariable(GapUsed, 				0)
28293. 	
28294. 	# Gap Adjustments
28295. 	SetVariable(GapRoundedLoc, 			0)
28296. 	# SetVariable(GapAdjustedLoc, 		0)
28297. 	SetVariable(GapAvailableLoc, 		0)
28298. 	SetVariable(GapCurrentLoc, 			0)
28299. 	SetVariable(GapActualLoc,			0)
28300. 	SetVariable(GapUsedLoc,				0)
28301. 	
28302. 	# Space usage
28303. 	SetVariable(ZoneFreePerRequested, 	0)
28304. 	SetVariable(ZoneFreePerUsed, 		0)
28305. 
28306. # Gap Size & Rounding
28307. 	SetVariable(ZoneGapSizePer, 		0)
28308. 	SetVariable(ZoneVolRoundUpPer, 		0)
28309. 	
28310. 	# Free Space
28311. 	SetVariable(ZoneFreeUsedPer, 		0)
28312. 	SetVariable(ZoneFreeRequestedPer, 	0)
28313. 
28314. 
28315. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
28316. 
28317. # Footer:
28318. SetVariable(ZoneFooter, "----------------------------------------------------------
28319. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
28320. 
28321. Statistics Report:
28322. ------------------
28323.    Size:  
28324.    ------------------------
28325.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
28326.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
28327.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
28328. 
28329.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
28330.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
28331. 
28332.    Location:
28333.    ------------------------
28334.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
28335.              Files End: !ZoneEndCurrent!
28336.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
28337.       
28338.    Gap Settings:
28339.    ------------------------
28340.          Gap Requested: !ZoneGapSizePer!%
28341.       Volume Rounding: !ZoneVolRoundUpPer!%
28342.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
28343.                  
28344.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
28345.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
28346.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
28347.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
28348.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
28349.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
28350.      
28351.    Free Space after Zone:
28352.    ------------------------
28353.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
28354.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
28355.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
28356. 
28357. Directory and Files Select:
28358. ---------------------------
28359. !ZoneTypeSelectCurrent!               
28360. ---------------------------
28361. ----------------------------------------------------------
28362. ")
28363. 
28364. # Script: BannerSet
28365. 
28366. # Script: DisplaySetDateTimeRun
28367. 
28368. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
28369. /* Xinclude "..\Display\BannerSet.MyDc"X */
28370. /* pause(1) */
28371. 
28372. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
28373. 
28374. Title('!Heading!')
28375. /* pause(1) */
28376. 
28377. /* NOTE: Can't round or truncate to integer precision. */
28378. 
28379. # Script: BannerLog
28380. 
28381. AppendLogfile("!LogFileName!", "!Title!")
28382. 
28383. 
28384. 
28385. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
28386. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
28387. AppendLogfile("!LogFileName!", "Time: 2021-11-13 20:31:22")
28388. 
28389. SetVariable(ZoneListByLine, "!ZoneListByLine!
28390. Zone: !ZoneNoCurrent! 2021-11-13 20:31:22 0:00:05 !ZoneLabel! !ZoneDescription!")
28391. 
28392. 
28393. /* Fixed Zone Position Handling */
28394. /* Literal number: */
28395. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
28396. /* Percentage of disk: */
28397. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
28398. /* Gap */
28399. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
28400. 
28401. /* ---------------------------------------------------------- */
28402. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
28403. # Script: DisplaySetFileStep
28404. 
28405. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
28406. 
28407. /* add message and move to a new line. */
28408. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
28409. ")
28410. 
28411. /* display the line. (hopefully.) */
28412. # Zone Footer Set Statistics Window Text
28413. 
28414. SetStatisticsWindowText("!Heading!
28415. ----------------------------------------------------------
28416. Zones Processed: 
28417. ----------------------------------------------------------
28418. !ZoneListByLine!
28419. ----------------------------------------------------------
28420. Zone Processing Step:
28421. !ZoneStepByLine!    
28422. ----------------------------------------------------------
28423. Current Zone:
28424. !ZoneFooter!
28425. ----------------------------------------------------------
28426. Volume Statistics:
28427. !VolumeStatisticsDetail!
28428. ----------------------------------------------------------
28429. Zone Detailed Report:
28430. ----------------------------------------------------------
28431. !ZoneStatisticsDetail!
28432. ----------------------------------------------------------
28433. ")
28434. 
28435. 
28436. 
28437. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
28438. 
28439. # Script: BannerSet
28440. 
28441. # Script: DisplaySetDateTimeRun
28442. 
28443. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
28444. /* Xinclude "..\Display\BannerSet.MyDc"X */
28445. /* pause(1) */
28446. 
28447. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
28448. 
28449. Title('!Heading!')
28450. /* pause(1) */
28451. 
28452. /* NOTE: Can't round or truncate to integer precision. */
28453. 
28454. pause(1)
28455. 
28456. # your stuff HERE (X)... pre file select code.
28457. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
28458. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
28459. 	# (X)
28460. 
28461. FileSelect
28462. 
28463. 	# your stuff can't really go here (errors.)
28464. 	# maybe for some reason I don't know of...
28465. 	
28466. 	# Actions next...
28467. 	# Script: ZoneDo ZoneTypeSelectArchivesBu
28468. # ArchivesBu start.
28469. all
28470. # ArchivesBu end.
28471. 
28472. 	# Script: ZoneDoAction
28473. # Zone Do File Action - SortByName.
28474. 
28475. FileActions
28476. 
28477. 		/* ---------------------------------------------------------- */
28478. 	# Gap
28479. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
28480. 		# Script: DisplaySetFileStep
28481. 
28482. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
28483. 
28484. /* add message and move to a new line. */
28485. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
28486. ")
28487. 
28488. /* display the line. (hopefully.) */
28489. # Zone Footer Set Statistics Window Text
28490. 
28491. SetStatisticsWindowText("!Heading!
28492. ----------------------------------------------------------
28493. Zones Processed: 
28494. ----------------------------------------------------------
28495. !ZoneListByLine!
28496. ----------------------------------------------------------
28497. Zone Processing Step:
28498. !ZoneStepByLine!    
28499. ----------------------------------------------------------
28500. Current Zone:
28501. !ZoneFooter!
28502. ----------------------------------------------------------
28503. Volume Statistics:
28504. !VolumeStatisticsDetail!
28505. ----------------------------------------------------------
28506. Zone Detailed Report:
28507. ----------------------------------------------------------
28508. !ZoneStatisticsDetail!
28509. ----------------------------------------------------------
28510. ")
28511. 
28512. 
28513. 
28514. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
28515. 
28516. # Script: BannerSet
28517. 
28518. # Script: DisplaySetDateTimeRun
28519. 
28520. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
28521. /* Xinclude "..\Display\BannerSet.MyDc"X */
28522. /* pause(1) */
28523. 
28524. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
28525. 
28526. Title('!Heading!')
28527. /* pause(1) */
28528. 
28529. /* NOTE: Can't round or truncate to integer precision. */
28530. 
28531. pause(1)
28532. 	
28533. 	# ACTUAL GAP
28534. 		/* AddGap Variant. */
28535. 	  	# Zone Do Gap
28536. # Gap Calculation Methods:
28537. 
28538. /* 1) Anything you need to add first. */
28539. /* empty */
28540. 
28541. /* ---------------------------------------------------------- */
28542. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
28543. 	# GapRequestedStd.
28544. 
28545. 		/* ---------------------------------------------------------- */
28546. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
28547. 
28548. 		# Gap Calculation Methods:
28549. 
28550. /* AddGap Variants */
28551. 
28552. 	/* Standard */
28553. 		# Gap Calculation Methods:
28554. 	/* AddGap Variants */
28555. 	/* Standard */
28556. 
28557. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
28558. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
28559. 
28560. 	SetVariable(GapRequested, GapRequestedStd)
28561. 	
28562. 
28563. 	/* MFT Low High Method */
28564. 		# Gap Calculation Methods:
28565. 	/* AddGap Variants */
28566. 	/* MFT Low High Method */
28567. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
28568. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
28569. 	SetVariable(GapRequested, GapRequestedMft)
28570. 	
28571. 
28572. 	/* OS Volume Type Method */
28573. 		# Gap Calculation Methods:
28574. 	/* AddGap Variants */
28575. 	/* OS Volume Type Method */
28576. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
28577. 	SetVariable(GapRequested, GapRequestedOs)
28578. 
28579. 
28580. 
28581. /* MakeGap Variants */
28582. 
28583. 	/* Original Os 1-3 + MFT 2 */
28584. 		# Gap Calculation Methods:
28585. 	/* MakeGap Variants */
28586. 	/* Original Os 1-3 + MFT 2 */
28587. 	/* plus MFT gap placed inline at the dividing zone. */
28588. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
28589. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
28590. 	SetVariable(GapRequested, GapRequestedOrig)
28591. 	
28592. 	
28593. /* Note: You could comment out the ones not in use */
28594. /* However having the data in the log is useful. */
28595. /* Therefore the following line is otherwise needed. */
28596. 
28597. /* Standard used */
28598. 
28599. SetVariable(GapRequested, GapRequestedStd)
28600. 
28601. # Gap Calculation Methods:
28602. 
28603. /* AddGap Variants */
28604. 	/* Standard */
28605. 	/* MFT Low High Method */
28606. 	/* OS Volume Type Method */
28607. 
28608. /* MakeGap Variants */
28609. 	/* Original Os 1-3 + MFT 2 */
28610. 
28611. /* Note: You could comment out the ones not in use */
28612. /* However having the data in the log is useful. */
28613. /* Therefore the following line is otherwise needed. */
28614. 
28615. /* Standard is used currently */
28616. 
28617. 
28618. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
28619. 
28620. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
28621. 
28622. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
28623. 
28624. /* ---------------------------------------------------------- */
28625. /* 3) SMALL ZONE ADJUSTMENT. */
28626. /* Gab cant be larger than half the Zone Size. */
28627. 
28628. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
28629. 	
28630. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
28631. 
28632. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
28633. 
28634. /* ---------------------------------------------------------- */
28635. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
28636. # Gap Adjustments.
28637. 
28638. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
28639. 	
28640. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
28641. 
28642. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
28643. 
28644. /* ---------------------------------------------------------- */
28645. # BYPASS THIS.
28646. 	/* This is definitely wrong. */
28647. 	/* The question is can we steal gap from the next zone */
28648. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
28649. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
28650. 		# Zone Overflow.
28651. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
28652. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
28653. 
28654. /* ---------------------------------------------------------- */
28655. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
28656. # Remaining free space available.
28657. 
28658. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
28659. 	
28660. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
28661. 
28662. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
28663. 
28664. /* ---------------------------------------------------------- */
28665. # CURRENT gap to use.
28666. 
28667. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
28668. 
28669. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
28670. 
28671. /* ---------------------------------------------------------- */
28672. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
28673. # Debugging.
28674. 
28675. 	SetVariable(GapUsed, GapCurrent) // for debugging
28676. 
28677. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
28678. 
28679. 		# Your code HERE
28680. 
28681. /* ---------------------------------------------------------- */
28682. /* 7) YOUR CODE. */
28683. # YOUR CODE HERE:
28684. 	# INPUT: GapCurrent or GapCurrentLoc
28685. 	# OUTPUT: GapUsed...
28686. 
28687. /* ---------------------------------------------------------- */
28688. # Gap Size.
28689. # Actual Size of Gap.
28690. 
28691. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
28692. 
28693. /* ---------------------------------------------------------- */
28694. /* xxxxxxxxxxxxxxxxxxxxxx */
28695. # ADD THE GAP
28696. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
28697. /* xxxxxxxxxxxxxxxxxxxxxx */
28698. 
28699. 	
28700. 	# Zone Statistics	
28701. 	# Script: ZoneDoStatistics
28702. # Zone / Volume Statistics and Display
28703. 		
28704. 	# Accumulate Totals
28705.   	# Script: ZoneDoVolumeTotals
28706. 
28707. /* Current total space used (by Zones and Gaps) */
28708. 
28709. SetVariable(VolumeZoneUsed, GapUsed)
28710. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
28711. /* Percentage */
28712. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
28713. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
28714. 
28715. /* Current total of free space requested */
28716. 
28717. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
28718. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
28719. /* Percent. */
28720. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
28721. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
28722. 
28723. /* Current total of free space used */
28724. 
28725. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
28726. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
28727. /* Percent */
28728. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
28729. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
28730. 
28731. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
28732. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
28733. /* Xinclude "..\DebugDisplayPause.MyDc"X */
28734. 
28735. 
28736. 	# Current Values
28737. 	# Script: ZoneDoCurrentSet
28738. 
28739. # Cluster, Sector, Block adjust for display.
28740. 	# Bytes per cluster is volume specific.
28741. 
28742. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
28743. 
28744. # Current Zone values.
28745. 	# Begin, end and size.
28746. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
28747. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
28748. 
28749. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
28750. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
28751. 
28752. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
28753. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
28754. 
28755. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
28756. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
28757. 
28758. 	SetVariable(ZoneFragments,				"!ZONE210N!")
28759. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
28760. 		
28761. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
28762. /* identical code to here: (separation not needed. TEST.) */	
28763. 
28764. # Current Gap, Actual and Free Values
28765. 	# Gap
28766. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
28767. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
28768. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
28769. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
28770. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
28771. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
28772. 	
28773. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
28774. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
28775. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
28776. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
28777. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
28778. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
28779. 	
28780. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
28781. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
28782. 	
28783. 	# Actual Size and End
28784. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
28785. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
28786. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
28787. 	
28788. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
28789. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
28790. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
28791. 
28792. # Gap Size & Rounding
28793. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
28794. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
28795. 	
28796. 	# Free Space
28797. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
28798. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
28799. 
28800. 	# Footer:
28801. SetVariable(ZoneFooter, "----------------------------------------------------------
28802. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
28803. 
28804. Statistics Report:
28805. ------------------
28806.    Size:  
28807.    ------------------------
28808.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
28809.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
28810.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
28811. 
28812.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
28813.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
28814. 
28815.    Location:
28816.    ------------------------
28817.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
28818.              Files End: !ZoneEndCurrent!
28819.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
28820.       
28821.    Gap Settings:
28822.    ------------------------
28823.          Gap Requested: !ZoneGapSizePer!%
28824.       Volume Rounding: !ZoneVolRoundUpPer!%
28825.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
28826.                  
28827.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
28828.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
28829.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
28830.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
28831.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
28832.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
28833.      
28834.    Free Space after Zone:
28835.    ------------------------
28836.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
28837.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
28838.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
28839. 
28840. Directory and Files Select:
28841. ---------------------------
28842. !ZoneTypeSelectCurrent!               
28843. ---------------------------
28844. ----------------------------------------------------------
28845. ")
28846. 	# Zone Footer Set Statistics Window Text
28847. 
28848. SetStatisticsWindowText("!Heading!
28849. ----------------------------------------------------------
28850. Zones Processed: 
28851. ----------------------------------------------------------
28852. !ZoneListByLine!
28853. ----------------------------------------------------------
28854. Zone Processing Step:
28855. !ZoneStepByLine!    
28856. ----------------------------------------------------------
28857. Current Zone:
28858. !ZoneFooter!
28859. ----------------------------------------------------------
28860. Volume Statistics:
28861. !VolumeStatisticsDetail!
28862. ----------------------------------------------------------
28863. Zone Detailed Report:
28864. ----------------------------------------------------------
28865. !ZoneStatisticsDetail!
28866. ----------------------------------------------------------
28867. ")
28868. 
28869. 
28870. 	
28871.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
28872. 
28873. 	# Add Zone to list of zones for display.
28874. 	SetVariable(ZoneListByLine, "!ZoneListByLine!
28875. 	A-( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / act size !ZoneSizeActualCurrent!) 
28876. 	- [begin !ZoneBeginCurrent! /  zone end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
28877. 	# ??? Free Stats?
28878. 	# Footer:
28879. SetVariable(ZoneFooter, "----------------------------------------------------------
28880. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
28881. 
28882. Statistics Report:
28883. ------------------
28884.    Size:  
28885.    ------------------------
28886.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
28887.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
28888.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
28889. 
28890.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
28891.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
28892. 
28893.    Location:
28894.    ------------------------
28895.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
28896.              Files End: !ZoneEndCurrent!
28897.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
28898.       
28899.    Gap Settings:
28900.    ------------------------
28901.          Gap Requested: !ZoneGapSizePer!%
28902.       Volume Rounding: !ZoneVolRoundUpPer!%
28903.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
28904.                  
28905.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
28906.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
28907.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
28908.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
28909.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
28910.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
28911.      
28912.    Free Space after Zone:
28913.    ------------------------
28914.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
28915.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
28916.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
28917. 
28918. Directory and Files Select:
28919. ---------------------------
28920. !ZoneTypeSelectCurrent!               
28921. ---------------------------
28922. ----------------------------------------------------------
28923. ")
28924. 
28925. 	# Add Zone Details to Report.	
28926. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
28927. !ZoneFooter!")
28928. 
28929. 
28930. 	
28931. 	# Footer:
28932. SetVariable(ZoneFooter, "----------------------------------------------------------
28933. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
28934. 
28935. Statistics Report:
28936. ------------------
28937.    Size:  
28938.    ------------------------
28939.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
28940.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
28941.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
28942. 
28943.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
28944.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
28945. 
28946.    Location:
28947.    ------------------------
28948.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
28949.              Files End: !ZoneEndCurrent!
28950.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
28951.       
28952.    Gap Settings:
28953.    ------------------------
28954.          Gap Requested: !ZoneGapSizePer!%
28955.       Volume Rounding: !ZoneVolRoundUpPer!%
28956.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
28957.                  
28958.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
28959.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
28960.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
28961.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
28962.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
28963.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
28964.      
28965.    Free Space after Zone:
28966.    ------------------------
28967.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
28968.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
28969.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
28970. 
28971. Directory and Files Select:
28972. ---------------------------
28973. !ZoneTypeSelectCurrent!               
28974. ---------------------------
28975. ----------------------------------------------------------
28976. ")
28977. 	SetStatisticsWindowText("!ZoneFooter!")
28978. 	
28979. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
28980. 	# Script: DisplaySetFileStep
28981. 
28982. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
28983. 
28984. /* add message and move to a new line. */
28985. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
28986. ")
28987. 
28988. /* display the line. (hopefully.) */
28989. # Zone Footer Set Statistics Window Text
28990. 
28991. SetStatisticsWindowText("!Heading!
28992. ----------------------------------------------------------
28993. Zones Processed: 
28994. ----------------------------------------------------------
28995. !ZoneListByLine!
28996. ----------------------------------------------------------
28997. Zone Processing Step:
28998. !ZoneStepByLine!    
28999. ----------------------------------------------------------
29000. Current Zone:
29001. !ZoneFooter!
29002. ----------------------------------------------------------
29003. Volume Statistics:
29004. !VolumeStatisticsDetail!
29005. ----------------------------------------------------------
29006. Zone Detailed Report:
29007. ----------------------------------------------------------
29008. !ZoneStatisticsDetail!
29009. ----------------------------------------------------------
29010. ")
29011. 
29012. 
29013. 
29014. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
29015. 
29016. # Script: BannerSet
29017. 
29018. # Script: DisplaySetDateTimeRun
29019. 
29020. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
29021. /* Xinclude "..\Display\BannerSet.MyDc"X */
29022. /* pause(1) */
29023. 
29024. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
29025. 
29026. Title('!Heading!')
29027. /* pause(1) */
29028. 
29029. /* NOTE: Can't round or truncate to integer precision. */
29030. 
29031. pause(1)
29032. 
29033. # Commands:
29034. 
29035. /* Moves to Zone or above it. */
29036. # MoveUpToZone()
29037. 
29038. # Defrag
29039. 
29040. # Defragment(OPTIONS)
29041. 
29042. /* Shuffles files around trying to make a big enough gap for fragmented files. */
29043. # Defragment()
29044. 
29045. /* Only does files where a gap will fit it. */
29046. # Defragment(Fast)
29047. 
29048. /* Skips fragmented files larger than the Chunck Size. */
29049. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
29050. # Defragment(Chunk Size)
29051. 
29052. /* Moves down to zone and packs zone to beginning if there are gaps. */
29053. /* Can be similar in performance to doing a SortBy. */
29054. # MoveDownFill()
29055. 
29056. # File Action - All - Fast - MoveUpToZone.
29057. 	MoveUpToZone()
29058. 	
29059. 
29060. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
29061. 	# Script: DisplaySetFileStep
29062. 
29063. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29064. 
29065. /* add message and move to a new line. */
29066. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
29067. ")
29068. 
29069. /* display the line. (hopefully.) */
29070. # Zone Footer Set Statistics Window Text
29071. 
29072. SetStatisticsWindowText("!Heading!
29073. ----------------------------------------------------------
29074. Zones Processed: 
29075. ----------------------------------------------------------
29076. !ZoneListByLine!
29077. ----------------------------------------------------------
29078. Zone Processing Step:
29079. !ZoneStepByLine!    
29080. ----------------------------------------------------------
29081. Current Zone:
29082. !ZoneFooter!
29083. ----------------------------------------------------------
29084. Volume Statistics:
29085. !VolumeStatisticsDetail!
29086. ----------------------------------------------------------
29087. Zone Detailed Report:
29088. ----------------------------------------------------------
29089. !ZoneStatisticsDetail!
29090. ----------------------------------------------------------
29091. ")
29092. 
29093. 
29094. 
29095. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
29096. 
29097. # Script: BannerSet
29098. 
29099. # Script: DisplaySetDateTimeRun
29100. 
29101. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
29102. /* Xinclude "..\Display\BannerSet.MyDc"X */
29103. /* pause(1) */
29104. 
29105. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
29106. 
29107. Title('!Heading!')
29108. /* pause(1) */
29109. 
29110. /* NOTE: Can't round or truncate to integer precision. */
29111. 
29112. pause(1)
29113. 
29114. 	# Script: ZoneDoFooter
29115. 
29116. /* ---------------------------------------------------------- */
29117. # File Select
29118. 	# Select Statments
29119. # File Actions 
29120. 	# Standard or OS File Actions.
29121. 	# Resume...
29122. 	
29123. 	# your stuff HERE (X)... post zone (file) file actions code.
29124. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
29125. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
29126. 		# (X)
29127. 		
29128. 		/* ??? Set window? */
29129. 	
29130. 	# ADD THE GAP
29131. # Vacate (good for diagnostics)
29132. # DoNotVacate - DO NOT Vacate (recommended)
29133. # DoNotVacate - DO NOT Vacate (recommended)
29134. 
29135. # Vacate
29136. /* AddGap(GapUsedLoc) */
29137. 
29138. # DO Not Vacate
29139. AddGap(GapUsedLoc, DoNotVacate) 
29140. 	
29141. 	
29142. # Script: GapZoneCommand
29143. # *** Moved to setting yours ***
29144. /* Xinclude "..\ActionVerbs\ZoneDoGapThis.MyDc"X */
29145. # Controlled via settings commands
29146. # DoNotVacate - DO NOT Vacate (recommended)
29147. 
29148. # Vacate
29149. /* AddGap(GapUsedLoc) */
29150. 
29151. # DO Not Vacate
29152. AddGap(GapUsedLoc, DoNotVacate) 
29153. 	
29154. 	
29155. # Vacate /* AddGap(GapUsed) */
29156. # DO NOT Vacate (recommended) /* AddGap(GapUsed, DoNotVacate) */ 
29157. 	
29158. 
29159. 		
29160. # 
29161. FileEnd
29162. /* ---------------------------------------------------------- */
29163. 
29164. # your stuff HERE (X)... post zone (file) code.
29165. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
29166. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
29167. 	# (X)
29168. 
29169. SetVariable(FileStepDescription,"Zone finished, reporting.")
29170. # Script: DisplaySetFileStep
29171. 
29172. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
29173. 
29174. /* add message and move to a new line. */
29175. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
29176. ")
29177. 
29178. /* display the line. (hopefully.) */
29179. # Zone Footer Set Statistics Window Text
29180. 
29181. SetStatisticsWindowText("!Heading!
29182. ----------------------------------------------------------
29183. Zones Processed: 
29184. ----------------------------------------------------------
29185. !ZoneListByLine!
29186. ----------------------------------------------------------
29187. Zone Processing Step:
29188. !ZoneStepByLine!    
29189. ----------------------------------------------------------
29190. Current Zone:
29191. !ZoneFooter!
29192. ----------------------------------------------------------
29193. Volume Statistics:
29194. !VolumeStatisticsDetail!
29195. ----------------------------------------------------------
29196. Zone Detailed Report:
29197. ----------------------------------------------------------
29198. !ZoneStatisticsDetail!
29199. ----------------------------------------------------------
29200. ")
29201. 
29202. 
29203. 
29204. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
29205. 
29206. # Script: BannerSet
29207. 
29208. # Script: DisplaySetDateTimeRun
29209. 
29210. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
29211. /* Xinclude "..\Display\BannerSet.MyDc"X */
29212. /* pause(1) */
29213. 
29214. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
29215. 
29216. Title('!Heading!')
29217. /* pause(1) */
29218. 
29219. /* NOTE: Can't round or truncate to integer precision. */
29220. 
29221. pause(1)
29222. 
29223. # Script: ZoneWhenFinished
29224. 
29225. # Script: BannerSet
29226. 
29227. # Script: DisplaySetDateTimeRun
29228. 
29229. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
29230. /* Xinclude "..\Display\BannerSet.MyDc"X */
29231. /* pause(1) */
29232. 
29233. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
29234. 
29235. Title('!Heading!')
29236. /* pause(1) */
29237. 
29238. /* NOTE: Can't round or truncate to integer precision. */
29239. 
29240. # Script: BannerLog
29241. 
29242. AppendLogfile("!LogFileName!", "!Title!")
29243. 
29244. 
29245. 
29246. # Zone Statistics	
29247. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
29248. 
29249. # Footer:
29250. SetVariable(ZoneFooter, "----------------------------------------------------------
29251. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-13 20:31:22
29252. 
29253. Statistics Report:
29254. ------------------
29255.    Size:  
29256.    ------------------------
29257.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
29258.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
29259.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
29260. 
29261.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
29262.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
29263. 
29264.    Location:
29265.    ------------------------
29266.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
29267.              Files End: !ZoneEndCurrent!
29268.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
29269.       
29270.    Gap Settings:
29271.    ------------------------
29272.          Gap Requested: !ZoneGapSizePer!%
29273.       Volume Rounding: !ZoneVolRoundUpPer!%
29274.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
29275.                  
29276.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  (Loc) !ZoneGapRequestedLocCurrent!
29277.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!   (---) !ZoneGapAdjustedLocCurrent!
29278.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! (---) !ZoneGapRoundedLocCurrent!
29279.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! (---) !ZoneGapAvailableLocCurrent!
29280.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! (---) !ZoneGapLocCurrent!
29281.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! (---) !ZoneGapUsedLocCurrent!
29282.      
29283.    Free Space after Zone:
29284.    ------------------------
29285.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
29286.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
29287.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
29288. 
29289. Directory and Files Select:
29290. ---------------------------
29291. !ZoneTypeSelectCurrent!               
29292. ---------------------------
29293. ----------------------------------------------------------
29294. ")
29295. 
29296. AppendLogfile("!LogFileName!", ".")
29297. AppendLogfile("!LogFileName!", "!ZoneFooter!")
29298. AppendLogfile("!LogFileName!", ".")
29299. 
29300. # Zone Footer Set Statistics Window Text
29301. 
29302. SetStatisticsWindowText("!Heading!
29303. ----------------------------------------------------------
29304. Zones Processed: 
29305. ----------------------------------------------------------
29306. !ZoneListByLine!
29307. ----------------------------------------------------------
29308. Zone Processing Step:
29309. !ZoneStepByLine!    
29310. ----------------------------------------------------------
29311. Current Zone:
29312. !ZoneFooter!
29313. ----------------------------------------------------------
29314. Volume Statistics:
29315. !VolumeStatisticsDetail!
29316. ----------------------------------------------------------
29317. Zone Detailed Report:
29318. ----------------------------------------------------------
29319. !ZoneStatisticsDetail!
29320. ----------------------------------------------------------
29321. ")
29322. 
29323. 
29324. 
29325. /* pause() */
29326. /* pause() */
29327. 
29328. 
29329. 
29330. 
29331. /* ---------------------------------------------------------- */
29332. 
29333. 
29334. /* ---------------------------------------------------------- */
29335. /* Volume End */
29336. # Script: VolumeWhenFinished
29337. 
29338. /* Write the "after" statistics to the logfile. */
29339. 
29340. # Script: BannerSet
29341. 
29342. # Script: DisplaySetDateTimeRun
29343. 
29344. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
29345. /* Xinclude "..\Display\BannerSet.MyDc"X */
29346. /* pause(1) */
29347. 
29348. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
29349. 
29350. Title('!Heading!')
29351. /* pause(1) */
29352. 
29353. /* NOTE: Can't round or truncate to integer precision. */
29354. 
29355. # Script: BannerLog
29356. 
29357. AppendLogfile("!LogFileName!", "!Title!")
29358. 
29359. 
29360. 
29361. # Script: 
29362. # Set Volume summary stats:
29363. 
29364. # Cluster, Sector, Block adjust for display.
29365. # Bytes per cluster is volume specific.
29366. 
29367. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
29368. 
29369. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
29370. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
29371. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
29372. 
29373. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
29374. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
29375. 
29376. # Set the display text:
29377. # Script: VolumeStatisticsSummaryDisplay
29378. 
29379. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
29380. SUMMARY: !VolumeLabel! !VolumeDescription!
29381.   
29382.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
29383.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
29384.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
29385.          
29386.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
29387.       Volume Free Adj:       !VolumeFreeAdj!
29388.     Bytes per cluster:       !BytesPerCluster! bytes
29389. 
29390.    Unfragmented Items:       !FILES200N!
29391.      Fragmented Items:       !FILES210N!
29392. 
29393.     Unfragmented Data:       !FILES202N! bytes
29394.       Fragmented Data:       !FILES212N! bytes
29395. 
29396.              All Gaps:       !GAP00N!
29397.              All gaps:       !GAP10N! bytes
29398.           Average gap:       !GAP13N! bytes
29399.            Median gap:       !GAP14N! bytes
29400.           Biggest gap:       !GAP15N! bytes
29401. ----------------------------------------------------------
29402. ") 
29403. 
29404. 
29405. SetVariable(VolumeFooter, "!VolumeStatisticsSummary!")
29406. 
29407. 
29408. # Script: VolumeSizeLog
29409. AppendLogfile("!LogFileName!", ".")
29410. AppendLogfile("!LogFileName!", "      Volume Size: !VolumeSize!")
29411. AppendLogfile("!LogFileName!", "      Volume Used: !VolumeUsed!")
29412. AppendLogfile("!LogFileName!", "Volume Used Total: !VolumeUsedTotal!")
29413. AppendLogfile("!LogFileName!", "      Volume Free: !VolumeFree!")
29414. AppendLogfile("!LogFileName!", "  Volume Free Adj: !VolumeFreeAdj!")
29415. AppendLogfile("!LogFileName!", ".")
29416. AppendLogfile("!LogFileName!", "MFT Zone: !MftZone! Location: !MftLocation! Gap: !MftGap!")
29417. AppendLogfile("!LogFileName!", ".")
29418. 
29419. 
29420. /* Write/display stats: */
29421. 
29422. # Log:  
29423. 
29424. # Script: VolumeStatisticsDetailGet
29425. 
29426. # Set Volume summary stats:
29427. 
29428. # Cluster, Sector, Block adjust for display.
29429. # Bytes per cluster is volume specific.
29430. 
29431. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
29432. 
29433. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
29434. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
29435. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
29436. 
29437. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
29438. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
29439. 
29440. # Set the display text:
29441. # Script: VolumeStatisticsSummaryDisplay
29442. 
29443. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
29444. SUMMARY: !VolumeLabel! !VolumeDescription!
29445.   
29446.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
29447.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
29448.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
29449.          
29450.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
29451.       Volume Free Adj:       !VolumeFreeAdj!
29452.     Bytes per cluster:       !BytesPerCluster! bytes
29453. 
29454.    Unfragmented Items:       !FILES200N!
29455.      Fragmented Items:       !FILES210N!
29456. 
29457.     Unfragmented Data:       !FILES202N! bytes
29458.       Fragmented Data:       !FILES212N! bytes
29459. 
29460.              All Gaps:       !GAP00N!
29461.              All gaps:       !GAP10N! bytes
29462.           Average gap:       !GAP13N! bytes
29463.            Median gap:       !GAP14N! bytes
29464.           Biggest gap:       !GAP15N! bytes
29465. ----------------------------------------------------------
29466. ") 
29467. 
29468. 
29469. 
29470. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
29471. VOLUME: !VolumeLabel! !VolumeDescription!
29472. ----------------------------------------------------------
29473. !VolumeStatisticsSummary!
29474. ----------------------------------------------------------
29475. DETAILS: !VolumeLabel! !VolumeDescription!
29476. ----------------------------------------------------------
29477. 
29478. SUMMARY:
29479. 
29480. Volume label/name:          !VolumeLabel!
29481. Volume mountpoint:          !MountPoint!
29482. Volume name:                !VolumeName!
29483. Volume type:                !VolumeType!
29484. 
29485. Total disk space:           !VolumeSize! bytes
29486.                             !VolumeSizeG! gigabytes
29487. 
29488. Bytes per cluster:          !BytesPerCluster! bytes
29489. Average end-begin distance: !AverageBeginEndDistance! clusters
29490.                             !AverageBeginEndDistanceP!% of volume size
29491. 
29492. ----------------------------------------------------------
29493. FRAGMENTS:
29494. 
29495. Unfragmented Items: !FILES200N!
29496.   Fragmented Items: !FILES210N!
29497.  Unfragmented Data: !FILES202N! bytes
29498.    Fragmented Data: !FILES212N! bytes
29499. Gaps:
29500.           All Gaps: !GAP00N!
29501.           All gaps: !GAP10N! bytes
29502.        Average gap: !GAP13N! bytes
29503.         Median gap: !GAP14N! bytes
29504.        Biggest gap: !GAP15N! bytes
29505. 
29506. ----------------------------------------------------------
29507. GAPS:
29508. 
29509.    ----------------------------------------------------------
29510.    Counts:
29511.                        Count      Percentage of all
29512.                 ----------------- -----------------
29513.    Small gaps   !GAP01N! !GAP01P!%
29514.    Big gaps     !GAP02N! !GAP02P!%
29515.                 ----------------- -----------------
29516.    All gaps     !GAP00N! !GAP00P!
29517. 
29518.    ----------------------------------------------------------
29519.    By size:
29520.                       Bytes          Gigabytes      Percentage of all
29521.                 ----------------- ----------------- -----------------
29522.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
29523.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
29524.                 ----------------- ----------------- -----------------
29525.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
29526. 
29527.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
29528.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
29529.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
29530.    ----------------------------------------------------------
29531. 
29532. ----------------------------------------------------------
29533. FILE STATISTICS:
29534. ----------------------------------------------------------
29535. 
29536. ----------------------------------------------------------
29537. ITEM COUNT:
29538. ----------------------------------------------------------
29539. Number of files and folders:
29540. 
29541.               Unfragmented       Fragmented            All
29542.    ------- ----------------- ----------------- -----------------
29543.    Files   !FILES000N! !FILES010N! !FILES020N!
29544.    Folders !FILES100N! !FILES110N! !FILES120N!
29545.    ------- ----------------- ----------------- -----------------
29546.    All     !FILES200N! !FILES210N! !FILES220N!
29547. 
29548. ----------------------------------------------------------
29549. Percentage of total:
29550. 
29551.               Unfragmented       Fragmented            All
29552.    ------- ----------------- ----------------- -----------------
29553.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
29554.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
29555.    ------- ----------------- ----------------- -----------------
29556.    All     !FILES200P!%!FILES210P!%!FILES220P!%
29557. 
29558. ----------------------------------------------------------
29559. OCCUPIED SIZE on disk:
29560. ----------------------------------------------------------
29561. Bytes:
29562.               Unfragmented       Fragmented            All
29563.    ------- ----------------- ----------------- -----------------
29564.    Files   !FILES002N! !FILES012N! !FILES022N!
29565.    Folders !FILES102N! !FILES112N! !FILES122N!
29566.    ------- ----------------- ----------------- -----------------
29567.    All     !FILES202N! !FILES212N! !FILES222N!
29568. 
29569. ----------------------------------------------------------
29570. Gigabytes:
29571.               Unfragmented       Fragmented            All
29572.    ------- ----------------- ----------------- -----------------
29573.    Files   !FILES002G! !FILES012G! !FILES022G!
29574.    Folders !FILES102G! !FILES112G! !FILES122G!
29575.    ------- ----------------- ----------------- -----------------
29576.    All     !FILES202G! !FILES212G! !FILES222G!
29577. 
29578. ----------------------------------------------------------
29579. Percentage:
29580.               Unfragmented       Fragmented            All
29581.    ------- ----------------- ----------------- -----------------
29582.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
29583.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
29584.    ------- ----------------- ----------------- -----------------
29585.    All     !FILES202P!%!FILES212P!%!FILES222P!%
29586. 
29587. ----------------------------------------------------------
29588. USED SIZE:
29589. ----------------------------------------------------------
29590. Bytes:
29591.               Unfragmented       Fragmented            All
29592.    ------- ----------------- ----------------- -----------------
29593.    Files   !FILES001N! !FILES011N! !FILES021N!
29594.    Folders !FILES101N! !FILES111N! !FILES121N!
29595.    ------- ----------------- ----------------- -----------------
29596.    All     !FILES201N! !FILES211N! !FILES221N!
29597. 
29598. ----------------------------------------------------------
29599. Gigabytes:
29600.               Unfragmented       Fragmented            All
29601.    ------- ----------------- ----------------- -----------------
29602.    Files   !FILES001G! !FILES011G! !FILES021G!
29603.    Folders !FILES101G! !FILES111G! !FILES121G!
29604.    ------- ----------------- ----------------- -----------------
29605.    All     !FILES201G! !FILES211G! !FILES221G!
29606. 
29607. ----------------------------------------------------------
29608. Percentage:
29609.               Unfragmented       Fragmented            All
29610.    ------- ----------------- ----------------- -----------------
29611.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
29612.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
29613.    ------- ----------------- ----------------- -----------------
29614.    All     !FILES201P!%!FILES211P!%!FILES221P!%
29615. 
29616. ----------------------------------------------------------
29617. Volume Detailed Statistics end.
29618. ----------------------------------------------------------
29619. ") 
29620. 
29621. 
29622. AppendLogfile("!LogFileName!", ".")
29623. AppendLogfile("!LogFileName!", "!VolumeStatisticsDetail!")
29624. AppendLogfile("!LogFileName!", ".")
29625. AppendLogfile("!LogFileName!", "Volume End.")	
29626. 
29627. # SetStatisticsWindowText("!VolumeStatisticsDetail!")
29628. 
29629. /* pause() */
29630. /* pause() */
29631. 
29632.   
29633. 
29634. VolumeEnd
29635. 
29636. /* ---------------------------------------------------------- */
29637. 
29638. AppendLogfile("!LogFileName!",".")
29639. SetVariable(FileStepDescription,"!Description! Complex Volume end: 2021-11-13 20:31:18.")
29640. # Script: BannerDescriptionSet
29641. 
29642. # Script: BannerSet
29643. 
29644. # Script: DisplaySetDateTimeRun
29645. 
29646. SetVariable(DateTimeRunDescription,		"2021-11-13 20:31:22 0:00:05")
29647. /* Xinclude "..\Display\BannerSet.MyDc"X */
29648. /* pause(1) */
29649. 
29650. SetVariable(Heading, 'Mode: Fast' ||Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||Server: !SeverStepDescription! - !RunStepDescription! started on !DateTimeRunDescription!')
29651. 
29652. Title('!Heading!')
29653. /* pause(1) */
29654. 
29655. /* NOTE: Can't round or truncate to integer precision. */
29656. 
29657. # Script: BannerLog
29658. 
29659. AppendLogfile("!LogFileName!", "!Title!")
29660. 
29661. 
29662. 
29663. AppendLogfile("!LogFileName!",".")
29664. 
29665. /* ---------------------------------------------------------- */
29666. # End. ;-) (Return to caller lovely nubes, only MyD's get executed.)
29667. 
29668. 
