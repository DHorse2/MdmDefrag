# See the 'MyDefrag.log' file for information intended for endusers. This is the debug
# logfile. The contents is highly technical and not documented. See the 'Debug' setting
# or the '-d' commandline option to control the level of information in this file.
#
Version: MyDefrag v4.3.1 for X64
Date: 2021/11/09 10:47:56
Windows version: v6.2 build 9200 
Commandline: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily\DefragDevDiskDaily.MyD" 
Working Directory: G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily
Userid: david
InstallPath = C:\Program Files\MyDefrag v4.3.1\
10:47:56 Lexical error in script 'G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily\DefragDevDiskDaily.MyD' at line 5302 column 4.

Unkown symbol.
10:48:39 Script:
  1. # MyDefrag v4.0 script: Development Volume Daily defrag
  2. #
  3. # This script is part of the standard Mdm Volume configuration
  4. # Author: David G. Horsman (DBA MacroDM) (C) 2019
  5. # based on MyDefrag distribution.
  6. 
  7. /* Development Volume Daily*/
  8. SetVariable(RunStepDescription,"Dev Vol Daily")
  9. # Display Set Run
 10. 
 11. SetVariable(RunStepDescription,			"!RunStepDescription! - DefragDevDiskDaily")
 12. SetVariable(SeverStepDescription,		"")
 13. SetVariable(VolumeStepDescription,		"")
 14. SetVariable(ZoneStepDescription,		"")
 15. SetVariable(FileStepDescription,		"")
 16. 
 17. SetVariable(VolumeStatisticsDetail, 	"")
 18. 
 19. SetVariable(ZoneListByLine, 			"Run start.")
 20. SetVariable(ZoneStepByLine, 			"")
 21. 
 22. # BANNER SET
 23. 
 24. # DATE TIME RUN ELP
 25. 
 26. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:48 0:00:00")
 27. /* Xinclude "..\Display\BannerSet.MyDc"X */
 28. /* pause(1) */
 29. 
 30. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
 31. 
 32. Title('!Heading!')
 33. /* pause(1) */
 34. 
 35. /* NOTE: Can't round or truncate to integer precision. */
 36. 
 37. pause(2)
 38. 
 39. # This script is part of the standard  disk configuration
 40. # Author: David G. Horsman (DBA MacroDM) (C) 2019
 41. # based on MyDefrag distribution.
 42. 
 43. SetVariable(Heading,"Initializing...")
 44. 
 45. ProcessPriority(Normal)
 46. /* ProcessPriority(Normal) */
 47. 
 48. 
 49. 
 50. ExitIfTimeout(300) // 5 minutes (for old systems), default 120.
 51. /* ExitIfTimeout(300) // 5 minutes (for old systems), default 120. */
 52. 
 53. 
 54. 
 55. # MyDefrag color palette.
 56. 
 57. # RGB Color pallets. (Red,Green,Blue).
 58. 
 59. # Basics:
 60. 
 61. # Red			255,	0,		0)			// Red
 62. # Green			0,		255,	0)			// Green
 63. # Blue			0,		0,		255)		// Blue
 64. # Shades:
 65. 
 66. /* (White was left unused for the administrator to highlight things.) */
 67. # White 		255,	255,	255)		// White
 68. # Black			0,		0,		0)			// Black
 69. # Grey 			240,	240,	240)		// Grey
 70. 
 71. # Bright colors and shades:
 72. 
 73. # Purple 		170,	89,		221)		// Purple
 74. # Magenta		255, 	5, 		255)		// Magenta (pinkish)
 75. 
 76. # Pure Yellow 	255,	255,	0)			// Pure yellow
 77. # Yellow 		229, 	229, 	0)			// Yellow
 78. # Light Yellow 	255,	255,	224)		// Light Yellow
 79. 
 80. # Pure Red 		255, 	0, 		0)			// Red
 81. # Red 			204, 	92, 	92)			// Red
 82. # Light red		255,	115,	115)		// Light red
 83. # Orange		255, 	165, 	0)			// Orange
 84. 
 85. # Pure Green	0, 		255, 	0)			// Pure Green (Lime)
 86. # Green			0,		128,	0)			// Green
 87. # Light Green	144,	228, 	144)		// Light Green
 88. # Pale Green	152, 	251, 	152)		// Pale Green
 89. 
 90. # Dark blue		20,		87,		229)		// Dark blue
 91. # Light Blue	175,	198,	247)		// Light Blue
 92. # Bright Blue	0, 		223, 	255)		// Bright Blue
 93. # Light sky blue 135, 	206, 	250)		// Light sky blue
 94. # Deep sky blue	0, 		191, 	255)		// Deep sky blue
 95. 
 96. # Black			0,		0,		0)
 97. # Grey			240,	240,	240)
 98. 
 99. # Window Colors
100. SetColor(Empty,										240,  	240, 	240)	// Grey
101. # ???
102. SetColor(Allocated,									45, 	72, 	128)	// Black
103. 
104. # Busy Colours
105. SetColor(BusyRead,									0, 		0, 		0)		// Black
106. SetColor(BusyWrite,									255, 	0, 		0)		// Red
107. 
108. #File Colors
109. SetFileColor(All,									0,		0,		0)		// Black
110. SetFileColor(Movable,								20,		87,		229)	// Dark blue
111. 
112. # Processed
113. SetFileColor(Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
114. SetFileColor(Processed and Fragmented,				170,	89,		221)	// Purple
115. 
116. # Fragmented and NotMovable
117. SetFileColor(Fragmented,							229, 	229, 	0)		// Yellow
118. SetFileColor(not(Movable),							255, 	165, 	0)		// Orange
119. 
120. # Light Green and Yellow
121. SetFileColor(Selected,								152,	251, 	152)	// Light Green
122. SetFileColor(Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
123. SetFileColor(Selected and not(Movable),				255,	115,	115)	// Light red
124. 
125. /* empty */
126. 
127. 
128. 
129. # Processes:
130. 	# This Process
131. 	SetVariable(RunProcessID,ProcessID)
132. 
133. 	# Kill other instances
134. 	/* Kill other MyDefrag Instances. */
135. 	/* Oops! This commits suicide. */
136. 	/* 	RunProgram("..\pskill.exe", "-t MyDefrag.exe") */
137. 	/* Pause(10) */
138. 	
139. 	/* If another instance of MyDefrag is already running then exit. */
140. 	/* Oops again. I don't know if this cause the hidden instance */
141. 	/* to hang around after the run. */
142. 	/* Warning: <alt><Run><Exit> seems to hide the instance not end it. */
143. 	/* The task mananager may be needed. This is under investigation. */
144. 
145. 	# OtherInstances
146. 	
147. OtherInstances(exit)
148. 
149. # OtherInstances
150. 	
151. # OtherInstances(exit)
152. 
153. 
154. 
155. 	# StatusBar
156. 	StatusBar(Status Path MouseOver)
157. 	# OtherInstances
158. 	
159. # OtherInstances(exit)
160. 
161. 	
162. 	# Power management
163. 	/* SetScreenPowerSaver(off) */
164. 	# Power management
165. 
166. 	/* SetScreenPowerSaver(off) */
167. 
168. 	# Power management
169. 
170. 	/* SetScreenPowerSaver(off) */
171. 
172. 
173. 
174. 
175. /* ---------------------------------------------------------- */
176. # Script Directory Location:
177. SetVariable(ScriptDir,"..\")
178. 
179. /* SetVariable(ScriptDir,"..\") */
180. /* SetVariable(ScriptDir,"G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily") */
181. /* SetVariable(ScriptDir,"E:\Ide\MyDefrag\MyDefrag\MdmScriptMyDefragVs4_3_1\") */
182. 
183. 
184. 
185. /* ---------------------------------------------------------- */
186. # DISPLAY - What text is displayed in Titlebar, data fields and reports.
187. 
188. 
189. /* The variable FileStepDescription get set to */
190. /* the messages below according to the Zone File */
191. /* step the defrag is on. */
192. 
193. /* The titlebar is organized in these areas: */
194. 
195. /* SwProductVs. */
196. /* Volume description. */
197. /* Zone description. */
198. /* File Processing Step (here.) */
199. /* Server and Script names. */
200. /* Run Date, Time and Elapsed (Bug) */
201. 
202. /* Shown in the Title / Banner / App Heading */
203. 
204. SetVariable(SeverStepDescription,	"")
205. SetVariable(VolumeStepDescription,	"")
206. SetVariable(ZoneStepDescription,	"")
207. SetVariable(FileStepDescription,	"")
208. SetVariable(RunStepDescription,		"")
209. 
210. # Display fields you can set for your personal tastes / needs:
211. 
212. /* ---------------------------------------------------------- */
213. # ZONE. Process One Zone (the steps and messages displayed. */
214. 
215. SetVariable(FileStepDescriptionZoneStart, 			"Zone started.")
216. 
217. /* "Your Zone Pre (before)Processing." */
218. SetVariable(FileStepDescriptionYourZonePre, 		"!FileStepDescriptionZoneStart!") 		
219. 
220. SetVariable(FileStepDescriptionFileSelect,			"Selecting Files.")
221. 
222. /* "Your Pre Sort File Actions." */
223. SetVariable(FileStepDescriptionYourFileActionsPre, 	"!FileStepDescriptionFileSelect!")
224. 
225. SetVariable(FileStepDescriptionFileActionStart, 	"File Actions started.")
226. 
227. /* "Your Post Sort File Actions." */
228. SetVariable(FileStepDescriptionYourFileActionsPost, "!FileStepDescriptionFileActionStart!")
229. 
230. SetVariable(FileStepDescriptionFileActionEnd, 		"File Actions completed.")
231. 
232. /* "Your Zone Post (after) Processing." */
233. SetVariable(FileStepDescriptionYourZonePost, 		"!FileStepDescriptionFileActionEnd!") 		
234. 
235. SetVariable(FileStepDescriptionFileActionGap, 		"Calculating Gap.")
236. 
237. SetVariable(FileStepDescriptionZoneEnd, 			"Zone finished.")
238. 
239. /* Pattern: SetVariable(FileStepDescriptionXXX, 	"FileStepDescriptionXXX") */
240. 
241. /* Note: If you add custom script code in the PRE and POST areas then at that */
242. /* time you fill in the messages above as appropriate. */
243. 
244. /* empty */
245. 
246. /* ---------------------------------------------------------- */
247. # Regarding Volume Names/Labels
248. 
249. /* FYI. The Volume names / drive letters need to be correct for your system. */
250. /* It is repeated here for infomation about fields used above. */
251. /* Set your values in "SettingsYours\SettingsYoursVolumeNames.MyDc" */
252. 
253. 	/* SetVariable(VolumeSys,"!VolumeNamePrefix!Sys") */
254. 	/* SetVariable(VolumeDev,"!VolumeNamePrefix!Dev") */
255. 	/* SetVariable(VolumeData,"!VolumeNamePrefix!Data") */
256. 	/* SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive") */
257. 
258. 	/*		or just */
259. 			
260. 	/* SetVariable(VolumeSys,"C:") */
261. 	/* SetVariable(VolumeDev,"E:") */
262. 
263. /* ---------------------------------------------------------- */
264. # BANNER DEFINITION
265. /* SetVariable(Heading, "Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! || !FileStepDescription! ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskDaily on 2021-11-09 10:47:49 0:00:01") */
266. 
267. # How to build them: (documentation)
268. 
269. /* Here is how is one pattern not used: */
270. /* SetVariable(Heading, "|") */
271. /* SetVariable(Heading, "!Heading! Vol: !VolumeStepDescription!") */
272. /* SetVariable(Heading, "!Heading! Zone: !ZoneStepDescription!") */
273. /* SetVariable(Heading, "!Heading! !FileStepDescription!") */
274. /* SetVariable(Heading, "!Heading!  ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskDaily") */
275. /* SetVariable(Heading, " on 2021-11-09 10:47:49 0:00:01") */
276. /* SetVariable(Heading, "!Heading!|") // spacers. */
277. 
278. /* A typical banner field list: */
279. # Appearing in Title('Vol: !
280. # VolumeCurrent
281. # ! Zone: !
282. # ZoneCurrentDescription
283. # ! !
284. # ZoneCurrent
285. # ! of !
286. # ZoneCount
287. # ! || Free: Vol: !
288. # VolumeFreePerUsed
289. # !% Zone: !
290. # ZoneFreePerUsed
291. # !% || Script: !
292. # ScriptTitle
293. # ! System: !
294. # VolumeNamePrefix
295. # ! !
296. # ServerNameFull
297. # ! !
298. # Date
299. # ! !
300. # Time
301. # ! !
302. # RunTime
303. # !')
304. /* . */
305. 
306. 
307. /* Progress Display */
308. SetVariable(ZoneListByLine, 	"Volume start.")
309. SetVariable(ZoneStepByLine, 	"")
310. 
311. /* There is 6 digit decimal precision so by using */
312. /* 1Mb the full number is displayed in a much more */
313. /* readable form. */
314. 
315. SetVariable(DisplayUnitDivisor, 	1000000) // 1MB.
316. 
317. /* ---------------------------------------------------------- */
318. # SERVER INFORMATION
319. 
320. 	/* ServerName (IE. Computer name or number.) not used. */
321. 	/* System99 */
322. 		# SetVariable(ServerName,"Pc15")
323. 
324. 		# Server Names
325. 
326. # ???
327. 
328. # IMPORTANT: ServerName NAME: 
329. 
330. 	# SetVariable(ServerName,"PcAny")
331. 
332. # IMPORTANT: ServerName NAME: 
333. 
334. 	# SetVariable(ServerName,"PcAny")
335.     /* System99 */
336. # SET
337. SetVariable(ServerName,"RavenPc")
338. 
339. 
340. 	
341. 	/* Descriptive Information so maybe */
342. 	/* VolumeNamePrefix (IE. Person or company initials) not used. */
343. 	/* "Xyz" */
344. 		# SetVariable(VolumeNamePrefix,"Mdm")
345. 
346. 		# VolumeNamePrefix
347. 
348. /* Descriptive Information so maybe */
349. /* VolumeNamePrefix (IE. Person or company initials) not used. */
350. /* "Xyz" */
351. 	SetVariable(VolumeNamePrefix,"VolThis")
352. 
353. 	
354. /* Descriptive Information so maybe */
355. /* VolumeNamePrefix (IE. Person or company initials) not used. */
356. /* "Xyz" */
357. 	SetVariable(VolumeNamePrefix,"Vol")
358. 
359. /* Server name full is usually the server and computer combined. not used. */
360. 	SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
361. 
362. 
363. 	/* Server name full is usually the server and computer combined. not used. */
364. 
365. 		SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
366. 	
367. 	# VOLUME
368. SetVariable(SeverStepDescription, 	"!ServerNameFull!")
369. SetVariable(VolumeStepDescription, 	"")
370. SetVariable(ZoneStepDescription, 	"")
371. SetVariable(FileStepDescription, 	"")
372. # BANNER SET
373. 
374. # DATE TIME RUN ELP
375. 
376. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
377. /* Xinclude "..\Display\BannerSet.MyDc"X */
378. /* pause(1) */
379. 
380. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
381. 
382. Title('!Heading!')
383. /* pause(1) */
384. 
385. /* NOTE: Can't round or truncate to integer precision. */
386. 
387. /* pause(2) */
388. 
389. /* ---------------------------------------------------------- */
390. # VOLUMES
391. /* ---------------------------------------------------------- */
392. 
393. 	# Volume Do Current Clear
394. 
395. /* ---------------------------------------------------------- */
396. # Current Values.
397. 	SetVariable(VolumeLabel, "NotSet")
398. 	SetVariable(VolumeDescription, "")
399. 
400. 	SetVariable(VolumeCount, 0)
401. 	SetVariable(VolumeNoCurrent, 0)
402. 	SetVariable(VolumeNoAdjCurrent, 0)
403.   	SetVariable(VolumeCurrentAjust, 0) // not used
404. 
405. /* ---------------------------------------------------------- */
406. # OS Disk Usage.
407. 
408. /* Percentage of disk used by OS */
409. 
410. 	SetVariable(OsPer, 0.18)
411. 
412. 	     SetVariable(ZoneCountOs, 5)
413. 
414.        SetVariable(ZoneCountType, 0) // not used
415.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
416. 
417. 	    SetVariable(ZoneCountSys, 2)
418. 	    SetVariable(ZoneCountDev, 7)
419. 
420. 	   SetVariable(ZoneCountData, 0)
421. 	SetVariable(ZoneCountArchive, 0)
422. 	
423. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
424. 
425. /* ---------------------------------------------------------- */
426. # Volume Totals
427. 	# USED:
428. 	/* Current total volume space used */
429. 	SetVariable(VolumeZoneUsed, 			0)
430. 	/* percentage */
431. 	SetVariable(VolumeZoneUsedPer, 			0)
432. 
433. 	# FREE:
434. 	/* Current total of free space used */
435. 	SetVariable(VolumeFreeRequested, 		0)
436. 	/* percentage */
437. 	SetVariable(VolumeFreeRequestedPer, 	0)
438. 
439. 	/* Current total of free space used */
440. 	SetVariable(VolumeFreeUsed, 			0)
441. 	/* percentage */
442. 	SetVariable(VolumeFreeUsedPer, 			0)
443. 	
444. /* ---------------------------------------------------------- */
445. # Volume Free Space Proportional Used Space vs Volume Size.
446. 	/* We only want to use a ratio of the free space relative to the volume. */
447. 	/* We could just use percentages of the total free space as well. */
448. 
449. 	/* SetVariable(VolumeFreeAdj, 		1) */
450. 	
451. 	SetVariable(VolumeFreeAdj,				(VolumeFree * (VolumeUsed / VolumeSize)))
452. 
453. /* ---------------------------------------------------------- */
454. # ZONES
455. 
456. 	SetVariable(ZoneNoCurrent, 0)
457. 	SetVariable(ZoneNoAdjCurrent, 0)
458. 	SetVariable(ZoneCurrentAjust, 0)
459. 
460. 	# Zone Do Current Clear
461. 
462. SetVariable(ZoneTypeSelectCurrent, 		"")
463. 
464. SetVariable(ZoneBeginCurrent, 			0)
465. SetVariable(ZoneBeginPerCurrent, 		0)
466. SetVariable(ZoneEndCurrent, 			0)
467. SetVariable(ZoneEndPerCurrent, 			0)
468. 
469. SetVariable(ZoneSizeCurrent,			0)
470. SetVariable(ZoneSizePerCurrent,			0)
471. 
472. SetVariable(ZoneGapRequestedCurrent,	0)
473. SetVariable(ZoneGapRoundedCurrent, 		0)
474. SetVariable(ZoneGapAdjustedCurrent, 	0)
475. SetVariable(ZoneGapAvailableCurrent, 	0)
476. SetVariable(ZoneGapCurrent,				0)
477. SetVariable(ZoneGapUsedCurrent, 		0)
478. 
479. SetVariable(ZoneGapActualCurrent, 		0)
480. SetVariable(ZoneGapActualPerCurrent, 	0)
481. 
482. SetVariable(ZoneSizeActual, 			0)
483. SetVariable(ZoneSizeActualCurrent,		0)
484. 
485. SetVariable(ZoneEndActual, 				0)
486. SetVariable(ZoneEndActualCurrent,		0)			
487. SetVariable(ZoneSizeActualPerCurrent, 	0)
488.       
489. SetVariable(ZoneFilesFolders,			0)
490. SetVariable(ZoneFilesFoldersPer,		0) 
491. 
492. SetVariable(ZoneFragments,				0)
493. SetVariable(ZoneFragmentsPer,			0) 
494. 		
495. SetVariable(ZoneEndActualCurrent, 		0)
496. SetVariable(ZoneEndActualPerCurrent, 	0)
497. 
498. # Gap Calculation Methodology:
499. 	# Requested
500. 	SetVariable(GapRequested, 			0) 
501. 	SetVariable(GapRequestedStd, 		0) 
502. 	SetVariable(GapRequestedMft, 		0) 
503. 	SetVariable(GapRequestedOs, 		0) 
504. 	SetVariable(GapRequestedOriginal, 	0) 
505. 	
506. 	# Gap Adjustments
507. 	SetVariable(GapRounded, 			0)
508. 	# SetVariable(GapAdjusted, 			0)
509. 	SetVariable(GapAvailable, 			0)
510. 	SetVariable(GapCurrent, 			0)
511. 	SetVariable(GapActual, 				0)
512. 	SetVariable(GapUsed, 				0)
513. 	
514. 	# Gap Adjustments
515. 	SetVariable(GapRoundedLoc, 			0)
516. 	# SetVariable(GapAdjustedLoc, 		0)
517. 	SetVariable(GapAvailableLoc, 		0)
518. 	SetVariable(GapCurrentLoc, 			0)
519. 	SetVariable(GapActualLoc,			0)
520. 	SetVariable(GapUsedLoc,				0)
521. 	
522. 	# Space usage
523. 	SetVariable(ZoneFreePerRequested, 	0)
524. 	SetVariable(ZoneFreePerUsed, 		0)
525. 
526. # Gap Size & Rounding
527. 	SetVariable(ZoneGapSizePer, 		0)
528. 	SetVariable(ZoneVolRoundUpPer, 		0)
529. 	
530. 	# Free Space
531. 	SetVariable(ZoneFreeUsedPer, 		0)
532. 	SetVariable(ZoneFreeRequestedPer, 	0)
533. 
534. 
535. 	SetVariable(ZoneLabel, "Volume")
536. 	SetVariable(ZoneDescription, "Analysis...")
537. 	# BANNER SET
538. 
539. # DATE TIME RUN ELP
540. 
541. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
542. /* Xinclude "..\Display\BannerSet.MyDc"X */
543. /* pause(1) */
544. 
545. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
546. 
547. Title('!Heading!')
548. /* pause(1) */
549. 
550. /* NOTE: Can't round or truncate to integer precision. */
551. 
552. 
553. 	
554. 	  
555. 	SetVariable(VolumeLabel, "NotSet")
556. 	SetVariable(VolumeDescription, "")
557. 
558. 	SetVariable(FileStepDescription,"Initializing run...")
559. 	# BANNER SET
560. 
561. # DATE TIME RUN ELP
562. 
563. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
564. /* Xinclude "..\Display\BannerSet.MyDc"X */
565. /* pause(1) */
566. 
567. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
568. 
569. Title('!Heading!')
570. /* pause(1) */
571. 
572. /* NOTE: Can't round or truncate to integer precision. */
573. 
574. 
575. /* ---------------------------------------------------------- */
576. # VOLUME TYPES
577. 
578. 	/* Volumes */
579. 	/* . */
580. 	/* Only those were fully implemented: */
581. 	/* Sys */
582. 	/* Dev */
583. 	/* . */
584. 	/* Common types of volumes: */
585. 	/* Data */
586. 	/* Archive */
587. 	/* . */
588. 	/* Other historical volumes: */
589. 	/* Test */
590. 	/* Live */
591. 	/* Server */
592. 	/* Client */
593. 	/* SysUtils */
594. 	/* . */
595. 
596. # IMPORTANT: VOLUME NAME: SET YOUR:
597. 	/* VOLUME NAMES IN SettingsYours\SettingsYoursVolumeNames.MyDc */
598. 	/* 		or    			*/
599. 	/* VOLUME NAME (one only for override) in SettingsYours\SettingsYoursVolume.MyDc */
600. 	/* 		or here also 	*/
601. 	SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
602. 	SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
603. 
604. 	/* SetVariable(VolumeSys,"C:") */
605. 	/* SetVariable(VolumeDev,"E:") */
606. 
607. 	/* These are for dedicated disks. */
608. 	/* So it means JUST Data or JUST Archives. */
609. 
610. 	SetVariable(VolumeData,"!VolumeNamePrefix!Data")
611. 	SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
612. 	
613. 	# IMPORTANT: VOLUME NAME: 
614. 
615. 	# SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
616. 	# SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
617. 	# SetVariable(VolumeData,"!VolumeNamePrefix!Data")
618. 	# SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
619. 
620. 	#    or this:
621. 	
622. 	
623. 	SetVariable(VolumeSys,"C:")
624. 	SetVariable(VolumeDev,"C:")
625. 	SetVariable(VolumeData,"C:")
626. 	SetVariable(VolumeArchive,"C:")
627. 
628. 
629. # SET
630. # SetVariable(VolumeSys,"C:")
631. 
632. 
633. 
634. /* ---------------------------------------------------------- */
635. # OS Disk Usage.
636. /* Percentage of disk used by OS */
637. 
638. 	SetVariable(OsPer, 0.18)
639. 
640. 	     SetVariable(ZoneCountOs, 5)
641. 
642.        SetVariable(ZoneCountType, 0) // not used
643.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
644. 
645. 	    SetVariable(ZoneCountSys, 2)
646. 	    SetVariable(ZoneCountDev, 7)
647. 
648. 	   SetVariable(ZoneCountData, 0)
649. 	SetVariable(ZoneCountArchive, 0)
650. 	
651. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
652. 
653. /* ---------------------------------------------------------- */
654. # ZONE TYPES. 
655. /* ---------------------------------------------------------- */
656. 	/* Type Labels, Descriptions, Gaps and Rounding. */
657. 	/* Load the Zone Definitions */
658. 	/* These are file categories basically */
659. 	/* and are maintained in a single file */
660. 	/* for ease of maintenance. Here: */
661. 	
662. 	/* ---------------------------------------------------------- */
663. # ROUNDING factors:
664. 
665. /* HERE if you want to tweak how type the Gaps are if growth is slow. */
666. /* HERE if your DISK IS VERY FULL */
667. /* This is where you can tweak growth rounding if the Volume gets really full. */
668. /* You don't have to use these, you can use actual percentages in the Zone section. */
669. 
670. /* Note: Volume and Gap Sizes are paired to a degree and */
671. /* set relative to each other. */
672. 	
673. 	      SetVariable(VolumeRoundUpNone, 	1)
674. 	      SetVariable(VolumeRoundUpTiny, 	0.005)
675. 	     SetVariable(VolumeRoundUpSmall, 	0.01)
676. 	    SetVariable(VolumeRoundUpMedium, 	0.02)
677. 	     SetVariable(VolumeRoundUpLarge, 	0.03)
678. 	SetVariable(VolumeRoundUpExtraLarge, 	0.05)
679. 	
680. 	    SetVariable(VolumeRoundUpBlogBu, 	0.10)
681. 	
682. 	      SetVariable(ZoneGapSizeNone, 		0)
683. 	      SetVariable(ZoneGapSizeTiny, 		0.005)
684. 	     SetVariable(ZoneGapSizeSmall, 		0.01)
685. 	    SetVariable(ZoneGapSizeMedium, 		0.05)
686. 	     SetVariable(ZoneGapSizeLarge, 		0.10)
687. 	SetVariable(ZoneGapSizeExtraLarge, 		0.15)
688. 		
689. 	    SetVariable(ZoneGapSizeBlobBu, 		0.10)
690. 
691. /* ---------------------------------------------------------- */
692. # ZONE SETTINGS:
693. /* ---------------------------------------------------------- */
694. /* These are the Zone Names */
695. /* Regular is at the end but otherwise */
696. /* this is in the order they appear on disk */
697. 
698. # Os Programs.
699. SetVariable(ZoneLabelBoot, 				"Boot")
700. SetVariable(ZoneLabelBootData, 				"BootData")
701. SetVariable(ZoneLabelProgramHints,			"ProgramHints")
702. SetVariable(ZoneLabelProgramHintsData,			"ProgramHintsData")
703. SetVariable(ZoneLabelPrograms,				"Programs")
704. SetVariable(ZoneLabelProgramsWindows,			"ProgramsWindows")
705. SetVariable(ZoneLabelProgramsData,			"ProgramsData")
706. # Moved to after Mft & Dir.
707. SetVariable(ZoneLabelPageHiperDump,			"PageHiperDump")
708. 
709. # Os Mft & Directories.
710. SetVariable(ZoneLabelMft,				"MFT")
711. SetVariable(ZoneLabelDir,				"DIR")
712. 
713. # Standard Zones.
714. SetVariable(ZoneLabelIdeScripts, 			"IdeScripts")
715. SetVariable(ZoneLabelDevToDo, 				"DevToDo")
716. SetVariable(ZoneLabelLinksCorp, 			"LinksCorp")
717. SetVariable(ZoneLabelPeople, 				"People")
718. # MFT.
719. # DIR.
720. # Games. 
721. SetVariable(ZoneLabelGames, 				"Games")
722. SetVariable(ZoneLabelShares, 				"Shares")
723. SetVariable(ZoneLabelSystemOtherData, 			"SystemOtherData")
724. SetVariable(ZoneLabelReference, 			"Reference")
725. 
726. 
727. # Sys.
728. # People.
729. # OS, Mft, Dir.
730. # Games.
731. SetVariable(ZoneLabelRegular, 				"Regular")
732. 
733. # Common.
734. SetVariable(ZoneLabelSpaceHogs, 			"SpaceHogs")
735. SetVariable(ZoneLabelArchivesBu, 			"ArchivesBu")
736. 
737. /* ---------------------------------------------------------- */
738. /* Use however you like */
739. 
740. # Os Programs.
741. SetVariable(ZoneDescriptionBoot, 			"!ZoneLabelBoot!")
742. SetVariable(ZoneDescriptionBootData, 			"!ZoneLabelBootData!")
743. SetVariable(ZoneDescriptionProgramHints, 		"!ZoneLabelProgramHints!")
744. SetVariable(ZoneDescriptionProgramHintsData, 		"!ZoneLabelProgramHintsData!")
745. SetVariable(ZoneDescriptionPrograms, 			"!ZoneLabelPrograms!")
746. SetVariable(ZoneDescriptionProgramsWindows, 		"!ZoneLabelProgramsWidows!")
747. SetVariable(ZoneDescriptionProgramsData, 		"!ZoneLabelProgramsData!")
748. SetVariable(ZoneDescriptionPageHiperDump, 		"!ZoneLabelPageHiperDump!")
749. 
750. # Os Mft & Directories.
751. SetVariable(ZoneDescriptionMft, 			"!ZoneLabelMft!")
752. SetVariable(ZoneDescriptionDir, 			"!ZoneLabelDir!")
753. 
754. # Standard Zones:
755. SetVariable(ZoneDescriptionIdeScripts, 			"!ZoneLabelIdeScripts!")
756. SetVariable(ZoneDescriptionDevToDo, 			"!ZoneLabelDevToDo!")
757. SetVariable(ZoneDescriptionLinksCorp, 			"!ZoneLabelLinksCorp!")
758. SetVariable(ZoneDescriptionPeople, 			"!ZoneLabelPeople!")
759. # MFT.
760. # DIR.
761. # Games. 
762. SetVariable(ZoneDescriptionGames, 			"!ZoneLabelGames!")
763. SetVariable(ZoneDescriptionShares, 			"!ZoneLabelShares!")
764. SetVariable(ZoneDescriptionSystemOtherData, 		"!ZoneLabelSystemOtherData!")
765. SetVariable(ZoneDescriptionReference, 			"!ZoneLabelReference!")
766. 
767. # Sys.
768. # People.
769. # OS, Mft, Dir.
770. SetVariable(ZoneDescriptionRegular, 			"!ZoneLabelRegular!")
771. 
772. SetVariable(ZoneDescriptionSpaceHogs, 			"!ZoneLabelSpaceHogs!")
773. SetVariable(ZoneDescriptionArchivesBu, 			"!ZoneLabelArchivesBu!")
774. 
775. /* ---------------------------------------------------------- */
776. /* This rounds up to even locations on the volume to keep */
777. /* the location of data relatively stable during fluctuation. */
778. 
779. /* NOTE: For Volume specifice settings you would have to copy these */
780. /* next two sections and use them in the SettingsYours\SettingsYours for each Volume. */
781. /* You would need a copy of these two to use in a Reset function between Volumes. */
782. 
783. # Os Programs.
784. SetVariable(ZoneVolRoundUpBoot, 		"!VolumeRoundUpSmall!")
785. SetVariable(ZoneVolRoundUpProgramHints, 	"!VolumeRoundUpSmall!")
786. SetVariable(ZoneVolRoundUpPrograms, 		"!VolumeRoundUpMedium!")
787. SetVariable(ZoneVolRoundUpPageHiperDump,	"!VolumeRoundUpSmall!")
788. 
789. # Os Mft & Directories.
790. SetVariable(ZoneVolRoundUpMft,			"!VolumeRoundUpTiny!")
791. SetVariable(ZoneVolRoundUpDir,		 	"!VolumeRoundUpLarge!")
792. 
793. # Standard Zones.
794. SetVariable(ZoneVolRoundUpIdeScripts, 		"!VolumeRoundUpSmall!")
795. SetVariable(ZoneVolRoundUpDevToDo, 		"!VolumeRoundUpSmall!")
796. SetVariable(ZoneVolRoundUpLinksCorp, 		"!VolumeRoundUpSmall!")
797. SetVariable(ZoneVolRoundUpPeople, 		"!VolumeRoundUpMedium!")
798. # MFT.
799. # DIR.
800. # Games. 
801. # ToDo.............
802. SetVariable(ZoneVolRoundUpGames, 		"!VolumeRoundUpSmall!")
803. SetVariable(ZoneVolRoundUpShares, 		"!VolumeRoundUpSmall!")
804. SetVariable(ZoneVolRoundUpSystemOtherData, 	"!VolumeRoundUpSmall!")
805. SetVariable(ZoneVolRoundUpReference, 		"!VolumeRoundUpMedium!")
806. 
807. # Sys.
808. # People.
809. # OS, Mft, Dir.
810. # Games.
811. SetVariable(ZoneVolRoundUpRegular, 		"!VolumeRoundUpMedium!")
812. 
813. # Common.
814. SetVariable(ZoneVolRoundUpSpaceHogs, 		"!VolumeRoundUpMedium!")
815. SetVariable(ZoneVolRoundUpArchivesBu, 		"!VolumeRoundUpTiny!")
816. 
817. /* ---------------------------------------------------------- */
818. /* Your Zone Gap consumption of free space as a percentage. */
819. /* Clearly this can not exceed 100%. Keep it under 99%. */
820. 
821. # Os Programs.
822. SetVariable(ZoneGapSizeBoot, 				"!ZoneGapSizeTiny!")
823. SetVariable(ZoneGapSizeProgramHints,	 		"!ZoneGapSizeTiny!")
824. SetVariable(ZoneGapSizePrograms, 			"!ZoneGapSizeSmall!")
825. SetVariable(ZoneGapSizePageHiperDump, 			"!ZoneGapSizeSmall!")
826. 
827. # Mft & Directories.
828. SetVariable(ZoneGapSizeMft, 				"!ZoneGapSizeTiny!")
829. SetVariable(ZoneGapSizeDir,		 		"!ZoneGapSizeTiny!")
830. 
831. # Standard Zones.
832. SetVariable(ZoneGapSizeIdeScripts, 			"!ZoneGapSizeMedium!")
833. SetVariable(ZoneGapSizeDevToDo, 			"!ZoneGapSizeMedium!")
834. SetVariable(ZoneGapSizeLinksCorp, 			"!ZoneGapSizeMedium!")
835. SetVariable(ZoneGapSizePeople, 				"!ZoneGapSizeMedium!")
836. # MFT.
837. # DIR.
838. # Games. 
839. # ToDo.............
840. SetVariable(ZoneGapSizeGames, 				"!ZoneGapSizeMedium!")
841. SetVariable(ZoneGapSizeShares, 				"!ZoneGapSizeMedium!")
842. SetVariable(ZoneGapSizeSystemOtherData, 		"!ZoneGapSizeMedium!")
843. SetVariable(ZoneGapSizeReference, 			"!ZoneGapSizeSmall!")
844. 
845. # Sys.
846. # People.
847. # OS, Mft, Dir.
848. # Games.
849. SetVariable(ZoneGapSizeRegular, 			"!ZoneGapSizeMedium!")
850. 
851. # Common.
852. SetVariable(ZoneGapSizeSpaceHogs, 			"!ZoneGapSizeMedium!")
853. SetVariable(ZoneGapSizeArchivesBu, 			"!ZoneGapSizeTiny!")
854. 
855. /* ---------------------------------------------------------- */
856. # ZONE CALCULATION METHODS:
857. # OS ZONE SETTINGS:
858. /* ---------------------------------------------------------- */
859. 
860. 	/* ---------------------------------------------------------- */
861. 	# VOLUME MFT Location.
862. 	/* The Volume Location of the MFT as a percentage of the Volume. */
863. 		
864. 		SetVariable(MftVolumeRoundUp, 		"!VolumeRoundUpLarge!")
865. 		SetVariable(MftVolumeGapSize, 		"!ZoneGapSizeTiny!")
866. 		
867. 		# MFT CALCULATION METHODS.
868. 			# STANDARD Method.
869. 			/* IMPORTANT: Standard method currently in use. */
870. 			/* IE: The others below are ignored but instructive. */
871. 			/* None of the following settings are used, hence zero. */
872. 			SetVariable(MftPer, 			0)
873. 			SetVariable(MftLocation, 		0)
874. 			
875. 			# MFT Method.
876. 			/* Place files at X% (MftPerSys) into the data on the Volume. */
877. 			/* This is really tied the ratio of executables to data and blobs. */
878. 			# SetVariable(MftPer, 			0.30)
879. 			# SetVariable(MftLocation, 		1000000000)
880. 			# SetVariable(MftGapSize, 		"!ZoneGapSizeLarge!")
881. 		
882. 			# FIXED Method.
883. 			# SetVariable(MftLocation, 		1000000000) // (IE. Yours)
884. 			# SetVariable(MftPer, 			MftLocation / VolumeSize)
885. 			
886. 			# ORIGINAL Method.
887. 			/* DEPRECIATED, not in use. */
888. 			/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
889. 			# SetVariable(MftPer, 			0.30)
890. 		
891. 		# ROUNDING.	
892. 		# SetVariable(MftLocation,			RoundUp(MftLocation, VolumeSize * MftVolumeRoundUp))
893. 		
894. 		# MFT ZONE.
895. 		/* Zone Number (not used for locating MFT.) */
896. 		SetVariable(MftZone, 				4) // Insert before this zone, info only.
897. 		/* Zone 10 on the Dev Volume */
898. 	
899. 	/* ---------------------------------------------------------- */
900. 	# VOLUME SPECIFIC MFT.
901. 	/* Note: You may need to set Volume specific values for the MFT location, */
902. 	/* On these volume types do not "push" the data above the MFT table? */
903. 	/* You can use a standard gap instead. */
904. 		
905. 			/* The current Volume Type Mft Percentage */
906. 		    # SetVariable(MftPer, 				0)
907. 		    # SetVariable(MftPerTypedDefault, 			"!MftPer!")
908. 			# Volume Types:	
909. 			#         SetVariable(MftPerSys, 		0.35)
910. 			# 	    SetVariable(MftPerDev, 		0.10)
911. 			# 	   SetVariable(MftPerData, 		0.35)
912. 			# 	SetVariable(MftPerArchive, 		0.10)
913. 	
914. 	/* ---------------------------------------------------------- */
915. 	# VOLUME DIR Location.
916. 	/* The amount of Gap between Mft and Dir's, the Location of DIR. */
917. 	
918. 		/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
919. 	
920. 		SetVariable(DirVolumeRoundUp, 		"!VolumeRoundUpLarge!")
921. 		SetVariable(DirVolumeGapSize, 		"!ZoneGapSizeLarge!")
922. 		
923. /* ---------------------------------------------------------- */
924. # SETTINGS YOURS
925. /* empty */
926. 
927. /* ---------------------------------------------------------- */
928. 
929. /* ---------------------------------------------------------- */
930. # STATISTICS
931. /* ---------------------------------------------------------- */
932. 
933. /* Xinclude "..\StatisticsInitialization.MyDc"X ToDo */
934. 
935. 
936. /* ---------------------------------------------------------- */
937. # GAPS
938. 	# TEST (FAILED!!!) NO BOOLEAN LOGIC AVAILABLE.
939. 	SetVariable(FlagDoNotVacate, 0)
940.  
941. /* ---------------------------------------------------------- */
942. # ZONE
943. 	SetVariable(ZoneNoCurrent, 		0)
944. 	SetVariable(ZoneNoAdjCurrent, 	0) 
945. 	SetVariable(ZoneCurrentAjust,	0)
946. 
947. 	SetVariable(ZoneListByLine, 		"Volume started.
948. ")
949. 	SetVariable(ZoneStepByLine, 		"Initialize.
950. ")
951. 	SetVariable(ZoneStatisticsDetail, 	"")
952. 
953. /* ---------------------------------------------------------- */
954. # ZONE FILE STEP (ACTIONS)
955. 	/* Nothing to set here */
956. 
957. /* ---------------------------------------------------------- */
958. # BLOB SIZE
959. 
960. 	# Size 10MB
961. 	SetVariable(BlobFileSize, 10000000)
962. 
963. /* ---------------------------------------------------------- */
964. # SKIP BLOCK
965.  
966. /* (important for run efficiency.) */
967. /* FILES: */
968. /* Day Files: 100 */
969. /* Monthly: 500 */
970. /* Yearly: 1M */
971. 
972. 	/* 100 Files - moved most blocks */
973. 	 /* 10 Files - 20211105 (error - not done) */ 
974. 	 /* 10 Files - (20211106) - Current */
975. 	 /* 5 Files - (2021????) - */
976. 	SetVariable(SkipBlockFilesDay, 10)
977. 
978. 	SetVariable(SkipBlockFilesMonth, 500)
979. 	SetVariable(SkipBlockFilesYear, 1000000)
980. 
981. 	/* Current: */
982. 	SetVariable(SkipBlockFiles,"!SkipBlockFilesMonth!")
983. 
984. /* BYTES: */
985. /* Day Bytes: 50MB */
986. /* Month Bytes: 500MB */
987. /* Year Bytes: 5GB */
988. 
989. 	 /* 50 MB Moved most existing blocks */
990. 	 /* 5 MB 20211105 (not done) */ 
991. 	 /* 1 MB 20211105 - Current */
992. 	SetVariable(SkipBlockBytesDay, 1000000)
993. 	/* SetVariable(SkipBlockBytesDay, 50000000) */
994. 
995. 	SetVariable(SkipBlockBytesMonth, 500000000)
996. 	SetVariable(SkipBlockBytesYear, 5000000000)
997. 
998. 	/* Current: */
999. 	SetVariable(SkipBlockBytes,"!SkipBlockBytesMonth!")
1000. 
1001. /* ---------------------------------------------------------- */
1002. # ZONE LOCATION METHODS:
1003. 
1004. # No 1) Standard. You can ignore this section
1005. 	/* Gaps between zones are a percentage of */
1006. 	/* free space auto adjusted to pack the used */
1007. 	/* space closely together and for performance. */
1008. 	
1009. 	/* The calculation will clear the Gap */
1010. 	/* and RoundUp to the fixed value present */
1011. 	
1012. 	SetVariable(ZoneMethodStd, 1)
1013. 
1014. /* The following are NOT FULLY IMPLEMENTED OR TESTED */
1015. # No 2) Mft. Relative to its location.
1016. 	SetVariable(ZoneMethodMft, (0-1))
1017. 
1018. # No 3) Os. Percentages are AFTER OsMftDir Space Used.
1019. 	SetVariable(ZoneMethodOs, (0-1))
1020. 
1021. # No 4) Orginal Mft/Os 1-5.
1022. 	SetVariable(ZoneMethodOrginal, (0-1))
1023. 
1024. # No 5) FIXED ZONES if you used them.
1025. 	
1026. 	SetVariable(ZoneMethodFixed, (0-1))
1027. 	SetVariable(ZoneMethodFixedPer, (0-1))
1028. 
1029. 	/* Not recommended */
1030. 	/* However doing all calcs is informative regarding what */
1031. 	/* Types of Volume data (Zones) exist. */
1032. 	
1033. 	/* Your FIXED calculation method, this can be: */
1034. 	SetVariable(ZoneMethodFixedVariantPer, (0-1))
1035. 	
1036. 	/* 1) Percentage. */
1037. 		/* So when it is 1 or On. */
1038. 		/* Not great but easy to use. */
1039. 		 
1040. 	/* 2) Fixed volume location. */
1041. 		/* When 0 or Off it is a volume location. */
1042. 		/* You will have to change: */
1043. 		/* file item xxxxxxxxx??? */
1044. 	
1045. 	/* FIXED VALUES: */
1046. 		/* SetVariable(ZoneMethodFixed, 1) */
1047. 	
1048. 		# Setting the following to a percentage or number:
1049. 		/* OS */
1050. 	    SetVariable(ZoneOsBoot, 0) // 1
1051. 	    SetVariable(ZoneOsProgramHints, 0) // 2
1052. 	    SetVariable(ZoneOsPrograms, 0) // 3
1053. 	    
1054. 	    /* MFT */
1055. 	    SetVariable(ZoneMft, 0) // Volume dependent
1056. 	    SetVariable(ZoneMftDir, 0) // Volume dependent
1057. 	
1058. 		/* Volume Sys */
1059. 	    # Os 3
1060. 	    # Mft + 2
1061. 	    SetVariable(ZoneSysRegular, 0) // 5
1062. 	    SetVariable(ZoneDevSpaceHog, 0) // 6
1063. 	
1064. 		/* Volume Dev */
1065. 	    # Os 3
1066. 	    SetVariable(ZoneDevDevToDo, 0) // 4
1067. 	    SetVariable(ZoneDevIdeScripts, 0) // 5
1068. 	    SetVariable(ZoneDevLinksCorp, 0) // 6
1069. 	    SetVariable(ZoneDevPeople, 0) // 7
1070. 	    # Mft + 2
1071. 	    SetVariable(ZoneDevShares, 0) // 10
1072. 	    SetVariable(ZoneDevSystemOtherData, 0) // 11
1073. 	    SetVariable(ZoneDevReference, 0) // 12
1074. 	    SetVariable(ZoneDevSpaceHogsArchives, 0) // 13
1075. 	
1076. 		/* Volume Archive not used currently */
1077. 		/* Volume Data not used currently */
1078. 
1079. /* ---------------------------------------------------------- */
1080. # LOGGING:
1081. /* ---------------------------------------------------------- */
1082. 
1083. 	# Log File Name:
1084. 	SetVariable(LogFileName,"Taylor Defrag 2021-11-09_10:47:49.log")
1085. 	/* SetVariable(LogFileName,"..\Logs\!MdmMyDefrag! 2021-11-09_10:47:49.log") */
1086. 	/* SetVariable(LogFileName,"!ScriptDir!Logs\!MdmMyDefrag! 2021-11-09_10:47:49.log") */
1087. 	/* SetVariable(LogFileName,"Defrag2021-11-09_10:47:49.txt") */
1088. 	/* SetVariable(LogFileName,"$ z Logs\Defrag2021-11-09_10:47:49.txt") */
1089. 	
1090. 	SetVariable(VolumeStatisticsSummary, "Not ready")
1091. 	SetVariable(VolumeStatisticsDetailed, "Not ready")
1092. 
1093. /* ---------------------------------------------------------- */
1094. # OVERRIDES
1095. /* ---------------------------------------------------------- */
1096. 
1097. 	# YOUR SETTINGS Volume overrides:
1098. 	/* empty */
1099. 
1100. 
1101. /* ---------------------------------------------------------- */
1102. # Create Run Log:
1103. 
1104. /* Write the header to the logfile. */
1105. 	# BANNER SET
1106. 
1107. # DATE TIME RUN ELP
1108. 
1109. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
1110. /* Xinclude "..\Display\BannerSet.MyDc"X */
1111. /* pause(1) */
1112. 
1113. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1114. 
1115. Title('!Heading!')
1116. /* pause(1) */
1117. 
1118. /* NOTE: Can't round or truncate to integer precision. */
1119. 
1120. 
1121. 	WriteLogfile("!LogFileName!", "Started.")
1122. 	AppendLogfile("!LogFileName!", ".")
1123. 	AppendLogfile("!LogFileName!", "!Title!")
1124. 
1125. 
1126. 	AppendLogfile("!LogFileName!", ".")
1127. 
1128. /* ---------------------------------------------------------- */
1129. /* Script Information */
1130. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-11-09 10:47:49")
1131. 	AppendLogfile("!LogFileName!", ".")
1132. 	AppendLogfile("!LogFileName!", "Script:")
1133. 	AppendLogfile("!LogFileName!", "DefragDevDiskDaily")
1134. 	AppendLogfile("!LogFileName!", ".")
1135. 	AppendLogfile("!LogFileName!", "Script Directory:")
1136. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1137. 	AppendLogfile("!LogFileName!", ".")
1138. 	AppendLogfile("!LogFileName!", "Log File:")
1139. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1140. 	AppendLogfile("!LogFileName!", ".")
1141. 
1142. /* ---------------------------------------------------------- */
1143. # Run Preprocessing Do Before.
1144. /* empty */
1145. 
1146. 
1147. 
1148. /* SkipBlock Daily: */
1149. SetVariable(SkipBlockFiles,"!SkipBlockFilesDay!")
1150. SetVariable(SkipBlockBytes,"!SkipBlockBytesDay!")
1151. 
1152. # Defrag Development Volume
1153. 
1154. SetVariable(VolumeLabel,"!VolumeDev!")
1155. SetVariable(VolumeDescription,"Development")
1156. # Display Set Volume
1157. 
1158. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1159. SetVariable(ZoneStepDescription,	"")
1160. SetVariable(FileStepDescription,	"")
1161. 
1162. SetVariable(ZoneListByLine, 		"Volume started 2021-11-09 10:47:49 0:00:01:
1163. ")
1164. SetVariable(ZoneStepByLine, 		"Pending.")
1165. 
1166. # BANNER SET
1167. 
1168. # DATE TIME RUN ELP
1169. 
1170. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
1171. /* Xinclude "..\Display\BannerSet.MyDc"X */
1172. /* pause(1) */
1173. 
1174. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1175. 
1176. Title('!Heading!')
1177. /* pause(1) */
1178. 
1179. /* NOTE: Can't round or truncate to integer precision. */
1180. 
1181. AppendLogfile("!LogFileName!", "!Title!")
1182. 
1183. 
1184. 
1185. pause(2)
1186. 
1187. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1188. 
1189. SetVariable(ZoneListByLine, "")
1190. SetVariable(ZoneFooter, "")
1191. 
1192. # This script is part of the standard disk configuration
1193. # Author: David G. Horsman (DBA MacroDM) (C) 2019
1194. # based on MyDefrag distribution.
1195. 
1196. /* Progress Display */
1197. SetVariable(ZoneListByLine, 	"Volume start.
1198. ")
1199. SetVariable(ZoneStepByLine, 	"
1200. ")
1201. 
1202. # VOLUME INFORMATION
1203. 
1204. SetVariable(VolumeNoCurrent, VolumeNoCurrent + 1)
1205. SetVariable(VolumeNoAdjCurrent, VolumeNoCurrent + VolumeCurrentAjust)
1206. 
1207. SetVariable(ZoneNoCurrent, 		0)
1208. SetVariable(ZoneNoAdjCurrent, 	0) 
1209. SetVariable(ZoneCurrentAjust,	0)
1210. 
1211. SetVariable(ZoneListByLine, 		"Volume started.
1212. ")
1213. SetVariable(ZoneStepByLine, 		"Initialize.
1214. ")
1215. SetVariable(ZoneStatisticsDetail, 	"")
1216. 
1217. SetVariable(ZoneStepNoCurrent, 0)
1218. 
1219. 
1220. # Zone Do Current Clear
1221. 
1222. SetVariable(ZoneTypeSelectCurrent, 		"")
1223. 
1224. SetVariable(ZoneBeginCurrent, 			0)
1225. SetVariable(ZoneBeginPerCurrent, 		0)
1226. SetVariable(ZoneEndCurrent, 			0)
1227. SetVariable(ZoneEndPerCurrent, 			0)
1228. 
1229. SetVariable(ZoneSizeCurrent,			0)
1230. SetVariable(ZoneSizePerCurrent,			0)
1231. 
1232. SetVariable(ZoneGapRequestedCurrent,	0)
1233. SetVariable(ZoneGapRoundedCurrent, 		0)
1234. SetVariable(ZoneGapAdjustedCurrent, 	0)
1235. SetVariable(ZoneGapAvailableCurrent, 	0)
1236. SetVariable(ZoneGapCurrent,				0)
1237. SetVariable(ZoneGapUsedCurrent, 		0)
1238. 
1239. SetVariable(ZoneGapActualCurrent, 		0)
1240. SetVariable(ZoneGapActualPerCurrent, 	0)
1241. 
1242. SetVariable(ZoneSizeActual, 			0)
1243. SetVariable(ZoneSizeActualCurrent,		0)
1244. 
1245. SetVariable(ZoneEndActual, 				0)
1246. SetVariable(ZoneEndActualCurrent,		0)			
1247. SetVariable(ZoneSizeActualPerCurrent, 	0)
1248.       
1249. SetVariable(ZoneFilesFolders,			0)
1250. SetVariable(ZoneFilesFoldersPer,		0) 
1251. 
1252. SetVariable(ZoneFragments,				0)
1253. SetVariable(ZoneFragmentsPer,			0) 
1254. 		
1255. SetVariable(ZoneEndActualCurrent, 		0)
1256. SetVariable(ZoneEndActualPerCurrent, 	0)
1257. 
1258. # Gap Calculation Methodology:
1259. 	# Requested
1260. 	SetVariable(GapRequested, 			0) 
1261. 	SetVariable(GapRequestedStd, 		0) 
1262. 	SetVariable(GapRequestedMft, 		0) 
1263. 	SetVariable(GapRequestedOs, 		0) 
1264. 	SetVariable(GapRequestedOriginal, 	0) 
1265. 	
1266. 	# Gap Adjustments
1267. 	SetVariable(GapRounded, 			0)
1268. 	# SetVariable(GapAdjusted, 			0)
1269. 	SetVariable(GapAvailable, 			0)
1270. 	SetVariable(GapCurrent, 			0)
1271. 	SetVariable(GapActual, 				0)
1272. 	SetVariable(GapUsed, 				0)
1273. 	
1274. 	# Gap Adjustments
1275. 	SetVariable(GapRoundedLoc, 			0)
1276. 	# SetVariable(GapAdjustedLoc, 		0)
1277. 	SetVariable(GapAvailableLoc, 		0)
1278. 	SetVariable(GapCurrentLoc, 			0)
1279. 	SetVariable(GapActualLoc,			0)
1280. 	SetVariable(GapUsedLoc,				0)
1281. 	
1282. 	# Space usage
1283. 	SetVariable(ZoneFreePerRequested, 	0)
1284. 	SetVariable(ZoneFreePerUsed, 		0)
1285. 
1286. # Gap Size & Rounding
1287. 	SetVariable(ZoneGapSizePer, 		0)
1288. 	SetVariable(ZoneVolRoundUpPer, 		0)
1289. 	
1290. 	# Free Space
1291. 	SetVariable(ZoneFreeUsedPer, 		0)
1292. 	SetVariable(ZoneFreeRequestedPer, 	0)
1293. 
1294. 
1295. # BANNER SET
1296. 
1297. # DATE TIME RUN ELP
1298. 
1299. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
1300. /* Xinclude "..\Display\BannerSet.MyDc"X */
1301. /* pause(1) */
1302. 
1303. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1304. 
1305. Title('!Heading!')
1306. /* pause(1) */
1307. 
1308. /* NOTE: Can't round or truncate to integer precision. */
1309. 
1310. 
1311. # OVERRIDES
1312. # YOUR SETTINGS Volume overrides:
1313. 
1314. 
1315. # SET
1316. # SetVariable(VolumeSys,"C:")
1317. 
1318. 
1319. # Display Set Volume
1320. 
1321. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1322. SetVariable(ZoneStepDescription,	"")
1323. SetVariable(FileStepDescription,	"")
1324. 
1325. SetVariable(ZoneListByLine, 		"Volume started 2021-11-09 10:47:49 0:00:01:
1326. ")
1327. SetVariable(ZoneStepByLine, 		"Pending.")
1328. 
1329. # BANNER SET
1330. 
1331. # DATE TIME RUN ELP
1332. 
1333. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
1334. /* Xinclude "..\Display\BannerSet.MyDc"X */
1335. /* pause(1) */
1336. 
1337. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1338. 
1339. Title('!Heading!')
1340. /* pause(1) */
1341. 
1342. /* NOTE: Can't round or truncate to integer precision. */
1343. 
1344. AppendLogfile("!LogFileName!", "!Title!")
1345. 
1346. 
1347. 
1348. pause(2)
1349. 
1350. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1351. 
1352. # LOGGING:
1353. 	# BANNER SET
1354. 
1355. # DATE TIME RUN ELP
1356. 
1357. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
1358. /* Xinclude "..\Display\BannerSet.MyDc"X */
1359. /* pause(1) */
1360. 
1361. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1362. 
1363. Title('!Heading!')
1364. /* pause(1) */
1365. 
1366. /* NOTE: Can't round or truncate to integer precision. */
1367. 
1368. AppendLogfile("!LogFileName!", "!Title!")
1369. 
1370. 
1371. 
1372. 
1373. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-11-09 10:47:49")
1374. 	AppendLogfile("!LogFileName!", ".")
1375. 	AppendLogfile("!LogFileName!", "Script Directory:")
1376. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1377. 	AppendLogfile("!LogFileName!", ".")
1378. 	AppendLogfile("!LogFileName!", "Log File:")
1379. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1380. 	AppendLogfile("!LogFileName!", ".")
1381. 	/* AppendLogfile("!LogFileName!", "Log Header:") */
1382. 	/* AppendLogfile("!LogFileName!", "!LogHeader!") */
1383. 	/* AppendLogfile("!LogFileName!", "End of Log Header.") */
1384. 	AppendLogfile("!LogFileName!", ".")
1385. 
1386. 	AppendLogfile("!LogFileName!", "MFT Percentage: !MftPer!")
1387. 	AppendLogfile("!LogFileName!", "MFT Volume RoundUp: !MftRoundUp!")
1388. 	AppendLogfile("!LogFileName!", "MFT Gap %: !MftAdjRoundUp!")
1389. 	AppendLogfile("!LogFileName!", ".")
1390. 
1391. /* This file is where you override the above setting for */
1392. /* global settings. */
1393. /* There is a "SettingsYours\SettingsYours???.MyDc" for each volume type */
1394. /* so this is where you set the volume specific settings */
1395. /* or you can put them all in the file below. */
1396. 
1397. # Volume Preprocessing Do Before.
1398. /* empty */
1399. 
1400. 
1401. # BANNER:
1402. /* AppendLogfile("!LogFileName!", ".")
1403. AppendLogfile("!LogFileName!", "      Volume Size: !VolumeSize!")
1404. AppendLogfile("!LogFileName!", "      Volume Used: !VolumeUsed!")
1405. AppendLogfile("!LogFileName!", "Volume Used Total: !VolumeUsedTotal!")
1406. AppendLogfile("!LogFileName!", "      Volume Free: !VolumeFree!")
1407. AppendLogfile("!LogFileName!", "  Volume Free Adj: !VolumeFreeAdj!")
1408. AppendLogfile("!LogFileName!", ".")
1409. AppendLogfile("!LogFileName!", "MFT Zone: !MftZone! Location: !MftLocation! Gap: !MftGap!")
1410. AppendLogfile("!LogFileName!", ".")
1411.  */
1412. 
1413. /* Missed: ToDo: */
1414. /* Games Zone Type */
1415. 
1416. 
1417. 
1418. 
1419. SetVariable(MftZone, "Shares")
1420. 
1421. /* empty */
1422. 
1423. 
1424. # Defrag Any Complex Volume
1425. /* Complex Volume */
1426. # MyDefrag v4.0 script: Defrag Complex (Mixed or Any) Volume.
1427. 
1428. # Set Volume Detailed Statistics:
1429. 
1430. # Set Volume summary stats:
1431. 
1432. # Cluster, Sector, Block adjust for display.
1433. # Bytes per cluster is volume specific.
1434. 
1435. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1436. 
1437. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1438. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1439. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1440. 
1441. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1442. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1443. 
1444. # Set the display text:
1445. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1446. SUMMARY: !VolumeLabel! !VolumeDescription!
1447.   
1448.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1449.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1450.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1451.          
1452.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1453.       Volume Free Adj:       !VolumeFreeAdj!
1454.     Bytes per cluster:       !BytesPerCluster! bytes
1455. 
1456.    Unfragmented Items:       !FILES200N!
1457.      Fragmented Items:       !FILES210N!
1458. 
1459.     Unfragmented Data:       !FILES202N! bytes
1460.       Fragmented Data:       !FILES212N! bytes
1461. 
1462.              All Gaps:       !GAP00N!
1463.              All gaps:       !GAP10N! bytes
1464.           Average gap:       !GAP13N! bytes
1465.            Median gap:       !GAP14N! bytes
1466.           Biggest gap:       !GAP15N! bytes
1467. ----------------------------------------------------------
1468. ") 
1469. 
1470. 
1471. 
1472. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1473. VOLUME: !VolumeLabel! !VolumeDescription!
1474. ----------------------------------------------------------
1475. !VolumeStatisticsSummary!
1476. ----------------------------------------------------------
1477. DETAILS: !VolumeLabel! !VolumeDescription!
1478. ----------------------------------------------------------
1479. 
1480. SUMMARY:
1481. 
1482. Volume label/name:          !VolumeLabel!
1483. Volume mountpoint:          !MountPoint!
1484. Volume name:                !VolumeName!
1485. Volume type:                !VolumeType!
1486. 
1487. Total disk space:           !VolumeSize! bytes
1488.                             !VolumeSizeG! gigabytes
1489. 
1490. Bytes per cluster:          !BytesPerCluster! bytes
1491. Average end-begin distance: !AverageBeginEndDistance! clusters
1492.                             !AverageBeginEndDistanceP!% of volume size
1493. 
1494. ----------------------------------------------------------
1495. FRAGMENTS:
1496. 
1497. Unfragmented Items: !FILES200N!
1498.   Fragmented Items: !FILES210N!
1499.  Unfragmented Data: !FILES202N! bytes
1500.    Fragmented Data: !FILES212N! bytes
1501. Gaps:
1502.           All Gaps: !GAP00N!
1503.           All gaps: !GAP10N! bytes
1504.        Average gap: !GAP13N! bytes
1505.         Median gap: !GAP14N! bytes
1506.        Biggest gap: !GAP15N! bytes
1507. 
1508. ----------------------------------------------------------
1509. GAPS:
1510. 
1511.    ----------------------------------------------------------
1512.    Counts:
1513.                        Count      Percentage of all
1514.                 ----------------- -----------------
1515.    Small gaps   !GAP01N! !GAP01P!%
1516.    Big gaps     !GAP02N! !GAP02P!%
1517.                 ----------------- -----------------
1518.    All gaps     !GAP00N! !GAP00P!
1519. 
1520.    ----------------------------------------------------------
1521.    By size:
1522.                       Bytes          Gigabytes      Percentage of all
1523.                 ----------------- ----------------- -----------------
1524.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1525.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1526.                 ----------------- ----------------- -----------------
1527.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1528. 
1529.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1530.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1531.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1532.    ----------------------------------------------------------
1533. 
1534. ----------------------------------------------------------
1535. FILE STATISTICS:
1536. ----------------------------------------------------------
1537. 
1538. ----------------------------------------------------------
1539. ITEM COUNT:
1540. ----------------------------------------------------------
1541. Number of files and folders:
1542. 
1543.               Unfragmented       Fragmented            All
1544.    ------- ----------------- ----------------- -----------------
1545.    Files   !FILES000N! !FILES010N! !FILES020N!
1546.    Folders !FILES100N! !FILES110N! !FILES120N!
1547.    ------- ----------------- ----------------- -----------------
1548.    All     !FILES200N! !FILES210N! !FILES220N!
1549. 
1550. ----------------------------------------------------------
1551. Percentage of total:
1552. 
1553.               Unfragmented       Fragmented            All
1554.    ------- ----------------- ----------------- -----------------
1555.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1556.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1557.    ------- ----------------- ----------------- -----------------
1558.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1559. 
1560. ----------------------------------------------------------
1561. OCCUPIED SIZE on disk:
1562. ----------------------------------------------------------
1563. Bytes:
1564.               Unfragmented       Fragmented            All
1565.    ------- ----------------- ----------------- -----------------
1566.    Files   !FILES002N! !FILES012N! !FILES022N!
1567.    Folders !FILES102N! !FILES112N! !FILES122N!
1568.    ------- ----------------- ----------------- -----------------
1569.    All     !FILES202N! !FILES212N! !FILES222N!
1570. 
1571. ----------------------------------------------------------
1572. Gigabytes:
1573.               Unfragmented       Fragmented            All
1574.    ------- ----------------- ----------------- -----------------
1575.    Files   !FILES002G! !FILES012G! !FILES022G!
1576.    Folders !FILES102G! !FILES112G! !FILES122G!
1577.    ------- ----------------- ----------------- -----------------
1578.    All     !FILES202G! !FILES212G! !FILES222G!
1579. 
1580. ----------------------------------------------------------
1581. Percentage:
1582.               Unfragmented       Fragmented            All
1583.    ------- ----------------- ----------------- -----------------
1584.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1585.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1586.    ------- ----------------- ----------------- -----------------
1587.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1588. 
1589. ----------------------------------------------------------
1590. USED SIZE:
1591. ----------------------------------------------------------
1592. Bytes:
1593.               Unfragmented       Fragmented            All
1594.    ------- ----------------- ----------------- -----------------
1595.    Files   !FILES001N! !FILES011N! !FILES021N!
1596.    Folders !FILES101N! !FILES111N! !FILES121N!
1597.    ------- ----------------- ----------------- -----------------
1598.    All     !FILES201N! !FILES211N! !FILES221N!
1599. 
1600. ----------------------------------------------------------
1601. Gigabytes:
1602.               Unfragmented       Fragmented            All
1603.    ------- ----------------- ----------------- -----------------
1604.    Files   !FILES001G! !FILES011G! !FILES021G!
1605.    Folders !FILES101G! !FILES111G! !FILES121G!
1606.    ------- ----------------- ----------------- -----------------
1607.    All     !FILES201G! !FILES211G! !FILES221G!
1608. 
1609. ----------------------------------------------------------
1610. Percentage:
1611.               Unfragmented       Fragmented            All
1612.    ------- ----------------- ----------------- -----------------
1613.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1614.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1615.    ------- ----------------- ----------------- -----------------
1616.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1617. 
1618. ----------------------------------------------------------
1619. Volume Detailed Statistics end.
1620. ----------------------------------------------------------
1621. ") 
1622. 
1623. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1624. 
1625. SetVariable(FileStepDescription,"!VolumeLabel! !VolumeDescription! started: 2021-11-09 10:47:49.")
1626. # FILE STEP
1627. 
1628. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1629. 
1630. /* add message and move to a new line. */
1631. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1632. ")
1633. 
1634. /* display the line. (hopefully.) */
1635. # Zone Footer Set Statistics Window Text
1636. 
1637. SetStatisticsWindowText("----------------------------------------------------------
1638. Zones Processed: 
1639. ----------------------------------------------------------
1640. !ZoneListByLine!
1641. ----------------------------------------------------------
1642. Zone Processing Step:
1643. !ZoneStepByLine!    
1644. ----------------------------------------------------------
1645. Current Zone:
1646. !ZoneFooter!
1647. ----------------------------------------------------------
1648. Volume Statistics:
1649. !VolumeStatisticsDetail!
1650. ----------------------------------------------------------
1651. Zone Detailed Report:
1652. ----------------------------------------------------------
1653. !ZoneStatisticsDetail!
1654. ----------------------------------------------------------
1655. ")
1656. 
1657. 
1658. 
1659. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1660. 
1661. # BANNER SET
1662. 
1663. # DATE TIME RUN ELP
1664. 
1665. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
1666. /* Xinclude "..\Display\BannerSet.MyDc"X */
1667. /* pause(1) */
1668. 
1669. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1670. 
1671. Title('!Heading!')
1672. /* pause(1) */
1673. 
1674. /* NOTE: Can't round or truncate to integer precision. */
1675. 
1676. pause(1)
1677. 
1678. SetVariable(FileStepDescription,"Analyzing Volume")
1679. # FILE STEP
1680. 
1681. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1682. 
1683. /* add message and move to a new line. */
1684. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1685. ")
1686. 
1687. /* display the line. (hopefully.) */
1688. # Zone Footer Set Statistics Window Text
1689. 
1690. SetStatisticsWindowText("----------------------------------------------------------
1691. Zones Processed: 
1692. ----------------------------------------------------------
1693. !ZoneListByLine!
1694. ----------------------------------------------------------
1695. Zone Processing Step:
1696. !ZoneStepByLine!    
1697. ----------------------------------------------------------
1698. Current Zone:
1699. !ZoneFooter!
1700. ----------------------------------------------------------
1701. Volume Statistics:
1702. !VolumeStatisticsDetail!
1703. ----------------------------------------------------------
1704. Zone Detailed Report:
1705. ----------------------------------------------------------
1706. !ZoneStatisticsDetail!
1707. ----------------------------------------------------------
1708. ")
1709. 
1710. 
1711. 
1712. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1713. 
1714. # BANNER SET
1715. 
1716. # DATE TIME RUN ELP
1717. 
1718. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
1719. /* Xinclude "..\Display\BannerSet.MyDc"X */
1720. /* pause(1) */
1721. 
1722. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1723. 
1724. Title('!Heading!')
1725. /* pause(1) */
1726. 
1727. /* NOTE: Can't round or truncate to integer precision. */
1728. 
1729. pause(1)
1730. 
1731. /* ---------------------------------------------------------- */
1732. VolumeSelect
1733. 
1734. 	Label("!VolumeLabel!") or Name("!VolumeLabel!")
1735. 
1736. /* ---------------------------------------------------------- */
1737. VolumeActions
1738. 
1739. /* ---------------------------------------------------------- */
1740. /* Volume Init */
1741. # Set Volume Detailed Statistics:
1742. 
1743. # Set Volume summary stats:
1744. 
1745. # Cluster, Sector, Block adjust for display.
1746. # Bytes per cluster is volume specific.
1747. 
1748. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1749. 
1750. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1751. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1752. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1753. 
1754. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1755. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1756. 
1757. # Set the display text:
1758. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1759. SUMMARY: !VolumeLabel! !VolumeDescription!
1760.   
1761.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1762.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1763.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1764.          
1765.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1766.       Volume Free Adj:       !VolumeFreeAdj!
1767.     Bytes per cluster:       !BytesPerCluster! bytes
1768. 
1769.    Unfragmented Items:       !FILES200N!
1770.      Fragmented Items:       !FILES210N!
1771. 
1772.     Unfragmented Data:       !FILES202N! bytes
1773.       Fragmented Data:       !FILES212N! bytes
1774. 
1775.              All Gaps:       !GAP00N!
1776.              All gaps:       !GAP10N! bytes
1777.           Average gap:       !GAP13N! bytes
1778.            Median gap:       !GAP14N! bytes
1779.           Biggest gap:       !GAP15N! bytes
1780. ----------------------------------------------------------
1781. ") 
1782. 
1783. 
1784. 
1785. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1786. VOLUME: !VolumeLabel! !VolumeDescription!
1787. ----------------------------------------------------------
1788. !VolumeStatisticsSummary!
1789. ----------------------------------------------------------
1790. DETAILS: !VolumeLabel! !VolumeDescription!
1791. ----------------------------------------------------------
1792. 
1793. SUMMARY:
1794. 
1795. Volume label/name:          !VolumeLabel!
1796. Volume mountpoint:          !MountPoint!
1797. Volume name:                !VolumeName!
1798. Volume type:                !VolumeType!
1799. 
1800. Total disk space:           !VolumeSize! bytes
1801.                             !VolumeSizeG! gigabytes
1802. 
1803. Bytes per cluster:          !BytesPerCluster! bytes
1804. Average end-begin distance: !AverageBeginEndDistance! clusters
1805.                             !AverageBeginEndDistanceP!% of volume size
1806. 
1807. ----------------------------------------------------------
1808. FRAGMENTS:
1809. 
1810. Unfragmented Items: !FILES200N!
1811.   Fragmented Items: !FILES210N!
1812.  Unfragmented Data: !FILES202N! bytes
1813.    Fragmented Data: !FILES212N! bytes
1814. Gaps:
1815.           All Gaps: !GAP00N!
1816.           All gaps: !GAP10N! bytes
1817.        Average gap: !GAP13N! bytes
1818.         Median gap: !GAP14N! bytes
1819.        Biggest gap: !GAP15N! bytes
1820. 
1821. ----------------------------------------------------------
1822. GAPS:
1823. 
1824.    ----------------------------------------------------------
1825.    Counts:
1826.                        Count      Percentage of all
1827.                 ----------------- -----------------
1828.    Small gaps   !GAP01N! !GAP01P!%
1829.    Big gaps     !GAP02N! !GAP02P!%
1830.                 ----------------- -----------------
1831.    All gaps     !GAP00N! !GAP00P!
1832. 
1833.    ----------------------------------------------------------
1834.    By size:
1835.                       Bytes          Gigabytes      Percentage of all
1836.                 ----------------- ----------------- -----------------
1837.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1838.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1839.                 ----------------- ----------------- -----------------
1840.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1841. 
1842.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1843.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1844.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1845.    ----------------------------------------------------------
1846. 
1847. ----------------------------------------------------------
1848. FILE STATISTICS:
1849. ----------------------------------------------------------
1850. 
1851. ----------------------------------------------------------
1852. ITEM COUNT:
1853. ----------------------------------------------------------
1854. Number of files and folders:
1855. 
1856.               Unfragmented       Fragmented            All
1857.    ------- ----------------- ----------------- -----------------
1858.    Files   !FILES000N! !FILES010N! !FILES020N!
1859.    Folders !FILES100N! !FILES110N! !FILES120N!
1860.    ------- ----------------- ----------------- -----------------
1861.    All     !FILES200N! !FILES210N! !FILES220N!
1862. 
1863. ----------------------------------------------------------
1864. Percentage of total:
1865. 
1866.               Unfragmented       Fragmented            All
1867.    ------- ----------------- ----------------- -----------------
1868.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1869.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1870.    ------- ----------------- ----------------- -----------------
1871.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1872. 
1873. ----------------------------------------------------------
1874. OCCUPIED SIZE on disk:
1875. ----------------------------------------------------------
1876. Bytes:
1877.               Unfragmented       Fragmented            All
1878.    ------- ----------------- ----------------- -----------------
1879.    Files   !FILES002N! !FILES012N! !FILES022N!
1880.    Folders !FILES102N! !FILES112N! !FILES122N!
1881.    ------- ----------------- ----------------- -----------------
1882.    All     !FILES202N! !FILES212N! !FILES222N!
1883. 
1884. ----------------------------------------------------------
1885. Gigabytes:
1886.               Unfragmented       Fragmented            All
1887.    ------- ----------------- ----------------- -----------------
1888.    Files   !FILES002G! !FILES012G! !FILES022G!
1889.    Folders !FILES102G! !FILES112G! !FILES122G!
1890.    ------- ----------------- ----------------- -----------------
1891.    All     !FILES202G! !FILES212G! !FILES222G!
1892. 
1893. ----------------------------------------------------------
1894. Percentage:
1895.               Unfragmented       Fragmented            All
1896.    ------- ----------------- ----------------- -----------------
1897.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1898.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1899.    ------- ----------------- ----------------- -----------------
1900.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1901. 
1902. ----------------------------------------------------------
1903. USED SIZE:
1904. ----------------------------------------------------------
1905. Bytes:
1906.               Unfragmented       Fragmented            All
1907.    ------- ----------------- ----------------- -----------------
1908.    Files   !FILES001N! !FILES011N! !FILES021N!
1909.    Folders !FILES101N! !FILES111N! !FILES121N!
1910.    ------- ----------------- ----------------- -----------------
1911.    All     !FILES201N! !FILES211N! !FILES221N!
1912. 
1913. ----------------------------------------------------------
1914. Gigabytes:
1915.               Unfragmented       Fragmented            All
1916.    ------- ----------------- ----------------- -----------------
1917.    Files   !FILES001G! !FILES011G! !FILES021G!
1918.    Folders !FILES101G! !FILES111G! !FILES121G!
1919.    ------- ----------------- ----------------- -----------------
1920.    All     !FILES201G! !FILES211G! !FILES221G!
1921. 
1922. ----------------------------------------------------------
1923. Percentage:
1924.               Unfragmented       Fragmented            All
1925.    ------- ----------------- ----------------- -----------------
1926.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1927.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1928.    ------- ----------------- ----------------- -----------------
1929.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1930. 
1931. ----------------------------------------------------------
1932. Volume Detailed Statistics end.
1933. ----------------------------------------------------------
1934. ") 
1935. 
1936. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1937. 
1938. SetVariable(FileStepDescription,"Volume started.")
1939. # FILE STEP
1940. 
1941. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1942. 
1943. /* add message and move to a new line. */
1944. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1945. ")
1946. 
1947. /* display the line. (hopefully.) */
1948. # Zone Footer Set Statistics Window Text
1949. 
1950. SetStatisticsWindowText("----------------------------------------------------------
1951. Zones Processed: 
1952. ----------------------------------------------------------
1953. !ZoneListByLine!
1954. ----------------------------------------------------------
1955. Zone Processing Step:
1956. !ZoneStepByLine!    
1957. ----------------------------------------------------------
1958. Current Zone:
1959. !ZoneFooter!
1960. ----------------------------------------------------------
1961. Volume Statistics:
1962. !VolumeStatisticsDetail!
1963. ----------------------------------------------------------
1964. Zone Detailed Report:
1965. ----------------------------------------------------------
1966. !ZoneStatisticsDetail!
1967. ----------------------------------------------------------
1968. ")
1969. 
1970. 
1971. 
1972. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1973. 
1974. # BANNER SET
1975. 
1976. # DATE TIME RUN ELP
1977. 
1978. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
1979. /* Xinclude "..\Display\BannerSet.MyDc"X */
1980. /* pause(1) */
1981. 
1982. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1983. 
1984. Title('!Heading!')
1985. /* pause(1) */
1986. 
1987. /* NOTE: Can't round or truncate to integer precision. */
1988. 
1989. pause(1)
1990. 
1991. # Volume When Started
1992. 
1993. SetVariable(VolumeFreeAdj, (VolumeFree * (VolumeUsed / VolumeSize)))
1994. 
1995. SetVariable(MftLocation, RoundUp(VolumeUsed * MftPerDev, VolumeSize * VolumeRoundUpLarge)) 
1996. 
1997. SetVariable(ZoneListByLine, 		"Volume started.
1998. ")
1999. SetVariable(ZoneStepByLine, 		"Initialize.
2000. ")
2001. SetVariable(ZoneStatisticsDetail, 	"")
2002. 
2003. SetVariable(ZoneNoCurrent, 		0)
2004. SetVariable(ZoneNoAdjCurrent, 	0) 
2005. SetVariable(ZoneCurrentAjust,	0)
2006. 
2007. # BANNER SET
2008. 
2009. # DATE TIME RUN ELP
2010. 
2011. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:49 0:00:01")
2012. /* Xinclude "..\Display\BannerSet.MyDc"X */
2013. /* pause(1) */
2014. 
2015. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2016. 
2017. Title('!Heading!')
2018. /* pause(1) */
2019. 
2020. /* NOTE: Can't round or truncate to integer precision. */
2021. 
2022. AppendLogfile("!LogFileName!", "!Title!")
2023. 
2024. 
2025. # Set Volume Detailed Statistics:
2026. 
2027. # Set Volume summary stats:
2028. 
2029. # Cluster, Sector, Block adjust for display.
2030. # Bytes per cluster is volume specific.
2031. 
2032. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
2033. 
2034. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
2035. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
2036. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2037. 
2038. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
2039. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2040. 
2041. # Set the display text:
2042. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
2043. SUMMARY: !VolumeLabel! !VolumeDescription!
2044.   
2045.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
2046.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
2047.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
2048.          
2049.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
2050.       Volume Free Adj:       !VolumeFreeAdj!
2051.     Bytes per cluster:       !BytesPerCluster! bytes
2052. 
2053.    Unfragmented Items:       !FILES200N!
2054.      Fragmented Items:       !FILES210N!
2055. 
2056.     Unfragmented Data:       !FILES202N! bytes
2057.       Fragmented Data:       !FILES212N! bytes
2058. 
2059.              All Gaps:       !GAP00N!
2060.              All gaps:       !GAP10N! bytes
2061.           Average gap:       !GAP13N! bytes
2062.            Median gap:       !GAP14N! bytes
2063.           Biggest gap:       !GAP15N! bytes
2064. ----------------------------------------------------------
2065. ") 
2066. 
2067. 
2068. 
2069. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
2070. VOLUME: !VolumeLabel! !VolumeDescription!
2071. ----------------------------------------------------------
2072. !VolumeStatisticsSummary!
2073. ----------------------------------------------------------
2074. DETAILS: !VolumeLabel! !VolumeDescription!
2075. ----------------------------------------------------------
2076. 
2077. SUMMARY:
2078. 
2079. Volume label/name:          !VolumeLabel!
2080. Volume mountpoint:          !MountPoint!
2081. Volume name:                !VolumeName!
2082. Volume type:                !VolumeType!
2083. 
2084. Total disk space:           !VolumeSize! bytes
2085.                             !VolumeSizeG! gigabytes
2086. 
2087. Bytes per cluster:          !BytesPerCluster! bytes
2088. Average end-begin distance: !AverageBeginEndDistance! clusters
2089.                             !AverageBeginEndDistanceP!% of volume size
2090. 
2091. ----------------------------------------------------------
2092. FRAGMENTS:
2093. 
2094. Unfragmented Items: !FILES200N!
2095.   Fragmented Items: !FILES210N!
2096.  Unfragmented Data: !FILES202N! bytes
2097.    Fragmented Data: !FILES212N! bytes
2098. Gaps:
2099.           All Gaps: !GAP00N!
2100.           All gaps: !GAP10N! bytes
2101.        Average gap: !GAP13N! bytes
2102.         Median gap: !GAP14N! bytes
2103.        Biggest gap: !GAP15N! bytes
2104. 
2105. ----------------------------------------------------------
2106. GAPS:
2107. 
2108.    ----------------------------------------------------------
2109.    Counts:
2110.                        Count      Percentage of all
2111.                 ----------------- -----------------
2112.    Small gaps   !GAP01N! !GAP01P!%
2113.    Big gaps     !GAP02N! !GAP02P!%
2114.                 ----------------- -----------------
2115.    All gaps     !GAP00N! !GAP00P!
2116. 
2117.    ----------------------------------------------------------
2118.    By size:
2119.                       Bytes          Gigabytes      Percentage of all
2120.                 ----------------- ----------------- -----------------
2121.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
2122.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
2123.                 ----------------- ----------------- -----------------
2124.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
2125. 
2126.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
2127.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
2128.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
2129.    ----------------------------------------------------------
2130. 
2131. ----------------------------------------------------------
2132. FILE STATISTICS:
2133. ----------------------------------------------------------
2134. 
2135. ----------------------------------------------------------
2136. ITEM COUNT:
2137. ----------------------------------------------------------
2138. Number of files and folders:
2139. 
2140.               Unfragmented       Fragmented            All
2141.    ------- ----------------- ----------------- -----------------
2142.    Files   !FILES000N! !FILES010N! !FILES020N!
2143.    Folders !FILES100N! !FILES110N! !FILES120N!
2144.    ------- ----------------- ----------------- -----------------
2145.    All     !FILES200N! !FILES210N! !FILES220N!
2146. 
2147. ----------------------------------------------------------
2148. Percentage of total:
2149. 
2150.               Unfragmented       Fragmented            All
2151.    ------- ----------------- ----------------- -----------------
2152.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
2153.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
2154.    ------- ----------------- ----------------- -----------------
2155.    All     !FILES200P!%!FILES210P!%!FILES220P!%
2156. 
2157. ----------------------------------------------------------
2158. OCCUPIED SIZE on disk:
2159. ----------------------------------------------------------
2160. Bytes:
2161.               Unfragmented       Fragmented            All
2162.    ------- ----------------- ----------------- -----------------
2163.    Files   !FILES002N! !FILES012N! !FILES022N!
2164.    Folders !FILES102N! !FILES112N! !FILES122N!
2165.    ------- ----------------- ----------------- -----------------
2166.    All     !FILES202N! !FILES212N! !FILES222N!
2167. 
2168. ----------------------------------------------------------
2169. Gigabytes:
2170.               Unfragmented       Fragmented            All
2171.    ------- ----------------- ----------------- -----------------
2172.    Files   !FILES002G! !FILES012G! !FILES022G!
2173.    Folders !FILES102G! !FILES112G! !FILES122G!
2174.    ------- ----------------- ----------------- -----------------
2175.    All     !FILES202G! !FILES212G! !FILES222G!
2176. 
2177. ----------------------------------------------------------
2178. Percentage:
2179.               Unfragmented       Fragmented            All
2180.    ------- ----------------- ----------------- -----------------
2181.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
2182.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
2183.    ------- ----------------- ----------------- -----------------
2184.    All     !FILES202P!%!FILES212P!%!FILES222P!%
2185. 
2186. ----------------------------------------------------------
2187. USED SIZE:
2188. ----------------------------------------------------------
2189. Bytes:
2190.               Unfragmented       Fragmented            All
2191.    ------- ----------------- ----------------- -----------------
2192.    Files   !FILES001N! !FILES011N! !FILES021N!
2193.    Folders !FILES101N! !FILES111N! !FILES121N!
2194.    ------- ----------------- ----------------- -----------------
2195.    All     !FILES201N! !FILES211N! !FILES221N!
2196. 
2197. ----------------------------------------------------------
2198. Gigabytes:
2199.               Unfragmented       Fragmented            All
2200.    ------- ----------------- ----------------- -----------------
2201.    Files   !FILES001G! !FILES011G! !FILES021G!
2202.    Folders !FILES101G! !FILES111G! !FILES121G!
2203.    ------- ----------------- ----------------- -----------------
2204.    All     !FILES201G! !FILES211G! !FILES221G!
2205. 
2206. ----------------------------------------------------------
2207. Percentage:
2208.               Unfragmented       Fragmented            All
2209.    ------- ----------------- ----------------- -----------------
2210.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
2211.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
2212.    ------- ----------------- ----------------- -----------------
2213.    All     !FILES201P!%!FILES211P!%!FILES221P!%
2214. 
2215. ----------------------------------------------------------
2216. Volume Detailed Statistics end.
2217. ----------------------------------------------------------
2218. ") 
2219. 
2220. AppendLogfile("!LogFileName!", "!Title!")
2221. 
2222. 
2223. 
2224. /* Write/display stats: */
2225. # Log:
2226. AppendLogfile("!LogFileName!", "!Title! started.")
2227. AppendLogfile("!LogFileName!", "2021-11-09 10:47:49.")
2228. AppendLogfile("!LogFileName!",".")
2229. AppendLogfile("!LogFileName!", ".")
2230. AppendLogfile("!LogFileName!", "Volume: !VolumeLabel!")
2231. AppendLogfile("!LogFileName!",".")
2232. AppendLogfile("!LogFileName!","!VolumeStatisticsDetail!")
2233. AppendLogfile("!LogFileName!",".")
2234. AppendLogfile("!LogFileName!", "!Title! started.")
2235. AppendLogfile("!LogFileName!", "2021-11-09 10:47:49.")
2236. AppendLogfile("!LogFileName!",".")
2237. 
2238. # In program statistics window (view):
2239. SetStatisticsWindowText("!VolumeStatisticsDetail!")
2240. 
2241. 
2242. /* ---------------------------------------------------------- */
2243. /* System Zones */
2244. /* ---------------------------------------------------------- */
2245. 
2246. 	# Defrag Zones Os
2247. 	/* System Zones */
2248. 
2249. AppendLogfile("!LogFileName!", "!Description! Os Zones started: 2021-11-09 10:47:50")
2250. SetVariable(FileStepDescription,"System Zones.")
2251. # BANNER SET
2252. 
2253. # DATE TIME RUN ELP
2254. 
2255. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:50 0:00:02")
2256. /* Xinclude "..\Display\BannerSet.MyDc"X */
2257. /* pause(1) */
2258. 
2259. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2260. 
2261. Title('!Heading!')
2262. /* pause(1) */
2263. 
2264. /* NOTE: Can't round or truncate to integer precision. */
2265. 
2266. AppendLogfile("!LogFileName!", "!Title!")
2267. 
2268. 
2269. AppendLogfile("!LogFileName!",".")
2270. 
2271. AppendLogfile("!LogFileName!", "System Disk optimized layout for boot and executables. 2021-11-09 10:47:50")
2272. /* Dgh 20190618 */
2273. 
2274. /* ---------------------------------------------------------- */
2275. /* Defrag the Pagefile.sys on the next boot. */
2276. 
2277. # PagedFrg - Page Defrag.
2278. 
2279. /* Defrag the Pagefile.sys on the next boot. */
2280. # RunProgram("..\Pagedfrg.exe","-o")
2281. 
2282. 
2283. /* ---------------------------------------------------------- */
2284. AppendLogfile("!LogFileName!", "Place files at the beginning of the disk: 2021-11-09 10:47:50")
2285. 
2286. 	MakeGap(0)
2287. 
2288. /* ---------------------------------------------------------- */
2289. # Zone Boot Fixed.
2290. /* ---------------------------------------------------------- */
2291. # Zone Boot Fixed.
2292. 	SetVariable(ZoneLabel, 			"!ZoneLabelBoot!")
2293. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBoot!")
2294. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
2295. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
2296. 	SetVariable(ZoneTypeSelect,'# Boot start.
2297. ImportListFromBootOptimize()
2298. # Boot end.
2299. ')
2300. 
2301. 		# Zone Do Header
2302. 
2303. # Zone When Started
2304. 
2305. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
2306. # Display Set Zone
2307. 
2308. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
2309. SetVariable(FileStepDescription,	"")
2310. 
2311. SetVariable(ZoneStepByLine, 			"Zone started.
2312. ")
2313. 
2314. # BANNER SET
2315. 
2316. # DATE TIME RUN ELP
2317. 
2318. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:50 0:00:02")
2319. /* Xinclude "..\Display\BannerSet.MyDc"X */
2320. /* pause(1) */
2321. 
2322. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2323. 
2324. Title('!Heading!')
2325. /* pause(1) */
2326. 
2327. /* NOTE: Can't round or truncate to integer precision. */
2328. 
2329. AppendLogfile("!LogFileName!", "!Title!")
2330. 
2331. 
2332. 
2333. pause(1)
2334. 
2335. 
2336. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
2337. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
2338. 
2339. SetVariable(ZoneStepNoCurrent, 0)
2340. 
2341. 
2342. # Zone Do Current Clear
2343. 
2344. SetVariable(ZoneTypeSelectCurrent, 		"")
2345. 
2346. SetVariable(ZoneBeginCurrent, 			0)
2347. SetVariable(ZoneBeginPerCurrent, 		0)
2348. SetVariable(ZoneEndCurrent, 			0)
2349. SetVariable(ZoneEndPerCurrent, 			0)
2350. 
2351. SetVariable(ZoneSizeCurrent,			0)
2352. SetVariable(ZoneSizePerCurrent,			0)
2353. 
2354. SetVariable(ZoneGapRequestedCurrent,	0)
2355. SetVariable(ZoneGapRoundedCurrent, 		0)
2356. SetVariable(ZoneGapAdjustedCurrent, 	0)
2357. SetVariable(ZoneGapAvailableCurrent, 	0)
2358. SetVariable(ZoneGapCurrent,				0)
2359. SetVariable(ZoneGapUsedCurrent, 		0)
2360. 
2361. SetVariable(ZoneGapActualCurrent, 		0)
2362. SetVariable(ZoneGapActualPerCurrent, 	0)
2363. 
2364. SetVariable(ZoneSizeActual, 			0)
2365. SetVariable(ZoneSizeActualCurrent,		0)
2366. 
2367. SetVariable(ZoneEndActual, 				0)
2368. SetVariable(ZoneEndActualCurrent,		0)			
2369. SetVariable(ZoneSizeActualPerCurrent, 	0)
2370.       
2371. SetVariable(ZoneFilesFolders,			0)
2372. SetVariable(ZoneFilesFoldersPer,		0) 
2373. 
2374. SetVariable(ZoneFragments,				0)
2375. SetVariable(ZoneFragmentsPer,			0) 
2376. 		
2377. SetVariable(ZoneEndActualCurrent, 		0)
2378. SetVariable(ZoneEndActualPerCurrent, 	0)
2379. 
2380. # Gap Calculation Methodology:
2381. 	# Requested
2382. 	SetVariable(GapRequested, 			0) 
2383. 	SetVariable(GapRequestedStd, 		0) 
2384. 	SetVariable(GapRequestedMft, 		0) 
2385. 	SetVariable(GapRequestedOs, 		0) 
2386. 	SetVariable(GapRequestedOriginal, 	0) 
2387. 	
2388. 	# Gap Adjustments
2389. 	SetVariable(GapRounded, 			0)
2390. 	# SetVariable(GapAdjusted, 			0)
2391. 	SetVariable(GapAvailable, 			0)
2392. 	SetVariable(GapCurrent, 			0)
2393. 	SetVariable(GapActual, 				0)
2394. 	SetVariable(GapUsed, 				0)
2395. 	
2396. 	# Gap Adjustments
2397. 	SetVariable(GapRoundedLoc, 			0)
2398. 	# SetVariable(GapAdjustedLoc, 		0)
2399. 	SetVariable(GapAvailableLoc, 		0)
2400. 	SetVariable(GapCurrentLoc, 			0)
2401. 	SetVariable(GapActualLoc,			0)
2402. 	SetVariable(GapUsedLoc,				0)
2403. 	
2404. 	# Space usage
2405. 	SetVariable(ZoneFreePerRequested, 	0)
2406. 	SetVariable(ZoneFreePerUsed, 		0)
2407. 
2408. # Gap Size & Rounding
2409. 	SetVariable(ZoneGapSizePer, 		0)
2410. 	SetVariable(ZoneVolRoundUpPer, 		0)
2411. 	
2412. 	# Free Space
2413. 	SetVariable(ZoneFreeUsedPer, 		0)
2414. 	SetVariable(ZoneFreeRequestedPer, 	0)
2415. 
2416. 
2417. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
2418. 
2419. # Footer:
2420. SetVariable(ZoneFooter, "----------------------------------------------------------
2421. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:50
2422. 
2423. Statistics Report:
2424. ------------------
2425.    Size:  
2426.    ------------------------
2427.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2428.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2429.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2430. 
2431.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2432.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2433. 
2434.    Location:
2435.    ------------------------
2436.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2437.              Files End: !ZoneEndCurrent!
2438.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2439.       
2440.    Gap Settings:
2441.    ------------------------
2442.          Gap Requested: !ZoneGapSizePer!%
2443.       Volume Rounding: !ZoneVolRoundUpPer!%
2444.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2445.                  
2446.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
2447.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
2448.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
2449.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
2450.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
2451.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
2452.      
2453.    Free Space after Zone:
2454.    ------------------------
2455.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
2456.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
2457.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
2458. 
2459. Directory and Files Select:
2460. ---------------------------
2461. !ZoneTypeSelectCurrent!               
2462. ---------------------------
2463. ----------------------------------------------------------
2464. ")
2465. 
2466. # BANNER SET
2467. 
2468. # DATE TIME RUN ELP
2469. 
2470. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:50 0:00:02")
2471. /* Xinclude "..\Display\BannerSet.MyDc"X */
2472. /* pause(1) */
2473. 
2474. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2475. 
2476. Title('!Heading!')
2477. /* pause(1) */
2478. 
2479. /* NOTE: Can't round or truncate to integer precision. */
2480. 
2481. AppendLogfile("!LogFileName!", "!Title!")
2482. 
2483. 
2484. 
2485. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
2486. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
2487. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:50")
2488. 
2489. SetVariable(ZoneListByLine, "!ZoneListByLine!
2490. Zone: !ZoneNoCurrent! 2021-11-09 10:47:50 0:00:02 !ZoneLabel! !ZoneDescription!")
2491. 
2492. 
2493. /* Fixed Zone Position Handling */
2494. /* Literal number: */
2495. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
2496. /* Percentage of disk: */
2497. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
2498. /* Gap */
2499. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
2500. 
2501. /* ---------------------------------------------------------- */
2502. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
2503. # FILE STEP
2504. 
2505. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2506. 
2507. /* add message and move to a new line. */
2508. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2509. ")
2510. 
2511. /* display the line. (hopefully.) */
2512. # Zone Footer Set Statistics Window Text
2513. 
2514. SetStatisticsWindowText("----------------------------------------------------------
2515. Zones Processed: 
2516. ----------------------------------------------------------
2517. !ZoneListByLine!
2518. ----------------------------------------------------------
2519. Zone Processing Step:
2520. !ZoneStepByLine!    
2521. ----------------------------------------------------------
2522. Current Zone:
2523. !ZoneFooter!
2524. ----------------------------------------------------------
2525. Volume Statistics:
2526. !VolumeStatisticsDetail!
2527. ----------------------------------------------------------
2528. Zone Detailed Report:
2529. ----------------------------------------------------------
2530. !ZoneStatisticsDetail!
2531. ----------------------------------------------------------
2532. ")
2533. 
2534. 
2535. 
2536. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2537. 
2538. # BANNER SET
2539. 
2540. # DATE TIME RUN ELP
2541. 
2542. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:50 0:00:02")
2543. /* Xinclude "..\Display\BannerSet.MyDc"X */
2544. /* pause(1) */
2545. 
2546. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2547. 
2548. Title('!Heading!')
2549. /* pause(1) */
2550. 
2551. /* NOTE: Can't round or truncate to integer precision. */
2552. 
2553. pause(1)
2554. 
2555. # your stuff HERE (X)... pre file select code.
2556. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
2557. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
2558. 	# (X)
2559. 
2560. FileSelect
2561. 
2562. 	# your stuff can't really go here (errors.)
2563. 	# maybe for some reason I don't know of...
2564. 	
2565. 	# Actions next...
2566. 		# Boot start.
2567. ImportListFromBootOptimize()
2568. # Boot end.
2569. 
2570. 		and not(
2571. 			# Os Data Dynamic start.
2572. (
2573. # Os Data Dynamic start.
2574. (
2575.   FileName("*.dat*")
2576.   or FileName("*.db*")
2577.   or FileName("*.edb*")
2578.   or FileName("*.log*")
2579.   or FileName("DataStore.edb")
2580. )
2581. # Os Data Dynamic end.
2582. 
2583.   or 
2584. # Os PageHiberDump start.
2585. (
2586.   FileName("DataStore.edb")
2587.   or FileName("DUMP*.*")
2588.   or FileName("Hiberfil.sys")
2589.   or FileName("MEMORY.DMP")
2590.   or FileName("Pagefile.sys")
2591. )
2592. # Os PageHiberDump end.
2593. 
2594. # Os Data Dynamic
2595. )
2596. # Os Data Dynamic end.
2597. 
2598. 		)
2599. 		FileActions
2600. 		  		/* ---------------------------------------------------------- */
2601. 	# Gap
2602. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
2603. 		# FILE STEP
2604. 
2605. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2606. 
2607. /* add message and move to a new line. */
2608. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2609. ")
2610. 
2611. /* display the line. (hopefully.) */
2612. # Zone Footer Set Statistics Window Text
2613. 
2614. SetStatisticsWindowText("----------------------------------------------------------
2615. Zones Processed: 
2616. ----------------------------------------------------------
2617. !ZoneListByLine!
2618. ----------------------------------------------------------
2619. Zone Processing Step:
2620. !ZoneStepByLine!    
2621. ----------------------------------------------------------
2622. Current Zone:
2623. !ZoneFooter!
2624. ----------------------------------------------------------
2625. Volume Statistics:
2626. !VolumeStatisticsDetail!
2627. ----------------------------------------------------------
2628. Zone Detailed Report:
2629. ----------------------------------------------------------
2630. !ZoneStatisticsDetail!
2631. ----------------------------------------------------------
2632. ")
2633. 
2634. 
2635. 
2636. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2637. 
2638. # BANNER SET
2639. 
2640. # DATE TIME RUN ELP
2641. 
2642. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:50 0:00:02")
2643. /* Xinclude "..\Display\BannerSet.MyDc"X */
2644. /* pause(1) */
2645. 
2646. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2647. 
2648. Title('!Heading!')
2649. /* pause(1) */
2650. 
2651. /* NOTE: Can't round or truncate to integer precision. */
2652. 
2653. pause(1)
2654. 	
2655. 	# ACTUAL GAP
2656. 		/* AddGap Variant. */
2657. 	  	# Zone Do Gap
2658. # Gap Calculation Methods:
2659. 
2660. /* 1) Anything you need to add first. */
2661. /* empty */
2662. 
2663. /* ---------------------------------------------------------- */
2664. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
2665. 	# GapRequestedStd.
2666. 
2667. 		/* ---------------------------------------------------------- */
2668. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
2669. 
2670. 		# Gap Calculation Methods:
2671. 
2672. /* AddGap Variants */
2673. 
2674. 	/* Standard */
2675. 		# Gap Calculation Methods:
2676. 	/* AddGap Variants */
2677. 	/* Standard */
2678. 
2679. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
2680. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
2681. 
2682. 	SetVariable(GapRequested, GapRequestedStd)
2683. 	
2684. 
2685. 	/* MFT Low High Method */
2686. 		# Gap Calculation Methods:
2687. 	/* AddGap Variants */
2688. 	/* MFT Low High Method */
2689. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
2690. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
2691. 	SetVariable(GapRequested, GapRequestedMft)
2692. 	
2693. 
2694. 	/* OS Volume Type Method */
2695. 		# Gap Calculation Methods:
2696. 	/* AddGap Variants */
2697. 	/* OS Volume Type Method */
2698. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
2699. 	SetVariable(GapRequested, GapRequestedOs)
2700. 
2701. 
2702. 
2703. /* MakeGap Variants */
2704. 
2705. 	/* Original Os 1-3 + MFT 2 */
2706. 		# Gap Calculation Methods:
2707. 	/* MakeGap Variants */
2708. 	/* Original Os 1-3 + MFT 2 */
2709. 	/* plus MFT gap placed inline at the dividing zone. */
2710. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
2711. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
2712. 	SetVariable(GapRequested, GapRequestedOrig)
2713. 	
2714. 	
2715. /* Note: You could comment out the ones not in use */
2716. /* However having the data in the log is useful. */
2717. /* Therefore the following line is otherwise needed. */
2718. 
2719. /* Standard used */
2720. 
2721. SetVariable(GapRequested, GapRequestedStd)
2722. 
2723. # Gap Calculation Methods:
2724. 
2725. /* AddGap Variants */
2726. 	/* Standard */
2727. 	/* MFT Low High Method */
2728. 	/* OS Volume Type Method */
2729. 
2730. /* MakeGap Variants */
2731. 	/* Original Os 1-3 + MFT 2 */
2732. 
2733. /* Note: You could comment out the ones not in use */
2734. /* However having the data in the log is useful. */
2735. /* Therefore the following line is otherwise needed. */
2736. 
2737. /* Standard is used currently */
2738. 
2739. 
2740. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
2741. 
2742. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
2743. 
2744. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
2745. 
2746. /* ---------------------------------------------------------- */
2747. /* 3) SMALL ZONE ADJUSTMENT. */
2748. /* Gab cant be larger than half the Zone Size. */
2749. 
2750. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
2751. 	
2752. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
2753. 
2754. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
2755. 
2756. /* ---------------------------------------------------------- */
2757. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
2758. # Gap Adjustments.
2759. 
2760. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
2761. 	
2762. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
2763. 
2764. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
2765. 
2766. /* ---------------------------------------------------------- */
2767. # BYPASS THIS.
2768. 	/* This is definitely wrong. */
2769. 	/* The question is can we steal gap from the next zone */
2770. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
2771. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
2772. 		# Zone Overflow.
2773. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
2774. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
2775. 
2776. /* ---------------------------------------------------------- */
2777. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
2778. # Remaining free space available.
2779. 
2780. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
2781. 	
2782. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
2783. 
2784. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
2785. 
2786. /* ---------------------------------------------------------- */
2787. # CURRENT gap to use.
2788. 
2789. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
2790. 
2791. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
2792. 
2793. /* ---------------------------------------------------------- */
2794. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
2795. # Debugging.
2796. 
2797. 	SetVariable(GapUsed, GapCurrent) // for debugging
2798. 
2799. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
2800. 
2801. 		# Your code HERE
2802. 
2803. /* ---------------------------------------------------------- */
2804. /* 7) YOUR CODE. */
2805. # YOUR CODE HERE:
2806. 	# INPUT: GapCurrent or GapCurrentLoc
2807. 	# OUTPUT: GapUsed...
2808. 
2809. /* ---------------------------------------------------------- */
2810. # Gap Size.
2811. # Actual Size of Gap.
2812. 
2813. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
2814. 
2815. /* ---------------------------------------------------------- */
2816. /* xxxxxxxxxxxxxxxxxxxxxx */
2817. # ADD THE GAP
2818. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
2819. /* xxxxxxxxxxxxxxxxxxxxxx */
2820. 
2821. 	
2822. 	# Zone Statistics	
2823. 	# Zone / Volume Statistics and Display
2824. 		
2825. 	# Accumulate Totals
2826.   	# Volume totals
2827. 
2828. /* Current total space used (by Zones and Gaps) */
2829. 
2830. SetVariable(VolumeZoneUsed, GapUsed)
2831. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
2832. /* Percentage */
2833. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
2834. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
2835. 
2836. /* Current total of free space requested */
2837. 
2838. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
2839. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2840. /* Percent. */
2841. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
2842. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2843. 
2844. /* Current total of free space used */
2845. 
2846. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
2847. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
2848. /* Percent */
2849. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
2850. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
2851. 
2852. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
2853. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
2854. /* Xinclude "..\DebugDisplayPause.MyDc"X */
2855. 
2856. 
2857. 	# Current Values
2858. 	# Cluster, Sector, Block adjust for display.
2859. 	# Bytes per cluster is volume specific.
2860. 
2861. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
2862. 
2863. # Current Zone values.
2864. 	# Begin, end and size.
2865. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
2866. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
2867. 
2868. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
2869. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
2870. 
2871. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
2872. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
2873. 
2874. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
2875. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
2876. 
2877. 	SetVariable(ZoneFragments,				"!ZONE210N!")
2878. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
2879. 		
2880. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
2881. /* identical code to here: (separation not needed. TEST.) */	
2882. 
2883. # Current Gap, Actual and Free Values
2884. 	# Gap
2885. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
2886. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
2887. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
2888. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
2889. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
2890. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
2891. 	
2892. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
2893. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
2894. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
2895. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
2896. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
2897. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
2898. 	
2899. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
2900. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
2901. 	
2902. 	# Actual Size and End
2903. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
2904. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
2905. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
2906. 	
2907. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
2908. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
2909. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
2910. 
2911. # Gap Size & Rounding
2912. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
2913. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
2914. 	
2915. 	# Free Space
2916. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
2917. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
2918. 
2919. 	# Footer:
2920. SetVariable(ZoneFooter, "----------------------------------------------------------
2921. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:50
2922. 
2923. Statistics Report:
2924. ------------------
2925.    Size:  
2926.    ------------------------
2927.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2928.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2929.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2930. 
2931.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2932.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2933. 
2934.    Location:
2935.    ------------------------
2936.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2937.              Files End: !ZoneEndCurrent!
2938.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2939.       
2940.    Gap Settings:
2941.    ------------------------
2942.          Gap Requested: !ZoneGapSizePer!%
2943.       Volume Rounding: !ZoneVolRoundUpPer!%
2944.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2945.                  
2946.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
2947.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
2948.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
2949.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
2950.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
2951.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
2952.      
2953.    Free Space after Zone:
2954.    ------------------------
2955.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
2956.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
2957.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
2958. 
2959. Directory and Files Select:
2960. ---------------------------
2961. !ZoneTypeSelectCurrent!               
2962. ---------------------------
2963. ----------------------------------------------------------
2964. ")
2965. 	# Zone Footer Set Statistics Window Text
2966. 
2967. SetStatisticsWindowText("----------------------------------------------------------
2968. Zones Processed: 
2969. ----------------------------------------------------------
2970. !ZoneListByLine!
2971. ----------------------------------------------------------
2972. Zone Processing Step:
2973. !ZoneStepByLine!    
2974. ----------------------------------------------------------
2975. Current Zone:
2976. !ZoneFooter!
2977. ----------------------------------------------------------
2978. Volume Statistics:
2979. !VolumeStatisticsDetail!
2980. ----------------------------------------------------------
2981. Zone Detailed Report:
2982. ----------------------------------------------------------
2983. !ZoneStatisticsDetail!
2984. ----------------------------------------------------------
2985. ")
2986. 
2987. 
2988. 	
2989.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
2990. 
2991. 	# Add Zone to list of zones for display.
2992. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
2993. 	# ??? Free Stats?
2994. 	# Footer:
2995. SetVariable(ZoneFooter, "----------------------------------------------------------
2996. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:50
2997. 
2998. Statistics Report:
2999. ------------------
3000.    Size:  
3001.    ------------------------
3002.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3003.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3004.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3005. 
3006.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3007.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3008. 
3009.    Location:
3010.    ------------------------
3011.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3012.              Files End: !ZoneEndCurrent!
3013.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3014.       
3015.    Gap Settings:
3016.    ------------------------
3017.          Gap Requested: !ZoneGapSizePer!%
3018.       Volume Rounding: !ZoneVolRoundUpPer!%
3019.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3020.                  
3021.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
3022.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
3023.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
3024.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
3025.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
3026.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
3027.      
3028.    Free Space after Zone:
3029.    ------------------------
3030.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3031.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3032.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3033. 
3034. Directory and Files Select:
3035. ---------------------------
3036. !ZoneTypeSelectCurrent!               
3037. ---------------------------
3038. ----------------------------------------------------------
3039. ")
3040. 
3041. 	# Add Zone Details to Report.	
3042. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
3043. !ZoneFooter!")
3044. 
3045. 
3046. 	
3047. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionStart!")
3048. 			# FILE STEP
3049. 
3050. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3051. 
3052. /* add message and move to a new line. */
3053. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3054. ")
3055. 
3056. /* display the line. (hopefully.) */
3057. # Zone Footer Set Statistics Window Text
3058. 
3059. SetStatisticsWindowText("----------------------------------------------------------
3060. Zones Processed: 
3061. ----------------------------------------------------------
3062. !ZoneListByLine!
3063. ----------------------------------------------------------
3064. Zone Processing Step:
3065. !ZoneStepByLine!    
3066. ----------------------------------------------------------
3067. Current Zone:
3068. !ZoneFooter!
3069. ----------------------------------------------------------
3070. Volume Statistics:
3071. !VolumeStatisticsDetail!
3072. ----------------------------------------------------------
3073. Zone Detailed Report:
3074. ----------------------------------------------------------
3075. !ZoneStatisticsDetail!
3076. ----------------------------------------------------------
3077. ")
3078. 
3079. 
3080. 
3081. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3082. 
3083. # BANNER SET
3084. 
3085. # DATE TIME RUN ELP
3086. 
3087. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:50 0:00:02")
3088. /* Xinclude "..\Display\BannerSet.MyDc"X */
3089. /* pause(1) */
3090. 
3091. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3092. 
3093. Title('!Heading!')
3094. /* pause(1) */
3095. 
3096. /* NOTE: Can't round or truncate to integer precision. */
3097. 
3098. pause(1)
3099. 	
3100. 			/* "..\ActionVerbs\ZoneDoActionThis.MyDc" */
3101. 			# File Action - SortByImportSequence.
3102. SortByImportSequence(Ascending ) 
3103. 	
3104. 
3105. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionEnd!")
3106. 			# FILE STEP
3107. 
3108. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3109. 
3110. /* add message and move to a new line. */
3111. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3112. ")
3113. 
3114. /* display the line. (hopefully.) */
3115. # Zone Footer Set Statistics Window Text
3116. 
3117. SetStatisticsWindowText("----------------------------------------------------------
3118. Zones Processed: 
3119. ----------------------------------------------------------
3120. !ZoneListByLine!
3121. ----------------------------------------------------------
3122. Zone Processing Step:
3123. !ZoneStepByLine!    
3124. ----------------------------------------------------------
3125. Current Zone:
3126. !ZoneFooter!
3127. ----------------------------------------------------------
3128. Volume Statistics:
3129. !VolumeStatisticsDetail!
3130. ----------------------------------------------------------
3131. Zone Detailed Report:
3132. ----------------------------------------------------------
3133. !ZoneStatisticsDetail!
3134. ----------------------------------------------------------
3135. ")
3136. 
3137. 
3138. 
3139. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3140. 
3141. # BANNER SET
3142. 
3143. # DATE TIME RUN ELP
3144. 
3145. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:50 0:00:02")
3146. /* Xinclude "..\Display\BannerSet.MyDc"X */
3147. /* pause(1) */
3148. 
3149. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3150. 
3151. Title('!Heading!')
3152. /* pause(1) */
3153. 
3154. /* NOTE: Can't round or truncate to integer precision. */
3155. 
3156. pause(1)
3157. 
3158. 		# Zone Do Footer
3159. 
3160. /* ---------------------------------------------------------- */
3161. # File Select
3162. 	# Select Statments
3163. # File Actions 
3164. 	# Standard or OS File Actions.
3165. 	# Resume...
3166. 	
3167. 	# your stuff HERE (X)... post zone (file) file actions code.
3168. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
3169. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3170. 		# (X)
3171. 		
3172. 		/* ??? Set window? */
3173. 	
3174. 	# ADD THE GAP
3175. 		
3176. # Vacate (good for diagnostics)
3177. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
3178. 
3179. # DoNotVacate - DO NOT Vacate (recommended)
3180. 
3181. # Vacate
3182. /* AddGap(GapUsedLoc) */
3183. 
3184. # DO Not Vacate
3185. AddGap(GapUsedLoc, DoNotVacate) 
3186. 	
3187. 	
3188. /* ---------------------------------------------------------- */
3189. # (failed) TEST for boolean logic.
3190. 
3191. /* It should work in the gap calculations for turning options */
3192. /* on and off but it will NOT work here. */
3193. 
3194. /* Boolean setting X or FlagX. */
3195. /* Where X will be on or off: */
3196. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
3197. /*      For ON:  (X  *  FlagAny) */
3198. 
3199. /* 1) Failed, zero gap overrode the previous one. */
3200. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
3201. /* AddGap(GapUsedTemp) */ 
3202. 
3203. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
3204. /* AddGap(GapUsedTemp, DoNotVacate) */ 
3205. 
3206. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
3207. 
3208. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
3209. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
3210. /* AddGap(GapUsedTemp) */ 
3211. 
3212. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
3213. /* AddGap(GapUsedTemp, DoNotVacate) */ 
3214. 
3215. /* ---------------------------------------------------------- */
3216. 
3217. # Vacate
3218. /* AddGap(GapUsed) */
3219. 
3220. # DO NOT Vacate (recommended)
3221. /* AddGap(GapUsed, DoNotVacate) */ 
3222. 	
3223. 
3224. 		
3225. # 
3226. FileEnd
3227. /* ---------------------------------------------------------- */
3228. 
3229. # your stuff HERE (X)... post zone (file) code.
3230. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
3231. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3232. 	# (X)
3233. 
3234. SetVariable(FileStepDescription,"Zone finished, reporting.")
3235. # FILE STEP
3236. 
3237. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3238. 
3239. /* add message and move to a new line. */
3240. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3241. ")
3242. 
3243. /* display the line. (hopefully.) */
3244. # Zone Footer Set Statistics Window Text
3245. 
3246. SetStatisticsWindowText("----------------------------------------------------------
3247. Zones Processed: 
3248. ----------------------------------------------------------
3249. !ZoneListByLine!
3250. ----------------------------------------------------------
3251. Zone Processing Step:
3252. !ZoneStepByLine!    
3253. ----------------------------------------------------------
3254. Current Zone:
3255. !ZoneFooter!
3256. ----------------------------------------------------------
3257. Volume Statistics:
3258. !VolumeStatisticsDetail!
3259. ----------------------------------------------------------
3260. Zone Detailed Report:
3261. ----------------------------------------------------------
3262. !ZoneStatisticsDetail!
3263. ----------------------------------------------------------
3264. ")
3265. 
3266. 
3267. 
3268. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3269. 
3270. # BANNER SET
3271. 
3272. # DATE TIME RUN ELP
3273. 
3274. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:50 0:00:02")
3275. /* Xinclude "..\Display\BannerSet.MyDc"X */
3276. /* pause(1) */
3277. 
3278. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3279. 
3280. Title('!Heading!')
3281. /* pause(1) */
3282. 
3283. /* NOTE: Can't round or truncate to integer precision. */
3284. 
3285. pause(1)
3286. 
3287. # Zone When Finished
3288. 
3289. # BANNER SET
3290. 
3291. # DATE TIME RUN ELP
3292. 
3293. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:50 0:00:02")
3294. /* Xinclude "..\Display\BannerSet.MyDc"X */
3295. /* pause(1) */
3296. 
3297. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3298. 
3299. Title('!Heading!')
3300. /* pause(1) */
3301. 
3302. /* NOTE: Can't round or truncate to integer precision. */
3303. 
3304. AppendLogfile("!LogFileName!", "!Title!")
3305. 
3306. 
3307. 
3308. # Zone Statistics	
3309. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
3310. 
3311. # Footer:
3312. SetVariable(ZoneFooter, "----------------------------------------------------------
3313. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:50
3314. 
3315. Statistics Report:
3316. ------------------
3317.    Size:  
3318.    ------------------------
3319.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3320.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3321.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3322. 
3323.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3324.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3325. 
3326.    Location:
3327.    ------------------------
3328.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3329.              Files End: !ZoneEndCurrent!
3330.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3331.       
3332.    Gap Settings:
3333.    ------------------------
3334.          Gap Requested: !ZoneGapSizePer!%
3335.       Volume Rounding: !ZoneVolRoundUpPer!%
3336.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3337.                  
3338.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
3339.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
3340.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
3341.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
3342.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
3343.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
3344.      
3345.    Free Space after Zone:
3346.    ------------------------
3347.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3348.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3349.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3350. 
3351. Directory and Files Select:
3352. ---------------------------
3353. !ZoneTypeSelectCurrent!               
3354. ---------------------------
3355. ----------------------------------------------------------
3356. ")
3357. 
3358. AppendLogfile("!LogFileName!", ".")
3359. AppendLogfile("!LogFileName!", "!ZoneFooter!")
3360. AppendLogfile("!LogFileName!", ".")
3361. 
3362. # Zone Footer Set Statistics Window Text
3363. 
3364. SetStatisticsWindowText("----------------------------------------------------------
3365. Zones Processed: 
3366. ----------------------------------------------------------
3367. !ZoneListByLine!
3368. ----------------------------------------------------------
3369. Zone Processing Step:
3370. !ZoneStepByLine!    
3371. ----------------------------------------------------------
3372. Current Zone:
3373. !ZoneFooter!
3374. ----------------------------------------------------------
3375. Volume Statistics:
3376. !VolumeStatisticsDetail!
3377. ----------------------------------------------------------
3378. Zone Detailed Report:
3379. ----------------------------------------------------------
3380. !ZoneStatisticsDetail!
3381. ----------------------------------------------------------
3382. ")
3383. 
3384. 
3385. 
3386. /* pause() */
3387. /* pause() */
3388. 
3389. 
3390. 
3391. 
3392. /* ---------------------------------------------------------- */
3393. # Zone Boot Data (Variable and other).
3394. 	SetVariable(ZoneLabel, 			"!ZoneLabelBootData!")
3395. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBootData!")
3396. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
3397. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
3398. 	SetVariable(ZoneTypeSelect,'
3399.                 # Boot - Data files.
3400.                 not(
3401.                      # Os PageHiberDump start.
3402. (
3403.   FileName("DataStore.edb")
3404.   or FileName("DUMP*.*")
3405.   or FileName("Hiberfil.sys")
3406.   or FileName("MEMORY.DMP")
3407.   or FileName("Pagefile.sys")
3408. )
3409. # Os PageHiberDump end.
3410. 
3411.                 )
3412. ')
3413. 
3414. 		# Zone Do Header
3415. 
3416. # Zone When Started
3417. 
3418. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
3419. # Display Set Zone
3420. 
3421. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
3422. SetVariable(FileStepDescription,	"")
3423. 
3424. SetVariable(ZoneStepByLine, 			"Zone started.
3425. ")
3426. 
3427. # BANNER SET
3428. 
3429. # DATE TIME RUN ELP
3430. 
3431. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:50 0:00:02")
3432. /* Xinclude "..\Display\BannerSet.MyDc"X */
3433. /* pause(1) */
3434. 
3435. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3436. 
3437. Title('!Heading!')
3438. /* pause(1) */
3439. 
3440. /* NOTE: Can't round or truncate to integer precision. */
3441. 
3442. AppendLogfile("!LogFileName!", "!Title!")
3443. 
3444. 
3445. 
3446. pause(1)
3447. 
3448. 
3449. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
3450. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
3451. 
3452. SetVariable(ZoneStepNoCurrent, 0)
3453. 
3454. 
3455. # Zone Do Current Clear
3456. 
3457. SetVariable(ZoneTypeSelectCurrent, 		"")
3458. 
3459. SetVariable(ZoneBeginCurrent, 			0)
3460. SetVariable(ZoneBeginPerCurrent, 		0)
3461. SetVariable(ZoneEndCurrent, 			0)
3462. SetVariable(ZoneEndPerCurrent, 			0)
3463. 
3464. SetVariable(ZoneSizeCurrent,			0)
3465. SetVariable(ZoneSizePerCurrent,			0)
3466. 
3467. SetVariable(ZoneGapRequestedCurrent,	0)
3468. SetVariable(ZoneGapRoundedCurrent, 		0)
3469. SetVariable(ZoneGapAdjustedCurrent, 	0)
3470. SetVariable(ZoneGapAvailableCurrent, 	0)
3471. SetVariable(ZoneGapCurrent,				0)
3472. SetVariable(ZoneGapUsedCurrent, 		0)
3473. 
3474. SetVariable(ZoneGapActualCurrent, 		0)
3475. SetVariable(ZoneGapActualPerCurrent, 	0)
3476. 
3477. SetVariable(ZoneSizeActual, 			0)
3478. SetVariable(ZoneSizeActualCurrent,		0)
3479. 
3480. SetVariable(ZoneEndActual, 				0)
3481. SetVariable(ZoneEndActualCurrent,		0)			
3482. SetVariable(ZoneSizeActualPerCurrent, 	0)
3483.       
3484. SetVariable(ZoneFilesFolders,			0)
3485. SetVariable(ZoneFilesFoldersPer,		0) 
3486. 
3487. SetVariable(ZoneFragments,				0)
3488. SetVariable(ZoneFragmentsPer,			0) 
3489. 		
3490. SetVariable(ZoneEndActualCurrent, 		0)
3491. SetVariable(ZoneEndActualPerCurrent, 	0)
3492. 
3493. # Gap Calculation Methodology:
3494. 	# Requested
3495. 	SetVariable(GapRequested, 			0) 
3496. 	SetVariable(GapRequestedStd, 		0) 
3497. 	SetVariable(GapRequestedMft, 		0) 
3498. 	SetVariable(GapRequestedOs, 		0) 
3499. 	SetVariable(GapRequestedOriginal, 	0) 
3500. 	
3501. 	# Gap Adjustments
3502. 	SetVariable(GapRounded, 			0)
3503. 	# SetVariable(GapAdjusted, 			0)
3504. 	SetVariable(GapAvailable, 			0)
3505. 	SetVariable(GapCurrent, 			0)
3506. 	SetVariable(GapActual, 				0)
3507. 	SetVariable(GapUsed, 				0)
3508. 	
3509. 	# Gap Adjustments
3510. 	SetVariable(GapRoundedLoc, 			0)
3511. 	# SetVariable(GapAdjustedLoc, 		0)
3512. 	SetVariable(GapAvailableLoc, 		0)
3513. 	SetVariable(GapCurrentLoc, 			0)
3514. 	SetVariable(GapActualLoc,			0)
3515. 	SetVariable(GapUsedLoc,				0)
3516. 	
3517. 	# Space usage
3518. 	SetVariable(ZoneFreePerRequested, 	0)
3519. 	SetVariable(ZoneFreePerUsed, 		0)
3520. 
3521. # Gap Size & Rounding
3522. 	SetVariable(ZoneGapSizePer, 		0)
3523. 	SetVariable(ZoneVolRoundUpPer, 		0)
3524. 	
3525. 	# Free Space
3526. 	SetVariable(ZoneFreeUsedPer, 		0)
3527. 	SetVariable(ZoneFreeRequestedPer, 	0)
3528. 
3529. 
3530. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
3531. 
3532. # Footer:
3533. SetVariable(ZoneFooter, "----------------------------------------------------------
3534. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
3535. 
3536. Statistics Report:
3537. ------------------
3538.    Size:  
3539.    ------------------------
3540.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3541.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3542.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3543. 
3544.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3545.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3546. 
3547.    Location:
3548.    ------------------------
3549.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3550.              Files End: !ZoneEndCurrent!
3551.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3552.       
3553.    Gap Settings:
3554.    ------------------------
3555.          Gap Requested: !ZoneGapSizePer!%
3556.       Volume Rounding: !ZoneVolRoundUpPer!%
3557.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3558.                  
3559.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
3560.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
3561.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
3562.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
3563.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
3564.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
3565.      
3566.    Free Space after Zone:
3567.    ------------------------
3568.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3569.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3570.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3571. 
3572. Directory and Files Select:
3573. ---------------------------
3574. !ZoneTypeSelectCurrent!               
3575. ---------------------------
3576. ----------------------------------------------------------
3577. ")
3578. 
3579. # BANNER SET
3580. 
3581. # DATE TIME RUN ELP
3582. 
3583. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
3584. /* Xinclude "..\Display\BannerSet.MyDc"X */
3585. /* pause(1) */
3586. 
3587. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3588. 
3589. Title('!Heading!')
3590. /* pause(1) */
3591. 
3592. /* NOTE: Can't round or truncate to integer precision. */
3593. 
3594. AppendLogfile("!LogFileName!", "!Title!")
3595. 
3596. 
3597. 
3598. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
3599. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
3600. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:50")
3601. 
3602. SetVariable(ZoneListByLine, "!ZoneListByLine!
3603. Zone: !ZoneNoCurrent! 2021-11-09 10:47:50 0:00:02 !ZoneLabel! !ZoneDescription!")
3604. 
3605. 
3606. /* Fixed Zone Position Handling */
3607. /* Literal number: */
3608. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
3609. /* Percentage of disk: */
3610. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
3611. /* Gap */
3612. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
3613. 
3614. /* ---------------------------------------------------------- */
3615. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
3616. # FILE STEP
3617. 
3618. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3619. 
3620. /* add message and move to a new line. */
3621. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3622. ")
3623. 
3624. /* display the line. (hopefully.) */
3625. # Zone Footer Set Statistics Window Text
3626. 
3627. SetStatisticsWindowText("----------------------------------------------------------
3628. Zones Processed: 
3629. ----------------------------------------------------------
3630. !ZoneListByLine!
3631. ----------------------------------------------------------
3632. Zone Processing Step:
3633. !ZoneStepByLine!    
3634. ----------------------------------------------------------
3635. Current Zone:
3636. !ZoneFooter!
3637. ----------------------------------------------------------
3638. Volume Statistics:
3639. !VolumeStatisticsDetail!
3640. ----------------------------------------------------------
3641. Zone Detailed Report:
3642. ----------------------------------------------------------
3643. !ZoneStatisticsDetail!
3644. ----------------------------------------------------------
3645. ")
3646. 
3647. 
3648. 
3649. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3650. 
3651. # BANNER SET
3652. 
3653. # DATE TIME RUN ELP
3654. 
3655. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
3656. /* Xinclude "..\Display\BannerSet.MyDc"X */
3657. /* pause(1) */
3658. 
3659. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3660. 
3661. Title('!Heading!')
3662. /* pause(1) */
3663. 
3664. /* NOTE: Can't round or truncate to integer precision. */
3665. 
3666. pause(1)
3667. 
3668. # your stuff HERE (X)... pre file select code.
3669. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
3670. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3671. 	# (X)
3672. 
3673. FileSelect
3674. 
3675. 	# your stuff can't really go here (errors.)
3676. 	# maybe for some reason I don't know of...
3677. 	
3678. 	# Actions next...
3679. 		# Boot start.
3680. ImportListFromBootOptimize()
3681. # Boot end.
3682. 
3683. 		and not(
3684. 			# Os PageHiberDump start.
3685. (
3686.   FileName("DataStore.edb")
3687.   or FileName("DUMP*.*")
3688.   or FileName("Hiberfil.sys")
3689.   or FileName("MEMORY.DMP")
3690.   or FileName("Pagefile.sys")
3691. )
3692. # Os PageHiberDump end.
3693. 
3694. 		)
3695. 		FileActions
3696. 		  		/* ---------------------------------------------------------- */
3697. 	# Gap
3698. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
3699. 		# FILE STEP
3700. 
3701. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3702. 
3703. /* add message and move to a new line. */
3704. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3705. ")
3706. 
3707. /* display the line. (hopefully.) */
3708. # Zone Footer Set Statistics Window Text
3709. 
3710. SetStatisticsWindowText("----------------------------------------------------------
3711. Zones Processed: 
3712. ----------------------------------------------------------
3713. !ZoneListByLine!
3714. ----------------------------------------------------------
3715. Zone Processing Step:
3716. !ZoneStepByLine!    
3717. ----------------------------------------------------------
3718. Current Zone:
3719. !ZoneFooter!
3720. ----------------------------------------------------------
3721. Volume Statistics:
3722. !VolumeStatisticsDetail!
3723. ----------------------------------------------------------
3724. Zone Detailed Report:
3725. ----------------------------------------------------------
3726. !ZoneStatisticsDetail!
3727. ----------------------------------------------------------
3728. ")
3729. 
3730. 
3731. 
3732. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3733. 
3734. # BANNER SET
3735. 
3736. # DATE TIME RUN ELP
3737. 
3738. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
3739. /* Xinclude "..\Display\BannerSet.MyDc"X */
3740. /* pause(1) */
3741. 
3742. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3743. 
3744. Title('!Heading!')
3745. /* pause(1) */
3746. 
3747. /* NOTE: Can't round or truncate to integer precision. */
3748. 
3749. pause(1)
3750. 	
3751. 	# ACTUAL GAP
3752. 		/* AddGap Variant. */
3753. 	  	# Zone Do Gap
3754. # Gap Calculation Methods:
3755. 
3756. /* 1) Anything you need to add first. */
3757. /* empty */
3758. 
3759. /* ---------------------------------------------------------- */
3760. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
3761. 	# GapRequestedStd.
3762. 
3763. 		/* ---------------------------------------------------------- */
3764. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
3765. 
3766. 		# Gap Calculation Methods:
3767. 
3768. /* AddGap Variants */
3769. 
3770. 	/* Standard */
3771. 		# Gap Calculation Methods:
3772. 	/* AddGap Variants */
3773. 	/* Standard */
3774. 
3775. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
3776. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
3777. 
3778. 	SetVariable(GapRequested, GapRequestedStd)
3779. 	
3780. 
3781. 	/* MFT Low High Method */
3782. 		# Gap Calculation Methods:
3783. 	/* AddGap Variants */
3784. 	/* MFT Low High Method */
3785. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
3786. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
3787. 	SetVariable(GapRequested, GapRequestedMft)
3788. 	
3789. 
3790. 	/* OS Volume Type Method */
3791. 		# Gap Calculation Methods:
3792. 	/* AddGap Variants */
3793. 	/* OS Volume Type Method */
3794. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
3795. 	SetVariable(GapRequested, GapRequestedOs)
3796. 
3797. 
3798. 
3799. /* MakeGap Variants */
3800. 
3801. 	/* Original Os 1-3 + MFT 2 */
3802. 		# Gap Calculation Methods:
3803. 	/* MakeGap Variants */
3804. 	/* Original Os 1-3 + MFT 2 */
3805. 	/* plus MFT gap placed inline at the dividing zone. */
3806. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
3807. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
3808. 	SetVariable(GapRequested, GapRequestedOrig)
3809. 	
3810. 	
3811. /* Note: You could comment out the ones not in use */
3812. /* However having the data in the log is useful. */
3813. /* Therefore the following line is otherwise needed. */
3814. 
3815. /* Standard used */
3816. 
3817. SetVariable(GapRequested, GapRequestedStd)
3818. 
3819. # Gap Calculation Methods:
3820. 
3821. /* AddGap Variants */
3822. 	/* Standard */
3823. 	/* MFT Low High Method */
3824. 	/* OS Volume Type Method */
3825. 
3826. /* MakeGap Variants */
3827. 	/* Original Os 1-3 + MFT 2 */
3828. 
3829. /* Note: You could comment out the ones not in use */
3830. /* However having the data in the log is useful. */
3831. /* Therefore the following line is otherwise needed. */
3832. 
3833. /* Standard is used currently */
3834. 
3835. 
3836. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
3837. 
3838. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
3839. 
3840. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
3841. 
3842. /* ---------------------------------------------------------- */
3843. /* 3) SMALL ZONE ADJUSTMENT. */
3844. /* Gab cant be larger than half the Zone Size. */
3845. 
3846. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
3847. 	
3848. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
3849. 
3850. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
3851. 
3852. /* ---------------------------------------------------------- */
3853. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
3854. # Gap Adjustments.
3855. 
3856. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
3857. 	
3858. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
3859. 
3860. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
3861. 
3862. /* ---------------------------------------------------------- */
3863. # BYPASS THIS.
3864. 	/* This is definitely wrong. */
3865. 	/* The question is can we steal gap from the next zone */
3866. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
3867. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
3868. 		# Zone Overflow.
3869. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
3870. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
3871. 
3872. /* ---------------------------------------------------------- */
3873. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
3874. # Remaining free space available.
3875. 
3876. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
3877. 	
3878. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
3879. 
3880. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
3881. 
3882. /* ---------------------------------------------------------- */
3883. # CURRENT gap to use.
3884. 
3885. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
3886. 
3887. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
3888. 
3889. /* ---------------------------------------------------------- */
3890. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
3891. # Debugging.
3892. 
3893. 	SetVariable(GapUsed, GapCurrent) // for debugging
3894. 
3895. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
3896. 
3897. 		# Your code HERE
3898. 
3899. /* ---------------------------------------------------------- */
3900. /* 7) YOUR CODE. */
3901. # YOUR CODE HERE:
3902. 	# INPUT: GapCurrent or GapCurrentLoc
3903. 	# OUTPUT: GapUsed...
3904. 
3905. /* ---------------------------------------------------------- */
3906. # Gap Size.
3907. # Actual Size of Gap.
3908. 
3909. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
3910. 
3911. /* ---------------------------------------------------------- */
3912. /* xxxxxxxxxxxxxxxxxxxxxx */
3913. # ADD THE GAP
3914. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
3915. /* xxxxxxxxxxxxxxxxxxxxxx */
3916. 
3917. 	
3918. 	# Zone Statistics	
3919. 	# Zone / Volume Statistics and Display
3920. 		
3921. 	# Accumulate Totals
3922.   	# Volume totals
3923. 
3924. /* Current total space used (by Zones and Gaps) */
3925. 
3926. SetVariable(VolumeZoneUsed, GapUsed)
3927. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
3928. /* Percentage */
3929. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
3930. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
3931. 
3932. /* Current total of free space requested */
3933. 
3934. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
3935. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3936. /* Percent. */
3937. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
3938. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3939. 
3940. /* Current total of free space used */
3941. 
3942. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
3943. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
3944. /* Percent */
3945. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
3946. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
3947. 
3948. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
3949. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
3950. /* Xinclude "..\DebugDisplayPause.MyDc"X */
3951. 
3952. 
3953. 	# Current Values
3954. 	# Cluster, Sector, Block adjust for display.
3955. 	# Bytes per cluster is volume specific.
3956. 
3957. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
3958. 
3959. # Current Zone values.
3960. 	# Begin, end and size.
3961. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
3962. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
3963. 
3964. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
3965. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
3966. 
3967. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
3968. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
3969. 
3970. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
3971. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
3972. 
3973. 	SetVariable(ZoneFragments,				"!ZONE210N!")
3974. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
3975. 		
3976. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
3977. /* identical code to here: (separation not needed. TEST.) */	
3978. 
3979. # Current Gap, Actual and Free Values
3980. 	# Gap
3981. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
3982. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
3983. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
3984. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
3985. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
3986. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
3987. 	
3988. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
3989. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
3990. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
3991. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
3992. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
3993. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
3994. 	
3995. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
3996. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
3997. 	
3998. 	# Actual Size and End
3999. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
4000. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
4001. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
4002. 	
4003. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
4004. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
4005. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
4006. 
4007. # Gap Size & Rounding
4008. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
4009. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
4010. 	
4011. 	# Free Space
4012. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
4013. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
4014. 
4015. 	# Footer:
4016. SetVariable(ZoneFooter, "----------------------------------------------------------
4017. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
4018. 
4019. Statistics Report:
4020. ------------------
4021.    Size:  
4022.    ------------------------
4023.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4024.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4025.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4026. 
4027.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4028.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4029. 
4030.    Location:
4031.    ------------------------
4032.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4033.              Files End: !ZoneEndCurrent!
4034.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4035.       
4036.    Gap Settings:
4037.    ------------------------
4038.          Gap Requested: !ZoneGapSizePer!%
4039.       Volume Rounding: !ZoneVolRoundUpPer!%
4040.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4041.                  
4042.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4043.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4044.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4045.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4046.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4047.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4048.      
4049.    Free Space after Zone:
4050.    ------------------------
4051.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4052.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4053.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4054. 
4055. Directory and Files Select:
4056. ---------------------------
4057. !ZoneTypeSelectCurrent!               
4058. ---------------------------
4059. ----------------------------------------------------------
4060. ")
4061. 	# Zone Footer Set Statistics Window Text
4062. 
4063. SetStatisticsWindowText("----------------------------------------------------------
4064. Zones Processed: 
4065. ----------------------------------------------------------
4066. !ZoneListByLine!
4067. ----------------------------------------------------------
4068. Zone Processing Step:
4069. !ZoneStepByLine!    
4070. ----------------------------------------------------------
4071. Current Zone:
4072. !ZoneFooter!
4073. ----------------------------------------------------------
4074. Volume Statistics:
4075. !VolumeStatisticsDetail!
4076. ----------------------------------------------------------
4077. Zone Detailed Report:
4078. ----------------------------------------------------------
4079. !ZoneStatisticsDetail!
4080. ----------------------------------------------------------
4081. ")
4082. 
4083. 
4084. 	
4085.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
4086. 
4087. 	# Add Zone to list of zones for display.
4088. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
4089. 	# ??? Free Stats?
4090. 	# Footer:
4091. SetVariable(ZoneFooter, "----------------------------------------------------------
4092. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
4093. 
4094. Statistics Report:
4095. ------------------
4096.    Size:  
4097.    ------------------------
4098.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4099.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4100.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4101. 
4102.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4103.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4104. 
4105.    Location:
4106.    ------------------------
4107.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4108.              Files End: !ZoneEndCurrent!
4109.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4110.       
4111.    Gap Settings:
4112.    ------------------------
4113.          Gap Requested: !ZoneGapSizePer!%
4114.       Volume Rounding: !ZoneVolRoundUpPer!%
4115.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4116.                  
4117.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4118.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4119.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4120.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4121.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4122.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4123.      
4124.    Free Space after Zone:
4125.    ------------------------
4126.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4127.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4128.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4129. 
4130. Directory and Files Select:
4131. ---------------------------
4132. !ZoneTypeSelectCurrent!               
4133. ---------------------------
4134. ----------------------------------------------------------
4135. ")
4136. 
4137. 	# Add Zone Details to Report.	
4138. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
4139. !ZoneFooter!")
4140. 
4141. 
4142. 	
4143. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
4144. 			# FILE STEP
4145. 
4146. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4147. 
4148. /* add message and move to a new line. */
4149. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4150. ")
4151. 
4152. /* display the line. (hopefully.) */
4153. # Zone Footer Set Statistics Window Text
4154. 
4155. SetStatisticsWindowText("----------------------------------------------------------
4156. Zones Processed: 
4157. ----------------------------------------------------------
4158. !ZoneListByLine!
4159. ----------------------------------------------------------
4160. Zone Processing Step:
4161. !ZoneStepByLine!    
4162. ----------------------------------------------------------
4163. Current Zone:
4164. !ZoneFooter!
4165. ----------------------------------------------------------
4166. Volume Statistics:
4167. !VolumeStatisticsDetail!
4168. ----------------------------------------------------------
4169. Zone Detailed Report:
4170. ----------------------------------------------------------
4171. !ZoneStatisticsDetail!
4172. ----------------------------------------------------------
4173. ")
4174. 
4175. 
4176. 
4177. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4178. 
4179. # BANNER SET
4180. 
4181. # DATE TIME RUN ELP
4182. 
4183. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
4184. /* Xinclude "..\Display\BannerSet.MyDc"X */
4185. /* pause(1) */
4186. 
4187. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4188. 
4189. Title('!Heading!')
4190. /* pause(1) */
4191. 
4192. /* NOTE: Can't round or truncate to integer precision. */
4193. 
4194. pause(1)
4195. 
4196. 			# File Action - SortByImportSequence.
4197. SortByImportSequence(Ascending ) 
4198. 	
4199. 	
4200. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
4201. 			# FILE STEP
4202. 
4203. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4204. 
4205. /* add message and move to a new line. */
4206. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4207. ")
4208. 
4209. /* display the line. (hopefully.) */
4210. # Zone Footer Set Statistics Window Text
4211. 
4212. SetStatisticsWindowText("----------------------------------------------------------
4213. Zones Processed: 
4214. ----------------------------------------------------------
4215. !ZoneListByLine!
4216. ----------------------------------------------------------
4217. Zone Processing Step:
4218. !ZoneStepByLine!    
4219. ----------------------------------------------------------
4220. Current Zone:
4221. !ZoneFooter!
4222. ----------------------------------------------------------
4223. Volume Statistics:
4224. !VolumeStatisticsDetail!
4225. ----------------------------------------------------------
4226. Zone Detailed Report:
4227. ----------------------------------------------------------
4228. !ZoneStatisticsDetail!
4229. ----------------------------------------------------------
4230. ")
4231. 
4232. 
4233. 
4234. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4235. 
4236. # BANNER SET
4237. 
4238. # DATE TIME RUN ELP
4239. 
4240. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
4241. /* Xinclude "..\Display\BannerSet.MyDc"X */
4242. /* pause(1) */
4243. 
4244. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4245. 
4246. Title('!Heading!')
4247. /* pause(1) */
4248. 
4249. /* NOTE: Can't round or truncate to integer precision. */
4250. 
4251. pause(1)
4252. 
4253. 		# Zone Do Footer
4254. 
4255. /* ---------------------------------------------------------- */
4256. # File Select
4257. 	# Select Statments
4258. # File Actions 
4259. 	# Standard or OS File Actions.
4260. 	# Resume...
4261. 	
4262. 	# your stuff HERE (X)... post zone (file) file actions code.
4263. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
4264. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4265. 		# (X)
4266. 		
4267. 		/* ??? Set window? */
4268. 	
4269. 	# ADD THE GAP
4270. 		
4271. # Vacate (good for diagnostics)
4272. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
4273. 
4274. # DoNotVacate - DO NOT Vacate (recommended)
4275. 
4276. # Vacate
4277. /* AddGap(GapUsedLoc) */
4278. 
4279. # DO Not Vacate
4280. AddGap(GapUsedLoc, DoNotVacate) 
4281. 	
4282. 	
4283. /* ---------------------------------------------------------- */
4284. # (failed) TEST for boolean logic.
4285. 
4286. /* It should work in the gap calculations for turning options */
4287. /* on and off but it will NOT work here. */
4288. 
4289. /* Boolean setting X or FlagX. */
4290. /* Where X will be on or off: */
4291. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
4292. /*      For ON:  (X  *  FlagAny) */
4293. 
4294. /* 1) Failed, zero gap overrode the previous one. */
4295. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
4296. /* AddGap(GapUsedTemp) */ 
4297. 
4298. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
4299. /* AddGap(GapUsedTemp, DoNotVacate) */ 
4300. 
4301. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
4302. 
4303. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
4304. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
4305. /* AddGap(GapUsedTemp) */ 
4306. 
4307. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
4308. /* AddGap(GapUsedTemp, DoNotVacate) */ 
4309. 
4310. /* ---------------------------------------------------------- */
4311. 
4312. # Vacate
4313. /* AddGap(GapUsed) */
4314. 
4315. # DO NOT Vacate (recommended)
4316. /* AddGap(GapUsed, DoNotVacate) */ 
4317. 	
4318. 
4319. 		
4320. # 
4321. FileEnd
4322. /* ---------------------------------------------------------- */
4323. 
4324. # your stuff HERE (X)... post zone (file) code.
4325. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
4326. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4327. 	# (X)
4328. 
4329. SetVariable(FileStepDescription,"Zone finished, reporting.")
4330. # FILE STEP
4331. 
4332. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4333. 
4334. /* add message and move to a new line. */
4335. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4336. ")
4337. 
4338. /* display the line. (hopefully.) */
4339. # Zone Footer Set Statistics Window Text
4340. 
4341. SetStatisticsWindowText("----------------------------------------------------------
4342. Zones Processed: 
4343. ----------------------------------------------------------
4344. !ZoneListByLine!
4345. ----------------------------------------------------------
4346. Zone Processing Step:
4347. !ZoneStepByLine!    
4348. ----------------------------------------------------------
4349. Current Zone:
4350. !ZoneFooter!
4351. ----------------------------------------------------------
4352. Volume Statistics:
4353. !VolumeStatisticsDetail!
4354. ----------------------------------------------------------
4355. Zone Detailed Report:
4356. ----------------------------------------------------------
4357. !ZoneStatisticsDetail!
4358. ----------------------------------------------------------
4359. ")
4360. 
4361. 
4362. 
4363. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4364. 
4365. # BANNER SET
4366. 
4367. # DATE TIME RUN ELP
4368. 
4369. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
4370. /* Xinclude "..\Display\BannerSet.MyDc"X */
4371. /* pause(1) */
4372. 
4373. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4374. 
4375. Title('!Heading!')
4376. /* pause(1) */
4377. 
4378. /* NOTE: Can't round or truncate to integer precision. */
4379. 
4380. pause(1)
4381. 
4382. # Zone When Finished
4383. 
4384. # BANNER SET
4385. 
4386. # DATE TIME RUN ELP
4387. 
4388. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
4389. /* Xinclude "..\Display\BannerSet.MyDc"X */
4390. /* pause(1) */
4391. 
4392. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4393. 
4394. Title('!Heading!')
4395. /* pause(1) */
4396. 
4397. /* NOTE: Can't round or truncate to integer precision. */
4398. 
4399. AppendLogfile("!LogFileName!", "!Title!")
4400. 
4401. 
4402. 
4403. # Zone Statistics	
4404. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
4405. 
4406. # Footer:
4407. SetVariable(ZoneFooter, "----------------------------------------------------------
4408. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
4409. 
4410. Statistics Report:
4411. ------------------
4412.    Size:  
4413.    ------------------------
4414.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4415.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4416.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4417. 
4418.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4419.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4420. 
4421.    Location:
4422.    ------------------------
4423.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4424.              Files End: !ZoneEndCurrent!
4425.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4426.       
4427.    Gap Settings:
4428.    ------------------------
4429.          Gap Requested: !ZoneGapSizePer!%
4430.       Volume Rounding: !ZoneVolRoundUpPer!%
4431.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4432.                  
4433.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4434.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4435.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4436.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4437.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4438.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4439.      
4440.    Free Space after Zone:
4441.    ------------------------
4442.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4443.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4444.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4445. 
4446. Directory and Files Select:
4447. ---------------------------
4448. !ZoneTypeSelectCurrent!               
4449. ---------------------------
4450. ----------------------------------------------------------
4451. ")
4452. 
4453. AppendLogfile("!LogFileName!", ".")
4454. AppendLogfile("!LogFileName!", "!ZoneFooter!")
4455. AppendLogfile("!LogFileName!", ".")
4456. 
4457. # Zone Footer Set Statistics Window Text
4458. 
4459. SetStatisticsWindowText("----------------------------------------------------------
4460. Zones Processed: 
4461. ----------------------------------------------------------
4462. !ZoneListByLine!
4463. ----------------------------------------------------------
4464. Zone Processing Step:
4465. !ZoneStepByLine!    
4466. ----------------------------------------------------------
4467. Current Zone:
4468. !ZoneFooter!
4469. ----------------------------------------------------------
4470. Volume Statistics:
4471. !VolumeStatisticsDetail!
4472. ----------------------------------------------------------
4473. Zone Detailed Report:
4474. ----------------------------------------------------------
4475. !ZoneStatisticsDetail!
4476. ----------------------------------------------------------
4477. ")
4478. 
4479. 
4480. 
4481. /* pause() */
4482. /* pause() */
4483. 
4484. 
4485. 
4486. 
4487. /* ---------------------------------------------------------- */
4488. 
4489. 
4490. /* ---------------------------------------------------------- */
4491. # Zone ProgramHints Fixed.
4492. /* ---------------------------------------------------------- */
4493. # Zone ProgramHints Fixed.
4494. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHints!")
4495. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHints!")
4496. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
4497. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHint!")
4498. 	SetVariable(ZoneTypeSelect,'# ProgramHints start.
4499. ImportListFromProgramHints("*.pf")
4500. # ProgramHints end.
4501. ')
4502. 
4503. 		# Zone Do Header
4504. 
4505. # Zone When Started
4506. 
4507. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
4508. # Display Set Zone
4509. 
4510. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
4511. SetVariable(FileStepDescription,	"")
4512. 
4513. SetVariable(ZoneStepByLine, 			"Zone started.
4514. ")
4515. 
4516. # BANNER SET
4517. 
4518. # DATE TIME RUN ELP
4519. 
4520. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
4521. /* Xinclude "..\Display\BannerSet.MyDc"X */
4522. /* pause(1) */
4523. 
4524. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4525. 
4526. Title('!Heading!')
4527. /* pause(1) */
4528. 
4529. /* NOTE: Can't round or truncate to integer precision. */
4530. 
4531. AppendLogfile("!LogFileName!", "!Title!")
4532. 
4533. 
4534. 
4535. pause(1)
4536. 
4537. 
4538. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
4539. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
4540. 
4541. SetVariable(ZoneStepNoCurrent, 0)
4542. 
4543. 
4544. # Zone Do Current Clear
4545. 
4546. SetVariable(ZoneTypeSelectCurrent, 		"")
4547. 
4548. SetVariable(ZoneBeginCurrent, 			0)
4549. SetVariable(ZoneBeginPerCurrent, 		0)
4550. SetVariable(ZoneEndCurrent, 			0)
4551. SetVariable(ZoneEndPerCurrent, 			0)
4552. 
4553. SetVariable(ZoneSizeCurrent,			0)
4554. SetVariable(ZoneSizePerCurrent,			0)
4555. 
4556. SetVariable(ZoneGapRequestedCurrent,	0)
4557. SetVariable(ZoneGapRoundedCurrent, 		0)
4558. SetVariable(ZoneGapAdjustedCurrent, 	0)
4559. SetVariable(ZoneGapAvailableCurrent, 	0)
4560. SetVariable(ZoneGapCurrent,				0)
4561. SetVariable(ZoneGapUsedCurrent, 		0)
4562. 
4563. SetVariable(ZoneGapActualCurrent, 		0)
4564. SetVariable(ZoneGapActualPerCurrent, 	0)
4565. 
4566. SetVariable(ZoneSizeActual, 			0)
4567. SetVariable(ZoneSizeActualCurrent,		0)
4568. 
4569. SetVariable(ZoneEndActual, 				0)
4570. SetVariable(ZoneEndActualCurrent,		0)			
4571. SetVariable(ZoneSizeActualPerCurrent, 	0)
4572.       
4573. SetVariable(ZoneFilesFolders,			0)
4574. SetVariable(ZoneFilesFoldersPer,		0) 
4575. 
4576. SetVariable(ZoneFragments,				0)
4577. SetVariable(ZoneFragmentsPer,			0) 
4578. 		
4579. SetVariable(ZoneEndActualCurrent, 		0)
4580. SetVariable(ZoneEndActualPerCurrent, 	0)
4581. 
4582. # Gap Calculation Methodology:
4583. 	# Requested
4584. 	SetVariable(GapRequested, 			0) 
4585. 	SetVariable(GapRequestedStd, 		0) 
4586. 	SetVariable(GapRequestedMft, 		0) 
4587. 	SetVariable(GapRequestedOs, 		0) 
4588. 	SetVariable(GapRequestedOriginal, 	0) 
4589. 	
4590. 	# Gap Adjustments
4591. 	SetVariable(GapRounded, 			0)
4592. 	# SetVariable(GapAdjusted, 			0)
4593. 	SetVariable(GapAvailable, 			0)
4594. 	SetVariable(GapCurrent, 			0)
4595. 	SetVariable(GapActual, 				0)
4596. 	SetVariable(GapUsed, 				0)
4597. 	
4598. 	# Gap Adjustments
4599. 	SetVariable(GapRoundedLoc, 			0)
4600. 	# SetVariable(GapAdjustedLoc, 		0)
4601. 	SetVariable(GapAvailableLoc, 		0)
4602. 	SetVariable(GapCurrentLoc, 			0)
4603. 	SetVariable(GapActualLoc,			0)
4604. 	SetVariable(GapUsedLoc,				0)
4605. 	
4606. 	# Space usage
4607. 	SetVariable(ZoneFreePerRequested, 	0)
4608. 	SetVariable(ZoneFreePerUsed, 		0)
4609. 
4610. # Gap Size & Rounding
4611. 	SetVariable(ZoneGapSizePer, 		0)
4612. 	SetVariable(ZoneVolRoundUpPer, 		0)
4613. 	
4614. 	# Free Space
4615. 	SetVariable(ZoneFreeUsedPer, 		0)
4616. 	SetVariable(ZoneFreeRequestedPer, 	0)
4617. 
4618. 
4619. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
4620. 
4621. # Footer:
4622. SetVariable(ZoneFooter, "----------------------------------------------------------
4623. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
4624. 
4625. Statistics Report:
4626. ------------------
4627.    Size:  
4628.    ------------------------
4629.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4630.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4631.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4632. 
4633.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4634.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4635. 
4636.    Location:
4637.    ------------------------
4638.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4639.              Files End: !ZoneEndCurrent!
4640.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4641.       
4642.    Gap Settings:
4643.    ------------------------
4644.          Gap Requested: !ZoneGapSizePer!%
4645.       Volume Rounding: !ZoneVolRoundUpPer!%
4646.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4647.                  
4648.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4649.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4650.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4651.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4652.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4653.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4654.      
4655.    Free Space after Zone:
4656.    ------------------------
4657.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4658.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4659.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4660. 
4661. Directory and Files Select:
4662. ---------------------------
4663. !ZoneTypeSelectCurrent!               
4664. ---------------------------
4665. ----------------------------------------------------------
4666. ")
4667. 
4668. # BANNER SET
4669. 
4670. # DATE TIME RUN ELP
4671. 
4672. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
4673. /* Xinclude "..\Display\BannerSet.MyDc"X */
4674. /* pause(1) */
4675. 
4676. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4677. 
4678. Title('!Heading!')
4679. /* pause(1) */
4680. 
4681. /* NOTE: Can't round or truncate to integer precision. */
4682. 
4683. AppendLogfile("!LogFileName!", "!Title!")
4684. 
4685. 
4686. 
4687. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
4688. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
4689. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:51")
4690. 
4691. SetVariable(ZoneListByLine, "!ZoneListByLine!
4692. Zone: !ZoneNoCurrent! 2021-11-09 10:47:51 0:00:03 !ZoneLabel! !ZoneDescription!")
4693. 
4694. 
4695. /* Fixed Zone Position Handling */
4696. /* Literal number: */
4697. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
4698. /* Percentage of disk: */
4699. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
4700. /* Gap */
4701. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
4702. 
4703. /* ---------------------------------------------------------- */
4704. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
4705. # FILE STEP
4706. 
4707. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4708. 
4709. /* add message and move to a new line. */
4710. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4711. ")
4712. 
4713. /* display the line. (hopefully.) */
4714. # Zone Footer Set Statistics Window Text
4715. 
4716. SetStatisticsWindowText("----------------------------------------------------------
4717. Zones Processed: 
4718. ----------------------------------------------------------
4719. !ZoneListByLine!
4720. ----------------------------------------------------------
4721. Zone Processing Step:
4722. !ZoneStepByLine!    
4723. ----------------------------------------------------------
4724. Current Zone:
4725. !ZoneFooter!
4726. ----------------------------------------------------------
4727. Volume Statistics:
4728. !VolumeStatisticsDetail!
4729. ----------------------------------------------------------
4730. Zone Detailed Report:
4731. ----------------------------------------------------------
4732. !ZoneStatisticsDetail!
4733. ----------------------------------------------------------
4734. ")
4735. 
4736. 
4737. 
4738. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4739. 
4740. # BANNER SET
4741. 
4742. # DATE TIME RUN ELP
4743. 
4744. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
4745. /* Xinclude "..\Display\BannerSet.MyDc"X */
4746. /* pause(1) */
4747. 
4748. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4749. 
4750. Title('!Heading!')
4751. /* pause(1) */
4752. 
4753. /* NOTE: Can't round or truncate to integer precision. */
4754. 
4755. pause(1)
4756. 
4757. # your stuff HERE (X)... pre file select code.
4758. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
4759. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4760. 	# (X)
4761. 
4762. FileSelect
4763. 
4764. 	# your stuff can't really go here (errors.)
4765. 	# maybe for some reason I don't know of...
4766. 	
4767. 	# Actions next...
4768. 		# ProgramHints start.
4769. ImportListFromProgramHints("*.pf")
4770. # ProgramHints end.
4771. 
4772. 		and not(
4773. 			# Os Data Dynamic start.
4774. (
4775. # Os Data Dynamic start.
4776. (
4777.   FileName("*.dat*")
4778.   or FileName("*.db*")
4779.   or FileName("*.edb*")
4780.   or FileName("*.log*")
4781.   or FileName("DataStore.edb")
4782. )
4783. # Os Data Dynamic end.
4784. 
4785.   or 
4786. # Os PageHiberDump start.
4787. (
4788.   FileName("DataStore.edb")
4789.   or FileName("DUMP*.*")
4790.   or FileName("Hiberfil.sys")
4791.   or FileName("MEMORY.DMP")
4792.   or FileName("Pagefile.sys")
4793. )
4794. # Os PageHiberDump end.
4795. 
4796. # Os Data Dynamic
4797. )
4798. # Os Data Dynamic end.
4799. 
4800. 		)
4801. 		FileActions
4802. 		  		/* ---------------------------------------------------------- */
4803. 	# Gap
4804. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
4805. 		# FILE STEP
4806. 
4807. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4808. 
4809. /* add message and move to a new line. */
4810. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4811. ")
4812. 
4813. /* display the line. (hopefully.) */
4814. # Zone Footer Set Statistics Window Text
4815. 
4816. SetStatisticsWindowText("----------------------------------------------------------
4817. Zones Processed: 
4818. ----------------------------------------------------------
4819. !ZoneListByLine!
4820. ----------------------------------------------------------
4821. Zone Processing Step:
4822. !ZoneStepByLine!    
4823. ----------------------------------------------------------
4824. Current Zone:
4825. !ZoneFooter!
4826. ----------------------------------------------------------
4827. Volume Statistics:
4828. !VolumeStatisticsDetail!
4829. ----------------------------------------------------------
4830. Zone Detailed Report:
4831. ----------------------------------------------------------
4832. !ZoneStatisticsDetail!
4833. ----------------------------------------------------------
4834. ")
4835. 
4836. 
4837. 
4838. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4839. 
4840. # BANNER SET
4841. 
4842. # DATE TIME RUN ELP
4843. 
4844. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
4845. /* Xinclude "..\Display\BannerSet.MyDc"X */
4846. /* pause(1) */
4847. 
4848. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4849. 
4850. Title('!Heading!')
4851. /* pause(1) */
4852. 
4853. /* NOTE: Can't round or truncate to integer precision. */
4854. 
4855. pause(1)
4856. 	
4857. 	# ACTUAL GAP
4858. 		/* AddGap Variant. */
4859. 	  	# Zone Do Gap
4860. # Gap Calculation Methods:
4861. 
4862. /* 1) Anything you need to add first. */
4863. /* empty */
4864. 
4865. /* ---------------------------------------------------------- */
4866. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
4867. 	# GapRequestedStd.
4868. 
4869. 		/* ---------------------------------------------------------- */
4870. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
4871. 
4872. 		# Gap Calculation Methods:
4873. 
4874. /* AddGap Variants */
4875. 
4876. 	/* Standard */
4877. 		# Gap Calculation Methods:
4878. 	/* AddGap Variants */
4879. 	/* Standard */
4880. 
4881. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
4882. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
4883. 
4884. 	SetVariable(GapRequested, GapRequestedStd)
4885. 	
4886. 
4887. 	/* MFT Low High Method */
4888. 		# Gap Calculation Methods:
4889. 	/* AddGap Variants */
4890. 	/* MFT Low High Method */
4891. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
4892. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
4893. 	SetVariable(GapRequested, GapRequestedMft)
4894. 	
4895. 
4896. 	/* OS Volume Type Method */
4897. 		# Gap Calculation Methods:
4898. 	/* AddGap Variants */
4899. 	/* OS Volume Type Method */
4900. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
4901. 	SetVariable(GapRequested, GapRequestedOs)
4902. 
4903. 
4904. 
4905. /* MakeGap Variants */
4906. 
4907. 	/* Original Os 1-3 + MFT 2 */
4908. 		# Gap Calculation Methods:
4909. 	/* MakeGap Variants */
4910. 	/* Original Os 1-3 + MFT 2 */
4911. 	/* plus MFT gap placed inline at the dividing zone. */
4912. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
4913. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
4914. 	SetVariable(GapRequested, GapRequestedOrig)
4915. 	
4916. 	
4917. /* Note: You could comment out the ones not in use */
4918. /* However having the data in the log is useful. */
4919. /* Therefore the following line is otherwise needed. */
4920. 
4921. /* Standard used */
4922. 
4923. SetVariable(GapRequested, GapRequestedStd)
4924. 
4925. # Gap Calculation Methods:
4926. 
4927. /* AddGap Variants */
4928. 	/* Standard */
4929. 	/* MFT Low High Method */
4930. 	/* OS Volume Type Method */
4931. 
4932. /* MakeGap Variants */
4933. 	/* Original Os 1-3 + MFT 2 */
4934. 
4935. /* Note: You could comment out the ones not in use */
4936. /* However having the data in the log is useful. */
4937. /* Therefore the following line is otherwise needed. */
4938. 
4939. /* Standard is used currently */
4940. 
4941. 
4942. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
4943. 
4944. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
4945. 
4946. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
4947. 
4948. /* ---------------------------------------------------------- */
4949. /* 3) SMALL ZONE ADJUSTMENT. */
4950. /* Gab cant be larger than half the Zone Size. */
4951. 
4952. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
4953. 	
4954. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
4955. 
4956. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
4957. 
4958. /* ---------------------------------------------------------- */
4959. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
4960. # Gap Adjustments.
4961. 
4962. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
4963. 	
4964. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
4965. 
4966. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
4967. 
4968. /* ---------------------------------------------------------- */
4969. # BYPASS THIS.
4970. 	/* This is definitely wrong. */
4971. 	/* The question is can we steal gap from the next zone */
4972. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
4973. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
4974. 		# Zone Overflow.
4975. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
4976. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
4977. 
4978. /* ---------------------------------------------------------- */
4979. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
4980. # Remaining free space available.
4981. 
4982. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
4983. 	
4984. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
4985. 
4986. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
4987. 
4988. /* ---------------------------------------------------------- */
4989. # CURRENT gap to use.
4990. 
4991. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
4992. 
4993. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
4994. 
4995. /* ---------------------------------------------------------- */
4996. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
4997. # Debugging.
4998. 
4999. 	SetVariable(GapUsed, GapCurrent) // for debugging
5000. 
5001. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
5002. 
5003. 		# Your code HERE
5004. 
5005. /* ---------------------------------------------------------- */
5006. /* 7) YOUR CODE. */
5007. # YOUR CODE HERE:
5008. 	# INPUT: GapCurrent or GapCurrentLoc
5009. 	# OUTPUT: GapUsed...
5010. 
5011. /* ---------------------------------------------------------- */
5012. # Gap Size.
5013. # Actual Size of Gap.
5014. 
5015. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
5016. 
5017. /* ---------------------------------------------------------- */
5018. /* xxxxxxxxxxxxxxxxxxxxxx */
5019. # ADD THE GAP
5020. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
5021. /* xxxxxxxxxxxxxxxxxxxxxx */
5022. 
5023. 	
5024. 	# Zone Statistics	
5025. 	# Zone / Volume Statistics and Display
5026. 		
5027. 	# Accumulate Totals
5028.   	# Volume totals
5029. 
5030. /* Current total space used (by Zones and Gaps) */
5031. 
5032. SetVariable(VolumeZoneUsed, GapUsed)
5033. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
5034. /* Percentage */
5035. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
5036. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
5037. 
5038. /* Current total of free space requested */
5039. 
5040. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
5041. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5042. /* Percent. */
5043. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
5044. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5045. 
5046. /* Current total of free space used */
5047. 
5048. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
5049. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
5050. /* Percent */
5051. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
5052. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
5053. 
5054. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
5055. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
5056. /* Xinclude "..\DebugDisplayPause.MyDc"X */
5057. 
5058. 
5059. 	# Current Values
5060. 	# Cluster, Sector, Block adjust for display.
5061. 	# Bytes per cluster is volume specific.
5062. 
5063. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
5064. 
5065. # Current Zone values.
5066. 	# Begin, end and size.
5067. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
5068. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
5069. 
5070. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
5071. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
5072. 
5073. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
5074. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
5075. 
5076. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
5077. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
5078. 
5079. 	SetVariable(ZoneFragments,				"!ZONE210N!")
5080. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
5081. 		
5082. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
5083. /* identical code to here: (separation not needed. TEST.) */	
5084. 
5085. # Current Gap, Actual and Free Values
5086. 	# Gap
5087. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
5088. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
5089. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
5090. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
5091. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
5092. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
5093. 	
5094. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
5095. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
5096. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
5097. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
5098. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
5099. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
5100. 	
5101. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
5102. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
5103. 	
5104. 	# Actual Size and End
5105. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
5106. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
5107. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
5108. 	
5109. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
5110. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
5111. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
5112. 
5113. # Gap Size & Rounding
5114. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
5115. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
5116. 	
5117. 	# Free Space
5118. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
5119. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
5120. 
5121. 	# Footer:
5122. SetVariable(ZoneFooter, "----------------------------------------------------------
5123. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
5124. 
5125. Statistics Report:
5126. ------------------
5127.    Size:  
5128.    ------------------------
5129.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5130.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5131.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5132. 
5133.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5134.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5135. 
5136.    Location:
5137.    ------------------------
5138.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5139.              Files End: !ZoneEndCurrent!
5140.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5141.       
5142.    Gap Settings:
5143.    ------------------------
5144.          Gap Requested: !ZoneGapSizePer!%
5145.       Volume Rounding: !ZoneVolRoundUpPer!%
5146.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5147.                  
5148.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5149.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5150.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5151.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5152.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5153.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5154.      
5155.    Free Space after Zone:
5156.    ------------------------
5157.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5158.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5159.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5160. 
5161. Directory and Files Select:
5162. ---------------------------
5163. !ZoneTypeSelectCurrent!               
5164. ---------------------------
5165. ----------------------------------------------------------
5166. ")
5167. 	# Zone Footer Set Statistics Window Text
5168. 
5169. SetStatisticsWindowText("----------------------------------------------------------
5170. Zones Processed: 
5171. ----------------------------------------------------------
5172. !ZoneListByLine!
5173. ----------------------------------------------------------
5174. Zone Processing Step:
5175. !ZoneStepByLine!    
5176. ----------------------------------------------------------
5177. Current Zone:
5178. !ZoneFooter!
5179. ----------------------------------------------------------
5180. Volume Statistics:
5181. !VolumeStatisticsDetail!
5182. ----------------------------------------------------------
5183. Zone Detailed Report:
5184. ----------------------------------------------------------
5185. !ZoneStatisticsDetail!
5186. ----------------------------------------------------------
5187. ")
5188. 
5189. 
5190. 	
5191.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
5192. 
5193. 	# Add Zone to list of zones for display.
5194. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
5195. 	# ??? Free Stats?
5196. 	# Footer:
5197. SetVariable(ZoneFooter, "----------------------------------------------------------
5198. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
5199. 
5200. Statistics Report:
5201. ------------------
5202.    Size:  
5203.    ------------------------
5204.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5205.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5206.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5207. 
5208.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5209.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5210. 
5211.    Location:
5212.    ------------------------
5213.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5214.              Files End: !ZoneEndCurrent!
5215.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5216.       
5217.    Gap Settings:
5218.    ------------------------
5219.          Gap Requested: !ZoneGapSizePer!%
5220.       Volume Rounding: !ZoneVolRoundUpPer!%
5221.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5222.                  
5223.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5224.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5225.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5226.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5227.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5228.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5229.      
5230.    Free Space after Zone:
5231.    ------------------------
5232.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5233.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5234.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5235. 
5236. Directory and Files Select:
5237. ---------------------------
5238. !ZoneTypeSelectCurrent!               
5239. ---------------------------
5240. ----------------------------------------------------------
5241. ")
5242. 
5243. 	# Add Zone Details to Report.	
5244. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
5245. !ZoneFooter!")
5246. 
5247. 
5248. 		
5249. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
5250. 			# FILE STEP
5251. 
5252. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5253. 
5254. /* add message and move to a new line. */
5255. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5256. ")
5257. 
5258. /* display the line. (hopefully.) */
5259. # Zone Footer Set Statistics Window Text
5260. 
5261. SetStatisticsWindowText("----------------------------------------------------------
5262. Zones Processed: 
5263. ----------------------------------------------------------
5264. !ZoneListByLine!
5265. ----------------------------------------------------------
5266. Zone Processing Step:
5267. !ZoneStepByLine!    
5268. ----------------------------------------------------------
5269. Current Zone:
5270. !ZoneFooter!
5271. ----------------------------------------------------------
5272. Volume Statistics:
5273. !VolumeStatisticsDetail!
5274. ----------------------------------------------------------
5275. Zone Detailed Report:
5276. ----------------------------------------------------------
5277. !ZoneStatisticsDetail!
5278. ----------------------------------------------------------
5279. ")
5280. 
5281. 
5282. 
5283. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5284. 
5285. # BANNER SET
5286. 
5287. # DATE TIME RUN ELP
5288. 
5289. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
5290. /* Xinclude "..\Display\BannerSet.MyDc"X */
5291. /* pause(1) */
5292. 
5293. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5294. 
5295. Title('!Heading!')
5296. /* pause(1) */
5297. 
5298. /* NOTE: Can't round or truncate to integer precision. */
5299. 
5300. pause(1)
5301. 	
5302. 			!include "..\ActionVerbs\ZoneDoActionTypeOsProgramHints.MyDc"!
5303. 
5304. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
5305. 			# FILE STEP
5306. 
5307. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5308. 
5309. /* add message and move to a new line. */
5310. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5311. ")
5312. 
5313. /* display the line. (hopefully.) */
5314. # Zone Footer Set Statistics Window Text
5315. 
5316. SetStatisticsWindowText("----------------------------------------------------------
5317. Zones Processed: 
5318. ----------------------------------------------------------
5319. !ZoneListByLine!
5320. ----------------------------------------------------------
5321. Zone Processing Step:
5322. !ZoneStepByLine!    
5323. ----------------------------------------------------------
5324. Current Zone:
5325. !ZoneFooter!
5326. ----------------------------------------------------------
5327. Volume Statistics:
5328. !VolumeStatisticsDetail!
5329. ----------------------------------------------------------
5330. Zone Detailed Report:
5331. ----------------------------------------------------------
5332. !ZoneStatisticsDetail!
5333. ----------------------------------------------------------
5334. ")
5335. 
5336. 
5337. 
5338. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5339. 
5340. # BANNER SET
5341. 
5342. # DATE TIME RUN ELP
5343. 
5344. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
5345. /* Xinclude "..\Display\BannerSet.MyDc"X */
5346. /* pause(1) */
5347. 
5348. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5349. 
5350. Title('!Heading!')
5351. /* pause(1) */
5352. 
5353. /* NOTE: Can't round or truncate to integer precision. */
5354. 
5355. pause(1)
5356. 
5357. 		# Zone Do Footer
5358. 
5359. /* ---------------------------------------------------------- */
5360. # File Select
5361. 	# Select Statments
5362. # File Actions 
5363. 	# Standard or OS File Actions.
5364. 	# Resume...
5365. 	
5366. 	# your stuff HERE (X)... post zone (file) file actions code.
5367. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
5368. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5369. 		# (X)
5370. 		
5371. 		/* ??? Set window? */
5372. 	
5373. 	# ADD THE GAP
5374. 		
5375. # Vacate (good for diagnostics)
5376. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
5377. 
5378. # DoNotVacate - DO NOT Vacate (recommended)
5379. 
5380. # Vacate
5381. /* AddGap(GapUsedLoc) */
5382. 
5383. # DO Not Vacate
5384. AddGap(GapUsedLoc, DoNotVacate) 
5385. 	
5386. 	
5387. /* ---------------------------------------------------------- */
5388. # (failed) TEST for boolean logic.
5389. 
5390. /* It should work in the gap calculations for turning options */
5391. /* on and off but it will NOT work here. */
5392. 
5393. /* Boolean setting X or FlagX. */
5394. /* Where X will be on or off: */
5395. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
5396. /*      For ON:  (X  *  FlagAny) */
5397. 
5398. /* 1) Failed, zero gap overrode the previous one. */
5399. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
5400. /* AddGap(GapUsedTemp) */ 
5401. 
5402. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
5403. /* AddGap(GapUsedTemp, DoNotVacate) */ 
5404. 
5405. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
5406. 
5407. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
5408. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
5409. /* AddGap(GapUsedTemp) */ 
5410. 
5411. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
5412. /* AddGap(GapUsedTemp, DoNotVacate) */ 
5413. 
5414. /* ---------------------------------------------------------- */
5415. 
5416. # Vacate
5417. /* AddGap(GapUsed) */
5418. 
5419. # DO NOT Vacate (recommended)
5420. /* AddGap(GapUsed, DoNotVacate) */ 
5421. 	
5422. 
5423. 		
5424. # 
5425. FileEnd
5426. /* ---------------------------------------------------------- */
5427. 
5428. # your stuff HERE (X)... post zone (file) code.
5429. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
5430. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5431. 	# (X)
5432. 
5433. SetVariable(FileStepDescription,"Zone finished, reporting.")
5434. # FILE STEP
5435. 
5436. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5437. 
5438. /* add message and move to a new line. */
5439. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5440. ")
5441. 
5442. /* display the line. (hopefully.) */
5443. # Zone Footer Set Statistics Window Text
5444. 
5445. SetStatisticsWindowText("----------------------------------------------------------
5446. Zones Processed: 
5447. ----------------------------------------------------------
5448. !ZoneListByLine!
5449. ----------------------------------------------------------
5450. Zone Processing Step:
5451. !ZoneStepByLine!    
5452. ----------------------------------------------------------
5453. Current Zone:
5454. !ZoneFooter!
5455. ----------------------------------------------------------
5456. Volume Statistics:
5457. !VolumeStatisticsDetail!
5458. ----------------------------------------------------------
5459. Zone Detailed Report:
5460. ----------------------------------------------------------
5461. !ZoneStatisticsDetail!
5462. ----------------------------------------------------------
5463. ")
5464. 
5465. 
5466. 
5467. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5468. 
5469. # BANNER SET
5470. 
5471. # DATE TIME RUN ELP
5472. 
5473. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
5474. /* Xinclude "..\Display\BannerSet.MyDc"X */
5475. /* pause(1) */
5476. 
5477. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5478. 
5479. Title('!Heading!')
5480. /* pause(1) */
5481. 
5482. /* NOTE: Can't round or truncate to integer precision. */
5483. 
5484. pause(1)
5485. 
5486. # Zone When Finished
5487. 
5488. # BANNER SET
5489. 
5490. # DATE TIME RUN ELP
5491. 
5492. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
5493. /* Xinclude "..\Display\BannerSet.MyDc"X */
5494. /* pause(1) */
5495. 
5496. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5497. 
5498. Title('!Heading!')
5499. /* pause(1) */
5500. 
5501. /* NOTE: Can't round or truncate to integer precision. */
5502. 
5503. AppendLogfile("!LogFileName!", "!Title!")
5504. 
5505. 
5506. 
5507. # Zone Statistics	
5508. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
5509. 
5510. # Footer:
5511. SetVariable(ZoneFooter, "----------------------------------------------------------
5512. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
5513. 
5514. Statistics Report:
5515. ------------------
5516.    Size:  
5517.    ------------------------
5518.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5519.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5520.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5521. 
5522.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5523.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5524. 
5525.    Location:
5526.    ------------------------
5527.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5528.              Files End: !ZoneEndCurrent!
5529.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5530.       
5531.    Gap Settings:
5532.    ------------------------
5533.          Gap Requested: !ZoneGapSizePer!%
5534.       Volume Rounding: !ZoneVolRoundUpPer!%
5535.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5536.                  
5537.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5538.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5539.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5540.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5541.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5542.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5543.      
5544.    Free Space after Zone:
5545.    ------------------------
5546.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5547.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5548.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5549. 
5550. Directory and Files Select:
5551. ---------------------------
5552. !ZoneTypeSelectCurrent!               
5553. ---------------------------
5554. ----------------------------------------------------------
5555. ")
5556. 
5557. AppendLogfile("!LogFileName!", ".")
5558. AppendLogfile("!LogFileName!", "!ZoneFooter!")
5559. AppendLogfile("!LogFileName!", ".")
5560. 
5561. # Zone Footer Set Statistics Window Text
5562. 
5563. SetStatisticsWindowText("----------------------------------------------------------
5564. Zones Processed: 
5565. ----------------------------------------------------------
5566. !ZoneListByLine!
5567. ----------------------------------------------------------
5568. Zone Processing Step:
5569. !ZoneStepByLine!    
5570. ----------------------------------------------------------
5571. Current Zone:
5572. !ZoneFooter!
5573. ----------------------------------------------------------
5574. Volume Statistics:
5575. !VolumeStatisticsDetail!
5576. ----------------------------------------------------------
5577. Zone Detailed Report:
5578. ----------------------------------------------------------
5579. !ZoneStatisticsDetail!
5580. ----------------------------------------------------------
5581. ")
5582. 
5583. 
5584. 
5585. /* pause() */
5586. /* pause() */
5587. 
5588. 
5589. 
5590. 	
5591. /* ---------------------------------------------------------- */
5592. # Zone ProgramHints Data.
5593. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHintsData!")
5594. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHintsData!")
5595. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
5596. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHints!")
5597. 	SetVariable(ZoneTypeSelect,'
5598.                 # ProgramHints - Data files.
5599.                 not(
5600.                      # Os PageHiberDump start.
5601. (
5602.   FileName("DataStore.edb")
5603.   or FileName("DUMP*.*")
5604.   or FileName("Hiberfil.sys")
5605.   or FileName("MEMORY.DMP")
5606.   or FileName("Pagefile.sys")
5607. )
5608. # Os PageHiberDump end.
5609. 
5610.                 )
5611. ')
5612. 
5613. 
5614. 		# Zone Do Header
5615. 
5616. # Zone When Started
5617. 
5618. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
5619. # Display Set Zone
5620. 
5621. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
5622. SetVariable(FileStepDescription,	"")
5623. 
5624. SetVariable(ZoneStepByLine, 			"Zone started.
5625. ")
5626. 
5627. # BANNER SET
5628. 
5629. # DATE TIME RUN ELP
5630. 
5631. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
5632. /* Xinclude "..\Display\BannerSet.MyDc"X */
5633. /* pause(1) */
5634. 
5635. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5636. 
5637. Title('!Heading!')
5638. /* pause(1) */
5639. 
5640. /* NOTE: Can't round or truncate to integer precision. */
5641. 
5642. AppendLogfile("!LogFileName!", "!Title!")
5643. 
5644. 
5645. 
5646. pause(1)
5647. 
5648. 
5649. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
5650. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
5651. 
5652. SetVariable(ZoneStepNoCurrent, 0)
5653. 
5654. 
5655. # Zone Do Current Clear
5656. 
5657. SetVariable(ZoneTypeSelectCurrent, 		"")
5658. 
5659. SetVariable(ZoneBeginCurrent, 			0)
5660. SetVariable(ZoneBeginPerCurrent, 		0)
5661. SetVariable(ZoneEndCurrent, 			0)
5662. SetVariable(ZoneEndPerCurrent, 			0)
5663. 
5664. SetVariable(ZoneSizeCurrent,			0)
5665. SetVariable(ZoneSizePerCurrent,			0)
5666. 
5667. SetVariable(ZoneGapRequestedCurrent,	0)
5668. SetVariable(ZoneGapRoundedCurrent, 		0)
5669. SetVariable(ZoneGapAdjustedCurrent, 	0)
5670. SetVariable(ZoneGapAvailableCurrent, 	0)
5671. SetVariable(ZoneGapCurrent,				0)
5672. SetVariable(ZoneGapUsedCurrent, 		0)
5673. 
5674. SetVariable(ZoneGapActualCurrent, 		0)
5675. SetVariable(ZoneGapActualPerCurrent, 	0)
5676. 
5677. SetVariable(ZoneSizeActual, 			0)
5678. SetVariable(ZoneSizeActualCurrent,		0)
5679. 
5680. SetVariable(ZoneEndActual, 				0)
5681. SetVariable(ZoneEndActualCurrent,		0)			
5682. SetVariable(ZoneSizeActualPerCurrent, 	0)
5683.       
5684. SetVariable(ZoneFilesFolders,			0)
5685. SetVariable(ZoneFilesFoldersPer,		0) 
5686. 
5687. SetVariable(ZoneFragments,				0)
5688. SetVariable(ZoneFragmentsPer,			0) 
5689. 		
5690. SetVariable(ZoneEndActualCurrent, 		0)
5691. SetVariable(ZoneEndActualPerCurrent, 	0)
5692. 
5693. # Gap Calculation Methodology:
5694. 	# Requested
5695. 	SetVariable(GapRequested, 			0) 
5696. 	SetVariable(GapRequestedStd, 		0) 
5697. 	SetVariable(GapRequestedMft, 		0) 
5698. 	SetVariable(GapRequestedOs, 		0) 
5699. 	SetVariable(GapRequestedOriginal, 	0) 
5700. 	
5701. 	# Gap Adjustments
5702. 	SetVariable(GapRounded, 			0)
5703. 	# SetVariable(GapAdjusted, 			0)
5704. 	SetVariable(GapAvailable, 			0)
5705. 	SetVariable(GapCurrent, 			0)
5706. 	SetVariable(GapActual, 				0)
5707. 	SetVariable(GapUsed, 				0)
5708. 	
5709. 	# Gap Adjustments
5710. 	SetVariable(GapRoundedLoc, 			0)
5711. 	# SetVariable(GapAdjustedLoc, 		0)
5712. 	SetVariable(GapAvailableLoc, 		0)
5713. 	SetVariable(GapCurrentLoc, 			0)
5714. 	SetVariable(GapActualLoc,			0)
5715. 	SetVariable(GapUsedLoc,				0)
5716. 	
5717. 	# Space usage
5718. 	SetVariable(ZoneFreePerRequested, 	0)
5719. 	SetVariable(ZoneFreePerUsed, 		0)
5720. 
5721. # Gap Size & Rounding
5722. 	SetVariable(ZoneGapSizePer, 		0)
5723. 	SetVariable(ZoneVolRoundUpPer, 		0)
5724. 	
5725. 	# Free Space
5726. 	SetVariable(ZoneFreeUsedPer, 		0)
5727. 	SetVariable(ZoneFreeRequestedPer, 	0)
5728. 
5729. 
5730. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
5731. 
5732. # Footer:
5733. SetVariable(ZoneFooter, "----------------------------------------------------------
5734. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
5735. 
5736. Statistics Report:
5737. ------------------
5738.    Size:  
5739.    ------------------------
5740.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5741.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5742.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5743. 
5744.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5745.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5746. 
5747.    Location:
5748.    ------------------------
5749.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5750.              Files End: !ZoneEndCurrent!
5751.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5752.       
5753.    Gap Settings:
5754.    ------------------------
5755.          Gap Requested: !ZoneGapSizePer!%
5756.       Volume Rounding: !ZoneVolRoundUpPer!%
5757.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5758.                  
5759.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5760.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5761.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5762.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5763.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5764.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5765.      
5766.    Free Space after Zone:
5767.    ------------------------
5768.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5769.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5770.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5771. 
5772. Directory and Files Select:
5773. ---------------------------
5774. !ZoneTypeSelectCurrent!               
5775. ---------------------------
5776. ----------------------------------------------------------
5777. ")
5778. 
5779. # BANNER SET
5780. 
5781. # DATE TIME RUN ELP
5782. 
5783. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
5784. /* Xinclude "..\Display\BannerSet.MyDc"X */
5785. /* pause(1) */
5786. 
5787. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5788. 
5789. Title('!Heading!')
5790. /* pause(1) */
5791. 
5792. /* NOTE: Can't round or truncate to integer precision. */
5793. 
5794. AppendLogfile("!LogFileName!", "!Title!")
5795. 
5796. 
5797. 
5798. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
5799. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
5800. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:51")
5801. 
5802. SetVariable(ZoneListByLine, "!ZoneListByLine!
5803. Zone: !ZoneNoCurrent! 2021-11-09 10:47:51 0:00:03 !ZoneLabel! !ZoneDescription!")
5804. 
5805. 
5806. /* Fixed Zone Position Handling */
5807. /* Literal number: */
5808. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
5809. /* Percentage of disk: */
5810. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
5811. /* Gap */
5812. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
5813. 
5814. /* ---------------------------------------------------------- */
5815. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
5816. # FILE STEP
5817. 
5818. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5819. 
5820. /* add message and move to a new line. */
5821. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5822. ")
5823. 
5824. /* display the line. (hopefully.) */
5825. # Zone Footer Set Statistics Window Text
5826. 
5827. SetStatisticsWindowText("----------------------------------------------------------
5828. Zones Processed: 
5829. ----------------------------------------------------------
5830. !ZoneListByLine!
5831. ----------------------------------------------------------
5832. Zone Processing Step:
5833. !ZoneStepByLine!    
5834. ----------------------------------------------------------
5835. Current Zone:
5836. !ZoneFooter!
5837. ----------------------------------------------------------
5838. Volume Statistics:
5839. !VolumeStatisticsDetail!
5840. ----------------------------------------------------------
5841. Zone Detailed Report:
5842. ----------------------------------------------------------
5843. !ZoneStatisticsDetail!
5844. ----------------------------------------------------------
5845. ")
5846. 
5847. 
5848. 
5849. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5850. 
5851. # BANNER SET
5852. 
5853. # DATE TIME RUN ELP
5854. 
5855. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
5856. /* Xinclude "..\Display\BannerSet.MyDc"X */
5857. /* pause(1) */
5858. 
5859. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5860. 
5861. Title('!Heading!')
5862. /* pause(1) */
5863. 
5864. /* NOTE: Can't round or truncate to integer precision. */
5865. 
5866. pause(1)
5867. 
5868. # your stuff HERE (X)... pre file select code.
5869. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
5870. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5871. 	# (X)
5872. 
5873. FileSelect
5874. 
5875. 	# your stuff can't really go here (errors.)
5876. 	# maybe for some reason I don't know of...
5877. 	
5878. 	# Actions next...
5879. 		# ProgramHints start.
5880. ImportListFromProgramHints("*.pf")
5881. # ProgramHints end.
5882. 
5883. 		and not(
5884. 			# Os PageHiberDump start.
5885. (
5886.   FileName("DataStore.edb")
5887.   or FileName("DUMP*.*")
5888.   or FileName("Hiberfil.sys")
5889.   or FileName("MEMORY.DMP")
5890.   or FileName("Pagefile.sys")
5891. )
5892. # Os PageHiberDump end.
5893. 
5894. 		)
5895. 		FileActions
5896. 		  		/* ---------------------------------------------------------- */
5897. 	# Gap
5898. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
5899. 		# FILE STEP
5900. 
5901. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5902. 
5903. /* add message and move to a new line. */
5904. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5905. ")
5906. 
5907. /* display the line. (hopefully.) */
5908. # Zone Footer Set Statistics Window Text
5909. 
5910. SetStatisticsWindowText("----------------------------------------------------------
5911. Zones Processed: 
5912. ----------------------------------------------------------
5913. !ZoneListByLine!
5914. ----------------------------------------------------------
5915. Zone Processing Step:
5916. !ZoneStepByLine!    
5917. ----------------------------------------------------------
5918. Current Zone:
5919. !ZoneFooter!
5920. ----------------------------------------------------------
5921. Volume Statistics:
5922. !VolumeStatisticsDetail!
5923. ----------------------------------------------------------
5924. Zone Detailed Report:
5925. ----------------------------------------------------------
5926. !ZoneStatisticsDetail!
5927. ----------------------------------------------------------
5928. ")
5929. 
5930. 
5931. 
5932. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5933. 
5934. # BANNER SET
5935. 
5936. # DATE TIME RUN ELP
5937. 
5938. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
5939. /* Xinclude "..\Display\BannerSet.MyDc"X */
5940. /* pause(1) */
5941. 
5942. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5943. 
5944. Title('!Heading!')
5945. /* pause(1) */
5946. 
5947. /* NOTE: Can't round or truncate to integer precision. */
5948. 
5949. pause(1)
5950. 	
5951. 	# ACTUAL GAP
5952. 		/* AddGap Variant. */
5953. 	  	# Zone Do Gap
5954. # Gap Calculation Methods:
5955. 
5956. /* 1) Anything you need to add first. */
5957. /* empty */
5958. 
5959. /* ---------------------------------------------------------- */
5960. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
5961. 	# GapRequestedStd.
5962. 
5963. 		/* ---------------------------------------------------------- */
5964. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
5965. 
5966. 		# Gap Calculation Methods:
5967. 
5968. /* AddGap Variants */
5969. 
5970. 	/* Standard */
5971. 		# Gap Calculation Methods:
5972. 	/* AddGap Variants */
5973. 	/* Standard */
5974. 
5975. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
5976. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
5977. 
5978. 	SetVariable(GapRequested, GapRequestedStd)
5979. 	
5980. 
5981. 	/* MFT Low High Method */
5982. 		# Gap Calculation Methods:
5983. 	/* AddGap Variants */
5984. 	/* MFT Low High Method */
5985. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
5986. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
5987. 	SetVariable(GapRequested, GapRequestedMft)
5988. 	
5989. 
5990. 	/* OS Volume Type Method */
5991. 		# Gap Calculation Methods:
5992. 	/* AddGap Variants */
5993. 	/* OS Volume Type Method */
5994. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
5995. 	SetVariable(GapRequested, GapRequestedOs)
5996. 
5997. 
5998. 
5999. /* MakeGap Variants */
6000. 
6001. 	/* Original Os 1-3 + MFT 2 */
6002. 		# Gap Calculation Methods:
6003. 	/* MakeGap Variants */
6004. 	/* Original Os 1-3 + MFT 2 */
6005. 	/* plus MFT gap placed inline at the dividing zone. */
6006. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
6007. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
6008. 	SetVariable(GapRequested, GapRequestedOrig)
6009. 	
6010. 	
6011. /* Note: You could comment out the ones not in use */
6012. /* However having the data in the log is useful. */
6013. /* Therefore the following line is otherwise needed. */
6014. 
6015. /* Standard used */
6016. 
6017. SetVariable(GapRequested, GapRequestedStd)
6018. 
6019. # Gap Calculation Methods:
6020. 
6021. /* AddGap Variants */
6022. 	/* Standard */
6023. 	/* MFT Low High Method */
6024. 	/* OS Volume Type Method */
6025. 
6026. /* MakeGap Variants */
6027. 	/* Original Os 1-3 + MFT 2 */
6028. 
6029. /* Note: You could comment out the ones not in use */
6030. /* However having the data in the log is useful. */
6031. /* Therefore the following line is otherwise needed. */
6032. 
6033. /* Standard is used currently */
6034. 
6035. 
6036. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
6037. 
6038. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
6039. 
6040. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
6041. 
6042. /* ---------------------------------------------------------- */
6043. /* 3) SMALL ZONE ADJUSTMENT. */
6044. /* Gab cant be larger than half the Zone Size. */
6045. 
6046. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
6047. 	
6048. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
6049. 
6050. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
6051. 
6052. /* ---------------------------------------------------------- */
6053. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
6054. # Gap Adjustments.
6055. 
6056. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
6057. 	
6058. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
6059. 
6060. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
6061. 
6062. /* ---------------------------------------------------------- */
6063. # BYPASS THIS.
6064. 	/* This is definitely wrong. */
6065. 	/* The question is can we steal gap from the next zone */
6066. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
6067. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
6068. 		# Zone Overflow.
6069. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
6070. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
6071. 
6072. /* ---------------------------------------------------------- */
6073. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
6074. # Remaining free space available.
6075. 
6076. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
6077. 	
6078. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
6079. 
6080. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
6081. 
6082. /* ---------------------------------------------------------- */
6083. # CURRENT gap to use.
6084. 
6085. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
6086. 
6087. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
6088. 
6089. /* ---------------------------------------------------------- */
6090. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
6091. # Debugging.
6092. 
6093. 	SetVariable(GapUsed, GapCurrent) // for debugging
6094. 
6095. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
6096. 
6097. 		# Your code HERE
6098. 
6099. /* ---------------------------------------------------------- */
6100. /* 7) YOUR CODE. */
6101. # YOUR CODE HERE:
6102. 	# INPUT: GapCurrent or GapCurrentLoc
6103. 	# OUTPUT: GapUsed...
6104. 
6105. /* ---------------------------------------------------------- */
6106. # Gap Size.
6107. # Actual Size of Gap.
6108. 
6109. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
6110. 
6111. /* ---------------------------------------------------------- */
6112. /* xxxxxxxxxxxxxxxxxxxxxx */
6113. # ADD THE GAP
6114. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
6115. /* xxxxxxxxxxxxxxxxxxxxxx */
6116. 
6117. 	
6118. 	# Zone Statistics	
6119. 	# Zone / Volume Statistics and Display
6120. 		
6121. 	# Accumulate Totals
6122.   	# Volume totals
6123. 
6124. /* Current total space used (by Zones and Gaps) */
6125. 
6126. SetVariable(VolumeZoneUsed, GapUsed)
6127. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
6128. /* Percentage */
6129. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
6130. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
6131. 
6132. /* Current total of free space requested */
6133. 
6134. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
6135. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6136. /* Percent. */
6137. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
6138. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6139. 
6140. /* Current total of free space used */
6141. 
6142. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
6143. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
6144. /* Percent */
6145. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
6146. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
6147. 
6148. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
6149. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
6150. /* Xinclude "..\DebugDisplayPause.MyDc"X */
6151. 
6152. 
6153. 	# Current Values
6154. 	# Cluster, Sector, Block adjust for display.
6155. 	# Bytes per cluster is volume specific.
6156. 
6157. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
6158. 
6159. # Current Zone values.
6160. 	# Begin, end and size.
6161. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
6162. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
6163. 
6164. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
6165. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
6166. 
6167. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
6168. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
6169. 
6170. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
6171. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
6172. 
6173. 	SetVariable(ZoneFragments,				"!ZONE210N!")
6174. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
6175. 		
6176. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
6177. /* identical code to here: (separation not needed. TEST.) */	
6178. 
6179. # Current Gap, Actual and Free Values
6180. 	# Gap
6181. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
6182. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
6183. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
6184. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
6185. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
6186. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
6187. 	
6188. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
6189. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
6190. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
6191. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
6192. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
6193. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
6194. 	
6195. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
6196. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
6197. 	
6198. 	# Actual Size and End
6199. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
6200. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
6201. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
6202. 	
6203. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
6204. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
6205. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
6206. 
6207. # Gap Size & Rounding
6208. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
6209. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
6210. 	
6211. 	# Free Space
6212. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
6213. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
6214. 
6215. 	# Footer:
6216. SetVariable(ZoneFooter, "----------------------------------------------------------
6217. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
6218. 
6219. Statistics Report:
6220. ------------------
6221.    Size:  
6222.    ------------------------
6223.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6224.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6225.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6226. 
6227.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6228.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6229. 
6230.    Location:
6231.    ------------------------
6232.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6233.              Files End: !ZoneEndCurrent!
6234.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6235.       
6236.    Gap Settings:
6237.    ------------------------
6238.          Gap Requested: !ZoneGapSizePer!%
6239.       Volume Rounding: !ZoneVolRoundUpPer!%
6240.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6241.                  
6242.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6243.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6244.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6245.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6246.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6247.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6248.      
6249.    Free Space after Zone:
6250.    ------------------------
6251.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6252.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6253.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6254. 
6255. Directory and Files Select:
6256. ---------------------------
6257. !ZoneTypeSelectCurrent!               
6258. ---------------------------
6259. ----------------------------------------------------------
6260. ")
6261. 	# Zone Footer Set Statistics Window Text
6262. 
6263. SetStatisticsWindowText("----------------------------------------------------------
6264. Zones Processed: 
6265. ----------------------------------------------------------
6266. !ZoneListByLine!
6267. ----------------------------------------------------------
6268. Zone Processing Step:
6269. !ZoneStepByLine!    
6270. ----------------------------------------------------------
6271. Current Zone:
6272. !ZoneFooter!
6273. ----------------------------------------------------------
6274. Volume Statistics:
6275. !VolumeStatisticsDetail!
6276. ----------------------------------------------------------
6277. Zone Detailed Report:
6278. ----------------------------------------------------------
6279. !ZoneStatisticsDetail!
6280. ----------------------------------------------------------
6281. ")
6282. 
6283. 
6284. 	
6285.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
6286. 
6287. 	# Add Zone to list of zones for display.
6288. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
6289. 	# ??? Free Stats?
6290. 	# Footer:
6291. SetVariable(ZoneFooter, "----------------------------------------------------------
6292. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
6293. 
6294. Statistics Report:
6295. ------------------
6296.    Size:  
6297.    ------------------------
6298.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6299.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6300.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6301. 
6302.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6303.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6304. 
6305.    Location:
6306.    ------------------------
6307.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6308.              Files End: !ZoneEndCurrent!
6309.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6310.       
6311.    Gap Settings:
6312.    ------------------------
6313.          Gap Requested: !ZoneGapSizePer!%
6314.       Volume Rounding: !ZoneVolRoundUpPer!%
6315.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6316.                  
6317.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6318.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6319.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6320.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6321.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6322.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6323.      
6324.    Free Space after Zone:
6325.    ------------------------
6326.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6327.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6328.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6329. 
6330. Directory and Files Select:
6331. ---------------------------
6332. !ZoneTypeSelectCurrent!               
6333. ---------------------------
6334. ----------------------------------------------------------
6335. ")
6336. 
6337. 	# Add Zone Details to Report.	
6338. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
6339. !ZoneFooter!")
6340. 
6341. 
6342. 	
6343. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
6344. 			# FILE STEP
6345. 
6346. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6347. 
6348. /* add message and move to a new line. */
6349. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6350. ")
6351. 
6352. /* display the line. (hopefully.) */
6353. # Zone Footer Set Statistics Window Text
6354. 
6355. SetStatisticsWindowText("----------------------------------------------------------
6356. Zones Processed: 
6357. ----------------------------------------------------------
6358. !ZoneListByLine!
6359. ----------------------------------------------------------
6360. Zone Processing Step:
6361. !ZoneStepByLine!    
6362. ----------------------------------------------------------
6363. Current Zone:
6364. !ZoneFooter!
6365. ----------------------------------------------------------
6366. Volume Statistics:
6367. !VolumeStatisticsDetail!
6368. ----------------------------------------------------------
6369. Zone Detailed Report:
6370. ----------------------------------------------------------
6371. !ZoneStatisticsDetail!
6372. ----------------------------------------------------------
6373. ")
6374. 
6375. 
6376. 
6377. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6378. 
6379. # BANNER SET
6380. 
6381. # DATE TIME RUN ELP
6382. 
6383. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
6384. /* Xinclude "..\Display\BannerSet.MyDc"X */
6385. /* pause(1) */
6386. 
6387. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6388. 
6389. Title('!Heading!')
6390. /* pause(1) */
6391. 
6392. /* NOTE: Can't round or truncate to integer precision. */
6393. 
6394. pause(1)
6395. 
6396. 			SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
6397. 	
6398. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
6399. 			# FILE STEP
6400. 
6401. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6402. 
6403. /* add message and move to a new line. */
6404. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6405. ")
6406. 
6407. /* display the line. (hopefully.) */
6408. # Zone Footer Set Statistics Window Text
6409. 
6410. SetStatisticsWindowText("----------------------------------------------------------
6411. Zones Processed: 
6412. ----------------------------------------------------------
6413. !ZoneListByLine!
6414. ----------------------------------------------------------
6415. Zone Processing Step:
6416. !ZoneStepByLine!    
6417. ----------------------------------------------------------
6418. Current Zone:
6419. !ZoneFooter!
6420. ----------------------------------------------------------
6421. Volume Statistics:
6422. !VolumeStatisticsDetail!
6423. ----------------------------------------------------------
6424. Zone Detailed Report:
6425. ----------------------------------------------------------
6426. !ZoneStatisticsDetail!
6427. ----------------------------------------------------------
6428. ")
6429. 
6430. 
6431. 
6432. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6433. 
6434. # BANNER SET
6435. 
6436. # DATE TIME RUN ELP
6437. 
6438. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
6439. /* Xinclude "..\Display\BannerSet.MyDc"X */
6440. /* pause(1) */
6441. 
6442. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6443. 
6444. Title('!Heading!')
6445. /* pause(1) */
6446. 
6447. /* NOTE: Can't round or truncate to integer precision. */
6448. 
6449. pause(1)
6450. 
6451. 		# Zone Do Footer
6452. 
6453. /* ---------------------------------------------------------- */
6454. # File Select
6455. 	# Select Statments
6456. # File Actions 
6457. 	# Standard or OS File Actions.
6458. 	# Resume...
6459. 	
6460. 	# your stuff HERE (X)... post zone (file) file actions code.
6461. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
6462. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
6463. 		# (X)
6464. 		
6465. 		/* ??? Set window? */
6466. 	
6467. 	# ADD THE GAP
6468. 		
6469. # Vacate (good for diagnostics)
6470. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
6471. 
6472. # DoNotVacate - DO NOT Vacate (recommended)
6473. 
6474. # Vacate
6475. /* AddGap(GapUsedLoc) */
6476. 
6477. # DO Not Vacate
6478. AddGap(GapUsedLoc, DoNotVacate) 
6479. 	
6480. 	
6481. /* ---------------------------------------------------------- */
6482. # (failed) TEST for boolean logic.
6483. 
6484. /* It should work in the gap calculations for turning options */
6485. /* on and off but it will NOT work here. */
6486. 
6487. /* Boolean setting X or FlagX. */
6488. /* Where X will be on or off: */
6489. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
6490. /*      For ON:  (X  *  FlagAny) */
6491. 
6492. /* 1) Failed, zero gap overrode the previous one. */
6493. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
6494. /* AddGap(GapUsedTemp) */ 
6495. 
6496. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
6497. /* AddGap(GapUsedTemp, DoNotVacate) */ 
6498. 
6499. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
6500. 
6501. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
6502. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
6503. /* AddGap(GapUsedTemp) */ 
6504. 
6505. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
6506. /* AddGap(GapUsedTemp, DoNotVacate) */ 
6507. 
6508. /* ---------------------------------------------------------- */
6509. 
6510. # Vacate
6511. /* AddGap(GapUsed) */
6512. 
6513. # DO NOT Vacate (recommended)
6514. /* AddGap(GapUsed, DoNotVacate) */ 
6515. 	
6516. 
6517. 		
6518. # 
6519. FileEnd
6520. /* ---------------------------------------------------------- */
6521. 
6522. # your stuff HERE (X)... post zone (file) code.
6523. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
6524. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
6525. 	# (X)
6526. 
6527. SetVariable(FileStepDescription,"Zone finished, reporting.")
6528. # FILE STEP
6529. 
6530. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6531. 
6532. /* add message and move to a new line. */
6533. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6534. ")
6535. 
6536. /* display the line. (hopefully.) */
6537. # Zone Footer Set Statistics Window Text
6538. 
6539. SetStatisticsWindowText("----------------------------------------------------------
6540. Zones Processed: 
6541. ----------------------------------------------------------
6542. !ZoneListByLine!
6543. ----------------------------------------------------------
6544. Zone Processing Step:
6545. !ZoneStepByLine!    
6546. ----------------------------------------------------------
6547. Current Zone:
6548. !ZoneFooter!
6549. ----------------------------------------------------------
6550. Volume Statistics:
6551. !VolumeStatisticsDetail!
6552. ----------------------------------------------------------
6553. Zone Detailed Report:
6554. ----------------------------------------------------------
6555. !ZoneStatisticsDetail!
6556. ----------------------------------------------------------
6557. ")
6558. 
6559. 
6560. 
6561. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6562. 
6563. # BANNER SET
6564. 
6565. # DATE TIME RUN ELP
6566. 
6567. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
6568. /* Xinclude "..\Display\BannerSet.MyDc"X */
6569. /* pause(1) */
6570. 
6571. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6572. 
6573. Title('!Heading!')
6574. /* pause(1) */
6575. 
6576. /* NOTE: Can't round or truncate to integer precision. */
6577. 
6578. pause(1)
6579. 
6580. # Zone When Finished
6581. 
6582. # BANNER SET
6583. 
6584. # DATE TIME RUN ELP
6585. 
6586. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:51 0:00:03")
6587. /* Xinclude "..\Display\BannerSet.MyDc"X */
6588. /* pause(1) */
6589. 
6590. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6591. 
6592. Title('!Heading!')
6593. /* pause(1) */
6594. 
6595. /* NOTE: Can't round or truncate to integer precision. */
6596. 
6597. AppendLogfile("!LogFileName!", "!Title!")
6598. 
6599. 
6600. 
6601. # Zone Statistics	
6602. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
6603. 
6604. # Footer:
6605. SetVariable(ZoneFooter, "----------------------------------------------------------
6606. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:51
6607. 
6608. Statistics Report:
6609. ------------------
6610.    Size:  
6611.    ------------------------
6612.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6613.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6614.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6615. 
6616.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6617.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6618. 
6619.    Location:
6620.    ------------------------
6621.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6622.              Files End: !ZoneEndCurrent!
6623.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6624.       
6625.    Gap Settings:
6626.    ------------------------
6627.          Gap Requested: !ZoneGapSizePer!%
6628.       Volume Rounding: !ZoneVolRoundUpPer!%
6629.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6630.                  
6631.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6632.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6633.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6634.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6635.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6636.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6637.      
6638.    Free Space after Zone:
6639.    ------------------------
6640.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6641.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6642.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6643. 
6644. Directory and Files Select:
6645. ---------------------------
6646. !ZoneTypeSelectCurrent!               
6647. ---------------------------
6648. ----------------------------------------------------------
6649. ")
6650. 
6651. AppendLogfile("!LogFileName!", ".")
6652. AppendLogfile("!LogFileName!", "!ZoneFooter!")
6653. AppendLogfile("!LogFileName!", ".")
6654. 
6655. # Zone Footer Set Statistics Window Text
6656. 
6657. SetStatisticsWindowText("----------------------------------------------------------
6658. Zones Processed: 
6659. ----------------------------------------------------------
6660. !ZoneListByLine!
6661. ----------------------------------------------------------
6662. Zone Processing Step:
6663. !ZoneStepByLine!    
6664. ----------------------------------------------------------
6665. Current Zone:
6666. !ZoneFooter!
6667. ----------------------------------------------------------
6668. Volume Statistics:
6669. !VolumeStatisticsDetail!
6670. ----------------------------------------------------------
6671. Zone Detailed Report:
6672. ----------------------------------------------------------
6673. !ZoneStatisticsDetail!
6674. ----------------------------------------------------------
6675. ")
6676. 
6677. 
6678. 
6679. /* pause() */
6680. /* pause() */
6681. 
6682. 
6683. 
6684. 	
6685. /* ---------------------------------------------------------- */
6686. 
6687. 
6688. /* ---------------------------------------------------------- */
6689. # Zone Programs Fixed size but not windows..
6690. /* ---------------------------------------------------------- */
6691. # Zone Programs Fixed size but not windows..
6692. 	SetVariable(ZoneLabel, 			"!ZoneLabelPrograms!")
6693. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPrograms!")
6694. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
6695. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
6696. 	SetVariable(ZoneTypeSelect,'# Programs start.
6697. # NotBlobsArchivesBu start.
6698. (not (
6699. # Blobs start.
6700. (
6701. # BlobsAndExceptions start.
6702. ( not(
6703.   FileName("*.bat")
6704.   or FileName("*.css")
6705.   or FileName("*.dll")
6706.   or FileName("*.exe")
6707.   or FileName("*.htm*")
6708.   or FileName("*.jar")
6709.   or FileName("*.js")
6710.   or FileName("*.script")
6711.   or FileName("*.wsf")
6712.   or (
6713. # Databases start.
6714. (
6715.   FileName("*.crypt*")
6716.   or FileName("*.db*")
6717.   or FileName("*.rdb*")
6718.   or FileName("*.dc*")
6719.   or FileName("*.dict*")
6720.   or FileName("*.?db*")
6721.   or FileName("*.?rdb*")
6722.   or FileName("*.md*")
6723.   or FileName("*.myd")
6724.   or FileName("*.ndf")
6725.   or FileName("*.ns?")
6726.   or FileName("*.pab")
6727.   or FileName("*.pst")
6728.   or FileName("*.sd?*")
6729.   or FileName("*.sq**")
6730.   or FileName("*.tmd")
6731.   or FileName("*.tps")
6732.   or FileName("*.tr*")
6733. )
6734. # Databases end.
6735. 
6736.     # BlobsAndExceptions
6737.     or 
6738. # Data start.
6739. (
6740.   DirectoryName("Data*")
6741.   or DirectoryName("Device*")
6742.   or DirectoryName("Export*")
6743.   or DirectoryName("Import*")
6744.   or DirectoryName("Log*")
6745.   or DirectoryName("*Log")
6746.   or DirectoryName("Maintenance*")
6747.   or DirectoryName("Rec*")
6748.   or DirectoryName("Sales*")
6749.   or DirectoryName("Search*")
6750.   or DirectoryName("User*")
6751. )
6752. # Data end.
6753. 
6754.     # BlobsAndExceptions
6755.   )
6756. ) )
6757. # BlobsAndExceptions end.
6758. 
6759. # Blobs
6760. ) and (
6761.   Size(BlobFileSize,0)
6762.   or (
6763.     FileName("*.arj")
6764.     or FileName("*.bup")
6765.     or FileName("*.bz2")
6766.     or FileName("*.chm")
6767.     or FileName("*.dvr-ms")
6768.     or FileName("*.gz")
6769.     or FileName("*.ifo")
6770.     or FileName("*.lzh")
6771.     or FileName("*.pdf")
6772.     or FileName("*.rpm")
6773.     or FileName("*.wmv")
6774.     or FileName("*.vob")
6775.     or FileName("*.z")
6776.   ) 
6777. )
6778. # Blobs end.
6779. 
6780. # NotBlobsArchivesBu
6781. or 
6782. # Archives start.
6783. (
6784.   DirectoryName("*Archive*")
6785.   or DirectoryName("*History*")
6786.   or DirectoryName("*Old")
6787.   or DirectoryName("* Old *")
6788.   or DirectoryName("Old *")
6789. 
6790.   or FileName("*.7z")
6791.   or FileName("*.cab")
6792.   or FileName("*.iso")
6793.   or FileName("*.msi")
6794.   or FileName("*.old")
6795.   or FileName("*.rar")
6796.   or FileName("*.tar")
6797.   or FileName("*.zip")
6798.   or
6799. # WinSysLow start.
6800. (
6801.   DirectoryName("$*")
6802.   or DirectoryName("0*")
6803.   or DirectoryName("1*")
6804.   or DirectoryName("2*")
6805.   or DirectoryName("3*")
6806.   or DirectoryName("4*")
6807.   or DirectoryName("5*")
6808.   or DirectoryName("6*")
6809.   or DirectoryName("7*")
6810.   or DirectoryName("8*")
6811.   or DirectoryName("9*")
6812. 
6813.   or DirectoryName("dllcache")
6814.   or DirectoryName("Downloaded Installations")
6815.   or DirectoryName("Ehome")
6816.   or DirectoryName("Fonts")
6817.   or DirectoryName("Help")
6818.   or DirectoryName("I386")
6819.   or DirectoryName("ie?updates")
6820.   or DirectoryName("Installer")
6821.   or DirectoryName("Installshield Installation Information")
6822.   or DirectoryName("IME")
6823.   or DirectoryName("*RECYCLE*")
6824.   or DirectoryName("ServicePackFiles")
6825.   or DirectoryName("SoftwareDistribution")
6826.   or DirectoryName("Speech")
6827.   or DirectoryName("Symbols")
6828.   or DirectoryName("System Volume Information")
6829.   or DirectoryName("windows.old")
6830. )
6831. # WinSysLow end.
6832. 
6833.   # Archives
6834. )
6835. # Archives end.
6836. 
6837. # NotBlobsArchivesBu
6838. or
6839. # Backups start.
6840. (
6841.   DirectoryName("*Backup*")
6842.   or DirectoryName("*Bu")
6843.   or DirectoryName("* Bu *")
6844.   or DirectoryName("Bu *")
6845. 
6846.   or FileName("*.bak")
6847.   or FileName("* - Copy*")
6848. )
6849. # Backups end.
6850. 
6851. # NotBlobsArchivesBu
6852. ) )
6853. # NotBlobsArchivesBu end.
6854. 
6855. # Programs
6856. and (
6857. # SystemDir start.
6858. (
6859.   DirectoryName("Boot*")
6860.   or DirectoryName("Device*")
6861.   or DirectoryName("DevSupport*")
6862.   or DirectoryName("Program*")
6863.   or DirectoryName("Security*")
6864.   or DirectoryName("SendTo*")
6865.   or DirectoryName("Sw*")
6866.   or DirectoryName("System*")
6867.   or DirectoryName("Toolbars")
6868.   or DirectoryName("Windows*")
6869. )
6870. # SystemDir end.
6871. 
6872. # Programs
6873. )
6874. # Programs end.
6875. 
6876.                 and not(
6877.                      # Os Data Dynamic start.
6878. (
6879. # Os Data Dynamic start.
6880. (
6881.   FileName("*.dat*")
6882.   or FileName("*.db*")
6883.   or FileName("*.edb*")
6884.   or FileName("*.log*")
6885.   or FileName("DataStore.edb")
6886. )
6887. # Os Data Dynamic end.
6888. 
6889.   or 
6890. # Os PageHiberDump start.
6891. (
6892.   FileName("DataStore.edb")
6893.   or FileName("DUMP*.*")
6894.   or FileName("Hiberfil.sys")
6895.   or FileName("MEMORY.DMP")
6896.   or FileName("Pagefile.sys")
6897. )
6898. # Os PageHiberDump end.
6899. 
6900. # Os Data Dynamic
6901. )
6902. # Os Data Dynamic end.
6903. 
6904.                      or 
6905.                      DirectoryName("Windows*")
6906.                 )
6907. ')
6908. 
6909. 		# Zone Do Header
6910. 
6911. # Zone When Started
6912. 
6913. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
6914. # Display Set Zone
6915. 
6916. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
6917. SetVariable(FileStepDescription,	"")
6918. 
6919. SetVariable(ZoneStepByLine, 			"Zone started.
6920. ")
6921. 
6922. # BANNER SET
6923. 
6924. # DATE TIME RUN ELP
6925. 
6926. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
6927. /* Xinclude "..\Display\BannerSet.MyDc"X */
6928. /* pause(1) */
6929. 
6930. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6931. 
6932. Title('!Heading!')
6933. /* pause(1) */
6934. 
6935. /* NOTE: Can't round or truncate to integer precision. */
6936. 
6937. AppendLogfile("!LogFileName!", "!Title!")
6938. 
6939. 
6940. 
6941. pause(1)
6942. 
6943. 
6944. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
6945. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
6946. 
6947. SetVariable(ZoneStepNoCurrent, 0)
6948. 
6949. 
6950. # Zone Do Current Clear
6951. 
6952. SetVariable(ZoneTypeSelectCurrent, 		"")
6953. 
6954. SetVariable(ZoneBeginCurrent, 			0)
6955. SetVariable(ZoneBeginPerCurrent, 		0)
6956. SetVariable(ZoneEndCurrent, 			0)
6957. SetVariable(ZoneEndPerCurrent, 			0)
6958. 
6959. SetVariable(ZoneSizeCurrent,			0)
6960. SetVariable(ZoneSizePerCurrent,			0)
6961. 
6962. SetVariable(ZoneGapRequestedCurrent,	0)
6963. SetVariable(ZoneGapRoundedCurrent, 		0)
6964. SetVariable(ZoneGapAdjustedCurrent, 	0)
6965. SetVariable(ZoneGapAvailableCurrent, 	0)
6966. SetVariable(ZoneGapCurrent,				0)
6967. SetVariable(ZoneGapUsedCurrent, 		0)
6968. 
6969. SetVariable(ZoneGapActualCurrent, 		0)
6970. SetVariable(ZoneGapActualPerCurrent, 	0)
6971. 
6972. SetVariable(ZoneSizeActual, 			0)
6973. SetVariable(ZoneSizeActualCurrent,		0)
6974. 
6975. SetVariable(ZoneEndActual, 				0)
6976. SetVariable(ZoneEndActualCurrent,		0)			
6977. SetVariable(ZoneSizeActualPerCurrent, 	0)
6978.       
6979. SetVariable(ZoneFilesFolders,			0)
6980. SetVariable(ZoneFilesFoldersPer,		0) 
6981. 
6982. SetVariable(ZoneFragments,				0)
6983. SetVariable(ZoneFragmentsPer,			0) 
6984. 		
6985. SetVariable(ZoneEndActualCurrent, 		0)
6986. SetVariable(ZoneEndActualPerCurrent, 	0)
6987. 
6988. # Gap Calculation Methodology:
6989. 	# Requested
6990. 	SetVariable(GapRequested, 			0) 
6991. 	SetVariable(GapRequestedStd, 		0) 
6992. 	SetVariable(GapRequestedMft, 		0) 
6993. 	SetVariable(GapRequestedOs, 		0) 
6994. 	SetVariable(GapRequestedOriginal, 	0) 
6995. 	
6996. 	# Gap Adjustments
6997. 	SetVariable(GapRounded, 			0)
6998. 	# SetVariable(GapAdjusted, 			0)
6999. 	SetVariable(GapAvailable, 			0)
7000. 	SetVariable(GapCurrent, 			0)
7001. 	SetVariable(GapActual, 				0)
7002. 	SetVariable(GapUsed, 				0)
7003. 	
7004. 	# Gap Adjustments
7005. 	SetVariable(GapRoundedLoc, 			0)
7006. 	# SetVariable(GapAdjustedLoc, 		0)
7007. 	SetVariable(GapAvailableLoc, 		0)
7008. 	SetVariable(GapCurrentLoc, 			0)
7009. 	SetVariable(GapActualLoc,			0)
7010. 	SetVariable(GapUsedLoc,				0)
7011. 	
7012. 	# Space usage
7013. 	SetVariable(ZoneFreePerRequested, 	0)
7014. 	SetVariable(ZoneFreePerUsed, 		0)
7015. 
7016. # Gap Size & Rounding
7017. 	SetVariable(ZoneGapSizePer, 		0)
7018. 	SetVariable(ZoneVolRoundUpPer, 		0)
7019. 	
7020. 	# Free Space
7021. 	SetVariable(ZoneFreeUsedPer, 		0)
7022. 	SetVariable(ZoneFreeRequestedPer, 	0)
7023. 
7024. 
7025. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
7026. 
7027. # Footer:
7028. SetVariable(ZoneFooter, "----------------------------------------------------------
7029. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
7030. 
7031. Statistics Report:
7032. ------------------
7033.    Size:  
7034.    ------------------------
7035.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7036.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7037.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7038. 
7039.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7040.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7041. 
7042.    Location:
7043.    ------------------------
7044.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7045.              Files End: !ZoneEndCurrent!
7046.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7047.       
7048.    Gap Settings:
7049.    ------------------------
7050.          Gap Requested: !ZoneGapSizePer!%
7051.       Volume Rounding: !ZoneVolRoundUpPer!%
7052.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7053.                  
7054.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7055.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7056.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7057.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7058.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7059.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7060.      
7061.    Free Space after Zone:
7062.    ------------------------
7063.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7064.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7065.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7066. 
7067. Directory and Files Select:
7068. ---------------------------
7069. !ZoneTypeSelectCurrent!               
7070. ---------------------------
7071. ----------------------------------------------------------
7072. ")
7073. 
7074. # BANNER SET
7075. 
7076. # DATE TIME RUN ELP
7077. 
7078. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
7079. /* Xinclude "..\Display\BannerSet.MyDc"X */
7080. /* pause(1) */
7081. 
7082. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7083. 
7084. Title('!Heading!')
7085. /* pause(1) */
7086. 
7087. /* NOTE: Can't round or truncate to integer precision. */
7088. 
7089. AppendLogfile("!LogFileName!", "!Title!")
7090. 
7091. 
7092. 
7093. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
7094. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
7095. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:53")
7096. 
7097. SetVariable(ZoneListByLine, "!ZoneListByLine!
7098. Zone: !ZoneNoCurrent! 2021-11-09 10:47:53 0:00:05 !ZoneLabel! !ZoneDescription!")
7099. 
7100. 
7101. /* Fixed Zone Position Handling */
7102. /* Literal number: */
7103. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
7104. /* Percentage of disk: */
7105. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
7106. /* Gap */
7107. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
7108. 
7109. /* ---------------------------------------------------------- */
7110. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
7111. # FILE STEP
7112. 
7113. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7114. 
7115. /* add message and move to a new line. */
7116. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7117. ")
7118. 
7119. /* display the line. (hopefully.) */
7120. # Zone Footer Set Statistics Window Text
7121. 
7122. SetStatisticsWindowText("----------------------------------------------------------
7123. Zones Processed: 
7124. ----------------------------------------------------------
7125. !ZoneListByLine!
7126. ----------------------------------------------------------
7127. Zone Processing Step:
7128. !ZoneStepByLine!    
7129. ----------------------------------------------------------
7130. Current Zone:
7131. !ZoneFooter!
7132. ----------------------------------------------------------
7133. Volume Statistics:
7134. !VolumeStatisticsDetail!
7135. ----------------------------------------------------------
7136. Zone Detailed Report:
7137. ----------------------------------------------------------
7138. !ZoneStatisticsDetail!
7139. ----------------------------------------------------------
7140. ")
7141. 
7142. 
7143. 
7144. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7145. 
7146. # BANNER SET
7147. 
7148. # DATE TIME RUN ELP
7149. 
7150. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
7151. /* Xinclude "..\Display\BannerSet.MyDc"X */
7152. /* pause(1) */
7153. 
7154. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7155. 
7156. Title('!Heading!')
7157. /* pause(1) */
7158. 
7159. /* NOTE: Can't round or truncate to integer precision. */
7160. 
7161. pause(1)
7162. 
7163. # your stuff HERE (X)... pre file select code.
7164. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
7165. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
7166. 	# (X)
7167. 
7168. FileSelect
7169. 
7170. 	# your stuff can't really go here (errors.)
7171. 	# maybe for some reason I don't know of...
7172. 	
7173. 	# Actions next...
7174. 		# Programs start.
7175. # NotBlobsArchivesBu start.
7176. (not (
7177. # Blobs start.
7178. (
7179. # BlobsAndExceptions start.
7180. ( not(
7181.   FileName("*.bat")
7182.   or FileName("*.css")
7183.   or FileName("*.dll")
7184.   or FileName("*.exe")
7185.   or FileName("*.htm*")
7186.   or FileName("*.jar")
7187.   or FileName("*.js")
7188.   or FileName("*.script")
7189.   or FileName("*.wsf")
7190.   or (
7191. # Databases start.
7192. (
7193.   FileName("*.crypt*")
7194.   or FileName("*.db*")
7195.   or FileName("*.rdb*")
7196.   or FileName("*.dc*")
7197.   or FileName("*.dict*")
7198.   or FileName("*.?db*")
7199.   or FileName("*.?rdb*")
7200.   or FileName("*.md*")
7201.   or FileName("*.myd")
7202.   or FileName("*.ndf")
7203.   or FileName("*.ns?")
7204.   or FileName("*.pab")
7205.   or FileName("*.pst")
7206.   or FileName("*.sd?*")
7207.   or FileName("*.sq**")
7208.   or FileName("*.tmd")
7209.   or FileName("*.tps")
7210.   or FileName("*.tr*")
7211. )
7212. # Databases end.
7213. 
7214.     # BlobsAndExceptions
7215.     or 
7216. # Data start.
7217. (
7218.   DirectoryName("Data*")
7219.   or DirectoryName("Device*")
7220.   or DirectoryName("Export*")
7221.   or DirectoryName("Import*")
7222.   or DirectoryName("Log*")
7223.   or DirectoryName("*Log")
7224.   or DirectoryName("Maintenance*")
7225.   or DirectoryName("Rec*")
7226.   or DirectoryName("Sales*")
7227.   or DirectoryName("Search*")
7228.   or DirectoryName("User*")
7229. )
7230. # Data end.
7231. 
7232.     # BlobsAndExceptions
7233.   )
7234. ) )
7235. # BlobsAndExceptions end.
7236. 
7237. # Blobs
7238. ) and (
7239.   Size(BlobFileSize,0)
7240.   or (
7241.     FileName("*.arj")
7242.     or FileName("*.bup")
7243.     or FileName("*.bz2")
7244.     or FileName("*.chm")
7245.     or FileName("*.dvr-ms")
7246.     or FileName("*.gz")
7247.     or FileName("*.ifo")
7248.     or FileName("*.lzh")
7249.     or FileName("*.pdf")
7250.     or FileName("*.rpm")
7251.     or FileName("*.wmv")
7252.     or FileName("*.vob")
7253.     or FileName("*.z")
7254.   ) 
7255. )
7256. # Blobs end.
7257. 
7258. # NotBlobsArchivesBu
7259. or 
7260. # Archives start.
7261. (
7262.   DirectoryName("*Archive*")
7263.   or DirectoryName("*History*")
7264.   or DirectoryName("*Old")
7265.   or DirectoryName("* Old *")
7266.   or DirectoryName("Old *")
7267. 
7268.   or FileName("*.7z")
7269.   or FileName("*.cab")
7270.   or FileName("*.iso")
7271.   or FileName("*.msi")
7272.   or FileName("*.old")
7273.   or FileName("*.rar")
7274.   or FileName("*.tar")
7275.   or FileName("*.zip")
7276.   or
7277. # WinSysLow start.
7278. (
7279.   DirectoryName("$*")
7280.   or DirectoryName("0*")
7281.   or DirectoryName("1*")
7282.   or DirectoryName("2*")
7283.   or DirectoryName("3*")
7284.   or DirectoryName("4*")
7285.   or DirectoryName("5*")
7286.   or DirectoryName("6*")
7287.   or DirectoryName("7*")
7288.   or DirectoryName("8*")
7289.   or DirectoryName("9*")
7290. 
7291.   or DirectoryName("dllcache")
7292.   or DirectoryName("Downloaded Installations")
7293.   or DirectoryName("Ehome")
7294.   or DirectoryName("Fonts")
7295.   or DirectoryName("Help")
7296.   or DirectoryName("I386")
7297.   or DirectoryName("ie?updates")
7298.   or DirectoryName("Installer")
7299.   or DirectoryName("Installshield Installation Information")
7300.   or DirectoryName("IME")
7301.   or DirectoryName("*RECYCLE*")
7302.   or DirectoryName("ServicePackFiles")
7303.   or DirectoryName("SoftwareDistribution")
7304.   or DirectoryName("Speech")
7305.   or DirectoryName("Symbols")
7306.   or DirectoryName("System Volume Information")
7307.   or DirectoryName("windows.old")
7308. )
7309. # WinSysLow end.
7310. 
7311.   # Archives
7312. )
7313. # Archives end.
7314. 
7315. # NotBlobsArchivesBu
7316. or
7317. # Backups start.
7318. (
7319.   DirectoryName("*Backup*")
7320.   or DirectoryName("*Bu")
7321.   or DirectoryName("* Bu *")
7322.   or DirectoryName("Bu *")
7323. 
7324.   or FileName("*.bak")
7325.   or FileName("* - Copy*")
7326. )
7327. # Backups end.
7328. 
7329. # NotBlobsArchivesBu
7330. ) )
7331. # NotBlobsArchivesBu end.
7332. 
7333. # Programs
7334. and (
7335. # SystemDir start.
7336. (
7337.   DirectoryName("Boot*")
7338.   or DirectoryName("Device*")
7339.   or DirectoryName("DevSupport*")
7340.   or DirectoryName("Program*")
7341.   or DirectoryName("Security*")
7342.   or DirectoryName("SendTo*")
7343.   or DirectoryName("Sw*")
7344.   or DirectoryName("System*")
7345.   or DirectoryName("Toolbars")
7346.   or DirectoryName("Windows*")
7347. )
7348. # SystemDir end.
7349. 
7350. # Programs
7351. )
7352. # Programs end.
7353. 
7354. 		and not(
7355. 			# Os Data Dynamic start.
7356. (
7357. # Os Data Dynamic start.
7358. (
7359.   FileName("*.dat*")
7360.   or FileName("*.db*")
7361.   or FileName("*.edb*")
7362.   or FileName("*.log*")
7363.   or FileName("DataStore.edb")
7364. )
7365. # Os Data Dynamic end.
7366. 
7367.   or 
7368. # Os PageHiberDump start.
7369. (
7370.   FileName("DataStore.edb")
7371.   or FileName("DUMP*.*")
7372.   or FileName("Hiberfil.sys")
7373.   or FileName("MEMORY.DMP")
7374.   or FileName("Pagefile.sys")
7375. )
7376. # Os PageHiberDump end.
7377. 
7378. # Os Data Dynamic
7379. )
7380. # Os Data Dynamic end.
7381. 
7382. 			or 
7383. 				DirectoryName("Windows*")
7384. 		)
7385. 		FileActions
7386. 		  		/* ---------------------------------------------------------- */
7387. 	# Gap
7388. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
7389. 		# FILE STEP
7390. 
7391. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7392. 
7393. /* add message and move to a new line. */
7394. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7395. ")
7396. 
7397. /* display the line. (hopefully.) */
7398. # Zone Footer Set Statistics Window Text
7399. 
7400. SetStatisticsWindowText("----------------------------------------------------------
7401. Zones Processed: 
7402. ----------------------------------------------------------
7403. !ZoneListByLine!
7404. ----------------------------------------------------------
7405. Zone Processing Step:
7406. !ZoneStepByLine!    
7407. ----------------------------------------------------------
7408. Current Zone:
7409. !ZoneFooter!
7410. ----------------------------------------------------------
7411. Volume Statistics:
7412. !VolumeStatisticsDetail!
7413. ----------------------------------------------------------
7414. Zone Detailed Report:
7415. ----------------------------------------------------------
7416. !ZoneStatisticsDetail!
7417. ----------------------------------------------------------
7418. ")
7419. 
7420. 
7421. 
7422. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7423. 
7424. # BANNER SET
7425. 
7426. # DATE TIME RUN ELP
7427. 
7428. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
7429. /* Xinclude "..\Display\BannerSet.MyDc"X */
7430. /* pause(1) */
7431. 
7432. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7433. 
7434. Title('!Heading!')
7435. /* pause(1) */
7436. 
7437. /* NOTE: Can't round or truncate to integer precision. */
7438. 
7439. pause(1)
7440. 	
7441. 	# ACTUAL GAP
7442. 		/* AddGap Variant. */
7443. 	  	# Zone Do Gap
7444. # Gap Calculation Methods:
7445. 
7446. /* 1) Anything you need to add first. */
7447. /* empty */
7448. 
7449. /* ---------------------------------------------------------- */
7450. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
7451. 	# GapRequestedStd.
7452. 
7453. 		/* ---------------------------------------------------------- */
7454. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
7455. 
7456. 		# Gap Calculation Methods:
7457. 
7458. /* AddGap Variants */
7459. 
7460. 	/* Standard */
7461. 		# Gap Calculation Methods:
7462. 	/* AddGap Variants */
7463. 	/* Standard */
7464. 
7465. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
7466. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
7467. 
7468. 	SetVariable(GapRequested, GapRequestedStd)
7469. 	
7470. 
7471. 	/* MFT Low High Method */
7472. 		# Gap Calculation Methods:
7473. 	/* AddGap Variants */
7474. 	/* MFT Low High Method */
7475. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
7476. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
7477. 	SetVariable(GapRequested, GapRequestedMft)
7478. 	
7479. 
7480. 	/* OS Volume Type Method */
7481. 		# Gap Calculation Methods:
7482. 	/* AddGap Variants */
7483. 	/* OS Volume Type Method */
7484. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
7485. 	SetVariable(GapRequested, GapRequestedOs)
7486. 
7487. 
7488. 
7489. /* MakeGap Variants */
7490. 
7491. 	/* Original Os 1-3 + MFT 2 */
7492. 		# Gap Calculation Methods:
7493. 	/* MakeGap Variants */
7494. 	/* Original Os 1-3 + MFT 2 */
7495. 	/* plus MFT gap placed inline at the dividing zone. */
7496. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
7497. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
7498. 	SetVariable(GapRequested, GapRequestedOrig)
7499. 	
7500. 	
7501. /* Note: You could comment out the ones not in use */
7502. /* However having the data in the log is useful. */
7503. /* Therefore the following line is otherwise needed. */
7504. 
7505. /* Standard used */
7506. 
7507. SetVariable(GapRequested, GapRequestedStd)
7508. 
7509. # Gap Calculation Methods:
7510. 
7511. /* AddGap Variants */
7512. 	/* Standard */
7513. 	/* MFT Low High Method */
7514. 	/* OS Volume Type Method */
7515. 
7516. /* MakeGap Variants */
7517. 	/* Original Os 1-3 + MFT 2 */
7518. 
7519. /* Note: You could comment out the ones not in use */
7520. /* However having the data in the log is useful. */
7521. /* Therefore the following line is otherwise needed. */
7522. 
7523. /* Standard is used currently */
7524. 
7525. 
7526. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
7527. 
7528. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
7529. 
7530. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
7531. 
7532. /* ---------------------------------------------------------- */
7533. /* 3) SMALL ZONE ADJUSTMENT. */
7534. /* Gab cant be larger than half the Zone Size. */
7535. 
7536. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
7537. 	
7538. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
7539. 
7540. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
7541. 
7542. /* ---------------------------------------------------------- */
7543. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
7544. # Gap Adjustments.
7545. 
7546. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
7547. 	
7548. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
7549. 
7550. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
7551. 
7552. /* ---------------------------------------------------------- */
7553. # BYPASS THIS.
7554. 	/* This is definitely wrong. */
7555. 	/* The question is can we steal gap from the next zone */
7556. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
7557. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
7558. 		# Zone Overflow.
7559. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
7560. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
7561. 
7562. /* ---------------------------------------------------------- */
7563. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
7564. # Remaining free space available.
7565. 
7566. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
7567. 	
7568. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
7569. 
7570. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
7571. 
7572. /* ---------------------------------------------------------- */
7573. # CURRENT gap to use.
7574. 
7575. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
7576. 
7577. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
7578. 
7579. /* ---------------------------------------------------------- */
7580. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
7581. # Debugging.
7582. 
7583. 	SetVariable(GapUsed, GapCurrent) // for debugging
7584. 
7585. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
7586. 
7587. 		# Your code HERE
7588. 
7589. /* ---------------------------------------------------------- */
7590. /* 7) YOUR CODE. */
7591. # YOUR CODE HERE:
7592. 	# INPUT: GapCurrent or GapCurrentLoc
7593. 	# OUTPUT: GapUsed...
7594. 
7595. /* ---------------------------------------------------------- */
7596. # Gap Size.
7597. # Actual Size of Gap.
7598. 
7599. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
7600. 
7601. /* ---------------------------------------------------------- */
7602. /* xxxxxxxxxxxxxxxxxxxxxx */
7603. # ADD THE GAP
7604. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
7605. /* xxxxxxxxxxxxxxxxxxxxxx */
7606. 
7607. 	
7608. 	# Zone Statistics	
7609. 	# Zone / Volume Statistics and Display
7610. 		
7611. 	# Accumulate Totals
7612.   	# Volume totals
7613. 
7614. /* Current total space used (by Zones and Gaps) */
7615. 
7616. SetVariable(VolumeZoneUsed, GapUsed)
7617. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
7618. /* Percentage */
7619. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
7620. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
7621. 
7622. /* Current total of free space requested */
7623. 
7624. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
7625. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7626. /* Percent. */
7627. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
7628. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7629. 
7630. /* Current total of free space used */
7631. 
7632. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
7633. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
7634. /* Percent */
7635. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
7636. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
7637. 
7638. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
7639. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
7640. /* Xinclude "..\DebugDisplayPause.MyDc"X */
7641. 
7642. 
7643. 	# Current Values
7644. 	# Cluster, Sector, Block adjust for display.
7645. 	# Bytes per cluster is volume specific.
7646. 
7647. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
7648. 
7649. # Current Zone values.
7650. 	# Begin, end and size.
7651. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
7652. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
7653. 
7654. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
7655. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
7656. 
7657. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
7658. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
7659. 
7660. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
7661. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
7662. 
7663. 	SetVariable(ZoneFragments,				"!ZONE210N!")
7664. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
7665. 		
7666. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
7667. /* identical code to here: (separation not needed. TEST.) */	
7668. 
7669. # Current Gap, Actual and Free Values
7670. 	# Gap
7671. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
7672. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
7673. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
7674. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
7675. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
7676. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
7677. 	
7678. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
7679. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
7680. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
7681. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
7682. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
7683. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
7684. 	
7685. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
7686. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
7687. 	
7688. 	# Actual Size and End
7689. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
7690. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
7691. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
7692. 	
7693. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
7694. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
7695. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
7696. 
7697. # Gap Size & Rounding
7698. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
7699. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
7700. 	
7701. 	# Free Space
7702. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
7703. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
7704. 
7705. 	# Footer:
7706. SetVariable(ZoneFooter, "----------------------------------------------------------
7707. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
7708. 
7709. Statistics Report:
7710. ------------------
7711.    Size:  
7712.    ------------------------
7713.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7714.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7715.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7716. 
7717.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7718.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7719. 
7720.    Location:
7721.    ------------------------
7722.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7723.              Files End: !ZoneEndCurrent!
7724.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7725.       
7726.    Gap Settings:
7727.    ------------------------
7728.          Gap Requested: !ZoneGapSizePer!%
7729.       Volume Rounding: !ZoneVolRoundUpPer!%
7730.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7731.                  
7732.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7733.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7734.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7735.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7736.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7737.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7738.      
7739.    Free Space after Zone:
7740.    ------------------------
7741.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7742.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7743.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7744. 
7745. Directory and Files Select:
7746. ---------------------------
7747. !ZoneTypeSelectCurrent!               
7748. ---------------------------
7749. ----------------------------------------------------------
7750. ")
7751. 	# Zone Footer Set Statistics Window Text
7752. 
7753. SetStatisticsWindowText("----------------------------------------------------------
7754. Zones Processed: 
7755. ----------------------------------------------------------
7756. !ZoneListByLine!
7757. ----------------------------------------------------------
7758. Zone Processing Step:
7759. !ZoneStepByLine!    
7760. ----------------------------------------------------------
7761. Current Zone:
7762. !ZoneFooter!
7763. ----------------------------------------------------------
7764. Volume Statistics:
7765. !VolumeStatisticsDetail!
7766. ----------------------------------------------------------
7767. Zone Detailed Report:
7768. ----------------------------------------------------------
7769. !ZoneStatisticsDetail!
7770. ----------------------------------------------------------
7771. ")
7772. 
7773. 
7774. 	
7775.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
7776. 
7777. 	# Add Zone to list of zones for display.
7778. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
7779. 	# ??? Free Stats?
7780. 	# Footer:
7781. SetVariable(ZoneFooter, "----------------------------------------------------------
7782. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
7783. 
7784. Statistics Report:
7785. ------------------
7786.    Size:  
7787.    ------------------------
7788.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7789.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7790.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7791. 
7792.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7793.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7794. 
7795.    Location:
7796.    ------------------------
7797.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7798.              Files End: !ZoneEndCurrent!
7799.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7800.       
7801.    Gap Settings:
7802.    ------------------------
7803.          Gap Requested: !ZoneGapSizePer!%
7804.       Volume Rounding: !ZoneVolRoundUpPer!%
7805.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7806.                  
7807.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7808.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7809.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7810.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7811.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7812.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7813.      
7814.    Free Space after Zone:
7815.    ------------------------
7816.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7817.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7818.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7819. 
7820. Directory and Files Select:
7821. ---------------------------
7822. !ZoneTypeSelectCurrent!               
7823. ---------------------------
7824. ----------------------------------------------------------
7825. ")
7826. 
7827. 	# Add Zone Details to Report.	
7828. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
7829. !ZoneFooter!")
7830. 
7831. 
7832. 	
7833. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
7834. 			# FILE STEP
7835. 
7836. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7837. 
7838. /* add message and move to a new line. */
7839. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7840. ")
7841. 
7842. /* display the line. (hopefully.) */
7843. # Zone Footer Set Statistics Window Text
7844. 
7845. SetStatisticsWindowText("----------------------------------------------------------
7846. Zones Processed: 
7847. ----------------------------------------------------------
7848. !ZoneListByLine!
7849. ----------------------------------------------------------
7850. Zone Processing Step:
7851. !ZoneStepByLine!    
7852. ----------------------------------------------------------
7853. Current Zone:
7854. !ZoneFooter!
7855. ----------------------------------------------------------
7856. Volume Statistics:
7857. !VolumeStatisticsDetail!
7858. ----------------------------------------------------------
7859. Zone Detailed Report:
7860. ----------------------------------------------------------
7861. !ZoneStatisticsDetail!
7862. ----------------------------------------------------------
7863. ")
7864. 
7865. 
7866. 
7867. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7868. 
7869. # BANNER SET
7870. 
7871. # DATE TIME RUN ELP
7872. 
7873. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
7874. /* Xinclude "..\Display\BannerSet.MyDc"X */
7875. /* pause(1) */
7876. 
7877. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7878. 
7879. Title('!Heading!')
7880. /* pause(1) */
7881. 
7882. /* NOTE: Can't round or truncate to integer precision. */
7883. 
7884. pause(1)
7885. 
7886. 				SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
7887. 
7888. 	
7889. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
7890. 			# FILE STEP
7891. 
7892. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7893. 
7894. /* add message and move to a new line. */
7895. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7896. ")
7897. 
7898. /* display the line. (hopefully.) */
7899. # Zone Footer Set Statistics Window Text
7900. 
7901. SetStatisticsWindowText("----------------------------------------------------------
7902. Zones Processed: 
7903. ----------------------------------------------------------
7904. !ZoneListByLine!
7905. ----------------------------------------------------------
7906. Zone Processing Step:
7907. !ZoneStepByLine!    
7908. ----------------------------------------------------------
7909. Current Zone:
7910. !ZoneFooter!
7911. ----------------------------------------------------------
7912. Volume Statistics:
7913. !VolumeStatisticsDetail!
7914. ----------------------------------------------------------
7915. Zone Detailed Report:
7916. ----------------------------------------------------------
7917. !ZoneStatisticsDetail!
7918. ----------------------------------------------------------
7919. ")
7920. 
7921. 
7922. 
7923. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7924. 
7925. # BANNER SET
7926. 
7927. # DATE TIME RUN ELP
7928. 
7929. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
7930. /* Xinclude "..\Display\BannerSet.MyDc"X */
7931. /* pause(1) */
7932. 
7933. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7934. 
7935. Title('!Heading!')
7936. /* pause(1) */
7937. 
7938. /* NOTE: Can't round or truncate to integer precision. */
7939. 
7940. pause(1)
7941. 
7942. 		# Zone Do Footer
7943. 
7944. /* ---------------------------------------------------------- */
7945. # File Select
7946. 	# Select Statments
7947. # File Actions 
7948. 	# Standard or OS File Actions.
7949. 	# Resume...
7950. 	
7951. 	# your stuff HERE (X)... post zone (file) file actions code.
7952. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
7953. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
7954. 		# (X)
7955. 		
7956. 		/* ??? Set window? */
7957. 	
7958. 	# ADD THE GAP
7959. 		
7960. # Vacate (good for diagnostics)
7961. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
7962. 
7963. # DoNotVacate - DO NOT Vacate (recommended)
7964. 
7965. # Vacate
7966. /* AddGap(GapUsedLoc) */
7967. 
7968. # DO Not Vacate
7969. AddGap(GapUsedLoc, DoNotVacate) 
7970. 	
7971. 	
7972. /* ---------------------------------------------------------- */
7973. # (failed) TEST for boolean logic.
7974. 
7975. /* It should work in the gap calculations for turning options */
7976. /* on and off but it will NOT work here. */
7977. 
7978. /* Boolean setting X or FlagX. */
7979. /* Where X will be on or off: */
7980. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
7981. /*      For ON:  (X  *  FlagAny) */
7982. 
7983. /* 1) Failed, zero gap overrode the previous one. */
7984. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
7985. /* AddGap(GapUsedTemp) */ 
7986. 
7987. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
7988. /* AddGap(GapUsedTemp, DoNotVacate) */ 
7989. 
7990. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
7991. 
7992. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
7993. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
7994. /* AddGap(GapUsedTemp) */ 
7995. 
7996. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
7997. /* AddGap(GapUsedTemp, DoNotVacate) */ 
7998. 
7999. /* ---------------------------------------------------------- */
8000. 
8001. # Vacate
8002. /* AddGap(GapUsed) */
8003. 
8004. # DO NOT Vacate (recommended)
8005. /* AddGap(GapUsed, DoNotVacate) */ 
8006. 	
8007. 
8008. 		
8009. # 
8010. FileEnd
8011. /* ---------------------------------------------------------- */
8012. 
8013. # your stuff HERE (X)... post zone (file) code.
8014. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
8015. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8016. 	# (X)
8017. 
8018. SetVariable(FileStepDescription,"Zone finished, reporting.")
8019. # FILE STEP
8020. 
8021. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8022. 
8023. /* add message and move to a new line. */
8024. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8025. ")
8026. 
8027. /* display the line. (hopefully.) */
8028. # Zone Footer Set Statistics Window Text
8029. 
8030. SetStatisticsWindowText("----------------------------------------------------------
8031. Zones Processed: 
8032. ----------------------------------------------------------
8033. !ZoneListByLine!
8034. ----------------------------------------------------------
8035. Zone Processing Step:
8036. !ZoneStepByLine!    
8037. ----------------------------------------------------------
8038. Current Zone:
8039. !ZoneFooter!
8040. ----------------------------------------------------------
8041. Volume Statistics:
8042. !VolumeStatisticsDetail!
8043. ----------------------------------------------------------
8044. Zone Detailed Report:
8045. ----------------------------------------------------------
8046. !ZoneStatisticsDetail!
8047. ----------------------------------------------------------
8048. ")
8049. 
8050. 
8051. 
8052. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8053. 
8054. # BANNER SET
8055. 
8056. # DATE TIME RUN ELP
8057. 
8058. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
8059. /* Xinclude "..\Display\BannerSet.MyDc"X */
8060. /* pause(1) */
8061. 
8062. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8063. 
8064. Title('!Heading!')
8065. /* pause(1) */
8066. 
8067. /* NOTE: Can't round or truncate to integer precision. */
8068. 
8069. pause(1)
8070. 
8071. # Zone When Finished
8072. 
8073. # BANNER SET
8074. 
8075. # DATE TIME RUN ELP
8076. 
8077. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
8078. /* Xinclude "..\Display\BannerSet.MyDc"X */
8079. /* pause(1) */
8080. 
8081. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8082. 
8083. Title('!Heading!')
8084. /* pause(1) */
8085. 
8086. /* NOTE: Can't round or truncate to integer precision. */
8087. 
8088. AppendLogfile("!LogFileName!", "!Title!")
8089. 
8090. 
8091. 
8092. # Zone Statistics	
8093. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
8094. 
8095. # Footer:
8096. SetVariable(ZoneFooter, "----------------------------------------------------------
8097. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
8098. 
8099. Statistics Report:
8100. ------------------
8101.    Size:  
8102.    ------------------------
8103.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8104.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8105.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8106. 
8107.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8108.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8109. 
8110.    Location:
8111.    ------------------------
8112.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8113.              Files End: !ZoneEndCurrent!
8114.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8115.       
8116.    Gap Settings:
8117.    ------------------------
8118.          Gap Requested: !ZoneGapSizePer!%
8119.       Volume Rounding: !ZoneVolRoundUpPer!%
8120.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8121.                  
8122.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
8123.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
8124.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
8125.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
8126.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
8127.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
8128.      
8129.    Free Space after Zone:
8130.    ------------------------
8131.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8132.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8133.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8134. 
8135. Directory and Files Select:
8136. ---------------------------
8137. !ZoneTypeSelectCurrent!               
8138. ---------------------------
8139. ----------------------------------------------------------
8140. ")
8141. 
8142. AppendLogfile("!LogFileName!", ".")
8143. AppendLogfile("!LogFileName!", "!ZoneFooter!")
8144. AppendLogfile("!LogFileName!", ".")
8145. 
8146. # Zone Footer Set Statistics Window Text
8147. 
8148. SetStatisticsWindowText("----------------------------------------------------------
8149. Zones Processed: 
8150. ----------------------------------------------------------
8151. !ZoneListByLine!
8152. ----------------------------------------------------------
8153. Zone Processing Step:
8154. !ZoneStepByLine!    
8155. ----------------------------------------------------------
8156. Current Zone:
8157. !ZoneFooter!
8158. ----------------------------------------------------------
8159. Volume Statistics:
8160. !VolumeStatisticsDetail!
8161. ----------------------------------------------------------
8162. Zone Detailed Report:
8163. ----------------------------------------------------------
8164. !ZoneStatisticsDetail!
8165. ----------------------------------------------------------
8166. ")
8167. 
8168. 
8169. 
8170. /* pause() */
8171. /* pause() */
8172. 
8173. 
8174. 
8175. 	
8176. /* ---------------------------------------------------------- */
8177. # Zone Programs Fixed size just Windows.
8178. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsWindows!")
8179. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsWindows!")
8180. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
8181. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
8182. 	SetVariable(ZoneTypeSelect,'
8183.                 # Programs - Windows folder.
8184.                 not(
8185.                 # Os Data Dynamic start.
8186. (
8187. # Os Data Dynamic start.
8188. (
8189.   FileName("*.dat*")
8190.   or FileName("*.db*")
8191.   or FileName("*.edb*")
8192.   or FileName("*.log*")
8193.   or FileName("DataStore.edb")
8194. )
8195. # Os Data Dynamic end.
8196. 
8197.   or 
8198. # Os PageHiberDump start.
8199. (
8200.   FileName("DataStore.edb")
8201.   or FileName("DUMP*.*")
8202.   or FileName("Hiberfil.sys")
8203.   or FileName("MEMORY.DMP")
8204.   or FileName("Pagefile.sys")
8205. )
8206. # Os PageHiberDump end.
8207. 
8208. # Os Data Dynamic
8209. )
8210. # Os Data Dynamic end.
8211. 
8212.                 )
8213. ')
8214. 
8215. 		# Zone Do Header
8216. 
8217. # Zone When Started
8218. 
8219. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
8220. # Display Set Zone
8221. 
8222. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
8223. SetVariable(FileStepDescription,	"")
8224. 
8225. SetVariable(ZoneStepByLine, 			"Zone started.
8226. ")
8227. 
8228. # BANNER SET
8229. 
8230. # DATE TIME RUN ELP
8231. 
8232. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
8233. /* Xinclude "..\Display\BannerSet.MyDc"X */
8234. /* pause(1) */
8235. 
8236. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8237. 
8238. Title('!Heading!')
8239. /* pause(1) */
8240. 
8241. /* NOTE: Can't round or truncate to integer precision. */
8242. 
8243. AppendLogfile("!LogFileName!", "!Title!")
8244. 
8245. 
8246. 
8247. pause(1)
8248. 
8249. 
8250. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
8251. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
8252. 
8253. SetVariable(ZoneStepNoCurrent, 0)
8254. 
8255. 
8256. # Zone Do Current Clear
8257. 
8258. SetVariable(ZoneTypeSelectCurrent, 		"")
8259. 
8260. SetVariable(ZoneBeginCurrent, 			0)
8261. SetVariable(ZoneBeginPerCurrent, 		0)
8262. SetVariable(ZoneEndCurrent, 			0)
8263. SetVariable(ZoneEndPerCurrent, 			0)
8264. 
8265. SetVariable(ZoneSizeCurrent,			0)
8266. SetVariable(ZoneSizePerCurrent,			0)
8267. 
8268. SetVariable(ZoneGapRequestedCurrent,	0)
8269. SetVariable(ZoneGapRoundedCurrent, 		0)
8270. SetVariable(ZoneGapAdjustedCurrent, 	0)
8271. SetVariable(ZoneGapAvailableCurrent, 	0)
8272. SetVariable(ZoneGapCurrent,				0)
8273. SetVariable(ZoneGapUsedCurrent, 		0)
8274. 
8275. SetVariable(ZoneGapActualCurrent, 		0)
8276. SetVariable(ZoneGapActualPerCurrent, 	0)
8277. 
8278. SetVariable(ZoneSizeActual, 			0)
8279. SetVariable(ZoneSizeActualCurrent,		0)
8280. 
8281. SetVariable(ZoneEndActual, 				0)
8282. SetVariable(ZoneEndActualCurrent,		0)			
8283. SetVariable(ZoneSizeActualPerCurrent, 	0)
8284.       
8285. SetVariable(ZoneFilesFolders,			0)
8286. SetVariable(ZoneFilesFoldersPer,		0) 
8287. 
8288. SetVariable(ZoneFragments,				0)
8289. SetVariable(ZoneFragmentsPer,			0) 
8290. 		
8291. SetVariable(ZoneEndActualCurrent, 		0)
8292. SetVariable(ZoneEndActualPerCurrent, 	0)
8293. 
8294. # Gap Calculation Methodology:
8295. 	# Requested
8296. 	SetVariable(GapRequested, 			0) 
8297. 	SetVariable(GapRequestedStd, 		0) 
8298. 	SetVariable(GapRequestedMft, 		0) 
8299. 	SetVariable(GapRequestedOs, 		0) 
8300. 	SetVariable(GapRequestedOriginal, 	0) 
8301. 	
8302. 	# Gap Adjustments
8303. 	SetVariable(GapRounded, 			0)
8304. 	# SetVariable(GapAdjusted, 			0)
8305. 	SetVariable(GapAvailable, 			0)
8306. 	SetVariable(GapCurrent, 			0)
8307. 	SetVariable(GapActual, 				0)
8308. 	SetVariable(GapUsed, 				0)
8309. 	
8310. 	# Gap Adjustments
8311. 	SetVariable(GapRoundedLoc, 			0)
8312. 	# SetVariable(GapAdjustedLoc, 		0)
8313. 	SetVariable(GapAvailableLoc, 		0)
8314. 	SetVariable(GapCurrentLoc, 			0)
8315. 	SetVariable(GapActualLoc,			0)
8316. 	SetVariable(GapUsedLoc,				0)
8317. 	
8318. 	# Space usage
8319. 	SetVariable(ZoneFreePerRequested, 	0)
8320. 	SetVariable(ZoneFreePerUsed, 		0)
8321. 
8322. # Gap Size & Rounding
8323. 	SetVariable(ZoneGapSizePer, 		0)
8324. 	SetVariable(ZoneVolRoundUpPer, 		0)
8325. 	
8326. 	# Free Space
8327. 	SetVariable(ZoneFreeUsedPer, 		0)
8328. 	SetVariable(ZoneFreeRequestedPer, 	0)
8329. 
8330. 
8331. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
8332. 
8333. # Footer:
8334. SetVariable(ZoneFooter, "----------------------------------------------------------
8335. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
8336. 
8337. Statistics Report:
8338. ------------------
8339.    Size:  
8340.    ------------------------
8341.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8342.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8343.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8344. 
8345.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8346.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8347. 
8348.    Location:
8349.    ------------------------
8350.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8351.              Files End: !ZoneEndCurrent!
8352.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8353.       
8354.    Gap Settings:
8355.    ------------------------
8356.          Gap Requested: !ZoneGapSizePer!%
8357.       Volume Rounding: !ZoneVolRoundUpPer!%
8358.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8359.                  
8360.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
8361.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
8362.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
8363.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
8364.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
8365.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
8366.      
8367.    Free Space after Zone:
8368.    ------------------------
8369.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8370.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8371.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8372. 
8373. Directory and Files Select:
8374. ---------------------------
8375. !ZoneTypeSelectCurrent!               
8376. ---------------------------
8377. ----------------------------------------------------------
8378. ")
8379. 
8380. # BANNER SET
8381. 
8382. # DATE TIME RUN ELP
8383. 
8384. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
8385. /* Xinclude "..\Display\BannerSet.MyDc"X */
8386. /* pause(1) */
8387. 
8388. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8389. 
8390. Title('!Heading!')
8391. /* pause(1) */
8392. 
8393. /* NOTE: Can't round or truncate to integer precision. */
8394. 
8395. AppendLogfile("!LogFileName!", "!Title!")
8396. 
8397. 
8398. 
8399. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
8400. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
8401. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:53")
8402. 
8403. SetVariable(ZoneListByLine, "!ZoneListByLine!
8404. Zone: !ZoneNoCurrent! 2021-11-09 10:47:53 0:00:05 !ZoneLabel! !ZoneDescription!")
8405. 
8406. 
8407. /* Fixed Zone Position Handling */
8408. /* Literal number: */
8409. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
8410. /* Percentage of disk: */
8411. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
8412. /* Gap */
8413. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
8414. 
8415. /* ---------------------------------------------------------- */
8416. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
8417. # FILE STEP
8418. 
8419. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8420. 
8421. /* add message and move to a new line. */
8422. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8423. ")
8424. 
8425. /* display the line. (hopefully.) */
8426. # Zone Footer Set Statistics Window Text
8427. 
8428. SetStatisticsWindowText("----------------------------------------------------------
8429. Zones Processed: 
8430. ----------------------------------------------------------
8431. !ZoneListByLine!
8432. ----------------------------------------------------------
8433. Zone Processing Step:
8434. !ZoneStepByLine!    
8435. ----------------------------------------------------------
8436. Current Zone:
8437. !ZoneFooter!
8438. ----------------------------------------------------------
8439. Volume Statistics:
8440. !VolumeStatisticsDetail!
8441. ----------------------------------------------------------
8442. Zone Detailed Report:
8443. ----------------------------------------------------------
8444. !ZoneStatisticsDetail!
8445. ----------------------------------------------------------
8446. ")
8447. 
8448. 
8449. 
8450. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8451. 
8452. # BANNER SET
8453. 
8454. # DATE TIME RUN ELP
8455. 
8456. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
8457. /* Xinclude "..\Display\BannerSet.MyDc"X */
8458. /* pause(1) */
8459. 
8460. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8461. 
8462. Title('!Heading!')
8463. /* pause(1) */
8464. 
8465. /* NOTE: Can't round or truncate to integer precision. */
8466. 
8467. pause(1)
8468. 
8469. # your stuff HERE (X)... pre file select code.
8470. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
8471. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8472. 	# (X)
8473. 
8474. FileSelect
8475. 
8476. 	# your stuff can't really go here (errors.)
8477. 	# maybe for some reason I don't know of...
8478. 	
8479. 	# Actions next...
8480. 		# Programs start.
8481. # NotBlobsArchivesBu start.
8482. (not (
8483. # Blobs start.
8484. (
8485. # BlobsAndExceptions start.
8486. ( not(
8487.   FileName("*.bat")
8488.   or FileName("*.css")
8489.   or FileName("*.dll")
8490.   or FileName("*.exe")
8491.   or FileName("*.htm*")
8492.   or FileName("*.jar")
8493.   or FileName("*.js")
8494.   or FileName("*.script")
8495.   or FileName("*.wsf")
8496.   or (
8497. # Databases start.
8498. (
8499.   FileName("*.crypt*")
8500.   or FileName("*.db*")
8501.   or FileName("*.rdb*")
8502.   or FileName("*.dc*")
8503.   or FileName("*.dict*")
8504.   or FileName("*.?db*")
8505.   or FileName("*.?rdb*")
8506.   or FileName("*.md*")
8507.   or FileName("*.myd")
8508.   or FileName("*.ndf")
8509.   or FileName("*.ns?")
8510.   or FileName("*.pab")
8511.   or FileName("*.pst")
8512.   or FileName("*.sd?*")
8513.   or FileName("*.sq**")
8514.   or FileName("*.tmd")
8515.   or FileName("*.tps")
8516.   or FileName("*.tr*")
8517. )
8518. # Databases end.
8519. 
8520.     # BlobsAndExceptions
8521.     or 
8522. # Data start.
8523. (
8524.   DirectoryName("Data*")
8525.   or DirectoryName("Device*")
8526.   or DirectoryName("Export*")
8527.   or DirectoryName("Import*")
8528.   or DirectoryName("Log*")
8529.   or DirectoryName("*Log")
8530.   or DirectoryName("Maintenance*")
8531.   or DirectoryName("Rec*")
8532.   or DirectoryName("Sales*")
8533.   or DirectoryName("Search*")
8534.   or DirectoryName("User*")
8535. )
8536. # Data end.
8537. 
8538.     # BlobsAndExceptions
8539.   )
8540. ) )
8541. # BlobsAndExceptions end.
8542. 
8543. # Blobs
8544. ) and (
8545.   Size(BlobFileSize,0)
8546.   or (
8547.     FileName("*.arj")
8548.     or FileName("*.bup")
8549.     or FileName("*.bz2")
8550.     or FileName("*.chm")
8551.     or FileName("*.dvr-ms")
8552.     or FileName("*.gz")
8553.     or FileName("*.ifo")
8554.     or FileName("*.lzh")
8555.     or FileName("*.pdf")
8556.     or FileName("*.rpm")
8557.     or FileName("*.wmv")
8558.     or FileName("*.vob")
8559.     or FileName("*.z")
8560.   ) 
8561. )
8562. # Blobs end.
8563. 
8564. # NotBlobsArchivesBu
8565. or 
8566. # Archives start.
8567. (
8568.   DirectoryName("*Archive*")
8569.   or DirectoryName("*History*")
8570.   or DirectoryName("*Old")
8571.   or DirectoryName("* Old *")
8572.   or DirectoryName("Old *")
8573. 
8574.   or FileName("*.7z")
8575.   or FileName("*.cab")
8576.   or FileName("*.iso")
8577.   or FileName("*.msi")
8578.   or FileName("*.old")
8579.   or FileName("*.rar")
8580.   or FileName("*.tar")
8581.   or FileName("*.zip")
8582.   or
8583. # WinSysLow start.
8584. (
8585.   DirectoryName("$*")
8586.   or DirectoryName("0*")
8587.   or DirectoryName("1*")
8588.   or DirectoryName("2*")
8589.   or DirectoryName("3*")
8590.   or DirectoryName("4*")
8591.   or DirectoryName("5*")
8592.   or DirectoryName("6*")
8593.   or DirectoryName("7*")
8594.   or DirectoryName("8*")
8595.   or DirectoryName("9*")
8596. 
8597.   or DirectoryName("dllcache")
8598.   or DirectoryName("Downloaded Installations")
8599.   or DirectoryName("Ehome")
8600.   or DirectoryName("Fonts")
8601.   or DirectoryName("Help")
8602.   or DirectoryName("I386")
8603.   or DirectoryName("ie?updates")
8604.   or DirectoryName("Installer")
8605.   or DirectoryName("Installshield Installation Information")
8606.   or DirectoryName("IME")
8607.   or DirectoryName("*RECYCLE*")
8608.   or DirectoryName("ServicePackFiles")
8609.   or DirectoryName("SoftwareDistribution")
8610.   or DirectoryName("Speech")
8611.   or DirectoryName("Symbols")
8612.   or DirectoryName("System Volume Information")
8613.   or DirectoryName("windows.old")
8614. )
8615. # WinSysLow end.
8616. 
8617.   # Archives
8618. )
8619. # Archives end.
8620. 
8621. # NotBlobsArchivesBu
8622. or
8623. # Backups start.
8624. (
8625.   DirectoryName("*Backup*")
8626.   or DirectoryName("*Bu")
8627.   or DirectoryName("* Bu *")
8628.   or DirectoryName("Bu *")
8629. 
8630.   or FileName("*.bak")
8631.   or FileName("* - Copy*")
8632. )
8633. # Backups end.
8634. 
8635. # NotBlobsArchivesBu
8636. ) )
8637. # NotBlobsArchivesBu end.
8638. 
8639. # Programs
8640. and (
8641. # SystemDir start.
8642. (
8643.   DirectoryName("Boot*")
8644.   or DirectoryName("Device*")
8645.   or DirectoryName("DevSupport*")
8646.   or DirectoryName("Program*")
8647.   or DirectoryName("Security*")
8648.   or DirectoryName("SendTo*")
8649.   or DirectoryName("Sw*")
8650.   or DirectoryName("System*")
8651.   or DirectoryName("Toolbars")
8652.   or DirectoryName("Windows*")
8653. )
8654. # SystemDir end.
8655. 
8656. # Programs
8657. )
8658. # Programs end.
8659. 
8660. 		and not(
8661. 			# Os Data Dynamic start.
8662. (
8663. # Os Data Dynamic start.
8664. (
8665.   FileName("*.dat*")
8666.   or FileName("*.db*")
8667.   or FileName("*.edb*")
8668.   or FileName("*.log*")
8669.   or FileName("DataStore.edb")
8670. )
8671. # Os Data Dynamic end.
8672. 
8673.   or 
8674. # Os PageHiberDump start.
8675. (
8676.   FileName("DataStore.edb")
8677.   or FileName("DUMP*.*")
8678.   or FileName("Hiberfil.sys")
8679.   or FileName("MEMORY.DMP")
8680.   or FileName("Pagefile.sys")
8681. )
8682. # Os PageHiberDump end.
8683. 
8684. # Os Data Dynamic
8685. )
8686. # Os Data Dynamic end.
8687. 
8688. 		)
8689. 		FileActions
8690. 		  		/* ---------------------------------------------------------- */
8691. 	# Gap
8692. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
8693. 		# FILE STEP
8694. 
8695. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8696. 
8697. /* add message and move to a new line. */
8698. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8699. ")
8700. 
8701. /* display the line. (hopefully.) */
8702. # Zone Footer Set Statistics Window Text
8703. 
8704. SetStatisticsWindowText("----------------------------------------------------------
8705. Zones Processed: 
8706. ----------------------------------------------------------
8707. !ZoneListByLine!
8708. ----------------------------------------------------------
8709. Zone Processing Step:
8710. !ZoneStepByLine!    
8711. ----------------------------------------------------------
8712. Current Zone:
8713. !ZoneFooter!
8714. ----------------------------------------------------------
8715. Volume Statistics:
8716. !VolumeStatisticsDetail!
8717. ----------------------------------------------------------
8718. Zone Detailed Report:
8719. ----------------------------------------------------------
8720. !ZoneStatisticsDetail!
8721. ----------------------------------------------------------
8722. ")
8723. 
8724. 
8725. 
8726. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8727. 
8728. # BANNER SET
8729. 
8730. # DATE TIME RUN ELP
8731. 
8732. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
8733. /* Xinclude "..\Display\BannerSet.MyDc"X */
8734. /* pause(1) */
8735. 
8736. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8737. 
8738. Title('!Heading!')
8739. /* pause(1) */
8740. 
8741. /* NOTE: Can't round or truncate to integer precision. */
8742. 
8743. pause(1)
8744. 	
8745. 	# ACTUAL GAP
8746. 		/* AddGap Variant. */
8747. 	  	# Zone Do Gap
8748. # Gap Calculation Methods:
8749. 
8750. /* 1) Anything you need to add first. */
8751. /* empty */
8752. 
8753. /* ---------------------------------------------------------- */
8754. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
8755. 	# GapRequestedStd.
8756. 
8757. 		/* ---------------------------------------------------------- */
8758. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
8759. 
8760. 		# Gap Calculation Methods:
8761. 
8762. /* AddGap Variants */
8763. 
8764. 	/* Standard */
8765. 		# Gap Calculation Methods:
8766. 	/* AddGap Variants */
8767. 	/* Standard */
8768. 
8769. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
8770. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
8771. 
8772. 	SetVariable(GapRequested, GapRequestedStd)
8773. 	
8774. 
8775. 	/* MFT Low High Method */
8776. 		# Gap Calculation Methods:
8777. 	/* AddGap Variants */
8778. 	/* MFT Low High Method */
8779. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
8780. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
8781. 	SetVariable(GapRequested, GapRequestedMft)
8782. 	
8783. 
8784. 	/* OS Volume Type Method */
8785. 		# Gap Calculation Methods:
8786. 	/* AddGap Variants */
8787. 	/* OS Volume Type Method */
8788. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
8789. 	SetVariable(GapRequested, GapRequestedOs)
8790. 
8791. 
8792. 
8793. /* MakeGap Variants */
8794. 
8795. 	/* Original Os 1-3 + MFT 2 */
8796. 		# Gap Calculation Methods:
8797. 	/* MakeGap Variants */
8798. 	/* Original Os 1-3 + MFT 2 */
8799. 	/* plus MFT gap placed inline at the dividing zone. */
8800. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
8801. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
8802. 	SetVariable(GapRequested, GapRequestedOrig)
8803. 	
8804. 	
8805. /* Note: You could comment out the ones not in use */
8806. /* However having the data in the log is useful. */
8807. /* Therefore the following line is otherwise needed. */
8808. 
8809. /* Standard used */
8810. 
8811. SetVariable(GapRequested, GapRequestedStd)
8812. 
8813. # Gap Calculation Methods:
8814. 
8815. /* AddGap Variants */
8816. 	/* Standard */
8817. 	/* MFT Low High Method */
8818. 	/* OS Volume Type Method */
8819. 
8820. /* MakeGap Variants */
8821. 	/* Original Os 1-3 + MFT 2 */
8822. 
8823. /* Note: You could comment out the ones not in use */
8824. /* However having the data in the log is useful. */
8825. /* Therefore the following line is otherwise needed. */
8826. 
8827. /* Standard is used currently */
8828. 
8829. 
8830. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
8831. 
8832. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
8833. 
8834. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
8835. 
8836. /* ---------------------------------------------------------- */
8837. /* 3) SMALL ZONE ADJUSTMENT. */
8838. /* Gab cant be larger than half the Zone Size. */
8839. 
8840. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
8841. 	
8842. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
8843. 
8844. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
8845. 
8846. /* ---------------------------------------------------------- */
8847. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
8848. # Gap Adjustments.
8849. 
8850. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
8851. 	
8852. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
8853. 
8854. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
8855. 
8856. /* ---------------------------------------------------------- */
8857. # BYPASS THIS.
8858. 	/* This is definitely wrong. */
8859. 	/* The question is can we steal gap from the next zone */
8860. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
8861. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
8862. 		# Zone Overflow.
8863. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
8864. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
8865. 
8866. /* ---------------------------------------------------------- */
8867. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
8868. # Remaining free space available.
8869. 
8870. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
8871. 	
8872. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
8873. 
8874. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
8875. 
8876. /* ---------------------------------------------------------- */
8877. # CURRENT gap to use.
8878. 
8879. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
8880. 
8881. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
8882. 
8883. /* ---------------------------------------------------------- */
8884. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
8885. # Debugging.
8886. 
8887. 	SetVariable(GapUsed, GapCurrent) // for debugging
8888. 
8889. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
8890. 
8891. 		# Your code HERE
8892. 
8893. /* ---------------------------------------------------------- */
8894. /* 7) YOUR CODE. */
8895. # YOUR CODE HERE:
8896. 	# INPUT: GapCurrent or GapCurrentLoc
8897. 	# OUTPUT: GapUsed...
8898. 
8899. /* ---------------------------------------------------------- */
8900. # Gap Size.
8901. # Actual Size of Gap.
8902. 
8903. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
8904. 
8905. /* ---------------------------------------------------------- */
8906. /* xxxxxxxxxxxxxxxxxxxxxx */
8907. # ADD THE GAP
8908. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
8909. /* xxxxxxxxxxxxxxxxxxxxxx */
8910. 
8911. 	
8912. 	# Zone Statistics	
8913. 	# Zone / Volume Statistics and Display
8914. 		
8915. 	# Accumulate Totals
8916.   	# Volume totals
8917. 
8918. /* Current total space used (by Zones and Gaps) */
8919. 
8920. SetVariable(VolumeZoneUsed, GapUsed)
8921. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
8922. /* Percentage */
8923. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
8924. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
8925. 
8926. /* Current total of free space requested */
8927. 
8928. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
8929. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
8930. /* Percent. */
8931. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
8932. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
8933. 
8934. /* Current total of free space used */
8935. 
8936. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
8937. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
8938. /* Percent */
8939. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
8940. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
8941. 
8942. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
8943. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
8944. /* Xinclude "..\DebugDisplayPause.MyDc"X */
8945. 
8946. 
8947. 	# Current Values
8948. 	# Cluster, Sector, Block adjust for display.
8949. 	# Bytes per cluster is volume specific.
8950. 
8951. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
8952. 
8953. # Current Zone values.
8954. 	# Begin, end and size.
8955. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
8956. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
8957. 
8958. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
8959. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
8960. 
8961. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
8962. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
8963. 
8964. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
8965. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
8966. 
8967. 	SetVariable(ZoneFragments,				"!ZONE210N!")
8968. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
8969. 		
8970. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
8971. /* identical code to here: (separation not needed. TEST.) */	
8972. 
8973. # Current Gap, Actual and Free Values
8974. 	# Gap
8975. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
8976. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
8977. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
8978. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
8979. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
8980. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
8981. 	
8982. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
8983. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
8984. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
8985. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
8986. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
8987. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
8988. 	
8989. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
8990. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
8991. 	
8992. 	# Actual Size and End
8993. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
8994. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
8995. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
8996. 	
8997. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
8998. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
8999. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
9000. 
9001. # Gap Size & Rounding
9002. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
9003. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
9004. 	
9005. 	# Free Space
9006. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
9007. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
9008. 
9009. 	# Footer:
9010. SetVariable(ZoneFooter, "----------------------------------------------------------
9011. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
9012. 
9013. Statistics Report:
9014. ------------------
9015.    Size:  
9016.    ------------------------
9017.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9018.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9019.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9020. 
9021.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9022.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9023. 
9024.    Location:
9025.    ------------------------
9026.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9027.              Files End: !ZoneEndCurrent!
9028.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9029.       
9030.    Gap Settings:
9031.    ------------------------
9032.          Gap Requested: !ZoneGapSizePer!%
9033.       Volume Rounding: !ZoneVolRoundUpPer!%
9034.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9035.                  
9036.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9037.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9038.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9039.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9040.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9041.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9042.      
9043.    Free Space after Zone:
9044.    ------------------------
9045.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9046.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9047.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9048. 
9049. Directory and Files Select:
9050. ---------------------------
9051. !ZoneTypeSelectCurrent!               
9052. ---------------------------
9053. ----------------------------------------------------------
9054. ")
9055. 	# Zone Footer Set Statistics Window Text
9056. 
9057. SetStatisticsWindowText("----------------------------------------------------------
9058. Zones Processed: 
9059. ----------------------------------------------------------
9060. !ZoneListByLine!
9061. ----------------------------------------------------------
9062. Zone Processing Step:
9063. !ZoneStepByLine!    
9064. ----------------------------------------------------------
9065. Current Zone:
9066. !ZoneFooter!
9067. ----------------------------------------------------------
9068. Volume Statistics:
9069. !VolumeStatisticsDetail!
9070. ----------------------------------------------------------
9071. Zone Detailed Report:
9072. ----------------------------------------------------------
9073. !ZoneStatisticsDetail!
9074. ----------------------------------------------------------
9075. ")
9076. 
9077. 
9078. 	
9079.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
9080. 
9081. 	# Add Zone to list of zones for display.
9082. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
9083. 	# ??? Free Stats?
9084. 	# Footer:
9085. SetVariable(ZoneFooter, "----------------------------------------------------------
9086. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
9087. 
9088. Statistics Report:
9089. ------------------
9090.    Size:  
9091.    ------------------------
9092.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9093.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9094.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9095. 
9096.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9097.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9098. 
9099.    Location:
9100.    ------------------------
9101.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9102.              Files End: !ZoneEndCurrent!
9103.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9104.       
9105.    Gap Settings:
9106.    ------------------------
9107.          Gap Requested: !ZoneGapSizePer!%
9108.       Volume Rounding: !ZoneVolRoundUpPer!%
9109.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9110.                  
9111.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9112.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9113.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9114.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9115.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9116.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9117.      
9118.    Free Space after Zone:
9119.    ------------------------
9120.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9121.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9122.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9123. 
9124. Directory and Files Select:
9125. ---------------------------
9126. !ZoneTypeSelectCurrent!               
9127. ---------------------------
9128. ----------------------------------------------------------
9129. ")
9130. 
9131. 	# Add Zone Details to Report.	
9132. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
9133. !ZoneFooter!")
9134. 
9135. 
9136. 	
9137. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
9138. 			# FILE STEP
9139. 
9140. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9141. 
9142. /* add message and move to a new line. */
9143. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9144. ")
9145. 
9146. /* display the line. (hopefully.) */
9147. # Zone Footer Set Statistics Window Text
9148. 
9149. SetStatisticsWindowText("----------------------------------------------------------
9150. Zones Processed: 
9151. ----------------------------------------------------------
9152. !ZoneListByLine!
9153. ----------------------------------------------------------
9154. Zone Processing Step:
9155. !ZoneStepByLine!    
9156. ----------------------------------------------------------
9157. Current Zone:
9158. !ZoneFooter!
9159. ----------------------------------------------------------
9160. Volume Statistics:
9161. !VolumeStatisticsDetail!
9162. ----------------------------------------------------------
9163. Zone Detailed Report:
9164. ----------------------------------------------------------
9165. !ZoneStatisticsDetail!
9166. ----------------------------------------------------------
9167. ")
9168. 
9169. 
9170. 
9171. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9172. 
9173. # BANNER SET
9174. 
9175. # DATE TIME RUN ELP
9176. 
9177. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
9178. /* Xinclude "..\Display\BannerSet.MyDc"X */
9179. /* pause(1) */
9180. 
9181. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9182. 
9183. Title('!Heading!')
9184. /* pause(1) */
9185. 
9186. /* NOTE: Can't round or truncate to integer precision. */
9187. 
9188. pause(1)
9189. 
9190. 			/* "..\ActionVerbs\ZoneDoActionThis.MyDc" */
9191. 			# File Action - SortByImportSequence with SkipBlock.
9192. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
9193. 	
9194. 	
9195. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
9196. 			# FILE STEP
9197. 
9198. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9199. 
9200. /* add message and move to a new line. */
9201. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9202. ")
9203. 
9204. /* display the line. (hopefully.) */
9205. # Zone Footer Set Statistics Window Text
9206. 
9207. SetStatisticsWindowText("----------------------------------------------------------
9208. Zones Processed: 
9209. ----------------------------------------------------------
9210. !ZoneListByLine!
9211. ----------------------------------------------------------
9212. Zone Processing Step:
9213. !ZoneStepByLine!    
9214. ----------------------------------------------------------
9215. Current Zone:
9216. !ZoneFooter!
9217. ----------------------------------------------------------
9218. Volume Statistics:
9219. !VolumeStatisticsDetail!
9220. ----------------------------------------------------------
9221. Zone Detailed Report:
9222. ----------------------------------------------------------
9223. !ZoneStatisticsDetail!
9224. ----------------------------------------------------------
9225. ")
9226. 
9227. 
9228. 
9229. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9230. 
9231. # BANNER SET
9232. 
9233. # DATE TIME RUN ELP
9234. 
9235. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
9236. /* Xinclude "..\Display\BannerSet.MyDc"X */
9237. /* pause(1) */
9238. 
9239. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9240. 
9241. Title('!Heading!')
9242. /* pause(1) */
9243. 
9244. /* NOTE: Can't round or truncate to integer precision. */
9245. 
9246. pause(1)
9247. 
9248. 		# Zone Do Footer
9249. 
9250. /* ---------------------------------------------------------- */
9251. # File Select
9252. 	# Select Statments
9253. # File Actions 
9254. 	# Standard or OS File Actions.
9255. 	# Resume...
9256. 	
9257. 	# your stuff HERE (X)... post zone (file) file actions code.
9258. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
9259. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9260. 		# (X)
9261. 		
9262. 		/* ??? Set window? */
9263. 	
9264. 	# ADD THE GAP
9265. 		
9266. # Vacate (good for diagnostics)
9267. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
9268. 
9269. # DoNotVacate - DO NOT Vacate (recommended)
9270. 
9271. # Vacate
9272. /* AddGap(GapUsedLoc) */
9273. 
9274. # DO Not Vacate
9275. AddGap(GapUsedLoc, DoNotVacate) 
9276. 	
9277. 	
9278. /* ---------------------------------------------------------- */
9279. # (failed) TEST for boolean logic.
9280. 
9281. /* It should work in the gap calculations for turning options */
9282. /* on and off but it will NOT work here. */
9283. 
9284. /* Boolean setting X or FlagX. */
9285. /* Where X will be on or off: */
9286. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
9287. /*      For ON:  (X  *  FlagAny) */
9288. 
9289. /* 1) Failed, zero gap overrode the previous one. */
9290. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
9291. /* AddGap(GapUsedTemp) */ 
9292. 
9293. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
9294. /* AddGap(GapUsedTemp, DoNotVacate) */ 
9295. 
9296. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
9297. 
9298. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
9299. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
9300. /* AddGap(GapUsedTemp) */ 
9301. 
9302. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
9303. /* AddGap(GapUsedTemp, DoNotVacate) */ 
9304. 
9305. /* ---------------------------------------------------------- */
9306. 
9307. # Vacate
9308. /* AddGap(GapUsed) */
9309. 
9310. # DO NOT Vacate (recommended)
9311. /* AddGap(GapUsed, DoNotVacate) */ 
9312. 	
9313. 
9314. 		
9315. # 
9316. FileEnd
9317. /* ---------------------------------------------------------- */
9318. 
9319. # your stuff HERE (X)... post zone (file) code.
9320. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
9321. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9322. 	# (X)
9323. 
9324. SetVariable(FileStepDescription,"Zone finished, reporting.")
9325. # FILE STEP
9326. 
9327. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9328. 
9329. /* add message and move to a new line. */
9330. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9331. ")
9332. 
9333. /* display the line. (hopefully.) */
9334. # Zone Footer Set Statistics Window Text
9335. 
9336. SetStatisticsWindowText("----------------------------------------------------------
9337. Zones Processed: 
9338. ----------------------------------------------------------
9339. !ZoneListByLine!
9340. ----------------------------------------------------------
9341. Zone Processing Step:
9342. !ZoneStepByLine!    
9343. ----------------------------------------------------------
9344. Current Zone:
9345. !ZoneFooter!
9346. ----------------------------------------------------------
9347. Volume Statistics:
9348. !VolumeStatisticsDetail!
9349. ----------------------------------------------------------
9350. Zone Detailed Report:
9351. ----------------------------------------------------------
9352. !ZoneStatisticsDetail!
9353. ----------------------------------------------------------
9354. ")
9355. 
9356. 
9357. 
9358. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9359. 
9360. # BANNER SET
9361. 
9362. # DATE TIME RUN ELP
9363. 
9364. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
9365. /* Xinclude "..\Display\BannerSet.MyDc"X */
9366. /* pause(1) */
9367. 
9368. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9369. 
9370. Title('!Heading!')
9371. /* pause(1) */
9372. 
9373. /* NOTE: Can't round or truncate to integer precision. */
9374. 
9375. pause(1)
9376. 
9377. # Zone When Finished
9378. 
9379. # BANNER SET
9380. 
9381. # DATE TIME RUN ELP
9382. 
9383. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
9384. /* Xinclude "..\Display\BannerSet.MyDc"X */
9385. /* pause(1) */
9386. 
9387. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9388. 
9389. Title('!Heading!')
9390. /* pause(1) */
9391. 
9392. /* NOTE: Can't round or truncate to integer precision. */
9393. 
9394. AppendLogfile("!LogFileName!", "!Title!")
9395. 
9396. 
9397. 
9398. # Zone Statistics	
9399. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
9400. 
9401. # Footer:
9402. SetVariable(ZoneFooter, "----------------------------------------------------------
9403. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
9404. 
9405. Statistics Report:
9406. ------------------
9407.    Size:  
9408.    ------------------------
9409.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9410.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9411.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9412. 
9413.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9414.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9415. 
9416.    Location:
9417.    ------------------------
9418.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9419.              Files End: !ZoneEndCurrent!
9420.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9421.       
9422.    Gap Settings:
9423.    ------------------------
9424.          Gap Requested: !ZoneGapSizePer!%
9425.       Volume Rounding: !ZoneVolRoundUpPer!%
9426.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9427.                  
9428.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9429.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9430.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9431.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9432.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9433.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9434.      
9435.    Free Space after Zone:
9436.    ------------------------
9437.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9438.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9439.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9440. 
9441. Directory and Files Select:
9442. ---------------------------
9443. !ZoneTypeSelectCurrent!               
9444. ---------------------------
9445. ----------------------------------------------------------
9446. ")
9447. 
9448. AppendLogfile("!LogFileName!", ".")
9449. AppendLogfile("!LogFileName!", "!ZoneFooter!")
9450. AppendLogfile("!LogFileName!", ".")
9451. 
9452. # Zone Footer Set Statistics Window Text
9453. 
9454. SetStatisticsWindowText("----------------------------------------------------------
9455. Zones Processed: 
9456. ----------------------------------------------------------
9457. !ZoneListByLine!
9458. ----------------------------------------------------------
9459. Zone Processing Step:
9460. !ZoneStepByLine!    
9461. ----------------------------------------------------------
9462. Current Zone:
9463. !ZoneFooter!
9464. ----------------------------------------------------------
9465. Volume Statistics:
9466. !VolumeStatisticsDetail!
9467. ----------------------------------------------------------
9468. Zone Detailed Report:
9469. ----------------------------------------------------------
9470. !ZoneStatisticsDetail!
9471. ----------------------------------------------------------
9472. ")
9473. 
9474. 
9475. 
9476. /* pause() */
9477. /* pause() */
9478. 
9479. 
9480. 
9481. 	
9482. /* ---------------------------------------------------------- */
9483. # Zone Program Data.
9484. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsData!")
9485. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsData!")
9486. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
9487. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
9488. 	SetVariable(ZoneTypeSelect,'
9489.                 # Programs - Data files.
9490.                 not(
9491.                 # Os PageHiberDump start.
9492. (
9493.   FileName("DataStore.edb")
9494.   or FileName("DUMP*.*")
9495.   or FileName("Hiberfil.sys")
9496.   or FileName("MEMORY.DMP")
9497.   or FileName("Pagefile.sys")
9498. )
9499. # Os PageHiberDump end.
9500. 
9501.                 )
9502. ')
9503. 
9504. 		# Zone Do Header
9505. 
9506. # Zone When Started
9507. 
9508. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
9509. # Display Set Zone
9510. 
9511. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
9512. SetVariable(FileStepDescription,	"")
9513. 
9514. SetVariable(ZoneStepByLine, 			"Zone started.
9515. ")
9516. 
9517. # BANNER SET
9518. 
9519. # DATE TIME RUN ELP
9520. 
9521. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
9522. /* Xinclude "..\Display\BannerSet.MyDc"X */
9523. /* pause(1) */
9524. 
9525. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9526. 
9527. Title('!Heading!')
9528. /* pause(1) */
9529. 
9530. /* NOTE: Can't round or truncate to integer precision. */
9531. 
9532. AppendLogfile("!LogFileName!", "!Title!")
9533. 
9534. 
9535. 
9536. pause(1)
9537. 
9538. 
9539. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
9540. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
9541. 
9542. SetVariable(ZoneStepNoCurrent, 0)
9543. 
9544. 
9545. # Zone Do Current Clear
9546. 
9547. SetVariable(ZoneTypeSelectCurrent, 		"")
9548. 
9549. SetVariable(ZoneBeginCurrent, 			0)
9550. SetVariable(ZoneBeginPerCurrent, 		0)
9551. SetVariable(ZoneEndCurrent, 			0)
9552. SetVariable(ZoneEndPerCurrent, 			0)
9553. 
9554. SetVariable(ZoneSizeCurrent,			0)
9555. SetVariable(ZoneSizePerCurrent,			0)
9556. 
9557. SetVariable(ZoneGapRequestedCurrent,	0)
9558. SetVariable(ZoneGapRoundedCurrent, 		0)
9559. SetVariable(ZoneGapAdjustedCurrent, 	0)
9560. SetVariable(ZoneGapAvailableCurrent, 	0)
9561. SetVariable(ZoneGapCurrent,				0)
9562. SetVariable(ZoneGapUsedCurrent, 		0)
9563. 
9564. SetVariable(ZoneGapActualCurrent, 		0)
9565. SetVariable(ZoneGapActualPerCurrent, 	0)
9566. 
9567. SetVariable(ZoneSizeActual, 			0)
9568. SetVariable(ZoneSizeActualCurrent,		0)
9569. 
9570. SetVariable(ZoneEndActual, 				0)
9571. SetVariable(ZoneEndActualCurrent,		0)			
9572. SetVariable(ZoneSizeActualPerCurrent, 	0)
9573.       
9574. SetVariable(ZoneFilesFolders,			0)
9575. SetVariable(ZoneFilesFoldersPer,		0) 
9576. 
9577. SetVariable(ZoneFragments,				0)
9578. SetVariable(ZoneFragmentsPer,			0) 
9579. 		
9580. SetVariable(ZoneEndActualCurrent, 		0)
9581. SetVariable(ZoneEndActualPerCurrent, 	0)
9582. 
9583. # Gap Calculation Methodology:
9584. 	# Requested
9585. 	SetVariable(GapRequested, 			0) 
9586. 	SetVariable(GapRequestedStd, 		0) 
9587. 	SetVariable(GapRequestedMft, 		0) 
9588. 	SetVariable(GapRequestedOs, 		0) 
9589. 	SetVariable(GapRequestedOriginal, 	0) 
9590. 	
9591. 	# Gap Adjustments
9592. 	SetVariable(GapRounded, 			0)
9593. 	# SetVariable(GapAdjusted, 			0)
9594. 	SetVariable(GapAvailable, 			0)
9595. 	SetVariable(GapCurrent, 			0)
9596. 	SetVariable(GapActual, 				0)
9597. 	SetVariable(GapUsed, 				0)
9598. 	
9599. 	# Gap Adjustments
9600. 	SetVariable(GapRoundedLoc, 			0)
9601. 	# SetVariable(GapAdjustedLoc, 		0)
9602. 	SetVariable(GapAvailableLoc, 		0)
9603. 	SetVariable(GapCurrentLoc, 			0)
9604. 	SetVariable(GapActualLoc,			0)
9605. 	SetVariable(GapUsedLoc,				0)
9606. 	
9607. 	# Space usage
9608. 	SetVariable(ZoneFreePerRequested, 	0)
9609. 	SetVariable(ZoneFreePerUsed, 		0)
9610. 
9611. # Gap Size & Rounding
9612. 	SetVariable(ZoneGapSizePer, 		0)
9613. 	SetVariable(ZoneVolRoundUpPer, 		0)
9614. 	
9615. 	# Free Space
9616. 	SetVariable(ZoneFreeUsedPer, 		0)
9617. 	SetVariable(ZoneFreeRequestedPer, 	0)
9618. 
9619. 
9620. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
9621. 
9622. # Footer:
9623. SetVariable(ZoneFooter, "----------------------------------------------------------
9624. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
9625. 
9626. Statistics Report:
9627. ------------------
9628.    Size:  
9629.    ------------------------
9630.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9631.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9632.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9633. 
9634.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9635.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9636. 
9637.    Location:
9638.    ------------------------
9639.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9640.              Files End: !ZoneEndCurrent!
9641.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9642.       
9643.    Gap Settings:
9644.    ------------------------
9645.          Gap Requested: !ZoneGapSizePer!%
9646.       Volume Rounding: !ZoneVolRoundUpPer!%
9647.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9648.                  
9649.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9650.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9651.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9652.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9653.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9654.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9655.      
9656.    Free Space after Zone:
9657.    ------------------------
9658.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9659.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9660.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9661. 
9662. Directory and Files Select:
9663. ---------------------------
9664. !ZoneTypeSelectCurrent!               
9665. ---------------------------
9666. ----------------------------------------------------------
9667. ")
9668. 
9669. # BANNER SET
9670. 
9671. # DATE TIME RUN ELP
9672. 
9673. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
9674. /* Xinclude "..\Display\BannerSet.MyDc"X */
9675. /* pause(1) */
9676. 
9677. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9678. 
9679. Title('!Heading!')
9680. /* pause(1) */
9681. 
9682. /* NOTE: Can't round or truncate to integer precision. */
9683. 
9684. AppendLogfile("!LogFileName!", "!Title!")
9685. 
9686. 
9687. 
9688. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
9689. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
9690. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:53")
9691. 
9692. SetVariable(ZoneListByLine, "!ZoneListByLine!
9693. Zone: !ZoneNoCurrent! 2021-11-09 10:47:53 0:00:05 !ZoneLabel! !ZoneDescription!")
9694. 
9695. 
9696. /* Fixed Zone Position Handling */
9697. /* Literal number: */
9698. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
9699. /* Percentage of disk: */
9700. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
9701. /* Gap */
9702. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
9703. 
9704. /* ---------------------------------------------------------- */
9705. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
9706. # FILE STEP
9707. 
9708. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9709. 
9710. /* add message and move to a new line. */
9711. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9712. ")
9713. 
9714. /* display the line. (hopefully.) */
9715. # Zone Footer Set Statistics Window Text
9716. 
9717. SetStatisticsWindowText("----------------------------------------------------------
9718. Zones Processed: 
9719. ----------------------------------------------------------
9720. !ZoneListByLine!
9721. ----------------------------------------------------------
9722. Zone Processing Step:
9723. !ZoneStepByLine!    
9724. ----------------------------------------------------------
9725. Current Zone:
9726. !ZoneFooter!
9727. ----------------------------------------------------------
9728. Volume Statistics:
9729. !VolumeStatisticsDetail!
9730. ----------------------------------------------------------
9731. Zone Detailed Report:
9732. ----------------------------------------------------------
9733. !ZoneStatisticsDetail!
9734. ----------------------------------------------------------
9735. ")
9736. 
9737. 
9738. 
9739. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9740. 
9741. # BANNER SET
9742. 
9743. # DATE TIME RUN ELP
9744. 
9745. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
9746. /* Xinclude "..\Display\BannerSet.MyDc"X */
9747. /* pause(1) */
9748. 
9749. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9750. 
9751. Title('!Heading!')
9752. /* pause(1) */
9753. 
9754. /* NOTE: Can't round or truncate to integer precision. */
9755. 
9756. pause(1)
9757. 
9758. # your stuff HERE (X)... pre file select code.
9759. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
9760. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9761. 	# (X)
9762. 
9763. FileSelect
9764. 
9765. 	# your stuff can't really go here (errors.)
9766. 	# maybe for some reason I don't know of...
9767. 	
9768. 	# Actions next...
9769. 		# Programs start.
9770. # NotBlobsArchivesBu start.
9771. (not (
9772. # Blobs start.
9773. (
9774. # BlobsAndExceptions start.
9775. ( not(
9776.   FileName("*.bat")
9777.   or FileName("*.css")
9778.   or FileName("*.dll")
9779.   or FileName("*.exe")
9780.   or FileName("*.htm*")
9781.   or FileName("*.jar")
9782.   or FileName("*.js")
9783.   or FileName("*.script")
9784.   or FileName("*.wsf")
9785.   or (
9786. # Databases start.
9787. (
9788.   FileName("*.crypt*")
9789.   or FileName("*.db*")
9790.   or FileName("*.rdb*")
9791.   or FileName("*.dc*")
9792.   or FileName("*.dict*")
9793.   or FileName("*.?db*")
9794.   or FileName("*.?rdb*")
9795.   or FileName("*.md*")
9796.   or FileName("*.myd")
9797.   or FileName("*.ndf")
9798.   or FileName("*.ns?")
9799.   or FileName("*.pab")
9800.   or FileName("*.pst")
9801.   or FileName("*.sd?*")
9802.   or FileName("*.sq**")
9803.   or FileName("*.tmd")
9804.   or FileName("*.tps")
9805.   or FileName("*.tr*")
9806. )
9807. # Databases end.
9808. 
9809.     # BlobsAndExceptions
9810.     or 
9811. # Data start.
9812. (
9813.   DirectoryName("Data*")
9814.   or DirectoryName("Device*")
9815.   or DirectoryName("Export*")
9816.   or DirectoryName("Import*")
9817.   or DirectoryName("Log*")
9818.   or DirectoryName("*Log")
9819.   or DirectoryName("Maintenance*")
9820.   or DirectoryName("Rec*")
9821.   or DirectoryName("Sales*")
9822.   or DirectoryName("Search*")
9823.   or DirectoryName("User*")
9824. )
9825. # Data end.
9826. 
9827.     # BlobsAndExceptions
9828.   )
9829. ) )
9830. # BlobsAndExceptions end.
9831. 
9832. # Blobs
9833. ) and (
9834.   Size(BlobFileSize,0)
9835.   or (
9836.     FileName("*.arj")
9837.     or FileName("*.bup")
9838.     or FileName("*.bz2")
9839.     or FileName("*.chm")
9840.     or FileName("*.dvr-ms")
9841.     or FileName("*.gz")
9842.     or FileName("*.ifo")
9843.     or FileName("*.lzh")
9844.     or FileName("*.pdf")
9845.     or FileName("*.rpm")
9846.     or FileName("*.wmv")
9847.     or FileName("*.vob")
9848.     or FileName("*.z")
9849.   ) 
9850. )
9851. # Blobs end.
9852. 
9853. # NotBlobsArchivesBu
9854. or 
9855. # Archives start.
9856. (
9857.   DirectoryName("*Archive*")
9858.   or DirectoryName("*History*")
9859.   or DirectoryName("*Old")
9860.   or DirectoryName("* Old *")
9861.   or DirectoryName("Old *")
9862. 
9863.   or FileName("*.7z")
9864.   or FileName("*.cab")
9865.   or FileName("*.iso")
9866.   or FileName("*.msi")
9867.   or FileName("*.old")
9868.   or FileName("*.rar")
9869.   or FileName("*.tar")
9870.   or FileName("*.zip")
9871.   or
9872. # WinSysLow start.
9873. (
9874.   DirectoryName("$*")
9875.   or DirectoryName("0*")
9876.   or DirectoryName("1*")
9877.   or DirectoryName("2*")
9878.   or DirectoryName("3*")
9879.   or DirectoryName("4*")
9880.   or DirectoryName("5*")
9881.   or DirectoryName("6*")
9882.   or DirectoryName("7*")
9883.   or DirectoryName("8*")
9884.   or DirectoryName("9*")
9885. 
9886.   or DirectoryName("dllcache")
9887.   or DirectoryName("Downloaded Installations")
9888.   or DirectoryName("Ehome")
9889.   or DirectoryName("Fonts")
9890.   or DirectoryName("Help")
9891.   or DirectoryName("I386")
9892.   or DirectoryName("ie?updates")
9893.   or DirectoryName("Installer")
9894.   or DirectoryName("Installshield Installation Information")
9895.   or DirectoryName("IME")
9896.   or DirectoryName("*RECYCLE*")
9897.   or DirectoryName("ServicePackFiles")
9898.   or DirectoryName("SoftwareDistribution")
9899.   or DirectoryName("Speech")
9900.   or DirectoryName("Symbols")
9901.   or DirectoryName("System Volume Information")
9902.   or DirectoryName("windows.old")
9903. )
9904. # WinSysLow end.
9905. 
9906.   # Archives
9907. )
9908. # Archives end.
9909. 
9910. # NotBlobsArchivesBu
9911. or
9912. # Backups start.
9913. (
9914.   DirectoryName("*Backup*")
9915.   or DirectoryName("*Bu")
9916.   or DirectoryName("* Bu *")
9917.   or DirectoryName("Bu *")
9918. 
9919.   or FileName("*.bak")
9920.   or FileName("* - Copy*")
9921. )
9922. # Backups end.
9923. 
9924. # NotBlobsArchivesBu
9925. ) )
9926. # NotBlobsArchivesBu end.
9927. 
9928. # Programs
9929. and (
9930. # SystemDir start.
9931. (
9932.   DirectoryName("Boot*")
9933.   or DirectoryName("Device*")
9934.   or DirectoryName("DevSupport*")
9935.   or DirectoryName("Program*")
9936.   or DirectoryName("Security*")
9937.   or DirectoryName("SendTo*")
9938.   or DirectoryName("Sw*")
9939.   or DirectoryName("System*")
9940.   or DirectoryName("Toolbars")
9941.   or DirectoryName("Windows*")
9942. )
9943. # SystemDir end.
9944. 
9945. # Programs
9946. )
9947. # Programs end.
9948. 
9949. 		and not(
9950. 			# Os PageHiberDump start.
9951. (
9952.   FileName("DataStore.edb")
9953.   or FileName("DUMP*.*")
9954.   or FileName("Hiberfil.sys")
9955.   or FileName("MEMORY.DMP")
9956.   or FileName("Pagefile.sys")
9957. )
9958. # Os PageHiberDump end.
9959. 
9960. 		)
9961. 		FileActions
9962. 		  		/* ---------------------------------------------------------- */
9963. 	# Gap
9964. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
9965. 		# FILE STEP
9966. 
9967. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9968. 
9969. /* add message and move to a new line. */
9970. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9971. ")
9972. 
9973. /* display the line. (hopefully.) */
9974. # Zone Footer Set Statistics Window Text
9975. 
9976. SetStatisticsWindowText("----------------------------------------------------------
9977. Zones Processed: 
9978. ----------------------------------------------------------
9979. !ZoneListByLine!
9980. ----------------------------------------------------------
9981. Zone Processing Step:
9982. !ZoneStepByLine!    
9983. ----------------------------------------------------------
9984. Current Zone:
9985. !ZoneFooter!
9986. ----------------------------------------------------------
9987. Volume Statistics:
9988. !VolumeStatisticsDetail!
9989. ----------------------------------------------------------
9990. Zone Detailed Report:
9991. ----------------------------------------------------------
9992. !ZoneStatisticsDetail!
9993. ----------------------------------------------------------
9994. ")
9995. 
9996. 
9997. 
9998. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9999. 
10000. # BANNER SET
10001. 
10002. # DATE TIME RUN ELP
10003. 
10004. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
10005. /* Xinclude "..\Display\BannerSet.MyDc"X */
10006. /* pause(1) */
10007. 
10008. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10009. 
10010. Title('!Heading!')
10011. /* pause(1) */
10012. 
10013. /* NOTE: Can't round or truncate to integer precision. */
10014. 
10015. pause(1)
10016. 	
10017. 	# ACTUAL GAP
10018. 		/* AddGap Variant. */
10019. 	  	# Zone Do Gap
10020. # Gap Calculation Methods:
10021. 
10022. /* 1) Anything you need to add first. */
10023. /* empty */
10024. 
10025. /* ---------------------------------------------------------- */
10026. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
10027. 	# GapRequestedStd.
10028. 
10029. 		/* ---------------------------------------------------------- */
10030. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
10031. 
10032. 		# Gap Calculation Methods:
10033. 
10034. /* AddGap Variants */
10035. 
10036. 	/* Standard */
10037. 		# Gap Calculation Methods:
10038. 	/* AddGap Variants */
10039. 	/* Standard */
10040. 
10041. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
10042. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
10043. 
10044. 	SetVariable(GapRequested, GapRequestedStd)
10045. 	
10046. 
10047. 	/* MFT Low High Method */
10048. 		# Gap Calculation Methods:
10049. 	/* AddGap Variants */
10050. 	/* MFT Low High Method */
10051. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
10052. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
10053. 	SetVariable(GapRequested, GapRequestedMft)
10054. 	
10055. 
10056. 	/* OS Volume Type Method */
10057. 		# Gap Calculation Methods:
10058. 	/* AddGap Variants */
10059. 	/* OS Volume Type Method */
10060. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
10061. 	SetVariable(GapRequested, GapRequestedOs)
10062. 
10063. 
10064. 
10065. /* MakeGap Variants */
10066. 
10067. 	/* Original Os 1-3 + MFT 2 */
10068. 		# Gap Calculation Methods:
10069. 	/* MakeGap Variants */
10070. 	/* Original Os 1-3 + MFT 2 */
10071. 	/* plus MFT gap placed inline at the dividing zone. */
10072. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
10073. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
10074. 	SetVariable(GapRequested, GapRequestedOrig)
10075. 	
10076. 	
10077. /* Note: You could comment out the ones not in use */
10078. /* However having the data in the log is useful. */
10079. /* Therefore the following line is otherwise needed. */
10080. 
10081. /* Standard used */
10082. 
10083. SetVariable(GapRequested, GapRequestedStd)
10084. 
10085. # Gap Calculation Methods:
10086. 
10087. /* AddGap Variants */
10088. 	/* Standard */
10089. 	/* MFT Low High Method */
10090. 	/* OS Volume Type Method */
10091. 
10092. /* MakeGap Variants */
10093. 	/* Original Os 1-3 + MFT 2 */
10094. 
10095. /* Note: You could comment out the ones not in use */
10096. /* However having the data in the log is useful. */
10097. /* Therefore the following line is otherwise needed. */
10098. 
10099. /* Standard is used currently */
10100. 
10101. 
10102. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
10103. 
10104. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
10105. 
10106. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
10107. 
10108. /* ---------------------------------------------------------- */
10109. /* 3) SMALL ZONE ADJUSTMENT. */
10110. /* Gab cant be larger than half the Zone Size. */
10111. 
10112. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
10113. 	
10114. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
10115. 
10116. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
10117. 
10118. /* ---------------------------------------------------------- */
10119. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
10120. # Gap Adjustments.
10121. 
10122. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
10123. 	
10124. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
10125. 
10126. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
10127. 
10128. /* ---------------------------------------------------------- */
10129. # BYPASS THIS.
10130. 	/* This is definitely wrong. */
10131. 	/* The question is can we steal gap from the next zone */
10132. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
10133. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
10134. 		# Zone Overflow.
10135. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
10136. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
10137. 
10138. /* ---------------------------------------------------------- */
10139. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
10140. # Remaining free space available.
10141. 
10142. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
10143. 	
10144. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
10145. 
10146. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
10147. 
10148. /* ---------------------------------------------------------- */
10149. # CURRENT gap to use.
10150. 
10151. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
10152. 
10153. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
10154. 
10155. /* ---------------------------------------------------------- */
10156. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
10157. # Debugging.
10158. 
10159. 	SetVariable(GapUsed, GapCurrent) // for debugging
10160. 
10161. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
10162. 
10163. 		# Your code HERE
10164. 
10165. /* ---------------------------------------------------------- */
10166. /* 7) YOUR CODE. */
10167. # YOUR CODE HERE:
10168. 	# INPUT: GapCurrent or GapCurrentLoc
10169. 	# OUTPUT: GapUsed...
10170. 
10171. /* ---------------------------------------------------------- */
10172. # Gap Size.
10173. # Actual Size of Gap.
10174. 
10175. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
10176. 
10177. /* ---------------------------------------------------------- */
10178. /* xxxxxxxxxxxxxxxxxxxxxx */
10179. # ADD THE GAP
10180. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
10181. /* xxxxxxxxxxxxxxxxxxxxxx */
10182. 
10183. 	
10184. 	# Zone Statistics	
10185. 	# Zone / Volume Statistics and Display
10186. 		
10187. 	# Accumulate Totals
10188.   	# Volume totals
10189. 
10190. /* Current total space used (by Zones and Gaps) */
10191. 
10192. SetVariable(VolumeZoneUsed, GapUsed)
10193. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
10194. /* Percentage */
10195. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
10196. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
10197. 
10198. /* Current total of free space requested */
10199. 
10200. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
10201. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10202. /* Percent. */
10203. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
10204. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10205. 
10206. /* Current total of free space used */
10207. 
10208. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
10209. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
10210. /* Percent */
10211. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
10212. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
10213. 
10214. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
10215. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
10216. /* Xinclude "..\DebugDisplayPause.MyDc"X */
10217. 
10218. 
10219. 	# Current Values
10220. 	# Cluster, Sector, Block adjust for display.
10221. 	# Bytes per cluster is volume specific.
10222. 
10223. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
10224. 
10225. # Current Zone values.
10226. 	# Begin, end and size.
10227. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
10228. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
10229. 
10230. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
10231. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
10232. 
10233. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
10234. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
10235. 
10236. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
10237. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
10238. 
10239. 	SetVariable(ZoneFragments,				"!ZONE210N!")
10240. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
10241. 		
10242. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
10243. /* identical code to here: (separation not needed. TEST.) */	
10244. 
10245. # Current Gap, Actual and Free Values
10246. 	# Gap
10247. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
10248. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
10249. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
10250. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
10251. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
10252. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
10253. 	
10254. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
10255. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
10256. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
10257. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
10258. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
10259. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
10260. 	
10261. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
10262. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
10263. 	
10264. 	# Actual Size and End
10265. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
10266. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
10267. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
10268. 	
10269. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
10270. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
10271. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
10272. 
10273. # Gap Size & Rounding
10274. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
10275. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
10276. 	
10277. 	# Free Space
10278. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
10279. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
10280. 
10281. 	# Footer:
10282. SetVariable(ZoneFooter, "----------------------------------------------------------
10283. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
10284. 
10285. Statistics Report:
10286. ------------------
10287.    Size:  
10288.    ------------------------
10289.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10290.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10291.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10292. 
10293.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10294.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10295. 
10296.    Location:
10297.    ------------------------
10298.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10299.              Files End: !ZoneEndCurrent!
10300.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10301.       
10302.    Gap Settings:
10303.    ------------------------
10304.          Gap Requested: !ZoneGapSizePer!%
10305.       Volume Rounding: !ZoneVolRoundUpPer!%
10306.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10307.                  
10308.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
10309.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
10310.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
10311.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
10312.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
10313.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
10314.      
10315.    Free Space after Zone:
10316.    ------------------------
10317.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10318.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10319.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10320. 
10321. Directory and Files Select:
10322. ---------------------------
10323. !ZoneTypeSelectCurrent!               
10324. ---------------------------
10325. ----------------------------------------------------------
10326. ")
10327. 	# Zone Footer Set Statistics Window Text
10328. 
10329. SetStatisticsWindowText("----------------------------------------------------------
10330. Zones Processed: 
10331. ----------------------------------------------------------
10332. !ZoneListByLine!
10333. ----------------------------------------------------------
10334. Zone Processing Step:
10335. !ZoneStepByLine!    
10336. ----------------------------------------------------------
10337. Current Zone:
10338. !ZoneFooter!
10339. ----------------------------------------------------------
10340. Volume Statistics:
10341. !VolumeStatisticsDetail!
10342. ----------------------------------------------------------
10343. Zone Detailed Report:
10344. ----------------------------------------------------------
10345. !ZoneStatisticsDetail!
10346. ----------------------------------------------------------
10347. ")
10348. 
10349. 
10350. 	
10351.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
10352. 
10353. 	# Add Zone to list of zones for display.
10354. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
10355. 	# ??? Free Stats?
10356. 	# Footer:
10357. SetVariable(ZoneFooter, "----------------------------------------------------------
10358. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
10359. 
10360. Statistics Report:
10361. ------------------
10362.    Size:  
10363.    ------------------------
10364.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10365.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10366.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10367. 
10368.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10369.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10370. 
10371.    Location:
10372.    ------------------------
10373.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10374.              Files End: !ZoneEndCurrent!
10375.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10376.       
10377.    Gap Settings:
10378.    ------------------------
10379.          Gap Requested: !ZoneGapSizePer!%
10380.       Volume Rounding: !ZoneVolRoundUpPer!%
10381.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10382.                  
10383.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
10384.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
10385.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
10386.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
10387.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
10388.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
10389.      
10390.    Free Space after Zone:
10391.    ------------------------
10392.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10393.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10394.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10395. 
10396. Directory and Files Select:
10397. ---------------------------
10398. !ZoneTypeSelectCurrent!               
10399. ---------------------------
10400. ----------------------------------------------------------
10401. ")
10402. 
10403. 	# Add Zone Details to Report.	
10404. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
10405. !ZoneFooter!")
10406. 
10407. 
10408. 	
10409. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
10410. 			# FILE STEP
10411. 
10412. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10413. 
10414. /* add message and move to a new line. */
10415. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10416. ")
10417. 
10418. /* display the line. (hopefully.) */
10419. # Zone Footer Set Statistics Window Text
10420. 
10421. SetStatisticsWindowText("----------------------------------------------------------
10422. Zones Processed: 
10423. ----------------------------------------------------------
10424. !ZoneListByLine!
10425. ----------------------------------------------------------
10426. Zone Processing Step:
10427. !ZoneStepByLine!    
10428. ----------------------------------------------------------
10429. Current Zone:
10430. !ZoneFooter!
10431. ----------------------------------------------------------
10432. Volume Statistics:
10433. !VolumeStatisticsDetail!
10434. ----------------------------------------------------------
10435. Zone Detailed Report:
10436. ----------------------------------------------------------
10437. !ZoneStatisticsDetail!
10438. ----------------------------------------------------------
10439. ")
10440. 
10441. 
10442. 
10443. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10444. 
10445. # BANNER SET
10446. 
10447. # DATE TIME RUN ELP
10448. 
10449. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
10450. /* Xinclude "..\Display\BannerSet.MyDc"X */
10451. /* pause(1) */
10452. 
10453. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10454. 
10455. Title('!Heading!')
10456. /* pause(1) */
10457. 
10458. /* NOTE: Can't round or truncate to integer precision. */
10459. 
10460. pause(1)
10461. 
10462. 			/* "..\ActionVerbs\ZoneDoActionThis.MyDc" */
10463. 			# File Action - SortByImportSequence with SkipBlock.
10464. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
10465. 	
10466. 	
10467. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
10468. 			# FILE STEP
10469. 
10470. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10471. 
10472. /* add message and move to a new line. */
10473. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10474. ")
10475. 
10476. /* display the line. (hopefully.) */
10477. # Zone Footer Set Statistics Window Text
10478. 
10479. SetStatisticsWindowText("----------------------------------------------------------
10480. Zones Processed: 
10481. ----------------------------------------------------------
10482. !ZoneListByLine!
10483. ----------------------------------------------------------
10484. Zone Processing Step:
10485. !ZoneStepByLine!    
10486. ----------------------------------------------------------
10487. Current Zone:
10488. !ZoneFooter!
10489. ----------------------------------------------------------
10490. Volume Statistics:
10491. !VolumeStatisticsDetail!
10492. ----------------------------------------------------------
10493. Zone Detailed Report:
10494. ----------------------------------------------------------
10495. !ZoneStatisticsDetail!
10496. ----------------------------------------------------------
10497. ")
10498. 
10499. 
10500. 
10501. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10502. 
10503. # BANNER SET
10504. 
10505. # DATE TIME RUN ELP
10506. 
10507. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
10508. /* Xinclude "..\Display\BannerSet.MyDc"X */
10509. /* pause(1) */
10510. 
10511. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10512. 
10513. Title('!Heading!')
10514. /* pause(1) */
10515. 
10516. /* NOTE: Can't round or truncate to integer precision. */
10517. 
10518. pause(1)
10519. 
10520. 		# Zone Do Footer
10521. 
10522. /* ---------------------------------------------------------- */
10523. # File Select
10524. 	# Select Statments
10525. # File Actions 
10526. 	# Standard or OS File Actions.
10527. 	# Resume...
10528. 	
10529. 	# your stuff HERE (X)... post zone (file) file actions code.
10530. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
10531. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
10532. 		# (X)
10533. 		
10534. 		/* ??? Set window? */
10535. 	
10536. 	# ADD THE GAP
10537. 		
10538. # Vacate (good for diagnostics)
10539. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
10540. 
10541. # DoNotVacate - DO NOT Vacate (recommended)
10542. 
10543. # Vacate
10544. /* AddGap(GapUsedLoc) */
10545. 
10546. # DO Not Vacate
10547. AddGap(GapUsedLoc, DoNotVacate) 
10548. 	
10549. 	
10550. /* ---------------------------------------------------------- */
10551. # (failed) TEST for boolean logic.
10552. 
10553. /* It should work in the gap calculations for turning options */
10554. /* on and off but it will NOT work here. */
10555. 
10556. /* Boolean setting X or FlagX. */
10557. /* Where X will be on or off: */
10558. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
10559. /*      For ON:  (X  *  FlagAny) */
10560. 
10561. /* 1) Failed, zero gap overrode the previous one. */
10562. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
10563. /* AddGap(GapUsedTemp) */ 
10564. 
10565. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
10566. /* AddGap(GapUsedTemp, DoNotVacate) */ 
10567. 
10568. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
10569. 
10570. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
10571. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
10572. /* AddGap(GapUsedTemp) */ 
10573. 
10574. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
10575. /* AddGap(GapUsedTemp, DoNotVacate) */ 
10576. 
10577. /* ---------------------------------------------------------- */
10578. 
10579. # Vacate
10580. /* AddGap(GapUsed) */
10581. 
10582. # DO NOT Vacate (recommended)
10583. /* AddGap(GapUsed, DoNotVacate) */ 
10584. 	
10585. 
10586. 		
10587. # 
10588. FileEnd
10589. /* ---------------------------------------------------------- */
10590. 
10591. # your stuff HERE (X)... post zone (file) code.
10592. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
10593. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
10594. 	# (X)
10595. 
10596. SetVariable(FileStepDescription,"Zone finished, reporting.")
10597. # FILE STEP
10598. 
10599. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10600. 
10601. /* add message and move to a new line. */
10602. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10603. ")
10604. 
10605. /* display the line. (hopefully.) */
10606. # Zone Footer Set Statistics Window Text
10607. 
10608. SetStatisticsWindowText("----------------------------------------------------------
10609. Zones Processed: 
10610. ----------------------------------------------------------
10611. !ZoneListByLine!
10612. ----------------------------------------------------------
10613. Zone Processing Step:
10614. !ZoneStepByLine!    
10615. ----------------------------------------------------------
10616. Current Zone:
10617. !ZoneFooter!
10618. ----------------------------------------------------------
10619. Volume Statistics:
10620. !VolumeStatisticsDetail!
10621. ----------------------------------------------------------
10622. Zone Detailed Report:
10623. ----------------------------------------------------------
10624. !ZoneStatisticsDetail!
10625. ----------------------------------------------------------
10626. ")
10627. 
10628. 
10629. 
10630. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10631. 
10632. # BANNER SET
10633. 
10634. # DATE TIME RUN ELP
10635. 
10636. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
10637. /* Xinclude "..\Display\BannerSet.MyDc"X */
10638. /* pause(1) */
10639. 
10640. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10641. 
10642. Title('!Heading!')
10643. /* pause(1) */
10644. 
10645. /* NOTE: Can't round or truncate to integer precision. */
10646. 
10647. pause(1)
10648. 
10649. # Zone When Finished
10650. 
10651. # BANNER SET
10652. 
10653. # DATE TIME RUN ELP
10654. 
10655. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
10656. /* Xinclude "..\Display\BannerSet.MyDc"X */
10657. /* pause(1) */
10658. 
10659. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10660. 
10661. Title('!Heading!')
10662. /* pause(1) */
10663. 
10664. /* NOTE: Can't round or truncate to integer precision. */
10665. 
10666. AppendLogfile("!LogFileName!", "!Title!")
10667. 
10668. 
10669. 
10670. # Zone Statistics	
10671. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
10672. 
10673. # Footer:
10674. SetVariable(ZoneFooter, "----------------------------------------------------------
10675. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
10676. 
10677. Statistics Report:
10678. ------------------
10679.    Size:  
10680.    ------------------------
10681.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10682.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10683.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10684. 
10685.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10686.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10687. 
10688.    Location:
10689.    ------------------------
10690.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10691.              Files End: !ZoneEndCurrent!
10692.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10693.       
10694.    Gap Settings:
10695.    ------------------------
10696.          Gap Requested: !ZoneGapSizePer!%
10697.       Volume Rounding: !ZoneVolRoundUpPer!%
10698.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10699.                  
10700.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
10701.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
10702.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
10703.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
10704.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
10705.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
10706.      
10707.    Free Space after Zone:
10708.    ------------------------
10709.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10710.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10711.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10712. 
10713. Directory and Files Select:
10714. ---------------------------
10715. !ZoneTypeSelectCurrent!               
10716. ---------------------------
10717. ----------------------------------------------------------
10718. ")
10719. 
10720. AppendLogfile("!LogFileName!", ".")
10721. AppendLogfile("!LogFileName!", "!ZoneFooter!")
10722. AppendLogfile("!LogFileName!", ".")
10723. 
10724. # Zone Footer Set Statistics Window Text
10725. 
10726. SetStatisticsWindowText("----------------------------------------------------------
10727. Zones Processed: 
10728. ----------------------------------------------------------
10729. !ZoneListByLine!
10730. ----------------------------------------------------------
10731. Zone Processing Step:
10732. !ZoneStepByLine!    
10733. ----------------------------------------------------------
10734. Current Zone:
10735. !ZoneFooter!
10736. ----------------------------------------------------------
10737. Volume Statistics:
10738. !VolumeStatisticsDetail!
10739. ----------------------------------------------------------
10740. Zone Detailed Report:
10741. ----------------------------------------------------------
10742. !ZoneStatisticsDetail!
10743. ----------------------------------------------------------
10744. ")
10745. 
10746. 
10747. 
10748. /* pause() */
10749. /* pause() */
10750. 
10751. 
10752. 
10753. 	
10754. /* ---------------------------------------------------------- */
10755. 
10756. 
10757. /* ---------------------------------------------------------- */
10758. /* OLD: ToDo */
10759. 	/* Zone 1 and 2 originally */
10760. 	/* Originally the MFT and DIRs were processed first. */
10761. 	/* Zone 4 and 5 normally */
10762. 	/* The MakeGap call is put between which ever zones you want */
10763. 	/* So the actual zone number is unknown */
10764. 	/* SetVariable(ZoneCurrent,"4, 5") */
10765. 	/* MakeGap(RoundUp(VolumeUsed * (!MftPer! + 0.15), VolumeSize * ZoneVolRoundUpLarge), DoNotVacate) */
10766. 
10767. /* ---------------------------------------------------------- */
10768. SetVariable(FileStepDescription,"System Zones completed.")
10769. # FILE STEP
10770. 
10771. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10772. 
10773. /* add message and move to a new line. */
10774. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10775. ")
10776. 
10777. /* display the line. (hopefully.) */
10778. # Zone Footer Set Statistics Window Text
10779. 
10780. SetStatisticsWindowText("----------------------------------------------------------
10781. Zones Processed: 
10782. ----------------------------------------------------------
10783. !ZoneListByLine!
10784. ----------------------------------------------------------
10785. Zone Processing Step:
10786. !ZoneStepByLine!    
10787. ----------------------------------------------------------
10788. Current Zone:
10789. !ZoneFooter!
10790. ----------------------------------------------------------
10791. Volume Statistics:
10792. !VolumeStatisticsDetail!
10793. ----------------------------------------------------------
10794. Zone Detailed Report:
10795. ----------------------------------------------------------
10796. !ZoneStatisticsDetail!
10797. ----------------------------------------------------------
10798. ")
10799. 
10800. 
10801. 
10802. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10803. 
10804. # BANNER SET
10805. 
10806. # DATE TIME RUN ELP
10807. 
10808. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
10809. /* Xinclude "..\Display\BannerSet.MyDc"X */
10810. /* pause(1) */
10811. 
10812. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10813. 
10814. Title('!Heading!')
10815. /* pause(1) */
10816. 
10817. /* NOTE: Can't round or truncate to integer precision. */
10818. 
10819. pause(1)
10820. 
10821. 
10822. /* ---------------------------------------------------------- */
10823. /* Any Volume Regular Zones */
10824. /* ---------------------------------------------------------- */
10825. 
10826. /* ---------------------------------------------------------- */
10827. /* Zone IdeScripts Ide, Scripts, Support */
10828. /* ---------------------------------------------------------- */
10829. /* Zone IdeScripts Ide, Scripts, Support */
10830. 
10831. SetVariable(ZoneLabel, "!ZoneLabelIdeScripts!")
10832. SetVariable(ZoneDescription, "!ZoneDescriptionIdeScripts!")
10833. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpIdeScripts!")
10834. SetVariable(ZoneGapSize, "!ZoneGapSizeIdeScripts!")
10835. SetVariable(ZoneTypeSelect,'# IdeScripts start.
10836. # NotBlobsArchivesBu start.
10837. (not (
10838. # Blobs start.
10839. (
10840. # BlobsAndExceptions start.
10841. ( not(
10842.   FileName("*.bat")
10843.   or FileName("*.css")
10844.   or FileName("*.dll")
10845.   or FileName("*.exe")
10846.   or FileName("*.htm*")
10847.   or FileName("*.jar")
10848.   or FileName("*.js")
10849.   or FileName("*.script")
10850.   or FileName("*.wsf")
10851.   or (
10852. # Databases start.
10853. (
10854.   FileName("*.crypt*")
10855.   or FileName("*.db*")
10856.   or FileName("*.rdb*")
10857.   or FileName("*.dc*")
10858.   or FileName("*.dict*")
10859.   or FileName("*.?db*")
10860.   or FileName("*.?rdb*")
10861.   or FileName("*.md*")
10862.   or FileName("*.myd")
10863.   or FileName("*.ndf")
10864.   or FileName("*.ns?")
10865.   or FileName("*.pab")
10866.   or FileName("*.pst")
10867.   or FileName("*.sd?*")
10868.   or FileName("*.sq**")
10869.   or FileName("*.tmd")
10870.   or FileName("*.tps")
10871.   or FileName("*.tr*")
10872. )
10873. # Databases end.
10874. 
10875.     # BlobsAndExceptions
10876.     or 
10877. # Data start.
10878. (
10879.   DirectoryName("Data*")
10880.   or DirectoryName("Device*")
10881.   or DirectoryName("Export*")
10882.   or DirectoryName("Import*")
10883.   or DirectoryName("Log*")
10884.   or DirectoryName("*Log")
10885.   or DirectoryName("Maintenance*")
10886.   or DirectoryName("Rec*")
10887.   or DirectoryName("Sales*")
10888.   or DirectoryName("Search*")
10889.   or DirectoryName("User*")
10890. )
10891. # Data end.
10892. 
10893.     # BlobsAndExceptions
10894.   )
10895. ) )
10896. # BlobsAndExceptions end.
10897. 
10898. # Blobs
10899. ) and (
10900.   Size(BlobFileSize,0)
10901.   or (
10902.     FileName("*.arj")
10903.     or FileName("*.bup")
10904.     or FileName("*.bz2")
10905.     or FileName("*.chm")
10906.     or FileName("*.dvr-ms")
10907.     or FileName("*.gz")
10908.     or FileName("*.ifo")
10909.     or FileName("*.lzh")
10910.     or FileName("*.pdf")
10911.     or FileName("*.rpm")
10912.     or FileName("*.wmv")
10913.     or FileName("*.vob")
10914.     or FileName("*.z")
10915.   ) 
10916. )
10917. # Blobs end.
10918. 
10919. # NotBlobsArchivesBu
10920. or 
10921. # Archives start.
10922. (
10923.   DirectoryName("*Archive*")
10924.   or DirectoryName("*History*")
10925.   or DirectoryName("*Old")
10926.   or DirectoryName("* Old *")
10927.   or DirectoryName("Old *")
10928. 
10929.   or FileName("*.7z")
10930.   or FileName("*.cab")
10931.   or FileName("*.iso")
10932.   or FileName("*.msi")
10933.   or FileName("*.old")
10934.   or FileName("*.rar")
10935.   or FileName("*.tar")
10936.   or FileName("*.zip")
10937.   or
10938. # WinSysLow start.
10939. (
10940.   DirectoryName("$*")
10941.   or DirectoryName("0*")
10942.   or DirectoryName("1*")
10943.   or DirectoryName("2*")
10944.   or DirectoryName("3*")
10945.   or DirectoryName("4*")
10946.   or DirectoryName("5*")
10947.   or DirectoryName("6*")
10948.   or DirectoryName("7*")
10949.   or DirectoryName("8*")
10950.   or DirectoryName("9*")
10951. 
10952.   or DirectoryName("dllcache")
10953.   or DirectoryName("Downloaded Installations")
10954.   or DirectoryName("Ehome")
10955.   or DirectoryName("Fonts")
10956.   or DirectoryName("Help")
10957.   or DirectoryName("I386")
10958.   or DirectoryName("ie?updates")
10959.   or DirectoryName("Installer")
10960.   or DirectoryName("Installshield Installation Information")
10961.   or DirectoryName("IME")
10962.   or DirectoryName("*RECYCLE*")
10963.   or DirectoryName("ServicePackFiles")
10964.   or DirectoryName("SoftwareDistribution")
10965.   or DirectoryName("Speech")
10966.   or DirectoryName("Symbols")
10967.   or DirectoryName("System Volume Information")
10968.   or DirectoryName("windows.old")
10969. )
10970. # WinSysLow end.
10971. 
10972.   # Archives
10973. )
10974. # Archives end.
10975. 
10976. # NotBlobsArchivesBu
10977. or
10978. # Backups start.
10979. (
10980.   DirectoryName("*Backup*")
10981.   or DirectoryName("*Bu")
10982.   or DirectoryName("* Bu *")
10983.   or DirectoryName("Bu *")
10984. 
10985.   or FileName("*.bak")
10986.   or FileName("* - Copy*")
10987. )
10988. # Backups end.
10989. 
10990. # NotBlobsArchivesBu
10991. ) )
10992. # NotBlobsArchivesBu end.
10993. 
10994. # IdeScripts
10995. and ( 
10996. # Ide start.
10997. (
10998.     DirectoryName("Ide*")
10999.     or DirectoryName("Java*")
11000.     or DirectoryName("Os")
11001. )
11002. # Ide end.
11003. 
11004. # IdeScripts
11005. or  
11006. # Scripts start.
11007. (
11008.   DirectoryName("*Script*")
11009. )
11010. # Scripts end.
11011. 
11012. # IdeScripts
11013. )
11014. # IdeScripts end.
11015. ')
11016. 
11017. 	# Zone Do Header
11018. 
11019. # Zone When Started
11020. 
11021. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
11022. # Display Set Zone
11023. 
11024. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
11025. SetVariable(FileStepDescription,	"")
11026. 
11027. SetVariable(ZoneStepByLine, 			"Zone started.
11028. ")
11029. 
11030. # BANNER SET
11031. 
11032. # DATE TIME RUN ELP
11033. 
11034. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
11035. /* Xinclude "..\Display\BannerSet.MyDc"X */
11036. /* pause(1) */
11037. 
11038. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11039. 
11040. Title('!Heading!')
11041. /* pause(1) */
11042. 
11043. /* NOTE: Can't round or truncate to integer precision. */
11044. 
11045. AppendLogfile("!LogFileName!", "!Title!")
11046. 
11047. 
11048. 
11049. pause(1)
11050. 
11051. 
11052. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
11053. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
11054. 
11055. SetVariable(ZoneStepNoCurrent, 0)
11056. 
11057. 
11058. # Zone Do Current Clear
11059. 
11060. SetVariable(ZoneTypeSelectCurrent, 		"")
11061. 
11062. SetVariable(ZoneBeginCurrent, 			0)
11063. SetVariable(ZoneBeginPerCurrent, 		0)
11064. SetVariable(ZoneEndCurrent, 			0)
11065. SetVariable(ZoneEndPerCurrent, 			0)
11066. 
11067. SetVariable(ZoneSizeCurrent,			0)
11068. SetVariable(ZoneSizePerCurrent,			0)
11069. 
11070. SetVariable(ZoneGapRequestedCurrent,	0)
11071. SetVariable(ZoneGapRoundedCurrent, 		0)
11072. SetVariable(ZoneGapAdjustedCurrent, 	0)
11073. SetVariable(ZoneGapAvailableCurrent, 	0)
11074. SetVariable(ZoneGapCurrent,				0)
11075. SetVariable(ZoneGapUsedCurrent, 		0)
11076. 
11077. SetVariable(ZoneGapActualCurrent, 		0)
11078. SetVariable(ZoneGapActualPerCurrent, 	0)
11079. 
11080. SetVariable(ZoneSizeActual, 			0)
11081. SetVariable(ZoneSizeActualCurrent,		0)
11082. 
11083. SetVariable(ZoneEndActual, 				0)
11084. SetVariable(ZoneEndActualCurrent,		0)			
11085. SetVariable(ZoneSizeActualPerCurrent, 	0)
11086.       
11087. SetVariable(ZoneFilesFolders,			0)
11088. SetVariable(ZoneFilesFoldersPer,		0) 
11089. 
11090. SetVariable(ZoneFragments,				0)
11091. SetVariable(ZoneFragmentsPer,			0) 
11092. 		
11093. SetVariable(ZoneEndActualCurrent, 		0)
11094. SetVariable(ZoneEndActualPerCurrent, 	0)
11095. 
11096. # Gap Calculation Methodology:
11097. 	# Requested
11098. 	SetVariable(GapRequested, 			0) 
11099. 	SetVariable(GapRequestedStd, 		0) 
11100. 	SetVariable(GapRequestedMft, 		0) 
11101. 	SetVariable(GapRequestedOs, 		0) 
11102. 	SetVariable(GapRequestedOriginal, 	0) 
11103. 	
11104. 	# Gap Adjustments
11105. 	SetVariable(GapRounded, 			0)
11106. 	# SetVariable(GapAdjusted, 			0)
11107. 	SetVariable(GapAvailable, 			0)
11108. 	SetVariable(GapCurrent, 			0)
11109. 	SetVariable(GapActual, 				0)
11110. 	SetVariable(GapUsed, 				0)
11111. 	
11112. 	# Gap Adjustments
11113. 	SetVariable(GapRoundedLoc, 			0)
11114. 	# SetVariable(GapAdjustedLoc, 		0)
11115. 	SetVariable(GapAvailableLoc, 		0)
11116. 	SetVariable(GapCurrentLoc, 			0)
11117. 	SetVariable(GapActualLoc,			0)
11118. 	SetVariable(GapUsedLoc,				0)
11119. 	
11120. 	# Space usage
11121. 	SetVariable(ZoneFreePerRequested, 	0)
11122. 	SetVariable(ZoneFreePerUsed, 		0)
11123. 
11124. # Gap Size & Rounding
11125. 	SetVariable(ZoneGapSizePer, 		0)
11126. 	SetVariable(ZoneVolRoundUpPer, 		0)
11127. 	
11128. 	# Free Space
11129. 	SetVariable(ZoneFreeUsedPer, 		0)
11130. 	SetVariable(ZoneFreeRequestedPer, 	0)
11131. 
11132. 
11133. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
11134. 
11135. # Footer:
11136. SetVariable(ZoneFooter, "----------------------------------------------------------
11137. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
11138. 
11139. Statistics Report:
11140. ------------------
11141.    Size:  
11142.    ------------------------
11143.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11144.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11145.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11146. 
11147.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11148.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11149. 
11150.    Location:
11151.    ------------------------
11152.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11153.              Files End: !ZoneEndCurrent!
11154.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11155.       
11156.    Gap Settings:
11157.    ------------------------
11158.          Gap Requested: !ZoneGapSizePer!%
11159.       Volume Rounding: !ZoneVolRoundUpPer!%
11160.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11161.                  
11162.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
11163.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
11164.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
11165.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
11166.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
11167.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
11168.      
11169.    Free Space after Zone:
11170.    ------------------------
11171.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11172.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11173.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11174. 
11175. Directory and Files Select:
11176. ---------------------------
11177. !ZoneTypeSelectCurrent!               
11178. ---------------------------
11179. ----------------------------------------------------------
11180. ")
11181. 
11182. # BANNER SET
11183. 
11184. # DATE TIME RUN ELP
11185. 
11186. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
11187. /* Xinclude "..\Display\BannerSet.MyDc"X */
11188. /* pause(1) */
11189. 
11190. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11191. 
11192. Title('!Heading!')
11193. /* pause(1) */
11194. 
11195. /* NOTE: Can't round or truncate to integer precision. */
11196. 
11197. AppendLogfile("!LogFileName!", "!Title!")
11198. 
11199. 
11200. 
11201. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
11202. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
11203. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:53")
11204. 
11205. SetVariable(ZoneListByLine, "!ZoneListByLine!
11206. Zone: !ZoneNoCurrent! 2021-11-09 10:47:53 0:00:05 !ZoneLabel! !ZoneDescription!")
11207. 
11208. 
11209. /* Fixed Zone Position Handling */
11210. /* Literal number: */
11211. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
11212. /* Percentage of disk: */
11213. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
11214. /* Gap */
11215. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
11216. 
11217. /* ---------------------------------------------------------- */
11218. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
11219. # FILE STEP
11220. 
11221. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11222. 
11223. /* add message and move to a new line. */
11224. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11225. ")
11226. 
11227. /* display the line. (hopefully.) */
11228. # Zone Footer Set Statistics Window Text
11229. 
11230. SetStatisticsWindowText("----------------------------------------------------------
11231. Zones Processed: 
11232. ----------------------------------------------------------
11233. !ZoneListByLine!
11234. ----------------------------------------------------------
11235. Zone Processing Step:
11236. !ZoneStepByLine!    
11237. ----------------------------------------------------------
11238. Current Zone:
11239. !ZoneFooter!
11240. ----------------------------------------------------------
11241. Volume Statistics:
11242. !VolumeStatisticsDetail!
11243. ----------------------------------------------------------
11244. Zone Detailed Report:
11245. ----------------------------------------------------------
11246. !ZoneStatisticsDetail!
11247. ----------------------------------------------------------
11248. ")
11249. 
11250. 
11251. 
11252. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11253. 
11254. # BANNER SET
11255. 
11256. # DATE TIME RUN ELP
11257. 
11258. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
11259. /* Xinclude "..\Display\BannerSet.MyDc"X */
11260. /* pause(1) */
11261. 
11262. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11263. 
11264. Title('!Heading!')
11265. /* pause(1) */
11266. 
11267. /* NOTE: Can't round or truncate to integer precision. */
11268. 
11269. pause(1)
11270. 
11271. # your stuff HERE (X)... pre file select code.
11272. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
11273. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
11274. 	# (X)
11275. 
11276. FileSelect
11277. 
11278. 	# your stuff can't really go here (errors.)
11279. 	# maybe for some reason I don't know of...
11280. 	
11281. 	# Actions next...
11282. 	# IdeScripts start.
11283. # NotBlobsArchivesBu start.
11284. (not (
11285. # Blobs start.
11286. (
11287. # BlobsAndExceptions start.
11288. ( not(
11289.   FileName("*.bat")
11290.   or FileName("*.css")
11291.   or FileName("*.dll")
11292.   or FileName("*.exe")
11293.   or FileName("*.htm*")
11294.   or FileName("*.jar")
11295.   or FileName("*.js")
11296.   or FileName("*.script")
11297.   or FileName("*.wsf")
11298.   or (
11299. # Databases start.
11300. (
11301.   FileName("*.crypt*")
11302.   or FileName("*.db*")
11303.   or FileName("*.rdb*")
11304.   or FileName("*.dc*")
11305.   or FileName("*.dict*")
11306.   or FileName("*.?db*")
11307.   or FileName("*.?rdb*")
11308.   or FileName("*.md*")
11309.   or FileName("*.myd")
11310.   or FileName("*.ndf")
11311.   or FileName("*.ns?")
11312.   or FileName("*.pab")
11313.   or FileName("*.pst")
11314.   or FileName("*.sd?*")
11315.   or FileName("*.sq**")
11316.   or FileName("*.tmd")
11317.   or FileName("*.tps")
11318.   or FileName("*.tr*")
11319. )
11320. # Databases end.
11321. 
11322.     # BlobsAndExceptions
11323.     or 
11324. # Data start.
11325. (
11326.   DirectoryName("Data*")
11327.   or DirectoryName("Device*")
11328.   or DirectoryName("Export*")
11329.   or DirectoryName("Import*")
11330.   or DirectoryName("Log*")
11331.   or DirectoryName("*Log")
11332.   or DirectoryName("Maintenance*")
11333.   or DirectoryName("Rec*")
11334.   or DirectoryName("Sales*")
11335.   or DirectoryName("Search*")
11336.   or DirectoryName("User*")
11337. )
11338. # Data end.
11339. 
11340.     # BlobsAndExceptions
11341.   )
11342. ) )
11343. # BlobsAndExceptions end.
11344. 
11345. # Blobs
11346. ) and (
11347.   Size(BlobFileSize,0)
11348.   or (
11349.     FileName("*.arj")
11350.     or FileName("*.bup")
11351.     or FileName("*.bz2")
11352.     or FileName("*.chm")
11353.     or FileName("*.dvr-ms")
11354.     or FileName("*.gz")
11355.     or FileName("*.ifo")
11356.     or FileName("*.lzh")
11357.     or FileName("*.pdf")
11358.     or FileName("*.rpm")
11359.     or FileName("*.wmv")
11360.     or FileName("*.vob")
11361.     or FileName("*.z")
11362.   ) 
11363. )
11364. # Blobs end.
11365. 
11366. # NotBlobsArchivesBu
11367. or 
11368. # Archives start.
11369. (
11370.   DirectoryName("*Archive*")
11371.   or DirectoryName("*History*")
11372.   or DirectoryName("*Old")
11373.   or DirectoryName("* Old *")
11374.   or DirectoryName("Old *")
11375. 
11376.   or FileName("*.7z")
11377.   or FileName("*.cab")
11378.   or FileName("*.iso")
11379.   or FileName("*.msi")
11380.   or FileName("*.old")
11381.   or FileName("*.rar")
11382.   or FileName("*.tar")
11383.   or FileName("*.zip")
11384.   or
11385. # WinSysLow start.
11386. (
11387.   DirectoryName("$*")
11388.   or DirectoryName("0*")
11389.   or DirectoryName("1*")
11390.   or DirectoryName("2*")
11391.   or DirectoryName("3*")
11392.   or DirectoryName("4*")
11393.   or DirectoryName("5*")
11394.   or DirectoryName("6*")
11395.   or DirectoryName("7*")
11396.   or DirectoryName("8*")
11397.   or DirectoryName("9*")
11398. 
11399.   or DirectoryName("dllcache")
11400.   or DirectoryName("Downloaded Installations")
11401.   or DirectoryName("Ehome")
11402.   or DirectoryName("Fonts")
11403.   or DirectoryName("Help")
11404.   or DirectoryName("I386")
11405.   or DirectoryName("ie?updates")
11406.   or DirectoryName("Installer")
11407.   or DirectoryName("Installshield Installation Information")
11408.   or DirectoryName("IME")
11409.   or DirectoryName("*RECYCLE*")
11410.   or DirectoryName("ServicePackFiles")
11411.   or DirectoryName("SoftwareDistribution")
11412.   or DirectoryName("Speech")
11413.   or DirectoryName("Symbols")
11414.   or DirectoryName("System Volume Information")
11415.   or DirectoryName("windows.old")
11416. )
11417. # WinSysLow end.
11418. 
11419.   # Archives
11420. )
11421. # Archives end.
11422. 
11423. # NotBlobsArchivesBu
11424. or
11425. # Backups start.
11426. (
11427.   DirectoryName("*Backup*")
11428.   or DirectoryName("*Bu")
11429.   or DirectoryName("* Bu *")
11430.   or DirectoryName("Bu *")
11431. 
11432.   or FileName("*.bak")
11433.   or FileName("* - Copy*")
11434. )
11435. # Backups end.
11436. 
11437. # NotBlobsArchivesBu
11438. ) )
11439. # NotBlobsArchivesBu end.
11440. 
11441. # IdeScripts
11442. and ( 
11443. # Ide start.
11444. (
11445.     DirectoryName("Ide*")
11446.     or DirectoryName("Java*")
11447.     or DirectoryName("Os")
11448. )
11449. # Ide end.
11450. 
11451. # IdeScripts
11452. or  
11453. # Scripts start.
11454. (
11455.   DirectoryName("*Script*")
11456. )
11457. # Scripts end.
11458. 
11459. # IdeScripts
11460. )
11461. # IdeScripts end.
11462. 
11463. 		SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
11464. 
11465. 	# Zone Do Footer
11466. 
11467. /* ---------------------------------------------------------- */
11468. # File Select
11469. 	# Select Statments
11470. # File Actions 
11471. 	# Standard or OS File Actions.
11472. 	# Resume...
11473. 	
11474. 	# your stuff HERE (X)... post zone (file) file actions code.
11475. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
11476. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
11477. 		# (X)
11478. 		
11479. 		/* ??? Set window? */
11480. 	
11481. 	# ADD THE GAP
11482. 		
11483. # Vacate (good for diagnostics)
11484. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
11485. 
11486. # DoNotVacate - DO NOT Vacate (recommended)
11487. 
11488. # Vacate
11489. /* AddGap(GapUsedLoc) */
11490. 
11491. # DO Not Vacate
11492. AddGap(GapUsedLoc, DoNotVacate) 
11493. 	
11494. 	
11495. /* ---------------------------------------------------------- */
11496. # (failed) TEST for boolean logic.
11497. 
11498. /* It should work in the gap calculations for turning options */
11499. /* on and off but it will NOT work here. */
11500. 
11501. /* Boolean setting X or FlagX. */
11502. /* Where X will be on or off: */
11503. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
11504. /*      For ON:  (X  *  FlagAny) */
11505. 
11506. /* 1) Failed, zero gap overrode the previous one. */
11507. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
11508. /* AddGap(GapUsedTemp) */ 
11509. 
11510. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
11511. /* AddGap(GapUsedTemp, DoNotVacate) */ 
11512. 
11513. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
11514. 
11515. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
11516. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
11517. /* AddGap(GapUsedTemp) */ 
11518. 
11519. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
11520. /* AddGap(GapUsedTemp, DoNotVacate) */ 
11521. 
11522. /* ---------------------------------------------------------- */
11523. 
11524. # Vacate
11525. /* AddGap(GapUsed) */
11526. 
11527. # DO NOT Vacate (recommended)
11528. /* AddGap(GapUsed, DoNotVacate) */ 
11529. 	
11530. 
11531. 		
11532. # 
11533. FileEnd
11534. /* ---------------------------------------------------------- */
11535. 
11536. # your stuff HERE (X)... post zone (file) code.
11537. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
11538. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
11539. 	# (X)
11540. 
11541. SetVariable(FileStepDescription,"Zone finished, reporting.")
11542. # FILE STEP
11543. 
11544. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11545. 
11546. /* add message and move to a new line. */
11547. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11548. ")
11549. 
11550. /* display the line. (hopefully.) */
11551. # Zone Footer Set Statistics Window Text
11552. 
11553. SetStatisticsWindowText("----------------------------------------------------------
11554. Zones Processed: 
11555. ----------------------------------------------------------
11556. !ZoneListByLine!
11557. ----------------------------------------------------------
11558. Zone Processing Step:
11559. !ZoneStepByLine!    
11560. ----------------------------------------------------------
11561. Current Zone:
11562. !ZoneFooter!
11563. ----------------------------------------------------------
11564. Volume Statistics:
11565. !VolumeStatisticsDetail!
11566. ----------------------------------------------------------
11567. Zone Detailed Report:
11568. ----------------------------------------------------------
11569. !ZoneStatisticsDetail!
11570. ----------------------------------------------------------
11571. ")
11572. 
11573. 
11574. 
11575. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11576. 
11577. # BANNER SET
11578. 
11579. # DATE TIME RUN ELP
11580. 
11581. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
11582. /* Xinclude "..\Display\BannerSet.MyDc"X */
11583. /* pause(1) */
11584. 
11585. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11586. 
11587. Title('!Heading!')
11588. /* pause(1) */
11589. 
11590. /* NOTE: Can't round or truncate to integer precision. */
11591. 
11592. pause(1)
11593. 
11594. # Zone When Finished
11595. 
11596. # BANNER SET
11597. 
11598. # DATE TIME RUN ELP
11599. 
11600. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:53 0:00:05")
11601. /* Xinclude "..\Display\BannerSet.MyDc"X */
11602. /* pause(1) */
11603. 
11604. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11605. 
11606. Title('!Heading!')
11607. /* pause(1) */
11608. 
11609. /* NOTE: Can't round or truncate to integer precision. */
11610. 
11611. AppendLogfile("!LogFileName!", "!Title!")
11612. 
11613. 
11614. 
11615. # Zone Statistics	
11616. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
11617. 
11618. # Footer:
11619. SetVariable(ZoneFooter, "----------------------------------------------------------
11620. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:53
11621. 
11622. Statistics Report:
11623. ------------------
11624.    Size:  
11625.    ------------------------
11626.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11627.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11628.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11629. 
11630.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11631.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11632. 
11633.    Location:
11634.    ------------------------
11635.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11636.              Files End: !ZoneEndCurrent!
11637.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11638.       
11639.    Gap Settings:
11640.    ------------------------
11641.          Gap Requested: !ZoneGapSizePer!%
11642.       Volume Rounding: !ZoneVolRoundUpPer!%
11643.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11644.                  
11645.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
11646.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
11647.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
11648.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
11649.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
11650.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
11651.      
11652.    Free Space after Zone:
11653.    ------------------------
11654.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11655.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11656.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11657. 
11658. Directory and Files Select:
11659. ---------------------------
11660. !ZoneTypeSelectCurrent!               
11661. ---------------------------
11662. ----------------------------------------------------------
11663. ")
11664. 
11665. AppendLogfile("!LogFileName!", ".")
11666. AppendLogfile("!LogFileName!", "!ZoneFooter!")
11667. AppendLogfile("!LogFileName!", ".")
11668. 
11669. # Zone Footer Set Statistics Window Text
11670. 
11671. SetStatisticsWindowText("----------------------------------------------------------
11672. Zones Processed: 
11673. ----------------------------------------------------------
11674. !ZoneListByLine!
11675. ----------------------------------------------------------
11676. Zone Processing Step:
11677. !ZoneStepByLine!    
11678. ----------------------------------------------------------
11679. Current Zone:
11680. !ZoneFooter!
11681. ----------------------------------------------------------
11682. Volume Statistics:
11683. !VolumeStatisticsDetail!
11684. ----------------------------------------------------------
11685. Zone Detailed Report:
11686. ----------------------------------------------------------
11687. !ZoneStatisticsDetail!
11688. ----------------------------------------------------------
11689. ")
11690. 
11691. 
11692. 
11693. /* pause() */
11694. /* pause() */
11695. 
11696. 
11697. 
11698. 
11699. /* ---------------------------------------------------------- */
11700. 
11701. /* ---------------------------------------------------------- */
11702. /* Zone DevToDo */
11703. /* ---------------------------------------------------------- */
11704. /* Zone DevToDo */
11705. 
11706. SetVariable(ZoneLabel, "!ZoneLabelDevToDo!")
11707. SetVariable(ZoneDescription, "!ZoneDescriptionDevToDo!")
11708. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpDevToDo!")
11709. SetVariable(ZoneGapSize, "!ZoneGapSizeDevToDo!")
11710. SetVariable(ZoneTypeSelect,'# DevToDo start.
11711. # NotBlobsArchivesBu start.
11712. (not (
11713. # Blobs start.
11714. (
11715. # BlobsAndExceptions start.
11716. ( not(
11717.   FileName("*.bat")
11718.   or FileName("*.css")
11719.   or FileName("*.dll")
11720.   or FileName("*.exe")
11721.   or FileName("*.htm*")
11722.   or FileName("*.jar")
11723.   or FileName("*.js")
11724.   or FileName("*.script")
11725.   or FileName("*.wsf")
11726.   or (
11727. # Databases start.
11728. (
11729.   FileName("*.crypt*")
11730.   or FileName("*.db*")
11731.   or FileName("*.rdb*")
11732.   or FileName("*.dc*")
11733.   or FileName("*.dict*")
11734.   or FileName("*.?db*")
11735.   or FileName("*.?rdb*")
11736.   or FileName("*.md*")
11737.   or FileName("*.myd")
11738.   or FileName("*.ndf")
11739.   or FileName("*.ns?")
11740.   or FileName("*.pab")
11741.   or FileName("*.pst")
11742.   or FileName("*.sd?*")
11743.   or FileName("*.sq**")
11744.   or FileName("*.tmd")
11745.   or FileName("*.tps")
11746.   or FileName("*.tr*")
11747. )
11748. # Databases end.
11749. 
11750.     # BlobsAndExceptions
11751.     or 
11752. # Data start.
11753. (
11754.   DirectoryName("Data*")
11755.   or DirectoryName("Device*")
11756.   or DirectoryName("Export*")
11757.   or DirectoryName("Import*")
11758.   or DirectoryName("Log*")
11759.   or DirectoryName("*Log")
11760.   or DirectoryName("Maintenance*")
11761.   or DirectoryName("Rec*")
11762.   or DirectoryName("Sales*")
11763.   or DirectoryName("Search*")
11764.   or DirectoryName("User*")
11765. )
11766. # Data end.
11767. 
11768.     # BlobsAndExceptions
11769.   )
11770. ) )
11771. # BlobsAndExceptions end.
11772. 
11773. # Blobs
11774. ) and (
11775.   Size(BlobFileSize,0)
11776.   or (
11777.     FileName("*.arj")
11778.     or FileName("*.bup")
11779.     or FileName("*.bz2")
11780.     or FileName("*.chm")
11781.     or FileName("*.dvr-ms")
11782.     or FileName("*.gz")
11783.     or FileName("*.ifo")
11784.     or FileName("*.lzh")
11785.     or FileName("*.pdf")
11786.     or FileName("*.rpm")
11787.     or FileName("*.wmv")
11788.     or FileName("*.vob")
11789.     or FileName("*.z")
11790.   ) 
11791. )
11792. # Blobs end.
11793. 
11794. # NotBlobsArchivesBu
11795. or 
11796. # Archives start.
11797. (
11798.   DirectoryName("*Archive*")
11799.   or DirectoryName("*History*")
11800.   or DirectoryName("*Old")
11801.   or DirectoryName("* Old *")
11802.   or DirectoryName("Old *")
11803. 
11804.   or FileName("*.7z")
11805.   or FileName("*.cab")
11806.   or FileName("*.iso")
11807.   or FileName("*.msi")
11808.   or FileName("*.old")
11809.   or FileName("*.rar")
11810.   or FileName("*.tar")
11811.   or FileName("*.zip")
11812.   or
11813. # WinSysLow start.
11814. (
11815.   DirectoryName("$*")
11816.   or DirectoryName("0*")
11817.   or DirectoryName("1*")
11818.   or DirectoryName("2*")
11819.   or DirectoryName("3*")
11820.   or DirectoryName("4*")
11821.   or DirectoryName("5*")
11822.   or DirectoryName("6*")
11823.   or DirectoryName("7*")
11824.   or DirectoryName("8*")
11825.   or DirectoryName("9*")
11826. 
11827.   or DirectoryName("dllcache")
11828.   or DirectoryName("Downloaded Installations")
11829.   or DirectoryName("Ehome")
11830.   or DirectoryName("Fonts")
11831.   or DirectoryName("Help")
11832.   or DirectoryName("I386")
11833.   or DirectoryName("ie?updates")
11834.   or DirectoryName("Installer")
11835.   or DirectoryName("Installshield Installation Information")
11836.   or DirectoryName("IME")
11837.   or DirectoryName("*RECYCLE*")
11838.   or DirectoryName("ServicePackFiles")
11839.   or DirectoryName("SoftwareDistribution")
11840.   or DirectoryName("Speech")
11841.   or DirectoryName("Symbols")
11842.   or DirectoryName("System Volume Information")
11843.   or DirectoryName("windows.old")
11844. )
11845. # WinSysLow end.
11846. 
11847.   # Archives
11848. )
11849. # Archives end.
11850. 
11851. # NotBlobsArchivesBu
11852. or
11853. # Backups start.
11854. (
11855.   DirectoryName("*Backup*")
11856.   or DirectoryName("*Bu")
11857.   or DirectoryName("* Bu *")
11858.   or DirectoryName("Bu *")
11859. 
11860.   or FileName("*.bak")
11861.   or FileName("* - Copy*")
11862. )
11863. # Backups end.
11864. 
11865. # NotBlobsArchivesBu
11866. ) )
11867. # NotBlobsArchivesBu end.
11868. 
11869. # DevToDo
11870. and ( 
11871. # Dev start.
11872. (
11873.   DirectoryName("*Dev") 
11874.   or DirectoryName("Dev *") 
11875.   or DirectoryName("*Development*") 
11876.   or DirectoryName("DsVs*") 
11877.   or DirectoryName("Srt*") 
11878. )
11879. # Dev end.
11880. 
11881. # DevToDo
11882. or 
11883. # ToDo start.
11884. (
11885.   DirectoryName("*ToDo*")
11886. )
11887. # ToDo end.
11888. 
11889. # DevToDo
11890. )
11891. # DevToDo end.
11892. ')
11893. 
11894. 	# Zone Do Header
11895. 
11896. # Zone When Started
11897. 
11898. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
11899. # Display Set Zone
11900. 
11901. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
11902. SetVariable(FileStepDescription,	"")
11903. 
11904. SetVariable(ZoneStepByLine, 			"Zone started.
11905. ")
11906. 
11907. # BANNER SET
11908. 
11909. # DATE TIME RUN ELP
11910. 
11911. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:54 0:00:06")
11912. /* Xinclude "..\Display\BannerSet.MyDc"X */
11913. /* pause(1) */
11914. 
11915. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11916. 
11917. Title('!Heading!')
11918. /* pause(1) */
11919. 
11920. /* NOTE: Can't round or truncate to integer precision. */
11921. 
11922. AppendLogfile("!LogFileName!", "!Title!")
11923. 
11924. 
11925. 
11926. pause(1)
11927. 
11928. 
11929. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
11930. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
11931. 
11932. SetVariable(ZoneStepNoCurrent, 0)
11933. 
11934. 
11935. # Zone Do Current Clear
11936. 
11937. SetVariable(ZoneTypeSelectCurrent, 		"")
11938. 
11939. SetVariable(ZoneBeginCurrent, 			0)
11940. SetVariable(ZoneBeginPerCurrent, 		0)
11941. SetVariable(ZoneEndCurrent, 			0)
11942. SetVariable(ZoneEndPerCurrent, 			0)
11943. 
11944. SetVariable(ZoneSizeCurrent,			0)
11945. SetVariable(ZoneSizePerCurrent,			0)
11946. 
11947. SetVariable(ZoneGapRequestedCurrent,	0)
11948. SetVariable(ZoneGapRoundedCurrent, 		0)
11949. SetVariable(ZoneGapAdjustedCurrent, 	0)
11950. SetVariable(ZoneGapAvailableCurrent, 	0)
11951. SetVariable(ZoneGapCurrent,				0)
11952. SetVariable(ZoneGapUsedCurrent, 		0)
11953. 
11954. SetVariable(ZoneGapActualCurrent, 		0)
11955. SetVariable(ZoneGapActualPerCurrent, 	0)
11956. 
11957. SetVariable(ZoneSizeActual, 			0)
11958. SetVariable(ZoneSizeActualCurrent,		0)
11959. 
11960. SetVariable(ZoneEndActual, 				0)
11961. SetVariable(ZoneEndActualCurrent,		0)			
11962. SetVariable(ZoneSizeActualPerCurrent, 	0)
11963.       
11964. SetVariable(ZoneFilesFolders,			0)
11965. SetVariable(ZoneFilesFoldersPer,		0) 
11966. 
11967. SetVariable(ZoneFragments,				0)
11968. SetVariable(ZoneFragmentsPer,			0) 
11969. 		
11970. SetVariable(ZoneEndActualCurrent, 		0)
11971. SetVariable(ZoneEndActualPerCurrent, 	0)
11972. 
11973. # Gap Calculation Methodology:
11974. 	# Requested
11975. 	SetVariable(GapRequested, 			0) 
11976. 	SetVariable(GapRequestedStd, 		0) 
11977. 	SetVariable(GapRequestedMft, 		0) 
11978. 	SetVariable(GapRequestedOs, 		0) 
11979. 	SetVariable(GapRequestedOriginal, 	0) 
11980. 	
11981. 	# Gap Adjustments
11982. 	SetVariable(GapRounded, 			0)
11983. 	# SetVariable(GapAdjusted, 			0)
11984. 	SetVariable(GapAvailable, 			0)
11985. 	SetVariable(GapCurrent, 			0)
11986. 	SetVariable(GapActual, 				0)
11987. 	SetVariable(GapUsed, 				0)
11988. 	
11989. 	# Gap Adjustments
11990. 	SetVariable(GapRoundedLoc, 			0)
11991. 	# SetVariable(GapAdjustedLoc, 		0)
11992. 	SetVariable(GapAvailableLoc, 		0)
11993. 	SetVariable(GapCurrentLoc, 			0)
11994. 	SetVariable(GapActualLoc,			0)
11995. 	SetVariable(GapUsedLoc,				0)
11996. 	
11997. 	# Space usage
11998. 	SetVariable(ZoneFreePerRequested, 	0)
11999. 	SetVariable(ZoneFreePerUsed, 		0)
12000. 
12001. # Gap Size & Rounding
12002. 	SetVariable(ZoneGapSizePer, 		0)
12003. 	SetVariable(ZoneVolRoundUpPer, 		0)
12004. 	
12005. 	# Free Space
12006. 	SetVariable(ZoneFreeUsedPer, 		0)
12007. 	SetVariable(ZoneFreeRequestedPer, 	0)
12008. 
12009. 
12010. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
12011. 
12012. # Footer:
12013. SetVariable(ZoneFooter, "----------------------------------------------------------
12014. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:54
12015. 
12016. Statistics Report:
12017. ------------------
12018.    Size:  
12019.    ------------------------
12020.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12021.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12022.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12023. 
12024.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12025.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12026. 
12027.    Location:
12028.    ------------------------
12029.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12030.              Files End: !ZoneEndCurrent!
12031.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12032.       
12033.    Gap Settings:
12034.    ------------------------
12035.          Gap Requested: !ZoneGapSizePer!%
12036.       Volume Rounding: !ZoneVolRoundUpPer!%
12037.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12038.                  
12039.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
12040.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
12041.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
12042.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
12043.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
12044.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
12045.      
12046.    Free Space after Zone:
12047.    ------------------------
12048.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12049.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12050.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12051. 
12052. Directory and Files Select:
12053. ---------------------------
12054. !ZoneTypeSelectCurrent!               
12055. ---------------------------
12056. ----------------------------------------------------------
12057. ")
12058. 
12059. # BANNER SET
12060. 
12061. # DATE TIME RUN ELP
12062. 
12063. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:54 0:00:06")
12064. /* Xinclude "..\Display\BannerSet.MyDc"X */
12065. /* pause(1) */
12066. 
12067. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12068. 
12069. Title('!Heading!')
12070. /* pause(1) */
12071. 
12072. /* NOTE: Can't round or truncate to integer precision. */
12073. 
12074. AppendLogfile("!LogFileName!", "!Title!")
12075. 
12076. 
12077. 
12078. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
12079. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
12080. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:54")
12081. 
12082. SetVariable(ZoneListByLine, "!ZoneListByLine!
12083. Zone: !ZoneNoCurrent! 2021-11-09 10:47:54 0:00:06 !ZoneLabel! !ZoneDescription!")
12084. 
12085. 
12086. /* Fixed Zone Position Handling */
12087. /* Literal number: */
12088. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
12089. /* Percentage of disk: */
12090. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
12091. /* Gap */
12092. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
12093. 
12094. /* ---------------------------------------------------------- */
12095. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
12096. # FILE STEP
12097. 
12098. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12099. 
12100. /* add message and move to a new line. */
12101. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12102. ")
12103. 
12104. /* display the line. (hopefully.) */
12105. # Zone Footer Set Statistics Window Text
12106. 
12107. SetStatisticsWindowText("----------------------------------------------------------
12108. Zones Processed: 
12109. ----------------------------------------------------------
12110. !ZoneListByLine!
12111. ----------------------------------------------------------
12112. Zone Processing Step:
12113. !ZoneStepByLine!    
12114. ----------------------------------------------------------
12115. Current Zone:
12116. !ZoneFooter!
12117. ----------------------------------------------------------
12118. Volume Statistics:
12119. !VolumeStatisticsDetail!
12120. ----------------------------------------------------------
12121. Zone Detailed Report:
12122. ----------------------------------------------------------
12123. !ZoneStatisticsDetail!
12124. ----------------------------------------------------------
12125. ")
12126. 
12127. 
12128. 
12129. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12130. 
12131. # BANNER SET
12132. 
12133. # DATE TIME RUN ELP
12134. 
12135. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:54 0:00:06")
12136. /* Xinclude "..\Display\BannerSet.MyDc"X */
12137. /* pause(1) */
12138. 
12139. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12140. 
12141. Title('!Heading!')
12142. /* pause(1) */
12143. 
12144. /* NOTE: Can't round or truncate to integer precision. */
12145. 
12146. pause(1)
12147. 
12148. # your stuff HERE (X)... pre file select code.
12149. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
12150. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12151. 	# (X)
12152. 
12153. FileSelect
12154. 
12155. 	# your stuff can't really go here (errors.)
12156. 	# maybe for some reason I don't know of...
12157. 	
12158. 	# Actions next...
12159. 	# DevToDo start.
12160. # NotBlobsArchivesBu start.
12161. (not (
12162. # Blobs start.
12163. (
12164. # BlobsAndExceptions start.
12165. ( not(
12166.   FileName("*.bat")
12167.   or FileName("*.css")
12168.   or FileName("*.dll")
12169.   or FileName("*.exe")
12170.   or FileName("*.htm*")
12171.   or FileName("*.jar")
12172.   or FileName("*.js")
12173.   or FileName("*.script")
12174.   or FileName("*.wsf")
12175.   or (
12176. # Databases start.
12177. (
12178.   FileName("*.crypt*")
12179.   or FileName("*.db*")
12180.   or FileName("*.rdb*")
12181.   or FileName("*.dc*")
12182.   or FileName("*.dict*")
12183.   or FileName("*.?db*")
12184.   or FileName("*.?rdb*")
12185.   or FileName("*.md*")
12186.   or FileName("*.myd")
12187.   or FileName("*.ndf")
12188.   or FileName("*.ns?")
12189.   or FileName("*.pab")
12190.   or FileName("*.pst")
12191.   or FileName("*.sd?*")
12192.   or FileName("*.sq**")
12193.   or FileName("*.tmd")
12194.   or FileName("*.tps")
12195.   or FileName("*.tr*")
12196. )
12197. # Databases end.
12198. 
12199.     # BlobsAndExceptions
12200.     or 
12201. # Data start.
12202. (
12203.   DirectoryName("Data*")
12204.   or DirectoryName("Device*")
12205.   or DirectoryName("Export*")
12206.   or DirectoryName("Import*")
12207.   or DirectoryName("Log*")
12208.   or DirectoryName("*Log")
12209.   or DirectoryName("Maintenance*")
12210.   or DirectoryName("Rec*")
12211.   or DirectoryName("Sales*")
12212.   or DirectoryName("Search*")
12213.   or DirectoryName("User*")
12214. )
12215. # Data end.
12216. 
12217.     # BlobsAndExceptions
12218.   )
12219. ) )
12220. # BlobsAndExceptions end.
12221. 
12222. # Blobs
12223. ) and (
12224.   Size(BlobFileSize,0)
12225.   or (
12226.     FileName("*.arj")
12227.     or FileName("*.bup")
12228.     or FileName("*.bz2")
12229.     or FileName("*.chm")
12230.     or FileName("*.dvr-ms")
12231.     or FileName("*.gz")
12232.     or FileName("*.ifo")
12233.     or FileName("*.lzh")
12234.     or FileName("*.pdf")
12235.     or FileName("*.rpm")
12236.     or FileName("*.wmv")
12237.     or FileName("*.vob")
12238.     or FileName("*.z")
12239.   ) 
12240. )
12241. # Blobs end.
12242. 
12243. # NotBlobsArchivesBu
12244. or 
12245. # Archives start.
12246. (
12247.   DirectoryName("*Archive*")
12248.   or DirectoryName("*History*")
12249.   or DirectoryName("*Old")
12250.   or DirectoryName("* Old *")
12251.   or DirectoryName("Old *")
12252. 
12253.   or FileName("*.7z")
12254.   or FileName("*.cab")
12255.   or FileName("*.iso")
12256.   or FileName("*.msi")
12257.   or FileName("*.old")
12258.   or FileName("*.rar")
12259.   or FileName("*.tar")
12260.   or FileName("*.zip")
12261.   or
12262. # WinSysLow start.
12263. (
12264.   DirectoryName("$*")
12265.   or DirectoryName("0*")
12266.   or DirectoryName("1*")
12267.   or DirectoryName("2*")
12268.   or DirectoryName("3*")
12269.   or DirectoryName("4*")
12270.   or DirectoryName("5*")
12271.   or DirectoryName("6*")
12272.   or DirectoryName("7*")
12273.   or DirectoryName("8*")
12274.   or DirectoryName("9*")
12275. 
12276.   or DirectoryName("dllcache")
12277.   or DirectoryName("Downloaded Installations")
12278.   or DirectoryName("Ehome")
12279.   or DirectoryName("Fonts")
12280.   or DirectoryName("Help")
12281.   or DirectoryName("I386")
12282.   or DirectoryName("ie?updates")
12283.   or DirectoryName("Installer")
12284.   or DirectoryName("Installshield Installation Information")
12285.   or DirectoryName("IME")
12286.   or DirectoryName("*RECYCLE*")
12287.   or DirectoryName("ServicePackFiles")
12288.   or DirectoryName("SoftwareDistribution")
12289.   or DirectoryName("Speech")
12290.   or DirectoryName("Symbols")
12291.   or DirectoryName("System Volume Information")
12292.   or DirectoryName("windows.old")
12293. )
12294. # WinSysLow end.
12295. 
12296.   # Archives
12297. )
12298. # Archives end.
12299. 
12300. # NotBlobsArchivesBu
12301. or
12302. # Backups start.
12303. (
12304.   DirectoryName("*Backup*")
12305.   or DirectoryName("*Bu")
12306.   or DirectoryName("* Bu *")
12307.   or DirectoryName("Bu *")
12308. 
12309.   or FileName("*.bak")
12310.   or FileName("* - Copy*")
12311. )
12312. # Backups end.
12313. 
12314. # NotBlobsArchivesBu
12315. ) )
12316. # NotBlobsArchivesBu end.
12317. 
12318. # DevToDo
12319. and ( 
12320. # Dev start.
12321. (
12322.   DirectoryName("*Dev") 
12323.   or DirectoryName("Dev *") 
12324.   or DirectoryName("*Development*") 
12325.   or DirectoryName("DsVs*") 
12326.   or DirectoryName("Srt*") 
12327. )
12328. # Dev end.
12329. 
12330. # DevToDo
12331. or 
12332. # ToDo start.
12333. (
12334.   DirectoryName("*ToDo*")
12335. )
12336. # ToDo end.
12337. 
12338. # DevToDo
12339. )
12340. # DevToDo end.
12341. 
12342. 		SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
12343. 
12344. 	# Zone Do Footer
12345. 
12346. /* ---------------------------------------------------------- */
12347. # File Select
12348. 	# Select Statments
12349. # File Actions 
12350. 	# Standard or OS File Actions.
12351. 	# Resume...
12352. 	
12353. 	# your stuff HERE (X)... post zone (file) file actions code.
12354. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
12355. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12356. 		# (X)
12357. 		
12358. 		/* ??? Set window? */
12359. 	
12360. 	# ADD THE GAP
12361. 		
12362. # Vacate (good for diagnostics)
12363. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
12364. 
12365. # DoNotVacate - DO NOT Vacate (recommended)
12366. 
12367. # Vacate
12368. /* AddGap(GapUsedLoc) */
12369. 
12370. # DO Not Vacate
12371. AddGap(GapUsedLoc, DoNotVacate) 
12372. 	
12373. 	
12374. /* ---------------------------------------------------------- */
12375. # (failed) TEST for boolean logic.
12376. 
12377. /* It should work in the gap calculations for turning options */
12378. /* on and off but it will NOT work here. */
12379. 
12380. /* Boolean setting X or FlagX. */
12381. /* Where X will be on or off: */
12382. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
12383. /*      For ON:  (X  *  FlagAny) */
12384. 
12385. /* 1) Failed, zero gap overrode the previous one. */
12386. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
12387. /* AddGap(GapUsedTemp) */ 
12388. 
12389. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
12390. /* AddGap(GapUsedTemp, DoNotVacate) */ 
12391. 
12392. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
12393. 
12394. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
12395. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
12396. /* AddGap(GapUsedTemp) */ 
12397. 
12398. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
12399. /* AddGap(GapUsedTemp, DoNotVacate) */ 
12400. 
12401. /* ---------------------------------------------------------- */
12402. 
12403. # Vacate
12404. /* AddGap(GapUsed) */
12405. 
12406. # DO NOT Vacate (recommended)
12407. /* AddGap(GapUsed, DoNotVacate) */ 
12408. 	
12409. 
12410. 		
12411. # 
12412. FileEnd
12413. /* ---------------------------------------------------------- */
12414. 
12415. # your stuff HERE (X)... post zone (file) code.
12416. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
12417. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12418. 	# (X)
12419. 
12420. SetVariable(FileStepDescription,"Zone finished, reporting.")
12421. # FILE STEP
12422. 
12423. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12424. 
12425. /* add message and move to a new line. */
12426. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12427. ")
12428. 
12429. /* display the line. (hopefully.) */
12430. # Zone Footer Set Statistics Window Text
12431. 
12432. SetStatisticsWindowText("----------------------------------------------------------
12433. Zones Processed: 
12434. ----------------------------------------------------------
12435. !ZoneListByLine!
12436. ----------------------------------------------------------
12437. Zone Processing Step:
12438. !ZoneStepByLine!    
12439. ----------------------------------------------------------
12440. Current Zone:
12441. !ZoneFooter!
12442. ----------------------------------------------------------
12443. Volume Statistics:
12444. !VolumeStatisticsDetail!
12445. ----------------------------------------------------------
12446. Zone Detailed Report:
12447. ----------------------------------------------------------
12448. !ZoneStatisticsDetail!
12449. ----------------------------------------------------------
12450. ")
12451. 
12452. 
12453. 
12454. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12455. 
12456. # BANNER SET
12457. 
12458. # DATE TIME RUN ELP
12459. 
12460. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:54 0:00:06")
12461. /* Xinclude "..\Display\BannerSet.MyDc"X */
12462. /* pause(1) */
12463. 
12464. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12465. 
12466. Title('!Heading!')
12467. /* pause(1) */
12468. 
12469. /* NOTE: Can't round or truncate to integer precision. */
12470. 
12471. pause(1)
12472. 
12473. # Zone When Finished
12474. 
12475. # BANNER SET
12476. 
12477. # DATE TIME RUN ELP
12478. 
12479. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:54 0:00:06")
12480. /* Xinclude "..\Display\BannerSet.MyDc"X */
12481. /* pause(1) */
12482. 
12483. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12484. 
12485. Title('!Heading!')
12486. /* pause(1) */
12487. 
12488. /* NOTE: Can't round or truncate to integer precision. */
12489. 
12490. AppendLogfile("!LogFileName!", "!Title!")
12491. 
12492. 
12493. 
12494. # Zone Statistics	
12495. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
12496. 
12497. # Footer:
12498. SetVariable(ZoneFooter, "----------------------------------------------------------
12499. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:54
12500. 
12501. Statistics Report:
12502. ------------------
12503.    Size:  
12504.    ------------------------
12505.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12506.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12507.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12508. 
12509.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12510.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12511. 
12512.    Location:
12513.    ------------------------
12514.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12515.              Files End: !ZoneEndCurrent!
12516.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12517.       
12518.    Gap Settings:
12519.    ------------------------
12520.          Gap Requested: !ZoneGapSizePer!%
12521.       Volume Rounding: !ZoneVolRoundUpPer!%
12522.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12523.                  
12524.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
12525.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
12526.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
12527.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
12528.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
12529.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
12530.      
12531.    Free Space after Zone:
12532.    ------------------------
12533.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12534.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12535.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12536. 
12537. Directory and Files Select:
12538. ---------------------------
12539. !ZoneTypeSelectCurrent!               
12540. ---------------------------
12541. ----------------------------------------------------------
12542. ")
12543. 
12544. AppendLogfile("!LogFileName!", ".")
12545. AppendLogfile("!LogFileName!", "!ZoneFooter!")
12546. AppendLogfile("!LogFileName!", ".")
12547. 
12548. # Zone Footer Set Statistics Window Text
12549. 
12550. SetStatisticsWindowText("----------------------------------------------------------
12551. Zones Processed: 
12552. ----------------------------------------------------------
12553. !ZoneListByLine!
12554. ----------------------------------------------------------
12555. Zone Processing Step:
12556. !ZoneStepByLine!    
12557. ----------------------------------------------------------
12558. Current Zone:
12559. !ZoneFooter!
12560. ----------------------------------------------------------
12561. Volume Statistics:
12562. !VolumeStatisticsDetail!
12563. ----------------------------------------------------------
12564. Zone Detailed Report:
12565. ----------------------------------------------------------
12566. !ZoneStatisticsDetail!
12567. ----------------------------------------------------------
12568. ")
12569. 
12570. 
12571. 
12572. /* pause() */
12573. /* pause() */
12574. 
12575. 
12576. 
12577. 
12578. /* ---------------------------------------------------------- */
12579. 
12580. /* ---------------------------------------------------------- */
12581. /* Zone LinksCorp Links and Corp */
12582. /* ---------------------------------------------------------- */
12583. /* Zone LinksCorp Links and Corp */
12584. SetVariable(ZoneLabel, "!ZoneLabelLinksCorp!")
12585. SetVariable(ZoneDescription, "!ZoneDescriptionLinksCorp!")
12586. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpLinksCorp!")
12587. SetVariable(ZoneGapSize, "!ZoneGapSizeLinksCorp!")
12588. SetVariable(ZoneTypeSelect,'# LinksCorp start.
12589. # NotBlobsArchivesBu start.
12590. (not (
12591. # Blobs start.
12592. (
12593. # BlobsAndExceptions start.
12594. ( not(
12595.   FileName("*.bat")
12596.   or FileName("*.css")
12597.   or FileName("*.dll")
12598.   or FileName("*.exe")
12599.   or FileName("*.htm*")
12600.   or FileName("*.jar")
12601.   or FileName("*.js")
12602.   or FileName("*.script")
12603.   or FileName("*.wsf")
12604.   or (
12605. # Databases start.
12606. (
12607.   FileName("*.crypt*")
12608.   or FileName("*.db*")
12609.   or FileName("*.rdb*")
12610.   or FileName("*.dc*")
12611.   or FileName("*.dict*")
12612.   or FileName("*.?db*")
12613.   or FileName("*.?rdb*")
12614.   or FileName("*.md*")
12615.   or FileName("*.myd")
12616.   or FileName("*.ndf")
12617.   or FileName("*.ns?")
12618.   or FileName("*.pab")
12619.   or FileName("*.pst")
12620.   or FileName("*.sd?*")
12621.   or FileName("*.sq**")
12622.   or FileName("*.tmd")
12623.   or FileName("*.tps")
12624.   or FileName("*.tr*")
12625. )
12626. # Databases end.
12627. 
12628.     # BlobsAndExceptions
12629.     or 
12630. # Data start.
12631. (
12632.   DirectoryName("Data*")
12633.   or DirectoryName("Device*")
12634.   or DirectoryName("Export*")
12635.   or DirectoryName("Import*")
12636.   or DirectoryName("Log*")
12637.   or DirectoryName("*Log")
12638.   or DirectoryName("Maintenance*")
12639.   or DirectoryName("Rec*")
12640.   or DirectoryName("Sales*")
12641.   or DirectoryName("Search*")
12642.   or DirectoryName("User*")
12643. )
12644. # Data end.
12645. 
12646.     # BlobsAndExceptions
12647.   )
12648. ) )
12649. # BlobsAndExceptions end.
12650. 
12651. # Blobs
12652. ) and (
12653.   Size(BlobFileSize,0)
12654.   or (
12655.     FileName("*.arj")
12656.     or FileName("*.bup")
12657.     or FileName("*.bz2")
12658.     or FileName("*.chm")
12659.     or FileName("*.dvr-ms")
12660.     or FileName("*.gz")
12661.     or FileName("*.ifo")
12662.     or FileName("*.lzh")
12663.     or FileName("*.pdf")
12664.     or FileName("*.rpm")
12665.     or FileName("*.wmv")
12666.     or FileName("*.vob")
12667.     or FileName("*.z")
12668.   ) 
12669. )
12670. # Blobs end.
12671. 
12672. # NotBlobsArchivesBu
12673. or 
12674. # Archives start.
12675. (
12676.   DirectoryName("*Archive*")
12677.   or DirectoryName("*History*")
12678.   or DirectoryName("*Old")
12679.   or DirectoryName("* Old *")
12680.   or DirectoryName("Old *")
12681. 
12682.   or FileName("*.7z")
12683.   or FileName("*.cab")
12684.   or FileName("*.iso")
12685.   or FileName("*.msi")
12686.   or FileName("*.old")
12687.   or FileName("*.rar")
12688.   or FileName("*.tar")
12689.   or FileName("*.zip")
12690.   or
12691. # WinSysLow start.
12692. (
12693.   DirectoryName("$*")
12694.   or DirectoryName("0*")
12695.   or DirectoryName("1*")
12696.   or DirectoryName("2*")
12697.   or DirectoryName("3*")
12698.   or DirectoryName("4*")
12699.   or DirectoryName("5*")
12700.   or DirectoryName("6*")
12701.   or DirectoryName("7*")
12702.   or DirectoryName("8*")
12703.   or DirectoryName("9*")
12704. 
12705.   or DirectoryName("dllcache")
12706.   or DirectoryName("Downloaded Installations")
12707.   or DirectoryName("Ehome")
12708.   or DirectoryName("Fonts")
12709.   or DirectoryName("Help")
12710.   or DirectoryName("I386")
12711.   or DirectoryName("ie?updates")
12712.   or DirectoryName("Installer")
12713.   or DirectoryName("Installshield Installation Information")
12714.   or DirectoryName("IME")
12715.   or DirectoryName("*RECYCLE*")
12716.   or DirectoryName("ServicePackFiles")
12717.   or DirectoryName("SoftwareDistribution")
12718.   or DirectoryName("Speech")
12719.   or DirectoryName("Symbols")
12720.   or DirectoryName("System Volume Information")
12721.   or DirectoryName("windows.old")
12722. )
12723. # WinSysLow end.
12724. 
12725.   # Archives
12726. )
12727. # Archives end.
12728. 
12729. # NotBlobsArchivesBu
12730. or
12731. # Backups start.
12732. (
12733.   DirectoryName("*Backup*")
12734.   or DirectoryName("*Bu")
12735.   or DirectoryName("* Bu *")
12736.   or DirectoryName("Bu *")
12737. 
12738.   or FileName("*.bak")
12739.   or FileName("* - Copy*")
12740. )
12741. # Backups end.
12742. 
12743. # NotBlobsArchivesBu
12744. ) )
12745. # NotBlobsArchivesBu end.
12746. 
12747. # LinksCorp
12748. and ( 
12749. # Corp start.
12750. (
12751.     DirectoryName("*Corp*") or
12752.     DirectoryName("*Mdm*")
12753. )
12754. # Corp end.
12755. 
12756. # LinksCorp
12757. or 
12758. # Links start.
12759. (
12760.     DirectoryName("*Favorites*") or
12761.     DirectoryName("*Job*") or
12762.     DirectoryName("*Links*")
12763. )
12764. # Links end.
12765. 
12766. # LinksCorp
12767. or 
12768. # Support start.
12769. (
12770.   DirectoryName("*Logs*") or
12771.   DirectoryName("*Support*") or
12772.   DirectoryName("*Maintenance*")
12773. )
12774. # Support end.
12775. 
12776. # LinksCorp
12777. )
12778. # LinksCorp end.
12779. ')
12780. 
12781. 	# Zone Do Header
12782. 
12783. # Zone When Started
12784. 
12785. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
12786. # Display Set Zone
12787. 
12788. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
12789. SetVariable(FileStepDescription,	"")
12790. 
12791. SetVariable(ZoneStepByLine, 			"Zone started.
12792. ")
12793. 
12794. # BANNER SET
12795. 
12796. # DATE TIME RUN ELP
12797. 
12798. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
12799. /* Xinclude "..\Display\BannerSet.MyDc"X */
12800. /* pause(1) */
12801. 
12802. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12803. 
12804. Title('!Heading!')
12805. /* pause(1) */
12806. 
12807. /* NOTE: Can't round or truncate to integer precision. */
12808. 
12809. AppendLogfile("!LogFileName!", "!Title!")
12810. 
12811. 
12812. 
12813. pause(1)
12814. 
12815. 
12816. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
12817. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
12818. 
12819. SetVariable(ZoneStepNoCurrent, 0)
12820. 
12821. 
12822. # Zone Do Current Clear
12823. 
12824. SetVariable(ZoneTypeSelectCurrent, 		"")
12825. 
12826. SetVariable(ZoneBeginCurrent, 			0)
12827. SetVariable(ZoneBeginPerCurrent, 		0)
12828. SetVariable(ZoneEndCurrent, 			0)
12829. SetVariable(ZoneEndPerCurrent, 			0)
12830. 
12831. SetVariable(ZoneSizeCurrent,			0)
12832. SetVariable(ZoneSizePerCurrent,			0)
12833. 
12834. SetVariable(ZoneGapRequestedCurrent,	0)
12835. SetVariable(ZoneGapRoundedCurrent, 		0)
12836. SetVariable(ZoneGapAdjustedCurrent, 	0)
12837. SetVariable(ZoneGapAvailableCurrent, 	0)
12838. SetVariable(ZoneGapCurrent,				0)
12839. SetVariable(ZoneGapUsedCurrent, 		0)
12840. 
12841. SetVariable(ZoneGapActualCurrent, 		0)
12842. SetVariable(ZoneGapActualPerCurrent, 	0)
12843. 
12844. SetVariable(ZoneSizeActual, 			0)
12845. SetVariable(ZoneSizeActualCurrent,		0)
12846. 
12847. SetVariable(ZoneEndActual, 				0)
12848. SetVariable(ZoneEndActualCurrent,		0)			
12849. SetVariable(ZoneSizeActualPerCurrent, 	0)
12850.       
12851. SetVariable(ZoneFilesFolders,			0)
12852. SetVariable(ZoneFilesFoldersPer,		0) 
12853. 
12854. SetVariable(ZoneFragments,				0)
12855. SetVariable(ZoneFragmentsPer,			0) 
12856. 		
12857. SetVariable(ZoneEndActualCurrent, 		0)
12858. SetVariable(ZoneEndActualPerCurrent, 	0)
12859. 
12860. # Gap Calculation Methodology:
12861. 	# Requested
12862. 	SetVariable(GapRequested, 			0) 
12863. 	SetVariable(GapRequestedStd, 		0) 
12864. 	SetVariable(GapRequestedMft, 		0) 
12865. 	SetVariable(GapRequestedOs, 		0) 
12866. 	SetVariable(GapRequestedOriginal, 	0) 
12867. 	
12868. 	# Gap Adjustments
12869. 	SetVariable(GapRounded, 			0)
12870. 	# SetVariable(GapAdjusted, 			0)
12871. 	SetVariable(GapAvailable, 			0)
12872. 	SetVariable(GapCurrent, 			0)
12873. 	SetVariable(GapActual, 				0)
12874. 	SetVariable(GapUsed, 				0)
12875. 	
12876. 	# Gap Adjustments
12877. 	SetVariable(GapRoundedLoc, 			0)
12878. 	# SetVariable(GapAdjustedLoc, 		0)
12879. 	SetVariable(GapAvailableLoc, 		0)
12880. 	SetVariable(GapCurrentLoc, 			0)
12881. 	SetVariable(GapActualLoc,			0)
12882. 	SetVariable(GapUsedLoc,				0)
12883. 	
12884. 	# Space usage
12885. 	SetVariable(ZoneFreePerRequested, 	0)
12886. 	SetVariable(ZoneFreePerUsed, 		0)
12887. 
12888. # Gap Size & Rounding
12889. 	SetVariable(ZoneGapSizePer, 		0)
12890. 	SetVariable(ZoneVolRoundUpPer, 		0)
12891. 	
12892. 	# Free Space
12893. 	SetVariable(ZoneFreeUsedPer, 		0)
12894. 	SetVariable(ZoneFreeRequestedPer, 	0)
12895. 
12896. 
12897. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
12898. 
12899. # Footer:
12900. SetVariable(ZoneFooter, "----------------------------------------------------------
12901. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
12902. 
12903. Statistics Report:
12904. ------------------
12905.    Size:  
12906.    ------------------------
12907.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12908.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12909.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12910. 
12911.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12912.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12913. 
12914.    Location:
12915.    ------------------------
12916.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12917.              Files End: !ZoneEndCurrent!
12918.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12919.       
12920.    Gap Settings:
12921.    ------------------------
12922.          Gap Requested: !ZoneGapSizePer!%
12923.       Volume Rounding: !ZoneVolRoundUpPer!%
12924.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12925.                  
12926.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
12927.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
12928.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
12929.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
12930.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
12931.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
12932.      
12933.    Free Space after Zone:
12934.    ------------------------
12935.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12936.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12937.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12938. 
12939. Directory and Files Select:
12940. ---------------------------
12941. !ZoneTypeSelectCurrent!               
12942. ---------------------------
12943. ----------------------------------------------------------
12944. ")
12945. 
12946. # BANNER SET
12947. 
12948. # DATE TIME RUN ELP
12949. 
12950. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
12951. /* Xinclude "..\Display\BannerSet.MyDc"X */
12952. /* pause(1) */
12953. 
12954. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12955. 
12956. Title('!Heading!')
12957. /* pause(1) */
12958. 
12959. /* NOTE: Can't round or truncate to integer precision. */
12960. 
12961. AppendLogfile("!LogFileName!", "!Title!")
12962. 
12963. 
12964. 
12965. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
12966. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
12967. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:55")
12968. 
12969. SetVariable(ZoneListByLine, "!ZoneListByLine!
12970. Zone: !ZoneNoCurrent! 2021-11-09 10:47:55 0:00:07 !ZoneLabel! !ZoneDescription!")
12971. 
12972. 
12973. /* Fixed Zone Position Handling */
12974. /* Literal number: */
12975. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
12976. /* Percentage of disk: */
12977. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
12978. /* Gap */
12979. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
12980. 
12981. /* ---------------------------------------------------------- */
12982. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
12983. # FILE STEP
12984. 
12985. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12986. 
12987. /* add message and move to a new line. */
12988. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12989. ")
12990. 
12991. /* display the line. (hopefully.) */
12992. # Zone Footer Set Statistics Window Text
12993. 
12994. SetStatisticsWindowText("----------------------------------------------------------
12995. Zones Processed: 
12996. ----------------------------------------------------------
12997. !ZoneListByLine!
12998. ----------------------------------------------------------
12999. Zone Processing Step:
13000. !ZoneStepByLine!    
13001. ----------------------------------------------------------
13002. Current Zone:
13003. !ZoneFooter!
13004. ----------------------------------------------------------
13005. Volume Statistics:
13006. !VolumeStatisticsDetail!
13007. ----------------------------------------------------------
13008. Zone Detailed Report:
13009. ----------------------------------------------------------
13010. !ZoneStatisticsDetail!
13011. ----------------------------------------------------------
13012. ")
13013. 
13014. 
13015. 
13016. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13017. 
13018. # BANNER SET
13019. 
13020. # DATE TIME RUN ELP
13021. 
13022. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
13023. /* Xinclude "..\Display\BannerSet.MyDc"X */
13024. /* pause(1) */
13025. 
13026. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13027. 
13028. Title('!Heading!')
13029. /* pause(1) */
13030. 
13031. /* NOTE: Can't round or truncate to integer precision. */
13032. 
13033. pause(1)
13034. 
13035. # your stuff HERE (X)... pre file select code.
13036. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
13037. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13038. 	# (X)
13039. 
13040. FileSelect
13041. 
13042. 	# your stuff can't really go here (errors.)
13043. 	# maybe for some reason I don't know of...
13044. 	
13045. 	# Actions next...
13046. 	# LinksCorp start.
13047. # NotBlobsArchivesBu start.
13048. (not (
13049. # Blobs start.
13050. (
13051. # BlobsAndExceptions start.
13052. ( not(
13053.   FileName("*.bat")
13054.   or FileName("*.css")
13055.   or FileName("*.dll")
13056.   or FileName("*.exe")
13057.   or FileName("*.htm*")
13058.   or FileName("*.jar")
13059.   or FileName("*.js")
13060.   or FileName("*.script")
13061.   or FileName("*.wsf")
13062.   or (
13063. # Databases start.
13064. (
13065.   FileName("*.crypt*")
13066.   or FileName("*.db*")
13067.   or FileName("*.rdb*")
13068.   or FileName("*.dc*")
13069.   or FileName("*.dict*")
13070.   or FileName("*.?db*")
13071.   or FileName("*.?rdb*")
13072.   or FileName("*.md*")
13073.   or FileName("*.myd")
13074.   or FileName("*.ndf")
13075.   or FileName("*.ns?")
13076.   or FileName("*.pab")
13077.   or FileName("*.pst")
13078.   or FileName("*.sd?*")
13079.   or FileName("*.sq**")
13080.   or FileName("*.tmd")
13081.   or FileName("*.tps")
13082.   or FileName("*.tr*")
13083. )
13084. # Databases end.
13085. 
13086.     # BlobsAndExceptions
13087.     or 
13088. # Data start.
13089. (
13090.   DirectoryName("Data*")
13091.   or DirectoryName("Device*")
13092.   or DirectoryName("Export*")
13093.   or DirectoryName("Import*")
13094.   or DirectoryName("Log*")
13095.   or DirectoryName("*Log")
13096.   or DirectoryName("Maintenance*")
13097.   or DirectoryName("Rec*")
13098.   or DirectoryName("Sales*")
13099.   or DirectoryName("Search*")
13100.   or DirectoryName("User*")
13101. )
13102. # Data end.
13103. 
13104.     # BlobsAndExceptions
13105.   )
13106. ) )
13107. # BlobsAndExceptions end.
13108. 
13109. # Blobs
13110. ) and (
13111.   Size(BlobFileSize,0)
13112.   or (
13113.     FileName("*.arj")
13114.     or FileName("*.bup")
13115.     or FileName("*.bz2")
13116.     or FileName("*.chm")
13117.     or FileName("*.dvr-ms")
13118.     or FileName("*.gz")
13119.     or FileName("*.ifo")
13120.     or FileName("*.lzh")
13121.     or FileName("*.pdf")
13122.     or FileName("*.rpm")
13123.     or FileName("*.wmv")
13124.     or FileName("*.vob")
13125.     or FileName("*.z")
13126.   ) 
13127. )
13128. # Blobs end.
13129. 
13130. # NotBlobsArchivesBu
13131. or 
13132. # Archives start.
13133. (
13134.   DirectoryName("*Archive*")
13135.   or DirectoryName("*History*")
13136.   or DirectoryName("*Old")
13137.   or DirectoryName("* Old *")
13138.   or DirectoryName("Old *")
13139. 
13140.   or FileName("*.7z")
13141.   or FileName("*.cab")
13142.   or FileName("*.iso")
13143.   or FileName("*.msi")
13144.   or FileName("*.old")
13145.   or FileName("*.rar")
13146.   or FileName("*.tar")
13147.   or FileName("*.zip")
13148.   or
13149. # WinSysLow start.
13150. (
13151.   DirectoryName("$*")
13152.   or DirectoryName("0*")
13153.   or DirectoryName("1*")
13154.   or DirectoryName("2*")
13155.   or DirectoryName("3*")
13156.   or DirectoryName("4*")
13157.   or DirectoryName("5*")
13158.   or DirectoryName("6*")
13159.   or DirectoryName("7*")
13160.   or DirectoryName("8*")
13161.   or DirectoryName("9*")
13162. 
13163.   or DirectoryName("dllcache")
13164.   or DirectoryName("Downloaded Installations")
13165.   or DirectoryName("Ehome")
13166.   or DirectoryName("Fonts")
13167.   or DirectoryName("Help")
13168.   or DirectoryName("I386")
13169.   or DirectoryName("ie?updates")
13170.   or DirectoryName("Installer")
13171.   or DirectoryName("Installshield Installation Information")
13172.   or DirectoryName("IME")
13173.   or DirectoryName("*RECYCLE*")
13174.   or DirectoryName("ServicePackFiles")
13175.   or DirectoryName("SoftwareDistribution")
13176.   or DirectoryName("Speech")
13177.   or DirectoryName("Symbols")
13178.   or DirectoryName("System Volume Information")
13179.   or DirectoryName("windows.old")
13180. )
13181. # WinSysLow end.
13182. 
13183.   # Archives
13184. )
13185. # Archives end.
13186. 
13187. # NotBlobsArchivesBu
13188. or
13189. # Backups start.
13190. (
13191.   DirectoryName("*Backup*")
13192.   or DirectoryName("*Bu")
13193.   or DirectoryName("* Bu *")
13194.   or DirectoryName("Bu *")
13195. 
13196.   or FileName("*.bak")
13197.   or FileName("* - Copy*")
13198. )
13199. # Backups end.
13200. 
13201. # NotBlobsArchivesBu
13202. ) )
13203. # NotBlobsArchivesBu end.
13204. 
13205. # LinksCorp
13206. and ( 
13207. # Corp start.
13208. (
13209.     DirectoryName("*Corp*") or
13210.     DirectoryName("*Mdm*")
13211. )
13212. # Corp end.
13213. 
13214. # LinksCorp
13215. or 
13216. # Links start.
13217. (
13218.     DirectoryName("*Favorites*") or
13219.     DirectoryName("*Job*") or
13220.     DirectoryName("*Links*")
13221. )
13222. # Links end.
13223. 
13224. # LinksCorp
13225. or 
13226. # Support start.
13227. (
13228.   DirectoryName("*Logs*") or
13229.   DirectoryName("*Support*") or
13230.   DirectoryName("*Maintenance*")
13231. )
13232. # Support end.
13233. 
13234. # LinksCorp
13235. )
13236. # LinksCorp end.
13237. 
13238. 		SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
13239. 
13240. 	# Zone Do Footer
13241. 
13242. /* ---------------------------------------------------------- */
13243. # File Select
13244. 	# Select Statments
13245. # File Actions 
13246. 	# Standard or OS File Actions.
13247. 	# Resume...
13248. 	
13249. 	# your stuff HERE (X)... post zone (file) file actions code.
13250. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
13251. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13252. 		# (X)
13253. 		
13254. 		/* ??? Set window? */
13255. 	
13256. 	# ADD THE GAP
13257. 		
13258. # Vacate (good for diagnostics)
13259. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
13260. 
13261. # DoNotVacate - DO NOT Vacate (recommended)
13262. 
13263. # Vacate
13264. /* AddGap(GapUsedLoc) */
13265. 
13266. # DO Not Vacate
13267. AddGap(GapUsedLoc, DoNotVacate) 
13268. 	
13269. 	
13270. /* ---------------------------------------------------------- */
13271. # (failed) TEST for boolean logic.
13272. 
13273. /* It should work in the gap calculations for turning options */
13274. /* on and off but it will NOT work here. */
13275. 
13276. /* Boolean setting X or FlagX. */
13277. /* Where X will be on or off: */
13278. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
13279. /*      For ON:  (X  *  FlagAny) */
13280. 
13281. /* 1) Failed, zero gap overrode the previous one. */
13282. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
13283. /* AddGap(GapUsedTemp) */ 
13284. 
13285. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
13286. /* AddGap(GapUsedTemp, DoNotVacate) */ 
13287. 
13288. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
13289. 
13290. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
13291. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
13292. /* AddGap(GapUsedTemp) */ 
13293. 
13294. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
13295. /* AddGap(GapUsedTemp, DoNotVacate) */ 
13296. 
13297. /* ---------------------------------------------------------- */
13298. 
13299. # Vacate
13300. /* AddGap(GapUsed) */
13301. 
13302. # DO NOT Vacate (recommended)
13303. /* AddGap(GapUsed, DoNotVacate) */ 
13304. 	
13305. 
13306. 		
13307. # 
13308. FileEnd
13309. /* ---------------------------------------------------------- */
13310. 
13311. # your stuff HERE (X)... post zone (file) code.
13312. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
13313. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13314. 	# (X)
13315. 
13316. SetVariable(FileStepDescription,"Zone finished, reporting.")
13317. # FILE STEP
13318. 
13319. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13320. 
13321. /* add message and move to a new line. */
13322. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13323. ")
13324. 
13325. /* display the line. (hopefully.) */
13326. # Zone Footer Set Statistics Window Text
13327. 
13328. SetStatisticsWindowText("----------------------------------------------------------
13329. Zones Processed: 
13330. ----------------------------------------------------------
13331. !ZoneListByLine!
13332. ----------------------------------------------------------
13333. Zone Processing Step:
13334. !ZoneStepByLine!    
13335. ----------------------------------------------------------
13336. Current Zone:
13337. !ZoneFooter!
13338. ----------------------------------------------------------
13339. Volume Statistics:
13340. !VolumeStatisticsDetail!
13341. ----------------------------------------------------------
13342. Zone Detailed Report:
13343. ----------------------------------------------------------
13344. !ZoneStatisticsDetail!
13345. ----------------------------------------------------------
13346. ")
13347. 
13348. 
13349. 
13350. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13351. 
13352. # BANNER SET
13353. 
13354. # DATE TIME RUN ELP
13355. 
13356. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
13357. /* Xinclude "..\Display\BannerSet.MyDc"X */
13358. /* pause(1) */
13359. 
13360. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13361. 
13362. Title('!Heading!')
13363. /* pause(1) */
13364. 
13365. /* NOTE: Can't round or truncate to integer precision. */
13366. 
13367. pause(1)
13368. 
13369. # Zone When Finished
13370. 
13371. # BANNER SET
13372. 
13373. # DATE TIME RUN ELP
13374. 
13375. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
13376. /* Xinclude "..\Display\BannerSet.MyDc"X */
13377. /* pause(1) */
13378. 
13379. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13380. 
13381. Title('!Heading!')
13382. /* pause(1) */
13383. 
13384. /* NOTE: Can't round or truncate to integer precision. */
13385. 
13386. AppendLogfile("!LogFileName!", "!Title!")
13387. 
13388. 
13389. 
13390. # Zone Statistics	
13391. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
13392. 
13393. # Footer:
13394. SetVariable(ZoneFooter, "----------------------------------------------------------
13395. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
13396. 
13397. Statistics Report:
13398. ------------------
13399.    Size:  
13400.    ------------------------
13401.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13402.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13403.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13404. 
13405.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13406.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13407. 
13408.    Location:
13409.    ------------------------
13410.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13411.              Files End: !ZoneEndCurrent!
13412.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13413.       
13414.    Gap Settings:
13415.    ------------------------
13416.          Gap Requested: !ZoneGapSizePer!%
13417.       Volume Rounding: !ZoneVolRoundUpPer!%
13418.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13419.                  
13420.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
13421.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
13422.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
13423.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
13424.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
13425.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
13426.      
13427.    Free Space after Zone:
13428.    ------------------------
13429.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13430.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13431.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13432. 
13433. Directory and Files Select:
13434. ---------------------------
13435. !ZoneTypeSelectCurrent!               
13436. ---------------------------
13437. ----------------------------------------------------------
13438. ")
13439. 
13440. AppendLogfile("!LogFileName!", ".")
13441. AppendLogfile("!LogFileName!", "!ZoneFooter!")
13442. AppendLogfile("!LogFileName!", ".")
13443. 
13444. # Zone Footer Set Statistics Window Text
13445. 
13446. SetStatisticsWindowText("----------------------------------------------------------
13447. Zones Processed: 
13448. ----------------------------------------------------------
13449. !ZoneListByLine!
13450. ----------------------------------------------------------
13451. Zone Processing Step:
13452. !ZoneStepByLine!    
13453. ----------------------------------------------------------
13454. Current Zone:
13455. !ZoneFooter!
13456. ----------------------------------------------------------
13457. Volume Statistics:
13458. !VolumeStatisticsDetail!
13459. ----------------------------------------------------------
13460. Zone Detailed Report:
13461. ----------------------------------------------------------
13462. !ZoneStatisticsDetail!
13463. ----------------------------------------------------------
13464. ")
13465. 
13466. 
13467. 
13468. /* pause() */
13469. /* pause() */
13470. 
13471. 
13472. 
13473. 
13474. /* ---------------------------------------------------------- */
13475. 
13476. 
13477. /* ---------------------------------------------------------- */
13478. /* Zone People */
13479. /* ---------------------------------------------------------- */
13480. /* Zone People */
13481. SetVariable(ZoneLabel, "!ZoneLabelPeople!")
13482. SetVariable(ZoneDescription, "!ZoneDescriptionPeople!")
13483. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpPeople!")
13484. SetVariable(ZoneGapSize, "!ZoneGapSizePeople!")
13485. SetVariable(ZoneTypeSelect,'# People start.
13486. # NotBlobsArchivesBu start.
13487. (not (
13488. # Blobs start.
13489. (
13490. # BlobsAndExceptions start.
13491. ( not(
13492.   FileName("*.bat")
13493.   or FileName("*.css")
13494.   or FileName("*.dll")
13495.   or FileName("*.exe")
13496.   or FileName("*.htm*")
13497.   or FileName("*.jar")
13498.   or FileName("*.js")
13499.   or FileName("*.script")
13500.   or FileName("*.wsf")
13501.   or (
13502. # Databases start.
13503. (
13504.   FileName("*.crypt*")
13505.   or FileName("*.db*")
13506.   or FileName("*.rdb*")
13507.   or FileName("*.dc*")
13508.   or FileName("*.dict*")
13509.   or FileName("*.?db*")
13510.   or FileName("*.?rdb*")
13511.   or FileName("*.md*")
13512.   or FileName("*.myd")
13513.   or FileName("*.ndf")
13514.   or FileName("*.ns?")
13515.   or FileName("*.pab")
13516.   or FileName("*.pst")
13517.   or FileName("*.sd?*")
13518.   or FileName("*.sq**")
13519.   or FileName("*.tmd")
13520.   or FileName("*.tps")
13521.   or FileName("*.tr*")
13522. )
13523. # Databases end.
13524. 
13525.     # BlobsAndExceptions
13526.     or 
13527. # Data start.
13528. (
13529.   DirectoryName("Data*")
13530.   or DirectoryName("Device*")
13531.   or DirectoryName("Export*")
13532.   or DirectoryName("Import*")
13533.   or DirectoryName("Log*")
13534.   or DirectoryName("*Log")
13535.   or DirectoryName("Maintenance*")
13536.   or DirectoryName("Rec*")
13537.   or DirectoryName("Sales*")
13538.   or DirectoryName("Search*")
13539.   or DirectoryName("User*")
13540. )
13541. # Data end.
13542. 
13543.     # BlobsAndExceptions
13544.   )
13545. ) )
13546. # BlobsAndExceptions end.
13547. 
13548. # Blobs
13549. ) and (
13550.   Size(BlobFileSize,0)
13551.   or (
13552.     FileName("*.arj")
13553.     or FileName("*.bup")
13554.     or FileName("*.bz2")
13555.     or FileName("*.chm")
13556.     or FileName("*.dvr-ms")
13557.     or FileName("*.gz")
13558.     or FileName("*.ifo")
13559.     or FileName("*.lzh")
13560.     or FileName("*.pdf")
13561.     or FileName("*.rpm")
13562.     or FileName("*.wmv")
13563.     or FileName("*.vob")
13564.     or FileName("*.z")
13565.   ) 
13566. )
13567. # Blobs end.
13568. 
13569. # NotBlobsArchivesBu
13570. or 
13571. # Archives start.
13572. (
13573.   DirectoryName("*Archive*")
13574.   or DirectoryName("*History*")
13575.   or DirectoryName("*Old")
13576.   or DirectoryName("* Old *")
13577.   or DirectoryName("Old *")
13578. 
13579.   or FileName("*.7z")
13580.   or FileName("*.cab")
13581.   or FileName("*.iso")
13582.   or FileName("*.msi")
13583.   or FileName("*.old")
13584.   or FileName("*.rar")
13585.   or FileName("*.tar")
13586.   or FileName("*.zip")
13587.   or
13588. # WinSysLow start.
13589. (
13590.   DirectoryName("$*")
13591.   or DirectoryName("0*")
13592.   or DirectoryName("1*")
13593.   or DirectoryName("2*")
13594.   or DirectoryName("3*")
13595.   or DirectoryName("4*")
13596.   or DirectoryName("5*")
13597.   or DirectoryName("6*")
13598.   or DirectoryName("7*")
13599.   or DirectoryName("8*")
13600.   or DirectoryName("9*")
13601. 
13602.   or DirectoryName("dllcache")
13603.   or DirectoryName("Downloaded Installations")
13604.   or DirectoryName("Ehome")
13605.   or DirectoryName("Fonts")
13606.   or DirectoryName("Help")
13607.   or DirectoryName("I386")
13608.   or DirectoryName("ie?updates")
13609.   or DirectoryName("Installer")
13610.   or DirectoryName("Installshield Installation Information")
13611.   or DirectoryName("IME")
13612.   or DirectoryName("*RECYCLE*")
13613.   or DirectoryName("ServicePackFiles")
13614.   or DirectoryName("SoftwareDistribution")
13615.   or DirectoryName("Speech")
13616.   or DirectoryName("Symbols")
13617.   or DirectoryName("System Volume Information")
13618.   or DirectoryName("windows.old")
13619. )
13620. # WinSysLow end.
13621. 
13622.   # Archives
13623. )
13624. # Archives end.
13625. 
13626. # NotBlobsArchivesBu
13627. or
13628. # Backups start.
13629. (
13630.   DirectoryName("*Backup*")
13631.   or DirectoryName("*Bu")
13632.   or DirectoryName("* Bu *")
13633.   or DirectoryName("Bu *")
13634. 
13635.   or FileName("*.bak")
13636.   or FileName("* - Copy*")
13637. )
13638. # Backups end.
13639. 
13640. # NotBlobsArchivesBu
13641. ) )
13642. # NotBlobsArchivesBu end.
13643. 
13644. # People
13645. and (
13646. # People start.
13647. (
13648.   DirectoryName("*Capture*")
13649.   or DirectoryName("*Document*")
13650.   or DirectoryName("*Download*")
13651.   or DirectoryName("*Kids*")
13652.   or DirectoryName("Mail*")
13653.   or DirectoryName("*Mail")
13654.   or DirectoryName("My*")
13655.   or DirectoryName("*Person*")
13656.   or DirectoryName("Private*")
13657.   or DirectoryName("Users")
13658.   
13659.   # Individual People HERE:
13660.   or DirectoryName("Dgh*")
13661. )
13662. # People end.
13663. 
13664. # People
13665. )
13666. # People end.
13667. ')
13668. 
13669. 	# Zone Do Header
13670. 
13671. # Zone When Started
13672. 
13673. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
13674. # Display Set Zone
13675. 
13676. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
13677. SetVariable(FileStepDescription,	"")
13678. 
13679. SetVariable(ZoneStepByLine, 			"Zone started.
13680. ")
13681. 
13682. # BANNER SET
13683. 
13684. # DATE TIME RUN ELP
13685. 
13686. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
13687. /* Xinclude "..\Display\BannerSet.MyDc"X */
13688. /* pause(1) */
13689. 
13690. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13691. 
13692. Title('!Heading!')
13693. /* pause(1) */
13694. 
13695. /* NOTE: Can't round or truncate to integer precision. */
13696. 
13697. AppendLogfile("!LogFileName!", "!Title!")
13698. 
13699. 
13700. 
13701. pause(1)
13702. 
13703. 
13704. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
13705. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
13706. 
13707. SetVariable(ZoneStepNoCurrent, 0)
13708. 
13709. 
13710. # Zone Do Current Clear
13711. 
13712. SetVariable(ZoneTypeSelectCurrent, 		"")
13713. 
13714. SetVariable(ZoneBeginCurrent, 			0)
13715. SetVariable(ZoneBeginPerCurrent, 		0)
13716. SetVariable(ZoneEndCurrent, 			0)
13717. SetVariable(ZoneEndPerCurrent, 			0)
13718. 
13719. SetVariable(ZoneSizeCurrent,			0)
13720. SetVariable(ZoneSizePerCurrent,			0)
13721. 
13722. SetVariable(ZoneGapRequestedCurrent,	0)
13723. SetVariable(ZoneGapRoundedCurrent, 		0)
13724. SetVariable(ZoneGapAdjustedCurrent, 	0)
13725. SetVariable(ZoneGapAvailableCurrent, 	0)
13726. SetVariable(ZoneGapCurrent,				0)
13727. SetVariable(ZoneGapUsedCurrent, 		0)
13728. 
13729. SetVariable(ZoneGapActualCurrent, 		0)
13730. SetVariable(ZoneGapActualPerCurrent, 	0)
13731. 
13732. SetVariable(ZoneSizeActual, 			0)
13733. SetVariable(ZoneSizeActualCurrent,		0)
13734. 
13735. SetVariable(ZoneEndActual, 				0)
13736. SetVariable(ZoneEndActualCurrent,		0)			
13737. SetVariable(ZoneSizeActualPerCurrent, 	0)
13738.       
13739. SetVariable(ZoneFilesFolders,			0)
13740. SetVariable(ZoneFilesFoldersPer,		0) 
13741. 
13742. SetVariable(ZoneFragments,				0)
13743. SetVariable(ZoneFragmentsPer,			0) 
13744. 		
13745. SetVariable(ZoneEndActualCurrent, 		0)
13746. SetVariable(ZoneEndActualPerCurrent, 	0)
13747. 
13748. # Gap Calculation Methodology:
13749. 	# Requested
13750. 	SetVariable(GapRequested, 			0) 
13751. 	SetVariable(GapRequestedStd, 		0) 
13752. 	SetVariable(GapRequestedMft, 		0) 
13753. 	SetVariable(GapRequestedOs, 		0) 
13754. 	SetVariable(GapRequestedOriginal, 	0) 
13755. 	
13756. 	# Gap Adjustments
13757. 	SetVariable(GapRounded, 			0)
13758. 	# SetVariable(GapAdjusted, 			0)
13759. 	SetVariable(GapAvailable, 			0)
13760. 	SetVariable(GapCurrent, 			0)
13761. 	SetVariable(GapActual, 				0)
13762. 	SetVariable(GapUsed, 				0)
13763. 	
13764. 	# Gap Adjustments
13765. 	SetVariable(GapRoundedLoc, 			0)
13766. 	# SetVariable(GapAdjustedLoc, 		0)
13767. 	SetVariable(GapAvailableLoc, 		0)
13768. 	SetVariable(GapCurrentLoc, 			0)
13769. 	SetVariable(GapActualLoc,			0)
13770. 	SetVariable(GapUsedLoc,				0)
13771. 	
13772. 	# Space usage
13773. 	SetVariable(ZoneFreePerRequested, 	0)
13774. 	SetVariable(ZoneFreePerUsed, 		0)
13775. 
13776. # Gap Size & Rounding
13777. 	SetVariable(ZoneGapSizePer, 		0)
13778. 	SetVariable(ZoneVolRoundUpPer, 		0)
13779. 	
13780. 	# Free Space
13781. 	SetVariable(ZoneFreeUsedPer, 		0)
13782. 	SetVariable(ZoneFreeRequestedPer, 	0)
13783. 
13784. 
13785. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
13786. 
13787. # Footer:
13788. SetVariable(ZoneFooter, "----------------------------------------------------------
13789. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
13790. 
13791. Statistics Report:
13792. ------------------
13793.    Size:  
13794.    ------------------------
13795.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13796.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13797.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13798. 
13799.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13800.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13801. 
13802.    Location:
13803.    ------------------------
13804.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13805.              Files End: !ZoneEndCurrent!
13806.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13807.       
13808.    Gap Settings:
13809.    ------------------------
13810.          Gap Requested: !ZoneGapSizePer!%
13811.       Volume Rounding: !ZoneVolRoundUpPer!%
13812.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13813.                  
13814.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
13815.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
13816.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
13817.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
13818.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
13819.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
13820.      
13821.    Free Space after Zone:
13822.    ------------------------
13823.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13824.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13825.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13826. 
13827. Directory and Files Select:
13828. ---------------------------
13829. !ZoneTypeSelectCurrent!               
13830. ---------------------------
13831. ----------------------------------------------------------
13832. ")
13833. 
13834. # BANNER SET
13835. 
13836. # DATE TIME RUN ELP
13837. 
13838. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
13839. /* Xinclude "..\Display\BannerSet.MyDc"X */
13840. /* pause(1) */
13841. 
13842. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13843. 
13844. Title('!Heading!')
13845. /* pause(1) */
13846. 
13847. /* NOTE: Can't round or truncate to integer precision. */
13848. 
13849. AppendLogfile("!LogFileName!", "!Title!")
13850. 
13851. 
13852. 
13853. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
13854. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
13855. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:55")
13856. 
13857. SetVariable(ZoneListByLine, "!ZoneListByLine!
13858. Zone: !ZoneNoCurrent! 2021-11-09 10:47:55 0:00:07 !ZoneLabel! !ZoneDescription!")
13859. 
13860. 
13861. /* Fixed Zone Position Handling */
13862. /* Literal number: */
13863. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
13864. /* Percentage of disk: */
13865. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
13866. /* Gap */
13867. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
13868. 
13869. /* ---------------------------------------------------------- */
13870. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
13871. # FILE STEP
13872. 
13873. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13874. 
13875. /* add message and move to a new line. */
13876. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13877. ")
13878. 
13879. /* display the line. (hopefully.) */
13880. # Zone Footer Set Statistics Window Text
13881. 
13882. SetStatisticsWindowText("----------------------------------------------------------
13883. Zones Processed: 
13884. ----------------------------------------------------------
13885. !ZoneListByLine!
13886. ----------------------------------------------------------
13887. Zone Processing Step:
13888. !ZoneStepByLine!    
13889. ----------------------------------------------------------
13890. Current Zone:
13891. !ZoneFooter!
13892. ----------------------------------------------------------
13893. Volume Statistics:
13894. !VolumeStatisticsDetail!
13895. ----------------------------------------------------------
13896. Zone Detailed Report:
13897. ----------------------------------------------------------
13898. !ZoneStatisticsDetail!
13899. ----------------------------------------------------------
13900. ")
13901. 
13902. 
13903. 
13904. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13905. 
13906. # BANNER SET
13907. 
13908. # DATE TIME RUN ELP
13909. 
13910. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
13911. /* Xinclude "..\Display\BannerSet.MyDc"X */
13912. /* pause(1) */
13913. 
13914. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13915. 
13916. Title('!Heading!')
13917. /* pause(1) */
13918. 
13919. /* NOTE: Can't round or truncate to integer precision. */
13920. 
13921. pause(1)
13922. 
13923. # your stuff HERE (X)... pre file select code.
13924. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
13925. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13926. 	# (X)
13927. 
13928. FileSelect
13929. 
13930. 	# your stuff can't really go here (errors.)
13931. 	# maybe for some reason I don't know of...
13932. 	
13933. 	# Actions next...
13934. 	# People start.
13935. # NotBlobsArchivesBu start.
13936. (not (
13937. # Blobs start.
13938. (
13939. # BlobsAndExceptions start.
13940. ( not(
13941.   FileName("*.bat")
13942.   or FileName("*.css")
13943.   or FileName("*.dll")
13944.   or FileName("*.exe")
13945.   or FileName("*.htm*")
13946.   or FileName("*.jar")
13947.   or FileName("*.js")
13948.   or FileName("*.script")
13949.   or FileName("*.wsf")
13950.   or (
13951. # Databases start.
13952. (
13953.   FileName("*.crypt*")
13954.   or FileName("*.db*")
13955.   or FileName("*.rdb*")
13956.   or FileName("*.dc*")
13957.   or FileName("*.dict*")
13958.   or FileName("*.?db*")
13959.   or FileName("*.?rdb*")
13960.   or FileName("*.md*")
13961.   or FileName("*.myd")
13962.   or FileName("*.ndf")
13963.   or FileName("*.ns?")
13964.   or FileName("*.pab")
13965.   or FileName("*.pst")
13966.   or FileName("*.sd?*")
13967.   or FileName("*.sq**")
13968.   or FileName("*.tmd")
13969.   or FileName("*.tps")
13970.   or FileName("*.tr*")
13971. )
13972. # Databases end.
13973. 
13974.     # BlobsAndExceptions
13975.     or 
13976. # Data start.
13977. (
13978.   DirectoryName("Data*")
13979.   or DirectoryName("Device*")
13980.   or DirectoryName("Export*")
13981.   or DirectoryName("Import*")
13982.   or DirectoryName("Log*")
13983.   or DirectoryName("*Log")
13984.   or DirectoryName("Maintenance*")
13985.   or DirectoryName("Rec*")
13986.   or DirectoryName("Sales*")
13987.   or DirectoryName("Search*")
13988.   or DirectoryName("User*")
13989. )
13990. # Data end.
13991. 
13992.     # BlobsAndExceptions
13993.   )
13994. ) )
13995. # BlobsAndExceptions end.
13996. 
13997. # Blobs
13998. ) and (
13999.   Size(BlobFileSize,0)
14000.   or (
14001.     FileName("*.arj")
14002.     or FileName("*.bup")
14003.     or FileName("*.bz2")
14004.     or FileName("*.chm")
14005.     or FileName("*.dvr-ms")
14006.     or FileName("*.gz")
14007.     or FileName("*.ifo")
14008.     or FileName("*.lzh")
14009.     or FileName("*.pdf")
14010.     or FileName("*.rpm")
14011.     or FileName("*.wmv")
14012.     or FileName("*.vob")
14013.     or FileName("*.z")
14014.   ) 
14015. )
14016. # Blobs end.
14017. 
14018. # NotBlobsArchivesBu
14019. or 
14020. # Archives start.
14021. (
14022.   DirectoryName("*Archive*")
14023.   or DirectoryName("*History*")
14024.   or DirectoryName("*Old")
14025.   or DirectoryName("* Old *")
14026.   or DirectoryName("Old *")
14027. 
14028.   or FileName("*.7z")
14029.   or FileName("*.cab")
14030.   or FileName("*.iso")
14031.   or FileName("*.msi")
14032.   or FileName("*.old")
14033.   or FileName("*.rar")
14034.   or FileName("*.tar")
14035.   or FileName("*.zip")
14036.   or
14037. # WinSysLow start.
14038. (
14039.   DirectoryName("$*")
14040.   or DirectoryName("0*")
14041.   or DirectoryName("1*")
14042.   or DirectoryName("2*")
14043.   or DirectoryName("3*")
14044.   or DirectoryName("4*")
14045.   or DirectoryName("5*")
14046.   or DirectoryName("6*")
14047.   or DirectoryName("7*")
14048.   or DirectoryName("8*")
14049.   or DirectoryName("9*")
14050. 
14051.   or DirectoryName("dllcache")
14052.   or DirectoryName("Downloaded Installations")
14053.   or DirectoryName("Ehome")
14054.   or DirectoryName("Fonts")
14055.   or DirectoryName("Help")
14056.   or DirectoryName("I386")
14057.   or DirectoryName("ie?updates")
14058.   or DirectoryName("Installer")
14059.   or DirectoryName("Installshield Installation Information")
14060.   or DirectoryName("IME")
14061.   or DirectoryName("*RECYCLE*")
14062.   or DirectoryName("ServicePackFiles")
14063.   or DirectoryName("SoftwareDistribution")
14064.   or DirectoryName("Speech")
14065.   or DirectoryName("Symbols")
14066.   or DirectoryName("System Volume Information")
14067.   or DirectoryName("windows.old")
14068. )
14069. # WinSysLow end.
14070. 
14071.   # Archives
14072. )
14073. # Archives end.
14074. 
14075. # NotBlobsArchivesBu
14076. or
14077. # Backups start.
14078. (
14079.   DirectoryName("*Backup*")
14080.   or DirectoryName("*Bu")
14081.   or DirectoryName("* Bu *")
14082.   or DirectoryName("Bu *")
14083. 
14084.   or FileName("*.bak")
14085.   or FileName("* - Copy*")
14086. )
14087. # Backups end.
14088. 
14089. # NotBlobsArchivesBu
14090. ) )
14091. # NotBlobsArchivesBu end.
14092. 
14093. # People
14094. and (
14095. # People start.
14096. (
14097.   DirectoryName("*Capture*")
14098.   or DirectoryName("*Document*")
14099.   or DirectoryName("*Download*")
14100.   or DirectoryName("*Kids*")
14101.   or DirectoryName("Mail*")
14102.   or DirectoryName("*Mail")
14103.   or DirectoryName("My*")
14104.   or DirectoryName("*Person*")
14105.   or DirectoryName("Private*")
14106.   or DirectoryName("Users")
14107.   
14108.   # Individual People HERE:
14109.   or DirectoryName("Dgh*")
14110. )
14111. # People end.
14112. 
14113. # People
14114. )
14115. # People end.
14116. 
14117. 		SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
14118. 
14119. 	# Zone Do Footer
14120. 
14121. /* ---------------------------------------------------------- */
14122. # File Select
14123. 	# Select Statments
14124. # File Actions 
14125. 	# Standard or OS File Actions.
14126. 	# Resume...
14127. 	
14128. 	# your stuff HERE (X)... post zone (file) file actions code.
14129. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
14130. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14131. 		# (X)
14132. 		
14133. 		/* ??? Set window? */
14134. 	
14135. 	# ADD THE GAP
14136. 		
14137. # Vacate (good for diagnostics)
14138. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
14139. 
14140. # DoNotVacate - DO NOT Vacate (recommended)
14141. 
14142. # Vacate
14143. /* AddGap(GapUsedLoc) */
14144. 
14145. # DO Not Vacate
14146. AddGap(GapUsedLoc, DoNotVacate) 
14147. 	
14148. 	
14149. /* ---------------------------------------------------------- */
14150. # (failed) TEST for boolean logic.
14151. 
14152. /* It should work in the gap calculations for turning options */
14153. /* on and off but it will NOT work here. */
14154. 
14155. /* Boolean setting X or FlagX. */
14156. /* Where X will be on or off: */
14157. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
14158. /*      For ON:  (X  *  FlagAny) */
14159. 
14160. /* 1) Failed, zero gap overrode the previous one. */
14161. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
14162. /* AddGap(GapUsedTemp) */ 
14163. 
14164. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
14165. /* AddGap(GapUsedTemp, DoNotVacate) */ 
14166. 
14167. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
14168. 
14169. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
14170. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
14171. /* AddGap(GapUsedTemp) */ 
14172. 
14173. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
14174. /* AddGap(GapUsedTemp, DoNotVacate) */ 
14175. 
14176. /* ---------------------------------------------------------- */
14177. 
14178. # Vacate
14179. /* AddGap(GapUsed) */
14180. 
14181. # DO NOT Vacate (recommended)
14182. /* AddGap(GapUsed, DoNotVacate) */ 
14183. 	
14184. 
14185. 		
14186. # 
14187. FileEnd
14188. /* ---------------------------------------------------------- */
14189. 
14190. # your stuff HERE (X)... post zone (file) code.
14191. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
14192. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14193. 	# (X)
14194. 
14195. SetVariable(FileStepDescription,"Zone finished, reporting.")
14196. # FILE STEP
14197. 
14198. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14199. 
14200. /* add message and move to a new line. */
14201. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14202. ")
14203. 
14204. /* display the line. (hopefully.) */
14205. # Zone Footer Set Statistics Window Text
14206. 
14207. SetStatisticsWindowText("----------------------------------------------------------
14208. Zones Processed: 
14209. ----------------------------------------------------------
14210. !ZoneListByLine!
14211. ----------------------------------------------------------
14212. Zone Processing Step:
14213. !ZoneStepByLine!    
14214. ----------------------------------------------------------
14215. Current Zone:
14216. !ZoneFooter!
14217. ----------------------------------------------------------
14218. Volume Statistics:
14219. !VolumeStatisticsDetail!
14220. ----------------------------------------------------------
14221. Zone Detailed Report:
14222. ----------------------------------------------------------
14223. !ZoneStatisticsDetail!
14224. ----------------------------------------------------------
14225. ")
14226. 
14227. 
14228. 
14229. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14230. 
14231. # BANNER SET
14232. 
14233. # DATE TIME RUN ELP
14234. 
14235. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
14236. /* Xinclude "..\Display\BannerSet.MyDc"X */
14237. /* pause(1) */
14238. 
14239. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14240. 
14241. Title('!Heading!')
14242. /* pause(1) */
14243. 
14244. /* NOTE: Can't round or truncate to integer precision. */
14245. 
14246. pause(1)
14247. 
14248. # Zone When Finished
14249. 
14250. # BANNER SET
14251. 
14252. # DATE TIME RUN ELP
14253. 
14254. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
14255. /* Xinclude "..\Display\BannerSet.MyDc"X */
14256. /* pause(1) */
14257. 
14258. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14259. 
14260. Title('!Heading!')
14261. /* pause(1) */
14262. 
14263. /* NOTE: Can't round or truncate to integer precision. */
14264. 
14265. AppendLogfile("!LogFileName!", "!Title!")
14266. 
14267. 
14268. 
14269. # Zone Statistics	
14270. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
14271. 
14272. # Footer:
14273. SetVariable(ZoneFooter, "----------------------------------------------------------
14274. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
14275. 
14276. Statistics Report:
14277. ------------------
14278.    Size:  
14279.    ------------------------
14280.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14281.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14282.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14283. 
14284.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14285.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14286. 
14287.    Location:
14288.    ------------------------
14289.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14290.              Files End: !ZoneEndCurrent!
14291.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14292.       
14293.    Gap Settings:
14294.    ------------------------
14295.          Gap Requested: !ZoneGapSizePer!%
14296.       Volume Rounding: !ZoneVolRoundUpPer!%
14297.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14298.                  
14299.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
14300.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
14301.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
14302.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
14303.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
14304.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
14305.      
14306.    Free Space after Zone:
14307.    ------------------------
14308.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14309.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14310.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14311. 
14312. Directory and Files Select:
14313. ---------------------------
14314. !ZoneTypeSelectCurrent!               
14315. ---------------------------
14316. ----------------------------------------------------------
14317. ")
14318. 
14319. AppendLogfile("!LogFileName!", ".")
14320. AppendLogfile("!LogFileName!", "!ZoneFooter!")
14321. AppendLogfile("!LogFileName!", ".")
14322. 
14323. # Zone Footer Set Statistics Window Text
14324. 
14325. SetStatisticsWindowText("----------------------------------------------------------
14326. Zones Processed: 
14327. ----------------------------------------------------------
14328. !ZoneListByLine!
14329. ----------------------------------------------------------
14330. Zone Processing Step:
14331. !ZoneStepByLine!    
14332. ----------------------------------------------------------
14333. Current Zone:
14334. !ZoneFooter!
14335. ----------------------------------------------------------
14336. Volume Statistics:
14337. !VolumeStatisticsDetail!
14338. ----------------------------------------------------------
14339. Zone Detailed Report:
14340. ----------------------------------------------------------
14341. !ZoneStatisticsDetail!
14342. ----------------------------------------------------------
14343. ")
14344. 
14345. 
14346. 
14347. /* pause() */
14348. /* pause() */
14349. 
14350. 
14351. 
14352. 
14353. /* ---------------------------------------------------------- */
14354. 
14355. 
14356. /* ---------------------------------------------------------- */
14357. // "4" & "5" now 8 & 9
14358. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
14359. /* Process MFT & Dir's HERE. */
14360. 	SetVariable(FileStepDescription,"Calculating Gap for MFT and DIR.")
14361. # BANNER SET
14362. 
14363. # DATE TIME RUN ELP
14364. 
14365. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
14366. /* Xinclude "..\Display\BannerSet.MyDc"X */
14367. /* pause(1) */
14368. 
14369. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14370. 
14371. Title('!Heading!')
14372. /* pause(1) */
14373. 
14374. /* NOTE: Can't round or truncate to integer precision. */
14375. 
14376. AppendLogfile("!LogFileName!", "!Title!")
14377. 
14378. 
14379. 
14380. 
14381. AppendLogfile("!LogFileName!", "MftLocation: !MftLocation! DoNotVacate 2021-11-09 10:47:55")
14382. 
14383. SetVariable(MftGapSlack, MftLocation - VolumeUsedTotal)
14384. AppendLogfile("!LogFileName!", "MftGapSlack: !MftGapSlack!")
14385. 
14386. SetVariable(MftGapSlackPerUsed, MftGapSlack / VolumeFreeAdj)
14387. AppendLogfile("!LogFileName!", "MftGapSlackPerUsed: !MftGapSlackPerUsed!")
14388. 
14389. AppendLogfile("!LogFileName!", "VolumeUsed before: !VolumeUsedTotal!")
14390. SetVariable(VolumeUsedTotal, MftLocation)
14391. AppendLogfile("!LogFileName!", "VolumeUsed at location: !VolumeUsedTotal!")
14392. 
14393. SetVariable(VolumeFreePerUsed, VolumeFreePerUsed + (MftGapSlack / VolumeFree))
14394. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!")
14395. 
14396. /* ---------------------------------------------------------- */
14397. #  MFT
14398. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
14399. 
14400. /* ---------------------------------------------------------- */
14401. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
14402.   
14403. SetVariable(ZoneLabel,				"MFT") // "4" 
14404. SetVariable(ZoneDescription, 		"MFT - Master File Table")
14405. SetVariable(ZoneCurrentAjust, 		1)
14406. /* and some other special NTFS files. */
14407. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpMft!")
14408. SetVariable(ZoneGapSize, 			"!ZoneGapSizeMft!")
14409. SetVariable(ZoneTypeSelect,'# MFT start.
14410. SelectNtfsSystemFiles(yes)
14411. # MFT end.')
14412. 
14413. 	# Zone Do Header
14414. 
14415. # Zone When Started
14416. 
14417. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
14418. # Display Set Zone
14419. 
14420. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
14421. SetVariable(FileStepDescription,	"")
14422. 
14423. SetVariable(ZoneStepByLine, 			"Zone started.
14424. ")
14425. 
14426. # BANNER SET
14427. 
14428. # DATE TIME RUN ELP
14429. 
14430. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
14431. /* Xinclude "..\Display\BannerSet.MyDc"X */
14432. /* pause(1) */
14433. 
14434. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14435. 
14436. Title('!Heading!')
14437. /* pause(1) */
14438. 
14439. /* NOTE: Can't round or truncate to integer precision. */
14440. 
14441. AppendLogfile("!LogFileName!", "!Title!")
14442. 
14443. 
14444. 
14445. pause(1)
14446. 
14447. 
14448. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
14449. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
14450. 
14451. SetVariable(ZoneStepNoCurrent, 0)
14452. 
14453. 
14454. # Zone Do Current Clear
14455. 
14456. SetVariable(ZoneTypeSelectCurrent, 		"")
14457. 
14458. SetVariable(ZoneBeginCurrent, 			0)
14459. SetVariable(ZoneBeginPerCurrent, 		0)
14460. SetVariable(ZoneEndCurrent, 			0)
14461. SetVariable(ZoneEndPerCurrent, 			0)
14462. 
14463. SetVariable(ZoneSizeCurrent,			0)
14464. SetVariable(ZoneSizePerCurrent,			0)
14465. 
14466. SetVariable(ZoneGapRequestedCurrent,	0)
14467. SetVariable(ZoneGapRoundedCurrent, 		0)
14468. SetVariable(ZoneGapAdjustedCurrent, 	0)
14469. SetVariable(ZoneGapAvailableCurrent, 	0)
14470. SetVariable(ZoneGapCurrent,				0)
14471. SetVariable(ZoneGapUsedCurrent, 		0)
14472. 
14473. SetVariable(ZoneGapActualCurrent, 		0)
14474. SetVariable(ZoneGapActualPerCurrent, 	0)
14475. 
14476. SetVariable(ZoneSizeActual, 			0)
14477. SetVariable(ZoneSizeActualCurrent,		0)
14478. 
14479. SetVariable(ZoneEndActual, 				0)
14480. SetVariable(ZoneEndActualCurrent,		0)			
14481. SetVariable(ZoneSizeActualPerCurrent, 	0)
14482.       
14483. SetVariable(ZoneFilesFolders,			0)
14484. SetVariable(ZoneFilesFoldersPer,		0) 
14485. 
14486. SetVariable(ZoneFragments,				0)
14487. SetVariable(ZoneFragmentsPer,			0) 
14488. 		
14489. SetVariable(ZoneEndActualCurrent, 		0)
14490. SetVariable(ZoneEndActualPerCurrent, 	0)
14491. 
14492. # Gap Calculation Methodology:
14493. 	# Requested
14494. 	SetVariable(GapRequested, 			0) 
14495. 	SetVariable(GapRequestedStd, 		0) 
14496. 	SetVariable(GapRequestedMft, 		0) 
14497. 	SetVariable(GapRequestedOs, 		0) 
14498. 	SetVariable(GapRequestedOriginal, 	0) 
14499. 	
14500. 	# Gap Adjustments
14501. 	SetVariable(GapRounded, 			0)
14502. 	# SetVariable(GapAdjusted, 			0)
14503. 	SetVariable(GapAvailable, 			0)
14504. 	SetVariable(GapCurrent, 			0)
14505. 	SetVariable(GapActual, 				0)
14506. 	SetVariable(GapUsed, 				0)
14507. 	
14508. 	# Gap Adjustments
14509. 	SetVariable(GapRoundedLoc, 			0)
14510. 	# SetVariable(GapAdjustedLoc, 		0)
14511. 	SetVariable(GapAvailableLoc, 		0)
14512. 	SetVariable(GapCurrentLoc, 			0)
14513. 	SetVariable(GapActualLoc,			0)
14514. 	SetVariable(GapUsedLoc,				0)
14515. 	
14516. 	# Space usage
14517. 	SetVariable(ZoneFreePerRequested, 	0)
14518. 	SetVariable(ZoneFreePerUsed, 		0)
14519. 
14520. # Gap Size & Rounding
14521. 	SetVariable(ZoneGapSizePer, 		0)
14522. 	SetVariable(ZoneVolRoundUpPer, 		0)
14523. 	
14524. 	# Free Space
14525. 	SetVariable(ZoneFreeUsedPer, 		0)
14526. 	SetVariable(ZoneFreeRequestedPer, 	0)
14527. 
14528. 
14529. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
14530. 
14531. # Footer:
14532. SetVariable(ZoneFooter, "----------------------------------------------------------
14533. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
14534. 
14535. Statistics Report:
14536. ------------------
14537.    Size:  
14538.    ------------------------
14539.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14540.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14541.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14542. 
14543.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14544.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14545. 
14546.    Location:
14547.    ------------------------
14548.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14549.              Files End: !ZoneEndCurrent!
14550.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14551.       
14552.    Gap Settings:
14553.    ------------------------
14554.          Gap Requested: !ZoneGapSizePer!%
14555.       Volume Rounding: !ZoneVolRoundUpPer!%
14556.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14557.                  
14558.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
14559.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
14560.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
14561.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
14562.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
14563.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
14564.      
14565.    Free Space after Zone:
14566.    ------------------------
14567.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14568.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14569.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14570. 
14571. Directory and Files Select:
14572. ---------------------------
14573. !ZoneTypeSelectCurrent!               
14574. ---------------------------
14575. ----------------------------------------------------------
14576. ")
14577. 
14578. # BANNER SET
14579. 
14580. # DATE TIME RUN ELP
14581. 
14582. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
14583. /* Xinclude "..\Display\BannerSet.MyDc"X */
14584. /* pause(1) */
14585. 
14586. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14587. 
14588. Title('!Heading!')
14589. /* pause(1) */
14590. 
14591. /* NOTE: Can't round or truncate to integer precision. */
14592. 
14593. AppendLogfile("!LogFileName!", "!Title!")
14594. 
14595. 
14596. 
14597. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
14598. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
14599. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:55")
14600. 
14601. SetVariable(ZoneListByLine, "!ZoneListByLine!
14602. Zone: !ZoneNoCurrent! 2021-11-09 10:47:55 0:00:07 !ZoneLabel! !ZoneDescription!")
14603. 
14604. 
14605. /* Fixed Zone Position Handling */
14606. /* Literal number: */
14607. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
14608. /* Percentage of disk: */
14609. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
14610. /* Gap */
14611. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
14612. 
14613. /* ---------------------------------------------------------- */
14614. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
14615. # FILE STEP
14616. 
14617. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14618. 
14619. /* add message and move to a new line. */
14620. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14621. ")
14622. 
14623. /* display the line. (hopefully.) */
14624. # Zone Footer Set Statistics Window Text
14625. 
14626. SetStatisticsWindowText("----------------------------------------------------------
14627. Zones Processed: 
14628. ----------------------------------------------------------
14629. !ZoneListByLine!
14630. ----------------------------------------------------------
14631. Zone Processing Step:
14632. !ZoneStepByLine!    
14633. ----------------------------------------------------------
14634. Current Zone:
14635. !ZoneFooter!
14636. ----------------------------------------------------------
14637. Volume Statistics:
14638. !VolumeStatisticsDetail!
14639. ----------------------------------------------------------
14640. Zone Detailed Report:
14641. ----------------------------------------------------------
14642. !ZoneStatisticsDetail!
14643. ----------------------------------------------------------
14644. ")
14645. 
14646. 
14647. 
14648. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14649. 
14650. # BANNER SET
14651. 
14652. # DATE TIME RUN ELP
14653. 
14654. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
14655. /* Xinclude "..\Display\BannerSet.MyDc"X */
14656. /* pause(1) */
14657. 
14658. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14659. 
14660. Title('!Heading!')
14661. /* pause(1) */
14662. 
14663. /* NOTE: Can't round or truncate to integer precision. */
14664. 
14665. pause(1)
14666. 
14667. # your stuff HERE (X)... pre file select code.
14668. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
14669. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14670. 	# (X)
14671. 
14672. FileSelect
14673. 
14674. 	# your stuff can't really go here (errors.)
14675. 	# maybe for some reason I don't know of...
14676. 	
14677. 	# Actions next...
14678. 	# MFT start.
14679. SelectNtfsSystemFiles(yes)
14680. # MFT end.
14681. 	FileActions
14682. 	  		/* ---------------------------------------------------------- */
14683. 	# Gap
14684. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
14685. 		# FILE STEP
14686. 
14687. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14688. 
14689. /* add message and move to a new line. */
14690. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14691. ")
14692. 
14693. /* display the line. (hopefully.) */
14694. # Zone Footer Set Statistics Window Text
14695. 
14696. SetStatisticsWindowText("----------------------------------------------------------
14697. Zones Processed: 
14698. ----------------------------------------------------------
14699. !ZoneListByLine!
14700. ----------------------------------------------------------
14701. Zone Processing Step:
14702. !ZoneStepByLine!    
14703. ----------------------------------------------------------
14704. Current Zone:
14705. !ZoneFooter!
14706. ----------------------------------------------------------
14707. Volume Statistics:
14708. !VolumeStatisticsDetail!
14709. ----------------------------------------------------------
14710. Zone Detailed Report:
14711. ----------------------------------------------------------
14712. !ZoneStatisticsDetail!
14713. ----------------------------------------------------------
14714. ")
14715. 
14716. 
14717. 
14718. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14719. 
14720. # BANNER SET
14721. 
14722. # DATE TIME RUN ELP
14723. 
14724. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
14725. /* Xinclude "..\Display\BannerSet.MyDc"X */
14726. /* pause(1) */
14727. 
14728. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14729. 
14730. Title('!Heading!')
14731. /* pause(1) */
14732. 
14733. /* NOTE: Can't round or truncate to integer precision. */
14734. 
14735. pause(1)
14736. 	
14737. 	# ACTUAL GAP
14738. 		/* AddGap Variant. */
14739. 	  	# Zone Do Gap
14740. # Gap Calculation Methods:
14741. 
14742. /* 1) Anything you need to add first. */
14743. /* empty */
14744. 
14745. /* ---------------------------------------------------------- */
14746. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
14747. 	# GapRequestedStd.
14748. 
14749. 		/* ---------------------------------------------------------- */
14750. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
14751. 
14752. 		# Gap Calculation Methods:
14753. 
14754. /* AddGap Variants */
14755. 
14756. 	/* Standard */
14757. 		# Gap Calculation Methods:
14758. 	/* AddGap Variants */
14759. 	/* Standard */
14760. 
14761. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
14762. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
14763. 
14764. 	SetVariable(GapRequested, GapRequestedStd)
14765. 	
14766. 
14767. 	/* MFT Low High Method */
14768. 		# Gap Calculation Methods:
14769. 	/* AddGap Variants */
14770. 	/* MFT Low High Method */
14771. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
14772. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
14773. 	SetVariable(GapRequested, GapRequestedMft)
14774. 	
14775. 
14776. 	/* OS Volume Type Method */
14777. 		# Gap Calculation Methods:
14778. 	/* AddGap Variants */
14779. 	/* OS Volume Type Method */
14780. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
14781. 	SetVariable(GapRequested, GapRequestedOs)
14782. 
14783. 
14784. 
14785. /* MakeGap Variants */
14786. 
14787. 	/* Original Os 1-3 + MFT 2 */
14788. 		# Gap Calculation Methods:
14789. 	/* MakeGap Variants */
14790. 	/* Original Os 1-3 + MFT 2 */
14791. 	/* plus MFT gap placed inline at the dividing zone. */
14792. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
14793. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
14794. 	SetVariable(GapRequested, GapRequestedOrig)
14795. 	
14796. 	
14797. /* Note: You could comment out the ones not in use */
14798. /* However having the data in the log is useful. */
14799. /* Therefore the following line is otherwise needed. */
14800. 
14801. /* Standard used */
14802. 
14803. SetVariable(GapRequested, GapRequestedStd)
14804. 
14805. # Gap Calculation Methods:
14806. 
14807. /* AddGap Variants */
14808. 	/* Standard */
14809. 	/* MFT Low High Method */
14810. 	/* OS Volume Type Method */
14811. 
14812. /* MakeGap Variants */
14813. 	/* Original Os 1-3 + MFT 2 */
14814. 
14815. /* Note: You could comment out the ones not in use */
14816. /* However having the data in the log is useful. */
14817. /* Therefore the following line is otherwise needed. */
14818. 
14819. /* Standard is used currently */
14820. 
14821. 
14822. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
14823. 
14824. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
14825. 
14826. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
14827. 
14828. /* ---------------------------------------------------------- */
14829. /* 3) SMALL ZONE ADJUSTMENT. */
14830. /* Gab cant be larger than half the Zone Size. */
14831. 
14832. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
14833. 	
14834. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
14835. 
14836. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
14837. 
14838. /* ---------------------------------------------------------- */
14839. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
14840. # Gap Adjustments.
14841. 
14842. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
14843. 	
14844. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
14845. 
14846. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
14847. 
14848. /* ---------------------------------------------------------- */
14849. # BYPASS THIS.
14850. 	/* This is definitely wrong. */
14851. 	/* The question is can we steal gap from the next zone */
14852. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
14853. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
14854. 		# Zone Overflow.
14855. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
14856. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
14857. 
14858. /* ---------------------------------------------------------- */
14859. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
14860. # Remaining free space available.
14861. 
14862. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
14863. 	
14864. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
14865. 
14866. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
14867. 
14868. /* ---------------------------------------------------------- */
14869. # CURRENT gap to use.
14870. 
14871. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
14872. 
14873. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
14874. 
14875. /* ---------------------------------------------------------- */
14876. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
14877. # Debugging.
14878. 
14879. 	SetVariable(GapUsed, GapCurrent) // for debugging
14880. 
14881. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
14882. 
14883. 		# Your code HERE
14884. 
14885. /* ---------------------------------------------------------- */
14886. /* 7) YOUR CODE. */
14887. # YOUR CODE HERE:
14888. 	# INPUT: GapCurrent or GapCurrentLoc
14889. 	# OUTPUT: GapUsed...
14890. 
14891. /* ---------------------------------------------------------- */
14892. # Gap Size.
14893. # Actual Size of Gap.
14894. 
14895. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
14896. 
14897. /* ---------------------------------------------------------- */
14898. /* xxxxxxxxxxxxxxxxxxxxxx */
14899. # ADD THE GAP
14900. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
14901. /* xxxxxxxxxxxxxxxxxxxxxx */
14902. 
14903. 	
14904. 	# Zone Statistics	
14905. 	# Zone / Volume Statistics and Display
14906. 		
14907. 	# Accumulate Totals
14908.   	# Volume totals
14909. 
14910. /* Current total space used (by Zones and Gaps) */
14911. 
14912. SetVariable(VolumeZoneUsed, GapUsed)
14913. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
14914. /* Percentage */
14915. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
14916. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
14917. 
14918. /* Current total of free space requested */
14919. 
14920. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
14921. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
14922. /* Percent. */
14923. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
14924. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
14925. 
14926. /* Current total of free space used */
14927. 
14928. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
14929. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
14930. /* Percent */
14931. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
14932. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
14933. 
14934. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
14935. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
14936. /* Xinclude "..\DebugDisplayPause.MyDc"X */
14937. 
14938. 
14939. 	# Current Values
14940. 	# Cluster, Sector, Block adjust for display.
14941. 	# Bytes per cluster is volume specific.
14942. 
14943. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
14944. 
14945. # Current Zone values.
14946. 	# Begin, end and size.
14947. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
14948. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
14949. 
14950. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
14951. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
14952. 
14953. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
14954. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
14955. 
14956. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
14957. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
14958. 
14959. 	SetVariable(ZoneFragments,				"!ZONE210N!")
14960. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
14961. 		
14962. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
14963. /* identical code to here: (separation not needed. TEST.) */	
14964. 
14965. # Current Gap, Actual and Free Values
14966. 	# Gap
14967. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
14968. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
14969. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
14970. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
14971. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
14972. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
14973. 	
14974. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
14975. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
14976. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
14977. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
14978. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
14979. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
14980. 	
14981. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
14982. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
14983. 	
14984. 	# Actual Size and End
14985. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
14986. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
14987. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
14988. 	
14989. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
14990. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
14991. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
14992. 
14993. # Gap Size & Rounding
14994. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
14995. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
14996. 	
14997. 	# Free Space
14998. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
14999. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
15000. 
15001. 	# Footer:
15002. SetVariable(ZoneFooter, "----------------------------------------------------------
15003. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
15004. 
15005. Statistics Report:
15006. ------------------
15007.    Size:  
15008.    ------------------------
15009.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15010.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15011.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15012. 
15013.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15014.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15015. 
15016.    Location:
15017.    ------------------------
15018.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15019.              Files End: !ZoneEndCurrent!
15020.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15021.       
15022.    Gap Settings:
15023.    ------------------------
15024.          Gap Requested: !ZoneGapSizePer!%
15025.       Volume Rounding: !ZoneVolRoundUpPer!%
15026.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15027.                  
15028.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15029.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15030.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15031.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15032.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15033.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15034.      
15035.    Free Space after Zone:
15036.    ------------------------
15037.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15038.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15039.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15040. 
15041. Directory and Files Select:
15042. ---------------------------
15043. !ZoneTypeSelectCurrent!               
15044. ---------------------------
15045. ----------------------------------------------------------
15046. ")
15047. 	# Zone Footer Set Statistics Window Text
15048. 
15049. SetStatisticsWindowText("----------------------------------------------------------
15050. Zones Processed: 
15051. ----------------------------------------------------------
15052. !ZoneListByLine!
15053. ----------------------------------------------------------
15054. Zone Processing Step:
15055. !ZoneStepByLine!    
15056. ----------------------------------------------------------
15057. Current Zone:
15058. !ZoneFooter!
15059. ----------------------------------------------------------
15060. Volume Statistics:
15061. !VolumeStatisticsDetail!
15062. ----------------------------------------------------------
15063. Zone Detailed Report:
15064. ----------------------------------------------------------
15065. !ZoneStatisticsDetail!
15066. ----------------------------------------------------------
15067. ")
15068. 
15069. 
15070. 	
15071.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
15072. 
15073. 	# Add Zone to list of zones for display.
15074. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
15075. 	# ??? Free Stats?
15076. 	# Footer:
15077. SetVariable(ZoneFooter, "----------------------------------------------------------
15078. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
15079. 
15080. Statistics Report:
15081. ------------------
15082.    Size:  
15083.    ------------------------
15084.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15085.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15086.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15087. 
15088.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15089.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15090. 
15091.    Location:
15092.    ------------------------
15093.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15094.              Files End: !ZoneEndCurrent!
15095.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15096.       
15097.    Gap Settings:
15098.    ------------------------
15099.          Gap Requested: !ZoneGapSizePer!%
15100.       Volume Rounding: !ZoneVolRoundUpPer!%
15101.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15102.                  
15103.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15104.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15105.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15106.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15107.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15108.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15109.      
15110.    Free Space after Zone:
15111.    ------------------------
15112.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15113.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15114.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15115. 
15116. Directory and Files Select:
15117. ---------------------------
15118. !ZoneTypeSelectCurrent!               
15119. ---------------------------
15120. ----------------------------------------------------------
15121. ")
15122. 
15123. 	# Add Zone Details to Report.	
15124. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
15125. !ZoneFooter!")
15126. 
15127. 
15128. 	
15129. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
15130. 		# FILE STEP
15131. 
15132. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15133. 
15134. /* add message and move to a new line. */
15135. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15136. ")
15137. 
15138. /* display the line. (hopefully.) */
15139. # Zone Footer Set Statistics Window Text
15140. 
15141. SetStatisticsWindowText("----------------------------------------------------------
15142. Zones Processed: 
15143. ----------------------------------------------------------
15144. !ZoneListByLine!
15145. ----------------------------------------------------------
15146. Zone Processing Step:
15147. !ZoneStepByLine!    
15148. ----------------------------------------------------------
15149. Current Zone:
15150. !ZoneFooter!
15151. ----------------------------------------------------------
15152. Volume Statistics:
15153. !VolumeStatisticsDetail!
15154. ----------------------------------------------------------
15155. Zone Detailed Report:
15156. ----------------------------------------------------------
15157. !ZoneStatisticsDetail!
15158. ----------------------------------------------------------
15159. ")
15160. 
15161. 
15162. 
15163. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15164. 
15165. # BANNER SET
15166. 
15167. # DATE TIME RUN ELP
15168. 
15169. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
15170. /* Xinclude "..\Display\BannerSet.MyDc"X */
15171. /* pause(1) */
15172. 
15173. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15174. 
15175. Title('!Heading!')
15176. /* pause(1) */
15177. 
15178. /* NOTE: Can't round or truncate to integer precision. */
15179. 
15180. pause(1)
15181. 	
15182. 		SetVariable(MftZone, ZoneCurrent) 
15183. 
15184. 		# File Action - MFT.
15185. PlaceNtfsSystemFiles(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes), MftSize * 0.1)
15186. 	
15187. 
15188.   		SetVariable(MftSize,ZoneSize) 
15189. 
15190. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
15191. 		# FILE STEP
15192. 
15193. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15194. 
15195. /* add message and move to a new line. */
15196. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15197. ")
15198. 
15199. /* display the line. (hopefully.) */
15200. # Zone Footer Set Statistics Window Text
15201. 
15202. SetStatisticsWindowText("----------------------------------------------------------
15203. Zones Processed: 
15204. ----------------------------------------------------------
15205. !ZoneListByLine!
15206. ----------------------------------------------------------
15207. Zone Processing Step:
15208. !ZoneStepByLine!    
15209. ----------------------------------------------------------
15210. Current Zone:
15211. !ZoneFooter!
15212. ----------------------------------------------------------
15213. Volume Statistics:
15214. !VolumeStatisticsDetail!
15215. ----------------------------------------------------------
15216. Zone Detailed Report:
15217. ----------------------------------------------------------
15218. !ZoneStatisticsDetail!
15219. ----------------------------------------------------------
15220. ")
15221. 
15222. 
15223. 
15224. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15225. 
15226. # BANNER SET
15227. 
15228. # DATE TIME RUN ELP
15229. 
15230. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
15231. /* Xinclude "..\Display\BannerSet.MyDc"X */
15232. /* pause(1) */
15233. 
15234. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15235. 
15236. Title('!Heading!')
15237. /* pause(1) */
15238. 
15239. /* NOTE: Can't round or truncate to integer precision. */
15240. 
15241. pause(1)
15242.   	# Zone Do Footer
15243. 
15244. /* ---------------------------------------------------------- */
15245. # File Select
15246. 	# Select Statments
15247. # File Actions 
15248. 	# Standard or OS File Actions.
15249. 	# Resume...
15250. 	
15251. 	# your stuff HERE (X)... post zone (file) file actions code.
15252. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
15253. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15254. 		# (X)
15255. 		
15256. 		/* ??? Set window? */
15257. 	
15258. 	# ADD THE GAP
15259. 		
15260. # Vacate (good for diagnostics)
15261. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
15262. 
15263. # DoNotVacate - DO NOT Vacate (recommended)
15264. 
15265. # Vacate
15266. /* AddGap(GapUsedLoc) */
15267. 
15268. # DO Not Vacate
15269. AddGap(GapUsedLoc, DoNotVacate) 
15270. 	
15271. 	
15272. /* ---------------------------------------------------------- */
15273. # (failed) TEST for boolean logic.
15274. 
15275. /* It should work in the gap calculations for turning options */
15276. /* on and off but it will NOT work here. */
15277. 
15278. /* Boolean setting X or FlagX. */
15279. /* Where X will be on or off: */
15280. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
15281. /*      For ON:  (X  *  FlagAny) */
15282. 
15283. /* 1) Failed, zero gap overrode the previous one. */
15284. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
15285. /* AddGap(GapUsedTemp) */ 
15286. 
15287. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
15288. /* AddGap(GapUsedTemp, DoNotVacate) */ 
15289. 
15290. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
15291. 
15292. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
15293. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
15294. /* AddGap(GapUsedTemp) */ 
15295. 
15296. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
15297. /* AddGap(GapUsedTemp, DoNotVacate) */ 
15298. 
15299. /* ---------------------------------------------------------- */
15300. 
15301. # Vacate
15302. /* AddGap(GapUsed) */
15303. 
15304. # DO NOT Vacate (recommended)
15305. /* AddGap(GapUsed, DoNotVacate) */ 
15306. 	
15307. 
15308. 		
15309. # 
15310. FileEnd
15311. /* ---------------------------------------------------------- */
15312. 
15313. # your stuff HERE (X)... post zone (file) code.
15314. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
15315. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15316. 	# (X)
15317. 
15318. SetVariable(FileStepDescription,"Zone finished, reporting.")
15319. # FILE STEP
15320. 
15321. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15322. 
15323. /* add message and move to a new line. */
15324. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15325. ")
15326. 
15327. /* display the line. (hopefully.) */
15328. # Zone Footer Set Statistics Window Text
15329. 
15330. SetStatisticsWindowText("----------------------------------------------------------
15331. Zones Processed: 
15332. ----------------------------------------------------------
15333. !ZoneListByLine!
15334. ----------------------------------------------------------
15335. Zone Processing Step:
15336. !ZoneStepByLine!    
15337. ----------------------------------------------------------
15338. Current Zone:
15339. !ZoneFooter!
15340. ----------------------------------------------------------
15341. Volume Statistics:
15342. !VolumeStatisticsDetail!
15343. ----------------------------------------------------------
15344. Zone Detailed Report:
15345. ----------------------------------------------------------
15346. !ZoneStatisticsDetail!
15347. ----------------------------------------------------------
15348. ")
15349. 
15350. 
15351. 
15352. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15353. 
15354. # BANNER SET
15355. 
15356. # DATE TIME RUN ELP
15357. 
15358. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
15359. /* Xinclude "..\Display\BannerSet.MyDc"X */
15360. /* pause(1) */
15361. 
15362. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15363. 
15364. Title('!Heading!')
15365. /* pause(1) */
15366. 
15367. /* NOTE: Can't round or truncate to integer precision. */
15368. 
15369. pause(1)
15370. 
15371. # Zone When Finished
15372. 
15373. # BANNER SET
15374. 
15375. # DATE TIME RUN ELP
15376. 
15377. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
15378. /* Xinclude "..\Display\BannerSet.MyDc"X */
15379. /* pause(1) */
15380. 
15381. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15382. 
15383. Title('!Heading!')
15384. /* pause(1) */
15385. 
15386. /* NOTE: Can't round or truncate to integer precision. */
15387. 
15388. AppendLogfile("!LogFileName!", "!Title!")
15389. 
15390. 
15391. 
15392. # Zone Statistics	
15393. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
15394. 
15395. # Footer:
15396. SetVariable(ZoneFooter, "----------------------------------------------------------
15397. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
15398. 
15399. Statistics Report:
15400. ------------------
15401.    Size:  
15402.    ------------------------
15403.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15404.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15405.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15406. 
15407.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15408.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15409. 
15410.    Location:
15411.    ------------------------
15412.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15413.              Files End: !ZoneEndCurrent!
15414.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15415.       
15416.    Gap Settings:
15417.    ------------------------
15418.          Gap Requested: !ZoneGapSizePer!%
15419.       Volume Rounding: !ZoneVolRoundUpPer!%
15420.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15421.                  
15422.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15423.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15424.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15425.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15426.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15427.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15428.      
15429.    Free Space after Zone:
15430.    ------------------------
15431.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15432.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15433.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15434. 
15435. Directory and Files Select:
15436. ---------------------------
15437. !ZoneTypeSelectCurrent!               
15438. ---------------------------
15439. ----------------------------------------------------------
15440. ")
15441. 
15442. AppendLogfile("!LogFileName!", ".")
15443. AppendLogfile("!LogFileName!", "!ZoneFooter!")
15444. AppendLogfile("!LogFileName!", ".")
15445. 
15446. # Zone Footer Set Statistics Window Text
15447. 
15448. SetStatisticsWindowText("----------------------------------------------------------
15449. Zones Processed: 
15450. ----------------------------------------------------------
15451. !ZoneListByLine!
15452. ----------------------------------------------------------
15453. Zone Processing Step:
15454. !ZoneStepByLine!    
15455. ----------------------------------------------------------
15456. Current Zone:
15457. !ZoneFooter!
15458. ----------------------------------------------------------
15459. Volume Statistics:
15460. !VolumeStatisticsDetail!
15461. ----------------------------------------------------------
15462. Zone Detailed Report:
15463. ----------------------------------------------------------
15464. !ZoneStatisticsDetail!
15465. ----------------------------------------------------------
15466. ")
15467. 
15468. 
15469. 
15470. /* pause() */
15471. /* pause() */
15472. 
15473. 
15474. 
15475. /* ---------------------------------------------------------- */
15476. 
15477.   
15478. /* ---------------------------------------------------------- */
15479. # DIR
15480. 
15481. /* ---------------------------------------------------------- */
15482. SetVariable(ZoneLabel,				"DIR") // "5"
15483. SetVariable(ZoneDescription, 		"Directories.")
15484. SetVariable(ZoneCurrentAjust, 		2)
15485. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpDir!")
15486. SetVariable(ZoneGapSize, 			"!ZoneGapSizeDir!")
15487. SetVariable(ZoneTypeSelect,'# DIR start.
15488. Directory(yes)
15489. # DIR end.
15490. ')
15491. 
15492. 	# Zone Do Header
15493. 
15494. # Zone When Started
15495. 
15496. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
15497. # Display Set Zone
15498. 
15499. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
15500. SetVariable(FileStepDescription,	"")
15501. 
15502. SetVariable(ZoneStepByLine, 			"Zone started.
15503. ")
15504. 
15505. # BANNER SET
15506. 
15507. # DATE TIME RUN ELP
15508. 
15509. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
15510. /* Xinclude "..\Display\BannerSet.MyDc"X */
15511. /* pause(1) */
15512. 
15513. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15514. 
15515. Title('!Heading!')
15516. /* pause(1) */
15517. 
15518. /* NOTE: Can't round or truncate to integer precision. */
15519. 
15520. AppendLogfile("!LogFileName!", "!Title!")
15521. 
15522. 
15523. 
15524. pause(1)
15525. 
15526. 
15527. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
15528. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
15529. 
15530. SetVariable(ZoneStepNoCurrent, 0)
15531. 
15532. 
15533. # Zone Do Current Clear
15534. 
15535. SetVariable(ZoneTypeSelectCurrent, 		"")
15536. 
15537. SetVariable(ZoneBeginCurrent, 			0)
15538. SetVariable(ZoneBeginPerCurrent, 		0)
15539. SetVariable(ZoneEndCurrent, 			0)
15540. SetVariable(ZoneEndPerCurrent, 			0)
15541. 
15542. SetVariable(ZoneSizeCurrent,			0)
15543. SetVariable(ZoneSizePerCurrent,			0)
15544. 
15545. SetVariable(ZoneGapRequestedCurrent,	0)
15546. SetVariable(ZoneGapRoundedCurrent, 		0)
15547. SetVariable(ZoneGapAdjustedCurrent, 	0)
15548. SetVariable(ZoneGapAvailableCurrent, 	0)
15549. SetVariable(ZoneGapCurrent,				0)
15550. SetVariable(ZoneGapUsedCurrent, 		0)
15551. 
15552. SetVariable(ZoneGapActualCurrent, 		0)
15553. SetVariable(ZoneGapActualPerCurrent, 	0)
15554. 
15555. SetVariable(ZoneSizeActual, 			0)
15556. SetVariable(ZoneSizeActualCurrent,		0)
15557. 
15558. SetVariable(ZoneEndActual, 				0)
15559. SetVariable(ZoneEndActualCurrent,		0)			
15560. SetVariable(ZoneSizeActualPerCurrent, 	0)
15561.       
15562. SetVariable(ZoneFilesFolders,			0)
15563. SetVariable(ZoneFilesFoldersPer,		0) 
15564. 
15565. SetVariable(ZoneFragments,				0)
15566. SetVariable(ZoneFragmentsPer,			0) 
15567. 		
15568. SetVariable(ZoneEndActualCurrent, 		0)
15569. SetVariable(ZoneEndActualPerCurrent, 	0)
15570. 
15571. # Gap Calculation Methodology:
15572. 	# Requested
15573. 	SetVariable(GapRequested, 			0) 
15574. 	SetVariable(GapRequestedStd, 		0) 
15575. 	SetVariable(GapRequestedMft, 		0) 
15576. 	SetVariable(GapRequestedOs, 		0) 
15577. 	SetVariable(GapRequestedOriginal, 	0) 
15578. 	
15579. 	# Gap Adjustments
15580. 	SetVariable(GapRounded, 			0)
15581. 	# SetVariable(GapAdjusted, 			0)
15582. 	SetVariable(GapAvailable, 			0)
15583. 	SetVariable(GapCurrent, 			0)
15584. 	SetVariable(GapActual, 				0)
15585. 	SetVariable(GapUsed, 				0)
15586. 	
15587. 	# Gap Adjustments
15588. 	SetVariable(GapRoundedLoc, 			0)
15589. 	# SetVariable(GapAdjustedLoc, 		0)
15590. 	SetVariable(GapAvailableLoc, 		0)
15591. 	SetVariable(GapCurrentLoc, 			0)
15592. 	SetVariable(GapActualLoc,			0)
15593. 	SetVariable(GapUsedLoc,				0)
15594. 	
15595. 	# Space usage
15596. 	SetVariable(ZoneFreePerRequested, 	0)
15597. 	SetVariable(ZoneFreePerUsed, 		0)
15598. 
15599. # Gap Size & Rounding
15600. 	SetVariable(ZoneGapSizePer, 		0)
15601. 	SetVariable(ZoneVolRoundUpPer, 		0)
15602. 	
15603. 	# Free Space
15604. 	SetVariable(ZoneFreeUsedPer, 		0)
15605. 	SetVariable(ZoneFreeRequestedPer, 	0)
15606. 
15607. 
15608. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
15609. 
15610. # Footer:
15611. SetVariable(ZoneFooter, "----------------------------------------------------------
15612. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
15613. 
15614. Statistics Report:
15615. ------------------
15616.    Size:  
15617.    ------------------------
15618.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15619.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15620.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15621. 
15622.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15623.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15624. 
15625.    Location:
15626.    ------------------------
15627.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15628.              Files End: !ZoneEndCurrent!
15629.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15630.       
15631.    Gap Settings:
15632.    ------------------------
15633.          Gap Requested: !ZoneGapSizePer!%
15634.       Volume Rounding: !ZoneVolRoundUpPer!%
15635.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15636.                  
15637.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15638.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15639.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15640.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15641.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15642.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15643.      
15644.    Free Space after Zone:
15645.    ------------------------
15646.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15647.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15648.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15649. 
15650. Directory and Files Select:
15651. ---------------------------
15652. !ZoneTypeSelectCurrent!               
15653. ---------------------------
15654. ----------------------------------------------------------
15655. ")
15656. 
15657. # BANNER SET
15658. 
15659. # DATE TIME RUN ELP
15660. 
15661. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
15662. /* Xinclude "..\Display\BannerSet.MyDc"X */
15663. /* pause(1) */
15664. 
15665. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15666. 
15667. Title('!Heading!')
15668. /* pause(1) */
15669. 
15670. /* NOTE: Can't round or truncate to integer precision. */
15671. 
15672. AppendLogfile("!LogFileName!", "!Title!")
15673. 
15674. 
15675. 
15676. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
15677. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
15678. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:55")
15679. 
15680. SetVariable(ZoneListByLine, "!ZoneListByLine!
15681. Zone: !ZoneNoCurrent! 2021-11-09 10:47:55 0:00:07 !ZoneLabel! !ZoneDescription!")
15682. 
15683. 
15684. /* Fixed Zone Position Handling */
15685. /* Literal number: */
15686. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
15687. /* Percentage of disk: */
15688. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
15689. /* Gap */
15690. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
15691. 
15692. /* ---------------------------------------------------------- */
15693. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
15694. # FILE STEP
15695. 
15696. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15697. 
15698. /* add message and move to a new line. */
15699. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15700. ")
15701. 
15702. /* display the line. (hopefully.) */
15703. # Zone Footer Set Statistics Window Text
15704. 
15705. SetStatisticsWindowText("----------------------------------------------------------
15706. Zones Processed: 
15707. ----------------------------------------------------------
15708. !ZoneListByLine!
15709. ----------------------------------------------------------
15710. Zone Processing Step:
15711. !ZoneStepByLine!    
15712. ----------------------------------------------------------
15713. Current Zone:
15714. !ZoneFooter!
15715. ----------------------------------------------------------
15716. Volume Statistics:
15717. !VolumeStatisticsDetail!
15718. ----------------------------------------------------------
15719. Zone Detailed Report:
15720. ----------------------------------------------------------
15721. !ZoneStatisticsDetail!
15722. ----------------------------------------------------------
15723. ")
15724. 
15725. 
15726. 
15727. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15728. 
15729. # BANNER SET
15730. 
15731. # DATE TIME RUN ELP
15732. 
15733. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
15734. /* Xinclude "..\Display\BannerSet.MyDc"X */
15735. /* pause(1) */
15736. 
15737. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15738. 
15739. Title('!Heading!')
15740. /* pause(1) */
15741. 
15742. /* NOTE: Can't round or truncate to integer precision. */
15743. 
15744. pause(1)
15745. 
15746. # your stuff HERE (X)... pre file select code.
15747. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
15748. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15749. 	# (X)
15750. 
15751. FileSelect
15752. 
15753. 	# your stuff can't really go here (errors.)
15754. 	# maybe for some reason I don't know of...
15755. 	
15756. 	# Actions next...
15757. 	# DIR start.
15758. Directory(yes)
15759. # DIR end.
15760. 
15761. 	FileActions
15762. 	  		/* ---------------------------------------------------------- */
15763. 	# Gap
15764. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
15765. 		# FILE STEP
15766. 
15767. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15768. 
15769. /* add message and move to a new line. */
15770. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15771. ")
15772. 
15773. /* display the line. (hopefully.) */
15774. # Zone Footer Set Statistics Window Text
15775. 
15776. SetStatisticsWindowText("----------------------------------------------------------
15777. Zones Processed: 
15778. ----------------------------------------------------------
15779. !ZoneListByLine!
15780. ----------------------------------------------------------
15781. Zone Processing Step:
15782. !ZoneStepByLine!    
15783. ----------------------------------------------------------
15784. Current Zone:
15785. !ZoneFooter!
15786. ----------------------------------------------------------
15787. Volume Statistics:
15788. !VolumeStatisticsDetail!
15789. ----------------------------------------------------------
15790. Zone Detailed Report:
15791. ----------------------------------------------------------
15792. !ZoneStatisticsDetail!
15793. ----------------------------------------------------------
15794. ")
15795. 
15796. 
15797. 
15798. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15799. 
15800. # BANNER SET
15801. 
15802. # DATE TIME RUN ELP
15803. 
15804. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
15805. /* Xinclude "..\Display\BannerSet.MyDc"X */
15806. /* pause(1) */
15807. 
15808. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15809. 
15810. Title('!Heading!')
15811. /* pause(1) */
15812. 
15813. /* NOTE: Can't round or truncate to integer precision. */
15814. 
15815. pause(1)
15816. 	
15817. 	# ACTUAL GAP
15818. 		/* AddGap Variant. */
15819. 	  	# Zone Do Gap
15820. # Gap Calculation Methods:
15821. 
15822. /* 1) Anything you need to add first. */
15823. /* empty */
15824. 
15825. /* ---------------------------------------------------------- */
15826. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
15827. 	# GapRequestedStd.
15828. 
15829. 		/* ---------------------------------------------------------- */
15830. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
15831. 
15832. 		# Gap Calculation Methods:
15833. 
15834. /* AddGap Variants */
15835. 
15836. 	/* Standard */
15837. 		# Gap Calculation Methods:
15838. 	/* AddGap Variants */
15839. 	/* Standard */
15840. 
15841. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
15842. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
15843. 
15844. 	SetVariable(GapRequested, GapRequestedStd)
15845. 	
15846. 
15847. 	/* MFT Low High Method */
15848. 		# Gap Calculation Methods:
15849. 	/* AddGap Variants */
15850. 	/* MFT Low High Method */
15851. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
15852. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
15853. 	SetVariable(GapRequested, GapRequestedMft)
15854. 	
15855. 
15856. 	/* OS Volume Type Method */
15857. 		# Gap Calculation Methods:
15858. 	/* AddGap Variants */
15859. 	/* OS Volume Type Method */
15860. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
15861. 	SetVariable(GapRequested, GapRequestedOs)
15862. 
15863. 
15864. 
15865. /* MakeGap Variants */
15866. 
15867. 	/* Original Os 1-3 + MFT 2 */
15868. 		# Gap Calculation Methods:
15869. 	/* MakeGap Variants */
15870. 	/* Original Os 1-3 + MFT 2 */
15871. 	/* plus MFT gap placed inline at the dividing zone. */
15872. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
15873. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
15874. 	SetVariable(GapRequested, GapRequestedOrig)
15875. 	
15876. 	
15877. /* Note: You could comment out the ones not in use */
15878. /* However having the data in the log is useful. */
15879. /* Therefore the following line is otherwise needed. */
15880. 
15881. /* Standard used */
15882. 
15883. SetVariable(GapRequested, GapRequestedStd)
15884. 
15885. # Gap Calculation Methods:
15886. 
15887. /* AddGap Variants */
15888. 	/* Standard */
15889. 	/* MFT Low High Method */
15890. 	/* OS Volume Type Method */
15891. 
15892. /* MakeGap Variants */
15893. 	/* Original Os 1-3 + MFT 2 */
15894. 
15895. /* Note: You could comment out the ones not in use */
15896. /* However having the data in the log is useful. */
15897. /* Therefore the following line is otherwise needed. */
15898. 
15899. /* Standard is used currently */
15900. 
15901. 
15902. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
15903. 
15904. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
15905. 
15906. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
15907. 
15908. /* ---------------------------------------------------------- */
15909. /* 3) SMALL ZONE ADJUSTMENT. */
15910. /* Gab cant be larger than half the Zone Size. */
15911. 
15912. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
15913. 	
15914. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
15915. 
15916. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
15917. 
15918. /* ---------------------------------------------------------- */
15919. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
15920. # Gap Adjustments.
15921. 
15922. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
15923. 	
15924. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
15925. 
15926. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
15927. 
15928. /* ---------------------------------------------------------- */
15929. # BYPASS THIS.
15930. 	/* This is definitely wrong. */
15931. 	/* The question is can we steal gap from the next zone */
15932. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
15933. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
15934. 		# Zone Overflow.
15935. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
15936. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
15937. 
15938. /* ---------------------------------------------------------- */
15939. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
15940. # Remaining free space available.
15941. 
15942. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
15943. 	
15944. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
15945. 
15946. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
15947. 
15948. /* ---------------------------------------------------------- */
15949. # CURRENT gap to use.
15950. 
15951. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
15952. 
15953. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
15954. 
15955. /* ---------------------------------------------------------- */
15956. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
15957. # Debugging.
15958. 
15959. 	SetVariable(GapUsed, GapCurrent) // for debugging
15960. 
15961. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
15962. 
15963. 		# Your code HERE
15964. 
15965. /* ---------------------------------------------------------- */
15966. /* 7) YOUR CODE. */
15967. # YOUR CODE HERE:
15968. 	# INPUT: GapCurrent or GapCurrentLoc
15969. 	# OUTPUT: GapUsed...
15970. 
15971. /* ---------------------------------------------------------- */
15972. # Gap Size.
15973. # Actual Size of Gap.
15974. 
15975. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
15976. 
15977. /* ---------------------------------------------------------- */
15978. /* xxxxxxxxxxxxxxxxxxxxxx */
15979. # ADD THE GAP
15980. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
15981. /* xxxxxxxxxxxxxxxxxxxxxx */
15982. 
15983. 	
15984. 	# Zone Statistics	
15985. 	# Zone / Volume Statistics and Display
15986. 		
15987. 	# Accumulate Totals
15988.   	# Volume totals
15989. 
15990. /* Current total space used (by Zones and Gaps) */
15991. 
15992. SetVariable(VolumeZoneUsed, GapUsed)
15993. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
15994. /* Percentage */
15995. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
15996. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
15997. 
15998. /* Current total of free space requested */
15999. 
16000. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
16001. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16002. /* Percent. */
16003. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
16004. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16005. 
16006. /* Current total of free space used */
16007. 
16008. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
16009. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
16010. /* Percent */
16011. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
16012. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
16013. 
16014. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
16015. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
16016. /* Xinclude "..\DebugDisplayPause.MyDc"X */
16017. 
16018. 
16019. 	# Current Values
16020. 	# Cluster, Sector, Block adjust for display.
16021. 	# Bytes per cluster is volume specific.
16022. 
16023. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
16024. 
16025. # Current Zone values.
16026. 	# Begin, end and size.
16027. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
16028. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
16029. 
16030. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
16031. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
16032. 
16033. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
16034. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
16035. 
16036. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
16037. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
16038. 
16039. 	SetVariable(ZoneFragments,				"!ZONE210N!")
16040. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
16041. 		
16042. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
16043. /* identical code to here: (separation not needed. TEST.) */	
16044. 
16045. # Current Gap, Actual and Free Values
16046. 	# Gap
16047. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
16048. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
16049. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
16050. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
16051. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
16052. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
16053. 	
16054. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
16055. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
16056. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
16057. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
16058. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
16059. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
16060. 	
16061. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
16062. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
16063. 	
16064. 	# Actual Size and End
16065. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
16066. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
16067. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
16068. 	
16069. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
16070. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
16071. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
16072. 
16073. # Gap Size & Rounding
16074. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
16075. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
16076. 	
16077. 	# Free Space
16078. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
16079. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
16080. 
16081. 	# Footer:
16082. SetVariable(ZoneFooter, "----------------------------------------------------------
16083. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
16084. 
16085. Statistics Report:
16086. ------------------
16087.    Size:  
16088.    ------------------------
16089.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16090.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16091.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16092. 
16093.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16094.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16095. 
16096.    Location:
16097.    ------------------------
16098.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16099.              Files End: !ZoneEndCurrent!
16100.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16101.       
16102.    Gap Settings:
16103.    ------------------------
16104.          Gap Requested: !ZoneGapSizePer!%
16105.       Volume Rounding: !ZoneVolRoundUpPer!%
16106.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16107.                  
16108.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16109.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16110.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16111.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16112.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16113.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16114.      
16115.    Free Space after Zone:
16116.    ------------------------
16117.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16118.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16119.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16120. 
16121. Directory and Files Select:
16122. ---------------------------
16123. !ZoneTypeSelectCurrent!               
16124. ---------------------------
16125. ----------------------------------------------------------
16126. ")
16127. 	# Zone Footer Set Statistics Window Text
16128. 
16129. SetStatisticsWindowText("----------------------------------------------------------
16130. Zones Processed: 
16131. ----------------------------------------------------------
16132. !ZoneListByLine!
16133. ----------------------------------------------------------
16134. Zone Processing Step:
16135. !ZoneStepByLine!    
16136. ----------------------------------------------------------
16137. Current Zone:
16138. !ZoneFooter!
16139. ----------------------------------------------------------
16140. Volume Statistics:
16141. !VolumeStatisticsDetail!
16142. ----------------------------------------------------------
16143. Zone Detailed Report:
16144. ----------------------------------------------------------
16145. !ZoneStatisticsDetail!
16146. ----------------------------------------------------------
16147. ")
16148. 
16149. 
16150. 	
16151.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
16152. 
16153. 	# Add Zone to list of zones for display.
16154. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
16155. 	# ??? Free Stats?
16156. 	# Footer:
16157. SetVariable(ZoneFooter, "----------------------------------------------------------
16158. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
16159. 
16160. Statistics Report:
16161. ------------------
16162.    Size:  
16163.    ------------------------
16164.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16165.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16166.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16167. 
16168.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16169.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16170. 
16171.    Location:
16172.    ------------------------
16173.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16174.              Files End: !ZoneEndCurrent!
16175.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16176.       
16177.    Gap Settings:
16178.    ------------------------
16179.          Gap Requested: !ZoneGapSizePer!%
16180.       Volume Rounding: !ZoneVolRoundUpPer!%
16181.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16182.                  
16183.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16184.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16185.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16186.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16187.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16188.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16189.      
16190.    Free Space after Zone:
16191.    ------------------------
16192.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16193.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16194.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16195. 
16196. Directory and Files Select:
16197. ---------------------------
16198. !ZoneTypeSelectCurrent!               
16199. ---------------------------
16200. ----------------------------------------------------------
16201. ")
16202. 
16203. 	# Add Zone Details to Report.	
16204. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
16205. !ZoneFooter!")
16206. 
16207. 
16208. 	
16209. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
16210. 		# FILE STEP
16211. 
16212. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16213. 
16214. /* add message and move to a new line. */
16215. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16216. ")
16217. 
16218. /* display the line. (hopefully.) */
16219. # Zone Footer Set Statistics Window Text
16220. 
16221. SetStatisticsWindowText("----------------------------------------------------------
16222. Zones Processed: 
16223. ----------------------------------------------------------
16224. !ZoneListByLine!
16225. ----------------------------------------------------------
16226. Zone Processing Step:
16227. !ZoneStepByLine!    
16228. ----------------------------------------------------------
16229. Current Zone:
16230. !ZoneFooter!
16231. ----------------------------------------------------------
16232. Volume Statistics:
16233. !VolumeStatisticsDetail!
16234. ----------------------------------------------------------
16235. Zone Detailed Report:
16236. ----------------------------------------------------------
16237. !ZoneStatisticsDetail!
16238. ----------------------------------------------------------
16239. ")
16240. 
16241. 
16242. 
16243. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16244. 
16245. # BANNER SET
16246. 
16247. # DATE TIME RUN ELP
16248. 
16249. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
16250. /* Xinclude "..\Display\BannerSet.MyDc"X */
16251. /* pause(1) */
16252. 
16253. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16254. 
16255. Title('!Heading!')
16256. /* pause(1) */
16257. 
16258. /* NOTE: Can't round or truncate to integer precision. */
16259. 
16260. pause(1)
16261. 	
16262. 		!include "..\ActionVerbs\ZoneDoActionOsTypeDir.MyDc"!
16263. 
16264. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
16265. 		# FILE STEP
16266. 
16267. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16268. 
16269. /* add message and move to a new line. */
16270. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16271. ")
16272. 
16273. /* display the line. (hopefully.) */
16274. # Zone Footer Set Statistics Window Text
16275. 
16276. SetStatisticsWindowText("----------------------------------------------------------
16277. Zones Processed: 
16278. ----------------------------------------------------------
16279. !ZoneListByLine!
16280. ----------------------------------------------------------
16281. Zone Processing Step:
16282. !ZoneStepByLine!    
16283. ----------------------------------------------------------
16284. Current Zone:
16285. !ZoneFooter!
16286. ----------------------------------------------------------
16287. Volume Statistics:
16288. !VolumeStatisticsDetail!
16289. ----------------------------------------------------------
16290. Zone Detailed Report:
16291. ----------------------------------------------------------
16292. !ZoneStatisticsDetail!
16293. ----------------------------------------------------------
16294. ")
16295. 
16296. 
16297. 
16298. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16299. 
16300. # BANNER SET
16301. 
16302. # DATE TIME RUN ELP
16303. 
16304. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
16305. /* Xinclude "..\Display\BannerSet.MyDc"X */
16306. /* pause(1) */
16307. 
16308. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16309. 
16310. Title('!Heading!')
16311. /* pause(1) */
16312. 
16313. /* NOTE: Can't round or truncate to integer precision. */
16314. 
16315. pause(1)
16316. 	# Zone Do Footer
16317. 
16318. /* ---------------------------------------------------------- */
16319. # File Select
16320. 	# Select Statments
16321. # File Actions 
16322. 	# Standard or OS File Actions.
16323. 	# Resume...
16324. 	
16325. 	# your stuff HERE (X)... post zone (file) file actions code.
16326. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
16327. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16328. 		# (X)
16329. 		
16330. 		/* ??? Set window? */
16331. 	
16332. 	# ADD THE GAP
16333. 		
16334. # Vacate (good for diagnostics)
16335. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
16336. 
16337. # DoNotVacate - DO NOT Vacate (recommended)
16338. 
16339. # Vacate
16340. /* AddGap(GapUsedLoc) */
16341. 
16342. # DO Not Vacate
16343. AddGap(GapUsedLoc, DoNotVacate) 
16344. 	
16345. 	
16346. /* ---------------------------------------------------------- */
16347. # (failed) TEST for boolean logic.
16348. 
16349. /* It should work in the gap calculations for turning options */
16350. /* on and off but it will NOT work here. */
16351. 
16352. /* Boolean setting X or FlagX. */
16353. /* Where X will be on or off: */
16354. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
16355. /*      For ON:  (X  *  FlagAny) */
16356. 
16357. /* 1) Failed, zero gap overrode the previous one. */
16358. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
16359. /* AddGap(GapUsedTemp) */ 
16360. 
16361. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
16362. /* AddGap(GapUsedTemp, DoNotVacate) */ 
16363. 
16364. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
16365. 
16366. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
16367. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
16368. /* AddGap(GapUsedTemp) */ 
16369. 
16370. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
16371. /* AddGap(GapUsedTemp, DoNotVacate) */ 
16372. 
16373. /* ---------------------------------------------------------- */
16374. 
16375. # Vacate
16376. /* AddGap(GapUsed) */
16377. 
16378. # DO NOT Vacate (recommended)
16379. /* AddGap(GapUsed, DoNotVacate) */ 
16380. 	
16381. 
16382. 		
16383. # 
16384. FileEnd
16385. /* ---------------------------------------------------------- */
16386. 
16387. # your stuff HERE (X)... post zone (file) code.
16388. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
16389. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16390. 	# (X)
16391. 
16392. SetVariable(FileStepDescription,"Zone finished, reporting.")
16393. # FILE STEP
16394. 
16395. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16396. 
16397. /* add message and move to a new line. */
16398. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16399. ")
16400. 
16401. /* display the line. (hopefully.) */
16402. # Zone Footer Set Statistics Window Text
16403. 
16404. SetStatisticsWindowText("----------------------------------------------------------
16405. Zones Processed: 
16406. ----------------------------------------------------------
16407. !ZoneListByLine!
16408. ----------------------------------------------------------
16409. Zone Processing Step:
16410. !ZoneStepByLine!    
16411. ----------------------------------------------------------
16412. Current Zone:
16413. !ZoneFooter!
16414. ----------------------------------------------------------
16415. Volume Statistics:
16416. !VolumeStatisticsDetail!
16417. ----------------------------------------------------------
16418. Zone Detailed Report:
16419. ----------------------------------------------------------
16420. !ZoneStatisticsDetail!
16421. ----------------------------------------------------------
16422. ")
16423. 
16424. 
16425. 
16426. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16427. 
16428. # BANNER SET
16429. 
16430. # DATE TIME RUN ELP
16431. 
16432. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
16433. /* Xinclude "..\Display\BannerSet.MyDc"X */
16434. /* pause(1) */
16435. 
16436. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16437. 
16438. Title('!Heading!')
16439. /* pause(1) */
16440. 
16441. /* NOTE: Can't round or truncate to integer precision. */
16442. 
16443. pause(1)
16444. 
16445. # Zone When Finished
16446. 
16447. # BANNER SET
16448. 
16449. # DATE TIME RUN ELP
16450. 
16451. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
16452. /* Xinclude "..\Display\BannerSet.MyDc"X */
16453. /* pause(1) */
16454. 
16455. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16456. 
16457. Title('!Heading!')
16458. /* pause(1) */
16459. 
16460. /* NOTE: Can't round or truncate to integer precision. */
16461. 
16462. AppendLogfile("!LogFileName!", "!Title!")
16463. 
16464. 
16465. 
16466. # Zone Statistics	
16467. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
16468. 
16469. # Footer:
16470. SetVariable(ZoneFooter, "----------------------------------------------------------
16471. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
16472. 
16473. Statistics Report:
16474. ------------------
16475.    Size:  
16476.    ------------------------
16477.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16478.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16479.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16480. 
16481.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16482.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16483. 
16484.    Location:
16485.    ------------------------
16486.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16487.              Files End: !ZoneEndCurrent!
16488.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16489.       
16490.    Gap Settings:
16491.    ------------------------
16492.          Gap Requested: !ZoneGapSizePer!%
16493.       Volume Rounding: !ZoneVolRoundUpPer!%
16494.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16495.                  
16496.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16497.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16498.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16499.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16500.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16501.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16502.      
16503.    Free Space after Zone:
16504.    ------------------------
16505.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16506.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16507.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16508. 
16509. Directory and Files Select:
16510. ---------------------------
16511. !ZoneTypeSelectCurrent!               
16512. ---------------------------
16513. ----------------------------------------------------------
16514. ")
16515. 
16516. AppendLogfile("!LogFileName!", ".")
16517. AppendLogfile("!LogFileName!", "!ZoneFooter!")
16518. AppendLogfile("!LogFileName!", ".")
16519. 
16520. # Zone Footer Set Statistics Window Text
16521. 
16522. SetStatisticsWindowText("----------------------------------------------------------
16523. Zones Processed: 
16524. ----------------------------------------------------------
16525. !ZoneListByLine!
16526. ----------------------------------------------------------
16527. Zone Processing Step:
16528. !ZoneStepByLine!    
16529. ----------------------------------------------------------
16530. Current Zone:
16531. !ZoneFooter!
16532. ----------------------------------------------------------
16533. Volume Statistics:
16534. !VolumeStatisticsDetail!
16535. ----------------------------------------------------------
16536. Zone Detailed Report:
16537. ----------------------------------------------------------
16538. !ZoneStatisticsDetail!
16539. ----------------------------------------------------------
16540. ")
16541. 
16542. 
16543. 
16544. /* pause() */
16545. /* pause() */
16546. 
16547. 
16548. 
16549. 
16550. /* Mft Method: MFT GAP HERE. */
16551. /* For fixed zone locations */
16552. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-11-09 10:47:55")
16553. /* MakeGap(MftGap, DoNotVacate) */
16554. /* ---------------------------------------------------------- */
16555. 
16556. 
16557. /* ---------------------------------------------------------- */
16558. /* Mft Method: MFT GAP HERE. */
16559. /* For fixed zone locations */
16560. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-11-09 10:47:55")
16561. /* MakeGap(MftGap, DoNotVacate) */
16562.   
16563. /* ---------------------------------------------------------- */
16564. # PageHiberDump
16565. 
16566. # You cannot move Pagefile or Hiberfil generally speaking.
16567. # This might work in safe mode with preparation.
16568. # Zone PageHiberDump.
16569. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
16570. 
16571. /* ---------------------------------------------------------- */
16572. # PageHiberDump
16573. # You cannot move Pagefile or Hiberfil generally speaking.
16574. # This might work in safe mode with preparation.
16575. # Zone PageHiberDump.
16576. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
16577. 
16578. 	SetVariable(ZoneLabel, 			"!ZoneLabelPageHiberDump!")
16579. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPageHiberDump!")
16580. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPageHiberDump!")
16581. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePageHiberDump!")
16582. 	SetVariable(ZoneTypeSelect,'# PageHiberDump start.
16583. (
16584. # Os PageHiberDump start.
16585. (
16586.   FileName("DataStore.edb")
16587.   or FileName("DUMP*.*")
16588.   or FileName("Hiberfil.sys")
16589.   or FileName("MEMORY.DMP")
16590.   or FileName("Pagefile.sys")
16591. )
16592. # Os PageHiberDump end.
16593. 
16594. )
16595. # PageHiberDump end.
16596. ')
16597. 
16598. 		# Zone Do Header
16599. 
16600. # Zone When Started
16601. 
16602. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
16603. # Display Set Zone
16604. 
16605. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
16606. SetVariable(FileStepDescription,	"")
16607. 
16608. SetVariable(ZoneStepByLine, 			"Zone started.
16609. ")
16610. 
16611. # BANNER SET
16612. 
16613. # DATE TIME RUN ELP
16614. 
16615. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
16616. /* Xinclude "..\Display\BannerSet.MyDc"X */
16617. /* pause(1) */
16618. 
16619. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16620. 
16621. Title('!Heading!')
16622. /* pause(1) */
16623. 
16624. /* NOTE: Can't round or truncate to integer precision. */
16625. 
16626. AppendLogfile("!LogFileName!", "!Title!")
16627. 
16628. 
16629. 
16630. pause(1)
16631. 
16632. 
16633. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
16634. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
16635. 
16636. SetVariable(ZoneStepNoCurrent, 0)
16637. 
16638. 
16639. # Zone Do Current Clear
16640. 
16641. SetVariable(ZoneTypeSelectCurrent, 		"")
16642. 
16643. SetVariable(ZoneBeginCurrent, 			0)
16644. SetVariable(ZoneBeginPerCurrent, 		0)
16645. SetVariable(ZoneEndCurrent, 			0)
16646. SetVariable(ZoneEndPerCurrent, 			0)
16647. 
16648. SetVariable(ZoneSizeCurrent,			0)
16649. SetVariable(ZoneSizePerCurrent,			0)
16650. 
16651. SetVariable(ZoneGapRequestedCurrent,	0)
16652. SetVariable(ZoneGapRoundedCurrent, 		0)
16653. SetVariable(ZoneGapAdjustedCurrent, 	0)
16654. SetVariable(ZoneGapAvailableCurrent, 	0)
16655. SetVariable(ZoneGapCurrent,				0)
16656. SetVariable(ZoneGapUsedCurrent, 		0)
16657. 
16658. SetVariable(ZoneGapActualCurrent, 		0)
16659. SetVariable(ZoneGapActualPerCurrent, 	0)
16660. 
16661. SetVariable(ZoneSizeActual, 			0)
16662. SetVariable(ZoneSizeActualCurrent,		0)
16663. 
16664. SetVariable(ZoneEndActual, 				0)
16665. SetVariable(ZoneEndActualCurrent,		0)			
16666. SetVariable(ZoneSizeActualPerCurrent, 	0)
16667.       
16668. SetVariable(ZoneFilesFolders,			0)
16669. SetVariable(ZoneFilesFoldersPer,		0) 
16670. 
16671. SetVariable(ZoneFragments,				0)
16672. SetVariable(ZoneFragmentsPer,			0) 
16673. 		
16674. SetVariable(ZoneEndActualCurrent, 		0)
16675. SetVariable(ZoneEndActualPerCurrent, 	0)
16676. 
16677. # Gap Calculation Methodology:
16678. 	# Requested
16679. 	SetVariable(GapRequested, 			0) 
16680. 	SetVariable(GapRequestedStd, 		0) 
16681. 	SetVariable(GapRequestedMft, 		0) 
16682. 	SetVariable(GapRequestedOs, 		0) 
16683. 	SetVariable(GapRequestedOriginal, 	0) 
16684. 	
16685. 	# Gap Adjustments
16686. 	SetVariable(GapRounded, 			0)
16687. 	# SetVariable(GapAdjusted, 			0)
16688. 	SetVariable(GapAvailable, 			0)
16689. 	SetVariable(GapCurrent, 			0)
16690. 	SetVariable(GapActual, 				0)
16691. 	SetVariable(GapUsed, 				0)
16692. 	
16693. 	# Gap Adjustments
16694. 	SetVariable(GapRoundedLoc, 			0)
16695. 	# SetVariable(GapAdjustedLoc, 		0)
16696. 	SetVariable(GapAvailableLoc, 		0)
16697. 	SetVariable(GapCurrentLoc, 			0)
16698. 	SetVariable(GapActualLoc,			0)
16699. 	SetVariable(GapUsedLoc,				0)
16700. 	
16701. 	# Space usage
16702. 	SetVariable(ZoneFreePerRequested, 	0)
16703. 	SetVariable(ZoneFreePerUsed, 		0)
16704. 
16705. # Gap Size & Rounding
16706. 	SetVariable(ZoneGapSizePer, 		0)
16707. 	SetVariable(ZoneVolRoundUpPer, 		0)
16708. 	
16709. 	# Free Space
16710. 	SetVariable(ZoneFreeUsedPer, 		0)
16711. 	SetVariable(ZoneFreeRequestedPer, 	0)
16712. 
16713. 
16714. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
16715. 
16716. # Footer:
16717. SetVariable(ZoneFooter, "----------------------------------------------------------
16718. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
16719. 
16720. Statistics Report:
16721. ------------------
16722.    Size:  
16723.    ------------------------
16724.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16725.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16726.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16727. 
16728.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16729.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16730. 
16731.    Location:
16732.    ------------------------
16733.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16734.              Files End: !ZoneEndCurrent!
16735.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16736.       
16737.    Gap Settings:
16738.    ------------------------
16739.          Gap Requested: !ZoneGapSizePer!%
16740.       Volume Rounding: !ZoneVolRoundUpPer!%
16741.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16742.                  
16743.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16744.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16745.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16746.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16747.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16748.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16749.      
16750.    Free Space after Zone:
16751.    ------------------------
16752.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16753.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16754.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16755. 
16756. Directory and Files Select:
16757. ---------------------------
16758. !ZoneTypeSelectCurrent!               
16759. ---------------------------
16760. ----------------------------------------------------------
16761. ")
16762. 
16763. # BANNER SET
16764. 
16765. # DATE TIME RUN ELP
16766. 
16767. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
16768. /* Xinclude "..\Display\BannerSet.MyDc"X */
16769. /* pause(1) */
16770. 
16771. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16772. 
16773. Title('!Heading!')
16774. /* pause(1) */
16775. 
16776. /* NOTE: Can't round or truncate to integer precision. */
16777. 
16778. AppendLogfile("!LogFileName!", "!Title!")
16779. 
16780. 
16781. 
16782. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
16783. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
16784. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:55")
16785. 
16786. SetVariable(ZoneListByLine, "!ZoneListByLine!
16787. Zone: !ZoneNoCurrent! 2021-11-09 10:47:55 0:00:07 !ZoneLabel! !ZoneDescription!")
16788. 
16789. 
16790. /* Fixed Zone Position Handling */
16791. /* Literal number: */
16792. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
16793. /* Percentage of disk: */
16794. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
16795. /* Gap */
16796. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
16797. 
16798. /* ---------------------------------------------------------- */
16799. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
16800. # FILE STEP
16801. 
16802. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16803. 
16804. /* add message and move to a new line. */
16805. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16806. ")
16807. 
16808. /* display the line. (hopefully.) */
16809. # Zone Footer Set Statistics Window Text
16810. 
16811. SetStatisticsWindowText("----------------------------------------------------------
16812. Zones Processed: 
16813. ----------------------------------------------------------
16814. !ZoneListByLine!
16815. ----------------------------------------------------------
16816. Zone Processing Step:
16817. !ZoneStepByLine!    
16818. ----------------------------------------------------------
16819. Current Zone:
16820. !ZoneFooter!
16821. ----------------------------------------------------------
16822. Volume Statistics:
16823. !VolumeStatisticsDetail!
16824. ----------------------------------------------------------
16825. Zone Detailed Report:
16826. ----------------------------------------------------------
16827. !ZoneStatisticsDetail!
16828. ----------------------------------------------------------
16829. ")
16830. 
16831. 
16832. 
16833. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16834. 
16835. # BANNER SET
16836. 
16837. # DATE TIME RUN ELP
16838. 
16839. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
16840. /* Xinclude "..\Display\BannerSet.MyDc"X */
16841. /* pause(1) */
16842. 
16843. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16844. 
16845. Title('!Heading!')
16846. /* pause(1) */
16847. 
16848. /* NOTE: Can't round or truncate to integer precision. */
16849. 
16850. pause(1)
16851. 
16852. # your stuff HERE (X)... pre file select code.
16853. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
16854. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16855. 	# (X)
16856. 
16857. FileSelect
16858. 
16859. 	# your stuff can't really go here (errors.)
16860. 	# maybe for some reason I don't know of...
16861. 	
16862. 	# Actions next...
16863. 		# PageHiberDump start.
16864. (
16865. # Os PageHiberDump start.
16866. (
16867.   FileName("DataStore.edb")
16868.   or FileName("DUMP*.*")
16869.   or FileName("Hiberfil.sys")
16870.   or FileName("MEMORY.DMP")
16871.   or FileName("Pagefile.sys")
16872. )
16873. # Os PageHiberDump end.
16874. 
16875. )
16876. # PageHiberDump end.
16877. 
16878. 		FileActions
16879. 		  		/* ---------------------------------------------------------- */
16880. 	# Gap
16881. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
16882. 		# FILE STEP
16883. 
16884. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16885. 
16886. /* add message and move to a new line. */
16887. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16888. ")
16889. 
16890. /* display the line. (hopefully.) */
16891. # Zone Footer Set Statistics Window Text
16892. 
16893. SetStatisticsWindowText("----------------------------------------------------------
16894. Zones Processed: 
16895. ----------------------------------------------------------
16896. !ZoneListByLine!
16897. ----------------------------------------------------------
16898. Zone Processing Step:
16899. !ZoneStepByLine!    
16900. ----------------------------------------------------------
16901. Current Zone:
16902. !ZoneFooter!
16903. ----------------------------------------------------------
16904. Volume Statistics:
16905. !VolumeStatisticsDetail!
16906. ----------------------------------------------------------
16907. Zone Detailed Report:
16908. ----------------------------------------------------------
16909. !ZoneStatisticsDetail!
16910. ----------------------------------------------------------
16911. ")
16912. 
16913. 
16914. 
16915. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16916. 
16917. # BANNER SET
16918. 
16919. # DATE TIME RUN ELP
16920. 
16921. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
16922. /* Xinclude "..\Display\BannerSet.MyDc"X */
16923. /* pause(1) */
16924. 
16925. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16926. 
16927. Title('!Heading!')
16928. /* pause(1) */
16929. 
16930. /* NOTE: Can't round or truncate to integer precision. */
16931. 
16932. pause(1)
16933. 	
16934. 	# ACTUAL GAP
16935. 		/* AddGap Variant. */
16936. 	  	# Zone Do Gap
16937. # Gap Calculation Methods:
16938. 
16939. /* 1) Anything you need to add first. */
16940. /* empty */
16941. 
16942. /* ---------------------------------------------------------- */
16943. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
16944. 	# GapRequestedStd.
16945. 
16946. 		/* ---------------------------------------------------------- */
16947. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
16948. 
16949. 		# Gap Calculation Methods:
16950. 
16951. /* AddGap Variants */
16952. 
16953. 	/* Standard */
16954. 		# Gap Calculation Methods:
16955. 	/* AddGap Variants */
16956. 	/* Standard */
16957. 
16958. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
16959. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
16960. 
16961. 	SetVariable(GapRequested, GapRequestedStd)
16962. 	
16963. 
16964. 	/* MFT Low High Method */
16965. 		# Gap Calculation Methods:
16966. 	/* AddGap Variants */
16967. 	/* MFT Low High Method */
16968. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
16969. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
16970. 	SetVariable(GapRequested, GapRequestedMft)
16971. 	
16972. 
16973. 	/* OS Volume Type Method */
16974. 		# Gap Calculation Methods:
16975. 	/* AddGap Variants */
16976. 	/* OS Volume Type Method */
16977. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
16978. 	SetVariable(GapRequested, GapRequestedOs)
16979. 
16980. 
16981. 
16982. /* MakeGap Variants */
16983. 
16984. 	/* Original Os 1-3 + MFT 2 */
16985. 		# Gap Calculation Methods:
16986. 	/* MakeGap Variants */
16987. 	/* Original Os 1-3 + MFT 2 */
16988. 	/* plus MFT gap placed inline at the dividing zone. */
16989. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
16990. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
16991. 	SetVariable(GapRequested, GapRequestedOrig)
16992. 	
16993. 	
16994. /* Note: You could comment out the ones not in use */
16995. /* However having the data in the log is useful. */
16996. /* Therefore the following line is otherwise needed. */
16997. 
16998. /* Standard used */
16999. 
17000. SetVariable(GapRequested, GapRequestedStd)
17001. 
17002. # Gap Calculation Methods:
17003. 
17004. /* AddGap Variants */
17005. 	/* Standard */
17006. 	/* MFT Low High Method */
17007. 	/* OS Volume Type Method */
17008. 
17009. /* MakeGap Variants */
17010. 	/* Original Os 1-3 + MFT 2 */
17011. 
17012. /* Note: You could comment out the ones not in use */
17013. /* However having the data in the log is useful. */
17014. /* Therefore the following line is otherwise needed. */
17015. 
17016. /* Standard is used currently */
17017. 
17018. 
17019. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
17020. 
17021. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
17022. 
17023. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
17024. 
17025. /* ---------------------------------------------------------- */
17026. /* 3) SMALL ZONE ADJUSTMENT. */
17027. /* Gab cant be larger than half the Zone Size. */
17028. 
17029. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
17030. 	
17031. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
17032. 
17033. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
17034. 
17035. /* ---------------------------------------------------------- */
17036. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
17037. # Gap Adjustments.
17038. 
17039. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
17040. 	
17041. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
17042. 
17043. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
17044. 
17045. /* ---------------------------------------------------------- */
17046. # BYPASS THIS.
17047. 	/* This is definitely wrong. */
17048. 	/* The question is can we steal gap from the next zone */
17049. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
17050. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
17051. 		# Zone Overflow.
17052. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
17053. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
17054. 
17055. /* ---------------------------------------------------------- */
17056. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
17057. # Remaining free space available.
17058. 
17059. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
17060. 	
17061. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
17062. 
17063. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
17064. 
17065. /* ---------------------------------------------------------- */
17066. # CURRENT gap to use.
17067. 
17068. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
17069. 
17070. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
17071. 
17072. /* ---------------------------------------------------------- */
17073. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
17074. # Debugging.
17075. 
17076. 	SetVariable(GapUsed, GapCurrent) // for debugging
17077. 
17078. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
17079. 
17080. 		# Your code HERE
17081. 
17082. /* ---------------------------------------------------------- */
17083. /* 7) YOUR CODE. */
17084. # YOUR CODE HERE:
17085. 	# INPUT: GapCurrent or GapCurrentLoc
17086. 	# OUTPUT: GapUsed...
17087. 
17088. /* ---------------------------------------------------------- */
17089. # Gap Size.
17090. # Actual Size of Gap.
17091. 
17092. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
17093. 
17094. /* ---------------------------------------------------------- */
17095. /* xxxxxxxxxxxxxxxxxxxxxx */
17096. # ADD THE GAP
17097. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
17098. /* xxxxxxxxxxxxxxxxxxxxxx */
17099. 
17100. 	
17101. 	# Zone Statistics	
17102. 	# Zone / Volume Statistics and Display
17103. 		
17104. 	# Accumulate Totals
17105.   	# Volume totals
17106. 
17107. /* Current total space used (by Zones and Gaps) */
17108. 
17109. SetVariable(VolumeZoneUsed, GapUsed)
17110. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
17111. /* Percentage */
17112. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
17113. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
17114. 
17115. /* Current total of free space requested */
17116. 
17117. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
17118. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17119. /* Percent. */
17120. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
17121. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17122. 
17123. /* Current total of free space used */
17124. 
17125. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
17126. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
17127. /* Percent */
17128. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
17129. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
17130. 
17131. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
17132. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
17133. /* Xinclude "..\DebugDisplayPause.MyDc"X */
17134. 
17135. 
17136. 	# Current Values
17137. 	# Cluster, Sector, Block adjust for display.
17138. 	# Bytes per cluster is volume specific.
17139. 
17140. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
17141. 
17142. # Current Zone values.
17143. 	# Begin, end and size.
17144. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
17145. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
17146. 
17147. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
17148. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
17149. 
17150. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
17151. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
17152. 
17153. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
17154. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
17155. 
17156. 	SetVariable(ZoneFragments,				"!ZONE210N!")
17157. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
17158. 		
17159. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
17160. /* identical code to here: (separation not needed. TEST.) */	
17161. 
17162. # Current Gap, Actual and Free Values
17163. 	# Gap
17164. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
17165. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
17166. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
17167. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
17168. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
17169. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
17170. 	
17171. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
17172. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
17173. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
17174. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
17175. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
17176. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
17177. 	
17178. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
17179. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
17180. 	
17181. 	# Actual Size and End
17182. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
17183. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
17184. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
17185. 	
17186. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
17187. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
17188. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
17189. 
17190. # Gap Size & Rounding
17191. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
17192. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
17193. 	
17194. 	# Free Space
17195. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
17196. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
17197. 
17198. 	# Footer:
17199. SetVariable(ZoneFooter, "----------------------------------------------------------
17200. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
17201. 
17202. Statistics Report:
17203. ------------------
17204.    Size:  
17205.    ------------------------
17206.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17207.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17208.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17209. 
17210.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17211.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17212. 
17213.    Location:
17214.    ------------------------
17215.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17216.              Files End: !ZoneEndCurrent!
17217.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17218.       
17219.    Gap Settings:
17220.    ------------------------
17221.          Gap Requested: !ZoneGapSizePer!%
17222.       Volume Rounding: !ZoneVolRoundUpPer!%
17223.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17224.                  
17225.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17226.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17227.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17228.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17229.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17230.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17231.      
17232.    Free Space after Zone:
17233.    ------------------------
17234.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17235.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17236.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17237. 
17238. Directory and Files Select:
17239. ---------------------------
17240. !ZoneTypeSelectCurrent!               
17241. ---------------------------
17242. ----------------------------------------------------------
17243. ")
17244. 	# Zone Footer Set Statistics Window Text
17245. 
17246. SetStatisticsWindowText("----------------------------------------------------------
17247. Zones Processed: 
17248. ----------------------------------------------------------
17249. !ZoneListByLine!
17250. ----------------------------------------------------------
17251. Zone Processing Step:
17252. !ZoneStepByLine!    
17253. ----------------------------------------------------------
17254. Current Zone:
17255. !ZoneFooter!
17256. ----------------------------------------------------------
17257. Volume Statistics:
17258. !VolumeStatisticsDetail!
17259. ----------------------------------------------------------
17260. Zone Detailed Report:
17261. ----------------------------------------------------------
17262. !ZoneStatisticsDetail!
17263. ----------------------------------------------------------
17264. ")
17265. 
17266. 
17267. 	
17268.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
17269. 
17270. 	# Add Zone to list of zones for display.
17271. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
17272. 	# ??? Free Stats?
17273. 	# Footer:
17274. SetVariable(ZoneFooter, "----------------------------------------------------------
17275. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
17276. 
17277. Statistics Report:
17278. ------------------
17279.    Size:  
17280.    ------------------------
17281.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17282.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17283.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17284. 
17285.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17286.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17287. 
17288.    Location:
17289.    ------------------------
17290.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17291.              Files End: !ZoneEndCurrent!
17292.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17293.       
17294.    Gap Settings:
17295.    ------------------------
17296.          Gap Requested: !ZoneGapSizePer!%
17297.       Volume Rounding: !ZoneVolRoundUpPer!%
17298.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17299.                  
17300.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17301.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17302.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17303.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17304.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17305.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17306.      
17307.    Free Space after Zone:
17308.    ------------------------
17309.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17310.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17311.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17312. 
17313. Directory and Files Select:
17314. ---------------------------
17315. !ZoneTypeSelectCurrent!               
17316. ---------------------------
17317. ----------------------------------------------------------
17318. ")
17319. 
17320. 	# Add Zone Details to Report.	
17321. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
17322. !ZoneFooter!")
17323. 
17324. 
17325. 	
17326. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
17327. 			# FILE STEP
17328. 
17329. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17330. 
17331. /* add message and move to a new line. */
17332. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17333. ")
17334. 
17335. /* display the line. (hopefully.) */
17336. # Zone Footer Set Statistics Window Text
17337. 
17338. SetStatisticsWindowText("----------------------------------------------------------
17339. Zones Processed: 
17340. ----------------------------------------------------------
17341. !ZoneListByLine!
17342. ----------------------------------------------------------
17343. Zone Processing Step:
17344. !ZoneStepByLine!    
17345. ----------------------------------------------------------
17346. Current Zone:
17347. !ZoneFooter!
17348. ----------------------------------------------------------
17349. Volume Statistics:
17350. !VolumeStatisticsDetail!
17351. ----------------------------------------------------------
17352. Zone Detailed Report:
17353. ----------------------------------------------------------
17354. !ZoneStatisticsDetail!
17355. ----------------------------------------------------------
17356. ")
17357. 
17358. 
17359. 
17360. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17361. 
17362. # BANNER SET
17363. 
17364. # DATE TIME RUN ELP
17365. 
17366. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
17367. /* Xinclude "..\Display\BannerSet.MyDc"X */
17368. /* pause(1) */
17369. 
17370. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17371. 
17372. Title('!Heading!')
17373. /* pause(1) */
17374. 
17375. /* NOTE: Can't round or truncate to integer precision. */
17376. 
17377. pause(1)
17378. 
17379. 			/* "..\ActionVerbs\ZoneDoActionThis.MyDc" */
17380. 			# File Action - SortByImportSequence with SkipBlock.
17381. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
17382. 	
17383. 
17384. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
17385. 		# FILE STEP
17386. 
17387. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17388. 
17389. /* add message and move to a new line. */
17390. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17391. ")
17392. 
17393. /* display the line. (hopefully.) */
17394. # Zone Footer Set Statistics Window Text
17395. 
17396. SetStatisticsWindowText("----------------------------------------------------------
17397. Zones Processed: 
17398. ----------------------------------------------------------
17399. !ZoneListByLine!
17400. ----------------------------------------------------------
17401. Zone Processing Step:
17402. !ZoneStepByLine!    
17403. ----------------------------------------------------------
17404. Current Zone:
17405. !ZoneFooter!
17406. ----------------------------------------------------------
17407. Volume Statistics:
17408. !VolumeStatisticsDetail!
17409. ----------------------------------------------------------
17410. Zone Detailed Report:
17411. ----------------------------------------------------------
17412. !ZoneStatisticsDetail!
17413. ----------------------------------------------------------
17414. ")
17415. 
17416. 
17417. 
17418. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17419. 
17420. # BANNER SET
17421. 
17422. # DATE TIME RUN ELP
17423. 
17424. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
17425. /* Xinclude "..\Display\BannerSet.MyDc"X */
17426. /* pause(1) */
17427. 
17428. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17429. 
17430. Title('!Heading!')
17431. /* pause(1) */
17432. 
17433. /* NOTE: Can't round or truncate to integer precision. */
17434. 
17435. pause(1)
17436. 
17437. 		# Zone Do Footer
17438. 
17439. /* ---------------------------------------------------------- */
17440. # File Select
17441. 	# Select Statments
17442. # File Actions 
17443. 	# Standard or OS File Actions.
17444. 	# Resume...
17445. 	
17446. 	# your stuff HERE (X)... post zone (file) file actions code.
17447. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
17448. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17449. 		# (X)
17450. 		
17451. 		/* ??? Set window? */
17452. 	
17453. 	# ADD THE GAP
17454. 		
17455. # Vacate (good for diagnostics)
17456. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
17457. 
17458. # DoNotVacate - DO NOT Vacate (recommended)
17459. 
17460. # Vacate
17461. /* AddGap(GapUsedLoc) */
17462. 
17463. # DO Not Vacate
17464. AddGap(GapUsedLoc, DoNotVacate) 
17465. 	
17466. 	
17467. /* ---------------------------------------------------------- */
17468. # (failed) TEST for boolean logic.
17469. 
17470. /* It should work in the gap calculations for turning options */
17471. /* on and off but it will NOT work here. */
17472. 
17473. /* Boolean setting X or FlagX. */
17474. /* Where X will be on or off: */
17475. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
17476. /*      For ON:  (X  *  FlagAny) */
17477. 
17478. /* 1) Failed, zero gap overrode the previous one. */
17479. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
17480. /* AddGap(GapUsedTemp) */ 
17481. 
17482. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
17483. /* AddGap(GapUsedTemp, DoNotVacate) */ 
17484. 
17485. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
17486. 
17487. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
17488. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
17489. /* AddGap(GapUsedTemp) */ 
17490. 
17491. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
17492. /* AddGap(GapUsedTemp, DoNotVacate) */ 
17493. 
17494. /* ---------------------------------------------------------- */
17495. 
17496. # Vacate
17497. /* AddGap(GapUsed) */
17498. 
17499. # DO NOT Vacate (recommended)
17500. /* AddGap(GapUsed, DoNotVacate) */ 
17501. 	
17502. 
17503. 		
17504. # 
17505. FileEnd
17506. /* ---------------------------------------------------------- */
17507. 
17508. # your stuff HERE (X)... post zone (file) code.
17509. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
17510. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17511. 	# (X)
17512. 
17513. SetVariable(FileStepDescription,"Zone finished, reporting.")
17514. # FILE STEP
17515. 
17516. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17517. 
17518. /* add message and move to a new line. */
17519. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17520. ")
17521. 
17522. /* display the line. (hopefully.) */
17523. # Zone Footer Set Statistics Window Text
17524. 
17525. SetStatisticsWindowText("----------------------------------------------------------
17526. Zones Processed: 
17527. ----------------------------------------------------------
17528. !ZoneListByLine!
17529. ----------------------------------------------------------
17530. Zone Processing Step:
17531. !ZoneStepByLine!    
17532. ----------------------------------------------------------
17533. Current Zone:
17534. !ZoneFooter!
17535. ----------------------------------------------------------
17536. Volume Statistics:
17537. !VolumeStatisticsDetail!
17538. ----------------------------------------------------------
17539. Zone Detailed Report:
17540. ----------------------------------------------------------
17541. !ZoneStatisticsDetail!
17542. ----------------------------------------------------------
17543. ")
17544. 
17545. 
17546. 
17547. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17548. 
17549. # BANNER SET
17550. 
17551. # DATE TIME RUN ELP
17552. 
17553. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
17554. /* Xinclude "..\Display\BannerSet.MyDc"X */
17555. /* pause(1) */
17556. 
17557. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17558. 
17559. Title('!Heading!')
17560. /* pause(1) */
17561. 
17562. /* NOTE: Can't round or truncate to integer precision. */
17563. 
17564. pause(1)
17565. 
17566. # Zone When Finished
17567. 
17568. # BANNER SET
17569. 
17570. # DATE TIME RUN ELP
17571. 
17572. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
17573. /* Xinclude "..\Display\BannerSet.MyDc"X */
17574. /* pause(1) */
17575. 
17576. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17577. 
17578. Title('!Heading!')
17579. /* pause(1) */
17580. 
17581. /* NOTE: Can't round or truncate to integer precision. */
17582. 
17583. AppendLogfile("!LogFileName!", "!Title!")
17584. 
17585. 
17586. 
17587. # Zone Statistics	
17588. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
17589. 
17590. # Footer:
17591. SetVariable(ZoneFooter, "----------------------------------------------------------
17592. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
17593. 
17594. Statistics Report:
17595. ------------------
17596.    Size:  
17597.    ------------------------
17598.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17599.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17600.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17601. 
17602.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17603.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17604. 
17605.    Location:
17606.    ------------------------
17607.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17608.              Files End: !ZoneEndCurrent!
17609.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17610.       
17611.    Gap Settings:
17612.    ------------------------
17613.          Gap Requested: !ZoneGapSizePer!%
17614.       Volume Rounding: !ZoneVolRoundUpPer!%
17615.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17616.                  
17617.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17618.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17619.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17620.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17621.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17622.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17623.      
17624.    Free Space after Zone:
17625.    ------------------------
17626.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17627.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17628.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17629. 
17630. Directory and Files Select:
17631. ---------------------------
17632. !ZoneTypeSelectCurrent!               
17633. ---------------------------
17634. ----------------------------------------------------------
17635. ")
17636. 
17637. AppendLogfile("!LogFileName!", ".")
17638. AppendLogfile("!LogFileName!", "!ZoneFooter!")
17639. AppendLogfile("!LogFileName!", ".")
17640. 
17641. # Zone Footer Set Statistics Window Text
17642. 
17643. SetStatisticsWindowText("----------------------------------------------------------
17644. Zones Processed: 
17645. ----------------------------------------------------------
17646. !ZoneListByLine!
17647. ----------------------------------------------------------
17648. Zone Processing Step:
17649. !ZoneStepByLine!    
17650. ----------------------------------------------------------
17651. Current Zone:
17652. !ZoneFooter!
17653. ----------------------------------------------------------
17654. Volume Statistics:
17655. !VolumeStatisticsDetail!
17656. ----------------------------------------------------------
17657. Zone Detailed Report:
17658. ----------------------------------------------------------
17659. !ZoneStatisticsDetail!
17660. ----------------------------------------------------------
17661. ")
17662. 
17663. 
17664. 
17665. /* pause() */
17666. /* pause() */
17667. 
17668. 
17669. 
17670. /* ---------------------------------------------------------- */
17671.   
17672. 
17673. /* ---------------------------------------------------------- */
17674. 
17675. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
17676. 
17677. /* ---------------------------------------------------------- */
17678. /* Zone Games */
17679. /* ---------------------------------------------------------- */
17680. /* Zone Games */
17681. SetVariable(ZoneLabel, "!ZoneLabelGames!")
17682. SetVariable(ZoneDescription, "!ZoneDescriptionGames!")
17683. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpGames!")
17684. SetVariable(ZoneGapSize, "!ZoneGapSizeGames!")
17685. SetVariable(ZoneTypeSelect,'# Games start.
17686. # NotBlobsArchivesBu start.
17687. (not (
17688. # Blobs start.
17689. (
17690. # BlobsAndExceptions start.
17691. ( not(
17692.   FileName("*.bat")
17693.   or FileName("*.css")
17694.   or FileName("*.dll")
17695.   or FileName("*.exe")
17696.   or FileName("*.htm*")
17697.   or FileName("*.jar")
17698.   or FileName("*.js")
17699.   or FileName("*.script")
17700.   or FileName("*.wsf")
17701.   or (
17702. # Databases start.
17703. (
17704.   FileName("*.crypt*")
17705.   or FileName("*.db*")
17706.   or FileName("*.rdb*")
17707.   or FileName("*.dc*")
17708.   or FileName("*.dict*")
17709.   or FileName("*.?db*")
17710.   or FileName("*.?rdb*")
17711.   or FileName("*.md*")
17712.   or FileName("*.myd")
17713.   or FileName("*.ndf")
17714.   or FileName("*.ns?")
17715.   or FileName("*.pab")
17716.   or FileName("*.pst")
17717.   or FileName("*.sd?*")
17718.   or FileName("*.sq**")
17719.   or FileName("*.tmd")
17720.   or FileName("*.tps")
17721.   or FileName("*.tr*")
17722. )
17723. # Databases end.
17724. 
17725.     # BlobsAndExceptions
17726.     or 
17727. # Data start.
17728. (
17729.   DirectoryName("Data*")
17730.   or DirectoryName("Device*")
17731.   or DirectoryName("Export*")
17732.   or DirectoryName("Import*")
17733.   or DirectoryName("Log*")
17734.   or DirectoryName("*Log")
17735.   or DirectoryName("Maintenance*")
17736.   or DirectoryName("Rec*")
17737.   or DirectoryName("Sales*")
17738.   or DirectoryName("Search*")
17739.   or DirectoryName("User*")
17740. )
17741. # Data end.
17742. 
17743.     # BlobsAndExceptions
17744.   )
17745. ) )
17746. # BlobsAndExceptions end.
17747. 
17748. # Blobs
17749. ) and (
17750.   Size(BlobFileSize,0)
17751.   or (
17752.     FileName("*.arj")
17753.     or FileName("*.bup")
17754.     or FileName("*.bz2")
17755.     or FileName("*.chm")
17756.     or FileName("*.dvr-ms")
17757.     or FileName("*.gz")
17758.     or FileName("*.ifo")
17759.     or FileName("*.lzh")
17760.     or FileName("*.pdf")
17761.     or FileName("*.rpm")
17762.     or FileName("*.wmv")
17763.     or FileName("*.vob")
17764.     or FileName("*.z")
17765.   ) 
17766. )
17767. # Blobs end.
17768. 
17769. # NotBlobsArchivesBu
17770. or 
17771. # Archives start.
17772. (
17773.   DirectoryName("*Archive*")
17774.   or DirectoryName("*History*")
17775.   or DirectoryName("*Old")
17776.   or DirectoryName("* Old *")
17777.   or DirectoryName("Old *")
17778. 
17779.   or FileName("*.7z")
17780.   or FileName("*.cab")
17781.   or FileName("*.iso")
17782.   or FileName("*.msi")
17783.   or FileName("*.old")
17784.   or FileName("*.rar")
17785.   or FileName("*.tar")
17786.   or FileName("*.zip")
17787.   or
17788. # WinSysLow start.
17789. (
17790.   DirectoryName("$*")
17791.   or DirectoryName("0*")
17792.   or DirectoryName("1*")
17793.   or DirectoryName("2*")
17794.   or DirectoryName("3*")
17795.   or DirectoryName("4*")
17796.   or DirectoryName("5*")
17797.   or DirectoryName("6*")
17798.   or DirectoryName("7*")
17799.   or DirectoryName("8*")
17800.   or DirectoryName("9*")
17801. 
17802.   or DirectoryName("dllcache")
17803.   or DirectoryName("Downloaded Installations")
17804.   or DirectoryName("Ehome")
17805.   or DirectoryName("Fonts")
17806.   or DirectoryName("Help")
17807.   or DirectoryName("I386")
17808.   or DirectoryName("ie?updates")
17809.   or DirectoryName("Installer")
17810.   or DirectoryName("Installshield Installation Information")
17811.   or DirectoryName("IME")
17812.   or DirectoryName("*RECYCLE*")
17813.   or DirectoryName("ServicePackFiles")
17814.   or DirectoryName("SoftwareDistribution")
17815.   or DirectoryName("Speech")
17816.   or DirectoryName("Symbols")
17817.   or DirectoryName("System Volume Information")
17818.   or DirectoryName("windows.old")
17819. )
17820. # WinSysLow end.
17821. 
17822.   # Archives
17823. )
17824. # Archives end.
17825. 
17826. # NotBlobsArchivesBu
17827. or
17828. # Backups start.
17829. (
17830.   DirectoryName("*Backup*")
17831.   or DirectoryName("*Bu")
17832.   or DirectoryName("* Bu *")
17833.   or DirectoryName("Bu *")
17834. 
17835.   or FileName("*.bak")
17836.   or FileName("* - Copy*")
17837. )
17838. # Backups end.
17839. 
17840. # NotBlobsArchivesBu
17841. ) )
17842. # NotBlobsArchivesBu end.
17843. 
17844. # People
17845. and (
17846. # Games start.
17847. (
17848.   DirectoryName("Game*")
17849.   or DirectoryName("Epic*")
17850.   or DirectoryName("*XBox*")
17851.   or DirectoryName("*PS2*")
17852. )
17853. # Games end.
17854. 
17855. # People
17856. )
17857. # People end.
17858. ')
17859. 
17860. 	# Zone Do Header
17861. 
17862. # Zone When Started
17863. 
17864. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
17865. # Display Set Zone
17866. 
17867. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
17868. SetVariable(FileStepDescription,	"")
17869. 
17870. SetVariable(ZoneStepByLine, 			"Zone started.
17871. ")
17872. 
17873. # BANNER SET
17874. 
17875. # DATE TIME RUN ELP
17876. 
17877. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
17878. /* Xinclude "..\Display\BannerSet.MyDc"X */
17879. /* pause(1) */
17880. 
17881. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17882. 
17883. Title('!Heading!')
17884. /* pause(1) */
17885. 
17886. /* NOTE: Can't round or truncate to integer precision. */
17887. 
17888. AppendLogfile("!LogFileName!", "!Title!")
17889. 
17890. 
17891. 
17892. pause(1)
17893. 
17894. 
17895. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
17896. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
17897. 
17898. SetVariable(ZoneStepNoCurrent, 0)
17899. 
17900. 
17901. # Zone Do Current Clear
17902. 
17903. SetVariable(ZoneTypeSelectCurrent, 		"")
17904. 
17905. SetVariable(ZoneBeginCurrent, 			0)
17906. SetVariable(ZoneBeginPerCurrent, 		0)
17907. SetVariable(ZoneEndCurrent, 			0)
17908. SetVariable(ZoneEndPerCurrent, 			0)
17909. 
17910. SetVariable(ZoneSizeCurrent,			0)
17911. SetVariable(ZoneSizePerCurrent,			0)
17912. 
17913. SetVariable(ZoneGapRequestedCurrent,	0)
17914. SetVariable(ZoneGapRoundedCurrent, 		0)
17915. SetVariable(ZoneGapAdjustedCurrent, 	0)
17916. SetVariable(ZoneGapAvailableCurrent, 	0)
17917. SetVariable(ZoneGapCurrent,				0)
17918. SetVariable(ZoneGapUsedCurrent, 		0)
17919. 
17920. SetVariable(ZoneGapActualCurrent, 		0)
17921. SetVariable(ZoneGapActualPerCurrent, 	0)
17922. 
17923. SetVariable(ZoneSizeActual, 			0)
17924. SetVariable(ZoneSizeActualCurrent,		0)
17925. 
17926. SetVariable(ZoneEndActual, 				0)
17927. SetVariable(ZoneEndActualCurrent,		0)			
17928. SetVariable(ZoneSizeActualPerCurrent, 	0)
17929.       
17930. SetVariable(ZoneFilesFolders,			0)
17931. SetVariable(ZoneFilesFoldersPer,		0) 
17932. 
17933. SetVariable(ZoneFragments,				0)
17934. SetVariable(ZoneFragmentsPer,			0) 
17935. 		
17936. SetVariable(ZoneEndActualCurrent, 		0)
17937. SetVariable(ZoneEndActualPerCurrent, 	0)
17938. 
17939. # Gap Calculation Methodology:
17940. 	# Requested
17941. 	SetVariable(GapRequested, 			0) 
17942. 	SetVariable(GapRequestedStd, 		0) 
17943. 	SetVariable(GapRequestedMft, 		0) 
17944. 	SetVariable(GapRequestedOs, 		0) 
17945. 	SetVariable(GapRequestedOriginal, 	0) 
17946. 	
17947. 	# Gap Adjustments
17948. 	SetVariable(GapRounded, 			0)
17949. 	# SetVariable(GapAdjusted, 			0)
17950. 	SetVariable(GapAvailable, 			0)
17951. 	SetVariable(GapCurrent, 			0)
17952. 	SetVariable(GapActual, 				0)
17953. 	SetVariable(GapUsed, 				0)
17954. 	
17955. 	# Gap Adjustments
17956. 	SetVariable(GapRoundedLoc, 			0)
17957. 	# SetVariable(GapAdjustedLoc, 		0)
17958. 	SetVariable(GapAvailableLoc, 		0)
17959. 	SetVariable(GapCurrentLoc, 			0)
17960. 	SetVariable(GapActualLoc,			0)
17961. 	SetVariable(GapUsedLoc,				0)
17962. 	
17963. 	# Space usage
17964. 	SetVariable(ZoneFreePerRequested, 	0)
17965. 	SetVariable(ZoneFreePerUsed, 		0)
17966. 
17967. # Gap Size & Rounding
17968. 	SetVariable(ZoneGapSizePer, 		0)
17969. 	SetVariable(ZoneVolRoundUpPer, 		0)
17970. 	
17971. 	# Free Space
17972. 	SetVariable(ZoneFreeUsedPer, 		0)
17973. 	SetVariable(ZoneFreeRequestedPer, 	0)
17974. 
17975. 
17976. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
17977. 
17978. # Footer:
17979. SetVariable(ZoneFooter, "----------------------------------------------------------
17980. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
17981. 
17982. Statistics Report:
17983. ------------------
17984.    Size:  
17985.    ------------------------
17986.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17987.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17988.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17989. 
17990.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17991.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17992. 
17993.    Location:
17994.    ------------------------
17995.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17996.              Files End: !ZoneEndCurrent!
17997.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17998.       
17999.    Gap Settings:
18000.    ------------------------
18001.          Gap Requested: !ZoneGapSizePer!%
18002.       Volume Rounding: !ZoneVolRoundUpPer!%
18003.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18004.                  
18005.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18006.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18007.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18008.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18009.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18010.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18011.      
18012.    Free Space after Zone:
18013.    ------------------------
18014.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18015.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18016.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18017. 
18018. Directory and Files Select:
18019. ---------------------------
18020. !ZoneTypeSelectCurrent!               
18021. ---------------------------
18022. ----------------------------------------------------------
18023. ")
18024. 
18025. # BANNER SET
18026. 
18027. # DATE TIME RUN ELP
18028. 
18029. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
18030. /* Xinclude "..\Display\BannerSet.MyDc"X */
18031. /* pause(1) */
18032. 
18033. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18034. 
18035. Title('!Heading!')
18036. /* pause(1) */
18037. 
18038. /* NOTE: Can't round or truncate to integer precision. */
18039. 
18040. AppendLogfile("!LogFileName!", "!Title!")
18041. 
18042. 
18043. 
18044. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
18045. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
18046. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:55")
18047. 
18048. SetVariable(ZoneListByLine, "!ZoneListByLine!
18049. Zone: !ZoneNoCurrent! 2021-11-09 10:47:55 0:00:07 !ZoneLabel! !ZoneDescription!")
18050. 
18051. 
18052. /* Fixed Zone Position Handling */
18053. /* Literal number: */
18054. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
18055. /* Percentage of disk: */
18056. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
18057. /* Gap */
18058. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
18059. 
18060. /* ---------------------------------------------------------- */
18061. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
18062. # FILE STEP
18063. 
18064. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18065. 
18066. /* add message and move to a new line. */
18067. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18068. ")
18069. 
18070. /* display the line. (hopefully.) */
18071. # Zone Footer Set Statistics Window Text
18072. 
18073. SetStatisticsWindowText("----------------------------------------------------------
18074. Zones Processed: 
18075. ----------------------------------------------------------
18076. !ZoneListByLine!
18077. ----------------------------------------------------------
18078. Zone Processing Step:
18079. !ZoneStepByLine!    
18080. ----------------------------------------------------------
18081. Current Zone:
18082. !ZoneFooter!
18083. ----------------------------------------------------------
18084. Volume Statistics:
18085. !VolumeStatisticsDetail!
18086. ----------------------------------------------------------
18087. Zone Detailed Report:
18088. ----------------------------------------------------------
18089. !ZoneStatisticsDetail!
18090. ----------------------------------------------------------
18091. ")
18092. 
18093. 
18094. 
18095. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18096. 
18097. # BANNER SET
18098. 
18099. # DATE TIME RUN ELP
18100. 
18101. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
18102. /* Xinclude "..\Display\BannerSet.MyDc"X */
18103. /* pause(1) */
18104. 
18105. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18106. 
18107. Title('!Heading!')
18108. /* pause(1) */
18109. 
18110. /* NOTE: Can't round or truncate to integer precision. */
18111. 
18112. pause(1)
18113. 
18114. # your stuff HERE (X)... pre file select code.
18115. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
18116. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18117. 	# (X)
18118. 
18119. FileSelect
18120. 
18121. 	# your stuff can't really go here (errors.)
18122. 	# maybe for some reason I don't know of...
18123. 	
18124. 	# Actions next...
18125. 	# Games start.
18126. # NotBlobsArchivesBu start.
18127. (not (
18128. # Blobs start.
18129. (
18130. # BlobsAndExceptions start.
18131. ( not(
18132.   FileName("*.bat")
18133.   or FileName("*.css")
18134.   or FileName("*.dll")
18135.   or FileName("*.exe")
18136.   or FileName("*.htm*")
18137.   or FileName("*.jar")
18138.   or FileName("*.js")
18139.   or FileName("*.script")
18140.   or FileName("*.wsf")
18141.   or (
18142. # Databases start.
18143. (
18144.   FileName("*.crypt*")
18145.   or FileName("*.db*")
18146.   or FileName("*.rdb*")
18147.   or FileName("*.dc*")
18148.   or FileName("*.dict*")
18149.   or FileName("*.?db*")
18150.   or FileName("*.?rdb*")
18151.   or FileName("*.md*")
18152.   or FileName("*.myd")
18153.   or FileName("*.ndf")
18154.   or FileName("*.ns?")
18155.   or FileName("*.pab")
18156.   or FileName("*.pst")
18157.   or FileName("*.sd?*")
18158.   or FileName("*.sq**")
18159.   or FileName("*.tmd")
18160.   or FileName("*.tps")
18161.   or FileName("*.tr*")
18162. )
18163. # Databases end.
18164. 
18165.     # BlobsAndExceptions
18166.     or 
18167. # Data start.
18168. (
18169.   DirectoryName("Data*")
18170.   or DirectoryName("Device*")
18171.   or DirectoryName("Export*")
18172.   or DirectoryName("Import*")
18173.   or DirectoryName("Log*")
18174.   or DirectoryName("*Log")
18175.   or DirectoryName("Maintenance*")
18176.   or DirectoryName("Rec*")
18177.   or DirectoryName("Sales*")
18178.   or DirectoryName("Search*")
18179.   or DirectoryName("User*")
18180. )
18181. # Data end.
18182. 
18183.     # BlobsAndExceptions
18184.   )
18185. ) )
18186. # BlobsAndExceptions end.
18187. 
18188. # Blobs
18189. ) and (
18190.   Size(BlobFileSize,0)
18191.   or (
18192.     FileName("*.arj")
18193.     or FileName("*.bup")
18194.     or FileName("*.bz2")
18195.     or FileName("*.chm")
18196.     or FileName("*.dvr-ms")
18197.     or FileName("*.gz")
18198.     or FileName("*.ifo")
18199.     or FileName("*.lzh")
18200.     or FileName("*.pdf")
18201.     or FileName("*.rpm")
18202.     or FileName("*.wmv")
18203.     or FileName("*.vob")
18204.     or FileName("*.z")
18205.   ) 
18206. )
18207. # Blobs end.
18208. 
18209. # NotBlobsArchivesBu
18210. or 
18211. # Archives start.
18212. (
18213.   DirectoryName("*Archive*")
18214.   or DirectoryName("*History*")
18215.   or DirectoryName("*Old")
18216.   or DirectoryName("* Old *")
18217.   or DirectoryName("Old *")
18218. 
18219.   or FileName("*.7z")
18220.   or FileName("*.cab")
18221.   or FileName("*.iso")
18222.   or FileName("*.msi")
18223.   or FileName("*.old")
18224.   or FileName("*.rar")
18225.   or FileName("*.tar")
18226.   or FileName("*.zip")
18227.   or
18228. # WinSysLow start.
18229. (
18230.   DirectoryName("$*")
18231.   or DirectoryName("0*")
18232.   or DirectoryName("1*")
18233.   or DirectoryName("2*")
18234.   or DirectoryName("3*")
18235.   or DirectoryName("4*")
18236.   or DirectoryName("5*")
18237.   or DirectoryName("6*")
18238.   or DirectoryName("7*")
18239.   or DirectoryName("8*")
18240.   or DirectoryName("9*")
18241. 
18242.   or DirectoryName("dllcache")
18243.   or DirectoryName("Downloaded Installations")
18244.   or DirectoryName("Ehome")
18245.   or DirectoryName("Fonts")
18246.   or DirectoryName("Help")
18247.   or DirectoryName("I386")
18248.   or DirectoryName("ie?updates")
18249.   or DirectoryName("Installer")
18250.   or DirectoryName("Installshield Installation Information")
18251.   or DirectoryName("IME")
18252.   or DirectoryName("*RECYCLE*")
18253.   or DirectoryName("ServicePackFiles")
18254.   or DirectoryName("SoftwareDistribution")
18255.   or DirectoryName("Speech")
18256.   or DirectoryName("Symbols")
18257.   or DirectoryName("System Volume Information")
18258.   or DirectoryName("windows.old")
18259. )
18260. # WinSysLow end.
18261. 
18262.   # Archives
18263. )
18264. # Archives end.
18265. 
18266. # NotBlobsArchivesBu
18267. or
18268. # Backups start.
18269. (
18270.   DirectoryName("*Backup*")
18271.   or DirectoryName("*Bu")
18272.   or DirectoryName("* Bu *")
18273.   or DirectoryName("Bu *")
18274. 
18275.   or FileName("*.bak")
18276.   or FileName("* - Copy*")
18277. )
18278. # Backups end.
18279. 
18280. # NotBlobsArchivesBu
18281. ) )
18282. # NotBlobsArchivesBu end.
18283. 
18284. # People
18285. and (
18286. # Games start.
18287. (
18288.   DirectoryName("Game*")
18289.   or DirectoryName("Epic*")
18290.   or DirectoryName("*XBox*")
18291.   or DirectoryName("*PS2*")
18292. )
18293. # Games end.
18294. 
18295. # People
18296. )
18297. # People end.
18298. 
18299. 		SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
18300. 
18301. 	# Zone Do Footer
18302. 
18303. /* ---------------------------------------------------------- */
18304. # File Select
18305. 	# Select Statments
18306. # File Actions 
18307. 	# Standard or OS File Actions.
18308. 	# Resume...
18309. 	
18310. 	# your stuff HERE (X)... post zone (file) file actions code.
18311. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
18312. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18313. 		# (X)
18314. 		
18315. 		/* ??? Set window? */
18316. 	
18317. 	# ADD THE GAP
18318. 		
18319. # Vacate (good for diagnostics)
18320. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
18321. 
18322. # DoNotVacate - DO NOT Vacate (recommended)
18323. 
18324. # Vacate
18325. /* AddGap(GapUsedLoc) */
18326. 
18327. # DO Not Vacate
18328. AddGap(GapUsedLoc, DoNotVacate) 
18329. 	
18330. 	
18331. /* ---------------------------------------------------------- */
18332. # (failed) TEST for boolean logic.
18333. 
18334. /* It should work in the gap calculations for turning options */
18335. /* on and off but it will NOT work here. */
18336. 
18337. /* Boolean setting X or FlagX. */
18338. /* Where X will be on or off: */
18339. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
18340. /*      For ON:  (X  *  FlagAny) */
18341. 
18342. /* 1) Failed, zero gap overrode the previous one. */
18343. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
18344. /* AddGap(GapUsedTemp) */ 
18345. 
18346. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
18347. /* AddGap(GapUsedTemp, DoNotVacate) */ 
18348. 
18349. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
18350. 
18351. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
18352. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
18353. /* AddGap(GapUsedTemp) */ 
18354. 
18355. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
18356. /* AddGap(GapUsedTemp, DoNotVacate) */ 
18357. 
18358. /* ---------------------------------------------------------- */
18359. 
18360. # Vacate
18361. /* AddGap(GapUsed) */
18362. 
18363. # DO NOT Vacate (recommended)
18364. /* AddGap(GapUsed, DoNotVacate) */ 
18365. 	
18366. 
18367. 		
18368. # 
18369. FileEnd
18370. /* ---------------------------------------------------------- */
18371. 
18372. # your stuff HERE (X)... post zone (file) code.
18373. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
18374. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18375. 	# (X)
18376. 
18377. SetVariable(FileStepDescription,"Zone finished, reporting.")
18378. # FILE STEP
18379. 
18380. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18381. 
18382. /* add message and move to a new line. */
18383. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18384. ")
18385. 
18386. /* display the line. (hopefully.) */
18387. # Zone Footer Set Statistics Window Text
18388. 
18389. SetStatisticsWindowText("----------------------------------------------------------
18390. Zones Processed: 
18391. ----------------------------------------------------------
18392. !ZoneListByLine!
18393. ----------------------------------------------------------
18394. Zone Processing Step:
18395. !ZoneStepByLine!    
18396. ----------------------------------------------------------
18397. Current Zone:
18398. !ZoneFooter!
18399. ----------------------------------------------------------
18400. Volume Statistics:
18401. !VolumeStatisticsDetail!
18402. ----------------------------------------------------------
18403. Zone Detailed Report:
18404. ----------------------------------------------------------
18405. !ZoneStatisticsDetail!
18406. ----------------------------------------------------------
18407. ")
18408. 
18409. 
18410. 
18411. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18412. 
18413. # BANNER SET
18414. 
18415. # DATE TIME RUN ELP
18416. 
18417. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
18418. /* Xinclude "..\Display\BannerSet.MyDc"X */
18419. /* pause(1) */
18420. 
18421. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18422. 
18423. Title('!Heading!')
18424. /* pause(1) */
18425. 
18426. /* NOTE: Can't round or truncate to integer precision. */
18427. 
18428. pause(1)
18429. 
18430. # Zone When Finished
18431. 
18432. # BANNER SET
18433. 
18434. # DATE TIME RUN ELP
18435. 
18436. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:55 0:00:07")
18437. /* Xinclude "..\Display\BannerSet.MyDc"X */
18438. /* pause(1) */
18439. 
18440. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18441. 
18442. Title('!Heading!')
18443. /* pause(1) */
18444. 
18445. /* NOTE: Can't round or truncate to integer precision. */
18446. 
18447. AppendLogfile("!LogFileName!", "!Title!")
18448. 
18449. 
18450. 
18451. # Zone Statistics	
18452. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
18453. 
18454. # Footer:
18455. SetVariable(ZoneFooter, "----------------------------------------------------------
18456. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:55
18457. 
18458. Statistics Report:
18459. ------------------
18460.    Size:  
18461.    ------------------------
18462.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18463.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18464.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18465. 
18466.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18467.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18468. 
18469.    Location:
18470.    ------------------------
18471.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18472.              Files End: !ZoneEndCurrent!
18473.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18474.       
18475.    Gap Settings:
18476.    ------------------------
18477.          Gap Requested: !ZoneGapSizePer!%
18478.       Volume Rounding: !ZoneVolRoundUpPer!%
18479.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18480.                  
18481.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18482.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18483.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18484.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18485.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18486.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18487.      
18488.    Free Space after Zone:
18489.    ------------------------
18490.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18491.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18492.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18493. 
18494. Directory and Files Select:
18495. ---------------------------
18496. !ZoneTypeSelectCurrent!               
18497. ---------------------------
18498. ----------------------------------------------------------
18499. ")
18500. 
18501. AppendLogfile("!LogFileName!", ".")
18502. AppendLogfile("!LogFileName!", "!ZoneFooter!")
18503. AppendLogfile("!LogFileName!", ".")
18504. 
18505. # Zone Footer Set Statistics Window Text
18506. 
18507. SetStatisticsWindowText("----------------------------------------------------------
18508. Zones Processed: 
18509. ----------------------------------------------------------
18510. !ZoneListByLine!
18511. ----------------------------------------------------------
18512. Zone Processing Step:
18513. !ZoneStepByLine!    
18514. ----------------------------------------------------------
18515. Current Zone:
18516. !ZoneFooter!
18517. ----------------------------------------------------------
18518. Volume Statistics:
18519. !VolumeStatisticsDetail!
18520. ----------------------------------------------------------
18521. Zone Detailed Report:
18522. ----------------------------------------------------------
18523. !ZoneStatisticsDetail!
18524. ----------------------------------------------------------
18525. ")
18526. 
18527. 
18528. 
18529. /* pause() */
18530. /* pause() */
18531. 
18532. 
18533. 
18534. 
18535. /* ---------------------------------------------------------- */
18536. 
18537. 
18538. /* ---------------------------------------------------------- */
18539. /* Zone Shares */
18540. /* ---------------------------------------------------------- */
18541. /* Zone Shares */
18542. SetVariable(ZoneLabel, "!ZoneLabelShares!")
18543. SetVariable(ZoneDescription, "!ZoneDescriptionShares!")
18544. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpShares!")
18545. SetVariable(ZoneGapSize, "!ZoneGapSizeShares!")
18546. SetVariable(ZoneTypeSelect,'# Shares start.
18547. # NotBlobsArchivesBu start.
18548. (not (
18549. # Blobs start.
18550. (
18551. # BlobsAndExceptions start.
18552. ( not(
18553.   FileName("*.bat")
18554.   or FileName("*.css")
18555.   or FileName("*.dll")
18556.   or FileName("*.exe")
18557.   or FileName("*.htm*")
18558.   or FileName("*.jar")
18559.   or FileName("*.js")
18560.   or FileName("*.script")
18561.   or FileName("*.wsf")
18562.   or (
18563. # Databases start.
18564. (
18565.   FileName("*.crypt*")
18566.   or FileName("*.db*")
18567.   or FileName("*.rdb*")
18568.   or FileName("*.dc*")
18569.   or FileName("*.dict*")
18570.   or FileName("*.?db*")
18571.   or FileName("*.?rdb*")
18572.   or FileName("*.md*")
18573.   or FileName("*.myd")
18574.   or FileName("*.ndf")
18575.   or FileName("*.ns?")
18576.   or FileName("*.pab")
18577.   or FileName("*.pst")
18578.   or FileName("*.sd?*")
18579.   or FileName("*.sq**")
18580.   or FileName("*.tmd")
18581.   or FileName("*.tps")
18582.   or FileName("*.tr*")
18583. )
18584. # Databases end.
18585. 
18586.     # BlobsAndExceptions
18587.     or 
18588. # Data start.
18589. (
18590.   DirectoryName("Data*")
18591.   or DirectoryName("Device*")
18592.   or DirectoryName("Export*")
18593.   or DirectoryName("Import*")
18594.   or DirectoryName("Log*")
18595.   or DirectoryName("*Log")
18596.   or DirectoryName("Maintenance*")
18597.   or DirectoryName("Rec*")
18598.   or DirectoryName("Sales*")
18599.   or DirectoryName("Search*")
18600.   or DirectoryName("User*")
18601. )
18602. # Data end.
18603. 
18604.     # BlobsAndExceptions
18605.   )
18606. ) )
18607. # BlobsAndExceptions end.
18608. 
18609. # Blobs
18610. ) and (
18611.   Size(BlobFileSize,0)
18612.   or (
18613.     FileName("*.arj")
18614.     or FileName("*.bup")
18615.     or FileName("*.bz2")
18616.     or FileName("*.chm")
18617.     or FileName("*.dvr-ms")
18618.     or FileName("*.gz")
18619.     or FileName("*.ifo")
18620.     or FileName("*.lzh")
18621.     or FileName("*.pdf")
18622.     or FileName("*.rpm")
18623.     or FileName("*.wmv")
18624.     or FileName("*.vob")
18625.     or FileName("*.z")
18626.   ) 
18627. )
18628. # Blobs end.
18629. 
18630. # NotBlobsArchivesBu
18631. or 
18632. # Archives start.
18633. (
18634.   DirectoryName("*Archive*")
18635.   or DirectoryName("*History*")
18636.   or DirectoryName("*Old")
18637.   or DirectoryName("* Old *")
18638.   or DirectoryName("Old *")
18639. 
18640.   or FileName("*.7z")
18641.   or FileName("*.cab")
18642.   or FileName("*.iso")
18643.   or FileName("*.msi")
18644.   or FileName("*.old")
18645.   or FileName("*.rar")
18646.   or FileName("*.tar")
18647.   or FileName("*.zip")
18648.   or
18649. # WinSysLow start.
18650. (
18651.   DirectoryName("$*")
18652.   or DirectoryName("0*")
18653.   or DirectoryName("1*")
18654.   or DirectoryName("2*")
18655.   or DirectoryName("3*")
18656.   or DirectoryName("4*")
18657.   or DirectoryName("5*")
18658.   or DirectoryName("6*")
18659.   or DirectoryName("7*")
18660.   or DirectoryName("8*")
18661.   or DirectoryName("9*")
18662. 
18663.   or DirectoryName("dllcache")
18664.   or DirectoryName("Downloaded Installations")
18665.   or DirectoryName("Ehome")
18666.   or DirectoryName("Fonts")
18667.   or DirectoryName("Help")
18668.   or DirectoryName("I386")
18669.   or DirectoryName("ie?updates")
18670.   or DirectoryName("Installer")
18671.   or DirectoryName("Installshield Installation Information")
18672.   or DirectoryName("IME")
18673.   or DirectoryName("*RECYCLE*")
18674.   or DirectoryName("ServicePackFiles")
18675.   or DirectoryName("SoftwareDistribution")
18676.   or DirectoryName("Speech")
18677.   or DirectoryName("Symbols")
18678.   or DirectoryName("System Volume Information")
18679.   or DirectoryName("windows.old")
18680. )
18681. # WinSysLow end.
18682. 
18683.   # Archives
18684. )
18685. # Archives end.
18686. 
18687. # NotBlobsArchivesBu
18688. or
18689. # Backups start.
18690. (
18691.   DirectoryName("*Backup*")
18692.   or DirectoryName("*Bu")
18693.   or DirectoryName("* Bu *")
18694.   or DirectoryName("Bu *")
18695. 
18696.   or FileName("*.bak")
18697.   or FileName("* - Copy*")
18698. )
18699. # Backups end.
18700. 
18701. # NotBlobsArchivesBu
18702. ) )
18703. # NotBlobsArchivesBu end.
18704. 
18705. # Shares
18706. and (
18707. # Share start.
18708. (
18709.   DirectoryName("*Common*")
18710.   or DirectoryName("Media*")
18711.   or DirectoryName("Multimedia*")
18712.   or DirectoryName("*Public*")
18713.   or DirectoryName("*Share*")
18714. )
18715. # Share end.
18716. 
18717. # Shares
18718. or 
18719. # Family start.
18720. (
18721.     DirectoryName("*Family*")
18722. )
18723. # Family end.
18724. 
18725. # Shares
18726. )
18727. # Shares end.
18728. ')
18729. 
18730. 	# Zone Do Header
18731. 
18732. # Zone When Started
18733. 
18734. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
18735. # Display Set Zone
18736. 
18737. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
18738. SetVariable(FileStepDescription,	"")
18739. 
18740. SetVariable(ZoneStepByLine, 			"Zone started.
18741. ")
18742. 
18743. # BANNER SET
18744. 
18745. # DATE TIME RUN ELP
18746. 
18747. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
18748. /* Xinclude "..\Display\BannerSet.MyDc"X */
18749. /* pause(1) */
18750. 
18751. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18752. 
18753. Title('!Heading!')
18754. /* pause(1) */
18755. 
18756. /* NOTE: Can't round or truncate to integer precision. */
18757. 
18758. AppendLogfile("!LogFileName!", "!Title!")
18759. 
18760. 
18761. 
18762. pause(1)
18763. 
18764. 
18765. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
18766. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
18767. 
18768. SetVariable(ZoneStepNoCurrent, 0)
18769. 
18770. 
18771. # Zone Do Current Clear
18772. 
18773. SetVariable(ZoneTypeSelectCurrent, 		"")
18774. 
18775. SetVariable(ZoneBeginCurrent, 			0)
18776. SetVariable(ZoneBeginPerCurrent, 		0)
18777. SetVariable(ZoneEndCurrent, 			0)
18778. SetVariable(ZoneEndPerCurrent, 			0)
18779. 
18780. SetVariable(ZoneSizeCurrent,			0)
18781. SetVariable(ZoneSizePerCurrent,			0)
18782. 
18783. SetVariable(ZoneGapRequestedCurrent,	0)
18784. SetVariable(ZoneGapRoundedCurrent, 		0)
18785. SetVariable(ZoneGapAdjustedCurrent, 	0)
18786. SetVariable(ZoneGapAvailableCurrent, 	0)
18787. SetVariable(ZoneGapCurrent,				0)
18788. SetVariable(ZoneGapUsedCurrent, 		0)
18789. 
18790. SetVariable(ZoneGapActualCurrent, 		0)
18791. SetVariable(ZoneGapActualPerCurrent, 	0)
18792. 
18793. SetVariable(ZoneSizeActual, 			0)
18794. SetVariable(ZoneSizeActualCurrent,		0)
18795. 
18796. SetVariable(ZoneEndActual, 				0)
18797. SetVariable(ZoneEndActualCurrent,		0)			
18798. SetVariable(ZoneSizeActualPerCurrent, 	0)
18799.       
18800. SetVariable(ZoneFilesFolders,			0)
18801. SetVariable(ZoneFilesFoldersPer,		0) 
18802. 
18803. SetVariable(ZoneFragments,				0)
18804. SetVariable(ZoneFragmentsPer,			0) 
18805. 		
18806. SetVariable(ZoneEndActualCurrent, 		0)
18807. SetVariable(ZoneEndActualPerCurrent, 	0)
18808. 
18809. # Gap Calculation Methodology:
18810. 	# Requested
18811. 	SetVariable(GapRequested, 			0) 
18812. 	SetVariable(GapRequestedStd, 		0) 
18813. 	SetVariable(GapRequestedMft, 		0) 
18814. 	SetVariable(GapRequestedOs, 		0) 
18815. 	SetVariable(GapRequestedOriginal, 	0) 
18816. 	
18817. 	# Gap Adjustments
18818. 	SetVariable(GapRounded, 			0)
18819. 	# SetVariable(GapAdjusted, 			0)
18820. 	SetVariable(GapAvailable, 			0)
18821. 	SetVariable(GapCurrent, 			0)
18822. 	SetVariable(GapActual, 				0)
18823. 	SetVariable(GapUsed, 				0)
18824. 	
18825. 	# Gap Adjustments
18826. 	SetVariable(GapRoundedLoc, 			0)
18827. 	# SetVariable(GapAdjustedLoc, 		0)
18828. 	SetVariable(GapAvailableLoc, 		0)
18829. 	SetVariable(GapCurrentLoc, 			0)
18830. 	SetVariable(GapActualLoc,			0)
18831. 	SetVariable(GapUsedLoc,				0)
18832. 	
18833. 	# Space usage
18834. 	SetVariable(ZoneFreePerRequested, 	0)
18835. 	SetVariable(ZoneFreePerUsed, 		0)
18836. 
18837. # Gap Size & Rounding
18838. 	SetVariable(ZoneGapSizePer, 		0)
18839. 	SetVariable(ZoneVolRoundUpPer, 		0)
18840. 	
18841. 	# Free Space
18842. 	SetVariable(ZoneFreeUsedPer, 		0)
18843. 	SetVariable(ZoneFreeRequestedPer, 	0)
18844. 
18845. 
18846. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
18847. 
18848. # Footer:
18849. SetVariable(ZoneFooter, "----------------------------------------------------------
18850. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:56
18851. 
18852. Statistics Report:
18853. ------------------
18854.    Size:  
18855.    ------------------------
18856.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18857.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18858.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18859. 
18860.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18861.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18862. 
18863.    Location:
18864.    ------------------------
18865.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18866.              Files End: !ZoneEndCurrent!
18867.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18868.       
18869.    Gap Settings:
18870.    ------------------------
18871.          Gap Requested: !ZoneGapSizePer!%
18872.       Volume Rounding: !ZoneVolRoundUpPer!%
18873.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18874.                  
18875.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18876.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18877.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18878.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18879.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18880.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18881.      
18882.    Free Space after Zone:
18883.    ------------------------
18884.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18885.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18886.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18887. 
18888. Directory and Files Select:
18889. ---------------------------
18890. !ZoneTypeSelectCurrent!               
18891. ---------------------------
18892. ----------------------------------------------------------
18893. ")
18894. 
18895. # BANNER SET
18896. 
18897. # DATE TIME RUN ELP
18898. 
18899. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
18900. /* Xinclude "..\Display\BannerSet.MyDc"X */
18901. /* pause(1) */
18902. 
18903. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18904. 
18905. Title('!Heading!')
18906. /* pause(1) */
18907. 
18908. /* NOTE: Can't round or truncate to integer precision. */
18909. 
18910. AppendLogfile("!LogFileName!", "!Title!")
18911. 
18912. 
18913. 
18914. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
18915. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
18916. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:56")
18917. 
18918. SetVariable(ZoneListByLine, "!ZoneListByLine!
18919. Zone: !ZoneNoCurrent! 2021-11-09 10:47:56 0:00:08 !ZoneLabel! !ZoneDescription!")
18920. 
18921. 
18922. /* Fixed Zone Position Handling */
18923. /* Literal number: */
18924. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
18925. /* Percentage of disk: */
18926. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
18927. /* Gap */
18928. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
18929. 
18930. /* ---------------------------------------------------------- */
18931. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
18932. # FILE STEP
18933. 
18934. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18935. 
18936. /* add message and move to a new line. */
18937. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18938. ")
18939. 
18940. /* display the line. (hopefully.) */
18941. # Zone Footer Set Statistics Window Text
18942. 
18943. SetStatisticsWindowText("----------------------------------------------------------
18944. Zones Processed: 
18945. ----------------------------------------------------------
18946. !ZoneListByLine!
18947. ----------------------------------------------------------
18948. Zone Processing Step:
18949. !ZoneStepByLine!    
18950. ----------------------------------------------------------
18951. Current Zone:
18952. !ZoneFooter!
18953. ----------------------------------------------------------
18954. Volume Statistics:
18955. !VolumeStatisticsDetail!
18956. ----------------------------------------------------------
18957. Zone Detailed Report:
18958. ----------------------------------------------------------
18959. !ZoneStatisticsDetail!
18960. ----------------------------------------------------------
18961. ")
18962. 
18963. 
18964. 
18965. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18966. 
18967. # BANNER SET
18968. 
18969. # DATE TIME RUN ELP
18970. 
18971. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
18972. /* Xinclude "..\Display\BannerSet.MyDc"X */
18973. /* pause(1) */
18974. 
18975. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18976. 
18977. Title('!Heading!')
18978. /* pause(1) */
18979. 
18980. /* NOTE: Can't round or truncate to integer precision. */
18981. 
18982. pause(1)
18983. 
18984. # your stuff HERE (X)... pre file select code.
18985. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
18986. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18987. 	# (X)
18988. 
18989. FileSelect
18990. 
18991. 	# your stuff can't really go here (errors.)
18992. 	# maybe for some reason I don't know of...
18993. 	
18994. 	# Actions next...
18995. 	# Shares start.
18996. # NotBlobsArchivesBu start.
18997. (not (
18998. # Blobs start.
18999. (
19000. # BlobsAndExceptions start.
19001. ( not(
19002.   FileName("*.bat")
19003.   or FileName("*.css")
19004.   or FileName("*.dll")
19005.   or FileName("*.exe")
19006.   or FileName("*.htm*")
19007.   or FileName("*.jar")
19008.   or FileName("*.js")
19009.   or FileName("*.script")
19010.   or FileName("*.wsf")
19011.   or (
19012. # Databases start.
19013. (
19014.   FileName("*.crypt*")
19015.   or FileName("*.db*")
19016.   or FileName("*.rdb*")
19017.   or FileName("*.dc*")
19018.   or FileName("*.dict*")
19019.   or FileName("*.?db*")
19020.   or FileName("*.?rdb*")
19021.   or FileName("*.md*")
19022.   or FileName("*.myd")
19023.   or FileName("*.ndf")
19024.   or FileName("*.ns?")
19025.   or FileName("*.pab")
19026.   or FileName("*.pst")
19027.   or FileName("*.sd?*")
19028.   or FileName("*.sq**")
19029.   or FileName("*.tmd")
19030.   or FileName("*.tps")
19031.   or FileName("*.tr*")
19032. )
19033. # Databases end.
19034. 
19035.     # BlobsAndExceptions
19036.     or 
19037. # Data start.
19038. (
19039.   DirectoryName("Data*")
19040.   or DirectoryName("Device*")
19041.   or DirectoryName("Export*")
19042.   or DirectoryName("Import*")
19043.   or DirectoryName("Log*")
19044.   or DirectoryName("*Log")
19045.   or DirectoryName("Maintenance*")
19046.   or DirectoryName("Rec*")
19047.   or DirectoryName("Sales*")
19048.   or DirectoryName("Search*")
19049.   or DirectoryName("User*")
19050. )
19051. # Data end.
19052. 
19053.     # BlobsAndExceptions
19054.   )
19055. ) )
19056. # BlobsAndExceptions end.
19057. 
19058. # Blobs
19059. ) and (
19060.   Size(BlobFileSize,0)
19061.   or (
19062.     FileName("*.arj")
19063.     or FileName("*.bup")
19064.     or FileName("*.bz2")
19065.     or FileName("*.chm")
19066.     or FileName("*.dvr-ms")
19067.     or FileName("*.gz")
19068.     or FileName("*.ifo")
19069.     or FileName("*.lzh")
19070.     or FileName("*.pdf")
19071.     or FileName("*.rpm")
19072.     or FileName("*.wmv")
19073.     or FileName("*.vob")
19074.     or FileName("*.z")
19075.   ) 
19076. )
19077. # Blobs end.
19078. 
19079. # NotBlobsArchivesBu
19080. or 
19081. # Archives start.
19082. (
19083.   DirectoryName("*Archive*")
19084.   or DirectoryName("*History*")
19085.   or DirectoryName("*Old")
19086.   or DirectoryName("* Old *")
19087.   or DirectoryName("Old *")
19088. 
19089.   or FileName("*.7z")
19090.   or FileName("*.cab")
19091.   or FileName("*.iso")
19092.   or FileName("*.msi")
19093.   or FileName("*.old")
19094.   or FileName("*.rar")
19095.   or FileName("*.tar")
19096.   or FileName("*.zip")
19097.   or
19098. # WinSysLow start.
19099. (
19100.   DirectoryName("$*")
19101.   or DirectoryName("0*")
19102.   or DirectoryName("1*")
19103.   or DirectoryName("2*")
19104.   or DirectoryName("3*")
19105.   or DirectoryName("4*")
19106.   or DirectoryName("5*")
19107.   or DirectoryName("6*")
19108.   or DirectoryName("7*")
19109.   or DirectoryName("8*")
19110.   or DirectoryName("9*")
19111. 
19112.   or DirectoryName("dllcache")
19113.   or DirectoryName("Downloaded Installations")
19114.   or DirectoryName("Ehome")
19115.   or DirectoryName("Fonts")
19116.   or DirectoryName("Help")
19117.   or DirectoryName("I386")
19118.   or DirectoryName("ie?updates")
19119.   or DirectoryName("Installer")
19120.   or DirectoryName("Installshield Installation Information")
19121.   or DirectoryName("IME")
19122.   or DirectoryName("*RECYCLE*")
19123.   or DirectoryName("ServicePackFiles")
19124.   or DirectoryName("SoftwareDistribution")
19125.   or DirectoryName("Speech")
19126.   or DirectoryName("Symbols")
19127.   or DirectoryName("System Volume Information")
19128.   or DirectoryName("windows.old")
19129. )
19130. # WinSysLow end.
19131. 
19132.   # Archives
19133. )
19134. # Archives end.
19135. 
19136. # NotBlobsArchivesBu
19137. or
19138. # Backups start.
19139. (
19140.   DirectoryName("*Backup*")
19141.   or DirectoryName("*Bu")
19142.   or DirectoryName("* Bu *")
19143.   or DirectoryName("Bu *")
19144. 
19145.   or FileName("*.bak")
19146.   or FileName("* - Copy*")
19147. )
19148. # Backups end.
19149. 
19150. # NotBlobsArchivesBu
19151. ) )
19152. # NotBlobsArchivesBu end.
19153. 
19154. # Shares
19155. and (
19156. # Share start.
19157. (
19158.   DirectoryName("*Common*")
19159.   or DirectoryName("Media*")
19160.   or DirectoryName("Multimedia*")
19161.   or DirectoryName("*Public*")
19162.   or DirectoryName("*Share*")
19163. )
19164. # Share end.
19165. 
19166. # Shares
19167. or 
19168. # Family start.
19169. (
19170.     DirectoryName("*Family*")
19171. )
19172. # Family end.
19173. 
19174. # Shares
19175. )
19176. # Shares end.
19177. 
19178. 		SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
19179. 
19180. 	# Zone Do Footer
19181. 
19182. /* ---------------------------------------------------------- */
19183. # File Select
19184. 	# Select Statments
19185. # File Actions 
19186. 	# Standard or OS File Actions.
19187. 	# Resume...
19188. 	
19189. 	# your stuff HERE (X)... post zone (file) file actions code.
19190. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
19191. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19192. 		# (X)
19193. 		
19194. 		/* ??? Set window? */
19195. 	
19196. 	# ADD THE GAP
19197. 		
19198. # Vacate (good for diagnostics)
19199. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
19200. 
19201. # DoNotVacate - DO NOT Vacate (recommended)
19202. 
19203. # Vacate
19204. /* AddGap(GapUsedLoc) */
19205. 
19206. # DO Not Vacate
19207. AddGap(GapUsedLoc, DoNotVacate) 
19208. 	
19209. 	
19210. /* ---------------------------------------------------------- */
19211. # (failed) TEST for boolean logic.
19212. 
19213. /* It should work in the gap calculations for turning options */
19214. /* on and off but it will NOT work here. */
19215. 
19216. /* Boolean setting X or FlagX. */
19217. /* Where X will be on or off: */
19218. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
19219. /*      For ON:  (X  *  FlagAny) */
19220. 
19221. /* 1) Failed, zero gap overrode the previous one. */
19222. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
19223. /* AddGap(GapUsedTemp) */ 
19224. 
19225. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
19226. /* AddGap(GapUsedTemp, DoNotVacate) */ 
19227. 
19228. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
19229. 
19230. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
19231. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
19232. /* AddGap(GapUsedTemp) */ 
19233. 
19234. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
19235. /* AddGap(GapUsedTemp, DoNotVacate) */ 
19236. 
19237. /* ---------------------------------------------------------- */
19238. 
19239. # Vacate
19240. /* AddGap(GapUsed) */
19241. 
19242. # DO NOT Vacate (recommended)
19243. /* AddGap(GapUsed, DoNotVacate) */ 
19244. 	
19245. 
19246. 		
19247. # 
19248. FileEnd
19249. /* ---------------------------------------------------------- */
19250. 
19251. # your stuff HERE (X)... post zone (file) code.
19252. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
19253. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19254. 	# (X)
19255. 
19256. SetVariable(FileStepDescription,"Zone finished, reporting.")
19257. # FILE STEP
19258. 
19259. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19260. 
19261. /* add message and move to a new line. */
19262. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19263. ")
19264. 
19265. /* display the line. (hopefully.) */
19266. # Zone Footer Set Statistics Window Text
19267. 
19268. SetStatisticsWindowText("----------------------------------------------------------
19269. Zones Processed: 
19270. ----------------------------------------------------------
19271. !ZoneListByLine!
19272. ----------------------------------------------------------
19273. Zone Processing Step:
19274. !ZoneStepByLine!    
19275. ----------------------------------------------------------
19276. Current Zone:
19277. !ZoneFooter!
19278. ----------------------------------------------------------
19279. Volume Statistics:
19280. !VolumeStatisticsDetail!
19281. ----------------------------------------------------------
19282. Zone Detailed Report:
19283. ----------------------------------------------------------
19284. !ZoneStatisticsDetail!
19285. ----------------------------------------------------------
19286. ")
19287. 
19288. 
19289. 
19290. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19291. 
19292. # BANNER SET
19293. 
19294. # DATE TIME RUN ELP
19295. 
19296. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
19297. /* Xinclude "..\Display\BannerSet.MyDc"X */
19298. /* pause(1) */
19299. 
19300. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19301. 
19302. Title('!Heading!')
19303. /* pause(1) */
19304. 
19305. /* NOTE: Can't round or truncate to integer precision. */
19306. 
19307. pause(1)
19308. 
19309. # Zone When Finished
19310. 
19311. # BANNER SET
19312. 
19313. # DATE TIME RUN ELP
19314. 
19315. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
19316. /* Xinclude "..\Display\BannerSet.MyDc"X */
19317. /* pause(1) */
19318. 
19319. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19320. 
19321. Title('!Heading!')
19322. /* pause(1) */
19323. 
19324. /* NOTE: Can't round or truncate to integer precision. */
19325. 
19326. AppendLogfile("!LogFileName!", "!Title!")
19327. 
19328. 
19329. 
19330. # Zone Statistics	
19331. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
19332. 
19333. # Footer:
19334. SetVariable(ZoneFooter, "----------------------------------------------------------
19335. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:56
19336. 
19337. Statistics Report:
19338. ------------------
19339.    Size:  
19340.    ------------------------
19341.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19342.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19343.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19344. 
19345.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19346.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19347. 
19348.    Location:
19349.    ------------------------
19350.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19351.              Files End: !ZoneEndCurrent!
19352.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19353.       
19354.    Gap Settings:
19355.    ------------------------
19356.          Gap Requested: !ZoneGapSizePer!%
19357.       Volume Rounding: !ZoneVolRoundUpPer!%
19358.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19359.                  
19360.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
19361.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
19362.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
19363.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
19364.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
19365.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
19366.      
19367.    Free Space after Zone:
19368.    ------------------------
19369.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19370.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19371.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19372. 
19373. Directory and Files Select:
19374. ---------------------------
19375. !ZoneTypeSelectCurrent!               
19376. ---------------------------
19377. ----------------------------------------------------------
19378. ")
19379. 
19380. AppendLogfile("!LogFileName!", ".")
19381. AppendLogfile("!LogFileName!", "!ZoneFooter!")
19382. AppendLogfile("!LogFileName!", ".")
19383. 
19384. # Zone Footer Set Statistics Window Text
19385. 
19386. SetStatisticsWindowText("----------------------------------------------------------
19387. Zones Processed: 
19388. ----------------------------------------------------------
19389. !ZoneListByLine!
19390. ----------------------------------------------------------
19391. Zone Processing Step:
19392. !ZoneStepByLine!    
19393. ----------------------------------------------------------
19394. Current Zone:
19395. !ZoneFooter!
19396. ----------------------------------------------------------
19397. Volume Statistics:
19398. !VolumeStatisticsDetail!
19399. ----------------------------------------------------------
19400. Zone Detailed Report:
19401. ----------------------------------------------------------
19402. !ZoneStatisticsDetail!
19403. ----------------------------------------------------------
19404. ")
19405. 
19406. 
19407. 
19408. /* pause() */
19409. /* pause() */
19410. 
19411. 
19412. 
19413. 
19414. /* ---------------------------------------------------------- */
19415. 
19416. 
19417. /* ---------------------------------------------------------- */
19418. /* Zone SystemOtherData System Other and Data */
19419. /* ---------------------------------------------------------- */
19420. /* Zone SystemOtherData System Other and Data */
19421. SetVariable(ZoneLabel, "!ZoneLabelSystemOtherData!")
19422. SetVariable(ZoneDescription, "!ZoneDescriptionSystemOtherData!")
19423. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSystemOtherData!")
19424. SetVariable(ZoneGapSize, "!ZoneGapSizeSystemOtherData!")
19425. SetVariable(ZoneTypeSelect,'# SystemOtherData start.
19426. # NotBlobsArchivesBu start.
19427. (not (
19428. # Blobs start.
19429. (
19430. # BlobsAndExceptions start.
19431. ( not(
19432.   FileName("*.bat")
19433.   or FileName("*.css")
19434.   or FileName("*.dll")
19435.   or FileName("*.exe")
19436.   or FileName("*.htm*")
19437.   or FileName("*.jar")
19438.   or FileName("*.js")
19439.   or FileName("*.script")
19440.   or FileName("*.wsf")
19441.   or (
19442. # Databases start.
19443. (
19444.   FileName("*.crypt*")
19445.   or FileName("*.db*")
19446.   or FileName("*.rdb*")
19447.   or FileName("*.dc*")
19448.   or FileName("*.dict*")
19449.   or FileName("*.?db*")
19450.   or FileName("*.?rdb*")
19451.   or FileName("*.md*")
19452.   or FileName("*.myd")
19453.   or FileName("*.ndf")
19454.   or FileName("*.ns?")
19455.   or FileName("*.pab")
19456.   or FileName("*.pst")
19457.   or FileName("*.sd?*")
19458.   or FileName("*.sq**")
19459.   or FileName("*.tmd")
19460.   or FileName("*.tps")
19461.   or FileName("*.tr*")
19462. )
19463. # Databases end.
19464. 
19465.     # BlobsAndExceptions
19466.     or 
19467. # Data start.
19468. (
19469.   DirectoryName("Data*")
19470.   or DirectoryName("Device*")
19471.   or DirectoryName("Export*")
19472.   or DirectoryName("Import*")
19473.   or DirectoryName("Log*")
19474.   or DirectoryName("*Log")
19475.   or DirectoryName("Maintenance*")
19476.   or DirectoryName("Rec*")
19477.   or DirectoryName("Sales*")
19478.   or DirectoryName("Search*")
19479.   or DirectoryName("User*")
19480. )
19481. # Data end.
19482. 
19483.     # BlobsAndExceptions
19484.   )
19485. ) )
19486. # BlobsAndExceptions end.
19487. 
19488. # Blobs
19489. ) and (
19490.   Size(BlobFileSize,0)
19491.   or (
19492.     FileName("*.arj")
19493.     or FileName("*.bup")
19494.     or FileName("*.bz2")
19495.     or FileName("*.chm")
19496.     or FileName("*.dvr-ms")
19497.     or FileName("*.gz")
19498.     or FileName("*.ifo")
19499.     or FileName("*.lzh")
19500.     or FileName("*.pdf")
19501.     or FileName("*.rpm")
19502.     or FileName("*.wmv")
19503.     or FileName("*.vob")
19504.     or FileName("*.z")
19505.   ) 
19506. )
19507. # Blobs end.
19508. 
19509. # NotBlobsArchivesBu
19510. or 
19511. # Archives start.
19512. (
19513.   DirectoryName("*Archive*")
19514.   or DirectoryName("*History*")
19515.   or DirectoryName("*Old")
19516.   or DirectoryName("* Old *")
19517.   or DirectoryName("Old *")
19518. 
19519.   or FileName("*.7z")
19520.   or FileName("*.cab")
19521.   or FileName("*.iso")
19522.   or FileName("*.msi")
19523.   or FileName("*.old")
19524.   or FileName("*.rar")
19525.   or FileName("*.tar")
19526.   or FileName("*.zip")
19527.   or
19528. # WinSysLow start.
19529. (
19530.   DirectoryName("$*")
19531.   or DirectoryName("0*")
19532.   or DirectoryName("1*")
19533.   or DirectoryName("2*")
19534.   or DirectoryName("3*")
19535.   or DirectoryName("4*")
19536.   or DirectoryName("5*")
19537.   or DirectoryName("6*")
19538.   or DirectoryName("7*")
19539.   or DirectoryName("8*")
19540.   or DirectoryName("9*")
19541. 
19542.   or DirectoryName("dllcache")
19543.   or DirectoryName("Downloaded Installations")
19544.   or DirectoryName("Ehome")
19545.   or DirectoryName("Fonts")
19546.   or DirectoryName("Help")
19547.   or DirectoryName("I386")
19548.   or DirectoryName("ie?updates")
19549.   or DirectoryName("Installer")
19550.   or DirectoryName("Installshield Installation Information")
19551.   or DirectoryName("IME")
19552.   or DirectoryName("*RECYCLE*")
19553.   or DirectoryName("ServicePackFiles")
19554.   or DirectoryName("SoftwareDistribution")
19555.   or DirectoryName("Speech")
19556.   or DirectoryName("Symbols")
19557.   or DirectoryName("System Volume Information")
19558.   or DirectoryName("windows.old")
19559. )
19560. # WinSysLow end.
19561. 
19562.   # Archives
19563. )
19564. # Archives end.
19565. 
19566. # NotBlobsArchivesBu
19567. or
19568. # Backups start.
19569. (
19570.   DirectoryName("*Backup*")
19571.   or DirectoryName("*Bu")
19572.   or DirectoryName("* Bu *")
19573.   or DirectoryName("Bu *")
19574. 
19575.   or FileName("*.bak")
19576.   or FileName("* - Copy*")
19577. )
19578. # Backups end.
19579. 
19580. # NotBlobsArchivesBu
19581. ) )
19582. # NotBlobsArchivesBu end.
19583. 
19584. # SystemOtherData
19585. and ( 
19586. # Data start.
19587. (
19588.   DirectoryName("Data*")
19589.   or DirectoryName("Device*")
19590.   or DirectoryName("Export*")
19591.   or DirectoryName("Import*")
19592.   or DirectoryName("Log*")
19593.   or DirectoryName("*Log")
19594.   or DirectoryName("Maintenance*")
19595.   or DirectoryName("Rec*")
19596.   or DirectoryName("Sales*")
19597.   or DirectoryName("Search*")
19598.   or DirectoryName("User*")
19599. )
19600. # Data end.
19601.  
19602. # SystemOtherData
19603. or  
19604. # Databases start.
19605. (
19606.   FileName("*.crypt*")
19607.   or FileName("*.db*")
19608.   or FileName("*.rdb*")
19609.   or FileName("*.dc*")
19610.   or FileName("*.dict*")
19611.   or FileName("*.?db*")
19612.   or FileName("*.?rdb*")
19613.   or FileName("*.md*")
19614.   or FileName("*.myd")
19615.   or FileName("*.ndf")
19616.   or FileName("*.ns?")
19617.   or FileName("*.pab")
19618.   or FileName("*.pst")
19619.   or FileName("*.sd?*")
19620.   or FileName("*.sq**")
19621.   or FileName("*.tmd")
19622.   or FileName("*.tps")
19623.   or FileName("*.tr*")
19624. )
19625. # Databases end.
19626. 
19627. # SystemOtherData
19628. )
19629. # SystemOtherData end.
19630. ')
19631. 
19632. 	# Zone Do Header
19633. 
19634. # Zone When Started
19635. 
19636. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
19637. # Display Set Zone
19638. 
19639. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
19640. SetVariable(FileStepDescription,	"")
19641. 
19642. SetVariable(ZoneStepByLine, 			"Zone started.
19643. ")
19644. 
19645. # BANNER SET
19646. 
19647. # DATE TIME RUN ELP
19648. 
19649. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
19650. /* Xinclude "..\Display\BannerSet.MyDc"X */
19651. /* pause(1) */
19652. 
19653. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19654. 
19655. Title('!Heading!')
19656. /* pause(1) */
19657. 
19658. /* NOTE: Can't round or truncate to integer precision. */
19659. 
19660. AppendLogfile("!LogFileName!", "!Title!")
19661. 
19662. 
19663. 
19664. pause(1)
19665. 
19666. 
19667. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
19668. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
19669. 
19670. SetVariable(ZoneStepNoCurrent, 0)
19671. 
19672. 
19673. # Zone Do Current Clear
19674. 
19675. SetVariable(ZoneTypeSelectCurrent, 		"")
19676. 
19677. SetVariable(ZoneBeginCurrent, 			0)
19678. SetVariable(ZoneBeginPerCurrent, 		0)
19679. SetVariable(ZoneEndCurrent, 			0)
19680. SetVariable(ZoneEndPerCurrent, 			0)
19681. 
19682. SetVariable(ZoneSizeCurrent,			0)
19683. SetVariable(ZoneSizePerCurrent,			0)
19684. 
19685. SetVariable(ZoneGapRequestedCurrent,	0)
19686. SetVariable(ZoneGapRoundedCurrent, 		0)
19687. SetVariable(ZoneGapAdjustedCurrent, 	0)
19688. SetVariable(ZoneGapAvailableCurrent, 	0)
19689. SetVariable(ZoneGapCurrent,				0)
19690. SetVariable(ZoneGapUsedCurrent, 		0)
19691. 
19692. SetVariable(ZoneGapActualCurrent, 		0)
19693. SetVariable(ZoneGapActualPerCurrent, 	0)
19694. 
19695. SetVariable(ZoneSizeActual, 			0)
19696. SetVariable(ZoneSizeActualCurrent,		0)
19697. 
19698. SetVariable(ZoneEndActual, 				0)
19699. SetVariable(ZoneEndActualCurrent,		0)			
19700. SetVariable(ZoneSizeActualPerCurrent, 	0)
19701.       
19702. SetVariable(ZoneFilesFolders,			0)
19703. SetVariable(ZoneFilesFoldersPer,		0) 
19704. 
19705. SetVariable(ZoneFragments,				0)
19706. SetVariable(ZoneFragmentsPer,			0) 
19707. 		
19708. SetVariable(ZoneEndActualCurrent, 		0)
19709. SetVariable(ZoneEndActualPerCurrent, 	0)
19710. 
19711. # Gap Calculation Methodology:
19712. 	# Requested
19713. 	SetVariable(GapRequested, 			0) 
19714. 	SetVariable(GapRequestedStd, 		0) 
19715. 	SetVariable(GapRequestedMft, 		0) 
19716. 	SetVariable(GapRequestedOs, 		0) 
19717. 	SetVariable(GapRequestedOriginal, 	0) 
19718. 	
19719. 	# Gap Adjustments
19720. 	SetVariable(GapRounded, 			0)
19721. 	# SetVariable(GapAdjusted, 			0)
19722. 	SetVariable(GapAvailable, 			0)
19723. 	SetVariable(GapCurrent, 			0)
19724. 	SetVariable(GapActual, 				0)
19725. 	SetVariable(GapUsed, 				0)
19726. 	
19727. 	# Gap Adjustments
19728. 	SetVariable(GapRoundedLoc, 			0)
19729. 	# SetVariable(GapAdjustedLoc, 		0)
19730. 	SetVariable(GapAvailableLoc, 		0)
19731. 	SetVariable(GapCurrentLoc, 			0)
19732. 	SetVariable(GapActualLoc,			0)
19733. 	SetVariable(GapUsedLoc,				0)
19734. 	
19735. 	# Space usage
19736. 	SetVariable(ZoneFreePerRequested, 	0)
19737. 	SetVariable(ZoneFreePerUsed, 		0)
19738. 
19739. # Gap Size & Rounding
19740. 	SetVariable(ZoneGapSizePer, 		0)
19741. 	SetVariable(ZoneVolRoundUpPer, 		0)
19742. 	
19743. 	# Free Space
19744. 	SetVariable(ZoneFreeUsedPer, 		0)
19745. 	SetVariable(ZoneFreeRequestedPer, 	0)
19746. 
19747. 
19748. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
19749. 
19750. # Footer:
19751. SetVariable(ZoneFooter, "----------------------------------------------------------
19752. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:56
19753. 
19754. Statistics Report:
19755. ------------------
19756.    Size:  
19757.    ------------------------
19758.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19759.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19760.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19761. 
19762.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19763.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19764. 
19765.    Location:
19766.    ------------------------
19767.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19768.              Files End: !ZoneEndCurrent!
19769.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19770.       
19771.    Gap Settings:
19772.    ------------------------
19773.          Gap Requested: !ZoneGapSizePer!%
19774.       Volume Rounding: !ZoneVolRoundUpPer!%
19775.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19776.                  
19777.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
19778.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
19779.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
19780.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
19781.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
19782.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
19783.      
19784.    Free Space after Zone:
19785.    ------------------------
19786.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19787.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19788.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19789. 
19790. Directory and Files Select:
19791. ---------------------------
19792. !ZoneTypeSelectCurrent!               
19793. ---------------------------
19794. ----------------------------------------------------------
19795. ")
19796. 
19797. # BANNER SET
19798. 
19799. # DATE TIME RUN ELP
19800. 
19801. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
19802. /* Xinclude "..\Display\BannerSet.MyDc"X */
19803. /* pause(1) */
19804. 
19805. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19806. 
19807. Title('!Heading!')
19808. /* pause(1) */
19809. 
19810. /* NOTE: Can't round or truncate to integer precision. */
19811. 
19812. AppendLogfile("!LogFileName!", "!Title!")
19813. 
19814. 
19815. 
19816. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
19817. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
19818. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:56")
19819. 
19820. SetVariable(ZoneListByLine, "!ZoneListByLine!
19821. Zone: !ZoneNoCurrent! 2021-11-09 10:47:56 0:00:08 !ZoneLabel! !ZoneDescription!")
19822. 
19823. 
19824. /* Fixed Zone Position Handling */
19825. /* Literal number: */
19826. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
19827. /* Percentage of disk: */
19828. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
19829. /* Gap */
19830. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
19831. 
19832. /* ---------------------------------------------------------- */
19833. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
19834. # FILE STEP
19835. 
19836. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19837. 
19838. /* add message and move to a new line. */
19839. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19840. ")
19841. 
19842. /* display the line. (hopefully.) */
19843. # Zone Footer Set Statistics Window Text
19844. 
19845. SetStatisticsWindowText("----------------------------------------------------------
19846. Zones Processed: 
19847. ----------------------------------------------------------
19848. !ZoneListByLine!
19849. ----------------------------------------------------------
19850. Zone Processing Step:
19851. !ZoneStepByLine!    
19852. ----------------------------------------------------------
19853. Current Zone:
19854. !ZoneFooter!
19855. ----------------------------------------------------------
19856. Volume Statistics:
19857. !VolumeStatisticsDetail!
19858. ----------------------------------------------------------
19859. Zone Detailed Report:
19860. ----------------------------------------------------------
19861. !ZoneStatisticsDetail!
19862. ----------------------------------------------------------
19863. ")
19864. 
19865. 
19866. 
19867. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19868. 
19869. # BANNER SET
19870. 
19871. # DATE TIME RUN ELP
19872. 
19873. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
19874. /* Xinclude "..\Display\BannerSet.MyDc"X */
19875. /* pause(1) */
19876. 
19877. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19878. 
19879. Title('!Heading!')
19880. /* pause(1) */
19881. 
19882. /* NOTE: Can't round or truncate to integer precision. */
19883. 
19884. pause(1)
19885. 
19886. # your stuff HERE (X)... pre file select code.
19887. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
19888. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19889. 	# (X)
19890. 
19891. FileSelect
19892. 
19893. 	# your stuff can't really go here (errors.)
19894. 	# maybe for some reason I don't know of...
19895. 	
19896. 	# Actions next...
19897. 	# SystemOtherData start.
19898. # NotBlobsArchivesBu start.
19899. (not (
19900. # Blobs start.
19901. (
19902. # BlobsAndExceptions start.
19903. ( not(
19904.   FileName("*.bat")
19905.   or FileName("*.css")
19906.   or FileName("*.dll")
19907.   or FileName("*.exe")
19908.   or FileName("*.htm*")
19909.   or FileName("*.jar")
19910.   or FileName("*.js")
19911.   or FileName("*.script")
19912.   or FileName("*.wsf")
19913.   or (
19914. # Databases start.
19915. (
19916.   FileName("*.crypt*")
19917.   or FileName("*.db*")
19918.   or FileName("*.rdb*")
19919.   or FileName("*.dc*")
19920.   or FileName("*.dict*")
19921.   or FileName("*.?db*")
19922.   or FileName("*.?rdb*")
19923.   or FileName("*.md*")
19924.   or FileName("*.myd")
19925.   or FileName("*.ndf")
19926.   or FileName("*.ns?")
19927.   or FileName("*.pab")
19928.   or FileName("*.pst")
19929.   or FileName("*.sd?*")
19930.   or FileName("*.sq**")
19931.   or FileName("*.tmd")
19932.   or FileName("*.tps")
19933.   or FileName("*.tr*")
19934. )
19935. # Databases end.
19936. 
19937.     # BlobsAndExceptions
19938.     or 
19939. # Data start.
19940. (
19941.   DirectoryName("Data*")
19942.   or DirectoryName("Device*")
19943.   or DirectoryName("Export*")
19944.   or DirectoryName("Import*")
19945.   or DirectoryName("Log*")
19946.   or DirectoryName("*Log")
19947.   or DirectoryName("Maintenance*")
19948.   or DirectoryName("Rec*")
19949.   or DirectoryName("Sales*")
19950.   or DirectoryName("Search*")
19951.   or DirectoryName("User*")
19952. )
19953. # Data end.
19954. 
19955.     # BlobsAndExceptions
19956.   )
19957. ) )
19958. # BlobsAndExceptions end.
19959. 
19960. # Blobs
19961. ) and (
19962.   Size(BlobFileSize,0)
19963.   or (
19964.     FileName("*.arj")
19965.     or FileName("*.bup")
19966.     or FileName("*.bz2")
19967.     or FileName("*.chm")
19968.     or FileName("*.dvr-ms")
19969.     or FileName("*.gz")
19970.     or FileName("*.ifo")
19971.     or FileName("*.lzh")
19972.     or FileName("*.pdf")
19973.     or FileName("*.rpm")
19974.     or FileName("*.wmv")
19975.     or FileName("*.vob")
19976.     or FileName("*.z")
19977.   ) 
19978. )
19979. # Blobs end.
19980. 
19981. # NotBlobsArchivesBu
19982. or 
19983. # Archives start.
19984. (
19985.   DirectoryName("*Archive*")
19986.   or DirectoryName("*History*")
19987.   or DirectoryName("*Old")
19988.   or DirectoryName("* Old *")
19989.   or DirectoryName("Old *")
19990. 
19991.   or FileName("*.7z")
19992.   or FileName("*.cab")
19993.   or FileName("*.iso")
19994.   or FileName("*.msi")
19995.   or FileName("*.old")
19996.   or FileName("*.rar")
19997.   or FileName("*.tar")
19998.   or FileName("*.zip")
19999.   or
20000. # WinSysLow start.
20001. (
20002.   DirectoryName("$*")
20003.   or DirectoryName("0*")
20004.   or DirectoryName("1*")
20005.   or DirectoryName("2*")
20006.   or DirectoryName("3*")
20007.   or DirectoryName("4*")
20008.   or DirectoryName("5*")
20009.   or DirectoryName("6*")
20010.   or DirectoryName("7*")
20011.   or DirectoryName("8*")
20012.   or DirectoryName("9*")
20013. 
20014.   or DirectoryName("dllcache")
20015.   or DirectoryName("Downloaded Installations")
20016.   or DirectoryName("Ehome")
20017.   or DirectoryName("Fonts")
20018.   or DirectoryName("Help")
20019.   or DirectoryName("I386")
20020.   or DirectoryName("ie?updates")
20021.   or DirectoryName("Installer")
20022.   or DirectoryName("Installshield Installation Information")
20023.   or DirectoryName("IME")
20024.   or DirectoryName("*RECYCLE*")
20025.   or DirectoryName("ServicePackFiles")
20026.   or DirectoryName("SoftwareDistribution")
20027.   or DirectoryName("Speech")
20028.   or DirectoryName("Symbols")
20029.   or DirectoryName("System Volume Information")
20030.   or DirectoryName("windows.old")
20031. )
20032. # WinSysLow end.
20033. 
20034.   # Archives
20035. )
20036. # Archives end.
20037. 
20038. # NotBlobsArchivesBu
20039. or
20040. # Backups start.
20041. (
20042.   DirectoryName("*Backup*")
20043.   or DirectoryName("*Bu")
20044.   or DirectoryName("* Bu *")
20045.   or DirectoryName("Bu *")
20046. 
20047.   or FileName("*.bak")
20048.   or FileName("* - Copy*")
20049. )
20050. # Backups end.
20051. 
20052. # NotBlobsArchivesBu
20053. ) )
20054. # NotBlobsArchivesBu end.
20055. 
20056. # SystemOtherData
20057. and ( 
20058. # Data start.
20059. (
20060.   DirectoryName("Data*")
20061.   or DirectoryName("Device*")
20062.   or DirectoryName("Export*")
20063.   or DirectoryName("Import*")
20064.   or DirectoryName("Log*")
20065.   or DirectoryName("*Log")
20066.   or DirectoryName("Maintenance*")
20067.   or DirectoryName("Rec*")
20068.   or DirectoryName("Sales*")
20069.   or DirectoryName("Search*")
20070.   or DirectoryName("User*")
20071. )
20072. # Data end.
20073.  
20074. # SystemOtherData
20075. or  
20076. # Databases start.
20077. (
20078.   FileName("*.crypt*")
20079.   or FileName("*.db*")
20080.   or FileName("*.rdb*")
20081.   or FileName("*.dc*")
20082.   or FileName("*.dict*")
20083.   or FileName("*.?db*")
20084.   or FileName("*.?rdb*")
20085.   or FileName("*.md*")
20086.   or FileName("*.myd")
20087.   or FileName("*.ndf")
20088.   or FileName("*.ns?")
20089.   or FileName("*.pab")
20090.   or FileName("*.pst")
20091.   or FileName("*.sd?*")
20092.   or FileName("*.sq**")
20093.   or FileName("*.tmd")
20094.   or FileName("*.tps")
20095.   or FileName("*.tr*")
20096. )
20097. # Databases end.
20098. 
20099. # SystemOtherData
20100. )
20101. # SystemOtherData end.
20102. 
20103. 		SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
20104. 
20105. 	# Zone Do Footer
20106. 
20107. /* ---------------------------------------------------------- */
20108. # File Select
20109. 	# Select Statments
20110. # File Actions 
20111. 	# Standard or OS File Actions.
20112. 	# Resume...
20113. 	
20114. 	# your stuff HERE (X)... post zone (file) file actions code.
20115. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
20116. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20117. 		# (X)
20118. 		
20119. 		/* ??? Set window? */
20120. 	
20121. 	# ADD THE GAP
20122. 		
20123. # Vacate (good for diagnostics)
20124. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
20125. 
20126. # DoNotVacate - DO NOT Vacate (recommended)
20127. 
20128. # Vacate
20129. /* AddGap(GapUsedLoc) */
20130. 
20131. # DO Not Vacate
20132. AddGap(GapUsedLoc, DoNotVacate) 
20133. 	
20134. 	
20135. /* ---------------------------------------------------------- */
20136. # (failed) TEST for boolean logic.
20137. 
20138. /* It should work in the gap calculations for turning options */
20139. /* on and off but it will NOT work here. */
20140. 
20141. /* Boolean setting X or FlagX. */
20142. /* Where X will be on or off: */
20143. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
20144. /*      For ON:  (X  *  FlagAny) */
20145. 
20146. /* 1) Failed, zero gap overrode the previous one. */
20147. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
20148. /* AddGap(GapUsedTemp) */ 
20149. 
20150. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
20151. /* AddGap(GapUsedTemp, DoNotVacate) */ 
20152. 
20153. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
20154. 
20155. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
20156. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
20157. /* AddGap(GapUsedTemp) */ 
20158. 
20159. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
20160. /* AddGap(GapUsedTemp, DoNotVacate) */ 
20161. 
20162. /* ---------------------------------------------------------- */
20163. 
20164. # Vacate
20165. /* AddGap(GapUsed) */
20166. 
20167. # DO NOT Vacate (recommended)
20168. /* AddGap(GapUsed, DoNotVacate) */ 
20169. 	
20170. 
20171. 		
20172. # 
20173. FileEnd
20174. /* ---------------------------------------------------------- */
20175. 
20176. # your stuff HERE (X)... post zone (file) code.
20177. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
20178. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20179. 	# (X)
20180. 
20181. SetVariable(FileStepDescription,"Zone finished, reporting.")
20182. # FILE STEP
20183. 
20184. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20185. 
20186. /* add message and move to a new line. */
20187. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20188. ")
20189. 
20190. /* display the line. (hopefully.) */
20191. # Zone Footer Set Statistics Window Text
20192. 
20193. SetStatisticsWindowText("----------------------------------------------------------
20194. Zones Processed: 
20195. ----------------------------------------------------------
20196. !ZoneListByLine!
20197. ----------------------------------------------------------
20198. Zone Processing Step:
20199. !ZoneStepByLine!    
20200. ----------------------------------------------------------
20201. Current Zone:
20202. !ZoneFooter!
20203. ----------------------------------------------------------
20204. Volume Statistics:
20205. !VolumeStatisticsDetail!
20206. ----------------------------------------------------------
20207. Zone Detailed Report:
20208. ----------------------------------------------------------
20209. !ZoneStatisticsDetail!
20210. ----------------------------------------------------------
20211. ")
20212. 
20213. 
20214. 
20215. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20216. 
20217. # BANNER SET
20218. 
20219. # DATE TIME RUN ELP
20220. 
20221. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
20222. /* Xinclude "..\Display\BannerSet.MyDc"X */
20223. /* pause(1) */
20224. 
20225. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20226. 
20227. Title('!Heading!')
20228. /* pause(1) */
20229. 
20230. /* NOTE: Can't round or truncate to integer precision. */
20231. 
20232. pause(1)
20233. 
20234. # Zone When Finished
20235. 
20236. # BANNER SET
20237. 
20238. # DATE TIME RUN ELP
20239. 
20240. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
20241. /* Xinclude "..\Display\BannerSet.MyDc"X */
20242. /* pause(1) */
20243. 
20244. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20245. 
20246. Title('!Heading!')
20247. /* pause(1) */
20248. 
20249. /* NOTE: Can't round or truncate to integer precision. */
20250. 
20251. AppendLogfile("!LogFileName!", "!Title!")
20252. 
20253. 
20254. 
20255. # Zone Statistics	
20256. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
20257. 
20258. # Footer:
20259. SetVariable(ZoneFooter, "----------------------------------------------------------
20260. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:56
20261. 
20262. Statistics Report:
20263. ------------------
20264.    Size:  
20265.    ------------------------
20266.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20267.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20268.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20269. 
20270.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20271.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20272. 
20273.    Location:
20274.    ------------------------
20275.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20276.              Files End: !ZoneEndCurrent!
20277.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20278.       
20279.    Gap Settings:
20280.    ------------------------
20281.          Gap Requested: !ZoneGapSizePer!%
20282.       Volume Rounding: !ZoneVolRoundUpPer!%
20283.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20284.                  
20285.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
20286.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
20287.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
20288.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
20289.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
20290.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
20291.      
20292.    Free Space after Zone:
20293.    ------------------------
20294.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20295.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20296.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20297. 
20298. Directory and Files Select:
20299. ---------------------------
20300. !ZoneTypeSelectCurrent!               
20301. ---------------------------
20302. ----------------------------------------------------------
20303. ")
20304. 
20305. AppendLogfile("!LogFileName!", ".")
20306. AppendLogfile("!LogFileName!", "!ZoneFooter!")
20307. AppendLogfile("!LogFileName!", ".")
20308. 
20309. # Zone Footer Set Statistics Window Text
20310. 
20311. SetStatisticsWindowText("----------------------------------------------------------
20312. Zones Processed: 
20313. ----------------------------------------------------------
20314. !ZoneListByLine!
20315. ----------------------------------------------------------
20316. Zone Processing Step:
20317. !ZoneStepByLine!    
20318. ----------------------------------------------------------
20319. Current Zone:
20320. !ZoneFooter!
20321. ----------------------------------------------------------
20322. Volume Statistics:
20323. !VolumeStatisticsDetail!
20324. ----------------------------------------------------------
20325. Zone Detailed Report:
20326. ----------------------------------------------------------
20327. !ZoneStatisticsDetail!
20328. ----------------------------------------------------------
20329. ")
20330. 
20331. 
20332. 
20333. /* pause() */
20334. /* pause() */
20335. 
20336. 
20337. 
20338. 
20339. /* ---------------------------------------------------------- */
20340. 
20341. 
20342. /* ---------------------------------------------------------- */
20343. /* Zone Reference & World */
20344. /* ---------------------------------------------------------- */
20345. /* Zone Reference & World */
20346. SetVariable(ZoneLabel, "!ZoneLabelReference!")
20347. SetVariable(ZoneDescription, "!ZoneDescriptionReference!")
20348. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpReference!")
20349. SetVariable(ZoneGapSize, "!ZoneGapSizeReference!")
20350. SetVariable(ZoneTypeSelect,'# Reference start.
20351. # NotBlobsArchivesBu start.
20352. (not (
20353. # Blobs start.
20354. (
20355. # BlobsAndExceptions start.
20356. ( not(
20357.   FileName("*.bat")
20358.   or FileName("*.css")
20359.   or FileName("*.dll")
20360.   or FileName("*.exe")
20361.   or FileName("*.htm*")
20362.   or FileName("*.jar")
20363.   or FileName("*.js")
20364.   or FileName("*.script")
20365.   or FileName("*.wsf")
20366.   or (
20367. # Databases start.
20368. (
20369.   FileName("*.crypt*")
20370.   or FileName("*.db*")
20371.   or FileName("*.rdb*")
20372.   or FileName("*.dc*")
20373.   or FileName("*.dict*")
20374.   or FileName("*.?db*")
20375.   or FileName("*.?rdb*")
20376.   or FileName("*.md*")
20377.   or FileName("*.myd")
20378.   or FileName("*.ndf")
20379.   or FileName("*.ns?")
20380.   or FileName("*.pab")
20381.   or FileName("*.pst")
20382.   or FileName("*.sd?*")
20383.   or FileName("*.sq**")
20384.   or FileName("*.tmd")
20385.   or FileName("*.tps")
20386.   or FileName("*.tr*")
20387. )
20388. # Databases end.
20389. 
20390.     # BlobsAndExceptions
20391.     or 
20392. # Data start.
20393. (
20394.   DirectoryName("Data*")
20395.   or DirectoryName("Device*")
20396.   or DirectoryName("Export*")
20397.   or DirectoryName("Import*")
20398.   or DirectoryName("Log*")
20399.   or DirectoryName("*Log")
20400.   or DirectoryName("Maintenance*")
20401.   or DirectoryName("Rec*")
20402.   or DirectoryName("Sales*")
20403.   or DirectoryName("Search*")
20404.   or DirectoryName("User*")
20405. )
20406. # Data end.
20407. 
20408.     # BlobsAndExceptions
20409.   )
20410. ) )
20411. # BlobsAndExceptions end.
20412. 
20413. # Blobs
20414. ) and (
20415.   Size(BlobFileSize,0)
20416.   or (
20417.     FileName("*.arj")
20418.     or FileName("*.bup")
20419.     or FileName("*.bz2")
20420.     or FileName("*.chm")
20421.     or FileName("*.dvr-ms")
20422.     or FileName("*.gz")
20423.     or FileName("*.ifo")
20424.     or FileName("*.lzh")
20425.     or FileName("*.pdf")
20426.     or FileName("*.rpm")
20427.     or FileName("*.wmv")
20428.     or FileName("*.vob")
20429.     or FileName("*.z")
20430.   ) 
20431. )
20432. # Blobs end.
20433. 
20434. # NotBlobsArchivesBu
20435. or 
20436. # Archives start.
20437. (
20438.   DirectoryName("*Archive*")
20439.   or DirectoryName("*History*")
20440.   or DirectoryName("*Old")
20441.   or DirectoryName("* Old *")
20442.   or DirectoryName("Old *")
20443. 
20444.   or FileName("*.7z")
20445.   or FileName("*.cab")
20446.   or FileName("*.iso")
20447.   or FileName("*.msi")
20448.   or FileName("*.old")
20449.   or FileName("*.rar")
20450.   or FileName("*.tar")
20451.   or FileName("*.zip")
20452.   or
20453. # WinSysLow start.
20454. (
20455.   DirectoryName("$*")
20456.   or DirectoryName("0*")
20457.   or DirectoryName("1*")
20458.   or DirectoryName("2*")
20459.   or DirectoryName("3*")
20460.   or DirectoryName("4*")
20461.   or DirectoryName("5*")
20462.   or DirectoryName("6*")
20463.   or DirectoryName("7*")
20464.   or DirectoryName("8*")
20465.   or DirectoryName("9*")
20466. 
20467.   or DirectoryName("dllcache")
20468.   or DirectoryName("Downloaded Installations")
20469.   or DirectoryName("Ehome")
20470.   or DirectoryName("Fonts")
20471.   or DirectoryName("Help")
20472.   or DirectoryName("I386")
20473.   or DirectoryName("ie?updates")
20474.   or DirectoryName("Installer")
20475.   or DirectoryName("Installshield Installation Information")
20476.   or DirectoryName("IME")
20477.   or DirectoryName("*RECYCLE*")
20478.   or DirectoryName("ServicePackFiles")
20479.   or DirectoryName("SoftwareDistribution")
20480.   or DirectoryName("Speech")
20481.   or DirectoryName("Symbols")
20482.   or DirectoryName("System Volume Information")
20483.   or DirectoryName("windows.old")
20484. )
20485. # WinSysLow end.
20486. 
20487.   # Archives
20488. )
20489. # Archives end.
20490. 
20491. # NotBlobsArchivesBu
20492. or
20493. # Backups start.
20494. (
20495.   DirectoryName("*Backup*")
20496.   or DirectoryName("*Bu")
20497.   or DirectoryName("* Bu *")
20498.   or DirectoryName("Bu *")
20499. 
20500.   or FileName("*.bak")
20501.   or FileName("* - Copy*")
20502. )
20503. # Backups end.
20504. 
20505. # NotBlobsArchivesBu
20506. ) )
20507. # NotBlobsArchivesBu end.
20508. 
20509. # Reference
20510. and (
20511. # Reference start.
20512. (
20513.   DirectoryName("World*") or
20514.   DirectoryName("Education*") or
20515.   DirectoryName("Entertainment*") or
20516.   DirectoryName("Food*") or
20517.   DirectoryName("Geography*") or
20518.   DirectoryName("Help*") or
20519.   DirectoryName("Humo*") or
20520.   DirectoryName("Internet*") or
20521.   DirectoryName("Legal*") or
20522.   DirectoryName("Linquistics*") or
20523.   DirectoryName("Media*") or
20524.   DirectoryName("Multimedia*") or
20525.   DirectoryName("Reference*") or
20526.   DirectoryName("Sales*") or
20527.   DirectoryName("Science*") or
20528.   DirectoryName("Social*") or
20529.   DirectoryName("Technology*")
20530. )
20531. # Reference end.
20532. 
20533. # Reference
20534. )
20535. # Reference end.
20536. ')
20537. 
20538. 	# Zone Do Header
20539. 
20540. # Zone When Started
20541. 
20542. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
20543. # Display Set Zone
20544. 
20545. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
20546. SetVariable(FileStepDescription,	"")
20547. 
20548. SetVariable(ZoneStepByLine, 			"Zone started.
20549. ")
20550. 
20551. # BANNER SET
20552. 
20553. # DATE TIME RUN ELP
20554. 
20555. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
20556. /* Xinclude "..\Display\BannerSet.MyDc"X */
20557. /* pause(1) */
20558. 
20559. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20560. 
20561. Title('!Heading!')
20562. /* pause(1) */
20563. 
20564. /* NOTE: Can't round or truncate to integer precision. */
20565. 
20566. AppendLogfile("!LogFileName!", "!Title!")
20567. 
20568. 
20569. 
20570. pause(1)
20571. 
20572. 
20573. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
20574. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
20575. 
20576. SetVariable(ZoneStepNoCurrent, 0)
20577. 
20578. 
20579. # Zone Do Current Clear
20580. 
20581. SetVariable(ZoneTypeSelectCurrent, 		"")
20582. 
20583. SetVariable(ZoneBeginCurrent, 			0)
20584. SetVariable(ZoneBeginPerCurrent, 		0)
20585. SetVariable(ZoneEndCurrent, 			0)
20586. SetVariable(ZoneEndPerCurrent, 			0)
20587. 
20588. SetVariable(ZoneSizeCurrent,			0)
20589. SetVariable(ZoneSizePerCurrent,			0)
20590. 
20591. SetVariable(ZoneGapRequestedCurrent,	0)
20592. SetVariable(ZoneGapRoundedCurrent, 		0)
20593. SetVariable(ZoneGapAdjustedCurrent, 	0)
20594. SetVariable(ZoneGapAvailableCurrent, 	0)
20595. SetVariable(ZoneGapCurrent,				0)
20596. SetVariable(ZoneGapUsedCurrent, 		0)
20597. 
20598. SetVariable(ZoneGapActualCurrent, 		0)
20599. SetVariable(ZoneGapActualPerCurrent, 	0)
20600. 
20601. SetVariable(ZoneSizeActual, 			0)
20602. SetVariable(ZoneSizeActualCurrent,		0)
20603. 
20604. SetVariable(ZoneEndActual, 				0)
20605. SetVariable(ZoneEndActualCurrent,		0)			
20606. SetVariable(ZoneSizeActualPerCurrent, 	0)
20607.       
20608. SetVariable(ZoneFilesFolders,			0)
20609. SetVariable(ZoneFilesFoldersPer,		0) 
20610. 
20611. SetVariable(ZoneFragments,				0)
20612. SetVariable(ZoneFragmentsPer,			0) 
20613. 		
20614. SetVariable(ZoneEndActualCurrent, 		0)
20615. SetVariable(ZoneEndActualPerCurrent, 	0)
20616. 
20617. # Gap Calculation Methodology:
20618. 	# Requested
20619. 	SetVariable(GapRequested, 			0) 
20620. 	SetVariable(GapRequestedStd, 		0) 
20621. 	SetVariable(GapRequestedMft, 		0) 
20622. 	SetVariable(GapRequestedOs, 		0) 
20623. 	SetVariable(GapRequestedOriginal, 	0) 
20624. 	
20625. 	# Gap Adjustments
20626. 	SetVariable(GapRounded, 			0)
20627. 	# SetVariable(GapAdjusted, 			0)
20628. 	SetVariable(GapAvailable, 			0)
20629. 	SetVariable(GapCurrent, 			0)
20630. 	SetVariable(GapActual, 				0)
20631. 	SetVariable(GapUsed, 				0)
20632. 	
20633. 	# Gap Adjustments
20634. 	SetVariable(GapRoundedLoc, 			0)
20635. 	# SetVariable(GapAdjustedLoc, 		0)
20636. 	SetVariable(GapAvailableLoc, 		0)
20637. 	SetVariable(GapCurrentLoc, 			0)
20638. 	SetVariable(GapActualLoc,			0)
20639. 	SetVariable(GapUsedLoc,				0)
20640. 	
20641. 	# Space usage
20642. 	SetVariable(ZoneFreePerRequested, 	0)
20643. 	SetVariable(ZoneFreePerUsed, 		0)
20644. 
20645. # Gap Size & Rounding
20646. 	SetVariable(ZoneGapSizePer, 		0)
20647. 	SetVariable(ZoneVolRoundUpPer, 		0)
20648. 	
20649. 	# Free Space
20650. 	SetVariable(ZoneFreeUsedPer, 		0)
20651. 	SetVariable(ZoneFreeRequestedPer, 	0)
20652. 
20653. 
20654. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
20655. 
20656. # Footer:
20657. SetVariable(ZoneFooter, "----------------------------------------------------------
20658. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:56
20659. 
20660. Statistics Report:
20661. ------------------
20662.    Size:  
20663.    ------------------------
20664.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20665.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20666.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20667. 
20668.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20669.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20670. 
20671.    Location:
20672.    ------------------------
20673.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20674.              Files End: !ZoneEndCurrent!
20675.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20676.       
20677.    Gap Settings:
20678.    ------------------------
20679.          Gap Requested: !ZoneGapSizePer!%
20680.       Volume Rounding: !ZoneVolRoundUpPer!%
20681.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20682.                  
20683.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
20684.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
20685.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
20686.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
20687.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
20688.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
20689.      
20690.    Free Space after Zone:
20691.    ------------------------
20692.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20693.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20694.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20695. 
20696. Directory and Files Select:
20697. ---------------------------
20698. !ZoneTypeSelectCurrent!               
20699. ---------------------------
20700. ----------------------------------------------------------
20701. ")
20702. 
20703. # BANNER SET
20704. 
20705. # DATE TIME RUN ELP
20706. 
20707. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
20708. /* Xinclude "..\Display\BannerSet.MyDc"X */
20709. /* pause(1) */
20710. 
20711. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20712. 
20713. Title('!Heading!')
20714. /* pause(1) */
20715. 
20716. /* NOTE: Can't round or truncate to integer precision. */
20717. 
20718. AppendLogfile("!LogFileName!", "!Title!")
20719. 
20720. 
20721. 
20722. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
20723. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
20724. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:56")
20725. 
20726. SetVariable(ZoneListByLine, "!ZoneListByLine!
20727. Zone: !ZoneNoCurrent! 2021-11-09 10:47:56 0:00:08 !ZoneLabel! !ZoneDescription!")
20728. 
20729. 
20730. /* Fixed Zone Position Handling */
20731. /* Literal number: */
20732. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
20733. /* Percentage of disk: */
20734. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
20735. /* Gap */
20736. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
20737. 
20738. /* ---------------------------------------------------------- */
20739. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
20740. # FILE STEP
20741. 
20742. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20743. 
20744. /* add message and move to a new line. */
20745. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20746. ")
20747. 
20748. /* display the line. (hopefully.) */
20749. # Zone Footer Set Statistics Window Text
20750. 
20751. SetStatisticsWindowText("----------------------------------------------------------
20752. Zones Processed: 
20753. ----------------------------------------------------------
20754. !ZoneListByLine!
20755. ----------------------------------------------------------
20756. Zone Processing Step:
20757. !ZoneStepByLine!    
20758. ----------------------------------------------------------
20759. Current Zone:
20760. !ZoneFooter!
20761. ----------------------------------------------------------
20762. Volume Statistics:
20763. !VolumeStatisticsDetail!
20764. ----------------------------------------------------------
20765. Zone Detailed Report:
20766. ----------------------------------------------------------
20767. !ZoneStatisticsDetail!
20768. ----------------------------------------------------------
20769. ")
20770. 
20771. 
20772. 
20773. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20774. 
20775. # BANNER SET
20776. 
20777. # DATE TIME RUN ELP
20778. 
20779. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
20780. /* Xinclude "..\Display\BannerSet.MyDc"X */
20781. /* pause(1) */
20782. 
20783. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20784. 
20785. Title('!Heading!')
20786. /* pause(1) */
20787. 
20788. /* NOTE: Can't round or truncate to integer precision. */
20789. 
20790. pause(1)
20791. 
20792. # your stuff HERE (X)... pre file select code.
20793. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
20794. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20795. 	# (X)
20796. 
20797. FileSelect
20798. 
20799. 	# your stuff can't really go here (errors.)
20800. 	# maybe for some reason I don't know of...
20801. 	
20802. 	# Actions next...
20803. 	# Reference start.
20804. # NotBlobsArchivesBu start.
20805. (not (
20806. # Blobs start.
20807. (
20808. # BlobsAndExceptions start.
20809. ( not(
20810.   FileName("*.bat")
20811.   or FileName("*.css")
20812.   or FileName("*.dll")
20813.   or FileName("*.exe")
20814.   or FileName("*.htm*")
20815.   or FileName("*.jar")
20816.   or FileName("*.js")
20817.   or FileName("*.script")
20818.   or FileName("*.wsf")
20819.   or (
20820. # Databases start.
20821. (
20822.   FileName("*.crypt*")
20823.   or FileName("*.db*")
20824.   or FileName("*.rdb*")
20825.   or FileName("*.dc*")
20826.   or FileName("*.dict*")
20827.   or FileName("*.?db*")
20828.   or FileName("*.?rdb*")
20829.   or FileName("*.md*")
20830.   or FileName("*.myd")
20831.   or FileName("*.ndf")
20832.   or FileName("*.ns?")
20833.   or FileName("*.pab")
20834.   or FileName("*.pst")
20835.   or FileName("*.sd?*")
20836.   or FileName("*.sq**")
20837.   or FileName("*.tmd")
20838.   or FileName("*.tps")
20839.   or FileName("*.tr*")
20840. )
20841. # Databases end.
20842. 
20843.     # BlobsAndExceptions
20844.     or 
20845. # Data start.
20846. (
20847.   DirectoryName("Data*")
20848.   or DirectoryName("Device*")
20849.   or DirectoryName("Export*")
20850.   or DirectoryName("Import*")
20851.   or DirectoryName("Log*")
20852.   or DirectoryName("*Log")
20853.   or DirectoryName("Maintenance*")
20854.   or DirectoryName("Rec*")
20855.   or DirectoryName("Sales*")
20856.   or DirectoryName("Search*")
20857.   or DirectoryName("User*")
20858. )
20859. # Data end.
20860. 
20861.     # BlobsAndExceptions
20862.   )
20863. ) )
20864. # BlobsAndExceptions end.
20865. 
20866. # Blobs
20867. ) and (
20868.   Size(BlobFileSize,0)
20869.   or (
20870.     FileName("*.arj")
20871.     or FileName("*.bup")
20872.     or FileName("*.bz2")
20873.     or FileName("*.chm")
20874.     or FileName("*.dvr-ms")
20875.     or FileName("*.gz")
20876.     or FileName("*.ifo")
20877.     or FileName("*.lzh")
20878.     or FileName("*.pdf")
20879.     or FileName("*.rpm")
20880.     or FileName("*.wmv")
20881.     or FileName("*.vob")
20882.     or FileName("*.z")
20883.   ) 
20884. )
20885. # Blobs end.
20886. 
20887. # NotBlobsArchivesBu
20888. or 
20889. # Archives start.
20890. (
20891.   DirectoryName("*Archive*")
20892.   or DirectoryName("*History*")
20893.   or DirectoryName("*Old")
20894.   or DirectoryName("* Old *")
20895.   or DirectoryName("Old *")
20896. 
20897.   or FileName("*.7z")
20898.   or FileName("*.cab")
20899.   or FileName("*.iso")
20900.   or FileName("*.msi")
20901.   or FileName("*.old")
20902.   or FileName("*.rar")
20903.   or FileName("*.tar")
20904.   or FileName("*.zip")
20905.   or
20906. # WinSysLow start.
20907. (
20908.   DirectoryName("$*")
20909.   or DirectoryName("0*")
20910.   or DirectoryName("1*")
20911.   or DirectoryName("2*")
20912.   or DirectoryName("3*")
20913.   or DirectoryName("4*")
20914.   or DirectoryName("5*")
20915.   or DirectoryName("6*")
20916.   or DirectoryName("7*")
20917.   or DirectoryName("8*")
20918.   or DirectoryName("9*")
20919. 
20920.   or DirectoryName("dllcache")
20921.   or DirectoryName("Downloaded Installations")
20922.   or DirectoryName("Ehome")
20923.   or DirectoryName("Fonts")
20924.   or DirectoryName("Help")
20925.   or DirectoryName("I386")
20926.   or DirectoryName("ie?updates")
20927.   or DirectoryName("Installer")
20928.   or DirectoryName("Installshield Installation Information")
20929.   or DirectoryName("IME")
20930.   or DirectoryName("*RECYCLE*")
20931.   or DirectoryName("ServicePackFiles")
20932.   or DirectoryName("SoftwareDistribution")
20933.   or DirectoryName("Speech")
20934.   or DirectoryName("Symbols")
20935.   or DirectoryName("System Volume Information")
20936.   or DirectoryName("windows.old")
20937. )
20938. # WinSysLow end.
20939. 
20940.   # Archives
20941. )
20942. # Archives end.
20943. 
20944. # NotBlobsArchivesBu
20945. or
20946. # Backups start.
20947. (
20948.   DirectoryName("*Backup*")
20949.   or DirectoryName("*Bu")
20950.   or DirectoryName("* Bu *")
20951.   or DirectoryName("Bu *")
20952. 
20953.   or FileName("*.bak")
20954.   or FileName("* - Copy*")
20955. )
20956. # Backups end.
20957. 
20958. # NotBlobsArchivesBu
20959. ) )
20960. # NotBlobsArchivesBu end.
20961. 
20962. # Reference
20963. and (
20964. # Reference start.
20965. (
20966.   DirectoryName("World*") or
20967.   DirectoryName("Education*") or
20968.   DirectoryName("Entertainment*") or
20969.   DirectoryName("Food*") or
20970.   DirectoryName("Geography*") or
20971.   DirectoryName("Help*") or
20972.   DirectoryName("Humo*") or
20973.   DirectoryName("Internet*") or
20974.   DirectoryName("Legal*") or
20975.   DirectoryName("Linquistics*") or
20976.   DirectoryName("Media*") or
20977.   DirectoryName("Multimedia*") or
20978.   DirectoryName("Reference*") or
20979.   DirectoryName("Sales*") or
20980.   DirectoryName("Science*") or
20981.   DirectoryName("Social*") or
20982.   DirectoryName("Technology*")
20983. )
20984. # Reference end.
20985. 
20986. # Reference
20987. )
20988. # Reference end.
20989. 
20990. 		SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
20991. 
20992. 	# Zone Do Footer
20993. 
20994. /* ---------------------------------------------------------- */
20995. # File Select
20996. 	# Select Statments
20997. # File Actions 
20998. 	# Standard or OS File Actions.
20999. 	# Resume...
21000. 	
21001. 	# your stuff HERE (X)... post zone (file) file actions code.
21002. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
21003. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21004. 		# (X)
21005. 		
21006. 		/* ??? Set window? */
21007. 	
21008. 	# ADD THE GAP
21009. 		
21010. # Vacate (good for diagnostics)
21011. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
21012. 
21013. # DoNotVacate - DO NOT Vacate (recommended)
21014. 
21015. # Vacate
21016. /* AddGap(GapUsedLoc) */
21017. 
21018. # DO Not Vacate
21019. AddGap(GapUsedLoc, DoNotVacate) 
21020. 	
21021. 	
21022. /* ---------------------------------------------------------- */
21023. # (failed) TEST for boolean logic.
21024. 
21025. /* It should work in the gap calculations for turning options */
21026. /* on and off but it will NOT work here. */
21027. 
21028. /* Boolean setting X or FlagX. */
21029. /* Where X will be on or off: */
21030. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
21031. /*      For ON:  (X  *  FlagAny) */
21032. 
21033. /* 1) Failed, zero gap overrode the previous one. */
21034. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
21035. /* AddGap(GapUsedTemp) */ 
21036. 
21037. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
21038. /* AddGap(GapUsedTemp, DoNotVacate) */ 
21039. 
21040. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
21041. 
21042. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
21043. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
21044. /* AddGap(GapUsedTemp) */ 
21045. 
21046. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
21047. /* AddGap(GapUsedTemp, DoNotVacate) */ 
21048. 
21049. /* ---------------------------------------------------------- */
21050. 
21051. # Vacate
21052. /* AddGap(GapUsed) */
21053. 
21054. # DO NOT Vacate (recommended)
21055. /* AddGap(GapUsed, DoNotVacate) */ 
21056. 	
21057. 
21058. 		
21059. # 
21060. FileEnd
21061. /* ---------------------------------------------------------- */
21062. 
21063. # your stuff HERE (X)... post zone (file) code.
21064. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
21065. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21066. 	# (X)
21067. 
21068. SetVariable(FileStepDescription,"Zone finished, reporting.")
21069. # FILE STEP
21070. 
21071. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21072. 
21073. /* add message and move to a new line. */
21074. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21075. ")
21076. 
21077. /* display the line. (hopefully.) */
21078. # Zone Footer Set Statistics Window Text
21079. 
21080. SetStatisticsWindowText("----------------------------------------------------------
21081. Zones Processed: 
21082. ----------------------------------------------------------
21083. !ZoneListByLine!
21084. ----------------------------------------------------------
21085. Zone Processing Step:
21086. !ZoneStepByLine!    
21087. ----------------------------------------------------------
21088. Current Zone:
21089. !ZoneFooter!
21090. ----------------------------------------------------------
21091. Volume Statistics:
21092. !VolumeStatisticsDetail!
21093. ----------------------------------------------------------
21094. Zone Detailed Report:
21095. ----------------------------------------------------------
21096. !ZoneStatisticsDetail!
21097. ----------------------------------------------------------
21098. ")
21099. 
21100. 
21101. 
21102. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21103. 
21104. # BANNER SET
21105. 
21106. # DATE TIME RUN ELP
21107. 
21108. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
21109. /* Xinclude "..\Display\BannerSet.MyDc"X */
21110. /* pause(1) */
21111. 
21112. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21113. 
21114. Title('!Heading!')
21115. /* pause(1) */
21116. 
21117. /* NOTE: Can't round or truncate to integer precision. */
21118. 
21119. pause(1)
21120. 
21121. # Zone When Finished
21122. 
21123. # BANNER SET
21124. 
21125. # DATE TIME RUN ELP
21126. 
21127. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
21128. /* Xinclude "..\Display\BannerSet.MyDc"X */
21129. /* pause(1) */
21130. 
21131. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21132. 
21133. Title('!Heading!')
21134. /* pause(1) */
21135. 
21136. /* NOTE: Can't round or truncate to integer precision. */
21137. 
21138. AppendLogfile("!LogFileName!", "!Title!")
21139. 
21140. 
21141. 
21142. # Zone Statistics	
21143. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
21144. 
21145. # Footer:
21146. SetVariable(ZoneFooter, "----------------------------------------------------------
21147. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:56
21148. 
21149. Statistics Report:
21150. ------------------
21151.    Size:  
21152.    ------------------------
21153.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21154.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21155.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21156. 
21157.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21158.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21159. 
21160.    Location:
21161.    ------------------------
21162.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21163.              Files End: !ZoneEndCurrent!
21164.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21165.       
21166.    Gap Settings:
21167.    ------------------------
21168.          Gap Requested: !ZoneGapSizePer!%
21169.       Volume Rounding: !ZoneVolRoundUpPer!%
21170.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21171.                  
21172.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
21173.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
21174.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
21175.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
21176.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
21177.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
21178.      
21179.    Free Space after Zone:
21180.    ------------------------
21181.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21182.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21183.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21184. 
21185. Directory and Files Select:
21186. ---------------------------
21187. !ZoneTypeSelectCurrent!               
21188. ---------------------------
21189. ----------------------------------------------------------
21190. ")
21191. 
21192. AppendLogfile("!LogFileName!", ".")
21193. AppendLogfile("!LogFileName!", "!ZoneFooter!")
21194. AppendLogfile("!LogFileName!", ".")
21195. 
21196. # Zone Footer Set Statistics Window Text
21197. 
21198. SetStatisticsWindowText("----------------------------------------------------------
21199. Zones Processed: 
21200. ----------------------------------------------------------
21201. !ZoneListByLine!
21202. ----------------------------------------------------------
21203. Zone Processing Step:
21204. !ZoneStepByLine!    
21205. ----------------------------------------------------------
21206. Current Zone:
21207. !ZoneFooter!
21208. ----------------------------------------------------------
21209. Volume Statistics:
21210. !VolumeStatisticsDetail!
21211. ----------------------------------------------------------
21212. Zone Detailed Report:
21213. ----------------------------------------------------------
21214. !ZoneStatisticsDetail!
21215. ----------------------------------------------------------
21216. ")
21217. 
21218. 
21219. 
21220. /* pause() */
21221. /* pause() */
21222. 
21223. 
21224. 
21225. 
21226. /* ---------------------------------------------------------- */
21227. 
21228. 
21229. /* ---------------------------------------------------------- */
21230. /* Zone SpaceHogs (BLOBS) */
21231. /* ---------------------------------------------------------- */
21232. /* Zone SpaceHogs (BLOBS) */
21233. SetVariable(ZoneLabel, "!ZoneLabelSpaceHogs!")
21234. SetVariable(ZoneDescription, "!ZoneDescriptionSpaceHogs!")
21235. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSpaceHogs!")
21236. SetVariable(ZoneGapSize, "!ZoneGapSizeSpaceHogs!")
21237. SetVariable(ZoneTypeSelect,'# SpaceHogs start.
21238. not(
21239. # Archives start.
21240. (
21241.   DirectoryName("*Archive*")
21242.   or DirectoryName("*History*")
21243.   or DirectoryName("*Old")
21244.   or DirectoryName("* Old *")
21245.   or DirectoryName("Old *")
21246. 
21247.   or FileName("*.7z")
21248.   or FileName("*.cab")
21249.   or FileName("*.iso")
21250.   or FileName("*.msi")
21251.   or FileName("*.old")
21252.   or FileName("*.rar")
21253.   or FileName("*.tar")
21254.   or FileName("*.zip")
21255.   or
21256. # WinSysLow start.
21257. (
21258.   DirectoryName("$*")
21259.   or DirectoryName("0*")
21260.   or DirectoryName("1*")
21261.   or DirectoryName("2*")
21262.   or DirectoryName("3*")
21263.   or DirectoryName("4*")
21264.   or DirectoryName("5*")
21265.   or DirectoryName("6*")
21266.   or DirectoryName("7*")
21267.   or DirectoryName("8*")
21268.   or DirectoryName("9*")
21269. 
21270.   or DirectoryName("dllcache")
21271.   or DirectoryName("Downloaded Installations")
21272.   or DirectoryName("Ehome")
21273.   or DirectoryName("Fonts")
21274.   or DirectoryName("Help")
21275.   or DirectoryName("I386")
21276.   or DirectoryName("ie?updates")
21277.   or DirectoryName("Installer")
21278.   or DirectoryName("Installshield Installation Information")
21279.   or DirectoryName("IME")
21280.   or DirectoryName("*RECYCLE*")
21281.   or DirectoryName("ServicePackFiles")
21282.   or DirectoryName("SoftwareDistribution")
21283.   or DirectoryName("Speech")
21284.   or DirectoryName("Symbols")
21285.   or DirectoryName("System Volume Information")
21286.   or DirectoryName("windows.old")
21287. )
21288. # WinSysLow end.
21289. 
21290.   # Archives
21291. )
21292. # Archives end.
21293. 
21294. or 
21295. # Backups start.
21296. (
21297.   DirectoryName("*Backup*")
21298.   or DirectoryName("*Bu")
21299.   or DirectoryName("* Bu *")
21300.   or DirectoryName("Bu *")
21301. 
21302.   or FileName("*.bak")
21303.   or FileName("* - Copy*")
21304. )
21305. # Backups end.
21306. 
21307. # SpaceHogs
21308. ) and (
21309. # Blobs start.
21310. (
21311. # BlobsAndExceptions start.
21312. ( not(
21313.   FileName("*.bat")
21314.   or FileName("*.css")
21315.   or FileName("*.dll")
21316.   or FileName("*.exe")
21317.   or FileName("*.htm*")
21318.   or FileName("*.jar")
21319.   or FileName("*.js")
21320.   or FileName("*.script")
21321.   or FileName("*.wsf")
21322.   or (
21323. # Databases start.
21324. (
21325.   FileName("*.crypt*")
21326.   or FileName("*.db*")
21327.   or FileName("*.rdb*")
21328.   or FileName("*.dc*")
21329.   or FileName("*.dict*")
21330.   or FileName("*.?db*")
21331.   or FileName("*.?rdb*")
21332.   or FileName("*.md*")
21333.   or FileName("*.myd")
21334.   or FileName("*.ndf")
21335.   or FileName("*.ns?")
21336.   or FileName("*.pab")
21337.   or FileName("*.pst")
21338.   or FileName("*.sd?*")
21339.   or FileName("*.sq**")
21340.   or FileName("*.tmd")
21341.   or FileName("*.tps")
21342.   or FileName("*.tr*")
21343. )
21344. # Databases end.
21345. 
21346.     # BlobsAndExceptions
21347.     or 
21348. # Data start.
21349. (
21350.   DirectoryName("Data*")
21351.   or DirectoryName("Device*")
21352.   or DirectoryName("Export*")
21353.   or DirectoryName("Import*")
21354.   or DirectoryName("Log*")
21355.   or DirectoryName("*Log")
21356.   or DirectoryName("Maintenance*")
21357.   or DirectoryName("Rec*")
21358.   or DirectoryName("Sales*")
21359.   or DirectoryName("Search*")
21360.   or DirectoryName("User*")
21361. )
21362. # Data end.
21363. 
21364.     # BlobsAndExceptions
21365.   )
21366. ) )
21367. # BlobsAndExceptions end.
21368. 
21369. # Blobs
21370. ) and (
21371.   Size(BlobFileSize,0)
21372.   or (
21373.     FileName("*.arj")
21374.     or FileName("*.bup")
21375.     or FileName("*.bz2")
21376.     or FileName("*.chm")
21377.     or FileName("*.dvr-ms")
21378.     or FileName("*.gz")
21379.     or FileName("*.ifo")
21380.     or FileName("*.lzh")
21381.     or FileName("*.pdf")
21382.     or FileName("*.rpm")
21383.     or FileName("*.wmv")
21384.     or FileName("*.vob")
21385.     or FileName("*.z")
21386.   ) 
21387. )
21388. # Blobs end.
21389. 
21390. # SpaceHogs
21391. ) 
21392. # SpaceHogs end.
21393. ')
21394. 
21395. /* Note: This should be all Blob Files but not archives and backups */
21396. /* It does not matter in my case because given the sorting the */
21397. /* "z Archive", "z Bu" and "z Backup" directories sort to the end. */
21398. 
21399. 	# Zone Do Header
21400. 
21401. # Zone When Started
21402. 
21403. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
21404. # Display Set Zone
21405. 
21406. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
21407. SetVariable(FileStepDescription,	"")
21408. 
21409. SetVariable(ZoneStepByLine, 			"Zone started.
21410. ")
21411. 
21412. # BANNER SET
21413. 
21414. # DATE TIME RUN ELP
21415. 
21416. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
21417. /* Xinclude "..\Display\BannerSet.MyDc"X */
21418. /* pause(1) */
21419. 
21420. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21421. 
21422. Title('!Heading!')
21423. /* pause(1) */
21424. 
21425. /* NOTE: Can't round or truncate to integer precision. */
21426. 
21427. AppendLogfile("!LogFileName!", "!Title!")
21428. 
21429. 
21430. 
21431. pause(1)
21432. 
21433. 
21434. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
21435. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
21436. 
21437. SetVariable(ZoneStepNoCurrent, 0)
21438. 
21439. 
21440. # Zone Do Current Clear
21441. 
21442. SetVariable(ZoneTypeSelectCurrent, 		"")
21443. 
21444. SetVariable(ZoneBeginCurrent, 			0)
21445. SetVariable(ZoneBeginPerCurrent, 		0)
21446. SetVariable(ZoneEndCurrent, 			0)
21447. SetVariable(ZoneEndPerCurrent, 			0)
21448. 
21449. SetVariable(ZoneSizeCurrent,			0)
21450. SetVariable(ZoneSizePerCurrent,			0)
21451. 
21452. SetVariable(ZoneGapRequestedCurrent,	0)
21453. SetVariable(ZoneGapRoundedCurrent, 		0)
21454. SetVariable(ZoneGapAdjustedCurrent, 	0)
21455. SetVariable(ZoneGapAvailableCurrent, 	0)
21456. SetVariable(ZoneGapCurrent,				0)
21457. SetVariable(ZoneGapUsedCurrent, 		0)
21458. 
21459. SetVariable(ZoneGapActualCurrent, 		0)
21460. SetVariable(ZoneGapActualPerCurrent, 	0)
21461. 
21462. SetVariable(ZoneSizeActual, 			0)
21463. SetVariable(ZoneSizeActualCurrent,		0)
21464. 
21465. SetVariable(ZoneEndActual, 				0)
21466. SetVariable(ZoneEndActualCurrent,		0)			
21467. SetVariable(ZoneSizeActualPerCurrent, 	0)
21468.       
21469. SetVariable(ZoneFilesFolders,			0)
21470. SetVariable(ZoneFilesFoldersPer,		0) 
21471. 
21472. SetVariable(ZoneFragments,				0)
21473. SetVariable(ZoneFragmentsPer,			0) 
21474. 		
21475. SetVariable(ZoneEndActualCurrent, 		0)
21476. SetVariable(ZoneEndActualPerCurrent, 	0)
21477. 
21478. # Gap Calculation Methodology:
21479. 	# Requested
21480. 	SetVariable(GapRequested, 			0) 
21481. 	SetVariable(GapRequestedStd, 		0) 
21482. 	SetVariable(GapRequestedMft, 		0) 
21483. 	SetVariable(GapRequestedOs, 		0) 
21484. 	SetVariable(GapRequestedOriginal, 	0) 
21485. 	
21486. 	# Gap Adjustments
21487. 	SetVariable(GapRounded, 			0)
21488. 	# SetVariable(GapAdjusted, 			0)
21489. 	SetVariable(GapAvailable, 			0)
21490. 	SetVariable(GapCurrent, 			0)
21491. 	SetVariable(GapActual, 				0)
21492. 	SetVariable(GapUsed, 				0)
21493. 	
21494. 	# Gap Adjustments
21495. 	SetVariable(GapRoundedLoc, 			0)
21496. 	# SetVariable(GapAdjustedLoc, 		0)
21497. 	SetVariable(GapAvailableLoc, 		0)
21498. 	SetVariable(GapCurrentLoc, 			0)
21499. 	SetVariable(GapActualLoc,			0)
21500. 	SetVariable(GapUsedLoc,				0)
21501. 	
21502. 	# Space usage
21503. 	SetVariable(ZoneFreePerRequested, 	0)
21504. 	SetVariable(ZoneFreePerUsed, 		0)
21505. 
21506. # Gap Size & Rounding
21507. 	SetVariable(ZoneGapSizePer, 		0)
21508. 	SetVariable(ZoneVolRoundUpPer, 		0)
21509. 	
21510. 	# Free Space
21511. 	SetVariable(ZoneFreeUsedPer, 		0)
21512. 	SetVariable(ZoneFreeRequestedPer, 	0)
21513. 
21514. 
21515. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
21516. 
21517. # Footer:
21518. SetVariable(ZoneFooter, "----------------------------------------------------------
21519. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:56
21520. 
21521. Statistics Report:
21522. ------------------
21523.    Size:  
21524.    ------------------------
21525.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21526.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21527.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21528. 
21529.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21530.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21531. 
21532.    Location:
21533.    ------------------------
21534.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21535.              Files End: !ZoneEndCurrent!
21536.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21537.       
21538.    Gap Settings:
21539.    ------------------------
21540.          Gap Requested: !ZoneGapSizePer!%
21541.       Volume Rounding: !ZoneVolRoundUpPer!%
21542.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21543.                  
21544.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
21545.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
21546.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
21547.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
21548.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
21549.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
21550.      
21551.    Free Space after Zone:
21552.    ------------------------
21553.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21554.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21555.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21556. 
21557. Directory and Files Select:
21558. ---------------------------
21559. !ZoneTypeSelectCurrent!               
21560. ---------------------------
21561. ----------------------------------------------------------
21562. ")
21563. 
21564. # BANNER SET
21565. 
21566. # DATE TIME RUN ELP
21567. 
21568. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
21569. /* Xinclude "..\Display\BannerSet.MyDc"X */
21570. /* pause(1) */
21571. 
21572. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21573. 
21574. Title('!Heading!')
21575. /* pause(1) */
21576. 
21577. /* NOTE: Can't round or truncate to integer precision. */
21578. 
21579. AppendLogfile("!LogFileName!", "!Title!")
21580. 
21581. 
21582. 
21583. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
21584. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
21585. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:56")
21586. 
21587. SetVariable(ZoneListByLine, "!ZoneListByLine!
21588. Zone: !ZoneNoCurrent! 2021-11-09 10:47:56 0:00:08 !ZoneLabel! !ZoneDescription!")
21589. 
21590. 
21591. /* Fixed Zone Position Handling */
21592. /* Literal number: */
21593. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
21594. /* Percentage of disk: */
21595. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
21596. /* Gap */
21597. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
21598. 
21599. /* ---------------------------------------------------------- */
21600. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
21601. # FILE STEP
21602. 
21603. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21604. 
21605. /* add message and move to a new line. */
21606. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21607. ")
21608. 
21609. /* display the line. (hopefully.) */
21610. # Zone Footer Set Statistics Window Text
21611. 
21612. SetStatisticsWindowText("----------------------------------------------------------
21613. Zones Processed: 
21614. ----------------------------------------------------------
21615. !ZoneListByLine!
21616. ----------------------------------------------------------
21617. Zone Processing Step:
21618. !ZoneStepByLine!    
21619. ----------------------------------------------------------
21620. Current Zone:
21621. !ZoneFooter!
21622. ----------------------------------------------------------
21623. Volume Statistics:
21624. !VolumeStatisticsDetail!
21625. ----------------------------------------------------------
21626. Zone Detailed Report:
21627. ----------------------------------------------------------
21628. !ZoneStatisticsDetail!
21629. ----------------------------------------------------------
21630. ")
21631. 
21632. 
21633. 
21634. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21635. 
21636. # BANNER SET
21637. 
21638. # DATE TIME RUN ELP
21639. 
21640. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
21641. /* Xinclude "..\Display\BannerSet.MyDc"X */
21642. /* pause(1) */
21643. 
21644. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21645. 
21646. Title('!Heading!')
21647. /* pause(1) */
21648. 
21649. /* NOTE: Can't round or truncate to integer precision. */
21650. 
21651. pause(1)
21652. 
21653. # your stuff HERE (X)... pre file select code.
21654. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
21655. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21656. 	# (X)
21657. 
21658. FileSelect
21659. 
21660. 	# your stuff can't really go here (errors.)
21661. 	# maybe for some reason I don't know of...
21662. 	
21663. 	# Actions next...
21664. 	# SpaceHogs start.
21665. not(
21666. # Archives start.
21667. (
21668.   DirectoryName("*Archive*")
21669.   or DirectoryName("*History*")
21670.   or DirectoryName("*Old")
21671.   or DirectoryName("* Old *")
21672.   or DirectoryName("Old *")
21673. 
21674.   or FileName("*.7z")
21675.   or FileName("*.cab")
21676.   or FileName("*.iso")
21677.   or FileName("*.msi")
21678.   or FileName("*.old")
21679.   or FileName("*.rar")
21680.   or FileName("*.tar")
21681.   or FileName("*.zip")
21682.   or
21683. # WinSysLow start.
21684. (
21685.   DirectoryName("$*")
21686.   or DirectoryName("0*")
21687.   or DirectoryName("1*")
21688.   or DirectoryName("2*")
21689.   or DirectoryName("3*")
21690.   or DirectoryName("4*")
21691.   or DirectoryName("5*")
21692.   or DirectoryName("6*")
21693.   or DirectoryName("7*")
21694.   or DirectoryName("8*")
21695.   or DirectoryName("9*")
21696. 
21697.   or DirectoryName("dllcache")
21698.   or DirectoryName("Downloaded Installations")
21699.   or DirectoryName("Ehome")
21700.   or DirectoryName("Fonts")
21701.   or DirectoryName("Help")
21702.   or DirectoryName("I386")
21703.   or DirectoryName("ie?updates")
21704.   or DirectoryName("Installer")
21705.   or DirectoryName("Installshield Installation Information")
21706.   or DirectoryName("IME")
21707.   or DirectoryName("*RECYCLE*")
21708.   or DirectoryName("ServicePackFiles")
21709.   or DirectoryName("SoftwareDistribution")
21710.   or DirectoryName("Speech")
21711.   or DirectoryName("Symbols")
21712.   or DirectoryName("System Volume Information")
21713.   or DirectoryName("windows.old")
21714. )
21715. # WinSysLow end.
21716. 
21717.   # Archives
21718. )
21719. # Archives end.
21720. 
21721. or 
21722. # Backups start.
21723. (
21724.   DirectoryName("*Backup*")
21725.   or DirectoryName("*Bu")
21726.   or DirectoryName("* Bu *")
21727.   or DirectoryName("Bu *")
21728. 
21729.   or FileName("*.bak")
21730.   or FileName("* - Copy*")
21731. )
21732. # Backups end.
21733. 
21734. # SpaceHogs
21735. ) and (
21736. # Blobs start.
21737. (
21738. # BlobsAndExceptions start.
21739. ( not(
21740.   FileName("*.bat")
21741.   or FileName("*.css")
21742.   or FileName("*.dll")
21743.   or FileName("*.exe")
21744.   or FileName("*.htm*")
21745.   or FileName("*.jar")
21746.   or FileName("*.js")
21747.   or FileName("*.script")
21748.   or FileName("*.wsf")
21749.   or (
21750. # Databases start.
21751. (
21752.   FileName("*.crypt*")
21753.   or FileName("*.db*")
21754.   or FileName("*.rdb*")
21755.   or FileName("*.dc*")
21756.   or FileName("*.dict*")
21757.   or FileName("*.?db*")
21758.   or FileName("*.?rdb*")
21759.   or FileName("*.md*")
21760.   or FileName("*.myd")
21761.   or FileName("*.ndf")
21762.   or FileName("*.ns?")
21763.   or FileName("*.pab")
21764.   or FileName("*.pst")
21765.   or FileName("*.sd?*")
21766.   or FileName("*.sq**")
21767.   or FileName("*.tmd")
21768.   or FileName("*.tps")
21769.   or FileName("*.tr*")
21770. )
21771. # Databases end.
21772. 
21773.     # BlobsAndExceptions
21774.     or 
21775. # Data start.
21776. (
21777.   DirectoryName("Data*")
21778.   or DirectoryName("Device*")
21779.   or DirectoryName("Export*")
21780.   or DirectoryName("Import*")
21781.   or DirectoryName("Log*")
21782.   or DirectoryName("*Log")
21783.   or DirectoryName("Maintenance*")
21784.   or DirectoryName("Rec*")
21785.   or DirectoryName("Sales*")
21786.   or DirectoryName("Search*")
21787.   or DirectoryName("User*")
21788. )
21789. # Data end.
21790. 
21791.     # BlobsAndExceptions
21792.   )
21793. ) )
21794. # BlobsAndExceptions end.
21795. 
21796. # Blobs
21797. ) and (
21798.   Size(BlobFileSize,0)
21799.   or (
21800.     FileName("*.arj")
21801.     or FileName("*.bup")
21802.     or FileName("*.bz2")
21803.     or FileName("*.chm")
21804.     or FileName("*.dvr-ms")
21805.     or FileName("*.gz")
21806.     or FileName("*.ifo")
21807.     or FileName("*.lzh")
21808.     or FileName("*.pdf")
21809.     or FileName("*.rpm")
21810.     or FileName("*.wmv")
21811.     or FileName("*.vob")
21812.     or FileName("*.z")
21813.   ) 
21814. )
21815. # Blobs end.
21816. 
21817. # SpaceHogs
21818. ) 
21819. # SpaceHogs end.
21820. 
21821. 		SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
21822. 
21823. 	# Zone Do Footer
21824. 
21825. /* ---------------------------------------------------------- */
21826. # File Select
21827. 	# Select Statments
21828. # File Actions 
21829. 	# Standard or OS File Actions.
21830. 	# Resume...
21831. 	
21832. 	# your stuff HERE (X)... post zone (file) file actions code.
21833. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
21834. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21835. 		# (X)
21836. 		
21837. 		/* ??? Set window? */
21838. 	
21839. 	# ADD THE GAP
21840. 		
21841. # Vacate (good for diagnostics)
21842. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
21843. 
21844. # DoNotVacate - DO NOT Vacate (recommended)
21845. 
21846. # Vacate
21847. /* AddGap(GapUsedLoc) */
21848. 
21849. # DO Not Vacate
21850. AddGap(GapUsedLoc, DoNotVacate) 
21851. 	
21852. 	
21853. /* ---------------------------------------------------------- */
21854. # (failed) TEST for boolean logic.
21855. 
21856. /* It should work in the gap calculations for turning options */
21857. /* on and off but it will NOT work here. */
21858. 
21859. /* Boolean setting X or FlagX. */
21860. /* Where X will be on or off: */
21861. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
21862. /*      For ON:  (X  *  FlagAny) */
21863. 
21864. /* 1) Failed, zero gap overrode the previous one. */
21865. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
21866. /* AddGap(GapUsedTemp) */ 
21867. 
21868. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
21869. /* AddGap(GapUsedTemp, DoNotVacate) */ 
21870. 
21871. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
21872. 
21873. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
21874. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
21875. /* AddGap(GapUsedTemp) */ 
21876. 
21877. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
21878. /* AddGap(GapUsedTemp, DoNotVacate) */ 
21879. 
21880. /* ---------------------------------------------------------- */
21881. 
21882. # Vacate
21883. /* AddGap(GapUsed) */
21884. 
21885. # DO NOT Vacate (recommended)
21886. /* AddGap(GapUsed, DoNotVacate) */ 
21887. 	
21888. 
21889. 		
21890. # 
21891. FileEnd
21892. /* ---------------------------------------------------------- */
21893. 
21894. # your stuff HERE (X)... post zone (file) code.
21895. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
21896. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21897. 	# (X)
21898. 
21899. SetVariable(FileStepDescription,"Zone finished, reporting.")
21900. # FILE STEP
21901. 
21902. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21903. 
21904. /* add message and move to a new line. */
21905. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21906. ")
21907. 
21908. /* display the line. (hopefully.) */
21909. # Zone Footer Set Statistics Window Text
21910. 
21911. SetStatisticsWindowText("----------------------------------------------------------
21912. Zones Processed: 
21913. ----------------------------------------------------------
21914. !ZoneListByLine!
21915. ----------------------------------------------------------
21916. Zone Processing Step:
21917. !ZoneStepByLine!    
21918. ----------------------------------------------------------
21919. Current Zone:
21920. !ZoneFooter!
21921. ----------------------------------------------------------
21922. Volume Statistics:
21923. !VolumeStatisticsDetail!
21924. ----------------------------------------------------------
21925. Zone Detailed Report:
21926. ----------------------------------------------------------
21927. !ZoneStatisticsDetail!
21928. ----------------------------------------------------------
21929. ")
21930. 
21931. 
21932. 
21933. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21934. 
21935. # BANNER SET
21936. 
21937. # DATE TIME RUN ELP
21938. 
21939. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
21940. /* Xinclude "..\Display\BannerSet.MyDc"X */
21941. /* pause(1) */
21942. 
21943. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21944. 
21945. Title('!Heading!')
21946. /* pause(1) */
21947. 
21948. /* NOTE: Can't round or truncate to integer precision. */
21949. 
21950. pause(1)
21951. 
21952. # Zone When Finished
21953. 
21954. # BANNER SET
21955. 
21956. # DATE TIME RUN ELP
21957. 
21958. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
21959. /* Xinclude "..\Display\BannerSet.MyDc"X */
21960. /* pause(1) */
21961. 
21962. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21963. 
21964. Title('!Heading!')
21965. /* pause(1) */
21966. 
21967. /* NOTE: Can't round or truncate to integer precision. */
21968. 
21969. AppendLogfile("!LogFileName!", "!Title!")
21970. 
21971. 
21972. 
21973. # Zone Statistics	
21974. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
21975. 
21976. # Footer:
21977. SetVariable(ZoneFooter, "----------------------------------------------------------
21978. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:56
21979. 
21980. Statistics Report:
21981. ------------------
21982.    Size:  
21983.    ------------------------
21984.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21985.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21986.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21987. 
21988.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21989.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21990. 
21991.    Location:
21992.    ------------------------
21993.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21994.              Files End: !ZoneEndCurrent!
21995.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21996.       
21997.    Gap Settings:
21998.    ------------------------
21999.          Gap Requested: !ZoneGapSizePer!%
22000.       Volume Rounding: !ZoneVolRoundUpPer!%
22001.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22002.                  
22003.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22004.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22005.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22006.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22007.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22008.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22009.      
22010.    Free Space after Zone:
22011.    ------------------------
22012.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22013.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22014.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22015. 
22016. Directory and Files Select:
22017. ---------------------------
22018. !ZoneTypeSelectCurrent!               
22019. ---------------------------
22020. ----------------------------------------------------------
22021. ")
22022. 
22023. AppendLogfile("!LogFileName!", ".")
22024. AppendLogfile("!LogFileName!", "!ZoneFooter!")
22025. AppendLogfile("!LogFileName!", ".")
22026. 
22027. # Zone Footer Set Statistics Window Text
22028. 
22029. SetStatisticsWindowText("----------------------------------------------------------
22030. Zones Processed: 
22031. ----------------------------------------------------------
22032. !ZoneListByLine!
22033. ----------------------------------------------------------
22034. Zone Processing Step:
22035. !ZoneStepByLine!    
22036. ----------------------------------------------------------
22037. Current Zone:
22038. !ZoneFooter!
22039. ----------------------------------------------------------
22040. Volume Statistics:
22041. !VolumeStatisticsDetail!
22042. ----------------------------------------------------------
22043. Zone Detailed Report:
22044. ----------------------------------------------------------
22045. !ZoneStatisticsDetail!
22046. ----------------------------------------------------------
22047. ")
22048. 
22049. 
22050. 
22051. /* pause() */
22052. /* pause() */
22053. 
22054. 
22055. 
22056. 
22057. /* ---------------------------------------------------------- */
22058. 
22059. 
22060. /* ---------------------------------------------------------- */
22061. /* Zone ArchivesBu (All) Archives and Backups*/
22062. /* ---------------------------------------------------------- */
22063. /* Zone ArchivesBu (All) Archives and Backups*/
22064. 
22065. SetVariable(ZoneLabel, "!ZoneLabelArchivesBu!")
22066. SetVariable(ZoneDescription, "!ZoneDescriptionArchivesBu!")
22067. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpArchivesBu!")
22068. SetVariable(ZoneGapSize, "!ZoneGapSizeArchivesBu!")
22069. SetVariable(ZoneTypeSelect,'# ArchivesBu start.
22070. all
22071. # ArchivesBu end.
22072. ')
22073. 
22074. /* Note: This should be all Blob archives and backups */
22075. /* The sorting the "z Archive", "z Bu" and "z Backup" directories */
22076. /* sort to the very end of the Volume. */
22077. 
22078. 	# Zone Do Header
22079. 
22080. # Zone When Started
22081. 
22082. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
22083. # Display Set Zone
22084. 
22085. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
22086. SetVariable(FileStepDescription,	"")
22087. 
22088. SetVariable(ZoneStepByLine, 			"Zone started.
22089. ")
22090. 
22091. # BANNER SET
22092. 
22093. # DATE TIME RUN ELP
22094. 
22095. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
22096. /* Xinclude "..\Display\BannerSet.MyDc"X */
22097. /* pause(1) */
22098. 
22099. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22100. 
22101. Title('!Heading!')
22102. /* pause(1) */
22103. 
22104. /* NOTE: Can't round or truncate to integer precision. */
22105. 
22106. AppendLogfile("!LogFileName!", "!Title!")
22107. 
22108. 
22109. 
22110. pause(1)
22111. 
22112. 
22113. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
22114. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
22115. 
22116. SetVariable(ZoneStepNoCurrent, 0)
22117. 
22118. 
22119. # Zone Do Current Clear
22120. 
22121. SetVariable(ZoneTypeSelectCurrent, 		"")
22122. 
22123. SetVariable(ZoneBeginCurrent, 			0)
22124. SetVariable(ZoneBeginPerCurrent, 		0)
22125. SetVariable(ZoneEndCurrent, 			0)
22126. SetVariable(ZoneEndPerCurrent, 			0)
22127. 
22128. SetVariable(ZoneSizeCurrent,			0)
22129. SetVariable(ZoneSizePerCurrent,			0)
22130. 
22131. SetVariable(ZoneGapRequestedCurrent,	0)
22132. SetVariable(ZoneGapRoundedCurrent, 		0)
22133. SetVariable(ZoneGapAdjustedCurrent, 	0)
22134. SetVariable(ZoneGapAvailableCurrent, 	0)
22135. SetVariable(ZoneGapCurrent,				0)
22136. SetVariable(ZoneGapUsedCurrent, 		0)
22137. 
22138. SetVariable(ZoneGapActualCurrent, 		0)
22139. SetVariable(ZoneGapActualPerCurrent, 	0)
22140. 
22141. SetVariable(ZoneSizeActual, 			0)
22142. SetVariable(ZoneSizeActualCurrent,		0)
22143. 
22144. SetVariable(ZoneEndActual, 				0)
22145. SetVariable(ZoneEndActualCurrent,		0)			
22146. SetVariable(ZoneSizeActualPerCurrent, 	0)
22147.       
22148. SetVariable(ZoneFilesFolders,			0)
22149. SetVariable(ZoneFilesFoldersPer,		0) 
22150. 
22151. SetVariable(ZoneFragments,				0)
22152. SetVariable(ZoneFragmentsPer,			0) 
22153. 		
22154. SetVariable(ZoneEndActualCurrent, 		0)
22155. SetVariable(ZoneEndActualPerCurrent, 	0)
22156. 
22157. # Gap Calculation Methodology:
22158. 	# Requested
22159. 	SetVariable(GapRequested, 			0) 
22160. 	SetVariable(GapRequestedStd, 		0) 
22161. 	SetVariable(GapRequestedMft, 		0) 
22162. 	SetVariable(GapRequestedOs, 		0) 
22163. 	SetVariable(GapRequestedOriginal, 	0) 
22164. 	
22165. 	# Gap Adjustments
22166. 	SetVariable(GapRounded, 			0)
22167. 	# SetVariable(GapAdjusted, 			0)
22168. 	SetVariable(GapAvailable, 			0)
22169. 	SetVariable(GapCurrent, 			0)
22170. 	SetVariable(GapActual, 				0)
22171. 	SetVariable(GapUsed, 				0)
22172. 	
22173. 	# Gap Adjustments
22174. 	SetVariable(GapRoundedLoc, 			0)
22175. 	# SetVariable(GapAdjustedLoc, 		0)
22176. 	SetVariable(GapAvailableLoc, 		0)
22177. 	SetVariable(GapCurrentLoc, 			0)
22178. 	SetVariable(GapActualLoc,			0)
22179. 	SetVariable(GapUsedLoc,				0)
22180. 	
22181. 	# Space usage
22182. 	SetVariable(ZoneFreePerRequested, 	0)
22183. 	SetVariable(ZoneFreePerUsed, 		0)
22184. 
22185. # Gap Size & Rounding
22186. 	SetVariable(ZoneGapSizePer, 		0)
22187. 	SetVariable(ZoneVolRoundUpPer, 		0)
22188. 	
22189. 	# Free Space
22190. 	SetVariable(ZoneFreeUsedPer, 		0)
22191. 	SetVariable(ZoneFreeRequestedPer, 	0)
22192. 
22193. 
22194. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
22195. 
22196. # Footer:
22197. SetVariable(ZoneFooter, "----------------------------------------------------------
22198. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:56
22199. 
22200. Statistics Report:
22201. ------------------
22202.    Size:  
22203.    ------------------------
22204.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22205.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22206.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22207. 
22208.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22209.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22210. 
22211.    Location:
22212.    ------------------------
22213.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22214.              Files End: !ZoneEndCurrent!
22215.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22216.       
22217.    Gap Settings:
22218.    ------------------------
22219.          Gap Requested: !ZoneGapSizePer!%
22220.       Volume Rounding: !ZoneVolRoundUpPer!%
22221.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22222.                  
22223.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22224.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22225.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22226.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22227.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22228.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22229.      
22230.    Free Space after Zone:
22231.    ------------------------
22232.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22233.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22234.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22235. 
22236. Directory and Files Select:
22237. ---------------------------
22238. !ZoneTypeSelectCurrent!               
22239. ---------------------------
22240. ----------------------------------------------------------
22241. ")
22242. 
22243. # BANNER SET
22244. 
22245. # DATE TIME RUN ELP
22246. 
22247. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
22248. /* Xinclude "..\Display\BannerSet.MyDc"X */
22249. /* pause(1) */
22250. 
22251. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22252. 
22253. Title('!Heading!')
22254. /* pause(1) */
22255. 
22256. /* NOTE: Can't round or truncate to integer precision. */
22257. 
22258. AppendLogfile("!LogFileName!", "!Title!")
22259. 
22260. 
22261. 
22262. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
22263. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
22264. AppendLogfile("!LogFileName!", "Time: 2021-11-09 10:47:56")
22265. 
22266. SetVariable(ZoneListByLine, "!ZoneListByLine!
22267. Zone: !ZoneNoCurrent! 2021-11-09 10:47:56 0:00:08 !ZoneLabel! !ZoneDescription!")
22268. 
22269. 
22270. /* Fixed Zone Position Handling */
22271. /* Literal number: */
22272. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
22273. /* Percentage of disk: */
22274. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
22275. /* Gap */
22276. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
22277. 
22278. /* ---------------------------------------------------------- */
22279. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
22280. # FILE STEP
22281. 
22282. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22283. 
22284. /* add message and move to a new line. */
22285. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22286. ")
22287. 
22288. /* display the line. (hopefully.) */
22289. # Zone Footer Set Statistics Window Text
22290. 
22291. SetStatisticsWindowText("----------------------------------------------------------
22292. Zones Processed: 
22293. ----------------------------------------------------------
22294. !ZoneListByLine!
22295. ----------------------------------------------------------
22296. Zone Processing Step:
22297. !ZoneStepByLine!    
22298. ----------------------------------------------------------
22299. Current Zone:
22300. !ZoneFooter!
22301. ----------------------------------------------------------
22302. Volume Statistics:
22303. !VolumeStatisticsDetail!
22304. ----------------------------------------------------------
22305. Zone Detailed Report:
22306. ----------------------------------------------------------
22307. !ZoneStatisticsDetail!
22308. ----------------------------------------------------------
22309. ")
22310. 
22311. 
22312. 
22313. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22314. 
22315. # BANNER SET
22316. 
22317. # DATE TIME RUN ELP
22318. 
22319. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
22320. /* Xinclude "..\Display\BannerSet.MyDc"X */
22321. /* pause(1) */
22322. 
22323. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22324. 
22325. Title('!Heading!')
22326. /* pause(1) */
22327. 
22328. /* NOTE: Can't round or truncate to integer precision. */
22329. 
22330. pause(1)
22331. 
22332. # your stuff HERE (X)... pre file select code.
22333. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
22334. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22335. 	# (X)
22336. 
22337. FileSelect
22338. 
22339. 	# your stuff can't really go here (errors.)
22340. 	# maybe for some reason I don't know of...
22341. 	
22342. 	# Actions next...
22343. 	# ArchivesBu start.
22344. all
22345. # ArchivesBu end.
22346. 
22347. 		SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
22348. 
22349. 	# Zone Do Footer
22350. 
22351. /* ---------------------------------------------------------- */
22352. # File Select
22353. 	# Select Statments
22354. # File Actions 
22355. 	# Standard or OS File Actions.
22356. 	# Resume...
22357. 	
22358. 	# your stuff HERE (X)... post zone (file) file actions code.
22359. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
22360. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22361. 		# (X)
22362. 		
22363. 		/* ??? Set window? */
22364. 	
22365. 	# ADD THE GAP
22366. 		
22367. # Vacate (good for diagnostics)
22368. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
22369. 
22370. # DoNotVacate - DO NOT Vacate (recommended)
22371. 
22372. # Vacate
22373. /* AddGap(GapUsedLoc) */
22374. 
22375. # DO Not Vacate
22376. AddGap(GapUsedLoc, DoNotVacate) 
22377. 	
22378. 	
22379. /* ---------------------------------------------------------- */
22380. # (failed) TEST for boolean logic.
22381. 
22382. /* It should work in the gap calculations for turning options */
22383. /* on and off but it will NOT work here. */
22384. 
22385. /* Boolean setting X or FlagX. */
22386. /* Where X will be on or off: */
22387. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
22388. /*      For ON:  (X  *  FlagAny) */
22389. 
22390. /* 1) Failed, zero gap overrode the previous one. */
22391. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
22392. /* AddGap(GapUsedTemp) */ 
22393. 
22394. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
22395. /* AddGap(GapUsedTemp, DoNotVacate) */ 
22396. 
22397. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
22398. 
22399. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
22400. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
22401. /* AddGap(GapUsedTemp) */ 
22402. 
22403. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
22404. /* AddGap(GapUsedTemp, DoNotVacate) */ 
22405. 
22406. /* ---------------------------------------------------------- */
22407. 
22408. # Vacate
22409. /* AddGap(GapUsed) */
22410. 
22411. # DO NOT Vacate (recommended)
22412. /* AddGap(GapUsed, DoNotVacate) */ 
22413. 	
22414. 
22415. 		
22416. # 
22417. FileEnd
22418. /* ---------------------------------------------------------- */
22419. 
22420. # your stuff HERE (X)... post zone (file) code.
22421. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
22422. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22423. 	# (X)
22424. 
22425. SetVariable(FileStepDescription,"Zone finished, reporting.")
22426. # FILE STEP
22427. 
22428. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22429. 
22430. /* add message and move to a new line. */
22431. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22432. ")
22433. 
22434. /* display the line. (hopefully.) */
22435. # Zone Footer Set Statistics Window Text
22436. 
22437. SetStatisticsWindowText("----------------------------------------------------------
22438. Zones Processed: 
22439. ----------------------------------------------------------
22440. !ZoneListByLine!
22441. ----------------------------------------------------------
22442. Zone Processing Step:
22443. !ZoneStepByLine!    
22444. ----------------------------------------------------------
22445. Current Zone:
22446. !ZoneFooter!
22447. ----------------------------------------------------------
22448. Volume Statistics:
22449. !VolumeStatisticsDetail!
22450. ----------------------------------------------------------
22451. Zone Detailed Report:
22452. ----------------------------------------------------------
22453. !ZoneStatisticsDetail!
22454. ----------------------------------------------------------
22455. ")
22456. 
22457. 
22458. 
22459. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22460. 
22461. # BANNER SET
22462. 
22463. # DATE TIME RUN ELP
22464. 
22465. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
22466. /* Xinclude "..\Display\BannerSet.MyDc"X */
22467. /* pause(1) */
22468. 
22469. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22470. 
22471. Title('!Heading!')
22472. /* pause(1) */
22473. 
22474. /* NOTE: Can't round or truncate to integer precision. */
22475. 
22476. pause(1)
22477. 
22478. # Zone When Finished
22479. 
22480. # BANNER SET
22481. 
22482. # DATE TIME RUN ELP
22483. 
22484. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
22485. /* Xinclude "..\Display\BannerSet.MyDc"X */
22486. /* pause(1) */
22487. 
22488. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22489. 
22490. Title('!Heading!')
22491. /* pause(1) */
22492. 
22493. /* NOTE: Can't round or truncate to integer precision. */
22494. 
22495. AppendLogfile("!LogFileName!", "!Title!")
22496. 
22497. 
22498. 
22499. # Zone Statistics	
22500. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
22501. 
22502. # Footer:
22503. SetVariable(ZoneFooter, "----------------------------------------------------------
22504. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 10:47:56
22505. 
22506. Statistics Report:
22507. ------------------
22508.    Size:  
22509.    ------------------------
22510.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22511.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22512.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22513. 
22514.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22515.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22516. 
22517.    Location:
22518.    ------------------------
22519.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22520.              Files End: !ZoneEndCurrent!
22521.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22522.       
22523.    Gap Settings:
22524.    ------------------------
22525.          Gap Requested: !ZoneGapSizePer!%
22526.       Volume Rounding: !ZoneVolRoundUpPer!%
22527.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22528.                  
22529.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22530.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22531.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22532.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22533.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22534.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22535.      
22536.    Free Space after Zone:
22537.    ------------------------
22538.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22539.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22540.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22541. 
22542. Directory and Files Select:
22543. ---------------------------
22544. !ZoneTypeSelectCurrent!               
22545. ---------------------------
22546. ----------------------------------------------------------
22547. ")
22548. 
22549. AppendLogfile("!LogFileName!", ".")
22550. AppendLogfile("!LogFileName!", "!ZoneFooter!")
22551. AppendLogfile("!LogFileName!", ".")
22552. 
22553. # Zone Footer Set Statistics Window Text
22554. 
22555. SetStatisticsWindowText("----------------------------------------------------------
22556. Zones Processed: 
22557. ----------------------------------------------------------
22558. !ZoneListByLine!
22559. ----------------------------------------------------------
22560. Zone Processing Step:
22561. !ZoneStepByLine!    
22562. ----------------------------------------------------------
22563. Current Zone:
22564. !ZoneFooter!
22565. ----------------------------------------------------------
22566. Volume Statistics:
22567. !VolumeStatisticsDetail!
22568. ----------------------------------------------------------
22569. Zone Detailed Report:
22570. ----------------------------------------------------------
22571. !ZoneStatisticsDetail!
22572. ----------------------------------------------------------
22573. ")
22574. 
22575. 
22576. 
22577. /* pause() */
22578. /* pause() */
22579. 
22580. 
22581. 
22582. 
22583. /* ---------------------------------------------------------- */
22584. 
22585. 
22586. /* ---------------------------------------------------------- */
22587. /* Volume End */
22588. # Volume When Finished
22589. 
22590. /* Write the "after" statistics to the logfile. */
22591. 
22592. # BANNER SET
22593. 
22594. # DATE TIME RUN ELP
22595. 
22596. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
22597. /* Xinclude "..\Display\BannerSet.MyDc"X */
22598. /* pause(1) */
22599. 
22600. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22601. 
22602. Title('!Heading!')
22603. /* pause(1) */
22604. 
22605. /* NOTE: Can't round or truncate to integer precision. */
22606. 
22607. AppendLogfile("!LogFileName!", "!Title!")
22608. 
22609. 
22610. 
22611. # Set Volume summary stats:
22612. 
22613. # Cluster, Sector, Block adjust for display.
22614. # Bytes per cluster is volume specific.
22615. 
22616. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
22617. 
22618. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
22619. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
22620. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
22621. 
22622. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
22623. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
22624. 
22625. # Set the display text:
22626. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
22627. SUMMARY: !VolumeLabel! !VolumeDescription!
22628.   
22629.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
22630.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
22631.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
22632.          
22633.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
22634.       Volume Free Adj:       !VolumeFreeAdj!
22635.     Bytes per cluster:       !BytesPerCluster! bytes
22636. 
22637.    Unfragmented Items:       !FILES200N!
22638.      Fragmented Items:       !FILES210N!
22639. 
22640.     Unfragmented Data:       !FILES202N! bytes
22641.       Fragmented Data:       !FILES212N! bytes
22642. 
22643.              All Gaps:       !GAP00N!
22644.              All gaps:       !GAP10N! bytes
22645.           Average gap:       !GAP13N! bytes
22646.            Median gap:       !GAP14N! bytes
22647.           Biggest gap:       !GAP15N! bytes
22648. ----------------------------------------------------------
22649. ") 
22650. 
22651. 
22652. SetVariable(VolumeFooter, "!VolumeStatisticsSummary!")
22653. 
22654. 
22655. AppendLogfile("!LogFileName!", ".")
22656. AppendLogfile("!LogFileName!", "      Volume Size: !VolumeSize!")
22657. AppendLogfile("!LogFileName!", "      Volume Used: !VolumeUsed!")
22658. AppendLogfile("!LogFileName!", "Volume Used Total: !VolumeUsedTotal!")
22659. AppendLogfile("!LogFileName!", "      Volume Free: !VolumeFree!")
22660. AppendLogfile("!LogFileName!", "  Volume Free Adj: !VolumeFreeAdj!")
22661. AppendLogfile("!LogFileName!", ".")
22662. AppendLogfile("!LogFileName!", "MFT Zone: !MftZone! Location: !MftLocation! Gap: !MftGap!")
22663. AppendLogfile("!LogFileName!", ".")
22664. 
22665. 
22666. /* Write/display stats: */
22667. 
22668. # Log:  
22669. 
22670. # Set Volume Detailed Statistics:
22671. 
22672. # Set Volume summary stats:
22673. 
22674. # Cluster, Sector, Block adjust for display.
22675. # Bytes per cluster is volume specific.
22676. 
22677. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
22678. 
22679. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
22680. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
22681. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
22682. 
22683. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
22684. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
22685. 
22686. # Set the display text:
22687. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
22688. SUMMARY: !VolumeLabel! !VolumeDescription!
22689.   
22690.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
22691.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
22692.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
22693.          
22694.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
22695.       Volume Free Adj:       !VolumeFreeAdj!
22696.     Bytes per cluster:       !BytesPerCluster! bytes
22697. 
22698.    Unfragmented Items:       !FILES200N!
22699.      Fragmented Items:       !FILES210N!
22700. 
22701.     Unfragmented Data:       !FILES202N! bytes
22702.       Fragmented Data:       !FILES212N! bytes
22703. 
22704.              All Gaps:       !GAP00N!
22705.              All gaps:       !GAP10N! bytes
22706.           Average gap:       !GAP13N! bytes
22707.            Median gap:       !GAP14N! bytes
22708.           Biggest gap:       !GAP15N! bytes
22709. ----------------------------------------------------------
22710. ") 
22711. 
22712. 
22713. 
22714. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
22715. VOLUME: !VolumeLabel! !VolumeDescription!
22716. ----------------------------------------------------------
22717. !VolumeStatisticsSummary!
22718. ----------------------------------------------------------
22719. DETAILS: !VolumeLabel! !VolumeDescription!
22720. ----------------------------------------------------------
22721. 
22722. SUMMARY:
22723. 
22724. Volume label/name:          !VolumeLabel!
22725. Volume mountpoint:          !MountPoint!
22726. Volume name:                !VolumeName!
22727. Volume type:                !VolumeType!
22728. 
22729. Total disk space:           !VolumeSize! bytes
22730.                             !VolumeSizeG! gigabytes
22731. 
22732. Bytes per cluster:          !BytesPerCluster! bytes
22733. Average end-begin distance: !AverageBeginEndDistance! clusters
22734.                             !AverageBeginEndDistanceP!% of volume size
22735. 
22736. ----------------------------------------------------------
22737. FRAGMENTS:
22738. 
22739. Unfragmented Items: !FILES200N!
22740.   Fragmented Items: !FILES210N!
22741.  Unfragmented Data: !FILES202N! bytes
22742.    Fragmented Data: !FILES212N! bytes
22743. Gaps:
22744.           All Gaps: !GAP00N!
22745.           All gaps: !GAP10N! bytes
22746.        Average gap: !GAP13N! bytes
22747.         Median gap: !GAP14N! bytes
22748.        Biggest gap: !GAP15N! bytes
22749. 
22750. ----------------------------------------------------------
22751. GAPS:
22752. 
22753.    ----------------------------------------------------------
22754.    Counts:
22755.                        Count      Percentage of all
22756.                 ----------------- -----------------
22757.    Small gaps   !GAP01N! !GAP01P!%
22758.    Big gaps     !GAP02N! !GAP02P!%
22759.                 ----------------- -----------------
22760.    All gaps     !GAP00N! !GAP00P!
22761. 
22762.    ----------------------------------------------------------
22763.    By size:
22764.                       Bytes          Gigabytes      Percentage of all
22765.                 ----------------- ----------------- -----------------
22766.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
22767.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
22768.                 ----------------- ----------------- -----------------
22769.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
22770. 
22771.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
22772.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
22773.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
22774.    ----------------------------------------------------------
22775. 
22776. ----------------------------------------------------------
22777. FILE STATISTICS:
22778. ----------------------------------------------------------
22779. 
22780. ----------------------------------------------------------
22781. ITEM COUNT:
22782. ----------------------------------------------------------
22783. Number of files and folders:
22784. 
22785.               Unfragmented       Fragmented            All
22786.    ------- ----------------- ----------------- -----------------
22787.    Files   !FILES000N! !FILES010N! !FILES020N!
22788.    Folders !FILES100N! !FILES110N! !FILES120N!
22789.    ------- ----------------- ----------------- -----------------
22790.    All     !FILES200N! !FILES210N! !FILES220N!
22791. 
22792. ----------------------------------------------------------
22793. Percentage of total:
22794. 
22795.               Unfragmented       Fragmented            All
22796.    ------- ----------------- ----------------- -----------------
22797.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
22798.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
22799.    ------- ----------------- ----------------- -----------------
22800.    All     !FILES200P!%!FILES210P!%!FILES220P!%
22801. 
22802. ----------------------------------------------------------
22803. OCCUPIED SIZE on disk:
22804. ----------------------------------------------------------
22805. Bytes:
22806.               Unfragmented       Fragmented            All
22807.    ------- ----------------- ----------------- -----------------
22808.    Files   !FILES002N! !FILES012N! !FILES022N!
22809.    Folders !FILES102N! !FILES112N! !FILES122N!
22810.    ------- ----------------- ----------------- -----------------
22811.    All     !FILES202N! !FILES212N! !FILES222N!
22812. 
22813. ----------------------------------------------------------
22814. Gigabytes:
22815.               Unfragmented       Fragmented            All
22816.    ------- ----------------- ----------------- -----------------
22817.    Files   !FILES002G! !FILES012G! !FILES022G!
22818.    Folders !FILES102G! !FILES112G! !FILES122G!
22819.    ------- ----------------- ----------------- -----------------
22820.    All     !FILES202G! !FILES212G! !FILES222G!
22821. 
22822. ----------------------------------------------------------
22823. Percentage:
22824.               Unfragmented       Fragmented            All
22825.    ------- ----------------- ----------------- -----------------
22826.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
22827.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
22828.    ------- ----------------- ----------------- -----------------
22829.    All     !FILES202P!%!FILES212P!%!FILES222P!%
22830. 
22831. ----------------------------------------------------------
22832. USED SIZE:
22833. ----------------------------------------------------------
22834. Bytes:
22835.               Unfragmented       Fragmented            All
22836.    ------- ----------------- ----------------- -----------------
22837.    Files   !FILES001N! !FILES011N! !FILES021N!
22838.    Folders !FILES101N! !FILES111N! !FILES121N!
22839.    ------- ----------------- ----------------- -----------------
22840.    All     !FILES201N! !FILES211N! !FILES221N!
22841. 
22842. ----------------------------------------------------------
22843. Gigabytes:
22844.               Unfragmented       Fragmented            All
22845.    ------- ----------------- ----------------- -----------------
22846.    Files   !FILES001G! !FILES011G! !FILES021G!
22847.    Folders !FILES101G! !FILES111G! !FILES121G!
22848.    ------- ----------------- ----------------- -----------------
22849.    All     !FILES201G! !FILES211G! !FILES221G!
22850. 
22851. ----------------------------------------------------------
22852. Percentage:
22853.               Unfragmented       Fragmented            All
22854.    ------- ----------------- ----------------- -----------------
22855.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
22856.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
22857.    ------- ----------------- ----------------- -----------------
22858.    All     !FILES201P!%!FILES211P!%!FILES221P!%
22859. 
22860. ----------------------------------------------------------
22861. Volume Detailed Statistics end.
22862. ----------------------------------------------------------
22863. ") 
22864. 
22865. 
22866. AppendLogfile("!LogFileName!", ".")
22867. AppendLogfile("!LogFileName!", "!VolumeStatisticsDetail!")
22868. AppendLogfile("!LogFileName!", ".")
22869. AppendLogfile("!LogFileName!", "Volume End.")	
22870. 
22871. # SetStatisticsWindowText("!VolumeStatisticsDetail!")
22872. 
22873. /* pause() */
22874. /* pause() */
22875. 
22876.   
22877. 
22878. VolumeEnd
22879. 
22880. /* ---------------------------------------------------------- */
22881. 
22882. AppendLogfile("!LogFileName!",".")
22883. SetVariable(FileStepDescription,"!Description! Complex Volume end: 2021-11-09 10:47:49.")
22884. # BANNER SET
22885. 
22886. # DATE TIME RUN ELP
22887. 
22888. SetVariable(DateTimeRunDescription,		"2021-11-09 10:47:56 0:00:08")
22889. /* Xinclude "..\Display\BannerSet.MyDc"X */
22890. /* pause(1) */
22891. 
22892. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22893. 
22894. Title('!Heading!')
22895. /* pause(1) */
22896. 
22897. /* NOTE: Can't round or truncate to integer precision. */
22898. 
22899. AppendLogfile("!LogFileName!", "!Title!")
22900. 
22901. 
22902. 
22903. AppendLogfile("!LogFileName!",".")
22904. 
22905. /* ---------------------------------------------------------- */
22906. # End. ;-) (Return to caller lovely nubes, only MyD's get executed.)
22907. 
22908. 
