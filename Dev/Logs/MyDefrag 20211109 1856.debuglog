# See the 'MyDefrag.log' file for information intended for endusers. This is the debug
# logfile. The contents is highly technical and not documented. See the 'Debug' setting
# or the '-d' commandline option to control the level of information in this file.
#
Version: MyDefrag v4.3.1 for X64
Date: 2021/11/09 18:53:51
Windows version: v6.2 build 9200 
Commandline: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily\DefragDevDiskDaily.MyD" 
Working Directory: G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily
Userid: david
InstallPath = C:\Program Files\MyDefrag v4.3.1\
18:53:51 Syntax error in script 'G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily\DefragDevDiskDaily.MyD' at line 7988 column 1.

The command 'FileActions' is invalid, only the following commands are valid at this point:

	)
	AddGap
	AppendLogfile
	BatteryPower
	Debug
	Defragment
	DeleteJournal
	Description
	DiskmapFlip
	DismountVolume
	ExcludeFiles
	ExcludeVolumes
	ExitIfTimeout
	FastFill
	FileEnd
	FileMoveChunkSize
	FileSelect
	ForcedFill
	IgnoreWrapAroundFragmentation
	Language
	MakeGap
	MaxRunTime
	Message
	MoveDownFill
	MoveToEndOfDisk
	MoveUpToZone
	OtherInstances
	Pause
	PlaceNtfsSystemFiles
	ProcessPriority
	ReclaimNtfsReservedAreas
	RememberUnmovables
	RunProgram
	RunScript
	SetColor
	SetFileColor
	SetScreenPowerSaver
	SetScreenSaver
	SetStatisticsWindowText
	SetVariable
	Slowdown
	SortByCreationDate
	SortByImportSequence
	SortByLastAccess
	SortByLastChange
	SortByName
	SortByNewestDate
	SortBySize
	StatusBar
	Title
	VolumeEnd
	VolumeSelect
	WhenFinished
	WindowSize
	WriteLogfile
	ZoomLevel

18:55:04 Script:
  1. # MyDefrag v4.0 script: Development Volume Daily defrag
  2. #
  3. # This script is part of the standard Mdm Volume configuration
  4. # Author: David G. Horsman (DBA MacroDM) (C) 2019
  5. # based on MyDefrag distribution.
  6. 
  7. /* Development Volume Daily*/
  8. SetVariable(RunStepDescription,"Dev Vol Daily")
  9. # Script: DisplaySetRun
 10. 
 11. SetVariable(RunStepDescription,			"!RunStepDescription! - DefragDevDiskDaily")
 12. SetVariable(SeverStepDescription,		"")
 13. SetVariable(VolumeStepDescription,		"")
 14. SetVariable(ZoneStepDescription,		"")
 15. SetVariable(FileStepDescription,		"")
 16. 
 17. SetVariable(VolumeStatisticsDetail, 	"")
 18. 
 19. SetVariable(ZoneListByLine, 			"Run start.")
 20. SetVariable(ZoneStepByLine, 			"")
 21. 
 22. # Script: BannerSet
 23. 
 24. # Script: DisplaySetDateTimeRun
 25. 
 26. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
 27. /* Xinclude "..\Display\BannerSet.MyDc"X */
 28. /* pause(1) */
 29. 
 30. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
 31. 
 32. Title('!Heading!')
 33. /* pause(1) */
 34. 
 35. /* NOTE: Can't round or truncate to integer precision. */
 36. 
 37. pause(2)
 38. 
 39. # This script is part of the standard  disk configuration
 40. # Author: David G. Horsman (DBA MacroDM) (C) 2019
 41. # based on MyDefrag distribution.
 42. 
 43. SetVariable(Heading,"Initializing...")
 44. 
 45. ProcessPriority(Normal)
 46. /* ProcessPriority(Normal) */
 47. 
 48. 
 49. 
 50. ExitIfTimeout(300) // 5 minutes (for old systems), default 120.
 51. /* ExitIfTimeout(300) // 5 minutes (for old systems), default 120. */
 52. 
 53. 
 54. 
 55. # Script: DisplayColors
 56. # MyDefrag color palette.
 57. 
 58. # RGB Color pallets. (Red,Green,Blue).
 59. 
 60. # Basics:
 61. 
 62. # Red			255,	0,		0)			// Red
 63. # Green			0,		255,	0)			// Green
 64. # Blue			0,		0,		255)		// Blue
 65. # Shades:
 66. 
 67. /* (White was left unused for the administrator to highlight things.) */
 68. # White 		255,	255,	255)		// White
 69. # Black			0,		0,		0)			// Black
 70. # Grey 			240,	240,	240)		// Grey
 71. 
 72. # Bright colors and shades:
 73. 
 74. # Purple 		170,	89,		221)		// Purple
 75. # Magenta		255, 	5, 		255)		// Magenta (pinkish)
 76. 
 77. # Pure Yellow 	255,	255,	0)			// Pure yellow
 78. # Yellow 		229, 	229, 	0)			// Yellow
 79. # Light Yellow 	255,	255,	224)		// Light Yellow
 80. 
 81. # Pure Red 		255, 	0, 		0)			// Red
 82. # Red 			204, 	92, 	92)			// Red
 83. # Light red		255,	115,	115)		// Light red
 84. # Orange		255, 	165, 	0)			// Orange
 85. 
 86. # Pure Green	0, 		255, 	0)			// Pure Green (Lime)
 87. # Green			0,		128,	0)			// Green
 88. # Light Green	144,	228, 	144)		// Light Green
 89. # Pale Green	152, 	251, 	152)		// Pale Green
 90. 
 91. # Dark blue		20,		87,		229)		// Dark blue
 92. # Light Blue	175,	198,	247)		// Light Blue
 93. # Bright Blue	0, 		223, 	255)		// Bright Blue
 94. # Light sky blue 135, 	206, 	250)		// Light sky blue
 95. # Deep sky blue	0, 		191, 	255)		// Deep sky blue
 96. 
 97. # Black			0,		0,		0)
 98. # Grey			240,	240,	240)
 99. 
100. # Window Colors
101. SetColor(Empty,										240,  	240, 	240)	// Grey
102. # ???
103. SetColor(Allocated,									45, 	72, 	128)	// Black
104. 
105. # Busy Colours
106. SetColor(BusyRead,									0, 		0, 		0)		// Black
107. SetColor(BusyWrite,									255, 	0, 		0)		// Red
108. 
109. #File Colors
110. SetFileColor(All,									0,		0,		0)		// Black
111. SetFileColor(Movable,								20,		87,		229)	// Dark blue
112. 
113. # Processed
114. SetFileColor(Processed and not(Fragmented),			0, 		191, 	255)	// Deep sky blue
115. SetFileColor(Processed and Fragmented,				170,	89,		221)	// Purple
116. 
117. # Fragmented and NotMovable
118. SetFileColor(Fragmented,							229, 	229, 	0)		// Yellow
119. SetFileColor(not(Movable),							255, 	165, 	0)		// Orange
120. 
121. # Light Green and Yellow
122. SetFileColor(Selected,								152,	251, 	152)	// Light Green
123. SetFileColor(Selected and Fragmented,				255, 	255, 	224)	// Light Yellow (0,255,255)
124. SetFileColor(Selected and not(Movable),				255,	115,	115)	// Light red
125. 
126. /* empty */
127. 
128. 
129. 
130. # Processes:
131. 	# This Process
132. 	SetVariable(RunProcessID,ProcessID)
133. 
134. 	# Kill other instances
135. 	/* Kill other MyDefrag Instances. */
136. 	/* Oops! This commits suicide. */
137. 	/* 	RunProgram("..\pskill.exe", "-t MyDefrag.exe") */
138. 	/* Pause(10) */
139. 	
140. 	/* If another instance of MyDefrag is already running then exit. */
141. 	/* Oops again. I don't know if this cause the hidden instance */
142. 	/* to hang around after the run. */
143. 	/* Warning: <alt><Run><Exit> seems to hide the instance not end it. */
144. 	/* The task mananager may be needed. This is under investigation. */
145. 
146. 	# OtherInstances
147. 	
148. OtherInstances(exit)
149. 
150. # OtherInstances
151. 	
152. # OtherInstances(exit)
153. 
154. 
155. 
156. 	# StatusBar
157. 	StatusBar(Status Path MouseOver)
158. 	# Script: DisplayStatusBar
159. # OtherInstances
160. 	
161. # OtherInstances(exit)
162. 
163. 	
164. 	# Power management
165. 	/* SetScreenPowerSaver(off) */
166. 	# Power management
167. 
168. 	/* SetScreenPowerSaver(off) */
169. 
170. 	# Power management
171. 
172. 	/* SetScreenPowerSaver(off) */
173. 
174. 
175. 
176. 
177. /* ---------------------------------------------------------- */
178. # Script Directory Location:
179. SetVariable(ScriptDir,"..\")
180. 
181. /* SetVariable(ScriptDir,"..\") */
182. /* SetVariable(ScriptDir,"G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsDaily") */
183. /* SetVariable(ScriptDir,"E:\Ide\MyDefrag\MyDefrag\MdmScriptMyDefragVs4_3_1\") */
184. 
185. 
186. 
187. /* ---------------------------------------------------------- */
188. # DISPLAY - What text is displayed in Titlebar, data fields and reports.
189. 
190. 
191. /* The variable FileStepDescription get set to */
192. /* the messages below according to the Zone File */
193. /* step the defrag is on. */
194. 
195. /* The titlebar is organized in these areas: */
196. 
197. /* SwProductVs. */
198. /* Volume description. */
199. /* Zone description. */
200. /* File Processing Step (here.) */
201. /* Server and Script names. */
202. /* Run Date, Time and Elapsed (Bug) */
203. 
204. /* Shown in the Title / Banner / App Heading */
205. 
206. SetVariable(SeverStepDescription,	"")
207. SetVariable(VolumeStepDescription,	"")
208. SetVariable(ZoneStepDescription,	"")
209. SetVariable(FileStepDescription,	"")
210. SetVariable(RunStepDescription,		"")
211. 
212. # Display fields you can set for your personal tastes / needs:
213. 
214. /* ---------------------------------------------------------- */
215. # ZONE. Process One Zone (the steps and messages displayed. */
216. 
217. SetVariable(FileStepDescriptionZoneStart, 			"Zone started.")
218. 
219. /* "Your Zone Pre (before)Processing." */
220. SetVariable(FileStepDescriptionYourZonePre, 		"!FileStepDescriptionZoneStart!") 		
221. 
222. SetVariable(FileStepDescriptionFileSelect,			"Selecting Files.")
223. 
224. /* "Your Pre Sort File Actions." */
225. SetVariable(FileStepDescriptionYourFileActionsPre, 	"!FileStepDescriptionFileSelect!")
226. 
227. SetVariable(FileStepDescriptionFileActionStart, 	"File Actions started.")
228. 
229. /* "Your Post Sort File Actions." */
230. SetVariable(FileStepDescriptionYourFileActionsPost, "!FileStepDescriptionFileActionStart!")
231. 
232. SetVariable(FileStepDescriptionFileActionEnd, 		"File Actions completed.")
233. 
234. /* "Your Zone Post (after) Processing." */
235. SetVariable(FileStepDescriptionYourZonePost, 		"!FileStepDescriptionFileActionEnd!") 		
236. 
237. SetVariable(FileStepDescriptionFileActionGap, 		"Calculating Gap.")
238. 
239. SetVariable(FileStepDescriptionZoneEnd, 			"Zone finished.")
240. 
241. /* Pattern: SetVariable(FileStepDescriptionXXX, 	"FileStepDescriptionXXX") */
242. 
243. /* Note: If you add custom script code in the PRE and POST areas then at that */
244. /* time you fill in the messages above as appropriate. */
245. 
246. /* empty */
247. 
248. /* ---------------------------------------------------------- */
249. # Regarding Volume Names/Labels
250. 
251. /* FYI. The Volume names / drive letters need to be correct for your system. */
252. /* It is repeated here for infomation about fields used above. */
253. /* Set your values in "SettingsYours\SettingsYoursVolumeNames.MyDc" */
254. 
255. 	/* SetVariable(VolumeSys,"!VolumeNamePrefix!Sys") */
256. 	/* SetVariable(VolumeDev,"!VolumeNamePrefix!Dev") */
257. 	/* SetVariable(VolumeData,"!VolumeNamePrefix!Data") */
258. 	/* SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive") */
259. 
260. 	/*		or just */
261. 			
262. 	/* SetVariable(VolumeSys,"C:") */
263. 	/* SetVariable(VolumeDev,"E:") */
264. 
265. /* ---------------------------------------------------------- */
266. # BANNER DEFINITION
267. /* SetVariable(Heading, "Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! || !FileStepDescription! ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskDaily on 2021-11-09 18:53:49 0:00:05") */
268. 
269. # How to build them: (documentation)
270. 
271. /* Here is how is one pattern not used: */
272. /* SetVariable(Heading, "|") */
273. /* SetVariable(Heading, "!Heading! Vol: !VolumeStepDescription!") */
274. /* SetVariable(Heading, "!Heading! Zone: !ZoneStepDescription!") */
275. /* SetVariable(Heading, "!Heading! !FileStepDescription!") */
276. /* SetVariable(Heading, "!Heading!  ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskDaily") */
277. /* SetVariable(Heading, " on 2021-11-09 18:53:49 0:00:05") */
278. /* SetVariable(Heading, "!Heading!|") // spacers. */
279. 
280. /* A typical banner field list: */
281. # Appearing in Title('Vol: !
282. # VolumeCurrent
283. # ! Zone: !
284. # ZoneCurrentDescription
285. # ! !
286. # ZoneCurrent
287. # ! of !
288. # ZoneCount
289. # ! || Free: Vol: !
290. # VolumeFreePerUsed
291. # !% Zone: !
292. # ZoneFreePerUsed
293. # !% || Script: !
294. # ScriptTitle
295. # ! System: !
296. # VolumeNamePrefix
297. # ! !
298. # ServerNameFull
299. # ! !
300. # Date
301. # ! !
302. # Time
303. # ! !
304. # RunTime
305. # !')
306. /* . */
307. 
308. 
309. /* Progress Display */
310. SetVariable(ZoneListByLine, 	"Volume start.")
311. SetVariable(ZoneStepByLine, 	"")
312. 
313. /* There is 6 digit decimal precision so by using */
314. /* 1Mb the full number is displayed in a much more */
315. /* readable form. */
316. 
317. SetVariable(DisplayUnitDivisor, 	1000000) // 1MB.
318. 
319. /* ---------------------------------------------------------- */
320. # SERVER INFORMATION
321. 
322. 	/* ServerName (IE. Computer name or number.) not used. */
323. 	/* System99 */
324. 		# SetVariable(ServerName,"Pc15")
325. 
326. 		# Server Names
327. 
328. # ???
329. 
330. # IMPORTANT: ServerName NAME: 
331. 
332. 	# SetVariable(ServerName,"PcAny")
333. 
334. # IMPORTANT: ServerName NAME: 
335. 
336. 	# SetVariable(ServerName,"PcAny")
337.     /* System99 */
338. # SET
339. SetVariable(ServerName,"RavenPc")
340. 
341. 
342. 	
343. 	/* Descriptive Information so maybe */
344. 	/* VolumeNamePrefix (IE. Person or company initials) not used. */
345. 	/* "Xyz" */
346. 		# SetVariable(VolumeNamePrefix,"Mdm")
347. 
348. 		# VolumeNamePrefix
349. 
350. /* Descriptive Information so maybe */
351. /* VolumeNamePrefix (IE. Person or company initials) not used. */
352. /* "Xyz" */
353. 	SetVariable(VolumeNamePrefix,"VolThis")
354. 
355. 	
356. /* Descriptive Information so maybe */
357. /* VolumeNamePrefix (IE. Person or company initials) not used. */
358. /* "Xyz" */
359. 	SetVariable(VolumeNamePrefix,"Vol")
360. 
361. /* Server name full is usually the server and computer combined. not used. */
362. 	SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
363. 
364. 
365. 	/* Server name full is usually the server and computer combined. not used. */
366. 
367. 		SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
368. 	
369. 	# Script: DisplaySetServer
370. # (Volume)
371. SetVariable(SeverStepDescription, 	"!ServerNameFull!")
372. SetVariable(VolumeStepDescription, 	"")
373. SetVariable(ZoneStepDescription, 	"")
374. SetVariable(FileStepDescription, 	"")
375. # Script: BannerSet
376. 
377. # Script: DisplaySetDateTimeRun
378. 
379. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
380. /* Xinclude "..\Display\BannerSet.MyDc"X */
381. /* pause(1) */
382. 
383. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
384. 
385. Title('!Heading!')
386. /* pause(1) */
387. 
388. /* NOTE: Can't round or truncate to integer precision. */
389. 
390. /* pause(2) */
391. 
392. /* ---------------------------------------------------------- */
393. # VOLUMES
394. /* ---------------------------------------------------------- */
395. 
396. 	# Volume Do Current Clear
397. 
398. /* ---------------------------------------------------------- */
399. # Current Values.
400. 	SetVariable(VolumeLabel, "NotSet")
401. 	SetVariable(VolumeDescription, "")
402. 
403. 	SetVariable(VolumeCount, 0)
404. 	SetVariable(VolumeNoCurrent, 0)
405. 	SetVariable(VolumeNoAdjCurrent, 0)
406.   	SetVariable(VolumeCurrentAjust, 0) // not used
407. 
408. /* ---------------------------------------------------------- */
409. # OS Disk Usage.
410. 
411. /* Percentage of disk used by OS */
412. 
413. 	SetVariable(OsPer, 0.18)
414. 
415. 	     SetVariable(ZoneCountOs, 5)
416. 
417.        SetVariable(ZoneCountType, 0) // not used
418.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
419. 
420. 	    SetVariable(ZoneCountSys, 2)
421. 	    SetVariable(ZoneCountDev, 7)
422. 
423. 	   SetVariable(ZoneCountData, 0)
424. 	SetVariable(ZoneCountArchive, 0)
425. 	
426. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
427. 
428. /* ---------------------------------------------------------- */
429. # Volume Totals
430. 	# USED:
431. 	/* Current total volume space used */
432. 	SetVariable(VolumeZoneUsed, 			0)
433. 	/* percentage */
434. 	SetVariable(VolumeZoneUsedPer, 			0)
435. 
436. 	# FREE:
437. 	/* Current total of free space used */
438. 	SetVariable(VolumeFreeRequested, 		0)
439. 	/* percentage */
440. 	SetVariable(VolumeFreeRequestedPer, 	0)
441. 
442. 	/* Current total of free space used */
443. 	SetVariable(VolumeFreeUsed, 			0)
444. 	/* percentage */
445. 	SetVariable(VolumeFreeUsedPer, 			0)
446. 	
447. /* ---------------------------------------------------------- */
448. # Volume Free Space Proportional Used Space vs Volume Size.
449. 	/* We only want to use a ratio of the free space relative to the volume. */
450. 	/* We could just use percentages of the total free space as well. */
451. 
452. 	/* SetVariable(VolumeFreeAdj, 		1) */
453. 	
454. 	SetVariable(VolumeFreeAdj,				(VolumeFree * (VolumeUsed / VolumeSize)))
455. 
456. /* ---------------------------------------------------------- */
457. # ZONES
458. 
459. 	SetVariable(ZoneNoCurrent, 0)
460. 	SetVariable(ZoneNoAdjCurrent, 0)
461. 	SetVariable(ZoneCurrentAjust, 0)
462. 
463. 	# Script: ZoneDoCurrentClear
464. 
465. SetVariable(ZoneTypeSelectCurrent, 		"")
466. 
467. SetVariable(ZoneBeginCurrent, 			0)
468. SetVariable(ZoneBeginPerCurrent, 		0)
469. SetVariable(ZoneEndCurrent, 			0)
470. SetVariable(ZoneEndPerCurrent, 			0)
471. 
472. SetVariable(ZoneSizeCurrent,			0)
473. SetVariable(ZoneSizePerCurrent,			0)
474. 
475. SetVariable(ZoneGapRequestedCurrent,	0)
476. SetVariable(ZoneGapRoundedCurrent, 		0)
477. SetVariable(ZoneGapAdjustedCurrent, 	0)
478. SetVariable(ZoneGapAvailableCurrent, 	0)
479. SetVariable(ZoneGapCurrent,				0)
480. SetVariable(ZoneGapUsedCurrent, 		0)
481. 
482. SetVariable(ZoneGapActualCurrent, 		0)
483. SetVariable(ZoneGapActualPerCurrent, 	0)
484. 
485. SetVariable(ZoneSizeActual, 			0)
486. SetVariable(ZoneSizeActualCurrent,		0)
487. 
488. SetVariable(ZoneEndActual, 				0)
489. SetVariable(ZoneEndActualCurrent,		0)			
490. SetVariable(ZoneSizeActualPerCurrent, 	0)
491.       
492. SetVariable(ZoneFilesFolders,			0)
493. SetVariable(ZoneFilesFoldersPer,		0) 
494. 
495. SetVariable(ZoneFragments,				0)
496. SetVariable(ZoneFragmentsPer,			0) 
497. 		
498. SetVariable(ZoneEndActualCurrent, 		0)
499. SetVariable(ZoneEndActualPerCurrent, 	0)
500. 
501. # Gap Calculation Methodology:
502. 	# Requested
503. 	SetVariable(GapRequested, 			0) 
504. 	SetVariable(GapRequestedStd, 		0) 
505. 	SetVariable(GapRequestedMft, 		0) 
506. 	SetVariable(GapRequestedOs, 		0) 
507. 	SetVariable(GapRequestedOriginal, 	0) 
508. 	
509. 	# Gap Adjustments
510. 	SetVariable(GapRounded, 			0)
511. 	# SetVariable(GapAdjusted, 			0)
512. 	SetVariable(GapAvailable, 			0)
513. 	SetVariable(GapCurrent, 			0)
514. 	SetVariable(GapActual, 				0)
515. 	SetVariable(GapUsed, 				0)
516. 	
517. 	# Gap Adjustments
518. 	SetVariable(GapRoundedLoc, 			0)
519. 	# SetVariable(GapAdjustedLoc, 		0)
520. 	SetVariable(GapAvailableLoc, 		0)
521. 	SetVariable(GapCurrentLoc, 			0)
522. 	SetVariable(GapActualLoc,			0)
523. 	SetVariable(GapUsedLoc,				0)
524. 	
525. 	# Space usage
526. 	SetVariable(ZoneFreePerRequested, 	0)
527. 	SetVariable(ZoneFreePerUsed, 		0)
528. 
529. # Gap Size & Rounding
530. 	SetVariable(ZoneGapSizePer, 		0)
531. 	SetVariable(ZoneVolRoundUpPer, 		0)
532. 	
533. 	# Free Space
534. 	SetVariable(ZoneFreeUsedPer, 		0)
535. 	SetVariable(ZoneFreeRequestedPer, 	0)
536. 
537. 
538. 	SetVariable(ZoneLabel, "Volume")
539. 	SetVariable(ZoneDescription, "Analysis...")
540. 	# Script: BannerSet
541. 
542. # Script: DisplaySetDateTimeRun
543. 
544. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
545. /* Xinclude "..\Display\BannerSet.MyDc"X */
546. /* pause(1) */
547. 
548. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
549. 
550. Title('!Heading!')
551. /* pause(1) */
552. 
553. /* NOTE: Can't round or truncate to integer precision. */
554. 
555. 
556. 	
557. 	  
558. 	SetVariable(VolumeLabel, "NotSet")
559. 	SetVariable(VolumeDescription, "")
560. 
561. 	SetVariable(FileStepDescription,"Initializing run...")
562. 	# Script: BannerSet
563. 
564. # Script: DisplaySetDateTimeRun
565. 
566. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
567. /* Xinclude "..\Display\BannerSet.MyDc"X */
568. /* pause(1) */
569. 
570. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
571. 
572. Title('!Heading!')
573. /* pause(1) */
574. 
575. /* NOTE: Can't round or truncate to integer precision. */
576. 
577. 
578. /* ---------------------------------------------------------- */
579. # VOLUME TYPES
580. 
581. 	/* Volumes */
582. 	/* . */
583. 	/* Only those were fully implemented: */
584. 	/* Sys */
585. 	/* Dev */
586. 	/* . */
587. 	/* Common types of volumes: */
588. 	/* Data */
589. 	/* Archive */
590. 	/* . */
591. 	/* Other historical volumes: */
592. 	/* Test */
593. 	/* Live */
594. 	/* Server */
595. 	/* Client */
596. 	/* SysUtils */
597. 	/* . */
598. 
599. # IMPORTANT: VOLUME NAME: SET YOUR:
600. 	/* VOLUME NAMES IN SettingsYours\SettingsYoursVolumeNames.MyDc */
601. 	/* 		or    			*/
602. 	/* VOLUME NAME (one only for override) in SettingsYours\SettingsYoursVolume.MyDc */
603. 	/* 		or here also 	*/
604. 	SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
605. 	SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
606. 
607. 	/* SetVariable(VolumeSys,"C:") */
608. 	/* SetVariable(VolumeDev,"E:") */
609. 
610. 	/* These are for dedicated disks. */
611. 	/* So it means JUST Data or JUST Archives. */
612. 
613. 	SetVariable(VolumeData,"!VolumeNamePrefix!Data")
614. 	SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
615. 	
616. 	# IMPORTANT: VOLUME NAME: 
617. 
618. 	# SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
619. 	# SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
620. 	# SetVariable(VolumeData,"!VolumeNamePrefix!Data")
621. 	# SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
622. 
623. 	#    or this:
624. 	
625. 	
626. 	SetVariable(VolumeSys,"C:")
627. 	SetVariable(VolumeDev,"C:")
628. 	SetVariable(VolumeData,"C:")
629. 	SetVariable(VolumeArchive,"C:")
630. 
631. 
632. # SET
633. # SetVariable(VolumeSys,"C:")
634. 
635. 
636. 
637. /* ---------------------------------------------------------- */
638. # OS Disk Usage.
639. /* Percentage of disk used by OS */
640. 
641. 	SetVariable(OsPer, 0.18)
642. 
643. 	     SetVariable(ZoneCountOs, 5)
644. 
645.        SetVariable(ZoneCountType, 0) // not used
646.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
647. 
648. 	    SetVariable(ZoneCountSys, 2)
649. 	    SetVariable(ZoneCountDev, 7)
650. 
651. 	   SetVariable(ZoneCountData, 0)
652. 	SetVariable(ZoneCountArchive, 0)
653. 	
654. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
655. 
656. /* ---------------------------------------------------------- */
657. # ZONE TYPES. 
658. /* ---------------------------------------------------------- */
659. 	/* Type Labels, Descriptions, Gaps and Rounding. */
660. 	/* Load the Zone Definitions */
661. 	/* These are file categories basically */
662. 	/* and are maintained in a single file */
663. 	/* for ease of maintenance. Here: */
664. 	
665. 	/* ---------------------------------------------------------- */
666. # ROUNDING factors:
667. 
668. /* HERE if you want to tweak how type the Gaps are if growth is slow. */
669. /* HERE if your DISK IS VERY FULL */
670. /* This is where you can tweak growth rounding if the Volume gets really full. */
671. /* You don't have to use these, you can use actual percentages in the Zone section. */
672. 
673. /* Note: Volume and Gap Sizes are paired to a degree and */
674. /* set relative to each other. */
675. 	
676. 	      SetVariable(VolumeRoundUpNone, 	1)
677. 	      SetVariable(VolumeRoundUpTiny, 	0.005)
678. 	     SetVariable(VolumeRoundUpSmall, 	0.01)
679. 	    SetVariable(VolumeRoundUpMedium, 	0.02)
680. 	     SetVariable(VolumeRoundUpLarge, 	0.03)
681. 	SetVariable(VolumeRoundUpExtraLarge, 	0.05)
682. 	
683. 	    SetVariable(VolumeRoundUpBlogBu, 	0.10)
684. 	
685. 	      SetVariable(ZoneGapSizeNone, 		0)
686. 	      SetVariable(ZoneGapSizeTiny, 		0.005)
687. 	     SetVariable(ZoneGapSizeSmall, 		0.01)
688. 	    SetVariable(ZoneGapSizeMedium, 		0.05)
689. 	     SetVariable(ZoneGapSizeLarge, 		0.10)
690. 	SetVariable(ZoneGapSizeExtraLarge, 		0.15)
691. 		
692. 	    SetVariable(ZoneGapSizeBlobBu, 		0.10)
693. 
694. /* ---------------------------------------------------------- */
695. # ZONE SETTINGS:
696. /* ---------------------------------------------------------- */
697. /* These are the Zone Names */
698. /* Regular is at the end but otherwise */
699. /* this is in the order they appear on disk */
700. 
701. # Os Programs.
702. SetVariable(ZoneLabelBoot, 				"Boot")
703. SetVariable(ZoneLabelBootData, 				"BootData")
704. SetVariable(ZoneLabelProgramHints,			"ProgramHints")
705. SetVariable(ZoneLabelProgramHintsData,			"ProgramHintsData")
706. SetVariable(ZoneLabelPrograms,				"Programs")
707. SetVariable(ZoneLabelProgramsWindows,			"ProgramsWindows")
708. SetVariable(ZoneLabelProgramsData,			"ProgramsData")
709. # Moved to after Mft & Dir.
710. SetVariable(ZoneLabelPageHiperDump,			"PageHiperDump")
711. 
712. # Os Mft & Directories.
713. SetVariable(ZoneLabelMft,				"MFT")
714. SetVariable(ZoneLabelDir,				"DIR")
715. 
716. # Standard Zones.
717. SetVariable(ZoneLabelIdeScripts, 			"IdeScripts")
718. SetVariable(ZoneLabelDevToDo, 				"DevToDo")
719. SetVariable(ZoneLabelLinksCorp, 			"LinksCorp")
720. SetVariable(ZoneLabelPeople, 				"People")
721. # MFT.
722. # DIR.
723. # Games. 
724. SetVariable(ZoneLabelGames, 				"Games")
725. SetVariable(ZoneLabelShares, 				"Shares")
726. SetVariable(ZoneLabelSystemOtherData, 			"SystemOtherData")
727. SetVariable(ZoneLabelReference, 			"Reference")
728. 
729. 
730. # Sys.
731. # People.
732. # OS, Mft, Dir.
733. # Games.
734. SetVariable(ZoneLabelRegular, 				"Regular")
735. 
736. # Common.
737. SetVariable(ZoneLabelSpaceHogs, 			"SpaceHogs")
738. SetVariable(ZoneLabelArchivesBu, 			"ArchivesBu")
739. 
740. /* ---------------------------------------------------------- */
741. /* Use however you like */
742. 
743. # Os Programs.
744. SetVariable(ZoneDescriptionBoot, 			"!ZoneLabelBoot!")
745. SetVariable(ZoneDescriptionBootData, 			"!ZoneLabelBootData!")
746. SetVariable(ZoneDescriptionProgramHints, 		"!ZoneLabelProgramHints!")
747. SetVariable(ZoneDescriptionProgramHintsData, 		"!ZoneLabelProgramHintsData!")
748. SetVariable(ZoneDescriptionPrograms, 			"!ZoneLabelPrograms!")
749. SetVariable(ZoneDescriptionProgramsWindows, 		"!ZoneLabelProgramsWidows!")
750. SetVariable(ZoneDescriptionProgramsData, 		"!ZoneLabelProgramsData!")
751. SetVariable(ZoneDescriptionPageHiperDump, 		"!ZoneLabelPageHiperDump!")
752. 
753. # Os Mft & Directories.
754. SetVariable(ZoneDescriptionMft, 			"!ZoneLabelMft!")
755. SetVariable(ZoneDescriptionDir, 			"!ZoneLabelDir!")
756. 
757. # Standard Zones:
758. SetVariable(ZoneDescriptionIdeScripts, 			"!ZoneLabelIdeScripts!")
759. SetVariable(ZoneDescriptionDevToDo, 			"!ZoneLabelDevToDo!")
760. SetVariable(ZoneDescriptionLinksCorp, 			"!ZoneLabelLinksCorp!")
761. SetVariable(ZoneDescriptionPeople, 			"!ZoneLabelPeople!")
762. # MFT.
763. # DIR.
764. # Games. 
765. SetVariable(ZoneDescriptionGames, 			"!ZoneLabelGames!")
766. SetVariable(ZoneDescriptionShares, 			"!ZoneLabelShares!")
767. SetVariable(ZoneDescriptionSystemOtherData, 		"!ZoneLabelSystemOtherData!")
768. SetVariable(ZoneDescriptionReference, 			"!ZoneLabelReference!")
769. 
770. # Sys.
771. # People.
772. # OS, Mft, Dir.
773. SetVariable(ZoneDescriptionRegular, 			"!ZoneLabelRegular!")
774. 
775. SetVariable(ZoneDescriptionSpaceHogs, 			"!ZoneLabelSpaceHogs!")
776. SetVariable(ZoneDescriptionArchivesBu, 			"!ZoneLabelArchivesBu!")
777. 
778. /* ---------------------------------------------------------- */
779. /* This rounds up to even locations on the volume to keep */
780. /* the location of data relatively stable during fluctuation. */
781. 
782. /* NOTE: For Volume specifice settings you would have to copy these */
783. /* next two sections and use them in the SettingsYours\SettingsYours for each Volume. */
784. /* You would need a copy of these two to use in a Reset function between Volumes. */
785. 
786. # Os Programs.
787. SetVariable(ZoneVolRoundUpBoot, 		"!VolumeRoundUpSmall!")
788. SetVariable(ZoneVolRoundUpProgramHints, 	"!VolumeRoundUpSmall!")
789. SetVariable(ZoneVolRoundUpPrograms, 		"!VolumeRoundUpMedium!")
790. SetVariable(ZoneVolRoundUpPageHiperDump,	"!VolumeRoundUpSmall!")
791. 
792. # Os Mft & Directories.
793. SetVariable(ZoneVolRoundUpMft,			"!VolumeRoundUpTiny!")
794. SetVariable(ZoneVolRoundUpDir,		 	"!VolumeRoundUpLarge!")
795. 
796. # Standard Zones.
797. SetVariable(ZoneVolRoundUpIdeScripts, 		"!VolumeRoundUpSmall!")
798. SetVariable(ZoneVolRoundUpDevToDo, 		"!VolumeRoundUpSmall!")
799. SetVariable(ZoneVolRoundUpLinksCorp, 		"!VolumeRoundUpSmall!")
800. SetVariable(ZoneVolRoundUpPeople, 		"!VolumeRoundUpMedium!")
801. # MFT.
802. # DIR.
803. # Games. 
804. # ToDo.............
805. SetVariable(ZoneVolRoundUpGames, 		"!VolumeRoundUpSmall!")
806. SetVariable(ZoneVolRoundUpShares, 		"!VolumeRoundUpSmall!")
807. SetVariable(ZoneVolRoundUpSystemOtherData, 	"!VolumeRoundUpSmall!")
808. SetVariable(ZoneVolRoundUpReference, 		"!VolumeRoundUpMedium!")
809. 
810. # Sys.
811. # People.
812. # OS, Mft, Dir.
813. # Games.
814. SetVariable(ZoneVolRoundUpRegular, 		"!VolumeRoundUpMedium!")
815. 
816. # Common.
817. SetVariable(ZoneVolRoundUpSpaceHogs, 		"!VolumeRoundUpMedium!")
818. SetVariable(ZoneVolRoundUpArchivesBu, 		"!VolumeRoundUpTiny!")
819. 
820. /* ---------------------------------------------------------- */
821. /* Your Zone Gap consumption of free space as a percentage. */
822. /* Clearly this can not exceed 100%. Keep it under 99%. */
823. 
824. # Os Programs.
825. SetVariable(ZoneGapSizeBoot, 				"!ZoneGapSizeTiny!")
826. SetVariable(ZoneGapSizeProgramHints,	 		"!ZoneGapSizeTiny!")
827. SetVariable(ZoneGapSizePrograms, 			"!ZoneGapSizeSmall!")
828. SetVariable(ZoneGapSizePageHiperDump, 			"!ZoneGapSizeSmall!")
829. 
830. # Mft & Directories.
831. SetVariable(ZoneGapSizeMft, 				"!ZoneGapSizeTiny!")
832. SetVariable(ZoneGapSizeDir,		 		"!ZoneGapSizeTiny!")
833. 
834. # Standard Zones.
835. SetVariable(ZoneGapSizeIdeScripts, 			"!ZoneGapSizeMedium!")
836. SetVariable(ZoneGapSizeDevToDo, 			"!ZoneGapSizeMedium!")
837. SetVariable(ZoneGapSizeLinksCorp, 			"!ZoneGapSizeMedium!")
838. SetVariable(ZoneGapSizePeople, 				"!ZoneGapSizeMedium!")
839. # MFT.
840. # DIR.
841. # Games. 
842. # ToDo.............
843. SetVariable(ZoneGapSizeGames, 				"!ZoneGapSizeMedium!")
844. SetVariable(ZoneGapSizeShares, 				"!ZoneGapSizeMedium!")
845. SetVariable(ZoneGapSizeSystemOtherData, 		"!ZoneGapSizeMedium!")
846. SetVariable(ZoneGapSizeReference, 			"!ZoneGapSizeSmall!")
847. 
848. # Sys.
849. # People.
850. # OS, Mft, Dir.
851. # Games.
852. SetVariable(ZoneGapSizeRegular, 			"!ZoneGapSizeMedium!")
853. 
854. # Common.
855. SetVariable(ZoneGapSizeSpaceHogs, 			"!ZoneGapSizeMedium!")
856. SetVariable(ZoneGapSizeArchivesBu, 			"!ZoneGapSizeTiny!")
857. 
858. /* ---------------------------------------------------------- */
859. # ZONE CALCULATION METHODS:
860. # OS ZONE SETTINGS:
861. /* ---------------------------------------------------------- */
862. 
863. 	/* ---------------------------------------------------------- */
864. 	# VOLUME MFT Location.
865. 	/* The Volume Location of the MFT as a percentage of the Volume. */
866. 		
867. 		SetVariable(MftVolumeRoundUp, 		"!VolumeRoundUpLarge!")
868. 		SetVariable(MftVolumeGapSize, 		"!ZoneGapSizeTiny!")
869. 		
870. 		# MFT CALCULATION METHODS.
871. 			# STANDARD Method.
872. 			/* IMPORTANT: Standard method currently in use. */
873. 			/* IE: The others below are ignored but instructive. */
874. 			/* None of the following settings are used, hence zero. */
875. 			SetVariable(MftPer, 			0)
876. 			SetVariable(MftLocation, 		0)
877. 			
878. 			# MFT Method.
879. 			/* Place files at X% (MftPerSys) into the data on the Volume. */
880. 			/* This is really tied the ratio of executables to data and blobs. */
881. 			# SetVariable(MftPer, 			0.30)
882. 			# SetVariable(MftLocation, 		1000000000)
883. 			# SetVariable(MftGapSize, 		"!ZoneGapSizeLarge!")
884. 		
885. 			# FIXED Method.
886. 			# SetVariable(MftLocation, 		1000000000) // (IE. Yours)
887. 			# SetVariable(MftPer, 			MftLocation / VolumeSize)
888. 			
889. 			# ORIGINAL Method.
890. 			/* DEPRECIATED, not in use. */
891. 			/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
892. 			# SetVariable(MftPer, 			0.30)
893. 		
894. 		# ROUNDING.	
895. 		# SetVariable(MftLocation,			RoundUp(MftLocation, VolumeSize * MftVolumeRoundUp))
896. 		
897. 		# MFT ZONE.
898. 		/* Zone Number (not used for locating MFT.) */
899. 		SetVariable(MftZone, 				4) // Insert before this zone, info only.
900. 		/* Zone 10 on the Dev Volume */
901. 	
902. 	/* ---------------------------------------------------------- */
903. 	# VOLUME SPECIFIC MFT.
904. 	/* Note: You may need to set Volume specific values for the MFT location, */
905. 	/* On these volume types do not "push" the data above the MFT table? */
906. 	/* You can use a standard gap instead. */
907. 		
908. 			/* The current Volume Type Mft Percentage */
909. 		    # SetVariable(MftPer, 				0)
910. 		    # SetVariable(MftPerTypedDefault, 			"!MftPer!")
911. 			# Volume Types:	
912. 			#         SetVariable(MftPerSys, 		0.35)
913. 			# 	    SetVariable(MftPerDev, 		0.10)
914. 			# 	   SetVariable(MftPerData, 		0.35)
915. 			# 	SetVariable(MftPerArchive, 		0.10)
916. 	
917. 	/* ---------------------------------------------------------- */
918. 	# VOLUME DIR Location.
919. 	/* The amount of Gap between Mft and Dir's, the Location of DIR. */
920. 	
921. 		/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
922. 	
923. 		SetVariable(DirVolumeRoundUp, 		"!VolumeRoundUpLarge!")
924. 		SetVariable(DirVolumeGapSize, 		"!ZoneGapSizeLarge!")
925. 		
926. /* ---------------------------------------------------------- */
927. # SETTINGS YOURS
928. /* empty */
929. 
930. /* ---------------------------------------------------------- */
931. 
932. /* ---------------------------------------------------------- */
933. # STATISTICS
934. /* ---------------------------------------------------------- */
935. 
936. /* Xinclude "..\StatisticsInitialization.MyDc"X ToDo */
937. 
938. 
939. /* ---------------------------------------------------------- */
940. # GAPS
941. 	# TEST (FAILED!!!) NO BOOLEAN LOGIC AVAILABLE.
942. 	SetVariable(FlagDoNotVacate, 0)
943.  
944. /* ---------------------------------------------------------- */
945. # ZONE
946. 	SetVariable(ZoneNoCurrent, 		0)
947. 	SetVariable(ZoneNoAdjCurrent, 	0) 
948. 	SetVariable(ZoneCurrentAjust,	0)
949. 
950. 	SetVariable(ZoneListByLine, 		"Volume started.
951. ")
952. 	SetVariable(ZoneStepByLine, 		"Initialize.
953. ")
954. 	SetVariable(ZoneStatisticsDetail, 	"")
955. 
956. /* ---------------------------------------------------------- */
957. # ZONE FILE STEP (ACTIONS)
958. 	/* Nothing to set here */
959. 
960. /* ---------------------------------------------------------- */
961. # BLOB SIZE
962. 
963. 	# Size 10MB
964. 	SetVariable(BlobFileSize, 10000000)
965. 
966. /* ---------------------------------------------------------- */
967. # SKIP BLOCK
968.  
969. /* (important for run efficiency.) */
970. /* FILES: */
971. /* Day Files: 100 */
972. /* Monthly: 500 */
973. /* Yearly: 1M */
974. 
975. 	/* 100 Files - moved most blocks */
976. 	 /* 10 Files - 20211105 (error - not done) */ 
977. 	 /* 10 Files - (20211106) - Current */
978. 	 /* 5 Files - (2021????) - */
979. 	SetVariable(SkipBlockFilesDay, 10)
980. 
981. 	SetVariable(SkipBlockFilesMonth, 500)
982. 	SetVariable(SkipBlockFilesYear, 1000000)
983. 
984. 	/* Current: */
985. 	SetVariable(SkipBlockFiles,"!SkipBlockFilesMonth!")
986. 
987. /* BYTES: */
988. /* Day Bytes: 50MB */
989. /* Month Bytes: 500MB */
990. /* Year Bytes: 5GB */
991. 
992. 	 /* 50 MB Moved most existing blocks */
993. 	 /* 5 MB 20211105 (not done) */ 
994. 	 /* 1 MB 20211105 - Current */
995. 	SetVariable(SkipBlockBytesDay, 1000000)
996. 	/* SetVariable(SkipBlockBytesDay, 50000000) */
997. 
998. 	SetVariable(SkipBlockBytesMonth, 500000000)
999. 	SetVariable(SkipBlockBytesYear, 5000000000)
1000. 
1001. 	/* Current: */
1002. 	SetVariable(SkipBlockBytes,"!SkipBlockBytesMonth!")
1003. 
1004. /* ---------------------------------------------------------- */
1005. # ZONE LOCATION METHODS:
1006. 
1007. # No 1) Standard. You can ignore this section
1008. 	/* Gaps between zones are a percentage of */
1009. 	/* free space auto adjusted to pack the used */
1010. 	/* space closely together and for performance. */
1011. 	
1012. 	/* The calculation will clear the Gap */
1013. 	/* and RoundUp to the fixed value present */
1014. 	
1015. 	SetVariable(ZoneMethodStd, 1)
1016. 
1017. /* The following are NOT FULLY IMPLEMENTED OR TESTED */
1018. # No 2) Mft. Relative to its location.
1019. 	SetVariable(ZoneMethodMft, (0-1))
1020. 
1021. # No 3) Os. Percentages are AFTER OsMftDir Space Used.
1022. 	SetVariable(ZoneMethodOs, (0-1))
1023. 
1024. # No 4) Orginal Mft/Os 1-5.
1025. 	SetVariable(ZoneMethodOrginal, (0-1))
1026. 
1027. # No 5) FIXED ZONES if you used them.
1028. 	
1029. 	SetVariable(ZoneMethodFixed, (0-1))
1030. 	SetVariable(ZoneMethodFixedPer, (0-1))
1031. 
1032. 	/* Not recommended */
1033. 	/* However doing all calcs is informative regarding what */
1034. 	/* Types of Volume data (Zones) exist. */
1035. 	
1036. 	/* Your FIXED calculation method, this can be: */
1037. 	SetVariable(ZoneMethodFixedVariantPer, (0-1))
1038. 	
1039. 	/* 1) Percentage. */
1040. 		/* So when it is 1 or On. */
1041. 		/* Not great but easy to use. */
1042. 		 
1043. 	/* 2) Fixed volume location. */
1044. 		/* When 0 or Off it is a volume location. */
1045. 		/* You will have to change: */
1046. 		/* file item xxxxxxxxx??? */
1047. 	
1048. 	/* FIXED VALUES: */
1049. 		/* SetVariable(ZoneMethodFixed, 1) */
1050. 	
1051. 		# Setting the following to a percentage or number:
1052. 		/* OS */
1053. 	    SetVariable(ZoneOsBoot, 0) // 1
1054. 	    SetVariable(ZoneOsProgramHints, 0) // 2
1055. 	    SetVariable(ZoneOsPrograms, 0) // 3
1056. 	    
1057. 	    /* MFT */
1058. 	    SetVariable(ZoneMft, 0) // Volume dependent
1059. 	    SetVariable(ZoneMftDir, 0) // Volume dependent
1060. 	
1061. 		/* Volume Sys */
1062. 	    # Os 3
1063. 	    # Mft + 2
1064. 	    SetVariable(ZoneSysRegular, 0) // 5
1065. 	    SetVariable(ZoneDevSpaceHog, 0) // 6
1066. 	
1067. 		/* Volume Dev */
1068. 	    # Os 3
1069. 	    SetVariable(ZoneDevDevToDo, 0) // 4
1070. 	    SetVariable(ZoneDevIdeScripts, 0) // 5
1071. 	    SetVariable(ZoneDevLinksCorp, 0) // 6
1072. 	    SetVariable(ZoneDevPeople, 0) // 7
1073. 	    # Mft + 2
1074. 	    SetVariable(ZoneDevShares, 0) // 10
1075. 	    SetVariable(ZoneDevSystemOtherData, 0) // 11
1076. 	    SetVariable(ZoneDevReference, 0) // 12
1077. 	    SetVariable(ZoneDevSpaceHogsArchives, 0) // 13
1078. 	
1079. 		/* Volume Archive not used currently */
1080. 		/* Volume Data not used currently */
1081. 
1082. /* ---------------------------------------------------------- */
1083. # LOGGING:
1084. /* ---------------------------------------------------------- */
1085. 
1086. 	# Log File Name:
1087. 	SetVariable(LogFileName,"Defrag !MdmMyDefrag! 2021-11-09_18:53:49.log")
1088. 	/* SetVariable(LogFileName,"..\Logs\!MdmMyDefrag! 2021-11-09_18:53:49.log") */
1089. 	/* SetVariable(LogFileName,"!ScriptDir!Logs\!MdmMyDefrag! 2021-11-09_18:53:49.log") */
1090. 	/* SetVariable(LogFileName,"Defrag2021-11-09_18:53:49.txt") */
1091. 	/* SetVariable(LogFileName,"$ z Logs\Defrag2021-11-09_18:53:49.txt") */
1092. 	
1093. 	SetVariable(VolumeStatisticsSummary, "Not ready")
1094. 	SetVariable(VolumeStatisticsDetailed, "Not ready")
1095. 
1096. /* ---------------------------------------------------------- */
1097. # OVERRIDES
1098. /* ---------------------------------------------------------- */
1099. 
1100. 	# YOUR SETTINGS Volume overrides:
1101. 	/* empty */
1102. 
1103. 
1104. /* ---------------------------------------------------------- */
1105. # Create Run Log:
1106. 
1107. /* Write the header to the logfile. */
1108. 	# Script: BannerSet
1109. 
1110. # Script: DisplaySetDateTimeRun
1111. 
1112. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
1113. /* Xinclude "..\Display\BannerSet.MyDc"X */
1114. /* pause(1) */
1115. 
1116. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1117. 
1118. Title('!Heading!')
1119. /* pause(1) */
1120. 
1121. /* NOTE: Can't round or truncate to integer precision. */
1122. 
1123. 
1124. 	WriteLogfile("!LogFileName!", "Started.")
1125. 	AppendLogfile("!LogFileName!", ".")
1126. 	# Script: BannerLog
1127. 
1128. AppendLogfile("!LogFileName!", "!Title!")
1129. 
1130. 
1131. 	AppendLogfile("!LogFileName!", ".")
1132. 
1133. /* ---------------------------------------------------------- */
1134. /* Script Information */
1135. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-11-09 18:53:49")
1136. 	AppendLogfile("!LogFileName!", ".")
1137. 	AppendLogfile("!LogFileName!", "Script:")
1138. 	AppendLogfile("!LogFileName!", "DefragDevDiskDaily")
1139. 	AppendLogfile("!LogFileName!", ".")
1140. 	AppendLogfile("!LogFileName!", "Script Directory:")
1141. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1142. 	AppendLogfile("!LogFileName!", ".")
1143. 	AppendLogfile("!LogFileName!", "Log File:")
1144. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1145. 	AppendLogfile("!LogFileName!", ".")
1146. 
1147. /* ---------------------------------------------------------- */
1148. # Run Preprocessing Do Before.
1149. /* empty */
1150. 
1151. 
1152. 
1153. /* SkipBlock Daily: */
1154. SetVariable(SkipBlockFiles,"!SkipBlockFilesDay!")
1155. SetVariable(SkipBlockBytes,"!SkipBlockBytesDay!")
1156. 
1157. # Defrag Development Volume
1158. 
1159. SetVariable(VolumeLabel,"!VolumeDev!")
1160. SetVariable(VolumeDescription,"Development")
1161. # Script: DisplaySetVolume
1162. 
1163. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1164. SetVariable(ZoneStepDescription,	"")
1165. SetVariable(FileStepDescription,	"")
1166. 
1167. SetVariable(ZoneListByLine, 		"Volume started 2021-11-09 18:53:49 0:00:05:
1168. ")
1169. SetVariable(ZoneStepByLine, 		"Pending.")
1170. 
1171. # Script: BannerDescriptionSet
1172. 
1173. # Script: BannerSet
1174. 
1175. # Script: DisplaySetDateTimeRun
1176. 
1177. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
1178. /* Xinclude "..\Display\BannerSet.MyDc"X */
1179. /* pause(1) */
1180. 
1181. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1182. 
1183. Title('!Heading!')
1184. /* pause(1) */
1185. 
1186. /* NOTE: Can't round or truncate to integer precision. */
1187. 
1188. # Script: BannerLog
1189. 
1190. AppendLogfile("!LogFileName!", "!Title!")
1191. 
1192. 
1193. 
1194. pause(2)
1195. 
1196. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1197. 
1198. SetVariable(ZoneListByLine, "")
1199. SetVariable(ZoneFooter, "")
1200. 
1201. # This script is part of the standard disk configuration
1202. # Author: David G. Horsman (DBA MacroDM) (C) 2019
1203. # based on MyDefrag distribution.
1204. 
1205. /* Progress Display */
1206. SetVariable(ZoneListByLine, 	"Volume start.
1207. ")
1208. SetVariable(ZoneStepByLine, 	"
1209. ")
1210. 
1211. # VOLUME INFORMATION
1212. 
1213. SetVariable(VolumeNoCurrent, VolumeNoCurrent + 1)
1214. SetVariable(VolumeNoAdjCurrent, VolumeNoCurrent + VolumeCurrentAjust)
1215. 
1216. SetVariable(ZoneNoCurrent, 		0)
1217. SetVariable(ZoneNoAdjCurrent, 	0) 
1218. SetVariable(ZoneCurrentAjust,	0)
1219. 
1220. SetVariable(ZoneListByLine, 		"Volume started.
1221. ")
1222. SetVariable(ZoneStepByLine, 		"Initialize.
1223. ")
1224. SetVariable(ZoneStatisticsDetail, 	"")
1225. 
1226. SetVariable(ZoneStepNoCurrent, 0)
1227. 
1228. 
1229. # Script: ZoneDoCurrentClear
1230. 
1231. SetVariable(ZoneTypeSelectCurrent, 		"")
1232. 
1233. SetVariable(ZoneBeginCurrent, 			0)
1234. SetVariable(ZoneBeginPerCurrent, 		0)
1235. SetVariable(ZoneEndCurrent, 			0)
1236. SetVariable(ZoneEndPerCurrent, 			0)
1237. 
1238. SetVariable(ZoneSizeCurrent,			0)
1239. SetVariable(ZoneSizePerCurrent,			0)
1240. 
1241. SetVariable(ZoneGapRequestedCurrent,	0)
1242. SetVariable(ZoneGapRoundedCurrent, 		0)
1243. SetVariable(ZoneGapAdjustedCurrent, 	0)
1244. SetVariable(ZoneGapAvailableCurrent, 	0)
1245. SetVariable(ZoneGapCurrent,				0)
1246. SetVariable(ZoneGapUsedCurrent, 		0)
1247. 
1248. SetVariable(ZoneGapActualCurrent, 		0)
1249. SetVariable(ZoneGapActualPerCurrent, 	0)
1250. 
1251. SetVariable(ZoneSizeActual, 			0)
1252. SetVariable(ZoneSizeActualCurrent,		0)
1253. 
1254. SetVariable(ZoneEndActual, 				0)
1255. SetVariable(ZoneEndActualCurrent,		0)			
1256. SetVariable(ZoneSizeActualPerCurrent, 	0)
1257.       
1258. SetVariable(ZoneFilesFolders,			0)
1259. SetVariable(ZoneFilesFoldersPer,		0) 
1260. 
1261. SetVariable(ZoneFragments,				0)
1262. SetVariable(ZoneFragmentsPer,			0) 
1263. 		
1264. SetVariable(ZoneEndActualCurrent, 		0)
1265. SetVariable(ZoneEndActualPerCurrent, 	0)
1266. 
1267. # Gap Calculation Methodology:
1268. 	# Requested
1269. 	SetVariable(GapRequested, 			0) 
1270. 	SetVariable(GapRequestedStd, 		0) 
1271. 	SetVariable(GapRequestedMft, 		0) 
1272. 	SetVariable(GapRequestedOs, 		0) 
1273. 	SetVariable(GapRequestedOriginal, 	0) 
1274. 	
1275. 	# Gap Adjustments
1276. 	SetVariable(GapRounded, 			0)
1277. 	# SetVariable(GapAdjusted, 			0)
1278. 	SetVariable(GapAvailable, 			0)
1279. 	SetVariable(GapCurrent, 			0)
1280. 	SetVariable(GapActual, 				0)
1281. 	SetVariable(GapUsed, 				0)
1282. 	
1283. 	# Gap Adjustments
1284. 	SetVariable(GapRoundedLoc, 			0)
1285. 	# SetVariable(GapAdjustedLoc, 		0)
1286. 	SetVariable(GapAvailableLoc, 		0)
1287. 	SetVariable(GapCurrentLoc, 			0)
1288. 	SetVariable(GapActualLoc,			0)
1289. 	SetVariable(GapUsedLoc,				0)
1290. 	
1291. 	# Space usage
1292. 	SetVariable(ZoneFreePerRequested, 	0)
1293. 	SetVariable(ZoneFreePerUsed, 		0)
1294. 
1295. # Gap Size & Rounding
1296. 	SetVariable(ZoneGapSizePer, 		0)
1297. 	SetVariable(ZoneVolRoundUpPer, 		0)
1298. 	
1299. 	# Free Space
1300. 	SetVariable(ZoneFreeUsedPer, 		0)
1301. 	SetVariable(ZoneFreeRequestedPer, 	0)
1302. 
1303. 
1304. # Script: BannerSet
1305. 
1306. # Script: DisplaySetDateTimeRun
1307. 
1308. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
1309. /* Xinclude "..\Display\BannerSet.MyDc"X */
1310. /* pause(1) */
1311. 
1312. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1313. 
1314. Title('!Heading!')
1315. /* pause(1) */
1316. 
1317. /* NOTE: Can't round or truncate to integer precision. */
1318. 
1319. 
1320. # OVERRIDES
1321. # YOUR SETTINGS Volume overrides:
1322. 
1323. 
1324. # SET
1325. # SetVariable(VolumeSys,"C:")
1326. 
1327. 
1328. # Script: DisplaySetVolume
1329. 
1330. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1331. SetVariable(ZoneStepDescription,	"")
1332. SetVariable(FileStepDescription,	"")
1333. 
1334. SetVariable(ZoneListByLine, 		"Volume started 2021-11-09 18:53:49 0:00:05:
1335. ")
1336. SetVariable(ZoneStepByLine, 		"Pending.")
1337. 
1338. # Script: BannerDescriptionSet
1339. 
1340. # Script: BannerSet
1341. 
1342. # Script: DisplaySetDateTimeRun
1343. 
1344. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
1345. /* Xinclude "..\Display\BannerSet.MyDc"X */
1346. /* pause(1) */
1347. 
1348. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1349. 
1350. Title('!Heading!')
1351. /* pause(1) */
1352. 
1353. /* NOTE: Can't round or truncate to integer precision. */
1354. 
1355. # Script: BannerLog
1356. 
1357. AppendLogfile("!LogFileName!", "!Title!")
1358. 
1359. 
1360. 
1361. pause(2)
1362. 
1363. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1364. 
1365. # LOGGING:
1366. 	# Script: BannerDescriptionSet
1367. 
1368. # Script: BannerSet
1369. 
1370. # Script: DisplaySetDateTimeRun
1371. 
1372. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
1373. /* Xinclude "..\Display\BannerSet.MyDc"X */
1374. /* pause(1) */
1375. 
1376. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1377. 
1378. Title('!Heading!')
1379. /* pause(1) */
1380. 
1381. /* NOTE: Can't round or truncate to integer precision. */
1382. 
1383. # Script: BannerLog
1384. 
1385. AppendLogfile("!LogFileName!", "!Title!")
1386. 
1387. 
1388. 
1389. 
1390. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-11-09 18:53:49")
1391. 	AppendLogfile("!LogFileName!", ".")
1392. 	AppendLogfile("!LogFileName!", "Script Directory:")
1393. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1394. 	AppendLogfile("!LogFileName!", ".")
1395. 	AppendLogfile("!LogFileName!", "Log File:")
1396. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1397. 	AppendLogfile("!LogFileName!", ".")
1398. 	/* AppendLogfile("!LogFileName!", "Log Header:") */
1399. 	/* AppendLogfile("!LogFileName!", "!LogHeader!") */
1400. 	/* AppendLogfile("!LogFileName!", "End of Log Header.") */
1401. 	AppendLogfile("!LogFileName!", ".")
1402. 
1403. 	AppendLogfile("!LogFileName!", "MFT Percentage: !MftPer!")
1404. 	AppendLogfile("!LogFileName!", "MFT Volume RoundUp: !MftRoundUp!")
1405. 	AppendLogfile("!LogFileName!", "MFT Gap %: !MftAdjRoundUp!")
1406. 	AppendLogfile("!LogFileName!", ".")
1407. 
1408. /* This file is where you override the above setting for */
1409. /* global settings. */
1410. /* There is a "SettingsYours\SettingsYours???.MyDc" for each volume type */
1411. /* so this is where you set the volume specific settings */
1412. /* or you can put them all in the file below. */
1413. 
1414. # Volume Preprocessing Do Before.
1415. /* empty */
1416. 
1417. 
1418. # BANNER:
1419. /* Xinclude "..\Display\VolumeSizeLog.MyDc"X */
1420. 
1421. /* Missed: ToDo: */
1422. /* Games Zone Type */
1423. 
1424. 
1425. 
1426. 
1427. SetVariable(MftZone, "Shares")
1428. 
1429. /* empty */
1430. 
1431. 
1432. # Script: DefragAnyComplexVolume
1433. /* Complex Volume */
1434. # MyDefrag v4.0 script: Defrag Complex (Mixed or Any) Volume.
1435. 
1436. # Script: VolumeStatisticsDetailGet
1437. 
1438. # Set Volume summary stats:
1439. 
1440. # Cluster, Sector, Block adjust for display.
1441. # Bytes per cluster is volume specific.
1442. 
1443. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1444. 
1445. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1446. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1447. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1448. 
1449. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1450. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1451. 
1452. # Set the display text:
1453. # Script: VolumeStatisticsSummaryDisplay
1454. 
1455. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1456. SUMMARY: !VolumeLabel! !VolumeDescription!
1457.   
1458.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1459.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1460.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1461.          
1462.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1463.       Volume Free Adj:       !VolumeFreeAdj!
1464.     Bytes per cluster:       !BytesPerCluster! bytes
1465. 
1466.    Unfragmented Items:       !FILES200N!
1467.      Fragmented Items:       !FILES210N!
1468. 
1469.     Unfragmented Data:       !FILES202N! bytes
1470.       Fragmented Data:       !FILES212N! bytes
1471. 
1472.              All Gaps:       !GAP00N!
1473.              All gaps:       !GAP10N! bytes
1474.           Average gap:       !GAP13N! bytes
1475.            Median gap:       !GAP14N! bytes
1476.           Biggest gap:       !GAP15N! bytes
1477. ----------------------------------------------------------
1478. ") 
1479. 
1480. 
1481. 
1482. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1483. VOLUME: !VolumeLabel! !VolumeDescription!
1484. ----------------------------------------------------------
1485. !VolumeStatisticsSummary!
1486. ----------------------------------------------------------
1487. DETAILS: !VolumeLabel! !VolumeDescription!
1488. ----------------------------------------------------------
1489. 
1490. SUMMARY:
1491. 
1492. Volume label/name:          !VolumeLabel!
1493. Volume mountpoint:          !MountPoint!
1494. Volume name:                !VolumeName!
1495. Volume type:                !VolumeType!
1496. 
1497. Total disk space:           !VolumeSize! bytes
1498.                             !VolumeSizeG! gigabytes
1499. 
1500. Bytes per cluster:          !BytesPerCluster! bytes
1501. Average end-begin distance: !AverageBeginEndDistance! clusters
1502.                             !AverageBeginEndDistanceP!% of volume size
1503. 
1504. ----------------------------------------------------------
1505. FRAGMENTS:
1506. 
1507. Unfragmented Items: !FILES200N!
1508.   Fragmented Items: !FILES210N!
1509.  Unfragmented Data: !FILES202N! bytes
1510.    Fragmented Data: !FILES212N! bytes
1511. Gaps:
1512.           All Gaps: !GAP00N!
1513.           All gaps: !GAP10N! bytes
1514.        Average gap: !GAP13N! bytes
1515.         Median gap: !GAP14N! bytes
1516.        Biggest gap: !GAP15N! bytes
1517. 
1518. ----------------------------------------------------------
1519. GAPS:
1520. 
1521.    ----------------------------------------------------------
1522.    Counts:
1523.                        Count      Percentage of all
1524.                 ----------------- -----------------
1525.    Small gaps   !GAP01N! !GAP01P!%
1526.    Big gaps     !GAP02N! !GAP02P!%
1527.                 ----------------- -----------------
1528.    All gaps     !GAP00N! !GAP00P!
1529. 
1530.    ----------------------------------------------------------
1531.    By size:
1532.                       Bytes          Gigabytes      Percentage of all
1533.                 ----------------- ----------------- -----------------
1534.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1535.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1536.                 ----------------- ----------------- -----------------
1537.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1538. 
1539.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1540.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1541.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1542.    ----------------------------------------------------------
1543. 
1544. ----------------------------------------------------------
1545. FILE STATISTICS:
1546. ----------------------------------------------------------
1547. 
1548. ----------------------------------------------------------
1549. ITEM COUNT:
1550. ----------------------------------------------------------
1551. Number of files and folders:
1552. 
1553.               Unfragmented       Fragmented            All
1554.    ------- ----------------- ----------------- -----------------
1555.    Files   !FILES000N! !FILES010N! !FILES020N!
1556.    Folders !FILES100N! !FILES110N! !FILES120N!
1557.    ------- ----------------- ----------------- -----------------
1558.    All     !FILES200N! !FILES210N! !FILES220N!
1559. 
1560. ----------------------------------------------------------
1561. Percentage of total:
1562. 
1563.               Unfragmented       Fragmented            All
1564.    ------- ----------------- ----------------- -----------------
1565.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1566.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1567.    ------- ----------------- ----------------- -----------------
1568.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1569. 
1570. ----------------------------------------------------------
1571. OCCUPIED SIZE on disk:
1572. ----------------------------------------------------------
1573. Bytes:
1574.               Unfragmented       Fragmented            All
1575.    ------- ----------------- ----------------- -----------------
1576.    Files   !FILES002N! !FILES012N! !FILES022N!
1577.    Folders !FILES102N! !FILES112N! !FILES122N!
1578.    ------- ----------------- ----------------- -----------------
1579.    All     !FILES202N! !FILES212N! !FILES222N!
1580. 
1581. ----------------------------------------------------------
1582. Gigabytes:
1583.               Unfragmented       Fragmented            All
1584.    ------- ----------------- ----------------- -----------------
1585.    Files   !FILES002G! !FILES012G! !FILES022G!
1586.    Folders !FILES102G! !FILES112G! !FILES122G!
1587.    ------- ----------------- ----------------- -----------------
1588.    All     !FILES202G! !FILES212G! !FILES222G!
1589. 
1590. ----------------------------------------------------------
1591. Percentage:
1592.               Unfragmented       Fragmented            All
1593.    ------- ----------------- ----------------- -----------------
1594.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1595.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1596.    ------- ----------------- ----------------- -----------------
1597.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1598. 
1599. ----------------------------------------------------------
1600. USED SIZE:
1601. ----------------------------------------------------------
1602. Bytes:
1603.               Unfragmented       Fragmented            All
1604.    ------- ----------------- ----------------- -----------------
1605.    Files   !FILES001N! !FILES011N! !FILES021N!
1606.    Folders !FILES101N! !FILES111N! !FILES121N!
1607.    ------- ----------------- ----------------- -----------------
1608.    All     !FILES201N! !FILES211N! !FILES221N!
1609. 
1610. ----------------------------------------------------------
1611. Gigabytes:
1612.               Unfragmented       Fragmented            All
1613.    ------- ----------------- ----------------- -----------------
1614.    Files   !FILES001G! !FILES011G! !FILES021G!
1615.    Folders !FILES101G! !FILES111G! !FILES121G!
1616.    ------- ----------------- ----------------- -----------------
1617.    All     !FILES201G! !FILES211G! !FILES221G!
1618. 
1619. ----------------------------------------------------------
1620. Percentage:
1621.               Unfragmented       Fragmented            All
1622.    ------- ----------------- ----------------- -----------------
1623.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1624.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1625.    ------- ----------------- ----------------- -----------------
1626.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1627. 
1628. ----------------------------------------------------------
1629. Volume Detailed Statistics end.
1630. ----------------------------------------------------------
1631. ") 
1632. 
1633. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1634. 
1635. SetVariable(FileStepDescription,"!VolumeLabel! !VolumeDescription! started: 2021-11-09 18:53:49.")
1636. # Script: DisplaySetFileStep
1637. 
1638. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1639. 
1640. /* add message and move to a new line. */
1641. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1642. ")
1643. 
1644. /* display the line. (hopefully.) */
1645. # Zone Footer Set Statistics Window Text
1646. 
1647. SetStatisticsWindowText("----------------------------------------------------------
1648. Zones Processed: 
1649. ----------------------------------------------------------
1650. !ZoneListByLine!
1651. ----------------------------------------------------------
1652. Zone Processing Step:
1653. !ZoneStepByLine!    
1654. ----------------------------------------------------------
1655. Current Zone:
1656. !ZoneFooter!
1657. ----------------------------------------------------------
1658. Volume Statistics:
1659. !VolumeStatisticsDetail!
1660. ----------------------------------------------------------
1661. Zone Detailed Report:
1662. ----------------------------------------------------------
1663. !ZoneStatisticsDetail!
1664. ----------------------------------------------------------
1665. ")
1666. 
1667. 
1668. 
1669. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1670. 
1671. # Script: BannerSet
1672. 
1673. # Script: DisplaySetDateTimeRun
1674. 
1675. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
1676. /* Xinclude "..\Display\BannerSet.MyDc"X */
1677. /* pause(1) */
1678. 
1679. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1680. 
1681. Title('!Heading!')
1682. /* pause(1) */
1683. 
1684. /* NOTE: Can't round or truncate to integer precision. */
1685. 
1686. pause(1)
1687. 
1688. SetVariable(FileStepDescription,"Analyzing Volume")
1689. # Script: DisplaySetFileStep
1690. 
1691. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1692. 
1693. /* add message and move to a new line. */
1694. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1695. ")
1696. 
1697. /* display the line. (hopefully.) */
1698. # Zone Footer Set Statistics Window Text
1699. 
1700. SetStatisticsWindowText("----------------------------------------------------------
1701. Zones Processed: 
1702. ----------------------------------------------------------
1703. !ZoneListByLine!
1704. ----------------------------------------------------------
1705. Zone Processing Step:
1706. !ZoneStepByLine!    
1707. ----------------------------------------------------------
1708. Current Zone:
1709. !ZoneFooter!
1710. ----------------------------------------------------------
1711. Volume Statistics:
1712. !VolumeStatisticsDetail!
1713. ----------------------------------------------------------
1714. Zone Detailed Report:
1715. ----------------------------------------------------------
1716. !ZoneStatisticsDetail!
1717. ----------------------------------------------------------
1718. ")
1719. 
1720. 
1721. 
1722. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1723. 
1724. # Script: BannerSet
1725. 
1726. # Script: DisplaySetDateTimeRun
1727. 
1728. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
1729. /* Xinclude "..\Display\BannerSet.MyDc"X */
1730. /* pause(1) */
1731. 
1732. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1733. 
1734. Title('!Heading!')
1735. /* pause(1) */
1736. 
1737. /* NOTE: Can't round or truncate to integer precision. */
1738. 
1739. pause(1)
1740. 
1741. /* ---------------------------------------------------------- */
1742. VolumeSelect
1743. 
1744. 	Label("!VolumeLabel!") or Name("!VolumeLabel!")
1745. 
1746. /* ---------------------------------------------------------- */
1747. VolumeActions
1748. 
1749. /* ---------------------------------------------------------- */
1750. /* Volume Init */
1751. # Script: VolumeStatisticsDetailGet
1752. 
1753. # Set Volume summary stats:
1754. 
1755. # Cluster, Sector, Block adjust for display.
1756. # Bytes per cluster is volume specific.
1757. 
1758. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1759. 
1760. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1761. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1762. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1763. 
1764. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1765. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1766. 
1767. # Set the display text:
1768. # Script: VolumeStatisticsSummaryDisplay
1769. 
1770. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1771. SUMMARY: !VolumeLabel! !VolumeDescription!
1772.   
1773.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1774.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1775.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1776.          
1777.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1778.       Volume Free Adj:       !VolumeFreeAdj!
1779.     Bytes per cluster:       !BytesPerCluster! bytes
1780. 
1781.    Unfragmented Items:       !FILES200N!
1782.      Fragmented Items:       !FILES210N!
1783. 
1784.     Unfragmented Data:       !FILES202N! bytes
1785.       Fragmented Data:       !FILES212N! bytes
1786. 
1787.              All Gaps:       !GAP00N!
1788.              All gaps:       !GAP10N! bytes
1789.           Average gap:       !GAP13N! bytes
1790.            Median gap:       !GAP14N! bytes
1791.           Biggest gap:       !GAP15N! bytes
1792. ----------------------------------------------------------
1793. ") 
1794. 
1795. 
1796. 
1797. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1798. VOLUME: !VolumeLabel! !VolumeDescription!
1799. ----------------------------------------------------------
1800. !VolumeStatisticsSummary!
1801. ----------------------------------------------------------
1802. DETAILS: !VolumeLabel! !VolumeDescription!
1803. ----------------------------------------------------------
1804. 
1805. SUMMARY:
1806. 
1807. Volume label/name:          !VolumeLabel!
1808. Volume mountpoint:          !MountPoint!
1809. Volume name:                !VolumeName!
1810. Volume type:                !VolumeType!
1811. 
1812. Total disk space:           !VolumeSize! bytes
1813.                             !VolumeSizeG! gigabytes
1814. 
1815. Bytes per cluster:          !BytesPerCluster! bytes
1816. Average end-begin distance: !AverageBeginEndDistance! clusters
1817.                             !AverageBeginEndDistanceP!% of volume size
1818. 
1819. ----------------------------------------------------------
1820. FRAGMENTS:
1821. 
1822. Unfragmented Items: !FILES200N!
1823.   Fragmented Items: !FILES210N!
1824.  Unfragmented Data: !FILES202N! bytes
1825.    Fragmented Data: !FILES212N! bytes
1826. Gaps:
1827.           All Gaps: !GAP00N!
1828.           All gaps: !GAP10N! bytes
1829.        Average gap: !GAP13N! bytes
1830.         Median gap: !GAP14N! bytes
1831.        Biggest gap: !GAP15N! bytes
1832. 
1833. ----------------------------------------------------------
1834. GAPS:
1835. 
1836.    ----------------------------------------------------------
1837.    Counts:
1838.                        Count      Percentage of all
1839.                 ----------------- -----------------
1840.    Small gaps   !GAP01N! !GAP01P!%
1841.    Big gaps     !GAP02N! !GAP02P!%
1842.                 ----------------- -----------------
1843.    All gaps     !GAP00N! !GAP00P!
1844. 
1845.    ----------------------------------------------------------
1846.    By size:
1847.                       Bytes          Gigabytes      Percentage of all
1848.                 ----------------- ----------------- -----------------
1849.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1850.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1851.                 ----------------- ----------------- -----------------
1852.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1853. 
1854.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1855.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1856.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1857.    ----------------------------------------------------------
1858. 
1859. ----------------------------------------------------------
1860. FILE STATISTICS:
1861. ----------------------------------------------------------
1862. 
1863. ----------------------------------------------------------
1864. ITEM COUNT:
1865. ----------------------------------------------------------
1866. Number of files and folders:
1867. 
1868.               Unfragmented       Fragmented            All
1869.    ------- ----------------- ----------------- -----------------
1870.    Files   !FILES000N! !FILES010N! !FILES020N!
1871.    Folders !FILES100N! !FILES110N! !FILES120N!
1872.    ------- ----------------- ----------------- -----------------
1873.    All     !FILES200N! !FILES210N! !FILES220N!
1874. 
1875. ----------------------------------------------------------
1876. Percentage of total:
1877. 
1878.               Unfragmented       Fragmented            All
1879.    ------- ----------------- ----------------- -----------------
1880.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1881.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1882.    ------- ----------------- ----------------- -----------------
1883.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1884. 
1885. ----------------------------------------------------------
1886. OCCUPIED SIZE on disk:
1887. ----------------------------------------------------------
1888. Bytes:
1889.               Unfragmented       Fragmented            All
1890.    ------- ----------------- ----------------- -----------------
1891.    Files   !FILES002N! !FILES012N! !FILES022N!
1892.    Folders !FILES102N! !FILES112N! !FILES122N!
1893.    ------- ----------------- ----------------- -----------------
1894.    All     !FILES202N! !FILES212N! !FILES222N!
1895. 
1896. ----------------------------------------------------------
1897. Gigabytes:
1898.               Unfragmented       Fragmented            All
1899.    ------- ----------------- ----------------- -----------------
1900.    Files   !FILES002G! !FILES012G! !FILES022G!
1901.    Folders !FILES102G! !FILES112G! !FILES122G!
1902.    ------- ----------------- ----------------- -----------------
1903.    All     !FILES202G! !FILES212G! !FILES222G!
1904. 
1905. ----------------------------------------------------------
1906. Percentage:
1907.               Unfragmented       Fragmented            All
1908.    ------- ----------------- ----------------- -----------------
1909.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1910.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1911.    ------- ----------------- ----------------- -----------------
1912.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1913. 
1914. ----------------------------------------------------------
1915. USED SIZE:
1916. ----------------------------------------------------------
1917. Bytes:
1918.               Unfragmented       Fragmented            All
1919.    ------- ----------------- ----------------- -----------------
1920.    Files   !FILES001N! !FILES011N! !FILES021N!
1921.    Folders !FILES101N! !FILES111N! !FILES121N!
1922.    ------- ----------------- ----------------- -----------------
1923.    All     !FILES201N! !FILES211N! !FILES221N!
1924. 
1925. ----------------------------------------------------------
1926. Gigabytes:
1927.               Unfragmented       Fragmented            All
1928.    ------- ----------------- ----------------- -----------------
1929.    Files   !FILES001G! !FILES011G! !FILES021G!
1930.    Folders !FILES101G! !FILES111G! !FILES121G!
1931.    ------- ----------------- ----------------- -----------------
1932.    All     !FILES201G! !FILES211G! !FILES221G!
1933. 
1934. ----------------------------------------------------------
1935. Percentage:
1936.               Unfragmented       Fragmented            All
1937.    ------- ----------------- ----------------- -----------------
1938.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1939.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1940.    ------- ----------------- ----------------- -----------------
1941.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1942. 
1943. ----------------------------------------------------------
1944. Volume Detailed Statistics end.
1945. ----------------------------------------------------------
1946. ") 
1947. 
1948. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1949. 
1950. SetVariable(FileStepDescription,"Volume started.")
1951. # Script: DisplaySetFileStep
1952. 
1953. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1954. 
1955. /* add message and move to a new line. */
1956. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1957. ")
1958. 
1959. /* display the line. (hopefully.) */
1960. # Zone Footer Set Statistics Window Text
1961. 
1962. SetStatisticsWindowText("----------------------------------------------------------
1963. Zones Processed: 
1964. ----------------------------------------------------------
1965. !ZoneListByLine!
1966. ----------------------------------------------------------
1967. Zone Processing Step:
1968. !ZoneStepByLine!    
1969. ----------------------------------------------------------
1970. Current Zone:
1971. !ZoneFooter!
1972. ----------------------------------------------------------
1973. Volume Statistics:
1974. !VolumeStatisticsDetail!
1975. ----------------------------------------------------------
1976. Zone Detailed Report:
1977. ----------------------------------------------------------
1978. !ZoneStatisticsDetail!
1979. ----------------------------------------------------------
1980. ")
1981. 
1982. 
1983. 
1984. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1985. 
1986. # Script: BannerSet
1987. 
1988. # Script: DisplaySetDateTimeRun
1989. 
1990. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
1991. /* Xinclude "..\Display\BannerSet.MyDc"X */
1992. /* pause(1) */
1993. 
1994. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1995. 
1996. Title('!Heading!')
1997. /* pause(1) */
1998. 
1999. /* NOTE: Can't round or truncate to integer precision. */
2000. 
2001. pause(1)
2002. 
2003. # Script: VolumeWhenStarted
2004. 
2005. SetVariable(VolumeFreeAdj, (VolumeFree * (VolumeUsed / VolumeSize)))
2006. 
2007. SetVariable(MftLocation, RoundUp(VolumeUsed * MftPerDev, VolumeSize * VolumeRoundUpLarge)) 
2008. 
2009. SetVariable(ZoneListByLine, 		"Volume started.
2010. ")
2011. SetVariable(ZoneStepByLine, 		"Initialize.
2012. ")
2013. SetVariable(ZoneStatisticsDetail, 	"")
2014. 
2015. SetVariable(ZoneNoCurrent, 		0)
2016. SetVariable(ZoneNoAdjCurrent, 	0) 
2017. SetVariable(ZoneCurrentAjust,	0)
2018. 
2019. # Script: BannerSet
2020. 
2021. # Script: DisplaySetDateTimeRun
2022. 
2023. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
2024. /* Xinclude "..\Display\BannerSet.MyDc"X */
2025. /* pause(1) */
2026. 
2027. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2028. 
2029. Title('!Heading!')
2030. /* pause(1) */
2031. 
2032. /* NOTE: Can't round or truncate to integer precision. */
2033. 
2034. # Script: BannerLog
2035. 
2036. AppendLogfile("!LogFileName!", "!Title!")
2037. 
2038. 
2039. # Script: VolumeStatisticsDetailGet
2040. 
2041. # Set Volume summary stats:
2042. 
2043. # Cluster, Sector, Block adjust for display.
2044. # Bytes per cluster is volume specific.
2045. 
2046. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
2047. 
2048. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
2049. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
2050. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2051. 
2052. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
2053. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2054. 
2055. # Set the display text:
2056. # Script: VolumeStatisticsSummaryDisplay
2057. 
2058. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
2059. SUMMARY: !VolumeLabel! !VolumeDescription!
2060.   
2061.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
2062.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
2063.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
2064.          
2065.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
2066.       Volume Free Adj:       !VolumeFreeAdj!
2067.     Bytes per cluster:       !BytesPerCluster! bytes
2068. 
2069.    Unfragmented Items:       !FILES200N!
2070.      Fragmented Items:       !FILES210N!
2071. 
2072.     Unfragmented Data:       !FILES202N! bytes
2073.       Fragmented Data:       !FILES212N! bytes
2074. 
2075.              All Gaps:       !GAP00N!
2076.              All gaps:       !GAP10N! bytes
2077.           Average gap:       !GAP13N! bytes
2078.            Median gap:       !GAP14N! bytes
2079.           Biggest gap:       !GAP15N! bytes
2080. ----------------------------------------------------------
2081. ") 
2082. 
2083. 
2084. 
2085. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
2086. VOLUME: !VolumeLabel! !VolumeDescription!
2087. ----------------------------------------------------------
2088. !VolumeStatisticsSummary!
2089. ----------------------------------------------------------
2090. DETAILS: !VolumeLabel! !VolumeDescription!
2091. ----------------------------------------------------------
2092. 
2093. SUMMARY:
2094. 
2095. Volume label/name:          !VolumeLabel!
2096. Volume mountpoint:          !MountPoint!
2097. Volume name:                !VolumeName!
2098. Volume type:                !VolumeType!
2099. 
2100. Total disk space:           !VolumeSize! bytes
2101.                             !VolumeSizeG! gigabytes
2102. 
2103. Bytes per cluster:          !BytesPerCluster! bytes
2104. Average end-begin distance: !AverageBeginEndDistance! clusters
2105.                             !AverageBeginEndDistanceP!% of volume size
2106. 
2107. ----------------------------------------------------------
2108. FRAGMENTS:
2109. 
2110. Unfragmented Items: !FILES200N!
2111.   Fragmented Items: !FILES210N!
2112.  Unfragmented Data: !FILES202N! bytes
2113.    Fragmented Data: !FILES212N! bytes
2114. Gaps:
2115.           All Gaps: !GAP00N!
2116.           All gaps: !GAP10N! bytes
2117.        Average gap: !GAP13N! bytes
2118.         Median gap: !GAP14N! bytes
2119.        Biggest gap: !GAP15N! bytes
2120. 
2121. ----------------------------------------------------------
2122. GAPS:
2123. 
2124.    ----------------------------------------------------------
2125.    Counts:
2126.                        Count      Percentage of all
2127.                 ----------------- -----------------
2128.    Small gaps   !GAP01N! !GAP01P!%
2129.    Big gaps     !GAP02N! !GAP02P!%
2130.                 ----------------- -----------------
2131.    All gaps     !GAP00N! !GAP00P!
2132. 
2133.    ----------------------------------------------------------
2134.    By size:
2135.                       Bytes          Gigabytes      Percentage of all
2136.                 ----------------- ----------------- -----------------
2137.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
2138.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
2139.                 ----------------- ----------------- -----------------
2140.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
2141. 
2142.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
2143.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
2144.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
2145.    ----------------------------------------------------------
2146. 
2147. ----------------------------------------------------------
2148. FILE STATISTICS:
2149. ----------------------------------------------------------
2150. 
2151. ----------------------------------------------------------
2152. ITEM COUNT:
2153. ----------------------------------------------------------
2154. Number of files and folders:
2155. 
2156.               Unfragmented       Fragmented            All
2157.    ------- ----------------- ----------------- -----------------
2158.    Files   !FILES000N! !FILES010N! !FILES020N!
2159.    Folders !FILES100N! !FILES110N! !FILES120N!
2160.    ------- ----------------- ----------------- -----------------
2161.    All     !FILES200N! !FILES210N! !FILES220N!
2162. 
2163. ----------------------------------------------------------
2164. Percentage of total:
2165. 
2166.               Unfragmented       Fragmented            All
2167.    ------- ----------------- ----------------- -----------------
2168.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
2169.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
2170.    ------- ----------------- ----------------- -----------------
2171.    All     !FILES200P!%!FILES210P!%!FILES220P!%
2172. 
2173. ----------------------------------------------------------
2174. OCCUPIED SIZE on disk:
2175. ----------------------------------------------------------
2176. Bytes:
2177.               Unfragmented       Fragmented            All
2178.    ------- ----------------- ----------------- -----------------
2179.    Files   !FILES002N! !FILES012N! !FILES022N!
2180.    Folders !FILES102N! !FILES112N! !FILES122N!
2181.    ------- ----------------- ----------------- -----------------
2182.    All     !FILES202N! !FILES212N! !FILES222N!
2183. 
2184. ----------------------------------------------------------
2185. Gigabytes:
2186.               Unfragmented       Fragmented            All
2187.    ------- ----------------- ----------------- -----------------
2188.    Files   !FILES002G! !FILES012G! !FILES022G!
2189.    Folders !FILES102G! !FILES112G! !FILES122G!
2190.    ------- ----------------- ----------------- -----------------
2191.    All     !FILES202G! !FILES212G! !FILES222G!
2192. 
2193. ----------------------------------------------------------
2194. Percentage:
2195.               Unfragmented       Fragmented            All
2196.    ------- ----------------- ----------------- -----------------
2197.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
2198.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
2199.    ------- ----------------- ----------------- -----------------
2200.    All     !FILES202P!%!FILES212P!%!FILES222P!%
2201. 
2202. ----------------------------------------------------------
2203. USED SIZE:
2204. ----------------------------------------------------------
2205. Bytes:
2206.               Unfragmented       Fragmented            All
2207.    ------- ----------------- ----------------- -----------------
2208.    Files   !FILES001N! !FILES011N! !FILES021N!
2209.    Folders !FILES101N! !FILES111N! !FILES121N!
2210.    ------- ----------------- ----------------- -----------------
2211.    All     !FILES201N! !FILES211N! !FILES221N!
2212. 
2213. ----------------------------------------------------------
2214. Gigabytes:
2215.               Unfragmented       Fragmented            All
2216.    ------- ----------------- ----------------- -----------------
2217.    Files   !FILES001G! !FILES011G! !FILES021G!
2218.    Folders !FILES101G! !FILES111G! !FILES121G!
2219.    ------- ----------------- ----------------- -----------------
2220.    All     !FILES201G! !FILES211G! !FILES221G!
2221. 
2222. ----------------------------------------------------------
2223. Percentage:
2224.               Unfragmented       Fragmented            All
2225.    ------- ----------------- ----------------- -----------------
2226.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
2227.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
2228.    ------- ----------------- ----------------- -----------------
2229.    All     !FILES201P!%!FILES211P!%!FILES221P!%
2230. 
2231. ----------------------------------------------------------
2232. Volume Detailed Statistics end.
2233. ----------------------------------------------------------
2234. ") 
2235. 
2236. # Script: BannerLog
2237. 
2238. AppendLogfile("!LogFileName!", "!Title!")
2239. 
2240. 
2241. 
2242. /* Write/display stats: */
2243. # Log:
2244. AppendLogfile("!LogFileName!", "!Title! started.")
2245. AppendLogfile("!LogFileName!", "2021-11-09 18:53:49.")
2246. AppendLogfile("!LogFileName!",".")
2247. AppendLogfile("!LogFileName!", ".")
2248. AppendLogfile("!LogFileName!", "Volume: !VolumeLabel!")
2249. AppendLogfile("!LogFileName!",".")
2250. AppendLogfile("!LogFileName!","!VolumeStatisticsDetail!")
2251. AppendLogfile("!LogFileName!",".")
2252. AppendLogfile("!LogFileName!", "!Title! started.")
2253. AppendLogfile("!LogFileName!", "2021-11-09 18:53:49.")
2254. AppendLogfile("!LogFileName!",".")
2255. 
2256. # In program statistics window (view):
2257. SetStatisticsWindowText("!VolumeStatisticsDetail!")
2258. 
2259. 
2260. /* ---------------------------------------------------------- */
2261. /* System Zones */
2262. /* ---------------------------------------------------------- */
2263. 
2264. 	# Script: DefragZoneGroupOs
2265. # Defrag Zones Os
2266. 	/* System Zones */
2267. 
2268. AppendLogfile("!LogFileName!", "!Description! Os Zones started: 2021-11-09 18:53:49")
2269. SetVariable(FileStepDescription,"System Zones.")
2270. # Script: BannerSet
2271. 
2272. # Script: DisplaySetDateTimeRun
2273. 
2274. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
2275. /* Xinclude "..\Display\BannerSet.MyDc"X */
2276. /* pause(1) */
2277. 
2278. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2279. 
2280. Title('!Heading!')
2281. /* pause(1) */
2282. 
2283. /* NOTE: Can't round or truncate to integer precision. */
2284. 
2285. # Script: BannerLog
2286. 
2287. AppendLogfile("!LogFileName!", "!Title!")
2288. 
2289. 
2290. AppendLogfile("!LogFileName!",".")
2291. 
2292. AppendLogfile("!LogFileName!", "System Disk optimized layout for boot and executables. 2021-11-09 18:53:49")
2293. /* Dgh 20190618 */
2294. 
2295. /* ---------------------------------------------------------- */
2296. /* Defrag the Pagefile.sys on the next boot. */
2297. 
2298. # PagedFrg - Page Defrag.
2299. 
2300. /* Defrag the Pagefile.sys on the next boot. */
2301. # RunProgram("..\Pagedfrg.exe","-o")
2302. 
2303. 
2304. /* ---------------------------------------------------------- */
2305. AppendLogfile("!LogFileName!", "Place files at the beginning of the disk: 2021-11-09 18:53:49")
2306. 
2307. 	MakeGap(0)
2308. 
2309. /* ---------------------------------------------------------- */
2310. # Zone Boot Fixed.
2311. # Script: DefragZoneTypeOsBoot
2312. /* ---------------------------------------------------------- */
2313. # Zone Boot Fixed.
2314. 	SetVariable(ZoneLabel, 			"!ZoneLabelBoot!")
2315. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBoot!")
2316. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
2317. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
2318. 	SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectOsBoot
2319. # Boot start.
2320. ImportListFromBootOptimize()
2321. # Boot end.
2322. ')
2323. 
2324. 		# Script: ZoneDoHeader
2325. 
2326. # Script: ZoneWhenStarted
2327. 
2328. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
2329. # Script: DisplaySetZone
2330. 
2331. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
2332. SetVariable(FileStepDescription,	"")
2333. 
2334. SetVariable(ZoneStepByLine, 			"Zone started.
2335. ")
2336. 
2337. # Script: BannerDescriptionSet
2338. 
2339. # Script: BannerSet
2340. 
2341. # Script: DisplaySetDateTimeRun
2342. 
2343. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
2344. /* Xinclude "..\Display\BannerSet.MyDc"X */
2345. /* pause(1) */
2346. 
2347. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2348. 
2349. Title('!Heading!')
2350. /* pause(1) */
2351. 
2352. /* NOTE: Can't round or truncate to integer precision. */
2353. 
2354. # Script: BannerLog
2355. 
2356. AppendLogfile("!LogFileName!", "!Title!")
2357. 
2358. 
2359. 
2360. pause(1)
2361. 
2362. 
2363. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
2364. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
2365. 
2366. SetVariable(ZoneStepNoCurrent, 0)
2367. 
2368. 
2369. # Script: ZoneDoCurrentClear
2370. 
2371. SetVariable(ZoneTypeSelectCurrent, 		"")
2372. 
2373. SetVariable(ZoneBeginCurrent, 			0)
2374. SetVariable(ZoneBeginPerCurrent, 		0)
2375. SetVariable(ZoneEndCurrent, 			0)
2376. SetVariable(ZoneEndPerCurrent, 			0)
2377. 
2378. SetVariable(ZoneSizeCurrent,			0)
2379. SetVariable(ZoneSizePerCurrent,			0)
2380. 
2381. SetVariable(ZoneGapRequestedCurrent,	0)
2382. SetVariable(ZoneGapRoundedCurrent, 		0)
2383. SetVariable(ZoneGapAdjustedCurrent, 	0)
2384. SetVariable(ZoneGapAvailableCurrent, 	0)
2385. SetVariable(ZoneGapCurrent,				0)
2386. SetVariable(ZoneGapUsedCurrent, 		0)
2387. 
2388. SetVariable(ZoneGapActualCurrent, 		0)
2389. SetVariable(ZoneGapActualPerCurrent, 	0)
2390. 
2391. SetVariable(ZoneSizeActual, 			0)
2392. SetVariable(ZoneSizeActualCurrent,		0)
2393. 
2394. SetVariable(ZoneEndActual, 				0)
2395. SetVariable(ZoneEndActualCurrent,		0)			
2396. SetVariable(ZoneSizeActualPerCurrent, 	0)
2397.       
2398. SetVariable(ZoneFilesFolders,			0)
2399. SetVariable(ZoneFilesFoldersPer,		0) 
2400. 
2401. SetVariable(ZoneFragments,				0)
2402. SetVariable(ZoneFragmentsPer,			0) 
2403. 		
2404. SetVariable(ZoneEndActualCurrent, 		0)
2405. SetVariable(ZoneEndActualPerCurrent, 	0)
2406. 
2407. # Gap Calculation Methodology:
2408. 	# Requested
2409. 	SetVariable(GapRequested, 			0) 
2410. 	SetVariable(GapRequestedStd, 		0) 
2411. 	SetVariable(GapRequestedMft, 		0) 
2412. 	SetVariable(GapRequestedOs, 		0) 
2413. 	SetVariable(GapRequestedOriginal, 	0) 
2414. 	
2415. 	# Gap Adjustments
2416. 	SetVariable(GapRounded, 			0)
2417. 	# SetVariable(GapAdjusted, 			0)
2418. 	SetVariable(GapAvailable, 			0)
2419. 	SetVariable(GapCurrent, 			0)
2420. 	SetVariable(GapActual, 				0)
2421. 	SetVariable(GapUsed, 				0)
2422. 	
2423. 	# Gap Adjustments
2424. 	SetVariable(GapRoundedLoc, 			0)
2425. 	# SetVariable(GapAdjustedLoc, 		0)
2426. 	SetVariable(GapAvailableLoc, 		0)
2427. 	SetVariable(GapCurrentLoc, 			0)
2428. 	SetVariable(GapActualLoc,			0)
2429. 	SetVariable(GapUsedLoc,				0)
2430. 	
2431. 	# Space usage
2432. 	SetVariable(ZoneFreePerRequested, 	0)
2433. 	SetVariable(ZoneFreePerUsed, 		0)
2434. 
2435. # Gap Size & Rounding
2436. 	SetVariable(ZoneGapSizePer, 		0)
2437. 	SetVariable(ZoneVolRoundUpPer, 		0)
2438. 	
2439. 	# Free Space
2440. 	SetVariable(ZoneFreeUsedPer, 		0)
2441. 	SetVariable(ZoneFreeRequestedPer, 	0)
2442. 
2443. 
2444. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
2445. 
2446. # Footer:
2447. SetVariable(ZoneFooter, "----------------------------------------------------------
2448. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:49
2449. 
2450. Statistics Report:
2451. ------------------
2452.    Size:  
2453.    ------------------------
2454.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2455.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2456.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2457. 
2458.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2459.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2460. 
2461.    Location:
2462.    ------------------------
2463.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2464.              Files End: !ZoneEndCurrent!
2465.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2466.       
2467.    Gap Settings:
2468.    ------------------------
2469.          Gap Requested: !ZoneGapSizePer!%
2470.       Volume Rounding: !ZoneVolRoundUpPer!%
2471.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2472.                  
2473.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
2474.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
2475.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
2476.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
2477.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
2478.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
2479.      
2480.    Free Space after Zone:
2481.    ------------------------
2482.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
2483.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
2484.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
2485. 
2486. Directory and Files Select:
2487. ---------------------------
2488. !ZoneTypeSelectCurrent!               
2489. ---------------------------
2490. ----------------------------------------------------------
2491. ")
2492. 
2493. # Script: BannerSet
2494. 
2495. # Script: DisplaySetDateTimeRun
2496. 
2497. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
2498. /* Xinclude "..\Display\BannerSet.MyDc"X */
2499. /* pause(1) */
2500. 
2501. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2502. 
2503. Title('!Heading!')
2504. /* pause(1) */
2505. 
2506. /* NOTE: Can't round or truncate to integer precision. */
2507. 
2508. # Script: BannerLog
2509. 
2510. AppendLogfile("!LogFileName!", "!Title!")
2511. 
2512. 
2513. 
2514. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
2515. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
2516. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:49")
2517. 
2518. SetVariable(ZoneListByLine, "!ZoneListByLine!
2519. Zone: !ZoneNoCurrent! 2021-11-09 18:53:49 0:00:05 !ZoneLabel! !ZoneDescription!")
2520. 
2521. 
2522. /* Fixed Zone Position Handling */
2523. /* Literal number: */
2524. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
2525. /* Percentage of disk: */
2526. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
2527. /* Gap */
2528. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
2529. 
2530. /* ---------------------------------------------------------- */
2531. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
2532. # Script: DisplaySetFileStep
2533. 
2534. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2535. 
2536. /* add message and move to a new line. */
2537. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2538. ")
2539. 
2540. /* display the line. (hopefully.) */
2541. # Zone Footer Set Statistics Window Text
2542. 
2543. SetStatisticsWindowText("----------------------------------------------------------
2544. Zones Processed: 
2545. ----------------------------------------------------------
2546. !ZoneListByLine!
2547. ----------------------------------------------------------
2548. Zone Processing Step:
2549. !ZoneStepByLine!    
2550. ----------------------------------------------------------
2551. Current Zone:
2552. !ZoneFooter!
2553. ----------------------------------------------------------
2554. Volume Statistics:
2555. !VolumeStatisticsDetail!
2556. ----------------------------------------------------------
2557. Zone Detailed Report:
2558. ----------------------------------------------------------
2559. !ZoneStatisticsDetail!
2560. ----------------------------------------------------------
2561. ")
2562. 
2563. 
2564. 
2565. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2566. 
2567. # Script: BannerSet
2568. 
2569. # Script: DisplaySetDateTimeRun
2570. 
2571. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
2572. /* Xinclude "..\Display\BannerSet.MyDc"X */
2573. /* pause(1) */
2574. 
2575. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2576. 
2577. Title('!Heading!')
2578. /* pause(1) */
2579. 
2580. /* NOTE: Can't round or truncate to integer precision. */
2581. 
2582. pause(1)
2583. 
2584. # your stuff HERE (X)... pre file select code.
2585. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
2586. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
2587. 	# (X)
2588. 
2589. FileSelect
2590. 
2591. 	# your stuff can't really go here (errors.)
2592. 	# maybe for some reason I don't know of...
2593. 	
2594. 	# Actions next...
2595. 		# Script: ZoneDo ZoneTypeSelectOsBoot
2596. # Boot start.
2597. ImportListFromBootOptimize()
2598. # Boot end.
2599. 
2600. 		and not(
2601. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
2602. # Os Data Dynamic start.
2603. (
2604. # Os Data Dynamic start.
2605. (
2606.   FileName("*.dat*")
2607.   or FileName("*.db*")
2608.   or FileName("*.edb*")
2609.   or FileName("*.log*")
2610.   or FileName("DataStore.edb")
2611. )
2612. # Os Data Dynamic end.
2613. 
2614.   or 
2615. # Os PageHiberDump start.
2616. (
2617.   FileName("DataStore.edb")
2618.   or FileName("DUMP*.*")
2619.   or FileName("Hiberfil.sys")
2620.   or FileName("MEMORY.DMP")
2621.   or FileName("Pagefile.sys")
2622. )
2623. # Os PageHiberDump end.
2624. 
2625. # Os Data Dynamic
2626. )
2627. # Os Data Dynamic end.
2628. 
2629. 		)
2630. 	FileActions
2631. 		  		/* ---------------------------------------------------------- */
2632. 	# Gap
2633. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
2634. 		# Script: DisplaySetFileStep
2635. 
2636. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2637. 
2638. /* add message and move to a new line. */
2639. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2640. ")
2641. 
2642. /* display the line. (hopefully.) */
2643. # Zone Footer Set Statistics Window Text
2644. 
2645. SetStatisticsWindowText("----------------------------------------------------------
2646. Zones Processed: 
2647. ----------------------------------------------------------
2648. !ZoneListByLine!
2649. ----------------------------------------------------------
2650. Zone Processing Step:
2651. !ZoneStepByLine!    
2652. ----------------------------------------------------------
2653. Current Zone:
2654. !ZoneFooter!
2655. ----------------------------------------------------------
2656. Volume Statistics:
2657. !VolumeStatisticsDetail!
2658. ----------------------------------------------------------
2659. Zone Detailed Report:
2660. ----------------------------------------------------------
2661. !ZoneStatisticsDetail!
2662. ----------------------------------------------------------
2663. ")
2664. 
2665. 
2666. 
2667. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2668. 
2669. # Script: BannerSet
2670. 
2671. # Script: DisplaySetDateTimeRun
2672. 
2673. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
2674. /* Xinclude "..\Display\BannerSet.MyDc"X */
2675. /* pause(1) */
2676. 
2677. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2678. 
2679. Title('!Heading!')
2680. /* pause(1) */
2681. 
2682. /* NOTE: Can't round or truncate to integer precision. */
2683. 
2684. pause(1)
2685. 	
2686. 	# ACTUAL GAP
2687. 		/* AddGap Variant. */
2688. 	  	# Zone Do Gap
2689. # Gap Calculation Methods:
2690. 
2691. /* 1) Anything you need to add first. */
2692. /* empty */
2693. 
2694. /* ---------------------------------------------------------- */
2695. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
2696. 	# GapRequestedStd.
2697. 
2698. 		/* ---------------------------------------------------------- */
2699. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
2700. 
2701. 		# Gap Calculation Methods:
2702. 
2703. /* AddGap Variants */
2704. 
2705. 	/* Standard */
2706. 		# Gap Calculation Methods:
2707. 	/* AddGap Variants */
2708. 	/* Standard */
2709. 
2710. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
2711. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
2712. 
2713. 	SetVariable(GapRequested, GapRequestedStd)
2714. 	
2715. 
2716. 	/* MFT Low High Method */
2717. 		# Gap Calculation Methods:
2718. 	/* AddGap Variants */
2719. 	/* MFT Low High Method */
2720. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
2721. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
2722. 	SetVariable(GapRequested, GapRequestedMft)
2723. 	
2724. 
2725. 	/* OS Volume Type Method */
2726. 		# Gap Calculation Methods:
2727. 	/* AddGap Variants */
2728. 	/* OS Volume Type Method */
2729. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
2730. 	SetVariable(GapRequested, GapRequestedOs)
2731. 
2732. 
2733. 
2734. /* MakeGap Variants */
2735. 
2736. 	/* Original Os 1-3 + MFT 2 */
2737. 		# Gap Calculation Methods:
2738. 	/* MakeGap Variants */
2739. 	/* Original Os 1-3 + MFT 2 */
2740. 	/* plus MFT gap placed inline at the dividing zone. */
2741. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
2742. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
2743. 	SetVariable(GapRequested, GapRequestedOrig)
2744. 	
2745. 	
2746. /* Note: You could comment out the ones not in use */
2747. /* However having the data in the log is useful. */
2748. /* Therefore the following line is otherwise needed. */
2749. 
2750. /* Standard used */
2751. 
2752. SetVariable(GapRequested, GapRequestedStd)
2753. 
2754. # Gap Calculation Methods:
2755. 
2756. /* AddGap Variants */
2757. 	/* Standard */
2758. 	/* MFT Low High Method */
2759. 	/* OS Volume Type Method */
2760. 
2761. /* MakeGap Variants */
2762. 	/* Original Os 1-3 + MFT 2 */
2763. 
2764. /* Note: You could comment out the ones not in use */
2765. /* However having the data in the log is useful. */
2766. /* Therefore the following line is otherwise needed. */
2767. 
2768. /* Standard is used currently */
2769. 
2770. 
2771. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
2772. 
2773. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
2774. 
2775. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
2776. 
2777. /* ---------------------------------------------------------- */
2778. /* 3) SMALL ZONE ADJUSTMENT. */
2779. /* Gab cant be larger than half the Zone Size. */
2780. 
2781. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
2782. 	
2783. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
2784. 
2785. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
2786. 
2787. /* ---------------------------------------------------------- */
2788. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
2789. # Gap Adjustments.
2790. 
2791. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
2792. 	
2793. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
2794. 
2795. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
2796. 
2797. /* ---------------------------------------------------------- */
2798. # BYPASS THIS.
2799. 	/* This is definitely wrong. */
2800. 	/* The question is can we steal gap from the next zone */
2801. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
2802. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
2803. 		# Zone Overflow.
2804. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
2805. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
2806. 
2807. /* ---------------------------------------------------------- */
2808. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
2809. # Remaining free space available.
2810. 
2811. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
2812. 	
2813. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
2814. 
2815. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
2816. 
2817. /* ---------------------------------------------------------- */
2818. # CURRENT gap to use.
2819. 
2820. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
2821. 
2822. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
2823. 
2824. /* ---------------------------------------------------------- */
2825. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
2826. # Debugging.
2827. 
2828. 	SetVariable(GapUsed, GapCurrent) // for debugging
2829. 
2830. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
2831. 
2832. 		# Your code HERE
2833. 
2834. /* ---------------------------------------------------------- */
2835. /* 7) YOUR CODE. */
2836. # YOUR CODE HERE:
2837. 	# INPUT: GapCurrent or GapCurrentLoc
2838. 	# OUTPUT: GapUsed...
2839. 
2840. /* ---------------------------------------------------------- */
2841. # Gap Size.
2842. # Actual Size of Gap.
2843. 
2844. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
2845. 
2846. /* ---------------------------------------------------------- */
2847. /* xxxxxxxxxxxxxxxxxxxxxx */
2848. # ADD THE GAP
2849. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
2850. /* xxxxxxxxxxxxxxxxxxxxxx */
2851. 
2852. 	
2853. 	# Zone Statistics	
2854. 	# Script: ZoneDoStatistics
2855. # Zone / Volume Statistics and Display
2856. 		
2857. 	# Accumulate Totals
2858.   	# Script: ZoneDoVolumeTotals
2859. 
2860. /* Current total space used (by Zones and Gaps) */
2861. 
2862. SetVariable(VolumeZoneUsed, GapUsed)
2863. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
2864. /* Percentage */
2865. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
2866. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
2867. 
2868. /* Current total of free space requested */
2869. 
2870. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
2871. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2872. /* Percent. */
2873. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
2874. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2875. 
2876. /* Current total of free space used */
2877. 
2878. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
2879. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
2880. /* Percent */
2881. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
2882. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
2883. 
2884. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
2885. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
2886. /* Xinclude "..\DebugDisplayPause.MyDc"X */
2887. 
2888. 
2889. 	# Current Values
2890. 	# Script: ZoneDoCurrentSet
2891. 
2892. # Cluster, Sector, Block adjust for display.
2893. 	# Bytes per cluster is volume specific.
2894. 
2895. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
2896. 
2897. # Current Zone values.
2898. 	# Begin, end and size.
2899. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
2900. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
2901. 
2902. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
2903. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
2904. 
2905. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
2906. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
2907. 
2908. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
2909. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
2910. 
2911. 	SetVariable(ZoneFragments,				"!ZONE210N!")
2912. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
2913. 		
2914. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
2915. /* identical code to here: (separation not needed. TEST.) */	
2916. 
2917. # Current Gap, Actual and Free Values
2918. 	# Gap
2919. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
2920. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
2921. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
2922. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
2923. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
2924. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
2925. 	
2926. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
2927. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
2928. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
2929. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
2930. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
2931. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
2932. 	
2933. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
2934. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
2935. 	
2936. 	# Actual Size and End
2937. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
2938. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
2939. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
2940. 	
2941. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
2942. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
2943. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
2944. 
2945. # Gap Size & Rounding
2946. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
2947. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
2948. 	
2949. 	# Free Space
2950. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
2951. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
2952. 
2953. 	# Footer:
2954. SetVariable(ZoneFooter, "----------------------------------------------------------
2955. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:49
2956. 
2957. Statistics Report:
2958. ------------------
2959.    Size:  
2960.    ------------------------
2961.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2962.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2963.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2964. 
2965.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2966.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2967. 
2968.    Location:
2969.    ------------------------
2970.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2971.              Files End: !ZoneEndCurrent!
2972.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2973.       
2974.    Gap Settings:
2975.    ------------------------
2976.          Gap Requested: !ZoneGapSizePer!%
2977.       Volume Rounding: !ZoneVolRoundUpPer!%
2978.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2979.                  
2980.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
2981.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
2982.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
2983.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
2984.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
2985.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
2986.      
2987.    Free Space after Zone:
2988.    ------------------------
2989.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
2990.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
2991.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
2992. 
2993. Directory and Files Select:
2994. ---------------------------
2995. !ZoneTypeSelectCurrent!               
2996. ---------------------------
2997. ----------------------------------------------------------
2998. ")
2999. 	# Zone Footer Set Statistics Window Text
3000. 
3001. SetStatisticsWindowText("----------------------------------------------------------
3002. Zones Processed: 
3003. ----------------------------------------------------------
3004. !ZoneListByLine!
3005. ----------------------------------------------------------
3006. Zone Processing Step:
3007. !ZoneStepByLine!    
3008. ----------------------------------------------------------
3009. Current Zone:
3010. !ZoneFooter!
3011. ----------------------------------------------------------
3012. Volume Statistics:
3013. !VolumeStatisticsDetail!
3014. ----------------------------------------------------------
3015. Zone Detailed Report:
3016. ----------------------------------------------------------
3017. !ZoneStatisticsDetail!
3018. ----------------------------------------------------------
3019. ")
3020. 
3021. 
3022. 	
3023.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
3024. 
3025. 	# Add Zone to list of zones for display.
3026. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
3027. 	# ??? Free Stats?
3028. 	# Footer:
3029. SetVariable(ZoneFooter, "----------------------------------------------------------
3030. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:49
3031. 
3032. Statistics Report:
3033. ------------------
3034.    Size:  
3035.    ------------------------
3036.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3037.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3038.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3039. 
3040.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3041.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3042. 
3043.    Location:
3044.    ------------------------
3045.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3046.              Files End: !ZoneEndCurrent!
3047.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3048.       
3049.    Gap Settings:
3050.    ------------------------
3051.          Gap Requested: !ZoneGapSizePer!%
3052.       Volume Rounding: !ZoneVolRoundUpPer!%
3053.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3054.                  
3055.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
3056.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
3057.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
3058.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
3059.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
3060.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
3061.      
3062.    Free Space after Zone:
3063.    ------------------------
3064.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3065.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3066.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3067. 
3068. Directory and Files Select:
3069. ---------------------------
3070. !ZoneTypeSelectCurrent!               
3071. ---------------------------
3072. ----------------------------------------------------------
3073. ")
3074. 
3075. 	# Add Zone Details to Report.	
3076. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
3077. !ZoneFooter!")
3078. 
3079. 
3080. 	
3081. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionStart!")
3082. 			# Script: DisplaySetFileStep
3083. 
3084. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3085. 
3086. /* add message and move to a new line. */
3087. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3088. ")
3089. 
3090. /* display the line. (hopefully.) */
3091. # Zone Footer Set Statistics Window Text
3092. 
3093. SetStatisticsWindowText("----------------------------------------------------------
3094. Zones Processed: 
3095. ----------------------------------------------------------
3096. !ZoneListByLine!
3097. ----------------------------------------------------------
3098. Zone Processing Step:
3099. !ZoneStepByLine!    
3100. ----------------------------------------------------------
3101. Current Zone:
3102. !ZoneFooter!
3103. ----------------------------------------------------------
3104. Volume Statistics:
3105. !VolumeStatisticsDetail!
3106. ----------------------------------------------------------
3107. Zone Detailed Report:
3108. ----------------------------------------------------------
3109. !ZoneStatisticsDetail!
3110. ----------------------------------------------------------
3111. ")
3112. 
3113. 
3114. 
3115. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3116. 
3117. # Script: BannerSet
3118. 
3119. # Script: DisplaySetDateTimeRun
3120. 
3121. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
3122. /* Xinclude "..\Display\BannerSet.MyDc"X */
3123. /* pause(1) */
3124. 
3125. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3126. 
3127. Title('!Heading!')
3128. /* pause(1) */
3129. 
3130. /* NOTE: Can't round or truncate to integer precision. */
3131. 
3132. pause(1)
3133. 	
3134. 			/* "..\ActionVerbs\ZoneDoActionThis.MyDc" */
3135. 			# File Action - SortByImportSequence.
3136. SortByImportSequence(Ascending ) 
3137. 	
3138. 
3139. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionEnd!")
3140. 			# Script: DisplaySetFileStep
3141. 
3142. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3143. 
3144. /* add message and move to a new line. */
3145. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3146. ")
3147. 
3148. /* display the line. (hopefully.) */
3149. # Zone Footer Set Statistics Window Text
3150. 
3151. SetStatisticsWindowText("----------------------------------------------------------
3152. Zones Processed: 
3153. ----------------------------------------------------------
3154. !ZoneListByLine!
3155. ----------------------------------------------------------
3156. Zone Processing Step:
3157. !ZoneStepByLine!    
3158. ----------------------------------------------------------
3159. Current Zone:
3160. !ZoneFooter!
3161. ----------------------------------------------------------
3162. Volume Statistics:
3163. !VolumeStatisticsDetail!
3164. ----------------------------------------------------------
3165. Zone Detailed Report:
3166. ----------------------------------------------------------
3167. !ZoneStatisticsDetail!
3168. ----------------------------------------------------------
3169. ")
3170. 
3171. 
3172. 
3173. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3174. 
3175. # Script: BannerSet
3176. 
3177. # Script: DisplaySetDateTimeRun
3178. 
3179. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
3180. /* Xinclude "..\Display\BannerSet.MyDc"X */
3181. /* pause(1) */
3182. 
3183. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3184. 
3185. Title('!Heading!')
3186. /* pause(1) */
3187. 
3188. /* NOTE: Can't round or truncate to integer precision. */
3189. 
3190. pause(1)
3191. 
3192. 		# Script: ZoneDoFooter
3193. 
3194. /* ---------------------------------------------------------- */
3195. # File Select
3196. 	# Select Statments
3197. # File Actions 
3198. 	# Standard or OS File Actions.
3199. 	# Resume...
3200. 	
3201. 	# your stuff HERE (X)... post zone (file) file actions code.
3202. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
3203. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3204. 		# (X)
3205. 		
3206. 		/* ??? Set window? */
3207. 	
3208. 	# ADD THE GAP
3209. 		
3210. # Vacate (good for diagnostics)
3211. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
3212. 
3213. # DoNotVacate - DO NOT Vacate (recommended)
3214. 
3215. # Vacate
3216. /* AddGap(GapUsedLoc) */
3217. 
3218. # DO Not Vacate
3219. AddGap(GapUsedLoc, DoNotVacate) 
3220. 	
3221. 	
3222. /* ---------------------------------------------------------- */
3223. # (failed) TEST for boolean logic.
3224. 
3225. /* It should work in the gap calculations for turning options */
3226. /* on and off but it will NOT work here. */
3227. 
3228. /* Boolean setting X or FlagX. */
3229. /* Where X will be on or off: */
3230. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
3231. /*      For ON:  (X  *  FlagAny) */
3232. 
3233. /* 1) Failed, zero gap overrode the previous one. */
3234. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
3235. /* AddGap(GapUsedTemp) */ 
3236. 
3237. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
3238. /* AddGap(GapUsedTemp, DoNotVacate) */ 
3239. 
3240. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
3241. 
3242. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
3243. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
3244. /* AddGap(GapUsedTemp) */ 
3245. 
3246. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
3247. /* AddGap(GapUsedTemp, DoNotVacate) */ 
3248. 
3249. /* ---------------------------------------------------------- */
3250. 
3251. # Vacate
3252. /* AddGap(GapUsed) */
3253. 
3254. # DO NOT Vacate (recommended)
3255. /* AddGap(GapUsed, DoNotVacate) */ 
3256. 	
3257. 
3258. 		
3259. # 
3260. FileEnd
3261. /* ---------------------------------------------------------- */
3262. 
3263. # your stuff HERE (X)... post zone (file) code.
3264. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
3265. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3266. 	# (X)
3267. 
3268. SetVariable(FileStepDescription,"Zone finished, reporting.")
3269. # Script: DisplaySetFileStep
3270. 
3271. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3272. 
3273. /* add message and move to a new line. */
3274. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3275. ")
3276. 
3277. /* display the line. (hopefully.) */
3278. # Zone Footer Set Statistics Window Text
3279. 
3280. SetStatisticsWindowText("----------------------------------------------------------
3281. Zones Processed: 
3282. ----------------------------------------------------------
3283. !ZoneListByLine!
3284. ----------------------------------------------------------
3285. Zone Processing Step:
3286. !ZoneStepByLine!    
3287. ----------------------------------------------------------
3288. Current Zone:
3289. !ZoneFooter!
3290. ----------------------------------------------------------
3291. Volume Statistics:
3292. !VolumeStatisticsDetail!
3293. ----------------------------------------------------------
3294. Zone Detailed Report:
3295. ----------------------------------------------------------
3296. !ZoneStatisticsDetail!
3297. ----------------------------------------------------------
3298. ")
3299. 
3300. 
3301. 
3302. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3303. 
3304. # Script: BannerSet
3305. 
3306. # Script: DisplaySetDateTimeRun
3307. 
3308. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
3309. /* Xinclude "..\Display\BannerSet.MyDc"X */
3310. /* pause(1) */
3311. 
3312. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3313. 
3314. Title('!Heading!')
3315. /* pause(1) */
3316. 
3317. /* NOTE: Can't round or truncate to integer precision. */
3318. 
3319. pause(1)
3320. 
3321. # Script: ZoneWhenFinished
3322. 
3323. # Script: BannerSet
3324. 
3325. # Script: DisplaySetDateTimeRun
3326. 
3327. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
3328. /* Xinclude "..\Display\BannerSet.MyDc"X */
3329. /* pause(1) */
3330. 
3331. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3332. 
3333. Title('!Heading!')
3334. /* pause(1) */
3335. 
3336. /* NOTE: Can't round or truncate to integer precision. */
3337. 
3338. # Script: BannerLog
3339. 
3340. AppendLogfile("!LogFileName!", "!Title!")
3341. 
3342. 
3343. 
3344. # Zone Statistics	
3345. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
3346. 
3347. # Footer:
3348. SetVariable(ZoneFooter, "----------------------------------------------------------
3349. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:49
3350. 
3351. Statistics Report:
3352. ------------------
3353.    Size:  
3354.    ------------------------
3355.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3356.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3357.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3358. 
3359.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3360.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3361. 
3362.    Location:
3363.    ------------------------
3364.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3365.              Files End: !ZoneEndCurrent!
3366.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3367.       
3368.    Gap Settings:
3369.    ------------------------
3370.          Gap Requested: !ZoneGapSizePer!%
3371.       Volume Rounding: !ZoneVolRoundUpPer!%
3372.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3373.                  
3374.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
3375.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
3376.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
3377.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
3378.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
3379.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
3380.      
3381.    Free Space after Zone:
3382.    ------------------------
3383.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3384.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3385.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3386. 
3387. Directory and Files Select:
3388. ---------------------------
3389. !ZoneTypeSelectCurrent!               
3390. ---------------------------
3391. ----------------------------------------------------------
3392. ")
3393. 
3394. AppendLogfile("!LogFileName!", ".")
3395. AppendLogfile("!LogFileName!", "!ZoneFooter!")
3396. AppendLogfile("!LogFileName!", ".")
3397. 
3398. # Zone Footer Set Statistics Window Text
3399. 
3400. SetStatisticsWindowText("----------------------------------------------------------
3401. Zones Processed: 
3402. ----------------------------------------------------------
3403. !ZoneListByLine!
3404. ----------------------------------------------------------
3405. Zone Processing Step:
3406. !ZoneStepByLine!    
3407. ----------------------------------------------------------
3408. Current Zone:
3409. !ZoneFooter!
3410. ----------------------------------------------------------
3411. Volume Statistics:
3412. !VolumeStatisticsDetail!
3413. ----------------------------------------------------------
3414. Zone Detailed Report:
3415. ----------------------------------------------------------
3416. !ZoneStatisticsDetail!
3417. ----------------------------------------------------------
3418. ")
3419. 
3420. 
3421. 
3422. /* pause() */
3423. /* pause() */
3424. 
3425. 
3426. 
3427. 
3428. /* ---------------------------------------------------------- */
3429. # Zone Boot Data (Variable and other).
3430. 	SetVariable(ZoneLabel, 			"!ZoneLabelBootData!")
3431. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBootData!")
3432. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
3433. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
3434. 	SetVariable(ZoneTypeSelect,'
3435.                 # Boot - Data files.
3436.                 not(
3437.                      # Os PageHiberDump start.
3438. (
3439.   FileName("DataStore.edb")
3440.   or FileName("DUMP*.*")
3441.   or FileName("Hiberfil.sys")
3442.   or FileName("MEMORY.DMP")
3443.   or FileName("Pagefile.sys")
3444. )
3445. # Os PageHiberDump end.
3446. 
3447.                 )
3448. ')
3449. 
3450. 		# Script: ZoneDoHeader
3451. 
3452. # Script: ZoneWhenStarted
3453. 
3454. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
3455. # Script: DisplaySetZone
3456. 
3457. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
3458. SetVariable(FileStepDescription,	"")
3459. 
3460. SetVariable(ZoneStepByLine, 			"Zone started.
3461. ")
3462. 
3463. # Script: BannerDescriptionSet
3464. 
3465. # Script: BannerSet
3466. 
3467. # Script: DisplaySetDateTimeRun
3468. 
3469. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
3470. /* Xinclude "..\Display\BannerSet.MyDc"X */
3471. /* pause(1) */
3472. 
3473. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3474. 
3475. Title('!Heading!')
3476. /* pause(1) */
3477. 
3478. /* NOTE: Can't round or truncate to integer precision. */
3479. 
3480. # Script: BannerLog
3481. 
3482. AppendLogfile("!LogFileName!", "!Title!")
3483. 
3484. 
3485. 
3486. pause(1)
3487. 
3488. 
3489. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
3490. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
3491. 
3492. SetVariable(ZoneStepNoCurrent, 0)
3493. 
3494. 
3495. # Script: ZoneDoCurrentClear
3496. 
3497. SetVariable(ZoneTypeSelectCurrent, 		"")
3498. 
3499. SetVariable(ZoneBeginCurrent, 			0)
3500. SetVariable(ZoneBeginPerCurrent, 		0)
3501. SetVariable(ZoneEndCurrent, 			0)
3502. SetVariable(ZoneEndPerCurrent, 			0)
3503. 
3504. SetVariable(ZoneSizeCurrent,			0)
3505. SetVariable(ZoneSizePerCurrent,			0)
3506. 
3507. SetVariable(ZoneGapRequestedCurrent,	0)
3508. SetVariable(ZoneGapRoundedCurrent, 		0)
3509. SetVariable(ZoneGapAdjustedCurrent, 	0)
3510. SetVariable(ZoneGapAvailableCurrent, 	0)
3511. SetVariable(ZoneGapCurrent,				0)
3512. SetVariable(ZoneGapUsedCurrent, 		0)
3513. 
3514. SetVariable(ZoneGapActualCurrent, 		0)
3515. SetVariable(ZoneGapActualPerCurrent, 	0)
3516. 
3517. SetVariable(ZoneSizeActual, 			0)
3518. SetVariable(ZoneSizeActualCurrent,		0)
3519. 
3520. SetVariable(ZoneEndActual, 				0)
3521. SetVariable(ZoneEndActualCurrent,		0)			
3522. SetVariable(ZoneSizeActualPerCurrent, 	0)
3523.       
3524. SetVariable(ZoneFilesFolders,			0)
3525. SetVariable(ZoneFilesFoldersPer,		0) 
3526. 
3527. SetVariable(ZoneFragments,				0)
3528. SetVariable(ZoneFragmentsPer,			0) 
3529. 		
3530. SetVariable(ZoneEndActualCurrent, 		0)
3531. SetVariable(ZoneEndActualPerCurrent, 	0)
3532. 
3533. # Gap Calculation Methodology:
3534. 	# Requested
3535. 	SetVariable(GapRequested, 			0) 
3536. 	SetVariable(GapRequestedStd, 		0) 
3537. 	SetVariable(GapRequestedMft, 		0) 
3538. 	SetVariable(GapRequestedOs, 		0) 
3539. 	SetVariable(GapRequestedOriginal, 	0) 
3540. 	
3541. 	# Gap Adjustments
3542. 	SetVariable(GapRounded, 			0)
3543. 	# SetVariable(GapAdjusted, 			0)
3544. 	SetVariable(GapAvailable, 			0)
3545. 	SetVariable(GapCurrent, 			0)
3546. 	SetVariable(GapActual, 				0)
3547. 	SetVariable(GapUsed, 				0)
3548. 	
3549. 	# Gap Adjustments
3550. 	SetVariable(GapRoundedLoc, 			0)
3551. 	# SetVariable(GapAdjustedLoc, 		0)
3552. 	SetVariable(GapAvailableLoc, 		0)
3553. 	SetVariable(GapCurrentLoc, 			0)
3554. 	SetVariable(GapActualLoc,			0)
3555. 	SetVariable(GapUsedLoc,				0)
3556. 	
3557. 	# Space usage
3558. 	SetVariable(ZoneFreePerRequested, 	0)
3559. 	SetVariable(ZoneFreePerUsed, 		0)
3560. 
3561. # Gap Size & Rounding
3562. 	SetVariable(ZoneGapSizePer, 		0)
3563. 	SetVariable(ZoneVolRoundUpPer, 		0)
3564. 	
3565. 	# Free Space
3566. 	SetVariable(ZoneFreeUsedPer, 		0)
3567. 	SetVariable(ZoneFreeRequestedPer, 	0)
3568. 
3569. 
3570. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
3571. 
3572. # Footer:
3573. SetVariable(ZoneFooter, "----------------------------------------------------------
3574. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:49
3575. 
3576. Statistics Report:
3577. ------------------
3578.    Size:  
3579.    ------------------------
3580.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3581.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3582.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3583. 
3584.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3585.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3586. 
3587.    Location:
3588.    ------------------------
3589.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3590.              Files End: !ZoneEndCurrent!
3591.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3592.       
3593.    Gap Settings:
3594.    ------------------------
3595.          Gap Requested: !ZoneGapSizePer!%
3596.       Volume Rounding: !ZoneVolRoundUpPer!%
3597.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3598.                  
3599.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
3600.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
3601.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
3602.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
3603.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
3604.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
3605.      
3606.    Free Space after Zone:
3607.    ------------------------
3608.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3609.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3610.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3611. 
3612. Directory and Files Select:
3613. ---------------------------
3614. !ZoneTypeSelectCurrent!               
3615. ---------------------------
3616. ----------------------------------------------------------
3617. ")
3618. 
3619. # Script: BannerSet
3620. 
3621. # Script: DisplaySetDateTimeRun
3622. 
3623. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
3624. /* Xinclude "..\Display\BannerSet.MyDc"X */
3625. /* pause(1) */
3626. 
3627. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3628. 
3629. Title('!Heading!')
3630. /* pause(1) */
3631. 
3632. /* NOTE: Can't round or truncate to integer precision. */
3633. 
3634. # Script: BannerLog
3635. 
3636. AppendLogfile("!LogFileName!", "!Title!")
3637. 
3638. 
3639. 
3640. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
3641. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
3642. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:49")
3643. 
3644. SetVariable(ZoneListByLine, "!ZoneListByLine!
3645. Zone: !ZoneNoCurrent! 2021-11-09 18:53:49 0:00:05 !ZoneLabel! !ZoneDescription!")
3646. 
3647. 
3648. /* Fixed Zone Position Handling */
3649. /* Literal number: */
3650. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
3651. /* Percentage of disk: */
3652. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
3653. /* Gap */
3654. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
3655. 
3656. /* ---------------------------------------------------------- */
3657. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
3658. # Script: DisplaySetFileStep
3659. 
3660. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3661. 
3662. /* add message and move to a new line. */
3663. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3664. ")
3665. 
3666. /* display the line. (hopefully.) */
3667. # Zone Footer Set Statistics Window Text
3668. 
3669. SetStatisticsWindowText("----------------------------------------------------------
3670. Zones Processed: 
3671. ----------------------------------------------------------
3672. !ZoneListByLine!
3673. ----------------------------------------------------------
3674. Zone Processing Step:
3675. !ZoneStepByLine!    
3676. ----------------------------------------------------------
3677. Current Zone:
3678. !ZoneFooter!
3679. ----------------------------------------------------------
3680. Volume Statistics:
3681. !VolumeStatisticsDetail!
3682. ----------------------------------------------------------
3683. Zone Detailed Report:
3684. ----------------------------------------------------------
3685. !ZoneStatisticsDetail!
3686. ----------------------------------------------------------
3687. ")
3688. 
3689. 
3690. 
3691. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3692. 
3693. # Script: BannerSet
3694. 
3695. # Script: DisplaySetDateTimeRun
3696. 
3697. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
3698. /* Xinclude "..\Display\BannerSet.MyDc"X */
3699. /* pause(1) */
3700. 
3701. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3702. 
3703. Title('!Heading!')
3704. /* pause(1) */
3705. 
3706. /* NOTE: Can't round or truncate to integer precision. */
3707. 
3708. pause(1)
3709. 
3710. # your stuff HERE (X)... pre file select code.
3711. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
3712. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
3713. 	# (X)
3714. 
3715. FileSelect
3716. 
3717. 	# your stuff can't really go here (errors.)
3718. 	# maybe for some reason I don't know of...
3719. 	
3720. 	# Actions next...
3721. 		# Script: ZoneDo ZoneTypeSelectOsBoot
3722. # Boot start.
3723. ImportListFromBootOptimize()
3724. # Boot end.
3725. 
3726. 		and not(
3727. 			# Os PageHiberDump start.
3728. (
3729.   FileName("DataStore.edb")
3730.   or FileName("DUMP*.*")
3731.   or FileName("Hiberfil.sys")
3732.   or FileName("MEMORY.DMP")
3733.   or FileName("Pagefile.sys")
3734. )
3735. # Os PageHiberDump end.
3736. 
3737. 		)
3738. 
3739. 	FileActions
3740. 		  		/* ---------------------------------------------------------- */
3741. 	# Gap
3742. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
3743. 		# Script: DisplaySetFileStep
3744. 
3745. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3746. 
3747. /* add message and move to a new line. */
3748. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3749. ")
3750. 
3751. /* display the line. (hopefully.) */
3752. # Zone Footer Set Statistics Window Text
3753. 
3754. SetStatisticsWindowText("----------------------------------------------------------
3755. Zones Processed: 
3756. ----------------------------------------------------------
3757. !ZoneListByLine!
3758. ----------------------------------------------------------
3759. Zone Processing Step:
3760. !ZoneStepByLine!    
3761. ----------------------------------------------------------
3762. Current Zone:
3763. !ZoneFooter!
3764. ----------------------------------------------------------
3765. Volume Statistics:
3766. !VolumeStatisticsDetail!
3767. ----------------------------------------------------------
3768. Zone Detailed Report:
3769. ----------------------------------------------------------
3770. !ZoneStatisticsDetail!
3771. ----------------------------------------------------------
3772. ")
3773. 
3774. 
3775. 
3776. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3777. 
3778. # Script: BannerSet
3779. 
3780. # Script: DisplaySetDateTimeRun
3781. 
3782. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
3783. /* Xinclude "..\Display\BannerSet.MyDc"X */
3784. /* pause(1) */
3785. 
3786. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3787. 
3788. Title('!Heading!')
3789. /* pause(1) */
3790. 
3791. /* NOTE: Can't round or truncate to integer precision. */
3792. 
3793. pause(1)
3794. 	
3795. 	# ACTUAL GAP
3796. 		/* AddGap Variant. */
3797. 	  	# Zone Do Gap
3798. # Gap Calculation Methods:
3799. 
3800. /* 1) Anything you need to add first. */
3801. /* empty */
3802. 
3803. /* ---------------------------------------------------------- */
3804. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
3805. 	# GapRequestedStd.
3806. 
3807. 		/* ---------------------------------------------------------- */
3808. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
3809. 
3810. 		# Gap Calculation Methods:
3811. 
3812. /* AddGap Variants */
3813. 
3814. 	/* Standard */
3815. 		# Gap Calculation Methods:
3816. 	/* AddGap Variants */
3817. 	/* Standard */
3818. 
3819. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
3820. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
3821. 
3822. 	SetVariable(GapRequested, GapRequestedStd)
3823. 	
3824. 
3825. 	/* MFT Low High Method */
3826. 		# Gap Calculation Methods:
3827. 	/* AddGap Variants */
3828. 	/* MFT Low High Method */
3829. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
3830. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
3831. 	SetVariable(GapRequested, GapRequestedMft)
3832. 	
3833. 
3834. 	/* OS Volume Type Method */
3835. 		# Gap Calculation Methods:
3836. 	/* AddGap Variants */
3837. 	/* OS Volume Type Method */
3838. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
3839. 	SetVariable(GapRequested, GapRequestedOs)
3840. 
3841. 
3842. 
3843. /* MakeGap Variants */
3844. 
3845. 	/* Original Os 1-3 + MFT 2 */
3846. 		# Gap Calculation Methods:
3847. 	/* MakeGap Variants */
3848. 	/* Original Os 1-3 + MFT 2 */
3849. 	/* plus MFT gap placed inline at the dividing zone. */
3850. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
3851. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
3852. 	SetVariable(GapRequested, GapRequestedOrig)
3853. 	
3854. 	
3855. /* Note: You could comment out the ones not in use */
3856. /* However having the data in the log is useful. */
3857. /* Therefore the following line is otherwise needed. */
3858. 
3859. /* Standard used */
3860. 
3861. SetVariable(GapRequested, GapRequestedStd)
3862. 
3863. # Gap Calculation Methods:
3864. 
3865. /* AddGap Variants */
3866. 	/* Standard */
3867. 	/* MFT Low High Method */
3868. 	/* OS Volume Type Method */
3869. 
3870. /* MakeGap Variants */
3871. 	/* Original Os 1-3 + MFT 2 */
3872. 
3873. /* Note: You could comment out the ones not in use */
3874. /* However having the data in the log is useful. */
3875. /* Therefore the following line is otherwise needed. */
3876. 
3877. /* Standard is used currently */
3878. 
3879. 
3880. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
3881. 
3882. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
3883. 
3884. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
3885. 
3886. /* ---------------------------------------------------------- */
3887. /* 3) SMALL ZONE ADJUSTMENT. */
3888. /* Gab cant be larger than half the Zone Size. */
3889. 
3890. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
3891. 	
3892. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
3893. 
3894. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
3895. 
3896. /* ---------------------------------------------------------- */
3897. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
3898. # Gap Adjustments.
3899. 
3900. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
3901. 	
3902. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
3903. 
3904. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
3905. 
3906. /* ---------------------------------------------------------- */
3907. # BYPASS THIS.
3908. 	/* This is definitely wrong. */
3909. 	/* The question is can we steal gap from the next zone */
3910. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
3911. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
3912. 		# Zone Overflow.
3913. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
3914. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
3915. 
3916. /* ---------------------------------------------------------- */
3917. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
3918. # Remaining free space available.
3919. 
3920. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
3921. 	
3922. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
3923. 
3924. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
3925. 
3926. /* ---------------------------------------------------------- */
3927. # CURRENT gap to use.
3928. 
3929. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
3930. 
3931. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
3932. 
3933. /* ---------------------------------------------------------- */
3934. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
3935. # Debugging.
3936. 
3937. 	SetVariable(GapUsed, GapCurrent) // for debugging
3938. 
3939. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
3940. 
3941. 		# Your code HERE
3942. 
3943. /* ---------------------------------------------------------- */
3944. /* 7) YOUR CODE. */
3945. # YOUR CODE HERE:
3946. 	# INPUT: GapCurrent or GapCurrentLoc
3947. 	# OUTPUT: GapUsed...
3948. 
3949. /* ---------------------------------------------------------- */
3950. # Gap Size.
3951. # Actual Size of Gap.
3952. 
3953. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
3954. 
3955. /* ---------------------------------------------------------- */
3956. /* xxxxxxxxxxxxxxxxxxxxxx */
3957. # ADD THE GAP
3958. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
3959. /* xxxxxxxxxxxxxxxxxxxxxx */
3960. 
3961. 	
3962. 	# Zone Statistics	
3963. 	# Script: ZoneDoStatistics
3964. # Zone / Volume Statistics and Display
3965. 		
3966. 	# Accumulate Totals
3967.   	# Script: ZoneDoVolumeTotals
3968. 
3969. /* Current total space used (by Zones and Gaps) */
3970. 
3971. SetVariable(VolumeZoneUsed, GapUsed)
3972. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
3973. /* Percentage */
3974. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
3975. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
3976. 
3977. /* Current total of free space requested */
3978. 
3979. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
3980. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3981. /* Percent. */
3982. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
3983. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3984. 
3985. /* Current total of free space used */
3986. 
3987. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
3988. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
3989. /* Percent */
3990. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
3991. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
3992. 
3993. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
3994. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
3995. /* Xinclude "..\DebugDisplayPause.MyDc"X */
3996. 
3997. 
3998. 	# Current Values
3999. 	# Script: ZoneDoCurrentSet
4000. 
4001. # Cluster, Sector, Block adjust for display.
4002. 	# Bytes per cluster is volume specific.
4003. 
4004. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
4005. 
4006. # Current Zone values.
4007. 	# Begin, end and size.
4008. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
4009. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
4010. 
4011. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
4012. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
4013. 
4014. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
4015. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
4016. 
4017. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
4018. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
4019. 
4020. 	SetVariable(ZoneFragments,				"!ZONE210N!")
4021. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
4022. 		
4023. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
4024. /* identical code to here: (separation not needed. TEST.) */	
4025. 
4026. # Current Gap, Actual and Free Values
4027. 	# Gap
4028. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
4029. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
4030. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
4031. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
4032. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
4033. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
4034. 	
4035. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
4036. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
4037. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
4038. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
4039. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
4040. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
4041. 	
4042. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
4043. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
4044. 	
4045. 	# Actual Size and End
4046. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
4047. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
4048. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
4049. 	
4050. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
4051. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
4052. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
4053. 
4054. # Gap Size & Rounding
4055. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
4056. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
4057. 	
4058. 	# Free Space
4059. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
4060. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
4061. 
4062. 	# Footer:
4063. SetVariable(ZoneFooter, "----------------------------------------------------------
4064. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:49
4065. 
4066. Statistics Report:
4067. ------------------
4068.    Size:  
4069.    ------------------------
4070.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4071.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4072.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4073. 
4074.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4075.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4076. 
4077.    Location:
4078.    ------------------------
4079.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4080.              Files End: !ZoneEndCurrent!
4081.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4082.       
4083.    Gap Settings:
4084.    ------------------------
4085.          Gap Requested: !ZoneGapSizePer!%
4086.       Volume Rounding: !ZoneVolRoundUpPer!%
4087.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4088.                  
4089.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4090.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4091.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4092.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4093.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4094.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4095.      
4096.    Free Space after Zone:
4097.    ------------------------
4098.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4099.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4100.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4101. 
4102. Directory and Files Select:
4103. ---------------------------
4104. !ZoneTypeSelectCurrent!               
4105. ---------------------------
4106. ----------------------------------------------------------
4107. ")
4108. 	# Zone Footer Set Statistics Window Text
4109. 
4110. SetStatisticsWindowText("----------------------------------------------------------
4111. Zones Processed: 
4112. ----------------------------------------------------------
4113. !ZoneListByLine!
4114. ----------------------------------------------------------
4115. Zone Processing Step:
4116. !ZoneStepByLine!    
4117. ----------------------------------------------------------
4118. Current Zone:
4119. !ZoneFooter!
4120. ----------------------------------------------------------
4121. Volume Statistics:
4122. !VolumeStatisticsDetail!
4123. ----------------------------------------------------------
4124. Zone Detailed Report:
4125. ----------------------------------------------------------
4126. !ZoneStatisticsDetail!
4127. ----------------------------------------------------------
4128. ")
4129. 
4130. 
4131. 	
4132.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
4133. 
4134. 	# Add Zone to list of zones for display.
4135. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
4136. 	# ??? Free Stats?
4137. 	# Footer:
4138. SetVariable(ZoneFooter, "----------------------------------------------------------
4139. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:49
4140. 
4141. Statistics Report:
4142. ------------------
4143.    Size:  
4144.    ------------------------
4145.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4146.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4147.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4148. 
4149.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4150.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4151. 
4152.    Location:
4153.    ------------------------
4154.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4155.              Files End: !ZoneEndCurrent!
4156.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4157.       
4158.    Gap Settings:
4159.    ------------------------
4160.          Gap Requested: !ZoneGapSizePer!%
4161.       Volume Rounding: !ZoneVolRoundUpPer!%
4162.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4163.                  
4164.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4165.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4166.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4167.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4168.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4169.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4170.      
4171.    Free Space after Zone:
4172.    ------------------------
4173.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4174.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4175.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4176. 
4177. Directory and Files Select:
4178. ---------------------------
4179. !ZoneTypeSelectCurrent!               
4180. ---------------------------
4181. ----------------------------------------------------------
4182. ")
4183. 
4184. 	# Add Zone Details to Report.	
4185. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
4186. !ZoneFooter!")
4187. 
4188. 
4189. 	
4190. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
4191. 			# Script: DisplaySetFileStep
4192. 
4193. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4194. 
4195. /* add message and move to a new line. */
4196. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4197. ")
4198. 
4199. /* display the line. (hopefully.) */
4200. # Zone Footer Set Statistics Window Text
4201. 
4202. SetStatisticsWindowText("----------------------------------------------------------
4203. Zones Processed: 
4204. ----------------------------------------------------------
4205. !ZoneListByLine!
4206. ----------------------------------------------------------
4207. Zone Processing Step:
4208. !ZoneStepByLine!    
4209. ----------------------------------------------------------
4210. Current Zone:
4211. !ZoneFooter!
4212. ----------------------------------------------------------
4213. Volume Statistics:
4214. !VolumeStatisticsDetail!
4215. ----------------------------------------------------------
4216. Zone Detailed Report:
4217. ----------------------------------------------------------
4218. !ZoneStatisticsDetail!
4219. ----------------------------------------------------------
4220. ")
4221. 
4222. 
4223. 
4224. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4225. 
4226. # Script: BannerSet
4227. 
4228. # Script: DisplaySetDateTimeRun
4229. 
4230. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
4231. /* Xinclude "..\Display\BannerSet.MyDc"X */
4232. /* pause(1) */
4233. 
4234. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4235. 
4236. Title('!Heading!')
4237. /* pause(1) */
4238. 
4239. /* NOTE: Can't round or truncate to integer precision. */
4240. 
4241. pause(1)
4242. 
4243. 			# File Action - SortByImportSequence.
4244. SortByImportSequence(Ascending ) 
4245. 	
4246. 	
4247. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
4248. 			# Script: DisplaySetFileStep
4249. 
4250. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4251. 
4252. /* add message and move to a new line. */
4253. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4254. ")
4255. 
4256. /* display the line. (hopefully.) */
4257. # Zone Footer Set Statistics Window Text
4258. 
4259. SetStatisticsWindowText("----------------------------------------------------------
4260. Zones Processed: 
4261. ----------------------------------------------------------
4262. !ZoneListByLine!
4263. ----------------------------------------------------------
4264. Zone Processing Step:
4265. !ZoneStepByLine!    
4266. ----------------------------------------------------------
4267. Current Zone:
4268. !ZoneFooter!
4269. ----------------------------------------------------------
4270. Volume Statistics:
4271. !VolumeStatisticsDetail!
4272. ----------------------------------------------------------
4273. Zone Detailed Report:
4274. ----------------------------------------------------------
4275. !ZoneStatisticsDetail!
4276. ----------------------------------------------------------
4277. ")
4278. 
4279. 
4280. 
4281. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4282. 
4283. # Script: BannerSet
4284. 
4285. # Script: DisplaySetDateTimeRun
4286. 
4287. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
4288. /* Xinclude "..\Display\BannerSet.MyDc"X */
4289. /* pause(1) */
4290. 
4291. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4292. 
4293. Title('!Heading!')
4294. /* pause(1) */
4295. 
4296. /* NOTE: Can't round or truncate to integer precision. */
4297. 
4298. pause(1)
4299. 
4300. 		# Script: ZoneDoFooter
4301. 
4302. /* ---------------------------------------------------------- */
4303. # File Select
4304. 	# Select Statments
4305. # File Actions 
4306. 	# Standard or OS File Actions.
4307. 	# Resume...
4308. 	
4309. 	# your stuff HERE (X)... post zone (file) file actions code.
4310. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
4311. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4312. 		# (X)
4313. 		
4314. 		/* ??? Set window? */
4315. 	
4316. 	# ADD THE GAP
4317. 		
4318. # Vacate (good for diagnostics)
4319. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
4320. 
4321. # DoNotVacate - DO NOT Vacate (recommended)
4322. 
4323. # Vacate
4324. /* AddGap(GapUsedLoc) */
4325. 
4326. # DO Not Vacate
4327. AddGap(GapUsedLoc, DoNotVacate) 
4328. 	
4329. 	
4330. /* ---------------------------------------------------------- */
4331. # (failed) TEST for boolean logic.
4332. 
4333. /* It should work in the gap calculations for turning options */
4334. /* on and off but it will NOT work here. */
4335. 
4336. /* Boolean setting X or FlagX. */
4337. /* Where X will be on or off: */
4338. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
4339. /*      For ON:  (X  *  FlagAny) */
4340. 
4341. /* 1) Failed, zero gap overrode the previous one. */
4342. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
4343. /* AddGap(GapUsedTemp) */ 
4344. 
4345. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
4346. /* AddGap(GapUsedTemp, DoNotVacate) */ 
4347. 
4348. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
4349. 
4350. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
4351. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
4352. /* AddGap(GapUsedTemp) */ 
4353. 
4354. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
4355. /* AddGap(GapUsedTemp, DoNotVacate) */ 
4356. 
4357. /* ---------------------------------------------------------- */
4358. 
4359. # Vacate
4360. /* AddGap(GapUsed) */
4361. 
4362. # DO NOT Vacate (recommended)
4363. /* AddGap(GapUsed, DoNotVacate) */ 
4364. 	
4365. 
4366. 		
4367. # 
4368. FileEnd
4369. /* ---------------------------------------------------------- */
4370. 
4371. # your stuff HERE (X)... post zone (file) code.
4372. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
4373. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4374. 	# (X)
4375. 
4376. SetVariable(FileStepDescription,"Zone finished, reporting.")
4377. # Script: DisplaySetFileStep
4378. 
4379. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4380. 
4381. /* add message and move to a new line. */
4382. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4383. ")
4384. 
4385. /* display the line. (hopefully.) */
4386. # Zone Footer Set Statistics Window Text
4387. 
4388. SetStatisticsWindowText("----------------------------------------------------------
4389. Zones Processed: 
4390. ----------------------------------------------------------
4391. !ZoneListByLine!
4392. ----------------------------------------------------------
4393. Zone Processing Step:
4394. !ZoneStepByLine!    
4395. ----------------------------------------------------------
4396. Current Zone:
4397. !ZoneFooter!
4398. ----------------------------------------------------------
4399. Volume Statistics:
4400. !VolumeStatisticsDetail!
4401. ----------------------------------------------------------
4402. Zone Detailed Report:
4403. ----------------------------------------------------------
4404. !ZoneStatisticsDetail!
4405. ----------------------------------------------------------
4406. ")
4407. 
4408. 
4409. 
4410. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4411. 
4412. # Script: BannerSet
4413. 
4414. # Script: DisplaySetDateTimeRun
4415. 
4416. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
4417. /* Xinclude "..\Display\BannerSet.MyDc"X */
4418. /* pause(1) */
4419. 
4420. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4421. 
4422. Title('!Heading!')
4423. /* pause(1) */
4424. 
4425. /* NOTE: Can't round or truncate to integer precision. */
4426. 
4427. pause(1)
4428. 
4429. # Script: ZoneWhenFinished
4430. 
4431. # Script: BannerSet
4432. 
4433. # Script: DisplaySetDateTimeRun
4434. 
4435. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
4436. /* Xinclude "..\Display\BannerSet.MyDc"X */
4437. /* pause(1) */
4438. 
4439. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4440. 
4441. Title('!Heading!')
4442. /* pause(1) */
4443. 
4444. /* NOTE: Can't round or truncate to integer precision. */
4445. 
4446. # Script: BannerLog
4447. 
4448. AppendLogfile("!LogFileName!", "!Title!")
4449. 
4450. 
4451. 
4452. # Zone Statistics	
4453. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
4454. 
4455. # Footer:
4456. SetVariable(ZoneFooter, "----------------------------------------------------------
4457. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:49
4458. 
4459. Statistics Report:
4460. ------------------
4461.    Size:  
4462.    ------------------------
4463.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4464.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4465.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4466. 
4467.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4468.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4469. 
4470.    Location:
4471.    ------------------------
4472.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4473.              Files End: !ZoneEndCurrent!
4474.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4475.       
4476.    Gap Settings:
4477.    ------------------------
4478.          Gap Requested: !ZoneGapSizePer!%
4479.       Volume Rounding: !ZoneVolRoundUpPer!%
4480.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4481.                  
4482.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4483.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4484.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4485.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4486.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4487.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4488.      
4489.    Free Space after Zone:
4490.    ------------------------
4491.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4492.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4493.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4494. 
4495. Directory and Files Select:
4496. ---------------------------
4497. !ZoneTypeSelectCurrent!               
4498. ---------------------------
4499. ----------------------------------------------------------
4500. ")
4501. 
4502. AppendLogfile("!LogFileName!", ".")
4503. AppendLogfile("!LogFileName!", "!ZoneFooter!")
4504. AppendLogfile("!LogFileName!", ".")
4505. 
4506. # Zone Footer Set Statistics Window Text
4507. 
4508. SetStatisticsWindowText("----------------------------------------------------------
4509. Zones Processed: 
4510. ----------------------------------------------------------
4511. !ZoneListByLine!
4512. ----------------------------------------------------------
4513. Zone Processing Step:
4514. !ZoneStepByLine!    
4515. ----------------------------------------------------------
4516. Current Zone:
4517. !ZoneFooter!
4518. ----------------------------------------------------------
4519. Volume Statistics:
4520. !VolumeStatisticsDetail!
4521. ----------------------------------------------------------
4522. Zone Detailed Report:
4523. ----------------------------------------------------------
4524. !ZoneStatisticsDetail!
4525. ----------------------------------------------------------
4526. ")
4527. 
4528. 
4529. 
4530. /* pause() */
4531. /* pause() */
4532. 
4533. 
4534. 
4535. 
4536. /* ---------------------------------------------------------- */
4537. 
4538. 
4539. /* ---------------------------------------------------------- */
4540. # Zone ProgramHints Fixed.
4541. # Script: DefragZoneTypeOsProgramHints
4542. /* ---------------------------------------------------------- */
4543. # Zone ProgramHints Fixed.
4544. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHints!")
4545. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHints!")
4546. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
4547. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHints!")
4548. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsProgramHints
4549. # ProgramHints start.
4550. ImportListFromProgramHints("*.pf")
4551. # ProgramHints end.
4552. ')
4553. 
4554. 		# Script: ZoneDoHeader
4555. 
4556. # Script: ZoneWhenStarted
4557. 
4558. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
4559. # Script: DisplaySetZone
4560. 
4561. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
4562. SetVariable(FileStepDescription,	"")
4563. 
4564. SetVariable(ZoneStepByLine, 			"Zone started.
4565. ")
4566. 
4567. # Script: BannerDescriptionSet
4568. 
4569. # Script: BannerSet
4570. 
4571. # Script: DisplaySetDateTimeRun
4572. 
4573. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
4574. /* Xinclude "..\Display\BannerSet.MyDc"X */
4575. /* pause(1) */
4576. 
4577. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4578. 
4579. Title('!Heading!')
4580. /* pause(1) */
4581. 
4582. /* NOTE: Can't round or truncate to integer precision. */
4583. 
4584. # Script: BannerLog
4585. 
4586. AppendLogfile("!LogFileName!", "!Title!")
4587. 
4588. 
4589. 
4590. pause(1)
4591. 
4592. 
4593. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
4594. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
4595. 
4596. SetVariable(ZoneStepNoCurrent, 0)
4597. 
4598. 
4599. # Script: ZoneDoCurrentClear
4600. 
4601. SetVariable(ZoneTypeSelectCurrent, 		"")
4602. 
4603. SetVariable(ZoneBeginCurrent, 			0)
4604. SetVariable(ZoneBeginPerCurrent, 		0)
4605. SetVariable(ZoneEndCurrent, 			0)
4606. SetVariable(ZoneEndPerCurrent, 			0)
4607. 
4608. SetVariable(ZoneSizeCurrent,			0)
4609. SetVariable(ZoneSizePerCurrent,			0)
4610. 
4611. SetVariable(ZoneGapRequestedCurrent,	0)
4612. SetVariable(ZoneGapRoundedCurrent, 		0)
4613. SetVariable(ZoneGapAdjustedCurrent, 	0)
4614. SetVariable(ZoneGapAvailableCurrent, 	0)
4615. SetVariable(ZoneGapCurrent,				0)
4616. SetVariable(ZoneGapUsedCurrent, 		0)
4617. 
4618. SetVariable(ZoneGapActualCurrent, 		0)
4619. SetVariable(ZoneGapActualPerCurrent, 	0)
4620. 
4621. SetVariable(ZoneSizeActual, 			0)
4622. SetVariable(ZoneSizeActualCurrent,		0)
4623. 
4624. SetVariable(ZoneEndActual, 				0)
4625. SetVariable(ZoneEndActualCurrent,		0)			
4626. SetVariable(ZoneSizeActualPerCurrent, 	0)
4627.       
4628. SetVariable(ZoneFilesFolders,			0)
4629. SetVariable(ZoneFilesFoldersPer,		0) 
4630. 
4631. SetVariable(ZoneFragments,				0)
4632. SetVariable(ZoneFragmentsPer,			0) 
4633. 		
4634. SetVariable(ZoneEndActualCurrent, 		0)
4635. SetVariable(ZoneEndActualPerCurrent, 	0)
4636. 
4637. # Gap Calculation Methodology:
4638. 	# Requested
4639. 	SetVariable(GapRequested, 			0) 
4640. 	SetVariable(GapRequestedStd, 		0) 
4641. 	SetVariable(GapRequestedMft, 		0) 
4642. 	SetVariable(GapRequestedOs, 		0) 
4643. 	SetVariable(GapRequestedOriginal, 	0) 
4644. 	
4645. 	# Gap Adjustments
4646. 	SetVariable(GapRounded, 			0)
4647. 	# SetVariable(GapAdjusted, 			0)
4648. 	SetVariable(GapAvailable, 			0)
4649. 	SetVariable(GapCurrent, 			0)
4650. 	SetVariable(GapActual, 				0)
4651. 	SetVariable(GapUsed, 				0)
4652. 	
4653. 	# Gap Adjustments
4654. 	SetVariable(GapRoundedLoc, 			0)
4655. 	# SetVariable(GapAdjustedLoc, 		0)
4656. 	SetVariable(GapAvailableLoc, 		0)
4657. 	SetVariable(GapCurrentLoc, 			0)
4658. 	SetVariable(GapActualLoc,			0)
4659. 	SetVariable(GapUsedLoc,				0)
4660. 	
4661. 	# Space usage
4662. 	SetVariable(ZoneFreePerRequested, 	0)
4663. 	SetVariable(ZoneFreePerUsed, 		0)
4664. 
4665. # Gap Size & Rounding
4666. 	SetVariable(ZoneGapSizePer, 		0)
4667. 	SetVariable(ZoneVolRoundUpPer, 		0)
4668. 	
4669. 	# Free Space
4670. 	SetVariable(ZoneFreeUsedPer, 		0)
4671. 	SetVariable(ZoneFreeRequestedPer, 	0)
4672. 
4673. 
4674. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
4675. 
4676. # Footer:
4677. SetVariable(ZoneFooter, "----------------------------------------------------------
4678. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:49
4679. 
4680. Statistics Report:
4681. ------------------
4682.    Size:  
4683.    ------------------------
4684.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4685.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4686.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4687. 
4688.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4689.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4690. 
4691.    Location:
4692.    ------------------------
4693.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4694.              Files End: !ZoneEndCurrent!
4695.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4696.       
4697.    Gap Settings:
4698.    ------------------------
4699.          Gap Requested: !ZoneGapSizePer!%
4700.       Volume Rounding: !ZoneVolRoundUpPer!%
4701.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4702.                  
4703.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4704.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4705.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4706.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4707.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4708.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4709.      
4710.    Free Space after Zone:
4711.    ------------------------
4712.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4713.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4714.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4715. 
4716. Directory and Files Select:
4717. ---------------------------
4718. !ZoneTypeSelectCurrent!               
4719. ---------------------------
4720. ----------------------------------------------------------
4721. ")
4722. 
4723. # Script: BannerSet
4724. 
4725. # Script: DisplaySetDateTimeRun
4726. 
4727. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
4728. /* Xinclude "..\Display\BannerSet.MyDc"X */
4729. /* pause(1) */
4730. 
4731. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4732. 
4733. Title('!Heading!')
4734. /* pause(1) */
4735. 
4736. /* NOTE: Can't round or truncate to integer precision. */
4737. 
4738. # Script: BannerLog
4739. 
4740. AppendLogfile("!LogFileName!", "!Title!")
4741. 
4742. 
4743. 
4744. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
4745. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
4746. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:49")
4747. 
4748. SetVariable(ZoneListByLine, "!ZoneListByLine!
4749. Zone: !ZoneNoCurrent! 2021-11-09 18:53:49 0:00:05 !ZoneLabel! !ZoneDescription!")
4750. 
4751. 
4752. /* Fixed Zone Position Handling */
4753. /* Literal number: */
4754. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
4755. /* Percentage of disk: */
4756. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
4757. /* Gap */
4758. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
4759. 
4760. /* ---------------------------------------------------------- */
4761. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
4762. # Script: DisplaySetFileStep
4763. 
4764. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4765. 
4766. /* add message and move to a new line. */
4767. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4768. ")
4769. 
4770. /* display the line. (hopefully.) */
4771. # Zone Footer Set Statistics Window Text
4772. 
4773. SetStatisticsWindowText("----------------------------------------------------------
4774. Zones Processed: 
4775. ----------------------------------------------------------
4776. !ZoneListByLine!
4777. ----------------------------------------------------------
4778. Zone Processing Step:
4779. !ZoneStepByLine!    
4780. ----------------------------------------------------------
4781. Current Zone:
4782. !ZoneFooter!
4783. ----------------------------------------------------------
4784. Volume Statistics:
4785. !VolumeStatisticsDetail!
4786. ----------------------------------------------------------
4787. Zone Detailed Report:
4788. ----------------------------------------------------------
4789. !ZoneStatisticsDetail!
4790. ----------------------------------------------------------
4791. ")
4792. 
4793. 
4794. 
4795. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4796. 
4797. # Script: BannerSet
4798. 
4799. # Script: DisplaySetDateTimeRun
4800. 
4801. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
4802. /* Xinclude "..\Display\BannerSet.MyDc"X */
4803. /* pause(1) */
4804. 
4805. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4806. 
4807. Title('!Heading!')
4808. /* pause(1) */
4809. 
4810. /* NOTE: Can't round or truncate to integer precision. */
4811. 
4812. pause(1)
4813. 
4814. # your stuff HERE (X)... pre file select code.
4815. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
4816. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
4817. 	# (X)
4818. 
4819. FileSelect
4820. 
4821. 	# your stuff can't really go here (errors.)
4822. 	# maybe for some reason I don't know of...
4823. 	
4824. 	# Actions next...
4825. 		# Script: ZoneDo ZoneTypeSelectOsProgramHints
4826. # ProgramHints start.
4827. ImportListFromProgramHints("*.pf")
4828. # ProgramHints end.
4829. 
4830. 		and not(
4831. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
4832. # Os Data Dynamic start.
4833. (
4834. # Os Data Dynamic start.
4835. (
4836.   FileName("*.dat*")
4837.   or FileName("*.db*")
4838.   or FileName("*.edb*")
4839.   or FileName("*.log*")
4840.   or FileName("DataStore.edb")
4841. )
4842. # Os Data Dynamic end.
4843. 
4844.   or 
4845. # Os PageHiberDump start.
4846. (
4847.   FileName("DataStore.edb")
4848.   or FileName("DUMP*.*")
4849.   or FileName("Hiberfil.sys")
4850.   or FileName("MEMORY.DMP")
4851.   or FileName("Pagefile.sys")
4852. )
4853. # Os PageHiberDump end.
4854. 
4855. # Os Data Dynamic
4856. )
4857. # Os Data Dynamic end.
4858. 
4859. 		)
4860. 		FileActions
4861. 		  		/* ---------------------------------------------------------- */
4862. 	# Gap
4863. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
4864. 		# Script: DisplaySetFileStep
4865. 
4866. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4867. 
4868. /* add message and move to a new line. */
4869. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4870. ")
4871. 
4872. /* display the line. (hopefully.) */
4873. # Zone Footer Set Statistics Window Text
4874. 
4875. SetStatisticsWindowText("----------------------------------------------------------
4876. Zones Processed: 
4877. ----------------------------------------------------------
4878. !ZoneListByLine!
4879. ----------------------------------------------------------
4880. Zone Processing Step:
4881. !ZoneStepByLine!    
4882. ----------------------------------------------------------
4883. Current Zone:
4884. !ZoneFooter!
4885. ----------------------------------------------------------
4886. Volume Statistics:
4887. !VolumeStatisticsDetail!
4888. ----------------------------------------------------------
4889. Zone Detailed Report:
4890. ----------------------------------------------------------
4891. !ZoneStatisticsDetail!
4892. ----------------------------------------------------------
4893. ")
4894. 
4895. 
4896. 
4897. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4898. 
4899. # Script: BannerSet
4900. 
4901. # Script: DisplaySetDateTimeRun
4902. 
4903. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
4904. /* Xinclude "..\Display\BannerSet.MyDc"X */
4905. /* pause(1) */
4906. 
4907. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4908. 
4909. Title('!Heading!')
4910. /* pause(1) */
4911. 
4912. /* NOTE: Can't round or truncate to integer precision. */
4913. 
4914. pause(1)
4915. 	
4916. 	# ACTUAL GAP
4917. 		/* AddGap Variant. */
4918. 	  	# Zone Do Gap
4919. # Gap Calculation Methods:
4920. 
4921. /* 1) Anything you need to add first. */
4922. /* empty */
4923. 
4924. /* ---------------------------------------------------------- */
4925. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
4926. 	# GapRequestedStd.
4927. 
4928. 		/* ---------------------------------------------------------- */
4929. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
4930. 
4931. 		# Gap Calculation Methods:
4932. 
4933. /* AddGap Variants */
4934. 
4935. 	/* Standard */
4936. 		# Gap Calculation Methods:
4937. 	/* AddGap Variants */
4938. 	/* Standard */
4939. 
4940. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
4941. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
4942. 
4943. 	SetVariable(GapRequested, GapRequestedStd)
4944. 	
4945. 
4946. 	/* MFT Low High Method */
4947. 		# Gap Calculation Methods:
4948. 	/* AddGap Variants */
4949. 	/* MFT Low High Method */
4950. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
4951. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
4952. 	SetVariable(GapRequested, GapRequestedMft)
4953. 	
4954. 
4955. 	/* OS Volume Type Method */
4956. 		# Gap Calculation Methods:
4957. 	/* AddGap Variants */
4958. 	/* OS Volume Type Method */
4959. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
4960. 	SetVariable(GapRequested, GapRequestedOs)
4961. 
4962. 
4963. 
4964. /* MakeGap Variants */
4965. 
4966. 	/* Original Os 1-3 + MFT 2 */
4967. 		# Gap Calculation Methods:
4968. 	/* MakeGap Variants */
4969. 	/* Original Os 1-3 + MFT 2 */
4970. 	/* plus MFT gap placed inline at the dividing zone. */
4971. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
4972. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
4973. 	SetVariable(GapRequested, GapRequestedOrig)
4974. 	
4975. 	
4976. /* Note: You could comment out the ones not in use */
4977. /* However having the data in the log is useful. */
4978. /* Therefore the following line is otherwise needed. */
4979. 
4980. /* Standard used */
4981. 
4982. SetVariable(GapRequested, GapRequestedStd)
4983. 
4984. # Gap Calculation Methods:
4985. 
4986. /* AddGap Variants */
4987. 	/* Standard */
4988. 	/* MFT Low High Method */
4989. 	/* OS Volume Type Method */
4990. 
4991. /* MakeGap Variants */
4992. 	/* Original Os 1-3 + MFT 2 */
4993. 
4994. /* Note: You could comment out the ones not in use */
4995. /* However having the data in the log is useful. */
4996. /* Therefore the following line is otherwise needed. */
4997. 
4998. /* Standard is used currently */
4999. 
5000. 
5001. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
5002. 
5003. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
5004. 
5005. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
5006. 
5007. /* ---------------------------------------------------------- */
5008. /* 3) SMALL ZONE ADJUSTMENT. */
5009. /* Gab cant be larger than half the Zone Size. */
5010. 
5011. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
5012. 	
5013. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
5014. 
5015. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
5016. 
5017. /* ---------------------------------------------------------- */
5018. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
5019. # Gap Adjustments.
5020. 
5021. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
5022. 	
5023. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
5024. 
5025. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
5026. 
5027. /* ---------------------------------------------------------- */
5028. # BYPASS THIS.
5029. 	/* This is definitely wrong. */
5030. 	/* The question is can we steal gap from the next zone */
5031. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
5032. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
5033. 		# Zone Overflow.
5034. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
5035. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
5036. 
5037. /* ---------------------------------------------------------- */
5038. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
5039. # Remaining free space available.
5040. 
5041. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
5042. 	
5043. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
5044. 
5045. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
5046. 
5047. /* ---------------------------------------------------------- */
5048. # CURRENT gap to use.
5049. 
5050. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
5051. 
5052. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
5053. 
5054. /* ---------------------------------------------------------- */
5055. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
5056. # Debugging.
5057. 
5058. 	SetVariable(GapUsed, GapCurrent) // for debugging
5059. 
5060. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
5061. 
5062. 		# Your code HERE
5063. 
5064. /* ---------------------------------------------------------- */
5065. /* 7) YOUR CODE. */
5066. # YOUR CODE HERE:
5067. 	# INPUT: GapCurrent or GapCurrentLoc
5068. 	# OUTPUT: GapUsed...
5069. 
5070. /* ---------------------------------------------------------- */
5071. # Gap Size.
5072. # Actual Size of Gap.
5073. 
5074. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
5075. 
5076. /* ---------------------------------------------------------- */
5077. /* xxxxxxxxxxxxxxxxxxxxxx */
5078. # ADD THE GAP
5079. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
5080. /* xxxxxxxxxxxxxxxxxxxxxx */
5081. 
5082. 	
5083. 	# Zone Statistics	
5084. 	# Script: ZoneDoStatistics
5085. # Zone / Volume Statistics and Display
5086. 		
5087. 	# Accumulate Totals
5088.   	# Script: ZoneDoVolumeTotals
5089. 
5090. /* Current total space used (by Zones and Gaps) */
5091. 
5092. SetVariable(VolumeZoneUsed, GapUsed)
5093. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
5094. /* Percentage */
5095. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
5096. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
5097. 
5098. /* Current total of free space requested */
5099. 
5100. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
5101. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5102. /* Percent. */
5103. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
5104. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5105. 
5106. /* Current total of free space used */
5107. 
5108. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
5109. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
5110. /* Percent */
5111. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
5112. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
5113. 
5114. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
5115. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
5116. /* Xinclude "..\DebugDisplayPause.MyDc"X */
5117. 
5118. 
5119. 	# Current Values
5120. 	# Script: ZoneDoCurrentSet
5121. 
5122. # Cluster, Sector, Block adjust for display.
5123. 	# Bytes per cluster is volume specific.
5124. 
5125. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
5126. 
5127. # Current Zone values.
5128. 	# Begin, end and size.
5129. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
5130. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
5131. 
5132. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
5133. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
5134. 
5135. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
5136. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
5137. 
5138. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
5139. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
5140. 
5141. 	SetVariable(ZoneFragments,				"!ZONE210N!")
5142. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
5143. 		
5144. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
5145. /* identical code to here: (separation not needed. TEST.) */	
5146. 
5147. # Current Gap, Actual and Free Values
5148. 	# Gap
5149. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
5150. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
5151. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
5152. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
5153. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
5154. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
5155. 	
5156. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
5157. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
5158. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
5159. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
5160. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
5161. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
5162. 	
5163. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
5164. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
5165. 	
5166. 	# Actual Size and End
5167. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
5168. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
5169. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
5170. 	
5171. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
5172. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
5173. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
5174. 
5175. # Gap Size & Rounding
5176. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
5177. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
5178. 	
5179. 	# Free Space
5180. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
5181. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
5182. 
5183. 	# Footer:
5184. SetVariable(ZoneFooter, "----------------------------------------------------------
5185. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:49
5186. 
5187. Statistics Report:
5188. ------------------
5189.    Size:  
5190.    ------------------------
5191.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5192.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5193.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5194. 
5195.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5196.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5197. 
5198.    Location:
5199.    ------------------------
5200.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5201.              Files End: !ZoneEndCurrent!
5202.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5203.       
5204.    Gap Settings:
5205.    ------------------------
5206.          Gap Requested: !ZoneGapSizePer!%
5207.       Volume Rounding: !ZoneVolRoundUpPer!%
5208.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5209.                  
5210.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5211.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5212.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5213.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5214.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5215.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5216.      
5217.    Free Space after Zone:
5218.    ------------------------
5219.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5220.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5221.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5222. 
5223. Directory and Files Select:
5224. ---------------------------
5225. !ZoneTypeSelectCurrent!               
5226. ---------------------------
5227. ----------------------------------------------------------
5228. ")
5229. 	# Zone Footer Set Statistics Window Text
5230. 
5231. SetStatisticsWindowText("----------------------------------------------------------
5232. Zones Processed: 
5233. ----------------------------------------------------------
5234. !ZoneListByLine!
5235. ----------------------------------------------------------
5236. Zone Processing Step:
5237. !ZoneStepByLine!    
5238. ----------------------------------------------------------
5239. Current Zone:
5240. !ZoneFooter!
5241. ----------------------------------------------------------
5242. Volume Statistics:
5243. !VolumeStatisticsDetail!
5244. ----------------------------------------------------------
5245. Zone Detailed Report:
5246. ----------------------------------------------------------
5247. !ZoneStatisticsDetail!
5248. ----------------------------------------------------------
5249. ")
5250. 
5251. 
5252. 	
5253.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
5254. 
5255. 	# Add Zone to list of zones for display.
5256. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
5257. 	# ??? Free Stats?
5258. 	# Footer:
5259. SetVariable(ZoneFooter, "----------------------------------------------------------
5260. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:49
5261. 
5262. Statistics Report:
5263. ------------------
5264.    Size:  
5265.    ------------------------
5266.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5267.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5268.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5269. 
5270.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5271.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5272. 
5273.    Location:
5274.    ------------------------
5275.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5276.              Files End: !ZoneEndCurrent!
5277.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5278.       
5279.    Gap Settings:
5280.    ------------------------
5281.          Gap Requested: !ZoneGapSizePer!%
5282.       Volume Rounding: !ZoneVolRoundUpPer!%
5283.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5284.                  
5285.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5286.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5287.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5288.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5289.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5290.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5291.      
5292.    Free Space after Zone:
5293.    ------------------------
5294.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5295.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5296.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5297. 
5298. Directory and Files Select:
5299. ---------------------------
5300. !ZoneTypeSelectCurrent!               
5301. ---------------------------
5302. ----------------------------------------------------------
5303. ")
5304. 
5305. 	# Add Zone Details to Report.	
5306. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
5307. !ZoneFooter!")
5308. 
5309. 
5310. 		
5311. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
5312. 			# Script: DisplaySetFileStep
5313. 
5314. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5315. 
5316. /* add message and move to a new line. */
5317. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5318. ")
5319. 
5320. /* display the line. (hopefully.) */
5321. # Zone Footer Set Statistics Window Text
5322. 
5323. SetStatisticsWindowText("----------------------------------------------------------
5324. Zones Processed: 
5325. ----------------------------------------------------------
5326. !ZoneListByLine!
5327. ----------------------------------------------------------
5328. Zone Processing Step:
5329. !ZoneStepByLine!    
5330. ----------------------------------------------------------
5331. Current Zone:
5332. !ZoneFooter!
5333. ----------------------------------------------------------
5334. Volume Statistics:
5335. !VolumeStatisticsDetail!
5336. ----------------------------------------------------------
5337. Zone Detailed Report:
5338. ----------------------------------------------------------
5339. !ZoneStatisticsDetail!
5340. ----------------------------------------------------------
5341. ")
5342. 
5343. 
5344. 
5345. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5346. 
5347. # Script: BannerSet
5348. 
5349. # Script: DisplaySetDateTimeRun
5350. 
5351. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
5352. /* Xinclude "..\Display\BannerSet.MyDc"X */
5353. /* pause(1) */
5354. 
5355. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5356. 
5357. Title('!Heading!')
5358. /* pause(1) */
5359. 
5360. /* NOTE: Can't round or truncate to integer precision. */
5361. 
5362. pause(1)
5363. 	
5364. 			# File Action - Type Os Program Hints.
5365. # File Action - SortByImportSequence.
5366. SortByImportSequence(Ascending ) 
5367. 	
5368. 	
5369. 
5370. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
5371. 			# Script: DisplaySetFileStep
5372. 
5373. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5374. 
5375. /* add message and move to a new line. */
5376. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5377. ")
5378. 
5379. /* display the line. (hopefully.) */
5380. # Zone Footer Set Statistics Window Text
5381. 
5382. SetStatisticsWindowText("----------------------------------------------------------
5383. Zones Processed: 
5384. ----------------------------------------------------------
5385. !ZoneListByLine!
5386. ----------------------------------------------------------
5387. Zone Processing Step:
5388. !ZoneStepByLine!    
5389. ----------------------------------------------------------
5390. Current Zone:
5391. !ZoneFooter!
5392. ----------------------------------------------------------
5393. Volume Statistics:
5394. !VolumeStatisticsDetail!
5395. ----------------------------------------------------------
5396. Zone Detailed Report:
5397. ----------------------------------------------------------
5398. !ZoneStatisticsDetail!
5399. ----------------------------------------------------------
5400. ")
5401. 
5402. 
5403. 
5404. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5405. 
5406. # Script: BannerSet
5407. 
5408. # Script: DisplaySetDateTimeRun
5409. 
5410. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:49 0:00:05")
5411. /* Xinclude "..\Display\BannerSet.MyDc"X */
5412. /* pause(1) */
5413. 
5414. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5415. 
5416. Title('!Heading!')
5417. /* pause(1) */
5418. 
5419. /* NOTE: Can't round or truncate to integer precision. */
5420. 
5421. pause(1)
5422. 
5423. 		# Script: ZoneDoFooter
5424. 
5425. /* ---------------------------------------------------------- */
5426. # File Select
5427. 	# Select Statments
5428. # File Actions 
5429. 	# Standard or OS File Actions.
5430. 	# Resume...
5431. 	
5432. 	# your stuff HERE (X)... post zone (file) file actions code.
5433. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
5434. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5435. 		# (X)
5436. 		
5437. 		/* ??? Set window? */
5438. 	
5439. 	# ADD THE GAP
5440. 		
5441. # Vacate (good for diagnostics)
5442. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
5443. 
5444. # DoNotVacate - DO NOT Vacate (recommended)
5445. 
5446. # Vacate
5447. /* AddGap(GapUsedLoc) */
5448. 
5449. # DO Not Vacate
5450. AddGap(GapUsedLoc, DoNotVacate) 
5451. 	
5452. 	
5453. /* ---------------------------------------------------------- */
5454. # (failed) TEST for boolean logic.
5455. 
5456. /* It should work in the gap calculations for turning options */
5457. /* on and off but it will NOT work here. */
5458. 
5459. /* Boolean setting X or FlagX. */
5460. /* Where X will be on or off: */
5461. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
5462. /*      For ON:  (X  *  FlagAny) */
5463. 
5464. /* 1) Failed, zero gap overrode the previous one. */
5465. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
5466. /* AddGap(GapUsedTemp) */ 
5467. 
5468. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
5469. /* AddGap(GapUsedTemp, DoNotVacate) */ 
5470. 
5471. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
5472. 
5473. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
5474. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
5475. /* AddGap(GapUsedTemp) */ 
5476. 
5477. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
5478. /* AddGap(GapUsedTemp, DoNotVacate) */ 
5479. 
5480. /* ---------------------------------------------------------- */
5481. 
5482. # Vacate
5483. /* AddGap(GapUsed) */
5484. 
5485. # DO NOT Vacate (recommended)
5486. /* AddGap(GapUsed, DoNotVacate) */ 
5487. 	
5488. 
5489. 		
5490. # 
5491. FileEnd
5492. /* ---------------------------------------------------------- */
5493. 
5494. # your stuff HERE (X)... post zone (file) code.
5495. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
5496. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5497. 	# (X)
5498. 
5499. SetVariable(FileStepDescription,"Zone finished, reporting.")
5500. # Script: DisplaySetFileStep
5501. 
5502. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5503. 
5504. /* add message and move to a new line. */
5505. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5506. ")
5507. 
5508. /* display the line. (hopefully.) */
5509. # Zone Footer Set Statistics Window Text
5510. 
5511. SetStatisticsWindowText("----------------------------------------------------------
5512. Zones Processed: 
5513. ----------------------------------------------------------
5514. !ZoneListByLine!
5515. ----------------------------------------------------------
5516. Zone Processing Step:
5517. !ZoneStepByLine!    
5518. ----------------------------------------------------------
5519. Current Zone:
5520. !ZoneFooter!
5521. ----------------------------------------------------------
5522. Volume Statistics:
5523. !VolumeStatisticsDetail!
5524. ----------------------------------------------------------
5525. Zone Detailed Report:
5526. ----------------------------------------------------------
5527. !ZoneStatisticsDetail!
5528. ----------------------------------------------------------
5529. ")
5530. 
5531. 
5532. 
5533. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5534. 
5535. # Script: BannerSet
5536. 
5537. # Script: DisplaySetDateTimeRun
5538. 
5539. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
5540. /* Xinclude "..\Display\BannerSet.MyDc"X */
5541. /* pause(1) */
5542. 
5543. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5544. 
5545. Title('!Heading!')
5546. /* pause(1) */
5547. 
5548. /* NOTE: Can't round or truncate to integer precision. */
5549. 
5550. pause(1)
5551. 
5552. # Script: ZoneWhenFinished
5553. 
5554. # Script: BannerSet
5555. 
5556. # Script: DisplaySetDateTimeRun
5557. 
5558. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
5559. /* Xinclude "..\Display\BannerSet.MyDc"X */
5560. /* pause(1) */
5561. 
5562. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5563. 
5564. Title('!Heading!')
5565. /* pause(1) */
5566. 
5567. /* NOTE: Can't round or truncate to integer precision. */
5568. 
5569. # Script: BannerLog
5570. 
5571. AppendLogfile("!LogFileName!", "!Title!")
5572. 
5573. 
5574. 
5575. # Zone Statistics	
5576. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
5577. 
5578. # Footer:
5579. SetVariable(ZoneFooter, "----------------------------------------------------------
5580. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
5581. 
5582. Statistics Report:
5583. ------------------
5584.    Size:  
5585.    ------------------------
5586.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5587.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5588.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5589. 
5590.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5591.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5592. 
5593.    Location:
5594.    ------------------------
5595.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5596.              Files End: !ZoneEndCurrent!
5597.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5598.       
5599.    Gap Settings:
5600.    ------------------------
5601.          Gap Requested: !ZoneGapSizePer!%
5602.       Volume Rounding: !ZoneVolRoundUpPer!%
5603.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5604.                  
5605.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5606.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5607.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5608.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5609.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5610.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5611.      
5612.    Free Space after Zone:
5613.    ------------------------
5614.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5615.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5616.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5617. 
5618. Directory and Files Select:
5619. ---------------------------
5620. !ZoneTypeSelectCurrent!               
5621. ---------------------------
5622. ----------------------------------------------------------
5623. ")
5624. 
5625. AppendLogfile("!LogFileName!", ".")
5626. AppendLogfile("!LogFileName!", "!ZoneFooter!")
5627. AppendLogfile("!LogFileName!", ".")
5628. 
5629. # Zone Footer Set Statistics Window Text
5630. 
5631. SetStatisticsWindowText("----------------------------------------------------------
5632. Zones Processed: 
5633. ----------------------------------------------------------
5634. !ZoneListByLine!
5635. ----------------------------------------------------------
5636. Zone Processing Step:
5637. !ZoneStepByLine!    
5638. ----------------------------------------------------------
5639. Current Zone:
5640. !ZoneFooter!
5641. ----------------------------------------------------------
5642. Volume Statistics:
5643. !VolumeStatisticsDetail!
5644. ----------------------------------------------------------
5645. Zone Detailed Report:
5646. ----------------------------------------------------------
5647. !ZoneStatisticsDetail!
5648. ----------------------------------------------------------
5649. ")
5650. 
5651. 
5652. 
5653. /* pause() */
5654. /* pause() */
5655. 
5656. 
5657. 
5658. 	
5659. /* ---------------------------------------------------------- */
5660. # Zone ProgramHints Data.
5661. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHintsData!")
5662. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHintsData!")
5663. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
5664. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHints!")
5665. 	SetVariable(ZoneTypeSelect,'
5666.                 # ProgramHints - Data files.
5667.                 not(
5668.                      # Os PageHiberDump start.
5669. (
5670.   FileName("DataStore.edb")
5671.   or FileName("DUMP*.*")
5672.   or FileName("Hiberfil.sys")
5673.   or FileName("MEMORY.DMP")
5674.   or FileName("Pagefile.sys")
5675. )
5676. # Os PageHiberDump end.
5677. 
5678.                 )
5679. ')
5680. 
5681. 
5682. 		# Script: ZoneDoHeader
5683. 
5684. # Script: ZoneWhenStarted
5685. 
5686. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
5687. # Script: DisplaySetZone
5688. 
5689. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
5690. SetVariable(FileStepDescription,	"")
5691. 
5692. SetVariable(ZoneStepByLine, 			"Zone started.
5693. ")
5694. 
5695. # Script: BannerDescriptionSet
5696. 
5697. # Script: BannerSet
5698. 
5699. # Script: DisplaySetDateTimeRun
5700. 
5701. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
5702. /* Xinclude "..\Display\BannerSet.MyDc"X */
5703. /* pause(1) */
5704. 
5705. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5706. 
5707. Title('!Heading!')
5708. /* pause(1) */
5709. 
5710. /* NOTE: Can't round or truncate to integer precision. */
5711. 
5712. # Script: BannerLog
5713. 
5714. AppendLogfile("!LogFileName!", "!Title!")
5715. 
5716. 
5717. 
5718. pause(1)
5719. 
5720. 
5721. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
5722. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
5723. 
5724. SetVariable(ZoneStepNoCurrent, 0)
5725. 
5726. 
5727. # Script: ZoneDoCurrentClear
5728. 
5729. SetVariable(ZoneTypeSelectCurrent, 		"")
5730. 
5731. SetVariable(ZoneBeginCurrent, 			0)
5732. SetVariable(ZoneBeginPerCurrent, 		0)
5733. SetVariable(ZoneEndCurrent, 			0)
5734. SetVariable(ZoneEndPerCurrent, 			0)
5735. 
5736. SetVariable(ZoneSizeCurrent,			0)
5737. SetVariable(ZoneSizePerCurrent,			0)
5738. 
5739. SetVariable(ZoneGapRequestedCurrent,	0)
5740. SetVariable(ZoneGapRoundedCurrent, 		0)
5741. SetVariable(ZoneGapAdjustedCurrent, 	0)
5742. SetVariable(ZoneGapAvailableCurrent, 	0)
5743. SetVariable(ZoneGapCurrent,				0)
5744. SetVariable(ZoneGapUsedCurrent, 		0)
5745. 
5746. SetVariable(ZoneGapActualCurrent, 		0)
5747. SetVariable(ZoneGapActualPerCurrent, 	0)
5748. 
5749. SetVariable(ZoneSizeActual, 			0)
5750. SetVariable(ZoneSizeActualCurrent,		0)
5751. 
5752. SetVariable(ZoneEndActual, 				0)
5753. SetVariable(ZoneEndActualCurrent,		0)			
5754. SetVariable(ZoneSizeActualPerCurrent, 	0)
5755.       
5756. SetVariable(ZoneFilesFolders,			0)
5757. SetVariable(ZoneFilesFoldersPer,		0) 
5758. 
5759. SetVariable(ZoneFragments,				0)
5760. SetVariable(ZoneFragmentsPer,			0) 
5761. 		
5762. SetVariable(ZoneEndActualCurrent, 		0)
5763. SetVariable(ZoneEndActualPerCurrent, 	0)
5764. 
5765. # Gap Calculation Methodology:
5766. 	# Requested
5767. 	SetVariable(GapRequested, 			0) 
5768. 	SetVariable(GapRequestedStd, 		0) 
5769. 	SetVariable(GapRequestedMft, 		0) 
5770. 	SetVariable(GapRequestedOs, 		0) 
5771. 	SetVariable(GapRequestedOriginal, 	0) 
5772. 	
5773. 	# Gap Adjustments
5774. 	SetVariable(GapRounded, 			0)
5775. 	# SetVariable(GapAdjusted, 			0)
5776. 	SetVariable(GapAvailable, 			0)
5777. 	SetVariable(GapCurrent, 			0)
5778. 	SetVariable(GapActual, 				0)
5779. 	SetVariable(GapUsed, 				0)
5780. 	
5781. 	# Gap Adjustments
5782. 	SetVariable(GapRoundedLoc, 			0)
5783. 	# SetVariable(GapAdjustedLoc, 		0)
5784. 	SetVariable(GapAvailableLoc, 		0)
5785. 	SetVariable(GapCurrentLoc, 			0)
5786. 	SetVariable(GapActualLoc,			0)
5787. 	SetVariable(GapUsedLoc,				0)
5788. 	
5789. 	# Space usage
5790. 	SetVariable(ZoneFreePerRequested, 	0)
5791. 	SetVariable(ZoneFreePerUsed, 		0)
5792. 
5793. # Gap Size & Rounding
5794. 	SetVariable(ZoneGapSizePer, 		0)
5795. 	SetVariable(ZoneVolRoundUpPer, 		0)
5796. 	
5797. 	# Free Space
5798. 	SetVariable(ZoneFreeUsedPer, 		0)
5799. 	SetVariable(ZoneFreeRequestedPer, 	0)
5800. 
5801. 
5802. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
5803. 
5804. # Footer:
5805. SetVariable(ZoneFooter, "----------------------------------------------------------
5806. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
5807. 
5808. Statistics Report:
5809. ------------------
5810.    Size:  
5811.    ------------------------
5812.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5813.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5814.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5815. 
5816.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5817.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5818. 
5819.    Location:
5820.    ------------------------
5821.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5822.              Files End: !ZoneEndCurrent!
5823.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5824.       
5825.    Gap Settings:
5826.    ------------------------
5827.          Gap Requested: !ZoneGapSizePer!%
5828.       Volume Rounding: !ZoneVolRoundUpPer!%
5829.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5830.                  
5831.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5832.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5833.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5834.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5835.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5836.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5837.      
5838.    Free Space after Zone:
5839.    ------------------------
5840.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5841.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5842.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5843. 
5844. Directory and Files Select:
5845. ---------------------------
5846. !ZoneTypeSelectCurrent!               
5847. ---------------------------
5848. ----------------------------------------------------------
5849. ")
5850. 
5851. # Script: BannerSet
5852. 
5853. # Script: DisplaySetDateTimeRun
5854. 
5855. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
5856. /* Xinclude "..\Display\BannerSet.MyDc"X */
5857. /* pause(1) */
5858. 
5859. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5860. 
5861. Title('!Heading!')
5862. /* pause(1) */
5863. 
5864. /* NOTE: Can't round or truncate to integer precision. */
5865. 
5866. # Script: BannerLog
5867. 
5868. AppendLogfile("!LogFileName!", "!Title!")
5869. 
5870. 
5871. 
5872. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
5873. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
5874. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:50")
5875. 
5876. SetVariable(ZoneListByLine, "!ZoneListByLine!
5877. Zone: !ZoneNoCurrent! 2021-11-09 18:53:50 0:00:06 !ZoneLabel! !ZoneDescription!")
5878. 
5879. 
5880. /* Fixed Zone Position Handling */
5881. /* Literal number: */
5882. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
5883. /* Percentage of disk: */
5884. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
5885. /* Gap */
5886. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
5887. 
5888. /* ---------------------------------------------------------- */
5889. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
5890. # Script: DisplaySetFileStep
5891. 
5892. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5893. 
5894. /* add message and move to a new line. */
5895. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5896. ")
5897. 
5898. /* display the line. (hopefully.) */
5899. # Zone Footer Set Statistics Window Text
5900. 
5901. SetStatisticsWindowText("----------------------------------------------------------
5902. Zones Processed: 
5903. ----------------------------------------------------------
5904. !ZoneListByLine!
5905. ----------------------------------------------------------
5906. Zone Processing Step:
5907. !ZoneStepByLine!    
5908. ----------------------------------------------------------
5909. Current Zone:
5910. !ZoneFooter!
5911. ----------------------------------------------------------
5912. Volume Statistics:
5913. !VolumeStatisticsDetail!
5914. ----------------------------------------------------------
5915. Zone Detailed Report:
5916. ----------------------------------------------------------
5917. !ZoneStatisticsDetail!
5918. ----------------------------------------------------------
5919. ")
5920. 
5921. 
5922. 
5923. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5924. 
5925. # Script: BannerSet
5926. 
5927. # Script: DisplaySetDateTimeRun
5928. 
5929. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
5930. /* Xinclude "..\Display\BannerSet.MyDc"X */
5931. /* pause(1) */
5932. 
5933. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5934. 
5935. Title('!Heading!')
5936. /* pause(1) */
5937. 
5938. /* NOTE: Can't round or truncate to integer precision. */
5939. 
5940. pause(1)
5941. 
5942. # your stuff HERE (X)... pre file select code.
5943. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
5944. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
5945. 	# (X)
5946. 
5947. FileSelect
5948. 
5949. 	# your stuff can't really go here (errors.)
5950. 	# maybe for some reason I don't know of...
5951. 	
5952. 	# Actions next...
5953. 		# Script: ZoneDo ZoneTypeSelectOsProgramHints
5954. # ProgramHints start.
5955. ImportListFromProgramHints("*.pf")
5956. # ProgramHints end.
5957. 
5958. 		and not(
5959. 			# Os PageHiberDump start.
5960. (
5961.   FileName("DataStore.edb")
5962.   or FileName("DUMP*.*")
5963.   or FileName("Hiberfil.sys")
5964.   or FileName("MEMORY.DMP")
5965.   or FileName("Pagefile.sys")
5966. )
5967. # Os PageHiberDump end.
5968. 
5969. 		)
5970. 		
5971. 		FileActions
5972. 		  		/* ---------------------------------------------------------- */
5973. 	# Gap
5974. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
5975. 		# Script: DisplaySetFileStep
5976. 
5977. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5978. 
5979. /* add message and move to a new line. */
5980. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5981. ")
5982. 
5983. /* display the line. (hopefully.) */
5984. # Zone Footer Set Statistics Window Text
5985. 
5986. SetStatisticsWindowText("----------------------------------------------------------
5987. Zones Processed: 
5988. ----------------------------------------------------------
5989. !ZoneListByLine!
5990. ----------------------------------------------------------
5991. Zone Processing Step:
5992. !ZoneStepByLine!    
5993. ----------------------------------------------------------
5994. Current Zone:
5995. !ZoneFooter!
5996. ----------------------------------------------------------
5997. Volume Statistics:
5998. !VolumeStatisticsDetail!
5999. ----------------------------------------------------------
6000. Zone Detailed Report:
6001. ----------------------------------------------------------
6002. !ZoneStatisticsDetail!
6003. ----------------------------------------------------------
6004. ")
6005. 
6006. 
6007. 
6008. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6009. 
6010. # Script: BannerSet
6011. 
6012. # Script: DisplaySetDateTimeRun
6013. 
6014. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
6015. /* Xinclude "..\Display\BannerSet.MyDc"X */
6016. /* pause(1) */
6017. 
6018. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6019. 
6020. Title('!Heading!')
6021. /* pause(1) */
6022. 
6023. /* NOTE: Can't round or truncate to integer precision. */
6024. 
6025. pause(1)
6026. 	
6027. 	# ACTUAL GAP
6028. 		/* AddGap Variant. */
6029. 	  	# Zone Do Gap
6030. # Gap Calculation Methods:
6031. 
6032. /* 1) Anything you need to add first. */
6033. /* empty */
6034. 
6035. /* ---------------------------------------------------------- */
6036. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
6037. 	# GapRequestedStd.
6038. 
6039. 		/* ---------------------------------------------------------- */
6040. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
6041. 
6042. 		# Gap Calculation Methods:
6043. 
6044. /* AddGap Variants */
6045. 
6046. 	/* Standard */
6047. 		# Gap Calculation Methods:
6048. 	/* AddGap Variants */
6049. 	/* Standard */
6050. 
6051. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
6052. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
6053. 
6054. 	SetVariable(GapRequested, GapRequestedStd)
6055. 	
6056. 
6057. 	/* MFT Low High Method */
6058. 		# Gap Calculation Methods:
6059. 	/* AddGap Variants */
6060. 	/* MFT Low High Method */
6061. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
6062. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
6063. 	SetVariable(GapRequested, GapRequestedMft)
6064. 	
6065. 
6066. 	/* OS Volume Type Method */
6067. 		# Gap Calculation Methods:
6068. 	/* AddGap Variants */
6069. 	/* OS Volume Type Method */
6070. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
6071. 	SetVariable(GapRequested, GapRequestedOs)
6072. 
6073. 
6074. 
6075. /* MakeGap Variants */
6076. 
6077. 	/* Original Os 1-3 + MFT 2 */
6078. 		# Gap Calculation Methods:
6079. 	/* MakeGap Variants */
6080. 	/* Original Os 1-3 + MFT 2 */
6081. 	/* plus MFT gap placed inline at the dividing zone. */
6082. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
6083. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
6084. 	SetVariable(GapRequested, GapRequestedOrig)
6085. 	
6086. 	
6087. /* Note: You could comment out the ones not in use */
6088. /* However having the data in the log is useful. */
6089. /* Therefore the following line is otherwise needed. */
6090. 
6091. /* Standard used */
6092. 
6093. SetVariable(GapRequested, GapRequestedStd)
6094. 
6095. # Gap Calculation Methods:
6096. 
6097. /* AddGap Variants */
6098. 	/* Standard */
6099. 	/* MFT Low High Method */
6100. 	/* OS Volume Type Method */
6101. 
6102. /* MakeGap Variants */
6103. 	/* Original Os 1-3 + MFT 2 */
6104. 
6105. /* Note: You could comment out the ones not in use */
6106. /* However having the data in the log is useful. */
6107. /* Therefore the following line is otherwise needed. */
6108. 
6109. /* Standard is used currently */
6110. 
6111. 
6112. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
6113. 
6114. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
6115. 
6116. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
6117. 
6118. /* ---------------------------------------------------------- */
6119. /* 3) SMALL ZONE ADJUSTMENT. */
6120. /* Gab cant be larger than half the Zone Size. */
6121. 
6122. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
6123. 	
6124. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
6125. 
6126. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
6127. 
6128. /* ---------------------------------------------------------- */
6129. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
6130. # Gap Adjustments.
6131. 
6132. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
6133. 	
6134. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
6135. 
6136. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
6137. 
6138. /* ---------------------------------------------------------- */
6139. # BYPASS THIS.
6140. 	/* This is definitely wrong. */
6141. 	/* The question is can we steal gap from the next zone */
6142. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
6143. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
6144. 		# Zone Overflow.
6145. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
6146. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
6147. 
6148. /* ---------------------------------------------------------- */
6149. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
6150. # Remaining free space available.
6151. 
6152. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
6153. 	
6154. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
6155. 
6156. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
6157. 
6158. /* ---------------------------------------------------------- */
6159. # CURRENT gap to use.
6160. 
6161. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
6162. 
6163. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
6164. 
6165. /* ---------------------------------------------------------- */
6166. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
6167. # Debugging.
6168. 
6169. 	SetVariable(GapUsed, GapCurrent) // for debugging
6170. 
6171. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
6172. 
6173. 		# Your code HERE
6174. 
6175. /* ---------------------------------------------------------- */
6176. /* 7) YOUR CODE. */
6177. # YOUR CODE HERE:
6178. 	# INPUT: GapCurrent or GapCurrentLoc
6179. 	# OUTPUT: GapUsed...
6180. 
6181. /* ---------------------------------------------------------- */
6182. # Gap Size.
6183. # Actual Size of Gap.
6184. 
6185. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
6186. 
6187. /* ---------------------------------------------------------- */
6188. /* xxxxxxxxxxxxxxxxxxxxxx */
6189. # ADD THE GAP
6190. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
6191. /* xxxxxxxxxxxxxxxxxxxxxx */
6192. 
6193. 	
6194. 	# Zone Statistics	
6195. 	# Script: ZoneDoStatistics
6196. # Zone / Volume Statistics and Display
6197. 		
6198. 	# Accumulate Totals
6199.   	# Script: ZoneDoVolumeTotals
6200. 
6201. /* Current total space used (by Zones and Gaps) */
6202. 
6203. SetVariable(VolumeZoneUsed, GapUsed)
6204. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
6205. /* Percentage */
6206. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
6207. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
6208. 
6209. /* Current total of free space requested */
6210. 
6211. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
6212. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6213. /* Percent. */
6214. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
6215. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6216. 
6217. /* Current total of free space used */
6218. 
6219. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
6220. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
6221. /* Percent */
6222. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
6223. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
6224. 
6225. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
6226. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
6227. /* Xinclude "..\DebugDisplayPause.MyDc"X */
6228. 
6229. 
6230. 	# Current Values
6231. 	# Script: ZoneDoCurrentSet
6232. 
6233. # Cluster, Sector, Block adjust for display.
6234. 	# Bytes per cluster is volume specific.
6235. 
6236. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
6237. 
6238. # Current Zone values.
6239. 	# Begin, end and size.
6240. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
6241. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
6242. 
6243. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
6244. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
6245. 
6246. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
6247. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
6248. 
6249. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
6250. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
6251. 
6252. 	SetVariable(ZoneFragments,				"!ZONE210N!")
6253. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
6254. 		
6255. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
6256. /* identical code to here: (separation not needed. TEST.) */	
6257. 
6258. # Current Gap, Actual and Free Values
6259. 	# Gap
6260. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
6261. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
6262. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
6263. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
6264. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
6265. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
6266. 	
6267. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
6268. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
6269. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
6270. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
6271. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
6272. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
6273. 	
6274. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
6275. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
6276. 	
6277. 	# Actual Size and End
6278. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
6279. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
6280. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
6281. 	
6282. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
6283. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
6284. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
6285. 
6286. # Gap Size & Rounding
6287. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
6288. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
6289. 	
6290. 	# Free Space
6291. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
6292. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
6293. 
6294. 	# Footer:
6295. SetVariable(ZoneFooter, "----------------------------------------------------------
6296. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
6297. 
6298. Statistics Report:
6299. ------------------
6300.    Size:  
6301.    ------------------------
6302.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6303.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6304.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6305. 
6306.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6307.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6308. 
6309.    Location:
6310.    ------------------------
6311.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6312.              Files End: !ZoneEndCurrent!
6313.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6314.       
6315.    Gap Settings:
6316.    ------------------------
6317.          Gap Requested: !ZoneGapSizePer!%
6318.       Volume Rounding: !ZoneVolRoundUpPer!%
6319.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6320.                  
6321.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6322.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6323.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6324.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6325.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6326.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6327.      
6328.    Free Space after Zone:
6329.    ------------------------
6330.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6331.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6332.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6333. 
6334. Directory and Files Select:
6335. ---------------------------
6336. !ZoneTypeSelectCurrent!               
6337. ---------------------------
6338. ----------------------------------------------------------
6339. ")
6340. 	# Zone Footer Set Statistics Window Text
6341. 
6342. SetStatisticsWindowText("----------------------------------------------------------
6343. Zones Processed: 
6344. ----------------------------------------------------------
6345. !ZoneListByLine!
6346. ----------------------------------------------------------
6347. Zone Processing Step:
6348. !ZoneStepByLine!    
6349. ----------------------------------------------------------
6350. Current Zone:
6351. !ZoneFooter!
6352. ----------------------------------------------------------
6353. Volume Statistics:
6354. !VolumeStatisticsDetail!
6355. ----------------------------------------------------------
6356. Zone Detailed Report:
6357. ----------------------------------------------------------
6358. !ZoneStatisticsDetail!
6359. ----------------------------------------------------------
6360. ")
6361. 
6362. 
6363. 	
6364.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
6365. 
6366. 	# Add Zone to list of zones for display.
6367. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
6368. 	# ??? Free Stats?
6369. 	# Footer:
6370. SetVariable(ZoneFooter, "----------------------------------------------------------
6371. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
6372. 
6373. Statistics Report:
6374. ------------------
6375.    Size:  
6376.    ------------------------
6377.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6378.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6379.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6380. 
6381.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6382.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6383. 
6384.    Location:
6385.    ------------------------
6386.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6387.              Files End: !ZoneEndCurrent!
6388.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6389.       
6390.    Gap Settings:
6391.    ------------------------
6392.          Gap Requested: !ZoneGapSizePer!%
6393.       Volume Rounding: !ZoneVolRoundUpPer!%
6394.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6395.                  
6396.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6397.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6398.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6399.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6400.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6401.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6402.      
6403.    Free Space after Zone:
6404.    ------------------------
6405.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6406.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6407.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6408. 
6409. Directory and Files Select:
6410. ---------------------------
6411. !ZoneTypeSelectCurrent!               
6412. ---------------------------
6413. ----------------------------------------------------------
6414. ")
6415. 
6416. 	# Add Zone Details to Report.	
6417. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
6418. !ZoneFooter!")
6419. 
6420. 
6421. 	
6422. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
6423. 			# Script: DisplaySetFileStep
6424. 
6425. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6426. 
6427. /* add message and move to a new line. */
6428. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6429. ")
6430. 
6431. /* display the line. (hopefully.) */
6432. # Zone Footer Set Statistics Window Text
6433. 
6434. SetStatisticsWindowText("----------------------------------------------------------
6435. Zones Processed: 
6436. ----------------------------------------------------------
6437. !ZoneListByLine!
6438. ----------------------------------------------------------
6439. Zone Processing Step:
6440. !ZoneStepByLine!    
6441. ----------------------------------------------------------
6442. Current Zone:
6443. !ZoneFooter!
6444. ----------------------------------------------------------
6445. Volume Statistics:
6446. !VolumeStatisticsDetail!
6447. ----------------------------------------------------------
6448. Zone Detailed Report:
6449. ----------------------------------------------------------
6450. !ZoneStatisticsDetail!
6451. ----------------------------------------------------------
6452. ")
6453. 
6454. 
6455. 
6456. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6457. 
6458. # Script: BannerSet
6459. 
6460. # Script: DisplaySetDateTimeRun
6461. 
6462. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
6463. /* Xinclude "..\Display\BannerSet.MyDc"X */
6464. /* pause(1) */
6465. 
6466. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6467. 
6468. Title('!Heading!')
6469. /* pause(1) */
6470. 
6471. /* NOTE: Can't round or truncate to integer precision. */
6472. 
6473. pause(1)
6474. 
6475. 			# File Action - Type Os Program Hints.
6476. # File Action - SortByImportSequence.
6477. SortByImportSequence(Ascending ) 
6478. 	
6479. 	
6480. 	
6481. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
6482. 			# Script: DisplaySetFileStep
6483. 
6484. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6485. 
6486. /* add message and move to a new line. */
6487. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6488. ")
6489. 
6490. /* display the line. (hopefully.) */
6491. # Zone Footer Set Statistics Window Text
6492. 
6493. SetStatisticsWindowText("----------------------------------------------------------
6494. Zones Processed: 
6495. ----------------------------------------------------------
6496. !ZoneListByLine!
6497. ----------------------------------------------------------
6498. Zone Processing Step:
6499. !ZoneStepByLine!    
6500. ----------------------------------------------------------
6501. Current Zone:
6502. !ZoneFooter!
6503. ----------------------------------------------------------
6504. Volume Statistics:
6505. !VolumeStatisticsDetail!
6506. ----------------------------------------------------------
6507. Zone Detailed Report:
6508. ----------------------------------------------------------
6509. !ZoneStatisticsDetail!
6510. ----------------------------------------------------------
6511. ")
6512. 
6513. 
6514. 
6515. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6516. 
6517. # Script: BannerSet
6518. 
6519. # Script: DisplaySetDateTimeRun
6520. 
6521. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
6522. /* Xinclude "..\Display\BannerSet.MyDc"X */
6523. /* pause(1) */
6524. 
6525. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6526. 
6527. Title('!Heading!')
6528. /* pause(1) */
6529. 
6530. /* NOTE: Can't round or truncate to integer precision. */
6531. 
6532. pause(1)
6533. 
6534. 		# Script: ZoneDoFooter
6535. 
6536. /* ---------------------------------------------------------- */
6537. # File Select
6538. 	# Select Statments
6539. # File Actions 
6540. 	# Standard or OS File Actions.
6541. 	# Resume...
6542. 	
6543. 	# your stuff HERE (X)... post zone (file) file actions code.
6544. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
6545. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
6546. 		# (X)
6547. 		
6548. 		/* ??? Set window? */
6549. 	
6550. 	# ADD THE GAP
6551. 		
6552. # Vacate (good for diagnostics)
6553. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
6554. 
6555. # DoNotVacate - DO NOT Vacate (recommended)
6556. 
6557. # Vacate
6558. /* AddGap(GapUsedLoc) */
6559. 
6560. # DO Not Vacate
6561. AddGap(GapUsedLoc, DoNotVacate) 
6562. 	
6563. 	
6564. /* ---------------------------------------------------------- */
6565. # (failed) TEST for boolean logic.
6566. 
6567. /* It should work in the gap calculations for turning options */
6568. /* on and off but it will NOT work here. */
6569. 
6570. /* Boolean setting X or FlagX. */
6571. /* Where X will be on or off: */
6572. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
6573. /*      For ON:  (X  *  FlagAny) */
6574. 
6575. /* 1) Failed, zero gap overrode the previous one. */
6576. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
6577. /* AddGap(GapUsedTemp) */ 
6578. 
6579. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
6580. /* AddGap(GapUsedTemp, DoNotVacate) */ 
6581. 
6582. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
6583. 
6584. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
6585. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
6586. /* AddGap(GapUsedTemp) */ 
6587. 
6588. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
6589. /* AddGap(GapUsedTemp, DoNotVacate) */ 
6590. 
6591. /* ---------------------------------------------------------- */
6592. 
6593. # Vacate
6594. /* AddGap(GapUsed) */
6595. 
6596. # DO NOT Vacate (recommended)
6597. /* AddGap(GapUsed, DoNotVacate) */ 
6598. 	
6599. 
6600. 		
6601. # 
6602. FileEnd
6603. /* ---------------------------------------------------------- */
6604. 
6605. # your stuff HERE (X)... post zone (file) code.
6606. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
6607. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
6608. 	# (X)
6609. 
6610. SetVariable(FileStepDescription,"Zone finished, reporting.")
6611. # Script: DisplaySetFileStep
6612. 
6613. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6614. 
6615. /* add message and move to a new line. */
6616. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6617. ")
6618. 
6619. /* display the line. (hopefully.) */
6620. # Zone Footer Set Statistics Window Text
6621. 
6622. SetStatisticsWindowText("----------------------------------------------------------
6623. Zones Processed: 
6624. ----------------------------------------------------------
6625. !ZoneListByLine!
6626. ----------------------------------------------------------
6627. Zone Processing Step:
6628. !ZoneStepByLine!    
6629. ----------------------------------------------------------
6630. Current Zone:
6631. !ZoneFooter!
6632. ----------------------------------------------------------
6633. Volume Statistics:
6634. !VolumeStatisticsDetail!
6635. ----------------------------------------------------------
6636. Zone Detailed Report:
6637. ----------------------------------------------------------
6638. !ZoneStatisticsDetail!
6639. ----------------------------------------------------------
6640. ")
6641. 
6642. 
6643. 
6644. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6645. 
6646. # Script: BannerSet
6647. 
6648. # Script: DisplaySetDateTimeRun
6649. 
6650. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
6651. /* Xinclude "..\Display\BannerSet.MyDc"X */
6652. /* pause(1) */
6653. 
6654. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6655. 
6656. Title('!Heading!')
6657. /* pause(1) */
6658. 
6659. /* NOTE: Can't round or truncate to integer precision. */
6660. 
6661. pause(1)
6662. 
6663. # Script: ZoneWhenFinished
6664. 
6665. # Script: BannerSet
6666. 
6667. # Script: DisplaySetDateTimeRun
6668. 
6669. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
6670. /* Xinclude "..\Display\BannerSet.MyDc"X */
6671. /* pause(1) */
6672. 
6673. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6674. 
6675. Title('!Heading!')
6676. /* pause(1) */
6677. 
6678. /* NOTE: Can't round or truncate to integer precision. */
6679. 
6680. # Script: BannerLog
6681. 
6682. AppendLogfile("!LogFileName!", "!Title!")
6683. 
6684. 
6685. 
6686. # Zone Statistics	
6687. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
6688. 
6689. # Footer:
6690. SetVariable(ZoneFooter, "----------------------------------------------------------
6691. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
6692. 
6693. Statistics Report:
6694. ------------------
6695.    Size:  
6696.    ------------------------
6697.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6698.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6699.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6700. 
6701.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6702.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6703. 
6704.    Location:
6705.    ------------------------
6706.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6707.              Files End: !ZoneEndCurrent!
6708.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6709.       
6710.    Gap Settings:
6711.    ------------------------
6712.          Gap Requested: !ZoneGapSizePer!%
6713.       Volume Rounding: !ZoneVolRoundUpPer!%
6714.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6715.                  
6716.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6717.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6718.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6719.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6720.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6721.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6722.      
6723.    Free Space after Zone:
6724.    ------------------------
6725.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6726.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6727.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6728. 
6729. Directory and Files Select:
6730. ---------------------------
6731. !ZoneTypeSelectCurrent!               
6732. ---------------------------
6733. ----------------------------------------------------------
6734. ")
6735. 
6736. AppendLogfile("!LogFileName!", ".")
6737. AppendLogfile("!LogFileName!", "!ZoneFooter!")
6738. AppendLogfile("!LogFileName!", ".")
6739. 
6740. # Zone Footer Set Statistics Window Text
6741. 
6742. SetStatisticsWindowText("----------------------------------------------------------
6743. Zones Processed: 
6744. ----------------------------------------------------------
6745. !ZoneListByLine!
6746. ----------------------------------------------------------
6747. Zone Processing Step:
6748. !ZoneStepByLine!    
6749. ----------------------------------------------------------
6750. Current Zone:
6751. !ZoneFooter!
6752. ----------------------------------------------------------
6753. Volume Statistics:
6754. !VolumeStatisticsDetail!
6755. ----------------------------------------------------------
6756. Zone Detailed Report:
6757. ----------------------------------------------------------
6758. !ZoneStatisticsDetail!
6759. ----------------------------------------------------------
6760. ")
6761. 
6762. 
6763. 
6764. /* pause() */
6765. /* pause() */
6766. 
6767. 
6768. 
6769. 	
6770. /* ---------------------------------------------------------- */
6771. 
6772. 
6773. /* ---------------------------------------------------------- */
6774. # Zone Programs Fixed size but not windows..
6775. # Script: DefragZoneTypeOsPrograms
6776. /* ---------------------------------------------------------- */
6777. # Zone Programs Fixed size but not windows..
6778. 	SetVariable(ZoneLabel, 			"!ZoneLabelPrograms!")
6779. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPrograms!")
6780. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
6781. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
6782. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsPrograms
6783. # Programs start.
6784. # NotBlobsArchivesBu start.
6785. (not (
6786. # Blobs start.
6787. (
6788. # BlobsAndExceptions start.
6789. ( not(
6790.   FileName("*.bat")
6791.   or FileName("*.css")
6792.   or FileName("*.dll")
6793.   or FileName("*.exe")
6794.   or FileName("*.htm*")
6795.   or FileName("*.jar")
6796.   or FileName("*.js")
6797.   or FileName("*.script")
6798.   or FileName("*.wsf")
6799.   or (
6800. # Databases start.
6801. (
6802.   FileName("*.crypt*")
6803.   or FileName("*.db*")
6804.   or FileName("*.rdb*")
6805.   or FileName("*.dc*")
6806.   or FileName("*.dict*")
6807.   or FileName("*.?db*")
6808.   or FileName("*.?rdb*")
6809.   or FileName("*.md*")
6810.   or FileName("*.myd")
6811.   or FileName("*.ndf")
6812.   or FileName("*.ns?")
6813.   or FileName("*.pab")
6814.   or FileName("*.pst")
6815.   or FileName("*.sd?*")
6816.   or FileName("*.sq**")
6817.   or FileName("*.tmd")
6818.   or FileName("*.tps")
6819.   or FileName("*.tr*")
6820. )
6821. # Databases end.
6822. 
6823.     # BlobsAndExceptions
6824.     or 
6825. # Data start.
6826. (
6827.   DirectoryName("Data*")
6828.   or DirectoryName("Device*")
6829.   or DirectoryName("Export*")
6830.   or DirectoryName("Import*")
6831.   or DirectoryName("Log*")
6832.   or DirectoryName("*Log")
6833.   or DirectoryName("Maintenance*")
6834.   or DirectoryName("Rec*")
6835.   or DirectoryName("Sales*")
6836.   or DirectoryName("Search*")
6837.   or DirectoryName("User*")
6838. )
6839. # Data end.
6840. 
6841.     # BlobsAndExceptions
6842.   )
6843. ) )
6844. # BlobsAndExceptions end.
6845. 
6846. # Blobs
6847. ) and (
6848.   Size(BlobFileSize,0)
6849.   or (
6850.     FileName("*.arj")
6851.     or FileName("*.bup")
6852.     or FileName("*.bz2")
6853.     or FileName("*.chm")
6854.     or FileName("*.dvr-ms")
6855.     or FileName("*.gz")
6856.     or FileName("*.ifo")
6857.     or FileName("*.lzh")
6858.     or FileName("*.pdf")
6859.     or FileName("*.rpm")
6860.     or FileName("*.wmv")
6861.     or FileName("*.vob")
6862.     or FileName("*.z")
6863.   ) 
6864. )
6865. # Blobs end.
6866. 
6867. # NotBlobsArchivesBu
6868. or 
6869. # Archives start.
6870. (
6871.   DirectoryName("*Archive*")
6872.   or DirectoryName("*History*")
6873.   or DirectoryName("*Old")
6874.   or DirectoryName("* Old *")
6875.   or DirectoryName("Old *")
6876. 
6877.   or FileName("*.7z")
6878.   or FileName("*.cab")
6879.   or FileName("*.iso")
6880.   or FileName("*.msi")
6881.   or FileName("*.old")
6882.   or FileName("*.rar")
6883.   or FileName("*.tar")
6884.   or FileName("*.zip")
6885.   or
6886. # WinSysLow start.
6887. (
6888.   DirectoryName("$*")
6889.   or DirectoryName("0*")
6890.   or DirectoryName("1*")
6891.   or DirectoryName("2*")
6892.   or DirectoryName("3*")
6893.   or DirectoryName("4*")
6894.   or DirectoryName("5*")
6895.   or DirectoryName("6*")
6896.   or DirectoryName("7*")
6897.   or DirectoryName("8*")
6898.   or DirectoryName("9*")
6899. 
6900.   or DirectoryName("dllcache")
6901.   or DirectoryName("Downloaded Installations")
6902.   or DirectoryName("Ehome")
6903.   or DirectoryName("Fonts")
6904.   or DirectoryName("Help")
6905.   or DirectoryName("I386")
6906.   or DirectoryName("ie?updates")
6907.   or DirectoryName("Installer")
6908.   or DirectoryName("Installshield Installation Information")
6909.   or DirectoryName("IME")
6910.   or DirectoryName("*RECYCLE*")
6911.   or DirectoryName("ServicePackFiles")
6912.   or DirectoryName("SoftwareDistribution")
6913.   or DirectoryName("Speech")
6914.   or DirectoryName("Symbols")
6915.   or DirectoryName("System Volume Information")
6916.   or DirectoryName("windows.old")
6917. )
6918. # WinSysLow end.
6919. 
6920.   # Archives
6921. )
6922. # Archives end.
6923. 
6924. # NotBlobsArchivesBu
6925. or
6926. # Backups start.
6927. (
6928.   DirectoryName("*Backup*")
6929.   or DirectoryName("*Bu")
6930.   or DirectoryName("* Bu *")
6931.   or DirectoryName("Bu *")
6932. 
6933.   or FileName("*.bak")
6934.   or FileName("* - Copy*")
6935. )
6936. # Backups end.
6937. 
6938. # NotBlobsArchivesBu
6939. ) )
6940. # NotBlobsArchivesBu end.
6941. 
6942. # Programs
6943. and (
6944. # SystemDir start.
6945. (
6946.   DirectoryName("Boot*")
6947.   or DirectoryName("Device*")
6948.   or DirectoryName("DevSupport*")
6949.   or DirectoryName("Program*")
6950.   or DirectoryName("Security*")
6951.   or DirectoryName("SendTo*")
6952.   or DirectoryName("Sw*")
6953.   or DirectoryName("System*")
6954.   or DirectoryName("Toolbars")
6955.   or DirectoryName("Windows*")
6956. )
6957. # SystemDir end.
6958. 
6959. # Programs
6960. )
6961. # Programs end.
6962. 
6963.                 and not(
6964.                      # Script: ZoneDo ZoneTypeSelectOsDataDynamic
6965. # Os Data Dynamic start.
6966. (
6967. # Os Data Dynamic start.
6968. (
6969.   FileName("*.dat*")
6970.   or FileName("*.db*")
6971.   or FileName("*.edb*")
6972.   or FileName("*.log*")
6973.   or FileName("DataStore.edb")
6974. )
6975. # Os Data Dynamic end.
6976. 
6977.   or 
6978. # Os PageHiberDump start.
6979. (
6980.   FileName("DataStore.edb")
6981.   or FileName("DUMP*.*")
6982.   or FileName("Hiberfil.sys")
6983.   or FileName("MEMORY.DMP")
6984.   or FileName("Pagefile.sys")
6985. )
6986. # Os PageHiberDump end.
6987. 
6988. # Os Data Dynamic
6989. )
6990. # Os Data Dynamic end.
6991. 
6992.                      or 
6993.                      DirectoryName("Windows*")
6994.                 )
6995. ')
6996. 
6997. 		# Script: ZoneDoHeader
6998. 
6999. # Script: ZoneWhenStarted
7000. 
7001. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
7002. # Script: DisplaySetZone
7003. 
7004. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
7005. SetVariable(FileStepDescription,	"")
7006. 
7007. SetVariable(ZoneStepByLine, 			"Zone started.
7008. ")
7009. 
7010. # Script: BannerDescriptionSet
7011. 
7012. # Script: BannerSet
7013. 
7014. # Script: DisplaySetDateTimeRun
7015. 
7016. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
7017. /* Xinclude "..\Display\BannerSet.MyDc"X */
7018. /* pause(1) */
7019. 
7020. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7021. 
7022. Title('!Heading!')
7023. /* pause(1) */
7024. 
7025. /* NOTE: Can't round or truncate to integer precision. */
7026. 
7027. # Script: BannerLog
7028. 
7029. AppendLogfile("!LogFileName!", "!Title!")
7030. 
7031. 
7032. 
7033. pause(1)
7034. 
7035. 
7036. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
7037. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
7038. 
7039. SetVariable(ZoneStepNoCurrent, 0)
7040. 
7041. 
7042. # Script: ZoneDoCurrentClear
7043. 
7044. SetVariable(ZoneTypeSelectCurrent, 		"")
7045. 
7046. SetVariable(ZoneBeginCurrent, 			0)
7047. SetVariable(ZoneBeginPerCurrent, 		0)
7048. SetVariable(ZoneEndCurrent, 			0)
7049. SetVariable(ZoneEndPerCurrent, 			0)
7050. 
7051. SetVariable(ZoneSizeCurrent,			0)
7052. SetVariable(ZoneSizePerCurrent,			0)
7053. 
7054. SetVariable(ZoneGapRequestedCurrent,	0)
7055. SetVariable(ZoneGapRoundedCurrent, 		0)
7056. SetVariable(ZoneGapAdjustedCurrent, 	0)
7057. SetVariable(ZoneGapAvailableCurrent, 	0)
7058. SetVariable(ZoneGapCurrent,				0)
7059. SetVariable(ZoneGapUsedCurrent, 		0)
7060. 
7061. SetVariable(ZoneGapActualCurrent, 		0)
7062. SetVariable(ZoneGapActualPerCurrent, 	0)
7063. 
7064. SetVariable(ZoneSizeActual, 			0)
7065. SetVariable(ZoneSizeActualCurrent,		0)
7066. 
7067. SetVariable(ZoneEndActual, 				0)
7068. SetVariable(ZoneEndActualCurrent,		0)			
7069. SetVariable(ZoneSizeActualPerCurrent, 	0)
7070.       
7071. SetVariable(ZoneFilesFolders,			0)
7072. SetVariable(ZoneFilesFoldersPer,		0) 
7073. 
7074. SetVariable(ZoneFragments,				0)
7075. SetVariable(ZoneFragmentsPer,			0) 
7076. 		
7077. SetVariable(ZoneEndActualCurrent, 		0)
7078. SetVariable(ZoneEndActualPerCurrent, 	0)
7079. 
7080. # Gap Calculation Methodology:
7081. 	# Requested
7082. 	SetVariable(GapRequested, 			0) 
7083. 	SetVariable(GapRequestedStd, 		0) 
7084. 	SetVariable(GapRequestedMft, 		0) 
7085. 	SetVariable(GapRequestedOs, 		0) 
7086. 	SetVariable(GapRequestedOriginal, 	0) 
7087. 	
7088. 	# Gap Adjustments
7089. 	SetVariable(GapRounded, 			0)
7090. 	# SetVariable(GapAdjusted, 			0)
7091. 	SetVariable(GapAvailable, 			0)
7092. 	SetVariable(GapCurrent, 			0)
7093. 	SetVariable(GapActual, 				0)
7094. 	SetVariable(GapUsed, 				0)
7095. 	
7096. 	# Gap Adjustments
7097. 	SetVariable(GapRoundedLoc, 			0)
7098. 	# SetVariable(GapAdjustedLoc, 		0)
7099. 	SetVariable(GapAvailableLoc, 		0)
7100. 	SetVariable(GapCurrentLoc, 			0)
7101. 	SetVariable(GapActualLoc,			0)
7102. 	SetVariable(GapUsedLoc,				0)
7103. 	
7104. 	# Space usage
7105. 	SetVariable(ZoneFreePerRequested, 	0)
7106. 	SetVariable(ZoneFreePerUsed, 		0)
7107. 
7108. # Gap Size & Rounding
7109. 	SetVariable(ZoneGapSizePer, 		0)
7110. 	SetVariable(ZoneVolRoundUpPer, 		0)
7111. 	
7112. 	# Free Space
7113. 	SetVariable(ZoneFreeUsedPer, 		0)
7114. 	SetVariable(ZoneFreeRequestedPer, 	0)
7115. 
7116. 
7117. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
7118. 
7119. # Footer:
7120. SetVariable(ZoneFooter, "----------------------------------------------------------
7121. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
7122. 
7123. Statistics Report:
7124. ------------------
7125.    Size:  
7126.    ------------------------
7127.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7128.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7129.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7130. 
7131.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7132.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7133. 
7134.    Location:
7135.    ------------------------
7136.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7137.              Files End: !ZoneEndCurrent!
7138.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7139.       
7140.    Gap Settings:
7141.    ------------------------
7142.          Gap Requested: !ZoneGapSizePer!%
7143.       Volume Rounding: !ZoneVolRoundUpPer!%
7144.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7145.                  
7146.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7147.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7148.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7149.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7150.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7151.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7152.      
7153.    Free Space after Zone:
7154.    ------------------------
7155.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7156.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7157.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7158. 
7159. Directory and Files Select:
7160. ---------------------------
7161. !ZoneTypeSelectCurrent!               
7162. ---------------------------
7163. ----------------------------------------------------------
7164. ")
7165. 
7166. # Script: BannerSet
7167. 
7168. # Script: DisplaySetDateTimeRun
7169. 
7170. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
7171. /* Xinclude "..\Display\BannerSet.MyDc"X */
7172. /* pause(1) */
7173. 
7174. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7175. 
7176. Title('!Heading!')
7177. /* pause(1) */
7178. 
7179. /* NOTE: Can't round or truncate to integer precision. */
7180. 
7181. # Script: BannerLog
7182. 
7183. AppendLogfile("!LogFileName!", "!Title!")
7184. 
7185. 
7186. 
7187. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
7188. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
7189. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:50")
7190. 
7191. SetVariable(ZoneListByLine, "!ZoneListByLine!
7192. Zone: !ZoneNoCurrent! 2021-11-09 18:53:50 0:00:06 !ZoneLabel! !ZoneDescription!")
7193. 
7194. 
7195. /* Fixed Zone Position Handling */
7196. /* Literal number: */
7197. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
7198. /* Percentage of disk: */
7199. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
7200. /* Gap */
7201. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
7202. 
7203. /* ---------------------------------------------------------- */
7204. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
7205. # Script: DisplaySetFileStep
7206. 
7207. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7208. 
7209. /* add message and move to a new line. */
7210. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7211. ")
7212. 
7213. /* display the line. (hopefully.) */
7214. # Zone Footer Set Statistics Window Text
7215. 
7216. SetStatisticsWindowText("----------------------------------------------------------
7217. Zones Processed: 
7218. ----------------------------------------------------------
7219. !ZoneListByLine!
7220. ----------------------------------------------------------
7221. Zone Processing Step:
7222. !ZoneStepByLine!    
7223. ----------------------------------------------------------
7224. Current Zone:
7225. !ZoneFooter!
7226. ----------------------------------------------------------
7227. Volume Statistics:
7228. !VolumeStatisticsDetail!
7229. ----------------------------------------------------------
7230. Zone Detailed Report:
7231. ----------------------------------------------------------
7232. !ZoneStatisticsDetail!
7233. ----------------------------------------------------------
7234. ")
7235. 
7236. 
7237. 
7238. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7239. 
7240. # Script: BannerSet
7241. 
7242. # Script: DisplaySetDateTimeRun
7243. 
7244. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
7245. /* Xinclude "..\Display\BannerSet.MyDc"X */
7246. /* pause(1) */
7247. 
7248. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7249. 
7250. Title('!Heading!')
7251. /* pause(1) */
7252. 
7253. /* NOTE: Can't round or truncate to integer precision. */
7254. 
7255. pause(1)
7256. 
7257. # your stuff HERE (X)... pre file select code.
7258. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
7259. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
7260. 	# (X)
7261. 
7262. FileSelect
7263. 
7264. 	# your stuff can't really go here (errors.)
7265. 	# maybe for some reason I don't know of...
7266. 	
7267. 	# Actions next...
7268. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
7269. # Programs start.
7270. # NotBlobsArchivesBu start.
7271. (not (
7272. # Blobs start.
7273. (
7274. # BlobsAndExceptions start.
7275. ( not(
7276.   FileName("*.bat")
7277.   or FileName("*.css")
7278.   or FileName("*.dll")
7279.   or FileName("*.exe")
7280.   or FileName("*.htm*")
7281.   or FileName("*.jar")
7282.   or FileName("*.js")
7283.   or FileName("*.script")
7284.   or FileName("*.wsf")
7285.   or (
7286. # Databases start.
7287. (
7288.   FileName("*.crypt*")
7289.   or FileName("*.db*")
7290.   or FileName("*.rdb*")
7291.   or FileName("*.dc*")
7292.   or FileName("*.dict*")
7293.   or FileName("*.?db*")
7294.   or FileName("*.?rdb*")
7295.   or FileName("*.md*")
7296.   or FileName("*.myd")
7297.   or FileName("*.ndf")
7298.   or FileName("*.ns?")
7299.   or FileName("*.pab")
7300.   or FileName("*.pst")
7301.   or FileName("*.sd?*")
7302.   or FileName("*.sq**")
7303.   or FileName("*.tmd")
7304.   or FileName("*.tps")
7305.   or FileName("*.tr*")
7306. )
7307. # Databases end.
7308. 
7309.     # BlobsAndExceptions
7310.     or 
7311. # Data start.
7312. (
7313.   DirectoryName("Data*")
7314.   or DirectoryName("Device*")
7315.   or DirectoryName("Export*")
7316.   or DirectoryName("Import*")
7317.   or DirectoryName("Log*")
7318.   or DirectoryName("*Log")
7319.   or DirectoryName("Maintenance*")
7320.   or DirectoryName("Rec*")
7321.   or DirectoryName("Sales*")
7322.   or DirectoryName("Search*")
7323.   or DirectoryName("User*")
7324. )
7325. # Data end.
7326. 
7327.     # BlobsAndExceptions
7328.   )
7329. ) )
7330. # BlobsAndExceptions end.
7331. 
7332. # Blobs
7333. ) and (
7334.   Size(BlobFileSize,0)
7335.   or (
7336.     FileName("*.arj")
7337.     or FileName("*.bup")
7338.     or FileName("*.bz2")
7339.     or FileName("*.chm")
7340.     or FileName("*.dvr-ms")
7341.     or FileName("*.gz")
7342.     or FileName("*.ifo")
7343.     or FileName("*.lzh")
7344.     or FileName("*.pdf")
7345.     or FileName("*.rpm")
7346.     or FileName("*.wmv")
7347.     or FileName("*.vob")
7348.     or FileName("*.z")
7349.   ) 
7350. )
7351. # Blobs end.
7352. 
7353. # NotBlobsArchivesBu
7354. or 
7355. # Archives start.
7356. (
7357.   DirectoryName("*Archive*")
7358.   or DirectoryName("*History*")
7359.   or DirectoryName("*Old")
7360.   or DirectoryName("* Old *")
7361.   or DirectoryName("Old *")
7362. 
7363.   or FileName("*.7z")
7364.   or FileName("*.cab")
7365.   or FileName("*.iso")
7366.   or FileName("*.msi")
7367.   or FileName("*.old")
7368.   or FileName("*.rar")
7369.   or FileName("*.tar")
7370.   or FileName("*.zip")
7371.   or
7372. # WinSysLow start.
7373. (
7374.   DirectoryName("$*")
7375.   or DirectoryName("0*")
7376.   or DirectoryName("1*")
7377.   or DirectoryName("2*")
7378.   or DirectoryName("3*")
7379.   or DirectoryName("4*")
7380.   or DirectoryName("5*")
7381.   or DirectoryName("6*")
7382.   or DirectoryName("7*")
7383.   or DirectoryName("8*")
7384.   or DirectoryName("9*")
7385. 
7386.   or DirectoryName("dllcache")
7387.   or DirectoryName("Downloaded Installations")
7388.   or DirectoryName("Ehome")
7389.   or DirectoryName("Fonts")
7390.   or DirectoryName("Help")
7391.   or DirectoryName("I386")
7392.   or DirectoryName("ie?updates")
7393.   or DirectoryName("Installer")
7394.   or DirectoryName("Installshield Installation Information")
7395.   or DirectoryName("IME")
7396.   or DirectoryName("*RECYCLE*")
7397.   or DirectoryName("ServicePackFiles")
7398.   or DirectoryName("SoftwareDistribution")
7399.   or DirectoryName("Speech")
7400.   or DirectoryName("Symbols")
7401.   or DirectoryName("System Volume Information")
7402.   or DirectoryName("windows.old")
7403. )
7404. # WinSysLow end.
7405. 
7406.   # Archives
7407. )
7408. # Archives end.
7409. 
7410. # NotBlobsArchivesBu
7411. or
7412. # Backups start.
7413. (
7414.   DirectoryName("*Backup*")
7415.   or DirectoryName("*Bu")
7416.   or DirectoryName("* Bu *")
7417.   or DirectoryName("Bu *")
7418. 
7419.   or FileName("*.bak")
7420.   or FileName("* - Copy*")
7421. )
7422. # Backups end.
7423. 
7424. # NotBlobsArchivesBu
7425. ) )
7426. # NotBlobsArchivesBu end.
7427. 
7428. # Programs
7429. and (
7430. # SystemDir start.
7431. (
7432.   DirectoryName("Boot*")
7433.   or DirectoryName("Device*")
7434.   or DirectoryName("DevSupport*")
7435.   or DirectoryName("Program*")
7436.   or DirectoryName("Security*")
7437.   or DirectoryName("SendTo*")
7438.   or DirectoryName("Sw*")
7439.   or DirectoryName("System*")
7440.   or DirectoryName("Toolbars")
7441.   or DirectoryName("Windows*")
7442. )
7443. # SystemDir end.
7444. 
7445. # Programs
7446. )
7447. # Programs end.
7448. 
7449. 		and not(
7450. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
7451. # Os Data Dynamic start.
7452. (
7453. # Os Data Dynamic start.
7454. (
7455.   FileName("*.dat*")
7456.   or FileName("*.db*")
7457.   or FileName("*.edb*")
7458.   or FileName("*.log*")
7459.   or FileName("DataStore.edb")
7460. )
7461. # Os Data Dynamic end.
7462. 
7463.   or 
7464. # Os PageHiberDump start.
7465. (
7466.   FileName("DataStore.edb")
7467.   or FileName("DUMP*.*")
7468.   or FileName("Hiberfil.sys")
7469.   or FileName("MEMORY.DMP")
7470.   or FileName("Pagefile.sys")
7471. )
7472. # Os PageHiberDump end.
7473. 
7474. # Os Data Dynamic
7475. )
7476. # Os Data Dynamic end.
7477. 
7478. 			or 
7479. 				DirectoryName("Windows*")
7480. 		)
7481. 		FileActions
7482. 		  		/* ---------------------------------------------------------- */
7483. 	# Gap
7484. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
7485. 		# Script: DisplaySetFileStep
7486. 
7487. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7488. 
7489. /* add message and move to a new line. */
7490. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7491. ")
7492. 
7493. /* display the line. (hopefully.) */
7494. # Zone Footer Set Statistics Window Text
7495. 
7496. SetStatisticsWindowText("----------------------------------------------------------
7497. Zones Processed: 
7498. ----------------------------------------------------------
7499. !ZoneListByLine!
7500. ----------------------------------------------------------
7501. Zone Processing Step:
7502. !ZoneStepByLine!    
7503. ----------------------------------------------------------
7504. Current Zone:
7505. !ZoneFooter!
7506. ----------------------------------------------------------
7507. Volume Statistics:
7508. !VolumeStatisticsDetail!
7509. ----------------------------------------------------------
7510. Zone Detailed Report:
7511. ----------------------------------------------------------
7512. !ZoneStatisticsDetail!
7513. ----------------------------------------------------------
7514. ")
7515. 
7516. 
7517. 
7518. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7519. 
7520. # Script: BannerSet
7521. 
7522. # Script: DisplaySetDateTimeRun
7523. 
7524. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
7525. /* Xinclude "..\Display\BannerSet.MyDc"X */
7526. /* pause(1) */
7527. 
7528. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7529. 
7530. Title('!Heading!')
7531. /* pause(1) */
7532. 
7533. /* NOTE: Can't round or truncate to integer precision. */
7534. 
7535. pause(1)
7536. 	
7537. 	# ACTUAL GAP
7538. 		/* AddGap Variant. */
7539. 	  	# Zone Do Gap
7540. # Gap Calculation Methods:
7541. 
7542. /* 1) Anything you need to add first. */
7543. /* empty */
7544. 
7545. /* ---------------------------------------------------------- */
7546. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
7547. 	# GapRequestedStd.
7548. 
7549. 		/* ---------------------------------------------------------- */
7550. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
7551. 
7552. 		# Gap Calculation Methods:
7553. 
7554. /* AddGap Variants */
7555. 
7556. 	/* Standard */
7557. 		# Gap Calculation Methods:
7558. 	/* AddGap Variants */
7559. 	/* Standard */
7560. 
7561. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
7562. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
7563. 
7564. 	SetVariable(GapRequested, GapRequestedStd)
7565. 	
7566. 
7567. 	/* MFT Low High Method */
7568. 		# Gap Calculation Methods:
7569. 	/* AddGap Variants */
7570. 	/* MFT Low High Method */
7571. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
7572. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
7573. 	SetVariable(GapRequested, GapRequestedMft)
7574. 	
7575. 
7576. 	/* OS Volume Type Method */
7577. 		# Gap Calculation Methods:
7578. 	/* AddGap Variants */
7579. 	/* OS Volume Type Method */
7580. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
7581. 	SetVariable(GapRequested, GapRequestedOs)
7582. 
7583. 
7584. 
7585. /* MakeGap Variants */
7586. 
7587. 	/* Original Os 1-3 + MFT 2 */
7588. 		# Gap Calculation Methods:
7589. 	/* MakeGap Variants */
7590. 	/* Original Os 1-3 + MFT 2 */
7591. 	/* plus MFT gap placed inline at the dividing zone. */
7592. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
7593. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
7594. 	SetVariable(GapRequested, GapRequestedOrig)
7595. 	
7596. 	
7597. /* Note: You could comment out the ones not in use */
7598. /* However having the data in the log is useful. */
7599. /* Therefore the following line is otherwise needed. */
7600. 
7601. /* Standard used */
7602. 
7603. SetVariable(GapRequested, GapRequestedStd)
7604. 
7605. # Gap Calculation Methods:
7606. 
7607. /* AddGap Variants */
7608. 	/* Standard */
7609. 	/* MFT Low High Method */
7610. 	/* OS Volume Type Method */
7611. 
7612. /* MakeGap Variants */
7613. 	/* Original Os 1-3 + MFT 2 */
7614. 
7615. /* Note: You could comment out the ones not in use */
7616. /* However having the data in the log is useful. */
7617. /* Therefore the following line is otherwise needed. */
7618. 
7619. /* Standard is used currently */
7620. 
7621. 
7622. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
7623. 
7624. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
7625. 
7626. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
7627. 
7628. /* ---------------------------------------------------------- */
7629. /* 3) SMALL ZONE ADJUSTMENT. */
7630. /* Gab cant be larger than half the Zone Size. */
7631. 
7632. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
7633. 	
7634. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
7635. 
7636. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
7637. 
7638. /* ---------------------------------------------------------- */
7639. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
7640. # Gap Adjustments.
7641. 
7642. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
7643. 	
7644. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
7645. 
7646. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
7647. 
7648. /* ---------------------------------------------------------- */
7649. # BYPASS THIS.
7650. 	/* This is definitely wrong. */
7651. 	/* The question is can we steal gap from the next zone */
7652. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
7653. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
7654. 		# Zone Overflow.
7655. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
7656. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
7657. 
7658. /* ---------------------------------------------------------- */
7659. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
7660. # Remaining free space available.
7661. 
7662. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
7663. 	
7664. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
7665. 
7666. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
7667. 
7668. /* ---------------------------------------------------------- */
7669. # CURRENT gap to use.
7670. 
7671. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
7672. 
7673. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
7674. 
7675. /* ---------------------------------------------------------- */
7676. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
7677. # Debugging.
7678. 
7679. 	SetVariable(GapUsed, GapCurrent) // for debugging
7680. 
7681. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
7682. 
7683. 		# Your code HERE
7684. 
7685. /* ---------------------------------------------------------- */
7686. /* 7) YOUR CODE. */
7687. # YOUR CODE HERE:
7688. 	# INPUT: GapCurrent or GapCurrentLoc
7689. 	# OUTPUT: GapUsed...
7690. 
7691. /* ---------------------------------------------------------- */
7692. # Gap Size.
7693. # Actual Size of Gap.
7694. 
7695. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
7696. 
7697. /* ---------------------------------------------------------- */
7698. /* xxxxxxxxxxxxxxxxxxxxxx */
7699. # ADD THE GAP
7700. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
7701. /* xxxxxxxxxxxxxxxxxxxxxx */
7702. 
7703. 	
7704. 	# Zone Statistics	
7705. 	# Script: ZoneDoStatistics
7706. # Zone / Volume Statistics and Display
7707. 		
7708. 	# Accumulate Totals
7709.   	# Script: ZoneDoVolumeTotals
7710. 
7711. /* Current total space used (by Zones and Gaps) */
7712. 
7713. SetVariable(VolumeZoneUsed, GapUsed)
7714. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
7715. /* Percentage */
7716. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
7717. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
7718. 
7719. /* Current total of free space requested */
7720. 
7721. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
7722. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7723. /* Percent. */
7724. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
7725. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7726. 
7727. /* Current total of free space used */
7728. 
7729. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
7730. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
7731. /* Percent */
7732. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
7733. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
7734. 
7735. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
7736. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
7737. /* Xinclude "..\DebugDisplayPause.MyDc"X */
7738. 
7739. 
7740. 	# Current Values
7741. 	# Script: ZoneDoCurrentSet
7742. 
7743. # Cluster, Sector, Block adjust for display.
7744. 	# Bytes per cluster is volume specific.
7745. 
7746. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
7747. 
7748. # Current Zone values.
7749. 	# Begin, end and size.
7750. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
7751. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
7752. 
7753. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
7754. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
7755. 
7756. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
7757. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
7758. 
7759. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
7760. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
7761. 
7762. 	SetVariable(ZoneFragments,				"!ZONE210N!")
7763. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
7764. 		
7765. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
7766. /* identical code to here: (separation not needed. TEST.) */	
7767. 
7768. # Current Gap, Actual and Free Values
7769. 	# Gap
7770. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
7771. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
7772. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
7773. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
7774. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
7775. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
7776. 	
7777. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
7778. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
7779. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
7780. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
7781. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
7782. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
7783. 	
7784. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
7785. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
7786. 	
7787. 	# Actual Size and End
7788. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
7789. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
7790. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
7791. 	
7792. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
7793. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
7794. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
7795. 
7796. # Gap Size & Rounding
7797. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
7798. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
7799. 	
7800. 	# Free Space
7801. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
7802. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
7803. 
7804. 	# Footer:
7805. SetVariable(ZoneFooter, "----------------------------------------------------------
7806. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
7807. 
7808. Statistics Report:
7809. ------------------
7810.    Size:  
7811.    ------------------------
7812.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7813.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7814.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7815. 
7816.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7817.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7818. 
7819.    Location:
7820.    ------------------------
7821.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7822.              Files End: !ZoneEndCurrent!
7823.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7824.       
7825.    Gap Settings:
7826.    ------------------------
7827.          Gap Requested: !ZoneGapSizePer!%
7828.       Volume Rounding: !ZoneVolRoundUpPer!%
7829.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7830.                  
7831.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7832.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7833.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7834.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7835.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7836.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7837.      
7838.    Free Space after Zone:
7839.    ------------------------
7840.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7841.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7842.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7843. 
7844. Directory and Files Select:
7845. ---------------------------
7846. !ZoneTypeSelectCurrent!               
7847. ---------------------------
7848. ----------------------------------------------------------
7849. ")
7850. 	# Zone Footer Set Statistics Window Text
7851. 
7852. SetStatisticsWindowText("----------------------------------------------------------
7853. Zones Processed: 
7854. ----------------------------------------------------------
7855. !ZoneListByLine!
7856. ----------------------------------------------------------
7857. Zone Processing Step:
7858. !ZoneStepByLine!    
7859. ----------------------------------------------------------
7860. Current Zone:
7861. !ZoneFooter!
7862. ----------------------------------------------------------
7863. Volume Statistics:
7864. !VolumeStatisticsDetail!
7865. ----------------------------------------------------------
7866. Zone Detailed Report:
7867. ----------------------------------------------------------
7868. !ZoneStatisticsDetail!
7869. ----------------------------------------------------------
7870. ")
7871. 
7872. 
7873. 	
7874.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
7875. 
7876. 	# Add Zone to list of zones for display.
7877. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
7878. 	# ??? Free Stats?
7879. 	# Footer:
7880. SetVariable(ZoneFooter, "----------------------------------------------------------
7881. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
7882. 
7883. Statistics Report:
7884. ------------------
7885.    Size:  
7886.    ------------------------
7887.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7888.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7889.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7890. 
7891.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7892.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7893. 
7894.    Location:
7895.    ------------------------
7896.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7897.              Files End: !ZoneEndCurrent!
7898.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7899.       
7900.    Gap Settings:
7901.    ------------------------
7902.          Gap Requested: !ZoneGapSizePer!%
7903.       Volume Rounding: !ZoneVolRoundUpPer!%
7904.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7905.                  
7906.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7907.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7908.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7909.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7910.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7911.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7912.      
7913.    Free Space after Zone:
7914.    ------------------------
7915.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7916.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7917.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7918. 
7919. Directory and Files Select:
7920. ---------------------------
7921. !ZoneTypeSelectCurrent!               
7922. ---------------------------
7923. ----------------------------------------------------------
7924. ")
7925. 
7926. 	# Add Zone Details to Report.	
7927. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
7928. !ZoneFooter!")
7929. 
7930. 
7931. 	
7932. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
7933. 			# Script: DisplaySetFileStep
7934. 
7935. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7936. 
7937. /* add message and move to a new line. */
7938. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7939. ")
7940. 
7941. /* display the line. (hopefully.) */
7942. # Zone Footer Set Statistics Window Text
7943. 
7944. SetStatisticsWindowText("----------------------------------------------------------
7945. Zones Processed: 
7946. ----------------------------------------------------------
7947. !ZoneListByLine!
7948. ----------------------------------------------------------
7949. Zone Processing Step:
7950. !ZoneStepByLine!    
7951. ----------------------------------------------------------
7952. Current Zone:
7953. !ZoneFooter!
7954. ----------------------------------------------------------
7955. Volume Statistics:
7956. !VolumeStatisticsDetail!
7957. ----------------------------------------------------------
7958. Zone Detailed Report:
7959. ----------------------------------------------------------
7960. !ZoneStatisticsDetail!
7961. ----------------------------------------------------------
7962. ")
7963. 
7964. 
7965. 
7966. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7967. 
7968. # Script: BannerSet
7969. 
7970. # Script: DisplaySetDateTimeRun
7971. 
7972. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
7973. /* Xinclude "..\Display\BannerSet.MyDc"X */
7974. /* pause(1) */
7975. 
7976. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7977. 
7978. Title('!Heading!')
7979. /* pause(1) */
7980. 
7981. /* NOTE: Can't round or truncate to integer precision. */
7982. 
7983. pause(1)
7984. 
7985. 			# Script: ZoneDoAction
7986. # Zone Do File Action - SortByName.
7987. 
7988. FileActions
7989. 
7990. 	# Footer:
7991. SetVariable(ZoneFooter, "----------------------------------------------------------
7992. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
7993. 
7994. Statistics Report:
7995. ------------------
7996.    Size:  
7997.    ------------------------
7998.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7999.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8000.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8001. 
8002.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8003.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8004. 
8005.    Location:
8006.    ------------------------
8007.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8008.              Files End: !ZoneEndCurrent!
8009.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8010.       
8011.    Gap Settings:
8012.    ------------------------
8013.          Gap Requested: !ZoneGapSizePer!%
8014.       Volume Rounding: !ZoneVolRoundUpPer!%
8015.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8016.                  
8017.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
8018.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
8019.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
8020.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
8021.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
8022.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
8023.      
8024.    Free Space after Zone:
8025.    ------------------------
8026.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8027.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8028.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8029. 
8030. Directory and Files Select:
8031. ---------------------------
8032. !ZoneTypeSelectCurrent!               
8033. ---------------------------
8034. ----------------------------------------------------------
8035. ")
8036. 	SetStatisticsWindowText("!ZoneFooter!")
8037. 	
8038. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
8039. 	# Script: DisplaySetFileStep
8040. 
8041. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8042. 
8043. /* add message and move to a new line. */
8044. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8045. ")
8046. 
8047. /* display the line. (hopefully.) */
8048. # Zone Footer Set Statistics Window Text
8049. 
8050. SetStatisticsWindowText("----------------------------------------------------------
8051. Zones Processed: 
8052. ----------------------------------------------------------
8053. !ZoneListByLine!
8054. ----------------------------------------------------------
8055. Zone Processing Step:
8056. !ZoneStepByLine!    
8057. ----------------------------------------------------------
8058. Current Zone:
8059. !ZoneFooter!
8060. ----------------------------------------------------------
8061. Volume Statistics:
8062. !VolumeStatisticsDetail!
8063. ----------------------------------------------------------
8064. Zone Detailed Report:
8065. ----------------------------------------------------------
8066. !ZoneStatisticsDetail!
8067. ----------------------------------------------------------
8068. ")
8069. 
8070. 
8071. 
8072. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8073. 
8074. # Script: BannerSet
8075. 
8076. # Script: DisplaySetDateTimeRun
8077. 
8078. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
8079. /* Xinclude "..\Display\BannerSet.MyDc"X */
8080. /* pause(1) */
8081. 
8082. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8083. 
8084. Title('!Heading!')
8085. /* pause(1) */
8086. 
8087. /* NOTE: Can't round or truncate to integer precision. */
8088. 
8089. pause(1)
8090. 
8091. # Commands:
8092. 
8093. /* Moves to Zone or above it. */
8094. # MoveUpToZone()
8095. 
8096. # Defrag
8097. 
8098. # Defragment(OPTIONS)
8099. 
8100. /* Shuffles files around trying to make a big enough gap for fragmented files. */
8101. # Defragment()
8102. 
8103. /* Only does files where a gap will fit it. */
8104. # Defragment(Fast)
8105. 
8106. /* Skips fragmented files larger than the Chunck Size.
8107. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
8108. # Defragment(Chunk Size)
8109. 
8110. /* Moves down to zone and packs zone to beginning if there are gaps. */
8111. /* Can be similar in performance to doing a SortBy. */
8112. # MoveDownFill()
8113. 
8114. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
8115. 
8116. 
8117. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
8118. 	# Script: DisplaySetFileStep
8119. 
8120. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8121. 
8122. /* add message and move to a new line. */
8123. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8124. ")
8125. 
8126. /* display the line. (hopefully.) */
8127. # Zone Footer Set Statistics Window Text
8128. 
8129. SetStatisticsWindowText("----------------------------------------------------------
8130. Zones Processed: 
8131. ----------------------------------------------------------
8132. !ZoneListByLine!
8133. ----------------------------------------------------------
8134. Zone Processing Step:
8135. !ZoneStepByLine!    
8136. ----------------------------------------------------------
8137. Current Zone:
8138. !ZoneFooter!
8139. ----------------------------------------------------------
8140. Volume Statistics:
8141. !VolumeStatisticsDetail!
8142. ----------------------------------------------------------
8143. Zone Detailed Report:
8144. ----------------------------------------------------------
8145. !ZoneStatisticsDetail!
8146. ----------------------------------------------------------
8147. ")
8148. 
8149. 
8150. 
8151. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8152. 
8153. # Script: BannerSet
8154. 
8155. # Script: DisplaySetDateTimeRun
8156. 
8157. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
8158. /* Xinclude "..\Display\BannerSet.MyDc"X */
8159. /* pause(1) */
8160. 
8161. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8162. 
8163. Title('!Heading!')
8164. /* pause(1) */
8165. 
8166. /* NOTE: Can't round or truncate to integer precision. */
8167. 
8168. pause(1)
8169. 
8170. 	
8171. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
8172. 			# Script: DisplaySetFileStep
8173. 
8174. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8175. 
8176. /* add message and move to a new line. */
8177. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8178. ")
8179. 
8180. /* display the line. (hopefully.) */
8181. # Zone Footer Set Statistics Window Text
8182. 
8183. SetStatisticsWindowText("----------------------------------------------------------
8184. Zones Processed: 
8185. ----------------------------------------------------------
8186. !ZoneListByLine!
8187. ----------------------------------------------------------
8188. Zone Processing Step:
8189. !ZoneStepByLine!    
8190. ----------------------------------------------------------
8191. Current Zone:
8192. !ZoneFooter!
8193. ----------------------------------------------------------
8194. Volume Statistics:
8195. !VolumeStatisticsDetail!
8196. ----------------------------------------------------------
8197. Zone Detailed Report:
8198. ----------------------------------------------------------
8199. !ZoneStatisticsDetail!
8200. ----------------------------------------------------------
8201. ")
8202. 
8203. 
8204. 
8205. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8206. 
8207. # Script: BannerSet
8208. 
8209. # Script: DisplaySetDateTimeRun
8210. 
8211. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
8212. /* Xinclude "..\Display\BannerSet.MyDc"X */
8213. /* pause(1) */
8214. 
8215. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8216. 
8217. Title('!Heading!')
8218. /* pause(1) */
8219. 
8220. /* NOTE: Can't round or truncate to integer precision. */
8221. 
8222. pause(1)
8223. 
8224. 		# Script: ZoneDoFooter
8225. 
8226. /* ---------------------------------------------------------- */
8227. # File Select
8228. 	# Select Statments
8229. # File Actions 
8230. 	# Standard or OS File Actions.
8231. 	# Resume...
8232. 	
8233. 	# your stuff HERE (X)... post zone (file) file actions code.
8234. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
8235. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8236. 		# (X)
8237. 		
8238. 		/* ??? Set window? */
8239. 	
8240. 	# ADD THE GAP
8241. 		
8242. # Vacate (good for diagnostics)
8243. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
8244. 
8245. # DoNotVacate - DO NOT Vacate (recommended)
8246. 
8247. # Vacate
8248. /* AddGap(GapUsedLoc) */
8249. 
8250. # DO Not Vacate
8251. AddGap(GapUsedLoc, DoNotVacate) 
8252. 	
8253. 	
8254. /* ---------------------------------------------------------- */
8255. # (failed) TEST for boolean logic.
8256. 
8257. /* It should work in the gap calculations for turning options */
8258. /* on and off but it will NOT work here. */
8259. 
8260. /* Boolean setting X or FlagX. */
8261. /* Where X will be on or off: */
8262. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
8263. /*      For ON:  (X  *  FlagAny) */
8264. 
8265. /* 1) Failed, zero gap overrode the previous one. */
8266. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
8267. /* AddGap(GapUsedTemp) */ 
8268. 
8269. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
8270. /* AddGap(GapUsedTemp, DoNotVacate) */ 
8271. 
8272. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
8273. 
8274. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
8275. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
8276. /* AddGap(GapUsedTemp) */ 
8277. 
8278. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
8279. /* AddGap(GapUsedTemp, DoNotVacate) */ 
8280. 
8281. /* ---------------------------------------------------------- */
8282. 
8283. # Vacate
8284. /* AddGap(GapUsed) */
8285. 
8286. # DO NOT Vacate (recommended)
8287. /* AddGap(GapUsed, DoNotVacate) */ 
8288. 	
8289. 
8290. 		
8291. # 
8292. FileEnd
8293. /* ---------------------------------------------------------- */
8294. 
8295. # your stuff HERE (X)... post zone (file) code.
8296. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
8297. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8298. 	# (X)
8299. 
8300. SetVariable(FileStepDescription,"Zone finished, reporting.")
8301. # Script: DisplaySetFileStep
8302. 
8303. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8304. 
8305. /* add message and move to a new line. */
8306. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8307. ")
8308. 
8309. /* display the line. (hopefully.) */
8310. # Zone Footer Set Statistics Window Text
8311. 
8312. SetStatisticsWindowText("----------------------------------------------------------
8313. Zones Processed: 
8314. ----------------------------------------------------------
8315. !ZoneListByLine!
8316. ----------------------------------------------------------
8317. Zone Processing Step:
8318. !ZoneStepByLine!    
8319. ----------------------------------------------------------
8320. Current Zone:
8321. !ZoneFooter!
8322. ----------------------------------------------------------
8323. Volume Statistics:
8324. !VolumeStatisticsDetail!
8325. ----------------------------------------------------------
8326. Zone Detailed Report:
8327. ----------------------------------------------------------
8328. !ZoneStatisticsDetail!
8329. ----------------------------------------------------------
8330. ")
8331. 
8332. 
8333. 
8334. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8335. 
8336. # Script: BannerSet
8337. 
8338. # Script: DisplaySetDateTimeRun
8339. 
8340. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
8341. /* Xinclude "..\Display\BannerSet.MyDc"X */
8342. /* pause(1) */
8343. 
8344. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8345. 
8346. Title('!Heading!')
8347. /* pause(1) */
8348. 
8349. /* NOTE: Can't round or truncate to integer precision. */
8350. 
8351. pause(1)
8352. 
8353. # Script: ZoneWhenFinished
8354. 
8355. # Script: BannerSet
8356. 
8357. # Script: DisplaySetDateTimeRun
8358. 
8359. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
8360. /* Xinclude "..\Display\BannerSet.MyDc"X */
8361. /* pause(1) */
8362. 
8363. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8364. 
8365. Title('!Heading!')
8366. /* pause(1) */
8367. 
8368. /* NOTE: Can't round or truncate to integer precision. */
8369. 
8370. # Script: BannerLog
8371. 
8372. AppendLogfile("!LogFileName!", "!Title!")
8373. 
8374. 
8375. 
8376. # Zone Statistics	
8377. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
8378. 
8379. # Footer:
8380. SetVariable(ZoneFooter, "----------------------------------------------------------
8381. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
8382. 
8383. Statistics Report:
8384. ------------------
8385.    Size:  
8386.    ------------------------
8387.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8388.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8389.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8390. 
8391.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8392.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8393. 
8394.    Location:
8395.    ------------------------
8396.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8397.              Files End: !ZoneEndCurrent!
8398.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8399.       
8400.    Gap Settings:
8401.    ------------------------
8402.          Gap Requested: !ZoneGapSizePer!%
8403.       Volume Rounding: !ZoneVolRoundUpPer!%
8404.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8405.                  
8406.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
8407.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
8408.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
8409.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
8410.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
8411.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
8412.      
8413.    Free Space after Zone:
8414.    ------------------------
8415.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8416.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8417.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8418. 
8419. Directory and Files Select:
8420. ---------------------------
8421. !ZoneTypeSelectCurrent!               
8422. ---------------------------
8423. ----------------------------------------------------------
8424. ")
8425. 
8426. AppendLogfile("!LogFileName!", ".")
8427. AppendLogfile("!LogFileName!", "!ZoneFooter!")
8428. AppendLogfile("!LogFileName!", ".")
8429. 
8430. # Zone Footer Set Statistics Window Text
8431. 
8432. SetStatisticsWindowText("----------------------------------------------------------
8433. Zones Processed: 
8434. ----------------------------------------------------------
8435. !ZoneListByLine!
8436. ----------------------------------------------------------
8437. Zone Processing Step:
8438. !ZoneStepByLine!    
8439. ----------------------------------------------------------
8440. Current Zone:
8441. !ZoneFooter!
8442. ----------------------------------------------------------
8443. Volume Statistics:
8444. !VolumeStatisticsDetail!
8445. ----------------------------------------------------------
8446. Zone Detailed Report:
8447. ----------------------------------------------------------
8448. !ZoneStatisticsDetail!
8449. ----------------------------------------------------------
8450. ")
8451. 
8452. 
8453. 
8454. /* pause() */
8455. /* pause() */
8456. 
8457. 
8458. 
8459. 	
8460. /* ---------------------------------------------------------- */
8461. # Zone Programs Fixed size just Windows.
8462. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsWindows!")
8463. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsWindows!")
8464. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
8465. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
8466. 	SetVariable(ZoneTypeSelect,'
8467.                 # Programs - Windows folder.
8468. 				# Script: ZoneDo ZoneTypeSelectOsPrograms
8469. # Programs start.
8470. # NotBlobsArchivesBu start.
8471. (not (
8472. # Blobs start.
8473. (
8474. # BlobsAndExceptions start.
8475. ( not(
8476.   FileName("*.bat")
8477.   or FileName("*.css")
8478.   or FileName("*.dll")
8479.   or FileName("*.exe")
8480.   or FileName("*.htm*")
8481.   or FileName("*.jar")
8482.   or FileName("*.js")
8483.   or FileName("*.script")
8484.   or FileName("*.wsf")
8485.   or (
8486. # Databases start.
8487. (
8488.   FileName("*.crypt*")
8489.   or FileName("*.db*")
8490.   or FileName("*.rdb*")
8491.   or FileName("*.dc*")
8492.   or FileName("*.dict*")
8493.   or FileName("*.?db*")
8494.   or FileName("*.?rdb*")
8495.   or FileName("*.md*")
8496.   or FileName("*.myd")
8497.   or FileName("*.ndf")
8498.   or FileName("*.ns?")
8499.   or FileName("*.pab")
8500.   or FileName("*.pst")
8501.   or FileName("*.sd?*")
8502.   or FileName("*.sq**")
8503.   or FileName("*.tmd")
8504.   or FileName("*.tps")
8505.   or FileName("*.tr*")
8506. )
8507. # Databases end.
8508. 
8509.     # BlobsAndExceptions
8510.     or 
8511. # Data start.
8512. (
8513.   DirectoryName("Data*")
8514.   or DirectoryName("Device*")
8515.   or DirectoryName("Export*")
8516.   or DirectoryName("Import*")
8517.   or DirectoryName("Log*")
8518.   or DirectoryName("*Log")
8519.   or DirectoryName("Maintenance*")
8520.   or DirectoryName("Rec*")
8521.   or DirectoryName("Sales*")
8522.   or DirectoryName("Search*")
8523.   or DirectoryName("User*")
8524. )
8525. # Data end.
8526. 
8527.     # BlobsAndExceptions
8528.   )
8529. ) )
8530. # BlobsAndExceptions end.
8531. 
8532. # Blobs
8533. ) and (
8534.   Size(BlobFileSize,0)
8535.   or (
8536.     FileName("*.arj")
8537.     or FileName("*.bup")
8538.     or FileName("*.bz2")
8539.     or FileName("*.chm")
8540.     or FileName("*.dvr-ms")
8541.     or FileName("*.gz")
8542.     or FileName("*.ifo")
8543.     or FileName("*.lzh")
8544.     or FileName("*.pdf")
8545.     or FileName("*.rpm")
8546.     or FileName("*.wmv")
8547.     or FileName("*.vob")
8548.     or FileName("*.z")
8549.   ) 
8550. )
8551. # Blobs end.
8552. 
8553. # NotBlobsArchivesBu
8554. or 
8555. # Archives start.
8556. (
8557.   DirectoryName("*Archive*")
8558.   or DirectoryName("*History*")
8559.   or DirectoryName("*Old")
8560.   or DirectoryName("* Old *")
8561.   or DirectoryName("Old *")
8562. 
8563.   or FileName("*.7z")
8564.   or FileName("*.cab")
8565.   or FileName("*.iso")
8566.   or FileName("*.msi")
8567.   or FileName("*.old")
8568.   or FileName("*.rar")
8569.   or FileName("*.tar")
8570.   or FileName("*.zip")
8571.   or
8572. # WinSysLow start.
8573. (
8574.   DirectoryName("$*")
8575.   or DirectoryName("0*")
8576.   or DirectoryName("1*")
8577.   or DirectoryName("2*")
8578.   or DirectoryName("3*")
8579.   or DirectoryName("4*")
8580.   or DirectoryName("5*")
8581.   or DirectoryName("6*")
8582.   or DirectoryName("7*")
8583.   or DirectoryName("8*")
8584.   or DirectoryName("9*")
8585. 
8586.   or DirectoryName("dllcache")
8587.   or DirectoryName("Downloaded Installations")
8588.   or DirectoryName("Ehome")
8589.   or DirectoryName("Fonts")
8590.   or DirectoryName("Help")
8591.   or DirectoryName("I386")
8592.   or DirectoryName("ie?updates")
8593.   or DirectoryName("Installer")
8594.   or DirectoryName("Installshield Installation Information")
8595.   or DirectoryName("IME")
8596.   or DirectoryName("*RECYCLE*")
8597.   or DirectoryName("ServicePackFiles")
8598.   or DirectoryName("SoftwareDistribution")
8599.   or DirectoryName("Speech")
8600.   or DirectoryName("Symbols")
8601.   or DirectoryName("System Volume Information")
8602.   or DirectoryName("windows.old")
8603. )
8604. # WinSysLow end.
8605. 
8606.   # Archives
8607. )
8608. # Archives end.
8609. 
8610. # NotBlobsArchivesBu
8611. or
8612. # Backups start.
8613. (
8614.   DirectoryName("*Backup*")
8615.   or DirectoryName("*Bu")
8616.   or DirectoryName("* Bu *")
8617.   or DirectoryName("Bu *")
8618. 
8619.   or FileName("*.bak")
8620.   or FileName("* - Copy*")
8621. )
8622. # Backups end.
8623. 
8624. # NotBlobsArchivesBu
8625. ) )
8626. # NotBlobsArchivesBu end.
8627. 
8628. # Programs
8629. and (
8630. # SystemDir start.
8631. (
8632.   DirectoryName("Boot*")
8633.   or DirectoryName("Device*")
8634.   or DirectoryName("DevSupport*")
8635.   or DirectoryName("Program*")
8636.   or DirectoryName("Security*")
8637.   or DirectoryName("SendTo*")
8638.   or DirectoryName("Sw*")
8639.   or DirectoryName("System*")
8640.   or DirectoryName("Toolbars")
8641.   or DirectoryName("Windows*")
8642. )
8643. # SystemDir end.
8644. 
8645. # Programs
8646. )
8647. # Programs end.
8648. 
8649.                 and not(
8650.                 # Script: ZoneDo ZoneTypeSelectOsDataDynamic
8651. # Os Data Dynamic start.
8652. (
8653. # Os Data Dynamic start.
8654. (
8655.   FileName("*.dat*")
8656.   or FileName("*.db*")
8657.   or FileName("*.edb*")
8658.   or FileName("*.log*")
8659.   or FileName("DataStore.edb")
8660. )
8661. # Os Data Dynamic end.
8662. 
8663.   or 
8664. # Os PageHiberDump start.
8665. (
8666.   FileName("DataStore.edb")
8667.   or FileName("DUMP*.*")
8668.   or FileName("Hiberfil.sys")
8669.   or FileName("MEMORY.DMP")
8670.   or FileName("Pagefile.sys")
8671. )
8672. # Os PageHiberDump end.
8673. 
8674. # Os Data Dynamic
8675. )
8676. # Os Data Dynamic end.
8677. 
8678.                 )
8679. ')
8680. 
8681. 		# Script: ZoneDoHeader
8682. 
8683. # Script: ZoneWhenStarted
8684. 
8685. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
8686. # Script: DisplaySetZone
8687. 
8688. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
8689. SetVariable(FileStepDescription,	"")
8690. 
8691. SetVariable(ZoneStepByLine, 			"Zone started.
8692. ")
8693. 
8694. # Script: BannerDescriptionSet
8695. 
8696. # Script: BannerSet
8697. 
8698. # Script: DisplaySetDateTimeRun
8699. 
8700. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
8701. /* Xinclude "..\Display\BannerSet.MyDc"X */
8702. /* pause(1) */
8703. 
8704. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8705. 
8706. Title('!Heading!')
8707. /* pause(1) */
8708. 
8709. /* NOTE: Can't round or truncate to integer precision. */
8710. 
8711. # Script: BannerLog
8712. 
8713. AppendLogfile("!LogFileName!", "!Title!")
8714. 
8715. 
8716. 
8717. pause(1)
8718. 
8719. 
8720. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
8721. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
8722. 
8723. SetVariable(ZoneStepNoCurrent, 0)
8724. 
8725. 
8726. # Script: ZoneDoCurrentClear
8727. 
8728. SetVariable(ZoneTypeSelectCurrent, 		"")
8729. 
8730. SetVariable(ZoneBeginCurrent, 			0)
8731. SetVariable(ZoneBeginPerCurrent, 		0)
8732. SetVariable(ZoneEndCurrent, 			0)
8733. SetVariable(ZoneEndPerCurrent, 			0)
8734. 
8735. SetVariable(ZoneSizeCurrent,			0)
8736. SetVariable(ZoneSizePerCurrent,			0)
8737. 
8738. SetVariable(ZoneGapRequestedCurrent,	0)
8739. SetVariable(ZoneGapRoundedCurrent, 		0)
8740. SetVariable(ZoneGapAdjustedCurrent, 	0)
8741. SetVariable(ZoneGapAvailableCurrent, 	0)
8742. SetVariable(ZoneGapCurrent,				0)
8743. SetVariable(ZoneGapUsedCurrent, 		0)
8744. 
8745. SetVariable(ZoneGapActualCurrent, 		0)
8746. SetVariable(ZoneGapActualPerCurrent, 	0)
8747. 
8748. SetVariable(ZoneSizeActual, 			0)
8749. SetVariable(ZoneSizeActualCurrent,		0)
8750. 
8751. SetVariable(ZoneEndActual, 				0)
8752. SetVariable(ZoneEndActualCurrent,		0)			
8753. SetVariable(ZoneSizeActualPerCurrent, 	0)
8754.       
8755. SetVariable(ZoneFilesFolders,			0)
8756. SetVariable(ZoneFilesFoldersPer,		0) 
8757. 
8758. SetVariable(ZoneFragments,				0)
8759. SetVariable(ZoneFragmentsPer,			0) 
8760. 		
8761. SetVariable(ZoneEndActualCurrent, 		0)
8762. SetVariable(ZoneEndActualPerCurrent, 	0)
8763. 
8764. # Gap Calculation Methodology:
8765. 	# Requested
8766. 	SetVariable(GapRequested, 			0) 
8767. 	SetVariable(GapRequestedStd, 		0) 
8768. 	SetVariable(GapRequestedMft, 		0) 
8769. 	SetVariable(GapRequestedOs, 		0) 
8770. 	SetVariable(GapRequestedOriginal, 	0) 
8771. 	
8772. 	# Gap Adjustments
8773. 	SetVariable(GapRounded, 			0)
8774. 	# SetVariable(GapAdjusted, 			0)
8775. 	SetVariable(GapAvailable, 			0)
8776. 	SetVariable(GapCurrent, 			0)
8777. 	SetVariable(GapActual, 				0)
8778. 	SetVariable(GapUsed, 				0)
8779. 	
8780. 	# Gap Adjustments
8781. 	SetVariable(GapRoundedLoc, 			0)
8782. 	# SetVariable(GapAdjustedLoc, 		0)
8783. 	SetVariable(GapAvailableLoc, 		0)
8784. 	SetVariable(GapCurrentLoc, 			0)
8785. 	SetVariable(GapActualLoc,			0)
8786. 	SetVariable(GapUsedLoc,				0)
8787. 	
8788. 	# Space usage
8789. 	SetVariable(ZoneFreePerRequested, 	0)
8790. 	SetVariable(ZoneFreePerUsed, 		0)
8791. 
8792. # Gap Size & Rounding
8793. 	SetVariable(ZoneGapSizePer, 		0)
8794. 	SetVariable(ZoneVolRoundUpPer, 		0)
8795. 	
8796. 	# Free Space
8797. 	SetVariable(ZoneFreeUsedPer, 		0)
8798. 	SetVariable(ZoneFreeRequestedPer, 	0)
8799. 
8800. 
8801. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
8802. 
8803. # Footer:
8804. SetVariable(ZoneFooter, "----------------------------------------------------------
8805. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
8806. 
8807. Statistics Report:
8808. ------------------
8809.    Size:  
8810.    ------------------------
8811.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8812.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8813.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8814. 
8815.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8816.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8817. 
8818.    Location:
8819.    ------------------------
8820.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8821.              Files End: !ZoneEndCurrent!
8822.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8823.       
8824.    Gap Settings:
8825.    ------------------------
8826.          Gap Requested: !ZoneGapSizePer!%
8827.       Volume Rounding: !ZoneVolRoundUpPer!%
8828.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8829.                  
8830.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
8831.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
8832.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
8833.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
8834.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
8835.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
8836.      
8837.    Free Space after Zone:
8838.    ------------------------
8839.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8840.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8841.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8842. 
8843. Directory and Files Select:
8844. ---------------------------
8845. !ZoneTypeSelectCurrent!               
8846. ---------------------------
8847. ----------------------------------------------------------
8848. ")
8849. 
8850. # Script: BannerSet
8851. 
8852. # Script: DisplaySetDateTimeRun
8853. 
8854. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
8855. /* Xinclude "..\Display\BannerSet.MyDc"X */
8856. /* pause(1) */
8857. 
8858. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8859. 
8860. Title('!Heading!')
8861. /* pause(1) */
8862. 
8863. /* NOTE: Can't round or truncate to integer precision. */
8864. 
8865. # Script: BannerLog
8866. 
8867. AppendLogfile("!LogFileName!", "!Title!")
8868. 
8869. 
8870. 
8871. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
8872. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
8873. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:50")
8874. 
8875. SetVariable(ZoneListByLine, "!ZoneListByLine!
8876. Zone: !ZoneNoCurrent! 2021-11-09 18:53:50 0:00:06 !ZoneLabel! !ZoneDescription!")
8877. 
8878. 
8879. /* Fixed Zone Position Handling */
8880. /* Literal number: */
8881. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
8882. /* Percentage of disk: */
8883. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
8884. /* Gap */
8885. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
8886. 
8887. /* ---------------------------------------------------------- */
8888. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
8889. # Script: DisplaySetFileStep
8890. 
8891. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8892. 
8893. /* add message and move to a new line. */
8894. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8895. ")
8896. 
8897. /* display the line. (hopefully.) */
8898. # Zone Footer Set Statistics Window Text
8899. 
8900. SetStatisticsWindowText("----------------------------------------------------------
8901. Zones Processed: 
8902. ----------------------------------------------------------
8903. !ZoneListByLine!
8904. ----------------------------------------------------------
8905. Zone Processing Step:
8906. !ZoneStepByLine!    
8907. ----------------------------------------------------------
8908. Current Zone:
8909. !ZoneFooter!
8910. ----------------------------------------------------------
8911. Volume Statistics:
8912. !VolumeStatisticsDetail!
8913. ----------------------------------------------------------
8914. Zone Detailed Report:
8915. ----------------------------------------------------------
8916. !ZoneStatisticsDetail!
8917. ----------------------------------------------------------
8918. ")
8919. 
8920. 
8921. 
8922. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8923. 
8924. # Script: BannerSet
8925. 
8926. # Script: DisplaySetDateTimeRun
8927. 
8928. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
8929. /* Xinclude "..\Display\BannerSet.MyDc"X */
8930. /* pause(1) */
8931. 
8932. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8933. 
8934. Title('!Heading!')
8935. /* pause(1) */
8936. 
8937. /* NOTE: Can't round or truncate to integer precision. */
8938. 
8939. pause(1)
8940. 
8941. # your stuff HERE (X)... pre file select code.
8942. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
8943. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
8944. 	# (X)
8945. 
8946. FileSelect
8947. 
8948. 	# your stuff can't really go here (errors.)
8949. 	# maybe for some reason I don't know of...
8950. 	
8951. 	# Actions next...
8952. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
8953. # Programs start.
8954. # NotBlobsArchivesBu start.
8955. (not (
8956. # Blobs start.
8957. (
8958. # BlobsAndExceptions start.
8959. ( not(
8960.   FileName("*.bat")
8961.   or FileName("*.css")
8962.   or FileName("*.dll")
8963.   or FileName("*.exe")
8964.   or FileName("*.htm*")
8965.   or FileName("*.jar")
8966.   or FileName("*.js")
8967.   or FileName("*.script")
8968.   or FileName("*.wsf")
8969.   or (
8970. # Databases start.
8971. (
8972.   FileName("*.crypt*")
8973.   or FileName("*.db*")
8974.   or FileName("*.rdb*")
8975.   or FileName("*.dc*")
8976.   or FileName("*.dict*")
8977.   or FileName("*.?db*")
8978.   or FileName("*.?rdb*")
8979.   or FileName("*.md*")
8980.   or FileName("*.myd")
8981.   or FileName("*.ndf")
8982.   or FileName("*.ns?")
8983.   or FileName("*.pab")
8984.   or FileName("*.pst")
8985.   or FileName("*.sd?*")
8986.   or FileName("*.sq**")
8987.   or FileName("*.tmd")
8988.   or FileName("*.tps")
8989.   or FileName("*.tr*")
8990. )
8991. # Databases end.
8992. 
8993.     # BlobsAndExceptions
8994.     or 
8995. # Data start.
8996. (
8997.   DirectoryName("Data*")
8998.   or DirectoryName("Device*")
8999.   or DirectoryName("Export*")
9000.   or DirectoryName("Import*")
9001.   or DirectoryName("Log*")
9002.   or DirectoryName("*Log")
9003.   or DirectoryName("Maintenance*")
9004.   or DirectoryName("Rec*")
9005.   or DirectoryName("Sales*")
9006.   or DirectoryName("Search*")
9007.   or DirectoryName("User*")
9008. )
9009. # Data end.
9010. 
9011.     # BlobsAndExceptions
9012.   )
9013. ) )
9014. # BlobsAndExceptions end.
9015. 
9016. # Blobs
9017. ) and (
9018.   Size(BlobFileSize,0)
9019.   or (
9020.     FileName("*.arj")
9021.     or FileName("*.bup")
9022.     or FileName("*.bz2")
9023.     or FileName("*.chm")
9024.     or FileName("*.dvr-ms")
9025.     or FileName("*.gz")
9026.     or FileName("*.ifo")
9027.     or FileName("*.lzh")
9028.     or FileName("*.pdf")
9029.     or FileName("*.rpm")
9030.     or FileName("*.wmv")
9031.     or FileName("*.vob")
9032.     or FileName("*.z")
9033.   ) 
9034. )
9035. # Blobs end.
9036. 
9037. # NotBlobsArchivesBu
9038. or 
9039. # Archives start.
9040. (
9041.   DirectoryName("*Archive*")
9042.   or DirectoryName("*History*")
9043.   or DirectoryName("*Old")
9044.   or DirectoryName("* Old *")
9045.   or DirectoryName("Old *")
9046. 
9047.   or FileName("*.7z")
9048.   or FileName("*.cab")
9049.   or FileName("*.iso")
9050.   or FileName("*.msi")
9051.   or FileName("*.old")
9052.   or FileName("*.rar")
9053.   or FileName("*.tar")
9054.   or FileName("*.zip")
9055.   or
9056. # WinSysLow start.
9057. (
9058.   DirectoryName("$*")
9059.   or DirectoryName("0*")
9060.   or DirectoryName("1*")
9061.   or DirectoryName("2*")
9062.   or DirectoryName("3*")
9063.   or DirectoryName("4*")
9064.   or DirectoryName("5*")
9065.   or DirectoryName("6*")
9066.   or DirectoryName("7*")
9067.   or DirectoryName("8*")
9068.   or DirectoryName("9*")
9069. 
9070.   or DirectoryName("dllcache")
9071.   or DirectoryName("Downloaded Installations")
9072.   or DirectoryName("Ehome")
9073.   or DirectoryName("Fonts")
9074.   or DirectoryName("Help")
9075.   or DirectoryName("I386")
9076.   or DirectoryName("ie?updates")
9077.   or DirectoryName("Installer")
9078.   or DirectoryName("Installshield Installation Information")
9079.   or DirectoryName("IME")
9080.   or DirectoryName("*RECYCLE*")
9081.   or DirectoryName("ServicePackFiles")
9082.   or DirectoryName("SoftwareDistribution")
9083.   or DirectoryName("Speech")
9084.   or DirectoryName("Symbols")
9085.   or DirectoryName("System Volume Information")
9086.   or DirectoryName("windows.old")
9087. )
9088. # WinSysLow end.
9089. 
9090.   # Archives
9091. )
9092. # Archives end.
9093. 
9094. # NotBlobsArchivesBu
9095. or
9096. # Backups start.
9097. (
9098.   DirectoryName("*Backup*")
9099.   or DirectoryName("*Bu")
9100.   or DirectoryName("* Bu *")
9101.   or DirectoryName("Bu *")
9102. 
9103.   or FileName("*.bak")
9104.   or FileName("* - Copy*")
9105. )
9106. # Backups end.
9107. 
9108. # NotBlobsArchivesBu
9109. ) )
9110. # NotBlobsArchivesBu end.
9111. 
9112. # Programs
9113. and (
9114. # SystemDir start.
9115. (
9116.   DirectoryName("Boot*")
9117.   or DirectoryName("Device*")
9118.   or DirectoryName("DevSupport*")
9119.   or DirectoryName("Program*")
9120.   or DirectoryName("Security*")
9121.   or DirectoryName("SendTo*")
9122.   or DirectoryName("Sw*")
9123.   or DirectoryName("System*")
9124.   or DirectoryName("Toolbars")
9125.   or DirectoryName("Windows*")
9126. )
9127. # SystemDir end.
9128. 
9129. # Programs
9130. )
9131. # Programs end.
9132. 
9133. 		and not(
9134. 			# Script: ZoneDo ZoneTypeSelectOsDataDynamic
9135. # Os Data Dynamic start.
9136. (
9137. # Os Data Dynamic start.
9138. (
9139.   FileName("*.dat*")
9140.   or FileName("*.db*")
9141.   or FileName("*.edb*")
9142.   or FileName("*.log*")
9143.   or FileName("DataStore.edb")
9144. )
9145. # Os Data Dynamic end.
9146. 
9147.   or 
9148. # Os PageHiberDump start.
9149. (
9150.   FileName("DataStore.edb")
9151.   or FileName("DUMP*.*")
9152.   or FileName("Hiberfil.sys")
9153.   or FileName("MEMORY.DMP")
9154.   or FileName("Pagefile.sys")
9155. )
9156. # Os PageHiberDump end.
9157. 
9158. # Os Data Dynamic
9159. )
9160. # Os Data Dynamic end.
9161. 
9162. 		)
9163. 
9164. 		FileActions
9165. 		  		/* ---------------------------------------------------------- */
9166. 	# Gap
9167. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
9168. 		# Script: DisplaySetFileStep
9169. 
9170. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9171. 
9172. /* add message and move to a new line. */
9173. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9174. ")
9175. 
9176. /* display the line. (hopefully.) */
9177. # Zone Footer Set Statistics Window Text
9178. 
9179. SetStatisticsWindowText("----------------------------------------------------------
9180. Zones Processed: 
9181. ----------------------------------------------------------
9182. !ZoneListByLine!
9183. ----------------------------------------------------------
9184. Zone Processing Step:
9185. !ZoneStepByLine!    
9186. ----------------------------------------------------------
9187. Current Zone:
9188. !ZoneFooter!
9189. ----------------------------------------------------------
9190. Volume Statistics:
9191. !VolumeStatisticsDetail!
9192. ----------------------------------------------------------
9193. Zone Detailed Report:
9194. ----------------------------------------------------------
9195. !ZoneStatisticsDetail!
9196. ----------------------------------------------------------
9197. ")
9198. 
9199. 
9200. 
9201. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9202. 
9203. # Script: BannerSet
9204. 
9205. # Script: DisplaySetDateTimeRun
9206. 
9207. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
9208. /* Xinclude "..\Display\BannerSet.MyDc"X */
9209. /* pause(1) */
9210. 
9211. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9212. 
9213. Title('!Heading!')
9214. /* pause(1) */
9215. 
9216. /* NOTE: Can't round or truncate to integer precision. */
9217. 
9218. pause(1)
9219. 	
9220. 	# ACTUAL GAP
9221. 		/* AddGap Variant. */
9222. 	  	# Zone Do Gap
9223. # Gap Calculation Methods:
9224. 
9225. /* 1) Anything you need to add first. */
9226. /* empty */
9227. 
9228. /* ---------------------------------------------------------- */
9229. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
9230. 	# GapRequestedStd.
9231. 
9232. 		/* ---------------------------------------------------------- */
9233. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
9234. 
9235. 		# Gap Calculation Methods:
9236. 
9237. /* AddGap Variants */
9238. 
9239. 	/* Standard */
9240. 		# Gap Calculation Methods:
9241. 	/* AddGap Variants */
9242. 	/* Standard */
9243. 
9244. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
9245. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
9246. 
9247. 	SetVariable(GapRequested, GapRequestedStd)
9248. 	
9249. 
9250. 	/* MFT Low High Method */
9251. 		# Gap Calculation Methods:
9252. 	/* AddGap Variants */
9253. 	/* MFT Low High Method */
9254. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
9255. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
9256. 	SetVariable(GapRequested, GapRequestedMft)
9257. 	
9258. 
9259. 	/* OS Volume Type Method */
9260. 		# Gap Calculation Methods:
9261. 	/* AddGap Variants */
9262. 	/* OS Volume Type Method */
9263. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
9264. 	SetVariable(GapRequested, GapRequestedOs)
9265. 
9266. 
9267. 
9268. /* MakeGap Variants */
9269. 
9270. 	/* Original Os 1-3 + MFT 2 */
9271. 		# Gap Calculation Methods:
9272. 	/* MakeGap Variants */
9273. 	/* Original Os 1-3 + MFT 2 */
9274. 	/* plus MFT gap placed inline at the dividing zone. */
9275. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
9276. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
9277. 	SetVariable(GapRequested, GapRequestedOrig)
9278. 	
9279. 	
9280. /* Note: You could comment out the ones not in use */
9281. /* However having the data in the log is useful. */
9282. /* Therefore the following line is otherwise needed. */
9283. 
9284. /* Standard used */
9285. 
9286. SetVariable(GapRequested, GapRequestedStd)
9287. 
9288. # Gap Calculation Methods:
9289. 
9290. /* AddGap Variants */
9291. 	/* Standard */
9292. 	/* MFT Low High Method */
9293. 	/* OS Volume Type Method */
9294. 
9295. /* MakeGap Variants */
9296. 	/* Original Os 1-3 + MFT 2 */
9297. 
9298. /* Note: You could comment out the ones not in use */
9299. /* However having the data in the log is useful. */
9300. /* Therefore the following line is otherwise needed. */
9301. 
9302. /* Standard is used currently */
9303. 
9304. 
9305. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
9306. 
9307. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
9308. 
9309. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
9310. 
9311. /* ---------------------------------------------------------- */
9312. /* 3) SMALL ZONE ADJUSTMENT. */
9313. /* Gab cant be larger than half the Zone Size. */
9314. 
9315. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
9316. 	
9317. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
9318. 
9319. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
9320. 
9321. /* ---------------------------------------------------------- */
9322. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
9323. # Gap Adjustments.
9324. 
9325. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
9326. 	
9327. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
9328. 
9329. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
9330. 
9331. /* ---------------------------------------------------------- */
9332. # BYPASS THIS.
9333. 	/* This is definitely wrong. */
9334. 	/* The question is can we steal gap from the next zone */
9335. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
9336. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
9337. 		# Zone Overflow.
9338. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
9339. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
9340. 
9341. /* ---------------------------------------------------------- */
9342. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
9343. # Remaining free space available.
9344. 
9345. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
9346. 	
9347. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
9348. 
9349. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
9350. 
9351. /* ---------------------------------------------------------- */
9352. # CURRENT gap to use.
9353. 
9354. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
9355. 
9356. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
9357. 
9358. /* ---------------------------------------------------------- */
9359. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
9360. # Debugging.
9361. 
9362. 	SetVariable(GapUsed, GapCurrent) // for debugging
9363. 
9364. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
9365. 
9366. 		# Your code HERE
9367. 
9368. /* ---------------------------------------------------------- */
9369. /* 7) YOUR CODE. */
9370. # YOUR CODE HERE:
9371. 	# INPUT: GapCurrent or GapCurrentLoc
9372. 	# OUTPUT: GapUsed...
9373. 
9374. /* ---------------------------------------------------------- */
9375. # Gap Size.
9376. # Actual Size of Gap.
9377. 
9378. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
9379. 
9380. /* ---------------------------------------------------------- */
9381. /* xxxxxxxxxxxxxxxxxxxxxx */
9382. # ADD THE GAP
9383. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
9384. /* xxxxxxxxxxxxxxxxxxxxxx */
9385. 
9386. 	
9387. 	# Zone Statistics	
9388. 	# Script: ZoneDoStatistics
9389. # Zone / Volume Statistics and Display
9390. 		
9391. 	# Accumulate Totals
9392.   	# Script: ZoneDoVolumeTotals
9393. 
9394. /* Current total space used (by Zones and Gaps) */
9395. 
9396. SetVariable(VolumeZoneUsed, GapUsed)
9397. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
9398. /* Percentage */
9399. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
9400. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
9401. 
9402. /* Current total of free space requested */
9403. 
9404. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
9405. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
9406. /* Percent. */
9407. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
9408. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
9409. 
9410. /* Current total of free space used */
9411. 
9412. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
9413. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
9414. /* Percent */
9415. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
9416. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
9417. 
9418. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
9419. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
9420. /* Xinclude "..\DebugDisplayPause.MyDc"X */
9421. 
9422. 
9423. 	# Current Values
9424. 	# Script: ZoneDoCurrentSet
9425. 
9426. # Cluster, Sector, Block adjust for display.
9427. 	# Bytes per cluster is volume specific.
9428. 
9429. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
9430. 
9431. # Current Zone values.
9432. 	# Begin, end and size.
9433. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
9434. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
9435. 
9436. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
9437. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
9438. 
9439. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
9440. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
9441. 
9442. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
9443. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
9444. 
9445. 	SetVariable(ZoneFragments,				"!ZONE210N!")
9446. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
9447. 		
9448. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
9449. /* identical code to here: (separation not needed. TEST.) */	
9450. 
9451. # Current Gap, Actual and Free Values
9452. 	# Gap
9453. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
9454. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
9455. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
9456. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
9457. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
9458. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
9459. 	
9460. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
9461. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
9462. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
9463. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
9464. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
9465. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
9466. 	
9467. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
9468. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
9469. 	
9470. 	# Actual Size and End
9471. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
9472. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
9473. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
9474. 	
9475. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
9476. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
9477. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
9478. 
9479. # Gap Size & Rounding
9480. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
9481. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
9482. 	
9483. 	# Free Space
9484. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
9485. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
9486. 
9487. 	# Footer:
9488. SetVariable(ZoneFooter, "----------------------------------------------------------
9489. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
9490. 
9491. Statistics Report:
9492. ------------------
9493.    Size:  
9494.    ------------------------
9495.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9496.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9497.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9498. 
9499.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9500.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9501. 
9502.    Location:
9503.    ------------------------
9504.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9505.              Files End: !ZoneEndCurrent!
9506.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9507.       
9508.    Gap Settings:
9509.    ------------------------
9510.          Gap Requested: !ZoneGapSizePer!%
9511.       Volume Rounding: !ZoneVolRoundUpPer!%
9512.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9513.                  
9514.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9515.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9516.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9517.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9518.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9519.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9520.      
9521.    Free Space after Zone:
9522.    ------------------------
9523.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9524.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9525.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9526. 
9527. Directory and Files Select:
9528. ---------------------------
9529. !ZoneTypeSelectCurrent!               
9530. ---------------------------
9531. ----------------------------------------------------------
9532. ")
9533. 	# Zone Footer Set Statistics Window Text
9534. 
9535. SetStatisticsWindowText("----------------------------------------------------------
9536. Zones Processed: 
9537. ----------------------------------------------------------
9538. !ZoneListByLine!
9539. ----------------------------------------------------------
9540. Zone Processing Step:
9541. !ZoneStepByLine!    
9542. ----------------------------------------------------------
9543. Current Zone:
9544. !ZoneFooter!
9545. ----------------------------------------------------------
9546. Volume Statistics:
9547. !VolumeStatisticsDetail!
9548. ----------------------------------------------------------
9549. Zone Detailed Report:
9550. ----------------------------------------------------------
9551. !ZoneStatisticsDetail!
9552. ----------------------------------------------------------
9553. ")
9554. 
9555. 
9556. 	
9557.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
9558. 
9559. 	# Add Zone to list of zones for display.
9560. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
9561. 	# ??? Free Stats?
9562. 	# Footer:
9563. SetVariable(ZoneFooter, "----------------------------------------------------------
9564. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
9565. 
9566. Statistics Report:
9567. ------------------
9568.    Size:  
9569.    ------------------------
9570.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9571.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9572.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9573. 
9574.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9575.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9576. 
9577.    Location:
9578.    ------------------------
9579.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9580.              Files End: !ZoneEndCurrent!
9581.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9582.       
9583.    Gap Settings:
9584.    ------------------------
9585.          Gap Requested: !ZoneGapSizePer!%
9586.       Volume Rounding: !ZoneVolRoundUpPer!%
9587.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9588.                  
9589.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9590.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9591.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9592.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9593.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9594.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9595.      
9596.    Free Space after Zone:
9597.    ------------------------
9598.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9599.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9600.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9601. 
9602. Directory and Files Select:
9603. ---------------------------
9604. !ZoneTypeSelectCurrent!               
9605. ---------------------------
9606. ----------------------------------------------------------
9607. ")
9608. 
9609. 	# Add Zone Details to Report.	
9610. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
9611. !ZoneFooter!")
9612. 
9613. 
9614. 	
9615. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
9616. 			# Script: DisplaySetFileStep
9617. 
9618. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9619. 
9620. /* add message and move to a new line. */
9621. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9622. ")
9623. 
9624. /* display the line. (hopefully.) */
9625. # Zone Footer Set Statistics Window Text
9626. 
9627. SetStatisticsWindowText("----------------------------------------------------------
9628. Zones Processed: 
9629. ----------------------------------------------------------
9630. !ZoneListByLine!
9631. ----------------------------------------------------------
9632. Zone Processing Step:
9633. !ZoneStepByLine!    
9634. ----------------------------------------------------------
9635. Current Zone:
9636. !ZoneFooter!
9637. ----------------------------------------------------------
9638. Volume Statistics:
9639. !VolumeStatisticsDetail!
9640. ----------------------------------------------------------
9641. Zone Detailed Report:
9642. ----------------------------------------------------------
9643. !ZoneStatisticsDetail!
9644. ----------------------------------------------------------
9645. ")
9646. 
9647. 
9648. 
9649. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9650. 
9651. # Script: BannerSet
9652. 
9653. # Script: DisplaySetDateTimeRun
9654. 
9655. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
9656. /* Xinclude "..\Display\BannerSet.MyDc"X */
9657. /* pause(1) */
9658. 
9659. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9660. 
9661. Title('!Heading!')
9662. /* pause(1) */
9663. 
9664. /* NOTE: Can't round or truncate to integer precision. */
9665. 
9666. pause(1)
9667. 
9668. 			/* "..\ActionVerbs\ZoneDoAction.MyDc" */
9669. 			# File Action - SortByImportSequence with SkipBlock.
9670. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
9671. 	
9672. 	
9673. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
9674. 			# Script: DisplaySetFileStep
9675. 
9676. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9677. 
9678. /* add message and move to a new line. */
9679. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9680. ")
9681. 
9682. /* display the line. (hopefully.) */
9683. # Zone Footer Set Statistics Window Text
9684. 
9685. SetStatisticsWindowText("----------------------------------------------------------
9686. Zones Processed: 
9687. ----------------------------------------------------------
9688. !ZoneListByLine!
9689. ----------------------------------------------------------
9690. Zone Processing Step:
9691. !ZoneStepByLine!    
9692. ----------------------------------------------------------
9693. Current Zone:
9694. !ZoneFooter!
9695. ----------------------------------------------------------
9696. Volume Statistics:
9697. !VolumeStatisticsDetail!
9698. ----------------------------------------------------------
9699. Zone Detailed Report:
9700. ----------------------------------------------------------
9701. !ZoneStatisticsDetail!
9702. ----------------------------------------------------------
9703. ")
9704. 
9705. 
9706. 
9707. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9708. 
9709. # Script: BannerSet
9710. 
9711. # Script: DisplaySetDateTimeRun
9712. 
9713. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
9714. /* Xinclude "..\Display\BannerSet.MyDc"X */
9715. /* pause(1) */
9716. 
9717. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9718. 
9719. Title('!Heading!')
9720. /* pause(1) */
9721. 
9722. /* NOTE: Can't round or truncate to integer precision. */
9723. 
9724. pause(1)
9725. 
9726. 		# Script: ZoneDoFooter
9727. 
9728. /* ---------------------------------------------------------- */
9729. # File Select
9730. 	# Select Statments
9731. # File Actions 
9732. 	# Standard or OS File Actions.
9733. 	# Resume...
9734. 	
9735. 	# your stuff HERE (X)... post zone (file) file actions code.
9736. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
9737. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9738. 		# (X)
9739. 		
9740. 		/* ??? Set window? */
9741. 	
9742. 	# ADD THE GAP
9743. 		
9744. # Vacate (good for diagnostics)
9745. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
9746. 
9747. # DoNotVacate - DO NOT Vacate (recommended)
9748. 
9749. # Vacate
9750. /* AddGap(GapUsedLoc) */
9751. 
9752. # DO Not Vacate
9753. AddGap(GapUsedLoc, DoNotVacate) 
9754. 	
9755. 	
9756. /* ---------------------------------------------------------- */
9757. # (failed) TEST for boolean logic.
9758. 
9759. /* It should work in the gap calculations for turning options */
9760. /* on and off but it will NOT work here. */
9761. 
9762. /* Boolean setting X or FlagX. */
9763. /* Where X will be on or off: */
9764. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
9765. /*      For ON:  (X  *  FlagAny) */
9766. 
9767. /* 1) Failed, zero gap overrode the previous one. */
9768. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
9769. /* AddGap(GapUsedTemp) */ 
9770. 
9771. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
9772. /* AddGap(GapUsedTemp, DoNotVacate) */ 
9773. 
9774. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
9775. 
9776. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
9777. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
9778. /* AddGap(GapUsedTemp) */ 
9779. 
9780. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
9781. /* AddGap(GapUsedTemp, DoNotVacate) */ 
9782. 
9783. /* ---------------------------------------------------------- */
9784. 
9785. # Vacate
9786. /* AddGap(GapUsed) */
9787. 
9788. # DO NOT Vacate (recommended)
9789. /* AddGap(GapUsed, DoNotVacate) */ 
9790. 	
9791. 
9792. 		
9793. # 
9794. FileEnd
9795. /* ---------------------------------------------------------- */
9796. 
9797. # your stuff HERE (X)... post zone (file) code.
9798. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
9799. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
9800. 	# (X)
9801. 
9802. SetVariable(FileStepDescription,"Zone finished, reporting.")
9803. # Script: DisplaySetFileStep
9804. 
9805. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9806. 
9807. /* add message and move to a new line. */
9808. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9809. ")
9810. 
9811. /* display the line. (hopefully.) */
9812. # Zone Footer Set Statistics Window Text
9813. 
9814. SetStatisticsWindowText("----------------------------------------------------------
9815. Zones Processed: 
9816. ----------------------------------------------------------
9817. !ZoneListByLine!
9818. ----------------------------------------------------------
9819. Zone Processing Step:
9820. !ZoneStepByLine!    
9821. ----------------------------------------------------------
9822. Current Zone:
9823. !ZoneFooter!
9824. ----------------------------------------------------------
9825. Volume Statistics:
9826. !VolumeStatisticsDetail!
9827. ----------------------------------------------------------
9828. Zone Detailed Report:
9829. ----------------------------------------------------------
9830. !ZoneStatisticsDetail!
9831. ----------------------------------------------------------
9832. ")
9833. 
9834. 
9835. 
9836. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9837. 
9838. # Script: BannerSet
9839. 
9840. # Script: DisplaySetDateTimeRun
9841. 
9842. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
9843. /* Xinclude "..\Display\BannerSet.MyDc"X */
9844. /* pause(1) */
9845. 
9846. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9847. 
9848. Title('!Heading!')
9849. /* pause(1) */
9850. 
9851. /* NOTE: Can't round or truncate to integer precision. */
9852. 
9853. pause(1)
9854. 
9855. # Script: ZoneWhenFinished
9856. 
9857. # Script: BannerSet
9858. 
9859. # Script: DisplaySetDateTimeRun
9860. 
9861. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
9862. /* Xinclude "..\Display\BannerSet.MyDc"X */
9863. /* pause(1) */
9864. 
9865. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9866. 
9867. Title('!Heading!')
9868. /* pause(1) */
9869. 
9870. /* NOTE: Can't round or truncate to integer precision. */
9871. 
9872. # Script: BannerLog
9873. 
9874. AppendLogfile("!LogFileName!", "!Title!")
9875. 
9876. 
9877. 
9878. # Zone Statistics	
9879. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
9880. 
9881. # Footer:
9882. SetVariable(ZoneFooter, "----------------------------------------------------------
9883. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
9884. 
9885. Statistics Report:
9886. ------------------
9887.    Size:  
9888.    ------------------------
9889.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9890.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9891.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9892. 
9893.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9894.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9895. 
9896.    Location:
9897.    ------------------------
9898.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9899.              Files End: !ZoneEndCurrent!
9900.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9901.       
9902.    Gap Settings:
9903.    ------------------------
9904.          Gap Requested: !ZoneGapSizePer!%
9905.       Volume Rounding: !ZoneVolRoundUpPer!%
9906.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9907.                  
9908.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9909.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9910.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9911.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9912.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9913.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9914.      
9915.    Free Space after Zone:
9916.    ------------------------
9917.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9918.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9919.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9920. 
9921. Directory and Files Select:
9922. ---------------------------
9923. !ZoneTypeSelectCurrent!               
9924. ---------------------------
9925. ----------------------------------------------------------
9926. ")
9927. 
9928. AppendLogfile("!LogFileName!", ".")
9929. AppendLogfile("!LogFileName!", "!ZoneFooter!")
9930. AppendLogfile("!LogFileName!", ".")
9931. 
9932. # Zone Footer Set Statistics Window Text
9933. 
9934. SetStatisticsWindowText("----------------------------------------------------------
9935. Zones Processed: 
9936. ----------------------------------------------------------
9937. !ZoneListByLine!
9938. ----------------------------------------------------------
9939. Zone Processing Step:
9940. !ZoneStepByLine!    
9941. ----------------------------------------------------------
9942. Current Zone:
9943. !ZoneFooter!
9944. ----------------------------------------------------------
9945. Volume Statistics:
9946. !VolumeStatisticsDetail!
9947. ----------------------------------------------------------
9948. Zone Detailed Report:
9949. ----------------------------------------------------------
9950. !ZoneStatisticsDetail!
9951. ----------------------------------------------------------
9952. ")
9953. 
9954. 
9955. 
9956. /* pause() */
9957. /* pause() */
9958. 
9959. 
9960. 
9961. 	
9962. /* ---------------------------------------------------------- */
9963. # Zone Program Data.
9964. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsData!")
9965. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsData!")
9966. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
9967. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
9968. 	SetVariable(ZoneTypeSelect,'
9969.                 # Programs - Data files.
9970.                 not(
9971.                 # Os PageHiberDump start.
9972. (
9973.   FileName("DataStore.edb")
9974.   or FileName("DUMP*.*")
9975.   or FileName("Hiberfil.sys")
9976.   or FileName("MEMORY.DMP")
9977.   or FileName("Pagefile.sys")
9978. )
9979. # Os PageHiberDump end.
9980. 
9981.                 )
9982. ')
9983. 
9984. 		# Script: ZoneDoHeader
9985. 
9986. # Script: ZoneWhenStarted
9987. 
9988. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
9989. # Script: DisplaySetZone
9990. 
9991. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
9992. SetVariable(FileStepDescription,	"")
9993. 
9994. SetVariable(ZoneStepByLine, 			"Zone started.
9995. ")
9996. 
9997. # Script: BannerDescriptionSet
9998. 
9999. # Script: BannerSet
10000. 
10001. # Script: DisplaySetDateTimeRun
10002. 
10003. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
10004. /* Xinclude "..\Display\BannerSet.MyDc"X */
10005. /* pause(1) */
10006. 
10007. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10008. 
10009. Title('!Heading!')
10010. /* pause(1) */
10011. 
10012. /* NOTE: Can't round or truncate to integer precision. */
10013. 
10014. # Script: BannerLog
10015. 
10016. AppendLogfile("!LogFileName!", "!Title!")
10017. 
10018. 
10019. 
10020. pause(1)
10021. 
10022. 
10023. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
10024. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
10025. 
10026. SetVariable(ZoneStepNoCurrent, 0)
10027. 
10028. 
10029. # Script: ZoneDoCurrentClear
10030. 
10031. SetVariable(ZoneTypeSelectCurrent, 		"")
10032. 
10033. SetVariable(ZoneBeginCurrent, 			0)
10034. SetVariable(ZoneBeginPerCurrent, 		0)
10035. SetVariable(ZoneEndCurrent, 			0)
10036. SetVariable(ZoneEndPerCurrent, 			0)
10037. 
10038. SetVariable(ZoneSizeCurrent,			0)
10039. SetVariable(ZoneSizePerCurrent,			0)
10040. 
10041. SetVariable(ZoneGapRequestedCurrent,	0)
10042. SetVariable(ZoneGapRoundedCurrent, 		0)
10043. SetVariable(ZoneGapAdjustedCurrent, 	0)
10044. SetVariable(ZoneGapAvailableCurrent, 	0)
10045. SetVariable(ZoneGapCurrent,				0)
10046. SetVariable(ZoneGapUsedCurrent, 		0)
10047. 
10048. SetVariable(ZoneGapActualCurrent, 		0)
10049. SetVariable(ZoneGapActualPerCurrent, 	0)
10050. 
10051. SetVariable(ZoneSizeActual, 			0)
10052. SetVariable(ZoneSizeActualCurrent,		0)
10053. 
10054. SetVariable(ZoneEndActual, 				0)
10055. SetVariable(ZoneEndActualCurrent,		0)			
10056. SetVariable(ZoneSizeActualPerCurrent, 	0)
10057.       
10058. SetVariable(ZoneFilesFolders,			0)
10059. SetVariable(ZoneFilesFoldersPer,		0) 
10060. 
10061. SetVariable(ZoneFragments,				0)
10062. SetVariable(ZoneFragmentsPer,			0) 
10063. 		
10064. SetVariable(ZoneEndActualCurrent, 		0)
10065. SetVariable(ZoneEndActualPerCurrent, 	0)
10066. 
10067. # Gap Calculation Methodology:
10068. 	# Requested
10069. 	SetVariable(GapRequested, 			0) 
10070. 	SetVariable(GapRequestedStd, 		0) 
10071. 	SetVariable(GapRequestedMft, 		0) 
10072. 	SetVariable(GapRequestedOs, 		0) 
10073. 	SetVariable(GapRequestedOriginal, 	0) 
10074. 	
10075. 	# Gap Adjustments
10076. 	SetVariable(GapRounded, 			0)
10077. 	# SetVariable(GapAdjusted, 			0)
10078. 	SetVariable(GapAvailable, 			0)
10079. 	SetVariable(GapCurrent, 			0)
10080. 	SetVariable(GapActual, 				0)
10081. 	SetVariable(GapUsed, 				0)
10082. 	
10083. 	# Gap Adjustments
10084. 	SetVariable(GapRoundedLoc, 			0)
10085. 	# SetVariable(GapAdjustedLoc, 		0)
10086. 	SetVariable(GapAvailableLoc, 		0)
10087. 	SetVariable(GapCurrentLoc, 			0)
10088. 	SetVariable(GapActualLoc,			0)
10089. 	SetVariable(GapUsedLoc,				0)
10090. 	
10091. 	# Space usage
10092. 	SetVariable(ZoneFreePerRequested, 	0)
10093. 	SetVariable(ZoneFreePerUsed, 		0)
10094. 
10095. # Gap Size & Rounding
10096. 	SetVariable(ZoneGapSizePer, 		0)
10097. 	SetVariable(ZoneVolRoundUpPer, 		0)
10098. 	
10099. 	# Free Space
10100. 	SetVariable(ZoneFreeUsedPer, 		0)
10101. 	SetVariable(ZoneFreeRequestedPer, 	0)
10102. 
10103. 
10104. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
10105. 
10106. # Footer:
10107. SetVariable(ZoneFooter, "----------------------------------------------------------
10108. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
10109. 
10110. Statistics Report:
10111. ------------------
10112.    Size:  
10113.    ------------------------
10114.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10115.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10116.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10117. 
10118.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10119.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10120. 
10121.    Location:
10122.    ------------------------
10123.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10124.              Files End: !ZoneEndCurrent!
10125.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10126.       
10127.    Gap Settings:
10128.    ------------------------
10129.          Gap Requested: !ZoneGapSizePer!%
10130.       Volume Rounding: !ZoneVolRoundUpPer!%
10131.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10132.                  
10133.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
10134.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
10135.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
10136.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
10137.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
10138.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
10139.      
10140.    Free Space after Zone:
10141.    ------------------------
10142.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10143.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10144.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10145. 
10146. Directory and Files Select:
10147. ---------------------------
10148. !ZoneTypeSelectCurrent!               
10149. ---------------------------
10150. ----------------------------------------------------------
10151. ")
10152. 
10153. # Script: BannerSet
10154. 
10155. # Script: DisplaySetDateTimeRun
10156. 
10157. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
10158. /* Xinclude "..\Display\BannerSet.MyDc"X */
10159. /* pause(1) */
10160. 
10161. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10162. 
10163. Title('!Heading!')
10164. /* pause(1) */
10165. 
10166. /* NOTE: Can't round or truncate to integer precision. */
10167. 
10168. # Script: BannerLog
10169. 
10170. AppendLogfile("!LogFileName!", "!Title!")
10171. 
10172. 
10173. 
10174. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
10175. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
10176. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:50")
10177. 
10178. SetVariable(ZoneListByLine, "!ZoneListByLine!
10179. Zone: !ZoneNoCurrent! 2021-11-09 18:53:50 0:00:06 !ZoneLabel! !ZoneDescription!")
10180. 
10181. 
10182. /* Fixed Zone Position Handling */
10183. /* Literal number: */
10184. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
10185. /* Percentage of disk: */
10186. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
10187. /* Gap */
10188. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
10189. 
10190. /* ---------------------------------------------------------- */
10191. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
10192. # Script: DisplaySetFileStep
10193. 
10194. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10195. 
10196. /* add message and move to a new line. */
10197. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10198. ")
10199. 
10200. /* display the line. (hopefully.) */
10201. # Zone Footer Set Statistics Window Text
10202. 
10203. SetStatisticsWindowText("----------------------------------------------------------
10204. Zones Processed: 
10205. ----------------------------------------------------------
10206. !ZoneListByLine!
10207. ----------------------------------------------------------
10208. Zone Processing Step:
10209. !ZoneStepByLine!    
10210. ----------------------------------------------------------
10211. Current Zone:
10212. !ZoneFooter!
10213. ----------------------------------------------------------
10214. Volume Statistics:
10215. !VolumeStatisticsDetail!
10216. ----------------------------------------------------------
10217. Zone Detailed Report:
10218. ----------------------------------------------------------
10219. !ZoneStatisticsDetail!
10220. ----------------------------------------------------------
10221. ")
10222. 
10223. 
10224. 
10225. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10226. 
10227. # Script: BannerSet
10228. 
10229. # Script: DisplaySetDateTimeRun
10230. 
10231. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
10232. /* Xinclude "..\Display\BannerSet.MyDc"X */
10233. /* pause(1) */
10234. 
10235. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10236. 
10237. Title('!Heading!')
10238. /* pause(1) */
10239. 
10240. /* NOTE: Can't round or truncate to integer precision. */
10241. 
10242. pause(1)
10243. 
10244. # your stuff HERE (X)... pre file select code.
10245. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
10246. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
10247. 	# (X)
10248. 
10249. FileSelect
10250. 
10251. 	# your stuff can't really go here (errors.)
10252. 	# maybe for some reason I don't know of...
10253. 	
10254. 	# Actions next...
10255. 		# Script: ZoneDo ZoneTypeSelectOsPrograms
10256. # Programs start.
10257. # NotBlobsArchivesBu start.
10258. (not (
10259. # Blobs start.
10260. (
10261. # BlobsAndExceptions start.
10262. ( not(
10263.   FileName("*.bat")
10264.   or FileName("*.css")
10265.   or FileName("*.dll")
10266.   or FileName("*.exe")
10267.   or FileName("*.htm*")
10268.   or FileName("*.jar")
10269.   or FileName("*.js")
10270.   or FileName("*.script")
10271.   or FileName("*.wsf")
10272.   or (
10273. # Databases start.
10274. (
10275.   FileName("*.crypt*")
10276.   or FileName("*.db*")
10277.   or FileName("*.rdb*")
10278.   or FileName("*.dc*")
10279.   or FileName("*.dict*")
10280.   or FileName("*.?db*")
10281.   or FileName("*.?rdb*")
10282.   or FileName("*.md*")
10283.   or FileName("*.myd")
10284.   or FileName("*.ndf")
10285.   or FileName("*.ns?")
10286.   or FileName("*.pab")
10287.   or FileName("*.pst")
10288.   or FileName("*.sd?*")
10289.   or FileName("*.sq**")
10290.   or FileName("*.tmd")
10291.   or FileName("*.tps")
10292.   or FileName("*.tr*")
10293. )
10294. # Databases end.
10295. 
10296.     # BlobsAndExceptions
10297.     or 
10298. # Data start.
10299. (
10300.   DirectoryName("Data*")
10301.   or DirectoryName("Device*")
10302.   or DirectoryName("Export*")
10303.   or DirectoryName("Import*")
10304.   or DirectoryName("Log*")
10305.   or DirectoryName("*Log")
10306.   or DirectoryName("Maintenance*")
10307.   or DirectoryName("Rec*")
10308.   or DirectoryName("Sales*")
10309.   or DirectoryName("Search*")
10310.   or DirectoryName("User*")
10311. )
10312. # Data end.
10313. 
10314.     # BlobsAndExceptions
10315.   )
10316. ) )
10317. # BlobsAndExceptions end.
10318. 
10319. # Blobs
10320. ) and (
10321.   Size(BlobFileSize,0)
10322.   or (
10323.     FileName("*.arj")
10324.     or FileName("*.bup")
10325.     or FileName("*.bz2")
10326.     or FileName("*.chm")
10327.     or FileName("*.dvr-ms")
10328.     or FileName("*.gz")
10329.     or FileName("*.ifo")
10330.     or FileName("*.lzh")
10331.     or FileName("*.pdf")
10332.     or FileName("*.rpm")
10333.     or FileName("*.wmv")
10334.     or FileName("*.vob")
10335.     or FileName("*.z")
10336.   ) 
10337. )
10338. # Blobs end.
10339. 
10340. # NotBlobsArchivesBu
10341. or 
10342. # Archives start.
10343. (
10344.   DirectoryName("*Archive*")
10345.   or DirectoryName("*History*")
10346.   or DirectoryName("*Old")
10347.   or DirectoryName("* Old *")
10348.   or DirectoryName("Old *")
10349. 
10350.   or FileName("*.7z")
10351.   or FileName("*.cab")
10352.   or FileName("*.iso")
10353.   or FileName("*.msi")
10354.   or FileName("*.old")
10355.   or FileName("*.rar")
10356.   or FileName("*.tar")
10357.   or FileName("*.zip")
10358.   or
10359. # WinSysLow start.
10360. (
10361.   DirectoryName("$*")
10362.   or DirectoryName("0*")
10363.   or DirectoryName("1*")
10364.   or DirectoryName("2*")
10365.   or DirectoryName("3*")
10366.   or DirectoryName("4*")
10367.   or DirectoryName("5*")
10368.   or DirectoryName("6*")
10369.   or DirectoryName("7*")
10370.   or DirectoryName("8*")
10371.   or DirectoryName("9*")
10372. 
10373.   or DirectoryName("dllcache")
10374.   or DirectoryName("Downloaded Installations")
10375.   or DirectoryName("Ehome")
10376.   or DirectoryName("Fonts")
10377.   or DirectoryName("Help")
10378.   or DirectoryName("I386")
10379.   or DirectoryName("ie?updates")
10380.   or DirectoryName("Installer")
10381.   or DirectoryName("Installshield Installation Information")
10382.   or DirectoryName("IME")
10383.   or DirectoryName("*RECYCLE*")
10384.   or DirectoryName("ServicePackFiles")
10385.   or DirectoryName("SoftwareDistribution")
10386.   or DirectoryName("Speech")
10387.   or DirectoryName("Symbols")
10388.   or DirectoryName("System Volume Information")
10389.   or DirectoryName("windows.old")
10390. )
10391. # WinSysLow end.
10392. 
10393.   # Archives
10394. )
10395. # Archives end.
10396. 
10397. # NotBlobsArchivesBu
10398. or
10399. # Backups start.
10400. (
10401.   DirectoryName("*Backup*")
10402.   or DirectoryName("*Bu")
10403.   or DirectoryName("* Bu *")
10404.   or DirectoryName("Bu *")
10405. 
10406.   or FileName("*.bak")
10407.   or FileName("* - Copy*")
10408. )
10409. # Backups end.
10410. 
10411. # NotBlobsArchivesBu
10412. ) )
10413. # NotBlobsArchivesBu end.
10414. 
10415. # Programs
10416. and (
10417. # SystemDir start.
10418. (
10419.   DirectoryName("Boot*")
10420.   or DirectoryName("Device*")
10421.   or DirectoryName("DevSupport*")
10422.   or DirectoryName("Program*")
10423.   or DirectoryName("Security*")
10424.   or DirectoryName("SendTo*")
10425.   or DirectoryName("Sw*")
10426.   or DirectoryName("System*")
10427.   or DirectoryName("Toolbars")
10428.   or DirectoryName("Windows*")
10429. )
10430. # SystemDir end.
10431. 
10432. # Programs
10433. )
10434. # Programs end.
10435. 
10436. 		and not(
10437. 			# Os PageHiberDump start.
10438. (
10439.   FileName("DataStore.edb")
10440.   or FileName("DUMP*.*")
10441.   or FileName("Hiberfil.sys")
10442.   or FileName("MEMORY.DMP")
10443.   or FileName("Pagefile.sys")
10444. )
10445. # Os PageHiberDump end.
10446. 
10447. 		)
10448. 
10449. 		FileActions
10450. 		  		/* ---------------------------------------------------------- */
10451. 	# Gap
10452. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
10453. 		# Script: DisplaySetFileStep
10454. 
10455. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10456. 
10457. /* add message and move to a new line. */
10458. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10459. ")
10460. 
10461. /* display the line. (hopefully.) */
10462. # Zone Footer Set Statistics Window Text
10463. 
10464. SetStatisticsWindowText("----------------------------------------------------------
10465. Zones Processed: 
10466. ----------------------------------------------------------
10467. !ZoneListByLine!
10468. ----------------------------------------------------------
10469. Zone Processing Step:
10470. !ZoneStepByLine!    
10471. ----------------------------------------------------------
10472. Current Zone:
10473. !ZoneFooter!
10474. ----------------------------------------------------------
10475. Volume Statistics:
10476. !VolumeStatisticsDetail!
10477. ----------------------------------------------------------
10478. Zone Detailed Report:
10479. ----------------------------------------------------------
10480. !ZoneStatisticsDetail!
10481. ----------------------------------------------------------
10482. ")
10483. 
10484. 
10485. 
10486. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10487. 
10488. # Script: BannerSet
10489. 
10490. # Script: DisplaySetDateTimeRun
10491. 
10492. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
10493. /* Xinclude "..\Display\BannerSet.MyDc"X */
10494. /* pause(1) */
10495. 
10496. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10497. 
10498. Title('!Heading!')
10499. /* pause(1) */
10500. 
10501. /* NOTE: Can't round or truncate to integer precision. */
10502. 
10503. pause(1)
10504. 	
10505. 	# ACTUAL GAP
10506. 		/* AddGap Variant. */
10507. 	  	# Zone Do Gap
10508. # Gap Calculation Methods:
10509. 
10510. /* 1) Anything you need to add first. */
10511. /* empty */
10512. 
10513. /* ---------------------------------------------------------- */
10514. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
10515. 	# GapRequestedStd.
10516. 
10517. 		/* ---------------------------------------------------------- */
10518. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
10519. 
10520. 		# Gap Calculation Methods:
10521. 
10522. /* AddGap Variants */
10523. 
10524. 	/* Standard */
10525. 		# Gap Calculation Methods:
10526. 	/* AddGap Variants */
10527. 	/* Standard */
10528. 
10529. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
10530. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
10531. 
10532. 	SetVariable(GapRequested, GapRequestedStd)
10533. 	
10534. 
10535. 	/* MFT Low High Method */
10536. 		# Gap Calculation Methods:
10537. 	/* AddGap Variants */
10538. 	/* MFT Low High Method */
10539. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
10540. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
10541. 	SetVariable(GapRequested, GapRequestedMft)
10542. 	
10543. 
10544. 	/* OS Volume Type Method */
10545. 		# Gap Calculation Methods:
10546. 	/* AddGap Variants */
10547. 	/* OS Volume Type Method */
10548. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
10549. 	SetVariable(GapRequested, GapRequestedOs)
10550. 
10551. 
10552. 
10553. /* MakeGap Variants */
10554. 
10555. 	/* Original Os 1-3 + MFT 2 */
10556. 		# Gap Calculation Methods:
10557. 	/* MakeGap Variants */
10558. 	/* Original Os 1-3 + MFT 2 */
10559. 	/* plus MFT gap placed inline at the dividing zone. */
10560. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
10561. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
10562. 	SetVariable(GapRequested, GapRequestedOrig)
10563. 	
10564. 	
10565. /* Note: You could comment out the ones not in use */
10566. /* However having the data in the log is useful. */
10567. /* Therefore the following line is otherwise needed. */
10568. 
10569. /* Standard used */
10570. 
10571. SetVariable(GapRequested, GapRequestedStd)
10572. 
10573. # Gap Calculation Methods:
10574. 
10575. /* AddGap Variants */
10576. 	/* Standard */
10577. 	/* MFT Low High Method */
10578. 	/* OS Volume Type Method */
10579. 
10580. /* MakeGap Variants */
10581. 	/* Original Os 1-3 + MFT 2 */
10582. 
10583. /* Note: You could comment out the ones not in use */
10584. /* However having the data in the log is useful. */
10585. /* Therefore the following line is otherwise needed. */
10586. 
10587. /* Standard is used currently */
10588. 
10589. 
10590. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
10591. 
10592. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
10593. 
10594. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
10595. 
10596. /* ---------------------------------------------------------- */
10597. /* 3) SMALL ZONE ADJUSTMENT. */
10598. /* Gab cant be larger than half the Zone Size. */
10599. 
10600. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
10601. 	
10602. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
10603. 
10604. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
10605. 
10606. /* ---------------------------------------------------------- */
10607. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
10608. # Gap Adjustments.
10609. 
10610. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
10611. 	
10612. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
10613. 
10614. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
10615. 
10616. /* ---------------------------------------------------------- */
10617. # BYPASS THIS.
10618. 	/* This is definitely wrong. */
10619. 	/* The question is can we steal gap from the next zone */
10620. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
10621. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
10622. 		# Zone Overflow.
10623. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
10624. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
10625. 
10626. /* ---------------------------------------------------------- */
10627. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
10628. # Remaining free space available.
10629. 
10630. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
10631. 	
10632. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
10633. 
10634. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
10635. 
10636. /* ---------------------------------------------------------- */
10637. # CURRENT gap to use.
10638. 
10639. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
10640. 
10641. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
10642. 
10643. /* ---------------------------------------------------------- */
10644. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
10645. # Debugging.
10646. 
10647. 	SetVariable(GapUsed, GapCurrent) // for debugging
10648. 
10649. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
10650. 
10651. 		# Your code HERE
10652. 
10653. /* ---------------------------------------------------------- */
10654. /* 7) YOUR CODE. */
10655. # YOUR CODE HERE:
10656. 	# INPUT: GapCurrent or GapCurrentLoc
10657. 	# OUTPUT: GapUsed...
10658. 
10659. /* ---------------------------------------------------------- */
10660. # Gap Size.
10661. # Actual Size of Gap.
10662. 
10663. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
10664. 
10665. /* ---------------------------------------------------------- */
10666. /* xxxxxxxxxxxxxxxxxxxxxx */
10667. # ADD THE GAP
10668. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
10669. /* xxxxxxxxxxxxxxxxxxxxxx */
10670. 
10671. 	
10672. 	# Zone Statistics	
10673. 	# Script: ZoneDoStatistics
10674. # Zone / Volume Statistics and Display
10675. 		
10676. 	# Accumulate Totals
10677.   	# Script: ZoneDoVolumeTotals
10678. 
10679. /* Current total space used (by Zones and Gaps) */
10680. 
10681. SetVariable(VolumeZoneUsed, GapUsed)
10682. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
10683. /* Percentage */
10684. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
10685. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
10686. 
10687. /* Current total of free space requested */
10688. 
10689. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
10690. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10691. /* Percent. */
10692. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
10693. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10694. 
10695. /* Current total of free space used */
10696. 
10697. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
10698. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
10699. /* Percent */
10700. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
10701. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
10702. 
10703. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
10704. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
10705. /* Xinclude "..\DebugDisplayPause.MyDc"X */
10706. 
10707. 
10708. 	# Current Values
10709. 	# Script: ZoneDoCurrentSet
10710. 
10711. # Cluster, Sector, Block adjust for display.
10712. 	# Bytes per cluster is volume specific.
10713. 
10714. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
10715. 
10716. # Current Zone values.
10717. 	# Begin, end and size.
10718. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
10719. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
10720. 
10721. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
10722. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
10723. 
10724. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
10725. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
10726. 
10727. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
10728. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
10729. 
10730. 	SetVariable(ZoneFragments,				"!ZONE210N!")
10731. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
10732. 		
10733. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
10734. /* identical code to here: (separation not needed. TEST.) */	
10735. 
10736. # Current Gap, Actual and Free Values
10737. 	# Gap
10738. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
10739. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
10740. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
10741. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
10742. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
10743. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
10744. 	
10745. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
10746. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
10747. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
10748. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
10749. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
10750. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
10751. 	
10752. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
10753. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
10754. 	
10755. 	# Actual Size and End
10756. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
10757. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
10758. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
10759. 	
10760. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
10761. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
10762. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
10763. 
10764. # Gap Size & Rounding
10765. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
10766. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
10767. 	
10768. 	# Free Space
10769. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
10770. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
10771. 
10772. 	# Footer:
10773. SetVariable(ZoneFooter, "----------------------------------------------------------
10774. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
10775. 
10776. Statistics Report:
10777. ------------------
10778.    Size:  
10779.    ------------------------
10780.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10781.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10782.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10783. 
10784.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10785.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10786. 
10787.    Location:
10788.    ------------------------
10789.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10790.              Files End: !ZoneEndCurrent!
10791.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10792.       
10793.    Gap Settings:
10794.    ------------------------
10795.          Gap Requested: !ZoneGapSizePer!%
10796.       Volume Rounding: !ZoneVolRoundUpPer!%
10797.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10798.                  
10799.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
10800.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
10801.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
10802.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
10803.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
10804.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
10805.      
10806.    Free Space after Zone:
10807.    ------------------------
10808.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10809.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10810.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10811. 
10812. Directory and Files Select:
10813. ---------------------------
10814. !ZoneTypeSelectCurrent!               
10815. ---------------------------
10816. ----------------------------------------------------------
10817. ")
10818. 	# Zone Footer Set Statistics Window Text
10819. 
10820. SetStatisticsWindowText("----------------------------------------------------------
10821. Zones Processed: 
10822. ----------------------------------------------------------
10823. !ZoneListByLine!
10824. ----------------------------------------------------------
10825. Zone Processing Step:
10826. !ZoneStepByLine!    
10827. ----------------------------------------------------------
10828. Current Zone:
10829. !ZoneFooter!
10830. ----------------------------------------------------------
10831. Volume Statistics:
10832. !VolumeStatisticsDetail!
10833. ----------------------------------------------------------
10834. Zone Detailed Report:
10835. ----------------------------------------------------------
10836. !ZoneStatisticsDetail!
10837. ----------------------------------------------------------
10838. ")
10839. 
10840. 
10841. 	
10842.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
10843. 
10844. 	# Add Zone to list of zones for display.
10845. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
10846. 	# ??? Free Stats?
10847. 	# Footer:
10848. SetVariable(ZoneFooter, "----------------------------------------------------------
10849. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
10850. 
10851. Statistics Report:
10852. ------------------
10853.    Size:  
10854.    ------------------------
10855.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10856.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10857.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10858. 
10859.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10860.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10861. 
10862.    Location:
10863.    ------------------------
10864.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10865.              Files End: !ZoneEndCurrent!
10866.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10867.       
10868.    Gap Settings:
10869.    ------------------------
10870.          Gap Requested: !ZoneGapSizePer!%
10871.       Volume Rounding: !ZoneVolRoundUpPer!%
10872.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10873.                  
10874.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
10875.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
10876.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
10877.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
10878.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
10879.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
10880.      
10881.    Free Space after Zone:
10882.    ------------------------
10883.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10884.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10885.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10886. 
10887. Directory and Files Select:
10888. ---------------------------
10889. !ZoneTypeSelectCurrent!               
10890. ---------------------------
10891. ----------------------------------------------------------
10892. ")
10893. 
10894. 	# Add Zone Details to Report.	
10895. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
10896. !ZoneFooter!")
10897. 
10898. 
10899. 	
10900. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
10901. 			# Script: DisplaySetFileStep
10902. 
10903. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10904. 
10905. /* add message and move to a new line. */
10906. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10907. ")
10908. 
10909. /* display the line. (hopefully.) */
10910. # Zone Footer Set Statistics Window Text
10911. 
10912. SetStatisticsWindowText("----------------------------------------------------------
10913. Zones Processed: 
10914. ----------------------------------------------------------
10915. !ZoneListByLine!
10916. ----------------------------------------------------------
10917. Zone Processing Step:
10918. !ZoneStepByLine!    
10919. ----------------------------------------------------------
10920. Current Zone:
10921. !ZoneFooter!
10922. ----------------------------------------------------------
10923. Volume Statistics:
10924. !VolumeStatisticsDetail!
10925. ----------------------------------------------------------
10926. Zone Detailed Report:
10927. ----------------------------------------------------------
10928. !ZoneStatisticsDetail!
10929. ----------------------------------------------------------
10930. ")
10931. 
10932. 
10933. 
10934. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10935. 
10936. # Script: BannerSet
10937. 
10938. # Script: DisplaySetDateTimeRun
10939. 
10940. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
10941. /* Xinclude "..\Display\BannerSet.MyDc"X */
10942. /* pause(1) */
10943. 
10944. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10945. 
10946. Title('!Heading!')
10947. /* pause(1) */
10948. 
10949. /* NOTE: Can't round or truncate to integer precision. */
10950. 
10951. pause(1)
10952. 
10953. 			# File Action - Type Os Programs - Fast - MoveUpToZone.
10954. # File Action - SortByImportSequence with SkipBlock.
10955. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
10956. 	
10957. 	
10958. 	
10959. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
10960. 			# Script: DisplaySetFileStep
10961. 
10962. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10963. 
10964. /* add message and move to a new line. */
10965. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10966. ")
10967. 
10968. /* display the line. (hopefully.) */
10969. # Zone Footer Set Statistics Window Text
10970. 
10971. SetStatisticsWindowText("----------------------------------------------------------
10972. Zones Processed: 
10973. ----------------------------------------------------------
10974. !ZoneListByLine!
10975. ----------------------------------------------------------
10976. Zone Processing Step:
10977. !ZoneStepByLine!    
10978. ----------------------------------------------------------
10979. Current Zone:
10980. !ZoneFooter!
10981. ----------------------------------------------------------
10982. Volume Statistics:
10983. !VolumeStatisticsDetail!
10984. ----------------------------------------------------------
10985. Zone Detailed Report:
10986. ----------------------------------------------------------
10987. !ZoneStatisticsDetail!
10988. ----------------------------------------------------------
10989. ")
10990. 
10991. 
10992. 
10993. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10994. 
10995. # Script: BannerSet
10996. 
10997. # Script: DisplaySetDateTimeRun
10998. 
10999. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
11000. /* Xinclude "..\Display\BannerSet.MyDc"X */
11001. /* pause(1) */
11002. 
11003. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11004. 
11005. Title('!Heading!')
11006. /* pause(1) */
11007. 
11008. /* NOTE: Can't round or truncate to integer precision. */
11009. 
11010. pause(1)
11011. 
11012. 		# Script: ZoneDoFooter
11013. 
11014. /* ---------------------------------------------------------- */
11015. # File Select
11016. 	# Select Statments
11017. # File Actions 
11018. 	# Standard or OS File Actions.
11019. 	# Resume...
11020. 	
11021. 	# your stuff HERE (X)... post zone (file) file actions code.
11022. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
11023. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
11024. 		# (X)
11025. 		
11026. 		/* ??? Set window? */
11027. 	
11028. 	# ADD THE GAP
11029. 		
11030. # Vacate (good for diagnostics)
11031. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
11032. 
11033. # DoNotVacate - DO NOT Vacate (recommended)
11034. 
11035. # Vacate
11036. /* AddGap(GapUsedLoc) */
11037. 
11038. # DO Not Vacate
11039. AddGap(GapUsedLoc, DoNotVacate) 
11040. 	
11041. 	
11042. /* ---------------------------------------------------------- */
11043. # (failed) TEST for boolean logic.
11044. 
11045. /* It should work in the gap calculations for turning options */
11046. /* on and off but it will NOT work here. */
11047. 
11048. /* Boolean setting X or FlagX. */
11049. /* Where X will be on or off: */
11050. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
11051. /*      For ON:  (X  *  FlagAny) */
11052. 
11053. /* 1) Failed, zero gap overrode the previous one. */
11054. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
11055. /* AddGap(GapUsedTemp) */ 
11056. 
11057. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
11058. /* AddGap(GapUsedTemp, DoNotVacate) */ 
11059. 
11060. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
11061. 
11062. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
11063. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
11064. /* AddGap(GapUsedTemp) */ 
11065. 
11066. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
11067. /* AddGap(GapUsedTemp, DoNotVacate) */ 
11068. 
11069. /* ---------------------------------------------------------- */
11070. 
11071. # Vacate
11072. /* AddGap(GapUsed) */
11073. 
11074. # DO NOT Vacate (recommended)
11075. /* AddGap(GapUsed, DoNotVacate) */ 
11076. 	
11077. 
11078. 		
11079. # 
11080. FileEnd
11081. /* ---------------------------------------------------------- */
11082. 
11083. # your stuff HERE (X)... post zone (file) code.
11084. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
11085. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
11086. 	# (X)
11087. 
11088. SetVariable(FileStepDescription,"Zone finished, reporting.")
11089. # Script: DisplaySetFileStep
11090. 
11091. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11092. 
11093. /* add message and move to a new line. */
11094. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11095. ")
11096. 
11097. /* display the line. (hopefully.) */
11098. # Zone Footer Set Statistics Window Text
11099. 
11100. SetStatisticsWindowText("----------------------------------------------------------
11101. Zones Processed: 
11102. ----------------------------------------------------------
11103. !ZoneListByLine!
11104. ----------------------------------------------------------
11105. Zone Processing Step:
11106. !ZoneStepByLine!    
11107. ----------------------------------------------------------
11108. Current Zone:
11109. !ZoneFooter!
11110. ----------------------------------------------------------
11111. Volume Statistics:
11112. !VolumeStatisticsDetail!
11113. ----------------------------------------------------------
11114. Zone Detailed Report:
11115. ----------------------------------------------------------
11116. !ZoneStatisticsDetail!
11117. ----------------------------------------------------------
11118. ")
11119. 
11120. 
11121. 
11122. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11123. 
11124. # Script: BannerSet
11125. 
11126. # Script: DisplaySetDateTimeRun
11127. 
11128. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
11129. /* Xinclude "..\Display\BannerSet.MyDc"X */
11130. /* pause(1) */
11131. 
11132. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11133. 
11134. Title('!Heading!')
11135. /* pause(1) */
11136. 
11137. /* NOTE: Can't round or truncate to integer precision. */
11138. 
11139. pause(1)
11140. 
11141. # Script: ZoneWhenFinished
11142. 
11143. # Script: BannerSet
11144. 
11145. # Script: DisplaySetDateTimeRun
11146. 
11147. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
11148. /* Xinclude "..\Display\BannerSet.MyDc"X */
11149. /* pause(1) */
11150. 
11151. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11152. 
11153. Title('!Heading!')
11154. /* pause(1) */
11155. 
11156. /* NOTE: Can't round or truncate to integer precision. */
11157. 
11158. # Script: BannerLog
11159. 
11160. AppendLogfile("!LogFileName!", "!Title!")
11161. 
11162. 
11163. 
11164. # Zone Statistics	
11165. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
11166. 
11167. # Footer:
11168. SetVariable(ZoneFooter, "----------------------------------------------------------
11169. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
11170. 
11171. Statistics Report:
11172. ------------------
11173.    Size:  
11174.    ------------------------
11175.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11176.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11177.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11178. 
11179.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11180.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11181. 
11182.    Location:
11183.    ------------------------
11184.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11185.              Files End: !ZoneEndCurrent!
11186.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11187.       
11188.    Gap Settings:
11189.    ------------------------
11190.          Gap Requested: !ZoneGapSizePer!%
11191.       Volume Rounding: !ZoneVolRoundUpPer!%
11192.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11193.                  
11194.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
11195.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
11196.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
11197.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
11198.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
11199.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
11200.      
11201.    Free Space after Zone:
11202.    ------------------------
11203.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11204.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11205.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11206. 
11207. Directory and Files Select:
11208. ---------------------------
11209. !ZoneTypeSelectCurrent!               
11210. ---------------------------
11211. ----------------------------------------------------------
11212. ")
11213. 
11214. AppendLogfile("!LogFileName!", ".")
11215. AppendLogfile("!LogFileName!", "!ZoneFooter!")
11216. AppendLogfile("!LogFileName!", ".")
11217. 
11218. # Zone Footer Set Statistics Window Text
11219. 
11220. SetStatisticsWindowText("----------------------------------------------------------
11221. Zones Processed: 
11222. ----------------------------------------------------------
11223. !ZoneListByLine!
11224. ----------------------------------------------------------
11225. Zone Processing Step:
11226. !ZoneStepByLine!    
11227. ----------------------------------------------------------
11228. Current Zone:
11229. !ZoneFooter!
11230. ----------------------------------------------------------
11231. Volume Statistics:
11232. !VolumeStatisticsDetail!
11233. ----------------------------------------------------------
11234. Zone Detailed Report:
11235. ----------------------------------------------------------
11236. !ZoneStatisticsDetail!
11237. ----------------------------------------------------------
11238. ")
11239. 
11240. 
11241. 
11242. /* pause() */
11243. /* pause() */
11244. 
11245. 
11246. 
11247. 	
11248. /* ---------------------------------------------------------- */
11249. 
11250. 
11251. /* ---------------------------------------------------------- */
11252. /* OLD: ToDo */
11253. 	/* Zone 1 and 2 originally */
11254. 	/* Originally the MFT and DIRs were processed first. */
11255. 	/* Zone 4 and 5 normally */
11256. 	/* The MakeGap call is put between which ever zones you want */
11257. 	/* So the actual zone number is unknown */
11258. 	/* SetVariable(ZoneCurrent,"4, 5") */
11259. 	/* MakeGap(RoundUp(VolumeUsed * (!MftPer! + 0.15), VolumeSize * ZoneVolRoundUpLarge), DoNotVacate) */
11260. 
11261. /* ---------------------------------------------------------- */
11262. SetVariable(FileStepDescription,"System Zones completed.")
11263. # Script: DisplaySetFileStep
11264. 
11265. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11266. 
11267. /* add message and move to a new line. */
11268. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11269. ")
11270. 
11271. /* display the line. (hopefully.) */
11272. # Zone Footer Set Statistics Window Text
11273. 
11274. SetStatisticsWindowText("----------------------------------------------------------
11275. Zones Processed: 
11276. ----------------------------------------------------------
11277. !ZoneListByLine!
11278. ----------------------------------------------------------
11279. Zone Processing Step:
11280. !ZoneStepByLine!    
11281. ----------------------------------------------------------
11282. Current Zone:
11283. !ZoneFooter!
11284. ----------------------------------------------------------
11285. Volume Statistics:
11286. !VolumeStatisticsDetail!
11287. ----------------------------------------------------------
11288. Zone Detailed Report:
11289. ----------------------------------------------------------
11290. !ZoneStatisticsDetail!
11291. ----------------------------------------------------------
11292. ")
11293. 
11294. 
11295. 
11296. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11297. 
11298. # Script: BannerSet
11299. 
11300. # Script: DisplaySetDateTimeRun
11301. 
11302. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
11303. /* Xinclude "..\Display\BannerSet.MyDc"X */
11304. /* pause(1) */
11305. 
11306. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11307. 
11308. Title('!Heading!')
11309. /* pause(1) */
11310. 
11311. /* NOTE: Can't round or truncate to integer precision. */
11312. 
11313. pause(1)
11314. 
11315. 
11316. /* ---------------------------------------------------------- */
11317. /* Any Volume Regular Zones */
11318. /* ---------------------------------------------------------- */
11319. 
11320. /* ---------------------------------------------------------- */
11321. /* Zone IdeScripts Ide, Scripts, Support */
11322. # Script: DefragZoneTypeIdeScripts
11323. /* ---------------------------------------------------------- */
11324. /* Zone IdeScripts Ide, Scripts, Support */
11325. 
11326. SetVariable(ZoneLabel, "!ZoneLabelIdeScripts!")
11327. SetVariable(ZoneDescription, "!ZoneDescriptionIdeScripts!")
11328. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpIdeScripts!")
11329. SetVariable(ZoneGapSize, "!ZoneGapSizeIdeScripts!")
11330. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectIdeScripts
11331. # IdeScripts start.
11332. # NotBlobsArchivesBu start.
11333. (not (
11334. # Blobs start.
11335. (
11336. # BlobsAndExceptions start.
11337. ( not(
11338.   FileName("*.bat")
11339.   or FileName("*.css")
11340.   or FileName("*.dll")
11341.   or FileName("*.exe")
11342.   or FileName("*.htm*")
11343.   or FileName("*.jar")
11344.   or FileName("*.js")
11345.   or FileName("*.script")
11346.   or FileName("*.wsf")
11347.   or (
11348. # Databases start.
11349. (
11350.   FileName("*.crypt*")
11351.   or FileName("*.db*")
11352.   or FileName("*.rdb*")
11353.   or FileName("*.dc*")
11354.   or FileName("*.dict*")
11355.   or FileName("*.?db*")
11356.   or FileName("*.?rdb*")
11357.   or FileName("*.md*")
11358.   or FileName("*.myd")
11359.   or FileName("*.ndf")
11360.   or FileName("*.ns?")
11361.   or FileName("*.pab")
11362.   or FileName("*.pst")
11363.   or FileName("*.sd?*")
11364.   or FileName("*.sq**")
11365.   or FileName("*.tmd")
11366.   or FileName("*.tps")
11367.   or FileName("*.tr*")
11368. )
11369. # Databases end.
11370. 
11371.     # BlobsAndExceptions
11372.     or 
11373. # Data start.
11374. (
11375.   DirectoryName("Data*")
11376.   or DirectoryName("Device*")
11377.   or DirectoryName("Export*")
11378.   or DirectoryName("Import*")
11379.   or DirectoryName("Log*")
11380.   or DirectoryName("*Log")
11381.   or DirectoryName("Maintenance*")
11382.   or DirectoryName("Rec*")
11383.   or DirectoryName("Sales*")
11384.   or DirectoryName("Search*")
11385.   or DirectoryName("User*")
11386. )
11387. # Data end.
11388. 
11389.     # BlobsAndExceptions
11390.   )
11391. ) )
11392. # BlobsAndExceptions end.
11393. 
11394. # Blobs
11395. ) and (
11396.   Size(BlobFileSize,0)
11397.   or (
11398.     FileName("*.arj")
11399.     or FileName("*.bup")
11400.     or FileName("*.bz2")
11401.     or FileName("*.chm")
11402.     or FileName("*.dvr-ms")
11403.     or FileName("*.gz")
11404.     or FileName("*.ifo")
11405.     or FileName("*.lzh")
11406.     or FileName("*.pdf")
11407.     or FileName("*.rpm")
11408.     or FileName("*.wmv")
11409.     or FileName("*.vob")
11410.     or FileName("*.z")
11411.   ) 
11412. )
11413. # Blobs end.
11414. 
11415. # NotBlobsArchivesBu
11416. or 
11417. # Archives start.
11418. (
11419.   DirectoryName("*Archive*")
11420.   or DirectoryName("*History*")
11421.   or DirectoryName("*Old")
11422.   or DirectoryName("* Old *")
11423.   or DirectoryName("Old *")
11424. 
11425.   or FileName("*.7z")
11426.   or FileName("*.cab")
11427.   or FileName("*.iso")
11428.   or FileName("*.msi")
11429.   or FileName("*.old")
11430.   or FileName("*.rar")
11431.   or FileName("*.tar")
11432.   or FileName("*.zip")
11433.   or
11434. # WinSysLow start.
11435. (
11436.   DirectoryName("$*")
11437.   or DirectoryName("0*")
11438.   or DirectoryName("1*")
11439.   or DirectoryName("2*")
11440.   or DirectoryName("3*")
11441.   or DirectoryName("4*")
11442.   or DirectoryName("5*")
11443.   or DirectoryName("6*")
11444.   or DirectoryName("7*")
11445.   or DirectoryName("8*")
11446.   or DirectoryName("9*")
11447. 
11448.   or DirectoryName("dllcache")
11449.   or DirectoryName("Downloaded Installations")
11450.   or DirectoryName("Ehome")
11451.   or DirectoryName("Fonts")
11452.   or DirectoryName("Help")
11453.   or DirectoryName("I386")
11454.   or DirectoryName("ie?updates")
11455.   or DirectoryName("Installer")
11456.   or DirectoryName("Installshield Installation Information")
11457.   or DirectoryName("IME")
11458.   or DirectoryName("*RECYCLE*")
11459.   or DirectoryName("ServicePackFiles")
11460.   or DirectoryName("SoftwareDistribution")
11461.   or DirectoryName("Speech")
11462.   or DirectoryName("Symbols")
11463.   or DirectoryName("System Volume Information")
11464.   or DirectoryName("windows.old")
11465. )
11466. # WinSysLow end.
11467. 
11468.   # Archives
11469. )
11470. # Archives end.
11471. 
11472. # NotBlobsArchivesBu
11473. or
11474. # Backups start.
11475. (
11476.   DirectoryName("*Backup*")
11477.   or DirectoryName("*Bu")
11478.   or DirectoryName("* Bu *")
11479.   or DirectoryName("Bu *")
11480. 
11481.   or FileName("*.bak")
11482.   or FileName("* - Copy*")
11483. )
11484. # Backups end.
11485. 
11486. # NotBlobsArchivesBu
11487. ) )
11488. # NotBlobsArchivesBu end.
11489. 
11490. # IdeScripts
11491. and ( 
11492. # Ide start.
11493. (
11494.     DirectoryName("Ide*")
11495.     or DirectoryName("Java*")
11496.     or DirectoryName("Os")
11497. )
11498. # Ide end.
11499. 
11500. # IdeScripts
11501. or  
11502. # Scripts start.
11503. (
11504.   DirectoryName("*Script*")
11505. )
11506. # Scripts end.
11507. 
11508. # IdeScripts
11509. )
11510. # IdeScripts end.
11511. ')
11512. 
11513. 	# Script: ZoneDoHeader
11514. 
11515. # Script: ZoneWhenStarted
11516. 
11517. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
11518. # Script: DisplaySetZone
11519. 
11520. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
11521. SetVariable(FileStepDescription,	"")
11522. 
11523. SetVariable(ZoneStepByLine, 			"Zone started.
11524. ")
11525. 
11526. # Script: BannerDescriptionSet
11527. 
11528. # Script: BannerSet
11529. 
11530. # Script: DisplaySetDateTimeRun
11531. 
11532. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
11533. /* Xinclude "..\Display\BannerSet.MyDc"X */
11534. /* pause(1) */
11535. 
11536. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11537. 
11538. Title('!Heading!')
11539. /* pause(1) */
11540. 
11541. /* NOTE: Can't round or truncate to integer precision. */
11542. 
11543. # Script: BannerLog
11544. 
11545. AppendLogfile("!LogFileName!", "!Title!")
11546. 
11547. 
11548. 
11549. pause(1)
11550. 
11551. 
11552. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
11553. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
11554. 
11555. SetVariable(ZoneStepNoCurrent, 0)
11556. 
11557. 
11558. # Script: ZoneDoCurrentClear
11559. 
11560. SetVariable(ZoneTypeSelectCurrent, 		"")
11561. 
11562. SetVariable(ZoneBeginCurrent, 			0)
11563. SetVariable(ZoneBeginPerCurrent, 		0)
11564. SetVariable(ZoneEndCurrent, 			0)
11565. SetVariable(ZoneEndPerCurrent, 			0)
11566. 
11567. SetVariable(ZoneSizeCurrent,			0)
11568. SetVariable(ZoneSizePerCurrent,			0)
11569. 
11570. SetVariable(ZoneGapRequestedCurrent,	0)
11571. SetVariable(ZoneGapRoundedCurrent, 		0)
11572. SetVariable(ZoneGapAdjustedCurrent, 	0)
11573. SetVariable(ZoneGapAvailableCurrent, 	0)
11574. SetVariable(ZoneGapCurrent,				0)
11575. SetVariable(ZoneGapUsedCurrent, 		0)
11576. 
11577. SetVariable(ZoneGapActualCurrent, 		0)
11578. SetVariable(ZoneGapActualPerCurrent, 	0)
11579. 
11580. SetVariable(ZoneSizeActual, 			0)
11581. SetVariable(ZoneSizeActualCurrent,		0)
11582. 
11583. SetVariable(ZoneEndActual, 				0)
11584. SetVariable(ZoneEndActualCurrent,		0)			
11585. SetVariable(ZoneSizeActualPerCurrent, 	0)
11586.       
11587. SetVariable(ZoneFilesFolders,			0)
11588. SetVariable(ZoneFilesFoldersPer,		0) 
11589. 
11590. SetVariable(ZoneFragments,				0)
11591. SetVariable(ZoneFragmentsPer,			0) 
11592. 		
11593. SetVariable(ZoneEndActualCurrent, 		0)
11594. SetVariable(ZoneEndActualPerCurrent, 	0)
11595. 
11596. # Gap Calculation Methodology:
11597. 	# Requested
11598. 	SetVariable(GapRequested, 			0) 
11599. 	SetVariable(GapRequestedStd, 		0) 
11600. 	SetVariable(GapRequestedMft, 		0) 
11601. 	SetVariable(GapRequestedOs, 		0) 
11602. 	SetVariable(GapRequestedOriginal, 	0) 
11603. 	
11604. 	# Gap Adjustments
11605. 	SetVariable(GapRounded, 			0)
11606. 	# SetVariable(GapAdjusted, 			0)
11607. 	SetVariable(GapAvailable, 			0)
11608. 	SetVariable(GapCurrent, 			0)
11609. 	SetVariable(GapActual, 				0)
11610. 	SetVariable(GapUsed, 				0)
11611. 	
11612. 	# Gap Adjustments
11613. 	SetVariable(GapRoundedLoc, 			0)
11614. 	# SetVariable(GapAdjustedLoc, 		0)
11615. 	SetVariable(GapAvailableLoc, 		0)
11616. 	SetVariable(GapCurrentLoc, 			0)
11617. 	SetVariable(GapActualLoc,			0)
11618. 	SetVariable(GapUsedLoc,				0)
11619. 	
11620. 	# Space usage
11621. 	SetVariable(ZoneFreePerRequested, 	0)
11622. 	SetVariable(ZoneFreePerUsed, 		0)
11623. 
11624. # Gap Size & Rounding
11625. 	SetVariable(ZoneGapSizePer, 		0)
11626. 	SetVariable(ZoneVolRoundUpPer, 		0)
11627. 	
11628. 	# Free Space
11629. 	SetVariable(ZoneFreeUsedPer, 		0)
11630. 	SetVariable(ZoneFreeRequestedPer, 	0)
11631. 
11632. 
11633. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
11634. 
11635. # Footer:
11636. SetVariable(ZoneFooter, "----------------------------------------------------------
11637. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
11638. 
11639. Statistics Report:
11640. ------------------
11641.    Size:  
11642.    ------------------------
11643.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11644.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11645.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11646. 
11647.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11648.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11649. 
11650.    Location:
11651.    ------------------------
11652.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11653.              Files End: !ZoneEndCurrent!
11654.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11655.       
11656.    Gap Settings:
11657.    ------------------------
11658.          Gap Requested: !ZoneGapSizePer!%
11659.       Volume Rounding: !ZoneVolRoundUpPer!%
11660.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11661.                  
11662.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
11663.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
11664.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
11665.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
11666.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
11667.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
11668.      
11669.    Free Space after Zone:
11670.    ------------------------
11671.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11672.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11673.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11674. 
11675. Directory and Files Select:
11676. ---------------------------
11677. !ZoneTypeSelectCurrent!               
11678. ---------------------------
11679. ----------------------------------------------------------
11680. ")
11681. 
11682. # Script: BannerSet
11683. 
11684. # Script: DisplaySetDateTimeRun
11685. 
11686. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
11687. /* Xinclude "..\Display\BannerSet.MyDc"X */
11688. /* pause(1) */
11689. 
11690. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11691. 
11692. Title('!Heading!')
11693. /* pause(1) */
11694. 
11695. /* NOTE: Can't round or truncate to integer precision. */
11696. 
11697. # Script: BannerLog
11698. 
11699. AppendLogfile("!LogFileName!", "!Title!")
11700. 
11701. 
11702. 
11703. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
11704. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
11705. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:50")
11706. 
11707. SetVariable(ZoneListByLine, "!ZoneListByLine!
11708. Zone: !ZoneNoCurrent! 2021-11-09 18:53:50 0:00:06 !ZoneLabel! !ZoneDescription!")
11709. 
11710. 
11711. /* Fixed Zone Position Handling */
11712. /* Literal number: */
11713. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
11714. /* Percentage of disk: */
11715. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
11716. /* Gap */
11717. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
11718. 
11719. /* ---------------------------------------------------------- */
11720. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
11721. # Script: DisplaySetFileStep
11722. 
11723. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11724. 
11725. /* add message and move to a new line. */
11726. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11727. ")
11728. 
11729. /* display the line. (hopefully.) */
11730. # Zone Footer Set Statistics Window Text
11731. 
11732. SetStatisticsWindowText("----------------------------------------------------------
11733. Zones Processed: 
11734. ----------------------------------------------------------
11735. !ZoneListByLine!
11736. ----------------------------------------------------------
11737. Zone Processing Step:
11738. !ZoneStepByLine!    
11739. ----------------------------------------------------------
11740. Current Zone:
11741. !ZoneFooter!
11742. ----------------------------------------------------------
11743. Volume Statistics:
11744. !VolumeStatisticsDetail!
11745. ----------------------------------------------------------
11746. Zone Detailed Report:
11747. ----------------------------------------------------------
11748. !ZoneStatisticsDetail!
11749. ----------------------------------------------------------
11750. ")
11751. 
11752. 
11753. 
11754. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11755. 
11756. # Script: BannerSet
11757. 
11758. # Script: DisplaySetDateTimeRun
11759. 
11760. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
11761. /* Xinclude "..\Display\BannerSet.MyDc"X */
11762. /* pause(1) */
11763. 
11764. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11765. 
11766. Title('!Heading!')
11767. /* pause(1) */
11768. 
11769. /* NOTE: Can't round or truncate to integer precision. */
11770. 
11771. pause(1)
11772. 
11773. # your stuff HERE (X)... pre file select code.
11774. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
11775. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
11776. 	# (X)
11777. 
11778. FileSelect
11779. 
11780. 	# your stuff can't really go here (errors.)
11781. 	# maybe for some reason I don't know of...
11782. 	
11783. 	# Actions next...
11784. 	# Script: ZoneDo ZoneTypeSelectIdeScripts
11785. # IdeScripts start.
11786. # NotBlobsArchivesBu start.
11787. (not (
11788. # Blobs start.
11789. (
11790. # BlobsAndExceptions start.
11791. ( not(
11792.   FileName("*.bat")
11793.   or FileName("*.css")
11794.   or FileName("*.dll")
11795.   or FileName("*.exe")
11796.   or FileName("*.htm*")
11797.   or FileName("*.jar")
11798.   or FileName("*.js")
11799.   or FileName("*.script")
11800.   or FileName("*.wsf")
11801.   or (
11802. # Databases start.
11803. (
11804.   FileName("*.crypt*")
11805.   or FileName("*.db*")
11806.   or FileName("*.rdb*")
11807.   or FileName("*.dc*")
11808.   or FileName("*.dict*")
11809.   or FileName("*.?db*")
11810.   or FileName("*.?rdb*")
11811.   or FileName("*.md*")
11812.   or FileName("*.myd")
11813.   or FileName("*.ndf")
11814.   or FileName("*.ns?")
11815.   or FileName("*.pab")
11816.   or FileName("*.pst")
11817.   or FileName("*.sd?*")
11818.   or FileName("*.sq**")
11819.   or FileName("*.tmd")
11820.   or FileName("*.tps")
11821.   or FileName("*.tr*")
11822. )
11823. # Databases end.
11824. 
11825.     # BlobsAndExceptions
11826.     or 
11827. # Data start.
11828. (
11829.   DirectoryName("Data*")
11830.   or DirectoryName("Device*")
11831.   or DirectoryName("Export*")
11832.   or DirectoryName("Import*")
11833.   or DirectoryName("Log*")
11834.   or DirectoryName("*Log")
11835.   or DirectoryName("Maintenance*")
11836.   or DirectoryName("Rec*")
11837.   or DirectoryName("Sales*")
11838.   or DirectoryName("Search*")
11839.   or DirectoryName("User*")
11840. )
11841. # Data end.
11842. 
11843.     # BlobsAndExceptions
11844.   )
11845. ) )
11846. # BlobsAndExceptions end.
11847. 
11848. # Blobs
11849. ) and (
11850.   Size(BlobFileSize,0)
11851.   or (
11852.     FileName("*.arj")
11853.     or FileName("*.bup")
11854.     or FileName("*.bz2")
11855.     or FileName("*.chm")
11856.     or FileName("*.dvr-ms")
11857.     or FileName("*.gz")
11858.     or FileName("*.ifo")
11859.     or FileName("*.lzh")
11860.     or FileName("*.pdf")
11861.     or FileName("*.rpm")
11862.     or FileName("*.wmv")
11863.     or FileName("*.vob")
11864.     or FileName("*.z")
11865.   ) 
11866. )
11867. # Blobs end.
11868. 
11869. # NotBlobsArchivesBu
11870. or 
11871. # Archives start.
11872. (
11873.   DirectoryName("*Archive*")
11874.   or DirectoryName("*History*")
11875.   or DirectoryName("*Old")
11876.   or DirectoryName("* Old *")
11877.   or DirectoryName("Old *")
11878. 
11879.   or FileName("*.7z")
11880.   or FileName("*.cab")
11881.   or FileName("*.iso")
11882.   or FileName("*.msi")
11883.   or FileName("*.old")
11884.   or FileName("*.rar")
11885.   or FileName("*.tar")
11886.   or FileName("*.zip")
11887.   or
11888. # WinSysLow start.
11889. (
11890.   DirectoryName("$*")
11891.   or DirectoryName("0*")
11892.   or DirectoryName("1*")
11893.   or DirectoryName("2*")
11894.   or DirectoryName("3*")
11895.   or DirectoryName("4*")
11896.   or DirectoryName("5*")
11897.   or DirectoryName("6*")
11898.   or DirectoryName("7*")
11899.   or DirectoryName("8*")
11900.   or DirectoryName("9*")
11901. 
11902.   or DirectoryName("dllcache")
11903.   or DirectoryName("Downloaded Installations")
11904.   or DirectoryName("Ehome")
11905.   or DirectoryName("Fonts")
11906.   or DirectoryName("Help")
11907.   or DirectoryName("I386")
11908.   or DirectoryName("ie?updates")
11909.   or DirectoryName("Installer")
11910.   or DirectoryName("Installshield Installation Information")
11911.   or DirectoryName("IME")
11912.   or DirectoryName("*RECYCLE*")
11913.   or DirectoryName("ServicePackFiles")
11914.   or DirectoryName("SoftwareDistribution")
11915.   or DirectoryName("Speech")
11916.   or DirectoryName("Symbols")
11917.   or DirectoryName("System Volume Information")
11918.   or DirectoryName("windows.old")
11919. )
11920. # WinSysLow end.
11921. 
11922.   # Archives
11923. )
11924. # Archives end.
11925. 
11926. # NotBlobsArchivesBu
11927. or
11928. # Backups start.
11929. (
11930.   DirectoryName("*Backup*")
11931.   or DirectoryName("*Bu")
11932.   or DirectoryName("* Bu *")
11933.   or DirectoryName("Bu *")
11934. 
11935.   or FileName("*.bak")
11936.   or FileName("* - Copy*")
11937. )
11938. # Backups end.
11939. 
11940. # NotBlobsArchivesBu
11941. ) )
11942. # NotBlobsArchivesBu end.
11943. 
11944. # IdeScripts
11945. and ( 
11946. # Ide start.
11947. (
11948.     DirectoryName("Ide*")
11949.     or DirectoryName("Java*")
11950.     or DirectoryName("Os")
11951. )
11952. # Ide end.
11953. 
11954. # IdeScripts
11955. or  
11956. # Scripts start.
11957. (
11958.   DirectoryName("*Script*")
11959. )
11960. # Scripts end.
11961. 
11962. # IdeScripts
11963. )
11964. # IdeScripts end.
11965. 
11966. 	# Script: ZoneDoAction
11967. # Zone Do File Action - SortByName.
11968. 
11969. FileActions
11970. 
11971. 	# Footer:
11972. SetVariable(ZoneFooter, "----------------------------------------------------------
11973. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
11974. 
11975. Statistics Report:
11976. ------------------
11977.    Size:  
11978.    ------------------------
11979.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11980.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11981.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11982. 
11983.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11984.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11985. 
11986.    Location:
11987.    ------------------------
11988.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11989.              Files End: !ZoneEndCurrent!
11990.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11991.       
11992.    Gap Settings:
11993.    ------------------------
11994.          Gap Requested: !ZoneGapSizePer!%
11995.       Volume Rounding: !ZoneVolRoundUpPer!%
11996.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11997.                  
11998.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
11999.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
12000.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
12001.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
12002.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
12003.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
12004.      
12005.    Free Space after Zone:
12006.    ------------------------
12007.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12008.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12009.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12010. 
12011. Directory and Files Select:
12012. ---------------------------
12013. !ZoneTypeSelectCurrent!               
12014. ---------------------------
12015. ----------------------------------------------------------
12016. ")
12017. 	SetStatisticsWindowText("!ZoneFooter!")
12018. 	
12019. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
12020. 	# Script: DisplaySetFileStep
12021. 
12022. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12023. 
12024. /* add message and move to a new line. */
12025. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12026. ")
12027. 
12028. /* display the line. (hopefully.) */
12029. # Zone Footer Set Statistics Window Text
12030. 
12031. SetStatisticsWindowText("----------------------------------------------------------
12032. Zones Processed: 
12033. ----------------------------------------------------------
12034. !ZoneListByLine!
12035. ----------------------------------------------------------
12036. Zone Processing Step:
12037. !ZoneStepByLine!    
12038. ----------------------------------------------------------
12039. Current Zone:
12040. !ZoneFooter!
12041. ----------------------------------------------------------
12042. Volume Statistics:
12043. !VolumeStatisticsDetail!
12044. ----------------------------------------------------------
12045. Zone Detailed Report:
12046. ----------------------------------------------------------
12047. !ZoneStatisticsDetail!
12048. ----------------------------------------------------------
12049. ")
12050. 
12051. 
12052. 
12053. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12054. 
12055. # Script: BannerSet
12056. 
12057. # Script: DisplaySetDateTimeRun
12058. 
12059. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
12060. /* Xinclude "..\Display\BannerSet.MyDc"X */
12061. /* pause(1) */
12062. 
12063. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12064. 
12065. Title('!Heading!')
12066. /* pause(1) */
12067. 
12068. /* NOTE: Can't round or truncate to integer precision. */
12069. 
12070. pause(1)
12071. 
12072. # Commands:
12073. 
12074. /* Moves to Zone or above it. */
12075. # MoveUpToZone()
12076. 
12077. # Defrag
12078. 
12079. # Defragment(OPTIONS)
12080. 
12081. /* Shuffles files around trying to make a big enough gap for fragmented files. */
12082. # Defragment()
12083. 
12084. /* Only does files where a gap will fit it. */
12085. # Defragment(Fast)
12086. 
12087. /* Skips fragmented files larger than the Chunck Size.
12088. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
12089. # Defragment(Chunk Size)
12090. 
12091. /* Moves down to zone and packs zone to beginning if there are gaps. */
12092. /* Can be similar in performance to doing a SortBy. */
12093. # MoveDownFill()
12094. 
12095. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
12096. 
12097. 
12098. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
12099. 	# Script: DisplaySetFileStep
12100. 
12101. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12102. 
12103. /* add message and move to a new line. */
12104. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12105. ")
12106. 
12107. /* display the line. (hopefully.) */
12108. # Zone Footer Set Statistics Window Text
12109. 
12110. SetStatisticsWindowText("----------------------------------------------------------
12111. Zones Processed: 
12112. ----------------------------------------------------------
12113. !ZoneListByLine!
12114. ----------------------------------------------------------
12115. Zone Processing Step:
12116. !ZoneStepByLine!    
12117. ----------------------------------------------------------
12118. Current Zone:
12119. !ZoneFooter!
12120. ----------------------------------------------------------
12121. Volume Statistics:
12122. !VolumeStatisticsDetail!
12123. ----------------------------------------------------------
12124. Zone Detailed Report:
12125. ----------------------------------------------------------
12126. !ZoneStatisticsDetail!
12127. ----------------------------------------------------------
12128. ")
12129. 
12130. 
12131. 
12132. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12133. 
12134. # Script: BannerSet
12135. 
12136. # Script: DisplaySetDateTimeRun
12137. 
12138. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
12139. /* Xinclude "..\Display\BannerSet.MyDc"X */
12140. /* pause(1) */
12141. 
12142. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12143. 
12144. Title('!Heading!')
12145. /* pause(1) */
12146. 
12147. /* NOTE: Can't round or truncate to integer precision. */
12148. 
12149. pause(1)
12150. 
12151. 	# Script: ZoneDoFooter
12152. 
12153. /* ---------------------------------------------------------- */
12154. # File Select
12155. 	# Select Statments
12156. # File Actions 
12157. 	# Standard or OS File Actions.
12158. 	# Resume...
12159. 	
12160. 	# your stuff HERE (X)... post zone (file) file actions code.
12161. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
12162. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12163. 		# (X)
12164. 		
12165. 		/* ??? Set window? */
12166. 	
12167. 	# ADD THE GAP
12168. 		
12169. # Vacate (good for diagnostics)
12170. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
12171. 
12172. # DoNotVacate - DO NOT Vacate (recommended)
12173. 
12174. # Vacate
12175. /* AddGap(GapUsedLoc) */
12176. 
12177. # DO Not Vacate
12178. AddGap(GapUsedLoc, DoNotVacate) 
12179. 	
12180. 	
12181. /* ---------------------------------------------------------- */
12182. # (failed) TEST for boolean logic.
12183. 
12184. /* It should work in the gap calculations for turning options */
12185. /* on and off but it will NOT work here. */
12186. 
12187. /* Boolean setting X or FlagX. */
12188. /* Where X will be on or off: */
12189. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
12190. /*      For ON:  (X  *  FlagAny) */
12191. 
12192. /* 1) Failed, zero gap overrode the previous one. */
12193. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
12194. /* AddGap(GapUsedTemp) */ 
12195. 
12196. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
12197. /* AddGap(GapUsedTemp, DoNotVacate) */ 
12198. 
12199. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
12200. 
12201. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
12202. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
12203. /* AddGap(GapUsedTemp) */ 
12204. 
12205. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
12206. /* AddGap(GapUsedTemp, DoNotVacate) */ 
12207. 
12208. /* ---------------------------------------------------------- */
12209. 
12210. # Vacate
12211. /* AddGap(GapUsed) */
12212. 
12213. # DO NOT Vacate (recommended)
12214. /* AddGap(GapUsed, DoNotVacate) */ 
12215. 	
12216. 
12217. 		
12218. # 
12219. FileEnd
12220. /* ---------------------------------------------------------- */
12221. 
12222. # your stuff HERE (X)... post zone (file) code.
12223. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
12224. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12225. 	# (X)
12226. 
12227. SetVariable(FileStepDescription,"Zone finished, reporting.")
12228. # Script: DisplaySetFileStep
12229. 
12230. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12231. 
12232. /* add message and move to a new line. */
12233. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12234. ")
12235. 
12236. /* display the line. (hopefully.) */
12237. # Zone Footer Set Statistics Window Text
12238. 
12239. SetStatisticsWindowText("----------------------------------------------------------
12240. Zones Processed: 
12241. ----------------------------------------------------------
12242. !ZoneListByLine!
12243. ----------------------------------------------------------
12244. Zone Processing Step:
12245. !ZoneStepByLine!    
12246. ----------------------------------------------------------
12247. Current Zone:
12248. !ZoneFooter!
12249. ----------------------------------------------------------
12250. Volume Statistics:
12251. !VolumeStatisticsDetail!
12252. ----------------------------------------------------------
12253. Zone Detailed Report:
12254. ----------------------------------------------------------
12255. !ZoneStatisticsDetail!
12256. ----------------------------------------------------------
12257. ")
12258. 
12259. 
12260. 
12261. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12262. 
12263. # Script: BannerSet
12264. 
12265. # Script: DisplaySetDateTimeRun
12266. 
12267. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
12268. /* Xinclude "..\Display\BannerSet.MyDc"X */
12269. /* pause(1) */
12270. 
12271. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12272. 
12273. Title('!Heading!')
12274. /* pause(1) */
12275. 
12276. /* NOTE: Can't round or truncate to integer precision. */
12277. 
12278. pause(1)
12279. 
12280. # Script: ZoneWhenFinished
12281. 
12282. # Script: BannerSet
12283. 
12284. # Script: DisplaySetDateTimeRun
12285. 
12286. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
12287. /* Xinclude "..\Display\BannerSet.MyDc"X */
12288. /* pause(1) */
12289. 
12290. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12291. 
12292. Title('!Heading!')
12293. /* pause(1) */
12294. 
12295. /* NOTE: Can't round or truncate to integer precision. */
12296. 
12297. # Script: BannerLog
12298. 
12299. AppendLogfile("!LogFileName!", "!Title!")
12300. 
12301. 
12302. 
12303. # Zone Statistics	
12304. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
12305. 
12306. # Footer:
12307. SetVariable(ZoneFooter, "----------------------------------------------------------
12308. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
12309. 
12310. Statistics Report:
12311. ------------------
12312.    Size:  
12313.    ------------------------
12314.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12315.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12316.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12317. 
12318.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12319.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12320. 
12321.    Location:
12322.    ------------------------
12323.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12324.              Files End: !ZoneEndCurrent!
12325.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12326.       
12327.    Gap Settings:
12328.    ------------------------
12329.          Gap Requested: !ZoneGapSizePer!%
12330.       Volume Rounding: !ZoneVolRoundUpPer!%
12331.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12332.                  
12333.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
12334.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
12335.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
12336.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
12337.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
12338.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
12339.      
12340.    Free Space after Zone:
12341.    ------------------------
12342.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12343.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12344.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12345. 
12346. Directory and Files Select:
12347. ---------------------------
12348. !ZoneTypeSelectCurrent!               
12349. ---------------------------
12350. ----------------------------------------------------------
12351. ")
12352. 
12353. AppendLogfile("!LogFileName!", ".")
12354. AppendLogfile("!LogFileName!", "!ZoneFooter!")
12355. AppendLogfile("!LogFileName!", ".")
12356. 
12357. # Zone Footer Set Statistics Window Text
12358. 
12359. SetStatisticsWindowText("----------------------------------------------------------
12360. Zones Processed: 
12361. ----------------------------------------------------------
12362. !ZoneListByLine!
12363. ----------------------------------------------------------
12364. Zone Processing Step:
12365. !ZoneStepByLine!    
12366. ----------------------------------------------------------
12367. Current Zone:
12368. !ZoneFooter!
12369. ----------------------------------------------------------
12370. Volume Statistics:
12371. !VolumeStatisticsDetail!
12372. ----------------------------------------------------------
12373. Zone Detailed Report:
12374. ----------------------------------------------------------
12375. !ZoneStatisticsDetail!
12376. ----------------------------------------------------------
12377. ")
12378. 
12379. 
12380. 
12381. /* pause() */
12382. /* pause() */
12383. 
12384. 
12385. 
12386. 
12387. /* ---------------------------------------------------------- */
12388. 
12389. /* ---------------------------------------------------------- */
12390. /* Zone DevToDo */
12391. # Script: DefragZoneTypeDevToDo
12392. /* ---------------------------------------------------------- */
12393. /* Zone DevToDo */
12394. 
12395. SetVariable(ZoneLabel, "!ZoneLabelDevToDo!")
12396. SetVariable(ZoneDescription, "!ZoneDescriptionDevToDo!")
12397. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpDevToDo!")
12398. SetVariable(ZoneGapSize, "!ZoneGapSizeDevToDo!")
12399. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectDevToDo
12400. # DevToDo start.
12401. # NotBlobsArchivesBu start.
12402. (not (
12403. # Blobs start.
12404. (
12405. # BlobsAndExceptions start.
12406. ( not(
12407.   FileName("*.bat")
12408.   or FileName("*.css")
12409.   or FileName("*.dll")
12410.   or FileName("*.exe")
12411.   or FileName("*.htm*")
12412.   or FileName("*.jar")
12413.   or FileName("*.js")
12414.   or FileName("*.script")
12415.   or FileName("*.wsf")
12416.   or (
12417. # Databases start.
12418. (
12419.   FileName("*.crypt*")
12420.   or FileName("*.db*")
12421.   or FileName("*.rdb*")
12422.   or FileName("*.dc*")
12423.   or FileName("*.dict*")
12424.   or FileName("*.?db*")
12425.   or FileName("*.?rdb*")
12426.   or FileName("*.md*")
12427.   or FileName("*.myd")
12428.   or FileName("*.ndf")
12429.   or FileName("*.ns?")
12430.   or FileName("*.pab")
12431.   or FileName("*.pst")
12432.   or FileName("*.sd?*")
12433.   or FileName("*.sq**")
12434.   or FileName("*.tmd")
12435.   or FileName("*.tps")
12436.   or FileName("*.tr*")
12437. )
12438. # Databases end.
12439. 
12440.     # BlobsAndExceptions
12441.     or 
12442. # Data start.
12443. (
12444.   DirectoryName("Data*")
12445.   or DirectoryName("Device*")
12446.   or DirectoryName("Export*")
12447.   or DirectoryName("Import*")
12448.   or DirectoryName("Log*")
12449.   or DirectoryName("*Log")
12450.   or DirectoryName("Maintenance*")
12451.   or DirectoryName("Rec*")
12452.   or DirectoryName("Sales*")
12453.   or DirectoryName("Search*")
12454.   or DirectoryName("User*")
12455. )
12456. # Data end.
12457. 
12458.     # BlobsAndExceptions
12459.   )
12460. ) )
12461. # BlobsAndExceptions end.
12462. 
12463. # Blobs
12464. ) and (
12465.   Size(BlobFileSize,0)
12466.   or (
12467.     FileName("*.arj")
12468.     or FileName("*.bup")
12469.     or FileName("*.bz2")
12470.     or FileName("*.chm")
12471.     or FileName("*.dvr-ms")
12472.     or FileName("*.gz")
12473.     or FileName("*.ifo")
12474.     or FileName("*.lzh")
12475.     or FileName("*.pdf")
12476.     or FileName("*.rpm")
12477.     or FileName("*.wmv")
12478.     or FileName("*.vob")
12479.     or FileName("*.z")
12480.   ) 
12481. )
12482. # Blobs end.
12483. 
12484. # NotBlobsArchivesBu
12485. or 
12486. # Archives start.
12487. (
12488.   DirectoryName("*Archive*")
12489.   or DirectoryName("*History*")
12490.   or DirectoryName("*Old")
12491.   or DirectoryName("* Old *")
12492.   or DirectoryName("Old *")
12493. 
12494.   or FileName("*.7z")
12495.   or FileName("*.cab")
12496.   or FileName("*.iso")
12497.   or FileName("*.msi")
12498.   or FileName("*.old")
12499.   or FileName("*.rar")
12500.   or FileName("*.tar")
12501.   or FileName("*.zip")
12502.   or
12503. # WinSysLow start.
12504. (
12505.   DirectoryName("$*")
12506.   or DirectoryName("0*")
12507.   or DirectoryName("1*")
12508.   or DirectoryName("2*")
12509.   or DirectoryName("3*")
12510.   or DirectoryName("4*")
12511.   or DirectoryName("5*")
12512.   or DirectoryName("6*")
12513.   or DirectoryName("7*")
12514.   or DirectoryName("8*")
12515.   or DirectoryName("9*")
12516. 
12517.   or DirectoryName("dllcache")
12518.   or DirectoryName("Downloaded Installations")
12519.   or DirectoryName("Ehome")
12520.   or DirectoryName("Fonts")
12521.   or DirectoryName("Help")
12522.   or DirectoryName("I386")
12523.   or DirectoryName("ie?updates")
12524.   or DirectoryName("Installer")
12525.   or DirectoryName("Installshield Installation Information")
12526.   or DirectoryName("IME")
12527.   or DirectoryName("*RECYCLE*")
12528.   or DirectoryName("ServicePackFiles")
12529.   or DirectoryName("SoftwareDistribution")
12530.   or DirectoryName("Speech")
12531.   or DirectoryName("Symbols")
12532.   or DirectoryName("System Volume Information")
12533.   or DirectoryName("windows.old")
12534. )
12535. # WinSysLow end.
12536. 
12537.   # Archives
12538. )
12539. # Archives end.
12540. 
12541. # NotBlobsArchivesBu
12542. or
12543. # Backups start.
12544. (
12545.   DirectoryName("*Backup*")
12546.   or DirectoryName("*Bu")
12547.   or DirectoryName("* Bu *")
12548.   or DirectoryName("Bu *")
12549. 
12550.   or FileName("*.bak")
12551.   or FileName("* - Copy*")
12552. )
12553. # Backups end.
12554. 
12555. # NotBlobsArchivesBu
12556. ) )
12557. # NotBlobsArchivesBu end.
12558. 
12559. # DevToDo
12560. and ( 
12561. # Dev start.
12562. (
12563.   DirectoryName("*Dev") 
12564.   or DirectoryName("Dev *") 
12565.   or DirectoryName("*Development*") 
12566.   or DirectoryName("DsVs*") 
12567.   or DirectoryName("Srt*") 
12568. )
12569. # Dev end.
12570. 
12571. # DevToDo
12572. or 
12573. # ToDo start.
12574. (
12575.   DirectoryName("*ToDo*")
12576. )
12577. # ToDo end.
12578. 
12579. # DevToDo
12580. )
12581. # DevToDo end.
12582. ')
12583. 
12584. 	# Script: ZoneDoHeader
12585. 
12586. # Script: ZoneWhenStarted
12587. 
12588. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
12589. # Script: DisplaySetZone
12590. 
12591. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
12592. SetVariable(FileStepDescription,	"")
12593. 
12594. SetVariable(ZoneStepByLine, 			"Zone started.
12595. ")
12596. 
12597. # Script: BannerDescriptionSet
12598. 
12599. # Script: BannerSet
12600. 
12601. # Script: DisplaySetDateTimeRun
12602. 
12603. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
12604. /* Xinclude "..\Display\BannerSet.MyDc"X */
12605. /* pause(1) */
12606. 
12607. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12608. 
12609. Title('!Heading!')
12610. /* pause(1) */
12611. 
12612. /* NOTE: Can't round or truncate to integer precision. */
12613. 
12614. # Script: BannerLog
12615. 
12616. AppendLogfile("!LogFileName!", "!Title!")
12617. 
12618. 
12619. 
12620. pause(1)
12621. 
12622. 
12623. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
12624. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
12625. 
12626. SetVariable(ZoneStepNoCurrent, 0)
12627. 
12628. 
12629. # Script: ZoneDoCurrentClear
12630. 
12631. SetVariable(ZoneTypeSelectCurrent, 		"")
12632. 
12633. SetVariable(ZoneBeginCurrent, 			0)
12634. SetVariable(ZoneBeginPerCurrent, 		0)
12635. SetVariable(ZoneEndCurrent, 			0)
12636. SetVariable(ZoneEndPerCurrent, 			0)
12637. 
12638. SetVariable(ZoneSizeCurrent,			0)
12639. SetVariable(ZoneSizePerCurrent,			0)
12640. 
12641. SetVariable(ZoneGapRequestedCurrent,	0)
12642. SetVariable(ZoneGapRoundedCurrent, 		0)
12643. SetVariable(ZoneGapAdjustedCurrent, 	0)
12644. SetVariable(ZoneGapAvailableCurrent, 	0)
12645. SetVariable(ZoneGapCurrent,				0)
12646. SetVariable(ZoneGapUsedCurrent, 		0)
12647. 
12648. SetVariable(ZoneGapActualCurrent, 		0)
12649. SetVariable(ZoneGapActualPerCurrent, 	0)
12650. 
12651. SetVariable(ZoneSizeActual, 			0)
12652. SetVariable(ZoneSizeActualCurrent,		0)
12653. 
12654. SetVariable(ZoneEndActual, 				0)
12655. SetVariable(ZoneEndActualCurrent,		0)			
12656. SetVariable(ZoneSizeActualPerCurrent, 	0)
12657.       
12658. SetVariable(ZoneFilesFolders,			0)
12659. SetVariable(ZoneFilesFoldersPer,		0) 
12660. 
12661. SetVariable(ZoneFragments,				0)
12662. SetVariable(ZoneFragmentsPer,			0) 
12663. 		
12664. SetVariable(ZoneEndActualCurrent, 		0)
12665. SetVariable(ZoneEndActualPerCurrent, 	0)
12666. 
12667. # Gap Calculation Methodology:
12668. 	# Requested
12669. 	SetVariable(GapRequested, 			0) 
12670. 	SetVariable(GapRequestedStd, 		0) 
12671. 	SetVariable(GapRequestedMft, 		0) 
12672. 	SetVariable(GapRequestedOs, 		0) 
12673. 	SetVariable(GapRequestedOriginal, 	0) 
12674. 	
12675. 	# Gap Adjustments
12676. 	SetVariable(GapRounded, 			0)
12677. 	# SetVariable(GapAdjusted, 			0)
12678. 	SetVariable(GapAvailable, 			0)
12679. 	SetVariable(GapCurrent, 			0)
12680. 	SetVariable(GapActual, 				0)
12681. 	SetVariable(GapUsed, 				0)
12682. 	
12683. 	# Gap Adjustments
12684. 	SetVariable(GapRoundedLoc, 			0)
12685. 	# SetVariable(GapAdjustedLoc, 		0)
12686. 	SetVariable(GapAvailableLoc, 		0)
12687. 	SetVariable(GapCurrentLoc, 			0)
12688. 	SetVariable(GapActualLoc,			0)
12689. 	SetVariable(GapUsedLoc,				0)
12690. 	
12691. 	# Space usage
12692. 	SetVariable(ZoneFreePerRequested, 	0)
12693. 	SetVariable(ZoneFreePerUsed, 		0)
12694. 
12695. # Gap Size & Rounding
12696. 	SetVariable(ZoneGapSizePer, 		0)
12697. 	SetVariable(ZoneVolRoundUpPer, 		0)
12698. 	
12699. 	# Free Space
12700. 	SetVariable(ZoneFreeUsedPer, 		0)
12701. 	SetVariable(ZoneFreeRequestedPer, 	0)
12702. 
12703. 
12704. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
12705. 
12706. # Footer:
12707. SetVariable(ZoneFooter, "----------------------------------------------------------
12708. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
12709. 
12710. Statistics Report:
12711. ------------------
12712.    Size:  
12713.    ------------------------
12714.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12715.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12716.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12717. 
12718.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12719.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12720. 
12721.    Location:
12722.    ------------------------
12723.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12724.              Files End: !ZoneEndCurrent!
12725.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12726.       
12727.    Gap Settings:
12728.    ------------------------
12729.          Gap Requested: !ZoneGapSizePer!%
12730.       Volume Rounding: !ZoneVolRoundUpPer!%
12731.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12732.                  
12733.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
12734.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
12735.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
12736.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
12737.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
12738.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
12739.      
12740.    Free Space after Zone:
12741.    ------------------------
12742.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12743.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12744.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12745. 
12746. Directory and Files Select:
12747. ---------------------------
12748. !ZoneTypeSelectCurrent!               
12749. ---------------------------
12750. ----------------------------------------------------------
12751. ")
12752. 
12753. # Script: BannerSet
12754. 
12755. # Script: DisplaySetDateTimeRun
12756. 
12757. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
12758. /* Xinclude "..\Display\BannerSet.MyDc"X */
12759. /* pause(1) */
12760. 
12761. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12762. 
12763. Title('!Heading!')
12764. /* pause(1) */
12765. 
12766. /* NOTE: Can't round or truncate to integer precision. */
12767. 
12768. # Script: BannerLog
12769. 
12770. AppendLogfile("!LogFileName!", "!Title!")
12771. 
12772. 
12773. 
12774. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
12775. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
12776. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:50")
12777. 
12778. SetVariable(ZoneListByLine, "!ZoneListByLine!
12779. Zone: !ZoneNoCurrent! 2021-11-09 18:53:50 0:00:06 !ZoneLabel! !ZoneDescription!")
12780. 
12781. 
12782. /* Fixed Zone Position Handling */
12783. /* Literal number: */
12784. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
12785. /* Percentage of disk: */
12786. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
12787. /* Gap */
12788. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
12789. 
12790. /* ---------------------------------------------------------- */
12791. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
12792. # Script: DisplaySetFileStep
12793. 
12794. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12795. 
12796. /* add message and move to a new line. */
12797. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12798. ")
12799. 
12800. /* display the line. (hopefully.) */
12801. # Zone Footer Set Statistics Window Text
12802. 
12803. SetStatisticsWindowText("----------------------------------------------------------
12804. Zones Processed: 
12805. ----------------------------------------------------------
12806. !ZoneListByLine!
12807. ----------------------------------------------------------
12808. Zone Processing Step:
12809. !ZoneStepByLine!    
12810. ----------------------------------------------------------
12811. Current Zone:
12812. !ZoneFooter!
12813. ----------------------------------------------------------
12814. Volume Statistics:
12815. !VolumeStatisticsDetail!
12816. ----------------------------------------------------------
12817. Zone Detailed Report:
12818. ----------------------------------------------------------
12819. !ZoneStatisticsDetail!
12820. ----------------------------------------------------------
12821. ")
12822. 
12823. 
12824. 
12825. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12826. 
12827. # Script: BannerSet
12828. 
12829. # Script: DisplaySetDateTimeRun
12830. 
12831. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
12832. /* Xinclude "..\Display\BannerSet.MyDc"X */
12833. /* pause(1) */
12834. 
12835. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12836. 
12837. Title('!Heading!')
12838. /* pause(1) */
12839. 
12840. /* NOTE: Can't round or truncate to integer precision. */
12841. 
12842. pause(1)
12843. 
12844. # your stuff HERE (X)... pre file select code.
12845. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
12846. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
12847. 	# (X)
12848. 
12849. FileSelect
12850. 
12851. 	# your stuff can't really go here (errors.)
12852. 	# maybe for some reason I don't know of...
12853. 	
12854. 	# Actions next...
12855. 	# Script: ZoneDo ZoneTypeSelectDevToDo
12856. # DevToDo start.
12857. # NotBlobsArchivesBu start.
12858. (not (
12859. # Blobs start.
12860. (
12861. # BlobsAndExceptions start.
12862. ( not(
12863.   FileName("*.bat")
12864.   or FileName("*.css")
12865.   or FileName("*.dll")
12866.   or FileName("*.exe")
12867.   or FileName("*.htm*")
12868.   or FileName("*.jar")
12869.   or FileName("*.js")
12870.   or FileName("*.script")
12871.   or FileName("*.wsf")
12872.   or (
12873. # Databases start.
12874. (
12875.   FileName("*.crypt*")
12876.   or FileName("*.db*")
12877.   or FileName("*.rdb*")
12878.   or FileName("*.dc*")
12879.   or FileName("*.dict*")
12880.   or FileName("*.?db*")
12881.   or FileName("*.?rdb*")
12882.   or FileName("*.md*")
12883.   or FileName("*.myd")
12884.   or FileName("*.ndf")
12885.   or FileName("*.ns?")
12886.   or FileName("*.pab")
12887.   or FileName("*.pst")
12888.   or FileName("*.sd?*")
12889.   or FileName("*.sq**")
12890.   or FileName("*.tmd")
12891.   or FileName("*.tps")
12892.   or FileName("*.tr*")
12893. )
12894. # Databases end.
12895. 
12896.     # BlobsAndExceptions
12897.     or 
12898. # Data start.
12899. (
12900.   DirectoryName("Data*")
12901.   or DirectoryName("Device*")
12902.   or DirectoryName("Export*")
12903.   or DirectoryName("Import*")
12904.   or DirectoryName("Log*")
12905.   or DirectoryName("*Log")
12906.   or DirectoryName("Maintenance*")
12907.   or DirectoryName("Rec*")
12908.   or DirectoryName("Sales*")
12909.   or DirectoryName("Search*")
12910.   or DirectoryName("User*")
12911. )
12912. # Data end.
12913. 
12914.     # BlobsAndExceptions
12915.   )
12916. ) )
12917. # BlobsAndExceptions end.
12918. 
12919. # Blobs
12920. ) and (
12921.   Size(BlobFileSize,0)
12922.   or (
12923.     FileName("*.arj")
12924.     or FileName("*.bup")
12925.     or FileName("*.bz2")
12926.     or FileName("*.chm")
12927.     or FileName("*.dvr-ms")
12928.     or FileName("*.gz")
12929.     or FileName("*.ifo")
12930.     or FileName("*.lzh")
12931.     or FileName("*.pdf")
12932.     or FileName("*.rpm")
12933.     or FileName("*.wmv")
12934.     or FileName("*.vob")
12935.     or FileName("*.z")
12936.   ) 
12937. )
12938. # Blobs end.
12939. 
12940. # NotBlobsArchivesBu
12941. or 
12942. # Archives start.
12943. (
12944.   DirectoryName("*Archive*")
12945.   or DirectoryName("*History*")
12946.   or DirectoryName("*Old")
12947.   or DirectoryName("* Old *")
12948.   or DirectoryName("Old *")
12949. 
12950.   or FileName("*.7z")
12951.   or FileName("*.cab")
12952.   or FileName("*.iso")
12953.   or FileName("*.msi")
12954.   or FileName("*.old")
12955.   or FileName("*.rar")
12956.   or FileName("*.tar")
12957.   or FileName("*.zip")
12958.   or
12959. # WinSysLow start.
12960. (
12961.   DirectoryName("$*")
12962.   or DirectoryName("0*")
12963.   or DirectoryName("1*")
12964.   or DirectoryName("2*")
12965.   or DirectoryName("3*")
12966.   or DirectoryName("4*")
12967.   or DirectoryName("5*")
12968.   or DirectoryName("6*")
12969.   or DirectoryName("7*")
12970.   or DirectoryName("8*")
12971.   or DirectoryName("9*")
12972. 
12973.   or DirectoryName("dllcache")
12974.   or DirectoryName("Downloaded Installations")
12975.   or DirectoryName("Ehome")
12976.   or DirectoryName("Fonts")
12977.   or DirectoryName("Help")
12978.   or DirectoryName("I386")
12979.   or DirectoryName("ie?updates")
12980.   or DirectoryName("Installer")
12981.   or DirectoryName("Installshield Installation Information")
12982.   or DirectoryName("IME")
12983.   or DirectoryName("*RECYCLE*")
12984.   or DirectoryName("ServicePackFiles")
12985.   or DirectoryName("SoftwareDistribution")
12986.   or DirectoryName("Speech")
12987.   or DirectoryName("Symbols")
12988.   or DirectoryName("System Volume Information")
12989.   or DirectoryName("windows.old")
12990. )
12991. # WinSysLow end.
12992. 
12993.   # Archives
12994. )
12995. # Archives end.
12996. 
12997. # NotBlobsArchivesBu
12998. or
12999. # Backups start.
13000. (
13001.   DirectoryName("*Backup*")
13002.   or DirectoryName("*Bu")
13003.   or DirectoryName("* Bu *")
13004.   or DirectoryName("Bu *")
13005. 
13006.   or FileName("*.bak")
13007.   or FileName("* - Copy*")
13008. )
13009. # Backups end.
13010. 
13011. # NotBlobsArchivesBu
13012. ) )
13013. # NotBlobsArchivesBu end.
13014. 
13015. # DevToDo
13016. and ( 
13017. # Dev start.
13018. (
13019.   DirectoryName("*Dev") 
13020.   or DirectoryName("Dev *") 
13021.   or DirectoryName("*Development*") 
13022.   or DirectoryName("DsVs*") 
13023.   or DirectoryName("Srt*") 
13024. )
13025. # Dev end.
13026. 
13027. # DevToDo
13028. or 
13029. # ToDo start.
13030. (
13031.   DirectoryName("*ToDo*")
13032. )
13033. # ToDo end.
13034. 
13035. # DevToDo
13036. )
13037. # DevToDo end.
13038. 
13039. 	# Script: ZoneDoAction
13040. # Zone Do File Action - SortByName.
13041. 
13042. FileActions
13043. 
13044. 	# Footer:
13045. SetVariable(ZoneFooter, "----------------------------------------------------------
13046. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
13047. 
13048. Statistics Report:
13049. ------------------
13050.    Size:  
13051.    ------------------------
13052.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13053.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13054.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13055. 
13056.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13057.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13058. 
13059.    Location:
13060.    ------------------------
13061.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13062.              Files End: !ZoneEndCurrent!
13063.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13064.       
13065.    Gap Settings:
13066.    ------------------------
13067.          Gap Requested: !ZoneGapSizePer!%
13068.       Volume Rounding: !ZoneVolRoundUpPer!%
13069.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13070.                  
13071.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
13072.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
13073.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
13074.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
13075.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
13076.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
13077.      
13078.    Free Space after Zone:
13079.    ------------------------
13080.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13081.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13082.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13083. 
13084. Directory and Files Select:
13085. ---------------------------
13086. !ZoneTypeSelectCurrent!               
13087. ---------------------------
13088. ----------------------------------------------------------
13089. ")
13090. 	SetStatisticsWindowText("!ZoneFooter!")
13091. 	
13092. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
13093. 	# Script: DisplaySetFileStep
13094. 
13095. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13096. 
13097. /* add message and move to a new line. */
13098. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13099. ")
13100. 
13101. /* display the line. (hopefully.) */
13102. # Zone Footer Set Statistics Window Text
13103. 
13104. SetStatisticsWindowText("----------------------------------------------------------
13105. Zones Processed: 
13106. ----------------------------------------------------------
13107. !ZoneListByLine!
13108. ----------------------------------------------------------
13109. Zone Processing Step:
13110. !ZoneStepByLine!    
13111. ----------------------------------------------------------
13112. Current Zone:
13113. !ZoneFooter!
13114. ----------------------------------------------------------
13115. Volume Statistics:
13116. !VolumeStatisticsDetail!
13117. ----------------------------------------------------------
13118. Zone Detailed Report:
13119. ----------------------------------------------------------
13120. !ZoneStatisticsDetail!
13121. ----------------------------------------------------------
13122. ")
13123. 
13124. 
13125. 
13126. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13127. 
13128. # Script: BannerSet
13129. 
13130. # Script: DisplaySetDateTimeRun
13131. 
13132. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
13133. /* Xinclude "..\Display\BannerSet.MyDc"X */
13134. /* pause(1) */
13135. 
13136. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13137. 
13138. Title('!Heading!')
13139. /* pause(1) */
13140. 
13141. /* NOTE: Can't round or truncate to integer precision. */
13142. 
13143. pause(1)
13144. 
13145. # Commands:
13146. 
13147. /* Moves to Zone or above it. */
13148. # MoveUpToZone()
13149. 
13150. # Defrag
13151. 
13152. # Defragment(OPTIONS)
13153. 
13154. /* Shuffles files around trying to make a big enough gap for fragmented files. */
13155. # Defragment()
13156. 
13157. /* Only does files where a gap will fit it. */
13158. # Defragment(Fast)
13159. 
13160. /* Skips fragmented files larger than the Chunck Size.
13161. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
13162. # Defragment(Chunk Size)
13163. 
13164. /* Moves down to zone and packs zone to beginning if there are gaps. */
13165. /* Can be similar in performance to doing a SortBy. */
13166. # MoveDownFill()
13167. 
13168. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
13169. 
13170. 
13171. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
13172. 	# Script: DisplaySetFileStep
13173. 
13174. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13175. 
13176. /* add message and move to a new line. */
13177. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13178. ")
13179. 
13180. /* display the line. (hopefully.) */
13181. # Zone Footer Set Statistics Window Text
13182. 
13183. SetStatisticsWindowText("----------------------------------------------------------
13184. Zones Processed: 
13185. ----------------------------------------------------------
13186. !ZoneListByLine!
13187. ----------------------------------------------------------
13188. Zone Processing Step:
13189. !ZoneStepByLine!    
13190. ----------------------------------------------------------
13191. Current Zone:
13192. !ZoneFooter!
13193. ----------------------------------------------------------
13194. Volume Statistics:
13195. !VolumeStatisticsDetail!
13196. ----------------------------------------------------------
13197. Zone Detailed Report:
13198. ----------------------------------------------------------
13199. !ZoneStatisticsDetail!
13200. ----------------------------------------------------------
13201. ")
13202. 
13203. 
13204. 
13205. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13206. 
13207. # Script: BannerSet
13208. 
13209. # Script: DisplaySetDateTimeRun
13210. 
13211. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
13212. /* Xinclude "..\Display\BannerSet.MyDc"X */
13213. /* pause(1) */
13214. 
13215. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13216. 
13217. Title('!Heading!')
13218. /* pause(1) */
13219. 
13220. /* NOTE: Can't round or truncate to integer precision. */
13221. 
13222. pause(1)
13223. 
13224. 	# Script: ZoneDoFooter
13225. 
13226. /* ---------------------------------------------------------- */
13227. # File Select
13228. 	# Select Statments
13229. # File Actions 
13230. 	# Standard or OS File Actions.
13231. 	# Resume...
13232. 	
13233. 	# your stuff HERE (X)... post zone (file) file actions code.
13234. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
13235. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13236. 		# (X)
13237. 		
13238. 		/* ??? Set window? */
13239. 	
13240. 	# ADD THE GAP
13241. 		
13242. # Vacate (good for diagnostics)
13243. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
13244. 
13245. # DoNotVacate - DO NOT Vacate (recommended)
13246. 
13247. # Vacate
13248. /* AddGap(GapUsedLoc) */
13249. 
13250. # DO Not Vacate
13251. AddGap(GapUsedLoc, DoNotVacate) 
13252. 	
13253. 	
13254. /* ---------------------------------------------------------- */
13255. # (failed) TEST for boolean logic.
13256. 
13257. /* It should work in the gap calculations for turning options */
13258. /* on and off but it will NOT work here. */
13259. 
13260. /* Boolean setting X or FlagX. */
13261. /* Where X will be on or off: */
13262. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
13263. /*      For ON:  (X  *  FlagAny) */
13264. 
13265. /* 1) Failed, zero gap overrode the previous one. */
13266. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
13267. /* AddGap(GapUsedTemp) */ 
13268. 
13269. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
13270. /* AddGap(GapUsedTemp, DoNotVacate) */ 
13271. 
13272. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
13273. 
13274. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
13275. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
13276. /* AddGap(GapUsedTemp) */ 
13277. 
13278. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
13279. /* AddGap(GapUsedTemp, DoNotVacate) */ 
13280. 
13281. /* ---------------------------------------------------------- */
13282. 
13283. # Vacate
13284. /* AddGap(GapUsed) */
13285. 
13286. # DO NOT Vacate (recommended)
13287. /* AddGap(GapUsed, DoNotVacate) */ 
13288. 	
13289. 
13290. 		
13291. # 
13292. FileEnd
13293. /* ---------------------------------------------------------- */
13294. 
13295. # your stuff HERE (X)... post zone (file) code.
13296. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
13297. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13298. 	# (X)
13299. 
13300. SetVariable(FileStepDescription,"Zone finished, reporting.")
13301. # Script: DisplaySetFileStep
13302. 
13303. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13304. 
13305. /* add message and move to a new line. */
13306. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13307. ")
13308. 
13309. /* display the line. (hopefully.) */
13310. # Zone Footer Set Statistics Window Text
13311. 
13312. SetStatisticsWindowText("----------------------------------------------------------
13313. Zones Processed: 
13314. ----------------------------------------------------------
13315. !ZoneListByLine!
13316. ----------------------------------------------------------
13317. Zone Processing Step:
13318. !ZoneStepByLine!    
13319. ----------------------------------------------------------
13320. Current Zone:
13321. !ZoneFooter!
13322. ----------------------------------------------------------
13323. Volume Statistics:
13324. !VolumeStatisticsDetail!
13325. ----------------------------------------------------------
13326. Zone Detailed Report:
13327. ----------------------------------------------------------
13328. !ZoneStatisticsDetail!
13329. ----------------------------------------------------------
13330. ")
13331. 
13332. 
13333. 
13334. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13335. 
13336. # Script: BannerSet
13337. 
13338. # Script: DisplaySetDateTimeRun
13339. 
13340. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
13341. /* Xinclude "..\Display\BannerSet.MyDc"X */
13342. /* pause(1) */
13343. 
13344. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13345. 
13346. Title('!Heading!')
13347. /* pause(1) */
13348. 
13349. /* NOTE: Can't round or truncate to integer precision. */
13350. 
13351. pause(1)
13352. 
13353. # Script: ZoneWhenFinished
13354. 
13355. # Script: BannerSet
13356. 
13357. # Script: DisplaySetDateTimeRun
13358. 
13359. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
13360. /* Xinclude "..\Display\BannerSet.MyDc"X */
13361. /* pause(1) */
13362. 
13363. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13364. 
13365. Title('!Heading!')
13366. /* pause(1) */
13367. 
13368. /* NOTE: Can't round or truncate to integer precision. */
13369. 
13370. # Script: BannerLog
13371. 
13372. AppendLogfile("!LogFileName!", "!Title!")
13373. 
13374. 
13375. 
13376. # Zone Statistics	
13377. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
13378. 
13379. # Footer:
13380. SetVariable(ZoneFooter, "----------------------------------------------------------
13381. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
13382. 
13383. Statistics Report:
13384. ------------------
13385.    Size:  
13386.    ------------------------
13387.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13388.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13389.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13390. 
13391.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13392.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13393. 
13394.    Location:
13395.    ------------------------
13396.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13397.              Files End: !ZoneEndCurrent!
13398.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13399.       
13400.    Gap Settings:
13401.    ------------------------
13402.          Gap Requested: !ZoneGapSizePer!%
13403.       Volume Rounding: !ZoneVolRoundUpPer!%
13404.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13405.                  
13406.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
13407.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
13408.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
13409.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
13410.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
13411.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
13412.      
13413.    Free Space after Zone:
13414.    ------------------------
13415.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13416.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13417.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13418. 
13419. Directory and Files Select:
13420. ---------------------------
13421. !ZoneTypeSelectCurrent!               
13422. ---------------------------
13423. ----------------------------------------------------------
13424. ")
13425. 
13426. AppendLogfile("!LogFileName!", ".")
13427. AppendLogfile("!LogFileName!", "!ZoneFooter!")
13428. AppendLogfile("!LogFileName!", ".")
13429. 
13430. # Zone Footer Set Statistics Window Text
13431. 
13432. SetStatisticsWindowText("----------------------------------------------------------
13433. Zones Processed: 
13434. ----------------------------------------------------------
13435. !ZoneListByLine!
13436. ----------------------------------------------------------
13437. Zone Processing Step:
13438. !ZoneStepByLine!    
13439. ----------------------------------------------------------
13440. Current Zone:
13441. !ZoneFooter!
13442. ----------------------------------------------------------
13443. Volume Statistics:
13444. !VolumeStatisticsDetail!
13445. ----------------------------------------------------------
13446. Zone Detailed Report:
13447. ----------------------------------------------------------
13448. !ZoneStatisticsDetail!
13449. ----------------------------------------------------------
13450. ")
13451. 
13452. 
13453. 
13454. /* pause() */
13455. /* pause() */
13456. 
13457. 
13458. 
13459. 
13460. /* ---------------------------------------------------------- */
13461. 
13462. /* ---------------------------------------------------------- */
13463. /* Zone LinksCorp Links and Corp */
13464. # Script: DefragZoneTypeLinksCorp
13465. /* ---------------------------------------------------------- */
13466. /* Zone LinksCorp Links and Corp */
13467. SetVariable(ZoneLabel, "!ZoneLabelLinksCorp!")
13468. SetVariable(ZoneDescription, "!ZoneDescriptionLinksCorp!")
13469. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpLinksCorp!")
13470. SetVariable(ZoneGapSize, "!ZoneGapSizeLinksCorp!")
13471. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectLinksCorp
13472. # LinksCorp start.
13473. # NotBlobsArchivesBu start.
13474. (not (
13475. # Blobs start.
13476. (
13477. # BlobsAndExceptions start.
13478. ( not(
13479.   FileName("*.bat")
13480.   or FileName("*.css")
13481.   or FileName("*.dll")
13482.   or FileName("*.exe")
13483.   or FileName("*.htm*")
13484.   or FileName("*.jar")
13485.   or FileName("*.js")
13486.   or FileName("*.script")
13487.   or FileName("*.wsf")
13488.   or (
13489. # Databases start.
13490. (
13491.   FileName("*.crypt*")
13492.   or FileName("*.db*")
13493.   or FileName("*.rdb*")
13494.   or FileName("*.dc*")
13495.   or FileName("*.dict*")
13496.   or FileName("*.?db*")
13497.   or FileName("*.?rdb*")
13498.   or FileName("*.md*")
13499.   or FileName("*.myd")
13500.   or FileName("*.ndf")
13501.   or FileName("*.ns?")
13502.   or FileName("*.pab")
13503.   or FileName("*.pst")
13504.   or FileName("*.sd?*")
13505.   or FileName("*.sq**")
13506.   or FileName("*.tmd")
13507.   or FileName("*.tps")
13508.   or FileName("*.tr*")
13509. )
13510. # Databases end.
13511. 
13512.     # BlobsAndExceptions
13513.     or 
13514. # Data start.
13515. (
13516.   DirectoryName("Data*")
13517.   or DirectoryName("Device*")
13518.   or DirectoryName("Export*")
13519.   or DirectoryName("Import*")
13520.   or DirectoryName("Log*")
13521.   or DirectoryName("*Log")
13522.   or DirectoryName("Maintenance*")
13523.   or DirectoryName("Rec*")
13524.   or DirectoryName("Sales*")
13525.   or DirectoryName("Search*")
13526.   or DirectoryName("User*")
13527. )
13528. # Data end.
13529. 
13530.     # BlobsAndExceptions
13531.   )
13532. ) )
13533. # BlobsAndExceptions end.
13534. 
13535. # Blobs
13536. ) and (
13537.   Size(BlobFileSize,0)
13538.   or (
13539.     FileName("*.arj")
13540.     or FileName("*.bup")
13541.     or FileName("*.bz2")
13542.     or FileName("*.chm")
13543.     or FileName("*.dvr-ms")
13544.     or FileName("*.gz")
13545.     or FileName("*.ifo")
13546.     or FileName("*.lzh")
13547.     or FileName("*.pdf")
13548.     or FileName("*.rpm")
13549.     or FileName("*.wmv")
13550.     or FileName("*.vob")
13551.     or FileName("*.z")
13552.   ) 
13553. )
13554. # Blobs end.
13555. 
13556. # NotBlobsArchivesBu
13557. or 
13558. # Archives start.
13559. (
13560.   DirectoryName("*Archive*")
13561.   or DirectoryName("*History*")
13562.   or DirectoryName("*Old")
13563.   or DirectoryName("* Old *")
13564.   or DirectoryName("Old *")
13565. 
13566.   or FileName("*.7z")
13567.   or FileName("*.cab")
13568.   or FileName("*.iso")
13569.   or FileName("*.msi")
13570.   or FileName("*.old")
13571.   or FileName("*.rar")
13572.   or FileName("*.tar")
13573.   or FileName("*.zip")
13574.   or
13575. # WinSysLow start.
13576. (
13577.   DirectoryName("$*")
13578.   or DirectoryName("0*")
13579.   or DirectoryName("1*")
13580.   or DirectoryName("2*")
13581.   or DirectoryName("3*")
13582.   or DirectoryName("4*")
13583.   or DirectoryName("5*")
13584.   or DirectoryName("6*")
13585.   or DirectoryName("7*")
13586.   or DirectoryName("8*")
13587.   or DirectoryName("9*")
13588. 
13589.   or DirectoryName("dllcache")
13590.   or DirectoryName("Downloaded Installations")
13591.   or DirectoryName("Ehome")
13592.   or DirectoryName("Fonts")
13593.   or DirectoryName("Help")
13594.   or DirectoryName("I386")
13595.   or DirectoryName("ie?updates")
13596.   or DirectoryName("Installer")
13597.   or DirectoryName("Installshield Installation Information")
13598.   or DirectoryName("IME")
13599.   or DirectoryName("*RECYCLE*")
13600.   or DirectoryName("ServicePackFiles")
13601.   or DirectoryName("SoftwareDistribution")
13602.   or DirectoryName("Speech")
13603.   or DirectoryName("Symbols")
13604.   or DirectoryName("System Volume Information")
13605.   or DirectoryName("windows.old")
13606. )
13607. # WinSysLow end.
13608. 
13609.   # Archives
13610. )
13611. # Archives end.
13612. 
13613. # NotBlobsArchivesBu
13614. or
13615. # Backups start.
13616. (
13617.   DirectoryName("*Backup*")
13618.   or DirectoryName("*Bu")
13619.   or DirectoryName("* Bu *")
13620.   or DirectoryName("Bu *")
13621. 
13622.   or FileName("*.bak")
13623.   or FileName("* - Copy*")
13624. )
13625. # Backups end.
13626. 
13627. # NotBlobsArchivesBu
13628. ) )
13629. # NotBlobsArchivesBu end.
13630. 
13631. # LinksCorp
13632. and ( 
13633. # Corp start.
13634. (
13635.     DirectoryName("*Corp*") or
13636.     DirectoryName("*Mdm*")
13637. )
13638. # Corp end.
13639. 
13640. # LinksCorp
13641. or 
13642. # Links start.
13643. (
13644.     DirectoryName("*Favorites*") or
13645.     DirectoryName("*Job*") or
13646.     DirectoryName("*Links*")
13647. )
13648. # Links end.
13649. 
13650. # LinksCorp
13651. or 
13652. # Support start.
13653. (
13654.   DirectoryName("*Logs*") or
13655.   DirectoryName("*Support*") or
13656.   DirectoryName("*Maintenance*")
13657. )
13658. # Support end.
13659. 
13660. # LinksCorp
13661. )
13662. # LinksCorp end.
13663. ')
13664. 
13665. 	# Script: ZoneDoHeader
13666. 
13667. # Script: ZoneWhenStarted
13668. 
13669. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
13670. # Script: DisplaySetZone
13671. 
13672. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
13673. SetVariable(FileStepDescription,	"")
13674. 
13675. SetVariable(ZoneStepByLine, 			"Zone started.
13676. ")
13677. 
13678. # Script: BannerDescriptionSet
13679. 
13680. # Script: BannerSet
13681. 
13682. # Script: DisplaySetDateTimeRun
13683. 
13684. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
13685. /* Xinclude "..\Display\BannerSet.MyDc"X */
13686. /* pause(1) */
13687. 
13688. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13689. 
13690. Title('!Heading!')
13691. /* pause(1) */
13692. 
13693. /* NOTE: Can't round or truncate to integer precision. */
13694. 
13695. # Script: BannerLog
13696. 
13697. AppendLogfile("!LogFileName!", "!Title!")
13698. 
13699. 
13700. 
13701. pause(1)
13702. 
13703. 
13704. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
13705. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
13706. 
13707. SetVariable(ZoneStepNoCurrent, 0)
13708. 
13709. 
13710. # Script: ZoneDoCurrentClear
13711. 
13712. SetVariable(ZoneTypeSelectCurrent, 		"")
13713. 
13714. SetVariable(ZoneBeginCurrent, 			0)
13715. SetVariable(ZoneBeginPerCurrent, 		0)
13716. SetVariable(ZoneEndCurrent, 			0)
13717. SetVariable(ZoneEndPerCurrent, 			0)
13718. 
13719. SetVariable(ZoneSizeCurrent,			0)
13720. SetVariable(ZoneSizePerCurrent,			0)
13721. 
13722. SetVariable(ZoneGapRequestedCurrent,	0)
13723. SetVariable(ZoneGapRoundedCurrent, 		0)
13724. SetVariable(ZoneGapAdjustedCurrent, 	0)
13725. SetVariable(ZoneGapAvailableCurrent, 	0)
13726. SetVariable(ZoneGapCurrent,				0)
13727. SetVariable(ZoneGapUsedCurrent, 		0)
13728. 
13729. SetVariable(ZoneGapActualCurrent, 		0)
13730. SetVariable(ZoneGapActualPerCurrent, 	0)
13731. 
13732. SetVariable(ZoneSizeActual, 			0)
13733. SetVariable(ZoneSizeActualCurrent,		0)
13734. 
13735. SetVariable(ZoneEndActual, 				0)
13736. SetVariable(ZoneEndActualCurrent,		0)			
13737. SetVariable(ZoneSizeActualPerCurrent, 	0)
13738.       
13739. SetVariable(ZoneFilesFolders,			0)
13740. SetVariable(ZoneFilesFoldersPer,		0) 
13741. 
13742. SetVariable(ZoneFragments,				0)
13743. SetVariable(ZoneFragmentsPer,			0) 
13744. 		
13745. SetVariable(ZoneEndActualCurrent, 		0)
13746. SetVariable(ZoneEndActualPerCurrent, 	0)
13747. 
13748. # Gap Calculation Methodology:
13749. 	# Requested
13750. 	SetVariable(GapRequested, 			0) 
13751. 	SetVariable(GapRequestedStd, 		0) 
13752. 	SetVariable(GapRequestedMft, 		0) 
13753. 	SetVariable(GapRequestedOs, 		0) 
13754. 	SetVariable(GapRequestedOriginal, 	0) 
13755. 	
13756. 	# Gap Adjustments
13757. 	SetVariable(GapRounded, 			0)
13758. 	# SetVariable(GapAdjusted, 			0)
13759. 	SetVariable(GapAvailable, 			0)
13760. 	SetVariable(GapCurrent, 			0)
13761. 	SetVariable(GapActual, 				0)
13762. 	SetVariable(GapUsed, 				0)
13763. 	
13764. 	# Gap Adjustments
13765. 	SetVariable(GapRoundedLoc, 			0)
13766. 	# SetVariable(GapAdjustedLoc, 		0)
13767. 	SetVariable(GapAvailableLoc, 		0)
13768. 	SetVariable(GapCurrentLoc, 			0)
13769. 	SetVariable(GapActualLoc,			0)
13770. 	SetVariable(GapUsedLoc,				0)
13771. 	
13772. 	# Space usage
13773. 	SetVariable(ZoneFreePerRequested, 	0)
13774. 	SetVariable(ZoneFreePerUsed, 		0)
13775. 
13776. # Gap Size & Rounding
13777. 	SetVariable(ZoneGapSizePer, 		0)
13778. 	SetVariable(ZoneVolRoundUpPer, 		0)
13779. 	
13780. 	# Free Space
13781. 	SetVariable(ZoneFreeUsedPer, 		0)
13782. 	SetVariable(ZoneFreeRequestedPer, 	0)
13783. 
13784. 
13785. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
13786. 
13787. # Footer:
13788. SetVariable(ZoneFooter, "----------------------------------------------------------
13789. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
13790. 
13791. Statistics Report:
13792. ------------------
13793.    Size:  
13794.    ------------------------
13795.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13796.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13797.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13798. 
13799.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13800.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13801. 
13802.    Location:
13803.    ------------------------
13804.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13805.              Files End: !ZoneEndCurrent!
13806.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13807.       
13808.    Gap Settings:
13809.    ------------------------
13810.          Gap Requested: !ZoneGapSizePer!%
13811.       Volume Rounding: !ZoneVolRoundUpPer!%
13812.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13813.                  
13814.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
13815.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
13816.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
13817.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
13818.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
13819.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
13820.      
13821.    Free Space after Zone:
13822.    ------------------------
13823.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13824.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13825.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13826. 
13827. Directory and Files Select:
13828. ---------------------------
13829. !ZoneTypeSelectCurrent!               
13830. ---------------------------
13831. ----------------------------------------------------------
13832. ")
13833. 
13834. # Script: BannerSet
13835. 
13836. # Script: DisplaySetDateTimeRun
13837. 
13838. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
13839. /* Xinclude "..\Display\BannerSet.MyDc"X */
13840. /* pause(1) */
13841. 
13842. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13843. 
13844. Title('!Heading!')
13845. /* pause(1) */
13846. 
13847. /* NOTE: Can't round or truncate to integer precision. */
13848. 
13849. # Script: BannerLog
13850. 
13851. AppendLogfile("!LogFileName!", "!Title!")
13852. 
13853. 
13854. 
13855. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
13856. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
13857. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:50")
13858. 
13859. SetVariable(ZoneListByLine, "!ZoneListByLine!
13860. Zone: !ZoneNoCurrent! 2021-11-09 18:53:50 0:00:06 !ZoneLabel! !ZoneDescription!")
13861. 
13862. 
13863. /* Fixed Zone Position Handling */
13864. /* Literal number: */
13865. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
13866. /* Percentage of disk: */
13867. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
13868. /* Gap */
13869. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
13870. 
13871. /* ---------------------------------------------------------- */
13872. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
13873. # Script: DisplaySetFileStep
13874. 
13875. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13876. 
13877. /* add message and move to a new line. */
13878. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13879. ")
13880. 
13881. /* display the line. (hopefully.) */
13882. # Zone Footer Set Statistics Window Text
13883. 
13884. SetStatisticsWindowText("----------------------------------------------------------
13885. Zones Processed: 
13886. ----------------------------------------------------------
13887. !ZoneListByLine!
13888. ----------------------------------------------------------
13889. Zone Processing Step:
13890. !ZoneStepByLine!    
13891. ----------------------------------------------------------
13892. Current Zone:
13893. !ZoneFooter!
13894. ----------------------------------------------------------
13895. Volume Statistics:
13896. !VolumeStatisticsDetail!
13897. ----------------------------------------------------------
13898. Zone Detailed Report:
13899. ----------------------------------------------------------
13900. !ZoneStatisticsDetail!
13901. ----------------------------------------------------------
13902. ")
13903. 
13904. 
13905. 
13906. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13907. 
13908. # Script: BannerSet
13909. 
13910. # Script: DisplaySetDateTimeRun
13911. 
13912. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
13913. /* Xinclude "..\Display\BannerSet.MyDc"X */
13914. /* pause(1) */
13915. 
13916. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13917. 
13918. Title('!Heading!')
13919. /* pause(1) */
13920. 
13921. /* NOTE: Can't round or truncate to integer precision. */
13922. 
13923. pause(1)
13924. 
13925. # your stuff HERE (X)... pre file select code.
13926. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
13927. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
13928. 	# (X)
13929. 
13930. FileSelect
13931. 
13932. 	# your stuff can't really go here (errors.)
13933. 	# maybe for some reason I don't know of...
13934. 	
13935. 	# Actions next...
13936. 	# Script: ZoneDo ZoneTypeSelectLinksCorp
13937. # LinksCorp start.
13938. # NotBlobsArchivesBu start.
13939. (not (
13940. # Blobs start.
13941. (
13942. # BlobsAndExceptions start.
13943. ( not(
13944.   FileName("*.bat")
13945.   or FileName("*.css")
13946.   or FileName("*.dll")
13947.   or FileName("*.exe")
13948.   or FileName("*.htm*")
13949.   or FileName("*.jar")
13950.   or FileName("*.js")
13951.   or FileName("*.script")
13952.   or FileName("*.wsf")
13953.   or (
13954. # Databases start.
13955. (
13956.   FileName("*.crypt*")
13957.   or FileName("*.db*")
13958.   or FileName("*.rdb*")
13959.   or FileName("*.dc*")
13960.   or FileName("*.dict*")
13961.   or FileName("*.?db*")
13962.   or FileName("*.?rdb*")
13963.   or FileName("*.md*")
13964.   or FileName("*.myd")
13965.   or FileName("*.ndf")
13966.   or FileName("*.ns?")
13967.   or FileName("*.pab")
13968.   or FileName("*.pst")
13969.   or FileName("*.sd?*")
13970.   or FileName("*.sq**")
13971.   or FileName("*.tmd")
13972.   or FileName("*.tps")
13973.   or FileName("*.tr*")
13974. )
13975. # Databases end.
13976. 
13977.     # BlobsAndExceptions
13978.     or 
13979. # Data start.
13980. (
13981.   DirectoryName("Data*")
13982.   or DirectoryName("Device*")
13983.   or DirectoryName("Export*")
13984.   or DirectoryName("Import*")
13985.   or DirectoryName("Log*")
13986.   or DirectoryName("*Log")
13987.   or DirectoryName("Maintenance*")
13988.   or DirectoryName("Rec*")
13989.   or DirectoryName("Sales*")
13990.   or DirectoryName("Search*")
13991.   or DirectoryName("User*")
13992. )
13993. # Data end.
13994. 
13995.     # BlobsAndExceptions
13996.   )
13997. ) )
13998. # BlobsAndExceptions end.
13999. 
14000. # Blobs
14001. ) and (
14002.   Size(BlobFileSize,0)
14003.   or (
14004.     FileName("*.arj")
14005.     or FileName("*.bup")
14006.     or FileName("*.bz2")
14007.     or FileName("*.chm")
14008.     or FileName("*.dvr-ms")
14009.     or FileName("*.gz")
14010.     or FileName("*.ifo")
14011.     or FileName("*.lzh")
14012.     or FileName("*.pdf")
14013.     or FileName("*.rpm")
14014.     or FileName("*.wmv")
14015.     or FileName("*.vob")
14016.     or FileName("*.z")
14017.   ) 
14018. )
14019. # Blobs end.
14020. 
14021. # NotBlobsArchivesBu
14022. or 
14023. # Archives start.
14024. (
14025.   DirectoryName("*Archive*")
14026.   or DirectoryName("*History*")
14027.   or DirectoryName("*Old")
14028.   or DirectoryName("* Old *")
14029.   or DirectoryName("Old *")
14030. 
14031.   or FileName("*.7z")
14032.   or FileName("*.cab")
14033.   or FileName("*.iso")
14034.   or FileName("*.msi")
14035.   or FileName("*.old")
14036.   or FileName("*.rar")
14037.   or FileName("*.tar")
14038.   or FileName("*.zip")
14039.   or
14040. # WinSysLow start.
14041. (
14042.   DirectoryName("$*")
14043.   or DirectoryName("0*")
14044.   or DirectoryName("1*")
14045.   or DirectoryName("2*")
14046.   or DirectoryName("3*")
14047.   or DirectoryName("4*")
14048.   or DirectoryName("5*")
14049.   or DirectoryName("6*")
14050.   or DirectoryName("7*")
14051.   or DirectoryName("8*")
14052.   or DirectoryName("9*")
14053. 
14054.   or DirectoryName("dllcache")
14055.   or DirectoryName("Downloaded Installations")
14056.   or DirectoryName("Ehome")
14057.   or DirectoryName("Fonts")
14058.   or DirectoryName("Help")
14059.   or DirectoryName("I386")
14060.   or DirectoryName("ie?updates")
14061.   or DirectoryName("Installer")
14062.   or DirectoryName("Installshield Installation Information")
14063.   or DirectoryName("IME")
14064.   or DirectoryName("*RECYCLE*")
14065.   or DirectoryName("ServicePackFiles")
14066.   or DirectoryName("SoftwareDistribution")
14067.   or DirectoryName("Speech")
14068.   or DirectoryName("Symbols")
14069.   or DirectoryName("System Volume Information")
14070.   or DirectoryName("windows.old")
14071. )
14072. # WinSysLow end.
14073. 
14074.   # Archives
14075. )
14076. # Archives end.
14077. 
14078. # NotBlobsArchivesBu
14079. or
14080. # Backups start.
14081. (
14082.   DirectoryName("*Backup*")
14083.   or DirectoryName("*Bu")
14084.   or DirectoryName("* Bu *")
14085.   or DirectoryName("Bu *")
14086. 
14087.   or FileName("*.bak")
14088.   or FileName("* - Copy*")
14089. )
14090. # Backups end.
14091. 
14092. # NotBlobsArchivesBu
14093. ) )
14094. # NotBlobsArchivesBu end.
14095. 
14096. # LinksCorp
14097. and ( 
14098. # Corp start.
14099. (
14100.     DirectoryName("*Corp*") or
14101.     DirectoryName("*Mdm*")
14102. )
14103. # Corp end.
14104. 
14105. # LinksCorp
14106. or 
14107. # Links start.
14108. (
14109.     DirectoryName("*Favorites*") or
14110.     DirectoryName("*Job*") or
14111.     DirectoryName("*Links*")
14112. )
14113. # Links end.
14114. 
14115. # LinksCorp
14116. or 
14117. # Support start.
14118. (
14119.   DirectoryName("*Logs*") or
14120.   DirectoryName("*Support*") or
14121.   DirectoryName("*Maintenance*")
14122. )
14123. # Support end.
14124. 
14125. # LinksCorp
14126. )
14127. # LinksCorp end.
14128. 
14129. 	# Script: ZoneDoAction
14130. # Zone Do File Action - SortByName.
14131. 
14132. FileActions
14133. 
14134. 	# Footer:
14135. SetVariable(ZoneFooter, "----------------------------------------------------------
14136. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
14137. 
14138. Statistics Report:
14139. ------------------
14140.    Size:  
14141.    ------------------------
14142.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14143.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14144.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14145. 
14146.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14147.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14148. 
14149.    Location:
14150.    ------------------------
14151.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14152.              Files End: !ZoneEndCurrent!
14153.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14154.       
14155.    Gap Settings:
14156.    ------------------------
14157.          Gap Requested: !ZoneGapSizePer!%
14158.       Volume Rounding: !ZoneVolRoundUpPer!%
14159.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14160.                  
14161.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
14162.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
14163.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
14164.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
14165.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
14166.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
14167.      
14168.    Free Space after Zone:
14169.    ------------------------
14170.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14171.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14172.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14173. 
14174. Directory and Files Select:
14175. ---------------------------
14176. !ZoneTypeSelectCurrent!               
14177. ---------------------------
14178. ----------------------------------------------------------
14179. ")
14180. 	SetStatisticsWindowText("!ZoneFooter!")
14181. 	
14182. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
14183. 	# Script: DisplaySetFileStep
14184. 
14185. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14186. 
14187. /* add message and move to a new line. */
14188. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14189. ")
14190. 
14191. /* display the line. (hopefully.) */
14192. # Zone Footer Set Statistics Window Text
14193. 
14194. SetStatisticsWindowText("----------------------------------------------------------
14195. Zones Processed: 
14196. ----------------------------------------------------------
14197. !ZoneListByLine!
14198. ----------------------------------------------------------
14199. Zone Processing Step:
14200. !ZoneStepByLine!    
14201. ----------------------------------------------------------
14202. Current Zone:
14203. !ZoneFooter!
14204. ----------------------------------------------------------
14205. Volume Statistics:
14206. !VolumeStatisticsDetail!
14207. ----------------------------------------------------------
14208. Zone Detailed Report:
14209. ----------------------------------------------------------
14210. !ZoneStatisticsDetail!
14211. ----------------------------------------------------------
14212. ")
14213. 
14214. 
14215. 
14216. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14217. 
14218. # Script: BannerSet
14219. 
14220. # Script: DisplaySetDateTimeRun
14221. 
14222. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
14223. /* Xinclude "..\Display\BannerSet.MyDc"X */
14224. /* pause(1) */
14225. 
14226. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14227. 
14228. Title('!Heading!')
14229. /* pause(1) */
14230. 
14231. /* NOTE: Can't round or truncate to integer precision. */
14232. 
14233. pause(1)
14234. 
14235. # Commands:
14236. 
14237. /* Moves to Zone or above it. */
14238. # MoveUpToZone()
14239. 
14240. # Defrag
14241. 
14242. # Defragment(OPTIONS)
14243. 
14244. /* Shuffles files around trying to make a big enough gap for fragmented files. */
14245. # Defragment()
14246. 
14247. /* Only does files where a gap will fit it. */
14248. # Defragment(Fast)
14249. 
14250. /* Skips fragmented files larger than the Chunck Size.
14251. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
14252. # Defragment(Chunk Size)
14253. 
14254. /* Moves down to zone and packs zone to beginning if there are gaps. */
14255. /* Can be similar in performance to doing a SortBy. */
14256. # MoveDownFill()
14257. 
14258. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
14259. 
14260. 
14261. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
14262. 	# Script: DisplaySetFileStep
14263. 
14264. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14265. 
14266. /* add message and move to a new line. */
14267. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14268. ")
14269. 
14270. /* display the line. (hopefully.) */
14271. # Zone Footer Set Statistics Window Text
14272. 
14273. SetStatisticsWindowText("----------------------------------------------------------
14274. Zones Processed: 
14275. ----------------------------------------------------------
14276. !ZoneListByLine!
14277. ----------------------------------------------------------
14278. Zone Processing Step:
14279. !ZoneStepByLine!    
14280. ----------------------------------------------------------
14281. Current Zone:
14282. !ZoneFooter!
14283. ----------------------------------------------------------
14284. Volume Statistics:
14285. !VolumeStatisticsDetail!
14286. ----------------------------------------------------------
14287. Zone Detailed Report:
14288. ----------------------------------------------------------
14289. !ZoneStatisticsDetail!
14290. ----------------------------------------------------------
14291. ")
14292. 
14293. 
14294. 
14295. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14296. 
14297. # Script: BannerSet
14298. 
14299. # Script: DisplaySetDateTimeRun
14300. 
14301. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
14302. /* Xinclude "..\Display\BannerSet.MyDc"X */
14303. /* pause(1) */
14304. 
14305. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14306. 
14307. Title('!Heading!')
14308. /* pause(1) */
14309. 
14310. /* NOTE: Can't round or truncate to integer precision. */
14311. 
14312. pause(1)
14313. 
14314. 	# Script: ZoneDoFooter
14315. 
14316. /* ---------------------------------------------------------- */
14317. # File Select
14318. 	# Select Statments
14319. # File Actions 
14320. 	# Standard or OS File Actions.
14321. 	# Resume...
14322. 	
14323. 	# your stuff HERE (X)... post zone (file) file actions code.
14324. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
14325. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14326. 		# (X)
14327. 		
14328. 		/* ??? Set window? */
14329. 	
14330. 	# ADD THE GAP
14331. 		
14332. # Vacate (good for diagnostics)
14333. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
14334. 
14335. # DoNotVacate - DO NOT Vacate (recommended)
14336. 
14337. # Vacate
14338. /* AddGap(GapUsedLoc) */
14339. 
14340. # DO Not Vacate
14341. AddGap(GapUsedLoc, DoNotVacate) 
14342. 	
14343. 	
14344. /* ---------------------------------------------------------- */
14345. # (failed) TEST for boolean logic.
14346. 
14347. /* It should work in the gap calculations for turning options */
14348. /* on and off but it will NOT work here. */
14349. 
14350. /* Boolean setting X or FlagX. */
14351. /* Where X will be on or off: */
14352. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
14353. /*      For ON:  (X  *  FlagAny) */
14354. 
14355. /* 1) Failed, zero gap overrode the previous one. */
14356. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
14357. /* AddGap(GapUsedTemp) */ 
14358. 
14359. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
14360. /* AddGap(GapUsedTemp, DoNotVacate) */ 
14361. 
14362. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
14363. 
14364. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
14365. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
14366. /* AddGap(GapUsedTemp) */ 
14367. 
14368. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
14369. /* AddGap(GapUsedTemp, DoNotVacate) */ 
14370. 
14371. /* ---------------------------------------------------------- */
14372. 
14373. # Vacate
14374. /* AddGap(GapUsed) */
14375. 
14376. # DO NOT Vacate (recommended)
14377. /* AddGap(GapUsed, DoNotVacate) */ 
14378. 	
14379. 
14380. 		
14381. # 
14382. FileEnd
14383. /* ---------------------------------------------------------- */
14384. 
14385. # your stuff HERE (X)... post zone (file) code.
14386. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
14387. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
14388. 	# (X)
14389. 
14390. SetVariable(FileStepDescription,"Zone finished, reporting.")
14391. # Script: DisplaySetFileStep
14392. 
14393. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14394. 
14395. /* add message and move to a new line. */
14396. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14397. ")
14398. 
14399. /* display the line. (hopefully.) */
14400. # Zone Footer Set Statistics Window Text
14401. 
14402. SetStatisticsWindowText("----------------------------------------------------------
14403. Zones Processed: 
14404. ----------------------------------------------------------
14405. !ZoneListByLine!
14406. ----------------------------------------------------------
14407. Zone Processing Step:
14408. !ZoneStepByLine!    
14409. ----------------------------------------------------------
14410. Current Zone:
14411. !ZoneFooter!
14412. ----------------------------------------------------------
14413. Volume Statistics:
14414. !VolumeStatisticsDetail!
14415. ----------------------------------------------------------
14416. Zone Detailed Report:
14417. ----------------------------------------------------------
14418. !ZoneStatisticsDetail!
14419. ----------------------------------------------------------
14420. ")
14421. 
14422. 
14423. 
14424. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14425. 
14426. # Script: BannerSet
14427. 
14428. # Script: DisplaySetDateTimeRun
14429. 
14430. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
14431. /* Xinclude "..\Display\BannerSet.MyDc"X */
14432. /* pause(1) */
14433. 
14434. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14435. 
14436. Title('!Heading!')
14437. /* pause(1) */
14438. 
14439. /* NOTE: Can't round or truncate to integer precision. */
14440. 
14441. pause(1)
14442. 
14443. # Script: ZoneWhenFinished
14444. 
14445. # Script: BannerSet
14446. 
14447. # Script: DisplaySetDateTimeRun
14448. 
14449. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
14450. /* Xinclude "..\Display\BannerSet.MyDc"X */
14451. /* pause(1) */
14452. 
14453. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14454. 
14455. Title('!Heading!')
14456. /* pause(1) */
14457. 
14458. /* NOTE: Can't round or truncate to integer precision. */
14459. 
14460. # Script: BannerLog
14461. 
14462. AppendLogfile("!LogFileName!", "!Title!")
14463. 
14464. 
14465. 
14466. # Zone Statistics	
14467. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
14468. 
14469. # Footer:
14470. SetVariable(ZoneFooter, "----------------------------------------------------------
14471. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
14472. 
14473. Statistics Report:
14474. ------------------
14475.    Size:  
14476.    ------------------------
14477.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14478.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14479.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14480. 
14481.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14482.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14483. 
14484.    Location:
14485.    ------------------------
14486.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14487.              Files End: !ZoneEndCurrent!
14488.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14489.       
14490.    Gap Settings:
14491.    ------------------------
14492.          Gap Requested: !ZoneGapSizePer!%
14493.       Volume Rounding: !ZoneVolRoundUpPer!%
14494.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14495.                  
14496.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
14497.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
14498.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
14499.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
14500.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
14501.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
14502.      
14503.    Free Space after Zone:
14504.    ------------------------
14505.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14506.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14507.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14508. 
14509. Directory and Files Select:
14510. ---------------------------
14511. !ZoneTypeSelectCurrent!               
14512. ---------------------------
14513. ----------------------------------------------------------
14514. ")
14515. 
14516. AppendLogfile("!LogFileName!", ".")
14517. AppendLogfile("!LogFileName!", "!ZoneFooter!")
14518. AppendLogfile("!LogFileName!", ".")
14519. 
14520. # Zone Footer Set Statistics Window Text
14521. 
14522. SetStatisticsWindowText("----------------------------------------------------------
14523. Zones Processed: 
14524. ----------------------------------------------------------
14525. !ZoneListByLine!
14526. ----------------------------------------------------------
14527. Zone Processing Step:
14528. !ZoneStepByLine!    
14529. ----------------------------------------------------------
14530. Current Zone:
14531. !ZoneFooter!
14532. ----------------------------------------------------------
14533. Volume Statistics:
14534. !VolumeStatisticsDetail!
14535. ----------------------------------------------------------
14536. Zone Detailed Report:
14537. ----------------------------------------------------------
14538. !ZoneStatisticsDetail!
14539. ----------------------------------------------------------
14540. ")
14541. 
14542. 
14543. 
14544. /* pause() */
14545. /* pause() */
14546. 
14547. 
14548. 
14549. 
14550. /* ---------------------------------------------------------- */
14551. 
14552. 
14553. /* ---------------------------------------------------------- */
14554. /* Zone People */
14555. # Script: DefragZoneTypePeople
14556. /* ---------------------------------------------------------- */
14557. /* Zone People */
14558. SetVariable(ZoneLabel, "!ZoneLabelPeople!")
14559. SetVariable(ZoneDescription, "!ZoneDescriptionPeople!")
14560. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpPeople!")
14561. SetVariable(ZoneGapSize, "!ZoneGapSizePeople!")
14562. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectPeople
14563. # People start.
14564. # NotBlobsArchivesBu start.
14565. (not (
14566. # Blobs start.
14567. (
14568. # BlobsAndExceptions start.
14569. ( not(
14570.   FileName("*.bat")
14571.   or FileName("*.css")
14572.   or FileName("*.dll")
14573.   or FileName("*.exe")
14574.   or FileName("*.htm*")
14575.   or FileName("*.jar")
14576.   or FileName("*.js")
14577.   or FileName("*.script")
14578.   or FileName("*.wsf")
14579.   or (
14580. # Databases start.
14581. (
14582.   FileName("*.crypt*")
14583.   or FileName("*.db*")
14584.   or FileName("*.rdb*")
14585.   or FileName("*.dc*")
14586.   or FileName("*.dict*")
14587.   or FileName("*.?db*")
14588.   or FileName("*.?rdb*")
14589.   or FileName("*.md*")
14590.   or FileName("*.myd")
14591.   or FileName("*.ndf")
14592.   or FileName("*.ns?")
14593.   or FileName("*.pab")
14594.   or FileName("*.pst")
14595.   or FileName("*.sd?*")
14596.   or FileName("*.sq**")
14597.   or FileName("*.tmd")
14598.   or FileName("*.tps")
14599.   or FileName("*.tr*")
14600. )
14601. # Databases end.
14602. 
14603.     # BlobsAndExceptions
14604.     or 
14605. # Data start.
14606. (
14607.   DirectoryName("Data*")
14608.   or DirectoryName("Device*")
14609.   or DirectoryName("Export*")
14610.   or DirectoryName("Import*")
14611.   or DirectoryName("Log*")
14612.   or DirectoryName("*Log")
14613.   or DirectoryName("Maintenance*")
14614.   or DirectoryName("Rec*")
14615.   or DirectoryName("Sales*")
14616.   or DirectoryName("Search*")
14617.   or DirectoryName("User*")
14618. )
14619. # Data end.
14620. 
14621.     # BlobsAndExceptions
14622.   )
14623. ) )
14624. # BlobsAndExceptions end.
14625. 
14626. # Blobs
14627. ) and (
14628.   Size(BlobFileSize,0)
14629.   or (
14630.     FileName("*.arj")
14631.     or FileName("*.bup")
14632.     or FileName("*.bz2")
14633.     or FileName("*.chm")
14634.     or FileName("*.dvr-ms")
14635.     or FileName("*.gz")
14636.     or FileName("*.ifo")
14637.     or FileName("*.lzh")
14638.     or FileName("*.pdf")
14639.     or FileName("*.rpm")
14640.     or FileName("*.wmv")
14641.     or FileName("*.vob")
14642.     or FileName("*.z")
14643.   ) 
14644. )
14645. # Blobs end.
14646. 
14647. # NotBlobsArchivesBu
14648. or 
14649. # Archives start.
14650. (
14651.   DirectoryName("*Archive*")
14652.   or DirectoryName("*History*")
14653.   or DirectoryName("*Old")
14654.   or DirectoryName("* Old *")
14655.   or DirectoryName("Old *")
14656. 
14657.   or FileName("*.7z")
14658.   or FileName("*.cab")
14659.   or FileName("*.iso")
14660.   or FileName("*.msi")
14661.   or FileName("*.old")
14662.   or FileName("*.rar")
14663.   or FileName("*.tar")
14664.   or FileName("*.zip")
14665.   or
14666. # WinSysLow start.
14667. (
14668.   DirectoryName("$*")
14669.   or DirectoryName("0*")
14670.   or DirectoryName("1*")
14671.   or DirectoryName("2*")
14672.   or DirectoryName("3*")
14673.   or DirectoryName("4*")
14674.   or DirectoryName("5*")
14675.   or DirectoryName("6*")
14676.   or DirectoryName("7*")
14677.   or DirectoryName("8*")
14678.   or DirectoryName("9*")
14679. 
14680.   or DirectoryName("dllcache")
14681.   or DirectoryName("Downloaded Installations")
14682.   or DirectoryName("Ehome")
14683.   or DirectoryName("Fonts")
14684.   or DirectoryName("Help")
14685.   or DirectoryName("I386")
14686.   or DirectoryName("ie?updates")
14687.   or DirectoryName("Installer")
14688.   or DirectoryName("Installshield Installation Information")
14689.   or DirectoryName("IME")
14690.   or DirectoryName("*RECYCLE*")
14691.   or DirectoryName("ServicePackFiles")
14692.   or DirectoryName("SoftwareDistribution")
14693.   or DirectoryName("Speech")
14694.   or DirectoryName("Symbols")
14695.   or DirectoryName("System Volume Information")
14696.   or DirectoryName("windows.old")
14697. )
14698. # WinSysLow end.
14699. 
14700.   # Archives
14701. )
14702. # Archives end.
14703. 
14704. # NotBlobsArchivesBu
14705. or
14706. # Backups start.
14707. (
14708.   DirectoryName("*Backup*")
14709.   or DirectoryName("*Bu")
14710.   or DirectoryName("* Bu *")
14711.   or DirectoryName("Bu *")
14712. 
14713.   or FileName("*.bak")
14714.   or FileName("* - Copy*")
14715. )
14716. # Backups end.
14717. 
14718. # NotBlobsArchivesBu
14719. ) )
14720. # NotBlobsArchivesBu end.
14721. 
14722. # People
14723. and (
14724. # People start.
14725. (
14726.   DirectoryName("*Capture*")
14727.   or DirectoryName("*Document*")
14728.   or DirectoryName("*Download*")
14729.   or DirectoryName("*Kids*")
14730.   or DirectoryName("Mail*")
14731.   or DirectoryName("*Mail")
14732.   or DirectoryName("My*")
14733.   or DirectoryName("*Person*")
14734.   or DirectoryName("Private*")
14735.   or DirectoryName("Users")
14736.   
14737.   # Individual People HERE:
14738.   or DirectoryName("Dgh*")
14739. )
14740. # People end.
14741. 
14742. # People
14743. )
14744. # People end.
14745. ')
14746. 
14747. 	# Script: ZoneDoHeader
14748. 
14749. # Script: ZoneWhenStarted
14750. 
14751. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
14752. # Script: DisplaySetZone
14753. 
14754. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
14755. SetVariable(FileStepDescription,	"")
14756. 
14757. SetVariable(ZoneStepByLine, 			"Zone started.
14758. ")
14759. 
14760. # Script: BannerDescriptionSet
14761. 
14762. # Script: BannerSet
14763. 
14764. # Script: DisplaySetDateTimeRun
14765. 
14766. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
14767. /* Xinclude "..\Display\BannerSet.MyDc"X */
14768. /* pause(1) */
14769. 
14770. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14771. 
14772. Title('!Heading!')
14773. /* pause(1) */
14774. 
14775. /* NOTE: Can't round or truncate to integer precision. */
14776. 
14777. # Script: BannerLog
14778. 
14779. AppendLogfile("!LogFileName!", "!Title!")
14780. 
14781. 
14782. 
14783. pause(1)
14784. 
14785. 
14786. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
14787. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
14788. 
14789. SetVariable(ZoneStepNoCurrent, 0)
14790. 
14791. 
14792. # Script: ZoneDoCurrentClear
14793. 
14794. SetVariable(ZoneTypeSelectCurrent, 		"")
14795. 
14796. SetVariable(ZoneBeginCurrent, 			0)
14797. SetVariable(ZoneBeginPerCurrent, 		0)
14798. SetVariable(ZoneEndCurrent, 			0)
14799. SetVariable(ZoneEndPerCurrent, 			0)
14800. 
14801. SetVariable(ZoneSizeCurrent,			0)
14802. SetVariable(ZoneSizePerCurrent,			0)
14803. 
14804. SetVariable(ZoneGapRequestedCurrent,	0)
14805. SetVariable(ZoneGapRoundedCurrent, 		0)
14806. SetVariable(ZoneGapAdjustedCurrent, 	0)
14807. SetVariable(ZoneGapAvailableCurrent, 	0)
14808. SetVariable(ZoneGapCurrent,				0)
14809. SetVariable(ZoneGapUsedCurrent, 		0)
14810. 
14811. SetVariable(ZoneGapActualCurrent, 		0)
14812. SetVariable(ZoneGapActualPerCurrent, 	0)
14813. 
14814. SetVariable(ZoneSizeActual, 			0)
14815. SetVariable(ZoneSizeActualCurrent,		0)
14816. 
14817. SetVariable(ZoneEndActual, 				0)
14818. SetVariable(ZoneEndActualCurrent,		0)			
14819. SetVariable(ZoneSizeActualPerCurrent, 	0)
14820.       
14821. SetVariable(ZoneFilesFolders,			0)
14822. SetVariable(ZoneFilesFoldersPer,		0) 
14823. 
14824. SetVariable(ZoneFragments,				0)
14825. SetVariable(ZoneFragmentsPer,			0) 
14826. 		
14827. SetVariable(ZoneEndActualCurrent, 		0)
14828. SetVariable(ZoneEndActualPerCurrent, 	0)
14829. 
14830. # Gap Calculation Methodology:
14831. 	# Requested
14832. 	SetVariable(GapRequested, 			0) 
14833. 	SetVariable(GapRequestedStd, 		0) 
14834. 	SetVariable(GapRequestedMft, 		0) 
14835. 	SetVariable(GapRequestedOs, 		0) 
14836. 	SetVariable(GapRequestedOriginal, 	0) 
14837. 	
14838. 	# Gap Adjustments
14839. 	SetVariable(GapRounded, 			0)
14840. 	# SetVariable(GapAdjusted, 			0)
14841. 	SetVariable(GapAvailable, 			0)
14842. 	SetVariable(GapCurrent, 			0)
14843. 	SetVariable(GapActual, 				0)
14844. 	SetVariable(GapUsed, 				0)
14845. 	
14846. 	# Gap Adjustments
14847. 	SetVariable(GapRoundedLoc, 			0)
14848. 	# SetVariable(GapAdjustedLoc, 		0)
14849. 	SetVariable(GapAvailableLoc, 		0)
14850. 	SetVariable(GapCurrentLoc, 			0)
14851. 	SetVariable(GapActualLoc,			0)
14852. 	SetVariable(GapUsedLoc,				0)
14853. 	
14854. 	# Space usage
14855. 	SetVariable(ZoneFreePerRequested, 	0)
14856. 	SetVariable(ZoneFreePerUsed, 		0)
14857. 
14858. # Gap Size & Rounding
14859. 	SetVariable(ZoneGapSizePer, 		0)
14860. 	SetVariable(ZoneVolRoundUpPer, 		0)
14861. 	
14862. 	# Free Space
14863. 	SetVariable(ZoneFreeUsedPer, 		0)
14864. 	SetVariable(ZoneFreeRequestedPer, 	0)
14865. 
14866. 
14867. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
14868. 
14869. # Footer:
14870. SetVariable(ZoneFooter, "----------------------------------------------------------
14871. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
14872. 
14873. Statistics Report:
14874. ------------------
14875.    Size:  
14876.    ------------------------
14877.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14878.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14879.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14880. 
14881.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14882.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14883. 
14884.    Location:
14885.    ------------------------
14886.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14887.              Files End: !ZoneEndCurrent!
14888.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14889.       
14890.    Gap Settings:
14891.    ------------------------
14892.          Gap Requested: !ZoneGapSizePer!%
14893.       Volume Rounding: !ZoneVolRoundUpPer!%
14894.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14895.                  
14896.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
14897.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
14898.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
14899.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
14900.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
14901.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
14902.      
14903.    Free Space after Zone:
14904.    ------------------------
14905.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14906.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14907.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14908. 
14909. Directory and Files Select:
14910. ---------------------------
14911. !ZoneTypeSelectCurrent!               
14912. ---------------------------
14913. ----------------------------------------------------------
14914. ")
14915. 
14916. # Script: BannerSet
14917. 
14918. # Script: DisplaySetDateTimeRun
14919. 
14920. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
14921. /* Xinclude "..\Display\BannerSet.MyDc"X */
14922. /* pause(1) */
14923. 
14924. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14925. 
14926. Title('!Heading!')
14927. /* pause(1) */
14928. 
14929. /* NOTE: Can't round or truncate to integer precision. */
14930. 
14931. # Script: BannerLog
14932. 
14933. AppendLogfile("!LogFileName!", "!Title!")
14934. 
14935. 
14936. 
14937. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
14938. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
14939. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:50")
14940. 
14941. SetVariable(ZoneListByLine, "!ZoneListByLine!
14942. Zone: !ZoneNoCurrent! 2021-11-09 18:53:50 0:00:06 !ZoneLabel! !ZoneDescription!")
14943. 
14944. 
14945. /* Fixed Zone Position Handling */
14946. /* Literal number: */
14947. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
14948. /* Percentage of disk: */
14949. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
14950. /* Gap */
14951. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
14952. 
14953. /* ---------------------------------------------------------- */
14954. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
14955. # Script: DisplaySetFileStep
14956. 
14957. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14958. 
14959. /* add message and move to a new line. */
14960. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14961. ")
14962. 
14963. /* display the line. (hopefully.) */
14964. # Zone Footer Set Statistics Window Text
14965. 
14966. SetStatisticsWindowText("----------------------------------------------------------
14967. Zones Processed: 
14968. ----------------------------------------------------------
14969. !ZoneListByLine!
14970. ----------------------------------------------------------
14971. Zone Processing Step:
14972. !ZoneStepByLine!    
14973. ----------------------------------------------------------
14974. Current Zone:
14975. !ZoneFooter!
14976. ----------------------------------------------------------
14977. Volume Statistics:
14978. !VolumeStatisticsDetail!
14979. ----------------------------------------------------------
14980. Zone Detailed Report:
14981. ----------------------------------------------------------
14982. !ZoneStatisticsDetail!
14983. ----------------------------------------------------------
14984. ")
14985. 
14986. 
14987. 
14988. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14989. 
14990. # Script: BannerSet
14991. 
14992. # Script: DisplaySetDateTimeRun
14993. 
14994. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
14995. /* Xinclude "..\Display\BannerSet.MyDc"X */
14996. /* pause(1) */
14997. 
14998. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14999. 
15000. Title('!Heading!')
15001. /* pause(1) */
15002. 
15003. /* NOTE: Can't round or truncate to integer precision. */
15004. 
15005. pause(1)
15006. 
15007. # your stuff HERE (X)... pre file select code.
15008. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
15009. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15010. 	# (X)
15011. 
15012. FileSelect
15013. 
15014. 	# your stuff can't really go here (errors.)
15015. 	# maybe for some reason I don't know of...
15016. 	
15017. 	# Actions next...
15018. 	# Script: ZoneDo ZoneTypeSelectPeople
15019. # People start.
15020. # NotBlobsArchivesBu start.
15021. (not (
15022. # Blobs start.
15023. (
15024. # BlobsAndExceptions start.
15025. ( not(
15026.   FileName("*.bat")
15027.   or FileName("*.css")
15028.   or FileName("*.dll")
15029.   or FileName("*.exe")
15030.   or FileName("*.htm*")
15031.   or FileName("*.jar")
15032.   or FileName("*.js")
15033.   or FileName("*.script")
15034.   or FileName("*.wsf")
15035.   or (
15036. # Databases start.
15037. (
15038.   FileName("*.crypt*")
15039.   or FileName("*.db*")
15040.   or FileName("*.rdb*")
15041.   or FileName("*.dc*")
15042.   or FileName("*.dict*")
15043.   or FileName("*.?db*")
15044.   or FileName("*.?rdb*")
15045.   or FileName("*.md*")
15046.   or FileName("*.myd")
15047.   or FileName("*.ndf")
15048.   or FileName("*.ns?")
15049.   or FileName("*.pab")
15050.   or FileName("*.pst")
15051.   or FileName("*.sd?*")
15052.   or FileName("*.sq**")
15053.   or FileName("*.tmd")
15054.   or FileName("*.tps")
15055.   or FileName("*.tr*")
15056. )
15057. # Databases end.
15058. 
15059.     # BlobsAndExceptions
15060.     or 
15061. # Data start.
15062. (
15063.   DirectoryName("Data*")
15064.   or DirectoryName("Device*")
15065.   or DirectoryName("Export*")
15066.   or DirectoryName("Import*")
15067.   or DirectoryName("Log*")
15068.   or DirectoryName("*Log")
15069.   or DirectoryName("Maintenance*")
15070.   or DirectoryName("Rec*")
15071.   or DirectoryName("Sales*")
15072.   or DirectoryName("Search*")
15073.   or DirectoryName("User*")
15074. )
15075. # Data end.
15076. 
15077.     # BlobsAndExceptions
15078.   )
15079. ) )
15080. # BlobsAndExceptions end.
15081. 
15082. # Blobs
15083. ) and (
15084.   Size(BlobFileSize,0)
15085.   or (
15086.     FileName("*.arj")
15087.     or FileName("*.bup")
15088.     or FileName("*.bz2")
15089.     or FileName("*.chm")
15090.     or FileName("*.dvr-ms")
15091.     or FileName("*.gz")
15092.     or FileName("*.ifo")
15093.     or FileName("*.lzh")
15094.     or FileName("*.pdf")
15095.     or FileName("*.rpm")
15096.     or FileName("*.wmv")
15097.     or FileName("*.vob")
15098.     or FileName("*.z")
15099.   ) 
15100. )
15101. # Blobs end.
15102. 
15103. # NotBlobsArchivesBu
15104. or 
15105. # Archives start.
15106. (
15107.   DirectoryName("*Archive*")
15108.   or DirectoryName("*History*")
15109.   or DirectoryName("*Old")
15110.   or DirectoryName("* Old *")
15111.   or DirectoryName("Old *")
15112. 
15113.   or FileName("*.7z")
15114.   or FileName("*.cab")
15115.   or FileName("*.iso")
15116.   or FileName("*.msi")
15117.   or FileName("*.old")
15118.   or FileName("*.rar")
15119.   or FileName("*.tar")
15120.   or FileName("*.zip")
15121.   or
15122. # WinSysLow start.
15123. (
15124.   DirectoryName("$*")
15125.   or DirectoryName("0*")
15126.   or DirectoryName("1*")
15127.   or DirectoryName("2*")
15128.   or DirectoryName("3*")
15129.   or DirectoryName("4*")
15130.   or DirectoryName("5*")
15131.   or DirectoryName("6*")
15132.   or DirectoryName("7*")
15133.   or DirectoryName("8*")
15134.   or DirectoryName("9*")
15135. 
15136.   or DirectoryName("dllcache")
15137.   or DirectoryName("Downloaded Installations")
15138.   or DirectoryName("Ehome")
15139.   or DirectoryName("Fonts")
15140.   or DirectoryName("Help")
15141.   or DirectoryName("I386")
15142.   or DirectoryName("ie?updates")
15143.   or DirectoryName("Installer")
15144.   or DirectoryName("Installshield Installation Information")
15145.   or DirectoryName("IME")
15146.   or DirectoryName("*RECYCLE*")
15147.   or DirectoryName("ServicePackFiles")
15148.   or DirectoryName("SoftwareDistribution")
15149.   or DirectoryName("Speech")
15150.   or DirectoryName("Symbols")
15151.   or DirectoryName("System Volume Information")
15152.   or DirectoryName("windows.old")
15153. )
15154. # WinSysLow end.
15155. 
15156.   # Archives
15157. )
15158. # Archives end.
15159. 
15160. # NotBlobsArchivesBu
15161. or
15162. # Backups start.
15163. (
15164.   DirectoryName("*Backup*")
15165.   or DirectoryName("*Bu")
15166.   or DirectoryName("* Bu *")
15167.   or DirectoryName("Bu *")
15168. 
15169.   or FileName("*.bak")
15170.   or FileName("* - Copy*")
15171. )
15172. # Backups end.
15173. 
15174. # NotBlobsArchivesBu
15175. ) )
15176. # NotBlobsArchivesBu end.
15177. 
15178. # People
15179. and (
15180. # People start.
15181. (
15182.   DirectoryName("*Capture*")
15183.   or DirectoryName("*Document*")
15184.   or DirectoryName("*Download*")
15185.   or DirectoryName("*Kids*")
15186.   or DirectoryName("Mail*")
15187.   or DirectoryName("*Mail")
15188.   or DirectoryName("My*")
15189.   or DirectoryName("*Person*")
15190.   or DirectoryName("Private*")
15191.   or DirectoryName("Users")
15192.   
15193.   # Individual People HERE:
15194.   or DirectoryName("Dgh*")
15195. )
15196. # People end.
15197. 
15198. # People
15199. )
15200. # People end.
15201. 
15202. 	# Script: ZoneDoAction
15203. # Zone Do File Action - SortByName.
15204. 
15205. FileActions
15206. 
15207. 	# Footer:
15208. SetVariable(ZoneFooter, "----------------------------------------------------------
15209. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
15210. 
15211. Statistics Report:
15212. ------------------
15213.    Size:  
15214.    ------------------------
15215.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15216.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15217.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15218. 
15219.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15220.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15221. 
15222.    Location:
15223.    ------------------------
15224.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15225.              Files End: !ZoneEndCurrent!
15226.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15227.       
15228.    Gap Settings:
15229.    ------------------------
15230.          Gap Requested: !ZoneGapSizePer!%
15231.       Volume Rounding: !ZoneVolRoundUpPer!%
15232.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15233.                  
15234.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15235.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15236.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15237.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15238.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15239.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15240.      
15241.    Free Space after Zone:
15242.    ------------------------
15243.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15244.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15245.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15246. 
15247. Directory and Files Select:
15248. ---------------------------
15249. !ZoneTypeSelectCurrent!               
15250. ---------------------------
15251. ----------------------------------------------------------
15252. ")
15253. 	SetStatisticsWindowText("!ZoneFooter!")
15254. 	
15255. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
15256. 	# Script: DisplaySetFileStep
15257. 
15258. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15259. 
15260. /* add message and move to a new line. */
15261. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15262. ")
15263. 
15264. /* display the line. (hopefully.) */
15265. # Zone Footer Set Statistics Window Text
15266. 
15267. SetStatisticsWindowText("----------------------------------------------------------
15268. Zones Processed: 
15269. ----------------------------------------------------------
15270. !ZoneListByLine!
15271. ----------------------------------------------------------
15272. Zone Processing Step:
15273. !ZoneStepByLine!    
15274. ----------------------------------------------------------
15275. Current Zone:
15276. !ZoneFooter!
15277. ----------------------------------------------------------
15278. Volume Statistics:
15279. !VolumeStatisticsDetail!
15280. ----------------------------------------------------------
15281. Zone Detailed Report:
15282. ----------------------------------------------------------
15283. !ZoneStatisticsDetail!
15284. ----------------------------------------------------------
15285. ")
15286. 
15287. 
15288. 
15289. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15290. 
15291. # Script: BannerSet
15292. 
15293. # Script: DisplaySetDateTimeRun
15294. 
15295. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
15296. /* Xinclude "..\Display\BannerSet.MyDc"X */
15297. /* pause(1) */
15298. 
15299. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15300. 
15301. Title('!Heading!')
15302. /* pause(1) */
15303. 
15304. /* NOTE: Can't round or truncate to integer precision. */
15305. 
15306. pause(1)
15307. 
15308. # Commands:
15309. 
15310. /* Moves to Zone or above it. */
15311. # MoveUpToZone()
15312. 
15313. # Defrag
15314. 
15315. # Defragment(OPTIONS)
15316. 
15317. /* Shuffles files around trying to make a big enough gap for fragmented files. */
15318. # Defragment()
15319. 
15320. /* Only does files where a gap will fit it. */
15321. # Defragment(Fast)
15322. 
15323. /* Skips fragmented files larger than the Chunck Size.
15324. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
15325. # Defragment(Chunk Size)
15326. 
15327. /* Moves down to zone and packs zone to beginning if there are gaps. */
15328. /* Can be similar in performance to doing a SortBy. */
15329. # MoveDownFill()
15330. 
15331. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
15332. 
15333. 
15334. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
15335. 	# Script: DisplaySetFileStep
15336. 
15337. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15338. 
15339. /* add message and move to a new line. */
15340. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15341. ")
15342. 
15343. /* display the line. (hopefully.) */
15344. # Zone Footer Set Statistics Window Text
15345. 
15346. SetStatisticsWindowText("----------------------------------------------------------
15347. Zones Processed: 
15348. ----------------------------------------------------------
15349. !ZoneListByLine!
15350. ----------------------------------------------------------
15351. Zone Processing Step:
15352. !ZoneStepByLine!    
15353. ----------------------------------------------------------
15354. Current Zone:
15355. !ZoneFooter!
15356. ----------------------------------------------------------
15357. Volume Statistics:
15358. !VolumeStatisticsDetail!
15359. ----------------------------------------------------------
15360. Zone Detailed Report:
15361. ----------------------------------------------------------
15362. !ZoneStatisticsDetail!
15363. ----------------------------------------------------------
15364. ")
15365. 
15366. 
15367. 
15368. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15369. 
15370. # Script: BannerSet
15371. 
15372. # Script: DisplaySetDateTimeRun
15373. 
15374. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
15375. /* Xinclude "..\Display\BannerSet.MyDc"X */
15376. /* pause(1) */
15377. 
15378. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15379. 
15380. Title('!Heading!')
15381. /* pause(1) */
15382. 
15383. /* NOTE: Can't round or truncate to integer precision. */
15384. 
15385. pause(1)
15386. 
15387. 	# Script: ZoneDoFooter
15388. 
15389. /* ---------------------------------------------------------- */
15390. # File Select
15391. 	# Select Statments
15392. # File Actions 
15393. 	# Standard or OS File Actions.
15394. 	# Resume...
15395. 	
15396. 	# your stuff HERE (X)... post zone (file) file actions code.
15397. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
15398. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15399. 		# (X)
15400. 		
15401. 		/* ??? Set window? */
15402. 	
15403. 	# ADD THE GAP
15404. 		
15405. # Vacate (good for diagnostics)
15406. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
15407. 
15408. # DoNotVacate - DO NOT Vacate (recommended)
15409. 
15410. # Vacate
15411. /* AddGap(GapUsedLoc) */
15412. 
15413. # DO Not Vacate
15414. AddGap(GapUsedLoc, DoNotVacate) 
15415. 	
15416. 	
15417. /* ---------------------------------------------------------- */
15418. # (failed) TEST for boolean logic.
15419. 
15420. /* It should work in the gap calculations for turning options */
15421. /* on and off but it will NOT work here. */
15422. 
15423. /* Boolean setting X or FlagX. */
15424. /* Where X will be on or off: */
15425. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
15426. /*      For ON:  (X  *  FlagAny) */
15427. 
15428. /* 1) Failed, zero gap overrode the previous one. */
15429. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
15430. /* AddGap(GapUsedTemp) */ 
15431. 
15432. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
15433. /* AddGap(GapUsedTemp, DoNotVacate) */ 
15434. 
15435. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
15436. 
15437. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
15438. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
15439. /* AddGap(GapUsedTemp) */ 
15440. 
15441. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
15442. /* AddGap(GapUsedTemp, DoNotVacate) */ 
15443. 
15444. /* ---------------------------------------------------------- */
15445. 
15446. # Vacate
15447. /* AddGap(GapUsed) */
15448. 
15449. # DO NOT Vacate (recommended)
15450. /* AddGap(GapUsed, DoNotVacate) */ 
15451. 	
15452. 
15453. 		
15454. # 
15455. FileEnd
15456. /* ---------------------------------------------------------- */
15457. 
15458. # your stuff HERE (X)... post zone (file) code.
15459. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
15460. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15461. 	# (X)
15462. 
15463. SetVariable(FileStepDescription,"Zone finished, reporting.")
15464. # Script: DisplaySetFileStep
15465. 
15466. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15467. 
15468. /* add message and move to a new line. */
15469. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15470. ")
15471. 
15472. /* display the line. (hopefully.) */
15473. # Zone Footer Set Statistics Window Text
15474. 
15475. SetStatisticsWindowText("----------------------------------------------------------
15476. Zones Processed: 
15477. ----------------------------------------------------------
15478. !ZoneListByLine!
15479. ----------------------------------------------------------
15480. Zone Processing Step:
15481. !ZoneStepByLine!    
15482. ----------------------------------------------------------
15483. Current Zone:
15484. !ZoneFooter!
15485. ----------------------------------------------------------
15486. Volume Statistics:
15487. !VolumeStatisticsDetail!
15488. ----------------------------------------------------------
15489. Zone Detailed Report:
15490. ----------------------------------------------------------
15491. !ZoneStatisticsDetail!
15492. ----------------------------------------------------------
15493. ")
15494. 
15495. 
15496. 
15497. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15498. 
15499. # Script: BannerSet
15500. 
15501. # Script: DisplaySetDateTimeRun
15502. 
15503. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
15504. /* Xinclude "..\Display\BannerSet.MyDc"X */
15505. /* pause(1) */
15506. 
15507. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15508. 
15509. Title('!Heading!')
15510. /* pause(1) */
15511. 
15512. /* NOTE: Can't round or truncate to integer precision. */
15513. 
15514. pause(1)
15515. 
15516. # Script: ZoneWhenFinished
15517. 
15518. # Script: BannerSet
15519. 
15520. # Script: DisplaySetDateTimeRun
15521. 
15522. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
15523. /* Xinclude "..\Display\BannerSet.MyDc"X */
15524. /* pause(1) */
15525. 
15526. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15527. 
15528. Title('!Heading!')
15529. /* pause(1) */
15530. 
15531. /* NOTE: Can't round or truncate to integer precision. */
15532. 
15533. # Script: BannerLog
15534. 
15535. AppendLogfile("!LogFileName!", "!Title!")
15536. 
15537. 
15538. 
15539. # Zone Statistics	
15540. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
15541. 
15542. # Footer:
15543. SetVariable(ZoneFooter, "----------------------------------------------------------
15544. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
15545. 
15546. Statistics Report:
15547. ------------------
15548.    Size:  
15549.    ------------------------
15550.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15551.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15552.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15553. 
15554.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15555.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15556. 
15557.    Location:
15558.    ------------------------
15559.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15560.              Files End: !ZoneEndCurrent!
15561.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15562.       
15563.    Gap Settings:
15564.    ------------------------
15565.          Gap Requested: !ZoneGapSizePer!%
15566.       Volume Rounding: !ZoneVolRoundUpPer!%
15567.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15568.                  
15569.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15570.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15571.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15572.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15573.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15574.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15575.      
15576.    Free Space after Zone:
15577.    ------------------------
15578.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15579.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15580.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15581. 
15582. Directory and Files Select:
15583. ---------------------------
15584. !ZoneTypeSelectCurrent!               
15585. ---------------------------
15586. ----------------------------------------------------------
15587. ")
15588. 
15589. AppendLogfile("!LogFileName!", ".")
15590. AppendLogfile("!LogFileName!", "!ZoneFooter!")
15591. AppendLogfile("!LogFileName!", ".")
15592. 
15593. # Zone Footer Set Statistics Window Text
15594. 
15595. SetStatisticsWindowText("----------------------------------------------------------
15596. Zones Processed: 
15597. ----------------------------------------------------------
15598. !ZoneListByLine!
15599. ----------------------------------------------------------
15600. Zone Processing Step:
15601. !ZoneStepByLine!    
15602. ----------------------------------------------------------
15603. Current Zone:
15604. !ZoneFooter!
15605. ----------------------------------------------------------
15606. Volume Statistics:
15607. !VolumeStatisticsDetail!
15608. ----------------------------------------------------------
15609. Zone Detailed Report:
15610. ----------------------------------------------------------
15611. !ZoneStatisticsDetail!
15612. ----------------------------------------------------------
15613. ")
15614. 
15615. 
15616. 
15617. /* pause() */
15618. /* pause() */
15619. 
15620. 
15621. 
15622. 
15623. /* ---------------------------------------------------------- */
15624. 
15625. 
15626. /* ---------------------------------------------------------- */
15627. // "4" & "5" now 8 & 9
15628. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
15629. /* Process MFT & Dir's HERE. */
15630. 	SetVariable(FileStepDescription,"Calculating Gap for MFT and DIR.")
15631. # Script: BannerDescriptionSet
15632. 
15633. # Script: BannerSet
15634. 
15635. # Script: DisplaySetDateTimeRun
15636. 
15637. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
15638. /* Xinclude "..\Display\BannerSet.MyDc"X */
15639. /* pause(1) */
15640. 
15641. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15642. 
15643. Title('!Heading!')
15644. /* pause(1) */
15645. 
15646. /* NOTE: Can't round or truncate to integer precision. */
15647. 
15648. # Script: BannerLog
15649. 
15650. AppendLogfile("!LogFileName!", "!Title!")
15651. 
15652. 
15653. 
15654. 
15655. AppendLogfile("!LogFileName!", "MftLocation: !MftLocation! DoNotVacate 2021-11-09 18:53:50")
15656. 
15657. SetVariable(MftGapSlack, MftLocation - VolumeUsedTotal)
15658. AppendLogfile("!LogFileName!", "MftGapSlack: !MftGapSlack!")
15659. 
15660. SetVariable(MftGapSlackPerUsed, MftGapSlack / VolumeFreeAdj)
15661. AppendLogfile("!LogFileName!", "MftGapSlackPerUsed: !MftGapSlackPerUsed!")
15662. 
15663. AppendLogfile("!LogFileName!", "VolumeUsed before: !VolumeUsedTotal!")
15664. SetVariable(VolumeUsedTotal, MftLocation)
15665. AppendLogfile("!LogFileName!", "VolumeUsed at location: !VolumeUsedTotal!")
15666. 
15667. SetVariable(VolumeFreePerUsed, VolumeFreePerUsed + (MftGapSlack / VolumeFree))
15668. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!")
15669. 
15670. /* ---------------------------------------------------------- */
15671. #  MFT
15672. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
15673. 
15674. # Script: DefragZoneTypeOsMft
15675. /* ---------------------------------------------------------- */
15676. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
15677.   
15678. SetVariable(ZoneLabel,				"MFT") // "4" 
15679. SetVariable(ZoneDescription, 		"MFT - Master File Table")
15680. SetVariable(ZoneCurrentAjust, 		1)
15681. /* and some other special NTFS files. */
15682. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpMft!")
15683. SetVariable(ZoneGapSize, 			"!ZoneGapSizeMft!")
15684. SetVariable(ZoneTypeSelect,			'# Script: ZoneDo ZoneTypeSelectOsMFT
15685. # MFT start.
15686. SelectNtfsSystemFiles(yes)
15687. # MFT end.')
15688. 
15689. 	# Script: ZoneDoHeader
15690. 
15691. # Script: ZoneWhenStarted
15692. 
15693. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
15694. # Script: DisplaySetZone
15695. 
15696. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
15697. SetVariable(FileStepDescription,	"")
15698. 
15699. SetVariable(ZoneStepByLine, 			"Zone started.
15700. ")
15701. 
15702. # Script: BannerDescriptionSet
15703. 
15704. # Script: BannerSet
15705. 
15706. # Script: DisplaySetDateTimeRun
15707. 
15708. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
15709. /* Xinclude "..\Display\BannerSet.MyDc"X */
15710. /* pause(1) */
15711. 
15712. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15713. 
15714. Title('!Heading!')
15715. /* pause(1) */
15716. 
15717. /* NOTE: Can't round or truncate to integer precision. */
15718. 
15719. # Script: BannerLog
15720. 
15721. AppendLogfile("!LogFileName!", "!Title!")
15722. 
15723. 
15724. 
15725. pause(1)
15726. 
15727. 
15728. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
15729. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
15730. 
15731. SetVariable(ZoneStepNoCurrent, 0)
15732. 
15733. 
15734. # Script: ZoneDoCurrentClear
15735. 
15736. SetVariable(ZoneTypeSelectCurrent, 		"")
15737. 
15738. SetVariable(ZoneBeginCurrent, 			0)
15739. SetVariable(ZoneBeginPerCurrent, 		0)
15740. SetVariable(ZoneEndCurrent, 			0)
15741. SetVariable(ZoneEndPerCurrent, 			0)
15742. 
15743. SetVariable(ZoneSizeCurrent,			0)
15744. SetVariable(ZoneSizePerCurrent,			0)
15745. 
15746. SetVariable(ZoneGapRequestedCurrent,	0)
15747. SetVariable(ZoneGapRoundedCurrent, 		0)
15748. SetVariable(ZoneGapAdjustedCurrent, 	0)
15749. SetVariable(ZoneGapAvailableCurrent, 	0)
15750. SetVariable(ZoneGapCurrent,				0)
15751. SetVariable(ZoneGapUsedCurrent, 		0)
15752. 
15753. SetVariable(ZoneGapActualCurrent, 		0)
15754. SetVariable(ZoneGapActualPerCurrent, 	0)
15755. 
15756. SetVariable(ZoneSizeActual, 			0)
15757. SetVariable(ZoneSizeActualCurrent,		0)
15758. 
15759. SetVariable(ZoneEndActual, 				0)
15760. SetVariable(ZoneEndActualCurrent,		0)			
15761. SetVariable(ZoneSizeActualPerCurrent, 	0)
15762.       
15763. SetVariable(ZoneFilesFolders,			0)
15764. SetVariable(ZoneFilesFoldersPer,		0) 
15765. 
15766. SetVariable(ZoneFragments,				0)
15767. SetVariable(ZoneFragmentsPer,			0) 
15768. 		
15769. SetVariable(ZoneEndActualCurrent, 		0)
15770. SetVariable(ZoneEndActualPerCurrent, 	0)
15771. 
15772. # Gap Calculation Methodology:
15773. 	# Requested
15774. 	SetVariable(GapRequested, 			0) 
15775. 	SetVariable(GapRequestedStd, 		0) 
15776. 	SetVariable(GapRequestedMft, 		0) 
15777. 	SetVariable(GapRequestedOs, 		0) 
15778. 	SetVariable(GapRequestedOriginal, 	0) 
15779. 	
15780. 	# Gap Adjustments
15781. 	SetVariable(GapRounded, 			0)
15782. 	# SetVariable(GapAdjusted, 			0)
15783. 	SetVariable(GapAvailable, 			0)
15784. 	SetVariable(GapCurrent, 			0)
15785. 	SetVariable(GapActual, 				0)
15786. 	SetVariable(GapUsed, 				0)
15787. 	
15788. 	# Gap Adjustments
15789. 	SetVariable(GapRoundedLoc, 			0)
15790. 	# SetVariable(GapAdjustedLoc, 		0)
15791. 	SetVariable(GapAvailableLoc, 		0)
15792. 	SetVariable(GapCurrentLoc, 			0)
15793. 	SetVariable(GapActualLoc,			0)
15794. 	SetVariable(GapUsedLoc,				0)
15795. 	
15796. 	# Space usage
15797. 	SetVariable(ZoneFreePerRequested, 	0)
15798. 	SetVariable(ZoneFreePerUsed, 		0)
15799. 
15800. # Gap Size & Rounding
15801. 	SetVariable(ZoneGapSizePer, 		0)
15802. 	SetVariable(ZoneVolRoundUpPer, 		0)
15803. 	
15804. 	# Free Space
15805. 	SetVariable(ZoneFreeUsedPer, 		0)
15806. 	SetVariable(ZoneFreeRequestedPer, 	0)
15807. 
15808. 
15809. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
15810. 
15811. # Footer:
15812. SetVariable(ZoneFooter, "----------------------------------------------------------
15813. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
15814. 
15815. Statistics Report:
15816. ------------------
15817.    Size:  
15818.    ------------------------
15819.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15820.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15821.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15822. 
15823.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15824.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15825. 
15826.    Location:
15827.    ------------------------
15828.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15829.              Files End: !ZoneEndCurrent!
15830.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15831.       
15832.    Gap Settings:
15833.    ------------------------
15834.          Gap Requested: !ZoneGapSizePer!%
15835.       Volume Rounding: !ZoneVolRoundUpPer!%
15836.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15837.                  
15838.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15839.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15840.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15841.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15842.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15843.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15844.      
15845.    Free Space after Zone:
15846.    ------------------------
15847.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15848.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15849.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15850. 
15851. Directory and Files Select:
15852. ---------------------------
15853. !ZoneTypeSelectCurrent!               
15854. ---------------------------
15855. ----------------------------------------------------------
15856. ")
15857. 
15858. # Script: BannerSet
15859. 
15860. # Script: DisplaySetDateTimeRun
15861. 
15862. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
15863. /* Xinclude "..\Display\BannerSet.MyDc"X */
15864. /* pause(1) */
15865. 
15866. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15867. 
15868. Title('!Heading!')
15869. /* pause(1) */
15870. 
15871. /* NOTE: Can't round or truncate to integer precision. */
15872. 
15873. # Script: BannerLog
15874. 
15875. AppendLogfile("!LogFileName!", "!Title!")
15876. 
15877. 
15878. 
15879. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
15880. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
15881. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:50")
15882. 
15883. SetVariable(ZoneListByLine, "!ZoneListByLine!
15884. Zone: !ZoneNoCurrent! 2021-11-09 18:53:50 0:00:06 !ZoneLabel! !ZoneDescription!")
15885. 
15886. 
15887. /* Fixed Zone Position Handling */
15888. /* Literal number: */
15889. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
15890. /* Percentage of disk: */
15891. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
15892. /* Gap */
15893. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
15894. 
15895. /* ---------------------------------------------------------- */
15896. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
15897. # Script: DisplaySetFileStep
15898. 
15899. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15900. 
15901. /* add message and move to a new line. */
15902. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15903. ")
15904. 
15905. /* display the line. (hopefully.) */
15906. # Zone Footer Set Statistics Window Text
15907. 
15908. SetStatisticsWindowText("----------------------------------------------------------
15909. Zones Processed: 
15910. ----------------------------------------------------------
15911. !ZoneListByLine!
15912. ----------------------------------------------------------
15913. Zone Processing Step:
15914. !ZoneStepByLine!    
15915. ----------------------------------------------------------
15916. Current Zone:
15917. !ZoneFooter!
15918. ----------------------------------------------------------
15919. Volume Statistics:
15920. !VolumeStatisticsDetail!
15921. ----------------------------------------------------------
15922. Zone Detailed Report:
15923. ----------------------------------------------------------
15924. !ZoneStatisticsDetail!
15925. ----------------------------------------------------------
15926. ")
15927. 
15928. 
15929. 
15930. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15931. 
15932. # Script: BannerSet
15933. 
15934. # Script: DisplaySetDateTimeRun
15935. 
15936. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
15937. /* Xinclude "..\Display\BannerSet.MyDc"X */
15938. /* pause(1) */
15939. 
15940. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15941. 
15942. Title('!Heading!')
15943. /* pause(1) */
15944. 
15945. /* NOTE: Can't round or truncate to integer precision. */
15946. 
15947. pause(1)
15948. 
15949. # your stuff HERE (X)... pre file select code.
15950. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
15951. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
15952. 	# (X)
15953. 
15954. FileSelect
15955. 
15956. 	# your stuff can't really go here (errors.)
15957. 	# maybe for some reason I don't know of...
15958. 	
15959. 	# Actions next...
15960. 	# Script: ZoneDo ZoneTypeSelectOsMFT
15961. # MFT start.
15962. SelectNtfsSystemFiles(yes)
15963. # MFT end.
15964. 	
15965. 	FileActions
15966. 	  		/* ---------------------------------------------------------- */
15967. 	# Gap
15968. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
15969. 		# Script: DisplaySetFileStep
15970. 
15971. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15972. 
15973. /* add message and move to a new line. */
15974. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15975. ")
15976. 
15977. /* display the line. (hopefully.) */
15978. # Zone Footer Set Statistics Window Text
15979. 
15980. SetStatisticsWindowText("----------------------------------------------------------
15981. Zones Processed: 
15982. ----------------------------------------------------------
15983. !ZoneListByLine!
15984. ----------------------------------------------------------
15985. Zone Processing Step:
15986. !ZoneStepByLine!    
15987. ----------------------------------------------------------
15988. Current Zone:
15989. !ZoneFooter!
15990. ----------------------------------------------------------
15991. Volume Statistics:
15992. !VolumeStatisticsDetail!
15993. ----------------------------------------------------------
15994. Zone Detailed Report:
15995. ----------------------------------------------------------
15996. !ZoneStatisticsDetail!
15997. ----------------------------------------------------------
15998. ")
15999. 
16000. 
16001. 
16002. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16003. 
16004. # Script: BannerSet
16005. 
16006. # Script: DisplaySetDateTimeRun
16007. 
16008. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
16009. /* Xinclude "..\Display\BannerSet.MyDc"X */
16010. /* pause(1) */
16011. 
16012. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16013. 
16014. Title('!Heading!')
16015. /* pause(1) */
16016. 
16017. /* NOTE: Can't round or truncate to integer precision. */
16018. 
16019. pause(1)
16020. 	
16021. 	# ACTUAL GAP
16022. 		/* AddGap Variant. */
16023. 	  	# Zone Do Gap
16024. # Gap Calculation Methods:
16025. 
16026. /* 1) Anything you need to add first. */
16027. /* empty */
16028. 
16029. /* ---------------------------------------------------------- */
16030. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
16031. 	# GapRequestedStd.
16032. 
16033. 		/* ---------------------------------------------------------- */
16034. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
16035. 
16036. 		# Gap Calculation Methods:
16037. 
16038. /* AddGap Variants */
16039. 
16040. 	/* Standard */
16041. 		# Gap Calculation Methods:
16042. 	/* AddGap Variants */
16043. 	/* Standard */
16044. 
16045. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
16046. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
16047. 
16048. 	SetVariable(GapRequested, GapRequestedStd)
16049. 	
16050. 
16051. 	/* MFT Low High Method */
16052. 		# Gap Calculation Methods:
16053. 	/* AddGap Variants */
16054. 	/* MFT Low High Method */
16055. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
16056. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
16057. 	SetVariable(GapRequested, GapRequestedMft)
16058. 	
16059. 
16060. 	/* OS Volume Type Method */
16061. 		# Gap Calculation Methods:
16062. 	/* AddGap Variants */
16063. 	/* OS Volume Type Method */
16064. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
16065. 	SetVariable(GapRequested, GapRequestedOs)
16066. 
16067. 
16068. 
16069. /* MakeGap Variants */
16070. 
16071. 	/* Original Os 1-3 + MFT 2 */
16072. 		# Gap Calculation Methods:
16073. 	/* MakeGap Variants */
16074. 	/* Original Os 1-3 + MFT 2 */
16075. 	/* plus MFT gap placed inline at the dividing zone. */
16076. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
16077. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
16078. 	SetVariable(GapRequested, GapRequestedOrig)
16079. 	
16080. 	
16081. /* Note: You could comment out the ones not in use */
16082. /* However having the data in the log is useful. */
16083. /* Therefore the following line is otherwise needed. */
16084. 
16085. /* Standard used */
16086. 
16087. SetVariable(GapRequested, GapRequestedStd)
16088. 
16089. # Gap Calculation Methods:
16090. 
16091. /* AddGap Variants */
16092. 	/* Standard */
16093. 	/* MFT Low High Method */
16094. 	/* OS Volume Type Method */
16095. 
16096. /* MakeGap Variants */
16097. 	/* Original Os 1-3 + MFT 2 */
16098. 
16099. /* Note: You could comment out the ones not in use */
16100. /* However having the data in the log is useful. */
16101. /* Therefore the following line is otherwise needed. */
16102. 
16103. /* Standard is used currently */
16104. 
16105. 
16106. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
16107. 
16108. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
16109. 
16110. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
16111. 
16112. /* ---------------------------------------------------------- */
16113. /* 3) SMALL ZONE ADJUSTMENT. */
16114. /* Gab cant be larger than half the Zone Size. */
16115. 
16116. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
16117. 	
16118. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
16119. 
16120. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
16121. 
16122. /* ---------------------------------------------------------- */
16123. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
16124. # Gap Adjustments.
16125. 
16126. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
16127. 	
16128. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
16129. 
16130. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
16131. 
16132. /* ---------------------------------------------------------- */
16133. # BYPASS THIS.
16134. 	/* This is definitely wrong. */
16135. 	/* The question is can we steal gap from the next zone */
16136. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
16137. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
16138. 		# Zone Overflow.
16139. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
16140. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
16141. 
16142. /* ---------------------------------------------------------- */
16143. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
16144. # Remaining free space available.
16145. 
16146. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
16147. 	
16148. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
16149. 
16150. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
16151. 
16152. /* ---------------------------------------------------------- */
16153. # CURRENT gap to use.
16154. 
16155. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
16156. 
16157. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
16158. 
16159. /* ---------------------------------------------------------- */
16160. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
16161. # Debugging.
16162. 
16163. 	SetVariable(GapUsed, GapCurrent) // for debugging
16164. 
16165. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
16166. 
16167. 		# Your code HERE
16168. 
16169. /* ---------------------------------------------------------- */
16170. /* 7) YOUR CODE. */
16171. # YOUR CODE HERE:
16172. 	# INPUT: GapCurrent or GapCurrentLoc
16173. 	# OUTPUT: GapUsed...
16174. 
16175. /* ---------------------------------------------------------- */
16176. # Gap Size.
16177. # Actual Size of Gap.
16178. 
16179. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
16180. 
16181. /* ---------------------------------------------------------- */
16182. /* xxxxxxxxxxxxxxxxxxxxxx */
16183. # ADD THE GAP
16184. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
16185. /* xxxxxxxxxxxxxxxxxxxxxx */
16186. 
16187. 	
16188. 	# Zone Statistics	
16189. 	# Script: ZoneDoStatistics
16190. # Zone / Volume Statistics and Display
16191. 		
16192. 	# Accumulate Totals
16193.   	# Script: ZoneDoVolumeTotals
16194. 
16195. /* Current total space used (by Zones and Gaps) */
16196. 
16197. SetVariable(VolumeZoneUsed, GapUsed)
16198. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
16199. /* Percentage */
16200. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
16201. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
16202. 
16203. /* Current total of free space requested */
16204. 
16205. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
16206. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16207. /* Percent. */
16208. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
16209. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16210. 
16211. /* Current total of free space used */
16212. 
16213. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
16214. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
16215. /* Percent */
16216. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
16217. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
16218. 
16219. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
16220. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
16221. /* Xinclude "..\DebugDisplayPause.MyDc"X */
16222. 
16223. 
16224. 	# Current Values
16225. 	# Script: ZoneDoCurrentSet
16226. 
16227. # Cluster, Sector, Block adjust for display.
16228. 	# Bytes per cluster is volume specific.
16229. 
16230. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
16231. 
16232. # Current Zone values.
16233. 	# Begin, end and size.
16234. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
16235. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
16236. 
16237. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
16238. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
16239. 
16240. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
16241. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
16242. 
16243. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
16244. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
16245. 
16246. 	SetVariable(ZoneFragments,				"!ZONE210N!")
16247. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
16248. 		
16249. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
16250. /* identical code to here: (separation not needed. TEST.) */	
16251. 
16252. # Current Gap, Actual and Free Values
16253. 	# Gap
16254. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
16255. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
16256. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
16257. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
16258. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
16259. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
16260. 	
16261. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
16262. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
16263. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
16264. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
16265. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
16266. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
16267. 	
16268. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
16269. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
16270. 	
16271. 	# Actual Size and End
16272. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
16273. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
16274. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
16275. 	
16276. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
16277. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
16278. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
16279. 
16280. # Gap Size & Rounding
16281. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
16282. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
16283. 	
16284. 	# Free Space
16285. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
16286. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
16287. 
16288. 	# Footer:
16289. SetVariable(ZoneFooter, "----------------------------------------------------------
16290. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
16291. 
16292. Statistics Report:
16293. ------------------
16294.    Size:  
16295.    ------------------------
16296.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16297.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16298.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16299. 
16300.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16301.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16302. 
16303.    Location:
16304.    ------------------------
16305.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16306.              Files End: !ZoneEndCurrent!
16307.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16308.       
16309.    Gap Settings:
16310.    ------------------------
16311.          Gap Requested: !ZoneGapSizePer!%
16312.       Volume Rounding: !ZoneVolRoundUpPer!%
16313.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16314.                  
16315.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16316.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16317.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16318.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16319.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16320.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16321.      
16322.    Free Space after Zone:
16323.    ------------------------
16324.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16325.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16326.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16327. 
16328. Directory and Files Select:
16329. ---------------------------
16330. !ZoneTypeSelectCurrent!               
16331. ---------------------------
16332. ----------------------------------------------------------
16333. ")
16334. 	# Zone Footer Set Statistics Window Text
16335. 
16336. SetStatisticsWindowText("----------------------------------------------------------
16337. Zones Processed: 
16338. ----------------------------------------------------------
16339. !ZoneListByLine!
16340. ----------------------------------------------------------
16341. Zone Processing Step:
16342. !ZoneStepByLine!    
16343. ----------------------------------------------------------
16344. Current Zone:
16345. !ZoneFooter!
16346. ----------------------------------------------------------
16347. Volume Statistics:
16348. !VolumeStatisticsDetail!
16349. ----------------------------------------------------------
16350. Zone Detailed Report:
16351. ----------------------------------------------------------
16352. !ZoneStatisticsDetail!
16353. ----------------------------------------------------------
16354. ")
16355. 
16356. 
16357. 	
16358.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
16359. 
16360. 	# Add Zone to list of zones for display.
16361. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
16362. 	# ??? Free Stats?
16363. 	# Footer:
16364. SetVariable(ZoneFooter, "----------------------------------------------------------
16365. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
16366. 
16367. Statistics Report:
16368. ------------------
16369.    Size:  
16370.    ------------------------
16371.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16372.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16373.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16374. 
16375.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16376.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16377. 
16378.    Location:
16379.    ------------------------
16380.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16381.              Files End: !ZoneEndCurrent!
16382.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16383.       
16384.    Gap Settings:
16385.    ------------------------
16386.          Gap Requested: !ZoneGapSizePer!%
16387.       Volume Rounding: !ZoneVolRoundUpPer!%
16388.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16389.                  
16390.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16391.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16392.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16393.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16394.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16395.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16396.      
16397.    Free Space after Zone:
16398.    ------------------------
16399.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16400.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16401.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16402. 
16403. Directory and Files Select:
16404. ---------------------------
16405. !ZoneTypeSelectCurrent!               
16406. ---------------------------
16407. ----------------------------------------------------------
16408. ")
16409. 
16410. 	# Add Zone Details to Report.	
16411. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
16412. !ZoneFooter!")
16413. 
16414. 
16415. 	
16416. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
16417. 		# Script: DisplaySetFileStep
16418. 
16419. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16420. 
16421. /* add message and move to a new line. */
16422. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16423. ")
16424. 
16425. /* display the line. (hopefully.) */
16426. # Zone Footer Set Statistics Window Text
16427. 
16428. SetStatisticsWindowText("----------------------------------------------------------
16429. Zones Processed: 
16430. ----------------------------------------------------------
16431. !ZoneListByLine!
16432. ----------------------------------------------------------
16433. Zone Processing Step:
16434. !ZoneStepByLine!    
16435. ----------------------------------------------------------
16436. Current Zone:
16437. !ZoneFooter!
16438. ----------------------------------------------------------
16439. Volume Statistics:
16440. !VolumeStatisticsDetail!
16441. ----------------------------------------------------------
16442. Zone Detailed Report:
16443. ----------------------------------------------------------
16444. !ZoneStatisticsDetail!
16445. ----------------------------------------------------------
16446. ")
16447. 
16448. 
16449. 
16450. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16451. 
16452. # Script: BannerSet
16453. 
16454. # Script: DisplaySetDateTimeRun
16455. 
16456. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
16457. /* Xinclude "..\Display\BannerSet.MyDc"X */
16458. /* pause(1) */
16459. 
16460. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16461. 
16462. Title('!Heading!')
16463. /* pause(1) */
16464. 
16465. /* NOTE: Can't round or truncate to integer precision. */
16466. 
16467. pause(1)
16468. 	
16469. 		SetVariable(MftZone, ZoneCurrent) 
16470. 
16471. 		/* "..\ActionVerbs\ZoneDoActionThis.MyDc" */
16472. 		# File Action - Type Os MFT - PlaceNtfsSystemFiles.
16473. PlaceNtfsSystemFiles(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes), MftSize * 0.1)
16474. 	
16475. 
16476.   		SetVariable(MftSize,ZoneSize) 
16477. 
16478. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
16479. 		# Script: DisplaySetFileStep
16480. 
16481. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16482. 
16483. /* add message and move to a new line. */
16484. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16485. ")
16486. 
16487. /* display the line. (hopefully.) */
16488. # Zone Footer Set Statistics Window Text
16489. 
16490. SetStatisticsWindowText("----------------------------------------------------------
16491. Zones Processed: 
16492. ----------------------------------------------------------
16493. !ZoneListByLine!
16494. ----------------------------------------------------------
16495. Zone Processing Step:
16496. !ZoneStepByLine!    
16497. ----------------------------------------------------------
16498. Current Zone:
16499. !ZoneFooter!
16500. ----------------------------------------------------------
16501. Volume Statistics:
16502. !VolumeStatisticsDetail!
16503. ----------------------------------------------------------
16504. Zone Detailed Report:
16505. ----------------------------------------------------------
16506. !ZoneStatisticsDetail!
16507. ----------------------------------------------------------
16508. ")
16509. 
16510. 
16511. 
16512. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16513. 
16514. # Script: BannerSet
16515. 
16516. # Script: DisplaySetDateTimeRun
16517. 
16518. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
16519. /* Xinclude "..\Display\BannerSet.MyDc"X */
16520. /* pause(1) */
16521. 
16522. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16523. 
16524. Title('!Heading!')
16525. /* pause(1) */
16526. 
16527. /* NOTE: Can't round or truncate to integer precision. */
16528. 
16529. pause(1)
16530.   	# Script: ZoneDoFooter
16531. 
16532. /* ---------------------------------------------------------- */
16533. # File Select
16534. 	# Select Statments
16535. # File Actions 
16536. 	# Standard or OS File Actions.
16537. 	# Resume...
16538. 	
16539. 	# your stuff HERE (X)... post zone (file) file actions code.
16540. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
16541. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16542. 		# (X)
16543. 		
16544. 		/* ??? Set window? */
16545. 	
16546. 	# ADD THE GAP
16547. 		
16548. # Vacate (good for diagnostics)
16549. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
16550. 
16551. # DoNotVacate - DO NOT Vacate (recommended)
16552. 
16553. # Vacate
16554. /* AddGap(GapUsedLoc) */
16555. 
16556. # DO Not Vacate
16557. AddGap(GapUsedLoc, DoNotVacate) 
16558. 	
16559. 	
16560. /* ---------------------------------------------------------- */
16561. # (failed) TEST for boolean logic.
16562. 
16563. /* It should work in the gap calculations for turning options */
16564. /* on and off but it will NOT work here. */
16565. 
16566. /* Boolean setting X or FlagX. */
16567. /* Where X will be on or off: */
16568. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
16569. /*      For ON:  (X  *  FlagAny) */
16570. 
16571. /* 1) Failed, zero gap overrode the previous one. */
16572. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
16573. /* AddGap(GapUsedTemp) */ 
16574. 
16575. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
16576. /* AddGap(GapUsedTemp, DoNotVacate) */ 
16577. 
16578. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
16579. 
16580. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
16581. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
16582. /* AddGap(GapUsedTemp) */ 
16583. 
16584. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
16585. /* AddGap(GapUsedTemp, DoNotVacate) */ 
16586. 
16587. /* ---------------------------------------------------------- */
16588. 
16589. # Vacate
16590. /* AddGap(GapUsed) */
16591. 
16592. # DO NOT Vacate (recommended)
16593. /* AddGap(GapUsed, DoNotVacate) */ 
16594. 	
16595. 
16596. 		
16597. # 
16598. FileEnd
16599. /* ---------------------------------------------------------- */
16600. 
16601. # your stuff HERE (X)... post zone (file) code.
16602. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
16603. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
16604. 	# (X)
16605. 
16606. SetVariable(FileStepDescription,"Zone finished, reporting.")
16607. # Script: DisplaySetFileStep
16608. 
16609. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16610. 
16611. /* add message and move to a new line. */
16612. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16613. ")
16614. 
16615. /* display the line. (hopefully.) */
16616. # Zone Footer Set Statistics Window Text
16617. 
16618. SetStatisticsWindowText("----------------------------------------------------------
16619. Zones Processed: 
16620. ----------------------------------------------------------
16621. !ZoneListByLine!
16622. ----------------------------------------------------------
16623. Zone Processing Step:
16624. !ZoneStepByLine!    
16625. ----------------------------------------------------------
16626. Current Zone:
16627. !ZoneFooter!
16628. ----------------------------------------------------------
16629. Volume Statistics:
16630. !VolumeStatisticsDetail!
16631. ----------------------------------------------------------
16632. Zone Detailed Report:
16633. ----------------------------------------------------------
16634. !ZoneStatisticsDetail!
16635. ----------------------------------------------------------
16636. ")
16637. 
16638. 
16639. 
16640. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16641. 
16642. # Script: BannerSet
16643. 
16644. # Script: DisplaySetDateTimeRun
16645. 
16646. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
16647. /* Xinclude "..\Display\BannerSet.MyDc"X */
16648. /* pause(1) */
16649. 
16650. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16651. 
16652. Title('!Heading!')
16653. /* pause(1) */
16654. 
16655. /* NOTE: Can't round or truncate to integer precision. */
16656. 
16657. pause(1)
16658. 
16659. # Script: ZoneWhenFinished
16660. 
16661. # Script: BannerSet
16662. 
16663. # Script: DisplaySetDateTimeRun
16664. 
16665. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
16666. /* Xinclude "..\Display\BannerSet.MyDc"X */
16667. /* pause(1) */
16668. 
16669. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16670. 
16671. Title('!Heading!')
16672. /* pause(1) */
16673. 
16674. /* NOTE: Can't round or truncate to integer precision. */
16675. 
16676. # Script: BannerLog
16677. 
16678. AppendLogfile("!LogFileName!", "!Title!")
16679. 
16680. 
16681. 
16682. # Zone Statistics	
16683. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
16684. 
16685. # Footer:
16686. SetVariable(ZoneFooter, "----------------------------------------------------------
16687. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
16688. 
16689. Statistics Report:
16690. ------------------
16691.    Size:  
16692.    ------------------------
16693.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16694.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16695.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16696. 
16697.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16698.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16699. 
16700.    Location:
16701.    ------------------------
16702.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16703.              Files End: !ZoneEndCurrent!
16704.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16705.       
16706.    Gap Settings:
16707.    ------------------------
16708.          Gap Requested: !ZoneGapSizePer!%
16709.       Volume Rounding: !ZoneVolRoundUpPer!%
16710.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16711.                  
16712.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16713.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16714.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16715.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16716.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16717.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16718.      
16719.    Free Space after Zone:
16720.    ------------------------
16721.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16722.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16723.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16724. 
16725. Directory and Files Select:
16726. ---------------------------
16727. !ZoneTypeSelectCurrent!               
16728. ---------------------------
16729. ----------------------------------------------------------
16730. ")
16731. 
16732. AppendLogfile("!LogFileName!", ".")
16733. AppendLogfile("!LogFileName!", "!ZoneFooter!")
16734. AppendLogfile("!LogFileName!", ".")
16735. 
16736. # Zone Footer Set Statistics Window Text
16737. 
16738. SetStatisticsWindowText("----------------------------------------------------------
16739. Zones Processed: 
16740. ----------------------------------------------------------
16741. !ZoneListByLine!
16742. ----------------------------------------------------------
16743. Zone Processing Step:
16744. !ZoneStepByLine!    
16745. ----------------------------------------------------------
16746. Current Zone:
16747. !ZoneFooter!
16748. ----------------------------------------------------------
16749. Volume Statistics:
16750. !VolumeStatisticsDetail!
16751. ----------------------------------------------------------
16752. Zone Detailed Report:
16753. ----------------------------------------------------------
16754. !ZoneStatisticsDetail!
16755. ----------------------------------------------------------
16756. ")
16757. 
16758. 
16759. 
16760. /* pause() */
16761. /* pause() */
16762. 
16763. 
16764. 
16765. /* ---------------------------------------------------------- */
16766. 
16767.   
16768. /* ---------------------------------------------------------- */
16769. # DIR
16770. 
16771. # Script: DefragZoneTypeOsDir
16772. /* ---------------------------------------------------------- */
16773. SetVariable(ZoneLabel,				"DIR") // "5"
16774. SetVariable(ZoneDescription, 		"Directories.")
16775. SetVariable(ZoneCurrentAjust, 		2)
16776. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpDir!")
16777. SetVariable(ZoneGapSize, 			"!ZoneGapSizeDir!")
16778. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectOsDIR
16779. # DIR start.
16780. Directory(yes)
16781. # DIR end.
16782. ')
16783. 
16784. 	# Script: ZoneDoHeader
16785. 
16786. # Script: ZoneWhenStarted
16787. 
16788. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
16789. # Script: DisplaySetZone
16790. 
16791. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
16792. SetVariable(FileStepDescription,	"")
16793. 
16794. SetVariable(ZoneStepByLine, 			"Zone started.
16795. ")
16796. 
16797. # Script: BannerDescriptionSet
16798. 
16799. # Script: BannerSet
16800. 
16801. # Script: DisplaySetDateTimeRun
16802. 
16803. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:50 0:00:06")
16804. /* Xinclude "..\Display\BannerSet.MyDc"X */
16805. /* pause(1) */
16806. 
16807. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16808. 
16809. Title('!Heading!')
16810. /* pause(1) */
16811. 
16812. /* NOTE: Can't round or truncate to integer precision. */
16813. 
16814. # Script: BannerLog
16815. 
16816. AppendLogfile("!LogFileName!", "!Title!")
16817. 
16818. 
16819. 
16820. pause(1)
16821. 
16822. 
16823. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
16824. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
16825. 
16826. SetVariable(ZoneStepNoCurrent, 0)
16827. 
16828. 
16829. # Script: ZoneDoCurrentClear
16830. 
16831. SetVariable(ZoneTypeSelectCurrent, 		"")
16832. 
16833. SetVariable(ZoneBeginCurrent, 			0)
16834. SetVariable(ZoneBeginPerCurrent, 		0)
16835. SetVariable(ZoneEndCurrent, 			0)
16836. SetVariable(ZoneEndPerCurrent, 			0)
16837. 
16838. SetVariable(ZoneSizeCurrent,			0)
16839. SetVariable(ZoneSizePerCurrent,			0)
16840. 
16841. SetVariable(ZoneGapRequestedCurrent,	0)
16842. SetVariable(ZoneGapRoundedCurrent, 		0)
16843. SetVariable(ZoneGapAdjustedCurrent, 	0)
16844. SetVariable(ZoneGapAvailableCurrent, 	0)
16845. SetVariable(ZoneGapCurrent,				0)
16846. SetVariable(ZoneGapUsedCurrent, 		0)
16847. 
16848. SetVariable(ZoneGapActualCurrent, 		0)
16849. SetVariable(ZoneGapActualPerCurrent, 	0)
16850. 
16851. SetVariable(ZoneSizeActual, 			0)
16852. SetVariable(ZoneSizeActualCurrent,		0)
16853. 
16854. SetVariable(ZoneEndActual, 				0)
16855. SetVariable(ZoneEndActualCurrent,		0)			
16856. SetVariable(ZoneSizeActualPerCurrent, 	0)
16857.       
16858. SetVariable(ZoneFilesFolders,			0)
16859. SetVariable(ZoneFilesFoldersPer,		0) 
16860. 
16861. SetVariable(ZoneFragments,				0)
16862. SetVariable(ZoneFragmentsPer,			0) 
16863. 		
16864. SetVariable(ZoneEndActualCurrent, 		0)
16865. SetVariable(ZoneEndActualPerCurrent, 	0)
16866. 
16867. # Gap Calculation Methodology:
16868. 	# Requested
16869. 	SetVariable(GapRequested, 			0) 
16870. 	SetVariable(GapRequestedStd, 		0) 
16871. 	SetVariable(GapRequestedMft, 		0) 
16872. 	SetVariable(GapRequestedOs, 		0) 
16873. 	SetVariable(GapRequestedOriginal, 	0) 
16874. 	
16875. 	# Gap Adjustments
16876. 	SetVariable(GapRounded, 			0)
16877. 	# SetVariable(GapAdjusted, 			0)
16878. 	SetVariable(GapAvailable, 			0)
16879. 	SetVariable(GapCurrent, 			0)
16880. 	SetVariable(GapActual, 				0)
16881. 	SetVariable(GapUsed, 				0)
16882. 	
16883. 	# Gap Adjustments
16884. 	SetVariable(GapRoundedLoc, 			0)
16885. 	# SetVariable(GapAdjustedLoc, 		0)
16886. 	SetVariable(GapAvailableLoc, 		0)
16887. 	SetVariable(GapCurrentLoc, 			0)
16888. 	SetVariable(GapActualLoc,			0)
16889. 	SetVariable(GapUsedLoc,				0)
16890. 	
16891. 	# Space usage
16892. 	SetVariable(ZoneFreePerRequested, 	0)
16893. 	SetVariable(ZoneFreePerUsed, 		0)
16894. 
16895. # Gap Size & Rounding
16896. 	SetVariable(ZoneGapSizePer, 		0)
16897. 	SetVariable(ZoneVolRoundUpPer, 		0)
16898. 	
16899. 	# Free Space
16900. 	SetVariable(ZoneFreeUsedPer, 		0)
16901. 	SetVariable(ZoneFreeRequestedPer, 	0)
16902. 
16903. 
16904. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
16905. 
16906. # Footer:
16907. SetVariable(ZoneFooter, "----------------------------------------------------------
16908. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:50
16909. 
16910. Statistics Report:
16911. ------------------
16912.    Size:  
16913.    ------------------------
16914.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16915.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16916.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16917. 
16918.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16919.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16920. 
16921.    Location:
16922.    ------------------------
16923.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16924.              Files End: !ZoneEndCurrent!
16925.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16926.       
16927.    Gap Settings:
16928.    ------------------------
16929.          Gap Requested: !ZoneGapSizePer!%
16930.       Volume Rounding: !ZoneVolRoundUpPer!%
16931.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16932.                  
16933.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16934.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16935.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16936.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16937.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16938.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16939.      
16940.    Free Space after Zone:
16941.    ------------------------
16942.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16943.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16944.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16945. 
16946. Directory and Files Select:
16947. ---------------------------
16948. !ZoneTypeSelectCurrent!               
16949. ---------------------------
16950. ----------------------------------------------------------
16951. ")
16952. 
16953. # Script: BannerSet
16954. 
16955. # Script: DisplaySetDateTimeRun
16956. 
16957. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
16958. /* Xinclude "..\Display\BannerSet.MyDc"X */
16959. /* pause(1) */
16960. 
16961. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16962. 
16963. Title('!Heading!')
16964. /* pause(1) */
16965. 
16966. /* NOTE: Can't round or truncate to integer precision. */
16967. 
16968. # Script: BannerLog
16969. 
16970. AppendLogfile("!LogFileName!", "!Title!")
16971. 
16972. 
16973. 
16974. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
16975. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
16976. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:50")
16977. 
16978. SetVariable(ZoneListByLine, "!ZoneListByLine!
16979. Zone: !ZoneNoCurrent! 2021-11-09 18:53:50 0:00:06 !ZoneLabel! !ZoneDescription!")
16980. 
16981. 
16982. /* Fixed Zone Position Handling */
16983. /* Literal number: */
16984. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
16985. /* Percentage of disk: */
16986. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
16987. /* Gap */
16988. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
16989. 
16990. /* ---------------------------------------------------------- */
16991. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
16992. # Script: DisplaySetFileStep
16993. 
16994. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16995. 
16996. /* add message and move to a new line. */
16997. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16998. ")
16999. 
17000. /* display the line. (hopefully.) */
17001. # Zone Footer Set Statistics Window Text
17002. 
17003. SetStatisticsWindowText("----------------------------------------------------------
17004. Zones Processed: 
17005. ----------------------------------------------------------
17006. !ZoneListByLine!
17007. ----------------------------------------------------------
17008. Zone Processing Step:
17009. !ZoneStepByLine!    
17010. ----------------------------------------------------------
17011. Current Zone:
17012. !ZoneFooter!
17013. ----------------------------------------------------------
17014. Volume Statistics:
17015. !VolumeStatisticsDetail!
17016. ----------------------------------------------------------
17017. Zone Detailed Report:
17018. ----------------------------------------------------------
17019. !ZoneStatisticsDetail!
17020. ----------------------------------------------------------
17021. ")
17022. 
17023. 
17024. 
17025. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17026. 
17027. # Script: BannerSet
17028. 
17029. # Script: DisplaySetDateTimeRun
17030. 
17031. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
17032. /* Xinclude "..\Display\BannerSet.MyDc"X */
17033. /* pause(1) */
17034. 
17035. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17036. 
17037. Title('!Heading!')
17038. /* pause(1) */
17039. 
17040. /* NOTE: Can't round or truncate to integer precision. */
17041. 
17042. pause(1)
17043. 
17044. # your stuff HERE (X)... pre file select code.
17045. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
17046. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17047. 	# (X)
17048. 
17049. FileSelect
17050. 
17051. 	# your stuff can't really go here (errors.)
17052. 	# maybe for some reason I don't know of...
17053. 	
17054. 	# Actions next...
17055. 	# Script: ZoneDo ZoneTypeSelectOsDIR
17056. # DIR start.
17057. Directory(yes)
17058. # DIR end.
17059. 
17060. 
17061. 	FileActions
17062. 	  		/* ---------------------------------------------------------- */
17063. 	# Gap
17064. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
17065. 		# Script: DisplaySetFileStep
17066. 
17067. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17068. 
17069. /* add message and move to a new line. */
17070. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17071. ")
17072. 
17073. /* display the line. (hopefully.) */
17074. # Zone Footer Set Statistics Window Text
17075. 
17076. SetStatisticsWindowText("----------------------------------------------------------
17077. Zones Processed: 
17078. ----------------------------------------------------------
17079. !ZoneListByLine!
17080. ----------------------------------------------------------
17081. Zone Processing Step:
17082. !ZoneStepByLine!    
17083. ----------------------------------------------------------
17084. Current Zone:
17085. !ZoneFooter!
17086. ----------------------------------------------------------
17087. Volume Statistics:
17088. !VolumeStatisticsDetail!
17089. ----------------------------------------------------------
17090. Zone Detailed Report:
17091. ----------------------------------------------------------
17092. !ZoneStatisticsDetail!
17093. ----------------------------------------------------------
17094. ")
17095. 
17096. 
17097. 
17098. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17099. 
17100. # Script: BannerSet
17101. 
17102. # Script: DisplaySetDateTimeRun
17103. 
17104. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
17105. /* Xinclude "..\Display\BannerSet.MyDc"X */
17106. /* pause(1) */
17107. 
17108. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17109. 
17110. Title('!Heading!')
17111. /* pause(1) */
17112. 
17113. /* NOTE: Can't round or truncate to integer precision. */
17114. 
17115. pause(1)
17116. 	
17117. 	# ACTUAL GAP
17118. 		/* AddGap Variant. */
17119. 	  	# Zone Do Gap
17120. # Gap Calculation Methods:
17121. 
17122. /* 1) Anything you need to add first. */
17123. /* empty */
17124. 
17125. /* ---------------------------------------------------------- */
17126. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
17127. 	# GapRequestedStd.
17128. 
17129. 		/* ---------------------------------------------------------- */
17130. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
17131. 
17132. 		# Gap Calculation Methods:
17133. 
17134. /* AddGap Variants */
17135. 
17136. 	/* Standard */
17137. 		# Gap Calculation Methods:
17138. 	/* AddGap Variants */
17139. 	/* Standard */
17140. 
17141. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
17142. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
17143. 
17144. 	SetVariable(GapRequested, GapRequestedStd)
17145. 	
17146. 
17147. 	/* MFT Low High Method */
17148. 		# Gap Calculation Methods:
17149. 	/* AddGap Variants */
17150. 	/* MFT Low High Method */
17151. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
17152. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
17153. 	SetVariable(GapRequested, GapRequestedMft)
17154. 	
17155. 
17156. 	/* OS Volume Type Method */
17157. 		# Gap Calculation Methods:
17158. 	/* AddGap Variants */
17159. 	/* OS Volume Type Method */
17160. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
17161. 	SetVariable(GapRequested, GapRequestedOs)
17162. 
17163. 
17164. 
17165. /* MakeGap Variants */
17166. 
17167. 	/* Original Os 1-3 + MFT 2 */
17168. 		# Gap Calculation Methods:
17169. 	/* MakeGap Variants */
17170. 	/* Original Os 1-3 + MFT 2 */
17171. 	/* plus MFT gap placed inline at the dividing zone. */
17172. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
17173. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
17174. 	SetVariable(GapRequested, GapRequestedOrig)
17175. 	
17176. 	
17177. /* Note: You could comment out the ones not in use */
17178. /* However having the data in the log is useful. */
17179. /* Therefore the following line is otherwise needed. */
17180. 
17181. /* Standard used */
17182. 
17183. SetVariable(GapRequested, GapRequestedStd)
17184. 
17185. # Gap Calculation Methods:
17186. 
17187. /* AddGap Variants */
17188. 	/* Standard */
17189. 	/* MFT Low High Method */
17190. 	/* OS Volume Type Method */
17191. 
17192. /* MakeGap Variants */
17193. 	/* Original Os 1-3 + MFT 2 */
17194. 
17195. /* Note: You could comment out the ones not in use */
17196. /* However having the data in the log is useful. */
17197. /* Therefore the following line is otherwise needed. */
17198. 
17199. /* Standard is used currently */
17200. 
17201. 
17202. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
17203. 
17204. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
17205. 
17206. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
17207. 
17208. /* ---------------------------------------------------------- */
17209. /* 3) SMALL ZONE ADJUSTMENT. */
17210. /* Gab cant be larger than half the Zone Size. */
17211. 
17212. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
17213. 	
17214. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
17215. 
17216. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
17217. 
17218. /* ---------------------------------------------------------- */
17219. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
17220. # Gap Adjustments.
17221. 
17222. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
17223. 	
17224. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
17225. 
17226. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
17227. 
17228. /* ---------------------------------------------------------- */
17229. # BYPASS THIS.
17230. 	/* This is definitely wrong. */
17231. 	/* The question is can we steal gap from the next zone */
17232. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
17233. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
17234. 		# Zone Overflow.
17235. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
17236. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
17237. 
17238. /* ---------------------------------------------------------- */
17239. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
17240. # Remaining free space available.
17241. 
17242. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
17243. 	
17244. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
17245. 
17246. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
17247. 
17248. /* ---------------------------------------------------------- */
17249. # CURRENT gap to use.
17250. 
17251. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
17252. 
17253. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
17254. 
17255. /* ---------------------------------------------------------- */
17256. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
17257. # Debugging.
17258. 
17259. 	SetVariable(GapUsed, GapCurrent) // for debugging
17260. 
17261. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
17262. 
17263. 		# Your code HERE
17264. 
17265. /* ---------------------------------------------------------- */
17266. /* 7) YOUR CODE. */
17267. # YOUR CODE HERE:
17268. 	# INPUT: GapCurrent or GapCurrentLoc
17269. 	# OUTPUT: GapUsed...
17270. 
17271. /* ---------------------------------------------------------- */
17272. # Gap Size.
17273. # Actual Size of Gap.
17274. 
17275. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
17276. 
17277. /* ---------------------------------------------------------- */
17278. /* xxxxxxxxxxxxxxxxxxxxxx */
17279. # ADD THE GAP
17280. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
17281. /* xxxxxxxxxxxxxxxxxxxxxx */
17282. 
17283. 	
17284. 	# Zone Statistics	
17285. 	# Script: ZoneDoStatistics
17286. # Zone / Volume Statistics and Display
17287. 		
17288. 	# Accumulate Totals
17289.   	# Script: ZoneDoVolumeTotals
17290. 
17291. /* Current total space used (by Zones and Gaps) */
17292. 
17293. SetVariable(VolumeZoneUsed, GapUsed)
17294. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
17295. /* Percentage */
17296. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
17297. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
17298. 
17299. /* Current total of free space requested */
17300. 
17301. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
17302. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17303. /* Percent. */
17304. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
17305. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
17306. 
17307. /* Current total of free space used */
17308. 
17309. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
17310. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
17311. /* Percent */
17312. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
17313. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
17314. 
17315. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
17316. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
17317. /* Xinclude "..\DebugDisplayPause.MyDc"X */
17318. 
17319. 
17320. 	# Current Values
17321. 	# Script: ZoneDoCurrentSet
17322. 
17323. # Cluster, Sector, Block adjust for display.
17324. 	# Bytes per cluster is volume specific.
17325. 
17326. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
17327. 
17328. # Current Zone values.
17329. 	# Begin, end and size.
17330. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
17331. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
17332. 
17333. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
17334. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
17335. 
17336. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
17337. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
17338. 
17339. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
17340. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
17341. 
17342. 	SetVariable(ZoneFragments,				"!ZONE210N!")
17343. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
17344. 		
17345. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
17346. /* identical code to here: (separation not needed. TEST.) */	
17347. 
17348. # Current Gap, Actual and Free Values
17349. 	# Gap
17350. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
17351. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
17352. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
17353. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
17354. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
17355. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
17356. 	
17357. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
17358. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
17359. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
17360. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
17361. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
17362. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
17363. 	
17364. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
17365. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
17366. 	
17367. 	# Actual Size and End
17368. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
17369. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
17370. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
17371. 	
17372. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
17373. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
17374. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
17375. 
17376. # Gap Size & Rounding
17377. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
17378. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
17379. 	
17380. 	# Free Space
17381. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
17382. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
17383. 
17384. 	# Footer:
17385. SetVariable(ZoneFooter, "----------------------------------------------------------
17386. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
17387. 
17388. Statistics Report:
17389. ------------------
17390.    Size:  
17391.    ------------------------
17392.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17393.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17394.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17395. 
17396.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17397.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17398. 
17399.    Location:
17400.    ------------------------
17401.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17402.              Files End: !ZoneEndCurrent!
17403.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17404.       
17405.    Gap Settings:
17406.    ------------------------
17407.          Gap Requested: !ZoneGapSizePer!%
17408.       Volume Rounding: !ZoneVolRoundUpPer!%
17409.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17410.                  
17411.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17412.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17413.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17414.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17415.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17416.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17417.      
17418.    Free Space after Zone:
17419.    ------------------------
17420.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17421.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17422.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17423. 
17424. Directory and Files Select:
17425. ---------------------------
17426. !ZoneTypeSelectCurrent!               
17427. ---------------------------
17428. ----------------------------------------------------------
17429. ")
17430. 	# Zone Footer Set Statistics Window Text
17431. 
17432. SetStatisticsWindowText("----------------------------------------------------------
17433. Zones Processed: 
17434. ----------------------------------------------------------
17435. !ZoneListByLine!
17436. ----------------------------------------------------------
17437. Zone Processing Step:
17438. !ZoneStepByLine!    
17439. ----------------------------------------------------------
17440. Current Zone:
17441. !ZoneFooter!
17442. ----------------------------------------------------------
17443. Volume Statistics:
17444. !VolumeStatisticsDetail!
17445. ----------------------------------------------------------
17446. Zone Detailed Report:
17447. ----------------------------------------------------------
17448. !ZoneStatisticsDetail!
17449. ----------------------------------------------------------
17450. ")
17451. 
17452. 
17453. 	
17454.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
17455. 
17456. 	# Add Zone to list of zones for display.
17457. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
17458. 	# ??? Free Stats?
17459. 	# Footer:
17460. SetVariable(ZoneFooter, "----------------------------------------------------------
17461. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
17462. 
17463. Statistics Report:
17464. ------------------
17465.    Size:  
17466.    ------------------------
17467.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17468.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17469.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17470. 
17471.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17472.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17473. 
17474.    Location:
17475.    ------------------------
17476.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17477.              Files End: !ZoneEndCurrent!
17478.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17479.       
17480.    Gap Settings:
17481.    ------------------------
17482.          Gap Requested: !ZoneGapSizePer!%
17483.       Volume Rounding: !ZoneVolRoundUpPer!%
17484.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17485.                  
17486.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17487.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17488.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17489.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17490.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17491.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17492.      
17493.    Free Space after Zone:
17494.    ------------------------
17495.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17496.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17497.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17498. 
17499. Directory and Files Select:
17500. ---------------------------
17501. !ZoneTypeSelectCurrent!               
17502. ---------------------------
17503. ----------------------------------------------------------
17504. ")
17505. 
17506. 	# Add Zone Details to Report.	
17507. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
17508. !ZoneFooter!")
17509. 
17510. 
17511. 	
17512. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
17513. 		# Script: DisplaySetFileStep
17514. 
17515. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17516. 
17517. /* add message and move to a new line. */
17518. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17519. ")
17520. 
17521. /* display the line. (hopefully.) */
17522. # Zone Footer Set Statistics Window Text
17523. 
17524. SetStatisticsWindowText("----------------------------------------------------------
17525. Zones Processed: 
17526. ----------------------------------------------------------
17527. !ZoneListByLine!
17528. ----------------------------------------------------------
17529. Zone Processing Step:
17530. !ZoneStepByLine!    
17531. ----------------------------------------------------------
17532. Current Zone:
17533. !ZoneFooter!
17534. ----------------------------------------------------------
17535. Volume Statistics:
17536. !VolumeStatisticsDetail!
17537. ----------------------------------------------------------
17538. Zone Detailed Report:
17539. ----------------------------------------------------------
17540. !ZoneStatisticsDetail!
17541. ----------------------------------------------------------
17542. ")
17543. 
17544. 
17545. 
17546. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17547. 
17548. # Script: BannerSet
17549. 
17550. # Script: DisplaySetDateTimeRun
17551. 
17552. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
17553. /* Xinclude "..\Display\BannerSet.MyDc"X */
17554. /* pause(1) */
17555. 
17556. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17557. 
17558. Title('!Heading!')
17559. /* pause(1) */
17560. 
17561. /* NOTE: Can't round or truncate to integer precision. */
17562. 
17563. pause(1)
17564. 	
17565. 		# File Action - Type Os Dir -  SortByName.
17566. # BY 10
17567. SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
17568. 	
17569. 
17570. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
17571. 		# Script: DisplaySetFileStep
17572. 
17573. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17574. 
17575. /* add message and move to a new line. */
17576. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17577. ")
17578. 
17579. /* display the line. (hopefully.) */
17580. # Zone Footer Set Statistics Window Text
17581. 
17582. SetStatisticsWindowText("----------------------------------------------------------
17583. Zones Processed: 
17584. ----------------------------------------------------------
17585. !ZoneListByLine!
17586. ----------------------------------------------------------
17587. Zone Processing Step:
17588. !ZoneStepByLine!    
17589. ----------------------------------------------------------
17590. Current Zone:
17591. !ZoneFooter!
17592. ----------------------------------------------------------
17593. Volume Statistics:
17594. !VolumeStatisticsDetail!
17595. ----------------------------------------------------------
17596. Zone Detailed Report:
17597. ----------------------------------------------------------
17598. !ZoneStatisticsDetail!
17599. ----------------------------------------------------------
17600. ")
17601. 
17602. 
17603. 
17604. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17605. 
17606. # Script: BannerSet
17607. 
17608. # Script: DisplaySetDateTimeRun
17609. 
17610. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
17611. /* Xinclude "..\Display\BannerSet.MyDc"X */
17612. /* pause(1) */
17613. 
17614. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17615. 
17616. Title('!Heading!')
17617. /* pause(1) */
17618. 
17619. /* NOTE: Can't round or truncate to integer precision. */
17620. 
17621. pause(1)
17622. 	# Script: ZoneDoFooter
17623. 
17624. /* ---------------------------------------------------------- */
17625. # File Select
17626. 	# Select Statments
17627. # File Actions 
17628. 	# Standard or OS File Actions.
17629. 	# Resume...
17630. 	
17631. 	# your stuff HERE (X)... post zone (file) file actions code.
17632. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
17633. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17634. 		# (X)
17635. 		
17636. 		/* ??? Set window? */
17637. 	
17638. 	# ADD THE GAP
17639. 		
17640. # Vacate (good for diagnostics)
17641. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
17642. 
17643. # DoNotVacate - DO NOT Vacate (recommended)
17644. 
17645. # Vacate
17646. /* AddGap(GapUsedLoc) */
17647. 
17648. # DO Not Vacate
17649. AddGap(GapUsedLoc, DoNotVacate) 
17650. 	
17651. 	
17652. /* ---------------------------------------------------------- */
17653. # (failed) TEST for boolean logic.
17654. 
17655. /* It should work in the gap calculations for turning options */
17656. /* on and off but it will NOT work here. */
17657. 
17658. /* Boolean setting X or FlagX. */
17659. /* Where X will be on or off: */
17660. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
17661. /*      For ON:  (X  *  FlagAny) */
17662. 
17663. /* 1) Failed, zero gap overrode the previous one. */
17664. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
17665. /* AddGap(GapUsedTemp) */ 
17666. 
17667. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
17668. /* AddGap(GapUsedTemp, DoNotVacate) */ 
17669. 
17670. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
17671. 
17672. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
17673. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
17674. /* AddGap(GapUsedTemp) */ 
17675. 
17676. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
17677. /* AddGap(GapUsedTemp, DoNotVacate) */ 
17678. 
17679. /* ---------------------------------------------------------- */
17680. 
17681. # Vacate
17682. /* AddGap(GapUsed) */
17683. 
17684. # DO NOT Vacate (recommended)
17685. /* AddGap(GapUsed, DoNotVacate) */ 
17686. 	
17687. 
17688. 		
17689. # 
17690. FileEnd
17691. /* ---------------------------------------------------------- */
17692. 
17693. # your stuff HERE (X)... post zone (file) code.
17694. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
17695. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
17696. 	# (X)
17697. 
17698. SetVariable(FileStepDescription,"Zone finished, reporting.")
17699. # Script: DisplaySetFileStep
17700. 
17701. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17702. 
17703. /* add message and move to a new line. */
17704. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17705. ")
17706. 
17707. /* display the line. (hopefully.) */
17708. # Zone Footer Set Statistics Window Text
17709. 
17710. SetStatisticsWindowText("----------------------------------------------------------
17711. Zones Processed: 
17712. ----------------------------------------------------------
17713. !ZoneListByLine!
17714. ----------------------------------------------------------
17715. Zone Processing Step:
17716. !ZoneStepByLine!    
17717. ----------------------------------------------------------
17718. Current Zone:
17719. !ZoneFooter!
17720. ----------------------------------------------------------
17721. Volume Statistics:
17722. !VolumeStatisticsDetail!
17723. ----------------------------------------------------------
17724. Zone Detailed Report:
17725. ----------------------------------------------------------
17726. !ZoneStatisticsDetail!
17727. ----------------------------------------------------------
17728. ")
17729. 
17730. 
17731. 
17732. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17733. 
17734. # Script: BannerSet
17735. 
17736. # Script: DisplaySetDateTimeRun
17737. 
17738. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
17739. /* Xinclude "..\Display\BannerSet.MyDc"X */
17740. /* pause(1) */
17741. 
17742. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17743. 
17744. Title('!Heading!')
17745. /* pause(1) */
17746. 
17747. /* NOTE: Can't round or truncate to integer precision. */
17748. 
17749. pause(1)
17750. 
17751. # Script: ZoneWhenFinished
17752. 
17753. # Script: BannerSet
17754. 
17755. # Script: DisplaySetDateTimeRun
17756. 
17757. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
17758. /* Xinclude "..\Display\BannerSet.MyDc"X */
17759. /* pause(1) */
17760. 
17761. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17762. 
17763. Title('!Heading!')
17764. /* pause(1) */
17765. 
17766. /* NOTE: Can't round or truncate to integer precision. */
17767. 
17768. # Script: BannerLog
17769. 
17770. AppendLogfile("!LogFileName!", "!Title!")
17771. 
17772. 
17773. 
17774. # Zone Statistics	
17775. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
17776. 
17777. # Footer:
17778. SetVariable(ZoneFooter, "----------------------------------------------------------
17779. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
17780. 
17781. Statistics Report:
17782. ------------------
17783.    Size:  
17784.    ------------------------
17785.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17786.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17787.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17788. 
17789.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17790.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17791. 
17792.    Location:
17793.    ------------------------
17794.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17795.              Files End: !ZoneEndCurrent!
17796.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17797.       
17798.    Gap Settings:
17799.    ------------------------
17800.          Gap Requested: !ZoneGapSizePer!%
17801.       Volume Rounding: !ZoneVolRoundUpPer!%
17802.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17803.                  
17804.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17805.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17806.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17807.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17808.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17809.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17810.      
17811.    Free Space after Zone:
17812.    ------------------------
17813.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17814.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17815.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17816. 
17817. Directory and Files Select:
17818. ---------------------------
17819. !ZoneTypeSelectCurrent!               
17820. ---------------------------
17821. ----------------------------------------------------------
17822. ")
17823. 
17824. AppendLogfile("!LogFileName!", ".")
17825. AppendLogfile("!LogFileName!", "!ZoneFooter!")
17826. AppendLogfile("!LogFileName!", ".")
17827. 
17828. # Zone Footer Set Statistics Window Text
17829. 
17830. SetStatisticsWindowText("----------------------------------------------------------
17831. Zones Processed: 
17832. ----------------------------------------------------------
17833. !ZoneListByLine!
17834. ----------------------------------------------------------
17835. Zone Processing Step:
17836. !ZoneStepByLine!    
17837. ----------------------------------------------------------
17838. Current Zone:
17839. !ZoneFooter!
17840. ----------------------------------------------------------
17841. Volume Statistics:
17842. !VolumeStatisticsDetail!
17843. ----------------------------------------------------------
17844. Zone Detailed Report:
17845. ----------------------------------------------------------
17846. !ZoneStatisticsDetail!
17847. ----------------------------------------------------------
17848. ")
17849. 
17850. 
17851. 
17852. /* pause() */
17853. /* pause() */
17854. 
17855. 
17856. 
17857. 
17858. /* Mft Method: MFT GAP HERE. */
17859. /* For fixed zone locations */
17860. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-11-09 18:53:50")
17861. /* MakeGap(MftGap, DoNotVacate) */
17862. /* ---------------------------------------------------------- */
17863. 
17864. 
17865. /* ---------------------------------------------------------- */
17866. /* Mft Method: MFT GAP HERE. */
17867. /* For fixed zone locations */
17868. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-11-09 18:53:50")
17869. /* MakeGap(MftGap, DoNotVacate) */
17870.   
17871. /* ---------------------------------------------------------- */
17872. # PageHiberDump
17873. 
17874. # You cannot move Pagefile or Hiberfil generally speaking.
17875. # This might work in safe mode with preparation.
17876. # Zone PageHiberDump.
17877. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
17878. 
17879. # Script: DefragZoneTypeOsPageHiberDump
17880. /* ---------------------------------------------------------- */
17881. # PageHiberDump
17882. # You cannot move Pagefile or Hiberfil generally speaking.
17883. # This might work in safe mode with preparation.
17884. # Zone PageHiberDump.
17885. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
17886. 
17887. 	SetVariable(ZoneLabel, 			"!ZoneLabelPageHiberDump!")
17888. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPageHiberDump!")
17889. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPageHiberDump!")
17890. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePageHiberDump!")
17891. 	SetVariable(ZoneTypeSelect,		'# Script: ZoneDo ZoneTypeSelectOsPageHiberDump
17892. # PageHiberDump start.
17893. (
17894. # Os PageHiberDump start.
17895. (
17896.   FileName("DataStore.edb")
17897.   or FileName("DUMP*.*")
17898.   or FileName("Hiberfil.sys")
17899.   or FileName("MEMORY.DMP")
17900.   or FileName("Pagefile.sys")
17901. )
17902. # Os PageHiberDump end.
17903. 
17904. )
17905. # PageHiberDump end.
17906. ')
17907. 
17908. 		# Script: ZoneDoHeader
17909. 
17910. # Script: ZoneWhenStarted
17911. 
17912. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
17913. # Script: DisplaySetZone
17914. 
17915. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
17916. SetVariable(FileStepDescription,	"")
17917. 
17918. SetVariable(ZoneStepByLine, 			"Zone started.
17919. ")
17920. 
17921. # Script: BannerDescriptionSet
17922. 
17923. # Script: BannerSet
17924. 
17925. # Script: DisplaySetDateTimeRun
17926. 
17927. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
17928. /* Xinclude "..\Display\BannerSet.MyDc"X */
17929. /* pause(1) */
17930. 
17931. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17932. 
17933. Title('!Heading!')
17934. /* pause(1) */
17935. 
17936. /* NOTE: Can't round or truncate to integer precision. */
17937. 
17938. # Script: BannerLog
17939. 
17940. AppendLogfile("!LogFileName!", "!Title!")
17941. 
17942. 
17943. 
17944. pause(1)
17945. 
17946. 
17947. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
17948. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
17949. 
17950. SetVariable(ZoneStepNoCurrent, 0)
17951. 
17952. 
17953. # Script: ZoneDoCurrentClear
17954. 
17955. SetVariable(ZoneTypeSelectCurrent, 		"")
17956. 
17957. SetVariable(ZoneBeginCurrent, 			0)
17958. SetVariable(ZoneBeginPerCurrent, 		0)
17959. SetVariable(ZoneEndCurrent, 			0)
17960. SetVariable(ZoneEndPerCurrent, 			0)
17961. 
17962. SetVariable(ZoneSizeCurrent,			0)
17963. SetVariable(ZoneSizePerCurrent,			0)
17964. 
17965. SetVariable(ZoneGapRequestedCurrent,	0)
17966. SetVariable(ZoneGapRoundedCurrent, 		0)
17967. SetVariable(ZoneGapAdjustedCurrent, 	0)
17968. SetVariable(ZoneGapAvailableCurrent, 	0)
17969. SetVariable(ZoneGapCurrent,				0)
17970. SetVariable(ZoneGapUsedCurrent, 		0)
17971. 
17972. SetVariable(ZoneGapActualCurrent, 		0)
17973. SetVariable(ZoneGapActualPerCurrent, 	0)
17974. 
17975. SetVariable(ZoneSizeActual, 			0)
17976. SetVariable(ZoneSizeActualCurrent,		0)
17977. 
17978. SetVariable(ZoneEndActual, 				0)
17979. SetVariable(ZoneEndActualCurrent,		0)			
17980. SetVariable(ZoneSizeActualPerCurrent, 	0)
17981.       
17982. SetVariable(ZoneFilesFolders,			0)
17983. SetVariable(ZoneFilesFoldersPer,		0) 
17984. 
17985. SetVariable(ZoneFragments,				0)
17986. SetVariable(ZoneFragmentsPer,			0) 
17987. 		
17988. SetVariable(ZoneEndActualCurrent, 		0)
17989. SetVariable(ZoneEndActualPerCurrent, 	0)
17990. 
17991. # Gap Calculation Methodology:
17992. 	# Requested
17993. 	SetVariable(GapRequested, 			0) 
17994. 	SetVariable(GapRequestedStd, 		0) 
17995. 	SetVariable(GapRequestedMft, 		0) 
17996. 	SetVariable(GapRequestedOs, 		0) 
17997. 	SetVariable(GapRequestedOriginal, 	0) 
17998. 	
17999. 	# Gap Adjustments
18000. 	SetVariable(GapRounded, 			0)
18001. 	# SetVariable(GapAdjusted, 			0)
18002. 	SetVariable(GapAvailable, 			0)
18003. 	SetVariable(GapCurrent, 			0)
18004. 	SetVariable(GapActual, 				0)
18005. 	SetVariable(GapUsed, 				0)
18006. 	
18007. 	# Gap Adjustments
18008. 	SetVariable(GapRoundedLoc, 			0)
18009. 	# SetVariable(GapAdjustedLoc, 		0)
18010. 	SetVariable(GapAvailableLoc, 		0)
18011. 	SetVariable(GapCurrentLoc, 			0)
18012. 	SetVariable(GapActualLoc,			0)
18013. 	SetVariable(GapUsedLoc,				0)
18014. 	
18015. 	# Space usage
18016. 	SetVariable(ZoneFreePerRequested, 	0)
18017. 	SetVariable(ZoneFreePerUsed, 		0)
18018. 
18019. # Gap Size & Rounding
18020. 	SetVariable(ZoneGapSizePer, 		0)
18021. 	SetVariable(ZoneVolRoundUpPer, 		0)
18022. 	
18023. 	# Free Space
18024. 	SetVariable(ZoneFreeUsedPer, 		0)
18025. 	SetVariable(ZoneFreeRequestedPer, 	0)
18026. 
18027. 
18028. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
18029. 
18030. # Footer:
18031. SetVariable(ZoneFooter, "----------------------------------------------------------
18032. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
18033. 
18034. Statistics Report:
18035. ------------------
18036.    Size:  
18037.    ------------------------
18038.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18039.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18040.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18041. 
18042.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18043.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18044. 
18045.    Location:
18046.    ------------------------
18047.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18048.              Files End: !ZoneEndCurrent!
18049.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18050.       
18051.    Gap Settings:
18052.    ------------------------
18053.          Gap Requested: !ZoneGapSizePer!%
18054.       Volume Rounding: !ZoneVolRoundUpPer!%
18055.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18056.                  
18057.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18058.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18059.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18060.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18061.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18062.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18063.      
18064.    Free Space after Zone:
18065.    ------------------------
18066.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18067.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18068.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18069. 
18070. Directory and Files Select:
18071. ---------------------------
18072. !ZoneTypeSelectCurrent!               
18073. ---------------------------
18074. ----------------------------------------------------------
18075. ")
18076. 
18077. # Script: BannerSet
18078. 
18079. # Script: DisplaySetDateTimeRun
18080. 
18081. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
18082. /* Xinclude "..\Display\BannerSet.MyDc"X */
18083. /* pause(1) */
18084. 
18085. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18086. 
18087. Title('!Heading!')
18088. /* pause(1) */
18089. 
18090. /* NOTE: Can't round or truncate to integer precision. */
18091. 
18092. # Script: BannerLog
18093. 
18094. AppendLogfile("!LogFileName!", "!Title!")
18095. 
18096. 
18097. 
18098. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
18099. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
18100. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:51")
18101. 
18102. SetVariable(ZoneListByLine, "!ZoneListByLine!
18103. Zone: !ZoneNoCurrent! 2021-11-09 18:53:51 0:00:07 !ZoneLabel! !ZoneDescription!")
18104. 
18105. 
18106. /* Fixed Zone Position Handling */
18107. /* Literal number: */
18108. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
18109. /* Percentage of disk: */
18110. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
18111. /* Gap */
18112. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
18113. 
18114. /* ---------------------------------------------------------- */
18115. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
18116. # Script: DisplaySetFileStep
18117. 
18118. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18119. 
18120. /* add message and move to a new line. */
18121. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18122. ")
18123. 
18124. /* display the line. (hopefully.) */
18125. # Zone Footer Set Statistics Window Text
18126. 
18127. SetStatisticsWindowText("----------------------------------------------------------
18128. Zones Processed: 
18129. ----------------------------------------------------------
18130. !ZoneListByLine!
18131. ----------------------------------------------------------
18132. Zone Processing Step:
18133. !ZoneStepByLine!    
18134. ----------------------------------------------------------
18135. Current Zone:
18136. !ZoneFooter!
18137. ----------------------------------------------------------
18138. Volume Statistics:
18139. !VolumeStatisticsDetail!
18140. ----------------------------------------------------------
18141. Zone Detailed Report:
18142. ----------------------------------------------------------
18143. !ZoneStatisticsDetail!
18144. ----------------------------------------------------------
18145. ")
18146. 
18147. 
18148. 
18149. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18150. 
18151. # Script: BannerSet
18152. 
18153. # Script: DisplaySetDateTimeRun
18154. 
18155. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
18156. /* Xinclude "..\Display\BannerSet.MyDc"X */
18157. /* pause(1) */
18158. 
18159. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18160. 
18161. Title('!Heading!')
18162. /* pause(1) */
18163. 
18164. /* NOTE: Can't round or truncate to integer precision. */
18165. 
18166. pause(1)
18167. 
18168. # your stuff HERE (X)... pre file select code.
18169. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
18170. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18171. 	# (X)
18172. 
18173. FileSelect
18174. 
18175. 	# your stuff can't really go here (errors.)
18176. 	# maybe for some reason I don't know of...
18177. 	
18178. 	# Actions next...
18179. 		# Script: ZoneDo ZoneTypeSelectOsPageHiberDump
18180. # PageHiberDump start.
18181. (
18182. # Os PageHiberDump start.
18183. (
18184.   FileName("DataStore.edb")
18185.   or FileName("DUMP*.*")
18186.   or FileName("Hiberfil.sys")
18187.   or FileName("MEMORY.DMP")
18188.   or FileName("Pagefile.sys")
18189. )
18190. # Os PageHiberDump end.
18191. 
18192. )
18193. # PageHiberDump end.
18194. 
18195. 		
18196. 		FileActions
18197. 		  		/* ---------------------------------------------------------- */
18198. 	# Gap
18199. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
18200. 		# Script: DisplaySetFileStep
18201. 
18202. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18203. 
18204. /* add message and move to a new line. */
18205. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18206. ")
18207. 
18208. /* display the line. (hopefully.) */
18209. # Zone Footer Set Statistics Window Text
18210. 
18211. SetStatisticsWindowText("----------------------------------------------------------
18212. Zones Processed: 
18213. ----------------------------------------------------------
18214. !ZoneListByLine!
18215. ----------------------------------------------------------
18216. Zone Processing Step:
18217. !ZoneStepByLine!    
18218. ----------------------------------------------------------
18219. Current Zone:
18220. !ZoneFooter!
18221. ----------------------------------------------------------
18222. Volume Statistics:
18223. !VolumeStatisticsDetail!
18224. ----------------------------------------------------------
18225. Zone Detailed Report:
18226. ----------------------------------------------------------
18227. !ZoneStatisticsDetail!
18228. ----------------------------------------------------------
18229. ")
18230. 
18231. 
18232. 
18233. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18234. 
18235. # Script: BannerSet
18236. 
18237. # Script: DisplaySetDateTimeRun
18238. 
18239. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
18240. /* Xinclude "..\Display\BannerSet.MyDc"X */
18241. /* pause(1) */
18242. 
18243. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18244. 
18245. Title('!Heading!')
18246. /* pause(1) */
18247. 
18248. /* NOTE: Can't round or truncate to integer precision. */
18249. 
18250. pause(1)
18251. 	
18252. 	# ACTUAL GAP
18253. 		/* AddGap Variant. */
18254. 	  	# Zone Do Gap
18255. # Gap Calculation Methods:
18256. 
18257. /* 1) Anything you need to add first. */
18258. /* empty */
18259. 
18260. /* ---------------------------------------------------------- */
18261. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
18262. 	# GapRequestedStd.
18263. 
18264. 		/* ---------------------------------------------------------- */
18265. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
18266. 
18267. 		# Gap Calculation Methods:
18268. 
18269. /* AddGap Variants */
18270. 
18271. 	/* Standard */
18272. 		# Gap Calculation Methods:
18273. 	/* AddGap Variants */
18274. 	/* Standard */
18275. 
18276. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
18277. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
18278. 
18279. 	SetVariable(GapRequested, GapRequestedStd)
18280. 	
18281. 
18282. 	/* MFT Low High Method */
18283. 		# Gap Calculation Methods:
18284. 	/* AddGap Variants */
18285. 	/* MFT Low High Method */
18286. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
18287. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
18288. 	SetVariable(GapRequested, GapRequestedMft)
18289. 	
18290. 
18291. 	/* OS Volume Type Method */
18292. 		# Gap Calculation Methods:
18293. 	/* AddGap Variants */
18294. 	/* OS Volume Type Method */
18295. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
18296. 	SetVariable(GapRequested, GapRequestedOs)
18297. 
18298. 
18299. 
18300. /* MakeGap Variants */
18301. 
18302. 	/* Original Os 1-3 + MFT 2 */
18303. 		# Gap Calculation Methods:
18304. 	/* MakeGap Variants */
18305. 	/* Original Os 1-3 + MFT 2 */
18306. 	/* plus MFT gap placed inline at the dividing zone. */
18307. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
18308. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
18309. 	SetVariable(GapRequested, GapRequestedOrig)
18310. 	
18311. 	
18312. /* Note: You could comment out the ones not in use */
18313. /* However having the data in the log is useful. */
18314. /* Therefore the following line is otherwise needed. */
18315. 
18316. /* Standard used */
18317. 
18318. SetVariable(GapRequested, GapRequestedStd)
18319. 
18320. # Gap Calculation Methods:
18321. 
18322. /* AddGap Variants */
18323. 	/* Standard */
18324. 	/* MFT Low High Method */
18325. 	/* OS Volume Type Method */
18326. 
18327. /* MakeGap Variants */
18328. 	/* Original Os 1-3 + MFT 2 */
18329. 
18330. /* Note: You could comment out the ones not in use */
18331. /* However having the data in the log is useful. */
18332. /* Therefore the following line is otherwise needed. */
18333. 
18334. /* Standard is used currently */
18335. 
18336. 
18337. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
18338. 
18339. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
18340. 
18341. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
18342. 
18343. /* ---------------------------------------------------------- */
18344. /* 3) SMALL ZONE ADJUSTMENT. */
18345. /* Gab cant be larger than half the Zone Size. */
18346. 
18347. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
18348. 	
18349. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
18350. 
18351. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
18352. 
18353. /* ---------------------------------------------------------- */
18354. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
18355. # Gap Adjustments.
18356. 
18357. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
18358. 	
18359. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
18360. 
18361. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
18362. 
18363. /* ---------------------------------------------------------- */
18364. # BYPASS THIS.
18365. 	/* This is definitely wrong. */
18366. 	/* The question is can we steal gap from the next zone */
18367. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
18368. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
18369. 		# Zone Overflow.
18370. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
18371. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
18372. 
18373. /* ---------------------------------------------------------- */
18374. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
18375. # Remaining free space available.
18376. 
18377. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
18378. 	
18379. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
18380. 
18381. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
18382. 
18383. /* ---------------------------------------------------------- */
18384. # CURRENT gap to use.
18385. 
18386. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
18387. 
18388. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
18389. 
18390. /* ---------------------------------------------------------- */
18391. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
18392. # Debugging.
18393. 
18394. 	SetVariable(GapUsed, GapCurrent) // for debugging
18395. 
18396. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
18397. 
18398. 		# Your code HERE
18399. 
18400. /* ---------------------------------------------------------- */
18401. /* 7) YOUR CODE. */
18402. # YOUR CODE HERE:
18403. 	# INPUT: GapCurrent or GapCurrentLoc
18404. 	# OUTPUT: GapUsed...
18405. 
18406. /* ---------------------------------------------------------- */
18407. # Gap Size.
18408. # Actual Size of Gap.
18409. 
18410. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
18411. 
18412. /* ---------------------------------------------------------- */
18413. /* xxxxxxxxxxxxxxxxxxxxxx */
18414. # ADD THE GAP
18415. 	/* Xinclude "..\Gap\GapCommandDo.MyDc"X */
18416. /* xxxxxxxxxxxxxxxxxxxxxx */
18417. 
18418. 	
18419. 	# Zone Statistics	
18420. 	# Script: ZoneDoStatistics
18421. # Zone / Volume Statistics and Display
18422. 		
18423. 	# Accumulate Totals
18424.   	# Script: ZoneDoVolumeTotals
18425. 
18426. /* Current total space used (by Zones and Gaps) */
18427. 
18428. SetVariable(VolumeZoneUsed, GapUsed)
18429. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
18430. /* Percentage */
18431. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
18432. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
18433. 
18434. /* Current total of free space requested */
18435. 
18436. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
18437. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18438. /* Percent. */
18439. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
18440. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18441. 
18442. /* Current total of free space used */
18443. 
18444. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
18445. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
18446. /* Percent */
18447. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
18448. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
18449. 
18450. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
18451. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
18452. /* Xinclude "..\DebugDisplayPause.MyDc"X */
18453. 
18454. 
18455. 	# Current Values
18456. 	# Script: ZoneDoCurrentSet
18457. 
18458. # Cluster, Sector, Block adjust for display.
18459. 	# Bytes per cluster is volume specific.
18460. 
18461. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
18462. 
18463. # Current Zone values.
18464. 	# Begin, end and size.
18465. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
18466. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
18467. 
18468. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
18469. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
18470. 
18471. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
18472. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
18473. 
18474. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
18475. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
18476. 
18477. 	SetVariable(ZoneFragments,				"!ZONE210N!")
18478. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
18479. 		
18480. /* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
18481. /* identical code to here: (separation not needed. TEST.) */	
18482. 
18483. # Current Gap, Actual and Free Values
18484. 	# Gap
18485. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
18486. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
18487. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
18488. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
18489. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
18490. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
18491. 	
18492. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
18493. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
18494. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
18495. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
18496. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
18497. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
18498. 	
18499. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
18500. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
18501. 	
18502. 	# Actual Size and End
18503. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
18504. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
18505. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
18506. 	
18507. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
18508. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
18509. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
18510. 
18511. # Gap Size & Rounding
18512. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
18513. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
18514. 	
18515. 	# Free Space
18516. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
18517. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
18518. 
18519. 	# Footer:
18520. SetVariable(ZoneFooter, "----------------------------------------------------------
18521. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
18522. 
18523. Statistics Report:
18524. ------------------
18525.    Size:  
18526.    ------------------------
18527.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18528.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18529.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18530. 
18531.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18532.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18533. 
18534.    Location:
18535.    ------------------------
18536.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18537.              Files End: !ZoneEndCurrent!
18538.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18539.       
18540.    Gap Settings:
18541.    ------------------------
18542.          Gap Requested: !ZoneGapSizePer!%
18543.       Volume Rounding: !ZoneVolRoundUpPer!%
18544.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18545.                  
18546.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18547.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18548.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18549.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18550.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18551.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18552.      
18553.    Free Space after Zone:
18554.    ------------------------
18555.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18556.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18557.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18558. 
18559. Directory and Files Select:
18560. ---------------------------
18561. !ZoneTypeSelectCurrent!               
18562. ---------------------------
18563. ----------------------------------------------------------
18564. ")
18565. 	# Zone Footer Set Statistics Window Text
18566. 
18567. SetStatisticsWindowText("----------------------------------------------------------
18568. Zones Processed: 
18569. ----------------------------------------------------------
18570. !ZoneListByLine!
18571. ----------------------------------------------------------
18572. Zone Processing Step:
18573. !ZoneStepByLine!    
18574. ----------------------------------------------------------
18575. Current Zone:
18576. !ZoneFooter!
18577. ----------------------------------------------------------
18578. Volume Statistics:
18579. !VolumeStatisticsDetail!
18580. ----------------------------------------------------------
18581. Zone Detailed Report:
18582. ----------------------------------------------------------
18583. !ZoneStatisticsDetail!
18584. ----------------------------------------------------------
18585. ")
18586. 
18587. 
18588. 	
18589.   	/* Xinclude "..\Gap\GapZoneActualFreeSetCurrent.MyDc"X */
18590. 
18591. 	# Add Zone to list of zones for display.
18592. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - ( size !ZoneSizeCurrent! / actual gap !ZoneGapActualCurrent! / actual size !ZoneSizeActualCurrent!) - [begin !ZoneBeginCurrent! / end !ZoneEndCurrent! / gap used !ZoneGapUsedCurrent! / gap unused !ZoneGapAvailableCurrent! / round up !ZoneVolRoundUp!]")
18593. 	# ??? Free Stats?
18594. 	# Footer:
18595. SetVariable(ZoneFooter, "----------------------------------------------------------
18596. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
18597. 
18598. Statistics Report:
18599. ------------------
18600.    Size:  
18601.    ------------------------
18602.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18603.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18604.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18605. 
18606.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18607.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18608. 
18609.    Location:
18610.    ------------------------
18611.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18612.              Files End: !ZoneEndCurrent!
18613.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18614.       
18615.    Gap Settings:
18616.    ------------------------
18617.          Gap Requested: !ZoneGapSizePer!%
18618.       Volume Rounding: !ZoneVolRoundUpPer!%
18619.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18620.                  
18621.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18622.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18623.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18624.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18625.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18626.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18627.      
18628.    Free Space after Zone:
18629.    ------------------------
18630.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18631.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18632.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18633. 
18634. Directory and Files Select:
18635. ---------------------------
18636. !ZoneTypeSelectCurrent!               
18637. ---------------------------
18638. ----------------------------------------------------------
18639. ")
18640. 
18641. 	# Add Zone Details to Report.	
18642. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
18643. !ZoneFooter!")
18644. 
18645. 
18646. 	
18647. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
18648. 			# Script: DisplaySetFileStep
18649. 
18650. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18651. 
18652. /* add message and move to a new line. */
18653. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18654. ")
18655. 
18656. /* display the line. (hopefully.) */
18657. # Zone Footer Set Statistics Window Text
18658. 
18659. SetStatisticsWindowText("----------------------------------------------------------
18660. Zones Processed: 
18661. ----------------------------------------------------------
18662. !ZoneListByLine!
18663. ----------------------------------------------------------
18664. Zone Processing Step:
18665. !ZoneStepByLine!    
18666. ----------------------------------------------------------
18667. Current Zone:
18668. !ZoneFooter!
18669. ----------------------------------------------------------
18670. Volume Statistics:
18671. !VolumeStatisticsDetail!
18672. ----------------------------------------------------------
18673. Zone Detailed Report:
18674. ----------------------------------------------------------
18675. !ZoneStatisticsDetail!
18676. ----------------------------------------------------------
18677. ")
18678. 
18679. 
18680. 
18681. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18682. 
18683. # Script: BannerSet
18684. 
18685. # Script: DisplaySetDateTimeRun
18686. 
18687. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
18688. /* Xinclude "..\Display\BannerSet.MyDc"X */
18689. /* pause(1) */
18690. 
18691. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18692. 
18693. Title('!Heading!')
18694. /* pause(1) */
18695. 
18696. /* NOTE: Can't round or truncate to integer precision. */
18697. 
18698. pause(1)
18699. 
18700. 			/* "..\ActionVerbs\ZoneDoActionThis.MyDc" */
18701. 			# File Action - SortByImportSequence with SkipBlock.
18702. SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
18703. 	
18704. 
18705. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
18706. 		# Script: DisplaySetFileStep
18707. 
18708. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18709. 
18710. /* add message and move to a new line. */
18711. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18712. ")
18713. 
18714. /* display the line. (hopefully.) */
18715. # Zone Footer Set Statistics Window Text
18716. 
18717. SetStatisticsWindowText("----------------------------------------------------------
18718. Zones Processed: 
18719. ----------------------------------------------------------
18720. !ZoneListByLine!
18721. ----------------------------------------------------------
18722. Zone Processing Step:
18723. !ZoneStepByLine!    
18724. ----------------------------------------------------------
18725. Current Zone:
18726. !ZoneFooter!
18727. ----------------------------------------------------------
18728. Volume Statistics:
18729. !VolumeStatisticsDetail!
18730. ----------------------------------------------------------
18731. Zone Detailed Report:
18732. ----------------------------------------------------------
18733. !ZoneStatisticsDetail!
18734. ----------------------------------------------------------
18735. ")
18736. 
18737. 
18738. 
18739. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18740. 
18741. # Script: BannerSet
18742. 
18743. # Script: DisplaySetDateTimeRun
18744. 
18745. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
18746. /* Xinclude "..\Display\BannerSet.MyDc"X */
18747. /* pause(1) */
18748. 
18749. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18750. 
18751. Title('!Heading!')
18752. /* pause(1) */
18753. 
18754. /* NOTE: Can't round or truncate to integer precision. */
18755. 
18756. pause(1)
18757. 
18758. 		# Script: ZoneDoFooter
18759. 
18760. /* ---------------------------------------------------------- */
18761. # File Select
18762. 	# Select Statments
18763. # File Actions 
18764. 	# Standard or OS File Actions.
18765. 	# Resume...
18766. 	
18767. 	# your stuff HERE (X)... post zone (file) file actions code.
18768. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
18769. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18770. 		# (X)
18771. 		
18772. 		/* ??? Set window? */
18773. 	
18774. 	# ADD THE GAP
18775. 		
18776. # Vacate (good for diagnostics)
18777. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
18778. 
18779. # DoNotVacate - DO NOT Vacate (recommended)
18780. 
18781. # Vacate
18782. /* AddGap(GapUsedLoc) */
18783. 
18784. # DO Not Vacate
18785. AddGap(GapUsedLoc, DoNotVacate) 
18786. 	
18787. 	
18788. /* ---------------------------------------------------------- */
18789. # (failed) TEST for boolean logic.
18790. 
18791. /* It should work in the gap calculations for turning options */
18792. /* on and off but it will NOT work here. */
18793. 
18794. /* Boolean setting X or FlagX. */
18795. /* Where X will be on or off: */
18796. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
18797. /*      For ON:  (X  *  FlagAny) */
18798. 
18799. /* 1) Failed, zero gap overrode the previous one. */
18800. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
18801. /* AddGap(GapUsedTemp) */ 
18802. 
18803. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
18804. /* AddGap(GapUsedTemp, DoNotVacate) */ 
18805. 
18806. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
18807. 
18808. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
18809. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
18810. /* AddGap(GapUsedTemp) */ 
18811. 
18812. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
18813. /* AddGap(GapUsedTemp, DoNotVacate) */ 
18814. 
18815. /* ---------------------------------------------------------- */
18816. 
18817. # Vacate
18818. /* AddGap(GapUsed) */
18819. 
18820. # DO NOT Vacate (recommended)
18821. /* AddGap(GapUsed, DoNotVacate) */ 
18822. 	
18823. 
18824. 		
18825. # 
18826. FileEnd
18827. /* ---------------------------------------------------------- */
18828. 
18829. # your stuff HERE (X)... post zone (file) code.
18830. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
18831. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
18832. 	# (X)
18833. 
18834. SetVariable(FileStepDescription,"Zone finished, reporting.")
18835. # Script: DisplaySetFileStep
18836. 
18837. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18838. 
18839. /* add message and move to a new line. */
18840. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18841. ")
18842. 
18843. /* display the line. (hopefully.) */
18844. # Zone Footer Set Statistics Window Text
18845. 
18846. SetStatisticsWindowText("----------------------------------------------------------
18847. Zones Processed: 
18848. ----------------------------------------------------------
18849. !ZoneListByLine!
18850. ----------------------------------------------------------
18851. Zone Processing Step:
18852. !ZoneStepByLine!    
18853. ----------------------------------------------------------
18854. Current Zone:
18855. !ZoneFooter!
18856. ----------------------------------------------------------
18857. Volume Statistics:
18858. !VolumeStatisticsDetail!
18859. ----------------------------------------------------------
18860. Zone Detailed Report:
18861. ----------------------------------------------------------
18862. !ZoneStatisticsDetail!
18863. ----------------------------------------------------------
18864. ")
18865. 
18866. 
18867. 
18868. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18869. 
18870. # Script: BannerSet
18871. 
18872. # Script: DisplaySetDateTimeRun
18873. 
18874. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
18875. /* Xinclude "..\Display\BannerSet.MyDc"X */
18876. /* pause(1) */
18877. 
18878. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18879. 
18880. Title('!Heading!')
18881. /* pause(1) */
18882. 
18883. /* NOTE: Can't round or truncate to integer precision. */
18884. 
18885. pause(1)
18886. 
18887. # Script: ZoneWhenFinished
18888. 
18889. # Script: BannerSet
18890. 
18891. # Script: DisplaySetDateTimeRun
18892. 
18893. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
18894. /* Xinclude "..\Display\BannerSet.MyDc"X */
18895. /* pause(1) */
18896. 
18897. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18898. 
18899. Title('!Heading!')
18900. /* pause(1) */
18901. 
18902. /* NOTE: Can't round or truncate to integer precision. */
18903. 
18904. # Script: BannerLog
18905. 
18906. AppendLogfile("!LogFileName!", "!Title!")
18907. 
18908. 
18909. 
18910. # Zone Statistics	
18911. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
18912. 
18913. # Footer:
18914. SetVariable(ZoneFooter, "----------------------------------------------------------
18915. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
18916. 
18917. Statistics Report:
18918. ------------------
18919.    Size:  
18920.    ------------------------
18921.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18922.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18923.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18924. 
18925.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18926.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18927. 
18928.    Location:
18929.    ------------------------
18930.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18931.              Files End: !ZoneEndCurrent!
18932.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18933.       
18934.    Gap Settings:
18935.    ------------------------
18936.          Gap Requested: !ZoneGapSizePer!%
18937.       Volume Rounding: !ZoneVolRoundUpPer!%
18938.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18939.                  
18940.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18941.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18942.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18943.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18944.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18945.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18946.      
18947.    Free Space after Zone:
18948.    ------------------------
18949.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18950.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18951.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18952. 
18953. Directory and Files Select:
18954. ---------------------------
18955. !ZoneTypeSelectCurrent!               
18956. ---------------------------
18957. ----------------------------------------------------------
18958. ")
18959. 
18960. AppendLogfile("!LogFileName!", ".")
18961. AppendLogfile("!LogFileName!", "!ZoneFooter!")
18962. AppendLogfile("!LogFileName!", ".")
18963. 
18964. # Zone Footer Set Statistics Window Text
18965. 
18966. SetStatisticsWindowText("----------------------------------------------------------
18967. Zones Processed: 
18968. ----------------------------------------------------------
18969. !ZoneListByLine!
18970. ----------------------------------------------------------
18971. Zone Processing Step:
18972. !ZoneStepByLine!    
18973. ----------------------------------------------------------
18974. Current Zone:
18975. !ZoneFooter!
18976. ----------------------------------------------------------
18977. Volume Statistics:
18978. !VolumeStatisticsDetail!
18979. ----------------------------------------------------------
18980. Zone Detailed Report:
18981. ----------------------------------------------------------
18982. !ZoneStatisticsDetail!
18983. ----------------------------------------------------------
18984. ")
18985. 
18986. 
18987. 
18988. /* pause() */
18989. /* pause() */
18990. 
18991. 
18992. 
18993. /* ---------------------------------------------------------- */
18994.   
18995. 
18996. /* ---------------------------------------------------------- */
18997. 
18998. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
18999. 
19000. /* ---------------------------------------------------------- */
19001. /* Zone Games */
19002. # Script: DefragZoneTypeGames
19003. /* ---------------------------------------------------------- */
19004. /* Zone Games */
19005. SetVariable(ZoneLabel, "!ZoneLabelGames!")
19006. SetVariable(ZoneDescription, "!ZoneDescriptionGames!")
19007. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpGames!")
19008. SetVariable(ZoneGapSize, "!ZoneGapSizeGames!")
19009. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectGames
19010. # Games start.
19011. # NotBlobsArchivesBu start.
19012. (not (
19013. # Blobs start.
19014. (
19015. # BlobsAndExceptions start.
19016. ( not(
19017.   FileName("*.bat")
19018.   or FileName("*.css")
19019.   or FileName("*.dll")
19020.   or FileName("*.exe")
19021.   or FileName("*.htm*")
19022.   or FileName("*.jar")
19023.   or FileName("*.js")
19024.   or FileName("*.script")
19025.   or FileName("*.wsf")
19026.   or (
19027. # Databases start.
19028. (
19029.   FileName("*.crypt*")
19030.   or FileName("*.db*")
19031.   or FileName("*.rdb*")
19032.   or FileName("*.dc*")
19033.   or FileName("*.dict*")
19034.   or FileName("*.?db*")
19035.   or FileName("*.?rdb*")
19036.   or FileName("*.md*")
19037.   or FileName("*.myd")
19038.   or FileName("*.ndf")
19039.   or FileName("*.ns?")
19040.   or FileName("*.pab")
19041.   or FileName("*.pst")
19042.   or FileName("*.sd?*")
19043.   or FileName("*.sq**")
19044.   or FileName("*.tmd")
19045.   or FileName("*.tps")
19046.   or FileName("*.tr*")
19047. )
19048. # Databases end.
19049. 
19050.     # BlobsAndExceptions
19051.     or 
19052. # Data start.
19053. (
19054.   DirectoryName("Data*")
19055.   or DirectoryName("Device*")
19056.   or DirectoryName("Export*")
19057.   or DirectoryName("Import*")
19058.   or DirectoryName("Log*")
19059.   or DirectoryName("*Log")
19060.   or DirectoryName("Maintenance*")
19061.   or DirectoryName("Rec*")
19062.   or DirectoryName("Sales*")
19063.   or DirectoryName("Search*")
19064.   or DirectoryName("User*")
19065. )
19066. # Data end.
19067. 
19068.     # BlobsAndExceptions
19069.   )
19070. ) )
19071. # BlobsAndExceptions end.
19072. 
19073. # Blobs
19074. ) and (
19075.   Size(BlobFileSize,0)
19076.   or (
19077.     FileName("*.arj")
19078.     or FileName("*.bup")
19079.     or FileName("*.bz2")
19080.     or FileName("*.chm")
19081.     or FileName("*.dvr-ms")
19082.     or FileName("*.gz")
19083.     or FileName("*.ifo")
19084.     or FileName("*.lzh")
19085.     or FileName("*.pdf")
19086.     or FileName("*.rpm")
19087.     or FileName("*.wmv")
19088.     or FileName("*.vob")
19089.     or FileName("*.z")
19090.   ) 
19091. )
19092. # Blobs end.
19093. 
19094. # NotBlobsArchivesBu
19095. or 
19096. # Archives start.
19097. (
19098.   DirectoryName("*Archive*")
19099.   or DirectoryName("*History*")
19100.   or DirectoryName("*Old")
19101.   or DirectoryName("* Old *")
19102.   or DirectoryName("Old *")
19103. 
19104.   or FileName("*.7z")
19105.   or FileName("*.cab")
19106.   or FileName("*.iso")
19107.   or FileName("*.msi")
19108.   or FileName("*.old")
19109.   or FileName("*.rar")
19110.   or FileName("*.tar")
19111.   or FileName("*.zip")
19112.   or
19113. # WinSysLow start.
19114. (
19115.   DirectoryName("$*")
19116.   or DirectoryName("0*")
19117.   or DirectoryName("1*")
19118.   or DirectoryName("2*")
19119.   or DirectoryName("3*")
19120.   or DirectoryName("4*")
19121.   or DirectoryName("5*")
19122.   or DirectoryName("6*")
19123.   or DirectoryName("7*")
19124.   or DirectoryName("8*")
19125.   or DirectoryName("9*")
19126. 
19127.   or DirectoryName("dllcache")
19128.   or DirectoryName("Downloaded Installations")
19129.   or DirectoryName("Ehome")
19130.   or DirectoryName("Fonts")
19131.   or DirectoryName("Help")
19132.   or DirectoryName("I386")
19133.   or DirectoryName("ie?updates")
19134.   or DirectoryName("Installer")
19135.   or DirectoryName("Installshield Installation Information")
19136.   or DirectoryName("IME")
19137.   or DirectoryName("*RECYCLE*")
19138.   or DirectoryName("ServicePackFiles")
19139.   or DirectoryName("SoftwareDistribution")
19140.   or DirectoryName("Speech")
19141.   or DirectoryName("Symbols")
19142.   or DirectoryName("System Volume Information")
19143.   or DirectoryName("windows.old")
19144. )
19145. # WinSysLow end.
19146. 
19147.   # Archives
19148. )
19149. # Archives end.
19150. 
19151. # NotBlobsArchivesBu
19152. or
19153. # Backups start.
19154. (
19155.   DirectoryName("*Backup*")
19156.   or DirectoryName("*Bu")
19157.   or DirectoryName("* Bu *")
19158.   or DirectoryName("Bu *")
19159. 
19160.   or FileName("*.bak")
19161.   or FileName("* - Copy*")
19162. )
19163. # Backups end.
19164. 
19165. # NotBlobsArchivesBu
19166. ) )
19167. # NotBlobsArchivesBu end.
19168. 
19169. # People
19170. and (
19171. # Games start.
19172. (
19173.   DirectoryName("Game*")
19174.   or DirectoryName("Epic*")
19175.   or DirectoryName("*XBox*")
19176.   or DirectoryName("*PS2*")
19177. )
19178. # Games end.
19179. 
19180. # People
19181. )
19182. # People end.
19183. ')
19184. 
19185. 	# Script: ZoneDoHeader
19186. 
19187. # Script: ZoneWhenStarted
19188. 
19189. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
19190. # Script: DisplaySetZone
19191. 
19192. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
19193. SetVariable(FileStepDescription,	"")
19194. 
19195. SetVariable(ZoneStepByLine, 			"Zone started.
19196. ")
19197. 
19198. # Script: BannerDescriptionSet
19199. 
19200. # Script: BannerSet
19201. 
19202. # Script: DisplaySetDateTimeRun
19203. 
19204. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
19205. /* Xinclude "..\Display\BannerSet.MyDc"X */
19206. /* pause(1) */
19207. 
19208. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19209. 
19210. Title('!Heading!')
19211. /* pause(1) */
19212. 
19213. /* NOTE: Can't round or truncate to integer precision. */
19214. 
19215. # Script: BannerLog
19216. 
19217. AppendLogfile("!LogFileName!", "!Title!")
19218. 
19219. 
19220. 
19221. pause(1)
19222. 
19223. 
19224. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
19225. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
19226. 
19227. SetVariable(ZoneStepNoCurrent, 0)
19228. 
19229. 
19230. # Script: ZoneDoCurrentClear
19231. 
19232. SetVariable(ZoneTypeSelectCurrent, 		"")
19233. 
19234. SetVariable(ZoneBeginCurrent, 			0)
19235. SetVariable(ZoneBeginPerCurrent, 		0)
19236. SetVariable(ZoneEndCurrent, 			0)
19237. SetVariable(ZoneEndPerCurrent, 			0)
19238. 
19239. SetVariable(ZoneSizeCurrent,			0)
19240. SetVariable(ZoneSizePerCurrent,			0)
19241. 
19242. SetVariable(ZoneGapRequestedCurrent,	0)
19243. SetVariable(ZoneGapRoundedCurrent, 		0)
19244. SetVariable(ZoneGapAdjustedCurrent, 	0)
19245. SetVariable(ZoneGapAvailableCurrent, 	0)
19246. SetVariable(ZoneGapCurrent,				0)
19247. SetVariable(ZoneGapUsedCurrent, 		0)
19248. 
19249. SetVariable(ZoneGapActualCurrent, 		0)
19250. SetVariable(ZoneGapActualPerCurrent, 	0)
19251. 
19252. SetVariable(ZoneSizeActual, 			0)
19253. SetVariable(ZoneSizeActualCurrent,		0)
19254. 
19255. SetVariable(ZoneEndActual, 				0)
19256. SetVariable(ZoneEndActualCurrent,		0)			
19257. SetVariable(ZoneSizeActualPerCurrent, 	0)
19258.       
19259. SetVariable(ZoneFilesFolders,			0)
19260. SetVariable(ZoneFilesFoldersPer,		0) 
19261. 
19262. SetVariable(ZoneFragments,				0)
19263. SetVariable(ZoneFragmentsPer,			0) 
19264. 		
19265. SetVariable(ZoneEndActualCurrent, 		0)
19266. SetVariable(ZoneEndActualPerCurrent, 	0)
19267. 
19268. # Gap Calculation Methodology:
19269. 	# Requested
19270. 	SetVariable(GapRequested, 			0) 
19271. 	SetVariable(GapRequestedStd, 		0) 
19272. 	SetVariable(GapRequestedMft, 		0) 
19273. 	SetVariable(GapRequestedOs, 		0) 
19274. 	SetVariable(GapRequestedOriginal, 	0) 
19275. 	
19276. 	# Gap Adjustments
19277. 	SetVariable(GapRounded, 			0)
19278. 	# SetVariable(GapAdjusted, 			0)
19279. 	SetVariable(GapAvailable, 			0)
19280. 	SetVariable(GapCurrent, 			0)
19281. 	SetVariable(GapActual, 				0)
19282. 	SetVariable(GapUsed, 				0)
19283. 	
19284. 	# Gap Adjustments
19285. 	SetVariable(GapRoundedLoc, 			0)
19286. 	# SetVariable(GapAdjustedLoc, 		0)
19287. 	SetVariable(GapAvailableLoc, 		0)
19288. 	SetVariable(GapCurrentLoc, 			0)
19289. 	SetVariable(GapActualLoc,			0)
19290. 	SetVariable(GapUsedLoc,				0)
19291. 	
19292. 	# Space usage
19293. 	SetVariable(ZoneFreePerRequested, 	0)
19294. 	SetVariable(ZoneFreePerUsed, 		0)
19295. 
19296. # Gap Size & Rounding
19297. 	SetVariable(ZoneGapSizePer, 		0)
19298. 	SetVariable(ZoneVolRoundUpPer, 		0)
19299. 	
19300. 	# Free Space
19301. 	SetVariable(ZoneFreeUsedPer, 		0)
19302. 	SetVariable(ZoneFreeRequestedPer, 	0)
19303. 
19304. 
19305. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
19306. 
19307. # Footer:
19308. SetVariable(ZoneFooter, "----------------------------------------------------------
19309. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
19310. 
19311. Statistics Report:
19312. ------------------
19313.    Size:  
19314.    ------------------------
19315.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19316.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19317.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19318. 
19319.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19320.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19321. 
19322.    Location:
19323.    ------------------------
19324.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19325.              Files End: !ZoneEndCurrent!
19326.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19327.       
19328.    Gap Settings:
19329.    ------------------------
19330.          Gap Requested: !ZoneGapSizePer!%
19331.       Volume Rounding: !ZoneVolRoundUpPer!%
19332.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19333.                  
19334.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
19335.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
19336.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
19337.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
19338.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
19339.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
19340.      
19341.    Free Space after Zone:
19342.    ------------------------
19343.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19344.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19345.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19346. 
19347. Directory and Files Select:
19348. ---------------------------
19349. !ZoneTypeSelectCurrent!               
19350. ---------------------------
19351. ----------------------------------------------------------
19352. ")
19353. 
19354. # Script: BannerSet
19355. 
19356. # Script: DisplaySetDateTimeRun
19357. 
19358. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
19359. /* Xinclude "..\Display\BannerSet.MyDc"X */
19360. /* pause(1) */
19361. 
19362. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19363. 
19364. Title('!Heading!')
19365. /* pause(1) */
19366. 
19367. /* NOTE: Can't round or truncate to integer precision. */
19368. 
19369. # Script: BannerLog
19370. 
19371. AppendLogfile("!LogFileName!", "!Title!")
19372. 
19373. 
19374. 
19375. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
19376. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
19377. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:51")
19378. 
19379. SetVariable(ZoneListByLine, "!ZoneListByLine!
19380. Zone: !ZoneNoCurrent! 2021-11-09 18:53:51 0:00:07 !ZoneLabel! !ZoneDescription!")
19381. 
19382. 
19383. /* Fixed Zone Position Handling */
19384. /* Literal number: */
19385. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
19386. /* Percentage of disk: */
19387. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
19388. /* Gap */
19389. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
19390. 
19391. /* ---------------------------------------------------------- */
19392. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
19393. # Script: DisplaySetFileStep
19394. 
19395. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19396. 
19397. /* add message and move to a new line. */
19398. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19399. ")
19400. 
19401. /* display the line. (hopefully.) */
19402. # Zone Footer Set Statistics Window Text
19403. 
19404. SetStatisticsWindowText("----------------------------------------------------------
19405. Zones Processed: 
19406. ----------------------------------------------------------
19407. !ZoneListByLine!
19408. ----------------------------------------------------------
19409. Zone Processing Step:
19410. !ZoneStepByLine!    
19411. ----------------------------------------------------------
19412. Current Zone:
19413. !ZoneFooter!
19414. ----------------------------------------------------------
19415. Volume Statistics:
19416. !VolumeStatisticsDetail!
19417. ----------------------------------------------------------
19418. Zone Detailed Report:
19419. ----------------------------------------------------------
19420. !ZoneStatisticsDetail!
19421. ----------------------------------------------------------
19422. ")
19423. 
19424. 
19425. 
19426. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19427. 
19428. # Script: BannerSet
19429. 
19430. # Script: DisplaySetDateTimeRun
19431. 
19432. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
19433. /* Xinclude "..\Display\BannerSet.MyDc"X */
19434. /* pause(1) */
19435. 
19436. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19437. 
19438. Title('!Heading!')
19439. /* pause(1) */
19440. 
19441. /* NOTE: Can't round or truncate to integer precision. */
19442. 
19443. pause(1)
19444. 
19445. # your stuff HERE (X)... pre file select code.
19446. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
19447. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19448. 	# (X)
19449. 
19450. FileSelect
19451. 
19452. 	# your stuff can't really go here (errors.)
19453. 	# maybe for some reason I don't know of...
19454. 	
19455. 	# Actions next...
19456. 	# Script: ZoneDo ZoneTypeSelectGames
19457. # Games start.
19458. # NotBlobsArchivesBu start.
19459. (not (
19460. # Blobs start.
19461. (
19462. # BlobsAndExceptions start.
19463. ( not(
19464.   FileName("*.bat")
19465.   or FileName("*.css")
19466.   or FileName("*.dll")
19467.   or FileName("*.exe")
19468.   or FileName("*.htm*")
19469.   or FileName("*.jar")
19470.   or FileName("*.js")
19471.   or FileName("*.script")
19472.   or FileName("*.wsf")
19473.   or (
19474. # Databases start.
19475. (
19476.   FileName("*.crypt*")
19477.   or FileName("*.db*")
19478.   or FileName("*.rdb*")
19479.   or FileName("*.dc*")
19480.   or FileName("*.dict*")
19481.   or FileName("*.?db*")
19482.   or FileName("*.?rdb*")
19483.   or FileName("*.md*")
19484.   or FileName("*.myd")
19485.   or FileName("*.ndf")
19486.   or FileName("*.ns?")
19487.   or FileName("*.pab")
19488.   or FileName("*.pst")
19489.   or FileName("*.sd?*")
19490.   or FileName("*.sq**")
19491.   or FileName("*.tmd")
19492.   or FileName("*.tps")
19493.   or FileName("*.tr*")
19494. )
19495. # Databases end.
19496. 
19497.     # BlobsAndExceptions
19498.     or 
19499. # Data start.
19500. (
19501.   DirectoryName("Data*")
19502.   or DirectoryName("Device*")
19503.   or DirectoryName("Export*")
19504.   or DirectoryName("Import*")
19505.   or DirectoryName("Log*")
19506.   or DirectoryName("*Log")
19507.   or DirectoryName("Maintenance*")
19508.   or DirectoryName("Rec*")
19509.   or DirectoryName("Sales*")
19510.   or DirectoryName("Search*")
19511.   or DirectoryName("User*")
19512. )
19513. # Data end.
19514. 
19515.     # BlobsAndExceptions
19516.   )
19517. ) )
19518. # BlobsAndExceptions end.
19519. 
19520. # Blobs
19521. ) and (
19522.   Size(BlobFileSize,0)
19523.   or (
19524.     FileName("*.arj")
19525.     or FileName("*.bup")
19526.     or FileName("*.bz2")
19527.     or FileName("*.chm")
19528.     or FileName("*.dvr-ms")
19529.     or FileName("*.gz")
19530.     or FileName("*.ifo")
19531.     or FileName("*.lzh")
19532.     or FileName("*.pdf")
19533.     or FileName("*.rpm")
19534.     or FileName("*.wmv")
19535.     or FileName("*.vob")
19536.     or FileName("*.z")
19537.   ) 
19538. )
19539. # Blobs end.
19540. 
19541. # NotBlobsArchivesBu
19542. or 
19543. # Archives start.
19544. (
19545.   DirectoryName("*Archive*")
19546.   or DirectoryName("*History*")
19547.   or DirectoryName("*Old")
19548.   or DirectoryName("* Old *")
19549.   or DirectoryName("Old *")
19550. 
19551.   or FileName("*.7z")
19552.   or FileName("*.cab")
19553.   or FileName("*.iso")
19554.   or FileName("*.msi")
19555.   or FileName("*.old")
19556.   or FileName("*.rar")
19557.   or FileName("*.tar")
19558.   or FileName("*.zip")
19559.   or
19560. # WinSysLow start.
19561. (
19562.   DirectoryName("$*")
19563.   or DirectoryName("0*")
19564.   or DirectoryName("1*")
19565.   or DirectoryName("2*")
19566.   or DirectoryName("3*")
19567.   or DirectoryName("4*")
19568.   or DirectoryName("5*")
19569.   or DirectoryName("6*")
19570.   or DirectoryName("7*")
19571.   or DirectoryName("8*")
19572.   or DirectoryName("9*")
19573. 
19574.   or DirectoryName("dllcache")
19575.   or DirectoryName("Downloaded Installations")
19576.   or DirectoryName("Ehome")
19577.   or DirectoryName("Fonts")
19578.   or DirectoryName("Help")
19579.   or DirectoryName("I386")
19580.   or DirectoryName("ie?updates")
19581.   or DirectoryName("Installer")
19582.   or DirectoryName("Installshield Installation Information")
19583.   or DirectoryName("IME")
19584.   or DirectoryName("*RECYCLE*")
19585.   or DirectoryName("ServicePackFiles")
19586.   or DirectoryName("SoftwareDistribution")
19587.   or DirectoryName("Speech")
19588.   or DirectoryName("Symbols")
19589.   or DirectoryName("System Volume Information")
19590.   or DirectoryName("windows.old")
19591. )
19592. # WinSysLow end.
19593. 
19594.   # Archives
19595. )
19596. # Archives end.
19597. 
19598. # NotBlobsArchivesBu
19599. or
19600. # Backups start.
19601. (
19602.   DirectoryName("*Backup*")
19603.   or DirectoryName("*Bu")
19604.   or DirectoryName("* Bu *")
19605.   or DirectoryName("Bu *")
19606. 
19607.   or FileName("*.bak")
19608.   or FileName("* - Copy*")
19609. )
19610. # Backups end.
19611. 
19612. # NotBlobsArchivesBu
19613. ) )
19614. # NotBlobsArchivesBu end.
19615. 
19616. # People
19617. and (
19618. # Games start.
19619. (
19620.   DirectoryName("Game*")
19621.   or DirectoryName("Epic*")
19622.   or DirectoryName("*XBox*")
19623.   or DirectoryName("*PS2*")
19624. )
19625. # Games end.
19626. 
19627. # People
19628. )
19629. # People end.
19630. 
19631. 	# Script: ZoneDoAction
19632. # Zone Do File Action - SortByName.
19633. 
19634. FileActions
19635. 
19636. 	# Footer:
19637. SetVariable(ZoneFooter, "----------------------------------------------------------
19638. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
19639. 
19640. Statistics Report:
19641. ------------------
19642.    Size:  
19643.    ------------------------
19644.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19645.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19646.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19647. 
19648.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19649.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19650. 
19651.    Location:
19652.    ------------------------
19653.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19654.              Files End: !ZoneEndCurrent!
19655.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19656.       
19657.    Gap Settings:
19658.    ------------------------
19659.          Gap Requested: !ZoneGapSizePer!%
19660.       Volume Rounding: !ZoneVolRoundUpPer!%
19661.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19662.                  
19663.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
19664.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
19665.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
19666.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
19667.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
19668.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
19669.      
19670.    Free Space after Zone:
19671.    ------------------------
19672.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19673.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19674.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19675. 
19676. Directory and Files Select:
19677. ---------------------------
19678. !ZoneTypeSelectCurrent!               
19679. ---------------------------
19680. ----------------------------------------------------------
19681. ")
19682. 	SetStatisticsWindowText("!ZoneFooter!")
19683. 	
19684. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
19685. 	# Script: DisplaySetFileStep
19686. 
19687. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19688. 
19689. /* add message and move to a new line. */
19690. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19691. ")
19692. 
19693. /* display the line. (hopefully.) */
19694. # Zone Footer Set Statistics Window Text
19695. 
19696. SetStatisticsWindowText("----------------------------------------------------------
19697. Zones Processed: 
19698. ----------------------------------------------------------
19699. !ZoneListByLine!
19700. ----------------------------------------------------------
19701. Zone Processing Step:
19702. !ZoneStepByLine!    
19703. ----------------------------------------------------------
19704. Current Zone:
19705. !ZoneFooter!
19706. ----------------------------------------------------------
19707. Volume Statistics:
19708. !VolumeStatisticsDetail!
19709. ----------------------------------------------------------
19710. Zone Detailed Report:
19711. ----------------------------------------------------------
19712. !ZoneStatisticsDetail!
19713. ----------------------------------------------------------
19714. ")
19715. 
19716. 
19717. 
19718. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19719. 
19720. # Script: BannerSet
19721. 
19722. # Script: DisplaySetDateTimeRun
19723. 
19724. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
19725. /* Xinclude "..\Display\BannerSet.MyDc"X */
19726. /* pause(1) */
19727. 
19728. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19729. 
19730. Title('!Heading!')
19731. /* pause(1) */
19732. 
19733. /* NOTE: Can't round or truncate to integer precision. */
19734. 
19735. pause(1)
19736. 
19737. # Commands:
19738. 
19739. /* Moves to Zone or above it. */
19740. # MoveUpToZone()
19741. 
19742. # Defrag
19743. 
19744. # Defragment(OPTIONS)
19745. 
19746. /* Shuffles files around trying to make a big enough gap for fragmented files. */
19747. # Defragment()
19748. 
19749. /* Only does files where a gap will fit it. */
19750. # Defragment(Fast)
19751. 
19752. /* Skips fragmented files larger than the Chunck Size.
19753. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
19754. # Defragment(Chunk Size)
19755. 
19756. /* Moves down to zone and packs zone to beginning if there are gaps. */
19757. /* Can be similar in performance to doing a SortBy. */
19758. # MoveDownFill()
19759. 
19760. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
19761. 
19762. 
19763. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
19764. 	# Script: DisplaySetFileStep
19765. 
19766. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19767. 
19768. /* add message and move to a new line. */
19769. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19770. ")
19771. 
19772. /* display the line. (hopefully.) */
19773. # Zone Footer Set Statistics Window Text
19774. 
19775. SetStatisticsWindowText("----------------------------------------------------------
19776. Zones Processed: 
19777. ----------------------------------------------------------
19778. !ZoneListByLine!
19779. ----------------------------------------------------------
19780. Zone Processing Step:
19781. !ZoneStepByLine!    
19782. ----------------------------------------------------------
19783. Current Zone:
19784. !ZoneFooter!
19785. ----------------------------------------------------------
19786. Volume Statistics:
19787. !VolumeStatisticsDetail!
19788. ----------------------------------------------------------
19789. Zone Detailed Report:
19790. ----------------------------------------------------------
19791. !ZoneStatisticsDetail!
19792. ----------------------------------------------------------
19793. ")
19794. 
19795. 
19796. 
19797. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19798. 
19799. # Script: BannerSet
19800. 
19801. # Script: DisplaySetDateTimeRun
19802. 
19803. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
19804. /* Xinclude "..\Display\BannerSet.MyDc"X */
19805. /* pause(1) */
19806. 
19807. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19808. 
19809. Title('!Heading!')
19810. /* pause(1) */
19811. 
19812. /* NOTE: Can't round or truncate to integer precision. */
19813. 
19814. pause(1)
19815. 
19816. 	# Script: ZoneDoFooter
19817. 
19818. /* ---------------------------------------------------------- */
19819. # File Select
19820. 	# Select Statments
19821. # File Actions 
19822. 	# Standard or OS File Actions.
19823. 	# Resume...
19824. 	
19825. 	# your stuff HERE (X)... post zone (file) file actions code.
19826. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
19827. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19828. 		# (X)
19829. 		
19830. 		/* ??? Set window? */
19831. 	
19832. 	# ADD THE GAP
19833. 		
19834. # Vacate (good for diagnostics)
19835. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
19836. 
19837. # DoNotVacate - DO NOT Vacate (recommended)
19838. 
19839. # Vacate
19840. /* AddGap(GapUsedLoc) */
19841. 
19842. # DO Not Vacate
19843. AddGap(GapUsedLoc, DoNotVacate) 
19844. 	
19845. 	
19846. /* ---------------------------------------------------------- */
19847. # (failed) TEST for boolean logic.
19848. 
19849. /* It should work in the gap calculations for turning options */
19850. /* on and off but it will NOT work here. */
19851. 
19852. /* Boolean setting X or FlagX. */
19853. /* Where X will be on or off: */
19854. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
19855. /*      For ON:  (X  *  FlagAny) */
19856. 
19857. /* 1) Failed, zero gap overrode the previous one. */
19858. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
19859. /* AddGap(GapUsedTemp) */ 
19860. 
19861. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
19862. /* AddGap(GapUsedTemp, DoNotVacate) */ 
19863. 
19864. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
19865. 
19866. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
19867. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
19868. /* AddGap(GapUsedTemp) */ 
19869. 
19870. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
19871. /* AddGap(GapUsedTemp, DoNotVacate) */ 
19872. 
19873. /* ---------------------------------------------------------- */
19874. 
19875. # Vacate
19876. /* AddGap(GapUsed) */
19877. 
19878. # DO NOT Vacate (recommended)
19879. /* AddGap(GapUsed, DoNotVacate) */ 
19880. 	
19881. 
19882. 		
19883. # 
19884. FileEnd
19885. /* ---------------------------------------------------------- */
19886. 
19887. # your stuff HERE (X)... post zone (file) code.
19888. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
19889. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
19890. 	# (X)
19891. 
19892. SetVariable(FileStepDescription,"Zone finished, reporting.")
19893. # Script: DisplaySetFileStep
19894. 
19895. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19896. 
19897. /* add message and move to a new line. */
19898. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19899. ")
19900. 
19901. /* display the line. (hopefully.) */
19902. # Zone Footer Set Statistics Window Text
19903. 
19904. SetStatisticsWindowText("----------------------------------------------------------
19905. Zones Processed: 
19906. ----------------------------------------------------------
19907. !ZoneListByLine!
19908. ----------------------------------------------------------
19909. Zone Processing Step:
19910. !ZoneStepByLine!    
19911. ----------------------------------------------------------
19912. Current Zone:
19913. !ZoneFooter!
19914. ----------------------------------------------------------
19915. Volume Statistics:
19916. !VolumeStatisticsDetail!
19917. ----------------------------------------------------------
19918. Zone Detailed Report:
19919. ----------------------------------------------------------
19920. !ZoneStatisticsDetail!
19921. ----------------------------------------------------------
19922. ")
19923. 
19924. 
19925. 
19926. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19927. 
19928. # Script: BannerSet
19929. 
19930. # Script: DisplaySetDateTimeRun
19931. 
19932. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
19933. /* Xinclude "..\Display\BannerSet.MyDc"X */
19934. /* pause(1) */
19935. 
19936. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19937. 
19938. Title('!Heading!')
19939. /* pause(1) */
19940. 
19941. /* NOTE: Can't round or truncate to integer precision. */
19942. 
19943. pause(1)
19944. 
19945. # Script: ZoneWhenFinished
19946. 
19947. # Script: BannerSet
19948. 
19949. # Script: DisplaySetDateTimeRun
19950. 
19951. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
19952. /* Xinclude "..\Display\BannerSet.MyDc"X */
19953. /* pause(1) */
19954. 
19955. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19956. 
19957. Title('!Heading!')
19958. /* pause(1) */
19959. 
19960. /* NOTE: Can't round or truncate to integer precision. */
19961. 
19962. # Script: BannerLog
19963. 
19964. AppendLogfile("!LogFileName!", "!Title!")
19965. 
19966. 
19967. 
19968. # Zone Statistics	
19969. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
19970. 
19971. # Footer:
19972. SetVariable(ZoneFooter, "----------------------------------------------------------
19973. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
19974. 
19975. Statistics Report:
19976. ------------------
19977.    Size:  
19978.    ------------------------
19979.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19980.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19981.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19982. 
19983.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19984.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19985. 
19986.    Location:
19987.    ------------------------
19988.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19989.              Files End: !ZoneEndCurrent!
19990.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19991.       
19992.    Gap Settings:
19993.    ------------------------
19994.          Gap Requested: !ZoneGapSizePer!%
19995.       Volume Rounding: !ZoneVolRoundUpPer!%
19996.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19997.                  
19998.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
19999.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
20000.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
20001.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
20002.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
20003.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
20004.      
20005.    Free Space after Zone:
20006.    ------------------------
20007.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20008.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20009.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20010. 
20011. Directory and Files Select:
20012. ---------------------------
20013. !ZoneTypeSelectCurrent!               
20014. ---------------------------
20015. ----------------------------------------------------------
20016. ")
20017. 
20018. AppendLogfile("!LogFileName!", ".")
20019. AppendLogfile("!LogFileName!", "!ZoneFooter!")
20020. AppendLogfile("!LogFileName!", ".")
20021. 
20022. # Zone Footer Set Statistics Window Text
20023. 
20024. SetStatisticsWindowText("----------------------------------------------------------
20025. Zones Processed: 
20026. ----------------------------------------------------------
20027. !ZoneListByLine!
20028. ----------------------------------------------------------
20029. Zone Processing Step:
20030. !ZoneStepByLine!    
20031. ----------------------------------------------------------
20032. Current Zone:
20033. !ZoneFooter!
20034. ----------------------------------------------------------
20035. Volume Statistics:
20036. !VolumeStatisticsDetail!
20037. ----------------------------------------------------------
20038. Zone Detailed Report:
20039. ----------------------------------------------------------
20040. !ZoneStatisticsDetail!
20041. ----------------------------------------------------------
20042. ")
20043. 
20044. 
20045. 
20046. /* pause() */
20047. /* pause() */
20048. 
20049. 
20050. 
20051. 
20052. /* ---------------------------------------------------------- */
20053. 
20054. 
20055. /* ---------------------------------------------------------- */
20056. /* Zone Shares */
20057. # Script: DefragZoneTypeShares
20058. /* ---------------------------------------------------------- */
20059. /* Zone Shares */
20060. SetVariable(ZoneLabel, "!ZoneLabelShares!")
20061. SetVariable(ZoneDescription, "!ZoneDescriptionShares!")
20062. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpShares!")
20063. SetVariable(ZoneGapSize, "!ZoneGapSizeShares!")
20064. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectShares
20065. # Shares start.
20066. # NotBlobsArchivesBu start.
20067. (not (
20068. # Blobs start.
20069. (
20070. # BlobsAndExceptions start.
20071. ( not(
20072.   FileName("*.bat")
20073.   or FileName("*.css")
20074.   or FileName("*.dll")
20075.   or FileName("*.exe")
20076.   or FileName("*.htm*")
20077.   or FileName("*.jar")
20078.   or FileName("*.js")
20079.   or FileName("*.script")
20080.   or FileName("*.wsf")
20081.   or (
20082. # Databases start.
20083. (
20084.   FileName("*.crypt*")
20085.   or FileName("*.db*")
20086.   or FileName("*.rdb*")
20087.   or FileName("*.dc*")
20088.   or FileName("*.dict*")
20089.   or FileName("*.?db*")
20090.   or FileName("*.?rdb*")
20091.   or FileName("*.md*")
20092.   or FileName("*.myd")
20093.   or FileName("*.ndf")
20094.   or FileName("*.ns?")
20095.   or FileName("*.pab")
20096.   or FileName("*.pst")
20097.   or FileName("*.sd?*")
20098.   or FileName("*.sq**")
20099.   or FileName("*.tmd")
20100.   or FileName("*.tps")
20101.   or FileName("*.tr*")
20102. )
20103. # Databases end.
20104. 
20105.     # BlobsAndExceptions
20106.     or 
20107. # Data start.
20108. (
20109.   DirectoryName("Data*")
20110.   or DirectoryName("Device*")
20111.   or DirectoryName("Export*")
20112.   or DirectoryName("Import*")
20113.   or DirectoryName("Log*")
20114.   or DirectoryName("*Log")
20115.   or DirectoryName("Maintenance*")
20116.   or DirectoryName("Rec*")
20117.   or DirectoryName("Sales*")
20118.   or DirectoryName("Search*")
20119.   or DirectoryName("User*")
20120. )
20121. # Data end.
20122. 
20123.     # BlobsAndExceptions
20124.   )
20125. ) )
20126. # BlobsAndExceptions end.
20127. 
20128. # Blobs
20129. ) and (
20130.   Size(BlobFileSize,0)
20131.   or (
20132.     FileName("*.arj")
20133.     or FileName("*.bup")
20134.     or FileName("*.bz2")
20135.     or FileName("*.chm")
20136.     or FileName("*.dvr-ms")
20137.     or FileName("*.gz")
20138.     or FileName("*.ifo")
20139.     or FileName("*.lzh")
20140.     or FileName("*.pdf")
20141.     or FileName("*.rpm")
20142.     or FileName("*.wmv")
20143.     or FileName("*.vob")
20144.     or FileName("*.z")
20145.   ) 
20146. )
20147. # Blobs end.
20148. 
20149. # NotBlobsArchivesBu
20150. or 
20151. # Archives start.
20152. (
20153.   DirectoryName("*Archive*")
20154.   or DirectoryName("*History*")
20155.   or DirectoryName("*Old")
20156.   or DirectoryName("* Old *")
20157.   or DirectoryName("Old *")
20158. 
20159.   or FileName("*.7z")
20160.   or FileName("*.cab")
20161.   or FileName("*.iso")
20162.   or FileName("*.msi")
20163.   or FileName("*.old")
20164.   or FileName("*.rar")
20165.   or FileName("*.tar")
20166.   or FileName("*.zip")
20167.   or
20168. # WinSysLow start.
20169. (
20170.   DirectoryName("$*")
20171.   or DirectoryName("0*")
20172.   or DirectoryName("1*")
20173.   or DirectoryName("2*")
20174.   or DirectoryName("3*")
20175.   or DirectoryName("4*")
20176.   or DirectoryName("5*")
20177.   or DirectoryName("6*")
20178.   or DirectoryName("7*")
20179.   or DirectoryName("8*")
20180.   or DirectoryName("9*")
20181. 
20182.   or DirectoryName("dllcache")
20183.   or DirectoryName("Downloaded Installations")
20184.   or DirectoryName("Ehome")
20185.   or DirectoryName("Fonts")
20186.   or DirectoryName("Help")
20187.   or DirectoryName("I386")
20188.   or DirectoryName("ie?updates")
20189.   or DirectoryName("Installer")
20190.   or DirectoryName("Installshield Installation Information")
20191.   or DirectoryName("IME")
20192.   or DirectoryName("*RECYCLE*")
20193.   or DirectoryName("ServicePackFiles")
20194.   or DirectoryName("SoftwareDistribution")
20195.   or DirectoryName("Speech")
20196.   or DirectoryName("Symbols")
20197.   or DirectoryName("System Volume Information")
20198.   or DirectoryName("windows.old")
20199. )
20200. # WinSysLow end.
20201. 
20202.   # Archives
20203. )
20204. # Archives end.
20205. 
20206. # NotBlobsArchivesBu
20207. or
20208. # Backups start.
20209. (
20210.   DirectoryName("*Backup*")
20211.   or DirectoryName("*Bu")
20212.   or DirectoryName("* Bu *")
20213.   or DirectoryName("Bu *")
20214. 
20215.   or FileName("*.bak")
20216.   or FileName("* - Copy*")
20217. )
20218. # Backups end.
20219. 
20220. # NotBlobsArchivesBu
20221. ) )
20222. # NotBlobsArchivesBu end.
20223. 
20224. # Shares
20225. and (
20226. # Share start.
20227. (
20228.   DirectoryName("*Common*")
20229.   or DirectoryName("Media*")
20230.   or DirectoryName("Multimedia*")
20231.   or DirectoryName("*Public*")
20232.   or DirectoryName("*Share*")
20233. )
20234. # Share end.
20235. 
20236. # Shares
20237. or 
20238. # Family start.
20239. (
20240.     DirectoryName("*Family*")
20241. )
20242. # Family end.
20243. 
20244. # Shares
20245. )
20246. # Shares end.
20247. ')
20248. 
20249. 	# Script: ZoneDoHeader
20250. 
20251. # Script: ZoneWhenStarted
20252. 
20253. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
20254. # Script: DisplaySetZone
20255. 
20256. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
20257. SetVariable(FileStepDescription,	"")
20258. 
20259. SetVariable(ZoneStepByLine, 			"Zone started.
20260. ")
20261. 
20262. # Script: BannerDescriptionSet
20263. 
20264. # Script: BannerSet
20265. 
20266. # Script: DisplaySetDateTimeRun
20267. 
20268. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
20269. /* Xinclude "..\Display\BannerSet.MyDc"X */
20270. /* pause(1) */
20271. 
20272. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20273. 
20274. Title('!Heading!')
20275. /* pause(1) */
20276. 
20277. /* NOTE: Can't round or truncate to integer precision. */
20278. 
20279. # Script: BannerLog
20280. 
20281. AppendLogfile("!LogFileName!", "!Title!")
20282. 
20283. 
20284. 
20285. pause(1)
20286. 
20287. 
20288. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
20289. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
20290. 
20291. SetVariable(ZoneStepNoCurrent, 0)
20292. 
20293. 
20294. # Script: ZoneDoCurrentClear
20295. 
20296. SetVariable(ZoneTypeSelectCurrent, 		"")
20297. 
20298. SetVariable(ZoneBeginCurrent, 			0)
20299. SetVariable(ZoneBeginPerCurrent, 		0)
20300. SetVariable(ZoneEndCurrent, 			0)
20301. SetVariable(ZoneEndPerCurrent, 			0)
20302. 
20303. SetVariable(ZoneSizeCurrent,			0)
20304. SetVariable(ZoneSizePerCurrent,			0)
20305. 
20306. SetVariable(ZoneGapRequestedCurrent,	0)
20307. SetVariable(ZoneGapRoundedCurrent, 		0)
20308. SetVariable(ZoneGapAdjustedCurrent, 	0)
20309. SetVariable(ZoneGapAvailableCurrent, 	0)
20310. SetVariable(ZoneGapCurrent,				0)
20311. SetVariable(ZoneGapUsedCurrent, 		0)
20312. 
20313. SetVariable(ZoneGapActualCurrent, 		0)
20314. SetVariable(ZoneGapActualPerCurrent, 	0)
20315. 
20316. SetVariable(ZoneSizeActual, 			0)
20317. SetVariable(ZoneSizeActualCurrent,		0)
20318. 
20319. SetVariable(ZoneEndActual, 				0)
20320. SetVariable(ZoneEndActualCurrent,		0)			
20321. SetVariable(ZoneSizeActualPerCurrent, 	0)
20322.       
20323. SetVariable(ZoneFilesFolders,			0)
20324. SetVariable(ZoneFilesFoldersPer,		0) 
20325. 
20326. SetVariable(ZoneFragments,				0)
20327. SetVariable(ZoneFragmentsPer,			0) 
20328. 		
20329. SetVariable(ZoneEndActualCurrent, 		0)
20330. SetVariable(ZoneEndActualPerCurrent, 	0)
20331. 
20332. # Gap Calculation Methodology:
20333. 	# Requested
20334. 	SetVariable(GapRequested, 			0) 
20335. 	SetVariable(GapRequestedStd, 		0) 
20336. 	SetVariable(GapRequestedMft, 		0) 
20337. 	SetVariable(GapRequestedOs, 		0) 
20338. 	SetVariable(GapRequestedOriginal, 	0) 
20339. 	
20340. 	# Gap Adjustments
20341. 	SetVariable(GapRounded, 			0)
20342. 	# SetVariable(GapAdjusted, 			0)
20343. 	SetVariable(GapAvailable, 			0)
20344. 	SetVariable(GapCurrent, 			0)
20345. 	SetVariable(GapActual, 				0)
20346. 	SetVariable(GapUsed, 				0)
20347. 	
20348. 	# Gap Adjustments
20349. 	SetVariable(GapRoundedLoc, 			0)
20350. 	# SetVariable(GapAdjustedLoc, 		0)
20351. 	SetVariable(GapAvailableLoc, 		0)
20352. 	SetVariable(GapCurrentLoc, 			0)
20353. 	SetVariable(GapActualLoc,			0)
20354. 	SetVariable(GapUsedLoc,				0)
20355. 	
20356. 	# Space usage
20357. 	SetVariable(ZoneFreePerRequested, 	0)
20358. 	SetVariable(ZoneFreePerUsed, 		0)
20359. 
20360. # Gap Size & Rounding
20361. 	SetVariable(ZoneGapSizePer, 		0)
20362. 	SetVariable(ZoneVolRoundUpPer, 		0)
20363. 	
20364. 	# Free Space
20365. 	SetVariable(ZoneFreeUsedPer, 		0)
20366. 	SetVariable(ZoneFreeRequestedPer, 	0)
20367. 
20368. 
20369. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
20370. 
20371. # Footer:
20372. SetVariable(ZoneFooter, "----------------------------------------------------------
20373. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
20374. 
20375. Statistics Report:
20376. ------------------
20377.    Size:  
20378.    ------------------------
20379.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20380.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20381.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20382. 
20383.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20384.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20385. 
20386.    Location:
20387.    ------------------------
20388.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20389.              Files End: !ZoneEndCurrent!
20390.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20391.       
20392.    Gap Settings:
20393.    ------------------------
20394.          Gap Requested: !ZoneGapSizePer!%
20395.       Volume Rounding: !ZoneVolRoundUpPer!%
20396.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20397.                  
20398.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
20399.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
20400.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
20401.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
20402.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
20403.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
20404.      
20405.    Free Space after Zone:
20406.    ------------------------
20407.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20408.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20409.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20410. 
20411. Directory and Files Select:
20412. ---------------------------
20413. !ZoneTypeSelectCurrent!               
20414. ---------------------------
20415. ----------------------------------------------------------
20416. ")
20417. 
20418. # Script: BannerSet
20419. 
20420. # Script: DisplaySetDateTimeRun
20421. 
20422. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
20423. /* Xinclude "..\Display\BannerSet.MyDc"X */
20424. /* pause(1) */
20425. 
20426. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20427. 
20428. Title('!Heading!')
20429. /* pause(1) */
20430. 
20431. /* NOTE: Can't round or truncate to integer precision. */
20432. 
20433. # Script: BannerLog
20434. 
20435. AppendLogfile("!LogFileName!", "!Title!")
20436. 
20437. 
20438. 
20439. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
20440. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
20441. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:51")
20442. 
20443. SetVariable(ZoneListByLine, "!ZoneListByLine!
20444. Zone: !ZoneNoCurrent! 2021-11-09 18:53:51 0:00:07 !ZoneLabel! !ZoneDescription!")
20445. 
20446. 
20447. /* Fixed Zone Position Handling */
20448. /* Literal number: */
20449. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
20450. /* Percentage of disk: */
20451. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
20452. /* Gap */
20453. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
20454. 
20455. /* ---------------------------------------------------------- */
20456. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
20457. # Script: DisplaySetFileStep
20458. 
20459. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20460. 
20461. /* add message and move to a new line. */
20462. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20463. ")
20464. 
20465. /* display the line. (hopefully.) */
20466. # Zone Footer Set Statistics Window Text
20467. 
20468. SetStatisticsWindowText("----------------------------------------------------------
20469. Zones Processed: 
20470. ----------------------------------------------------------
20471. !ZoneListByLine!
20472. ----------------------------------------------------------
20473. Zone Processing Step:
20474. !ZoneStepByLine!    
20475. ----------------------------------------------------------
20476. Current Zone:
20477. !ZoneFooter!
20478. ----------------------------------------------------------
20479. Volume Statistics:
20480. !VolumeStatisticsDetail!
20481. ----------------------------------------------------------
20482. Zone Detailed Report:
20483. ----------------------------------------------------------
20484. !ZoneStatisticsDetail!
20485. ----------------------------------------------------------
20486. ")
20487. 
20488. 
20489. 
20490. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20491. 
20492. # Script: BannerSet
20493. 
20494. # Script: DisplaySetDateTimeRun
20495. 
20496. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
20497. /* Xinclude "..\Display\BannerSet.MyDc"X */
20498. /* pause(1) */
20499. 
20500. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20501. 
20502. Title('!Heading!')
20503. /* pause(1) */
20504. 
20505. /* NOTE: Can't round or truncate to integer precision. */
20506. 
20507. pause(1)
20508. 
20509. # your stuff HERE (X)... pre file select code.
20510. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
20511. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20512. 	# (X)
20513. 
20514. FileSelect
20515. 
20516. 	# your stuff can't really go here (errors.)
20517. 	# maybe for some reason I don't know of...
20518. 	
20519. 	# Actions next...
20520. 	# Script: ZoneDo ZoneTypeSelectShares
20521. # Shares start.
20522. # NotBlobsArchivesBu start.
20523. (not (
20524. # Blobs start.
20525. (
20526. # BlobsAndExceptions start.
20527. ( not(
20528.   FileName("*.bat")
20529.   or FileName("*.css")
20530.   or FileName("*.dll")
20531.   or FileName("*.exe")
20532.   or FileName("*.htm*")
20533.   or FileName("*.jar")
20534.   or FileName("*.js")
20535.   or FileName("*.script")
20536.   or FileName("*.wsf")
20537.   or (
20538. # Databases start.
20539. (
20540.   FileName("*.crypt*")
20541.   or FileName("*.db*")
20542.   or FileName("*.rdb*")
20543.   or FileName("*.dc*")
20544.   or FileName("*.dict*")
20545.   or FileName("*.?db*")
20546.   or FileName("*.?rdb*")
20547.   or FileName("*.md*")
20548.   or FileName("*.myd")
20549.   or FileName("*.ndf")
20550.   or FileName("*.ns?")
20551.   or FileName("*.pab")
20552.   or FileName("*.pst")
20553.   or FileName("*.sd?*")
20554.   or FileName("*.sq**")
20555.   or FileName("*.tmd")
20556.   or FileName("*.tps")
20557.   or FileName("*.tr*")
20558. )
20559. # Databases end.
20560. 
20561.     # BlobsAndExceptions
20562.     or 
20563. # Data start.
20564. (
20565.   DirectoryName("Data*")
20566.   or DirectoryName("Device*")
20567.   or DirectoryName("Export*")
20568.   or DirectoryName("Import*")
20569.   or DirectoryName("Log*")
20570.   or DirectoryName("*Log")
20571.   or DirectoryName("Maintenance*")
20572.   or DirectoryName("Rec*")
20573.   or DirectoryName("Sales*")
20574.   or DirectoryName("Search*")
20575.   or DirectoryName("User*")
20576. )
20577. # Data end.
20578. 
20579.     # BlobsAndExceptions
20580.   )
20581. ) )
20582. # BlobsAndExceptions end.
20583. 
20584. # Blobs
20585. ) and (
20586.   Size(BlobFileSize,0)
20587.   or (
20588.     FileName("*.arj")
20589.     or FileName("*.bup")
20590.     or FileName("*.bz2")
20591.     or FileName("*.chm")
20592.     or FileName("*.dvr-ms")
20593.     or FileName("*.gz")
20594.     or FileName("*.ifo")
20595.     or FileName("*.lzh")
20596.     or FileName("*.pdf")
20597.     or FileName("*.rpm")
20598.     or FileName("*.wmv")
20599.     or FileName("*.vob")
20600.     or FileName("*.z")
20601.   ) 
20602. )
20603. # Blobs end.
20604. 
20605. # NotBlobsArchivesBu
20606. or 
20607. # Archives start.
20608. (
20609.   DirectoryName("*Archive*")
20610.   or DirectoryName("*History*")
20611.   or DirectoryName("*Old")
20612.   or DirectoryName("* Old *")
20613.   or DirectoryName("Old *")
20614. 
20615.   or FileName("*.7z")
20616.   or FileName("*.cab")
20617.   or FileName("*.iso")
20618.   or FileName("*.msi")
20619.   or FileName("*.old")
20620.   or FileName("*.rar")
20621.   or FileName("*.tar")
20622.   or FileName("*.zip")
20623.   or
20624. # WinSysLow start.
20625. (
20626.   DirectoryName("$*")
20627.   or DirectoryName("0*")
20628.   or DirectoryName("1*")
20629.   or DirectoryName("2*")
20630.   or DirectoryName("3*")
20631.   or DirectoryName("4*")
20632.   or DirectoryName("5*")
20633.   or DirectoryName("6*")
20634.   or DirectoryName("7*")
20635.   or DirectoryName("8*")
20636.   or DirectoryName("9*")
20637. 
20638.   or DirectoryName("dllcache")
20639.   or DirectoryName("Downloaded Installations")
20640.   or DirectoryName("Ehome")
20641.   or DirectoryName("Fonts")
20642.   or DirectoryName("Help")
20643.   or DirectoryName("I386")
20644.   or DirectoryName("ie?updates")
20645.   or DirectoryName("Installer")
20646.   or DirectoryName("Installshield Installation Information")
20647.   or DirectoryName("IME")
20648.   or DirectoryName("*RECYCLE*")
20649.   or DirectoryName("ServicePackFiles")
20650.   or DirectoryName("SoftwareDistribution")
20651.   or DirectoryName("Speech")
20652.   or DirectoryName("Symbols")
20653.   or DirectoryName("System Volume Information")
20654.   or DirectoryName("windows.old")
20655. )
20656. # WinSysLow end.
20657. 
20658.   # Archives
20659. )
20660. # Archives end.
20661. 
20662. # NotBlobsArchivesBu
20663. or
20664. # Backups start.
20665. (
20666.   DirectoryName("*Backup*")
20667.   or DirectoryName("*Bu")
20668.   or DirectoryName("* Bu *")
20669.   or DirectoryName("Bu *")
20670. 
20671.   or FileName("*.bak")
20672.   or FileName("* - Copy*")
20673. )
20674. # Backups end.
20675. 
20676. # NotBlobsArchivesBu
20677. ) )
20678. # NotBlobsArchivesBu end.
20679. 
20680. # Shares
20681. and (
20682. # Share start.
20683. (
20684.   DirectoryName("*Common*")
20685.   or DirectoryName("Media*")
20686.   or DirectoryName("Multimedia*")
20687.   or DirectoryName("*Public*")
20688.   or DirectoryName("*Share*")
20689. )
20690. # Share end.
20691. 
20692. # Shares
20693. or 
20694. # Family start.
20695. (
20696.     DirectoryName("*Family*")
20697. )
20698. # Family end.
20699. 
20700. # Shares
20701. )
20702. # Shares end.
20703. 
20704. 	# Script: ZoneDoAction
20705. # Zone Do File Action - SortByName.
20706. 
20707. FileActions
20708. 
20709. 	# Footer:
20710. SetVariable(ZoneFooter, "----------------------------------------------------------
20711. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
20712. 
20713. Statistics Report:
20714. ------------------
20715.    Size:  
20716.    ------------------------
20717.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20718.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20719.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20720. 
20721.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20722.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20723. 
20724.    Location:
20725.    ------------------------
20726.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20727.              Files End: !ZoneEndCurrent!
20728.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20729.       
20730.    Gap Settings:
20731.    ------------------------
20732.          Gap Requested: !ZoneGapSizePer!%
20733.       Volume Rounding: !ZoneVolRoundUpPer!%
20734.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20735.                  
20736.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
20737.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
20738.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
20739.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
20740.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
20741.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
20742.      
20743.    Free Space after Zone:
20744.    ------------------------
20745.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20746.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20747.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20748. 
20749. Directory and Files Select:
20750. ---------------------------
20751. !ZoneTypeSelectCurrent!               
20752. ---------------------------
20753. ----------------------------------------------------------
20754. ")
20755. 	SetStatisticsWindowText("!ZoneFooter!")
20756. 	
20757. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
20758. 	# Script: DisplaySetFileStep
20759. 
20760. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20761. 
20762. /* add message and move to a new line. */
20763. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20764. ")
20765. 
20766. /* display the line. (hopefully.) */
20767. # Zone Footer Set Statistics Window Text
20768. 
20769. SetStatisticsWindowText("----------------------------------------------------------
20770. Zones Processed: 
20771. ----------------------------------------------------------
20772. !ZoneListByLine!
20773. ----------------------------------------------------------
20774. Zone Processing Step:
20775. !ZoneStepByLine!    
20776. ----------------------------------------------------------
20777. Current Zone:
20778. !ZoneFooter!
20779. ----------------------------------------------------------
20780. Volume Statistics:
20781. !VolumeStatisticsDetail!
20782. ----------------------------------------------------------
20783. Zone Detailed Report:
20784. ----------------------------------------------------------
20785. !ZoneStatisticsDetail!
20786. ----------------------------------------------------------
20787. ")
20788. 
20789. 
20790. 
20791. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20792. 
20793. # Script: BannerSet
20794. 
20795. # Script: DisplaySetDateTimeRun
20796. 
20797. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
20798. /* Xinclude "..\Display\BannerSet.MyDc"X */
20799. /* pause(1) */
20800. 
20801. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20802. 
20803. Title('!Heading!')
20804. /* pause(1) */
20805. 
20806. /* NOTE: Can't round or truncate to integer precision. */
20807. 
20808. pause(1)
20809. 
20810. # Commands:
20811. 
20812. /* Moves to Zone or above it. */
20813. # MoveUpToZone()
20814. 
20815. # Defrag
20816. 
20817. # Defragment(OPTIONS)
20818. 
20819. /* Shuffles files around trying to make a big enough gap for fragmented files. */
20820. # Defragment()
20821. 
20822. /* Only does files where a gap will fit it. */
20823. # Defragment(Fast)
20824. 
20825. /* Skips fragmented files larger than the Chunck Size.
20826. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
20827. # Defragment(Chunk Size)
20828. 
20829. /* Moves down to zone and packs zone to beginning if there are gaps. */
20830. /* Can be similar in performance to doing a SortBy. */
20831. # MoveDownFill()
20832. 
20833. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
20834. 
20835. 
20836. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
20837. 	# Script: DisplaySetFileStep
20838. 
20839. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20840. 
20841. /* add message and move to a new line. */
20842. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20843. ")
20844. 
20845. /* display the line. (hopefully.) */
20846. # Zone Footer Set Statistics Window Text
20847. 
20848. SetStatisticsWindowText("----------------------------------------------------------
20849. Zones Processed: 
20850. ----------------------------------------------------------
20851. !ZoneListByLine!
20852. ----------------------------------------------------------
20853. Zone Processing Step:
20854. !ZoneStepByLine!    
20855. ----------------------------------------------------------
20856. Current Zone:
20857. !ZoneFooter!
20858. ----------------------------------------------------------
20859. Volume Statistics:
20860. !VolumeStatisticsDetail!
20861. ----------------------------------------------------------
20862. Zone Detailed Report:
20863. ----------------------------------------------------------
20864. !ZoneStatisticsDetail!
20865. ----------------------------------------------------------
20866. ")
20867. 
20868. 
20869. 
20870. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20871. 
20872. # Script: BannerSet
20873. 
20874. # Script: DisplaySetDateTimeRun
20875. 
20876. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
20877. /* Xinclude "..\Display\BannerSet.MyDc"X */
20878. /* pause(1) */
20879. 
20880. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20881. 
20882. Title('!Heading!')
20883. /* pause(1) */
20884. 
20885. /* NOTE: Can't round or truncate to integer precision. */
20886. 
20887. pause(1)
20888. 
20889. 	# Script: ZoneDoFooter
20890. 
20891. /* ---------------------------------------------------------- */
20892. # File Select
20893. 	# Select Statments
20894. # File Actions 
20895. 	# Standard or OS File Actions.
20896. 	# Resume...
20897. 	
20898. 	# your stuff HERE (X)... post zone (file) file actions code.
20899. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
20900. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20901. 		# (X)
20902. 		
20903. 		/* ??? Set window? */
20904. 	
20905. 	# ADD THE GAP
20906. 		
20907. # Vacate (good for diagnostics)
20908. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
20909. 
20910. # DoNotVacate - DO NOT Vacate (recommended)
20911. 
20912. # Vacate
20913. /* AddGap(GapUsedLoc) */
20914. 
20915. # DO Not Vacate
20916. AddGap(GapUsedLoc, DoNotVacate) 
20917. 	
20918. 	
20919. /* ---------------------------------------------------------- */
20920. # (failed) TEST for boolean logic.
20921. 
20922. /* It should work in the gap calculations for turning options */
20923. /* on and off but it will NOT work here. */
20924. 
20925. /* Boolean setting X or FlagX. */
20926. /* Where X will be on or off: */
20927. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
20928. /*      For ON:  (X  *  FlagAny) */
20929. 
20930. /* 1) Failed, zero gap overrode the previous one. */
20931. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
20932. /* AddGap(GapUsedTemp) */ 
20933. 
20934. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
20935. /* AddGap(GapUsedTemp, DoNotVacate) */ 
20936. 
20937. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
20938. 
20939. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
20940. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
20941. /* AddGap(GapUsedTemp) */ 
20942. 
20943. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
20944. /* AddGap(GapUsedTemp, DoNotVacate) */ 
20945. 
20946. /* ---------------------------------------------------------- */
20947. 
20948. # Vacate
20949. /* AddGap(GapUsed) */
20950. 
20951. # DO NOT Vacate (recommended)
20952. /* AddGap(GapUsed, DoNotVacate) */ 
20953. 	
20954. 
20955. 		
20956. # 
20957. FileEnd
20958. /* ---------------------------------------------------------- */
20959. 
20960. # your stuff HERE (X)... post zone (file) code.
20961. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
20962. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
20963. 	# (X)
20964. 
20965. SetVariable(FileStepDescription,"Zone finished, reporting.")
20966. # Script: DisplaySetFileStep
20967. 
20968. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20969. 
20970. /* add message and move to a new line. */
20971. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20972. ")
20973. 
20974. /* display the line. (hopefully.) */
20975. # Zone Footer Set Statistics Window Text
20976. 
20977. SetStatisticsWindowText("----------------------------------------------------------
20978. Zones Processed: 
20979. ----------------------------------------------------------
20980. !ZoneListByLine!
20981. ----------------------------------------------------------
20982. Zone Processing Step:
20983. !ZoneStepByLine!    
20984. ----------------------------------------------------------
20985. Current Zone:
20986. !ZoneFooter!
20987. ----------------------------------------------------------
20988. Volume Statistics:
20989. !VolumeStatisticsDetail!
20990. ----------------------------------------------------------
20991. Zone Detailed Report:
20992. ----------------------------------------------------------
20993. !ZoneStatisticsDetail!
20994. ----------------------------------------------------------
20995. ")
20996. 
20997. 
20998. 
20999. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21000. 
21001. # Script: BannerSet
21002. 
21003. # Script: DisplaySetDateTimeRun
21004. 
21005. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
21006. /* Xinclude "..\Display\BannerSet.MyDc"X */
21007. /* pause(1) */
21008. 
21009. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21010. 
21011. Title('!Heading!')
21012. /* pause(1) */
21013. 
21014. /* NOTE: Can't round or truncate to integer precision. */
21015. 
21016. pause(1)
21017. 
21018. # Script: ZoneWhenFinished
21019. 
21020. # Script: BannerSet
21021. 
21022. # Script: DisplaySetDateTimeRun
21023. 
21024. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
21025. /* Xinclude "..\Display\BannerSet.MyDc"X */
21026. /* pause(1) */
21027. 
21028. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21029. 
21030. Title('!Heading!')
21031. /* pause(1) */
21032. 
21033. /* NOTE: Can't round or truncate to integer precision. */
21034. 
21035. # Script: BannerLog
21036. 
21037. AppendLogfile("!LogFileName!", "!Title!")
21038. 
21039. 
21040. 
21041. # Zone Statistics	
21042. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
21043. 
21044. # Footer:
21045. SetVariable(ZoneFooter, "----------------------------------------------------------
21046. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
21047. 
21048. Statistics Report:
21049. ------------------
21050.    Size:  
21051.    ------------------------
21052.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21053.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21054.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21055. 
21056.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21057.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21058. 
21059.    Location:
21060.    ------------------------
21061.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21062.              Files End: !ZoneEndCurrent!
21063.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21064.       
21065.    Gap Settings:
21066.    ------------------------
21067.          Gap Requested: !ZoneGapSizePer!%
21068.       Volume Rounding: !ZoneVolRoundUpPer!%
21069.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21070.                  
21071.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
21072.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
21073.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
21074.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
21075.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
21076.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
21077.      
21078.    Free Space after Zone:
21079.    ------------------------
21080.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21081.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21082.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21083. 
21084. Directory and Files Select:
21085. ---------------------------
21086. !ZoneTypeSelectCurrent!               
21087. ---------------------------
21088. ----------------------------------------------------------
21089. ")
21090. 
21091. AppendLogfile("!LogFileName!", ".")
21092. AppendLogfile("!LogFileName!", "!ZoneFooter!")
21093. AppendLogfile("!LogFileName!", ".")
21094. 
21095. # Zone Footer Set Statistics Window Text
21096. 
21097. SetStatisticsWindowText("----------------------------------------------------------
21098. Zones Processed: 
21099. ----------------------------------------------------------
21100. !ZoneListByLine!
21101. ----------------------------------------------------------
21102. Zone Processing Step:
21103. !ZoneStepByLine!    
21104. ----------------------------------------------------------
21105. Current Zone:
21106. !ZoneFooter!
21107. ----------------------------------------------------------
21108. Volume Statistics:
21109. !VolumeStatisticsDetail!
21110. ----------------------------------------------------------
21111. Zone Detailed Report:
21112. ----------------------------------------------------------
21113. !ZoneStatisticsDetail!
21114. ----------------------------------------------------------
21115. ")
21116. 
21117. 
21118. 
21119. /* pause() */
21120. /* pause() */
21121. 
21122. 
21123. 
21124. 
21125. /* ---------------------------------------------------------- */
21126. 
21127. 
21128. /* ---------------------------------------------------------- */
21129. /* Zone SystemOtherData System Other and Data */
21130. # Script: DefragZoneTypeSystemOtherData
21131. /* ---------------------------------------------------------- */
21132. /* Zone SystemOtherData System Other and Data */
21133. SetVariable(ZoneLabel, "!ZoneLabelSystemOtherData!")
21134. SetVariable(ZoneDescription, "!ZoneDescriptionSystemOtherData!")
21135. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSystemOtherData!")
21136. SetVariable(ZoneGapSize, "!ZoneGapSizeSystemOtherData!")
21137. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectSystemOtherData
21138. # SystemOtherData start.
21139. # NotBlobsArchivesBu start.
21140. (not (
21141. # Blobs start.
21142. (
21143. # BlobsAndExceptions start.
21144. ( not(
21145.   FileName("*.bat")
21146.   or FileName("*.css")
21147.   or FileName("*.dll")
21148.   or FileName("*.exe")
21149.   or FileName("*.htm*")
21150.   or FileName("*.jar")
21151.   or FileName("*.js")
21152.   or FileName("*.script")
21153.   or FileName("*.wsf")
21154.   or (
21155. # Databases start.
21156. (
21157.   FileName("*.crypt*")
21158.   or FileName("*.db*")
21159.   or FileName("*.rdb*")
21160.   or FileName("*.dc*")
21161.   or FileName("*.dict*")
21162.   or FileName("*.?db*")
21163.   or FileName("*.?rdb*")
21164.   or FileName("*.md*")
21165.   or FileName("*.myd")
21166.   or FileName("*.ndf")
21167.   or FileName("*.ns?")
21168.   or FileName("*.pab")
21169.   or FileName("*.pst")
21170.   or FileName("*.sd?*")
21171.   or FileName("*.sq**")
21172.   or FileName("*.tmd")
21173.   or FileName("*.tps")
21174.   or FileName("*.tr*")
21175. )
21176. # Databases end.
21177. 
21178.     # BlobsAndExceptions
21179.     or 
21180. # Data start.
21181. (
21182.   DirectoryName("Data*")
21183.   or DirectoryName("Device*")
21184.   or DirectoryName("Export*")
21185.   or DirectoryName("Import*")
21186.   or DirectoryName("Log*")
21187.   or DirectoryName("*Log")
21188.   or DirectoryName("Maintenance*")
21189.   or DirectoryName("Rec*")
21190.   or DirectoryName("Sales*")
21191.   or DirectoryName("Search*")
21192.   or DirectoryName("User*")
21193. )
21194. # Data end.
21195. 
21196.     # BlobsAndExceptions
21197.   )
21198. ) )
21199. # BlobsAndExceptions end.
21200. 
21201. # Blobs
21202. ) and (
21203.   Size(BlobFileSize,0)
21204.   or (
21205.     FileName("*.arj")
21206.     or FileName("*.bup")
21207.     or FileName("*.bz2")
21208.     or FileName("*.chm")
21209.     or FileName("*.dvr-ms")
21210.     or FileName("*.gz")
21211.     or FileName("*.ifo")
21212.     or FileName("*.lzh")
21213.     or FileName("*.pdf")
21214.     or FileName("*.rpm")
21215.     or FileName("*.wmv")
21216.     or FileName("*.vob")
21217.     or FileName("*.z")
21218.   ) 
21219. )
21220. # Blobs end.
21221. 
21222. # NotBlobsArchivesBu
21223. or 
21224. # Archives start.
21225. (
21226.   DirectoryName("*Archive*")
21227.   or DirectoryName("*History*")
21228.   or DirectoryName("*Old")
21229.   or DirectoryName("* Old *")
21230.   or DirectoryName("Old *")
21231. 
21232.   or FileName("*.7z")
21233.   or FileName("*.cab")
21234.   or FileName("*.iso")
21235.   or FileName("*.msi")
21236.   or FileName("*.old")
21237.   or FileName("*.rar")
21238.   or FileName("*.tar")
21239.   or FileName("*.zip")
21240.   or
21241. # WinSysLow start.
21242. (
21243.   DirectoryName("$*")
21244.   or DirectoryName("0*")
21245.   or DirectoryName("1*")
21246.   or DirectoryName("2*")
21247.   or DirectoryName("3*")
21248.   or DirectoryName("4*")
21249.   or DirectoryName("5*")
21250.   or DirectoryName("6*")
21251.   or DirectoryName("7*")
21252.   or DirectoryName("8*")
21253.   or DirectoryName("9*")
21254. 
21255.   or DirectoryName("dllcache")
21256.   or DirectoryName("Downloaded Installations")
21257.   or DirectoryName("Ehome")
21258.   or DirectoryName("Fonts")
21259.   or DirectoryName("Help")
21260.   or DirectoryName("I386")
21261.   or DirectoryName("ie?updates")
21262.   or DirectoryName("Installer")
21263.   or DirectoryName("Installshield Installation Information")
21264.   or DirectoryName("IME")
21265.   or DirectoryName("*RECYCLE*")
21266.   or DirectoryName("ServicePackFiles")
21267.   or DirectoryName("SoftwareDistribution")
21268.   or DirectoryName("Speech")
21269.   or DirectoryName("Symbols")
21270.   or DirectoryName("System Volume Information")
21271.   or DirectoryName("windows.old")
21272. )
21273. # WinSysLow end.
21274. 
21275.   # Archives
21276. )
21277. # Archives end.
21278. 
21279. # NotBlobsArchivesBu
21280. or
21281. # Backups start.
21282. (
21283.   DirectoryName("*Backup*")
21284.   or DirectoryName("*Bu")
21285.   or DirectoryName("* Bu *")
21286.   or DirectoryName("Bu *")
21287. 
21288.   or FileName("*.bak")
21289.   or FileName("* - Copy*")
21290. )
21291. # Backups end.
21292. 
21293. # NotBlobsArchivesBu
21294. ) )
21295. # NotBlobsArchivesBu end.
21296. 
21297. # SystemOtherData
21298. and ( 
21299. # Data start.
21300. (
21301.   DirectoryName("Data*")
21302.   or DirectoryName("Device*")
21303.   or DirectoryName("Export*")
21304.   or DirectoryName("Import*")
21305.   or DirectoryName("Log*")
21306.   or DirectoryName("*Log")
21307.   or DirectoryName("Maintenance*")
21308.   or DirectoryName("Rec*")
21309.   or DirectoryName("Sales*")
21310.   or DirectoryName("Search*")
21311.   or DirectoryName("User*")
21312. )
21313. # Data end.
21314.  
21315. # SystemOtherData
21316. or  
21317. # Databases start.
21318. (
21319.   FileName("*.crypt*")
21320.   or FileName("*.db*")
21321.   or FileName("*.rdb*")
21322.   or FileName("*.dc*")
21323.   or FileName("*.dict*")
21324.   or FileName("*.?db*")
21325.   or FileName("*.?rdb*")
21326.   or FileName("*.md*")
21327.   or FileName("*.myd")
21328.   or FileName("*.ndf")
21329.   or FileName("*.ns?")
21330.   or FileName("*.pab")
21331.   or FileName("*.pst")
21332.   or FileName("*.sd?*")
21333.   or FileName("*.sq**")
21334.   or FileName("*.tmd")
21335.   or FileName("*.tps")
21336.   or FileName("*.tr*")
21337. )
21338. # Databases end.
21339. 
21340. # SystemOtherData
21341. )
21342. # SystemOtherData end.
21343. ')
21344. 
21345. 	# Script: ZoneDoHeader
21346. 
21347. # Script: ZoneWhenStarted
21348. 
21349. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
21350. # Script: DisplaySetZone
21351. 
21352. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
21353. SetVariable(FileStepDescription,	"")
21354. 
21355. SetVariable(ZoneStepByLine, 			"Zone started.
21356. ")
21357. 
21358. # Script: BannerDescriptionSet
21359. 
21360. # Script: BannerSet
21361. 
21362. # Script: DisplaySetDateTimeRun
21363. 
21364. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
21365. /* Xinclude "..\Display\BannerSet.MyDc"X */
21366. /* pause(1) */
21367. 
21368. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21369. 
21370. Title('!Heading!')
21371. /* pause(1) */
21372. 
21373. /* NOTE: Can't round or truncate to integer precision. */
21374. 
21375. # Script: BannerLog
21376. 
21377. AppendLogfile("!LogFileName!", "!Title!")
21378. 
21379. 
21380. 
21381. pause(1)
21382. 
21383. 
21384. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
21385. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
21386. 
21387. SetVariable(ZoneStepNoCurrent, 0)
21388. 
21389. 
21390. # Script: ZoneDoCurrentClear
21391. 
21392. SetVariable(ZoneTypeSelectCurrent, 		"")
21393. 
21394. SetVariable(ZoneBeginCurrent, 			0)
21395. SetVariable(ZoneBeginPerCurrent, 		0)
21396. SetVariable(ZoneEndCurrent, 			0)
21397. SetVariable(ZoneEndPerCurrent, 			0)
21398. 
21399. SetVariable(ZoneSizeCurrent,			0)
21400. SetVariable(ZoneSizePerCurrent,			0)
21401. 
21402. SetVariable(ZoneGapRequestedCurrent,	0)
21403. SetVariable(ZoneGapRoundedCurrent, 		0)
21404. SetVariable(ZoneGapAdjustedCurrent, 	0)
21405. SetVariable(ZoneGapAvailableCurrent, 	0)
21406. SetVariable(ZoneGapCurrent,				0)
21407. SetVariable(ZoneGapUsedCurrent, 		0)
21408. 
21409. SetVariable(ZoneGapActualCurrent, 		0)
21410. SetVariable(ZoneGapActualPerCurrent, 	0)
21411. 
21412. SetVariable(ZoneSizeActual, 			0)
21413. SetVariable(ZoneSizeActualCurrent,		0)
21414. 
21415. SetVariable(ZoneEndActual, 				0)
21416. SetVariable(ZoneEndActualCurrent,		0)			
21417. SetVariable(ZoneSizeActualPerCurrent, 	0)
21418.       
21419. SetVariable(ZoneFilesFolders,			0)
21420. SetVariable(ZoneFilesFoldersPer,		0) 
21421. 
21422. SetVariable(ZoneFragments,				0)
21423. SetVariable(ZoneFragmentsPer,			0) 
21424. 		
21425. SetVariable(ZoneEndActualCurrent, 		0)
21426. SetVariable(ZoneEndActualPerCurrent, 	0)
21427. 
21428. # Gap Calculation Methodology:
21429. 	# Requested
21430. 	SetVariable(GapRequested, 			0) 
21431. 	SetVariable(GapRequestedStd, 		0) 
21432. 	SetVariable(GapRequestedMft, 		0) 
21433. 	SetVariable(GapRequestedOs, 		0) 
21434. 	SetVariable(GapRequestedOriginal, 	0) 
21435. 	
21436. 	# Gap Adjustments
21437. 	SetVariable(GapRounded, 			0)
21438. 	# SetVariable(GapAdjusted, 			0)
21439. 	SetVariable(GapAvailable, 			0)
21440. 	SetVariable(GapCurrent, 			0)
21441. 	SetVariable(GapActual, 				0)
21442. 	SetVariable(GapUsed, 				0)
21443. 	
21444. 	# Gap Adjustments
21445. 	SetVariable(GapRoundedLoc, 			0)
21446. 	# SetVariable(GapAdjustedLoc, 		0)
21447. 	SetVariable(GapAvailableLoc, 		0)
21448. 	SetVariable(GapCurrentLoc, 			0)
21449. 	SetVariable(GapActualLoc,			0)
21450. 	SetVariable(GapUsedLoc,				0)
21451. 	
21452. 	# Space usage
21453. 	SetVariable(ZoneFreePerRequested, 	0)
21454. 	SetVariable(ZoneFreePerUsed, 		0)
21455. 
21456. # Gap Size & Rounding
21457. 	SetVariable(ZoneGapSizePer, 		0)
21458. 	SetVariable(ZoneVolRoundUpPer, 		0)
21459. 	
21460. 	# Free Space
21461. 	SetVariable(ZoneFreeUsedPer, 		0)
21462. 	SetVariable(ZoneFreeRequestedPer, 	0)
21463. 
21464. 
21465. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
21466. 
21467. # Footer:
21468. SetVariable(ZoneFooter, "----------------------------------------------------------
21469. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
21470. 
21471. Statistics Report:
21472. ------------------
21473.    Size:  
21474.    ------------------------
21475.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21476.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21477.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21478. 
21479.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21480.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21481. 
21482.    Location:
21483.    ------------------------
21484.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21485.              Files End: !ZoneEndCurrent!
21486.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21487.       
21488.    Gap Settings:
21489.    ------------------------
21490.          Gap Requested: !ZoneGapSizePer!%
21491.       Volume Rounding: !ZoneVolRoundUpPer!%
21492.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21493.                  
21494.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
21495.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
21496.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
21497.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
21498.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
21499.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
21500.      
21501.    Free Space after Zone:
21502.    ------------------------
21503.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21504.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21505.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21506. 
21507. Directory and Files Select:
21508. ---------------------------
21509. !ZoneTypeSelectCurrent!               
21510. ---------------------------
21511. ----------------------------------------------------------
21512. ")
21513. 
21514. # Script: BannerSet
21515. 
21516. # Script: DisplaySetDateTimeRun
21517. 
21518. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
21519. /* Xinclude "..\Display\BannerSet.MyDc"X */
21520. /* pause(1) */
21521. 
21522. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21523. 
21524. Title('!Heading!')
21525. /* pause(1) */
21526. 
21527. /* NOTE: Can't round or truncate to integer precision. */
21528. 
21529. # Script: BannerLog
21530. 
21531. AppendLogfile("!LogFileName!", "!Title!")
21532. 
21533. 
21534. 
21535. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
21536. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
21537. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:51")
21538. 
21539. SetVariable(ZoneListByLine, "!ZoneListByLine!
21540. Zone: !ZoneNoCurrent! 2021-11-09 18:53:51 0:00:07 !ZoneLabel! !ZoneDescription!")
21541. 
21542. 
21543. /* Fixed Zone Position Handling */
21544. /* Literal number: */
21545. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
21546. /* Percentage of disk: */
21547. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
21548. /* Gap */
21549. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
21550. 
21551. /* ---------------------------------------------------------- */
21552. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
21553. # Script: DisplaySetFileStep
21554. 
21555. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21556. 
21557. /* add message and move to a new line. */
21558. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21559. ")
21560. 
21561. /* display the line. (hopefully.) */
21562. # Zone Footer Set Statistics Window Text
21563. 
21564. SetStatisticsWindowText("----------------------------------------------------------
21565. Zones Processed: 
21566. ----------------------------------------------------------
21567. !ZoneListByLine!
21568. ----------------------------------------------------------
21569. Zone Processing Step:
21570. !ZoneStepByLine!    
21571. ----------------------------------------------------------
21572. Current Zone:
21573. !ZoneFooter!
21574. ----------------------------------------------------------
21575. Volume Statistics:
21576. !VolumeStatisticsDetail!
21577. ----------------------------------------------------------
21578. Zone Detailed Report:
21579. ----------------------------------------------------------
21580. !ZoneStatisticsDetail!
21581. ----------------------------------------------------------
21582. ")
21583. 
21584. 
21585. 
21586. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21587. 
21588. # Script: BannerSet
21589. 
21590. # Script: DisplaySetDateTimeRun
21591. 
21592. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
21593. /* Xinclude "..\Display\BannerSet.MyDc"X */
21594. /* pause(1) */
21595. 
21596. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21597. 
21598. Title('!Heading!')
21599. /* pause(1) */
21600. 
21601. /* NOTE: Can't round or truncate to integer precision. */
21602. 
21603. pause(1)
21604. 
21605. # your stuff HERE (X)... pre file select code.
21606. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
21607. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
21608. 	# (X)
21609. 
21610. FileSelect
21611. 
21612. 	# your stuff can't really go here (errors.)
21613. 	# maybe for some reason I don't know of...
21614. 	
21615. 	# Actions next...
21616. 	# Script: ZoneDo ZoneTypeSelectSystemOtherData
21617. # SystemOtherData start.
21618. # NotBlobsArchivesBu start.
21619. (not (
21620. # Blobs start.
21621. (
21622. # BlobsAndExceptions start.
21623. ( not(
21624.   FileName("*.bat")
21625.   or FileName("*.css")
21626.   or FileName("*.dll")
21627.   or FileName("*.exe")
21628.   or FileName("*.htm*")
21629.   or FileName("*.jar")
21630.   or FileName("*.js")
21631.   or FileName("*.script")
21632.   or FileName("*.wsf")
21633.   or (
21634. # Databases start.
21635. (
21636.   FileName("*.crypt*")
21637.   or FileName("*.db*")
21638.   or FileName("*.rdb*")
21639.   or FileName("*.dc*")
21640.   or FileName("*.dict*")
21641.   or FileName("*.?db*")
21642.   or FileName("*.?rdb*")
21643.   or FileName("*.md*")
21644.   or FileName("*.myd")
21645.   or FileName("*.ndf")
21646.   or FileName("*.ns?")
21647.   or FileName("*.pab")
21648.   or FileName("*.pst")
21649.   or FileName("*.sd?*")
21650.   or FileName("*.sq**")
21651.   or FileName("*.tmd")
21652.   or FileName("*.tps")
21653.   or FileName("*.tr*")
21654. )
21655. # Databases end.
21656. 
21657.     # BlobsAndExceptions
21658.     or 
21659. # Data start.
21660. (
21661.   DirectoryName("Data*")
21662.   or DirectoryName("Device*")
21663.   or DirectoryName("Export*")
21664.   or DirectoryName("Import*")
21665.   or DirectoryName("Log*")
21666.   or DirectoryName("*Log")
21667.   or DirectoryName("Maintenance*")
21668.   or DirectoryName("Rec*")
21669.   or DirectoryName("Sales*")
21670.   or DirectoryName("Search*")
21671.   or DirectoryName("User*")
21672. )
21673. # Data end.
21674. 
21675.     # BlobsAndExceptions
21676.   )
21677. ) )
21678. # BlobsAndExceptions end.
21679. 
21680. # Blobs
21681. ) and (
21682.   Size(BlobFileSize,0)
21683.   or (
21684.     FileName("*.arj")
21685.     or FileName("*.bup")
21686.     or FileName("*.bz2")
21687.     or FileName("*.chm")
21688.     or FileName("*.dvr-ms")
21689.     or FileName("*.gz")
21690.     or FileName("*.ifo")
21691.     or FileName("*.lzh")
21692.     or FileName("*.pdf")
21693.     or FileName("*.rpm")
21694.     or FileName("*.wmv")
21695.     or FileName("*.vob")
21696.     or FileName("*.z")
21697.   ) 
21698. )
21699. # Blobs end.
21700. 
21701. # NotBlobsArchivesBu
21702. or 
21703. # Archives start.
21704. (
21705.   DirectoryName("*Archive*")
21706.   or DirectoryName("*History*")
21707.   or DirectoryName("*Old")
21708.   or DirectoryName("* Old *")
21709.   or DirectoryName("Old *")
21710. 
21711.   or FileName("*.7z")
21712.   or FileName("*.cab")
21713.   or FileName("*.iso")
21714.   or FileName("*.msi")
21715.   or FileName("*.old")
21716.   or FileName("*.rar")
21717.   or FileName("*.tar")
21718.   or FileName("*.zip")
21719.   or
21720. # WinSysLow start.
21721. (
21722.   DirectoryName("$*")
21723.   or DirectoryName("0*")
21724.   or DirectoryName("1*")
21725.   or DirectoryName("2*")
21726.   or DirectoryName("3*")
21727.   or DirectoryName("4*")
21728.   or DirectoryName("5*")
21729.   or DirectoryName("6*")
21730.   or DirectoryName("7*")
21731.   or DirectoryName("8*")
21732.   or DirectoryName("9*")
21733. 
21734.   or DirectoryName("dllcache")
21735.   or DirectoryName("Downloaded Installations")
21736.   or DirectoryName("Ehome")
21737.   or DirectoryName("Fonts")
21738.   or DirectoryName("Help")
21739.   or DirectoryName("I386")
21740.   or DirectoryName("ie?updates")
21741.   or DirectoryName("Installer")
21742.   or DirectoryName("Installshield Installation Information")
21743.   or DirectoryName("IME")
21744.   or DirectoryName("*RECYCLE*")
21745.   or DirectoryName("ServicePackFiles")
21746.   or DirectoryName("SoftwareDistribution")
21747.   or DirectoryName("Speech")
21748.   or DirectoryName("Symbols")
21749.   or DirectoryName("System Volume Information")
21750.   or DirectoryName("windows.old")
21751. )
21752. # WinSysLow end.
21753. 
21754.   # Archives
21755. )
21756. # Archives end.
21757. 
21758. # NotBlobsArchivesBu
21759. or
21760. # Backups start.
21761. (
21762.   DirectoryName("*Backup*")
21763.   or DirectoryName("*Bu")
21764.   or DirectoryName("* Bu *")
21765.   or DirectoryName("Bu *")
21766. 
21767.   or FileName("*.bak")
21768.   or FileName("* - Copy*")
21769. )
21770. # Backups end.
21771. 
21772. # NotBlobsArchivesBu
21773. ) )
21774. # NotBlobsArchivesBu end.
21775. 
21776. # SystemOtherData
21777. and ( 
21778. # Data start.
21779. (
21780.   DirectoryName("Data*")
21781.   or DirectoryName("Device*")
21782.   or DirectoryName("Export*")
21783.   or DirectoryName("Import*")
21784.   or DirectoryName("Log*")
21785.   or DirectoryName("*Log")
21786.   or DirectoryName("Maintenance*")
21787.   or DirectoryName("Rec*")
21788.   or DirectoryName("Sales*")
21789.   or DirectoryName("Search*")
21790.   or DirectoryName("User*")
21791. )
21792. # Data end.
21793.  
21794. # SystemOtherData
21795. or  
21796. # Databases start.
21797. (
21798.   FileName("*.crypt*")
21799.   or FileName("*.db*")
21800.   or FileName("*.rdb*")
21801.   or FileName("*.dc*")
21802.   or FileName("*.dict*")
21803.   or FileName("*.?db*")
21804.   or FileName("*.?rdb*")
21805.   or FileName("*.md*")
21806.   or FileName("*.myd")
21807.   or FileName("*.ndf")
21808.   or FileName("*.ns?")
21809.   or FileName("*.pab")
21810.   or FileName("*.pst")
21811.   or FileName("*.sd?*")
21812.   or FileName("*.sq**")
21813.   or FileName("*.tmd")
21814.   or FileName("*.tps")
21815.   or FileName("*.tr*")
21816. )
21817. # Databases end.
21818. 
21819. # SystemOtherData
21820. )
21821. # SystemOtherData end.
21822. 
21823. 	# Script: ZoneDoAction
21824. # Zone Do File Action - SortByName.
21825. 
21826. FileActions
21827. 
21828. 	# Footer:
21829. SetVariable(ZoneFooter, "----------------------------------------------------------
21830. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
21831. 
21832. Statistics Report:
21833. ------------------
21834.    Size:  
21835.    ------------------------
21836.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21837.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21838.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21839. 
21840.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21841.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21842. 
21843.    Location:
21844.    ------------------------
21845.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21846.              Files End: !ZoneEndCurrent!
21847.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21848.       
21849.    Gap Settings:
21850.    ------------------------
21851.          Gap Requested: !ZoneGapSizePer!%
21852.       Volume Rounding: !ZoneVolRoundUpPer!%
21853.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21854.                  
21855.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
21856.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
21857.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
21858.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
21859.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
21860.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
21861.      
21862.    Free Space after Zone:
21863.    ------------------------
21864.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21865.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21866.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21867. 
21868. Directory and Files Select:
21869. ---------------------------
21870. !ZoneTypeSelectCurrent!               
21871. ---------------------------
21872. ----------------------------------------------------------
21873. ")
21874. 	SetStatisticsWindowText("!ZoneFooter!")
21875. 	
21876. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
21877. 	# Script: DisplaySetFileStep
21878. 
21879. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21880. 
21881. /* add message and move to a new line. */
21882. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21883. ")
21884. 
21885. /* display the line. (hopefully.) */
21886. # Zone Footer Set Statistics Window Text
21887. 
21888. SetStatisticsWindowText("----------------------------------------------------------
21889. Zones Processed: 
21890. ----------------------------------------------------------
21891. !ZoneListByLine!
21892. ----------------------------------------------------------
21893. Zone Processing Step:
21894. !ZoneStepByLine!    
21895. ----------------------------------------------------------
21896. Current Zone:
21897. !ZoneFooter!
21898. ----------------------------------------------------------
21899. Volume Statistics:
21900. !VolumeStatisticsDetail!
21901. ----------------------------------------------------------
21902. Zone Detailed Report:
21903. ----------------------------------------------------------
21904. !ZoneStatisticsDetail!
21905. ----------------------------------------------------------
21906. ")
21907. 
21908. 
21909. 
21910. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21911. 
21912. # Script: BannerSet
21913. 
21914. # Script: DisplaySetDateTimeRun
21915. 
21916. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
21917. /* Xinclude "..\Display\BannerSet.MyDc"X */
21918. /* pause(1) */
21919. 
21920. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21921. 
21922. Title('!Heading!')
21923. /* pause(1) */
21924. 
21925. /* NOTE: Can't round or truncate to integer precision. */
21926. 
21927. pause(1)
21928. 
21929. # Commands:
21930. 
21931. /* Moves to Zone or above it. */
21932. # MoveUpToZone()
21933. 
21934. # Defrag
21935. 
21936. # Defragment(OPTIONS)
21937. 
21938. /* Shuffles files around trying to make a big enough gap for fragmented files. */
21939. # Defragment()
21940. 
21941. /* Only does files where a gap will fit it. */
21942. # Defragment(Fast)
21943. 
21944. /* Skips fragmented files larger than the Chunck Size.
21945. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
21946. # Defragment(Chunk Size)
21947. 
21948. /* Moves down to zone and packs zone to beginning if there are gaps. */
21949. /* Can be similar in performance to doing a SortBy. */
21950. # MoveDownFill()
21951. 
21952. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
21953. 
21954. 
21955. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
21956. 	# Script: DisplaySetFileStep
21957. 
21958. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21959. 
21960. /* add message and move to a new line. */
21961. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21962. ")
21963. 
21964. /* display the line. (hopefully.) */
21965. # Zone Footer Set Statistics Window Text
21966. 
21967. SetStatisticsWindowText("----------------------------------------------------------
21968. Zones Processed: 
21969. ----------------------------------------------------------
21970. !ZoneListByLine!
21971. ----------------------------------------------------------
21972. Zone Processing Step:
21973. !ZoneStepByLine!    
21974. ----------------------------------------------------------
21975. Current Zone:
21976. !ZoneFooter!
21977. ----------------------------------------------------------
21978. Volume Statistics:
21979. !VolumeStatisticsDetail!
21980. ----------------------------------------------------------
21981. Zone Detailed Report:
21982. ----------------------------------------------------------
21983. !ZoneStatisticsDetail!
21984. ----------------------------------------------------------
21985. ")
21986. 
21987. 
21988. 
21989. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21990. 
21991. # Script: BannerSet
21992. 
21993. # Script: DisplaySetDateTimeRun
21994. 
21995. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
21996. /* Xinclude "..\Display\BannerSet.MyDc"X */
21997. /* pause(1) */
21998. 
21999. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22000. 
22001. Title('!Heading!')
22002. /* pause(1) */
22003. 
22004. /* NOTE: Can't round or truncate to integer precision. */
22005. 
22006. pause(1)
22007. 
22008. 	# Script: ZoneDoFooter
22009. 
22010. /* ---------------------------------------------------------- */
22011. # File Select
22012. 	# Select Statments
22013. # File Actions 
22014. 	# Standard or OS File Actions.
22015. 	# Resume...
22016. 	
22017. 	# your stuff HERE (X)... post zone (file) file actions code.
22018. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
22019. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22020. 		# (X)
22021. 		
22022. 		/* ??? Set window? */
22023. 	
22024. 	# ADD THE GAP
22025. 		
22026. # Vacate (good for diagnostics)
22027. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
22028. 
22029. # DoNotVacate - DO NOT Vacate (recommended)
22030. 
22031. # Vacate
22032. /* AddGap(GapUsedLoc) */
22033. 
22034. # DO Not Vacate
22035. AddGap(GapUsedLoc, DoNotVacate) 
22036. 	
22037. 	
22038. /* ---------------------------------------------------------- */
22039. # (failed) TEST for boolean logic.
22040. 
22041. /* It should work in the gap calculations for turning options */
22042. /* on and off but it will NOT work here. */
22043. 
22044. /* Boolean setting X or FlagX. */
22045. /* Where X will be on or off: */
22046. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
22047. /*      For ON:  (X  *  FlagAny) */
22048. 
22049. /* 1) Failed, zero gap overrode the previous one. */
22050. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
22051. /* AddGap(GapUsedTemp) */ 
22052. 
22053. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
22054. /* AddGap(GapUsedTemp, DoNotVacate) */ 
22055. 
22056. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
22057. 
22058. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
22059. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
22060. /* AddGap(GapUsedTemp) */ 
22061. 
22062. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
22063. /* AddGap(GapUsedTemp, DoNotVacate) */ 
22064. 
22065. /* ---------------------------------------------------------- */
22066. 
22067. # Vacate
22068. /* AddGap(GapUsed) */
22069. 
22070. # DO NOT Vacate (recommended)
22071. /* AddGap(GapUsed, DoNotVacate) */ 
22072. 	
22073. 
22074. 		
22075. # 
22076. FileEnd
22077. /* ---------------------------------------------------------- */
22078. 
22079. # your stuff HERE (X)... post zone (file) code.
22080. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
22081. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22082. 	# (X)
22083. 
22084. SetVariable(FileStepDescription,"Zone finished, reporting.")
22085. # Script: DisplaySetFileStep
22086. 
22087. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22088. 
22089. /* add message and move to a new line. */
22090. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22091. ")
22092. 
22093. /* display the line. (hopefully.) */
22094. # Zone Footer Set Statistics Window Text
22095. 
22096. SetStatisticsWindowText("----------------------------------------------------------
22097. Zones Processed: 
22098. ----------------------------------------------------------
22099. !ZoneListByLine!
22100. ----------------------------------------------------------
22101. Zone Processing Step:
22102. !ZoneStepByLine!    
22103. ----------------------------------------------------------
22104. Current Zone:
22105. !ZoneFooter!
22106. ----------------------------------------------------------
22107. Volume Statistics:
22108. !VolumeStatisticsDetail!
22109. ----------------------------------------------------------
22110. Zone Detailed Report:
22111. ----------------------------------------------------------
22112. !ZoneStatisticsDetail!
22113. ----------------------------------------------------------
22114. ")
22115. 
22116. 
22117. 
22118. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22119. 
22120. # Script: BannerSet
22121. 
22122. # Script: DisplaySetDateTimeRun
22123. 
22124. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
22125. /* Xinclude "..\Display\BannerSet.MyDc"X */
22126. /* pause(1) */
22127. 
22128. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22129. 
22130. Title('!Heading!')
22131. /* pause(1) */
22132. 
22133. /* NOTE: Can't round or truncate to integer precision. */
22134. 
22135. pause(1)
22136. 
22137. # Script: ZoneWhenFinished
22138. 
22139. # Script: BannerSet
22140. 
22141. # Script: DisplaySetDateTimeRun
22142. 
22143. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
22144. /* Xinclude "..\Display\BannerSet.MyDc"X */
22145. /* pause(1) */
22146. 
22147. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22148. 
22149. Title('!Heading!')
22150. /* pause(1) */
22151. 
22152. /* NOTE: Can't round or truncate to integer precision. */
22153. 
22154. # Script: BannerLog
22155. 
22156. AppendLogfile("!LogFileName!", "!Title!")
22157. 
22158. 
22159. 
22160. # Zone Statistics	
22161. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
22162. 
22163. # Footer:
22164. SetVariable(ZoneFooter, "----------------------------------------------------------
22165. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
22166. 
22167. Statistics Report:
22168. ------------------
22169.    Size:  
22170.    ------------------------
22171.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22172.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22173.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22174. 
22175.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22176.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22177. 
22178.    Location:
22179.    ------------------------
22180.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22181.              Files End: !ZoneEndCurrent!
22182.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22183.       
22184.    Gap Settings:
22185.    ------------------------
22186.          Gap Requested: !ZoneGapSizePer!%
22187.       Volume Rounding: !ZoneVolRoundUpPer!%
22188.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22189.                  
22190.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22191.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22192.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22193.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22194.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22195.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22196.      
22197.    Free Space after Zone:
22198.    ------------------------
22199.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22200.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22201.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22202. 
22203. Directory and Files Select:
22204. ---------------------------
22205. !ZoneTypeSelectCurrent!               
22206. ---------------------------
22207. ----------------------------------------------------------
22208. ")
22209. 
22210. AppendLogfile("!LogFileName!", ".")
22211. AppendLogfile("!LogFileName!", "!ZoneFooter!")
22212. AppendLogfile("!LogFileName!", ".")
22213. 
22214. # Zone Footer Set Statistics Window Text
22215. 
22216. SetStatisticsWindowText("----------------------------------------------------------
22217. Zones Processed: 
22218. ----------------------------------------------------------
22219. !ZoneListByLine!
22220. ----------------------------------------------------------
22221. Zone Processing Step:
22222. !ZoneStepByLine!    
22223. ----------------------------------------------------------
22224. Current Zone:
22225. !ZoneFooter!
22226. ----------------------------------------------------------
22227. Volume Statistics:
22228. !VolumeStatisticsDetail!
22229. ----------------------------------------------------------
22230. Zone Detailed Report:
22231. ----------------------------------------------------------
22232. !ZoneStatisticsDetail!
22233. ----------------------------------------------------------
22234. ")
22235. 
22236. 
22237. 
22238. /* pause() */
22239. /* pause() */
22240. 
22241. 
22242. 
22243. 
22244. /* ---------------------------------------------------------- */
22245. 
22246. 
22247. /* ---------------------------------------------------------- */
22248. /* Zone Reference & World */
22249. # Script: DefragZoneTypeReference
22250. /* ---------------------------------------------------------- */
22251. /* Zone Reference & World */
22252. SetVariable(ZoneLabel, "!ZoneLabelReference!")
22253. SetVariable(ZoneDescription, "!ZoneDescriptionReference!")
22254. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpReference!")
22255. SetVariable(ZoneGapSize, "!ZoneGapSizeReference!")
22256. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectReference
22257. # Reference start.
22258. # NotBlobsArchivesBu start.
22259. (not (
22260. # Blobs start.
22261. (
22262. # BlobsAndExceptions start.
22263. ( not(
22264.   FileName("*.bat")
22265.   or FileName("*.css")
22266.   or FileName("*.dll")
22267.   or FileName("*.exe")
22268.   or FileName("*.htm*")
22269.   or FileName("*.jar")
22270.   or FileName("*.js")
22271.   or FileName("*.script")
22272.   or FileName("*.wsf")
22273.   or (
22274. # Databases start.
22275. (
22276.   FileName("*.crypt*")
22277.   or FileName("*.db*")
22278.   or FileName("*.rdb*")
22279.   or FileName("*.dc*")
22280.   or FileName("*.dict*")
22281.   or FileName("*.?db*")
22282.   or FileName("*.?rdb*")
22283.   or FileName("*.md*")
22284.   or FileName("*.myd")
22285.   or FileName("*.ndf")
22286.   or FileName("*.ns?")
22287.   or FileName("*.pab")
22288.   or FileName("*.pst")
22289.   or FileName("*.sd?*")
22290.   or FileName("*.sq**")
22291.   or FileName("*.tmd")
22292.   or FileName("*.tps")
22293.   or FileName("*.tr*")
22294. )
22295. # Databases end.
22296. 
22297.     # BlobsAndExceptions
22298.     or 
22299. # Data start.
22300. (
22301.   DirectoryName("Data*")
22302.   or DirectoryName("Device*")
22303.   or DirectoryName("Export*")
22304.   or DirectoryName("Import*")
22305.   or DirectoryName("Log*")
22306.   or DirectoryName("*Log")
22307.   or DirectoryName("Maintenance*")
22308.   or DirectoryName("Rec*")
22309.   or DirectoryName("Sales*")
22310.   or DirectoryName("Search*")
22311.   or DirectoryName("User*")
22312. )
22313. # Data end.
22314. 
22315.     # BlobsAndExceptions
22316.   )
22317. ) )
22318. # BlobsAndExceptions end.
22319. 
22320. # Blobs
22321. ) and (
22322.   Size(BlobFileSize,0)
22323.   or (
22324.     FileName("*.arj")
22325.     or FileName("*.bup")
22326.     or FileName("*.bz2")
22327.     or FileName("*.chm")
22328.     or FileName("*.dvr-ms")
22329.     or FileName("*.gz")
22330.     or FileName("*.ifo")
22331.     or FileName("*.lzh")
22332.     or FileName("*.pdf")
22333.     or FileName("*.rpm")
22334.     or FileName("*.wmv")
22335.     or FileName("*.vob")
22336.     or FileName("*.z")
22337.   ) 
22338. )
22339. # Blobs end.
22340. 
22341. # NotBlobsArchivesBu
22342. or 
22343. # Archives start.
22344. (
22345.   DirectoryName("*Archive*")
22346.   or DirectoryName("*History*")
22347.   or DirectoryName("*Old")
22348.   or DirectoryName("* Old *")
22349.   or DirectoryName("Old *")
22350. 
22351.   or FileName("*.7z")
22352.   or FileName("*.cab")
22353.   or FileName("*.iso")
22354.   or FileName("*.msi")
22355.   or FileName("*.old")
22356.   or FileName("*.rar")
22357.   or FileName("*.tar")
22358.   or FileName("*.zip")
22359.   or
22360. # WinSysLow start.
22361. (
22362.   DirectoryName("$*")
22363.   or DirectoryName("0*")
22364.   or DirectoryName("1*")
22365.   or DirectoryName("2*")
22366.   or DirectoryName("3*")
22367.   or DirectoryName("4*")
22368.   or DirectoryName("5*")
22369.   or DirectoryName("6*")
22370.   or DirectoryName("7*")
22371.   or DirectoryName("8*")
22372.   or DirectoryName("9*")
22373. 
22374.   or DirectoryName("dllcache")
22375.   or DirectoryName("Downloaded Installations")
22376.   or DirectoryName("Ehome")
22377.   or DirectoryName("Fonts")
22378.   or DirectoryName("Help")
22379.   or DirectoryName("I386")
22380.   or DirectoryName("ie?updates")
22381.   or DirectoryName("Installer")
22382.   or DirectoryName("Installshield Installation Information")
22383.   or DirectoryName("IME")
22384.   or DirectoryName("*RECYCLE*")
22385.   or DirectoryName("ServicePackFiles")
22386.   or DirectoryName("SoftwareDistribution")
22387.   or DirectoryName("Speech")
22388.   or DirectoryName("Symbols")
22389.   or DirectoryName("System Volume Information")
22390.   or DirectoryName("windows.old")
22391. )
22392. # WinSysLow end.
22393. 
22394.   # Archives
22395. )
22396. # Archives end.
22397. 
22398. # NotBlobsArchivesBu
22399. or
22400. # Backups start.
22401. (
22402.   DirectoryName("*Backup*")
22403.   or DirectoryName("*Bu")
22404.   or DirectoryName("* Bu *")
22405.   or DirectoryName("Bu *")
22406. 
22407.   or FileName("*.bak")
22408.   or FileName("* - Copy*")
22409. )
22410. # Backups end.
22411. 
22412. # NotBlobsArchivesBu
22413. ) )
22414. # NotBlobsArchivesBu end.
22415. 
22416. # Reference
22417. and (
22418. # Reference start.
22419. (
22420.   DirectoryName("World*") or
22421.   DirectoryName("Education*") or
22422.   DirectoryName("Entertainment*") or
22423.   DirectoryName("Food*") or
22424.   DirectoryName("Geography*") or
22425.   DirectoryName("Help*") or
22426.   DirectoryName("Humo*") or
22427.   DirectoryName("Internet*") or
22428.   DirectoryName("Legal*") or
22429.   DirectoryName("Linquistics*") or
22430.   DirectoryName("Media*") or
22431.   DirectoryName("Multimedia*") or
22432.   DirectoryName("Reference*") or
22433.   DirectoryName("Sales*") or
22434.   DirectoryName("Science*") or
22435.   DirectoryName("Social*") or
22436.   DirectoryName("Technology*")
22437. )
22438. # Reference end.
22439. 
22440. # Reference
22441. )
22442. # Reference end.
22443. ')
22444. 
22445. 	# Script: ZoneDoHeader
22446. 
22447. # Script: ZoneWhenStarted
22448. 
22449. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
22450. # Script: DisplaySetZone
22451. 
22452. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
22453. SetVariable(FileStepDescription,	"")
22454. 
22455. SetVariable(ZoneStepByLine, 			"Zone started.
22456. ")
22457. 
22458. # Script: BannerDescriptionSet
22459. 
22460. # Script: BannerSet
22461. 
22462. # Script: DisplaySetDateTimeRun
22463. 
22464. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
22465. /* Xinclude "..\Display\BannerSet.MyDc"X */
22466. /* pause(1) */
22467. 
22468. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22469. 
22470. Title('!Heading!')
22471. /* pause(1) */
22472. 
22473. /* NOTE: Can't round or truncate to integer precision. */
22474. 
22475. # Script: BannerLog
22476. 
22477. AppendLogfile("!LogFileName!", "!Title!")
22478. 
22479. 
22480. 
22481. pause(1)
22482. 
22483. 
22484. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
22485. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
22486. 
22487. SetVariable(ZoneStepNoCurrent, 0)
22488. 
22489. 
22490. # Script: ZoneDoCurrentClear
22491. 
22492. SetVariable(ZoneTypeSelectCurrent, 		"")
22493. 
22494. SetVariable(ZoneBeginCurrent, 			0)
22495. SetVariable(ZoneBeginPerCurrent, 		0)
22496. SetVariable(ZoneEndCurrent, 			0)
22497. SetVariable(ZoneEndPerCurrent, 			0)
22498. 
22499. SetVariable(ZoneSizeCurrent,			0)
22500. SetVariable(ZoneSizePerCurrent,			0)
22501. 
22502. SetVariable(ZoneGapRequestedCurrent,	0)
22503. SetVariable(ZoneGapRoundedCurrent, 		0)
22504. SetVariable(ZoneGapAdjustedCurrent, 	0)
22505. SetVariable(ZoneGapAvailableCurrent, 	0)
22506. SetVariable(ZoneGapCurrent,				0)
22507. SetVariable(ZoneGapUsedCurrent, 		0)
22508. 
22509. SetVariable(ZoneGapActualCurrent, 		0)
22510. SetVariable(ZoneGapActualPerCurrent, 	0)
22511. 
22512. SetVariable(ZoneSizeActual, 			0)
22513. SetVariable(ZoneSizeActualCurrent,		0)
22514. 
22515. SetVariable(ZoneEndActual, 				0)
22516. SetVariable(ZoneEndActualCurrent,		0)			
22517. SetVariable(ZoneSizeActualPerCurrent, 	0)
22518.       
22519. SetVariable(ZoneFilesFolders,			0)
22520. SetVariable(ZoneFilesFoldersPer,		0) 
22521. 
22522. SetVariable(ZoneFragments,				0)
22523. SetVariable(ZoneFragmentsPer,			0) 
22524. 		
22525. SetVariable(ZoneEndActualCurrent, 		0)
22526. SetVariable(ZoneEndActualPerCurrent, 	0)
22527. 
22528. # Gap Calculation Methodology:
22529. 	# Requested
22530. 	SetVariable(GapRequested, 			0) 
22531. 	SetVariable(GapRequestedStd, 		0) 
22532. 	SetVariable(GapRequestedMft, 		0) 
22533. 	SetVariable(GapRequestedOs, 		0) 
22534. 	SetVariable(GapRequestedOriginal, 	0) 
22535. 	
22536. 	# Gap Adjustments
22537. 	SetVariable(GapRounded, 			0)
22538. 	# SetVariable(GapAdjusted, 			0)
22539. 	SetVariable(GapAvailable, 			0)
22540. 	SetVariable(GapCurrent, 			0)
22541. 	SetVariable(GapActual, 				0)
22542. 	SetVariable(GapUsed, 				0)
22543. 	
22544. 	# Gap Adjustments
22545. 	SetVariable(GapRoundedLoc, 			0)
22546. 	# SetVariable(GapAdjustedLoc, 		0)
22547. 	SetVariable(GapAvailableLoc, 		0)
22548. 	SetVariable(GapCurrentLoc, 			0)
22549. 	SetVariable(GapActualLoc,			0)
22550. 	SetVariable(GapUsedLoc,				0)
22551. 	
22552. 	# Space usage
22553. 	SetVariable(ZoneFreePerRequested, 	0)
22554. 	SetVariable(ZoneFreePerUsed, 		0)
22555. 
22556. # Gap Size & Rounding
22557. 	SetVariable(ZoneGapSizePer, 		0)
22558. 	SetVariable(ZoneVolRoundUpPer, 		0)
22559. 	
22560. 	# Free Space
22561. 	SetVariable(ZoneFreeUsedPer, 		0)
22562. 	SetVariable(ZoneFreeRequestedPer, 	0)
22563. 
22564. 
22565. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
22566. 
22567. # Footer:
22568. SetVariable(ZoneFooter, "----------------------------------------------------------
22569. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
22570. 
22571. Statistics Report:
22572. ------------------
22573.    Size:  
22574.    ------------------------
22575.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22576.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22577.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22578. 
22579.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22580.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22581. 
22582.    Location:
22583.    ------------------------
22584.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22585.              Files End: !ZoneEndCurrent!
22586.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22587.       
22588.    Gap Settings:
22589.    ------------------------
22590.          Gap Requested: !ZoneGapSizePer!%
22591.       Volume Rounding: !ZoneVolRoundUpPer!%
22592.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22593.                  
22594.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22595.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22596.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22597.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22598.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22599.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22600.      
22601.    Free Space after Zone:
22602.    ------------------------
22603.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22604.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22605.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22606. 
22607. Directory and Files Select:
22608. ---------------------------
22609. !ZoneTypeSelectCurrent!               
22610. ---------------------------
22611. ----------------------------------------------------------
22612. ")
22613. 
22614. # Script: BannerSet
22615. 
22616. # Script: DisplaySetDateTimeRun
22617. 
22618. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
22619. /* Xinclude "..\Display\BannerSet.MyDc"X */
22620. /* pause(1) */
22621. 
22622. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22623. 
22624. Title('!Heading!')
22625. /* pause(1) */
22626. 
22627. /* NOTE: Can't round or truncate to integer precision. */
22628. 
22629. # Script: BannerLog
22630. 
22631. AppendLogfile("!LogFileName!", "!Title!")
22632. 
22633. 
22634. 
22635. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
22636. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
22637. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:51")
22638. 
22639. SetVariable(ZoneListByLine, "!ZoneListByLine!
22640. Zone: !ZoneNoCurrent! 2021-11-09 18:53:51 0:00:07 !ZoneLabel! !ZoneDescription!")
22641. 
22642. 
22643. /* Fixed Zone Position Handling */
22644. /* Literal number: */
22645. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
22646. /* Percentage of disk: */
22647. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
22648. /* Gap */
22649. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
22650. 
22651. /* ---------------------------------------------------------- */
22652. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
22653. # Script: DisplaySetFileStep
22654. 
22655. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22656. 
22657. /* add message and move to a new line. */
22658. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22659. ")
22660. 
22661. /* display the line. (hopefully.) */
22662. # Zone Footer Set Statistics Window Text
22663. 
22664. SetStatisticsWindowText("----------------------------------------------------------
22665. Zones Processed: 
22666. ----------------------------------------------------------
22667. !ZoneListByLine!
22668. ----------------------------------------------------------
22669. Zone Processing Step:
22670. !ZoneStepByLine!    
22671. ----------------------------------------------------------
22672. Current Zone:
22673. !ZoneFooter!
22674. ----------------------------------------------------------
22675. Volume Statistics:
22676. !VolumeStatisticsDetail!
22677. ----------------------------------------------------------
22678. Zone Detailed Report:
22679. ----------------------------------------------------------
22680. !ZoneStatisticsDetail!
22681. ----------------------------------------------------------
22682. ")
22683. 
22684. 
22685. 
22686. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22687. 
22688. # Script: BannerSet
22689. 
22690. # Script: DisplaySetDateTimeRun
22691. 
22692. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
22693. /* Xinclude "..\Display\BannerSet.MyDc"X */
22694. /* pause(1) */
22695. 
22696. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22697. 
22698. Title('!Heading!')
22699. /* pause(1) */
22700. 
22701. /* NOTE: Can't round or truncate to integer precision. */
22702. 
22703. pause(1)
22704. 
22705. # your stuff HERE (X)... pre file select code.
22706. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
22707. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
22708. 	# (X)
22709. 
22710. FileSelect
22711. 
22712. 	# your stuff can't really go here (errors.)
22713. 	# maybe for some reason I don't know of...
22714. 	
22715. 	# Actions next...
22716. 	# Script: ZoneDo ZoneTypeSelectReference
22717. # Reference start.
22718. # NotBlobsArchivesBu start.
22719. (not (
22720. # Blobs start.
22721. (
22722. # BlobsAndExceptions start.
22723. ( not(
22724.   FileName("*.bat")
22725.   or FileName("*.css")
22726.   or FileName("*.dll")
22727.   or FileName("*.exe")
22728.   or FileName("*.htm*")
22729.   or FileName("*.jar")
22730.   or FileName("*.js")
22731.   or FileName("*.script")
22732.   or FileName("*.wsf")
22733.   or (
22734. # Databases start.
22735. (
22736.   FileName("*.crypt*")
22737.   or FileName("*.db*")
22738.   or FileName("*.rdb*")
22739.   or FileName("*.dc*")
22740.   or FileName("*.dict*")
22741.   or FileName("*.?db*")
22742.   or FileName("*.?rdb*")
22743.   or FileName("*.md*")
22744.   or FileName("*.myd")
22745.   or FileName("*.ndf")
22746.   or FileName("*.ns?")
22747.   or FileName("*.pab")
22748.   or FileName("*.pst")
22749.   or FileName("*.sd?*")
22750.   or FileName("*.sq**")
22751.   or FileName("*.tmd")
22752.   or FileName("*.tps")
22753.   or FileName("*.tr*")
22754. )
22755. # Databases end.
22756. 
22757.     # BlobsAndExceptions
22758.     or 
22759. # Data start.
22760. (
22761.   DirectoryName("Data*")
22762.   or DirectoryName("Device*")
22763.   or DirectoryName("Export*")
22764.   or DirectoryName("Import*")
22765.   or DirectoryName("Log*")
22766.   or DirectoryName("*Log")
22767.   or DirectoryName("Maintenance*")
22768.   or DirectoryName("Rec*")
22769.   or DirectoryName("Sales*")
22770.   or DirectoryName("Search*")
22771.   or DirectoryName("User*")
22772. )
22773. # Data end.
22774. 
22775.     # BlobsAndExceptions
22776.   )
22777. ) )
22778. # BlobsAndExceptions end.
22779. 
22780. # Blobs
22781. ) and (
22782.   Size(BlobFileSize,0)
22783.   or (
22784.     FileName("*.arj")
22785.     or FileName("*.bup")
22786.     or FileName("*.bz2")
22787.     or FileName("*.chm")
22788.     or FileName("*.dvr-ms")
22789.     or FileName("*.gz")
22790.     or FileName("*.ifo")
22791.     or FileName("*.lzh")
22792.     or FileName("*.pdf")
22793.     or FileName("*.rpm")
22794.     or FileName("*.wmv")
22795.     or FileName("*.vob")
22796.     or FileName("*.z")
22797.   ) 
22798. )
22799. # Blobs end.
22800. 
22801. # NotBlobsArchivesBu
22802. or 
22803. # Archives start.
22804. (
22805.   DirectoryName("*Archive*")
22806.   or DirectoryName("*History*")
22807.   or DirectoryName("*Old")
22808.   or DirectoryName("* Old *")
22809.   or DirectoryName("Old *")
22810. 
22811.   or FileName("*.7z")
22812.   or FileName("*.cab")
22813.   or FileName("*.iso")
22814.   or FileName("*.msi")
22815.   or FileName("*.old")
22816.   or FileName("*.rar")
22817.   or FileName("*.tar")
22818.   or FileName("*.zip")
22819.   or
22820. # WinSysLow start.
22821. (
22822.   DirectoryName("$*")
22823.   or DirectoryName("0*")
22824.   or DirectoryName("1*")
22825.   or DirectoryName("2*")
22826.   or DirectoryName("3*")
22827.   or DirectoryName("4*")
22828.   or DirectoryName("5*")
22829.   or DirectoryName("6*")
22830.   or DirectoryName("7*")
22831.   or DirectoryName("8*")
22832.   or DirectoryName("9*")
22833. 
22834.   or DirectoryName("dllcache")
22835.   or DirectoryName("Downloaded Installations")
22836.   or DirectoryName("Ehome")
22837.   or DirectoryName("Fonts")
22838.   or DirectoryName("Help")
22839.   or DirectoryName("I386")
22840.   or DirectoryName("ie?updates")
22841.   or DirectoryName("Installer")
22842.   or DirectoryName("Installshield Installation Information")
22843.   or DirectoryName("IME")
22844.   or DirectoryName("*RECYCLE*")
22845.   or DirectoryName("ServicePackFiles")
22846.   or DirectoryName("SoftwareDistribution")
22847.   or DirectoryName("Speech")
22848.   or DirectoryName("Symbols")
22849.   or DirectoryName("System Volume Information")
22850.   or DirectoryName("windows.old")
22851. )
22852. # WinSysLow end.
22853. 
22854.   # Archives
22855. )
22856. # Archives end.
22857. 
22858. # NotBlobsArchivesBu
22859. or
22860. # Backups start.
22861. (
22862.   DirectoryName("*Backup*")
22863.   or DirectoryName("*Bu")
22864.   or DirectoryName("* Bu *")
22865.   or DirectoryName("Bu *")
22866. 
22867.   or FileName("*.bak")
22868.   or FileName("* - Copy*")
22869. )
22870. # Backups end.
22871. 
22872. # NotBlobsArchivesBu
22873. ) )
22874. # NotBlobsArchivesBu end.
22875. 
22876. # Reference
22877. and (
22878. # Reference start.
22879. (
22880.   DirectoryName("World*") or
22881.   DirectoryName("Education*") or
22882.   DirectoryName("Entertainment*") or
22883.   DirectoryName("Food*") or
22884.   DirectoryName("Geography*") or
22885.   DirectoryName("Help*") or
22886.   DirectoryName("Humo*") or
22887.   DirectoryName("Internet*") or
22888.   DirectoryName("Legal*") or
22889.   DirectoryName("Linquistics*") or
22890.   DirectoryName("Media*") or
22891.   DirectoryName("Multimedia*") or
22892.   DirectoryName("Reference*") or
22893.   DirectoryName("Sales*") or
22894.   DirectoryName("Science*") or
22895.   DirectoryName("Social*") or
22896.   DirectoryName("Technology*")
22897. )
22898. # Reference end.
22899. 
22900. # Reference
22901. )
22902. # Reference end.
22903. 
22904. 	# Script: ZoneDoAction
22905. # Zone Do File Action - SortByName.
22906. 
22907. FileActions
22908. 
22909. 	# Footer:
22910. SetVariable(ZoneFooter, "----------------------------------------------------------
22911. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
22912. 
22913. Statistics Report:
22914. ------------------
22915.    Size:  
22916.    ------------------------
22917.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22918.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22919.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22920. 
22921.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22922.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22923. 
22924.    Location:
22925.    ------------------------
22926.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22927.              Files End: !ZoneEndCurrent!
22928.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22929.       
22930.    Gap Settings:
22931.    ------------------------
22932.          Gap Requested: !ZoneGapSizePer!%
22933.       Volume Rounding: !ZoneVolRoundUpPer!%
22934.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22935.                  
22936.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22937.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22938.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22939.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22940.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22941.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22942.      
22943.    Free Space after Zone:
22944.    ------------------------
22945.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22946.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22947.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22948. 
22949. Directory and Files Select:
22950. ---------------------------
22951. !ZoneTypeSelectCurrent!               
22952. ---------------------------
22953. ----------------------------------------------------------
22954. ")
22955. 	SetStatisticsWindowText("!ZoneFooter!")
22956. 	
22957. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
22958. 	# Script: DisplaySetFileStep
22959. 
22960. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22961. 
22962. /* add message and move to a new line. */
22963. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22964. ")
22965. 
22966. /* display the line. (hopefully.) */
22967. # Zone Footer Set Statistics Window Text
22968. 
22969. SetStatisticsWindowText("----------------------------------------------------------
22970. Zones Processed: 
22971. ----------------------------------------------------------
22972. !ZoneListByLine!
22973. ----------------------------------------------------------
22974. Zone Processing Step:
22975. !ZoneStepByLine!    
22976. ----------------------------------------------------------
22977. Current Zone:
22978. !ZoneFooter!
22979. ----------------------------------------------------------
22980. Volume Statistics:
22981. !VolumeStatisticsDetail!
22982. ----------------------------------------------------------
22983. Zone Detailed Report:
22984. ----------------------------------------------------------
22985. !ZoneStatisticsDetail!
22986. ----------------------------------------------------------
22987. ")
22988. 
22989. 
22990. 
22991. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22992. 
22993. # Script: BannerSet
22994. 
22995. # Script: DisplaySetDateTimeRun
22996. 
22997. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
22998. /* Xinclude "..\Display\BannerSet.MyDc"X */
22999. /* pause(1) */
23000. 
23001. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23002. 
23003. Title('!Heading!')
23004. /* pause(1) */
23005. 
23006. /* NOTE: Can't round or truncate to integer precision. */
23007. 
23008. pause(1)
23009. 
23010. # Commands:
23011. 
23012. /* Moves to Zone or above it. */
23013. # MoveUpToZone()
23014. 
23015. # Defrag
23016. 
23017. # Defragment(OPTIONS)
23018. 
23019. /* Shuffles files around trying to make a big enough gap for fragmented files. */
23020. # Defragment()
23021. 
23022. /* Only does files where a gap will fit it. */
23023. # Defragment(Fast)
23024. 
23025. /* Skips fragmented files larger than the Chunck Size.
23026. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
23027. # Defragment(Chunk Size)
23028. 
23029. /* Moves down to zone and packs zone to beginning if there are gaps. */
23030. /* Can be similar in performance to doing a SortBy. */
23031. # MoveDownFill()
23032. 
23033. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
23034. 
23035. 
23036. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
23037. 	# Script: DisplaySetFileStep
23038. 
23039. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23040. 
23041. /* add message and move to a new line. */
23042. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23043. ")
23044. 
23045. /* display the line. (hopefully.) */
23046. # Zone Footer Set Statistics Window Text
23047. 
23048. SetStatisticsWindowText("----------------------------------------------------------
23049. Zones Processed: 
23050. ----------------------------------------------------------
23051. !ZoneListByLine!
23052. ----------------------------------------------------------
23053. Zone Processing Step:
23054. !ZoneStepByLine!    
23055. ----------------------------------------------------------
23056. Current Zone:
23057. !ZoneFooter!
23058. ----------------------------------------------------------
23059. Volume Statistics:
23060. !VolumeStatisticsDetail!
23061. ----------------------------------------------------------
23062. Zone Detailed Report:
23063. ----------------------------------------------------------
23064. !ZoneStatisticsDetail!
23065. ----------------------------------------------------------
23066. ")
23067. 
23068. 
23069. 
23070. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23071. 
23072. # Script: BannerSet
23073. 
23074. # Script: DisplaySetDateTimeRun
23075. 
23076. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
23077. /* Xinclude "..\Display\BannerSet.MyDc"X */
23078. /* pause(1) */
23079. 
23080. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23081. 
23082. Title('!Heading!')
23083. /* pause(1) */
23084. 
23085. /* NOTE: Can't round or truncate to integer precision. */
23086. 
23087. pause(1)
23088. 
23089. 	# Script: ZoneDoFooter
23090. 
23091. /* ---------------------------------------------------------- */
23092. # File Select
23093. 	# Select Statments
23094. # File Actions 
23095. 	# Standard or OS File Actions.
23096. 	# Resume...
23097. 	
23098. 	# your stuff HERE (X)... post zone (file) file actions code.
23099. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
23100. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
23101. 		# (X)
23102. 		
23103. 		/* ??? Set window? */
23104. 	
23105. 	# ADD THE GAP
23106. 		
23107. # Vacate (good for diagnostics)
23108. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
23109. 
23110. # DoNotVacate - DO NOT Vacate (recommended)
23111. 
23112. # Vacate
23113. /* AddGap(GapUsedLoc) */
23114. 
23115. # DO Not Vacate
23116. AddGap(GapUsedLoc, DoNotVacate) 
23117. 	
23118. 	
23119. /* ---------------------------------------------------------- */
23120. # (failed) TEST for boolean logic.
23121. 
23122. /* It should work in the gap calculations for turning options */
23123. /* on and off but it will NOT work here. */
23124. 
23125. /* Boolean setting X or FlagX. */
23126. /* Where X will be on or off: */
23127. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
23128. /*      For ON:  (X  *  FlagAny) */
23129. 
23130. /* 1) Failed, zero gap overrode the previous one. */
23131. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
23132. /* AddGap(GapUsedTemp) */ 
23133. 
23134. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
23135. /* AddGap(GapUsedTemp, DoNotVacate) */ 
23136. 
23137. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
23138. 
23139. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
23140. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
23141. /* AddGap(GapUsedTemp) */ 
23142. 
23143. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
23144. /* AddGap(GapUsedTemp, DoNotVacate) */ 
23145. 
23146. /* ---------------------------------------------------------- */
23147. 
23148. # Vacate
23149. /* AddGap(GapUsed) */
23150. 
23151. # DO NOT Vacate (recommended)
23152. /* AddGap(GapUsed, DoNotVacate) */ 
23153. 	
23154. 
23155. 		
23156. # 
23157. FileEnd
23158. /* ---------------------------------------------------------- */
23159. 
23160. # your stuff HERE (X)... post zone (file) code.
23161. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
23162. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
23163. 	# (X)
23164. 
23165. SetVariable(FileStepDescription,"Zone finished, reporting.")
23166. # Script: DisplaySetFileStep
23167. 
23168. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23169. 
23170. /* add message and move to a new line. */
23171. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23172. ")
23173. 
23174. /* display the line. (hopefully.) */
23175. # Zone Footer Set Statistics Window Text
23176. 
23177. SetStatisticsWindowText("----------------------------------------------------------
23178. Zones Processed: 
23179. ----------------------------------------------------------
23180. !ZoneListByLine!
23181. ----------------------------------------------------------
23182. Zone Processing Step:
23183. !ZoneStepByLine!    
23184. ----------------------------------------------------------
23185. Current Zone:
23186. !ZoneFooter!
23187. ----------------------------------------------------------
23188. Volume Statistics:
23189. !VolumeStatisticsDetail!
23190. ----------------------------------------------------------
23191. Zone Detailed Report:
23192. ----------------------------------------------------------
23193. !ZoneStatisticsDetail!
23194. ----------------------------------------------------------
23195. ")
23196. 
23197. 
23198. 
23199. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23200. 
23201. # Script: BannerSet
23202. 
23203. # Script: DisplaySetDateTimeRun
23204. 
23205. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
23206. /* Xinclude "..\Display\BannerSet.MyDc"X */
23207. /* pause(1) */
23208. 
23209. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23210. 
23211. Title('!Heading!')
23212. /* pause(1) */
23213. 
23214. /* NOTE: Can't round or truncate to integer precision. */
23215. 
23216. pause(1)
23217. 
23218. # Script: ZoneWhenFinished
23219. 
23220. # Script: BannerSet
23221. 
23222. # Script: DisplaySetDateTimeRun
23223. 
23224. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
23225. /* Xinclude "..\Display\BannerSet.MyDc"X */
23226. /* pause(1) */
23227. 
23228. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23229. 
23230. Title('!Heading!')
23231. /* pause(1) */
23232. 
23233. /* NOTE: Can't round or truncate to integer precision. */
23234. 
23235. # Script: BannerLog
23236. 
23237. AppendLogfile("!LogFileName!", "!Title!")
23238. 
23239. 
23240. 
23241. # Zone Statistics	
23242. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
23243. 
23244. # Footer:
23245. SetVariable(ZoneFooter, "----------------------------------------------------------
23246. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
23247. 
23248. Statistics Report:
23249. ------------------
23250.    Size:  
23251.    ------------------------
23252.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23253.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23254.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23255. 
23256.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23257.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23258. 
23259.    Location:
23260.    ------------------------
23261.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23262.              Files End: !ZoneEndCurrent!
23263.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23264.       
23265.    Gap Settings:
23266.    ------------------------
23267.          Gap Requested: !ZoneGapSizePer!%
23268.       Volume Rounding: !ZoneVolRoundUpPer!%
23269.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23270.                  
23271.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
23272.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
23273.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
23274.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
23275.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
23276.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
23277.      
23278.    Free Space after Zone:
23279.    ------------------------
23280.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23281.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23282.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23283. 
23284. Directory and Files Select:
23285. ---------------------------
23286. !ZoneTypeSelectCurrent!               
23287. ---------------------------
23288. ----------------------------------------------------------
23289. ")
23290. 
23291. AppendLogfile("!LogFileName!", ".")
23292. AppendLogfile("!LogFileName!", "!ZoneFooter!")
23293. AppendLogfile("!LogFileName!", ".")
23294. 
23295. # Zone Footer Set Statistics Window Text
23296. 
23297. SetStatisticsWindowText("----------------------------------------------------------
23298. Zones Processed: 
23299. ----------------------------------------------------------
23300. !ZoneListByLine!
23301. ----------------------------------------------------------
23302. Zone Processing Step:
23303. !ZoneStepByLine!    
23304. ----------------------------------------------------------
23305. Current Zone:
23306. !ZoneFooter!
23307. ----------------------------------------------------------
23308. Volume Statistics:
23309. !VolumeStatisticsDetail!
23310. ----------------------------------------------------------
23311. Zone Detailed Report:
23312. ----------------------------------------------------------
23313. !ZoneStatisticsDetail!
23314. ----------------------------------------------------------
23315. ")
23316. 
23317. 
23318. 
23319. /* pause() */
23320. /* pause() */
23321. 
23322. 
23323. 
23324. 
23325. /* ---------------------------------------------------------- */
23326. 
23327. 
23328. /* ---------------------------------------------------------- */
23329. /* Zone SpaceHogs (BLOBS) */
23330. # Script: DefragZoneTypeSpaceHogs
23331. /* ---------------------------------------------------------- */
23332. /* Zone SpaceHogs (BLOBS) */
23333. SetVariable(ZoneLabel, "!ZoneLabelSpaceHogs!")
23334. SetVariable(ZoneDescription, "!ZoneDescriptionSpaceHogs!")
23335. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSpaceHogs!")
23336. SetVariable(ZoneGapSize, "!ZoneGapSizeSpaceHogs!")
23337. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectSpaceHogs
23338. # SpaceHogs start.
23339. not(
23340. # Archives start.
23341. (
23342.   DirectoryName("*Archive*")
23343.   or DirectoryName("*History*")
23344.   or DirectoryName("*Old")
23345.   or DirectoryName("* Old *")
23346.   or DirectoryName("Old *")
23347. 
23348.   or FileName("*.7z")
23349.   or FileName("*.cab")
23350.   or FileName("*.iso")
23351.   or FileName("*.msi")
23352.   or FileName("*.old")
23353.   or FileName("*.rar")
23354.   or FileName("*.tar")
23355.   or FileName("*.zip")
23356.   or
23357. # WinSysLow start.
23358. (
23359.   DirectoryName("$*")
23360.   or DirectoryName("0*")
23361.   or DirectoryName("1*")
23362.   or DirectoryName("2*")
23363.   or DirectoryName("3*")
23364.   or DirectoryName("4*")
23365.   or DirectoryName("5*")
23366.   or DirectoryName("6*")
23367.   or DirectoryName("7*")
23368.   or DirectoryName("8*")
23369.   or DirectoryName("9*")
23370. 
23371.   or DirectoryName("dllcache")
23372.   or DirectoryName("Downloaded Installations")
23373.   or DirectoryName("Ehome")
23374.   or DirectoryName("Fonts")
23375.   or DirectoryName("Help")
23376.   or DirectoryName("I386")
23377.   or DirectoryName("ie?updates")
23378.   or DirectoryName("Installer")
23379.   or DirectoryName("Installshield Installation Information")
23380.   or DirectoryName("IME")
23381.   or DirectoryName("*RECYCLE*")
23382.   or DirectoryName("ServicePackFiles")
23383.   or DirectoryName("SoftwareDistribution")
23384.   or DirectoryName("Speech")
23385.   or DirectoryName("Symbols")
23386.   or DirectoryName("System Volume Information")
23387.   or DirectoryName("windows.old")
23388. )
23389. # WinSysLow end.
23390. 
23391.   # Archives
23392. )
23393. # Archives end.
23394. 
23395. or 
23396. # Backups start.
23397. (
23398.   DirectoryName("*Backup*")
23399.   or DirectoryName("*Bu")
23400.   or DirectoryName("* Bu *")
23401.   or DirectoryName("Bu *")
23402. 
23403.   or FileName("*.bak")
23404.   or FileName("* - Copy*")
23405. )
23406. # Backups end.
23407. 
23408. # SpaceHogs
23409. ) and (
23410. # Blobs start.
23411. (
23412. # BlobsAndExceptions start.
23413. ( not(
23414.   FileName("*.bat")
23415.   or FileName("*.css")
23416.   or FileName("*.dll")
23417.   or FileName("*.exe")
23418.   or FileName("*.htm*")
23419.   or FileName("*.jar")
23420.   or FileName("*.js")
23421.   or FileName("*.script")
23422.   or FileName("*.wsf")
23423.   or (
23424. # Databases start.
23425. (
23426.   FileName("*.crypt*")
23427.   or FileName("*.db*")
23428.   or FileName("*.rdb*")
23429.   or FileName("*.dc*")
23430.   or FileName("*.dict*")
23431.   or FileName("*.?db*")
23432.   or FileName("*.?rdb*")
23433.   or FileName("*.md*")
23434.   or FileName("*.myd")
23435.   or FileName("*.ndf")
23436.   or FileName("*.ns?")
23437.   or FileName("*.pab")
23438.   or FileName("*.pst")
23439.   or FileName("*.sd?*")
23440.   or FileName("*.sq**")
23441.   or FileName("*.tmd")
23442.   or FileName("*.tps")
23443.   or FileName("*.tr*")
23444. )
23445. # Databases end.
23446. 
23447.     # BlobsAndExceptions
23448.     or 
23449. # Data start.
23450. (
23451.   DirectoryName("Data*")
23452.   or DirectoryName("Device*")
23453.   or DirectoryName("Export*")
23454.   or DirectoryName("Import*")
23455.   or DirectoryName("Log*")
23456.   or DirectoryName("*Log")
23457.   or DirectoryName("Maintenance*")
23458.   or DirectoryName("Rec*")
23459.   or DirectoryName("Sales*")
23460.   or DirectoryName("Search*")
23461.   or DirectoryName("User*")
23462. )
23463. # Data end.
23464. 
23465.     # BlobsAndExceptions
23466.   )
23467. ) )
23468. # BlobsAndExceptions end.
23469. 
23470. # Blobs
23471. ) and (
23472.   Size(BlobFileSize,0)
23473.   or (
23474.     FileName("*.arj")
23475.     or FileName("*.bup")
23476.     or FileName("*.bz2")
23477.     or FileName("*.chm")
23478.     or FileName("*.dvr-ms")
23479.     or FileName("*.gz")
23480.     or FileName("*.ifo")
23481.     or FileName("*.lzh")
23482.     or FileName("*.pdf")
23483.     or FileName("*.rpm")
23484.     or FileName("*.wmv")
23485.     or FileName("*.vob")
23486.     or FileName("*.z")
23487.   ) 
23488. )
23489. # Blobs end.
23490. 
23491. # SpaceHogs
23492. ) 
23493. # SpaceHogs end.
23494. ')
23495. 
23496. /* Note: This should be all Blob Files but not archives and backups */
23497. /* It does not matter in my case because given the sorting the */
23498. /* "z Archive", "z Bu" and "z Backup" directories sort to the end. */
23499. 
23500. 	# Script: ZoneDoHeader
23501. 
23502. # Script: ZoneWhenStarted
23503. 
23504. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
23505. # Script: DisplaySetZone
23506. 
23507. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
23508. SetVariable(FileStepDescription,	"")
23509. 
23510. SetVariable(ZoneStepByLine, 			"Zone started.
23511. ")
23512. 
23513. # Script: BannerDescriptionSet
23514. 
23515. # Script: BannerSet
23516. 
23517. # Script: DisplaySetDateTimeRun
23518. 
23519. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
23520. /* Xinclude "..\Display\BannerSet.MyDc"X */
23521. /* pause(1) */
23522. 
23523. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23524. 
23525. Title('!Heading!')
23526. /* pause(1) */
23527. 
23528. /* NOTE: Can't round or truncate to integer precision. */
23529. 
23530. # Script: BannerLog
23531. 
23532. AppendLogfile("!LogFileName!", "!Title!")
23533. 
23534. 
23535. 
23536. pause(1)
23537. 
23538. 
23539. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
23540. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
23541. 
23542. SetVariable(ZoneStepNoCurrent, 0)
23543. 
23544. 
23545. # Script: ZoneDoCurrentClear
23546. 
23547. SetVariable(ZoneTypeSelectCurrent, 		"")
23548. 
23549. SetVariable(ZoneBeginCurrent, 			0)
23550. SetVariable(ZoneBeginPerCurrent, 		0)
23551. SetVariable(ZoneEndCurrent, 			0)
23552. SetVariable(ZoneEndPerCurrent, 			0)
23553. 
23554. SetVariable(ZoneSizeCurrent,			0)
23555. SetVariable(ZoneSizePerCurrent,			0)
23556. 
23557. SetVariable(ZoneGapRequestedCurrent,	0)
23558. SetVariable(ZoneGapRoundedCurrent, 		0)
23559. SetVariable(ZoneGapAdjustedCurrent, 	0)
23560. SetVariable(ZoneGapAvailableCurrent, 	0)
23561. SetVariable(ZoneGapCurrent,				0)
23562. SetVariable(ZoneGapUsedCurrent, 		0)
23563. 
23564. SetVariable(ZoneGapActualCurrent, 		0)
23565. SetVariable(ZoneGapActualPerCurrent, 	0)
23566. 
23567. SetVariable(ZoneSizeActual, 			0)
23568. SetVariable(ZoneSizeActualCurrent,		0)
23569. 
23570. SetVariable(ZoneEndActual, 				0)
23571. SetVariable(ZoneEndActualCurrent,		0)			
23572. SetVariable(ZoneSizeActualPerCurrent, 	0)
23573.       
23574. SetVariable(ZoneFilesFolders,			0)
23575. SetVariable(ZoneFilesFoldersPer,		0) 
23576. 
23577. SetVariable(ZoneFragments,				0)
23578. SetVariable(ZoneFragmentsPer,			0) 
23579. 		
23580. SetVariable(ZoneEndActualCurrent, 		0)
23581. SetVariable(ZoneEndActualPerCurrent, 	0)
23582. 
23583. # Gap Calculation Methodology:
23584. 	# Requested
23585. 	SetVariable(GapRequested, 			0) 
23586. 	SetVariable(GapRequestedStd, 		0) 
23587. 	SetVariable(GapRequestedMft, 		0) 
23588. 	SetVariable(GapRequestedOs, 		0) 
23589. 	SetVariable(GapRequestedOriginal, 	0) 
23590. 	
23591. 	# Gap Adjustments
23592. 	SetVariable(GapRounded, 			0)
23593. 	# SetVariable(GapAdjusted, 			0)
23594. 	SetVariable(GapAvailable, 			0)
23595. 	SetVariable(GapCurrent, 			0)
23596. 	SetVariable(GapActual, 				0)
23597. 	SetVariable(GapUsed, 				0)
23598. 	
23599. 	# Gap Adjustments
23600. 	SetVariable(GapRoundedLoc, 			0)
23601. 	# SetVariable(GapAdjustedLoc, 		0)
23602. 	SetVariable(GapAvailableLoc, 		0)
23603. 	SetVariable(GapCurrentLoc, 			0)
23604. 	SetVariable(GapActualLoc,			0)
23605. 	SetVariable(GapUsedLoc,				0)
23606. 	
23607. 	# Space usage
23608. 	SetVariable(ZoneFreePerRequested, 	0)
23609. 	SetVariable(ZoneFreePerUsed, 		0)
23610. 
23611. # Gap Size & Rounding
23612. 	SetVariable(ZoneGapSizePer, 		0)
23613. 	SetVariable(ZoneVolRoundUpPer, 		0)
23614. 	
23615. 	# Free Space
23616. 	SetVariable(ZoneFreeUsedPer, 		0)
23617. 	SetVariable(ZoneFreeRequestedPer, 	0)
23618. 
23619. 
23620. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
23621. 
23622. # Footer:
23623. SetVariable(ZoneFooter, "----------------------------------------------------------
23624. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
23625. 
23626. Statistics Report:
23627. ------------------
23628.    Size:  
23629.    ------------------------
23630.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23631.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23632.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23633. 
23634.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23635.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23636. 
23637.    Location:
23638.    ------------------------
23639.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23640.              Files End: !ZoneEndCurrent!
23641.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23642.       
23643.    Gap Settings:
23644.    ------------------------
23645.          Gap Requested: !ZoneGapSizePer!%
23646.       Volume Rounding: !ZoneVolRoundUpPer!%
23647.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23648.                  
23649.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
23650.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
23651.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
23652.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
23653.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
23654.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
23655.      
23656.    Free Space after Zone:
23657.    ------------------------
23658.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23659.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23660.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23661. 
23662. Directory and Files Select:
23663. ---------------------------
23664. !ZoneTypeSelectCurrent!               
23665. ---------------------------
23666. ----------------------------------------------------------
23667. ")
23668. 
23669. # Script: BannerSet
23670. 
23671. # Script: DisplaySetDateTimeRun
23672. 
23673. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
23674. /* Xinclude "..\Display\BannerSet.MyDc"X */
23675. /* pause(1) */
23676. 
23677. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23678. 
23679. Title('!Heading!')
23680. /* pause(1) */
23681. 
23682. /* NOTE: Can't round or truncate to integer precision. */
23683. 
23684. # Script: BannerLog
23685. 
23686. AppendLogfile("!LogFileName!", "!Title!")
23687. 
23688. 
23689. 
23690. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
23691. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
23692. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:51")
23693. 
23694. SetVariable(ZoneListByLine, "!ZoneListByLine!
23695. Zone: !ZoneNoCurrent! 2021-11-09 18:53:51 0:00:07 !ZoneLabel! !ZoneDescription!")
23696. 
23697. 
23698. /* Fixed Zone Position Handling */
23699. /* Literal number: */
23700. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
23701. /* Percentage of disk: */
23702. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
23703. /* Gap */
23704. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
23705. 
23706. /* ---------------------------------------------------------- */
23707. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
23708. # Script: DisplaySetFileStep
23709. 
23710. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23711. 
23712. /* add message and move to a new line. */
23713. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23714. ")
23715. 
23716. /* display the line. (hopefully.) */
23717. # Zone Footer Set Statistics Window Text
23718. 
23719. SetStatisticsWindowText("----------------------------------------------------------
23720. Zones Processed: 
23721. ----------------------------------------------------------
23722. !ZoneListByLine!
23723. ----------------------------------------------------------
23724. Zone Processing Step:
23725. !ZoneStepByLine!    
23726. ----------------------------------------------------------
23727. Current Zone:
23728. !ZoneFooter!
23729. ----------------------------------------------------------
23730. Volume Statistics:
23731. !VolumeStatisticsDetail!
23732. ----------------------------------------------------------
23733. Zone Detailed Report:
23734. ----------------------------------------------------------
23735. !ZoneStatisticsDetail!
23736. ----------------------------------------------------------
23737. ")
23738. 
23739. 
23740. 
23741. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23742. 
23743. # Script: BannerSet
23744. 
23745. # Script: DisplaySetDateTimeRun
23746. 
23747. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
23748. /* Xinclude "..\Display\BannerSet.MyDc"X */
23749. /* pause(1) */
23750. 
23751. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23752. 
23753. Title('!Heading!')
23754. /* pause(1) */
23755. 
23756. /* NOTE: Can't round or truncate to integer precision. */
23757. 
23758. pause(1)
23759. 
23760. # your stuff HERE (X)... pre file select code.
23761. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
23762. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
23763. 	# (X)
23764. 
23765. FileSelect
23766. 
23767. 	# your stuff can't really go here (errors.)
23768. 	# maybe for some reason I don't know of...
23769. 	
23770. 	# Actions next...
23771. 	# Script: ZoneDo ZoneTypeSelectSpaceHogs
23772. # SpaceHogs start.
23773. not(
23774. # Archives start.
23775. (
23776.   DirectoryName("*Archive*")
23777.   or DirectoryName("*History*")
23778.   or DirectoryName("*Old")
23779.   or DirectoryName("* Old *")
23780.   or DirectoryName("Old *")
23781. 
23782.   or FileName("*.7z")
23783.   or FileName("*.cab")
23784.   or FileName("*.iso")
23785.   or FileName("*.msi")
23786.   or FileName("*.old")
23787.   or FileName("*.rar")
23788.   or FileName("*.tar")
23789.   or FileName("*.zip")
23790.   or
23791. # WinSysLow start.
23792. (
23793.   DirectoryName("$*")
23794.   or DirectoryName("0*")
23795.   or DirectoryName("1*")
23796.   or DirectoryName("2*")
23797.   or DirectoryName("3*")
23798.   or DirectoryName("4*")
23799.   or DirectoryName("5*")
23800.   or DirectoryName("6*")
23801.   or DirectoryName("7*")
23802.   or DirectoryName("8*")
23803.   or DirectoryName("9*")
23804. 
23805.   or DirectoryName("dllcache")
23806.   or DirectoryName("Downloaded Installations")
23807.   or DirectoryName("Ehome")
23808.   or DirectoryName("Fonts")
23809.   or DirectoryName("Help")
23810.   or DirectoryName("I386")
23811.   or DirectoryName("ie?updates")
23812.   or DirectoryName("Installer")
23813.   or DirectoryName("Installshield Installation Information")
23814.   or DirectoryName("IME")
23815.   or DirectoryName("*RECYCLE*")
23816.   or DirectoryName("ServicePackFiles")
23817.   or DirectoryName("SoftwareDistribution")
23818.   or DirectoryName("Speech")
23819.   or DirectoryName("Symbols")
23820.   or DirectoryName("System Volume Information")
23821.   or DirectoryName("windows.old")
23822. )
23823. # WinSysLow end.
23824. 
23825.   # Archives
23826. )
23827. # Archives end.
23828. 
23829. or 
23830. # Backups start.
23831. (
23832.   DirectoryName("*Backup*")
23833.   or DirectoryName("*Bu")
23834.   or DirectoryName("* Bu *")
23835.   or DirectoryName("Bu *")
23836. 
23837.   or FileName("*.bak")
23838.   or FileName("* - Copy*")
23839. )
23840. # Backups end.
23841. 
23842. # SpaceHogs
23843. ) and (
23844. # Blobs start.
23845. (
23846. # BlobsAndExceptions start.
23847. ( not(
23848.   FileName("*.bat")
23849.   or FileName("*.css")
23850.   or FileName("*.dll")
23851.   or FileName("*.exe")
23852.   or FileName("*.htm*")
23853.   or FileName("*.jar")
23854.   or FileName("*.js")
23855.   or FileName("*.script")
23856.   or FileName("*.wsf")
23857.   or (
23858. # Databases start.
23859. (
23860.   FileName("*.crypt*")
23861.   or FileName("*.db*")
23862.   or FileName("*.rdb*")
23863.   or FileName("*.dc*")
23864.   or FileName("*.dict*")
23865.   or FileName("*.?db*")
23866.   or FileName("*.?rdb*")
23867.   or FileName("*.md*")
23868.   or FileName("*.myd")
23869.   or FileName("*.ndf")
23870.   or FileName("*.ns?")
23871.   or FileName("*.pab")
23872.   or FileName("*.pst")
23873.   or FileName("*.sd?*")
23874.   or FileName("*.sq**")
23875.   or FileName("*.tmd")
23876.   or FileName("*.tps")
23877.   or FileName("*.tr*")
23878. )
23879. # Databases end.
23880. 
23881.     # BlobsAndExceptions
23882.     or 
23883. # Data start.
23884. (
23885.   DirectoryName("Data*")
23886.   or DirectoryName("Device*")
23887.   or DirectoryName("Export*")
23888.   or DirectoryName("Import*")
23889.   or DirectoryName("Log*")
23890.   or DirectoryName("*Log")
23891.   or DirectoryName("Maintenance*")
23892.   or DirectoryName("Rec*")
23893.   or DirectoryName("Sales*")
23894.   or DirectoryName("Search*")
23895.   or DirectoryName("User*")
23896. )
23897. # Data end.
23898. 
23899.     # BlobsAndExceptions
23900.   )
23901. ) )
23902. # BlobsAndExceptions end.
23903. 
23904. # Blobs
23905. ) and (
23906.   Size(BlobFileSize,0)
23907.   or (
23908.     FileName("*.arj")
23909.     or FileName("*.bup")
23910.     or FileName("*.bz2")
23911.     or FileName("*.chm")
23912.     or FileName("*.dvr-ms")
23913.     or FileName("*.gz")
23914.     or FileName("*.ifo")
23915.     or FileName("*.lzh")
23916.     or FileName("*.pdf")
23917.     or FileName("*.rpm")
23918.     or FileName("*.wmv")
23919.     or FileName("*.vob")
23920.     or FileName("*.z")
23921.   ) 
23922. )
23923. # Blobs end.
23924. 
23925. # SpaceHogs
23926. ) 
23927. # SpaceHogs end.
23928. 
23929. 	# Script: ZoneDoAction
23930. # Zone Do File Action - SortByName.
23931. 
23932. FileActions
23933. 
23934. 	# Footer:
23935. SetVariable(ZoneFooter, "----------------------------------------------------------
23936. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
23937. 
23938. Statistics Report:
23939. ------------------
23940.    Size:  
23941.    ------------------------
23942.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23943.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23944.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23945. 
23946.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23947.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23948. 
23949.    Location:
23950.    ------------------------
23951.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23952.              Files End: !ZoneEndCurrent!
23953.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23954.       
23955.    Gap Settings:
23956.    ------------------------
23957.          Gap Requested: !ZoneGapSizePer!%
23958.       Volume Rounding: !ZoneVolRoundUpPer!%
23959.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23960.                  
23961.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
23962.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
23963.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
23964.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
23965.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
23966.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
23967.      
23968.    Free Space after Zone:
23969.    ------------------------
23970.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23971.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23972.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23973. 
23974. Directory and Files Select:
23975. ---------------------------
23976. !ZoneTypeSelectCurrent!               
23977. ---------------------------
23978. ----------------------------------------------------------
23979. ")
23980. 	SetStatisticsWindowText("!ZoneFooter!")
23981. 	
23982. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
23983. 	# Script: DisplaySetFileStep
23984. 
23985. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23986. 
23987. /* add message and move to a new line. */
23988. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23989. ")
23990. 
23991. /* display the line. (hopefully.) */
23992. # Zone Footer Set Statistics Window Text
23993. 
23994. SetStatisticsWindowText("----------------------------------------------------------
23995. Zones Processed: 
23996. ----------------------------------------------------------
23997. !ZoneListByLine!
23998. ----------------------------------------------------------
23999. Zone Processing Step:
24000. !ZoneStepByLine!    
24001. ----------------------------------------------------------
24002. Current Zone:
24003. !ZoneFooter!
24004. ----------------------------------------------------------
24005. Volume Statistics:
24006. !VolumeStatisticsDetail!
24007. ----------------------------------------------------------
24008. Zone Detailed Report:
24009. ----------------------------------------------------------
24010. !ZoneStatisticsDetail!
24011. ----------------------------------------------------------
24012. ")
24013. 
24014. 
24015. 
24016. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24017. 
24018. # Script: BannerSet
24019. 
24020. # Script: DisplaySetDateTimeRun
24021. 
24022. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
24023. /* Xinclude "..\Display\BannerSet.MyDc"X */
24024. /* pause(1) */
24025. 
24026. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24027. 
24028. Title('!Heading!')
24029. /* pause(1) */
24030. 
24031. /* NOTE: Can't round or truncate to integer precision. */
24032. 
24033. pause(1)
24034. 
24035. # Commands:
24036. 
24037. /* Moves to Zone or above it. */
24038. # MoveUpToZone()
24039. 
24040. # Defrag
24041. 
24042. # Defragment(OPTIONS)
24043. 
24044. /* Shuffles files around trying to make a big enough gap for fragmented files. */
24045. # Defragment()
24046. 
24047. /* Only does files where a gap will fit it. */
24048. # Defragment(Fast)
24049. 
24050. /* Skips fragmented files larger than the Chunck Size.
24051. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
24052. # Defragment(Chunk Size)
24053. 
24054. /* Moves down to zone and packs zone to beginning if there are gaps. */
24055. /* Can be similar in performance to doing a SortBy. */
24056. # MoveDownFill()
24057. 
24058. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
24059. 
24060. 
24061. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
24062. 	# Script: DisplaySetFileStep
24063. 
24064. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24065. 
24066. /* add message and move to a new line. */
24067. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24068. ")
24069. 
24070. /* display the line. (hopefully.) */
24071. # Zone Footer Set Statistics Window Text
24072. 
24073. SetStatisticsWindowText("----------------------------------------------------------
24074. Zones Processed: 
24075. ----------------------------------------------------------
24076. !ZoneListByLine!
24077. ----------------------------------------------------------
24078. Zone Processing Step:
24079. !ZoneStepByLine!    
24080. ----------------------------------------------------------
24081. Current Zone:
24082. !ZoneFooter!
24083. ----------------------------------------------------------
24084. Volume Statistics:
24085. !VolumeStatisticsDetail!
24086. ----------------------------------------------------------
24087. Zone Detailed Report:
24088. ----------------------------------------------------------
24089. !ZoneStatisticsDetail!
24090. ----------------------------------------------------------
24091. ")
24092. 
24093. 
24094. 
24095. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24096. 
24097. # Script: BannerSet
24098. 
24099. # Script: DisplaySetDateTimeRun
24100. 
24101. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
24102. /* Xinclude "..\Display\BannerSet.MyDc"X */
24103. /* pause(1) */
24104. 
24105. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24106. 
24107. Title('!Heading!')
24108. /* pause(1) */
24109. 
24110. /* NOTE: Can't round or truncate to integer precision. */
24111. 
24112. pause(1)
24113. 
24114. 	# Script: ZoneDoFooter
24115. 
24116. /* ---------------------------------------------------------- */
24117. # File Select
24118. 	# Select Statments
24119. # File Actions 
24120. 	# Standard or OS File Actions.
24121. 	# Resume...
24122. 	
24123. 	# your stuff HERE (X)... post zone (file) file actions code.
24124. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
24125. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24126. 		# (X)
24127. 		
24128. 		/* ??? Set window? */
24129. 	
24130. 	# ADD THE GAP
24131. 		
24132. # Vacate (good for diagnostics)
24133. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
24134. 
24135. # DoNotVacate - DO NOT Vacate (recommended)
24136. 
24137. # Vacate
24138. /* AddGap(GapUsedLoc) */
24139. 
24140. # DO Not Vacate
24141. AddGap(GapUsedLoc, DoNotVacate) 
24142. 	
24143. 	
24144. /* ---------------------------------------------------------- */
24145. # (failed) TEST for boolean logic.
24146. 
24147. /* It should work in the gap calculations for turning options */
24148. /* on and off but it will NOT work here. */
24149. 
24150. /* Boolean setting X or FlagX. */
24151. /* Where X will be on or off: */
24152. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
24153. /*      For ON:  (X  *  FlagAny) */
24154. 
24155. /* 1) Failed, zero gap overrode the previous one. */
24156. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
24157. /* AddGap(GapUsedTemp) */ 
24158. 
24159. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
24160. /* AddGap(GapUsedTemp, DoNotVacate) */ 
24161. 
24162. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
24163. 
24164. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
24165. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
24166. /* AddGap(GapUsedTemp) */ 
24167. 
24168. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
24169. /* AddGap(GapUsedTemp, DoNotVacate) */ 
24170. 
24171. /* ---------------------------------------------------------- */
24172. 
24173. # Vacate
24174. /* AddGap(GapUsed) */
24175. 
24176. # DO NOT Vacate (recommended)
24177. /* AddGap(GapUsed, DoNotVacate) */ 
24178. 	
24179. 
24180. 		
24181. # 
24182. FileEnd
24183. /* ---------------------------------------------------------- */
24184. 
24185. # your stuff HERE (X)... post zone (file) code.
24186. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
24187. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24188. 	# (X)
24189. 
24190. SetVariable(FileStepDescription,"Zone finished, reporting.")
24191. # Script: DisplaySetFileStep
24192. 
24193. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24194. 
24195. /* add message and move to a new line. */
24196. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24197. ")
24198. 
24199. /* display the line. (hopefully.) */
24200. # Zone Footer Set Statistics Window Text
24201. 
24202. SetStatisticsWindowText("----------------------------------------------------------
24203. Zones Processed: 
24204. ----------------------------------------------------------
24205. !ZoneListByLine!
24206. ----------------------------------------------------------
24207. Zone Processing Step:
24208. !ZoneStepByLine!    
24209. ----------------------------------------------------------
24210. Current Zone:
24211. !ZoneFooter!
24212. ----------------------------------------------------------
24213. Volume Statistics:
24214. !VolumeStatisticsDetail!
24215. ----------------------------------------------------------
24216. Zone Detailed Report:
24217. ----------------------------------------------------------
24218. !ZoneStatisticsDetail!
24219. ----------------------------------------------------------
24220. ")
24221. 
24222. 
24223. 
24224. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24225. 
24226. # Script: BannerSet
24227. 
24228. # Script: DisplaySetDateTimeRun
24229. 
24230. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
24231. /* Xinclude "..\Display\BannerSet.MyDc"X */
24232. /* pause(1) */
24233. 
24234. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24235. 
24236. Title('!Heading!')
24237. /* pause(1) */
24238. 
24239. /* NOTE: Can't round or truncate to integer precision. */
24240. 
24241. pause(1)
24242. 
24243. # Script: ZoneWhenFinished
24244. 
24245. # Script: BannerSet
24246. 
24247. # Script: DisplaySetDateTimeRun
24248. 
24249. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
24250. /* Xinclude "..\Display\BannerSet.MyDc"X */
24251. /* pause(1) */
24252. 
24253. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24254. 
24255. Title('!Heading!')
24256. /* pause(1) */
24257. 
24258. /* NOTE: Can't round or truncate to integer precision. */
24259. 
24260. # Script: BannerLog
24261. 
24262. AppendLogfile("!LogFileName!", "!Title!")
24263. 
24264. 
24265. 
24266. # Zone Statistics	
24267. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
24268. 
24269. # Footer:
24270. SetVariable(ZoneFooter, "----------------------------------------------------------
24271. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
24272. 
24273. Statistics Report:
24274. ------------------
24275.    Size:  
24276.    ------------------------
24277.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24278.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24279.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24280. 
24281.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24282.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24283. 
24284.    Location:
24285.    ------------------------
24286.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24287.              Files End: !ZoneEndCurrent!
24288.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24289.       
24290.    Gap Settings:
24291.    ------------------------
24292.          Gap Requested: !ZoneGapSizePer!%
24293.       Volume Rounding: !ZoneVolRoundUpPer!%
24294.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24295.                  
24296.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
24297.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
24298.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
24299.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
24300.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
24301.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
24302.      
24303.    Free Space after Zone:
24304.    ------------------------
24305.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24306.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24307.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24308. 
24309. Directory and Files Select:
24310. ---------------------------
24311. !ZoneTypeSelectCurrent!               
24312. ---------------------------
24313. ----------------------------------------------------------
24314. ")
24315. 
24316. AppendLogfile("!LogFileName!", ".")
24317. AppendLogfile("!LogFileName!", "!ZoneFooter!")
24318. AppendLogfile("!LogFileName!", ".")
24319. 
24320. # Zone Footer Set Statistics Window Text
24321. 
24322. SetStatisticsWindowText("----------------------------------------------------------
24323. Zones Processed: 
24324. ----------------------------------------------------------
24325. !ZoneListByLine!
24326. ----------------------------------------------------------
24327. Zone Processing Step:
24328. !ZoneStepByLine!    
24329. ----------------------------------------------------------
24330. Current Zone:
24331. !ZoneFooter!
24332. ----------------------------------------------------------
24333. Volume Statistics:
24334. !VolumeStatisticsDetail!
24335. ----------------------------------------------------------
24336. Zone Detailed Report:
24337. ----------------------------------------------------------
24338. !ZoneStatisticsDetail!
24339. ----------------------------------------------------------
24340. ")
24341. 
24342. 
24343. 
24344. /* pause() */
24345. /* pause() */
24346. 
24347. 
24348. 
24349. 
24350. /* ---------------------------------------------------------- */
24351. 
24352. 
24353. /* ---------------------------------------------------------- */
24354. /* Zone ArchivesBu (All) Archives and Backups*/
24355. # Script: DefragZoneTypeArchivesBu
24356. /* ---------------------------------------------------------- */
24357. /* Zone ArchivesBu (All) Archives and Backups*/
24358. 
24359. SetVariable(ZoneLabel, "!ZoneLabelArchivesBu!")
24360. SetVariable(ZoneDescription, "!ZoneDescriptionArchivesBu!")
24361. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpArchivesBu!")
24362. SetVariable(ZoneGapSize, "!ZoneGapSizeArchivesBu!")
24363. SetVariable(ZoneTypeSelect,'# Script: ZoneDo ZoneTypeSelectArchivesBu
24364. # ArchivesBu start.
24365. all
24366. # ArchivesBu end.
24367. ')
24368. 
24369. /* Note: This should be all Blob archives and backups */
24370. /* The sorting the "z Archive", "z Bu" and "z Backup" directories */
24371. /* sort to the very end of the Volume. */
24372. 
24373. 	# Script: ZoneDoHeader
24374. 
24375. # Script: ZoneWhenStarted
24376. 
24377. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
24378. # Script: DisplaySetZone
24379. 
24380. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
24381. SetVariable(FileStepDescription,	"")
24382. 
24383. SetVariable(ZoneStepByLine, 			"Zone started.
24384. ")
24385. 
24386. # Script: BannerDescriptionSet
24387. 
24388. # Script: BannerSet
24389. 
24390. # Script: DisplaySetDateTimeRun
24391. 
24392. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
24393. /* Xinclude "..\Display\BannerSet.MyDc"X */
24394. /* pause(1) */
24395. 
24396. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24397. 
24398. Title('!Heading!')
24399. /* pause(1) */
24400. 
24401. /* NOTE: Can't round or truncate to integer precision. */
24402. 
24403. # Script: BannerLog
24404. 
24405. AppendLogfile("!LogFileName!", "!Title!")
24406. 
24407. 
24408. 
24409. pause(1)
24410. 
24411. 
24412. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
24413. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
24414. 
24415. SetVariable(ZoneStepNoCurrent, 0)
24416. 
24417. 
24418. # Script: ZoneDoCurrentClear
24419. 
24420. SetVariable(ZoneTypeSelectCurrent, 		"")
24421. 
24422. SetVariable(ZoneBeginCurrent, 			0)
24423. SetVariable(ZoneBeginPerCurrent, 		0)
24424. SetVariable(ZoneEndCurrent, 			0)
24425. SetVariable(ZoneEndPerCurrent, 			0)
24426. 
24427. SetVariable(ZoneSizeCurrent,			0)
24428. SetVariable(ZoneSizePerCurrent,			0)
24429. 
24430. SetVariable(ZoneGapRequestedCurrent,	0)
24431. SetVariable(ZoneGapRoundedCurrent, 		0)
24432. SetVariable(ZoneGapAdjustedCurrent, 	0)
24433. SetVariable(ZoneGapAvailableCurrent, 	0)
24434. SetVariable(ZoneGapCurrent,				0)
24435. SetVariable(ZoneGapUsedCurrent, 		0)
24436. 
24437. SetVariable(ZoneGapActualCurrent, 		0)
24438. SetVariable(ZoneGapActualPerCurrent, 	0)
24439. 
24440. SetVariable(ZoneSizeActual, 			0)
24441. SetVariable(ZoneSizeActualCurrent,		0)
24442. 
24443. SetVariable(ZoneEndActual, 				0)
24444. SetVariable(ZoneEndActualCurrent,		0)			
24445. SetVariable(ZoneSizeActualPerCurrent, 	0)
24446.       
24447. SetVariable(ZoneFilesFolders,			0)
24448. SetVariable(ZoneFilesFoldersPer,		0) 
24449. 
24450. SetVariable(ZoneFragments,				0)
24451. SetVariable(ZoneFragmentsPer,			0) 
24452. 		
24453. SetVariable(ZoneEndActualCurrent, 		0)
24454. SetVariable(ZoneEndActualPerCurrent, 	0)
24455. 
24456. # Gap Calculation Methodology:
24457. 	# Requested
24458. 	SetVariable(GapRequested, 			0) 
24459. 	SetVariable(GapRequestedStd, 		0) 
24460. 	SetVariable(GapRequestedMft, 		0) 
24461. 	SetVariable(GapRequestedOs, 		0) 
24462. 	SetVariable(GapRequestedOriginal, 	0) 
24463. 	
24464. 	# Gap Adjustments
24465. 	SetVariable(GapRounded, 			0)
24466. 	# SetVariable(GapAdjusted, 			0)
24467. 	SetVariable(GapAvailable, 			0)
24468. 	SetVariable(GapCurrent, 			0)
24469. 	SetVariable(GapActual, 				0)
24470. 	SetVariable(GapUsed, 				0)
24471. 	
24472. 	# Gap Adjustments
24473. 	SetVariable(GapRoundedLoc, 			0)
24474. 	# SetVariable(GapAdjustedLoc, 		0)
24475. 	SetVariable(GapAvailableLoc, 		0)
24476. 	SetVariable(GapCurrentLoc, 			0)
24477. 	SetVariable(GapActualLoc,			0)
24478. 	SetVariable(GapUsedLoc,				0)
24479. 	
24480. 	# Space usage
24481. 	SetVariable(ZoneFreePerRequested, 	0)
24482. 	SetVariable(ZoneFreePerUsed, 		0)
24483. 
24484. # Gap Size & Rounding
24485. 	SetVariable(ZoneGapSizePer, 		0)
24486. 	SetVariable(ZoneVolRoundUpPer, 		0)
24487. 	
24488. 	# Free Space
24489. 	SetVariable(ZoneFreeUsedPer, 		0)
24490. 	SetVariable(ZoneFreeRequestedPer, 	0)
24491. 
24492. 
24493. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
24494. 
24495. # Footer:
24496. SetVariable(ZoneFooter, "----------------------------------------------------------
24497. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
24498. 
24499. Statistics Report:
24500. ------------------
24501.    Size:  
24502.    ------------------------
24503.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24504.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24505.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24506. 
24507.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24508.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24509. 
24510.    Location:
24511.    ------------------------
24512.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24513.              Files End: !ZoneEndCurrent!
24514.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24515.       
24516.    Gap Settings:
24517.    ------------------------
24518.          Gap Requested: !ZoneGapSizePer!%
24519.       Volume Rounding: !ZoneVolRoundUpPer!%
24520.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24521.                  
24522.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
24523.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
24524.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
24525.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
24526.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
24527.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
24528.      
24529.    Free Space after Zone:
24530.    ------------------------
24531.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24532.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24533.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24534. 
24535. Directory and Files Select:
24536. ---------------------------
24537. !ZoneTypeSelectCurrent!               
24538. ---------------------------
24539. ----------------------------------------------------------
24540. ")
24541. 
24542. # Script: BannerSet
24543. 
24544. # Script: DisplaySetDateTimeRun
24545. 
24546. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
24547. /* Xinclude "..\Display\BannerSet.MyDc"X */
24548. /* pause(1) */
24549. 
24550. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24551. 
24552. Title('!Heading!')
24553. /* pause(1) */
24554. 
24555. /* NOTE: Can't round or truncate to integer precision. */
24556. 
24557. # Script: BannerLog
24558. 
24559. AppendLogfile("!LogFileName!", "!Title!")
24560. 
24561. 
24562. 
24563. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
24564. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
24565. AppendLogfile("!LogFileName!", "Time: 2021-11-09 18:53:51")
24566. 
24567. SetVariable(ZoneListByLine, "!ZoneListByLine!
24568. Zone: !ZoneNoCurrent! 2021-11-09 18:53:51 0:00:07 !ZoneLabel! !ZoneDescription!")
24569. 
24570. 
24571. /* Fixed Zone Position Handling */
24572. /* Literal number: */
24573. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
24574. /* Percentage of disk: */
24575. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
24576. /* Gap */
24577. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
24578. 
24579. /* ---------------------------------------------------------- */
24580. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
24581. # Script: DisplaySetFileStep
24582. 
24583. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24584. 
24585. /* add message and move to a new line. */
24586. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24587. ")
24588. 
24589. /* display the line. (hopefully.) */
24590. # Zone Footer Set Statistics Window Text
24591. 
24592. SetStatisticsWindowText("----------------------------------------------------------
24593. Zones Processed: 
24594. ----------------------------------------------------------
24595. !ZoneListByLine!
24596. ----------------------------------------------------------
24597. Zone Processing Step:
24598. !ZoneStepByLine!    
24599. ----------------------------------------------------------
24600. Current Zone:
24601. !ZoneFooter!
24602. ----------------------------------------------------------
24603. Volume Statistics:
24604. !VolumeStatisticsDetail!
24605. ----------------------------------------------------------
24606. Zone Detailed Report:
24607. ----------------------------------------------------------
24608. !ZoneStatisticsDetail!
24609. ----------------------------------------------------------
24610. ")
24611. 
24612. 
24613. 
24614. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24615. 
24616. # Script: BannerSet
24617. 
24618. # Script: DisplaySetDateTimeRun
24619. 
24620. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
24621. /* Xinclude "..\Display\BannerSet.MyDc"X */
24622. /* pause(1) */
24623. 
24624. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24625. 
24626. Title('!Heading!')
24627. /* pause(1) */
24628. 
24629. /* NOTE: Can't round or truncate to integer precision. */
24630. 
24631. pause(1)
24632. 
24633. # your stuff HERE (X)... pre file select code.
24634. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
24635. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24636. 	# (X)
24637. 
24638. FileSelect
24639. 
24640. 	# your stuff can't really go here (errors.)
24641. 	# maybe for some reason I don't know of...
24642. 	
24643. 	# Actions next...
24644. 	# Script: ZoneDo ZoneTypeSelectArchivesBu
24645. # ArchivesBu start.
24646. all
24647. # ArchivesBu end.
24648. 
24649. 	# Script: ZoneDoAction
24650. # Zone Do File Action - SortByName.
24651. 
24652. FileActions
24653. 
24654. 	# Footer:
24655. SetVariable(ZoneFooter, "----------------------------------------------------------
24656. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
24657. 
24658. Statistics Report:
24659. ------------------
24660.    Size:  
24661.    ------------------------
24662.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24663.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24664.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24665. 
24666.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24667.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24668. 
24669.    Location:
24670.    ------------------------
24671.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24672.              Files End: !ZoneEndCurrent!
24673.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24674.       
24675.    Gap Settings:
24676.    ------------------------
24677.          Gap Requested: !ZoneGapSizePer!%
24678.       Volume Rounding: !ZoneVolRoundUpPer!%
24679.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24680.                  
24681.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
24682.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
24683.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
24684.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
24685.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
24686.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
24687.      
24688.    Free Space after Zone:
24689.    ------------------------
24690.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24691.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24692.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24693. 
24694. Directory and Files Select:
24695. ---------------------------
24696. !ZoneTypeSelectCurrent!               
24697. ---------------------------
24698. ----------------------------------------------------------
24699. ")
24700. 	SetStatisticsWindowText("!ZoneFooter!")
24701. 	
24702. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
24703. 	# Script: DisplaySetFileStep
24704. 
24705. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24706. 
24707. /* add message and move to a new line. */
24708. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24709. ")
24710. 
24711. /* display the line. (hopefully.) */
24712. # Zone Footer Set Statistics Window Text
24713. 
24714. SetStatisticsWindowText("----------------------------------------------------------
24715. Zones Processed: 
24716. ----------------------------------------------------------
24717. !ZoneListByLine!
24718. ----------------------------------------------------------
24719. Zone Processing Step:
24720. !ZoneStepByLine!    
24721. ----------------------------------------------------------
24722. Current Zone:
24723. !ZoneFooter!
24724. ----------------------------------------------------------
24725. Volume Statistics:
24726. !VolumeStatisticsDetail!
24727. ----------------------------------------------------------
24728. Zone Detailed Report:
24729. ----------------------------------------------------------
24730. !ZoneStatisticsDetail!
24731. ----------------------------------------------------------
24732. ")
24733. 
24734. 
24735. 
24736. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24737. 
24738. # Script: BannerSet
24739. 
24740. # Script: DisplaySetDateTimeRun
24741. 
24742. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
24743. /* Xinclude "..\Display\BannerSet.MyDc"X */
24744. /* pause(1) */
24745. 
24746. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24747. 
24748. Title('!Heading!')
24749. /* pause(1) */
24750. 
24751. /* NOTE: Can't round or truncate to integer precision. */
24752. 
24753. pause(1)
24754. 
24755. # Commands:
24756. 
24757. /* Moves to Zone or above it. */
24758. # MoveUpToZone()
24759. 
24760. # Defrag
24761. 
24762. # Defragment(OPTIONS)
24763. 
24764. /* Shuffles files around trying to make a big enough gap for fragmented files. */
24765. # Defragment()
24766. 
24767. /* Only does files where a gap will fit it. */
24768. # Defragment(Fast)
24769. 
24770. /* Skips fragmented files larger than the Chunck Size.
24771. /* The build-in defragmenter that comes with Vista does a chunk defragment, ignoring fragments larger than 64 megabytes. */
24772. # Defragment(Chunk Size)
24773. 
24774. /* Moves down to zone and packs zone to beginning if there are gaps. */
24775. /* Can be similar in performance to doing a SortBy. */
24776. # MoveDownFill()
24777. 
24778. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
24779. 
24780. 
24781. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
24782. 	# Script: DisplaySetFileStep
24783. 
24784. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24785. 
24786. /* add message and move to a new line. */
24787. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24788. ")
24789. 
24790. /* display the line. (hopefully.) */
24791. # Zone Footer Set Statistics Window Text
24792. 
24793. SetStatisticsWindowText("----------------------------------------------------------
24794. Zones Processed: 
24795. ----------------------------------------------------------
24796. !ZoneListByLine!
24797. ----------------------------------------------------------
24798. Zone Processing Step:
24799. !ZoneStepByLine!    
24800. ----------------------------------------------------------
24801. Current Zone:
24802. !ZoneFooter!
24803. ----------------------------------------------------------
24804. Volume Statistics:
24805. !VolumeStatisticsDetail!
24806. ----------------------------------------------------------
24807. Zone Detailed Report:
24808. ----------------------------------------------------------
24809. !ZoneStatisticsDetail!
24810. ----------------------------------------------------------
24811. ")
24812. 
24813. 
24814. 
24815. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24816. 
24817. # Script: BannerSet
24818. 
24819. # Script: DisplaySetDateTimeRun
24820. 
24821. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
24822. /* Xinclude "..\Display\BannerSet.MyDc"X */
24823. /* pause(1) */
24824. 
24825. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24826. 
24827. Title('!Heading!')
24828. /* pause(1) */
24829. 
24830. /* NOTE: Can't round or truncate to integer precision. */
24831. 
24832. pause(1)
24833. 
24834. 	# Script: ZoneDoFooter
24835. 
24836. /* ---------------------------------------------------------- */
24837. # File Select
24838. 	# Select Statments
24839. # File Actions 
24840. 	# Standard or OS File Actions.
24841. 	# Resume...
24842. 	
24843. 	# your stuff HERE (X)... post zone (file) file actions code.
24844. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
24845. 		# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24846. 		# (X)
24847. 		
24848. 		/* ??? Set window? */
24849. 	
24850. 	# ADD THE GAP
24851. 		
24852. # Vacate (good for diagnostics)
24853. /* Xinclude "..\Gap\GapCommandDoVacate.MyDc"X */
24854. 
24855. # DoNotVacate - DO NOT Vacate (recommended)
24856. 
24857. # Vacate
24858. /* AddGap(GapUsedLoc) */
24859. 
24860. # DO Not Vacate
24861. AddGap(GapUsedLoc, DoNotVacate) 
24862. 	
24863. 	
24864. /* ---------------------------------------------------------- */
24865. # (failed) TEST for boolean logic.
24866. 
24867. /* It should work in the gap calculations for turning options */
24868. /* on and off but it will NOT work here. */
24869. 
24870. /* Boolean setting X or FlagX. */
24871. /* Where X will be on or off: */
24872. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
24873. /*      For ON:  (X  *  FlagAny) */
24874. 
24875. /* 1) Failed, zero gap overrode the previous one. */
24876. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
24877. /* AddGap(GapUsedTemp) */ 
24878. 
24879. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
24880. /* AddGap(GapUsedTemp, DoNotVacate) */ 
24881. 
24882. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
24883. 
24884. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
24885. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
24886. /* AddGap(GapUsedTemp) */ 
24887. 
24888. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
24889. /* AddGap(GapUsedTemp, DoNotVacate) */ 
24890. 
24891. /* ---------------------------------------------------------- */
24892. 
24893. # Vacate
24894. /* AddGap(GapUsed) */
24895. 
24896. # DO NOT Vacate (recommended)
24897. /* AddGap(GapUsed, DoNotVacate) */ 
24898. 	
24899. 
24900. 		
24901. # 
24902. FileEnd
24903. /* ---------------------------------------------------------- */
24904. 
24905. # your stuff HERE (X)... post zone (file) code.
24906. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
24907. 	# Xinclude "..\Display\DisplaySetFileStep.MyDc"X
24908. 	# (X)
24909. 
24910. SetVariable(FileStepDescription,"Zone finished, reporting.")
24911. # Script: DisplaySetFileStep
24912. 
24913. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24914. 
24915. /* add message and move to a new line. */
24916. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24917. ")
24918. 
24919. /* display the line. (hopefully.) */
24920. # Zone Footer Set Statistics Window Text
24921. 
24922. SetStatisticsWindowText("----------------------------------------------------------
24923. Zones Processed: 
24924. ----------------------------------------------------------
24925. !ZoneListByLine!
24926. ----------------------------------------------------------
24927. Zone Processing Step:
24928. !ZoneStepByLine!    
24929. ----------------------------------------------------------
24930. Current Zone:
24931. !ZoneFooter!
24932. ----------------------------------------------------------
24933. Volume Statistics:
24934. !VolumeStatisticsDetail!
24935. ----------------------------------------------------------
24936. Zone Detailed Report:
24937. ----------------------------------------------------------
24938. !ZoneStatisticsDetail!
24939. ----------------------------------------------------------
24940. ")
24941. 
24942. 
24943. 
24944. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24945. 
24946. # Script: BannerSet
24947. 
24948. # Script: DisplaySetDateTimeRun
24949. 
24950. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
24951. /* Xinclude "..\Display\BannerSet.MyDc"X */
24952. /* pause(1) */
24953. 
24954. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24955. 
24956. Title('!Heading!')
24957. /* pause(1) */
24958. 
24959. /* NOTE: Can't round or truncate to integer precision. */
24960. 
24961. pause(1)
24962. 
24963. # Script: ZoneWhenFinished
24964. 
24965. # Script: BannerSet
24966. 
24967. # Script: DisplaySetDateTimeRun
24968. 
24969. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
24970. /* Xinclude "..\Display\BannerSet.MyDc"X */
24971. /* pause(1) */
24972. 
24973. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24974. 
24975. Title('!Heading!')
24976. /* pause(1) */
24977. 
24978. /* NOTE: Can't round or truncate to integer precision. */
24979. 
24980. # Script: BannerLog
24981. 
24982. AppendLogfile("!LogFileName!", "!Title!")
24983. 
24984. 
24985. 
24986. # Zone Statistics	
24987. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
24988. 
24989. # Footer:
24990. SetVariable(ZoneFooter, "----------------------------------------------------------
24991. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-11-09 18:53:51
24992. 
24993. Statistics Report:
24994. ------------------
24995.    Size:  
24996.    ------------------------
24997.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24998.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24999.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
25000. 
25001.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
25002.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
25003. 
25004.    Location:
25005.    ------------------------
25006.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
25007.              Files End: !ZoneEndCurrent!
25008.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
25009.       
25010.    Gap Settings:
25011.    ------------------------
25012.          Gap Requested: !ZoneGapSizePer!%
25013.       Volume Rounding: !ZoneVolRoundUpPer!%
25014.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
25015.                  
25016.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
25017.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
25018.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
25019.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
25020.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
25021.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
25022.      
25023.    Free Space after Zone:
25024.    ------------------------
25025.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
25026.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
25027.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
25028. 
25029. Directory and Files Select:
25030. ---------------------------
25031. !ZoneTypeSelectCurrent!               
25032. ---------------------------
25033. ----------------------------------------------------------
25034. ")
25035. 
25036. AppendLogfile("!LogFileName!", ".")
25037. AppendLogfile("!LogFileName!", "!ZoneFooter!")
25038. AppendLogfile("!LogFileName!", ".")
25039. 
25040. # Zone Footer Set Statistics Window Text
25041. 
25042. SetStatisticsWindowText("----------------------------------------------------------
25043. Zones Processed: 
25044. ----------------------------------------------------------
25045. !ZoneListByLine!
25046. ----------------------------------------------------------
25047. Zone Processing Step:
25048. !ZoneStepByLine!    
25049. ----------------------------------------------------------
25050. Current Zone:
25051. !ZoneFooter!
25052. ----------------------------------------------------------
25053. Volume Statistics:
25054. !VolumeStatisticsDetail!
25055. ----------------------------------------------------------
25056. Zone Detailed Report:
25057. ----------------------------------------------------------
25058. !ZoneStatisticsDetail!
25059. ----------------------------------------------------------
25060. ")
25061. 
25062. 
25063. 
25064. /* pause() */
25065. /* pause() */
25066. 
25067. 
25068. 
25069. 
25070. /* ---------------------------------------------------------- */
25071. 
25072. 
25073. /* ---------------------------------------------------------- */
25074. /* Volume End */
25075. # Script: VolumeWhenFinished
25076. 
25077. /* Write the "after" statistics to the logfile. */
25078. 
25079. # Script: BannerSet
25080. 
25081. # Script: DisplaySetDateTimeRun
25082. 
25083. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
25084. /* Xinclude "..\Display\BannerSet.MyDc"X */
25085. /* pause(1) */
25086. 
25087. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
25088. 
25089. Title('!Heading!')
25090. /* pause(1) */
25091. 
25092. /* NOTE: Can't round or truncate to integer precision. */
25093. 
25094. # Script: BannerLog
25095. 
25096. AppendLogfile("!LogFileName!", "!Title!")
25097. 
25098. 
25099. 
25100. # Script: VolumeFooterGet
25101. # Set Volume summary stats:
25102. 
25103. # Cluster, Sector, Block adjust for display.
25104. # Bytes per cluster is volume specific.
25105. 
25106. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
25107. 
25108. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
25109. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
25110. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
25111. 
25112. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
25113. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
25114. 
25115. # Set the display text:
25116. # Script: VolumeStatisticsSummaryDisplay
25117. 
25118. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
25119. SUMMARY: !VolumeLabel! !VolumeDescription!
25120.   
25121.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
25122.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
25123.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
25124.          
25125.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
25126.       Volume Free Adj:       !VolumeFreeAdj!
25127.     Bytes per cluster:       !BytesPerCluster! bytes
25128. 
25129.    Unfragmented Items:       !FILES200N!
25130.      Fragmented Items:       !FILES210N!
25131. 
25132.     Unfragmented Data:       !FILES202N! bytes
25133.       Fragmented Data:       !FILES212N! bytes
25134. 
25135.              All Gaps:       !GAP00N!
25136.              All gaps:       !GAP10N! bytes
25137.           Average gap:       !GAP13N! bytes
25138.            Median gap:       !GAP14N! bytes
25139.           Biggest gap:       !GAP15N! bytes
25140. ----------------------------------------------------------
25141. ") 
25142. 
25143. 
25144. SetVariable(VolumeFooter, "!VolumeStatisticsSummary!")
25145. 
25146. 
25147. # Script: VolumeSizeLog
25148. AppendLogfile("!LogFileName!", ".")
25149. AppendLogfile("!LogFileName!", "      Volume Size: !VolumeSize!")
25150. AppendLogfile("!LogFileName!", "      Volume Used: !VolumeUsed!")
25151. AppendLogfile("!LogFileName!", "Volume Used Total: !VolumeUsedTotal!")
25152. AppendLogfile("!LogFileName!", "      Volume Free: !VolumeFree!")
25153. AppendLogfile("!LogFileName!", "  Volume Free Adj: !VolumeFreeAdj!")
25154. AppendLogfile("!LogFileName!", ".")
25155. AppendLogfile("!LogFileName!", "MFT Zone: !MftZone! Location: !MftLocation! Gap: !MftGap!")
25156. AppendLogfile("!LogFileName!", ".")
25157. 
25158. 
25159. /* Write/display stats: */
25160. 
25161. # Log:  
25162. 
25163. # Script: VolumeStatisticsDetailGet
25164. 
25165. # Set Volume summary stats:
25166. 
25167. # Cluster, Sector, Block adjust for display.
25168. # Bytes per cluster is volume specific.
25169. 
25170. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
25171. 
25172. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
25173. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
25174. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
25175. 
25176. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
25177. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
25178. 
25179. # Set the display text:
25180. # Script: VolumeStatisticsSummaryDisplay
25181. 
25182. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
25183. SUMMARY: !VolumeLabel! !VolumeDescription!
25184.   
25185.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
25186.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
25187.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
25188.          
25189.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
25190.       Volume Free Adj:       !VolumeFreeAdj!
25191.     Bytes per cluster:       !BytesPerCluster! bytes
25192. 
25193.    Unfragmented Items:       !FILES200N!
25194.      Fragmented Items:       !FILES210N!
25195. 
25196.     Unfragmented Data:       !FILES202N! bytes
25197.       Fragmented Data:       !FILES212N! bytes
25198. 
25199.              All Gaps:       !GAP00N!
25200.              All gaps:       !GAP10N! bytes
25201.           Average gap:       !GAP13N! bytes
25202.            Median gap:       !GAP14N! bytes
25203.           Biggest gap:       !GAP15N! bytes
25204. ----------------------------------------------------------
25205. ") 
25206. 
25207. 
25208. 
25209. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
25210. VOLUME: !VolumeLabel! !VolumeDescription!
25211. ----------------------------------------------------------
25212. !VolumeStatisticsSummary!
25213. ----------------------------------------------------------
25214. DETAILS: !VolumeLabel! !VolumeDescription!
25215. ----------------------------------------------------------
25216. 
25217. SUMMARY:
25218. 
25219. Volume label/name:          !VolumeLabel!
25220. Volume mountpoint:          !MountPoint!
25221. Volume name:                !VolumeName!
25222. Volume type:                !VolumeType!
25223. 
25224. Total disk space:           !VolumeSize! bytes
25225.                             !VolumeSizeG! gigabytes
25226. 
25227. Bytes per cluster:          !BytesPerCluster! bytes
25228. Average end-begin distance: !AverageBeginEndDistance! clusters
25229.                             !AverageBeginEndDistanceP!% of volume size
25230. 
25231. ----------------------------------------------------------
25232. FRAGMENTS:
25233. 
25234. Unfragmented Items: !FILES200N!
25235.   Fragmented Items: !FILES210N!
25236.  Unfragmented Data: !FILES202N! bytes
25237.    Fragmented Data: !FILES212N! bytes
25238. Gaps:
25239.           All Gaps: !GAP00N!
25240.           All gaps: !GAP10N! bytes
25241.        Average gap: !GAP13N! bytes
25242.         Median gap: !GAP14N! bytes
25243.        Biggest gap: !GAP15N! bytes
25244. 
25245. ----------------------------------------------------------
25246. GAPS:
25247. 
25248.    ----------------------------------------------------------
25249.    Counts:
25250.                        Count      Percentage of all
25251.                 ----------------- -----------------
25252.    Small gaps   !GAP01N! !GAP01P!%
25253.    Big gaps     !GAP02N! !GAP02P!%
25254.                 ----------------- -----------------
25255.    All gaps     !GAP00N! !GAP00P!
25256. 
25257.    ----------------------------------------------------------
25258.    By size:
25259.                       Bytes          Gigabytes      Percentage of all
25260.                 ----------------- ----------------- -----------------
25261.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
25262.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
25263.                 ----------------- ----------------- -----------------
25264.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
25265. 
25266.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
25267.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
25268.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
25269.    ----------------------------------------------------------
25270. 
25271. ----------------------------------------------------------
25272. FILE STATISTICS:
25273. ----------------------------------------------------------
25274. 
25275. ----------------------------------------------------------
25276. ITEM COUNT:
25277. ----------------------------------------------------------
25278. Number of files and folders:
25279. 
25280.               Unfragmented       Fragmented            All
25281.    ------- ----------------- ----------------- -----------------
25282.    Files   !FILES000N! !FILES010N! !FILES020N!
25283.    Folders !FILES100N! !FILES110N! !FILES120N!
25284.    ------- ----------------- ----------------- -----------------
25285.    All     !FILES200N! !FILES210N! !FILES220N!
25286. 
25287. ----------------------------------------------------------
25288. Percentage of total:
25289. 
25290.               Unfragmented       Fragmented            All
25291.    ------- ----------------- ----------------- -----------------
25292.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
25293.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
25294.    ------- ----------------- ----------------- -----------------
25295.    All     !FILES200P!%!FILES210P!%!FILES220P!%
25296. 
25297. ----------------------------------------------------------
25298. OCCUPIED SIZE on disk:
25299. ----------------------------------------------------------
25300. Bytes:
25301.               Unfragmented       Fragmented            All
25302.    ------- ----------------- ----------------- -----------------
25303.    Files   !FILES002N! !FILES012N! !FILES022N!
25304.    Folders !FILES102N! !FILES112N! !FILES122N!
25305.    ------- ----------------- ----------------- -----------------
25306.    All     !FILES202N! !FILES212N! !FILES222N!
25307. 
25308. ----------------------------------------------------------
25309. Gigabytes:
25310.               Unfragmented       Fragmented            All
25311.    ------- ----------------- ----------------- -----------------
25312.    Files   !FILES002G! !FILES012G! !FILES022G!
25313.    Folders !FILES102G! !FILES112G! !FILES122G!
25314.    ------- ----------------- ----------------- -----------------
25315.    All     !FILES202G! !FILES212G! !FILES222G!
25316. 
25317. ----------------------------------------------------------
25318. Percentage:
25319.               Unfragmented       Fragmented            All
25320.    ------- ----------------- ----------------- -----------------
25321.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
25322.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
25323.    ------- ----------------- ----------------- -----------------
25324.    All     !FILES202P!%!FILES212P!%!FILES222P!%
25325. 
25326. ----------------------------------------------------------
25327. USED SIZE:
25328. ----------------------------------------------------------
25329. Bytes:
25330.               Unfragmented       Fragmented            All
25331.    ------- ----------------- ----------------- -----------------
25332.    Files   !FILES001N! !FILES011N! !FILES021N!
25333.    Folders !FILES101N! !FILES111N! !FILES121N!
25334.    ------- ----------------- ----------------- -----------------
25335.    All     !FILES201N! !FILES211N! !FILES221N!
25336. 
25337. ----------------------------------------------------------
25338. Gigabytes:
25339.               Unfragmented       Fragmented            All
25340.    ------- ----------------- ----------------- -----------------
25341.    Files   !FILES001G! !FILES011G! !FILES021G!
25342.    Folders !FILES101G! !FILES111G! !FILES121G!
25343.    ------- ----------------- ----------------- -----------------
25344.    All     !FILES201G! !FILES211G! !FILES221G!
25345. 
25346. ----------------------------------------------------------
25347. Percentage:
25348.               Unfragmented       Fragmented            All
25349.    ------- ----------------- ----------------- -----------------
25350.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
25351.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
25352.    ------- ----------------- ----------------- -----------------
25353.    All     !FILES201P!%!FILES211P!%!FILES221P!%
25354. 
25355. ----------------------------------------------------------
25356. Volume Detailed Statistics end.
25357. ----------------------------------------------------------
25358. ") 
25359. 
25360. 
25361. AppendLogfile("!LogFileName!", ".")
25362. AppendLogfile("!LogFileName!", "!VolumeStatisticsDetail!")
25363. AppendLogfile("!LogFileName!", ".")
25364. AppendLogfile("!LogFileName!", "Volume End.")	
25365. 
25366. # SetStatisticsWindowText("!VolumeStatisticsDetail!")
25367. 
25368. /* pause() */
25369. /* pause() */
25370. 
25371.   
25372. 
25373. VolumeEnd
25374. 
25375. /* ---------------------------------------------------------- */
25376. 
25377. AppendLogfile("!LogFileName!",".")
25378. SetVariable(FileStepDescription,"!Description! Complex Volume end: 2021-11-09 18:53:49.")
25379. # Script: BannerDescriptionSet
25380. 
25381. # Script: BannerSet
25382. 
25383. # Script: DisplaySetDateTimeRun
25384. 
25385. SetVariable(DateTimeRunDescription,		"2021-11-09 18:53:51 0:00:07")
25386. /* Xinclude "..\Display\BannerSet.MyDc"X */
25387. /* pause(1) */
25388. 
25389. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
25390. 
25391. Title('!Heading!')
25392. /* pause(1) */
25393. 
25394. /* NOTE: Can't round or truncate to integer precision. */
25395. 
25396. # Script: BannerLog
25397. 
25398. AppendLogfile("!LogFileName!", "!Title!")
25399. 
25400. 
25401. 
25402. AppendLogfile("!LogFileName!",".")
25403. 
25404. /* ---------------------------------------------------------- */
25405. # End. ;-) (Return to caller lovely nubes, only MyD's get executed.)
25406. 
25407. 
