# See the 'MyDefrag.log' file for information intended for endusers. This is the debug
# logfile. The contents is highly technical and not documented. See the 'Debug' setting
# or the '-d' commandline option to control the level of information in this file.
#
Version: MyDefrag v4.3.1 for X64
Date: 2021/10/24 14:34:19
Windows version: v6.2 build 9200 
Commandline: "C:\Program Files\MyDefrag v4.3.1\MyDefrag.exe" -r "G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsYearly\DefragDevDiskYearly.MyD" 
Working Directory: G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsYearly
Userid: david
InstallPath = C:\Program Files\MyDefrag v4.3.1\
14:34:19 Lexical error in script 'G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsYearly\DefragDevDiskYearly.MyD' at line 14139 column 2.

Unkown symbol.
14:35:12 Script:
  1. # MyDefrag v4.0 script: Development Volume Yearly defrag
  2. #
  3. # This script is part of the standard Mdm Volume configuration
  4. # Author: David G. Horsman (DBA MacroDM) (FOSS) 2019
  5. # based on MyDefrag distribution.
  6. 
  7. /* Development Volume Yearly*/
  8. SetVariable(RunStepDescription,"Dev Vol Yearly")
  9. # Display Set Run
 10. 
 11. SetVariable(RunStepDescription,			"!RunStepDescription! - DefragDevDiskYearly")
 12. SetVariable(SeverStepDescription,		"")
 13. SetVariable(VolumeStepDescription,		"")
 14. SetVariable(ZoneStepDescription,		"")
 15. SetVariable(FileStepDescription,		"")
 16. 
 17. SetVariable(VolumeStatisticsDetail, 	"")
 18. 
 19. SetVariable(ZoneListByLine, 			"Run start.")
 20. SetVariable(ZoneStepByLine, 			"")
 21. 
 22. # BANNER SET
 23. 
 24. # DATE TIME RUN ELP
 25. 
 26. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:14 0:00:00")
 27. /* Xinclude "..\BannerSet.MyDc"X */
 28. /* pause(1) */
 29. 
 30. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
 31. 
 32. Title('!Heading!')
 33. /* pause(1) */
 34. 
 35. /* NOTE: Can't round or truncate to integer precision. */
 36. 
 37. pause(2)
 38. 
 39. # This script is part of the standard  disk configuration
 40. # Author: David G. Horsman (DBA MacroDM) (C) 2019
 41. # based on MyDefrag distribution.
 42. 
 43. SetVariable(Heading,"Initializing...")
 44. 
 45. ProcessPriority(Normal)
 46. /* ProcessPriority(Normal) */
 47. 
 48. 
 49. 
 50. ExitIfTimeout(300) // 5 minutes (for old systems), default 120.
 51. /* ExitIfTimeout(300) // 5 minutes (for old systems), default 120. */
 52. 
 53. 
 54. 
 55. # MyDefrag color palette.
 56. 
 57. # RGB Color pallets. (Red,Green,Blue).
 58. 
 59. # Basics:
 60. 
 61. # Red			255,	0,		0)			// Red					RGB(255, 0, 0)
 62. # Green			0,		255		0)			// Green				RGB(0, 255, 0)
 63. # Blue			0,		0,		255)		// Blue					RGB(0, 0, 255)
 64. 
 65. # Shades:
 66. 
 67. /* (White was left unused for the administrator to highlight things.) */
 68. # White 		255,	255,	255)		// White				RGB(255, 255, 255) 		
 69. # Black			0,		0,		0)			// Black 				RGB(0, 0, 0)
 70. # Grey 			240,	240,	240)		// Grey 				RGB(240, 240, 240)
 71. 
 72. # Bright colors and shades:
 73. 
 74. # Purple 		170,	89,		221)		// Purple 				RGB(170, 89, 221)
 75. # Magenta		255, 	5, 		255)		// Magenta (pinkish)	RGB(255, 5, 255)
 76. # Bright blue	0, 		255, 	0)			// Light bright blue 	RGB(7, 255, 255)
 77. # Pure yellow 	255,	255,	0)			// Pure yellow 			RGB(255, 255, 0)
 78. # Yellow 		229, 	229, 	0)			// Yellow 				RGB(229, 229, 0)
 79. # Light red		255,	115,	115)		// Light red			RGB(255, 115, 115)
 80. # Red 			204, 	92, 	92)			// Red 					RGB(204, 92, 92)
 81. 
 82. 
 83. # Window Colors
 84. SetColor(Empty,										240,  	240, 	240)	// Grey 				RGB(240, 240, 240)
 85. SetColor(Allocated,									45, 	72, 	128)	// Black 				RGB(0, 0, 0)
 86. 
 87. SetColor(BusyRead,									255, 	5, 		255)	// Magenta (pinkish)	RGB(255, 5, 255)
 88. SetColor(BusyWrite,									0, 		255, 	0)		// Light bright blue 	RGB(7, 255, 255)
 89. 
 90. #File Colors
 91. SetFileColor(All,									0,		0,		0)		// Black 				RGB(0, 0, 0)
 92. SetFileColor(Movable,								20,		87,		229)	// Dark blue			RGB(20, 87, 229)
 93. 
 94. SetFileColor(Processed and not(Fragmented),			0, 		255, 	0)		// Green 				RGB(0, 255, 0)
 95. SetFileColor(Processed and Fragmented,				0, 		223, 	255)	// Bright Blue 			RGB(0, 223, 255)
 96. 
 97. SetFileColor(Fragmented,							229, 	229, 	0)		// Yellow 				RGB(229, 229, 0)
 98. SetFileColor(not(Movable),							204, 	92, 	92)		// Red 					RGB(204, 92, 92)
 99. 
100. SetFileColor(Selected,								175,	198,	247)	// Light blue 			RGB(175, 198, 247)
101. SetFileColor(Selected and Fragmented,				255,	255,	0)		// Pure yellow 			RGB(255, 255, 0)
102. SetFileColor(Selected and not(Movable),				255,	115,	115)	// Light red			RGB(255, 115, 115) 
103. 
104. /* empty */
105. 
106. 
107. 
108. # Processes:
109. 	# This Process
110. 	SetVariable(RunProcessID,ProcessID)
111. 
112. 	# Kill other instances
113. 	/* Kill other MyDefrag Instances. */
114. 	/* Oops! This commits suicide. */
115. 	/* 	RunProgram("..\pskill.exe", "-t MyDefrag.exe") */
116. 	/* Pause(10) */
117. 	
118. 	/* If another instance of MyDefrag is already running then exit. */
119. 	/* Oops again. I don't know if this cause the hidden instance */
120. 	/* to hang around after the run. */
121. 	/* Warning: <alt><Run><Exit> seems to hide the instance not end it. */
122. 	/* The task mananager may be needed. This is under investigation. */
123. 
124. 	# OtherInstances
125. 	
126. OtherInstances(exit)
127. 
128. # OtherInstances
129. 	
130. # OtherInstances(exit)
131. 
132. 
133. 
134. 	# StatusBar
135. 	StatusBar(Status Path MouseOver)
136. 	# OtherInstances
137. 	
138. # OtherInstances(exit)
139. 
140. 	
141. 	# Power management
142. 	/* SetScreenPowerSaver(off) */
143. 	# Power management
144. 
145. 	/* SetScreenPowerSaver(off) */
146. 
147. 	# Power management
148. 
149. 	/* SetScreenPowerSaver(off) */
150. 
151. 
152. 
153. 
154. /* ---------------------------------------------------------- */
155. # Script Directory Location:
156. SetVariable(ScriptDir,"..\")
157. 
158. /* SetVariable(ScriptDir,"..\") */
159. /* SetVariable(ScriptDir,"G:\Dev\MdmDefrag\TaylorDOVs0_2\ScriptsYearly") */
160. /* SetVariable(ScriptDir,"E:\Ide\MyDefrag\MyDefrag\MdmScriptMyDefragVs4_3_1\") */
161. 
162. 
163. 
164. /* ---------------------------------------------------------- */
165. # DISPLAY - What text is displayed in Titlebar, data fields and reports.
166. 
167. 
168. /* The variable FileStepDescription get set to */
169. /* the messages below according to the Zone File */
170. /* step the defrag is on. */
171. 
172. /* The titlebar is organized in these areas: */
173. 
174. /* SwProductVs. */
175. /* Volume description. */
176. /* Zone description. */
177. /* File Processing Step (here.) */
178. /* Server and Script names. */
179. /* Run Date, Time and Elapsed (Bug) */
180. 
181. /* Shown in the Title / Banner / App Heading */
182. 
183. SetVariable(SeverStepDescription,	"")
184. SetVariable(VolumeStepDescription,	"")
185. SetVariable(ZoneStepDescription,	"")
186. SetVariable(FileStepDescription,	"")
187. SetVariable(RunStepDescription,		"")
188. 
189. # Display fields you can set for your personal tastes / needs:
190. 
191. /* ---------------------------------------------------------- */
192. # ZONE. Process One Zone (the steps and messages displayed. */
193. 
194. SetVariable(FileStepDescriptionZoneStart, 			"Zone started.")
195. 
196. /* "Your Zone Pre (before)Processing." */
197. SetVariable(FileStepDescriptionYourZonePre, 		"!FileStepDescriptionZoneStart!") 		
198. 
199. SetVariable(FileStepDescriptionFileSelect,			"Selecting Files.")
200. 
201. /* "Your Pre Sort File Actions." */
202. SetVariable(FileStepDescriptionYourFileActionsPre, 	"!FileStepDescriptionFileSelect!")
203. 
204. SetVariable(FileStepDescriptionFileActionStart, 	"File Actions started.")
205. 
206. /* "Your Post Sort File Actions." */
207. SetVariable(FileStepDescriptionYourFileActionsPost, "!FileStepDescriptionFileActionStart!")
208. 
209. SetVariable(FileStepDescriptionFileActionEnd, 		"File Actions completed.")
210. 
211. /* "Your Zone Post (after) Processing." */
212. SetVariable(FileStepDescriptionYourZonePost, 		"!FileStepDescriptionFileActionEnd!") 		
213. 
214. SetVariable(FileStepDescriptionFileActionGap, 		"Calculating Gap.")
215. 
216. SetVariable(FileStepDescriptionZoneEnd, 			"Zone finished.")
217. 
218. /* Pattern: SetVariable(FileStepDescriptionXXX, 	"FileStepDescriptionXXX") */
219. 
220. /* Note: If you add custom script code in the PRE and POST areas then at that */
221. /* time you fill in the messages above as appropriate. */
222. 
223. /* empty */
224. 
225. /* ---------------------------------------------------------- */
226. # Regarding Volume Names/Labels
227. 
228. /* FYI. The Volume names / drive letters need to be correct for your system. */
229. /* It is repeated here for infomation about fields used above. */
230. /* Set your values in "SettingsYours\SettingsYoursVolumeNames.MyDc" */
231. 
232. 	/* SetVariable(VolumeSys,"!VolumeNamePrefix!Sys") */
233. 	/* SetVariable(VolumeDev,"!VolumeNamePrefix!Dev") */
234. 	/* SetVariable(VolumeData,"!VolumeNamePrefix!Data") */
235. 	/* SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive") */
236. 
237. 	/*		or just */
238. 			
239. 	/* SetVariable(VolumeSys,"C:") */
240. 	/* SetVariable(VolumeDev,"E:") */
241. 
242. /* ---------------------------------------------------------- */
243. # BANNER DEFINITION
244. /* SetVariable(Heading, "Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! || !FileStepDescription! ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskYearly on 2021-10-24 14:34:14 0:00:00") */
245. 
246. # How to build them: (documentation)
247. 
248. /* Here is how is one pattern not used: */
249. /* SetVariable(Heading, "|") */
250. /* SetVariable(Heading, "!Heading! Vol: !VolumeStepDescription!") */
251. /* SetVariable(Heading, "!Heading! Zone: !ZoneStepDescription!") */
252. /* SetVariable(Heading, "!Heading! !FileStepDescription!") */
253. /* SetVariable(Heading, "!Heading!  ||!VolumeNamePrefix! - !ServerNameFull! - DefragDevDiskYearly") */
254. /* SetVariable(Heading, " on 2021-10-24 14:34:14 0:00:00") */
255. /* SetVariable(Heading, "!Heading!|") // spacers. */
256. 
257. /* A typical banner field list: */
258. # Appearing in Title('Vol: !
259. # VolumeCurrent
260. # ! Zone: !
261. # ZoneCurrentDescription
262. # ! !
263. # ZoneCurrent
264. # ! of !
265. # ZoneCount
266. # ! || Free: Vol: !
267. # VolumeFreePerUsed
268. # !% Zone: !
269. # ZoneFreePerUsed
270. # !% || Script: !
271. # ScriptTitle
272. # ! System: !
273. # VolumeNamePrefix
274. # ! !
275. # ServerNameFull
276. # ! !
277. # Date
278. # ! !
279. # Time
280. # ! !
281. # RunTime
282. # !')
283. /* . */
284. 
285. 
286. /* Progress Display */
287. SetVariable(ZoneListByLine, 	"Volume start.")
288. SetVariable(ZoneStepByLine, 	"")
289. 
290. /* There is 6 digit decimal precision so by using */
291. /* 1Mb the full number is displayed in a much more */
292. /* readable form. */
293. 
294. SetVariable(DisplayUnitDivisor, 	1000000) // 1MB.
295. 
296. /* ---------------------------------------------------------- */
297. # SERVER INFORMATION
298. 
299. 	/* ServerName (IE. Computer name or number.) not used. */
300. 	/* System99 */
301. 		# SetVariable(ServerName,"Pc15")
302. 
303. 		# Server Names
304. 
305. # ???
306. 
307. # IMPORTANT: VOLUME NAME: 
308. 
309. 	# SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
310. 	# SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
311. 	# SetVariable(VolumeData,"!VolumeNamePrefix!Data")
312. 	# SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
313. 
314. 	#    or this:
315. 	
316. 	
317. 	# SetVariable(VolumeSys,"C:")
318. 	# SetVariable(VolumeDev,"C:")
319. 
320. /* empty */
321. 
322. 
323. 
324. 	
325. 	/* Descriptive Information so maybe */
326. 	/* VolumeNamePrefix (IE. Person or company initials) not used. */
327. 	/* "Xyz" */
328. 		# SetVariable(VolumeNamePrefix,"Mdm")
329. 
330. 		# VolumeNamePrefix
331. 
332. /* Descriptive Information so maybe */
333. /* VolumeNamePrefix (IE. Person or company initials) not used. */
334. /* "Xyz" */
335. 	SetVariable(VolumeNamePrefix,"Mdm")
336. 
337. 	/* Server name full is usually the server and computer combined. not used. */
338. 	SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
339. 
340. /* Descriptive Information so maybe */
341. /* VolumeNamePrefix (IE. Person or company initials) not used. */
342. /* "Xyz" */
343. 	# SetVariable(VolumeNamePrefix,"Mdm")
344. 
345. 
346. 
347. 	/* Server name full is usually the server and computer combined. not used. */
348. 
349. 		SetVariable(ServerNameFull,"!VolumeNamePrefix!!ServerName!")
350. 	
351. 	# VOLUME
352. SetVariable(SeverStepDescription, 	"!ServerNameFull!")
353. SetVariable(VolumeStepDescription, 	"")
354. SetVariable(ZoneStepDescription, 	"")
355. SetVariable(FileStepDescription, 	"")
356. # BANNER SET
357. 
358. # DATE TIME RUN ELP
359. 
360. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:14 0:00:00")
361. /* Xinclude "..\BannerSet.MyDc"X */
362. /* pause(1) */
363. 
364. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
365. 
366. Title('!Heading!')
367. /* pause(1) */
368. 
369. /* NOTE: Can't round or truncate to integer precision. */
370. 
371. /* pause(2) */
372. 
373. /* ---------------------------------------------------------- */
374. # VOLUMES
375. /* ---------------------------------------------------------- */
376. 
377. 	# Volume Do Current Clear
378. 
379. /* ---------------------------------------------------------- */
380. # Current Values.
381. 	SetVariable(VolumeLabel, "NotSet")
382. 	SetVariable(VolumeDescription, "")
383. 
384. 	SetVariable(VolumeCount, 0)
385. 	SetVariable(VolumeNoCurrent, 0)
386. 	SetVariable(VolumeNoAdjCurrent, 0)
387.   	SetVariable(VolumeCurrentAjust, 0) // not used
388. 
389. /* ---------------------------------------------------------- */
390. # OS Disk Usage.
391. 
392. /* Percentage of disk used by OS */
393. 
394. 	SetVariable(OsPer, 0.18)
395. 
396. 	     SetVariable(ZoneCountOs, 5)
397. 
398.        SetVariable(ZoneCountType, 0) // not used
399.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
400. 
401. 	    SetVariable(ZoneCountSys, 2)
402. 	    SetVariable(ZoneCountDev, 7)
403. 
404. 	   SetVariable(ZoneCountData, 0)
405. 	SetVariable(ZoneCountArchive, 0)
406. 	
407. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
408. 
409. /* ---------------------------------------------------------- */
410. # Volume Totals
411. 	# USED:
412. 	/* Current total volume space used */
413. 	SetVariable(VolumeZoneUsed, 			0)
414. 	/* percentage */
415. 	SetVariable(VolumeZoneUsedPer, 			0)
416. 
417. 	# FREE:
418. 	/* Current total of free space used */
419. 	SetVariable(VolumeFreeRequested, 		0)
420. 	/* percentage */
421. 	SetVariable(VolumeFreeRequestedPer, 	0)
422. 
423. 	/* Current total of free space used */
424. 	SetVariable(VolumeFreeUsed, 			0)
425. 	/* percentage */
426. 	SetVariable(VolumeFreeUsedPer, 			0)
427. 	
428. /* ---------------------------------------------------------- */
429. # Volume Free Space Proportional Used Space vs Volume Size.
430. 	/* We only want to use a ratio of the free space relative to the volume. */
431. 	/* We could just use percentages of the total free space as well. */
432. 
433. 	/* SetVariable(VolumeFreeAdj, 		1) */
434. 	
435. 	SetVariable(VolumeFreeAdj,				(VolumeFree * (VolumeUsed / VolumeSize)))
436. 
437. /* ---------------------------------------------------------- */
438. # ZONES
439. 
440. 	SetVariable(ZoneNoCurrent, 0)
441. 	SetVariable(ZoneNoAdjCurrent, 0)
442. 	SetVariable(ZoneCurrentAjust, 0)
443. 
444. 	# Zone Do Current Clear
445. 
446. SetVariable(ZoneTypeSelectCurrent, 		"")
447. 
448. SetVariable(ZoneBeginCurrent, 			0)
449. SetVariable(ZoneBeginPerCurrent, 		0)
450. SetVariable(ZoneEndCurrent, 			0)
451. SetVariable(ZoneEndPerCurrent, 			0)
452. 
453. SetVariable(ZoneSizeCurrent,			0)
454. SetVariable(ZoneSizePerCurrent,			0)
455. 
456. SetVariable(ZoneGapRequestedCurrent,	0)
457. SetVariable(ZoneGapRoundedCurrent, 		0)
458. SetVariable(ZoneGapAdjustedCurrent, 	0)
459. SetVariable(ZoneGapAvailableCurrent, 	0)
460. SetVariable(ZoneGapCurrent,				0)
461. SetVariable(ZoneGapUsedCurrent, 		0)
462. 
463. SetVariable(ZoneGapActualCurrent, 		0)
464. SetVariable(ZoneGapActualPerCurrent, 	0)
465. 
466. SetVariable(ZoneSizeActual, 			0)
467. SetVariable(ZoneSizeActualCurrent,		0)
468. 
469. SetVariable(ZoneEndActual, 				0)
470. SetVariable(ZoneEndActualCurrent,		0)			
471. SetVariable(ZoneSizeActualPerCurrent, 	0)
472.       
473. SetVariable(ZoneFilesFolders,			0)
474. SetVariable(ZoneFilesFoldersPer,		0) 
475. 
476. SetVariable(ZoneFragments,				0)
477. SetVariable(ZoneFragmentsPer,			0) 
478. 		
479. SetVariable(ZoneEndActualCurrent, 		0)
480. SetVariable(ZoneEndActualPerCurrent, 	0)
481. 
482. # Gap Calculation Methodology:
483. 	# Requested
484. 	SetVariable(GapRequested, 			0) 
485. 	SetVariable(GapRequestedStd, 		0) 
486. 	SetVariable(GapRequestedMft, 		0) 
487. 	SetVariable(GapRequestedOs, 		0) 
488. 	SetVariable(GapRequestedOriginal, 	0) 
489. 	
490. 	# Gap Adjustments
491. 	SetVariable(GapRounded, 			0)
492. 	# SetVariable(GapAdjusted, 			0)
493. 	SetVariable(GapAvailable, 			0)
494. 	SetVariable(GapCurrent, 			0)
495. 	SetVariable(GapActual, 				0)
496. 	SetVariable(GapUsed, 				0)
497. 	
498. 	# Gap Adjustments
499. 	SetVariable(GapRoundedLoc, 			0)
500. 	# SetVariable(GapAdjustedLoc, 		0)
501. 	SetVariable(GapAvailableLoc, 		0)
502. 	SetVariable(GapCurrentLoc, 			0)
503. 	SetVariable(GapActualLoc,			0)
504. 	SetVariable(GapUsedLoc,				0)
505. 	
506. 	# Space usage
507. 	SetVariable(ZoneFreePerRequested, 	0)
508. 	SetVariable(ZoneFreePerUsed, 		0)
509. 
510. # Gap Size & Rounding
511. 	SetVariable(ZoneGapSizePer, 		0)
512. 	SetVariable(ZoneVolRoundUpPer, 		0)
513. 	
514. 	# Free Space
515. 	SetVariable(ZoneFreeUsedPer, 		0)
516. 	SetVariable(ZoneFreeRequestedPer, 	0)
517. 
518. 
519. 	SetVariable(ZoneLabel, "Volume")
520. 	SetVariable(ZoneDescription, "Analysis...")
521. 	# BANNER SET
522. 
523. # DATE TIME RUN ELP
524. 
525. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:14 0:00:00")
526. /* Xinclude "..\BannerSet.MyDc"X */
527. /* pause(1) */
528. 
529. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
530. 
531. Title('!Heading!')
532. /* pause(1) */
533. 
534. /* NOTE: Can't round or truncate to integer precision. */
535. 
536. 
537. 	
538. 	  
539. 	SetVariable(VolumeLabel, "NotSet")
540. 	SetVariable(VolumeDescription, "")
541. 
542. 	SetVariable(FileStepDescription,"Initializing run...")
543. 	# BANNER SET
544. 
545. # DATE TIME RUN ELP
546. 
547. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:14 0:00:00")
548. /* Xinclude "..\BannerSet.MyDc"X */
549. /* pause(1) */
550. 
551. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
552. 
553. Title('!Heading!')
554. /* pause(1) */
555. 
556. /* NOTE: Can't round or truncate to integer precision. */
557. 
558. 
559. /* ---------------------------------------------------------- */
560. # VOLUME TYPES
561. 
562. 	/* Volumes */
563. 	/* . */
564. 	/* Only those were fully implemented: */
565. 	/* Sys */
566. 	/* Dev */
567. 	/* . */
568. 	/* Common types of volumes: */
569. 	/* Data */
570. 	/* Archive */
571. 	/* . */
572. 	/* Other historical volumes: */
573. 	/* Test */
574. 	/* Live */
575. 	/* Server */
576. 	/* Client */
577. 	/* SysUtils */
578. 	/* . */
579. 
580. # IMPORTANT: VOLUME NAME: SET YOUR:
581. 	/* VOLUME NAMES IN SettingsYours\SettingsYoursVolumeNames.MyDc */
582. 	/* 		or    			*/
583. 	/* VOLUME NAME (one only for override) in SettingsYours\SettingsYoursVolume.MyDc */
584. 	/* 		or here also 	*/
585. 	SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
586. 	SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
587. 
588. 	/* SetVariable(VolumeSys,"C:") */
589. 	/* SetVariable(VolumeDev,"E:") */
590. 
591. 	/* These are for dedicated disks. */
592. 	/* So it means JUST Data or JUST Archives. */
593. 
594. 	SetVariable(VolumeData,"!VolumeNamePrefix!Data")
595. 	SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
596. 	
597. 	# IMPORTANT: VOLUME NAME: 
598. 
599. 	# SetVariable(VolumeSys,"!VolumeNamePrefix!Sys")
600. 	# SetVariable(VolumeDev,"!VolumeNamePrefix!Dev")
601. 	# SetVariable(VolumeData,"!VolumeNamePrefix!Data")
602. 	# SetVariable(VolumeArchive,"!VolumeNamePrefix!Archive")
603. 
604. 	#    or this:
605. 	
606. 	
607. 	# SetVariable(VolumeSys,"C:")
608. 	# SetVariable(VolumeDev,"C:")
609. 
610. 
611. # SetVariable(VolumeSys,"C:")
612. 
613. 
614. 
615. /* ---------------------------------------------------------- */
616. # OS Disk Usage.
617. /* Percentage of disk used by OS */
618. 
619. 	SetVariable(OsPer, 0.18)
620. 
621. 	     SetVariable(ZoneCountOs, 5)
622. 
623.        SetVariable(ZoneCountType, 0) // not used
624.       SetVariable(ZoneCountVolume, ZoneCountOs + ZoneCountType)
625. 
626. 	    SetVariable(ZoneCountSys, 2)
627. 	    SetVariable(ZoneCountDev, 7)
628. 
629. 	   SetVariable(ZoneCountData, 0)
630. 	SetVariable(ZoneCountArchive, 0)
631. 	
632. 	/* SetVariable(GapCalc, VolumeFreeAdj * ZoneAdjRoundUp) */
633. 
634. /* ---------------------------------------------------------- */
635. # ZONE TYPES. 
636. /* ---------------------------------------------------------- */
637. 	/* Type Labels, Descriptions, Gaps and Rounding. */
638. 	/* Load the Zone Definitions */
639. 	/* These are file categories basically */
640. 	/* and are maintained in a single file */
641. 	/* for ease of maintenance. Here: */
642. 	
643. 	/* ---------------------------------------------------------- */
644. # ROUNDING factors:
645. 
646. /* HERE if you want to tweak how type the Gaps are if growth is slow. */
647. /* HERE if your DISK IS VERY FULL */
648. /* This is where you can tweak growth rounding if the Volume gets really full. */
649. /* You don't have to use these, you can use actual percentages in the Zone section. */
650. 
651. /* Note: Volume and Gap Sizes are paired to a degree and */
652. /* set relative to each other. */
653. 	
654. 	      SetVariable(VolumeRoundUpNone, 	1)
655. 	      SetVariable(VolumeRoundUpTiny, 	0.005)
656. 	     SetVariable(VolumeRoundUpSmall, 	0.01)
657. 	    SetVariable(VolumeRoundUpMedium, 	0.02)
658. 	     SetVariable(VolumeRoundUpLarge, 	0.03)
659. 	SetVariable(VolumeRoundUpExtraLarge, 	0.05)
660. 	
661. 	    SetVariable(VolumeRoundUpBlogBu, 	0.10)
662. 	
663. 	      SetVariable(ZoneGapSizeNone, 		0)
664. 	      SetVariable(ZoneGapSizeTiny, 		0.005)
665. 	     SetVariable(ZoneGapSizeSmall, 		0.01)
666. 	    SetVariable(ZoneGapSizeMedium, 		0.05)
667. 	     SetVariable(ZoneGapSizeLarge, 		0.10)
668. 	SetVariable(ZoneGapSizeExtraLarge, 		0.15)
669. 		
670. 	    SetVariable(ZoneGapSizeBlobBu, 		0.10)
671. 
672. /* ---------------------------------------------------------- */
673. # ZONE SETTINGS:
674. /* ---------------------------------------------------------- */
675. /* These are the Zone Names */
676. /* Regular is at the end but otherwise */
677. /* this is in the order they appear on disk */
678. 
679. # Os Programs.
680. SetVariable(ZoneLabelBoot, 				"Boot")
681. SetVariable(ZoneLabelBootData, 				"BootData")
682. SetVariable(ZoneLabelProgramHints,			"ProgramHints")
683. SetVariable(ZoneLabelProgramHintsData,			"ProgramHintsData")
684. SetVariable(ZoneLabelPrograms,				"Programs")
685. SetVariable(ZoneLabelProgramsWindows,			"ProgramsWindows")
686. SetVariable(ZoneLabelProgramsData,			"ProgramsData")
687. # Moved to after Mft & Dir.
688. SetVariable(ZoneLabelPageHiperDump,			"PageHiperDump")
689. 
690. # Os Mft & Directories.
691. SetVariable(ZoneLabelMft,				"MFT")
692. SetVariable(ZoneLabelDir,				"DIR")
693. 
694. # Standard Zones.
695. SetVariable(ZoneLabelIdeScripts, 			"IdeScripts")
696. SetVariable(ZoneLabelDevToDo, 				"DevToDo")
697. SetVariable(ZoneLabelLinksCorp, 			"LinksCorp")
698. SetVariable(ZoneLabelPeople, 				"People")
699. # MFT.
700. # DIR.
701. # Games. 
702. SetVariable(ZoneLabelGames, 				"Games")
703. SetVariable(ZoneLabelShares, 				"Shares")
704. SetVariable(ZoneLabelSystemOtherData, 			"SystemOtherData")
705. SetVariable(ZoneLabelReference, 			"Reference")
706. 
707. 
708. # Sys.
709. # People.
710. # OS, Mft, Dir.
711. # Games.
712. SetVariable(ZoneLabelRegular, 				"Regular")
713. 
714. # Common.
715. SetVariable(ZoneLabelSpaceHogs, 			"SpaceHogs")
716. SetVariable(ZoneLabelArchivesBu, 			"ArchivesBu")
717. 
718. /* ---------------------------------------------------------- */
719. /* Use however you like */
720. 
721. # Os Programs.
722. SetVariable(ZoneDescriptionBoot, 			"!ZoneLabelBoot!")
723. SetVariable(ZoneDescriptionBootData, 			"!ZoneLabelBootData!")
724. SetVariable(ZoneDescriptionProgramHints, 		"!ZoneLabelProgramHints!")
725. SetVariable(ZoneDescriptionProgramHintsData, 		"!ZoneLabelProgramHintsData!")
726. SetVariable(ZoneDescriptionPrograms, 			"!ZoneLabelPrograms!")
727. SetVariable(ZoneDescriptionProgramsWindows, 		"!ZoneLabelProgramsWidows!")
728. SetVariable(ZoneDescriptionProgramsData, 		"!ZoneLabelProgramsData!")
729. SetVariable(ZoneDescriptionPageHiperDump, 		"!ZoneLabelPageHiperDump!")
730. 
731. # Os Mft & Directories.
732. SetVariable(ZoneDescriptionMft, 			"!ZoneLabelMft!")
733. SetVariable(ZoneDescriptionDir, 			"!ZoneLabelDir!")
734. 
735. # Standard Zones:
736. SetVariable(ZoneDescriptionIdeScripts, 			"!ZoneLabelIdeScripts!")
737. SetVariable(ZoneDescriptionDevToDo, 			"!ZoneLabelDevToDo!")
738. SetVariable(ZoneDescriptionLinksCorp, 			"!ZoneLabelLinksCorp!")
739. SetVariable(ZoneDescriptionPeople, 			"!ZoneLabelPeople!")
740. # MFT.
741. # DIR.
742. # Games. 
743. SetVariable(ZoneDescriptionGames, 			"!ZoneLabelGames!")
744. SetVariable(ZoneDescriptionShares, 			"!ZoneLabelShares!")
745. SetVariable(ZoneDescriptionSystemOtherData, 		"!ZoneLabelSystemOtherData!")
746. SetVariable(ZoneDescriptionReference, 			"!ZoneLabelReference!")
747. 
748. # Sys.
749. # People.
750. # OS, Mft, Dir.
751. SetVariable(ZoneDescriptionRegular, 			"!ZoneLabelRegular!")
752. 
753. SetVariable(ZoneDescriptionSpaceHogs, 			"!ZoneLabelSpaceHogs!")
754. SetVariable(ZoneDescriptionArchivesBu, 			"!ZoneLabelArchivesBu!")
755. 
756. /* ---------------------------------------------------------- */
757. /* This rounds up to even locations on the volume to keep */
758. /* the location of data relatively stable during fluctuation. */
759. 
760. /* NOTE: For Volume specifice settings you would have to copy these */
761. /* next two sections and use them in the SettingsYours\SettingsYours for each Volume. */
762. /* You would need a copy of these two to use in a Reset function between Volumes. */
763. 
764. # Os Programs.
765. SetVariable(ZoneVolRoundUpBoot, 		"!VolumeRoundUpSmall!")
766. SetVariable(ZoneVolRoundUpProgramHints, 	"!VolumeRoundUpSmall!")
767. SetVariable(ZoneVolRoundUpPrograms, 		"!VolumeRoundUpMedium!")
768. SetVariable(ZoneVolRoundUpPageHiperDump,	"!VolumeRoundUpSmall!")
769. 
770. # Os Mft & Directories.
771. SetVariable(ZoneVolRoundUpMft,			"!VolumeRoundUpTiny!")
772. SetVariable(ZoneVolRoundUpDir,		 	"!VolumeRoundUpLarge!")
773. 
774. # Standard Zones.
775. SetVariable(ZoneVolRoundUpIdeScripts, 		"!VolumeRoundUpSmall!")
776. SetVariable(ZoneVolRoundUpDevToDo, 		"!VolumeRoundUpSmall!")
777. SetVariable(ZoneVolRoundUpLinksCorp, 		"!VolumeRoundUpSmall!")
778. SetVariable(ZoneVolRoundUpPeople, 		"!VolumeRoundUpMedium!")
779. # MFT.
780. # DIR.
781. # Games. 
782. # ToDo.............
783. SetVariable(ZoneVolRoundUpGames, 		"!VolumeRoundUpSmall!")
784. SetVariable(ZoneVolRoundUpShares, 		"!VolumeRoundUpSmall!")
785. SetVariable(ZoneVolRoundUpSystemOtherData, 	"!VolumeRoundUpSmall!")
786. SetVariable(ZoneVolRoundUpReference, 		"!VolumeRoundUpMedium!")
787. 
788. # Sys.
789. # People.
790. # OS, Mft, Dir.
791. # Games.
792. SetVariable(ZoneVolRoundUpRegular, 		"!VolumeRoundUpMedium!")
793. 
794. # Common.
795. SetVariable(ZoneVolRoundUpSpaceHogs, 		"!VolumeRoundUpMedium!")
796. SetVariable(ZoneVolRoundUpArchivesBu, 		"!VolumeRoundUpTiny!")
797. 
798. /* ---------------------------------------------------------- */
799. /* Your Zone Gap consumption of free space as a percentage. */
800. /* Clearly this can not exceed 100%. Keep it under 99%. */
801. 
802. # Os Programs.
803. SetVariable(ZoneGapSizeBoot, 				"!ZoneGapSizeTiny!")
804. SetVariable(ZoneGapSizeProgramHints,	 		"!ZoneGapSizeTiny!")
805. SetVariable(ZoneGapSizePrograms, 			"!ZoneGapSizeSmall!")
806. SetVariable(ZoneGapSizePageHiperDump, 			"!ZoneGapSizeSmall!")
807. 
808. # Mft & Directories.
809. SetVariable(ZoneGapSizeMft, 				"!ZoneGapSizeTiny!")
810. SetVariable(ZoneGapSizeDir,		 		"!ZoneGapSizeTiny!")
811. 
812. # Standard Zones.
813. SetVariable(ZoneGapSizeIdeScripts, 			"!ZoneGapSizeMedium!")
814. SetVariable(ZoneGapSizeDevToDo, 			"!ZoneGapSizeMedium!")
815. SetVariable(ZoneGapSizeLinksCorp, 			"!ZoneGapSizeMedium!")
816. SetVariable(ZoneGapSizePeople, 				"!ZoneGapSizeMedium!")
817. # MFT.
818. # DIR.
819. # Games. 
820. # ToDo.............
821. SetVariable(ZoneGapSizeGames, 				"!ZoneGapSizeMedium!")
822. SetVariable(ZoneGapSizeShares, 				"!ZoneGapSizeMedium!")
823. SetVariable(ZoneGapSizeSystemOtherData, 		"!ZoneGapSizeMedium!")
824. SetVariable(ZoneGapSizeReference, 			"!ZoneGapSizeSmall!")
825. 
826. # Sys.
827. # People.
828. # OS, Mft, Dir.
829. # Games.
830. SetVariable(ZoneGapSizeRegular, 			"!ZoneGapSizeMedium!")
831. 
832. # Common.
833. SetVariable(ZoneGapSizeSpaceHogs, 			"!ZoneGapSizeMedium!")
834. SetVariable(ZoneGapSizeArchivesBu, 			"!ZoneGapSizeTiny!")
835. 
836. /* ---------------------------------------------------------- */
837. # ZONE CALCULATION METHODS:
838. # OS ZONE SETTINGS:
839. /* ---------------------------------------------------------- */
840. 
841. 	/* ---------------------------------------------------------- */
842. 	# VOLUME MFT Location.
843. 	/* The Volume Location of the MFT as a percentage of the Volume. */
844. 		
845. 		SetVariable(MftVolumeRoundUp, 		"!VolumeRoundUpLarge!")
846. 		SetVariable(MftVolumeGapSize, 		"!ZoneGapSizeTiny!")
847. 		
848. 		# MFT CALCULATION METHODS.
849. 			# STANDARD Method.
850. 			/* IMPORTANT: Standard method currently in use. */
851. 			/* IE: The others below are ignored but instructive. */
852. 			/* None of the following settings are used, hence zero. */
853. 			SetVariable(MftPer, 			0)
854. 			SetVariable(MftLocation, 		0)
855. 			
856. 			# MFT Method.
857. 			/* Place files at X% (MftPerSys) into the data on the Volume. */
858. 			/* This is really tied the ratio of executables to data and blobs. */
859. 			# SetVariable(MftPer, 			0.30)
860. 			# SetVariable(MftLocation, 		1000000000)
861. 			# SetVariable(MftGapSize, 		"!ZoneGapSizeLarge!")
862. 		
863. 			# FIXED Method.
864. 			# SetVariable(MftLocation, 		1000000000) // (IE. Yours)
865. 			# SetVariable(MftPer, 			MftLocation / VolumeSize)
866. 			
867. 			# ORIGINAL Method.
868. 			/* DEPRECIATED, not in use. */
869. 			/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
870. 			# SetVariable(MftPer, 			0.30)
871. 		
872. 		# ROUNDING.	
873. 		# SetVariable(MftLocation,			RoundUp(MftLocation, VolumeSize * MftVolumeRoundUp))
874. 		
875. 		# MFT ZONE.
876. 		/* Zone Number (not used for locating MFT.) */
877. 		SetVariable(MftZone, 				4) // Insert before this zone, info only.
878. 		/* Zone 10 on the Dev Volume */
879. 	
880. 	/* ---------------------------------------------------------- */
881. 	# VOLUME SPECIFIC MFT.
882. 	/* Note: You may need to set Volume specific values for the MFT location, */
883. 	/* On these volume types do not "push" the data above the MFT table? */
884. 	/* You can use a standard gap instead. */
885. 		
886. 			/* The current Volume Type Mft Percentage */
887. 		    # SetVariable(MftPer, 				0)
888. 		    # SetVariable(MftPerTypedDefault, 			"!MftPer!")
889. 			# Volume Types:	
890. 			#         SetVariable(MftPerSys, 		0.35)
891. 			# 	    SetVariable(MftPerDev, 		0.10)
892. 			# 	   SetVariable(MftPerData, 		0.35)
893. 			# 	SetVariable(MftPerArchive, 		0.10)
894. 	
895. 	/* ---------------------------------------------------------- */
896. 	# VOLUME DIR Location.
897. 	/* The amount of Gap between Mft and Dir's, the Location of DIR. */
898. 	
899. 		/* Note: Orginally, The Gap between the MFT and Directories is fixed and tiny. */
900. 	
901. 		SetVariable(DirVolumeRoundUp, 		"!VolumeRoundUpLarge!")
902. 		SetVariable(DirVolumeGapSize, 		"!ZoneGapSizeLarge!")
903. 		
904. /* ---------------------------------------------------------- */
905. # SETTINGS YOURS
906. /* empty */
907. 
908. /* ---------------------------------------------------------- */
909. 
910. /* ---------------------------------------------------------- */
911. # STATISTICS
912. /* ---------------------------------------------------------- */
913. 
914. /* Xinclude "..\StatisticsInitialization.MyDc"X ToDo */
915. 
916. 
917. /* ---------------------------------------------------------- */
918. # GAPS
919. 	# TEST (FAILED!!!) NO BOOLEAN LOGIC AVAILABLE.
920. 	SetVariable(FlagDoNotVacate, 0)
921.  
922. /* ---------------------------------------------------------- */
923. # ZONE
924. 	SetVariable(ZoneNoCurrent, 		0)
925. 	SetVariable(ZoneNoAdjCurrent, 	0) 
926. 	SetVariable(ZoneCurrentAjust,	0)
927. 
928. 	SetVariable(ZoneListByLine, 		"Volume started.
929. ")
930. 	SetVariable(ZoneStepByLine, 		"Initialize.
931. ")
932. 	SetVariable(ZoneStatisticsDetail, 	"")
933. 
934. /* ---------------------------------------------------------- */
935. # ZONE FILE STEP (ACTIONS)
936. 	/* Nothing to set here */
937. 
938. /* ---------------------------------------------------------- */
939. # BLOB SIZE
940. 
941. 	# Size 10MB
942. 	SetVariable(BlobFileSize, 10000000)
943. 
944. /* ---------------------------------------------------------- */
945. # SKIP BLOCK
946.  
947. /* (important for run efficiency.) */
948. /* FILES: */
949. /* Day Files: 100 */
950. /* Monthly: 500 */
951. /* Yearly: 1M */
952. 
953. 	SetVariable(SkipBlockFilesDay, 100)
954. 	SetVariable(SkipBlockFilesMonth, 500)
955. 	SetVariable(SkipBlockFilesYear, 1000000)
956. 
957. 	/* Current: */
958. 	SetVariable(SkipBlockFiles,"!SkipBlockFilesMonth!")
959. 
960. /* BYTES: */
961. /* Day Bytes: 50MB */
962. /* Month Bytes: 500MB */
963. /* Year Bytes: 5GB */
964. 
965. 	  SetVariable(SkipBlockBytesDay, 50000000)
966. 	SetVariable(SkipBlockBytesMonth, 500000000)
967. 	 SetVariable(SkipBlockBytesYear, 5000000000)
968. 
969. 	/* Current: */
970. 	SetVariable(SkipBlockBytes,"!SkipBlockBytesMonth!")
971. 
972. /* ---------------------------------------------------------- */
973. # ZONE LOCATION METHODS:
974. 
975. # No 1) Standard. You can ignore this section
976. 	/* Gaps between zones are a percentage of */
977. 	/* free space auto adjusted to pack the used */
978. 	/* space closely together and for performance. */
979. 	
980. 	/* The calculation will clear the Gap */
981. 	/* and RoundUp to the fixed value present */
982. 	
983. 	SetVariable(ZoneMethodStd, 1)
984. 
985. /* The following are NOT FULLY IMPLEMENTED OR TESTED */
986. # No 2) Mft. Relative to its location.
987. 	SetVariable(ZoneMethodMft, (0-1))
988. 
989. # No 3) Os. Percentages are AFTER OsMftDir Space Used.
990. 	SetVariable(ZoneMethodOs, (0-1))
991. 
992. # No 4) Orginal Mft/Os 1-5.
993. 	SetVariable(ZoneMethodOrginal, (0-1))
994. 
995. # No 5) FIXED ZONES if you used them.
996. 	
997. 	SetVariable(ZoneMethodFixed, (0-1))
998. 	SetVariable(ZoneMethodFixedPer, (0-1))
999. 
1000. 	/* Not recommended */
1001. 	/* However doing all calcs is informative regarding what */
1002. 	/* Types of Volume data (Zones) exist. */
1003. 	
1004. 	/* Your FIXED calculation method, this can be: */
1005. 	SetVariable(ZoneMethodFixedVariantPer, (0-1))
1006. 	
1007. 	/* 1) Percentage. */
1008. 		/* So when it is 1 or On. */
1009. 		/* Not great but easy to use. */
1010. 		 
1011. 	/* 2) Fixed volume location. */
1012. 		/* When 0 or Off it is a volume location. */
1013. 		/* You will have to change: */
1014. 		/* file item xxxxxxxxx??? */
1015. 	
1016. 	/* FIXED VALUES: */
1017. 		/* SetVariable(ZoneMethodFixed, 1) */
1018. 	
1019. 		# Setting the following to a percentage or number:
1020. 		/* OS */
1021. 	    SetVariable(ZoneOsBoot, 0) // 1
1022. 	    SetVariable(ZoneOsProgramHints, 0) // 2
1023. 	    SetVariable(ZoneOsPrograms, 0) // 3
1024. 	    
1025. 	    /* MFT */
1026. 	    SetVariable(ZoneMft, 0) // Volume dependent
1027. 	    SetVariable(ZoneMftDir, 0) // Volume dependent
1028. 	
1029. 		/* Volume Sys */
1030. 	    # Os 3
1031. 	    # Mft + 2
1032. 	    SetVariable(ZoneSysRegular, 0) // 5
1033. 	    SetVariable(ZoneDevSpaceHog, 0) // 6
1034. 	
1035. 		/* Volume Dev */
1036. 	    # Os 3
1037. 	    SetVariable(ZoneDevDevToDo, 0) // 4
1038. 	    SetVariable(ZoneDevIdeScripts, 0) // 5
1039. 	    SetVariable(ZoneDevLinksCorp, 0) // 6
1040. 	    SetVariable(ZoneDevPeople, 0) // 7
1041. 	    # Mft + 2
1042. 	    SetVariable(ZoneDevShares, 0) // 10
1043. 	    SetVariable(ZoneDevSystemOtherData, 0) // 11
1044. 	    SetVariable(ZoneDevReference, 0) // 12
1045. 	    SetVariable(ZoneDevSpaceHogsArchives, 0) // 13
1046. 	
1047. 		/* Volume Archive not used currently */
1048. 		/* Volume Data not used currently */
1049. 
1050. /* ---------------------------------------------------------- */
1051. # LOGGING:
1052. /* ---------------------------------------------------------- */
1053. 
1054. 	# Log File Name:
1055. 	SetVariable(LogFileName,"!ScriptDir!$ z Logs\!MdmMyDefrag! 2021-10-24_14:34:14.log")
1056. 	/* SetVariable(LogFileName,"Defrag2021-10-24_14:34:14.txt") */
1057. 	/* SetVariable(LogFileName,"$ z Logs\Defrag2021-10-24_14:34:14.txt") */
1058. 	
1059. 	SetVariable(VolumeStatisticsSummary, "Not ready")
1060. 	SetVariable(VolumeStatisticsDetailed, "Not ready")
1061. 
1062. /* ---------------------------------------------------------- */
1063. # OVERRIDES
1064. /* ---------------------------------------------------------- */
1065. 
1066. 	# YOUR SETTINGS Volume overrides:
1067. 	/* empty */
1068. 
1069. 
1070. /* ---------------------------------------------------------- */
1071. # Create Run Log:
1072. 
1073. /* Write the header to the logfile. */
1074. 	# BANNER SET
1075. 
1076. # DATE TIME RUN ELP
1077. 
1078. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:14 0:00:00")
1079. /* Xinclude "..\BannerSet.MyDc"X */
1080. /* pause(1) */
1081. 
1082. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1083. 
1084. Title('!Heading!')
1085. /* pause(1) */
1086. 
1087. /* NOTE: Can't round or truncate to integer precision. */
1088. 
1089. 
1090. 	WriteLogfile("!LogFileName!", "Started.")
1091. 	AppendLogfile("!LogFileName!", ".")
1092. 	AppendLogfile("!LogFileName!", "!Title!")
1093. 
1094. 
1095. 	AppendLogfile("!LogFileName!", ".")
1096. 
1097. /* ---------------------------------------------------------- */
1098. /* Script Information */
1099. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-10-24 14:34:14")
1100. 	AppendLogfile("!LogFileName!", ".")
1101. 	AppendLogfile("!LogFileName!", "Script:")
1102. 	AppendLogfile("!LogFileName!", "DefragDevDiskYearly")
1103. 	AppendLogfile("!LogFileName!", ".")
1104. 	AppendLogfile("!LogFileName!", "Script Directory:")
1105. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1106. 	AppendLogfile("!LogFileName!", ".")
1107. 	AppendLogfile("!LogFileName!", "Log File:")
1108. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1109. 	AppendLogfile("!LogFileName!", ".")
1110. 
1111. /* ---------------------------------------------------------- */
1112. # Run Preprocessing Do Before.
1113. /* empty */
1114. 
1115. 
1116. 
1117. /* SkipBlock Yearly: */
1118. SetVariable(SkipBlockFiles,"!SkipBlockFilesYear!")
1119. SetVariable(SkipBlockBytes,"!SkipBlockBytesYear!")
1120. 
1121. /* Dev */
1122. # Defrag Development Volume
1123. 
1124. SetVariable(VolumeLabel,"!VolumeDev!")
1125. SetVariable(VolumeDescription,"Development")
1126. # Display Set Volume
1127. 
1128. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1129. SetVariable(ZoneStepDescription,	"")
1130. SetVariable(FileStepDescription,	"")
1131. 
1132. SetVariable(ZoneListByLine, 		"Volume started.
1133. ")
1134. SetVariable(ZoneStepByLine, 		"Pending.")
1135. 
1136. # BANNER SET
1137. 
1138. # DATE TIME RUN ELP
1139. 
1140. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:14 0:00:00")
1141. /* Xinclude "..\BannerSet.MyDc"X */
1142. /* pause(1) */
1143. 
1144. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1145. 
1146. Title('!Heading!')
1147. /* pause(1) */
1148. 
1149. /* NOTE: Can't round or truncate to integer precision. */
1150. 
1151. AppendLogfile("!LogFileName!", "!Title!")
1152. 
1153. 
1154. 
1155. pause(2)
1156. 
1157. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1158. 
1159. SetVariable(ZoneListByLine, "")
1160. SetVariable(ZoneFooter, "")
1161. 
1162. # This script is part of the standard disk configuration
1163. # Author: David G. Horsman (DBA MacroDM) (C) 2019
1164. # based on MyDefrag distribution.
1165. 
1166. /* Progress Display */
1167. SetVariable(ZoneListByLine, 	"Volume start.
1168. ")
1169. SetVariable(ZoneStepByLine, 	"
1170. ")
1171. 
1172. # VOLUME INFORMATION
1173. 
1174. SetVariable(VolumeNoCurrent, VolumeNoCurrent + 1)
1175. SetVariable(VolumeNoAdjCurrent, VolumeNoCurrent + VolumeCurrentAjust)
1176. 
1177. SetVariable(ZoneNoCurrent, 		0)
1178. SetVariable(ZoneNoAdjCurrent, 	0) 
1179. SetVariable(ZoneCurrentAjust,	0)
1180. 
1181. SetVariable(ZoneListByLine, 		"Volume started.
1182. ")
1183. SetVariable(ZoneStepByLine, 		"Initialize.
1184. ")
1185. SetVariable(ZoneStatisticsDetail, 	"")
1186. 
1187. SetVariable(ZoneStepNoCurrent, 0)
1188. 
1189. 
1190. # Zone Do Current Clear
1191. 
1192. SetVariable(ZoneTypeSelectCurrent, 		"")
1193. 
1194. SetVariable(ZoneBeginCurrent, 			0)
1195. SetVariable(ZoneBeginPerCurrent, 		0)
1196. SetVariable(ZoneEndCurrent, 			0)
1197. SetVariable(ZoneEndPerCurrent, 			0)
1198. 
1199. SetVariable(ZoneSizeCurrent,			0)
1200. SetVariable(ZoneSizePerCurrent,			0)
1201. 
1202. SetVariable(ZoneGapRequestedCurrent,	0)
1203. SetVariable(ZoneGapRoundedCurrent, 		0)
1204. SetVariable(ZoneGapAdjustedCurrent, 	0)
1205. SetVariable(ZoneGapAvailableCurrent, 	0)
1206. SetVariable(ZoneGapCurrent,				0)
1207. SetVariable(ZoneGapUsedCurrent, 		0)
1208. 
1209. SetVariable(ZoneGapActualCurrent, 		0)
1210. SetVariable(ZoneGapActualPerCurrent, 	0)
1211. 
1212. SetVariable(ZoneSizeActual, 			0)
1213. SetVariable(ZoneSizeActualCurrent,		0)
1214. 
1215. SetVariable(ZoneEndActual, 				0)
1216. SetVariable(ZoneEndActualCurrent,		0)			
1217. SetVariable(ZoneSizeActualPerCurrent, 	0)
1218.       
1219. SetVariable(ZoneFilesFolders,			0)
1220. SetVariable(ZoneFilesFoldersPer,		0) 
1221. 
1222. SetVariable(ZoneFragments,				0)
1223. SetVariable(ZoneFragmentsPer,			0) 
1224. 		
1225. SetVariable(ZoneEndActualCurrent, 		0)
1226. SetVariable(ZoneEndActualPerCurrent, 	0)
1227. 
1228. # Gap Calculation Methodology:
1229. 	# Requested
1230. 	SetVariable(GapRequested, 			0) 
1231. 	SetVariable(GapRequestedStd, 		0) 
1232. 	SetVariable(GapRequestedMft, 		0) 
1233. 	SetVariable(GapRequestedOs, 		0) 
1234. 	SetVariable(GapRequestedOriginal, 	0) 
1235. 	
1236. 	# Gap Adjustments
1237. 	SetVariable(GapRounded, 			0)
1238. 	# SetVariable(GapAdjusted, 			0)
1239. 	SetVariable(GapAvailable, 			0)
1240. 	SetVariable(GapCurrent, 			0)
1241. 	SetVariable(GapActual, 				0)
1242. 	SetVariable(GapUsed, 				0)
1243. 	
1244. 	# Gap Adjustments
1245. 	SetVariable(GapRoundedLoc, 			0)
1246. 	# SetVariable(GapAdjustedLoc, 		0)
1247. 	SetVariable(GapAvailableLoc, 		0)
1248. 	SetVariable(GapCurrentLoc, 			0)
1249. 	SetVariable(GapActualLoc,			0)
1250. 	SetVariable(GapUsedLoc,				0)
1251. 	
1252. 	# Space usage
1253. 	SetVariable(ZoneFreePerRequested, 	0)
1254. 	SetVariable(ZoneFreePerUsed, 		0)
1255. 
1256. # Gap Size & Rounding
1257. 	SetVariable(ZoneGapSizePer, 		0)
1258. 	SetVariable(ZoneVolRoundUpPer, 		0)
1259. 	
1260. 	# Free Space
1261. 	SetVariable(ZoneFreeUsedPer, 		0)
1262. 	SetVariable(ZoneFreeRequestedPer, 	0)
1263. 
1264. 
1265. # BANNER SET
1266. 
1267. # DATE TIME RUN ELP
1268. 
1269. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:14 0:00:00")
1270. /* Xinclude "..\BannerSet.MyDc"X */
1271. /* pause(1) */
1272. 
1273. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1274. 
1275. Title('!Heading!')
1276. /* pause(1) */
1277. 
1278. /* NOTE: Can't round or truncate to integer precision. */
1279. 
1280. 
1281. # OVERRIDES
1282. # YOUR SETTINGS Volume overrides:
1283. 
1284. 
1285. # SetVariable(VolumeSys,"C:")
1286. 
1287. 
1288. # Display Set Volume
1289. 
1290. SetVariable(VolumeStepDescription, 	"!VolumeLabel! - !VolumeDescription!")
1291. SetVariable(ZoneStepDescription,	"")
1292. SetVariable(FileStepDescription,	"")
1293. 
1294. SetVariable(ZoneListByLine, 		"Volume started.
1295. ")
1296. SetVariable(ZoneStepByLine, 		"Pending.")
1297. 
1298. # BANNER SET
1299. 
1300. # DATE TIME RUN ELP
1301. 
1302. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:14 0:00:00")
1303. /* Xinclude "..\BannerSet.MyDc"X */
1304. /* pause(1) */
1305. 
1306. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1307. 
1308. Title('!Heading!')
1309. /* pause(1) */
1310. 
1311. /* NOTE: Can't round or truncate to integer precision. */
1312. 
1313. AppendLogfile("!LogFileName!", "!Title!")
1314. 
1315. 
1316. 
1317. pause(2)
1318. 
1319. # Precision issue: (!VolumeNoCurrent!-!ZoneNoCurrent!-!ZoneStepNoCurrent!) 
1320. 
1321. # LOGGING:
1322. 	# BANNER SET
1323. 
1324. # DATE TIME RUN ELP
1325. 
1326. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:14 0:00:00")
1327. /* Xinclude "..\BannerSet.MyDc"X */
1328. /* pause(1) */
1329. 
1330. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1331. 
1332. Title('!Heading!')
1333. /* pause(1) */
1334. 
1335. /* NOTE: Can't round or truncate to integer precision. */
1336. 
1337. AppendLogfile("!LogFileName!", "!Title!")
1338. 
1339. 
1340. 
1341. 
1342. 	AppendLogfile("!LogFileName!", "!Description! Started: 2021-10-24 14:34:14")
1343. 	AppendLogfile("!LogFileName!", ".")
1344. 	AppendLogfile("!LogFileName!", "Script Directory:")
1345. 	AppendLogfile("!LogFileName!", "!ScriptDir!")
1346. 	AppendLogfile("!LogFileName!", ".")
1347. 	AppendLogfile("!LogFileName!", "Log File:")
1348. 	AppendLogfile("!LogFileName!", "!LogFileName!")
1349. 	AppendLogfile("!LogFileName!", ".")
1350. 	/* AppendLogfile("!LogFileName!", "Log Header:") */
1351. 	/* AppendLogfile("!LogFileName!", "!LogHeader!") */
1352. 	/* AppendLogfile("!LogFileName!", "End of Log Header.") */
1353. 	AppendLogfile("!LogFileName!", ".")
1354. 
1355. 	AppendLogfile("!LogFileName!", "MFT Percentage: !MftPer!")
1356. 	AppendLogfile("!LogFileName!", "MFT Volume RoundUp: !MftRoundUp!")
1357. 	AppendLogfile("!LogFileName!", "MFT Gap %: !MftAdjRoundUp!")
1358. 	AppendLogfile("!LogFileName!", ".")
1359. 
1360. /* This file is where you override the above setting for */
1361. /* global settings. */
1362. /* There is a "SettingsYours\SettingsYours???.MyDc" for each volume type */
1363. /* so this is where you set the volume specific settings */
1364. /* or you can put them all in the file below. */
1365. 
1366. # Volume Preprocessing Do Before.
1367. /* empty */
1368. 
1369. 
1370. # BANNER:
1371. /* AppendLogfile("!LogFileName!", ".")
1372. AppendLogfile("!LogFileName!", "      Volume Size: !VolumeSize!")
1373. AppendLogfile("!LogFileName!", "      Volume Used: !VolumeUsed!")
1374. AppendLogfile("!LogFileName!", "Volume Used Total: !VolumeUsedTotal!")
1375. AppendLogfile("!LogFileName!", "      Volume Free: !VolumeFree!")
1376. AppendLogfile("!LogFileName!", "  Volume Free Adj: !VolumeFreeAdj!")
1377. AppendLogfile("!LogFileName!", ".")
1378. AppendLogfile("!LogFileName!", "MFT Zone: !MftZone! Location: !MftLocation! Gap: !MftGap!")
1379. AppendLogfile("!LogFileName!", ".")
1380.  */
1381. 
1382. /* Missed: ToDo: */
1383. /* Games Zone Type */
1384. 
1385. 
1386. 
1387. 
1388. SetVariable(MftZone, "Shares")
1389. 
1390. /* empty */
1391. 
1392. 
1393. # Defrag Any Complex Volume
1394. /* Complex Volume */
1395. # MyDefrag v4.0 script: Defrag Complex (Mixed or Any) Volume.
1396. 
1397. # Set Volume Detailed Statistics:
1398. 
1399. # Set Volume summary stats:
1400. 
1401. # Cluster, Sector, Block adjust for display.
1402. # Bytes per cluster is volume specific.
1403. 
1404. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1405. 
1406. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1407. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1408. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1409. 
1410. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1411. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1412. 
1413. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1414. SUMMARY: !VolumeLabel! !VolumeDescription!
1415.   
1416.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1417.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1418.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1419.          
1420.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1421.       Volume Free Adj:       !VolumeFreeAdj!
1422.     Bytes per cluster:       !BytesPerCluster! bytes
1423. 
1424.    Unfragmented Items:       !FILES200N!
1425.      Fragmented Items:       !FILES210N!
1426. 
1427.     Unfragmented Data:       !FILES202N! bytes
1428.       Fragmented Data:       !FILES212N! bytes
1429. 
1430.              All Gaps:       !GAP00N!
1431.              All gaps:       !GAP10N! bytes
1432.           Average gap:       !GAP13N! bytes
1433.            Median gap:       !GAP14N! bytes
1434.           Biggest gap:       !GAP15N! bytes
1435. ----------------------------------------------------------
1436. ") 
1437. 
1438. 
1439. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1440. VOLUME: !VolumeLabel! !VolumeDescription!
1441. ----------------------------------------------------------
1442. !VolumeStatisticsSummary!
1443. ----------------------------------------------------------
1444. DETAILS: !VolumeLabel! !VolumeDescription!
1445. ----------------------------------------------------------
1446. 
1447. SUMMARY:
1448. 
1449. Volume label/name:          !VolumeLabel!
1450. Volume mountpoint:          !MountPoint!
1451. Volume name:                !VolumeName!
1452. Volume type:                !VolumeType!
1453. 
1454. Total disk space:           !VolumeSize! bytes
1455.                             !VolumeSizeG! gigabytes
1456. 
1457. Bytes per cluster:          !BytesPerCluster! bytes
1458. Average end-begin distance: !AverageBeginEndDistance! clusters
1459.                             !AverageBeginEndDistanceP!% of volume size
1460. 
1461. ----------------------------------------------------------
1462. FRAGMENTS:
1463. 
1464. Unfragmented Items: !FILES200N!
1465.   Fragmented Items: !FILES210N!
1466.  Unfragmented Data: !FILES202N! bytes
1467.    Fragmented Data: !FILES212N! bytes
1468. Gaps:
1469.           All Gaps: !GAP00N!
1470.           All gaps: !GAP10N! bytes
1471.        Average gap: !GAP13N! bytes
1472.         Median gap: !GAP14N! bytes
1473.        Biggest gap: !GAP15N! bytes
1474. 
1475. ----------------------------------------------------------
1476. GAPS:
1477. 
1478.    ----------------------------------------------------------
1479.    Counts:
1480.                        Count      Percentage of all
1481.                 ----------------- -----------------
1482.    Small gaps   !GAP01N! !GAP01P!%
1483.    Big gaps     !GAP02N! !GAP02P!%
1484.                 ----------------- -----------------
1485.    All gaps     !GAP00N! !GAP00P!
1486. 
1487.    ----------------------------------------------------------
1488.    By size:
1489.                       Bytes          Gigabytes      Percentage of all
1490.                 ----------------- ----------------- -----------------
1491.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1492.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1493.                 ----------------- ----------------- -----------------
1494.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1495. 
1496.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1497.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1498.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1499.    ----------------------------------------------------------
1500. 
1501. ----------------------------------------------------------
1502. FILE STATISTICS:
1503. ----------------------------------------------------------
1504. 
1505. ----------------------------------------------------------
1506. ITEM COUNT:
1507. ----------------------------------------------------------
1508. Number of files and folders:
1509. 
1510.               Unfragmented       Fragmented            All
1511.    ------- ----------------- ----------------- -----------------
1512.    Files   !FILES000N! !FILES010N! !FILES020N!
1513.    Folders !FILES100N! !FILES110N! !FILES120N!
1514.    ------- ----------------- ----------------- -----------------
1515.    All     !FILES200N! !FILES210N! !FILES220N!
1516. 
1517. ----------------------------------------------------------
1518. Percentage of total:
1519. 
1520.               Unfragmented       Fragmented            All
1521.    ------- ----------------- ----------------- -----------------
1522.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1523.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1524.    ------- ----------------- ----------------- -----------------
1525.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1526. 
1527. ----------------------------------------------------------
1528. OCCUPIED SIZE on disk:
1529. ----------------------------------------------------------
1530. Bytes:
1531.               Unfragmented       Fragmented            All
1532.    ------- ----------------- ----------------- -----------------
1533.    Files   !FILES002N! !FILES012N! !FILES022N!
1534.    Folders !FILES102N! !FILES112N! !FILES122N!
1535.    ------- ----------------- ----------------- -----------------
1536.    All     !FILES202N! !FILES212N! !FILES222N!
1537. 
1538. ----------------------------------------------------------
1539. Gigabytes:
1540.               Unfragmented       Fragmented            All
1541.    ------- ----------------- ----------------- -----------------
1542.    Files   !FILES002G! !FILES012G! !FILES022G!
1543.    Folders !FILES102G! !FILES112G! !FILES122G!
1544.    ------- ----------------- ----------------- -----------------
1545.    All     !FILES202G! !FILES212G! !FILES222G!
1546. 
1547. ----------------------------------------------------------
1548. Percentage:
1549.               Unfragmented       Fragmented            All
1550.    ------- ----------------- ----------------- -----------------
1551.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1552.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1553.    ------- ----------------- ----------------- -----------------
1554.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1555. 
1556. ----------------------------------------------------------
1557. USED SIZE:
1558. ----------------------------------------------------------
1559. Bytes:
1560.               Unfragmented       Fragmented            All
1561.    ------- ----------------- ----------------- -----------------
1562.    Files   !FILES001N! !FILES011N! !FILES021N!
1563.    Folders !FILES101N! !FILES111N! !FILES121N!
1564.    ------- ----------------- ----------------- -----------------
1565.    All     !FILES201N! !FILES211N! !FILES221N!
1566. 
1567. ----------------------------------------------------------
1568. Gigabytes:
1569.               Unfragmented       Fragmented            All
1570.    ------- ----------------- ----------------- -----------------
1571.    Files   !FILES001G! !FILES011G! !FILES021G!
1572.    Folders !FILES101G! !FILES111G! !FILES121G!
1573.    ------- ----------------- ----------------- -----------------
1574.    All     !FILES201G! !FILES211G! !FILES221G!
1575. 
1576. ----------------------------------------------------------
1577. Percentage:
1578.               Unfragmented       Fragmented            All
1579.    ------- ----------------- ----------------- -----------------
1580.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1581.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1582.    ------- ----------------- ----------------- -----------------
1583.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1584. 
1585. ----------------------------------------------------------
1586. Volume Detailed Statistics end.
1587. ----------------------------------------------------------
1588. ") 
1589. 
1590. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1591. 
1592. SetVariable(FileStepDescription,"!VolumeLabel! !VolumeDescription! started: 2021-10-24 14:34:15.")
1593. # FILE STEP
1594. 
1595. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1596. 
1597. /* add message and move to a new line. */
1598. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1599. ")
1600. 
1601. /* display the line. (hopefully.) */
1602. # Zone Footer Set Statistics Window Text
1603. 
1604. SetStatisticsWindowText("----------------------------------------------------------
1605. Zones Processed: 
1606. ----------------------------------------------------------
1607. !ZoneListByLine!
1608. ----------------------------------------------------------
1609. Zone Processing Step:
1610. !ZoneStepByLine!    
1611. ----------------------------------------------------------
1612. Current Zone:
1613. !ZoneFooter!
1614. ----------------------------------------------------------
1615. Volume Statistics:
1616. !VolumeStatisticsDetail!
1617. ----------------------------------------------------------
1618. Zone Detailed Report:
1619. ----------------------------------------------------------
1620. !ZoneStatisticsDetail!
1621. ----------------------------------------------------------
1622. ")
1623. 
1624. 
1625. 
1626. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1627. 
1628. # BANNER SET
1629. 
1630. # DATE TIME RUN ELP
1631. 
1632. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
1633. /* Xinclude "..\BannerSet.MyDc"X */
1634. /* pause(1) */
1635. 
1636. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1637. 
1638. Title('!Heading!')
1639. /* pause(1) */
1640. 
1641. /* NOTE: Can't round or truncate to integer precision. */
1642. 
1643. pause(1)
1644. 
1645. SetVariable(FileStepDescription,"Analyzing Volume")
1646. # FILE STEP
1647. 
1648. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1649. 
1650. /* add message and move to a new line. */
1651. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1652. ")
1653. 
1654. /* display the line. (hopefully.) */
1655. # Zone Footer Set Statistics Window Text
1656. 
1657. SetStatisticsWindowText("----------------------------------------------------------
1658. Zones Processed: 
1659. ----------------------------------------------------------
1660. !ZoneListByLine!
1661. ----------------------------------------------------------
1662. Zone Processing Step:
1663. !ZoneStepByLine!    
1664. ----------------------------------------------------------
1665. Current Zone:
1666. !ZoneFooter!
1667. ----------------------------------------------------------
1668. Volume Statistics:
1669. !VolumeStatisticsDetail!
1670. ----------------------------------------------------------
1671. Zone Detailed Report:
1672. ----------------------------------------------------------
1673. !ZoneStatisticsDetail!
1674. ----------------------------------------------------------
1675. ")
1676. 
1677. 
1678. 
1679. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1680. 
1681. # BANNER SET
1682. 
1683. # DATE TIME RUN ELP
1684. 
1685. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
1686. /* Xinclude "..\BannerSet.MyDc"X */
1687. /* pause(1) */
1688. 
1689. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1690. 
1691. Title('!Heading!')
1692. /* pause(1) */
1693. 
1694. /* NOTE: Can't round or truncate to integer precision. */
1695. 
1696. pause(1)
1697. 
1698. /* ---------------------------------------------------------- */
1699. VolumeSelect
1700. 
1701. 	Label("!VolumeLabel!") or Name("!VolumeLabel!")
1702. 
1703. /* ---------------------------------------------------------- */
1704. VolumeActions
1705. 
1706. /* ---------------------------------------------------------- */
1707. /* Volume Init */
1708. # Set Volume Detailed Statistics:
1709. 
1710. # Set Volume summary stats:
1711. 
1712. # Cluster, Sector, Block adjust for display.
1713. # Bytes per cluster is volume specific.
1714. 
1715. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1716. 
1717. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
1718. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
1719. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1720. 
1721. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
1722. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
1723. 
1724. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
1725. SUMMARY: !VolumeLabel! !VolumeDescription!
1726.   
1727.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
1728.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
1729.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
1730.          
1731.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
1732.       Volume Free Adj:       !VolumeFreeAdj!
1733.     Bytes per cluster:       !BytesPerCluster! bytes
1734. 
1735.    Unfragmented Items:       !FILES200N!
1736.      Fragmented Items:       !FILES210N!
1737. 
1738.     Unfragmented Data:       !FILES202N! bytes
1739.       Fragmented Data:       !FILES212N! bytes
1740. 
1741.              All Gaps:       !GAP00N!
1742.              All gaps:       !GAP10N! bytes
1743.           Average gap:       !GAP13N! bytes
1744.            Median gap:       !GAP14N! bytes
1745.           Biggest gap:       !GAP15N! bytes
1746. ----------------------------------------------------------
1747. ") 
1748. 
1749. 
1750. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
1751. VOLUME: !VolumeLabel! !VolumeDescription!
1752. ----------------------------------------------------------
1753. !VolumeStatisticsSummary!
1754. ----------------------------------------------------------
1755. DETAILS: !VolumeLabel! !VolumeDescription!
1756. ----------------------------------------------------------
1757. 
1758. SUMMARY:
1759. 
1760. Volume label/name:          !VolumeLabel!
1761. Volume mountpoint:          !MountPoint!
1762. Volume name:                !VolumeName!
1763. Volume type:                !VolumeType!
1764. 
1765. Total disk space:           !VolumeSize! bytes
1766.                             !VolumeSizeG! gigabytes
1767. 
1768. Bytes per cluster:          !BytesPerCluster! bytes
1769. Average end-begin distance: !AverageBeginEndDistance! clusters
1770.                             !AverageBeginEndDistanceP!% of volume size
1771. 
1772. ----------------------------------------------------------
1773. FRAGMENTS:
1774. 
1775. Unfragmented Items: !FILES200N!
1776.   Fragmented Items: !FILES210N!
1777.  Unfragmented Data: !FILES202N! bytes
1778.    Fragmented Data: !FILES212N! bytes
1779. Gaps:
1780.           All Gaps: !GAP00N!
1781.           All gaps: !GAP10N! bytes
1782.        Average gap: !GAP13N! bytes
1783.         Median gap: !GAP14N! bytes
1784.        Biggest gap: !GAP15N! bytes
1785. 
1786. ----------------------------------------------------------
1787. GAPS:
1788. 
1789.    ----------------------------------------------------------
1790.    Counts:
1791.                        Count      Percentage of all
1792.                 ----------------- -----------------
1793.    Small gaps   !GAP01N! !GAP01P!%
1794.    Big gaps     !GAP02N! !GAP02P!%
1795.                 ----------------- -----------------
1796.    All gaps     !GAP00N! !GAP00P!
1797. 
1798.    ----------------------------------------------------------
1799.    By size:
1800.                       Bytes          Gigabytes      Percentage of all
1801.                 ----------------- ----------------- -----------------
1802.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
1803.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
1804.                 ----------------- ----------------- -----------------
1805.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
1806. 
1807.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
1808.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
1809.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
1810.    ----------------------------------------------------------
1811. 
1812. ----------------------------------------------------------
1813. FILE STATISTICS:
1814. ----------------------------------------------------------
1815. 
1816. ----------------------------------------------------------
1817. ITEM COUNT:
1818. ----------------------------------------------------------
1819. Number of files and folders:
1820. 
1821.               Unfragmented       Fragmented            All
1822.    ------- ----------------- ----------------- -----------------
1823.    Files   !FILES000N! !FILES010N! !FILES020N!
1824.    Folders !FILES100N! !FILES110N! !FILES120N!
1825.    ------- ----------------- ----------------- -----------------
1826.    All     !FILES200N! !FILES210N! !FILES220N!
1827. 
1828. ----------------------------------------------------------
1829. Percentage of total:
1830. 
1831.               Unfragmented       Fragmented            All
1832.    ------- ----------------- ----------------- -----------------
1833.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
1834.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
1835.    ------- ----------------- ----------------- -----------------
1836.    All     !FILES200P!%!FILES210P!%!FILES220P!%
1837. 
1838. ----------------------------------------------------------
1839. OCCUPIED SIZE on disk:
1840. ----------------------------------------------------------
1841. Bytes:
1842.               Unfragmented       Fragmented            All
1843.    ------- ----------------- ----------------- -----------------
1844.    Files   !FILES002N! !FILES012N! !FILES022N!
1845.    Folders !FILES102N! !FILES112N! !FILES122N!
1846.    ------- ----------------- ----------------- -----------------
1847.    All     !FILES202N! !FILES212N! !FILES222N!
1848. 
1849. ----------------------------------------------------------
1850. Gigabytes:
1851.               Unfragmented       Fragmented            All
1852.    ------- ----------------- ----------------- -----------------
1853.    Files   !FILES002G! !FILES012G! !FILES022G!
1854.    Folders !FILES102G! !FILES112G! !FILES122G!
1855.    ------- ----------------- ----------------- -----------------
1856.    All     !FILES202G! !FILES212G! !FILES222G!
1857. 
1858. ----------------------------------------------------------
1859. Percentage:
1860.               Unfragmented       Fragmented            All
1861.    ------- ----------------- ----------------- -----------------
1862.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
1863.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
1864.    ------- ----------------- ----------------- -----------------
1865.    All     !FILES202P!%!FILES212P!%!FILES222P!%
1866. 
1867. ----------------------------------------------------------
1868. USED SIZE:
1869. ----------------------------------------------------------
1870. Bytes:
1871.               Unfragmented       Fragmented            All
1872.    ------- ----------------- ----------------- -----------------
1873.    Files   !FILES001N! !FILES011N! !FILES021N!
1874.    Folders !FILES101N! !FILES111N! !FILES121N!
1875.    ------- ----------------- ----------------- -----------------
1876.    All     !FILES201N! !FILES211N! !FILES221N!
1877. 
1878. ----------------------------------------------------------
1879. Gigabytes:
1880.               Unfragmented       Fragmented            All
1881.    ------- ----------------- ----------------- -----------------
1882.    Files   !FILES001G! !FILES011G! !FILES021G!
1883.    Folders !FILES101G! !FILES111G! !FILES121G!
1884.    ------- ----------------- ----------------- -----------------
1885.    All     !FILES201G! !FILES211G! !FILES221G!
1886. 
1887. ----------------------------------------------------------
1888. Percentage:
1889.               Unfragmented       Fragmented            All
1890.    ------- ----------------- ----------------- -----------------
1891.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
1892.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
1893.    ------- ----------------- ----------------- -----------------
1894.    All     !FILES201P!%!FILES211P!%!FILES221P!%
1895. 
1896. ----------------------------------------------------------
1897. Volume Detailed Statistics end.
1898. ----------------------------------------------------------
1899. ") 
1900. 
1901. SetStatisticsWindowText("!VolumeStatisticsSummary!")
1902. 
1903. SetVariable(FileStepDescription,"Volume started.")
1904. # FILE STEP
1905. 
1906. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
1907. 
1908. /* add message and move to a new line. */
1909. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
1910. ")
1911. 
1912. /* display the line. (hopefully.) */
1913. # Zone Footer Set Statistics Window Text
1914. 
1915. SetStatisticsWindowText("----------------------------------------------------------
1916. Zones Processed: 
1917. ----------------------------------------------------------
1918. !ZoneListByLine!
1919. ----------------------------------------------------------
1920. Zone Processing Step:
1921. !ZoneStepByLine!    
1922. ----------------------------------------------------------
1923. Current Zone:
1924. !ZoneFooter!
1925. ----------------------------------------------------------
1926. Volume Statistics:
1927. !VolumeStatisticsDetail!
1928. ----------------------------------------------------------
1929. Zone Detailed Report:
1930. ----------------------------------------------------------
1931. !ZoneStatisticsDetail!
1932. ----------------------------------------------------------
1933. ")
1934. 
1935. 
1936. 
1937. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
1938. 
1939. # BANNER SET
1940. 
1941. # DATE TIME RUN ELP
1942. 
1943. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
1944. /* Xinclude "..\BannerSet.MyDc"X */
1945. /* pause(1) */
1946. 
1947. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1948. 
1949. Title('!Heading!')
1950. /* pause(1) */
1951. 
1952. /* NOTE: Can't round or truncate to integer precision. */
1953. 
1954. pause(1)
1955. 
1956. # Volume When Started
1957. 
1958. SetVariable(VolumeFreeAdj, (VolumeFree * (VolumeUsed / VolumeSize)))
1959. 
1960. SetVariable(MftLocation, RoundUp(VolumeUsed * MftPerDev, VolumeSize * VolumeRoundUpLarge)) 
1961. 
1962. SetVariable(ZoneListByLine, 		"Volume started.
1963. ")
1964. SetVariable(ZoneStepByLine, 		"Initialize.
1965. ")
1966. SetVariable(ZoneStatisticsDetail, 	"")
1967. 
1968. SetVariable(ZoneNoCurrent, 		0)
1969. SetVariable(ZoneNoAdjCurrent, 	0) 
1970. SetVariable(ZoneCurrentAjust,	0)
1971. 
1972. # BANNER SET
1973. 
1974. # DATE TIME RUN ELP
1975. 
1976. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
1977. /* Xinclude "..\BannerSet.MyDc"X */
1978. /* pause(1) */
1979. 
1980. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
1981. 
1982. Title('!Heading!')
1983. /* pause(1) */
1984. 
1985. /* NOTE: Can't round or truncate to integer precision. */
1986. 
1987. AppendLogfile("!LogFileName!", "!Title!")
1988. 
1989. 
1990. # Set Volume Detailed Statistics:
1991. 
1992. # Set Volume summary stats:
1993. 
1994. # Cluster, Sector, Block adjust for display.
1995. # Bytes per cluster is volume specific.
1996. 
1997. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
1998. 
1999. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
2000. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
2001. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2002. 
2003. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
2004. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
2005. 
2006. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
2007. SUMMARY: !VolumeLabel! !VolumeDescription!
2008.   
2009.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
2010.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
2011.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
2012.          
2013.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
2014.       Volume Free Adj:       !VolumeFreeAdj!
2015.     Bytes per cluster:       !BytesPerCluster! bytes
2016. 
2017.    Unfragmented Items:       !FILES200N!
2018.      Fragmented Items:       !FILES210N!
2019. 
2020.     Unfragmented Data:       !FILES202N! bytes
2021.       Fragmented Data:       !FILES212N! bytes
2022. 
2023.              All Gaps:       !GAP00N!
2024.              All gaps:       !GAP10N! bytes
2025.           Average gap:       !GAP13N! bytes
2026.            Median gap:       !GAP14N! bytes
2027.           Biggest gap:       !GAP15N! bytes
2028. ----------------------------------------------------------
2029. ") 
2030. 
2031. 
2032. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
2033. VOLUME: !VolumeLabel! !VolumeDescription!
2034. ----------------------------------------------------------
2035. !VolumeStatisticsSummary!
2036. ----------------------------------------------------------
2037. DETAILS: !VolumeLabel! !VolumeDescription!
2038. ----------------------------------------------------------
2039. 
2040. SUMMARY:
2041. 
2042. Volume label/name:          !VolumeLabel!
2043. Volume mountpoint:          !MountPoint!
2044. Volume name:                !VolumeName!
2045. Volume type:                !VolumeType!
2046. 
2047. Total disk space:           !VolumeSize! bytes
2048.                             !VolumeSizeG! gigabytes
2049. 
2050. Bytes per cluster:          !BytesPerCluster! bytes
2051. Average end-begin distance: !AverageBeginEndDistance! clusters
2052.                             !AverageBeginEndDistanceP!% of volume size
2053. 
2054. ----------------------------------------------------------
2055. FRAGMENTS:
2056. 
2057. Unfragmented Items: !FILES200N!
2058.   Fragmented Items: !FILES210N!
2059.  Unfragmented Data: !FILES202N! bytes
2060.    Fragmented Data: !FILES212N! bytes
2061. Gaps:
2062.           All Gaps: !GAP00N!
2063.           All gaps: !GAP10N! bytes
2064.        Average gap: !GAP13N! bytes
2065.         Median gap: !GAP14N! bytes
2066.        Biggest gap: !GAP15N! bytes
2067. 
2068. ----------------------------------------------------------
2069. GAPS:
2070. 
2071.    ----------------------------------------------------------
2072.    Counts:
2073.                        Count      Percentage of all
2074.                 ----------------- -----------------
2075.    Small gaps   !GAP01N! !GAP01P!%
2076.    Big gaps     !GAP02N! !GAP02P!%
2077.                 ----------------- -----------------
2078.    All gaps     !GAP00N! !GAP00P!
2079. 
2080.    ----------------------------------------------------------
2081.    By size:
2082.                       Bytes          Gigabytes      Percentage of all
2083.                 ----------------- ----------------- -----------------
2084.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
2085.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
2086.                 ----------------- ----------------- -----------------
2087.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
2088. 
2089.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
2090.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
2091.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
2092.    ----------------------------------------------------------
2093. 
2094. ----------------------------------------------------------
2095. FILE STATISTICS:
2096. ----------------------------------------------------------
2097. 
2098. ----------------------------------------------------------
2099. ITEM COUNT:
2100. ----------------------------------------------------------
2101. Number of files and folders:
2102. 
2103.               Unfragmented       Fragmented            All
2104.    ------- ----------------- ----------------- -----------------
2105.    Files   !FILES000N! !FILES010N! !FILES020N!
2106.    Folders !FILES100N! !FILES110N! !FILES120N!
2107.    ------- ----------------- ----------------- -----------------
2108.    All     !FILES200N! !FILES210N! !FILES220N!
2109. 
2110. ----------------------------------------------------------
2111. Percentage of total:
2112. 
2113.               Unfragmented       Fragmented            All
2114.    ------- ----------------- ----------------- -----------------
2115.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
2116.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
2117.    ------- ----------------- ----------------- -----------------
2118.    All     !FILES200P!%!FILES210P!%!FILES220P!%
2119. 
2120. ----------------------------------------------------------
2121. OCCUPIED SIZE on disk:
2122. ----------------------------------------------------------
2123. Bytes:
2124.               Unfragmented       Fragmented            All
2125.    ------- ----------------- ----------------- -----------------
2126.    Files   !FILES002N! !FILES012N! !FILES022N!
2127.    Folders !FILES102N! !FILES112N! !FILES122N!
2128.    ------- ----------------- ----------------- -----------------
2129.    All     !FILES202N! !FILES212N! !FILES222N!
2130. 
2131. ----------------------------------------------------------
2132. Gigabytes:
2133.               Unfragmented       Fragmented            All
2134.    ------- ----------------- ----------------- -----------------
2135.    Files   !FILES002G! !FILES012G! !FILES022G!
2136.    Folders !FILES102G! !FILES112G! !FILES122G!
2137.    ------- ----------------- ----------------- -----------------
2138.    All     !FILES202G! !FILES212G! !FILES222G!
2139. 
2140. ----------------------------------------------------------
2141. Percentage:
2142.               Unfragmented       Fragmented            All
2143.    ------- ----------------- ----------------- -----------------
2144.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
2145.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
2146.    ------- ----------------- ----------------- -----------------
2147.    All     !FILES202P!%!FILES212P!%!FILES222P!%
2148. 
2149. ----------------------------------------------------------
2150. USED SIZE:
2151. ----------------------------------------------------------
2152. Bytes:
2153.               Unfragmented       Fragmented            All
2154.    ------- ----------------- ----------------- -----------------
2155.    Files   !FILES001N! !FILES011N! !FILES021N!
2156.    Folders !FILES101N! !FILES111N! !FILES121N!
2157.    ------- ----------------- ----------------- -----------------
2158.    All     !FILES201N! !FILES211N! !FILES221N!
2159. 
2160. ----------------------------------------------------------
2161. Gigabytes:
2162.               Unfragmented       Fragmented            All
2163.    ------- ----------------- ----------------- -----------------
2164.    Files   !FILES001G! !FILES011G! !FILES021G!
2165.    Folders !FILES101G! !FILES111G! !FILES121G!
2166.    ------- ----------------- ----------------- -----------------
2167.    All     !FILES201G! !FILES211G! !FILES221G!
2168. 
2169. ----------------------------------------------------------
2170. Percentage:
2171.               Unfragmented       Fragmented            All
2172.    ------- ----------------- ----------------- -----------------
2173.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
2174.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
2175.    ------- ----------------- ----------------- -----------------
2176.    All     !FILES201P!%!FILES211P!%!FILES221P!%
2177. 
2178. ----------------------------------------------------------
2179. Volume Detailed Statistics end.
2180. ----------------------------------------------------------
2181. ") 
2182. 
2183. AppendLogfile("!LogFileName!", "!Title!")
2184. 
2185. 
2186. 
2187. /* Write/display stats: */
2188. # Log:
2189. AppendLogfile("!LogFileName!", "!Title! started.")
2190. AppendLogfile("!LogFileName!", "2021-10-24 14:34:15.")
2191. AppendLogfile("!LogFileName!",".")
2192. AppendLogfile("!LogFileName!", ".")
2193. AppendLogfile("!LogFileName!", "Volume: !VolumeLabel!")
2194. AppendLogfile("!LogFileName!",".")
2195. AppendLogfile("!LogFileName!","!VolumeStatisticsDetail!")
2196. AppendLogfile("!LogFileName!",".")
2197. AppendLogfile("!LogFileName!", "!Title! started.")
2198. AppendLogfile("!LogFileName!", "2021-10-24 14:34:15.")
2199. AppendLogfile("!LogFileName!",".")
2200. 
2201. # In program statistics window (view):
2202. SetStatisticsWindowText("!VolumeStatisticsDetail!")
2203. 
2204. 
2205. /* ---------------------------------------------------------- */
2206. /* System Zones */
2207. /* ---------------------------------------------------------- */
2208. 
2209. 	# Defrag Zones Os
2210. 	/* System Zones */
2211. 
2212. AppendLogfile("!LogFileName!", "!Description! Os Zones started: 2021-10-24 14:34:15")
2213. SetVariable(FileStepDescription,"System Zones.")
2214. # BANNER SET
2215. 
2216. # DATE TIME RUN ELP
2217. 
2218. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
2219. /* Xinclude "..\BannerSet.MyDc"X */
2220. /* pause(1) */
2221. 
2222. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2223. 
2224. Title('!Heading!')
2225. /* pause(1) */
2226. 
2227. /* NOTE: Can't round or truncate to integer precision. */
2228. 
2229. AppendLogfile("!LogFileName!", "!Title!")
2230. 
2231. 
2232. AppendLogfile("!LogFileName!",".")
2233. 
2234. AppendLogfile("!LogFileName!", "System Disk optimized layout for boot and executables. 2021-10-24 14:34:15")
2235. /* Dgh 20190618 */
2236. 
2237. /* ---------------------------------------------------------- */
2238. /* Defrag the Pagefile.sys on the next boot. */
2239. 
2240. # PagedFrg - Page Defrag.
2241. 
2242. /* Defrag the Pagefile.sys on the next boot. */
2243. # RunProgram("..\Pagedfrg.exe","-o")
2244. 
2245. 
2246. /* ---------------------------------------------------------- */
2247. AppendLogfile("!LogFileName!", "Place files at the beginning of the disk: 2021-10-24 14:34:15")
2248. 
2249. 	MakeGap(0)
2250. 
2251. /* ---------------------------------------------------------- */
2252. # Zone Boot Fixed.
2253. /* ---------------------------------------------------------- */
2254. # Zone Boot Fixed.
2255. 	SetVariable(ZoneLabel, 			"!ZoneLabelBoot!")
2256. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBoot!")
2257. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
2258. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
2259. 	SetVariable(ZoneTypeSelect,'# Boot start.
2260. ImportListFromBootOptimize()
2261. # Boot end.
2262. ')
2263. 
2264. 		# Zone Do Header
2265. 
2266. # Zone When Started
2267. 
2268. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
2269. # Display Set Zone
2270. 
2271. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
2272. SetVariable(FileStepDescription,	"")
2273. 
2274. SetVariable(ZoneStepByLine, 			"Zone started.
2275. ")
2276. 
2277. # BANNER SET
2278. 
2279. # DATE TIME RUN ELP
2280. 
2281. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
2282. /* Xinclude "..\BannerSet.MyDc"X */
2283. /* pause(1) */
2284. 
2285. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2286. 
2287. Title('!Heading!')
2288. /* pause(1) */
2289. 
2290. /* NOTE: Can't round or truncate to integer precision. */
2291. 
2292. AppendLogfile("!LogFileName!", "!Title!")
2293. 
2294. 
2295. 
2296. pause(1)
2297. 
2298. 
2299. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
2300. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
2301. 
2302. SetVariable(ZoneStepNoCurrent, 0)
2303. 
2304. 
2305. # Zone Do Current Clear
2306. 
2307. SetVariable(ZoneTypeSelectCurrent, 		"")
2308. 
2309. SetVariable(ZoneBeginCurrent, 			0)
2310. SetVariable(ZoneBeginPerCurrent, 		0)
2311. SetVariable(ZoneEndCurrent, 			0)
2312. SetVariable(ZoneEndPerCurrent, 			0)
2313. 
2314. SetVariable(ZoneSizeCurrent,			0)
2315. SetVariable(ZoneSizePerCurrent,			0)
2316. 
2317. SetVariable(ZoneGapRequestedCurrent,	0)
2318. SetVariable(ZoneGapRoundedCurrent, 		0)
2319. SetVariable(ZoneGapAdjustedCurrent, 	0)
2320. SetVariable(ZoneGapAvailableCurrent, 	0)
2321. SetVariable(ZoneGapCurrent,				0)
2322. SetVariable(ZoneGapUsedCurrent, 		0)
2323. 
2324. SetVariable(ZoneGapActualCurrent, 		0)
2325. SetVariable(ZoneGapActualPerCurrent, 	0)
2326. 
2327. SetVariable(ZoneSizeActual, 			0)
2328. SetVariable(ZoneSizeActualCurrent,		0)
2329. 
2330. SetVariable(ZoneEndActual, 				0)
2331. SetVariable(ZoneEndActualCurrent,		0)			
2332. SetVariable(ZoneSizeActualPerCurrent, 	0)
2333.       
2334. SetVariable(ZoneFilesFolders,			0)
2335. SetVariable(ZoneFilesFoldersPer,		0) 
2336. 
2337. SetVariable(ZoneFragments,				0)
2338. SetVariable(ZoneFragmentsPer,			0) 
2339. 		
2340. SetVariable(ZoneEndActualCurrent, 		0)
2341. SetVariable(ZoneEndActualPerCurrent, 	0)
2342. 
2343. # Gap Calculation Methodology:
2344. 	# Requested
2345. 	SetVariable(GapRequested, 			0) 
2346. 	SetVariable(GapRequestedStd, 		0) 
2347. 	SetVariable(GapRequestedMft, 		0) 
2348. 	SetVariable(GapRequestedOs, 		0) 
2349. 	SetVariable(GapRequestedOriginal, 	0) 
2350. 	
2351. 	# Gap Adjustments
2352. 	SetVariable(GapRounded, 			0)
2353. 	# SetVariable(GapAdjusted, 			0)
2354. 	SetVariable(GapAvailable, 			0)
2355. 	SetVariable(GapCurrent, 			0)
2356. 	SetVariable(GapActual, 				0)
2357. 	SetVariable(GapUsed, 				0)
2358. 	
2359. 	# Gap Adjustments
2360. 	SetVariable(GapRoundedLoc, 			0)
2361. 	# SetVariable(GapAdjustedLoc, 		0)
2362. 	SetVariable(GapAvailableLoc, 		0)
2363. 	SetVariable(GapCurrentLoc, 			0)
2364. 	SetVariable(GapActualLoc,			0)
2365. 	SetVariable(GapUsedLoc,				0)
2366. 	
2367. 	# Space usage
2368. 	SetVariable(ZoneFreePerRequested, 	0)
2369. 	SetVariable(ZoneFreePerUsed, 		0)
2370. 
2371. # Gap Size & Rounding
2372. 	SetVariable(ZoneGapSizePer, 		0)
2373. 	SetVariable(ZoneVolRoundUpPer, 		0)
2374. 	
2375. 	# Free Space
2376. 	SetVariable(ZoneFreeUsedPer, 		0)
2377. 	SetVariable(ZoneFreeRequestedPer, 	0)
2378. 
2379. 
2380. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
2381. 
2382. # Footer:
2383. SetVariable(ZoneFooter, "----------------------------------------------------------
2384. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
2385. 
2386. Statistics Report:
2387. ------------------
2388.    Size:  
2389.    ------------------------
2390.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2391.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2392.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2393. 
2394.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2395.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2396. 
2397.    Location:
2398.    ------------------------
2399.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2400.              Files End: !ZoneEndCurrent!
2401.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2402.       
2403.    Gap Settings:
2404.    ------------------------
2405.          Gap Requested: !ZoneGapSizePer!%
2406.       Volume Rounding: !ZoneVolRoundUpPer!%
2407.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2408.                  
2409.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
2410.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
2411.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
2412.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
2413.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
2414.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
2415.      
2416.    Free Space after Zone:
2417.    ------------------------
2418.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
2419.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
2420.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
2421. 
2422. Directory and Files Select:
2423. ---------------------------
2424. !ZoneTypeSelectCurrent!               
2425. ---------------------------
2426. ----------------------------------------------------------
2427. ")
2428. 
2429. # BANNER SET
2430. 
2431. # DATE TIME RUN ELP
2432. 
2433. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
2434. /* Xinclude "..\BannerSet.MyDc"X */
2435. /* pause(1) */
2436. 
2437. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2438. 
2439. Title('!Heading!')
2440. /* pause(1) */
2441. 
2442. /* NOTE: Can't round or truncate to integer precision. */
2443. 
2444. AppendLogfile("!LogFileName!", "!Title!")
2445. 
2446. 
2447. 
2448. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
2449. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
2450. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:15")
2451. 
2452. SetVariable(ZoneListByLine, "!ZoneListByLine!
2453. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
2454. 
2455. 
2456. /* Fixed Zone Position Handling */
2457. /* Literal number: */
2458. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
2459. /* Percentage of disk: */
2460. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
2461. /* Gap */
2462. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
2463. 
2464. /* ---------------------------------------------------------- */
2465. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
2466. # FILE STEP
2467. 
2468. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2469. 
2470. /* add message and move to a new line. */
2471. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2472. ")
2473. 
2474. /* display the line. (hopefully.) */
2475. # Zone Footer Set Statistics Window Text
2476. 
2477. SetStatisticsWindowText("----------------------------------------------------------
2478. Zones Processed: 
2479. ----------------------------------------------------------
2480. !ZoneListByLine!
2481. ----------------------------------------------------------
2482. Zone Processing Step:
2483. !ZoneStepByLine!    
2484. ----------------------------------------------------------
2485. Current Zone:
2486. !ZoneFooter!
2487. ----------------------------------------------------------
2488. Volume Statistics:
2489. !VolumeStatisticsDetail!
2490. ----------------------------------------------------------
2491. Zone Detailed Report:
2492. ----------------------------------------------------------
2493. !ZoneStatisticsDetail!
2494. ----------------------------------------------------------
2495. ")
2496. 
2497. 
2498. 
2499. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2500. 
2501. # BANNER SET
2502. 
2503. # DATE TIME RUN ELP
2504. 
2505. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
2506. /* Xinclude "..\BannerSet.MyDc"X */
2507. /* pause(1) */
2508. 
2509. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2510. 
2511. Title('!Heading!')
2512. /* pause(1) */
2513. 
2514. /* NOTE: Can't round or truncate to integer precision. */
2515. 
2516. pause(1)
2517. 
2518. # your stuff HERE (X)... pre file select code.
2519. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
2520. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
2521. 	# (X)
2522. 
2523. FileSelect
2524. 
2525. 	# your stuff can't really go here (errors.)
2526. 	# maybe for some reason I don't know of...
2527. 	
2528. 	# Actions next...
2529. 		# Boot start.
2530. ImportListFromBootOptimize()
2531. # Boot end.
2532. 
2533. 		and not(
2534. 			# Os Data Dynamic start.
2535. (
2536. # Os Data Dynamic start.
2537. (
2538.   FileName("*.dat*")
2539.   or FileName("*.db*")
2540.   or FileName("*.edb*")
2541.   or FileName("*.log*")
2542.   or FileName("DataStore.edb")
2543. )
2544. # Os Data Dynamic end.
2545. 
2546.   or 
2547. # Os PageHiberDump start.
2548. (
2549.   FileName("DataStore.edb")
2550.   or FileName("DUMP*.*")
2551.   or FileName("Hiberfil.sys")
2552.   or FileName("MEMORY.DMP")
2553.   or FileName("Pagefile.sys")
2554. )
2555. # Os PageHiberDump end.
2556. 
2557. # Os Data Dynamic
2558. )
2559. # Os Data Dynamic end.
2560. 
2561. 		)
2562. 		FileActions
2563. 		  		/* ---------------------------------------------------------- */
2564. 	# Gap
2565. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
2566. 		# FILE STEP
2567. 
2568. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
2569. 
2570. /* add message and move to a new line. */
2571. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
2572. ")
2573. 
2574. /* display the line. (hopefully.) */
2575. # Zone Footer Set Statistics Window Text
2576. 
2577. SetStatisticsWindowText("----------------------------------------------------------
2578. Zones Processed: 
2579. ----------------------------------------------------------
2580. !ZoneListByLine!
2581. ----------------------------------------------------------
2582. Zone Processing Step:
2583. !ZoneStepByLine!    
2584. ----------------------------------------------------------
2585. Current Zone:
2586. !ZoneFooter!
2587. ----------------------------------------------------------
2588. Volume Statistics:
2589. !VolumeStatisticsDetail!
2590. ----------------------------------------------------------
2591. Zone Detailed Report:
2592. ----------------------------------------------------------
2593. !ZoneStatisticsDetail!
2594. ----------------------------------------------------------
2595. ")
2596. 
2597. 
2598. 
2599. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
2600. 
2601. # BANNER SET
2602. 
2603. # DATE TIME RUN ELP
2604. 
2605. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
2606. /* Xinclude "..\BannerSet.MyDc"X */
2607. /* pause(1) */
2608. 
2609. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
2610. 
2611. Title('!Heading!')
2612. /* pause(1) */
2613. 
2614. /* NOTE: Can't round or truncate to integer precision. */
2615. 
2616. pause(1)
2617. 	
2618. 	# ACTUAL GAP
2619. 		/* AddGap Variant. */
2620. 	  	# Zone Do Gap
2621. # Gap Calculation Methods:
2622. 
2623. /* 1) Anything you need to add first. */
2624. /* empty */
2625. 
2626. /* ---------------------------------------------------------- */
2627. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
2628. 	# GapRequestedStd.
2629. 
2630. 		/* ---------------------------------------------------------- */
2631. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
2632. 
2633. 		# Gap Calculation Methods:
2634. 
2635. /* AddGap Variants */
2636. 
2637. 	/* Standard */
2638. 		# Gap Calculation Methods:
2639. 	/* AddGap Variants */
2640. 	/* Standard */
2641. 
2642. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
2643. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
2644. 
2645. 	SetVariable(GapRequested, GapRequestedStd)
2646. 	
2647. 
2648. 	/* MFT Low High Method */
2649. 		# Gap Calculation Methods:
2650. 	/* AddGap Variants */
2651. 	/* MFT Low High Method */
2652. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
2653. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
2654. 	SetVariable(GapRequested, GapRequestedMft)
2655. 	
2656. 
2657. 	/* OS Volume Type Method */
2658. 		# Gap Calculation Methods:
2659. 	/* AddGap Variants */
2660. 	/* OS Volume Type Method */
2661. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
2662. 	SetVariable(GapRequested, GapRequestedOs)
2663. 
2664. 
2665. 
2666. /* MakeGap Variants */
2667. 
2668. 	/* Original Os 1-3 + MFT 2 */
2669. 		# Gap Calculation Methods:
2670. 	/* MakeGap Variants */
2671. 	/* Original Os 1-3 + MFT 2 */
2672. 	/* plus MFT gap placed inline at the dividing zone. */
2673. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
2674. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
2675. 	SetVariable(GapRequested, GapRequestedOrig)
2676. 	
2677. 	
2678. /* Note: You could comment out the ones not in use */
2679. /* However having the data in the log is useful. */
2680. /* Therefore the following line is otherwise needed. */
2681. 
2682. /* Standard used */
2683. 
2684. SetVariable(GapRequested, GapRequestedStd)
2685. 
2686. # Gap Calculation Methods:
2687. 
2688. /* AddGap Variants */
2689. 	/* Standard */
2690. 	/* MFT Low High Method */
2691. 	/* OS Volume Type Method */
2692. 
2693. /* MakeGap Variants */
2694. 	/* Original Os 1-3 + MFT 2 */
2695. 
2696. /* Note: You could comment out the ones not in use */
2697. /* However having the data in the log is useful. */
2698. /* Therefore the following line is otherwise needed. */
2699. 
2700. /* Standard is used currently */
2701. 
2702. 
2703. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
2704. 
2705. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
2706. 
2707. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
2708. 
2709. /* ---------------------------------------------------------- */
2710. /* 3) SMALL ZONE ADJUSTMENT. */
2711. /* Gab cant be larger than half the Zone Size. */
2712. 
2713. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
2714. 	
2715. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
2716. 
2717. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
2718. 
2719. /* ---------------------------------------------------------- */
2720. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
2721. # Gap Adjustments.
2722. 
2723. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
2724. 	
2725. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
2726. 
2727. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
2728. 
2729. /* ---------------------------------------------------------- */
2730. # BYPASS THIS.
2731. 	/* This is definitely wrong. */
2732. 	/* The question is can we steal gap from the next zone */
2733. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
2734. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
2735. 		# Zone Overflow.
2736. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
2737. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
2738. 
2739. /* ---------------------------------------------------------- */
2740. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
2741. # Remaining free space available.
2742. 
2743. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
2744. 	
2745. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
2746. 
2747. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
2748. 
2749. /* ---------------------------------------------------------- */
2750. # CURRENT gap to use.
2751. 
2752. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
2753. 
2754. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
2755. 
2756. /* ---------------------------------------------------------- */
2757. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
2758. # Debugging.
2759. 
2760. 	SetVariable(GapUsed, GapCurrent) // for debugging
2761. 
2762. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
2763. 
2764. 		# Your code HERE
2765. 
2766. /* ---------------------------------------------------------- */
2767. /* 7) YOUR CODE. */
2768. # YOUR CODE HERE:
2769. 	# INPUT: GapCurrent or GapCurrentLoc
2770. 	# OUTPUT: GapUsed...
2771. 
2772. /* ---------------------------------------------------------- */
2773. # Gap Size.
2774. # Actual Size of Gap.
2775. 
2776. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
2777. 
2778. /* ---------------------------------------------------------- */
2779. /* xxxxxxxxxxxxxxxxxxxxxx */
2780. # ADD THE GAP
2781. 	/* Xinclude "..\GapCommandDo.MyDc"X */
2782. /* xxxxxxxxxxxxxxxxxxxxxx */
2783. 
2784. 	
2785. 	# Zone Statistics	
2786. 	# Zone / Volume Statistics and Display
2787. 		
2788. 	# Accumulate Totals
2789.   	# Volume totals
2790. 
2791. /* Current total space used (by Zones and Gaps) */
2792. 
2793. SetVariable(VolumeZoneUsed, GapUsed)
2794. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
2795. /* Percentage */
2796. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
2797. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
2798. 
2799. /* Current total of free space requested */
2800. 
2801. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
2802. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2803. /* Percent. */
2804. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
2805. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
2806. 
2807. /* Current total of free space used */
2808. 
2809. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
2810. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
2811. /* Percent */
2812. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
2813. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
2814. 
2815. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
2816. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
2817. /* Xinclude "..\DebugDisplayPause.MyDc"X */
2818. 
2819. 
2820. 	# Current Values
2821. 	# Cluster, Sector, Block adjust for display.
2822. 	# Bytes per cluster is volume specific.
2823. 
2824. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
2825. 
2826. # Current Zone values.
2827. 	# Begin, end and size.
2828. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
2829. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
2830. 
2831. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
2832. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
2833. 
2834. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
2835. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
2836. 
2837. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
2838. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
2839. 
2840. 	SetVariable(ZoneFragments,				"!ZONE210N!")
2841. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
2842. 		
2843. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
2844. /* identical code to here: (separation not needed. TEST.) */	
2845. 
2846. # Current Gap, Actual and Free Values
2847. 	# Gap
2848. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
2849. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
2850. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
2851. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
2852. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
2853. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
2854. 	
2855. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
2856. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
2857. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
2858. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
2859. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
2860. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
2861. 	
2862. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
2863. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
2864. 	
2865. 	# Actual Size and End
2866. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
2867. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
2868. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
2869. 	
2870. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
2871. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
2872. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
2873. 
2874. # Gap Size & Rounding
2875. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
2876. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
2877. 	
2878. 	# Free Space
2879. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
2880. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
2881. 
2882. 	# Footer:
2883. SetVariable(ZoneFooter, "----------------------------------------------------------
2884. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
2885. 
2886. Statistics Report:
2887. ------------------
2888.    Size:  
2889.    ------------------------
2890.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2891.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2892.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2893. 
2894.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2895.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2896. 
2897.    Location:
2898.    ------------------------
2899.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2900.              Files End: !ZoneEndCurrent!
2901.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2902.       
2903.    Gap Settings:
2904.    ------------------------
2905.          Gap Requested: !ZoneGapSizePer!%
2906.       Volume Rounding: !ZoneVolRoundUpPer!%
2907.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2908.                  
2909.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
2910.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
2911.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
2912.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
2913.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
2914.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
2915.      
2916.    Free Space after Zone:
2917.    ------------------------
2918.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
2919.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
2920.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
2921. 
2922. Directory and Files Select:
2923. ---------------------------
2924. !ZoneTypeSelectCurrent!               
2925. ---------------------------
2926. ----------------------------------------------------------
2927. ")
2928. 	# Zone Footer Set Statistics Window Text
2929. 
2930. SetStatisticsWindowText("----------------------------------------------------------
2931. Zones Processed: 
2932. ----------------------------------------------------------
2933. !ZoneListByLine!
2934. ----------------------------------------------------------
2935. Zone Processing Step:
2936. !ZoneStepByLine!    
2937. ----------------------------------------------------------
2938. Current Zone:
2939. !ZoneFooter!
2940. ----------------------------------------------------------
2941. Volume Statistics:
2942. !VolumeStatisticsDetail!
2943. ----------------------------------------------------------
2944. Zone Detailed Report:
2945. ----------------------------------------------------------
2946. !ZoneStatisticsDetail!
2947. ----------------------------------------------------------
2948. ")
2949. 
2950. 
2951. 	
2952.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
2953. 
2954. 	# Add Zone to list of zones for display.
2955. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
2956. 
2957. 	# Footer:
2958. SetVariable(ZoneFooter, "----------------------------------------------------------
2959. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
2960. 
2961. Statistics Report:
2962. ------------------
2963.    Size:  
2964.    ------------------------
2965.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
2966.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
2967.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
2968. 
2969.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
2970.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
2971. 
2972.    Location:
2973.    ------------------------
2974.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
2975.              Files End: !ZoneEndCurrent!
2976.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
2977.       
2978.    Gap Settings:
2979.    ------------------------
2980.          Gap Requested: !ZoneGapSizePer!%
2981.       Volume Rounding: !ZoneVolRoundUpPer!%
2982.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
2983.                  
2984.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
2985.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
2986.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
2987.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
2988.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
2989.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
2990.      
2991.    Free Space after Zone:
2992.    ------------------------
2993.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
2994.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
2995.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
2996. 
2997. Directory and Files Select:
2998. ---------------------------
2999. !ZoneTypeSelectCurrent!               
3000. ---------------------------
3001. ----------------------------------------------------------
3002. ")
3003. 
3004. 	# Add Zone Details to Report.	
3005. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
3006. !ZoneFooter!")
3007. 
3008. 
3009. 	
3010. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionStart!")
3011. 			# FILE STEP
3012. 
3013. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3014. 
3015. /* add message and move to a new line. */
3016. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3017. ")
3018. 
3019. /* display the line. (hopefully.) */
3020. # Zone Footer Set Statistics Window Text
3021. 
3022. SetStatisticsWindowText("----------------------------------------------------------
3023. Zones Processed: 
3024. ----------------------------------------------------------
3025. !ZoneListByLine!
3026. ----------------------------------------------------------
3027. Zone Processing Step:
3028. !ZoneStepByLine!    
3029. ----------------------------------------------------------
3030. Current Zone:
3031. !ZoneFooter!
3032. ----------------------------------------------------------
3033. Volume Statistics:
3034. !VolumeStatisticsDetail!
3035. ----------------------------------------------------------
3036. Zone Detailed Report:
3037. ----------------------------------------------------------
3038. !ZoneStatisticsDetail!
3039. ----------------------------------------------------------
3040. ")
3041. 
3042. 
3043. 
3044. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3045. 
3046. # BANNER SET
3047. 
3048. # DATE TIME RUN ELP
3049. 
3050. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
3051. /* Xinclude "..\BannerSet.MyDc"X */
3052. /* pause(1) */
3053. 
3054. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3055. 
3056. Title('!Heading!')
3057. /* pause(1) */
3058. 
3059. /* NOTE: Can't round or truncate to integer precision. */
3060. 
3061. pause(1)
3062. 	
3063. 			SortByImportSequence(Ascending )
3064. 			/* SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) */
3065. 
3066. 			SetVariable(FileStepDescription, 	"!FileStepDescriptionFileActionEnd!")
3067. 			# FILE STEP
3068. 
3069. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3070. 
3071. /* add message and move to a new line. */
3072. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3073. ")
3074. 
3075. /* display the line. (hopefully.) */
3076. # Zone Footer Set Statistics Window Text
3077. 
3078. SetStatisticsWindowText("----------------------------------------------------------
3079. Zones Processed: 
3080. ----------------------------------------------------------
3081. !ZoneListByLine!
3082. ----------------------------------------------------------
3083. Zone Processing Step:
3084. !ZoneStepByLine!    
3085. ----------------------------------------------------------
3086. Current Zone:
3087. !ZoneFooter!
3088. ----------------------------------------------------------
3089. Volume Statistics:
3090. !VolumeStatisticsDetail!
3091. ----------------------------------------------------------
3092. Zone Detailed Report:
3093. ----------------------------------------------------------
3094. !ZoneStatisticsDetail!
3095. ----------------------------------------------------------
3096. ")
3097. 
3098. 
3099. 
3100. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3101. 
3102. # BANNER SET
3103. 
3104. # DATE TIME RUN ELP
3105. 
3106. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
3107. /* Xinclude "..\BannerSet.MyDc"X */
3108. /* pause(1) */
3109. 
3110. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3111. 
3112. Title('!Heading!')
3113. /* pause(1) */
3114. 
3115. /* NOTE: Can't round or truncate to integer precision. */
3116. 
3117. pause(1)
3118. 
3119. 		# Zone Do Footer
3120. 
3121. /* ---------------------------------------------------------- */
3122. # File Select
3123. 	# Select Statments
3124. # File Actions 
3125. 	# Standard or OS File Actions.
3126. 	# Resume...
3127. 	
3128. 	# your stuff HERE (X)... post zone (file) file actions code.
3129. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
3130. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
3131. 		# (X)
3132. 		
3133. 		/* ??? Set window? */
3134. 	
3135. 	# ADD THE GAP
3136. 		
3137. # Vacate (good for diagnostics)
3138. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
3139. 
3140. # DoNotVacate - DO NOT Vacate (recommended)
3141. 
3142. # Vacate
3143. /* AddGap(GapUsedLoc) */
3144. 
3145. # DO Not Vacate
3146. AddGap(GapUsedLoc, DoNotVacate) 
3147. 	
3148. 	
3149. /* ---------------------------------------------------------- */
3150. # (failed) TEST for boolean logic.
3151. 
3152. /* It should work in the gap calculations for turning options */
3153. /* on and off but it will NOT work here. */
3154. 
3155. /* Boolean setting X or FlagX. */
3156. /* Where X will be on or off: */
3157. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
3158. /*      For ON:  (X  *  FlagAny) */
3159. 
3160. /* 1) Failed, zero gap overrode the previous one. */
3161. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
3162. /* AddGap(GapUsedTemp) */ 
3163. 
3164. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
3165. /* AddGap(GapUsedTemp, DoNotVacate) */ 
3166. 
3167. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
3168. 
3169. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
3170. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
3171. /* AddGap(GapUsedTemp) */ 
3172. 
3173. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
3174. /* AddGap(GapUsedTemp, DoNotVacate) */ 
3175. 
3176. /* ---------------------------------------------------------- */
3177. 
3178. # Vacate
3179. /* AddGap(GapUsed) */
3180. 
3181. # DO NOT Vacate (recommended)
3182. /* AddGap(GapUsed, DoNotVacate) */ 
3183. 	
3184. 
3185. 		
3186. # 
3187. FileEnd
3188. /* ---------------------------------------------------------- */
3189. 
3190. # your stuff HERE (X)... post zone (file) code.
3191. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
3192. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
3193. 	# (X)
3194. 
3195. SetVariable(FileStepDescription,"Zone finished, reporting.")
3196. # FILE STEP
3197. 
3198. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3199. 
3200. /* add message and move to a new line. */
3201. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3202. ")
3203. 
3204. /* display the line. (hopefully.) */
3205. # Zone Footer Set Statistics Window Text
3206. 
3207. SetStatisticsWindowText("----------------------------------------------------------
3208. Zones Processed: 
3209. ----------------------------------------------------------
3210. !ZoneListByLine!
3211. ----------------------------------------------------------
3212. Zone Processing Step:
3213. !ZoneStepByLine!    
3214. ----------------------------------------------------------
3215. Current Zone:
3216. !ZoneFooter!
3217. ----------------------------------------------------------
3218. Volume Statistics:
3219. !VolumeStatisticsDetail!
3220. ----------------------------------------------------------
3221. Zone Detailed Report:
3222. ----------------------------------------------------------
3223. !ZoneStatisticsDetail!
3224. ----------------------------------------------------------
3225. ")
3226. 
3227. 
3228. 
3229. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3230. 
3231. # BANNER SET
3232. 
3233. # DATE TIME RUN ELP
3234. 
3235. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
3236. /* Xinclude "..\BannerSet.MyDc"X */
3237. /* pause(1) */
3238. 
3239. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3240. 
3241. Title('!Heading!')
3242. /* pause(1) */
3243. 
3244. /* NOTE: Can't round or truncate to integer precision. */
3245. 
3246. pause(1)
3247. 
3248. # Zone When Finished
3249. 
3250. # BANNER SET
3251. 
3252. # DATE TIME RUN ELP
3253. 
3254. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
3255. /* Xinclude "..\BannerSet.MyDc"X */
3256. /* pause(1) */
3257. 
3258. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3259. 
3260. Title('!Heading!')
3261. /* pause(1) */
3262. 
3263. /* NOTE: Can't round or truncate to integer precision. */
3264. 
3265. AppendLogfile("!LogFileName!", "!Title!")
3266. 
3267. 
3268. 
3269. # Zone Statistics	
3270. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
3271. 
3272. # Footer:
3273. SetVariable(ZoneFooter, "----------------------------------------------------------
3274. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
3275. 
3276. Statistics Report:
3277. ------------------
3278.    Size:  
3279.    ------------------------
3280.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3281.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3282.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3283. 
3284.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3285.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3286. 
3287.    Location:
3288.    ------------------------
3289.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3290.              Files End: !ZoneEndCurrent!
3291.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3292.       
3293.    Gap Settings:
3294.    ------------------------
3295.          Gap Requested: !ZoneGapSizePer!%
3296.       Volume Rounding: !ZoneVolRoundUpPer!%
3297.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3298.                  
3299.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
3300.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
3301.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
3302.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
3303.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
3304.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
3305.      
3306.    Free Space after Zone:
3307.    ------------------------
3308.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3309.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3310.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3311. 
3312. Directory and Files Select:
3313. ---------------------------
3314. !ZoneTypeSelectCurrent!               
3315. ---------------------------
3316. ----------------------------------------------------------
3317. ")
3318. 
3319. AppendLogfile("!LogFileName!", ".")
3320. AppendLogfile("!LogFileName!", "!ZoneFooter!")
3321. AppendLogfile("!LogFileName!", ".")
3322. 
3323. # Zone Footer Set Statistics Window Text
3324. 
3325. SetStatisticsWindowText("----------------------------------------------------------
3326. Zones Processed: 
3327. ----------------------------------------------------------
3328. !ZoneListByLine!
3329. ----------------------------------------------------------
3330. Zone Processing Step:
3331. !ZoneStepByLine!    
3332. ----------------------------------------------------------
3333. Current Zone:
3334. !ZoneFooter!
3335. ----------------------------------------------------------
3336. Volume Statistics:
3337. !VolumeStatisticsDetail!
3338. ----------------------------------------------------------
3339. Zone Detailed Report:
3340. ----------------------------------------------------------
3341. !ZoneStatisticsDetail!
3342. ----------------------------------------------------------
3343. ")
3344. 
3345. 
3346. 
3347. /* pause() */
3348. /* pause() */
3349. 
3350. 
3351. 
3352. 
3353. /* ---------------------------------------------------------- */
3354. # Zone Boot Data (Variable and other).
3355. 	SetVariable(ZoneLabel, 			"!ZoneLabelBootData!")
3356. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionBootData!")
3357. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpBoot!")
3358. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeBoot!")
3359. 	SetVariable(ZoneTypeSelect,'
3360.                 # Boot - Data files.
3361.                 not(
3362.                      # Os PageHiberDump start.
3363. (
3364.   FileName("DataStore.edb")
3365.   or FileName("DUMP*.*")
3366.   or FileName("Hiberfil.sys")
3367.   or FileName("MEMORY.DMP")
3368.   or FileName("Pagefile.sys")
3369. )
3370. # Os PageHiberDump end.
3371. 
3372.                 )
3373. ')
3374. 
3375. 		# Zone Do Header
3376. 
3377. # Zone When Started
3378. 
3379. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
3380. # Display Set Zone
3381. 
3382. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
3383. SetVariable(FileStepDescription,	"")
3384. 
3385. SetVariable(ZoneStepByLine, 			"Zone started.
3386. ")
3387. 
3388. # BANNER SET
3389. 
3390. # DATE TIME RUN ELP
3391. 
3392. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
3393. /* Xinclude "..\BannerSet.MyDc"X */
3394. /* pause(1) */
3395. 
3396. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3397. 
3398. Title('!Heading!')
3399. /* pause(1) */
3400. 
3401. /* NOTE: Can't round or truncate to integer precision. */
3402. 
3403. AppendLogfile("!LogFileName!", "!Title!")
3404. 
3405. 
3406. 
3407. pause(1)
3408. 
3409. 
3410. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
3411. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
3412. 
3413. SetVariable(ZoneStepNoCurrent, 0)
3414. 
3415. 
3416. # Zone Do Current Clear
3417. 
3418. SetVariable(ZoneTypeSelectCurrent, 		"")
3419. 
3420. SetVariable(ZoneBeginCurrent, 			0)
3421. SetVariable(ZoneBeginPerCurrent, 		0)
3422. SetVariable(ZoneEndCurrent, 			0)
3423. SetVariable(ZoneEndPerCurrent, 			0)
3424. 
3425. SetVariable(ZoneSizeCurrent,			0)
3426. SetVariable(ZoneSizePerCurrent,			0)
3427. 
3428. SetVariable(ZoneGapRequestedCurrent,	0)
3429. SetVariable(ZoneGapRoundedCurrent, 		0)
3430. SetVariable(ZoneGapAdjustedCurrent, 	0)
3431. SetVariable(ZoneGapAvailableCurrent, 	0)
3432. SetVariable(ZoneGapCurrent,				0)
3433. SetVariable(ZoneGapUsedCurrent, 		0)
3434. 
3435. SetVariable(ZoneGapActualCurrent, 		0)
3436. SetVariable(ZoneGapActualPerCurrent, 	0)
3437. 
3438. SetVariable(ZoneSizeActual, 			0)
3439. SetVariable(ZoneSizeActualCurrent,		0)
3440. 
3441. SetVariable(ZoneEndActual, 				0)
3442. SetVariable(ZoneEndActualCurrent,		0)			
3443. SetVariable(ZoneSizeActualPerCurrent, 	0)
3444.       
3445. SetVariable(ZoneFilesFolders,			0)
3446. SetVariable(ZoneFilesFoldersPer,		0) 
3447. 
3448. SetVariable(ZoneFragments,				0)
3449. SetVariable(ZoneFragmentsPer,			0) 
3450. 		
3451. SetVariable(ZoneEndActualCurrent, 		0)
3452. SetVariable(ZoneEndActualPerCurrent, 	0)
3453. 
3454. # Gap Calculation Methodology:
3455. 	# Requested
3456. 	SetVariable(GapRequested, 			0) 
3457. 	SetVariable(GapRequestedStd, 		0) 
3458. 	SetVariable(GapRequestedMft, 		0) 
3459. 	SetVariable(GapRequestedOs, 		0) 
3460. 	SetVariable(GapRequestedOriginal, 	0) 
3461. 	
3462. 	# Gap Adjustments
3463. 	SetVariable(GapRounded, 			0)
3464. 	# SetVariable(GapAdjusted, 			0)
3465. 	SetVariable(GapAvailable, 			0)
3466. 	SetVariable(GapCurrent, 			0)
3467. 	SetVariable(GapActual, 				0)
3468. 	SetVariable(GapUsed, 				0)
3469. 	
3470. 	# Gap Adjustments
3471. 	SetVariable(GapRoundedLoc, 			0)
3472. 	# SetVariable(GapAdjustedLoc, 		0)
3473. 	SetVariable(GapAvailableLoc, 		0)
3474. 	SetVariable(GapCurrentLoc, 			0)
3475. 	SetVariable(GapActualLoc,			0)
3476. 	SetVariable(GapUsedLoc,				0)
3477. 	
3478. 	# Space usage
3479. 	SetVariable(ZoneFreePerRequested, 	0)
3480. 	SetVariable(ZoneFreePerUsed, 		0)
3481. 
3482. # Gap Size & Rounding
3483. 	SetVariable(ZoneGapSizePer, 		0)
3484. 	SetVariable(ZoneVolRoundUpPer, 		0)
3485. 	
3486. 	# Free Space
3487. 	SetVariable(ZoneFreeUsedPer, 		0)
3488. 	SetVariable(ZoneFreeRequestedPer, 	0)
3489. 
3490. 
3491. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
3492. 
3493. # Footer:
3494. SetVariable(ZoneFooter, "----------------------------------------------------------
3495. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
3496. 
3497. Statistics Report:
3498. ------------------
3499.    Size:  
3500.    ------------------------
3501.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3502.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3503.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3504. 
3505.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3506.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3507. 
3508.    Location:
3509.    ------------------------
3510.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3511.              Files End: !ZoneEndCurrent!
3512.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3513.       
3514.    Gap Settings:
3515.    ------------------------
3516.          Gap Requested: !ZoneGapSizePer!%
3517.       Volume Rounding: !ZoneVolRoundUpPer!%
3518.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
3519.                  
3520.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
3521.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
3522.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
3523.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
3524.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
3525.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
3526.      
3527.    Free Space after Zone:
3528.    ------------------------
3529.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
3530.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
3531.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
3532. 
3533. Directory and Files Select:
3534. ---------------------------
3535. !ZoneTypeSelectCurrent!               
3536. ---------------------------
3537. ----------------------------------------------------------
3538. ")
3539. 
3540. # BANNER SET
3541. 
3542. # DATE TIME RUN ELP
3543. 
3544. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
3545. /* Xinclude "..\BannerSet.MyDc"X */
3546. /* pause(1) */
3547. 
3548. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3549. 
3550. Title('!Heading!')
3551. /* pause(1) */
3552. 
3553. /* NOTE: Can't round or truncate to integer precision. */
3554. 
3555. AppendLogfile("!LogFileName!", "!Title!")
3556. 
3557. 
3558. 
3559. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
3560. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
3561. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:15")
3562. 
3563. SetVariable(ZoneListByLine, "!ZoneListByLine!
3564. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
3565. 
3566. 
3567. /* Fixed Zone Position Handling */
3568. /* Literal number: */
3569. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
3570. /* Percentage of disk: */
3571. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
3572. /* Gap */
3573. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
3574. 
3575. /* ---------------------------------------------------------- */
3576. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
3577. # FILE STEP
3578. 
3579. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3580. 
3581. /* add message and move to a new line. */
3582. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3583. ")
3584. 
3585. /* display the line. (hopefully.) */
3586. # Zone Footer Set Statistics Window Text
3587. 
3588. SetStatisticsWindowText("----------------------------------------------------------
3589. Zones Processed: 
3590. ----------------------------------------------------------
3591. !ZoneListByLine!
3592. ----------------------------------------------------------
3593. Zone Processing Step:
3594. !ZoneStepByLine!    
3595. ----------------------------------------------------------
3596. Current Zone:
3597. !ZoneFooter!
3598. ----------------------------------------------------------
3599. Volume Statistics:
3600. !VolumeStatisticsDetail!
3601. ----------------------------------------------------------
3602. Zone Detailed Report:
3603. ----------------------------------------------------------
3604. !ZoneStatisticsDetail!
3605. ----------------------------------------------------------
3606. ")
3607. 
3608. 
3609. 
3610. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3611. 
3612. # BANNER SET
3613. 
3614. # DATE TIME RUN ELP
3615. 
3616. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
3617. /* Xinclude "..\BannerSet.MyDc"X */
3618. /* pause(1) */
3619. 
3620. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3621. 
3622. Title('!Heading!')
3623. /* pause(1) */
3624. 
3625. /* NOTE: Can't round or truncate to integer precision. */
3626. 
3627. pause(1)
3628. 
3629. # your stuff HERE (X)... pre file select code.
3630. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
3631. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
3632. 	# (X)
3633. 
3634. FileSelect
3635. 
3636. 	# your stuff can't really go here (errors.)
3637. 	# maybe for some reason I don't know of...
3638. 	
3639. 	# Actions next...
3640. 		# Boot start.
3641. ImportListFromBootOptimize()
3642. # Boot end.
3643. 
3644. 		and not(
3645. 			# Os PageHiberDump start.
3646. (
3647.   FileName("DataStore.edb")
3648.   or FileName("DUMP*.*")
3649.   or FileName("Hiberfil.sys")
3650.   or FileName("MEMORY.DMP")
3651.   or FileName("Pagefile.sys")
3652. )
3653. # Os PageHiberDump end.
3654. 
3655. 		)
3656. 		FileActions
3657. 		  		/* ---------------------------------------------------------- */
3658. 	# Gap
3659. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
3660. 		# FILE STEP
3661. 
3662. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
3663. 
3664. /* add message and move to a new line. */
3665. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
3666. ")
3667. 
3668. /* display the line. (hopefully.) */
3669. # Zone Footer Set Statistics Window Text
3670. 
3671. SetStatisticsWindowText("----------------------------------------------------------
3672. Zones Processed: 
3673. ----------------------------------------------------------
3674. !ZoneListByLine!
3675. ----------------------------------------------------------
3676. Zone Processing Step:
3677. !ZoneStepByLine!    
3678. ----------------------------------------------------------
3679. Current Zone:
3680. !ZoneFooter!
3681. ----------------------------------------------------------
3682. Volume Statistics:
3683. !VolumeStatisticsDetail!
3684. ----------------------------------------------------------
3685. Zone Detailed Report:
3686. ----------------------------------------------------------
3687. !ZoneStatisticsDetail!
3688. ----------------------------------------------------------
3689. ")
3690. 
3691. 
3692. 
3693. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
3694. 
3695. # BANNER SET
3696. 
3697. # DATE TIME RUN ELP
3698. 
3699. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
3700. /* Xinclude "..\BannerSet.MyDc"X */
3701. /* pause(1) */
3702. 
3703. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
3704. 
3705. Title('!Heading!')
3706. /* pause(1) */
3707. 
3708. /* NOTE: Can't round or truncate to integer precision. */
3709. 
3710. pause(1)
3711. 	
3712. 	# ACTUAL GAP
3713. 		/* AddGap Variant. */
3714. 	  	# Zone Do Gap
3715. # Gap Calculation Methods:
3716. 
3717. /* 1) Anything you need to add first. */
3718. /* empty */
3719. 
3720. /* ---------------------------------------------------------- */
3721. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
3722. 	# GapRequestedStd.
3723. 
3724. 		/* ---------------------------------------------------------- */
3725. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
3726. 
3727. 		# Gap Calculation Methods:
3728. 
3729. /* AddGap Variants */
3730. 
3731. 	/* Standard */
3732. 		# Gap Calculation Methods:
3733. 	/* AddGap Variants */
3734. 	/* Standard */
3735. 
3736. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
3737. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
3738. 
3739. 	SetVariable(GapRequested, GapRequestedStd)
3740. 	
3741. 
3742. 	/* MFT Low High Method */
3743. 		# Gap Calculation Methods:
3744. 	/* AddGap Variants */
3745. 	/* MFT Low High Method */
3746. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
3747. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
3748. 	SetVariable(GapRequested, GapRequestedMft)
3749. 	
3750. 
3751. 	/* OS Volume Type Method */
3752. 		# Gap Calculation Methods:
3753. 	/* AddGap Variants */
3754. 	/* OS Volume Type Method */
3755. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
3756. 	SetVariable(GapRequested, GapRequestedOs)
3757. 
3758. 
3759. 
3760. /* MakeGap Variants */
3761. 
3762. 	/* Original Os 1-3 + MFT 2 */
3763. 		# Gap Calculation Methods:
3764. 	/* MakeGap Variants */
3765. 	/* Original Os 1-3 + MFT 2 */
3766. 	/* plus MFT gap placed inline at the dividing zone. */
3767. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
3768. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
3769. 	SetVariable(GapRequested, GapRequestedOrig)
3770. 	
3771. 	
3772. /* Note: You could comment out the ones not in use */
3773. /* However having the data in the log is useful. */
3774. /* Therefore the following line is otherwise needed. */
3775. 
3776. /* Standard used */
3777. 
3778. SetVariable(GapRequested, GapRequestedStd)
3779. 
3780. # Gap Calculation Methods:
3781. 
3782. /* AddGap Variants */
3783. 	/* Standard */
3784. 	/* MFT Low High Method */
3785. 	/* OS Volume Type Method */
3786. 
3787. /* MakeGap Variants */
3788. 	/* Original Os 1-3 + MFT 2 */
3789. 
3790. /* Note: You could comment out the ones not in use */
3791. /* However having the data in the log is useful. */
3792. /* Therefore the following line is otherwise needed. */
3793. 
3794. /* Standard is used currently */
3795. 
3796. 
3797. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
3798. 
3799. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
3800. 
3801. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
3802. 
3803. /* ---------------------------------------------------------- */
3804. /* 3) SMALL ZONE ADJUSTMENT. */
3805. /* Gab cant be larger than half the Zone Size. */
3806. 
3807. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
3808. 	
3809. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
3810. 
3811. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
3812. 
3813. /* ---------------------------------------------------------- */
3814. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
3815. # Gap Adjustments.
3816. 
3817. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
3818. 	
3819. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
3820. 
3821. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
3822. 
3823. /* ---------------------------------------------------------- */
3824. # BYPASS THIS.
3825. 	/* This is definitely wrong. */
3826. 	/* The question is can we steal gap from the next zone */
3827. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
3828. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
3829. 		# Zone Overflow.
3830. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
3831. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
3832. 
3833. /* ---------------------------------------------------------- */
3834. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
3835. # Remaining free space available.
3836. 
3837. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
3838. 	
3839. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
3840. 
3841. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
3842. 
3843. /* ---------------------------------------------------------- */
3844. # CURRENT gap to use.
3845. 
3846. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
3847. 
3848. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
3849. 
3850. /* ---------------------------------------------------------- */
3851. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
3852. # Debugging.
3853. 
3854. 	SetVariable(GapUsed, GapCurrent) // for debugging
3855. 
3856. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
3857. 
3858. 		# Your code HERE
3859. 
3860. /* ---------------------------------------------------------- */
3861. /* 7) YOUR CODE. */
3862. # YOUR CODE HERE:
3863. 	# INPUT: GapCurrent or GapCurrentLoc
3864. 	# OUTPUT: GapUsed...
3865. 
3866. /* ---------------------------------------------------------- */
3867. # Gap Size.
3868. # Actual Size of Gap.
3869. 
3870. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
3871. 
3872. /* ---------------------------------------------------------- */
3873. /* xxxxxxxxxxxxxxxxxxxxxx */
3874. # ADD THE GAP
3875. 	/* Xinclude "..\GapCommandDo.MyDc"X */
3876. /* xxxxxxxxxxxxxxxxxxxxxx */
3877. 
3878. 	
3879. 	# Zone Statistics	
3880. 	# Zone / Volume Statistics and Display
3881. 		
3882. 	# Accumulate Totals
3883.   	# Volume totals
3884. 
3885. /* Current total space used (by Zones and Gaps) */
3886. 
3887. SetVariable(VolumeZoneUsed, GapUsed)
3888. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
3889. /* Percentage */
3890. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
3891. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
3892. 
3893. /* Current total of free space requested */
3894. 
3895. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
3896. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3897. /* Percent. */
3898. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
3899. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
3900. 
3901. /* Current total of free space used */
3902. 
3903. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
3904. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
3905. /* Percent */
3906. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
3907. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
3908. 
3909. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
3910. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
3911. /* Xinclude "..\DebugDisplayPause.MyDc"X */
3912. 
3913. 
3914. 	# Current Values
3915. 	# Cluster, Sector, Block adjust for display.
3916. 	# Bytes per cluster is volume specific.
3917. 
3918. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
3919. 
3920. # Current Zone values.
3921. 	# Begin, end and size.
3922. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
3923. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
3924. 
3925. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
3926. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
3927. 
3928. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
3929. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
3930. 
3931. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
3932. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
3933. 
3934. 	SetVariable(ZoneFragments,				"!ZONE210N!")
3935. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
3936. 		
3937. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
3938. /* identical code to here: (separation not needed. TEST.) */	
3939. 
3940. # Current Gap, Actual and Free Values
3941. 	# Gap
3942. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
3943. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
3944. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
3945. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
3946. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
3947. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
3948. 	
3949. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
3950. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
3951. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
3952. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
3953. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
3954. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
3955. 	
3956. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
3957. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
3958. 	
3959. 	# Actual Size and End
3960. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
3961. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
3962. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
3963. 	
3964. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
3965. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
3966. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
3967. 
3968. # Gap Size & Rounding
3969. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
3970. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
3971. 	
3972. 	# Free Space
3973. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
3974. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
3975. 
3976. 	# Footer:
3977. SetVariable(ZoneFooter, "----------------------------------------------------------
3978. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
3979. 
3980. Statistics Report:
3981. ------------------
3982.    Size:  
3983.    ------------------------
3984.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
3985.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
3986.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
3987. 
3988.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
3989.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
3990. 
3991.    Location:
3992.    ------------------------
3993.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
3994.              Files End: !ZoneEndCurrent!
3995.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
3996.       
3997.    Gap Settings:
3998.    ------------------------
3999.          Gap Requested: !ZoneGapSizePer!%
4000.       Volume Rounding: !ZoneVolRoundUpPer!%
4001.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4002.                  
4003.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4004.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4005.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4006.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4007.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4008.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4009.      
4010.    Free Space after Zone:
4011.    ------------------------
4012.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4013.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4014.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4015. 
4016. Directory and Files Select:
4017. ---------------------------
4018. !ZoneTypeSelectCurrent!               
4019. ---------------------------
4020. ----------------------------------------------------------
4021. ")
4022. 	# Zone Footer Set Statistics Window Text
4023. 
4024. SetStatisticsWindowText("----------------------------------------------------------
4025. Zones Processed: 
4026. ----------------------------------------------------------
4027. !ZoneListByLine!
4028. ----------------------------------------------------------
4029. Zone Processing Step:
4030. !ZoneStepByLine!    
4031. ----------------------------------------------------------
4032. Current Zone:
4033. !ZoneFooter!
4034. ----------------------------------------------------------
4035. Volume Statistics:
4036. !VolumeStatisticsDetail!
4037. ----------------------------------------------------------
4038. Zone Detailed Report:
4039. ----------------------------------------------------------
4040. !ZoneStatisticsDetail!
4041. ----------------------------------------------------------
4042. ")
4043. 
4044. 
4045. 	
4046.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
4047. 
4048. 	# Add Zone to list of zones for display.
4049. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
4050. 
4051. 	# Footer:
4052. SetVariable(ZoneFooter, "----------------------------------------------------------
4053. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
4054. 
4055. Statistics Report:
4056. ------------------
4057.    Size:  
4058.    ------------------------
4059.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4060.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4061.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4062. 
4063.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4064.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4065. 
4066.    Location:
4067.    ------------------------
4068.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4069.              Files End: !ZoneEndCurrent!
4070.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4071.       
4072.    Gap Settings:
4073.    ------------------------
4074.          Gap Requested: !ZoneGapSizePer!%
4075.       Volume Rounding: !ZoneVolRoundUpPer!%
4076.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4077.                  
4078.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4079.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4080.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4081.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4082.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4083.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4084.      
4085.    Free Space after Zone:
4086.    ------------------------
4087.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4088.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4089.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4090. 
4091. Directory and Files Select:
4092. ---------------------------
4093. !ZoneTypeSelectCurrent!               
4094. ---------------------------
4095. ----------------------------------------------------------
4096. ")
4097. 
4098. 	# Add Zone Details to Report.	
4099. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
4100. !ZoneFooter!")
4101. 
4102. 
4103. 	
4104. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
4105. 			# FILE STEP
4106. 
4107. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4108. 
4109. /* add message and move to a new line. */
4110. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4111. ")
4112. 
4113. /* display the line. (hopefully.) */
4114. # Zone Footer Set Statistics Window Text
4115. 
4116. SetStatisticsWindowText("----------------------------------------------------------
4117. Zones Processed: 
4118. ----------------------------------------------------------
4119. !ZoneListByLine!
4120. ----------------------------------------------------------
4121. Zone Processing Step:
4122. !ZoneStepByLine!    
4123. ----------------------------------------------------------
4124. Current Zone:
4125. !ZoneFooter!
4126. ----------------------------------------------------------
4127. Volume Statistics:
4128. !VolumeStatisticsDetail!
4129. ----------------------------------------------------------
4130. Zone Detailed Report:
4131. ----------------------------------------------------------
4132. !ZoneStatisticsDetail!
4133. ----------------------------------------------------------
4134. ")
4135. 
4136. 
4137. 
4138. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4139. 
4140. # BANNER SET
4141. 
4142. # DATE TIME RUN ELP
4143. 
4144. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
4145. /* Xinclude "..\BannerSet.MyDc"X */
4146. /* pause(1) */
4147. 
4148. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4149. 
4150. Title('!Heading!')
4151. /* pause(1) */
4152. 
4153. /* NOTE: Can't round or truncate to integer precision. */
4154. 
4155. pause(1)
4156. 
4157. 			SortByImportSequence(Ascending )
4158. 			/* SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) */
4159. 	
4160. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
4161. 			# FILE STEP
4162. 
4163. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4164. 
4165. /* add message and move to a new line. */
4166. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4167. ")
4168. 
4169. /* display the line. (hopefully.) */
4170. # Zone Footer Set Statistics Window Text
4171. 
4172. SetStatisticsWindowText("----------------------------------------------------------
4173. Zones Processed: 
4174. ----------------------------------------------------------
4175. !ZoneListByLine!
4176. ----------------------------------------------------------
4177. Zone Processing Step:
4178. !ZoneStepByLine!    
4179. ----------------------------------------------------------
4180. Current Zone:
4181. !ZoneFooter!
4182. ----------------------------------------------------------
4183. Volume Statistics:
4184. !VolumeStatisticsDetail!
4185. ----------------------------------------------------------
4186. Zone Detailed Report:
4187. ----------------------------------------------------------
4188. !ZoneStatisticsDetail!
4189. ----------------------------------------------------------
4190. ")
4191. 
4192. 
4193. 
4194. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4195. 
4196. # BANNER SET
4197. 
4198. # DATE TIME RUN ELP
4199. 
4200. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
4201. /* Xinclude "..\BannerSet.MyDc"X */
4202. /* pause(1) */
4203. 
4204. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4205. 
4206. Title('!Heading!')
4207. /* pause(1) */
4208. 
4209. /* NOTE: Can't round or truncate to integer precision. */
4210. 
4211. pause(1)
4212. 
4213. 		# Zone Do Footer
4214. 
4215. /* ---------------------------------------------------------- */
4216. # File Select
4217. 	# Select Statments
4218. # File Actions 
4219. 	# Standard or OS File Actions.
4220. 	# Resume...
4221. 	
4222. 	# your stuff HERE (X)... post zone (file) file actions code.
4223. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
4224. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
4225. 		# (X)
4226. 		
4227. 		/* ??? Set window? */
4228. 	
4229. 	# ADD THE GAP
4230. 		
4231. # Vacate (good for diagnostics)
4232. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
4233. 
4234. # DoNotVacate - DO NOT Vacate (recommended)
4235. 
4236. # Vacate
4237. /* AddGap(GapUsedLoc) */
4238. 
4239. # DO Not Vacate
4240. AddGap(GapUsedLoc, DoNotVacate) 
4241. 	
4242. 	
4243. /* ---------------------------------------------------------- */
4244. # (failed) TEST for boolean logic.
4245. 
4246. /* It should work in the gap calculations for turning options */
4247. /* on and off but it will NOT work here. */
4248. 
4249. /* Boolean setting X or FlagX. */
4250. /* Where X will be on or off: */
4251. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
4252. /*      For ON:  (X  *  FlagAny) */
4253. 
4254. /* 1) Failed, zero gap overrode the previous one. */
4255. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
4256. /* AddGap(GapUsedTemp) */ 
4257. 
4258. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
4259. /* AddGap(GapUsedTemp, DoNotVacate) */ 
4260. 
4261. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
4262. 
4263. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
4264. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
4265. /* AddGap(GapUsedTemp) */ 
4266. 
4267. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
4268. /* AddGap(GapUsedTemp, DoNotVacate) */ 
4269. 
4270. /* ---------------------------------------------------------- */
4271. 
4272. # Vacate
4273. /* AddGap(GapUsed) */
4274. 
4275. # DO NOT Vacate (recommended)
4276. /* AddGap(GapUsed, DoNotVacate) */ 
4277. 	
4278. 
4279. 		
4280. # 
4281. FileEnd
4282. /* ---------------------------------------------------------- */
4283. 
4284. # your stuff HERE (X)... post zone (file) code.
4285. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
4286. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
4287. 	# (X)
4288. 
4289. SetVariable(FileStepDescription,"Zone finished, reporting.")
4290. # FILE STEP
4291. 
4292. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4293. 
4294. /* add message and move to a new line. */
4295. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4296. ")
4297. 
4298. /* display the line. (hopefully.) */
4299. # Zone Footer Set Statistics Window Text
4300. 
4301. SetStatisticsWindowText("----------------------------------------------------------
4302. Zones Processed: 
4303. ----------------------------------------------------------
4304. !ZoneListByLine!
4305. ----------------------------------------------------------
4306. Zone Processing Step:
4307. !ZoneStepByLine!    
4308. ----------------------------------------------------------
4309. Current Zone:
4310. !ZoneFooter!
4311. ----------------------------------------------------------
4312. Volume Statistics:
4313. !VolumeStatisticsDetail!
4314. ----------------------------------------------------------
4315. Zone Detailed Report:
4316. ----------------------------------------------------------
4317. !ZoneStatisticsDetail!
4318. ----------------------------------------------------------
4319. ")
4320. 
4321. 
4322. 
4323. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4324. 
4325. # BANNER SET
4326. 
4327. # DATE TIME RUN ELP
4328. 
4329. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
4330. /* Xinclude "..\BannerSet.MyDc"X */
4331. /* pause(1) */
4332. 
4333. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4334. 
4335. Title('!Heading!')
4336. /* pause(1) */
4337. 
4338. /* NOTE: Can't round or truncate to integer precision. */
4339. 
4340. pause(1)
4341. 
4342. # Zone When Finished
4343. 
4344. # BANNER SET
4345. 
4346. # DATE TIME RUN ELP
4347. 
4348. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
4349. /* Xinclude "..\BannerSet.MyDc"X */
4350. /* pause(1) */
4351. 
4352. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4353. 
4354. Title('!Heading!')
4355. /* pause(1) */
4356. 
4357. /* NOTE: Can't round or truncate to integer precision. */
4358. 
4359. AppendLogfile("!LogFileName!", "!Title!")
4360. 
4361. 
4362. 
4363. # Zone Statistics	
4364. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
4365. 
4366. # Footer:
4367. SetVariable(ZoneFooter, "----------------------------------------------------------
4368. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
4369. 
4370. Statistics Report:
4371. ------------------
4372.    Size:  
4373.    ------------------------
4374.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4375.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4376.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4377. 
4378.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4379.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4380. 
4381.    Location:
4382.    ------------------------
4383.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4384.              Files End: !ZoneEndCurrent!
4385.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4386.       
4387.    Gap Settings:
4388.    ------------------------
4389.          Gap Requested: !ZoneGapSizePer!%
4390.       Volume Rounding: !ZoneVolRoundUpPer!%
4391.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4392.                  
4393.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4394.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4395.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4396.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4397.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4398.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4399.      
4400.    Free Space after Zone:
4401.    ------------------------
4402.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4403.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4404.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4405. 
4406. Directory and Files Select:
4407. ---------------------------
4408. !ZoneTypeSelectCurrent!               
4409. ---------------------------
4410. ----------------------------------------------------------
4411. ")
4412. 
4413. AppendLogfile("!LogFileName!", ".")
4414. AppendLogfile("!LogFileName!", "!ZoneFooter!")
4415. AppendLogfile("!LogFileName!", ".")
4416. 
4417. # Zone Footer Set Statistics Window Text
4418. 
4419. SetStatisticsWindowText("----------------------------------------------------------
4420. Zones Processed: 
4421. ----------------------------------------------------------
4422. !ZoneListByLine!
4423. ----------------------------------------------------------
4424. Zone Processing Step:
4425. !ZoneStepByLine!    
4426. ----------------------------------------------------------
4427. Current Zone:
4428. !ZoneFooter!
4429. ----------------------------------------------------------
4430. Volume Statistics:
4431. !VolumeStatisticsDetail!
4432. ----------------------------------------------------------
4433. Zone Detailed Report:
4434. ----------------------------------------------------------
4435. !ZoneStatisticsDetail!
4436. ----------------------------------------------------------
4437. ")
4438. 
4439. 
4440. 
4441. /* pause() */
4442. /* pause() */
4443. 
4444. 
4445. 
4446. 
4447. /* ---------------------------------------------------------- */
4448. 
4449. 
4450. /* ---------------------------------------------------------- */
4451. # Zone ProgramHints Fixed.
4452. /* ---------------------------------------------------------- */
4453. # Zone ProgramHints Fixed.
4454. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHints!")
4455. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHints!")
4456. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
4457. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHint!")
4458. 	SetVariable(ZoneTypeSelect,'# ProgramHints start.
4459. ImportListFromProgramHints("*.pf")
4460. # ProgramHints end.
4461. ')
4462. 
4463. 		# Zone Do Header
4464. 
4465. # Zone When Started
4466. 
4467. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
4468. # Display Set Zone
4469. 
4470. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
4471. SetVariable(FileStepDescription,	"")
4472. 
4473. SetVariable(ZoneStepByLine, 			"Zone started.
4474. ")
4475. 
4476. # BANNER SET
4477. 
4478. # DATE TIME RUN ELP
4479. 
4480. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
4481. /* Xinclude "..\BannerSet.MyDc"X */
4482. /* pause(1) */
4483. 
4484. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4485. 
4486. Title('!Heading!')
4487. /* pause(1) */
4488. 
4489. /* NOTE: Can't round or truncate to integer precision. */
4490. 
4491. AppendLogfile("!LogFileName!", "!Title!")
4492. 
4493. 
4494. 
4495. pause(1)
4496. 
4497. 
4498. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
4499. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
4500. 
4501. SetVariable(ZoneStepNoCurrent, 0)
4502. 
4503. 
4504. # Zone Do Current Clear
4505. 
4506. SetVariable(ZoneTypeSelectCurrent, 		"")
4507. 
4508. SetVariable(ZoneBeginCurrent, 			0)
4509. SetVariable(ZoneBeginPerCurrent, 		0)
4510. SetVariable(ZoneEndCurrent, 			0)
4511. SetVariable(ZoneEndPerCurrent, 			0)
4512. 
4513. SetVariable(ZoneSizeCurrent,			0)
4514. SetVariable(ZoneSizePerCurrent,			0)
4515. 
4516. SetVariable(ZoneGapRequestedCurrent,	0)
4517. SetVariable(ZoneGapRoundedCurrent, 		0)
4518. SetVariable(ZoneGapAdjustedCurrent, 	0)
4519. SetVariable(ZoneGapAvailableCurrent, 	0)
4520. SetVariable(ZoneGapCurrent,				0)
4521. SetVariable(ZoneGapUsedCurrent, 		0)
4522. 
4523. SetVariable(ZoneGapActualCurrent, 		0)
4524. SetVariable(ZoneGapActualPerCurrent, 	0)
4525. 
4526. SetVariable(ZoneSizeActual, 			0)
4527. SetVariable(ZoneSizeActualCurrent,		0)
4528. 
4529. SetVariable(ZoneEndActual, 				0)
4530. SetVariable(ZoneEndActualCurrent,		0)			
4531. SetVariable(ZoneSizeActualPerCurrent, 	0)
4532.       
4533. SetVariable(ZoneFilesFolders,			0)
4534. SetVariable(ZoneFilesFoldersPer,		0) 
4535. 
4536. SetVariable(ZoneFragments,				0)
4537. SetVariable(ZoneFragmentsPer,			0) 
4538. 		
4539. SetVariable(ZoneEndActualCurrent, 		0)
4540. SetVariable(ZoneEndActualPerCurrent, 	0)
4541. 
4542. # Gap Calculation Methodology:
4543. 	# Requested
4544. 	SetVariable(GapRequested, 			0) 
4545. 	SetVariable(GapRequestedStd, 		0) 
4546. 	SetVariable(GapRequestedMft, 		0) 
4547. 	SetVariable(GapRequestedOs, 		0) 
4548. 	SetVariable(GapRequestedOriginal, 	0) 
4549. 	
4550. 	# Gap Adjustments
4551. 	SetVariable(GapRounded, 			0)
4552. 	# SetVariable(GapAdjusted, 			0)
4553. 	SetVariable(GapAvailable, 			0)
4554. 	SetVariable(GapCurrent, 			0)
4555. 	SetVariable(GapActual, 				0)
4556. 	SetVariable(GapUsed, 				0)
4557. 	
4558. 	# Gap Adjustments
4559. 	SetVariable(GapRoundedLoc, 			0)
4560. 	# SetVariable(GapAdjustedLoc, 		0)
4561. 	SetVariable(GapAvailableLoc, 		0)
4562. 	SetVariable(GapCurrentLoc, 			0)
4563. 	SetVariable(GapActualLoc,			0)
4564. 	SetVariable(GapUsedLoc,				0)
4565. 	
4566. 	# Space usage
4567. 	SetVariable(ZoneFreePerRequested, 	0)
4568. 	SetVariable(ZoneFreePerUsed, 		0)
4569. 
4570. # Gap Size & Rounding
4571. 	SetVariable(ZoneGapSizePer, 		0)
4572. 	SetVariable(ZoneVolRoundUpPer, 		0)
4573. 	
4574. 	# Free Space
4575. 	SetVariable(ZoneFreeUsedPer, 		0)
4576. 	SetVariable(ZoneFreeRequestedPer, 	0)
4577. 
4578. 
4579. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
4580. 
4581. # Footer:
4582. SetVariable(ZoneFooter, "----------------------------------------------------------
4583. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
4584. 
4585. Statistics Report:
4586. ------------------
4587.    Size:  
4588.    ------------------------
4589.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
4590.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
4591.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
4592. 
4593.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
4594.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
4595. 
4596.    Location:
4597.    ------------------------
4598.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
4599.              Files End: !ZoneEndCurrent!
4600.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
4601.       
4602.    Gap Settings:
4603.    ------------------------
4604.          Gap Requested: !ZoneGapSizePer!%
4605.       Volume Rounding: !ZoneVolRoundUpPer!%
4606.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
4607.                  
4608.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
4609.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
4610.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
4611.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
4612.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
4613.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
4614.      
4615.    Free Space after Zone:
4616.    ------------------------
4617.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
4618.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
4619.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
4620. 
4621. Directory and Files Select:
4622. ---------------------------
4623. !ZoneTypeSelectCurrent!               
4624. ---------------------------
4625. ----------------------------------------------------------
4626. ")
4627. 
4628. # BANNER SET
4629. 
4630. # DATE TIME RUN ELP
4631. 
4632. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
4633. /* Xinclude "..\BannerSet.MyDc"X */
4634. /* pause(1) */
4635. 
4636. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4637. 
4638. Title('!Heading!')
4639. /* pause(1) */
4640. 
4641. /* NOTE: Can't round or truncate to integer precision. */
4642. 
4643. AppendLogfile("!LogFileName!", "!Title!")
4644. 
4645. 
4646. 
4647. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
4648. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
4649. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:15")
4650. 
4651. SetVariable(ZoneListByLine, "!ZoneListByLine!
4652. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
4653. 
4654. 
4655. /* Fixed Zone Position Handling */
4656. /* Literal number: */
4657. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
4658. /* Percentage of disk: */
4659. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
4660. /* Gap */
4661. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
4662. 
4663. /* ---------------------------------------------------------- */
4664. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
4665. # FILE STEP
4666. 
4667. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4668. 
4669. /* add message and move to a new line. */
4670. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4671. ")
4672. 
4673. /* display the line. (hopefully.) */
4674. # Zone Footer Set Statistics Window Text
4675. 
4676. SetStatisticsWindowText("----------------------------------------------------------
4677. Zones Processed: 
4678. ----------------------------------------------------------
4679. !ZoneListByLine!
4680. ----------------------------------------------------------
4681. Zone Processing Step:
4682. !ZoneStepByLine!    
4683. ----------------------------------------------------------
4684. Current Zone:
4685. !ZoneFooter!
4686. ----------------------------------------------------------
4687. Volume Statistics:
4688. !VolumeStatisticsDetail!
4689. ----------------------------------------------------------
4690. Zone Detailed Report:
4691. ----------------------------------------------------------
4692. !ZoneStatisticsDetail!
4693. ----------------------------------------------------------
4694. ")
4695. 
4696. 
4697. 
4698. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4699. 
4700. # BANNER SET
4701. 
4702. # DATE TIME RUN ELP
4703. 
4704. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
4705. /* Xinclude "..\BannerSet.MyDc"X */
4706. /* pause(1) */
4707. 
4708. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4709. 
4710. Title('!Heading!')
4711. /* pause(1) */
4712. 
4713. /* NOTE: Can't round or truncate to integer precision. */
4714. 
4715. pause(1)
4716. 
4717. # your stuff HERE (X)... pre file select code.
4718. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
4719. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
4720. 	# (X)
4721. 
4722. FileSelect
4723. 
4724. 	# your stuff can't really go here (errors.)
4725. 	# maybe for some reason I don't know of...
4726. 	
4727. 	# Actions next...
4728. 		# ProgramHints start.
4729. ImportListFromProgramHints("*.pf")
4730. # ProgramHints end.
4731. 
4732. 		and not(
4733. 			# Os Data Dynamic start.
4734. (
4735. # Os Data Dynamic start.
4736. (
4737.   FileName("*.dat*")
4738.   or FileName("*.db*")
4739.   or FileName("*.edb*")
4740.   or FileName("*.log*")
4741.   or FileName("DataStore.edb")
4742. )
4743. # Os Data Dynamic end.
4744. 
4745.   or 
4746. # Os PageHiberDump start.
4747. (
4748.   FileName("DataStore.edb")
4749.   or FileName("DUMP*.*")
4750.   or FileName("Hiberfil.sys")
4751.   or FileName("MEMORY.DMP")
4752.   or FileName("Pagefile.sys")
4753. )
4754. # Os PageHiberDump end.
4755. 
4756. # Os Data Dynamic
4757. )
4758. # Os Data Dynamic end.
4759. 
4760. 		)
4761. 		FileActions
4762. 		  		/* ---------------------------------------------------------- */
4763. 	# Gap
4764. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
4765. 		# FILE STEP
4766. 
4767. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
4768. 
4769. /* add message and move to a new line. */
4770. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
4771. ")
4772. 
4773. /* display the line. (hopefully.) */
4774. # Zone Footer Set Statistics Window Text
4775. 
4776. SetStatisticsWindowText("----------------------------------------------------------
4777. Zones Processed: 
4778. ----------------------------------------------------------
4779. !ZoneListByLine!
4780. ----------------------------------------------------------
4781. Zone Processing Step:
4782. !ZoneStepByLine!    
4783. ----------------------------------------------------------
4784. Current Zone:
4785. !ZoneFooter!
4786. ----------------------------------------------------------
4787. Volume Statistics:
4788. !VolumeStatisticsDetail!
4789. ----------------------------------------------------------
4790. Zone Detailed Report:
4791. ----------------------------------------------------------
4792. !ZoneStatisticsDetail!
4793. ----------------------------------------------------------
4794. ")
4795. 
4796. 
4797. 
4798. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
4799. 
4800. # BANNER SET
4801. 
4802. # DATE TIME RUN ELP
4803. 
4804. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
4805. /* Xinclude "..\BannerSet.MyDc"X */
4806. /* pause(1) */
4807. 
4808. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
4809. 
4810. Title('!Heading!')
4811. /* pause(1) */
4812. 
4813. /* NOTE: Can't round or truncate to integer precision. */
4814. 
4815. pause(1)
4816. 	
4817. 	# ACTUAL GAP
4818. 		/* AddGap Variant. */
4819. 	  	# Zone Do Gap
4820. # Gap Calculation Methods:
4821. 
4822. /* 1) Anything you need to add first. */
4823. /* empty */
4824. 
4825. /* ---------------------------------------------------------- */
4826. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
4827. 	# GapRequestedStd.
4828. 
4829. 		/* ---------------------------------------------------------- */
4830. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
4831. 
4832. 		# Gap Calculation Methods:
4833. 
4834. /* AddGap Variants */
4835. 
4836. 	/* Standard */
4837. 		# Gap Calculation Methods:
4838. 	/* AddGap Variants */
4839. 	/* Standard */
4840. 
4841. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
4842. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
4843. 
4844. 	SetVariable(GapRequested, GapRequestedStd)
4845. 	
4846. 
4847. 	/* MFT Low High Method */
4848. 		# Gap Calculation Methods:
4849. 	/* AddGap Variants */
4850. 	/* MFT Low High Method */
4851. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
4852. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
4853. 	SetVariable(GapRequested, GapRequestedMft)
4854. 	
4855. 
4856. 	/* OS Volume Type Method */
4857. 		# Gap Calculation Methods:
4858. 	/* AddGap Variants */
4859. 	/* OS Volume Type Method */
4860. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
4861. 	SetVariable(GapRequested, GapRequestedOs)
4862. 
4863. 
4864. 
4865. /* MakeGap Variants */
4866. 
4867. 	/* Original Os 1-3 + MFT 2 */
4868. 		# Gap Calculation Methods:
4869. 	/* MakeGap Variants */
4870. 	/* Original Os 1-3 + MFT 2 */
4871. 	/* plus MFT gap placed inline at the dividing zone. */
4872. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
4873. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
4874. 	SetVariable(GapRequested, GapRequestedOrig)
4875. 	
4876. 	
4877. /* Note: You could comment out the ones not in use */
4878. /* However having the data in the log is useful. */
4879. /* Therefore the following line is otherwise needed. */
4880. 
4881. /* Standard used */
4882. 
4883. SetVariable(GapRequested, GapRequestedStd)
4884. 
4885. # Gap Calculation Methods:
4886. 
4887. /* AddGap Variants */
4888. 	/* Standard */
4889. 	/* MFT Low High Method */
4890. 	/* OS Volume Type Method */
4891. 
4892. /* MakeGap Variants */
4893. 	/* Original Os 1-3 + MFT 2 */
4894. 
4895. /* Note: You could comment out the ones not in use */
4896. /* However having the data in the log is useful. */
4897. /* Therefore the following line is otherwise needed. */
4898. 
4899. /* Standard is used currently */
4900. 
4901. 
4902. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
4903. 
4904. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
4905. 
4906. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
4907. 
4908. /* ---------------------------------------------------------- */
4909. /* 3) SMALL ZONE ADJUSTMENT. */
4910. /* Gab cant be larger than half the Zone Size. */
4911. 
4912. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
4913. 	
4914. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
4915. 
4916. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
4917. 
4918. /* ---------------------------------------------------------- */
4919. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
4920. # Gap Adjustments.
4921. 
4922. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
4923. 	
4924. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
4925. 
4926. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
4927. 
4928. /* ---------------------------------------------------------- */
4929. # BYPASS THIS.
4930. 	/* This is definitely wrong. */
4931. 	/* The question is can we steal gap from the next zone */
4932. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
4933. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
4934. 		# Zone Overflow.
4935. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
4936. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
4937. 
4938. /* ---------------------------------------------------------- */
4939. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
4940. # Remaining free space available.
4941. 
4942. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
4943. 	
4944. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
4945. 
4946. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
4947. 
4948. /* ---------------------------------------------------------- */
4949. # CURRENT gap to use.
4950. 
4951. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
4952. 
4953. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
4954. 
4955. /* ---------------------------------------------------------- */
4956. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
4957. # Debugging.
4958. 
4959. 	SetVariable(GapUsed, GapCurrent) // for debugging
4960. 
4961. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
4962. 
4963. 		# Your code HERE
4964. 
4965. /* ---------------------------------------------------------- */
4966. /* 7) YOUR CODE. */
4967. # YOUR CODE HERE:
4968. 	# INPUT: GapCurrent or GapCurrentLoc
4969. 	# OUTPUT: GapUsed...
4970. 
4971. /* ---------------------------------------------------------- */
4972. # Gap Size.
4973. # Actual Size of Gap.
4974. 
4975. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
4976. 
4977. /* ---------------------------------------------------------- */
4978. /* xxxxxxxxxxxxxxxxxxxxxx */
4979. # ADD THE GAP
4980. 	/* Xinclude "..\GapCommandDo.MyDc"X */
4981. /* xxxxxxxxxxxxxxxxxxxxxx */
4982. 
4983. 	
4984. 	# Zone Statistics	
4985. 	# Zone / Volume Statistics and Display
4986. 		
4987. 	# Accumulate Totals
4988.   	# Volume totals
4989. 
4990. /* Current total space used (by Zones and Gaps) */
4991. 
4992. SetVariable(VolumeZoneUsed, GapUsed)
4993. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
4994. /* Percentage */
4995. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
4996. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
4997. 
4998. /* Current total of free space requested */
4999. 
5000. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
5001. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5002. /* Percent. */
5003. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
5004. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
5005. 
5006. /* Current total of free space used */
5007. 
5008. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
5009. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
5010. /* Percent */
5011. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
5012. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
5013. 
5014. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
5015. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
5016. /* Xinclude "..\DebugDisplayPause.MyDc"X */
5017. 
5018. 
5019. 	# Current Values
5020. 	# Cluster, Sector, Block adjust for display.
5021. 	# Bytes per cluster is volume specific.
5022. 
5023. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
5024. 
5025. # Current Zone values.
5026. 	# Begin, end and size.
5027. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
5028. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
5029. 
5030. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
5031. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
5032. 
5033. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
5034. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
5035. 
5036. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
5037. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
5038. 
5039. 	SetVariable(ZoneFragments,				"!ZONE210N!")
5040. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
5041. 		
5042. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
5043. /* identical code to here: (separation not needed. TEST.) */	
5044. 
5045. # Current Gap, Actual and Free Values
5046. 	# Gap
5047. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
5048. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
5049. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
5050. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
5051. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
5052. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
5053. 	
5054. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
5055. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
5056. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
5057. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
5058. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
5059. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
5060. 	
5061. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
5062. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
5063. 	
5064. 	# Actual Size and End
5065. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
5066. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
5067. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
5068. 	
5069. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
5070. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
5071. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
5072. 
5073. # Gap Size & Rounding
5074. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
5075. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
5076. 	
5077. 	# Free Space
5078. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
5079. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
5080. 
5081. 	# Footer:
5082. SetVariable(ZoneFooter, "----------------------------------------------------------
5083. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
5084. 
5085. Statistics Report:
5086. ------------------
5087.    Size:  
5088.    ------------------------
5089.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5090.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5091.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5092. 
5093.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5094.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5095. 
5096.    Location:
5097.    ------------------------
5098.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5099.              Files End: !ZoneEndCurrent!
5100.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5101.       
5102.    Gap Settings:
5103.    ------------------------
5104.          Gap Requested: !ZoneGapSizePer!%
5105.       Volume Rounding: !ZoneVolRoundUpPer!%
5106.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5107.                  
5108.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5109.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5110.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5111.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5112.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5113.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5114.      
5115.    Free Space after Zone:
5116.    ------------------------
5117.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5118.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5119.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5120. 
5121. Directory and Files Select:
5122. ---------------------------
5123. !ZoneTypeSelectCurrent!               
5124. ---------------------------
5125. ----------------------------------------------------------
5126. ")
5127. 	# Zone Footer Set Statistics Window Text
5128. 
5129. SetStatisticsWindowText("----------------------------------------------------------
5130. Zones Processed: 
5131. ----------------------------------------------------------
5132. !ZoneListByLine!
5133. ----------------------------------------------------------
5134. Zone Processing Step:
5135. !ZoneStepByLine!    
5136. ----------------------------------------------------------
5137. Current Zone:
5138. !ZoneFooter!
5139. ----------------------------------------------------------
5140. Volume Statistics:
5141. !VolumeStatisticsDetail!
5142. ----------------------------------------------------------
5143. Zone Detailed Report:
5144. ----------------------------------------------------------
5145. !ZoneStatisticsDetail!
5146. ----------------------------------------------------------
5147. ")
5148. 
5149. 
5150. 	
5151.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
5152. 
5153. 	# Add Zone to list of zones for display.
5154. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
5155. 
5156. 	# Footer:
5157. SetVariable(ZoneFooter, "----------------------------------------------------------
5158. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
5159. 
5160. Statistics Report:
5161. ------------------
5162.    Size:  
5163.    ------------------------
5164.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5165.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5166.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5167. 
5168.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5169.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5170. 
5171.    Location:
5172.    ------------------------
5173.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5174.              Files End: !ZoneEndCurrent!
5175.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5176.       
5177.    Gap Settings:
5178.    ------------------------
5179.          Gap Requested: !ZoneGapSizePer!%
5180.       Volume Rounding: !ZoneVolRoundUpPer!%
5181.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5182.                  
5183.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5184.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5185.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5186.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5187.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5188.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5189.      
5190.    Free Space after Zone:
5191.    ------------------------
5192.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5193.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5194.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5195. 
5196. Directory and Files Select:
5197. ---------------------------
5198. !ZoneTypeSelectCurrent!               
5199. ---------------------------
5200. ----------------------------------------------------------
5201. ")
5202. 
5203. 	# Add Zone Details to Report.	
5204. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
5205. !ZoneFooter!")
5206. 
5207. 
5208. 		
5209. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
5210. 			# FILE STEP
5211. 
5212. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5213. 
5214. /* add message and move to a new line. */
5215. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5216. ")
5217. 
5218. /* display the line. (hopefully.) */
5219. # Zone Footer Set Statistics Window Text
5220. 
5221. SetStatisticsWindowText("----------------------------------------------------------
5222. Zones Processed: 
5223. ----------------------------------------------------------
5224. !ZoneListByLine!
5225. ----------------------------------------------------------
5226. Zone Processing Step:
5227. !ZoneStepByLine!    
5228. ----------------------------------------------------------
5229. Current Zone:
5230. !ZoneFooter!
5231. ----------------------------------------------------------
5232. Volume Statistics:
5233. !VolumeStatisticsDetail!
5234. ----------------------------------------------------------
5235. Zone Detailed Report:
5236. ----------------------------------------------------------
5237. !ZoneStatisticsDetail!
5238. ----------------------------------------------------------
5239. ")
5240. 
5241. 
5242. 
5243. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5244. 
5245. # BANNER SET
5246. 
5247. # DATE TIME RUN ELP
5248. 
5249. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
5250. /* Xinclude "..\BannerSet.MyDc"X */
5251. /* pause(1) */
5252. 
5253. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5254. 
5255. Title('!Heading!')
5256. /* pause(1) */
5257. 
5258. /* NOTE: Can't round or truncate to integer precision. */
5259. 
5260. pause(1)
5261. 	
5262. 			SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
5263. 
5264. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
5265. 			# FILE STEP
5266. 
5267. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5268. 
5269. /* add message and move to a new line. */
5270. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5271. ")
5272. 
5273. /* display the line. (hopefully.) */
5274. # Zone Footer Set Statistics Window Text
5275. 
5276. SetStatisticsWindowText("----------------------------------------------------------
5277. Zones Processed: 
5278. ----------------------------------------------------------
5279. !ZoneListByLine!
5280. ----------------------------------------------------------
5281. Zone Processing Step:
5282. !ZoneStepByLine!    
5283. ----------------------------------------------------------
5284. Current Zone:
5285. !ZoneFooter!
5286. ----------------------------------------------------------
5287. Volume Statistics:
5288. !VolumeStatisticsDetail!
5289. ----------------------------------------------------------
5290. Zone Detailed Report:
5291. ----------------------------------------------------------
5292. !ZoneStatisticsDetail!
5293. ----------------------------------------------------------
5294. ")
5295. 
5296. 
5297. 
5298. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5299. 
5300. # BANNER SET
5301. 
5302. # DATE TIME RUN ELP
5303. 
5304. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
5305. /* Xinclude "..\BannerSet.MyDc"X */
5306. /* pause(1) */
5307. 
5308. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5309. 
5310. Title('!Heading!')
5311. /* pause(1) */
5312. 
5313. /* NOTE: Can't round or truncate to integer precision. */
5314. 
5315. pause(1)
5316. 
5317. 		# Zone Do Footer
5318. 
5319. /* ---------------------------------------------------------- */
5320. # File Select
5321. 	# Select Statments
5322. # File Actions 
5323. 	# Standard or OS File Actions.
5324. 	# Resume...
5325. 	
5326. 	# your stuff HERE (X)... post zone (file) file actions code.
5327. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
5328. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
5329. 		# (X)
5330. 		
5331. 		/* ??? Set window? */
5332. 	
5333. 	# ADD THE GAP
5334. 		
5335. # Vacate (good for diagnostics)
5336. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
5337. 
5338. # DoNotVacate - DO NOT Vacate (recommended)
5339. 
5340. # Vacate
5341. /* AddGap(GapUsedLoc) */
5342. 
5343. # DO Not Vacate
5344. AddGap(GapUsedLoc, DoNotVacate) 
5345. 	
5346. 	
5347. /* ---------------------------------------------------------- */
5348. # (failed) TEST for boolean logic.
5349. 
5350. /* It should work in the gap calculations for turning options */
5351. /* on and off but it will NOT work here. */
5352. 
5353. /* Boolean setting X or FlagX. */
5354. /* Where X will be on or off: */
5355. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
5356. /*      For ON:  (X  *  FlagAny) */
5357. 
5358. /* 1) Failed, zero gap overrode the previous one. */
5359. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
5360. /* AddGap(GapUsedTemp) */ 
5361. 
5362. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
5363. /* AddGap(GapUsedTemp, DoNotVacate) */ 
5364. 
5365. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
5366. 
5367. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
5368. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
5369. /* AddGap(GapUsedTemp) */ 
5370. 
5371. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
5372. /* AddGap(GapUsedTemp, DoNotVacate) */ 
5373. 
5374. /* ---------------------------------------------------------- */
5375. 
5376. # Vacate
5377. /* AddGap(GapUsed) */
5378. 
5379. # DO NOT Vacate (recommended)
5380. /* AddGap(GapUsed, DoNotVacate) */ 
5381. 	
5382. 
5383. 		
5384. # 
5385. FileEnd
5386. /* ---------------------------------------------------------- */
5387. 
5388. # your stuff HERE (X)... post zone (file) code.
5389. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
5390. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
5391. 	# (X)
5392. 
5393. SetVariable(FileStepDescription,"Zone finished, reporting.")
5394. # FILE STEP
5395. 
5396. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5397. 
5398. /* add message and move to a new line. */
5399. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5400. ")
5401. 
5402. /* display the line. (hopefully.) */
5403. # Zone Footer Set Statistics Window Text
5404. 
5405. SetStatisticsWindowText("----------------------------------------------------------
5406. Zones Processed: 
5407. ----------------------------------------------------------
5408. !ZoneListByLine!
5409. ----------------------------------------------------------
5410. Zone Processing Step:
5411. !ZoneStepByLine!    
5412. ----------------------------------------------------------
5413. Current Zone:
5414. !ZoneFooter!
5415. ----------------------------------------------------------
5416. Volume Statistics:
5417. !VolumeStatisticsDetail!
5418. ----------------------------------------------------------
5419. Zone Detailed Report:
5420. ----------------------------------------------------------
5421. !ZoneStatisticsDetail!
5422. ----------------------------------------------------------
5423. ")
5424. 
5425. 
5426. 
5427. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5428. 
5429. # BANNER SET
5430. 
5431. # DATE TIME RUN ELP
5432. 
5433. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
5434. /* Xinclude "..\BannerSet.MyDc"X */
5435. /* pause(1) */
5436. 
5437. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5438. 
5439. Title('!Heading!')
5440. /* pause(1) */
5441. 
5442. /* NOTE: Can't round or truncate to integer precision. */
5443. 
5444. pause(1)
5445. 
5446. # Zone When Finished
5447. 
5448. # BANNER SET
5449. 
5450. # DATE TIME RUN ELP
5451. 
5452. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
5453. /* Xinclude "..\BannerSet.MyDc"X */
5454. /* pause(1) */
5455. 
5456. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5457. 
5458. Title('!Heading!')
5459. /* pause(1) */
5460. 
5461. /* NOTE: Can't round or truncate to integer precision. */
5462. 
5463. AppendLogfile("!LogFileName!", "!Title!")
5464. 
5465. 
5466. 
5467. # Zone Statistics	
5468. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
5469. 
5470. # Footer:
5471. SetVariable(ZoneFooter, "----------------------------------------------------------
5472. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
5473. 
5474. Statistics Report:
5475. ------------------
5476.    Size:  
5477.    ------------------------
5478.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5479.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5480.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5481. 
5482.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5483.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5484. 
5485.    Location:
5486.    ------------------------
5487.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5488.              Files End: !ZoneEndCurrent!
5489.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5490.       
5491.    Gap Settings:
5492.    ------------------------
5493.          Gap Requested: !ZoneGapSizePer!%
5494.       Volume Rounding: !ZoneVolRoundUpPer!%
5495.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5496.                  
5497.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5498.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5499.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5500.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5501.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5502.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5503.      
5504.    Free Space after Zone:
5505.    ------------------------
5506.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5507.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5508.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5509. 
5510. Directory and Files Select:
5511. ---------------------------
5512. !ZoneTypeSelectCurrent!               
5513. ---------------------------
5514. ----------------------------------------------------------
5515. ")
5516. 
5517. AppendLogfile("!LogFileName!", ".")
5518. AppendLogfile("!LogFileName!", "!ZoneFooter!")
5519. AppendLogfile("!LogFileName!", ".")
5520. 
5521. # Zone Footer Set Statistics Window Text
5522. 
5523. SetStatisticsWindowText("----------------------------------------------------------
5524. Zones Processed: 
5525. ----------------------------------------------------------
5526. !ZoneListByLine!
5527. ----------------------------------------------------------
5528. Zone Processing Step:
5529. !ZoneStepByLine!    
5530. ----------------------------------------------------------
5531. Current Zone:
5532. !ZoneFooter!
5533. ----------------------------------------------------------
5534. Volume Statistics:
5535. !VolumeStatisticsDetail!
5536. ----------------------------------------------------------
5537. Zone Detailed Report:
5538. ----------------------------------------------------------
5539. !ZoneStatisticsDetail!
5540. ----------------------------------------------------------
5541. ")
5542. 
5543. 
5544. 
5545. /* pause() */
5546. /* pause() */
5547. 
5548. 
5549. 
5550. 	
5551. /* ---------------------------------------------------------- */
5552. # Zone ProgramHints Data.
5553. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramHintsData!")
5554. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramHintsData!")
5555. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpProgramHints!")
5556. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizeProgramHints!")
5557. 	SetVariable(ZoneTypeSelect,'
5558.                 # ProgramHints - Data files.
5559.                 not(
5560.                      # Os PageHiberDump start.
5561. (
5562.   FileName("DataStore.edb")
5563.   or FileName("DUMP*.*")
5564.   or FileName("Hiberfil.sys")
5565.   or FileName("MEMORY.DMP")
5566.   or FileName("Pagefile.sys")
5567. )
5568. # Os PageHiberDump end.
5569. 
5570.                 )
5571. ')
5572. 
5573. 
5574. 		# Zone Do Header
5575. 
5576. # Zone When Started
5577. 
5578. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
5579. # Display Set Zone
5580. 
5581. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
5582. SetVariable(FileStepDescription,	"")
5583. 
5584. SetVariable(ZoneStepByLine, 			"Zone started.
5585. ")
5586. 
5587. # BANNER SET
5588. 
5589. # DATE TIME RUN ELP
5590. 
5591. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
5592. /* Xinclude "..\BannerSet.MyDc"X */
5593. /* pause(1) */
5594. 
5595. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5596. 
5597. Title('!Heading!')
5598. /* pause(1) */
5599. 
5600. /* NOTE: Can't round or truncate to integer precision. */
5601. 
5602. AppendLogfile("!LogFileName!", "!Title!")
5603. 
5604. 
5605. 
5606. pause(1)
5607. 
5608. 
5609. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
5610. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
5611. 
5612. SetVariable(ZoneStepNoCurrent, 0)
5613. 
5614. 
5615. # Zone Do Current Clear
5616. 
5617. SetVariable(ZoneTypeSelectCurrent, 		"")
5618. 
5619. SetVariable(ZoneBeginCurrent, 			0)
5620. SetVariable(ZoneBeginPerCurrent, 		0)
5621. SetVariable(ZoneEndCurrent, 			0)
5622. SetVariable(ZoneEndPerCurrent, 			0)
5623. 
5624. SetVariable(ZoneSizeCurrent,			0)
5625. SetVariable(ZoneSizePerCurrent,			0)
5626. 
5627. SetVariable(ZoneGapRequestedCurrent,	0)
5628. SetVariable(ZoneGapRoundedCurrent, 		0)
5629. SetVariable(ZoneGapAdjustedCurrent, 	0)
5630. SetVariable(ZoneGapAvailableCurrent, 	0)
5631. SetVariable(ZoneGapCurrent,				0)
5632. SetVariable(ZoneGapUsedCurrent, 		0)
5633. 
5634. SetVariable(ZoneGapActualCurrent, 		0)
5635. SetVariable(ZoneGapActualPerCurrent, 	0)
5636. 
5637. SetVariable(ZoneSizeActual, 			0)
5638. SetVariable(ZoneSizeActualCurrent,		0)
5639. 
5640. SetVariable(ZoneEndActual, 				0)
5641. SetVariable(ZoneEndActualCurrent,		0)			
5642. SetVariable(ZoneSizeActualPerCurrent, 	0)
5643.       
5644. SetVariable(ZoneFilesFolders,			0)
5645. SetVariable(ZoneFilesFoldersPer,		0) 
5646. 
5647. SetVariable(ZoneFragments,				0)
5648. SetVariable(ZoneFragmentsPer,			0) 
5649. 		
5650. SetVariable(ZoneEndActualCurrent, 		0)
5651. SetVariable(ZoneEndActualPerCurrent, 	0)
5652. 
5653. # Gap Calculation Methodology:
5654. 	# Requested
5655. 	SetVariable(GapRequested, 			0) 
5656. 	SetVariable(GapRequestedStd, 		0) 
5657. 	SetVariable(GapRequestedMft, 		0) 
5658. 	SetVariable(GapRequestedOs, 		0) 
5659. 	SetVariable(GapRequestedOriginal, 	0) 
5660. 	
5661. 	# Gap Adjustments
5662. 	SetVariable(GapRounded, 			0)
5663. 	# SetVariable(GapAdjusted, 			0)
5664. 	SetVariable(GapAvailable, 			0)
5665. 	SetVariable(GapCurrent, 			0)
5666. 	SetVariable(GapActual, 				0)
5667. 	SetVariable(GapUsed, 				0)
5668. 	
5669. 	# Gap Adjustments
5670. 	SetVariable(GapRoundedLoc, 			0)
5671. 	# SetVariable(GapAdjustedLoc, 		0)
5672. 	SetVariable(GapAvailableLoc, 		0)
5673. 	SetVariable(GapCurrentLoc, 			0)
5674. 	SetVariable(GapActualLoc,			0)
5675. 	SetVariable(GapUsedLoc,				0)
5676. 	
5677. 	# Space usage
5678. 	SetVariable(ZoneFreePerRequested, 	0)
5679. 	SetVariable(ZoneFreePerUsed, 		0)
5680. 
5681. # Gap Size & Rounding
5682. 	SetVariable(ZoneGapSizePer, 		0)
5683. 	SetVariable(ZoneVolRoundUpPer, 		0)
5684. 	
5685. 	# Free Space
5686. 	SetVariable(ZoneFreeUsedPer, 		0)
5687. 	SetVariable(ZoneFreeRequestedPer, 	0)
5688. 
5689. 
5690. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
5691. 
5692. # Footer:
5693. SetVariable(ZoneFooter, "----------------------------------------------------------
5694. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
5695. 
5696. Statistics Report:
5697. ------------------
5698.    Size:  
5699.    ------------------------
5700.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
5701.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
5702.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
5703. 
5704.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
5705.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
5706. 
5707.    Location:
5708.    ------------------------
5709.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
5710.              Files End: !ZoneEndCurrent!
5711.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
5712.       
5713.    Gap Settings:
5714.    ------------------------
5715.          Gap Requested: !ZoneGapSizePer!%
5716.       Volume Rounding: !ZoneVolRoundUpPer!%
5717.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
5718.                  
5719.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
5720.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
5721.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
5722.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
5723.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
5724.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
5725.      
5726.    Free Space after Zone:
5727.    ------------------------
5728.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
5729.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
5730.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
5731. 
5732. Directory and Files Select:
5733. ---------------------------
5734. !ZoneTypeSelectCurrent!               
5735. ---------------------------
5736. ----------------------------------------------------------
5737. ")
5738. 
5739. # BANNER SET
5740. 
5741. # DATE TIME RUN ELP
5742. 
5743. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
5744. /* Xinclude "..\BannerSet.MyDc"X */
5745. /* pause(1) */
5746. 
5747. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5748. 
5749. Title('!Heading!')
5750. /* pause(1) */
5751. 
5752. /* NOTE: Can't round or truncate to integer precision. */
5753. 
5754. AppendLogfile("!LogFileName!", "!Title!")
5755. 
5756. 
5757. 
5758. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
5759. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
5760. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:15")
5761. 
5762. SetVariable(ZoneListByLine, "!ZoneListByLine!
5763. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
5764. 
5765. 
5766. /* Fixed Zone Position Handling */
5767. /* Literal number: */
5768. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
5769. /* Percentage of disk: */
5770. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
5771. /* Gap */
5772. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
5773. 
5774. /* ---------------------------------------------------------- */
5775. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
5776. # FILE STEP
5777. 
5778. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5779. 
5780. /* add message and move to a new line. */
5781. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5782. ")
5783. 
5784. /* display the line. (hopefully.) */
5785. # Zone Footer Set Statistics Window Text
5786. 
5787. SetStatisticsWindowText("----------------------------------------------------------
5788. Zones Processed: 
5789. ----------------------------------------------------------
5790. !ZoneListByLine!
5791. ----------------------------------------------------------
5792. Zone Processing Step:
5793. !ZoneStepByLine!    
5794. ----------------------------------------------------------
5795. Current Zone:
5796. !ZoneFooter!
5797. ----------------------------------------------------------
5798. Volume Statistics:
5799. !VolumeStatisticsDetail!
5800. ----------------------------------------------------------
5801. Zone Detailed Report:
5802. ----------------------------------------------------------
5803. !ZoneStatisticsDetail!
5804. ----------------------------------------------------------
5805. ")
5806. 
5807. 
5808. 
5809. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5810. 
5811. # BANNER SET
5812. 
5813. # DATE TIME RUN ELP
5814. 
5815. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
5816. /* Xinclude "..\BannerSet.MyDc"X */
5817. /* pause(1) */
5818. 
5819. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5820. 
5821. Title('!Heading!')
5822. /* pause(1) */
5823. 
5824. /* NOTE: Can't round or truncate to integer precision. */
5825. 
5826. pause(1)
5827. 
5828. # your stuff HERE (X)... pre file select code.
5829. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
5830. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
5831. 	# (X)
5832. 
5833. FileSelect
5834. 
5835. 	# your stuff can't really go here (errors.)
5836. 	# maybe for some reason I don't know of...
5837. 	
5838. 	# Actions next...
5839. 		# ProgramHints start.
5840. ImportListFromProgramHints("*.pf")
5841. # ProgramHints end.
5842. 
5843. 		and not(
5844. 			# Os PageHiberDump start.
5845. (
5846.   FileName("DataStore.edb")
5847.   or FileName("DUMP*.*")
5848.   or FileName("Hiberfil.sys")
5849.   or FileName("MEMORY.DMP")
5850.   or FileName("Pagefile.sys")
5851. )
5852. # Os PageHiberDump end.
5853. 
5854. 		)
5855. 		FileActions
5856. 		  		/* ---------------------------------------------------------- */
5857. 	# Gap
5858. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
5859. 		# FILE STEP
5860. 
5861. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
5862. 
5863. /* add message and move to a new line. */
5864. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
5865. ")
5866. 
5867. /* display the line. (hopefully.) */
5868. # Zone Footer Set Statistics Window Text
5869. 
5870. SetStatisticsWindowText("----------------------------------------------------------
5871. Zones Processed: 
5872. ----------------------------------------------------------
5873. !ZoneListByLine!
5874. ----------------------------------------------------------
5875. Zone Processing Step:
5876. !ZoneStepByLine!    
5877. ----------------------------------------------------------
5878. Current Zone:
5879. !ZoneFooter!
5880. ----------------------------------------------------------
5881. Volume Statistics:
5882. !VolumeStatisticsDetail!
5883. ----------------------------------------------------------
5884. Zone Detailed Report:
5885. ----------------------------------------------------------
5886. !ZoneStatisticsDetail!
5887. ----------------------------------------------------------
5888. ")
5889. 
5890. 
5891. 
5892. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
5893. 
5894. # BANNER SET
5895. 
5896. # DATE TIME RUN ELP
5897. 
5898. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
5899. /* Xinclude "..\BannerSet.MyDc"X */
5900. /* pause(1) */
5901. 
5902. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
5903. 
5904. Title('!Heading!')
5905. /* pause(1) */
5906. 
5907. /* NOTE: Can't round or truncate to integer precision. */
5908. 
5909. pause(1)
5910. 	
5911. 	# ACTUAL GAP
5912. 		/* AddGap Variant. */
5913. 	  	# Zone Do Gap
5914. # Gap Calculation Methods:
5915. 
5916. /* 1) Anything you need to add first. */
5917. /* empty */
5918. 
5919. /* ---------------------------------------------------------- */
5920. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
5921. 	# GapRequestedStd.
5922. 
5923. 		/* ---------------------------------------------------------- */
5924. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
5925. 
5926. 		# Gap Calculation Methods:
5927. 
5928. /* AddGap Variants */
5929. 
5930. 	/* Standard */
5931. 		# Gap Calculation Methods:
5932. 	/* AddGap Variants */
5933. 	/* Standard */
5934. 
5935. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
5936. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
5937. 
5938. 	SetVariable(GapRequested, GapRequestedStd)
5939. 	
5940. 
5941. 	/* MFT Low High Method */
5942. 		# Gap Calculation Methods:
5943. 	/* AddGap Variants */
5944. 	/* MFT Low High Method */
5945. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
5946. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
5947. 	SetVariable(GapRequested, GapRequestedMft)
5948. 	
5949. 
5950. 	/* OS Volume Type Method */
5951. 		# Gap Calculation Methods:
5952. 	/* AddGap Variants */
5953. 	/* OS Volume Type Method */
5954. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
5955. 	SetVariable(GapRequested, GapRequestedOs)
5956. 
5957. 
5958. 
5959. /* MakeGap Variants */
5960. 
5961. 	/* Original Os 1-3 + MFT 2 */
5962. 		# Gap Calculation Methods:
5963. 	/* MakeGap Variants */
5964. 	/* Original Os 1-3 + MFT 2 */
5965. 	/* plus MFT gap placed inline at the dividing zone. */
5966. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
5967. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
5968. 	SetVariable(GapRequested, GapRequestedOrig)
5969. 	
5970. 	
5971. /* Note: You could comment out the ones not in use */
5972. /* However having the data in the log is useful. */
5973. /* Therefore the following line is otherwise needed. */
5974. 
5975. /* Standard used */
5976. 
5977. SetVariable(GapRequested, GapRequestedStd)
5978. 
5979. # Gap Calculation Methods:
5980. 
5981. /* AddGap Variants */
5982. 	/* Standard */
5983. 	/* MFT Low High Method */
5984. 	/* OS Volume Type Method */
5985. 
5986. /* MakeGap Variants */
5987. 	/* Original Os 1-3 + MFT 2 */
5988. 
5989. /* Note: You could comment out the ones not in use */
5990. /* However having the data in the log is useful. */
5991. /* Therefore the following line is otherwise needed. */
5992. 
5993. /* Standard is used currently */
5994. 
5995. 
5996. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
5997. 
5998. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
5999. 
6000. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
6001. 
6002. /* ---------------------------------------------------------- */
6003. /* 3) SMALL ZONE ADJUSTMENT. */
6004. /* Gab cant be larger than half the Zone Size. */
6005. 
6006. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
6007. 	
6008. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
6009. 
6010. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
6011. 
6012. /* ---------------------------------------------------------- */
6013. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
6014. # Gap Adjustments.
6015. 
6016. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
6017. 	
6018. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
6019. 
6020. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
6021. 
6022. /* ---------------------------------------------------------- */
6023. # BYPASS THIS.
6024. 	/* This is definitely wrong. */
6025. 	/* The question is can we steal gap from the next zone */
6026. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
6027. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
6028. 		# Zone Overflow.
6029. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
6030. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
6031. 
6032. /* ---------------------------------------------------------- */
6033. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
6034. # Remaining free space available.
6035. 
6036. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
6037. 	
6038. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
6039. 
6040. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
6041. 
6042. /* ---------------------------------------------------------- */
6043. # CURRENT gap to use.
6044. 
6045. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
6046. 
6047. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
6048. 
6049. /* ---------------------------------------------------------- */
6050. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
6051. # Debugging.
6052. 
6053. 	SetVariable(GapUsed, GapCurrent) // for debugging
6054. 
6055. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
6056. 
6057. 		# Your code HERE
6058. 
6059. /* ---------------------------------------------------------- */
6060. /* 7) YOUR CODE. */
6061. # YOUR CODE HERE:
6062. 	# INPUT: GapCurrent or GapCurrentLoc
6063. 	# OUTPUT: GapUsed...
6064. 
6065. /* ---------------------------------------------------------- */
6066. # Gap Size.
6067. # Actual Size of Gap.
6068. 
6069. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
6070. 
6071. /* ---------------------------------------------------------- */
6072. /* xxxxxxxxxxxxxxxxxxxxxx */
6073. # ADD THE GAP
6074. 	/* Xinclude "..\GapCommandDo.MyDc"X */
6075. /* xxxxxxxxxxxxxxxxxxxxxx */
6076. 
6077. 	
6078. 	# Zone Statistics	
6079. 	# Zone / Volume Statistics and Display
6080. 		
6081. 	# Accumulate Totals
6082.   	# Volume totals
6083. 
6084. /* Current total space used (by Zones and Gaps) */
6085. 
6086. SetVariable(VolumeZoneUsed, GapUsed)
6087. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
6088. /* Percentage */
6089. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
6090. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
6091. 
6092. /* Current total of free space requested */
6093. 
6094. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
6095. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6096. /* Percent. */
6097. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
6098. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
6099. 
6100. /* Current total of free space used */
6101. 
6102. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
6103. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
6104. /* Percent */
6105. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
6106. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
6107. 
6108. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
6109. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
6110. /* Xinclude "..\DebugDisplayPause.MyDc"X */
6111. 
6112. 
6113. 	# Current Values
6114. 	# Cluster, Sector, Block adjust for display.
6115. 	# Bytes per cluster is volume specific.
6116. 
6117. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
6118. 
6119. # Current Zone values.
6120. 	# Begin, end and size.
6121. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
6122. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
6123. 
6124. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
6125. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
6126. 
6127. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
6128. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
6129. 
6130. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
6131. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
6132. 
6133. 	SetVariable(ZoneFragments,				"!ZONE210N!")
6134. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
6135. 		
6136. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
6137. /* identical code to here: (separation not needed. TEST.) */	
6138. 
6139. # Current Gap, Actual and Free Values
6140. 	# Gap
6141. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
6142. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
6143. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
6144. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
6145. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
6146. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
6147. 	
6148. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
6149. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
6150. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
6151. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
6152. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
6153. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
6154. 	
6155. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
6156. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
6157. 	
6158. 	# Actual Size and End
6159. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
6160. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
6161. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
6162. 	
6163. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
6164. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
6165. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
6166. 
6167. # Gap Size & Rounding
6168. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
6169. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
6170. 	
6171. 	# Free Space
6172. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
6173. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
6174. 
6175. 	# Footer:
6176. SetVariable(ZoneFooter, "----------------------------------------------------------
6177. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
6178. 
6179. Statistics Report:
6180. ------------------
6181.    Size:  
6182.    ------------------------
6183.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6184.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6185.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6186. 
6187.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6188.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6189. 
6190.    Location:
6191.    ------------------------
6192.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6193.              Files End: !ZoneEndCurrent!
6194.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6195.       
6196.    Gap Settings:
6197.    ------------------------
6198.          Gap Requested: !ZoneGapSizePer!%
6199.       Volume Rounding: !ZoneVolRoundUpPer!%
6200.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6201.                  
6202.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6203.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6204.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6205.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6206.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6207.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6208.      
6209.    Free Space after Zone:
6210.    ------------------------
6211.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6212.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6213.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6214. 
6215. Directory and Files Select:
6216. ---------------------------
6217. !ZoneTypeSelectCurrent!               
6218. ---------------------------
6219. ----------------------------------------------------------
6220. ")
6221. 	# Zone Footer Set Statistics Window Text
6222. 
6223. SetStatisticsWindowText("----------------------------------------------------------
6224. Zones Processed: 
6225. ----------------------------------------------------------
6226. !ZoneListByLine!
6227. ----------------------------------------------------------
6228. Zone Processing Step:
6229. !ZoneStepByLine!    
6230. ----------------------------------------------------------
6231. Current Zone:
6232. !ZoneFooter!
6233. ----------------------------------------------------------
6234. Volume Statistics:
6235. !VolumeStatisticsDetail!
6236. ----------------------------------------------------------
6237. Zone Detailed Report:
6238. ----------------------------------------------------------
6239. !ZoneStatisticsDetail!
6240. ----------------------------------------------------------
6241. ")
6242. 
6243. 
6244. 	
6245.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
6246. 
6247. 	# Add Zone to list of zones for display.
6248. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
6249. 
6250. 	# Footer:
6251. SetVariable(ZoneFooter, "----------------------------------------------------------
6252. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
6253. 
6254. Statistics Report:
6255. ------------------
6256.    Size:  
6257.    ------------------------
6258.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6259.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6260.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6261. 
6262.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6263.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6264. 
6265.    Location:
6266.    ------------------------
6267.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6268.              Files End: !ZoneEndCurrent!
6269.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6270.       
6271.    Gap Settings:
6272.    ------------------------
6273.          Gap Requested: !ZoneGapSizePer!%
6274.       Volume Rounding: !ZoneVolRoundUpPer!%
6275.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6276.                  
6277.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6278.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6279.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6280.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6281.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6282.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6283.      
6284.    Free Space after Zone:
6285.    ------------------------
6286.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6287.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6288.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6289. 
6290. Directory and Files Select:
6291. ---------------------------
6292. !ZoneTypeSelectCurrent!               
6293. ---------------------------
6294. ----------------------------------------------------------
6295. ")
6296. 
6297. 	# Add Zone Details to Report.	
6298. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
6299. !ZoneFooter!")
6300. 
6301. 
6302. 	
6303. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
6304. 			# FILE STEP
6305. 
6306. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6307. 
6308. /* add message and move to a new line. */
6309. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6310. ")
6311. 
6312. /* display the line. (hopefully.) */
6313. # Zone Footer Set Statistics Window Text
6314. 
6315. SetStatisticsWindowText("----------------------------------------------------------
6316. Zones Processed: 
6317. ----------------------------------------------------------
6318. !ZoneListByLine!
6319. ----------------------------------------------------------
6320. Zone Processing Step:
6321. !ZoneStepByLine!    
6322. ----------------------------------------------------------
6323. Current Zone:
6324. !ZoneFooter!
6325. ----------------------------------------------------------
6326. Volume Statistics:
6327. !VolumeStatisticsDetail!
6328. ----------------------------------------------------------
6329. Zone Detailed Report:
6330. ----------------------------------------------------------
6331. !ZoneStatisticsDetail!
6332. ----------------------------------------------------------
6333. ")
6334. 
6335. 
6336. 
6337. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6338. 
6339. # BANNER SET
6340. 
6341. # DATE TIME RUN ELP
6342. 
6343. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
6344. /* Xinclude "..\BannerSet.MyDc"X */
6345. /* pause(1) */
6346. 
6347. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6348. 
6349. Title('!Heading!')
6350. /* pause(1) */
6351. 
6352. /* NOTE: Can't round or truncate to integer precision. */
6353. 
6354. pause(1)
6355. 
6356. 			SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
6357. 	
6358. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
6359. 			# FILE STEP
6360. 
6361. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6362. 
6363. /* add message and move to a new line. */
6364. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6365. ")
6366. 
6367. /* display the line. (hopefully.) */
6368. # Zone Footer Set Statistics Window Text
6369. 
6370. SetStatisticsWindowText("----------------------------------------------------------
6371. Zones Processed: 
6372. ----------------------------------------------------------
6373. !ZoneListByLine!
6374. ----------------------------------------------------------
6375. Zone Processing Step:
6376. !ZoneStepByLine!    
6377. ----------------------------------------------------------
6378. Current Zone:
6379. !ZoneFooter!
6380. ----------------------------------------------------------
6381. Volume Statistics:
6382. !VolumeStatisticsDetail!
6383. ----------------------------------------------------------
6384. Zone Detailed Report:
6385. ----------------------------------------------------------
6386. !ZoneStatisticsDetail!
6387. ----------------------------------------------------------
6388. ")
6389. 
6390. 
6391. 
6392. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6393. 
6394. # BANNER SET
6395. 
6396. # DATE TIME RUN ELP
6397. 
6398. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
6399. /* Xinclude "..\BannerSet.MyDc"X */
6400. /* pause(1) */
6401. 
6402. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6403. 
6404. Title('!Heading!')
6405. /* pause(1) */
6406. 
6407. /* NOTE: Can't round or truncate to integer precision. */
6408. 
6409. pause(1)
6410. 
6411. 		# Zone Do Footer
6412. 
6413. /* ---------------------------------------------------------- */
6414. # File Select
6415. 	# Select Statments
6416. # File Actions 
6417. 	# Standard or OS File Actions.
6418. 	# Resume...
6419. 	
6420. 	# your stuff HERE (X)... post zone (file) file actions code.
6421. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
6422. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
6423. 		# (X)
6424. 		
6425. 		/* ??? Set window? */
6426. 	
6427. 	# ADD THE GAP
6428. 		
6429. # Vacate (good for diagnostics)
6430. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
6431. 
6432. # DoNotVacate - DO NOT Vacate (recommended)
6433. 
6434. # Vacate
6435. /* AddGap(GapUsedLoc) */
6436. 
6437. # DO Not Vacate
6438. AddGap(GapUsedLoc, DoNotVacate) 
6439. 	
6440. 	
6441. /* ---------------------------------------------------------- */
6442. # (failed) TEST for boolean logic.
6443. 
6444. /* It should work in the gap calculations for turning options */
6445. /* on and off but it will NOT work here. */
6446. 
6447. /* Boolean setting X or FlagX. */
6448. /* Where X will be on or off: */
6449. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
6450. /*      For ON:  (X  *  FlagAny) */
6451. 
6452. /* 1) Failed, zero gap overrode the previous one. */
6453. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
6454. /* AddGap(GapUsedTemp) */ 
6455. 
6456. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
6457. /* AddGap(GapUsedTemp, DoNotVacate) */ 
6458. 
6459. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
6460. 
6461. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
6462. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
6463. /* AddGap(GapUsedTemp) */ 
6464. 
6465. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
6466. /* AddGap(GapUsedTemp, DoNotVacate) */ 
6467. 
6468. /* ---------------------------------------------------------- */
6469. 
6470. # Vacate
6471. /* AddGap(GapUsed) */
6472. 
6473. # DO NOT Vacate (recommended)
6474. /* AddGap(GapUsed, DoNotVacate) */ 
6475. 	
6476. 
6477. 		
6478. # 
6479. FileEnd
6480. /* ---------------------------------------------------------- */
6481. 
6482. # your stuff HERE (X)... post zone (file) code.
6483. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
6484. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
6485. 	# (X)
6486. 
6487. SetVariable(FileStepDescription,"Zone finished, reporting.")
6488. # FILE STEP
6489. 
6490. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
6491. 
6492. /* add message and move to a new line. */
6493. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
6494. ")
6495. 
6496. /* display the line. (hopefully.) */
6497. # Zone Footer Set Statistics Window Text
6498. 
6499. SetStatisticsWindowText("----------------------------------------------------------
6500. Zones Processed: 
6501. ----------------------------------------------------------
6502. !ZoneListByLine!
6503. ----------------------------------------------------------
6504. Zone Processing Step:
6505. !ZoneStepByLine!    
6506. ----------------------------------------------------------
6507. Current Zone:
6508. !ZoneFooter!
6509. ----------------------------------------------------------
6510. Volume Statistics:
6511. !VolumeStatisticsDetail!
6512. ----------------------------------------------------------
6513. Zone Detailed Report:
6514. ----------------------------------------------------------
6515. !ZoneStatisticsDetail!
6516. ----------------------------------------------------------
6517. ")
6518. 
6519. 
6520. 
6521. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
6522. 
6523. # BANNER SET
6524. 
6525. # DATE TIME RUN ELP
6526. 
6527. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
6528. /* Xinclude "..\BannerSet.MyDc"X */
6529. /* pause(1) */
6530. 
6531. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6532. 
6533. Title('!Heading!')
6534. /* pause(1) */
6535. 
6536. /* NOTE: Can't round or truncate to integer precision. */
6537. 
6538. pause(1)
6539. 
6540. # Zone When Finished
6541. 
6542. # BANNER SET
6543. 
6544. # DATE TIME RUN ELP
6545. 
6546. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
6547. /* Xinclude "..\BannerSet.MyDc"X */
6548. /* pause(1) */
6549. 
6550. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6551. 
6552. Title('!Heading!')
6553. /* pause(1) */
6554. 
6555. /* NOTE: Can't round or truncate to integer precision. */
6556. 
6557. AppendLogfile("!LogFileName!", "!Title!")
6558. 
6559. 
6560. 
6561. # Zone Statistics	
6562. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
6563. 
6564. # Footer:
6565. SetVariable(ZoneFooter, "----------------------------------------------------------
6566. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
6567. 
6568. Statistics Report:
6569. ------------------
6570.    Size:  
6571.    ------------------------
6572.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6573.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6574.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6575. 
6576.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
6577.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
6578. 
6579.    Location:
6580.    ------------------------
6581.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
6582.              Files End: !ZoneEndCurrent!
6583.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
6584.       
6585.    Gap Settings:
6586.    ------------------------
6587.          Gap Requested: !ZoneGapSizePer!%
6588.       Volume Rounding: !ZoneVolRoundUpPer!%
6589.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
6590.                  
6591.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
6592.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
6593.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
6594.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
6595.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
6596.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
6597.      
6598.    Free Space after Zone:
6599.    ------------------------
6600.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
6601.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
6602.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
6603. 
6604. Directory and Files Select:
6605. ---------------------------
6606. !ZoneTypeSelectCurrent!               
6607. ---------------------------
6608. ----------------------------------------------------------
6609. ")
6610. 
6611. AppendLogfile("!LogFileName!", ".")
6612. AppendLogfile("!LogFileName!", "!ZoneFooter!")
6613. AppendLogfile("!LogFileName!", ".")
6614. 
6615. # Zone Footer Set Statistics Window Text
6616. 
6617. SetStatisticsWindowText("----------------------------------------------------------
6618. Zones Processed: 
6619. ----------------------------------------------------------
6620. !ZoneListByLine!
6621. ----------------------------------------------------------
6622. Zone Processing Step:
6623. !ZoneStepByLine!    
6624. ----------------------------------------------------------
6625. Current Zone:
6626. !ZoneFooter!
6627. ----------------------------------------------------------
6628. Volume Statistics:
6629. !VolumeStatisticsDetail!
6630. ----------------------------------------------------------
6631. Zone Detailed Report:
6632. ----------------------------------------------------------
6633. !ZoneStatisticsDetail!
6634. ----------------------------------------------------------
6635. ")
6636. 
6637. 
6638. 
6639. /* pause() */
6640. /* pause() */
6641. 
6642. 
6643. 
6644. 	
6645. /* ---------------------------------------------------------- */
6646. 
6647. 
6648. /* ---------------------------------------------------------- */
6649. # Zone Programs Fixed size but not windows..
6650. /* ---------------------------------------------------------- */
6651. # Zone Programs Fixed size but not windows..
6652. 	SetVariable(ZoneLabel, 			"!ZoneLabelPrograms!")
6653. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPrograms!")
6654. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
6655. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
6656. 	SetVariable(ZoneTypeSelect,'# Programs start.
6657. # NotBlobsArchivesBu start.
6658. (not (
6659. # Blobs start.
6660. (
6661. # BlobsAndExceptions start.
6662. ( not(
6663.   FileName("*.bat")
6664.   or FileName("*.css")
6665.   or FileName("*.dll")
6666.   or FileName("*.exe")
6667.   or FileName("*.htm*")
6668.   or FileName("*.jar")
6669.   or FileName("*.js")
6670.   or FileName("*.script")
6671.   or FileName("*.wsf")
6672.   or (
6673. # Databases start.
6674. (
6675.   FileName("*.crypt*")
6676.   or FileName("*.db*")
6677.   or FileName("*.rdb*")
6678.   or FileName("*.dc*")
6679.   or FileName("*.dict*")
6680.   or FileName("*.?db*")
6681.   or FileName("*.?rdb*")
6682.   or FileName("*.md*")
6683.   or FileName("*.myd")
6684.   or FileName("*.ndf")
6685.   or FileName("*.ns?")
6686.   or FileName("*.pab")
6687.   or FileName("*.pst")
6688.   or FileName("*.sd?*")
6689.   or FileName("*.sq**")
6690.   or FileName("*.tmd")
6691.   or FileName("*.tps")
6692.   or FileName("*.tr*")
6693. )
6694. # Databases end.
6695. 
6696.     # BlobsAndExceptions
6697.     or 
6698. # Data start.
6699. (
6700.   DirectoryName("Data*")
6701.   or DirectoryName("Device*")
6702.   or DirectoryName("Export*")
6703.   or DirectoryName("Import*")
6704.   or DirectoryName("Log*")
6705.   or DirectoryName("*Log")
6706.   or DirectoryName("Maintenance*")
6707.   or DirectoryName("Rec*")
6708.   or DirectoryName("Sales*")
6709.   or DirectoryName("Search*")
6710.   or DirectoryName("User*")
6711. )
6712. # Data end.
6713. 
6714.     # BlobsAndExceptions
6715.   )
6716. ) )
6717. # BlobsAndExceptions end.
6718. 
6719. # Blobs
6720. ) and (
6721.   Size(BlobFileSize,0)
6722.   or (
6723.     FileName("*.arj")
6724.     or FileName("*.bup")
6725.     or FileName("*.bz2")
6726.     or FileName("*.chm")
6727.     or FileName("*.dvr-ms")
6728.     or FileName("*.gz")
6729.     or FileName("*.ifo")
6730.     or FileName("*.lzh")
6731.     or FileName("*.pdf")
6732.     or FileName("*.rpm")
6733.     or FileName("*.wmv")
6734.     or FileName("*.vob")
6735.     or FileName("*.z")
6736.   ) 
6737. )
6738. # Blobs end.
6739. 
6740. # NotBlobsArchivesBu
6741. or 
6742. # Archives start.
6743. (
6744.   DirectoryName("*Archive*")
6745.   or DirectoryName("*History*")
6746.   or DirectoryName("*Old")
6747.   or DirectoryName("* Old *")
6748.   or DirectoryName("Old *")
6749. 
6750.   or FileName("*.7z")
6751.   or FileName("*.cab")
6752.   or FileName("*.iso")
6753.   or FileName("*.msi")
6754.   or FileName("*.old")
6755.   or FileName("*.rar")
6756.   or FileName("*.tar")
6757.   or FileName("*.zip")
6758.   or
6759. # WinSysLow start.
6760. (
6761.   DirectoryName("$*")
6762.   or DirectoryName("0*")
6763.   or DirectoryName("1*")
6764.   or DirectoryName("2*")
6765.   or DirectoryName("3*")
6766.   or DirectoryName("4*")
6767.   or DirectoryName("5*")
6768.   or DirectoryName("6*")
6769.   or DirectoryName("7*")
6770.   or DirectoryName("8*")
6771.   or DirectoryName("9*")
6772. 
6773.   or DirectoryName("dllcache")
6774.   or DirectoryName("Downloaded Installations")
6775.   or DirectoryName("Ehome")
6776.   or DirectoryName("Fonts")
6777.   or DirectoryName("Help")
6778.   or DirectoryName("I386")
6779.   or DirectoryName("ie?updates")
6780.   or DirectoryName("Installer")
6781.   or DirectoryName("Installshield Installation Information")
6782.   or DirectoryName("IME")
6783.   or DirectoryName("*RECYCLE*")
6784.   or DirectoryName("ServicePackFiles")
6785.   or DirectoryName("SoftwareDistribution")
6786.   or DirectoryName("Speech")
6787.   or DirectoryName("Symbols")
6788.   or DirectoryName("System Volume Information")
6789.   or DirectoryName("windows.old")
6790. )
6791. # WinSysLow end.
6792. 
6793.   # Archives
6794. )
6795. # Archives end.
6796. 
6797. # NotBlobsArchivesBu
6798. or
6799. # Backups start.
6800. (
6801.   DirectoryName("*Backup*")
6802.   or DirectoryName("*Bu")
6803.   or DirectoryName("* Bu *")
6804.   or DirectoryName("Bu *")
6805. 
6806.   or FileName("*.bak")
6807.   or FileName("* - Copy*")
6808. )
6809. # Backups end.
6810. 
6811. # NotBlobsArchivesBu
6812. ) )
6813. # NotBlobsArchivesBu end.
6814. 
6815. # Programs
6816. and (
6817. # SystemDir start.
6818. (
6819.   DirectoryName("Boot*")
6820.   or DirectoryName("Device*")
6821.   or DirectoryName("DevSupport*")
6822.   or DirectoryName("Program*")
6823.   or DirectoryName("Security*")
6824.   or DirectoryName("SendTo*")
6825.   or DirectoryName("Sw*")
6826.   or DirectoryName("System*")
6827.   or DirectoryName("Toolbars")
6828.   or DirectoryName("Windows*")
6829. )
6830. # SystemDir end.
6831. 
6832. # Programs
6833. )
6834. # Programs end.
6835. 
6836.                 and not(
6837.                      # Os Data Dynamic start.
6838. (
6839. # Os Data Dynamic start.
6840. (
6841.   FileName("*.dat*")
6842.   or FileName("*.db*")
6843.   or FileName("*.edb*")
6844.   or FileName("*.log*")
6845.   or FileName("DataStore.edb")
6846. )
6847. # Os Data Dynamic end.
6848. 
6849.   or 
6850. # Os PageHiberDump start.
6851. (
6852.   FileName("DataStore.edb")
6853.   or FileName("DUMP*.*")
6854.   or FileName("Hiberfil.sys")
6855.   or FileName("MEMORY.DMP")
6856.   or FileName("Pagefile.sys")
6857. )
6858. # Os PageHiberDump end.
6859. 
6860. # Os Data Dynamic
6861. )
6862. # Os Data Dynamic end.
6863. 
6864.                      or 
6865.                      DirectoryName("Windows*")
6866.                 )
6867. ')
6868. 
6869. 		# Zone Do Header
6870. 
6871. # Zone When Started
6872. 
6873. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
6874. # Display Set Zone
6875. 
6876. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
6877. SetVariable(FileStepDescription,	"")
6878. 
6879. SetVariable(ZoneStepByLine, 			"Zone started.
6880. ")
6881. 
6882. # BANNER SET
6883. 
6884. # DATE TIME RUN ELP
6885. 
6886. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
6887. /* Xinclude "..\BannerSet.MyDc"X */
6888. /* pause(1) */
6889. 
6890. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
6891. 
6892. Title('!Heading!')
6893. /* pause(1) */
6894. 
6895. /* NOTE: Can't round or truncate to integer precision. */
6896. 
6897. AppendLogfile("!LogFileName!", "!Title!")
6898. 
6899. 
6900. 
6901. pause(1)
6902. 
6903. 
6904. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
6905. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
6906. 
6907. SetVariable(ZoneStepNoCurrent, 0)
6908. 
6909. 
6910. # Zone Do Current Clear
6911. 
6912. SetVariable(ZoneTypeSelectCurrent, 		"")
6913. 
6914. SetVariable(ZoneBeginCurrent, 			0)
6915. SetVariable(ZoneBeginPerCurrent, 		0)
6916. SetVariable(ZoneEndCurrent, 			0)
6917. SetVariable(ZoneEndPerCurrent, 			0)
6918. 
6919. SetVariable(ZoneSizeCurrent,			0)
6920. SetVariable(ZoneSizePerCurrent,			0)
6921. 
6922. SetVariable(ZoneGapRequestedCurrent,	0)
6923. SetVariable(ZoneGapRoundedCurrent, 		0)
6924. SetVariable(ZoneGapAdjustedCurrent, 	0)
6925. SetVariable(ZoneGapAvailableCurrent, 	0)
6926. SetVariable(ZoneGapCurrent,				0)
6927. SetVariable(ZoneGapUsedCurrent, 		0)
6928. 
6929. SetVariable(ZoneGapActualCurrent, 		0)
6930. SetVariable(ZoneGapActualPerCurrent, 	0)
6931. 
6932. SetVariable(ZoneSizeActual, 			0)
6933. SetVariable(ZoneSizeActualCurrent,		0)
6934. 
6935. SetVariable(ZoneEndActual, 				0)
6936. SetVariable(ZoneEndActualCurrent,		0)			
6937. SetVariable(ZoneSizeActualPerCurrent, 	0)
6938.       
6939. SetVariable(ZoneFilesFolders,			0)
6940. SetVariable(ZoneFilesFoldersPer,		0) 
6941. 
6942. SetVariable(ZoneFragments,				0)
6943. SetVariable(ZoneFragmentsPer,			0) 
6944. 		
6945. SetVariable(ZoneEndActualCurrent, 		0)
6946. SetVariable(ZoneEndActualPerCurrent, 	0)
6947. 
6948. # Gap Calculation Methodology:
6949. 	# Requested
6950. 	SetVariable(GapRequested, 			0) 
6951. 	SetVariable(GapRequestedStd, 		0) 
6952. 	SetVariable(GapRequestedMft, 		0) 
6953. 	SetVariable(GapRequestedOs, 		0) 
6954. 	SetVariable(GapRequestedOriginal, 	0) 
6955. 	
6956. 	# Gap Adjustments
6957. 	SetVariable(GapRounded, 			0)
6958. 	# SetVariable(GapAdjusted, 			0)
6959. 	SetVariable(GapAvailable, 			0)
6960. 	SetVariable(GapCurrent, 			0)
6961. 	SetVariable(GapActual, 				0)
6962. 	SetVariable(GapUsed, 				0)
6963. 	
6964. 	# Gap Adjustments
6965. 	SetVariable(GapRoundedLoc, 			0)
6966. 	# SetVariable(GapAdjustedLoc, 		0)
6967. 	SetVariable(GapAvailableLoc, 		0)
6968. 	SetVariable(GapCurrentLoc, 			0)
6969. 	SetVariable(GapActualLoc,			0)
6970. 	SetVariable(GapUsedLoc,				0)
6971. 	
6972. 	# Space usage
6973. 	SetVariable(ZoneFreePerRequested, 	0)
6974. 	SetVariable(ZoneFreePerUsed, 		0)
6975. 
6976. # Gap Size & Rounding
6977. 	SetVariable(ZoneGapSizePer, 		0)
6978. 	SetVariable(ZoneVolRoundUpPer, 		0)
6979. 	
6980. 	# Free Space
6981. 	SetVariable(ZoneFreeUsedPer, 		0)
6982. 	SetVariable(ZoneFreeRequestedPer, 	0)
6983. 
6984. 
6985. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
6986. 
6987. # Footer:
6988. SetVariable(ZoneFooter, "----------------------------------------------------------
6989. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
6990. 
6991. Statistics Report:
6992. ------------------
6993.    Size:  
6994.    ------------------------
6995.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
6996.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
6997.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
6998. 
6999.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7000.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7001. 
7002.    Location:
7003.    ------------------------
7004.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7005.              Files End: !ZoneEndCurrent!
7006.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7007.       
7008.    Gap Settings:
7009.    ------------------------
7010.          Gap Requested: !ZoneGapSizePer!%
7011.       Volume Rounding: !ZoneVolRoundUpPer!%
7012.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7013.                  
7014.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7015.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7016.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7017.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7018.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7019.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7020.      
7021.    Free Space after Zone:
7022.    ------------------------
7023.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7024.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7025.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7026. 
7027. Directory and Files Select:
7028. ---------------------------
7029. !ZoneTypeSelectCurrent!               
7030. ---------------------------
7031. ----------------------------------------------------------
7032. ")
7033. 
7034. # BANNER SET
7035. 
7036. # DATE TIME RUN ELP
7037. 
7038. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
7039. /* Xinclude "..\BannerSet.MyDc"X */
7040. /* pause(1) */
7041. 
7042. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7043. 
7044. Title('!Heading!')
7045. /* pause(1) */
7046. 
7047. /* NOTE: Can't round or truncate to integer precision. */
7048. 
7049. AppendLogfile("!LogFileName!", "!Title!")
7050. 
7051. 
7052. 
7053. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
7054. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
7055. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:15")
7056. 
7057. SetVariable(ZoneListByLine, "!ZoneListByLine!
7058. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
7059. 
7060. 
7061. /* Fixed Zone Position Handling */
7062. /* Literal number: */
7063. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
7064. /* Percentage of disk: */
7065. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
7066. /* Gap */
7067. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
7068. 
7069. /* ---------------------------------------------------------- */
7070. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
7071. # FILE STEP
7072. 
7073. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7074. 
7075. /* add message and move to a new line. */
7076. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7077. ")
7078. 
7079. /* display the line. (hopefully.) */
7080. # Zone Footer Set Statistics Window Text
7081. 
7082. SetStatisticsWindowText("----------------------------------------------------------
7083. Zones Processed: 
7084. ----------------------------------------------------------
7085. !ZoneListByLine!
7086. ----------------------------------------------------------
7087. Zone Processing Step:
7088. !ZoneStepByLine!    
7089. ----------------------------------------------------------
7090. Current Zone:
7091. !ZoneFooter!
7092. ----------------------------------------------------------
7093. Volume Statistics:
7094. !VolumeStatisticsDetail!
7095. ----------------------------------------------------------
7096. Zone Detailed Report:
7097. ----------------------------------------------------------
7098. !ZoneStatisticsDetail!
7099. ----------------------------------------------------------
7100. ")
7101. 
7102. 
7103. 
7104. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7105. 
7106. # BANNER SET
7107. 
7108. # DATE TIME RUN ELP
7109. 
7110. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
7111. /* Xinclude "..\BannerSet.MyDc"X */
7112. /* pause(1) */
7113. 
7114. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7115. 
7116. Title('!Heading!')
7117. /* pause(1) */
7118. 
7119. /* NOTE: Can't round or truncate to integer precision. */
7120. 
7121. pause(1)
7122. 
7123. # your stuff HERE (X)... pre file select code.
7124. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
7125. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
7126. 	# (X)
7127. 
7128. FileSelect
7129. 
7130. 	# your stuff can't really go here (errors.)
7131. 	# maybe for some reason I don't know of...
7132. 	
7133. 	# Actions next...
7134. 		# Programs start.
7135. # NotBlobsArchivesBu start.
7136. (not (
7137. # Blobs start.
7138. (
7139. # BlobsAndExceptions start.
7140. ( not(
7141.   FileName("*.bat")
7142.   or FileName("*.css")
7143.   or FileName("*.dll")
7144.   or FileName("*.exe")
7145.   or FileName("*.htm*")
7146.   or FileName("*.jar")
7147.   or FileName("*.js")
7148.   or FileName("*.script")
7149.   or FileName("*.wsf")
7150.   or (
7151. # Databases start.
7152. (
7153.   FileName("*.crypt*")
7154.   or FileName("*.db*")
7155.   or FileName("*.rdb*")
7156.   or FileName("*.dc*")
7157.   or FileName("*.dict*")
7158.   or FileName("*.?db*")
7159.   or FileName("*.?rdb*")
7160.   or FileName("*.md*")
7161.   or FileName("*.myd")
7162.   or FileName("*.ndf")
7163.   or FileName("*.ns?")
7164.   or FileName("*.pab")
7165.   or FileName("*.pst")
7166.   or FileName("*.sd?*")
7167.   or FileName("*.sq**")
7168.   or FileName("*.tmd")
7169.   or FileName("*.tps")
7170.   or FileName("*.tr*")
7171. )
7172. # Databases end.
7173. 
7174.     # BlobsAndExceptions
7175.     or 
7176. # Data start.
7177. (
7178.   DirectoryName("Data*")
7179.   or DirectoryName("Device*")
7180.   or DirectoryName("Export*")
7181.   or DirectoryName("Import*")
7182.   or DirectoryName("Log*")
7183.   or DirectoryName("*Log")
7184.   or DirectoryName("Maintenance*")
7185.   or DirectoryName("Rec*")
7186.   or DirectoryName("Sales*")
7187.   or DirectoryName("Search*")
7188.   or DirectoryName("User*")
7189. )
7190. # Data end.
7191. 
7192.     # BlobsAndExceptions
7193.   )
7194. ) )
7195. # BlobsAndExceptions end.
7196. 
7197. # Blobs
7198. ) and (
7199.   Size(BlobFileSize,0)
7200.   or (
7201.     FileName("*.arj")
7202.     or FileName("*.bup")
7203.     or FileName("*.bz2")
7204.     or FileName("*.chm")
7205.     or FileName("*.dvr-ms")
7206.     or FileName("*.gz")
7207.     or FileName("*.ifo")
7208.     or FileName("*.lzh")
7209.     or FileName("*.pdf")
7210.     or FileName("*.rpm")
7211.     or FileName("*.wmv")
7212.     or FileName("*.vob")
7213.     or FileName("*.z")
7214.   ) 
7215. )
7216. # Blobs end.
7217. 
7218. # NotBlobsArchivesBu
7219. or 
7220. # Archives start.
7221. (
7222.   DirectoryName("*Archive*")
7223.   or DirectoryName("*History*")
7224.   or DirectoryName("*Old")
7225.   or DirectoryName("* Old *")
7226.   or DirectoryName("Old *")
7227. 
7228.   or FileName("*.7z")
7229.   or FileName("*.cab")
7230.   or FileName("*.iso")
7231.   or FileName("*.msi")
7232.   or FileName("*.old")
7233.   or FileName("*.rar")
7234.   or FileName("*.tar")
7235.   or FileName("*.zip")
7236.   or
7237. # WinSysLow start.
7238. (
7239.   DirectoryName("$*")
7240.   or DirectoryName("0*")
7241.   or DirectoryName("1*")
7242.   or DirectoryName("2*")
7243.   or DirectoryName("3*")
7244.   or DirectoryName("4*")
7245.   or DirectoryName("5*")
7246.   or DirectoryName("6*")
7247.   or DirectoryName("7*")
7248.   or DirectoryName("8*")
7249.   or DirectoryName("9*")
7250. 
7251.   or DirectoryName("dllcache")
7252.   or DirectoryName("Downloaded Installations")
7253.   or DirectoryName("Ehome")
7254.   or DirectoryName("Fonts")
7255.   or DirectoryName("Help")
7256.   or DirectoryName("I386")
7257.   or DirectoryName("ie?updates")
7258.   or DirectoryName("Installer")
7259.   or DirectoryName("Installshield Installation Information")
7260.   or DirectoryName("IME")
7261.   or DirectoryName("*RECYCLE*")
7262.   or DirectoryName("ServicePackFiles")
7263.   or DirectoryName("SoftwareDistribution")
7264.   or DirectoryName("Speech")
7265.   or DirectoryName("Symbols")
7266.   or DirectoryName("System Volume Information")
7267.   or DirectoryName("windows.old")
7268. )
7269. # WinSysLow end.
7270. 
7271.   # Archives
7272. )
7273. # Archives end.
7274. 
7275. # NotBlobsArchivesBu
7276. or
7277. # Backups start.
7278. (
7279.   DirectoryName("*Backup*")
7280.   or DirectoryName("*Bu")
7281.   or DirectoryName("* Bu *")
7282.   or DirectoryName("Bu *")
7283. 
7284.   or FileName("*.bak")
7285.   or FileName("* - Copy*")
7286. )
7287. # Backups end.
7288. 
7289. # NotBlobsArchivesBu
7290. ) )
7291. # NotBlobsArchivesBu end.
7292. 
7293. # Programs
7294. and (
7295. # SystemDir start.
7296. (
7297.   DirectoryName("Boot*")
7298.   or DirectoryName("Device*")
7299.   or DirectoryName("DevSupport*")
7300.   or DirectoryName("Program*")
7301.   or DirectoryName("Security*")
7302.   or DirectoryName("SendTo*")
7303.   or DirectoryName("Sw*")
7304.   or DirectoryName("System*")
7305.   or DirectoryName("Toolbars")
7306.   or DirectoryName("Windows*")
7307. )
7308. # SystemDir end.
7309. 
7310. # Programs
7311. )
7312. # Programs end.
7313. 
7314. 		and not(
7315. 			# Os Data Dynamic start.
7316. (
7317. # Os Data Dynamic start.
7318. (
7319.   FileName("*.dat*")
7320.   or FileName("*.db*")
7321.   or FileName("*.edb*")
7322.   or FileName("*.log*")
7323.   or FileName("DataStore.edb")
7324. )
7325. # Os Data Dynamic end.
7326. 
7327.   or 
7328. # Os PageHiberDump start.
7329. (
7330.   FileName("DataStore.edb")
7331.   or FileName("DUMP*.*")
7332.   or FileName("Hiberfil.sys")
7333.   or FileName("MEMORY.DMP")
7334.   or FileName("Pagefile.sys")
7335. )
7336. # Os PageHiberDump end.
7337. 
7338. # Os Data Dynamic
7339. )
7340. # Os Data Dynamic end.
7341. 
7342. 			or 
7343. 				DirectoryName("Windows*")
7344. 		)
7345. 		FileActions
7346. 		  		/* ---------------------------------------------------------- */
7347. 	# Gap
7348. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
7349. 		# FILE STEP
7350. 
7351. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7352. 
7353. /* add message and move to a new line. */
7354. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7355. ")
7356. 
7357. /* display the line. (hopefully.) */
7358. # Zone Footer Set Statistics Window Text
7359. 
7360. SetStatisticsWindowText("----------------------------------------------------------
7361. Zones Processed: 
7362. ----------------------------------------------------------
7363. !ZoneListByLine!
7364. ----------------------------------------------------------
7365. Zone Processing Step:
7366. !ZoneStepByLine!    
7367. ----------------------------------------------------------
7368. Current Zone:
7369. !ZoneFooter!
7370. ----------------------------------------------------------
7371. Volume Statistics:
7372. !VolumeStatisticsDetail!
7373. ----------------------------------------------------------
7374. Zone Detailed Report:
7375. ----------------------------------------------------------
7376. !ZoneStatisticsDetail!
7377. ----------------------------------------------------------
7378. ")
7379. 
7380. 
7381. 
7382. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7383. 
7384. # BANNER SET
7385. 
7386. # DATE TIME RUN ELP
7387. 
7388. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
7389. /* Xinclude "..\BannerSet.MyDc"X */
7390. /* pause(1) */
7391. 
7392. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7393. 
7394. Title('!Heading!')
7395. /* pause(1) */
7396. 
7397. /* NOTE: Can't round or truncate to integer precision. */
7398. 
7399. pause(1)
7400. 	
7401. 	# ACTUAL GAP
7402. 		/* AddGap Variant. */
7403. 	  	# Zone Do Gap
7404. # Gap Calculation Methods:
7405. 
7406. /* 1) Anything you need to add first. */
7407. /* empty */
7408. 
7409. /* ---------------------------------------------------------- */
7410. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
7411. 	# GapRequestedStd.
7412. 
7413. 		/* ---------------------------------------------------------- */
7414. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
7415. 
7416. 		# Gap Calculation Methods:
7417. 
7418. /* AddGap Variants */
7419. 
7420. 	/* Standard */
7421. 		# Gap Calculation Methods:
7422. 	/* AddGap Variants */
7423. 	/* Standard */
7424. 
7425. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
7426. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
7427. 
7428. 	SetVariable(GapRequested, GapRequestedStd)
7429. 	
7430. 
7431. 	/* MFT Low High Method */
7432. 		# Gap Calculation Methods:
7433. 	/* AddGap Variants */
7434. 	/* MFT Low High Method */
7435. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
7436. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
7437. 	SetVariable(GapRequested, GapRequestedMft)
7438. 	
7439. 
7440. 	/* OS Volume Type Method */
7441. 		# Gap Calculation Methods:
7442. 	/* AddGap Variants */
7443. 	/* OS Volume Type Method */
7444. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
7445. 	SetVariable(GapRequested, GapRequestedOs)
7446. 
7447. 
7448. 
7449. /* MakeGap Variants */
7450. 
7451. 	/* Original Os 1-3 + MFT 2 */
7452. 		# Gap Calculation Methods:
7453. 	/* MakeGap Variants */
7454. 	/* Original Os 1-3 + MFT 2 */
7455. 	/* plus MFT gap placed inline at the dividing zone. */
7456. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
7457. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
7458. 	SetVariable(GapRequested, GapRequestedOrig)
7459. 	
7460. 	
7461. /* Note: You could comment out the ones not in use */
7462. /* However having the data in the log is useful. */
7463. /* Therefore the following line is otherwise needed. */
7464. 
7465. /* Standard used */
7466. 
7467. SetVariable(GapRequested, GapRequestedStd)
7468. 
7469. # Gap Calculation Methods:
7470. 
7471. /* AddGap Variants */
7472. 	/* Standard */
7473. 	/* MFT Low High Method */
7474. 	/* OS Volume Type Method */
7475. 
7476. /* MakeGap Variants */
7477. 	/* Original Os 1-3 + MFT 2 */
7478. 
7479. /* Note: You could comment out the ones not in use */
7480. /* However having the data in the log is useful. */
7481. /* Therefore the following line is otherwise needed. */
7482. 
7483. /* Standard is used currently */
7484. 
7485. 
7486. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
7487. 
7488. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
7489. 
7490. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
7491. 
7492. /* ---------------------------------------------------------- */
7493. /* 3) SMALL ZONE ADJUSTMENT. */
7494. /* Gab cant be larger than half the Zone Size. */
7495. 
7496. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
7497. 	
7498. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
7499. 
7500. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
7501. 
7502. /* ---------------------------------------------------------- */
7503. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
7504. # Gap Adjustments.
7505. 
7506. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
7507. 	
7508. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
7509. 
7510. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
7511. 
7512. /* ---------------------------------------------------------- */
7513. # BYPASS THIS.
7514. 	/* This is definitely wrong. */
7515. 	/* The question is can we steal gap from the next zone */
7516. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
7517. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
7518. 		# Zone Overflow.
7519. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
7520. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
7521. 
7522. /* ---------------------------------------------------------- */
7523. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
7524. # Remaining free space available.
7525. 
7526. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
7527. 	
7528. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
7529. 
7530. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
7531. 
7532. /* ---------------------------------------------------------- */
7533. # CURRENT gap to use.
7534. 
7535. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
7536. 
7537. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
7538. 
7539. /* ---------------------------------------------------------- */
7540. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
7541. # Debugging.
7542. 
7543. 	SetVariable(GapUsed, GapCurrent) // for debugging
7544. 
7545. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
7546. 
7547. 		# Your code HERE
7548. 
7549. /* ---------------------------------------------------------- */
7550. /* 7) YOUR CODE. */
7551. # YOUR CODE HERE:
7552. 	# INPUT: GapCurrent or GapCurrentLoc
7553. 	# OUTPUT: GapUsed...
7554. 
7555. /* ---------------------------------------------------------- */
7556. # Gap Size.
7557. # Actual Size of Gap.
7558. 
7559. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
7560. 
7561. /* ---------------------------------------------------------- */
7562. /* xxxxxxxxxxxxxxxxxxxxxx */
7563. # ADD THE GAP
7564. 	/* Xinclude "..\GapCommandDo.MyDc"X */
7565. /* xxxxxxxxxxxxxxxxxxxxxx */
7566. 
7567. 	
7568. 	# Zone Statistics	
7569. 	# Zone / Volume Statistics and Display
7570. 		
7571. 	# Accumulate Totals
7572.   	# Volume totals
7573. 
7574. /* Current total space used (by Zones and Gaps) */
7575. 
7576. SetVariable(VolumeZoneUsed, GapUsed)
7577. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
7578. /* Percentage */
7579. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
7580. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
7581. 
7582. /* Current total of free space requested */
7583. 
7584. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
7585. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7586. /* Percent. */
7587. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
7588. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
7589. 
7590. /* Current total of free space used */
7591. 
7592. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
7593. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
7594. /* Percent */
7595. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
7596. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
7597. 
7598. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
7599. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
7600. /* Xinclude "..\DebugDisplayPause.MyDc"X */
7601. 
7602. 
7603. 	# Current Values
7604. 	# Cluster, Sector, Block adjust for display.
7605. 	# Bytes per cluster is volume specific.
7606. 
7607. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
7608. 
7609. # Current Zone values.
7610. 	# Begin, end and size.
7611. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
7612. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
7613. 
7614. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
7615. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
7616. 
7617. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
7618. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
7619. 
7620. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
7621. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
7622. 
7623. 	SetVariable(ZoneFragments,				"!ZONE210N!")
7624. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
7625. 		
7626. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
7627. /* identical code to here: (separation not needed. TEST.) */	
7628. 
7629. # Current Gap, Actual and Free Values
7630. 	# Gap
7631. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
7632. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
7633. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
7634. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
7635. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
7636. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
7637. 	
7638. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
7639. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
7640. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
7641. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
7642. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
7643. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
7644. 	
7645. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
7646. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
7647. 	
7648. 	# Actual Size and End
7649. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
7650. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
7651. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
7652. 	
7653. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
7654. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
7655. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
7656. 
7657. # Gap Size & Rounding
7658. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
7659. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
7660. 	
7661. 	# Free Space
7662. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
7663. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
7664. 
7665. 	# Footer:
7666. SetVariable(ZoneFooter, "----------------------------------------------------------
7667. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
7668. 
7669. Statistics Report:
7670. ------------------
7671.    Size:  
7672.    ------------------------
7673.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7674.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7675.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7676. 
7677.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7678.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7679. 
7680.    Location:
7681.    ------------------------
7682.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7683.              Files End: !ZoneEndCurrent!
7684.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7685.       
7686.    Gap Settings:
7687.    ------------------------
7688.          Gap Requested: !ZoneGapSizePer!%
7689.       Volume Rounding: !ZoneVolRoundUpPer!%
7690.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7691.                  
7692.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7693.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7694.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7695.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7696.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7697.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7698.      
7699.    Free Space after Zone:
7700.    ------------------------
7701.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7702.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7703.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7704. 
7705. Directory and Files Select:
7706. ---------------------------
7707. !ZoneTypeSelectCurrent!               
7708. ---------------------------
7709. ----------------------------------------------------------
7710. ")
7711. 	# Zone Footer Set Statistics Window Text
7712. 
7713. SetStatisticsWindowText("----------------------------------------------------------
7714. Zones Processed: 
7715. ----------------------------------------------------------
7716. !ZoneListByLine!
7717. ----------------------------------------------------------
7718. Zone Processing Step:
7719. !ZoneStepByLine!    
7720. ----------------------------------------------------------
7721. Current Zone:
7722. !ZoneFooter!
7723. ----------------------------------------------------------
7724. Volume Statistics:
7725. !VolumeStatisticsDetail!
7726. ----------------------------------------------------------
7727. Zone Detailed Report:
7728. ----------------------------------------------------------
7729. !ZoneStatisticsDetail!
7730. ----------------------------------------------------------
7731. ")
7732. 
7733. 
7734. 	
7735.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
7736. 
7737. 	# Add Zone to list of zones for display.
7738. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
7739. 
7740. 	# Footer:
7741. SetVariable(ZoneFooter, "----------------------------------------------------------
7742. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
7743. 
7744. Statistics Report:
7745. ------------------
7746.    Size:  
7747.    ------------------------
7748.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
7749.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
7750.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
7751. 
7752.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
7753.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
7754. 
7755.    Location:
7756.    ------------------------
7757.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
7758.              Files End: !ZoneEndCurrent!
7759.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
7760.       
7761.    Gap Settings:
7762.    ------------------------
7763.          Gap Requested: !ZoneGapSizePer!%
7764.       Volume Rounding: !ZoneVolRoundUpPer!%
7765.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
7766.                  
7767.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
7768.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
7769.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
7770.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
7771.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
7772.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
7773.      
7774.    Free Space after Zone:
7775.    ------------------------
7776.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
7777.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
7778.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
7779. 
7780. Directory and Files Select:
7781. ---------------------------
7782. !ZoneTypeSelectCurrent!               
7783. ---------------------------
7784. ----------------------------------------------------------
7785. ")
7786. 
7787. 	# Add Zone Details to Report.	
7788. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
7789. !ZoneFooter!")
7790. 
7791. 
7792. 	
7793. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
7794. 			# FILE STEP
7795. 
7796. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7797. 
7798. /* add message and move to a new line. */
7799. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7800. ")
7801. 
7802. /* display the line. (hopefully.) */
7803. # Zone Footer Set Statistics Window Text
7804. 
7805. SetStatisticsWindowText("----------------------------------------------------------
7806. Zones Processed: 
7807. ----------------------------------------------------------
7808. !ZoneListByLine!
7809. ----------------------------------------------------------
7810. Zone Processing Step:
7811. !ZoneStepByLine!    
7812. ----------------------------------------------------------
7813. Current Zone:
7814. !ZoneFooter!
7815. ----------------------------------------------------------
7816. Volume Statistics:
7817. !VolumeStatisticsDetail!
7818. ----------------------------------------------------------
7819. Zone Detailed Report:
7820. ----------------------------------------------------------
7821. !ZoneStatisticsDetail!
7822. ----------------------------------------------------------
7823. ")
7824. 
7825. 
7826. 
7827. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7828. 
7829. # BANNER SET
7830. 
7831. # DATE TIME RUN ELP
7832. 
7833. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
7834. /* Xinclude "..\BannerSet.MyDc"X */
7835. /* pause(1) */
7836. 
7837. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7838. 
7839. Title('!Heading!')
7840. /* pause(1) */
7841. 
7842. /* NOTE: Can't round or truncate to integer precision. */
7843. 
7844. pause(1)
7845. 
7846. 			SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
7847. 	
7848. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
7849. 			# FILE STEP
7850. 
7851. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7852. 
7853. /* add message and move to a new line. */
7854. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7855. ")
7856. 
7857. /* display the line. (hopefully.) */
7858. # Zone Footer Set Statistics Window Text
7859. 
7860. SetStatisticsWindowText("----------------------------------------------------------
7861. Zones Processed: 
7862. ----------------------------------------------------------
7863. !ZoneListByLine!
7864. ----------------------------------------------------------
7865. Zone Processing Step:
7866. !ZoneStepByLine!    
7867. ----------------------------------------------------------
7868. Current Zone:
7869. !ZoneFooter!
7870. ----------------------------------------------------------
7871. Volume Statistics:
7872. !VolumeStatisticsDetail!
7873. ----------------------------------------------------------
7874. Zone Detailed Report:
7875. ----------------------------------------------------------
7876. !ZoneStatisticsDetail!
7877. ----------------------------------------------------------
7878. ")
7879. 
7880. 
7881. 
7882. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
7883. 
7884. # BANNER SET
7885. 
7886. # DATE TIME RUN ELP
7887. 
7888. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
7889. /* Xinclude "..\BannerSet.MyDc"X */
7890. /* pause(1) */
7891. 
7892. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
7893. 
7894. Title('!Heading!')
7895. /* pause(1) */
7896. 
7897. /* NOTE: Can't round or truncate to integer precision. */
7898. 
7899. pause(1)
7900. 
7901. 		# Zone Do Footer
7902. 
7903. /* ---------------------------------------------------------- */
7904. # File Select
7905. 	# Select Statments
7906. # File Actions 
7907. 	# Standard or OS File Actions.
7908. 	# Resume...
7909. 	
7910. 	# your stuff HERE (X)... post zone (file) file actions code.
7911. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
7912. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
7913. 		# (X)
7914. 		
7915. 		/* ??? Set window? */
7916. 	
7917. 	# ADD THE GAP
7918. 		
7919. # Vacate (good for diagnostics)
7920. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
7921. 
7922. # DoNotVacate - DO NOT Vacate (recommended)
7923. 
7924. # Vacate
7925. /* AddGap(GapUsedLoc) */
7926. 
7927. # DO Not Vacate
7928. AddGap(GapUsedLoc, DoNotVacate) 
7929. 	
7930. 	
7931. /* ---------------------------------------------------------- */
7932. # (failed) TEST for boolean logic.
7933. 
7934. /* It should work in the gap calculations for turning options */
7935. /* on and off but it will NOT work here. */
7936. 
7937. /* Boolean setting X or FlagX. */
7938. /* Where X will be on or off: */
7939. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
7940. /*      For ON:  (X  *  FlagAny) */
7941. 
7942. /* 1) Failed, zero gap overrode the previous one. */
7943. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
7944. /* AddGap(GapUsedTemp) */ 
7945. 
7946. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
7947. /* AddGap(GapUsedTemp, DoNotVacate) */ 
7948. 
7949. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
7950. 
7951. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
7952. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
7953. /* AddGap(GapUsedTemp) */ 
7954. 
7955. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
7956. /* AddGap(GapUsedTemp, DoNotVacate) */ 
7957. 
7958. /* ---------------------------------------------------------- */
7959. 
7960. # Vacate
7961. /* AddGap(GapUsed) */
7962. 
7963. # DO NOT Vacate (recommended)
7964. /* AddGap(GapUsed, DoNotVacate) */ 
7965. 	
7966. 
7967. 		
7968. # 
7969. FileEnd
7970. /* ---------------------------------------------------------- */
7971. 
7972. # your stuff HERE (X)... post zone (file) code.
7973. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
7974. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
7975. 	# (X)
7976. 
7977. SetVariable(FileStepDescription,"Zone finished, reporting.")
7978. # FILE STEP
7979. 
7980. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
7981. 
7982. /* add message and move to a new line. */
7983. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
7984. ")
7985. 
7986. /* display the line. (hopefully.) */
7987. # Zone Footer Set Statistics Window Text
7988. 
7989. SetStatisticsWindowText("----------------------------------------------------------
7990. Zones Processed: 
7991. ----------------------------------------------------------
7992. !ZoneListByLine!
7993. ----------------------------------------------------------
7994. Zone Processing Step:
7995. !ZoneStepByLine!    
7996. ----------------------------------------------------------
7997. Current Zone:
7998. !ZoneFooter!
7999. ----------------------------------------------------------
8000. Volume Statistics:
8001. !VolumeStatisticsDetail!
8002. ----------------------------------------------------------
8003. Zone Detailed Report:
8004. ----------------------------------------------------------
8005. !ZoneStatisticsDetail!
8006. ----------------------------------------------------------
8007. ")
8008. 
8009. 
8010. 
8011. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8012. 
8013. # BANNER SET
8014. 
8015. # DATE TIME RUN ELP
8016. 
8017. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
8018. /* Xinclude "..\BannerSet.MyDc"X */
8019. /* pause(1) */
8020. 
8021. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8022. 
8023. Title('!Heading!')
8024. /* pause(1) */
8025. 
8026. /* NOTE: Can't round or truncate to integer precision. */
8027. 
8028. pause(1)
8029. 
8030. # Zone When Finished
8031. 
8032. # BANNER SET
8033. 
8034. # DATE TIME RUN ELP
8035. 
8036. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
8037. /* Xinclude "..\BannerSet.MyDc"X */
8038. /* pause(1) */
8039. 
8040. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8041. 
8042. Title('!Heading!')
8043. /* pause(1) */
8044. 
8045. /* NOTE: Can't round or truncate to integer precision. */
8046. 
8047. AppendLogfile("!LogFileName!", "!Title!")
8048. 
8049. 
8050. 
8051. # Zone Statistics	
8052. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
8053. 
8054. # Footer:
8055. SetVariable(ZoneFooter, "----------------------------------------------------------
8056. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
8057. 
8058. Statistics Report:
8059. ------------------
8060.    Size:  
8061.    ------------------------
8062.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8063.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8064.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8065. 
8066.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8067.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8068. 
8069.    Location:
8070.    ------------------------
8071.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8072.              Files End: !ZoneEndCurrent!
8073.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8074.       
8075.    Gap Settings:
8076.    ------------------------
8077.          Gap Requested: !ZoneGapSizePer!%
8078.       Volume Rounding: !ZoneVolRoundUpPer!%
8079.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8080.                  
8081.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
8082.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
8083.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
8084.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
8085.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
8086.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
8087.      
8088.    Free Space after Zone:
8089.    ------------------------
8090.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8091.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8092.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8093. 
8094. Directory and Files Select:
8095. ---------------------------
8096. !ZoneTypeSelectCurrent!               
8097. ---------------------------
8098. ----------------------------------------------------------
8099. ")
8100. 
8101. AppendLogfile("!LogFileName!", ".")
8102. AppendLogfile("!LogFileName!", "!ZoneFooter!")
8103. AppendLogfile("!LogFileName!", ".")
8104. 
8105. # Zone Footer Set Statistics Window Text
8106. 
8107. SetStatisticsWindowText("----------------------------------------------------------
8108. Zones Processed: 
8109. ----------------------------------------------------------
8110. !ZoneListByLine!
8111. ----------------------------------------------------------
8112. Zone Processing Step:
8113. !ZoneStepByLine!    
8114. ----------------------------------------------------------
8115. Current Zone:
8116. !ZoneFooter!
8117. ----------------------------------------------------------
8118. Volume Statistics:
8119. !VolumeStatisticsDetail!
8120. ----------------------------------------------------------
8121. Zone Detailed Report:
8122. ----------------------------------------------------------
8123. !ZoneStatisticsDetail!
8124. ----------------------------------------------------------
8125. ")
8126. 
8127. 
8128. 
8129. /* pause() */
8130. /* pause() */
8131. 
8132. 
8133. 
8134. 	
8135. /* ---------------------------------------------------------- */
8136. # Zone Programs Fixed size just Windows.
8137. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsWindows!")
8138. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsWindows!")
8139. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
8140. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
8141. 	SetVariable(ZoneTypeSelect,'
8142.                 # Programs - Windows folder.
8143.                 not(
8144.                 # Os Data Dynamic start.
8145. (
8146. # Os Data Dynamic start.
8147. (
8148.   FileName("*.dat*")
8149.   or FileName("*.db*")
8150.   or FileName("*.edb*")
8151.   or FileName("*.log*")
8152.   or FileName("DataStore.edb")
8153. )
8154. # Os Data Dynamic end.
8155. 
8156.   or 
8157. # Os PageHiberDump start.
8158. (
8159.   FileName("DataStore.edb")
8160.   or FileName("DUMP*.*")
8161.   or FileName("Hiberfil.sys")
8162.   or FileName("MEMORY.DMP")
8163.   or FileName("Pagefile.sys")
8164. )
8165. # Os PageHiberDump end.
8166. 
8167. # Os Data Dynamic
8168. )
8169. # Os Data Dynamic end.
8170. 
8171.                 )
8172. ')
8173. 
8174. 		# Zone Do Header
8175. 
8176. # Zone When Started
8177. 
8178. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
8179. # Display Set Zone
8180. 
8181. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
8182. SetVariable(FileStepDescription,	"")
8183. 
8184. SetVariable(ZoneStepByLine, 			"Zone started.
8185. ")
8186. 
8187. # BANNER SET
8188. 
8189. # DATE TIME RUN ELP
8190. 
8191. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
8192. /* Xinclude "..\BannerSet.MyDc"X */
8193. /* pause(1) */
8194. 
8195. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8196. 
8197. Title('!Heading!')
8198. /* pause(1) */
8199. 
8200. /* NOTE: Can't round or truncate to integer precision. */
8201. 
8202. AppendLogfile("!LogFileName!", "!Title!")
8203. 
8204. 
8205. 
8206. pause(1)
8207. 
8208. 
8209. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
8210. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
8211. 
8212. SetVariable(ZoneStepNoCurrent, 0)
8213. 
8214. 
8215. # Zone Do Current Clear
8216. 
8217. SetVariable(ZoneTypeSelectCurrent, 		"")
8218. 
8219. SetVariable(ZoneBeginCurrent, 			0)
8220. SetVariable(ZoneBeginPerCurrent, 		0)
8221. SetVariable(ZoneEndCurrent, 			0)
8222. SetVariable(ZoneEndPerCurrent, 			0)
8223. 
8224. SetVariable(ZoneSizeCurrent,			0)
8225. SetVariable(ZoneSizePerCurrent,			0)
8226. 
8227. SetVariable(ZoneGapRequestedCurrent,	0)
8228. SetVariable(ZoneGapRoundedCurrent, 		0)
8229. SetVariable(ZoneGapAdjustedCurrent, 	0)
8230. SetVariable(ZoneGapAvailableCurrent, 	0)
8231. SetVariable(ZoneGapCurrent,				0)
8232. SetVariable(ZoneGapUsedCurrent, 		0)
8233. 
8234. SetVariable(ZoneGapActualCurrent, 		0)
8235. SetVariable(ZoneGapActualPerCurrent, 	0)
8236. 
8237. SetVariable(ZoneSizeActual, 			0)
8238. SetVariable(ZoneSizeActualCurrent,		0)
8239. 
8240. SetVariable(ZoneEndActual, 				0)
8241. SetVariable(ZoneEndActualCurrent,		0)			
8242. SetVariable(ZoneSizeActualPerCurrent, 	0)
8243.       
8244. SetVariable(ZoneFilesFolders,			0)
8245. SetVariable(ZoneFilesFoldersPer,		0) 
8246. 
8247. SetVariable(ZoneFragments,				0)
8248. SetVariable(ZoneFragmentsPer,			0) 
8249. 		
8250. SetVariable(ZoneEndActualCurrent, 		0)
8251. SetVariable(ZoneEndActualPerCurrent, 	0)
8252. 
8253. # Gap Calculation Methodology:
8254. 	# Requested
8255. 	SetVariable(GapRequested, 			0) 
8256. 	SetVariable(GapRequestedStd, 		0) 
8257. 	SetVariable(GapRequestedMft, 		0) 
8258. 	SetVariable(GapRequestedOs, 		0) 
8259. 	SetVariable(GapRequestedOriginal, 	0) 
8260. 	
8261. 	# Gap Adjustments
8262. 	SetVariable(GapRounded, 			0)
8263. 	# SetVariable(GapAdjusted, 			0)
8264. 	SetVariable(GapAvailable, 			0)
8265. 	SetVariable(GapCurrent, 			0)
8266. 	SetVariable(GapActual, 				0)
8267. 	SetVariable(GapUsed, 				0)
8268. 	
8269. 	# Gap Adjustments
8270. 	SetVariable(GapRoundedLoc, 			0)
8271. 	# SetVariable(GapAdjustedLoc, 		0)
8272. 	SetVariable(GapAvailableLoc, 		0)
8273. 	SetVariable(GapCurrentLoc, 			0)
8274. 	SetVariable(GapActualLoc,			0)
8275. 	SetVariable(GapUsedLoc,				0)
8276. 	
8277. 	# Space usage
8278. 	SetVariable(ZoneFreePerRequested, 	0)
8279. 	SetVariable(ZoneFreePerUsed, 		0)
8280. 
8281. # Gap Size & Rounding
8282. 	SetVariable(ZoneGapSizePer, 		0)
8283. 	SetVariable(ZoneVolRoundUpPer, 		0)
8284. 	
8285. 	# Free Space
8286. 	SetVariable(ZoneFreeUsedPer, 		0)
8287. 	SetVariable(ZoneFreeRequestedPer, 	0)
8288. 
8289. 
8290. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
8291. 
8292. # Footer:
8293. SetVariable(ZoneFooter, "----------------------------------------------------------
8294. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:15
8295. 
8296. Statistics Report:
8297. ------------------
8298.    Size:  
8299.    ------------------------
8300.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8301.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8302.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8303. 
8304.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8305.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8306. 
8307.    Location:
8308.    ------------------------
8309.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8310.              Files End: !ZoneEndCurrent!
8311.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8312.       
8313.    Gap Settings:
8314.    ------------------------
8315.          Gap Requested: !ZoneGapSizePer!%
8316.       Volume Rounding: !ZoneVolRoundUpPer!%
8317.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8318.                  
8319.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
8320.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
8321.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
8322.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
8323.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
8324.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
8325.      
8326.    Free Space after Zone:
8327.    ------------------------
8328.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
8329.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
8330.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
8331. 
8332. Directory and Files Select:
8333. ---------------------------
8334. !ZoneTypeSelectCurrent!               
8335. ---------------------------
8336. ----------------------------------------------------------
8337. ")
8338. 
8339. # BANNER SET
8340. 
8341. # DATE TIME RUN ELP
8342. 
8343. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
8344. /* Xinclude "..\BannerSet.MyDc"X */
8345. /* pause(1) */
8346. 
8347. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8348. 
8349. Title('!Heading!')
8350. /* pause(1) */
8351. 
8352. /* NOTE: Can't round or truncate to integer precision. */
8353. 
8354. AppendLogfile("!LogFileName!", "!Title!")
8355. 
8356. 
8357. 
8358. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
8359. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
8360. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:15")
8361. 
8362. SetVariable(ZoneListByLine, "!ZoneListByLine!
8363. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
8364. 
8365. 
8366. /* Fixed Zone Position Handling */
8367. /* Literal number: */
8368. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
8369. /* Percentage of disk: */
8370. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
8371. /* Gap */
8372. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
8373. 
8374. /* ---------------------------------------------------------- */
8375. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
8376. # FILE STEP
8377. 
8378. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8379. 
8380. /* add message and move to a new line. */
8381. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8382. ")
8383. 
8384. /* display the line. (hopefully.) */
8385. # Zone Footer Set Statistics Window Text
8386. 
8387. SetStatisticsWindowText("----------------------------------------------------------
8388. Zones Processed: 
8389. ----------------------------------------------------------
8390. !ZoneListByLine!
8391. ----------------------------------------------------------
8392. Zone Processing Step:
8393. !ZoneStepByLine!    
8394. ----------------------------------------------------------
8395. Current Zone:
8396. !ZoneFooter!
8397. ----------------------------------------------------------
8398. Volume Statistics:
8399. !VolumeStatisticsDetail!
8400. ----------------------------------------------------------
8401. Zone Detailed Report:
8402. ----------------------------------------------------------
8403. !ZoneStatisticsDetail!
8404. ----------------------------------------------------------
8405. ")
8406. 
8407. 
8408. 
8409. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8410. 
8411. # BANNER SET
8412. 
8413. # DATE TIME RUN ELP
8414. 
8415. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
8416. /* Xinclude "..\BannerSet.MyDc"X */
8417. /* pause(1) */
8418. 
8419. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8420. 
8421. Title('!Heading!')
8422. /* pause(1) */
8423. 
8424. /* NOTE: Can't round or truncate to integer precision. */
8425. 
8426. pause(1)
8427. 
8428. # your stuff HERE (X)... pre file select code.
8429. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
8430. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
8431. 	# (X)
8432. 
8433. FileSelect
8434. 
8435. 	# your stuff can't really go here (errors.)
8436. 	# maybe for some reason I don't know of...
8437. 	
8438. 	# Actions next...
8439. 		# Programs start.
8440. # NotBlobsArchivesBu start.
8441. (not (
8442. # Blobs start.
8443. (
8444. # BlobsAndExceptions start.
8445. ( not(
8446.   FileName("*.bat")
8447.   or FileName("*.css")
8448.   or FileName("*.dll")
8449.   or FileName("*.exe")
8450.   or FileName("*.htm*")
8451.   or FileName("*.jar")
8452.   or FileName("*.js")
8453.   or FileName("*.script")
8454.   or FileName("*.wsf")
8455.   or (
8456. # Databases start.
8457. (
8458.   FileName("*.crypt*")
8459.   or FileName("*.db*")
8460.   or FileName("*.rdb*")
8461.   or FileName("*.dc*")
8462.   or FileName("*.dict*")
8463.   or FileName("*.?db*")
8464.   or FileName("*.?rdb*")
8465.   or FileName("*.md*")
8466.   or FileName("*.myd")
8467.   or FileName("*.ndf")
8468.   or FileName("*.ns?")
8469.   or FileName("*.pab")
8470.   or FileName("*.pst")
8471.   or FileName("*.sd?*")
8472.   or FileName("*.sq**")
8473.   or FileName("*.tmd")
8474.   or FileName("*.tps")
8475.   or FileName("*.tr*")
8476. )
8477. # Databases end.
8478. 
8479.     # BlobsAndExceptions
8480.     or 
8481. # Data start.
8482. (
8483.   DirectoryName("Data*")
8484.   or DirectoryName("Device*")
8485.   or DirectoryName("Export*")
8486.   or DirectoryName("Import*")
8487.   or DirectoryName("Log*")
8488.   or DirectoryName("*Log")
8489.   or DirectoryName("Maintenance*")
8490.   or DirectoryName("Rec*")
8491.   or DirectoryName("Sales*")
8492.   or DirectoryName("Search*")
8493.   or DirectoryName("User*")
8494. )
8495. # Data end.
8496. 
8497.     # BlobsAndExceptions
8498.   )
8499. ) )
8500. # BlobsAndExceptions end.
8501. 
8502. # Blobs
8503. ) and (
8504.   Size(BlobFileSize,0)
8505.   or (
8506.     FileName("*.arj")
8507.     or FileName("*.bup")
8508.     or FileName("*.bz2")
8509.     or FileName("*.chm")
8510.     or FileName("*.dvr-ms")
8511.     or FileName("*.gz")
8512.     or FileName("*.ifo")
8513.     or FileName("*.lzh")
8514.     or FileName("*.pdf")
8515.     or FileName("*.rpm")
8516.     or FileName("*.wmv")
8517.     or FileName("*.vob")
8518.     or FileName("*.z")
8519.   ) 
8520. )
8521. # Blobs end.
8522. 
8523. # NotBlobsArchivesBu
8524. or 
8525. # Archives start.
8526. (
8527.   DirectoryName("*Archive*")
8528.   or DirectoryName("*History*")
8529.   or DirectoryName("*Old")
8530.   or DirectoryName("* Old *")
8531.   or DirectoryName("Old *")
8532. 
8533.   or FileName("*.7z")
8534.   or FileName("*.cab")
8535.   or FileName("*.iso")
8536.   or FileName("*.msi")
8537.   or FileName("*.old")
8538.   or FileName("*.rar")
8539.   or FileName("*.tar")
8540.   or FileName("*.zip")
8541.   or
8542. # WinSysLow start.
8543. (
8544.   DirectoryName("$*")
8545.   or DirectoryName("0*")
8546.   or DirectoryName("1*")
8547.   or DirectoryName("2*")
8548.   or DirectoryName("3*")
8549.   or DirectoryName("4*")
8550.   or DirectoryName("5*")
8551.   or DirectoryName("6*")
8552.   or DirectoryName("7*")
8553.   or DirectoryName("8*")
8554.   or DirectoryName("9*")
8555. 
8556.   or DirectoryName("dllcache")
8557.   or DirectoryName("Downloaded Installations")
8558.   or DirectoryName("Ehome")
8559.   or DirectoryName("Fonts")
8560.   or DirectoryName("Help")
8561.   or DirectoryName("I386")
8562.   or DirectoryName("ie?updates")
8563.   or DirectoryName("Installer")
8564.   or DirectoryName("Installshield Installation Information")
8565.   or DirectoryName("IME")
8566.   or DirectoryName("*RECYCLE*")
8567.   or DirectoryName("ServicePackFiles")
8568.   or DirectoryName("SoftwareDistribution")
8569.   or DirectoryName("Speech")
8570.   or DirectoryName("Symbols")
8571.   or DirectoryName("System Volume Information")
8572.   or DirectoryName("windows.old")
8573. )
8574. # WinSysLow end.
8575. 
8576.   # Archives
8577. )
8578. # Archives end.
8579. 
8580. # NotBlobsArchivesBu
8581. or
8582. # Backups start.
8583. (
8584.   DirectoryName("*Backup*")
8585.   or DirectoryName("*Bu")
8586.   or DirectoryName("* Bu *")
8587.   or DirectoryName("Bu *")
8588. 
8589.   or FileName("*.bak")
8590.   or FileName("* - Copy*")
8591. )
8592. # Backups end.
8593. 
8594. # NotBlobsArchivesBu
8595. ) )
8596. # NotBlobsArchivesBu end.
8597. 
8598. # Programs
8599. and (
8600. # SystemDir start.
8601. (
8602.   DirectoryName("Boot*")
8603.   or DirectoryName("Device*")
8604.   or DirectoryName("DevSupport*")
8605.   or DirectoryName("Program*")
8606.   or DirectoryName("Security*")
8607.   or DirectoryName("SendTo*")
8608.   or DirectoryName("Sw*")
8609.   or DirectoryName("System*")
8610.   or DirectoryName("Toolbars")
8611.   or DirectoryName("Windows*")
8612. )
8613. # SystemDir end.
8614. 
8615. # Programs
8616. )
8617. # Programs end.
8618. 
8619. 		and not(
8620. 			# Os Data Dynamic start.
8621. (
8622. # Os Data Dynamic start.
8623. (
8624.   FileName("*.dat*")
8625.   or FileName("*.db*")
8626.   or FileName("*.edb*")
8627.   or FileName("*.log*")
8628.   or FileName("DataStore.edb")
8629. )
8630. # Os Data Dynamic end.
8631. 
8632.   or 
8633. # Os PageHiberDump start.
8634. (
8635.   FileName("DataStore.edb")
8636.   or FileName("DUMP*.*")
8637.   or FileName("Hiberfil.sys")
8638.   or FileName("MEMORY.DMP")
8639.   or FileName("Pagefile.sys")
8640. )
8641. # Os PageHiberDump end.
8642. 
8643. # Os Data Dynamic
8644. )
8645. # Os Data Dynamic end.
8646. 
8647. 		)
8648. 		FileActions
8649. 		  		/* ---------------------------------------------------------- */
8650. 	# Gap
8651. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
8652. 		# FILE STEP
8653. 
8654. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
8655. 
8656. /* add message and move to a new line. */
8657. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
8658. ")
8659. 
8660. /* display the line. (hopefully.) */
8661. # Zone Footer Set Statistics Window Text
8662. 
8663. SetStatisticsWindowText("----------------------------------------------------------
8664. Zones Processed: 
8665. ----------------------------------------------------------
8666. !ZoneListByLine!
8667. ----------------------------------------------------------
8668. Zone Processing Step:
8669. !ZoneStepByLine!    
8670. ----------------------------------------------------------
8671. Current Zone:
8672. !ZoneFooter!
8673. ----------------------------------------------------------
8674. Volume Statistics:
8675. !VolumeStatisticsDetail!
8676. ----------------------------------------------------------
8677. Zone Detailed Report:
8678. ----------------------------------------------------------
8679. !ZoneStatisticsDetail!
8680. ----------------------------------------------------------
8681. ")
8682. 
8683. 
8684. 
8685. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
8686. 
8687. # BANNER SET
8688. 
8689. # DATE TIME RUN ELP
8690. 
8691. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:15 0:00:01")
8692. /* Xinclude "..\BannerSet.MyDc"X */
8693. /* pause(1) */
8694. 
8695. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
8696. 
8697. Title('!Heading!')
8698. /* pause(1) */
8699. 
8700. /* NOTE: Can't round or truncate to integer precision. */
8701. 
8702. pause(1)
8703. 	
8704. 	# ACTUAL GAP
8705. 		/* AddGap Variant. */
8706. 	  	# Zone Do Gap
8707. # Gap Calculation Methods:
8708. 
8709. /* 1) Anything you need to add first. */
8710. /* empty */
8711. 
8712. /* ---------------------------------------------------------- */
8713. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
8714. 	# GapRequestedStd.
8715. 
8716. 		/* ---------------------------------------------------------- */
8717. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
8718. 
8719. 		# Gap Calculation Methods:
8720. 
8721. /* AddGap Variants */
8722. 
8723. 	/* Standard */
8724. 		# Gap Calculation Methods:
8725. 	/* AddGap Variants */
8726. 	/* Standard */
8727. 
8728. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
8729. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
8730. 
8731. 	SetVariable(GapRequested, GapRequestedStd)
8732. 	
8733. 
8734. 	/* MFT Low High Method */
8735. 		# Gap Calculation Methods:
8736. 	/* AddGap Variants */
8737. 	/* MFT Low High Method */
8738. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
8739. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
8740. 	SetVariable(GapRequested, GapRequestedMft)
8741. 	
8742. 
8743. 	/* OS Volume Type Method */
8744. 		# Gap Calculation Methods:
8745. 	/* AddGap Variants */
8746. 	/* OS Volume Type Method */
8747. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
8748. 	SetVariable(GapRequested, GapRequestedOs)
8749. 
8750. 
8751. 
8752. /* MakeGap Variants */
8753. 
8754. 	/* Original Os 1-3 + MFT 2 */
8755. 		# Gap Calculation Methods:
8756. 	/* MakeGap Variants */
8757. 	/* Original Os 1-3 + MFT 2 */
8758. 	/* plus MFT gap placed inline at the dividing zone. */
8759. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
8760. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
8761. 	SetVariable(GapRequested, GapRequestedOrig)
8762. 	
8763. 	
8764. /* Note: You could comment out the ones not in use */
8765. /* However having the data in the log is useful. */
8766. /* Therefore the following line is otherwise needed. */
8767. 
8768. /* Standard used */
8769. 
8770. SetVariable(GapRequested, GapRequestedStd)
8771. 
8772. # Gap Calculation Methods:
8773. 
8774. /* AddGap Variants */
8775. 	/* Standard */
8776. 	/* MFT Low High Method */
8777. 	/* OS Volume Type Method */
8778. 
8779. /* MakeGap Variants */
8780. 	/* Original Os 1-3 + MFT 2 */
8781. 
8782. /* Note: You could comment out the ones not in use */
8783. /* However having the data in the log is useful. */
8784. /* Therefore the following line is otherwise needed. */
8785. 
8786. /* Standard is used currently */
8787. 
8788. 
8789. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
8790. 
8791. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
8792. 
8793. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
8794. 
8795. /* ---------------------------------------------------------- */
8796. /* 3) SMALL ZONE ADJUSTMENT. */
8797. /* Gab cant be larger than half the Zone Size. */
8798. 
8799. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
8800. 	
8801. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
8802. 
8803. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
8804. 
8805. /* ---------------------------------------------------------- */
8806. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
8807. # Gap Adjustments.
8808. 
8809. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
8810. 	
8811. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
8812. 
8813. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
8814. 
8815. /* ---------------------------------------------------------- */
8816. # BYPASS THIS.
8817. 	/* This is definitely wrong. */
8818. 	/* The question is can we steal gap from the next zone */
8819. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
8820. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
8821. 		# Zone Overflow.
8822. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
8823. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
8824. 
8825. /* ---------------------------------------------------------- */
8826. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
8827. # Remaining free space available.
8828. 
8829. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
8830. 	
8831. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
8832. 
8833. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
8834. 
8835. /* ---------------------------------------------------------- */
8836. # CURRENT gap to use.
8837. 
8838. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
8839. 
8840. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
8841. 
8842. /* ---------------------------------------------------------- */
8843. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
8844. # Debugging.
8845. 
8846. 	SetVariable(GapUsed, GapCurrent) // for debugging
8847. 
8848. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
8849. 
8850. 		# Your code HERE
8851. 
8852. /* ---------------------------------------------------------- */
8853. /* 7) YOUR CODE. */
8854. # YOUR CODE HERE:
8855. 	# INPUT: GapCurrent or GapCurrentLoc
8856. 	# OUTPUT: GapUsed...
8857. 
8858. /* ---------------------------------------------------------- */
8859. # Gap Size.
8860. # Actual Size of Gap.
8861. 
8862. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
8863. 
8864. /* ---------------------------------------------------------- */
8865. /* xxxxxxxxxxxxxxxxxxxxxx */
8866. # ADD THE GAP
8867. 	/* Xinclude "..\GapCommandDo.MyDc"X */
8868. /* xxxxxxxxxxxxxxxxxxxxxx */
8869. 
8870. 	
8871. 	# Zone Statistics	
8872. 	# Zone / Volume Statistics and Display
8873. 		
8874. 	# Accumulate Totals
8875.   	# Volume totals
8876. 
8877. /* Current total space used (by Zones and Gaps) */
8878. 
8879. SetVariable(VolumeZoneUsed, GapUsed)
8880. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
8881. /* Percentage */
8882. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
8883. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
8884. 
8885. /* Current total of free space requested */
8886. 
8887. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
8888. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
8889. /* Percent. */
8890. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
8891. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
8892. 
8893. /* Current total of free space used */
8894. 
8895. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
8896. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
8897. /* Percent */
8898. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
8899. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
8900. 
8901. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
8902. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
8903. /* Xinclude "..\DebugDisplayPause.MyDc"X */
8904. 
8905. 
8906. 	# Current Values
8907. 	# Cluster, Sector, Block adjust for display.
8908. 	# Bytes per cluster is volume specific.
8909. 
8910. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
8911. 
8912. # Current Zone values.
8913. 	# Begin, end and size.
8914. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
8915. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
8916. 
8917. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
8918. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
8919. 
8920. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
8921. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
8922. 
8923. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
8924. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
8925. 
8926. 	SetVariable(ZoneFragments,				"!ZONE210N!")
8927. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
8928. 		
8929. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
8930. /* identical code to here: (separation not needed. TEST.) */	
8931. 
8932. # Current Gap, Actual and Free Values
8933. 	# Gap
8934. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
8935. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
8936. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
8937. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
8938. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
8939. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
8940. 	
8941. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
8942. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
8943. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
8944. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
8945. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
8946. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
8947. 	
8948. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
8949. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
8950. 	
8951. 	# Actual Size and End
8952. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
8953. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
8954. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
8955. 	
8956. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
8957. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
8958. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
8959. 
8960. # Gap Size & Rounding
8961. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
8962. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
8963. 	
8964. 	# Free Space
8965. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
8966. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
8967. 
8968. 	# Footer:
8969. SetVariable(ZoneFooter, "----------------------------------------------------------
8970. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
8971. 
8972. Statistics Report:
8973. ------------------
8974.    Size:  
8975.    ------------------------
8976.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
8977.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
8978.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
8979. 
8980.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
8981.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
8982. 
8983.    Location:
8984.    ------------------------
8985.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
8986.              Files End: !ZoneEndCurrent!
8987.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
8988.       
8989.    Gap Settings:
8990.    ------------------------
8991.          Gap Requested: !ZoneGapSizePer!%
8992.       Volume Rounding: !ZoneVolRoundUpPer!%
8993.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
8994.                  
8995.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
8996.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
8997.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
8998.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
8999.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9000.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9001.      
9002.    Free Space after Zone:
9003.    ------------------------
9004.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9005.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9006.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9007. 
9008. Directory and Files Select:
9009. ---------------------------
9010. !ZoneTypeSelectCurrent!               
9011. ---------------------------
9012. ----------------------------------------------------------
9013. ")
9014. 	# Zone Footer Set Statistics Window Text
9015. 
9016. SetStatisticsWindowText("----------------------------------------------------------
9017. Zones Processed: 
9018. ----------------------------------------------------------
9019. !ZoneListByLine!
9020. ----------------------------------------------------------
9021. Zone Processing Step:
9022. !ZoneStepByLine!    
9023. ----------------------------------------------------------
9024. Current Zone:
9025. !ZoneFooter!
9026. ----------------------------------------------------------
9027. Volume Statistics:
9028. !VolumeStatisticsDetail!
9029. ----------------------------------------------------------
9030. Zone Detailed Report:
9031. ----------------------------------------------------------
9032. !ZoneStatisticsDetail!
9033. ----------------------------------------------------------
9034. ")
9035. 
9036. 
9037. 	
9038.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
9039. 
9040. 	# Add Zone to list of zones for display.
9041. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
9042. 
9043. 	# Footer:
9044. SetVariable(ZoneFooter, "----------------------------------------------------------
9045. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
9046. 
9047. Statistics Report:
9048. ------------------
9049.    Size:  
9050.    ------------------------
9051.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9052.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9053.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9054. 
9055.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9056.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9057. 
9058.    Location:
9059.    ------------------------
9060.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9061.              Files End: !ZoneEndCurrent!
9062.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9063.       
9064.    Gap Settings:
9065.    ------------------------
9066.          Gap Requested: !ZoneGapSizePer!%
9067.       Volume Rounding: !ZoneVolRoundUpPer!%
9068.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9069.                  
9070.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9071.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9072.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9073.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9074.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9075.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9076.      
9077.    Free Space after Zone:
9078.    ------------------------
9079.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9080.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9081.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9082. 
9083. Directory and Files Select:
9084. ---------------------------
9085. !ZoneTypeSelectCurrent!               
9086. ---------------------------
9087. ----------------------------------------------------------
9088. ")
9089. 
9090. 	# Add Zone Details to Report.	
9091. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
9092. !ZoneFooter!")
9093. 
9094. 
9095. 	
9096. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
9097. 			# FILE STEP
9098. 
9099. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9100. 
9101. /* add message and move to a new line. */
9102. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9103. ")
9104. 
9105. /* display the line. (hopefully.) */
9106. # Zone Footer Set Statistics Window Text
9107. 
9108. SetStatisticsWindowText("----------------------------------------------------------
9109. Zones Processed: 
9110. ----------------------------------------------------------
9111. !ZoneListByLine!
9112. ----------------------------------------------------------
9113. Zone Processing Step:
9114. !ZoneStepByLine!    
9115. ----------------------------------------------------------
9116. Current Zone:
9117. !ZoneFooter!
9118. ----------------------------------------------------------
9119. Volume Statistics:
9120. !VolumeStatisticsDetail!
9121. ----------------------------------------------------------
9122. Zone Detailed Report:
9123. ----------------------------------------------------------
9124. !ZoneStatisticsDetail!
9125. ----------------------------------------------------------
9126. ")
9127. 
9128. 
9129. 
9130. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9131. 
9132. # BANNER SET
9133. 
9134. # DATE TIME RUN ELP
9135. 
9136. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
9137. /* Xinclude "..\BannerSet.MyDc"X */
9138. /* pause(1) */
9139. 
9140. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9141. 
9142. Title('!Heading!')
9143. /* pause(1) */
9144. 
9145. /* NOTE: Can't round or truncate to integer precision. */
9146. 
9147. pause(1)
9148. 
9149. 			SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
9150. 	
9151. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
9152. 			# FILE STEP
9153. 
9154. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9155. 
9156. /* add message and move to a new line. */
9157. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9158. ")
9159. 
9160. /* display the line. (hopefully.) */
9161. # Zone Footer Set Statistics Window Text
9162. 
9163. SetStatisticsWindowText("----------------------------------------------------------
9164. Zones Processed: 
9165. ----------------------------------------------------------
9166. !ZoneListByLine!
9167. ----------------------------------------------------------
9168. Zone Processing Step:
9169. !ZoneStepByLine!    
9170. ----------------------------------------------------------
9171. Current Zone:
9172. !ZoneFooter!
9173. ----------------------------------------------------------
9174. Volume Statistics:
9175. !VolumeStatisticsDetail!
9176. ----------------------------------------------------------
9177. Zone Detailed Report:
9178. ----------------------------------------------------------
9179. !ZoneStatisticsDetail!
9180. ----------------------------------------------------------
9181. ")
9182. 
9183. 
9184. 
9185. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9186. 
9187. # BANNER SET
9188. 
9189. # DATE TIME RUN ELP
9190. 
9191. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
9192. /* Xinclude "..\BannerSet.MyDc"X */
9193. /* pause(1) */
9194. 
9195. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9196. 
9197. Title('!Heading!')
9198. /* pause(1) */
9199. 
9200. /* NOTE: Can't round or truncate to integer precision. */
9201. 
9202. pause(1)
9203. 
9204. 		# Zone Do Footer
9205. 
9206. /* ---------------------------------------------------------- */
9207. # File Select
9208. 	# Select Statments
9209. # File Actions 
9210. 	# Standard or OS File Actions.
9211. 	# Resume...
9212. 	
9213. 	# your stuff HERE (X)... post zone (file) file actions code.
9214. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
9215. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
9216. 		# (X)
9217. 		
9218. 		/* ??? Set window? */
9219. 	
9220. 	# ADD THE GAP
9221. 		
9222. # Vacate (good for diagnostics)
9223. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
9224. 
9225. # DoNotVacate - DO NOT Vacate (recommended)
9226. 
9227. # Vacate
9228. /* AddGap(GapUsedLoc) */
9229. 
9230. # DO Not Vacate
9231. AddGap(GapUsedLoc, DoNotVacate) 
9232. 	
9233. 	
9234. /* ---------------------------------------------------------- */
9235. # (failed) TEST for boolean logic.
9236. 
9237. /* It should work in the gap calculations for turning options */
9238. /* on and off but it will NOT work here. */
9239. 
9240. /* Boolean setting X or FlagX. */
9241. /* Where X will be on or off: */
9242. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
9243. /*      For ON:  (X  *  FlagAny) */
9244. 
9245. /* 1) Failed, zero gap overrode the previous one. */
9246. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
9247. /* AddGap(GapUsedTemp) */ 
9248. 
9249. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
9250. /* AddGap(GapUsedTemp, DoNotVacate) */ 
9251. 
9252. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
9253. 
9254. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
9255. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
9256. /* AddGap(GapUsedTemp) */ 
9257. 
9258. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
9259. /* AddGap(GapUsedTemp, DoNotVacate) */ 
9260. 
9261. /* ---------------------------------------------------------- */
9262. 
9263. # Vacate
9264. /* AddGap(GapUsed) */
9265. 
9266. # DO NOT Vacate (recommended)
9267. /* AddGap(GapUsed, DoNotVacate) */ 
9268. 	
9269. 
9270. 		
9271. # 
9272. FileEnd
9273. /* ---------------------------------------------------------- */
9274. 
9275. # your stuff HERE (X)... post zone (file) code.
9276. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
9277. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
9278. 	# (X)
9279. 
9280. SetVariable(FileStepDescription,"Zone finished, reporting.")
9281. # FILE STEP
9282. 
9283. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9284. 
9285. /* add message and move to a new line. */
9286. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9287. ")
9288. 
9289. /* display the line. (hopefully.) */
9290. # Zone Footer Set Statistics Window Text
9291. 
9292. SetStatisticsWindowText("----------------------------------------------------------
9293. Zones Processed: 
9294. ----------------------------------------------------------
9295. !ZoneListByLine!
9296. ----------------------------------------------------------
9297. Zone Processing Step:
9298. !ZoneStepByLine!    
9299. ----------------------------------------------------------
9300. Current Zone:
9301. !ZoneFooter!
9302. ----------------------------------------------------------
9303. Volume Statistics:
9304. !VolumeStatisticsDetail!
9305. ----------------------------------------------------------
9306. Zone Detailed Report:
9307. ----------------------------------------------------------
9308. !ZoneStatisticsDetail!
9309. ----------------------------------------------------------
9310. ")
9311. 
9312. 
9313. 
9314. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9315. 
9316. # BANNER SET
9317. 
9318. # DATE TIME RUN ELP
9319. 
9320. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
9321. /* Xinclude "..\BannerSet.MyDc"X */
9322. /* pause(1) */
9323. 
9324. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9325. 
9326. Title('!Heading!')
9327. /* pause(1) */
9328. 
9329. /* NOTE: Can't round or truncate to integer precision. */
9330. 
9331. pause(1)
9332. 
9333. # Zone When Finished
9334. 
9335. # BANNER SET
9336. 
9337. # DATE TIME RUN ELP
9338. 
9339. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
9340. /* Xinclude "..\BannerSet.MyDc"X */
9341. /* pause(1) */
9342. 
9343. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9344. 
9345. Title('!Heading!')
9346. /* pause(1) */
9347. 
9348. /* NOTE: Can't round or truncate to integer precision. */
9349. 
9350. AppendLogfile("!LogFileName!", "!Title!")
9351. 
9352. 
9353. 
9354. # Zone Statistics	
9355. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
9356. 
9357. # Footer:
9358. SetVariable(ZoneFooter, "----------------------------------------------------------
9359. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
9360. 
9361. Statistics Report:
9362. ------------------
9363.    Size:  
9364.    ------------------------
9365.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9366.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9367.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9368. 
9369.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9370.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9371. 
9372.    Location:
9373.    ------------------------
9374.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9375.              Files End: !ZoneEndCurrent!
9376.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9377.       
9378.    Gap Settings:
9379.    ------------------------
9380.          Gap Requested: !ZoneGapSizePer!%
9381.       Volume Rounding: !ZoneVolRoundUpPer!%
9382.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9383.                  
9384.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9385.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9386.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9387.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9388.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9389.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9390.      
9391.    Free Space after Zone:
9392.    ------------------------
9393.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9394.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9395.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9396. 
9397. Directory and Files Select:
9398. ---------------------------
9399. !ZoneTypeSelectCurrent!               
9400. ---------------------------
9401. ----------------------------------------------------------
9402. ")
9403. 
9404. AppendLogfile("!LogFileName!", ".")
9405. AppendLogfile("!LogFileName!", "!ZoneFooter!")
9406. AppendLogfile("!LogFileName!", ".")
9407. 
9408. # Zone Footer Set Statistics Window Text
9409. 
9410. SetStatisticsWindowText("----------------------------------------------------------
9411. Zones Processed: 
9412. ----------------------------------------------------------
9413. !ZoneListByLine!
9414. ----------------------------------------------------------
9415. Zone Processing Step:
9416. !ZoneStepByLine!    
9417. ----------------------------------------------------------
9418. Current Zone:
9419. !ZoneFooter!
9420. ----------------------------------------------------------
9421. Volume Statistics:
9422. !VolumeStatisticsDetail!
9423. ----------------------------------------------------------
9424. Zone Detailed Report:
9425. ----------------------------------------------------------
9426. !ZoneStatisticsDetail!
9427. ----------------------------------------------------------
9428. ")
9429. 
9430. 
9431. 
9432. /* pause() */
9433. /* pause() */
9434. 
9435. 
9436. 
9437. 	
9438. /* ---------------------------------------------------------- */
9439. # Zone Program Data.
9440. 	SetVariable(ZoneLabel, 			"!ZoneLabelProgramsData!")
9441. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionProgramsData!")
9442. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPrograms!")
9443. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePrograms!")
9444. 	SetVariable(ZoneTypeSelect,'
9445.                 # Programs - Data files.
9446.                 not(
9447.                 # Os PageHiberDump start.
9448. (
9449.   FileName("DataStore.edb")
9450.   or FileName("DUMP*.*")
9451.   or FileName("Hiberfil.sys")
9452.   or FileName("MEMORY.DMP")
9453.   or FileName("Pagefile.sys")
9454. )
9455. # Os PageHiberDump end.
9456. 
9457.                 )
9458. ')
9459. 
9460. 		# Zone Do Header
9461. 
9462. # Zone When Started
9463. 
9464. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
9465. # Display Set Zone
9466. 
9467. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
9468. SetVariable(FileStepDescription,	"")
9469. 
9470. SetVariable(ZoneStepByLine, 			"Zone started.
9471. ")
9472. 
9473. # BANNER SET
9474. 
9475. # DATE TIME RUN ELP
9476. 
9477. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
9478. /* Xinclude "..\BannerSet.MyDc"X */
9479. /* pause(1) */
9480. 
9481. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9482. 
9483. Title('!Heading!')
9484. /* pause(1) */
9485. 
9486. /* NOTE: Can't round or truncate to integer precision. */
9487. 
9488. AppendLogfile("!LogFileName!", "!Title!")
9489. 
9490. 
9491. 
9492. pause(1)
9493. 
9494. 
9495. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
9496. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
9497. 
9498. SetVariable(ZoneStepNoCurrent, 0)
9499. 
9500. 
9501. # Zone Do Current Clear
9502. 
9503. SetVariable(ZoneTypeSelectCurrent, 		"")
9504. 
9505. SetVariable(ZoneBeginCurrent, 			0)
9506. SetVariable(ZoneBeginPerCurrent, 		0)
9507. SetVariable(ZoneEndCurrent, 			0)
9508. SetVariable(ZoneEndPerCurrent, 			0)
9509. 
9510. SetVariable(ZoneSizeCurrent,			0)
9511. SetVariable(ZoneSizePerCurrent,			0)
9512. 
9513. SetVariable(ZoneGapRequestedCurrent,	0)
9514. SetVariable(ZoneGapRoundedCurrent, 		0)
9515. SetVariable(ZoneGapAdjustedCurrent, 	0)
9516. SetVariable(ZoneGapAvailableCurrent, 	0)
9517. SetVariable(ZoneGapCurrent,				0)
9518. SetVariable(ZoneGapUsedCurrent, 		0)
9519. 
9520. SetVariable(ZoneGapActualCurrent, 		0)
9521. SetVariable(ZoneGapActualPerCurrent, 	0)
9522. 
9523. SetVariable(ZoneSizeActual, 			0)
9524. SetVariable(ZoneSizeActualCurrent,		0)
9525. 
9526. SetVariable(ZoneEndActual, 				0)
9527. SetVariable(ZoneEndActualCurrent,		0)			
9528. SetVariable(ZoneSizeActualPerCurrent, 	0)
9529.       
9530. SetVariable(ZoneFilesFolders,			0)
9531. SetVariable(ZoneFilesFoldersPer,		0) 
9532. 
9533. SetVariable(ZoneFragments,				0)
9534. SetVariable(ZoneFragmentsPer,			0) 
9535. 		
9536. SetVariable(ZoneEndActualCurrent, 		0)
9537. SetVariable(ZoneEndActualPerCurrent, 	0)
9538. 
9539. # Gap Calculation Methodology:
9540. 	# Requested
9541. 	SetVariable(GapRequested, 			0) 
9542. 	SetVariable(GapRequestedStd, 		0) 
9543. 	SetVariable(GapRequestedMft, 		0) 
9544. 	SetVariable(GapRequestedOs, 		0) 
9545. 	SetVariable(GapRequestedOriginal, 	0) 
9546. 	
9547. 	# Gap Adjustments
9548. 	SetVariable(GapRounded, 			0)
9549. 	# SetVariable(GapAdjusted, 			0)
9550. 	SetVariable(GapAvailable, 			0)
9551. 	SetVariable(GapCurrent, 			0)
9552. 	SetVariable(GapActual, 				0)
9553. 	SetVariable(GapUsed, 				0)
9554. 	
9555. 	# Gap Adjustments
9556. 	SetVariable(GapRoundedLoc, 			0)
9557. 	# SetVariable(GapAdjustedLoc, 		0)
9558. 	SetVariable(GapAvailableLoc, 		0)
9559. 	SetVariable(GapCurrentLoc, 			0)
9560. 	SetVariable(GapActualLoc,			0)
9561. 	SetVariable(GapUsedLoc,				0)
9562. 	
9563. 	# Space usage
9564. 	SetVariable(ZoneFreePerRequested, 	0)
9565. 	SetVariable(ZoneFreePerUsed, 		0)
9566. 
9567. # Gap Size & Rounding
9568. 	SetVariable(ZoneGapSizePer, 		0)
9569. 	SetVariable(ZoneVolRoundUpPer, 		0)
9570. 	
9571. 	# Free Space
9572. 	SetVariable(ZoneFreeUsedPer, 		0)
9573. 	SetVariable(ZoneFreeRequestedPer, 	0)
9574. 
9575. 
9576. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
9577. 
9578. # Footer:
9579. SetVariable(ZoneFooter, "----------------------------------------------------------
9580. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
9581. 
9582. Statistics Report:
9583. ------------------
9584.    Size:  
9585.    ------------------------
9586.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
9587.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
9588.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
9589. 
9590.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
9591.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
9592. 
9593.    Location:
9594.    ------------------------
9595.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
9596.              Files End: !ZoneEndCurrent!
9597.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
9598.       
9599.    Gap Settings:
9600.    ------------------------
9601.          Gap Requested: !ZoneGapSizePer!%
9602.       Volume Rounding: !ZoneVolRoundUpPer!%
9603.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
9604.                  
9605.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
9606.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
9607.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
9608.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
9609.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
9610.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
9611.      
9612.    Free Space after Zone:
9613.    ------------------------
9614.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
9615.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
9616.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
9617. 
9618. Directory and Files Select:
9619. ---------------------------
9620. !ZoneTypeSelectCurrent!               
9621. ---------------------------
9622. ----------------------------------------------------------
9623. ")
9624. 
9625. # BANNER SET
9626. 
9627. # DATE TIME RUN ELP
9628. 
9629. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
9630. /* Xinclude "..\BannerSet.MyDc"X */
9631. /* pause(1) */
9632. 
9633. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9634. 
9635. Title('!Heading!')
9636. /* pause(1) */
9637. 
9638. /* NOTE: Can't round or truncate to integer precision. */
9639. 
9640. AppendLogfile("!LogFileName!", "!Title!")
9641. 
9642. 
9643. 
9644. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
9645. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
9646. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:16")
9647. 
9648. SetVariable(ZoneListByLine, "!ZoneListByLine!
9649. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
9650. 
9651. 
9652. /* Fixed Zone Position Handling */
9653. /* Literal number: */
9654. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
9655. /* Percentage of disk: */
9656. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
9657. /* Gap */
9658. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
9659. 
9660. /* ---------------------------------------------------------- */
9661. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
9662. # FILE STEP
9663. 
9664. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9665. 
9666. /* add message and move to a new line. */
9667. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9668. ")
9669. 
9670. /* display the line. (hopefully.) */
9671. # Zone Footer Set Statistics Window Text
9672. 
9673. SetStatisticsWindowText("----------------------------------------------------------
9674. Zones Processed: 
9675. ----------------------------------------------------------
9676. !ZoneListByLine!
9677. ----------------------------------------------------------
9678. Zone Processing Step:
9679. !ZoneStepByLine!    
9680. ----------------------------------------------------------
9681. Current Zone:
9682. !ZoneFooter!
9683. ----------------------------------------------------------
9684. Volume Statistics:
9685. !VolumeStatisticsDetail!
9686. ----------------------------------------------------------
9687. Zone Detailed Report:
9688. ----------------------------------------------------------
9689. !ZoneStatisticsDetail!
9690. ----------------------------------------------------------
9691. ")
9692. 
9693. 
9694. 
9695. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9696. 
9697. # BANNER SET
9698. 
9699. # DATE TIME RUN ELP
9700. 
9701. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
9702. /* Xinclude "..\BannerSet.MyDc"X */
9703. /* pause(1) */
9704. 
9705. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9706. 
9707. Title('!Heading!')
9708. /* pause(1) */
9709. 
9710. /* NOTE: Can't round or truncate to integer precision. */
9711. 
9712. pause(1)
9713. 
9714. # your stuff HERE (X)... pre file select code.
9715. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
9716. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
9717. 	# (X)
9718. 
9719. FileSelect
9720. 
9721. 	# your stuff can't really go here (errors.)
9722. 	# maybe for some reason I don't know of...
9723. 	
9724. 	# Actions next...
9725. 		# Programs start.
9726. # NotBlobsArchivesBu start.
9727. (not (
9728. # Blobs start.
9729. (
9730. # BlobsAndExceptions start.
9731. ( not(
9732.   FileName("*.bat")
9733.   or FileName("*.css")
9734.   or FileName("*.dll")
9735.   or FileName("*.exe")
9736.   or FileName("*.htm*")
9737.   or FileName("*.jar")
9738.   or FileName("*.js")
9739.   or FileName("*.script")
9740.   or FileName("*.wsf")
9741.   or (
9742. # Databases start.
9743. (
9744.   FileName("*.crypt*")
9745.   or FileName("*.db*")
9746.   or FileName("*.rdb*")
9747.   or FileName("*.dc*")
9748.   or FileName("*.dict*")
9749.   or FileName("*.?db*")
9750.   or FileName("*.?rdb*")
9751.   or FileName("*.md*")
9752.   or FileName("*.myd")
9753.   or FileName("*.ndf")
9754.   or FileName("*.ns?")
9755.   or FileName("*.pab")
9756.   or FileName("*.pst")
9757.   or FileName("*.sd?*")
9758.   or FileName("*.sq**")
9759.   or FileName("*.tmd")
9760.   or FileName("*.tps")
9761.   or FileName("*.tr*")
9762. )
9763. # Databases end.
9764. 
9765.     # BlobsAndExceptions
9766.     or 
9767. # Data start.
9768. (
9769.   DirectoryName("Data*")
9770.   or DirectoryName("Device*")
9771.   or DirectoryName("Export*")
9772.   or DirectoryName("Import*")
9773.   or DirectoryName("Log*")
9774.   or DirectoryName("*Log")
9775.   or DirectoryName("Maintenance*")
9776.   or DirectoryName("Rec*")
9777.   or DirectoryName("Sales*")
9778.   or DirectoryName("Search*")
9779.   or DirectoryName("User*")
9780. )
9781. # Data end.
9782. 
9783.     # BlobsAndExceptions
9784.   )
9785. ) )
9786. # BlobsAndExceptions end.
9787. 
9788. # Blobs
9789. ) and (
9790.   Size(BlobFileSize,0)
9791.   or (
9792.     FileName("*.arj")
9793.     or FileName("*.bup")
9794.     or FileName("*.bz2")
9795.     or FileName("*.chm")
9796.     or FileName("*.dvr-ms")
9797.     or FileName("*.gz")
9798.     or FileName("*.ifo")
9799.     or FileName("*.lzh")
9800.     or FileName("*.pdf")
9801.     or FileName("*.rpm")
9802.     or FileName("*.wmv")
9803.     or FileName("*.vob")
9804.     or FileName("*.z")
9805.   ) 
9806. )
9807. # Blobs end.
9808. 
9809. # NotBlobsArchivesBu
9810. or 
9811. # Archives start.
9812. (
9813.   DirectoryName("*Archive*")
9814.   or DirectoryName("*History*")
9815.   or DirectoryName("*Old")
9816.   or DirectoryName("* Old *")
9817.   or DirectoryName("Old *")
9818. 
9819.   or FileName("*.7z")
9820.   or FileName("*.cab")
9821.   or FileName("*.iso")
9822.   or FileName("*.msi")
9823.   or FileName("*.old")
9824.   or FileName("*.rar")
9825.   or FileName("*.tar")
9826.   or FileName("*.zip")
9827.   or
9828. # WinSysLow start.
9829. (
9830.   DirectoryName("$*")
9831.   or DirectoryName("0*")
9832.   or DirectoryName("1*")
9833.   or DirectoryName("2*")
9834.   or DirectoryName("3*")
9835.   or DirectoryName("4*")
9836.   or DirectoryName("5*")
9837.   or DirectoryName("6*")
9838.   or DirectoryName("7*")
9839.   or DirectoryName("8*")
9840.   or DirectoryName("9*")
9841. 
9842.   or DirectoryName("dllcache")
9843.   or DirectoryName("Downloaded Installations")
9844.   or DirectoryName("Ehome")
9845.   or DirectoryName("Fonts")
9846.   or DirectoryName("Help")
9847.   or DirectoryName("I386")
9848.   or DirectoryName("ie?updates")
9849.   or DirectoryName("Installer")
9850.   or DirectoryName("Installshield Installation Information")
9851.   or DirectoryName("IME")
9852.   or DirectoryName("*RECYCLE*")
9853.   or DirectoryName("ServicePackFiles")
9854.   or DirectoryName("SoftwareDistribution")
9855.   or DirectoryName("Speech")
9856.   or DirectoryName("Symbols")
9857.   or DirectoryName("System Volume Information")
9858.   or DirectoryName("windows.old")
9859. )
9860. # WinSysLow end.
9861. 
9862.   # Archives
9863. )
9864. # Archives end.
9865. 
9866. # NotBlobsArchivesBu
9867. or
9868. # Backups start.
9869. (
9870.   DirectoryName("*Backup*")
9871.   or DirectoryName("*Bu")
9872.   or DirectoryName("* Bu *")
9873.   or DirectoryName("Bu *")
9874. 
9875.   or FileName("*.bak")
9876.   or FileName("* - Copy*")
9877. )
9878. # Backups end.
9879. 
9880. # NotBlobsArchivesBu
9881. ) )
9882. # NotBlobsArchivesBu end.
9883. 
9884. # Programs
9885. and (
9886. # SystemDir start.
9887. (
9888.   DirectoryName("Boot*")
9889.   or DirectoryName("Device*")
9890.   or DirectoryName("DevSupport*")
9891.   or DirectoryName("Program*")
9892.   or DirectoryName("Security*")
9893.   or DirectoryName("SendTo*")
9894.   or DirectoryName("Sw*")
9895.   or DirectoryName("System*")
9896.   or DirectoryName("Toolbars")
9897.   or DirectoryName("Windows*")
9898. )
9899. # SystemDir end.
9900. 
9901. # Programs
9902. )
9903. # Programs end.
9904. 
9905. 		and not(
9906. 			# Os PageHiberDump start.
9907. (
9908.   FileName("DataStore.edb")
9909.   or FileName("DUMP*.*")
9910.   or FileName("Hiberfil.sys")
9911.   or FileName("MEMORY.DMP")
9912.   or FileName("Pagefile.sys")
9913. )
9914. # Os PageHiberDump end.
9915. 
9916. 		)
9917. 		FileActions
9918. 		  		/* ---------------------------------------------------------- */
9919. 	# Gap
9920. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
9921. 		# FILE STEP
9922. 
9923. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
9924. 
9925. /* add message and move to a new line. */
9926. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
9927. ")
9928. 
9929. /* display the line. (hopefully.) */
9930. # Zone Footer Set Statistics Window Text
9931. 
9932. SetStatisticsWindowText("----------------------------------------------------------
9933. Zones Processed: 
9934. ----------------------------------------------------------
9935. !ZoneListByLine!
9936. ----------------------------------------------------------
9937. Zone Processing Step:
9938. !ZoneStepByLine!    
9939. ----------------------------------------------------------
9940. Current Zone:
9941. !ZoneFooter!
9942. ----------------------------------------------------------
9943. Volume Statistics:
9944. !VolumeStatisticsDetail!
9945. ----------------------------------------------------------
9946. Zone Detailed Report:
9947. ----------------------------------------------------------
9948. !ZoneStatisticsDetail!
9949. ----------------------------------------------------------
9950. ")
9951. 
9952. 
9953. 
9954. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
9955. 
9956. # BANNER SET
9957. 
9958. # DATE TIME RUN ELP
9959. 
9960. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
9961. /* Xinclude "..\BannerSet.MyDc"X */
9962. /* pause(1) */
9963. 
9964. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
9965. 
9966. Title('!Heading!')
9967. /* pause(1) */
9968. 
9969. /* NOTE: Can't round or truncate to integer precision. */
9970. 
9971. pause(1)
9972. 	
9973. 	# ACTUAL GAP
9974. 		/* AddGap Variant. */
9975. 	  	# Zone Do Gap
9976. # Gap Calculation Methods:
9977. 
9978. /* 1) Anything you need to add first. */
9979. /* empty */
9980. 
9981. /* ---------------------------------------------------------- */
9982. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
9983. 	# GapRequestedStd.
9984. 
9985. 		/* ---------------------------------------------------------- */
9986. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
9987. 
9988. 		# Gap Calculation Methods:
9989. 
9990. /* AddGap Variants */
9991. 
9992. 	/* Standard */
9993. 		# Gap Calculation Methods:
9994. 	/* AddGap Variants */
9995. 	/* Standard */
9996. 
9997. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
9998. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
9999. 
10000. 	SetVariable(GapRequested, GapRequestedStd)
10001. 	
10002. 
10003. 	/* MFT Low High Method */
10004. 		# Gap Calculation Methods:
10005. 	/* AddGap Variants */
10006. 	/* MFT Low High Method */
10007. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
10008. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
10009. 	SetVariable(GapRequested, GapRequestedMft)
10010. 	
10011. 
10012. 	/* OS Volume Type Method */
10013. 		# Gap Calculation Methods:
10014. 	/* AddGap Variants */
10015. 	/* OS Volume Type Method */
10016. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
10017. 	SetVariable(GapRequested, GapRequestedOs)
10018. 
10019. 
10020. 
10021. /* MakeGap Variants */
10022. 
10023. 	/* Original Os 1-3 + MFT 2 */
10024. 		# Gap Calculation Methods:
10025. 	/* MakeGap Variants */
10026. 	/* Original Os 1-3 + MFT 2 */
10027. 	/* plus MFT gap placed inline at the dividing zone. */
10028. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
10029. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
10030. 	SetVariable(GapRequested, GapRequestedOrig)
10031. 	
10032. 	
10033. /* Note: You could comment out the ones not in use */
10034. /* However having the data in the log is useful. */
10035. /* Therefore the following line is otherwise needed. */
10036. 
10037. /* Standard used */
10038. 
10039. SetVariable(GapRequested, GapRequestedStd)
10040. 
10041. # Gap Calculation Methods:
10042. 
10043. /* AddGap Variants */
10044. 	/* Standard */
10045. 	/* MFT Low High Method */
10046. 	/* OS Volume Type Method */
10047. 
10048. /* MakeGap Variants */
10049. 	/* Original Os 1-3 + MFT 2 */
10050. 
10051. /* Note: You could comment out the ones not in use */
10052. /* However having the data in the log is useful. */
10053. /* Therefore the following line is otherwise needed. */
10054. 
10055. /* Standard is used currently */
10056. 
10057. 
10058. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
10059. 
10060. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
10061. 
10062. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
10063. 
10064. /* ---------------------------------------------------------- */
10065. /* 3) SMALL ZONE ADJUSTMENT. */
10066. /* Gab cant be larger than half the Zone Size. */
10067. 
10068. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
10069. 	
10070. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
10071. 
10072. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
10073. 
10074. /* ---------------------------------------------------------- */
10075. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
10076. # Gap Adjustments.
10077. 
10078. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
10079. 	
10080. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
10081. 
10082. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
10083. 
10084. /* ---------------------------------------------------------- */
10085. # BYPASS THIS.
10086. 	/* This is definitely wrong. */
10087. 	/* The question is can we steal gap from the next zone */
10088. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
10089. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
10090. 		# Zone Overflow.
10091. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
10092. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
10093. 
10094. /* ---------------------------------------------------------- */
10095. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
10096. # Remaining free space available.
10097. 
10098. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
10099. 	
10100. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
10101. 
10102. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
10103. 
10104. /* ---------------------------------------------------------- */
10105. # CURRENT gap to use.
10106. 
10107. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
10108. 
10109. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
10110. 
10111. /* ---------------------------------------------------------- */
10112. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
10113. # Debugging.
10114. 
10115. 	SetVariable(GapUsed, GapCurrent) // for debugging
10116. 
10117. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
10118. 
10119. 		# Your code HERE
10120. 
10121. /* ---------------------------------------------------------- */
10122. /* 7) YOUR CODE. */
10123. # YOUR CODE HERE:
10124. 	# INPUT: GapCurrent or GapCurrentLoc
10125. 	# OUTPUT: GapUsed...
10126. 
10127. /* ---------------------------------------------------------- */
10128. # Gap Size.
10129. # Actual Size of Gap.
10130. 
10131. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
10132. 
10133. /* ---------------------------------------------------------- */
10134. /* xxxxxxxxxxxxxxxxxxxxxx */
10135. # ADD THE GAP
10136. 	/* Xinclude "..\GapCommandDo.MyDc"X */
10137. /* xxxxxxxxxxxxxxxxxxxxxx */
10138. 
10139. 	
10140. 	# Zone Statistics	
10141. 	# Zone / Volume Statistics and Display
10142. 		
10143. 	# Accumulate Totals
10144.   	# Volume totals
10145. 
10146. /* Current total space used (by Zones and Gaps) */
10147. 
10148. SetVariable(VolumeZoneUsed, GapUsed)
10149. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
10150. /* Percentage */
10151. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
10152. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
10153. 
10154. /* Current total of free space requested */
10155. 
10156. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
10157. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10158. /* Percent. */
10159. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
10160. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
10161. 
10162. /* Current total of free space used */
10163. 
10164. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
10165. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
10166. /* Percent */
10167. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
10168. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
10169. 
10170. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
10171. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
10172. /* Xinclude "..\DebugDisplayPause.MyDc"X */
10173. 
10174. 
10175. 	# Current Values
10176. 	# Cluster, Sector, Block adjust for display.
10177. 	# Bytes per cluster is volume specific.
10178. 
10179. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
10180. 
10181. # Current Zone values.
10182. 	# Begin, end and size.
10183. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
10184. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
10185. 
10186. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
10187. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
10188. 
10189. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
10190. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
10191. 
10192. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
10193. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
10194. 
10195. 	SetVariable(ZoneFragments,				"!ZONE210N!")
10196. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
10197. 		
10198. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
10199. /* identical code to here: (separation not needed. TEST.) */	
10200. 
10201. # Current Gap, Actual and Free Values
10202. 	# Gap
10203. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
10204. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
10205. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
10206. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
10207. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
10208. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
10209. 	
10210. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
10211. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
10212. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
10213. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
10214. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
10215. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
10216. 	
10217. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
10218. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
10219. 	
10220. 	# Actual Size and End
10221. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
10222. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
10223. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
10224. 	
10225. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
10226. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
10227. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
10228. 
10229. # Gap Size & Rounding
10230. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
10231. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
10232. 	
10233. 	# Free Space
10234. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
10235. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
10236. 
10237. 	# Footer:
10238. SetVariable(ZoneFooter, "----------------------------------------------------------
10239. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
10240. 
10241. Statistics Report:
10242. ------------------
10243.    Size:  
10244.    ------------------------
10245.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10246.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10247.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10248. 
10249.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10250.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10251. 
10252.    Location:
10253.    ------------------------
10254.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10255.              Files End: !ZoneEndCurrent!
10256.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10257.       
10258.    Gap Settings:
10259.    ------------------------
10260.          Gap Requested: !ZoneGapSizePer!%
10261.       Volume Rounding: !ZoneVolRoundUpPer!%
10262.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10263.                  
10264.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
10265.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
10266.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
10267.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
10268.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
10269.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
10270.      
10271.    Free Space after Zone:
10272.    ------------------------
10273.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10274.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10275.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10276. 
10277. Directory and Files Select:
10278. ---------------------------
10279. !ZoneTypeSelectCurrent!               
10280. ---------------------------
10281. ----------------------------------------------------------
10282. ")
10283. 	# Zone Footer Set Statistics Window Text
10284. 
10285. SetStatisticsWindowText("----------------------------------------------------------
10286. Zones Processed: 
10287. ----------------------------------------------------------
10288. !ZoneListByLine!
10289. ----------------------------------------------------------
10290. Zone Processing Step:
10291. !ZoneStepByLine!    
10292. ----------------------------------------------------------
10293. Current Zone:
10294. !ZoneFooter!
10295. ----------------------------------------------------------
10296. Volume Statistics:
10297. !VolumeStatisticsDetail!
10298. ----------------------------------------------------------
10299. Zone Detailed Report:
10300. ----------------------------------------------------------
10301. !ZoneStatisticsDetail!
10302. ----------------------------------------------------------
10303. ")
10304. 
10305. 
10306. 	
10307.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
10308. 
10309. 	# Add Zone to list of zones for display.
10310. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
10311. 
10312. 	# Footer:
10313. SetVariable(ZoneFooter, "----------------------------------------------------------
10314. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
10315. 
10316. Statistics Report:
10317. ------------------
10318.    Size:  
10319.    ------------------------
10320.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10321.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10322.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10323. 
10324.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10325.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10326. 
10327.    Location:
10328.    ------------------------
10329.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10330.              Files End: !ZoneEndCurrent!
10331.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10332.       
10333.    Gap Settings:
10334.    ------------------------
10335.          Gap Requested: !ZoneGapSizePer!%
10336.       Volume Rounding: !ZoneVolRoundUpPer!%
10337.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10338.                  
10339.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
10340.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
10341.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
10342.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
10343.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
10344.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
10345.      
10346.    Free Space after Zone:
10347.    ------------------------
10348.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10349.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10350.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10351. 
10352. Directory and Files Select:
10353. ---------------------------
10354. !ZoneTypeSelectCurrent!               
10355. ---------------------------
10356. ----------------------------------------------------------
10357. ")
10358. 
10359. 	# Add Zone Details to Report.	
10360. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
10361. !ZoneFooter!")
10362. 
10363. 
10364. 	
10365. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
10366. 			# FILE STEP
10367. 
10368. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10369. 
10370. /* add message and move to a new line. */
10371. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10372. ")
10373. 
10374. /* display the line. (hopefully.) */
10375. # Zone Footer Set Statistics Window Text
10376. 
10377. SetStatisticsWindowText("----------------------------------------------------------
10378. Zones Processed: 
10379. ----------------------------------------------------------
10380. !ZoneListByLine!
10381. ----------------------------------------------------------
10382. Zone Processing Step:
10383. !ZoneStepByLine!    
10384. ----------------------------------------------------------
10385. Current Zone:
10386. !ZoneFooter!
10387. ----------------------------------------------------------
10388. Volume Statistics:
10389. !VolumeStatisticsDetail!
10390. ----------------------------------------------------------
10391. Zone Detailed Report:
10392. ----------------------------------------------------------
10393. !ZoneStatisticsDetail!
10394. ----------------------------------------------------------
10395. ")
10396. 
10397. 
10398. 
10399. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10400. 
10401. # BANNER SET
10402. 
10403. # DATE TIME RUN ELP
10404. 
10405. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
10406. /* Xinclude "..\BannerSet.MyDc"X */
10407. /* pause(1) */
10408. 
10409. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10410. 
10411. Title('!Heading!')
10412. /* pause(1) */
10413. 
10414. /* NOTE: Can't round or truncate to integer precision. */
10415. 
10416. pause(1)
10417. 
10418. 			SortByImportSequence(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
10419. 	
10420. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
10421. 			# FILE STEP
10422. 
10423. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10424. 
10425. /* add message and move to a new line. */
10426. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10427. ")
10428. 
10429. /* display the line. (hopefully.) */
10430. # Zone Footer Set Statistics Window Text
10431. 
10432. SetStatisticsWindowText("----------------------------------------------------------
10433. Zones Processed: 
10434. ----------------------------------------------------------
10435. !ZoneListByLine!
10436. ----------------------------------------------------------
10437. Zone Processing Step:
10438. !ZoneStepByLine!    
10439. ----------------------------------------------------------
10440. Current Zone:
10441. !ZoneFooter!
10442. ----------------------------------------------------------
10443. Volume Statistics:
10444. !VolumeStatisticsDetail!
10445. ----------------------------------------------------------
10446. Zone Detailed Report:
10447. ----------------------------------------------------------
10448. !ZoneStatisticsDetail!
10449. ----------------------------------------------------------
10450. ")
10451. 
10452. 
10453. 
10454. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10455. 
10456. # BANNER SET
10457. 
10458. # DATE TIME RUN ELP
10459. 
10460. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
10461. /* Xinclude "..\BannerSet.MyDc"X */
10462. /* pause(1) */
10463. 
10464. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10465. 
10466. Title('!Heading!')
10467. /* pause(1) */
10468. 
10469. /* NOTE: Can't round or truncate to integer precision. */
10470. 
10471. pause(1)
10472. 
10473. 		# Zone Do Footer
10474. 
10475. /* ---------------------------------------------------------- */
10476. # File Select
10477. 	# Select Statments
10478. # File Actions 
10479. 	# Standard or OS File Actions.
10480. 	# Resume...
10481. 	
10482. 	# your stuff HERE (X)... post zone (file) file actions code.
10483. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
10484. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
10485. 		# (X)
10486. 		
10487. 		/* ??? Set window? */
10488. 	
10489. 	# ADD THE GAP
10490. 		
10491. # Vacate (good for diagnostics)
10492. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
10493. 
10494. # DoNotVacate - DO NOT Vacate (recommended)
10495. 
10496. # Vacate
10497. /* AddGap(GapUsedLoc) */
10498. 
10499. # DO Not Vacate
10500. AddGap(GapUsedLoc, DoNotVacate) 
10501. 	
10502. 	
10503. /* ---------------------------------------------------------- */
10504. # (failed) TEST for boolean logic.
10505. 
10506. /* It should work in the gap calculations for turning options */
10507. /* on and off but it will NOT work here. */
10508. 
10509. /* Boolean setting X or FlagX. */
10510. /* Where X will be on or off: */
10511. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
10512. /*      For ON:  (X  *  FlagAny) */
10513. 
10514. /* 1) Failed, zero gap overrode the previous one. */
10515. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
10516. /* AddGap(GapUsedTemp) */ 
10517. 
10518. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
10519. /* AddGap(GapUsedTemp, DoNotVacate) */ 
10520. 
10521. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
10522. 
10523. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
10524. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
10525. /* AddGap(GapUsedTemp) */ 
10526. 
10527. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
10528. /* AddGap(GapUsedTemp, DoNotVacate) */ 
10529. 
10530. /* ---------------------------------------------------------- */
10531. 
10532. # Vacate
10533. /* AddGap(GapUsed) */
10534. 
10535. # DO NOT Vacate (recommended)
10536. /* AddGap(GapUsed, DoNotVacate) */ 
10537. 	
10538. 
10539. 		
10540. # 
10541. FileEnd
10542. /* ---------------------------------------------------------- */
10543. 
10544. # your stuff HERE (X)... post zone (file) code.
10545. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
10546. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
10547. 	# (X)
10548. 
10549. SetVariable(FileStepDescription,"Zone finished, reporting.")
10550. # FILE STEP
10551. 
10552. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10553. 
10554. /* add message and move to a new line. */
10555. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10556. ")
10557. 
10558. /* display the line. (hopefully.) */
10559. # Zone Footer Set Statistics Window Text
10560. 
10561. SetStatisticsWindowText("----------------------------------------------------------
10562. Zones Processed: 
10563. ----------------------------------------------------------
10564. !ZoneListByLine!
10565. ----------------------------------------------------------
10566. Zone Processing Step:
10567. !ZoneStepByLine!    
10568. ----------------------------------------------------------
10569. Current Zone:
10570. !ZoneFooter!
10571. ----------------------------------------------------------
10572. Volume Statistics:
10573. !VolumeStatisticsDetail!
10574. ----------------------------------------------------------
10575. Zone Detailed Report:
10576. ----------------------------------------------------------
10577. !ZoneStatisticsDetail!
10578. ----------------------------------------------------------
10579. ")
10580. 
10581. 
10582. 
10583. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10584. 
10585. # BANNER SET
10586. 
10587. # DATE TIME RUN ELP
10588. 
10589. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
10590. /* Xinclude "..\BannerSet.MyDc"X */
10591. /* pause(1) */
10592. 
10593. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10594. 
10595. Title('!Heading!')
10596. /* pause(1) */
10597. 
10598. /* NOTE: Can't round or truncate to integer precision. */
10599. 
10600. pause(1)
10601. 
10602. # Zone When Finished
10603. 
10604. # BANNER SET
10605. 
10606. # DATE TIME RUN ELP
10607. 
10608. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
10609. /* Xinclude "..\BannerSet.MyDc"X */
10610. /* pause(1) */
10611. 
10612. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10613. 
10614. Title('!Heading!')
10615. /* pause(1) */
10616. 
10617. /* NOTE: Can't round or truncate to integer precision. */
10618. 
10619. AppendLogfile("!LogFileName!", "!Title!")
10620. 
10621. 
10622. 
10623. # Zone Statistics	
10624. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
10625. 
10626. # Footer:
10627. SetVariable(ZoneFooter, "----------------------------------------------------------
10628. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
10629. 
10630. Statistics Report:
10631. ------------------
10632.    Size:  
10633.    ------------------------
10634.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
10635.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
10636.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
10637. 
10638.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
10639.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
10640. 
10641.    Location:
10642.    ------------------------
10643.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
10644.              Files End: !ZoneEndCurrent!
10645.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
10646.       
10647.    Gap Settings:
10648.    ------------------------
10649.          Gap Requested: !ZoneGapSizePer!%
10650.       Volume Rounding: !ZoneVolRoundUpPer!%
10651.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
10652.                  
10653.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
10654.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
10655.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
10656.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
10657.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
10658.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
10659.      
10660.    Free Space after Zone:
10661.    ------------------------
10662.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
10663.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
10664.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
10665. 
10666. Directory and Files Select:
10667. ---------------------------
10668. !ZoneTypeSelectCurrent!               
10669. ---------------------------
10670. ----------------------------------------------------------
10671. ")
10672. 
10673. AppendLogfile("!LogFileName!", ".")
10674. AppendLogfile("!LogFileName!", "!ZoneFooter!")
10675. AppendLogfile("!LogFileName!", ".")
10676. 
10677. # Zone Footer Set Statistics Window Text
10678. 
10679. SetStatisticsWindowText("----------------------------------------------------------
10680. Zones Processed: 
10681. ----------------------------------------------------------
10682. !ZoneListByLine!
10683. ----------------------------------------------------------
10684. Zone Processing Step:
10685. !ZoneStepByLine!    
10686. ----------------------------------------------------------
10687. Current Zone:
10688. !ZoneFooter!
10689. ----------------------------------------------------------
10690. Volume Statistics:
10691. !VolumeStatisticsDetail!
10692. ----------------------------------------------------------
10693. Zone Detailed Report:
10694. ----------------------------------------------------------
10695. !ZoneStatisticsDetail!
10696. ----------------------------------------------------------
10697. ")
10698. 
10699. 
10700. 
10701. /* pause() */
10702. /* pause() */
10703. 
10704. 
10705. 
10706. 	
10707. /* ---------------------------------------------------------- */
10708. 
10709. 
10710. /* ---------------------------------------------------------- */
10711. /* OLD: ToDo */
10712. 	/* Zone 1 and 2 originally */
10713. 	/* Originally the MFT and DIRs were processed first. */
10714. 	/* Zone 4 and 5 normally */
10715. 	/* The MakeGap call is put between which ever zones you want */
10716. 	/* So the actual zone number is unknown */
10717. 	/* SetVariable(ZoneCurrent,"4, 5") */
10718. 	/* MakeGap(RoundUp(VolumeUsed * (!MftPer! + 0.15), VolumeSize * ZoneVolRoundUpLarge), DoNotVacate) */
10719. 
10720. /* ---------------------------------------------------------- */
10721. SetVariable(FileStepDescription,"System Zones completed.")
10722. # FILE STEP
10723. 
10724. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
10725. 
10726. /* add message and move to a new line. */
10727. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
10728. ")
10729. 
10730. /* display the line. (hopefully.) */
10731. # Zone Footer Set Statistics Window Text
10732. 
10733. SetStatisticsWindowText("----------------------------------------------------------
10734. Zones Processed: 
10735. ----------------------------------------------------------
10736. !ZoneListByLine!
10737. ----------------------------------------------------------
10738. Zone Processing Step:
10739. !ZoneStepByLine!    
10740. ----------------------------------------------------------
10741. Current Zone:
10742. !ZoneFooter!
10743. ----------------------------------------------------------
10744. Volume Statistics:
10745. !VolumeStatisticsDetail!
10746. ----------------------------------------------------------
10747. Zone Detailed Report:
10748. ----------------------------------------------------------
10749. !ZoneStatisticsDetail!
10750. ----------------------------------------------------------
10751. ")
10752. 
10753. 
10754. 
10755. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
10756. 
10757. # BANNER SET
10758. 
10759. # DATE TIME RUN ELP
10760. 
10761. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
10762. /* Xinclude "..\BannerSet.MyDc"X */
10763. /* pause(1) */
10764. 
10765. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10766. 
10767. Title('!Heading!')
10768. /* pause(1) */
10769. 
10770. /* NOTE: Can't round or truncate to integer precision. */
10771. 
10772. pause(1)
10773. 
10774. 
10775. /* ---------------------------------------------------------- */
10776. /* Any Volume Regular Zones */
10777. /* ---------------------------------------------------------- */
10778. 
10779. /* ---------------------------------------------------------- */
10780. /* Zone IdeScripts Ide, Scripts, Support */
10781. /* ---------------------------------------------------------- */
10782. /* Zone IdeScripts Ide, Scripts, Support */
10783. 
10784. SetVariable(ZoneLabel, "!ZoneLabelIdeScripts!")
10785. SetVariable(ZoneDescription, "!ZoneDescriptionIdeScripts!")
10786. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpIdeScripts!")
10787. SetVariable(ZoneGapSize, "!ZoneGapSizeIdeScripts!")
10788. SetVariable(ZoneTypeSelect,'# IdeScripts start.
10789. # NotBlobsArchivesBu start.
10790. (not (
10791. # Blobs start.
10792. (
10793. # BlobsAndExceptions start.
10794. ( not(
10795.   FileName("*.bat")
10796.   or FileName("*.css")
10797.   or FileName("*.dll")
10798.   or FileName("*.exe")
10799.   or FileName("*.htm*")
10800.   or FileName("*.jar")
10801.   or FileName("*.js")
10802.   or FileName("*.script")
10803.   or FileName("*.wsf")
10804.   or (
10805. # Databases start.
10806. (
10807.   FileName("*.crypt*")
10808.   or FileName("*.db*")
10809.   or FileName("*.rdb*")
10810.   or FileName("*.dc*")
10811.   or FileName("*.dict*")
10812.   or FileName("*.?db*")
10813.   or FileName("*.?rdb*")
10814.   or FileName("*.md*")
10815.   or FileName("*.myd")
10816.   or FileName("*.ndf")
10817.   or FileName("*.ns?")
10818.   or FileName("*.pab")
10819.   or FileName("*.pst")
10820.   or FileName("*.sd?*")
10821.   or FileName("*.sq**")
10822.   or FileName("*.tmd")
10823.   or FileName("*.tps")
10824.   or FileName("*.tr*")
10825. )
10826. # Databases end.
10827. 
10828.     # BlobsAndExceptions
10829.     or 
10830. # Data start.
10831. (
10832.   DirectoryName("Data*")
10833.   or DirectoryName("Device*")
10834.   or DirectoryName("Export*")
10835.   or DirectoryName("Import*")
10836.   or DirectoryName("Log*")
10837.   or DirectoryName("*Log")
10838.   or DirectoryName("Maintenance*")
10839.   or DirectoryName("Rec*")
10840.   or DirectoryName("Sales*")
10841.   or DirectoryName("Search*")
10842.   or DirectoryName("User*")
10843. )
10844. # Data end.
10845. 
10846.     # BlobsAndExceptions
10847.   )
10848. ) )
10849. # BlobsAndExceptions end.
10850. 
10851. # Blobs
10852. ) and (
10853.   Size(BlobFileSize,0)
10854.   or (
10855.     FileName("*.arj")
10856.     or FileName("*.bup")
10857.     or FileName("*.bz2")
10858.     or FileName("*.chm")
10859.     or FileName("*.dvr-ms")
10860.     or FileName("*.gz")
10861.     or FileName("*.ifo")
10862.     or FileName("*.lzh")
10863.     or FileName("*.pdf")
10864.     or FileName("*.rpm")
10865.     or FileName("*.wmv")
10866.     or FileName("*.vob")
10867.     or FileName("*.z")
10868.   ) 
10869. )
10870. # Blobs end.
10871. 
10872. # NotBlobsArchivesBu
10873. or 
10874. # Archives start.
10875. (
10876.   DirectoryName("*Archive*")
10877.   or DirectoryName("*History*")
10878.   or DirectoryName("*Old")
10879.   or DirectoryName("* Old *")
10880.   or DirectoryName("Old *")
10881. 
10882.   or FileName("*.7z")
10883.   or FileName("*.cab")
10884.   or FileName("*.iso")
10885.   or FileName("*.msi")
10886.   or FileName("*.old")
10887.   or FileName("*.rar")
10888.   or FileName("*.tar")
10889.   or FileName("*.zip")
10890.   or
10891. # WinSysLow start.
10892. (
10893.   DirectoryName("$*")
10894.   or DirectoryName("0*")
10895.   or DirectoryName("1*")
10896.   or DirectoryName("2*")
10897.   or DirectoryName("3*")
10898.   or DirectoryName("4*")
10899.   or DirectoryName("5*")
10900.   or DirectoryName("6*")
10901.   or DirectoryName("7*")
10902.   or DirectoryName("8*")
10903.   or DirectoryName("9*")
10904. 
10905.   or DirectoryName("dllcache")
10906.   or DirectoryName("Downloaded Installations")
10907.   or DirectoryName("Ehome")
10908.   or DirectoryName("Fonts")
10909.   or DirectoryName("Help")
10910.   or DirectoryName("I386")
10911.   or DirectoryName("ie?updates")
10912.   or DirectoryName("Installer")
10913.   or DirectoryName("Installshield Installation Information")
10914.   or DirectoryName("IME")
10915.   or DirectoryName("*RECYCLE*")
10916.   or DirectoryName("ServicePackFiles")
10917.   or DirectoryName("SoftwareDistribution")
10918.   or DirectoryName("Speech")
10919.   or DirectoryName("Symbols")
10920.   or DirectoryName("System Volume Information")
10921.   or DirectoryName("windows.old")
10922. )
10923. # WinSysLow end.
10924. 
10925.   # Archives
10926. )
10927. # Archives end.
10928. 
10929. # NotBlobsArchivesBu
10930. or
10931. # Backups start.
10932. (
10933.   DirectoryName("*Backup*")
10934.   or DirectoryName("*Bu")
10935.   or DirectoryName("* Bu *")
10936.   or DirectoryName("Bu *")
10937. 
10938.   or FileName("*.bak")
10939.   or FileName("* - Copy*")
10940. )
10941. # Backups end.
10942. 
10943. # NotBlobsArchivesBu
10944. ) )
10945. # NotBlobsArchivesBu end.
10946. 
10947. # IdeScripts
10948. and ( 
10949. # Ide start.
10950. (
10951.     DirectoryName("Ide*")
10952.     or DirectoryName("Java*")
10953.     or DirectoryName("Os")
10954. )
10955. # Ide end.
10956. 
10957. # IdeScripts
10958. or  
10959. # Scripts start.
10960. (
10961.   DirectoryName("*Script*")
10962. )
10963. # Scripts end.
10964. 
10965. # IdeScripts
10966. )
10967. # IdeScripts end.
10968. ')
10969. 
10970. 	# Zone Do Header
10971. 
10972. # Zone When Started
10973. 
10974. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
10975. # Display Set Zone
10976. 
10977. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
10978. SetVariable(FileStepDescription,	"")
10979. 
10980. SetVariable(ZoneStepByLine, 			"Zone started.
10981. ")
10982. 
10983. # BANNER SET
10984. 
10985. # DATE TIME RUN ELP
10986. 
10987. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
10988. /* Xinclude "..\BannerSet.MyDc"X */
10989. /* pause(1) */
10990. 
10991. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
10992. 
10993. Title('!Heading!')
10994. /* pause(1) */
10995. 
10996. /* NOTE: Can't round or truncate to integer precision. */
10997. 
10998. AppendLogfile("!LogFileName!", "!Title!")
10999. 
11000. 
11001. 
11002. pause(1)
11003. 
11004. 
11005. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
11006. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
11007. 
11008. SetVariable(ZoneStepNoCurrent, 0)
11009. 
11010. 
11011. # Zone Do Current Clear
11012. 
11013. SetVariable(ZoneTypeSelectCurrent, 		"")
11014. 
11015. SetVariable(ZoneBeginCurrent, 			0)
11016. SetVariable(ZoneBeginPerCurrent, 		0)
11017. SetVariable(ZoneEndCurrent, 			0)
11018. SetVariable(ZoneEndPerCurrent, 			0)
11019. 
11020. SetVariable(ZoneSizeCurrent,			0)
11021. SetVariable(ZoneSizePerCurrent,			0)
11022. 
11023. SetVariable(ZoneGapRequestedCurrent,	0)
11024. SetVariable(ZoneGapRoundedCurrent, 		0)
11025. SetVariable(ZoneGapAdjustedCurrent, 	0)
11026. SetVariable(ZoneGapAvailableCurrent, 	0)
11027. SetVariable(ZoneGapCurrent,				0)
11028. SetVariable(ZoneGapUsedCurrent, 		0)
11029. 
11030. SetVariable(ZoneGapActualCurrent, 		0)
11031. SetVariable(ZoneGapActualPerCurrent, 	0)
11032. 
11033. SetVariable(ZoneSizeActual, 			0)
11034. SetVariable(ZoneSizeActualCurrent,		0)
11035. 
11036. SetVariable(ZoneEndActual, 				0)
11037. SetVariable(ZoneEndActualCurrent,		0)			
11038. SetVariable(ZoneSizeActualPerCurrent, 	0)
11039.       
11040. SetVariable(ZoneFilesFolders,			0)
11041. SetVariable(ZoneFilesFoldersPer,		0) 
11042. 
11043. SetVariable(ZoneFragments,				0)
11044. SetVariable(ZoneFragmentsPer,			0) 
11045. 		
11046. SetVariable(ZoneEndActualCurrent, 		0)
11047. SetVariable(ZoneEndActualPerCurrent, 	0)
11048. 
11049. # Gap Calculation Methodology:
11050. 	# Requested
11051. 	SetVariable(GapRequested, 			0) 
11052. 	SetVariable(GapRequestedStd, 		0) 
11053. 	SetVariable(GapRequestedMft, 		0) 
11054. 	SetVariable(GapRequestedOs, 		0) 
11055. 	SetVariable(GapRequestedOriginal, 	0) 
11056. 	
11057. 	# Gap Adjustments
11058. 	SetVariable(GapRounded, 			0)
11059. 	# SetVariable(GapAdjusted, 			0)
11060. 	SetVariable(GapAvailable, 			0)
11061. 	SetVariable(GapCurrent, 			0)
11062. 	SetVariable(GapActual, 				0)
11063. 	SetVariable(GapUsed, 				0)
11064. 	
11065. 	# Gap Adjustments
11066. 	SetVariable(GapRoundedLoc, 			0)
11067. 	# SetVariable(GapAdjustedLoc, 		0)
11068. 	SetVariable(GapAvailableLoc, 		0)
11069. 	SetVariable(GapCurrentLoc, 			0)
11070. 	SetVariable(GapActualLoc,			0)
11071. 	SetVariable(GapUsedLoc,				0)
11072. 	
11073. 	# Space usage
11074. 	SetVariable(ZoneFreePerRequested, 	0)
11075. 	SetVariable(ZoneFreePerUsed, 		0)
11076. 
11077. # Gap Size & Rounding
11078. 	SetVariable(ZoneGapSizePer, 		0)
11079. 	SetVariable(ZoneVolRoundUpPer, 		0)
11080. 	
11081. 	# Free Space
11082. 	SetVariable(ZoneFreeUsedPer, 		0)
11083. 	SetVariable(ZoneFreeRequestedPer, 	0)
11084. 
11085. 
11086. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
11087. 
11088. # Footer:
11089. SetVariable(ZoneFooter, "----------------------------------------------------------
11090. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
11091. 
11092. Statistics Report:
11093. ------------------
11094.    Size:  
11095.    ------------------------
11096.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11097.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11098.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11099. 
11100.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11101.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11102. 
11103.    Location:
11104.    ------------------------
11105.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11106.              Files End: !ZoneEndCurrent!
11107.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11108.       
11109.    Gap Settings:
11110.    ------------------------
11111.          Gap Requested: !ZoneGapSizePer!%
11112.       Volume Rounding: !ZoneVolRoundUpPer!%
11113.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11114.                  
11115.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
11116.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
11117.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
11118.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
11119.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
11120.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
11121.      
11122.    Free Space after Zone:
11123.    ------------------------
11124.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11125.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11126.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11127. 
11128. Directory and Files Select:
11129. ---------------------------
11130. !ZoneTypeSelectCurrent!               
11131. ---------------------------
11132. ----------------------------------------------------------
11133. ")
11134. 
11135. # BANNER SET
11136. 
11137. # DATE TIME RUN ELP
11138. 
11139. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
11140. /* Xinclude "..\BannerSet.MyDc"X */
11141. /* pause(1) */
11142. 
11143. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11144. 
11145. Title('!Heading!')
11146. /* pause(1) */
11147. 
11148. /* NOTE: Can't round or truncate to integer precision. */
11149. 
11150. AppendLogfile("!LogFileName!", "!Title!")
11151. 
11152. 
11153. 
11154. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
11155. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
11156. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:16")
11157. 
11158. SetVariable(ZoneListByLine, "!ZoneListByLine!
11159. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
11160. 
11161. 
11162. /* Fixed Zone Position Handling */
11163. /* Literal number: */
11164. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
11165. /* Percentage of disk: */
11166. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
11167. /* Gap */
11168. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
11169. 
11170. /* ---------------------------------------------------------- */
11171. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
11172. # FILE STEP
11173. 
11174. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11175. 
11176. /* add message and move to a new line. */
11177. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11178. ")
11179. 
11180. /* display the line. (hopefully.) */
11181. # Zone Footer Set Statistics Window Text
11182. 
11183. SetStatisticsWindowText("----------------------------------------------------------
11184. Zones Processed: 
11185. ----------------------------------------------------------
11186. !ZoneListByLine!
11187. ----------------------------------------------------------
11188. Zone Processing Step:
11189. !ZoneStepByLine!    
11190. ----------------------------------------------------------
11191. Current Zone:
11192. !ZoneFooter!
11193. ----------------------------------------------------------
11194. Volume Statistics:
11195. !VolumeStatisticsDetail!
11196. ----------------------------------------------------------
11197. Zone Detailed Report:
11198. ----------------------------------------------------------
11199. !ZoneStatisticsDetail!
11200. ----------------------------------------------------------
11201. ")
11202. 
11203. 
11204. 
11205. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11206. 
11207. # BANNER SET
11208. 
11209. # DATE TIME RUN ELP
11210. 
11211. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
11212. /* Xinclude "..\BannerSet.MyDc"X */
11213. /* pause(1) */
11214. 
11215. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11216. 
11217. Title('!Heading!')
11218. /* pause(1) */
11219. 
11220. /* NOTE: Can't round or truncate to integer precision. */
11221. 
11222. pause(1)
11223. 
11224. # your stuff HERE (X)... pre file select code.
11225. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
11226. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
11227. 	# (X)
11228. 
11229. FileSelect
11230. 
11231. 	# your stuff can't really go here (errors.)
11232. 	# maybe for some reason I don't know of...
11233. 	
11234. 	# Actions next...
11235. 	# IdeScripts start.
11236. # NotBlobsArchivesBu start.
11237. (not (
11238. # Blobs start.
11239. (
11240. # BlobsAndExceptions start.
11241. ( not(
11242.   FileName("*.bat")
11243.   or FileName("*.css")
11244.   or FileName("*.dll")
11245.   or FileName("*.exe")
11246.   or FileName("*.htm*")
11247.   or FileName("*.jar")
11248.   or FileName("*.js")
11249.   or FileName("*.script")
11250.   or FileName("*.wsf")
11251.   or (
11252. # Databases start.
11253. (
11254.   FileName("*.crypt*")
11255.   or FileName("*.db*")
11256.   or FileName("*.rdb*")
11257.   or FileName("*.dc*")
11258.   or FileName("*.dict*")
11259.   or FileName("*.?db*")
11260.   or FileName("*.?rdb*")
11261.   or FileName("*.md*")
11262.   or FileName("*.myd")
11263.   or FileName("*.ndf")
11264.   or FileName("*.ns?")
11265.   or FileName("*.pab")
11266.   or FileName("*.pst")
11267.   or FileName("*.sd?*")
11268.   or FileName("*.sq**")
11269.   or FileName("*.tmd")
11270.   or FileName("*.tps")
11271.   or FileName("*.tr*")
11272. )
11273. # Databases end.
11274. 
11275.     # BlobsAndExceptions
11276.     or 
11277. # Data start.
11278. (
11279.   DirectoryName("Data*")
11280.   or DirectoryName("Device*")
11281.   or DirectoryName("Export*")
11282.   or DirectoryName("Import*")
11283.   or DirectoryName("Log*")
11284.   or DirectoryName("*Log")
11285.   or DirectoryName("Maintenance*")
11286.   or DirectoryName("Rec*")
11287.   or DirectoryName("Sales*")
11288.   or DirectoryName("Search*")
11289.   or DirectoryName("User*")
11290. )
11291. # Data end.
11292. 
11293.     # BlobsAndExceptions
11294.   )
11295. ) )
11296. # BlobsAndExceptions end.
11297. 
11298. # Blobs
11299. ) and (
11300.   Size(BlobFileSize,0)
11301.   or (
11302.     FileName("*.arj")
11303.     or FileName("*.bup")
11304.     or FileName("*.bz2")
11305.     or FileName("*.chm")
11306.     or FileName("*.dvr-ms")
11307.     or FileName("*.gz")
11308.     or FileName("*.ifo")
11309.     or FileName("*.lzh")
11310.     or FileName("*.pdf")
11311.     or FileName("*.rpm")
11312.     or FileName("*.wmv")
11313.     or FileName("*.vob")
11314.     or FileName("*.z")
11315.   ) 
11316. )
11317. # Blobs end.
11318. 
11319. # NotBlobsArchivesBu
11320. or 
11321. # Archives start.
11322. (
11323.   DirectoryName("*Archive*")
11324.   or DirectoryName("*History*")
11325.   or DirectoryName("*Old")
11326.   or DirectoryName("* Old *")
11327.   or DirectoryName("Old *")
11328. 
11329.   or FileName("*.7z")
11330.   or FileName("*.cab")
11331.   or FileName("*.iso")
11332.   or FileName("*.msi")
11333.   or FileName("*.old")
11334.   or FileName("*.rar")
11335.   or FileName("*.tar")
11336.   or FileName("*.zip")
11337.   or
11338. # WinSysLow start.
11339. (
11340.   DirectoryName("$*")
11341.   or DirectoryName("0*")
11342.   or DirectoryName("1*")
11343.   or DirectoryName("2*")
11344.   or DirectoryName("3*")
11345.   or DirectoryName("4*")
11346.   or DirectoryName("5*")
11347.   or DirectoryName("6*")
11348.   or DirectoryName("7*")
11349.   or DirectoryName("8*")
11350.   or DirectoryName("9*")
11351. 
11352.   or DirectoryName("dllcache")
11353.   or DirectoryName("Downloaded Installations")
11354.   or DirectoryName("Ehome")
11355.   or DirectoryName("Fonts")
11356.   or DirectoryName("Help")
11357.   or DirectoryName("I386")
11358.   or DirectoryName("ie?updates")
11359.   or DirectoryName("Installer")
11360.   or DirectoryName("Installshield Installation Information")
11361.   or DirectoryName("IME")
11362.   or DirectoryName("*RECYCLE*")
11363.   or DirectoryName("ServicePackFiles")
11364.   or DirectoryName("SoftwareDistribution")
11365.   or DirectoryName("Speech")
11366.   or DirectoryName("Symbols")
11367.   or DirectoryName("System Volume Information")
11368.   or DirectoryName("windows.old")
11369. )
11370. # WinSysLow end.
11371. 
11372.   # Archives
11373. )
11374. # Archives end.
11375. 
11376. # NotBlobsArchivesBu
11377. or
11378. # Backups start.
11379. (
11380.   DirectoryName("*Backup*")
11381.   or DirectoryName("*Bu")
11382.   or DirectoryName("* Bu *")
11383.   or DirectoryName("Bu *")
11384. 
11385.   or FileName("*.bak")
11386.   or FileName("* - Copy*")
11387. )
11388. # Backups end.
11389. 
11390. # NotBlobsArchivesBu
11391. ) )
11392. # NotBlobsArchivesBu end.
11393. 
11394. # IdeScripts
11395. and ( 
11396. # Ide start.
11397. (
11398.     DirectoryName("Ide*")
11399.     or DirectoryName("Java*")
11400.     or DirectoryName("Os")
11401. )
11402. # Ide end.
11403. 
11404. # IdeScripts
11405. or  
11406. # Scripts start.
11407. (
11408.   DirectoryName("*Script*")
11409. )
11410. # Scripts end.
11411. 
11412. # IdeScripts
11413. )
11414. # IdeScripts end.
11415. 
11416. 	# Zone
11417. # File Select
11418. 	# File Booleans
11419. 	# Resume...
11420. # File Action - SortByName.
11421. 
11422. FileActions
11423. 
11424. 		/* ---------------------------------------------------------- */
11425. 	# Gap
11426. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
11427. 		# FILE STEP
11428. 
11429. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11430. 
11431. /* add message and move to a new line. */
11432. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11433. ")
11434. 
11435. /* display the line. (hopefully.) */
11436. # Zone Footer Set Statistics Window Text
11437. 
11438. SetStatisticsWindowText("----------------------------------------------------------
11439. Zones Processed: 
11440. ----------------------------------------------------------
11441. !ZoneListByLine!
11442. ----------------------------------------------------------
11443. Zone Processing Step:
11444. !ZoneStepByLine!    
11445. ----------------------------------------------------------
11446. Current Zone:
11447. !ZoneFooter!
11448. ----------------------------------------------------------
11449. Volume Statistics:
11450. !VolumeStatisticsDetail!
11451. ----------------------------------------------------------
11452. Zone Detailed Report:
11453. ----------------------------------------------------------
11454. !ZoneStatisticsDetail!
11455. ----------------------------------------------------------
11456. ")
11457. 
11458. 
11459. 
11460. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11461. 
11462. # BANNER SET
11463. 
11464. # DATE TIME RUN ELP
11465. 
11466. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
11467. /* Xinclude "..\BannerSet.MyDc"X */
11468. /* pause(1) */
11469. 
11470. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11471. 
11472. Title('!Heading!')
11473. /* pause(1) */
11474. 
11475. /* NOTE: Can't round or truncate to integer precision. */
11476. 
11477. pause(1)
11478. 	
11479. 	# ACTUAL GAP
11480. 		/* AddGap Variant. */
11481. 	  	# Zone Do Gap
11482. # Gap Calculation Methods:
11483. 
11484. /* 1) Anything you need to add first. */
11485. /* empty */
11486. 
11487. /* ---------------------------------------------------------- */
11488. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
11489. 	# GapRequestedStd.
11490. 
11491. 		/* ---------------------------------------------------------- */
11492. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
11493. 
11494. 		# Gap Calculation Methods:
11495. 
11496. /* AddGap Variants */
11497. 
11498. 	/* Standard */
11499. 		# Gap Calculation Methods:
11500. 	/* AddGap Variants */
11501. 	/* Standard */
11502. 
11503. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
11504. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
11505. 
11506. 	SetVariable(GapRequested, GapRequestedStd)
11507. 	
11508. 
11509. 	/* MFT Low High Method */
11510. 		# Gap Calculation Methods:
11511. 	/* AddGap Variants */
11512. 	/* MFT Low High Method */
11513. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
11514. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
11515. 	SetVariable(GapRequested, GapRequestedMft)
11516. 	
11517. 
11518. 	/* OS Volume Type Method */
11519. 		# Gap Calculation Methods:
11520. 	/* AddGap Variants */
11521. 	/* OS Volume Type Method */
11522. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
11523. 	SetVariable(GapRequested, GapRequestedOs)
11524. 
11525. 
11526. 
11527. /* MakeGap Variants */
11528. 
11529. 	/* Original Os 1-3 + MFT 2 */
11530. 		# Gap Calculation Methods:
11531. 	/* MakeGap Variants */
11532. 	/* Original Os 1-3 + MFT 2 */
11533. 	/* plus MFT gap placed inline at the dividing zone. */
11534. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
11535. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
11536. 	SetVariable(GapRequested, GapRequestedOrig)
11537. 	
11538. 	
11539. /* Note: You could comment out the ones not in use */
11540. /* However having the data in the log is useful. */
11541. /* Therefore the following line is otherwise needed. */
11542. 
11543. /* Standard used */
11544. 
11545. SetVariable(GapRequested, GapRequestedStd)
11546. 
11547. # Gap Calculation Methods:
11548. 
11549. /* AddGap Variants */
11550. 	/* Standard */
11551. 	/* MFT Low High Method */
11552. 	/* OS Volume Type Method */
11553. 
11554. /* MakeGap Variants */
11555. 	/* Original Os 1-3 + MFT 2 */
11556. 
11557. /* Note: You could comment out the ones not in use */
11558. /* However having the data in the log is useful. */
11559. /* Therefore the following line is otherwise needed. */
11560. 
11561. /* Standard is used currently */
11562. 
11563. 
11564. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
11565. 
11566. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
11567. 
11568. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
11569. 
11570. /* ---------------------------------------------------------- */
11571. /* 3) SMALL ZONE ADJUSTMENT. */
11572. /* Gab cant be larger than half the Zone Size. */
11573. 
11574. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
11575. 	
11576. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
11577. 
11578. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
11579. 
11580. /* ---------------------------------------------------------- */
11581. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
11582. # Gap Adjustments.
11583. 
11584. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
11585. 	
11586. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
11587. 
11588. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
11589. 
11590. /* ---------------------------------------------------------- */
11591. # BYPASS THIS.
11592. 	/* This is definitely wrong. */
11593. 	/* The question is can we steal gap from the next zone */
11594. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
11595. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
11596. 		# Zone Overflow.
11597. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
11598. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
11599. 
11600. /* ---------------------------------------------------------- */
11601. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
11602. # Remaining free space available.
11603. 
11604. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
11605. 	
11606. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
11607. 
11608. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
11609. 
11610. /* ---------------------------------------------------------- */
11611. # CURRENT gap to use.
11612. 
11613. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
11614. 
11615. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
11616. 
11617. /* ---------------------------------------------------------- */
11618. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
11619. # Debugging.
11620. 
11621. 	SetVariable(GapUsed, GapCurrent) // for debugging
11622. 
11623. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
11624. 
11625. 		# Your code HERE
11626. 
11627. /* ---------------------------------------------------------- */
11628. /* 7) YOUR CODE. */
11629. # YOUR CODE HERE:
11630. 	# INPUT: GapCurrent or GapCurrentLoc
11631. 	# OUTPUT: GapUsed...
11632. 
11633. /* ---------------------------------------------------------- */
11634. # Gap Size.
11635. # Actual Size of Gap.
11636. 
11637. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
11638. 
11639. /* ---------------------------------------------------------- */
11640. /* xxxxxxxxxxxxxxxxxxxxxx */
11641. # ADD THE GAP
11642. 	/* Xinclude "..\GapCommandDo.MyDc"X */
11643. /* xxxxxxxxxxxxxxxxxxxxxx */
11644. 
11645. 	
11646. 	# Zone Statistics	
11647. 	# Zone / Volume Statistics and Display
11648. 		
11649. 	# Accumulate Totals
11650.   	# Volume totals
11651. 
11652. /* Current total space used (by Zones and Gaps) */
11653. 
11654. SetVariable(VolumeZoneUsed, GapUsed)
11655. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
11656. /* Percentage */
11657. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
11658. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
11659. 
11660. /* Current total of free space requested */
11661. 
11662. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
11663. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
11664. /* Percent. */
11665. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
11666. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
11667. 
11668. /* Current total of free space used */
11669. 
11670. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
11671. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
11672. /* Percent */
11673. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
11674. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
11675. 
11676. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
11677. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
11678. /* Xinclude "..\DebugDisplayPause.MyDc"X */
11679. 
11680. 
11681. 	# Current Values
11682. 	# Cluster, Sector, Block adjust for display.
11683. 	# Bytes per cluster is volume specific.
11684. 
11685. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
11686. 
11687. # Current Zone values.
11688. 	# Begin, end and size.
11689. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
11690. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
11691. 
11692. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
11693. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
11694. 
11695. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
11696. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
11697. 
11698. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
11699. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
11700. 
11701. 	SetVariable(ZoneFragments,				"!ZONE210N!")
11702. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
11703. 		
11704. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
11705. /* identical code to here: (separation not needed. TEST.) */	
11706. 
11707. # Current Gap, Actual and Free Values
11708. 	# Gap
11709. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
11710. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
11711. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
11712. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
11713. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
11714. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
11715. 	
11716. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
11717. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
11718. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
11719. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
11720. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
11721. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
11722. 	
11723. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
11724. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
11725. 	
11726. 	# Actual Size and End
11727. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
11728. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
11729. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
11730. 	
11731. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
11732. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
11733. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
11734. 
11735. # Gap Size & Rounding
11736. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
11737. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
11738. 	
11739. 	# Free Space
11740. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
11741. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
11742. 
11743. 	# Footer:
11744. SetVariable(ZoneFooter, "----------------------------------------------------------
11745. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
11746. 
11747. Statistics Report:
11748. ------------------
11749.    Size:  
11750.    ------------------------
11751.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11752.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11753.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11754. 
11755.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11756.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11757. 
11758.    Location:
11759.    ------------------------
11760.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11761.              Files End: !ZoneEndCurrent!
11762.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11763.       
11764.    Gap Settings:
11765.    ------------------------
11766.          Gap Requested: !ZoneGapSizePer!%
11767.       Volume Rounding: !ZoneVolRoundUpPer!%
11768.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11769.                  
11770.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
11771.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
11772.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
11773.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
11774.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
11775.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
11776.      
11777.    Free Space after Zone:
11778.    ------------------------
11779.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11780.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11781.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11782. 
11783. Directory and Files Select:
11784. ---------------------------
11785. !ZoneTypeSelectCurrent!               
11786. ---------------------------
11787. ----------------------------------------------------------
11788. ")
11789. 	# Zone Footer Set Statistics Window Text
11790. 
11791. SetStatisticsWindowText("----------------------------------------------------------
11792. Zones Processed: 
11793. ----------------------------------------------------------
11794. !ZoneListByLine!
11795. ----------------------------------------------------------
11796. Zone Processing Step:
11797. !ZoneStepByLine!    
11798. ----------------------------------------------------------
11799. Current Zone:
11800. !ZoneFooter!
11801. ----------------------------------------------------------
11802. Volume Statistics:
11803. !VolumeStatisticsDetail!
11804. ----------------------------------------------------------
11805. Zone Detailed Report:
11806. ----------------------------------------------------------
11807. !ZoneStatisticsDetail!
11808. ----------------------------------------------------------
11809. ")
11810. 
11811. 
11812. 	
11813.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
11814. 
11815. 	# Add Zone to list of zones for display.
11816. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
11817. 
11818. 	# Footer:
11819. SetVariable(ZoneFooter, "----------------------------------------------------------
11820. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
11821. 
11822. Statistics Report:
11823. ------------------
11824.    Size:  
11825.    ------------------------
11826.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
11827.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
11828.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
11829. 
11830.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
11831.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
11832. 
11833.    Location:
11834.    ------------------------
11835.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
11836.              Files End: !ZoneEndCurrent!
11837.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
11838.       
11839.    Gap Settings:
11840.    ------------------------
11841.          Gap Requested: !ZoneGapSizePer!%
11842.       Volume Rounding: !ZoneVolRoundUpPer!%
11843.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
11844.                  
11845.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
11846.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
11847.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
11848.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
11849.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
11850.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
11851.      
11852.    Free Space after Zone:
11853.    ------------------------
11854.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
11855.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
11856.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
11857. 
11858. Directory and Files Select:
11859. ---------------------------
11860. !ZoneTypeSelectCurrent!               
11861. ---------------------------
11862. ----------------------------------------------------------
11863. ")
11864. 
11865. 	# Add Zone Details to Report.	
11866. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
11867. !ZoneFooter!")
11868. 
11869. 
11870. 
11871. 	# DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
11872. 		/* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
11873. 		/* Xinclude "..\DebugDisplayPause.MyDc"X */
11874. 
11875.   	# Zone Statistics	
11876.   	/* Xinclude "..\ZoneDoStatistics.MyDc"X */
11877. 
11878. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
11879. 	# FILE STEP
11880. 
11881. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11882. 
11883. /* add message and move to a new line. */
11884. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11885. ")
11886. 
11887. /* display the line. (hopefully.) */
11888. # Zone Footer Set Statistics Window Text
11889. 
11890. SetStatisticsWindowText("----------------------------------------------------------
11891. Zones Processed: 
11892. ----------------------------------------------------------
11893. !ZoneListByLine!
11894. ----------------------------------------------------------
11895. Zone Processing Step:
11896. !ZoneStepByLine!    
11897. ----------------------------------------------------------
11898. Current Zone:
11899. !ZoneFooter!
11900. ----------------------------------------------------------
11901. Volume Statistics:
11902. !VolumeStatisticsDetail!
11903. ----------------------------------------------------------
11904. Zone Detailed Report:
11905. ----------------------------------------------------------
11906. !ZoneStatisticsDetail!
11907. ----------------------------------------------------------
11908. ")
11909. 
11910. 
11911. 
11912. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11913. 
11914. # BANNER SET
11915. 
11916. # DATE TIME RUN ELP
11917. 
11918. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
11919. /* Xinclude "..\BannerSet.MyDc"X */
11920. /* pause(1) */
11921. 
11922. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11923. 
11924. Title('!Heading!')
11925. /* pause(1) */
11926. 
11927. /* NOTE: Can't round or truncate to integer precision. */
11928. 
11929. pause(1)
11930. 
11931. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
11932. 	
11933. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
11934. 	# FILE STEP
11935. 
11936. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
11937. 
11938. /* add message and move to a new line. */
11939. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
11940. ")
11941. 
11942. /* display the line. (hopefully.) */
11943. # Zone Footer Set Statistics Window Text
11944. 
11945. SetStatisticsWindowText("----------------------------------------------------------
11946. Zones Processed: 
11947. ----------------------------------------------------------
11948. !ZoneListByLine!
11949. ----------------------------------------------------------
11950. Zone Processing Step:
11951. !ZoneStepByLine!    
11952. ----------------------------------------------------------
11953. Current Zone:
11954. !ZoneFooter!
11955. ----------------------------------------------------------
11956. Volume Statistics:
11957. !VolumeStatisticsDetail!
11958. ----------------------------------------------------------
11959. Zone Detailed Report:
11960. ----------------------------------------------------------
11961. !ZoneStatisticsDetail!
11962. ----------------------------------------------------------
11963. ")
11964. 
11965. 
11966. 
11967. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
11968. 
11969. # BANNER SET
11970. 
11971. # DATE TIME RUN ELP
11972. 
11973. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
11974. /* Xinclude "..\BannerSet.MyDc"X */
11975. /* pause(1) */
11976. 
11977. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
11978. 
11979. Title('!Heading!')
11980. /* pause(1) */
11981. 
11982. /* NOTE: Can't round or truncate to integer precision. */
11983. 
11984. pause(1)
11985. 
11986. 	# Footer next...
11987. 	
11988. 	# Zone Do Footer
11989. 
11990. /* ---------------------------------------------------------- */
11991. # File Select
11992. 	# Select Statments
11993. # File Actions 
11994. 	# Standard or OS File Actions.
11995. 	# Resume...
11996. 	
11997. 	# your stuff HERE (X)... post zone (file) file actions code.
11998. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
11999. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
12000. 		# (X)
12001. 		
12002. 		/* ??? Set window? */
12003. 	
12004. 	# ADD THE GAP
12005. 		
12006. # Vacate (good for diagnostics)
12007. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
12008. 
12009. # DoNotVacate - DO NOT Vacate (recommended)
12010. 
12011. # Vacate
12012. /* AddGap(GapUsedLoc) */
12013. 
12014. # DO Not Vacate
12015. AddGap(GapUsedLoc, DoNotVacate) 
12016. 	
12017. 	
12018. /* ---------------------------------------------------------- */
12019. # (failed) TEST for boolean logic.
12020. 
12021. /* It should work in the gap calculations for turning options */
12022. /* on and off but it will NOT work here. */
12023. 
12024. /* Boolean setting X or FlagX. */
12025. /* Where X will be on or off: */
12026. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
12027. /*      For ON:  (X  *  FlagAny) */
12028. 
12029. /* 1) Failed, zero gap overrode the previous one. */
12030. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
12031. /* AddGap(GapUsedTemp) */ 
12032. 
12033. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
12034. /* AddGap(GapUsedTemp, DoNotVacate) */ 
12035. 
12036. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
12037. 
12038. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
12039. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
12040. /* AddGap(GapUsedTemp) */ 
12041. 
12042. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
12043. /* AddGap(GapUsedTemp, DoNotVacate) */ 
12044. 
12045. /* ---------------------------------------------------------- */
12046. 
12047. # Vacate
12048. /* AddGap(GapUsed) */
12049. 
12050. # DO NOT Vacate (recommended)
12051. /* AddGap(GapUsed, DoNotVacate) */ 
12052. 	
12053. 
12054. 		
12055. # 
12056. FileEnd
12057. /* ---------------------------------------------------------- */
12058. 
12059. # your stuff HERE (X)... post zone (file) code.
12060. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
12061. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
12062. 	# (X)
12063. 
12064. SetVariable(FileStepDescription,"Zone finished, reporting.")
12065. # FILE STEP
12066. 
12067. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12068. 
12069. /* add message and move to a new line. */
12070. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12071. ")
12072. 
12073. /* display the line. (hopefully.) */
12074. # Zone Footer Set Statistics Window Text
12075. 
12076. SetStatisticsWindowText("----------------------------------------------------------
12077. Zones Processed: 
12078. ----------------------------------------------------------
12079. !ZoneListByLine!
12080. ----------------------------------------------------------
12081. Zone Processing Step:
12082. !ZoneStepByLine!    
12083. ----------------------------------------------------------
12084. Current Zone:
12085. !ZoneFooter!
12086. ----------------------------------------------------------
12087. Volume Statistics:
12088. !VolumeStatisticsDetail!
12089. ----------------------------------------------------------
12090. Zone Detailed Report:
12091. ----------------------------------------------------------
12092. !ZoneStatisticsDetail!
12093. ----------------------------------------------------------
12094. ")
12095. 
12096. 
12097. 
12098. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12099. 
12100. # BANNER SET
12101. 
12102. # DATE TIME RUN ELP
12103. 
12104. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
12105. /* Xinclude "..\BannerSet.MyDc"X */
12106. /* pause(1) */
12107. 
12108. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12109. 
12110. Title('!Heading!')
12111. /* pause(1) */
12112. 
12113. /* NOTE: Can't round or truncate to integer precision. */
12114. 
12115. pause(1)
12116. 
12117. # Zone When Finished
12118. 
12119. # BANNER SET
12120. 
12121. # DATE TIME RUN ELP
12122. 
12123. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
12124. /* Xinclude "..\BannerSet.MyDc"X */
12125. /* pause(1) */
12126. 
12127. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12128. 
12129. Title('!Heading!')
12130. /* pause(1) */
12131. 
12132. /* NOTE: Can't round or truncate to integer precision. */
12133. 
12134. AppendLogfile("!LogFileName!", "!Title!")
12135. 
12136. 
12137. 
12138. # Zone Statistics	
12139. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
12140. 
12141. # Footer:
12142. SetVariable(ZoneFooter, "----------------------------------------------------------
12143. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
12144. 
12145. Statistics Report:
12146. ------------------
12147.    Size:  
12148.    ------------------------
12149.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12150.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12151.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12152. 
12153.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12154.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12155. 
12156.    Location:
12157.    ------------------------
12158.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12159.              Files End: !ZoneEndCurrent!
12160.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12161.       
12162.    Gap Settings:
12163.    ------------------------
12164.          Gap Requested: !ZoneGapSizePer!%
12165.       Volume Rounding: !ZoneVolRoundUpPer!%
12166.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12167.                  
12168.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
12169.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
12170.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
12171.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
12172.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
12173.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
12174.      
12175.    Free Space after Zone:
12176.    ------------------------
12177.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12178.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12179.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12180. 
12181. Directory and Files Select:
12182. ---------------------------
12183. !ZoneTypeSelectCurrent!               
12184. ---------------------------
12185. ----------------------------------------------------------
12186. ")
12187. 
12188. AppendLogfile("!LogFileName!", ".")
12189. AppendLogfile("!LogFileName!", "!ZoneFooter!")
12190. AppendLogfile("!LogFileName!", ".")
12191. 
12192. # Zone Footer Set Statistics Window Text
12193. 
12194. SetStatisticsWindowText("----------------------------------------------------------
12195. Zones Processed: 
12196. ----------------------------------------------------------
12197. !ZoneListByLine!
12198. ----------------------------------------------------------
12199. Zone Processing Step:
12200. !ZoneStepByLine!    
12201. ----------------------------------------------------------
12202. Current Zone:
12203. !ZoneFooter!
12204. ----------------------------------------------------------
12205. Volume Statistics:
12206. !VolumeStatisticsDetail!
12207. ----------------------------------------------------------
12208. Zone Detailed Report:
12209. ----------------------------------------------------------
12210. !ZoneStatisticsDetail!
12211. ----------------------------------------------------------
12212. ")
12213. 
12214. 
12215. 
12216. /* pause() */
12217. /* pause() */
12218. 
12219. 
12220. 
12221. 
12222. /* ---------------------------------------------------------- */
12223. 
12224. /* ---------------------------------------------------------- */
12225. /* Zone DevToDo */
12226. /* ---------------------------------------------------------- */
12227. /* Zone DevToDo */
12228. 
12229. SetVariable(ZoneLabel, "!ZoneLabelDevToDo!")
12230. SetVariable(ZoneDescription, "!ZoneDescriptionDevToDo!")
12231. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpDevToDo!")
12232. SetVariable(ZoneGapSize, "!ZoneGapSizeDevToDo!")
12233. SetVariable(ZoneTypeSelect,'# DevToDo start.
12234. # NotBlobsArchivesBu start.
12235. (not (
12236. # Blobs start.
12237. (
12238. # BlobsAndExceptions start.
12239. ( not(
12240.   FileName("*.bat")
12241.   or FileName("*.css")
12242.   or FileName("*.dll")
12243.   or FileName("*.exe")
12244.   or FileName("*.htm*")
12245.   or FileName("*.jar")
12246.   or FileName("*.js")
12247.   or FileName("*.script")
12248.   or FileName("*.wsf")
12249.   or (
12250. # Databases start.
12251. (
12252.   FileName("*.crypt*")
12253.   or FileName("*.db*")
12254.   or FileName("*.rdb*")
12255.   or FileName("*.dc*")
12256.   or FileName("*.dict*")
12257.   or FileName("*.?db*")
12258.   or FileName("*.?rdb*")
12259.   or FileName("*.md*")
12260.   or FileName("*.myd")
12261.   or FileName("*.ndf")
12262.   or FileName("*.ns?")
12263.   or FileName("*.pab")
12264.   or FileName("*.pst")
12265.   or FileName("*.sd?*")
12266.   or FileName("*.sq**")
12267.   or FileName("*.tmd")
12268.   or FileName("*.tps")
12269.   or FileName("*.tr*")
12270. )
12271. # Databases end.
12272. 
12273.     # BlobsAndExceptions
12274.     or 
12275. # Data start.
12276. (
12277.   DirectoryName("Data*")
12278.   or DirectoryName("Device*")
12279.   or DirectoryName("Export*")
12280.   or DirectoryName("Import*")
12281.   or DirectoryName("Log*")
12282.   or DirectoryName("*Log")
12283.   or DirectoryName("Maintenance*")
12284.   or DirectoryName("Rec*")
12285.   or DirectoryName("Sales*")
12286.   or DirectoryName("Search*")
12287.   or DirectoryName("User*")
12288. )
12289. # Data end.
12290. 
12291.     # BlobsAndExceptions
12292.   )
12293. ) )
12294. # BlobsAndExceptions end.
12295. 
12296. # Blobs
12297. ) and (
12298.   Size(BlobFileSize,0)
12299.   or (
12300.     FileName("*.arj")
12301.     or FileName("*.bup")
12302.     or FileName("*.bz2")
12303.     or FileName("*.chm")
12304.     or FileName("*.dvr-ms")
12305.     or FileName("*.gz")
12306.     or FileName("*.ifo")
12307.     or FileName("*.lzh")
12308.     or FileName("*.pdf")
12309.     or FileName("*.rpm")
12310.     or FileName("*.wmv")
12311.     or FileName("*.vob")
12312.     or FileName("*.z")
12313.   ) 
12314. )
12315. # Blobs end.
12316. 
12317. # NotBlobsArchivesBu
12318. or 
12319. # Archives start.
12320. (
12321.   DirectoryName("*Archive*")
12322.   or DirectoryName("*History*")
12323.   or DirectoryName("*Old")
12324.   or DirectoryName("* Old *")
12325.   or DirectoryName("Old *")
12326. 
12327.   or FileName("*.7z")
12328.   or FileName("*.cab")
12329.   or FileName("*.iso")
12330.   or FileName("*.msi")
12331.   or FileName("*.old")
12332.   or FileName("*.rar")
12333.   or FileName("*.tar")
12334.   or FileName("*.zip")
12335.   or
12336. # WinSysLow start.
12337. (
12338.   DirectoryName("$*")
12339.   or DirectoryName("0*")
12340.   or DirectoryName("1*")
12341.   or DirectoryName("2*")
12342.   or DirectoryName("3*")
12343.   or DirectoryName("4*")
12344.   or DirectoryName("5*")
12345.   or DirectoryName("6*")
12346.   or DirectoryName("7*")
12347.   or DirectoryName("8*")
12348.   or DirectoryName("9*")
12349. 
12350.   or DirectoryName("dllcache")
12351.   or DirectoryName("Downloaded Installations")
12352.   or DirectoryName("Ehome")
12353.   or DirectoryName("Fonts")
12354.   or DirectoryName("Help")
12355.   or DirectoryName("I386")
12356.   or DirectoryName("ie?updates")
12357.   or DirectoryName("Installer")
12358.   or DirectoryName("Installshield Installation Information")
12359.   or DirectoryName("IME")
12360.   or DirectoryName("*RECYCLE*")
12361.   or DirectoryName("ServicePackFiles")
12362.   or DirectoryName("SoftwareDistribution")
12363.   or DirectoryName("Speech")
12364.   or DirectoryName("Symbols")
12365.   or DirectoryName("System Volume Information")
12366.   or DirectoryName("windows.old")
12367. )
12368. # WinSysLow end.
12369. 
12370.   # Archives
12371. )
12372. # Archives end.
12373. 
12374. # NotBlobsArchivesBu
12375. or
12376. # Backups start.
12377. (
12378.   DirectoryName("*Backup*")
12379.   or DirectoryName("*Bu")
12380.   or DirectoryName("* Bu *")
12381.   or DirectoryName("Bu *")
12382. 
12383.   or FileName("*.bak")
12384.   or FileName("* - Copy*")
12385. )
12386. # Backups end.
12387. 
12388. # NotBlobsArchivesBu
12389. ) )
12390. # NotBlobsArchivesBu end.
12391. 
12392. # DevToDo
12393. and ( 
12394. # Dev start.
12395. (
12396.   DirectoryName("*Dev") 
12397.   or DirectoryName("Dev *") 
12398.   or DirectoryName("*Development*") 
12399.   or DirectoryName("DsVs*") 
12400.   or DirectoryName("Srt*") 
12401. )
12402. # Dev end.
12403. 
12404. # DevToDo
12405. or 
12406. # ToDo start.
12407. (
12408.   DirectoryName("*ToDo*")
12409. )
12410. # ToDo end.
12411. 
12412. # DevToDo
12413. )
12414. # DevToDo end.
12415. ')
12416. 
12417. 	# Zone Do Header
12418. 
12419. # Zone When Started
12420. 
12421. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
12422. # Display Set Zone
12423. 
12424. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
12425. SetVariable(FileStepDescription,	"")
12426. 
12427. SetVariable(ZoneStepByLine, 			"Zone started.
12428. ")
12429. 
12430. # BANNER SET
12431. 
12432. # DATE TIME RUN ELP
12433. 
12434. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
12435. /* Xinclude "..\BannerSet.MyDc"X */
12436. /* pause(1) */
12437. 
12438. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12439. 
12440. Title('!Heading!')
12441. /* pause(1) */
12442. 
12443. /* NOTE: Can't round or truncate to integer precision. */
12444. 
12445. AppendLogfile("!LogFileName!", "!Title!")
12446. 
12447. 
12448. 
12449. pause(1)
12450. 
12451. 
12452. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
12453. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
12454. 
12455. SetVariable(ZoneStepNoCurrent, 0)
12456. 
12457. 
12458. # Zone Do Current Clear
12459. 
12460. SetVariable(ZoneTypeSelectCurrent, 		"")
12461. 
12462. SetVariable(ZoneBeginCurrent, 			0)
12463. SetVariable(ZoneBeginPerCurrent, 		0)
12464. SetVariable(ZoneEndCurrent, 			0)
12465. SetVariable(ZoneEndPerCurrent, 			0)
12466. 
12467. SetVariable(ZoneSizeCurrent,			0)
12468. SetVariable(ZoneSizePerCurrent,			0)
12469. 
12470. SetVariable(ZoneGapRequestedCurrent,	0)
12471. SetVariable(ZoneGapRoundedCurrent, 		0)
12472. SetVariable(ZoneGapAdjustedCurrent, 	0)
12473. SetVariable(ZoneGapAvailableCurrent, 	0)
12474. SetVariable(ZoneGapCurrent,				0)
12475. SetVariable(ZoneGapUsedCurrent, 		0)
12476. 
12477. SetVariable(ZoneGapActualCurrent, 		0)
12478. SetVariable(ZoneGapActualPerCurrent, 	0)
12479. 
12480. SetVariable(ZoneSizeActual, 			0)
12481. SetVariable(ZoneSizeActualCurrent,		0)
12482. 
12483. SetVariable(ZoneEndActual, 				0)
12484. SetVariable(ZoneEndActualCurrent,		0)			
12485. SetVariable(ZoneSizeActualPerCurrent, 	0)
12486.       
12487. SetVariable(ZoneFilesFolders,			0)
12488. SetVariable(ZoneFilesFoldersPer,		0) 
12489. 
12490. SetVariable(ZoneFragments,				0)
12491. SetVariable(ZoneFragmentsPer,			0) 
12492. 		
12493. SetVariable(ZoneEndActualCurrent, 		0)
12494. SetVariable(ZoneEndActualPerCurrent, 	0)
12495. 
12496. # Gap Calculation Methodology:
12497. 	# Requested
12498. 	SetVariable(GapRequested, 			0) 
12499. 	SetVariable(GapRequestedStd, 		0) 
12500. 	SetVariable(GapRequestedMft, 		0) 
12501. 	SetVariable(GapRequestedOs, 		0) 
12502. 	SetVariable(GapRequestedOriginal, 	0) 
12503. 	
12504. 	# Gap Adjustments
12505. 	SetVariable(GapRounded, 			0)
12506. 	# SetVariable(GapAdjusted, 			0)
12507. 	SetVariable(GapAvailable, 			0)
12508. 	SetVariable(GapCurrent, 			0)
12509. 	SetVariable(GapActual, 				0)
12510. 	SetVariable(GapUsed, 				0)
12511. 	
12512. 	# Gap Adjustments
12513. 	SetVariable(GapRoundedLoc, 			0)
12514. 	# SetVariable(GapAdjustedLoc, 		0)
12515. 	SetVariable(GapAvailableLoc, 		0)
12516. 	SetVariable(GapCurrentLoc, 			0)
12517. 	SetVariable(GapActualLoc,			0)
12518. 	SetVariable(GapUsedLoc,				0)
12519. 	
12520. 	# Space usage
12521. 	SetVariable(ZoneFreePerRequested, 	0)
12522. 	SetVariable(ZoneFreePerUsed, 		0)
12523. 
12524. # Gap Size & Rounding
12525. 	SetVariable(ZoneGapSizePer, 		0)
12526. 	SetVariable(ZoneVolRoundUpPer, 		0)
12527. 	
12528. 	# Free Space
12529. 	SetVariable(ZoneFreeUsedPer, 		0)
12530. 	SetVariable(ZoneFreeRequestedPer, 	0)
12531. 
12532. 
12533. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
12534. 
12535. # Footer:
12536. SetVariable(ZoneFooter, "----------------------------------------------------------
12537. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
12538. 
12539. Statistics Report:
12540. ------------------
12541.    Size:  
12542.    ------------------------
12543.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
12544.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
12545.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
12546. 
12547.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
12548.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
12549. 
12550.    Location:
12551.    ------------------------
12552.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
12553.              Files End: !ZoneEndCurrent!
12554.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
12555.       
12556.    Gap Settings:
12557.    ------------------------
12558.          Gap Requested: !ZoneGapSizePer!%
12559.       Volume Rounding: !ZoneVolRoundUpPer!%
12560.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
12561.                  
12562.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
12563.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
12564.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
12565.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
12566.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
12567.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
12568.      
12569.    Free Space after Zone:
12570.    ------------------------
12571.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
12572.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
12573.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
12574. 
12575. Directory and Files Select:
12576. ---------------------------
12577. !ZoneTypeSelectCurrent!               
12578. ---------------------------
12579. ----------------------------------------------------------
12580. ")
12581. 
12582. # BANNER SET
12583. 
12584. # DATE TIME RUN ELP
12585. 
12586. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
12587. /* Xinclude "..\BannerSet.MyDc"X */
12588. /* pause(1) */
12589. 
12590. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12591. 
12592. Title('!Heading!')
12593. /* pause(1) */
12594. 
12595. /* NOTE: Can't round or truncate to integer precision. */
12596. 
12597. AppendLogfile("!LogFileName!", "!Title!")
12598. 
12599. 
12600. 
12601. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
12602. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
12603. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:16")
12604. 
12605. SetVariable(ZoneListByLine, "!ZoneListByLine!
12606. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
12607. 
12608. 
12609. /* Fixed Zone Position Handling */
12610. /* Literal number: */
12611. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
12612. /* Percentage of disk: */
12613. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
12614. /* Gap */
12615. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
12616. 
12617. /* ---------------------------------------------------------- */
12618. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
12619. # FILE STEP
12620. 
12621. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12622. 
12623. /* add message and move to a new line. */
12624. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12625. ")
12626. 
12627. /* display the line. (hopefully.) */
12628. # Zone Footer Set Statistics Window Text
12629. 
12630. SetStatisticsWindowText("----------------------------------------------------------
12631. Zones Processed: 
12632. ----------------------------------------------------------
12633. !ZoneListByLine!
12634. ----------------------------------------------------------
12635. Zone Processing Step:
12636. !ZoneStepByLine!    
12637. ----------------------------------------------------------
12638. Current Zone:
12639. !ZoneFooter!
12640. ----------------------------------------------------------
12641. Volume Statistics:
12642. !VolumeStatisticsDetail!
12643. ----------------------------------------------------------
12644. Zone Detailed Report:
12645. ----------------------------------------------------------
12646. !ZoneStatisticsDetail!
12647. ----------------------------------------------------------
12648. ")
12649. 
12650. 
12651. 
12652. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12653. 
12654. # BANNER SET
12655. 
12656. # DATE TIME RUN ELP
12657. 
12658. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
12659. /* Xinclude "..\BannerSet.MyDc"X */
12660. /* pause(1) */
12661. 
12662. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12663. 
12664. Title('!Heading!')
12665. /* pause(1) */
12666. 
12667. /* NOTE: Can't round or truncate to integer precision. */
12668. 
12669. pause(1)
12670. 
12671. # your stuff HERE (X)... pre file select code.
12672. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
12673. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
12674. 	# (X)
12675. 
12676. FileSelect
12677. 
12678. 	# your stuff can't really go here (errors.)
12679. 	# maybe for some reason I don't know of...
12680. 	
12681. 	# Actions next...
12682. 	# DevToDo start.
12683. # NotBlobsArchivesBu start.
12684. (not (
12685. # Blobs start.
12686. (
12687. # BlobsAndExceptions start.
12688. ( not(
12689.   FileName("*.bat")
12690.   or FileName("*.css")
12691.   or FileName("*.dll")
12692.   or FileName("*.exe")
12693.   or FileName("*.htm*")
12694.   or FileName("*.jar")
12695.   or FileName("*.js")
12696.   or FileName("*.script")
12697.   or FileName("*.wsf")
12698.   or (
12699. # Databases start.
12700. (
12701.   FileName("*.crypt*")
12702.   or FileName("*.db*")
12703.   or FileName("*.rdb*")
12704.   or FileName("*.dc*")
12705.   or FileName("*.dict*")
12706.   or FileName("*.?db*")
12707.   or FileName("*.?rdb*")
12708.   or FileName("*.md*")
12709.   or FileName("*.myd")
12710.   or FileName("*.ndf")
12711.   or FileName("*.ns?")
12712.   or FileName("*.pab")
12713.   or FileName("*.pst")
12714.   or FileName("*.sd?*")
12715.   or FileName("*.sq**")
12716.   or FileName("*.tmd")
12717.   or FileName("*.tps")
12718.   or FileName("*.tr*")
12719. )
12720. # Databases end.
12721. 
12722.     # BlobsAndExceptions
12723.     or 
12724. # Data start.
12725. (
12726.   DirectoryName("Data*")
12727.   or DirectoryName("Device*")
12728.   or DirectoryName("Export*")
12729.   or DirectoryName("Import*")
12730.   or DirectoryName("Log*")
12731.   or DirectoryName("*Log")
12732.   or DirectoryName("Maintenance*")
12733.   or DirectoryName("Rec*")
12734.   or DirectoryName("Sales*")
12735.   or DirectoryName("Search*")
12736.   or DirectoryName("User*")
12737. )
12738. # Data end.
12739. 
12740.     # BlobsAndExceptions
12741.   )
12742. ) )
12743. # BlobsAndExceptions end.
12744. 
12745. # Blobs
12746. ) and (
12747.   Size(BlobFileSize,0)
12748.   or (
12749.     FileName("*.arj")
12750.     or FileName("*.bup")
12751.     or FileName("*.bz2")
12752.     or FileName("*.chm")
12753.     or FileName("*.dvr-ms")
12754.     or FileName("*.gz")
12755.     or FileName("*.ifo")
12756.     or FileName("*.lzh")
12757.     or FileName("*.pdf")
12758.     or FileName("*.rpm")
12759.     or FileName("*.wmv")
12760.     or FileName("*.vob")
12761.     or FileName("*.z")
12762.   ) 
12763. )
12764. # Blobs end.
12765. 
12766. # NotBlobsArchivesBu
12767. or 
12768. # Archives start.
12769. (
12770.   DirectoryName("*Archive*")
12771.   or DirectoryName("*History*")
12772.   or DirectoryName("*Old")
12773.   or DirectoryName("* Old *")
12774.   or DirectoryName("Old *")
12775. 
12776.   or FileName("*.7z")
12777.   or FileName("*.cab")
12778.   or FileName("*.iso")
12779.   or FileName("*.msi")
12780.   or FileName("*.old")
12781.   or FileName("*.rar")
12782.   or FileName("*.tar")
12783.   or FileName("*.zip")
12784.   or
12785. # WinSysLow start.
12786. (
12787.   DirectoryName("$*")
12788.   or DirectoryName("0*")
12789.   or DirectoryName("1*")
12790.   or DirectoryName("2*")
12791.   or DirectoryName("3*")
12792.   or DirectoryName("4*")
12793.   or DirectoryName("5*")
12794.   or DirectoryName("6*")
12795.   or DirectoryName("7*")
12796.   or DirectoryName("8*")
12797.   or DirectoryName("9*")
12798. 
12799.   or DirectoryName("dllcache")
12800.   or DirectoryName("Downloaded Installations")
12801.   or DirectoryName("Ehome")
12802.   or DirectoryName("Fonts")
12803.   or DirectoryName("Help")
12804.   or DirectoryName("I386")
12805.   or DirectoryName("ie?updates")
12806.   or DirectoryName("Installer")
12807.   or DirectoryName("Installshield Installation Information")
12808.   or DirectoryName("IME")
12809.   or DirectoryName("*RECYCLE*")
12810.   or DirectoryName("ServicePackFiles")
12811.   or DirectoryName("SoftwareDistribution")
12812.   or DirectoryName("Speech")
12813.   or DirectoryName("Symbols")
12814.   or DirectoryName("System Volume Information")
12815.   or DirectoryName("windows.old")
12816. )
12817. # WinSysLow end.
12818. 
12819.   # Archives
12820. )
12821. # Archives end.
12822. 
12823. # NotBlobsArchivesBu
12824. or
12825. # Backups start.
12826. (
12827.   DirectoryName("*Backup*")
12828.   or DirectoryName("*Bu")
12829.   or DirectoryName("* Bu *")
12830.   or DirectoryName("Bu *")
12831. 
12832.   or FileName("*.bak")
12833.   or FileName("* - Copy*")
12834. )
12835. # Backups end.
12836. 
12837. # NotBlobsArchivesBu
12838. ) )
12839. # NotBlobsArchivesBu end.
12840. 
12841. # DevToDo
12842. and ( 
12843. # Dev start.
12844. (
12845.   DirectoryName("*Dev") 
12846.   or DirectoryName("Dev *") 
12847.   or DirectoryName("*Development*") 
12848.   or DirectoryName("DsVs*") 
12849.   or DirectoryName("Srt*") 
12850. )
12851. # Dev end.
12852. 
12853. # DevToDo
12854. or 
12855. # ToDo start.
12856. (
12857.   DirectoryName("*ToDo*")
12858. )
12859. # ToDo end.
12860. 
12861. # DevToDo
12862. )
12863. # DevToDo end.
12864. 
12865. 	# Zone
12866. # File Select
12867. 	# File Booleans
12868. 	# Resume...
12869. # File Action - SortByName.
12870. 
12871. FileActions
12872. 
12873. 		/* ---------------------------------------------------------- */
12874. 	# Gap
12875. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
12876. 		# FILE STEP
12877. 
12878. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
12879. 
12880. /* add message and move to a new line. */
12881. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
12882. ")
12883. 
12884. /* display the line. (hopefully.) */
12885. # Zone Footer Set Statistics Window Text
12886. 
12887. SetStatisticsWindowText("----------------------------------------------------------
12888. Zones Processed: 
12889. ----------------------------------------------------------
12890. !ZoneListByLine!
12891. ----------------------------------------------------------
12892. Zone Processing Step:
12893. !ZoneStepByLine!    
12894. ----------------------------------------------------------
12895. Current Zone:
12896. !ZoneFooter!
12897. ----------------------------------------------------------
12898. Volume Statistics:
12899. !VolumeStatisticsDetail!
12900. ----------------------------------------------------------
12901. Zone Detailed Report:
12902. ----------------------------------------------------------
12903. !ZoneStatisticsDetail!
12904. ----------------------------------------------------------
12905. ")
12906. 
12907. 
12908. 
12909. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
12910. 
12911. # BANNER SET
12912. 
12913. # DATE TIME RUN ELP
12914. 
12915. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
12916. /* Xinclude "..\BannerSet.MyDc"X */
12917. /* pause(1) */
12918. 
12919. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
12920. 
12921. Title('!Heading!')
12922. /* pause(1) */
12923. 
12924. /* NOTE: Can't round or truncate to integer precision. */
12925. 
12926. pause(1)
12927. 	
12928. 	# ACTUAL GAP
12929. 		/* AddGap Variant. */
12930. 	  	# Zone Do Gap
12931. # Gap Calculation Methods:
12932. 
12933. /* 1) Anything you need to add first. */
12934. /* empty */
12935. 
12936. /* ---------------------------------------------------------- */
12937. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
12938. 	# GapRequestedStd.
12939. 
12940. 		/* ---------------------------------------------------------- */
12941. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
12942. 
12943. 		# Gap Calculation Methods:
12944. 
12945. /* AddGap Variants */
12946. 
12947. 	/* Standard */
12948. 		# Gap Calculation Methods:
12949. 	/* AddGap Variants */
12950. 	/* Standard */
12951. 
12952. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
12953. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
12954. 
12955. 	SetVariable(GapRequested, GapRequestedStd)
12956. 	
12957. 
12958. 	/* MFT Low High Method */
12959. 		# Gap Calculation Methods:
12960. 	/* AddGap Variants */
12961. 	/* MFT Low High Method */
12962. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
12963. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
12964. 	SetVariable(GapRequested, GapRequestedMft)
12965. 	
12966. 
12967. 	/* OS Volume Type Method */
12968. 		# Gap Calculation Methods:
12969. 	/* AddGap Variants */
12970. 	/* OS Volume Type Method */
12971. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
12972. 	SetVariable(GapRequested, GapRequestedOs)
12973. 
12974. 
12975. 
12976. /* MakeGap Variants */
12977. 
12978. 	/* Original Os 1-3 + MFT 2 */
12979. 		# Gap Calculation Methods:
12980. 	/* MakeGap Variants */
12981. 	/* Original Os 1-3 + MFT 2 */
12982. 	/* plus MFT gap placed inline at the dividing zone. */
12983. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
12984. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
12985. 	SetVariable(GapRequested, GapRequestedOrig)
12986. 	
12987. 	
12988. /* Note: You could comment out the ones not in use */
12989. /* However having the data in the log is useful. */
12990. /* Therefore the following line is otherwise needed. */
12991. 
12992. /* Standard used */
12993. 
12994. SetVariable(GapRequested, GapRequestedStd)
12995. 
12996. # Gap Calculation Methods:
12997. 
12998. /* AddGap Variants */
12999. 	/* Standard */
13000. 	/* MFT Low High Method */
13001. 	/* OS Volume Type Method */
13002. 
13003. /* MakeGap Variants */
13004. 	/* Original Os 1-3 + MFT 2 */
13005. 
13006. /* Note: You could comment out the ones not in use */
13007. /* However having the data in the log is useful. */
13008. /* Therefore the following line is otherwise needed. */
13009. 
13010. /* Standard is used currently */
13011. 
13012. 
13013. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
13014. 
13015. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
13016. 
13017. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
13018. 
13019. /* ---------------------------------------------------------- */
13020. /* 3) SMALL ZONE ADJUSTMENT. */
13021. /* Gab cant be larger than half the Zone Size. */
13022. 
13023. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
13024. 	
13025. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
13026. 
13027. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
13028. 
13029. /* ---------------------------------------------------------- */
13030. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
13031. # Gap Adjustments.
13032. 
13033. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
13034. 	
13035. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
13036. 
13037. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
13038. 
13039. /* ---------------------------------------------------------- */
13040. # BYPASS THIS.
13041. 	/* This is definitely wrong. */
13042. 	/* The question is can we steal gap from the next zone */
13043. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
13044. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
13045. 		# Zone Overflow.
13046. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
13047. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
13048. 
13049. /* ---------------------------------------------------------- */
13050. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
13051. # Remaining free space available.
13052. 
13053. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
13054. 	
13055. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
13056. 
13057. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
13058. 
13059. /* ---------------------------------------------------------- */
13060. # CURRENT gap to use.
13061. 
13062. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
13063. 
13064. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
13065. 
13066. /* ---------------------------------------------------------- */
13067. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
13068. # Debugging.
13069. 
13070. 	SetVariable(GapUsed, GapCurrent) // for debugging
13071. 
13072. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
13073. 
13074. 		# Your code HERE
13075. 
13076. /* ---------------------------------------------------------- */
13077. /* 7) YOUR CODE. */
13078. # YOUR CODE HERE:
13079. 	# INPUT: GapCurrent or GapCurrentLoc
13080. 	# OUTPUT: GapUsed...
13081. 
13082. /* ---------------------------------------------------------- */
13083. # Gap Size.
13084. # Actual Size of Gap.
13085. 
13086. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
13087. 
13088. /* ---------------------------------------------------------- */
13089. /* xxxxxxxxxxxxxxxxxxxxxx */
13090. # ADD THE GAP
13091. 	/* Xinclude "..\GapCommandDo.MyDc"X */
13092. /* xxxxxxxxxxxxxxxxxxxxxx */
13093. 
13094. 	
13095. 	# Zone Statistics	
13096. 	# Zone / Volume Statistics and Display
13097. 		
13098. 	# Accumulate Totals
13099.   	# Volume totals
13100. 
13101. /* Current total space used (by Zones and Gaps) */
13102. 
13103. SetVariable(VolumeZoneUsed, GapUsed)
13104. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
13105. /* Percentage */
13106. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
13107. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
13108. 
13109. /* Current total of free space requested */
13110. 
13111. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
13112. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
13113. /* Percent. */
13114. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
13115. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
13116. 
13117. /* Current total of free space used */
13118. 
13119. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
13120. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
13121. /* Percent */
13122. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
13123. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
13124. 
13125. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
13126. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
13127. /* Xinclude "..\DebugDisplayPause.MyDc"X */
13128. 
13129. 
13130. 	# Current Values
13131. 	# Cluster, Sector, Block adjust for display.
13132. 	# Bytes per cluster is volume specific.
13133. 
13134. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
13135. 
13136. # Current Zone values.
13137. 	# Begin, end and size.
13138. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
13139. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
13140. 
13141. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
13142. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
13143. 
13144. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
13145. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
13146. 
13147. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
13148. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
13149. 
13150. 	SetVariable(ZoneFragments,				"!ZONE210N!")
13151. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
13152. 		
13153. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
13154. /* identical code to here: (separation not needed. TEST.) */	
13155. 
13156. # Current Gap, Actual and Free Values
13157. 	# Gap
13158. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
13159. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
13160. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
13161. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
13162. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
13163. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
13164. 	
13165. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
13166. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
13167. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
13168. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
13169. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
13170. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
13171. 	
13172. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
13173. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
13174. 	
13175. 	# Actual Size and End
13176. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
13177. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
13178. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
13179. 	
13180. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
13181. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
13182. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
13183. 
13184. # Gap Size & Rounding
13185. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
13186. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
13187. 	
13188. 	# Free Space
13189. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
13190. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
13191. 
13192. 	# Footer:
13193. SetVariable(ZoneFooter, "----------------------------------------------------------
13194. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
13195. 
13196. Statistics Report:
13197. ------------------
13198.    Size:  
13199.    ------------------------
13200.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13201.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13202.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13203. 
13204.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13205.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13206. 
13207.    Location:
13208.    ------------------------
13209.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13210.              Files End: !ZoneEndCurrent!
13211.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13212.       
13213.    Gap Settings:
13214.    ------------------------
13215.          Gap Requested: !ZoneGapSizePer!%
13216.       Volume Rounding: !ZoneVolRoundUpPer!%
13217.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13218.                  
13219.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
13220.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
13221.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
13222.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
13223.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
13224.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
13225.      
13226.    Free Space after Zone:
13227.    ------------------------
13228.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13229.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13230.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13231. 
13232. Directory and Files Select:
13233. ---------------------------
13234. !ZoneTypeSelectCurrent!               
13235. ---------------------------
13236. ----------------------------------------------------------
13237. ")
13238. 	# Zone Footer Set Statistics Window Text
13239. 
13240. SetStatisticsWindowText("----------------------------------------------------------
13241. Zones Processed: 
13242. ----------------------------------------------------------
13243. !ZoneListByLine!
13244. ----------------------------------------------------------
13245. Zone Processing Step:
13246. !ZoneStepByLine!    
13247. ----------------------------------------------------------
13248. Current Zone:
13249. !ZoneFooter!
13250. ----------------------------------------------------------
13251. Volume Statistics:
13252. !VolumeStatisticsDetail!
13253. ----------------------------------------------------------
13254. Zone Detailed Report:
13255. ----------------------------------------------------------
13256. !ZoneStatisticsDetail!
13257. ----------------------------------------------------------
13258. ")
13259. 
13260. 
13261. 	
13262.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
13263. 
13264. 	# Add Zone to list of zones for display.
13265. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
13266. 
13267. 	# Footer:
13268. SetVariable(ZoneFooter, "----------------------------------------------------------
13269. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
13270. 
13271. Statistics Report:
13272. ------------------
13273.    Size:  
13274.    ------------------------
13275.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13276.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13277.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13278. 
13279.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13280.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13281. 
13282.    Location:
13283.    ------------------------
13284.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13285.              Files End: !ZoneEndCurrent!
13286.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13287.       
13288.    Gap Settings:
13289.    ------------------------
13290.          Gap Requested: !ZoneGapSizePer!%
13291.       Volume Rounding: !ZoneVolRoundUpPer!%
13292.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13293.                  
13294.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
13295.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
13296.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
13297.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
13298.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
13299.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
13300.      
13301.    Free Space after Zone:
13302.    ------------------------
13303.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13304.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13305.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13306. 
13307. Directory and Files Select:
13308. ---------------------------
13309. !ZoneTypeSelectCurrent!               
13310. ---------------------------
13311. ----------------------------------------------------------
13312. ")
13313. 
13314. 	# Add Zone Details to Report.	
13315. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
13316. !ZoneFooter!")
13317. 
13318. 
13319. 
13320. 	# DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
13321. 		/* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
13322. 		/* Xinclude "..\DebugDisplayPause.MyDc"X */
13323. 
13324.   	# Zone Statistics	
13325.   	/* Xinclude "..\ZoneDoStatistics.MyDc"X */
13326. 
13327. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
13328. 	# FILE STEP
13329. 
13330. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13331. 
13332. /* add message and move to a new line. */
13333. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13334. ")
13335. 
13336. /* display the line. (hopefully.) */
13337. # Zone Footer Set Statistics Window Text
13338. 
13339. SetStatisticsWindowText("----------------------------------------------------------
13340. Zones Processed: 
13341. ----------------------------------------------------------
13342. !ZoneListByLine!
13343. ----------------------------------------------------------
13344. Zone Processing Step:
13345. !ZoneStepByLine!    
13346. ----------------------------------------------------------
13347. Current Zone:
13348. !ZoneFooter!
13349. ----------------------------------------------------------
13350. Volume Statistics:
13351. !VolumeStatisticsDetail!
13352. ----------------------------------------------------------
13353. Zone Detailed Report:
13354. ----------------------------------------------------------
13355. !ZoneStatisticsDetail!
13356. ----------------------------------------------------------
13357. ")
13358. 
13359. 
13360. 
13361. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13362. 
13363. # BANNER SET
13364. 
13365. # DATE TIME RUN ELP
13366. 
13367. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
13368. /* Xinclude "..\BannerSet.MyDc"X */
13369. /* pause(1) */
13370. 
13371. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13372. 
13373. Title('!Heading!')
13374. /* pause(1) */
13375. 
13376. /* NOTE: Can't round or truncate to integer precision. */
13377. 
13378. pause(1)
13379. 
13380. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
13381. 	
13382. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
13383. 	# FILE STEP
13384. 
13385. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13386. 
13387. /* add message and move to a new line. */
13388. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13389. ")
13390. 
13391. /* display the line. (hopefully.) */
13392. # Zone Footer Set Statistics Window Text
13393. 
13394. SetStatisticsWindowText("----------------------------------------------------------
13395. Zones Processed: 
13396. ----------------------------------------------------------
13397. !ZoneListByLine!
13398. ----------------------------------------------------------
13399. Zone Processing Step:
13400. !ZoneStepByLine!    
13401. ----------------------------------------------------------
13402. Current Zone:
13403. !ZoneFooter!
13404. ----------------------------------------------------------
13405. Volume Statistics:
13406. !VolumeStatisticsDetail!
13407. ----------------------------------------------------------
13408. Zone Detailed Report:
13409. ----------------------------------------------------------
13410. !ZoneStatisticsDetail!
13411. ----------------------------------------------------------
13412. ")
13413. 
13414. 
13415. 
13416. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13417. 
13418. # BANNER SET
13419. 
13420. # DATE TIME RUN ELP
13421. 
13422. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
13423. /* Xinclude "..\BannerSet.MyDc"X */
13424. /* pause(1) */
13425. 
13426. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13427. 
13428. Title('!Heading!')
13429. /* pause(1) */
13430. 
13431. /* NOTE: Can't round or truncate to integer precision. */
13432. 
13433. pause(1)
13434. 
13435. 	# Footer next...
13436. 	
13437. 	# Zone Do Footer
13438. 
13439. /* ---------------------------------------------------------- */
13440. # File Select
13441. 	# Select Statments
13442. # File Actions 
13443. 	# Standard or OS File Actions.
13444. 	# Resume...
13445. 	
13446. 	# your stuff HERE (X)... post zone (file) file actions code.
13447. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
13448. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
13449. 		# (X)
13450. 		
13451. 		/* ??? Set window? */
13452. 	
13453. 	# ADD THE GAP
13454. 		
13455. # Vacate (good for diagnostics)
13456. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
13457. 
13458. # DoNotVacate - DO NOT Vacate (recommended)
13459. 
13460. # Vacate
13461. /* AddGap(GapUsedLoc) */
13462. 
13463. # DO Not Vacate
13464. AddGap(GapUsedLoc, DoNotVacate) 
13465. 	
13466. 	
13467. /* ---------------------------------------------------------- */
13468. # (failed) TEST for boolean logic.
13469. 
13470. /* It should work in the gap calculations for turning options */
13471. /* on and off but it will NOT work here. */
13472. 
13473. /* Boolean setting X or FlagX. */
13474. /* Where X will be on or off: */
13475. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
13476. /*      For ON:  (X  *  FlagAny) */
13477. 
13478. /* 1) Failed, zero gap overrode the previous one. */
13479. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
13480. /* AddGap(GapUsedTemp) */ 
13481. 
13482. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
13483. /* AddGap(GapUsedTemp, DoNotVacate) */ 
13484. 
13485. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
13486. 
13487. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
13488. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
13489. /* AddGap(GapUsedTemp) */ 
13490. 
13491. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
13492. /* AddGap(GapUsedTemp, DoNotVacate) */ 
13493. 
13494. /* ---------------------------------------------------------- */
13495. 
13496. # Vacate
13497. /* AddGap(GapUsed) */
13498. 
13499. # DO NOT Vacate (recommended)
13500. /* AddGap(GapUsed, DoNotVacate) */ 
13501. 	
13502. 
13503. 		
13504. # 
13505. FileEnd
13506. /* ---------------------------------------------------------- */
13507. 
13508. # your stuff HERE (X)... post zone (file) code.
13509. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
13510. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
13511. 	# (X)
13512. 
13513. SetVariable(FileStepDescription,"Zone finished, reporting.")
13514. # FILE STEP
13515. 
13516. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
13517. 
13518. /* add message and move to a new line. */
13519. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
13520. ")
13521. 
13522. /* display the line. (hopefully.) */
13523. # Zone Footer Set Statistics Window Text
13524. 
13525. SetStatisticsWindowText("----------------------------------------------------------
13526. Zones Processed: 
13527. ----------------------------------------------------------
13528. !ZoneListByLine!
13529. ----------------------------------------------------------
13530. Zone Processing Step:
13531. !ZoneStepByLine!    
13532. ----------------------------------------------------------
13533. Current Zone:
13534. !ZoneFooter!
13535. ----------------------------------------------------------
13536. Volume Statistics:
13537. !VolumeStatisticsDetail!
13538. ----------------------------------------------------------
13539. Zone Detailed Report:
13540. ----------------------------------------------------------
13541. !ZoneStatisticsDetail!
13542. ----------------------------------------------------------
13543. ")
13544. 
13545. 
13546. 
13547. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
13548. 
13549. # BANNER SET
13550. 
13551. # DATE TIME RUN ELP
13552. 
13553. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
13554. /* Xinclude "..\BannerSet.MyDc"X */
13555. /* pause(1) */
13556. 
13557. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13558. 
13559. Title('!Heading!')
13560. /* pause(1) */
13561. 
13562. /* NOTE: Can't round or truncate to integer precision. */
13563. 
13564. pause(1)
13565. 
13566. # Zone When Finished
13567. 
13568. # BANNER SET
13569. 
13570. # DATE TIME RUN ELP
13571. 
13572. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:16 0:00:02")
13573. /* Xinclude "..\BannerSet.MyDc"X */
13574. /* pause(1) */
13575. 
13576. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13577. 
13578. Title('!Heading!')
13579. /* pause(1) */
13580. 
13581. /* NOTE: Can't round or truncate to integer precision. */
13582. 
13583. AppendLogfile("!LogFileName!", "!Title!")
13584. 
13585. 
13586. 
13587. # Zone Statistics	
13588. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
13589. 
13590. # Footer:
13591. SetVariable(ZoneFooter, "----------------------------------------------------------
13592. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:16
13593. 
13594. Statistics Report:
13595. ------------------
13596.    Size:  
13597.    ------------------------
13598.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
13599.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
13600.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
13601. 
13602.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
13603.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
13604. 
13605.    Location:
13606.    ------------------------
13607.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
13608.              Files End: !ZoneEndCurrent!
13609.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
13610.       
13611.    Gap Settings:
13612.    ------------------------
13613.          Gap Requested: !ZoneGapSizePer!%
13614.       Volume Rounding: !ZoneVolRoundUpPer!%
13615.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
13616.                  
13617.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
13618.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
13619.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
13620.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
13621.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
13622.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
13623.      
13624.    Free Space after Zone:
13625.    ------------------------
13626.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
13627.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
13628.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
13629. 
13630. Directory and Files Select:
13631. ---------------------------
13632. !ZoneTypeSelectCurrent!               
13633. ---------------------------
13634. ----------------------------------------------------------
13635. ")
13636. 
13637. AppendLogfile("!LogFileName!", ".")
13638. AppendLogfile("!LogFileName!", "!ZoneFooter!")
13639. AppendLogfile("!LogFileName!", ".")
13640. 
13641. # Zone Footer Set Statistics Window Text
13642. 
13643. SetStatisticsWindowText("----------------------------------------------------------
13644. Zones Processed: 
13645. ----------------------------------------------------------
13646. !ZoneListByLine!
13647. ----------------------------------------------------------
13648. Zone Processing Step:
13649. !ZoneStepByLine!    
13650. ----------------------------------------------------------
13651. Current Zone:
13652. !ZoneFooter!
13653. ----------------------------------------------------------
13654. Volume Statistics:
13655. !VolumeStatisticsDetail!
13656. ----------------------------------------------------------
13657. Zone Detailed Report:
13658. ----------------------------------------------------------
13659. !ZoneStatisticsDetail!
13660. ----------------------------------------------------------
13661. ")
13662. 
13663. 
13664. 
13665. /* pause() */
13666. /* pause() */
13667. 
13668. 
13669. 
13670. 
13671. /* ---------------------------------------------------------- */
13672. 
13673. /* ---------------------------------------------------------- */
13674. /* Zone LinksCorp Links and Corp */
13675. /* ---------------------------------------------------------- */
13676. /* Zone LinksCorp Links and Corp */
13677. SetVariable(ZoneLabel, "!ZoneLabelLinksCorp!")
13678. SetVariable(ZoneDescription, "!ZoneDescriptionLinksCorp!")
13679. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpLinksCorp!")
13680. SetVariable(ZoneGapSize, "!ZoneGapSizeLinksCorp!")
13681. SetVariable(ZoneTypeSelect,'# LinksCorp start.
13682. # NotBlobsArchivesBu start.
13683. (not (
13684. # Blobs start.
13685. (
13686. # BlobsAndExceptions start.
13687. ( not(
13688.   FileName("*.bat")
13689.   or FileName("*.css")
13690.   or FileName("*.dll")
13691.   or FileName("*.exe")
13692.   or FileName("*.htm*")
13693.   or FileName("*.jar")
13694.   or FileName("*.js")
13695.   or FileName("*.script")
13696.   or FileName("*.wsf")
13697.   or (
13698. # Databases start.
13699. (
13700.   FileName("*.crypt*")
13701.   or FileName("*.db*")
13702.   or FileName("*.rdb*")
13703.   or FileName("*.dc*")
13704.   or FileName("*.dict*")
13705.   or FileName("*.?db*")
13706.   or FileName("*.?rdb*")
13707.   or FileName("*.md*")
13708.   or FileName("*.myd")
13709.   or FileName("*.ndf")
13710.   or FileName("*.ns?")
13711.   or FileName("*.pab")
13712.   or FileName("*.pst")
13713.   or FileName("*.sd?*")
13714.   or FileName("*.sq**")
13715.   or FileName("*.tmd")
13716.   or FileName("*.tps")
13717.   or FileName("*.tr*")
13718. )
13719. # Databases end.
13720. 
13721.     # BlobsAndExceptions
13722.     or 
13723. # Data start.
13724. (
13725.   DirectoryName("Data*")
13726.   or DirectoryName("Device*")
13727.   or DirectoryName("Export*")
13728.   or DirectoryName("Import*")
13729.   or DirectoryName("Log*")
13730.   or DirectoryName("*Log")
13731.   or DirectoryName("Maintenance*")
13732.   or DirectoryName("Rec*")
13733.   or DirectoryName("Sales*")
13734.   or DirectoryName("Search*")
13735.   or DirectoryName("User*")
13736. )
13737. # Data end.
13738. 
13739.     # BlobsAndExceptions
13740.   )
13741. ) )
13742. # BlobsAndExceptions end.
13743. 
13744. # Blobs
13745. ) and (
13746.   Size(BlobFileSize,0)
13747.   or (
13748.     FileName("*.arj")
13749.     or FileName("*.bup")
13750.     or FileName("*.bz2")
13751.     or FileName("*.chm")
13752.     or FileName("*.dvr-ms")
13753.     or FileName("*.gz")
13754.     or FileName("*.ifo")
13755.     or FileName("*.lzh")
13756.     or FileName("*.pdf")
13757.     or FileName("*.rpm")
13758.     or FileName("*.wmv")
13759.     or FileName("*.vob")
13760.     or FileName("*.z")
13761.   ) 
13762. )
13763. # Blobs end.
13764. 
13765. # NotBlobsArchivesBu
13766. or 
13767. # Archives start.
13768. (
13769.   DirectoryName("*Archive*")
13770.   or DirectoryName("*History*")
13771.   or DirectoryName("*Old")
13772.   or DirectoryName("* Old *")
13773.   or DirectoryName("Old *")
13774. 
13775.   or FileName("*.7z")
13776.   or FileName("*.cab")
13777.   or FileName("*.iso")
13778.   or FileName("*.msi")
13779.   or FileName("*.old")
13780.   or FileName("*.rar")
13781.   or FileName("*.tar")
13782.   or FileName("*.zip")
13783.   or
13784. # WinSysLow start.
13785. (
13786.   DirectoryName("$*")
13787.   or DirectoryName("0*")
13788.   or DirectoryName("1*")
13789.   or DirectoryName("2*")
13790.   or DirectoryName("3*")
13791.   or DirectoryName("4*")
13792.   or DirectoryName("5*")
13793.   or DirectoryName("6*")
13794.   or DirectoryName("7*")
13795.   or DirectoryName("8*")
13796.   or DirectoryName("9*")
13797. 
13798.   or DirectoryName("dllcache")
13799.   or DirectoryName("Downloaded Installations")
13800.   or DirectoryName("Ehome")
13801.   or DirectoryName("Fonts")
13802.   or DirectoryName("Help")
13803.   or DirectoryName("I386")
13804.   or DirectoryName("ie?updates")
13805.   or DirectoryName("Installer")
13806.   or DirectoryName("Installshield Installation Information")
13807.   or DirectoryName("IME")
13808.   or DirectoryName("*RECYCLE*")
13809.   or DirectoryName("ServicePackFiles")
13810.   or DirectoryName("SoftwareDistribution")
13811.   or DirectoryName("Speech")
13812.   or DirectoryName("Symbols")
13813.   or DirectoryName("System Volume Information")
13814.   or DirectoryName("windows.old")
13815. )
13816. # WinSysLow end.
13817. 
13818.   # Archives
13819. )
13820. # Archives end.
13821. 
13822. # NotBlobsArchivesBu
13823. or
13824. # Backups start.
13825. (
13826.   DirectoryName("*Backup*")
13827.   or DirectoryName("*Bu")
13828.   or DirectoryName("* Bu *")
13829.   or DirectoryName("Bu *")
13830. 
13831.   or FileName("*.bak")
13832.   or FileName("* - Copy*")
13833. )
13834. # Backups end.
13835. 
13836. # NotBlobsArchivesBu
13837. ) )
13838. # NotBlobsArchivesBu end.
13839. 
13840. # LinksCorp
13841. and ( 
13842. # Corp start.
13843. (
13844.     DirectoryName("*Corp*") or
13845.     DirectoryName("*Mdm*")
13846. )
13847. # Corp end.
13848. 
13849. # LinksCorp
13850. or 
13851. # Links start.
13852. (
13853.     DirectoryName("*Favorites*") or
13854.     DirectoryName("*Job*") or
13855.     DirectoryName("*Links*")
13856. )
13857. # Links end.
13858. 
13859. # LinksCorp
13860. or 
13861. # Support start.
13862. (
13863.   DirectoryName("*Logs*") or
13864.   DirectoryName("*Support*") or
13865.   DirectoryName("*Maintenance*")
13866. )
13867. # Support end.
13868. 
13869. # LinksCorp
13870. )
13871. # LinksCorp end.
13872. ')
13873. 
13874. 	# Zone Do Header
13875. 
13876. # Zone When Started
13877. 
13878. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
13879. # Display Set Zone
13880. 
13881. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
13882. SetVariable(FileStepDescription,	"")
13883. 
13884. SetVariable(ZoneStepByLine, 			"Zone started.
13885. ")
13886. 
13887. # BANNER SET
13888. 
13889. # DATE TIME RUN ELP
13890. 
13891. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
13892. /* Xinclude "..\BannerSet.MyDc"X */
13893. /* pause(1) */
13894. 
13895. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
13896. 
13897. Title('!Heading!')
13898. /* pause(1) */
13899. 
13900. /* NOTE: Can't round or truncate to integer precision. */
13901. 
13902. AppendLogfile("!LogFileName!", "!Title!")
13903. 
13904. 
13905. 
13906. pause(1)
13907. 
13908. 
13909. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
13910. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
13911. 
13912. SetVariable(ZoneStepNoCurrent, 0)
13913. 
13914. 
13915. # Zone Do Current Clear
13916. 
13917. SetVariable(ZoneTypeSelectCurrent, 		"")
13918. 
13919. SetVariable(ZoneBeginCurrent, 			0)
13920. SetVariable(ZoneBeginPerCurrent, 		0)
13921. SetVariable(ZoneEndCurrent, 			0)
13922. SetVariable(ZoneEndPerCurrent, 			0)
13923. 
13924. SetVariable(ZoneSizeCurrent,			0)
13925. SetVariable(ZoneSizePerCurrent,			0)
13926. 
13927. SetVariable(ZoneGapRequestedCurrent,	0)
13928. SetVariable(ZoneGapRoundedCurrent, 		0)
13929. SetVariable(ZoneGapAdjustedCurrent, 	0)
13930. SetVariable(ZoneGapAvailableCurrent, 	0)
13931. SetVariable(ZoneGapCurrent,				0)
13932. SetVariable(ZoneGapUsedCurrent, 		0)
13933. 
13934. SetVariable(ZoneGapActualCurrent, 		0)
13935. SetVariable(ZoneGapActualPerCurrent, 	0)
13936. 
13937. SetVariable(ZoneSizeActual, 			0)
13938. SetVariable(ZoneSizeActualCurrent,		0)
13939. 
13940. SetVariable(ZoneEndActual, 				0)
13941. SetVariable(ZoneEndActualCurrent,		0)			
13942. SetVariable(ZoneSizeActualPerCurrent, 	0)
13943.       
13944. SetVariable(ZoneFilesFolders,			0)
13945. SetVariable(ZoneFilesFoldersPer,		0) 
13946. 
13947. SetVariable(ZoneFragments,				0)
13948. SetVariable(ZoneFragmentsPer,			0) 
13949. 		
13950. SetVariable(ZoneEndActualCurrent, 		0)
13951. SetVariable(ZoneEndActualPerCurrent, 	0)
13952. 
13953. # Gap Calculation Methodology:
13954. 	# Requested
13955. 	SetVariable(GapRequested, 			0) 
13956. 	SetVariable(GapRequestedStd, 		0) 
13957. 	SetVariable(GapRequestedMft, 		0) 
13958. 	SetVariable(GapRequestedOs, 		0) 
13959. 	SetVariable(GapRequestedOriginal, 	0) 
13960. 	
13961. 	# Gap Adjustments
13962. 	SetVariable(GapRounded, 			0)
13963. 	# SetVariable(GapAdjusted, 			0)
13964. 	SetVariable(GapAvailable, 			0)
13965. 	SetVariable(GapCurrent, 			0)
13966. 	SetVariable(GapActual, 				0)
13967. 	SetVariable(GapUsed, 				0)
13968. 	
13969. 	# Gap Adjustments
13970. 	SetVariable(GapRoundedLoc, 			0)
13971. 	# SetVariable(GapAdjustedLoc, 		0)
13972. 	SetVariable(GapAvailableLoc, 		0)
13973. 	SetVariable(GapCurrentLoc, 			0)
13974. 	SetVariable(GapActualLoc,			0)
13975. 	SetVariable(GapUsedLoc,				0)
13976. 	
13977. 	# Space usage
13978. 	SetVariable(ZoneFreePerRequested, 	0)
13979. 	SetVariable(ZoneFreePerUsed, 		0)
13980. 
13981. # Gap Size & Rounding
13982. 	SetVariable(ZoneGapSizePer, 		0)
13983. 	SetVariable(ZoneVolRoundUpPer, 		0)
13984. 	
13985. 	# Free Space
13986. 	SetVariable(ZoneFreeUsedPer, 		0)
13987. 	SetVariable(ZoneFreeRequestedPer, 	0)
13988. 
13989. 
13990. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
13991. 
13992. # Footer:
13993. SetVariable(ZoneFooter, "----------------------------------------------------------
13994. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:17
13995. 
13996. Statistics Report:
13997. ------------------
13998.    Size:  
13999.    ------------------------
14000.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14001.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14002.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14003. 
14004.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14005.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14006. 
14007.    Location:
14008.    ------------------------
14009.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14010.              Files End: !ZoneEndCurrent!
14011.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14012.       
14013.    Gap Settings:
14014.    ------------------------
14015.          Gap Requested: !ZoneGapSizePer!%
14016.       Volume Rounding: !ZoneVolRoundUpPer!%
14017.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14018.                  
14019.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
14020.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
14021.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
14022.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
14023.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
14024.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
14025.      
14026.    Free Space after Zone:
14027.    ------------------------
14028.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14029.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14030.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14031. 
14032. Directory and Files Select:
14033. ---------------------------
14034. !ZoneTypeSelectCurrent!               
14035. ---------------------------
14036. ----------------------------------------------------------
14037. ")
14038. 
14039. # BANNER SET
14040. 
14041. # DATE TIME RUN ELP
14042. 
14043. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
14044. /* Xinclude "..\BannerSet.MyDc"X */
14045. /* pause(1) */
14046. 
14047. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14048. 
14049. Title('!Heading!')
14050. /* pause(1) */
14051. 
14052. /* NOTE: Can't round or truncate to integer precision. */
14053. 
14054. AppendLogfile("!LogFileName!", "!Title!")
14055. 
14056. 
14057. 
14058. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
14059. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
14060. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:17")
14061. 
14062. SetVariable(ZoneListByLine, "!ZoneListByLine!
14063. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
14064. 
14065. 
14066. /* Fixed Zone Position Handling */
14067. /* Literal number: */
14068. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
14069. /* Percentage of disk: */
14070. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
14071. /* Gap */
14072. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
14073. 
14074. /* ---------------------------------------------------------- */
14075. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
14076. # FILE STEP
14077. 
14078. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14079. 
14080. /* add message and move to a new line. */
14081. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14082. ")
14083. 
14084. /* display the line. (hopefully.) */
14085. # Zone Footer Set Statistics Window Text
14086. 
14087. SetStatisticsWindowText("----------------------------------------------------------
14088. Zones Processed: 
14089. ----------------------------------------------------------
14090. !ZoneListByLine!
14091. ----------------------------------------------------------
14092. Zone Processing Step:
14093. !ZoneStepByLine!    
14094. ----------------------------------------------------------
14095. Current Zone:
14096. !ZoneFooter!
14097. ----------------------------------------------------------
14098. Volume Statistics:
14099. !VolumeStatisticsDetail!
14100. ----------------------------------------------------------
14101. Zone Detailed Report:
14102. ----------------------------------------------------------
14103. !ZoneStatisticsDetail!
14104. ----------------------------------------------------------
14105. ")
14106. 
14107. 
14108. 
14109. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14110. 
14111. # BANNER SET
14112. 
14113. # DATE TIME RUN ELP
14114. 
14115. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
14116. /* Xinclude "..\BannerSet.MyDc"X */
14117. /* pause(1) */
14118. 
14119. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14120. 
14121. Title('!Heading!')
14122. /* pause(1) */
14123. 
14124. /* NOTE: Can't round or truncate to integer precision. */
14125. 
14126. pause(1)
14127. 
14128. # your stuff HERE (X)... pre file select code.
14129. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
14130. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
14131. 	# (X)
14132. 
14133. FileSelect
14134. 
14135. 	# your stuff can't really go here (errors.)
14136. 	# maybe for some reason I don't know of...
14137. 	
14138. 	# Actions next...
14139. 	!include "....\ZoneTypeSelectLinksCorp.MyDc"!
14140. 	# Zone
14141. # File Select
14142. 	# File Booleans
14143. 	# Resume...
14144. # File Action - SortByName.
14145. 
14146. FileActions
14147. 
14148. 		/* ---------------------------------------------------------- */
14149. 	# Gap
14150. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
14151. 		# FILE STEP
14152. 
14153. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14154. 
14155. /* add message and move to a new line. */
14156. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14157. ")
14158. 
14159. /* display the line. (hopefully.) */
14160. # Zone Footer Set Statistics Window Text
14161. 
14162. SetStatisticsWindowText("----------------------------------------------------------
14163. Zones Processed: 
14164. ----------------------------------------------------------
14165. !ZoneListByLine!
14166. ----------------------------------------------------------
14167. Zone Processing Step:
14168. !ZoneStepByLine!    
14169. ----------------------------------------------------------
14170. Current Zone:
14171. !ZoneFooter!
14172. ----------------------------------------------------------
14173. Volume Statistics:
14174. !VolumeStatisticsDetail!
14175. ----------------------------------------------------------
14176. Zone Detailed Report:
14177. ----------------------------------------------------------
14178. !ZoneStatisticsDetail!
14179. ----------------------------------------------------------
14180. ")
14181. 
14182. 
14183. 
14184. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14185. 
14186. # BANNER SET
14187. 
14188. # DATE TIME RUN ELP
14189. 
14190. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
14191. /* Xinclude "..\BannerSet.MyDc"X */
14192. /* pause(1) */
14193. 
14194. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14195. 
14196. Title('!Heading!')
14197. /* pause(1) */
14198. 
14199. /* NOTE: Can't round or truncate to integer precision. */
14200. 
14201. pause(1)
14202. 	
14203. 	# ACTUAL GAP
14204. 		/* AddGap Variant. */
14205. 	  	# Zone Do Gap
14206. # Gap Calculation Methods:
14207. 
14208. /* 1) Anything you need to add first. */
14209. /* empty */
14210. 
14211. /* ---------------------------------------------------------- */
14212. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
14213. 	# GapRequestedStd.
14214. 
14215. 		/* ---------------------------------------------------------- */
14216. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
14217. 
14218. 		# Gap Calculation Methods:
14219. 
14220. /* AddGap Variants */
14221. 
14222. 	/* Standard */
14223. 		# Gap Calculation Methods:
14224. 	/* AddGap Variants */
14225. 	/* Standard */
14226. 
14227. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
14228. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
14229. 
14230. 	SetVariable(GapRequested, GapRequestedStd)
14231. 	
14232. 
14233. 	/* MFT Low High Method */
14234. 		# Gap Calculation Methods:
14235. 	/* AddGap Variants */
14236. 	/* MFT Low High Method */
14237. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
14238. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
14239. 	SetVariable(GapRequested, GapRequestedMft)
14240. 	
14241. 
14242. 	/* OS Volume Type Method */
14243. 		# Gap Calculation Methods:
14244. 	/* AddGap Variants */
14245. 	/* OS Volume Type Method */
14246. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
14247. 	SetVariable(GapRequested, GapRequestedOs)
14248. 
14249. 
14250. 
14251. /* MakeGap Variants */
14252. 
14253. 	/* Original Os 1-3 + MFT 2 */
14254. 		# Gap Calculation Methods:
14255. 	/* MakeGap Variants */
14256. 	/* Original Os 1-3 + MFT 2 */
14257. 	/* plus MFT gap placed inline at the dividing zone. */
14258. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
14259. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
14260. 	SetVariable(GapRequested, GapRequestedOrig)
14261. 	
14262. 	
14263. /* Note: You could comment out the ones not in use */
14264. /* However having the data in the log is useful. */
14265. /* Therefore the following line is otherwise needed. */
14266. 
14267. /* Standard used */
14268. 
14269. SetVariable(GapRequested, GapRequestedStd)
14270. 
14271. # Gap Calculation Methods:
14272. 
14273. /* AddGap Variants */
14274. 	/* Standard */
14275. 	/* MFT Low High Method */
14276. 	/* OS Volume Type Method */
14277. 
14278. /* MakeGap Variants */
14279. 	/* Original Os 1-3 + MFT 2 */
14280. 
14281. /* Note: You could comment out the ones not in use */
14282. /* However having the data in the log is useful. */
14283. /* Therefore the following line is otherwise needed. */
14284. 
14285. /* Standard is used currently */
14286. 
14287. 
14288. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
14289. 
14290. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
14291. 
14292. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
14293. 
14294. /* ---------------------------------------------------------- */
14295. /* 3) SMALL ZONE ADJUSTMENT. */
14296. /* Gab cant be larger than half the Zone Size. */
14297. 
14298. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
14299. 	
14300. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
14301. 
14302. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
14303. 
14304. /* ---------------------------------------------------------- */
14305. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
14306. # Gap Adjustments.
14307. 
14308. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
14309. 	
14310. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
14311. 
14312. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
14313. 
14314. /* ---------------------------------------------------------- */
14315. # BYPASS THIS.
14316. 	/* This is definitely wrong. */
14317. 	/* The question is can we steal gap from the next zone */
14318. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
14319. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
14320. 		# Zone Overflow.
14321. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
14322. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
14323. 
14324. /* ---------------------------------------------------------- */
14325. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
14326. # Remaining free space available.
14327. 
14328. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
14329. 	
14330. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
14331. 
14332. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
14333. 
14334. /* ---------------------------------------------------------- */
14335. # CURRENT gap to use.
14336. 
14337. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
14338. 
14339. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
14340. 
14341. /* ---------------------------------------------------------- */
14342. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
14343. # Debugging.
14344. 
14345. 	SetVariable(GapUsed, GapCurrent) // for debugging
14346. 
14347. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
14348. 
14349. 		# Your code HERE
14350. 
14351. /* ---------------------------------------------------------- */
14352. /* 7) YOUR CODE. */
14353. # YOUR CODE HERE:
14354. 	# INPUT: GapCurrent or GapCurrentLoc
14355. 	# OUTPUT: GapUsed...
14356. 
14357. /* ---------------------------------------------------------- */
14358. # Gap Size.
14359. # Actual Size of Gap.
14360. 
14361. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
14362. 
14363. /* ---------------------------------------------------------- */
14364. /* xxxxxxxxxxxxxxxxxxxxxx */
14365. # ADD THE GAP
14366. 	/* Xinclude "..\GapCommandDo.MyDc"X */
14367. /* xxxxxxxxxxxxxxxxxxxxxx */
14368. 
14369. 	
14370. 	# Zone Statistics	
14371. 	# Zone / Volume Statistics and Display
14372. 		
14373. 	# Accumulate Totals
14374.   	# Volume totals
14375. 
14376. /* Current total space used (by Zones and Gaps) */
14377. 
14378. SetVariable(VolumeZoneUsed, GapUsed)
14379. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
14380. /* Percentage */
14381. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
14382. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
14383. 
14384. /* Current total of free space requested */
14385. 
14386. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
14387. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
14388. /* Percent. */
14389. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
14390. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
14391. 
14392. /* Current total of free space used */
14393. 
14394. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
14395. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
14396. /* Percent */
14397. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
14398. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
14399. 
14400. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
14401. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
14402. /* Xinclude "..\DebugDisplayPause.MyDc"X */
14403. 
14404. 
14405. 	# Current Values
14406. 	# Cluster, Sector, Block adjust for display.
14407. 	# Bytes per cluster is volume specific.
14408. 
14409. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
14410. 
14411. # Current Zone values.
14412. 	# Begin, end and size.
14413. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
14414. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
14415. 
14416. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
14417. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
14418. 
14419. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
14420. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
14421. 
14422. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
14423. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
14424. 
14425. 	SetVariable(ZoneFragments,				"!ZONE210N!")
14426. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
14427. 		
14428. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
14429. /* identical code to here: (separation not needed. TEST.) */	
14430. 
14431. # Current Gap, Actual and Free Values
14432. 	# Gap
14433. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
14434. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
14435. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
14436. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
14437. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
14438. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
14439. 	
14440. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
14441. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
14442. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
14443. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
14444. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
14445. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
14446. 	
14447. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
14448. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
14449. 	
14450. 	# Actual Size and End
14451. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
14452. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
14453. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
14454. 	
14455. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
14456. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
14457. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
14458. 
14459. # Gap Size & Rounding
14460. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
14461. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
14462. 	
14463. 	# Free Space
14464. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
14465. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
14466. 
14467. 	# Footer:
14468. SetVariable(ZoneFooter, "----------------------------------------------------------
14469. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:17
14470. 
14471. Statistics Report:
14472. ------------------
14473.    Size:  
14474.    ------------------------
14475.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14476.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14477.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14478. 
14479.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14480.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14481. 
14482.    Location:
14483.    ------------------------
14484.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14485.              Files End: !ZoneEndCurrent!
14486.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14487.       
14488.    Gap Settings:
14489.    ------------------------
14490.          Gap Requested: !ZoneGapSizePer!%
14491.       Volume Rounding: !ZoneVolRoundUpPer!%
14492.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14493.                  
14494.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
14495.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
14496.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
14497.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
14498.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
14499.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
14500.      
14501.    Free Space after Zone:
14502.    ------------------------
14503.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14504.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14505.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14506. 
14507. Directory and Files Select:
14508. ---------------------------
14509. !ZoneTypeSelectCurrent!               
14510. ---------------------------
14511. ----------------------------------------------------------
14512. ")
14513. 	# Zone Footer Set Statistics Window Text
14514. 
14515. SetStatisticsWindowText("----------------------------------------------------------
14516. Zones Processed: 
14517. ----------------------------------------------------------
14518. !ZoneListByLine!
14519. ----------------------------------------------------------
14520. Zone Processing Step:
14521. !ZoneStepByLine!    
14522. ----------------------------------------------------------
14523. Current Zone:
14524. !ZoneFooter!
14525. ----------------------------------------------------------
14526. Volume Statistics:
14527. !VolumeStatisticsDetail!
14528. ----------------------------------------------------------
14529. Zone Detailed Report:
14530. ----------------------------------------------------------
14531. !ZoneStatisticsDetail!
14532. ----------------------------------------------------------
14533. ")
14534. 
14535. 
14536. 	
14537.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
14538. 
14539. 	# Add Zone to list of zones for display.
14540. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
14541. 
14542. 	# Footer:
14543. SetVariable(ZoneFooter, "----------------------------------------------------------
14544. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:17
14545. 
14546. Statistics Report:
14547. ------------------
14548.    Size:  
14549.    ------------------------
14550.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14551.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14552.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14553. 
14554.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14555.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14556. 
14557.    Location:
14558.    ------------------------
14559.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14560.              Files End: !ZoneEndCurrent!
14561.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14562.       
14563.    Gap Settings:
14564.    ------------------------
14565.          Gap Requested: !ZoneGapSizePer!%
14566.       Volume Rounding: !ZoneVolRoundUpPer!%
14567.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14568.                  
14569.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
14570.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
14571.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
14572.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
14573.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
14574.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
14575.      
14576.    Free Space after Zone:
14577.    ------------------------
14578.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14579.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14580.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14581. 
14582. Directory and Files Select:
14583. ---------------------------
14584. !ZoneTypeSelectCurrent!               
14585. ---------------------------
14586. ----------------------------------------------------------
14587. ")
14588. 
14589. 	# Add Zone Details to Report.	
14590. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
14591. !ZoneFooter!")
14592. 
14593. 
14594. 
14595. 	# DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
14596. 		/* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
14597. 		/* Xinclude "..\DebugDisplayPause.MyDc"X */
14598. 
14599.   	# Zone Statistics	
14600.   	/* Xinclude "..\ZoneDoStatistics.MyDc"X */
14601. 
14602. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
14603. 	# FILE STEP
14604. 
14605. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14606. 
14607. /* add message and move to a new line. */
14608. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14609. ")
14610. 
14611. /* display the line. (hopefully.) */
14612. # Zone Footer Set Statistics Window Text
14613. 
14614. SetStatisticsWindowText("----------------------------------------------------------
14615. Zones Processed: 
14616. ----------------------------------------------------------
14617. !ZoneListByLine!
14618. ----------------------------------------------------------
14619. Zone Processing Step:
14620. !ZoneStepByLine!    
14621. ----------------------------------------------------------
14622. Current Zone:
14623. !ZoneFooter!
14624. ----------------------------------------------------------
14625. Volume Statistics:
14626. !VolumeStatisticsDetail!
14627. ----------------------------------------------------------
14628. Zone Detailed Report:
14629. ----------------------------------------------------------
14630. !ZoneStatisticsDetail!
14631. ----------------------------------------------------------
14632. ")
14633. 
14634. 
14635. 
14636. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14637. 
14638. # BANNER SET
14639. 
14640. # DATE TIME RUN ELP
14641. 
14642. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
14643. /* Xinclude "..\BannerSet.MyDc"X */
14644. /* pause(1) */
14645. 
14646. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14647. 
14648. Title('!Heading!')
14649. /* pause(1) */
14650. 
14651. /* NOTE: Can't round or truncate to integer precision. */
14652. 
14653. pause(1)
14654. 
14655. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
14656. 	
14657. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
14658. 	# FILE STEP
14659. 
14660. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14661. 
14662. /* add message and move to a new line. */
14663. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14664. ")
14665. 
14666. /* display the line. (hopefully.) */
14667. # Zone Footer Set Statistics Window Text
14668. 
14669. SetStatisticsWindowText("----------------------------------------------------------
14670. Zones Processed: 
14671. ----------------------------------------------------------
14672. !ZoneListByLine!
14673. ----------------------------------------------------------
14674. Zone Processing Step:
14675. !ZoneStepByLine!    
14676. ----------------------------------------------------------
14677. Current Zone:
14678. !ZoneFooter!
14679. ----------------------------------------------------------
14680. Volume Statistics:
14681. !VolumeStatisticsDetail!
14682. ----------------------------------------------------------
14683. Zone Detailed Report:
14684. ----------------------------------------------------------
14685. !ZoneStatisticsDetail!
14686. ----------------------------------------------------------
14687. ")
14688. 
14689. 
14690. 
14691. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14692. 
14693. # BANNER SET
14694. 
14695. # DATE TIME RUN ELP
14696. 
14697. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
14698. /* Xinclude "..\BannerSet.MyDc"X */
14699. /* pause(1) */
14700. 
14701. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14702. 
14703. Title('!Heading!')
14704. /* pause(1) */
14705. 
14706. /* NOTE: Can't round or truncate to integer precision. */
14707. 
14708. pause(1)
14709. 
14710. 	# Footer next...
14711. 	
14712. 	# Zone Do Footer
14713. 
14714. /* ---------------------------------------------------------- */
14715. # File Select
14716. 	# Select Statments
14717. # File Actions 
14718. 	# Standard or OS File Actions.
14719. 	# Resume...
14720. 	
14721. 	# your stuff HERE (X)... post zone (file) file actions code.
14722. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
14723. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
14724. 		# (X)
14725. 		
14726. 		/* ??? Set window? */
14727. 	
14728. 	# ADD THE GAP
14729. 		
14730. # Vacate (good for diagnostics)
14731. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
14732. 
14733. # DoNotVacate - DO NOT Vacate (recommended)
14734. 
14735. # Vacate
14736. /* AddGap(GapUsedLoc) */
14737. 
14738. # DO Not Vacate
14739. AddGap(GapUsedLoc, DoNotVacate) 
14740. 	
14741. 	
14742. /* ---------------------------------------------------------- */
14743. # (failed) TEST for boolean logic.
14744. 
14745. /* It should work in the gap calculations for turning options */
14746. /* on and off but it will NOT work here. */
14747. 
14748. /* Boolean setting X or FlagX. */
14749. /* Where X will be on or off: */
14750. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
14751. /*      For ON:  (X  *  FlagAny) */
14752. 
14753. /* 1) Failed, zero gap overrode the previous one. */
14754. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
14755. /* AddGap(GapUsedTemp) */ 
14756. 
14757. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
14758. /* AddGap(GapUsedTemp, DoNotVacate) */ 
14759. 
14760. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
14761. 
14762. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
14763. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
14764. /* AddGap(GapUsedTemp) */ 
14765. 
14766. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
14767. /* AddGap(GapUsedTemp, DoNotVacate) */ 
14768. 
14769. /* ---------------------------------------------------------- */
14770. 
14771. # Vacate
14772. /* AddGap(GapUsed) */
14773. 
14774. # DO NOT Vacate (recommended)
14775. /* AddGap(GapUsed, DoNotVacate) */ 
14776. 	
14777. 
14778. 		
14779. # 
14780. FileEnd
14781. /* ---------------------------------------------------------- */
14782. 
14783. # your stuff HERE (X)... post zone (file) code.
14784. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
14785. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
14786. 	# (X)
14787. 
14788. SetVariable(FileStepDescription,"Zone finished, reporting.")
14789. # FILE STEP
14790. 
14791. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
14792. 
14793. /* add message and move to a new line. */
14794. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
14795. ")
14796. 
14797. /* display the line. (hopefully.) */
14798. # Zone Footer Set Statistics Window Text
14799. 
14800. SetStatisticsWindowText("----------------------------------------------------------
14801. Zones Processed: 
14802. ----------------------------------------------------------
14803. !ZoneListByLine!
14804. ----------------------------------------------------------
14805. Zone Processing Step:
14806. !ZoneStepByLine!    
14807. ----------------------------------------------------------
14808. Current Zone:
14809. !ZoneFooter!
14810. ----------------------------------------------------------
14811. Volume Statistics:
14812. !VolumeStatisticsDetail!
14813. ----------------------------------------------------------
14814. Zone Detailed Report:
14815. ----------------------------------------------------------
14816. !ZoneStatisticsDetail!
14817. ----------------------------------------------------------
14818. ")
14819. 
14820. 
14821. 
14822. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
14823. 
14824. # BANNER SET
14825. 
14826. # DATE TIME RUN ELP
14827. 
14828. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
14829. /* Xinclude "..\BannerSet.MyDc"X */
14830. /* pause(1) */
14831. 
14832. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14833. 
14834. Title('!Heading!')
14835. /* pause(1) */
14836. 
14837. /* NOTE: Can't round or truncate to integer precision. */
14838. 
14839. pause(1)
14840. 
14841. # Zone When Finished
14842. 
14843. # BANNER SET
14844. 
14845. # DATE TIME RUN ELP
14846. 
14847. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
14848. /* Xinclude "..\BannerSet.MyDc"X */
14849. /* pause(1) */
14850. 
14851. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
14852. 
14853. Title('!Heading!')
14854. /* pause(1) */
14855. 
14856. /* NOTE: Can't round or truncate to integer precision. */
14857. 
14858. AppendLogfile("!LogFileName!", "!Title!")
14859. 
14860. 
14861. 
14862. # Zone Statistics	
14863. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
14864. 
14865. # Footer:
14866. SetVariable(ZoneFooter, "----------------------------------------------------------
14867. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:17
14868. 
14869. Statistics Report:
14870. ------------------
14871.    Size:  
14872.    ------------------------
14873.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
14874.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
14875.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
14876. 
14877.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
14878.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
14879. 
14880.    Location:
14881.    ------------------------
14882.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
14883.              Files End: !ZoneEndCurrent!
14884.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
14885.       
14886.    Gap Settings:
14887.    ------------------------
14888.          Gap Requested: !ZoneGapSizePer!%
14889.       Volume Rounding: !ZoneVolRoundUpPer!%
14890.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
14891.                  
14892.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
14893.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
14894.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
14895.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
14896.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
14897.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
14898.      
14899.    Free Space after Zone:
14900.    ------------------------
14901.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
14902.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
14903.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
14904. 
14905. Directory and Files Select:
14906. ---------------------------
14907. !ZoneTypeSelectCurrent!               
14908. ---------------------------
14909. ----------------------------------------------------------
14910. ")
14911. 
14912. AppendLogfile("!LogFileName!", ".")
14913. AppendLogfile("!LogFileName!", "!ZoneFooter!")
14914. AppendLogfile("!LogFileName!", ".")
14915. 
14916. # Zone Footer Set Statistics Window Text
14917. 
14918. SetStatisticsWindowText("----------------------------------------------------------
14919. Zones Processed: 
14920. ----------------------------------------------------------
14921. !ZoneListByLine!
14922. ----------------------------------------------------------
14923. Zone Processing Step:
14924. !ZoneStepByLine!    
14925. ----------------------------------------------------------
14926. Current Zone:
14927. !ZoneFooter!
14928. ----------------------------------------------------------
14929. Volume Statistics:
14930. !VolumeStatisticsDetail!
14931. ----------------------------------------------------------
14932. Zone Detailed Report:
14933. ----------------------------------------------------------
14934. !ZoneStatisticsDetail!
14935. ----------------------------------------------------------
14936. ")
14937. 
14938. 
14939. 
14940. /* pause() */
14941. /* pause() */
14942. 
14943. 
14944. 
14945. 
14946. /* ---------------------------------------------------------- */
14947. 
14948. 
14949. /* ---------------------------------------------------------- */
14950. /* Zone People */
14951. /* ---------------------------------------------------------- */
14952. /* Zone People */
14953. SetVariable(ZoneLabel, "!ZoneLabelPeople!")
14954. SetVariable(ZoneDescription, "!ZoneDescriptionPeople!")
14955. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpPeople!")
14956. SetVariable(ZoneGapSize, "!ZoneGapSizePeople!")
14957. SetVariable(ZoneTypeSelect,'# People start.
14958. # NotBlobsArchivesBu start.
14959. (not (
14960. # Blobs start.
14961. (
14962. # BlobsAndExceptions start.
14963. ( not(
14964.   FileName("*.bat")
14965.   or FileName("*.css")
14966.   or FileName("*.dll")
14967.   or FileName("*.exe")
14968.   or FileName("*.htm*")
14969.   or FileName("*.jar")
14970.   or FileName("*.js")
14971.   or FileName("*.script")
14972.   or FileName("*.wsf")
14973.   or (
14974. # Databases start.
14975. (
14976.   FileName("*.crypt*")
14977.   or FileName("*.db*")
14978.   or FileName("*.rdb*")
14979.   or FileName("*.dc*")
14980.   or FileName("*.dict*")
14981.   or FileName("*.?db*")
14982.   or FileName("*.?rdb*")
14983.   or FileName("*.md*")
14984.   or FileName("*.myd")
14985.   or FileName("*.ndf")
14986.   or FileName("*.ns?")
14987.   or FileName("*.pab")
14988.   or FileName("*.pst")
14989.   or FileName("*.sd?*")
14990.   or FileName("*.sq**")
14991.   or FileName("*.tmd")
14992.   or FileName("*.tps")
14993.   or FileName("*.tr*")
14994. )
14995. # Databases end.
14996. 
14997.     # BlobsAndExceptions
14998.     or 
14999. # Data start.
15000. (
15001.   DirectoryName("Data*")
15002.   or DirectoryName("Device*")
15003.   or DirectoryName("Export*")
15004.   or DirectoryName("Import*")
15005.   or DirectoryName("Log*")
15006.   or DirectoryName("*Log")
15007.   or DirectoryName("Maintenance*")
15008.   or DirectoryName("Rec*")
15009.   or DirectoryName("Sales*")
15010.   or DirectoryName("Search*")
15011.   or DirectoryName("User*")
15012. )
15013. # Data end.
15014. 
15015.     # BlobsAndExceptions
15016.   )
15017. ) )
15018. # BlobsAndExceptions end.
15019. 
15020. # Blobs
15021. ) and (
15022.   Size(BlobFileSize,0)
15023.   or (
15024.     FileName("*.arj")
15025.     or FileName("*.bup")
15026.     or FileName("*.bz2")
15027.     or FileName("*.chm")
15028.     or FileName("*.dvr-ms")
15029.     or FileName("*.gz")
15030.     or FileName("*.ifo")
15031.     or FileName("*.lzh")
15032.     or FileName("*.pdf")
15033.     or FileName("*.rpm")
15034.     or FileName("*.wmv")
15035.     or FileName("*.vob")
15036.     or FileName("*.z")
15037.   ) 
15038. )
15039. # Blobs end.
15040. 
15041. # NotBlobsArchivesBu
15042. or 
15043. # Archives start.
15044. (
15045.   DirectoryName("*Archive*")
15046.   or DirectoryName("*History*")
15047.   or DirectoryName("*Old")
15048.   or DirectoryName("* Old *")
15049.   or DirectoryName("Old *")
15050. 
15051.   or FileName("*.7z")
15052.   or FileName("*.cab")
15053.   or FileName("*.iso")
15054.   or FileName("*.msi")
15055.   or FileName("*.old")
15056.   or FileName("*.rar")
15057.   or FileName("*.tar")
15058.   or FileName("*.zip")
15059.   or
15060. # WinSysLow start.
15061. (
15062.   DirectoryName("$*")
15063.   or DirectoryName("0*")
15064.   or DirectoryName("1*")
15065.   or DirectoryName("2*")
15066.   or DirectoryName("3*")
15067.   or DirectoryName("4*")
15068.   or DirectoryName("5*")
15069.   or DirectoryName("6*")
15070.   or DirectoryName("7*")
15071.   or DirectoryName("8*")
15072.   or DirectoryName("9*")
15073. 
15074.   or DirectoryName("dllcache")
15075.   or DirectoryName("Downloaded Installations")
15076.   or DirectoryName("Ehome")
15077.   or DirectoryName("Fonts")
15078.   or DirectoryName("Help")
15079.   or DirectoryName("I386")
15080.   or DirectoryName("ie?updates")
15081.   or DirectoryName("Installer")
15082.   or DirectoryName("Installshield Installation Information")
15083.   or DirectoryName("IME")
15084.   or DirectoryName("*RECYCLE*")
15085.   or DirectoryName("ServicePackFiles")
15086.   or DirectoryName("SoftwareDistribution")
15087.   or DirectoryName("Speech")
15088.   or DirectoryName("Symbols")
15089.   or DirectoryName("System Volume Information")
15090.   or DirectoryName("windows.old")
15091. )
15092. # WinSysLow end.
15093. 
15094.   # Archives
15095. )
15096. # Archives end.
15097. 
15098. # NotBlobsArchivesBu
15099. or
15100. # Backups start.
15101. (
15102.   DirectoryName("*Backup*")
15103.   or DirectoryName("*Bu")
15104.   or DirectoryName("* Bu *")
15105.   or DirectoryName("Bu *")
15106. 
15107.   or FileName("*.bak")
15108.   or FileName("* - Copy*")
15109. )
15110. # Backups end.
15111. 
15112. # NotBlobsArchivesBu
15113. ) )
15114. # NotBlobsArchivesBu end.
15115. 
15116. # People
15117. and (
15118. # People start.
15119. (
15120.   DirectoryName("*Capture*")
15121.   or DirectoryName("*Document*")
15122.   or DirectoryName("*Download*")
15123.   or DirectoryName("*Kids*")
15124.   or DirectoryName("Mail*")
15125.   or DirectoryName("*Mail")
15126.   or DirectoryName("My*")
15127.   or DirectoryName("*Person*")
15128.   or DirectoryName("Private*")
15129.   or DirectoryName("Users")
15130.   
15131.   # Individual People HERE:
15132.   or DirectoryName("Dgh*")
15133. )
15134. # People end.
15135. 
15136. # People
15137. )
15138. # People end.
15139. ')
15140. 
15141. 	# Zone Do Header
15142. 
15143. # Zone When Started
15144. 
15145. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
15146. # Display Set Zone
15147. 
15148. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
15149. SetVariable(FileStepDescription,	"")
15150. 
15151. SetVariable(ZoneStepByLine, 			"Zone started.
15152. ")
15153. 
15154. # BANNER SET
15155. 
15156. # DATE TIME RUN ELP
15157. 
15158. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
15159. /* Xinclude "..\BannerSet.MyDc"X */
15160. /* pause(1) */
15161. 
15162. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15163. 
15164. Title('!Heading!')
15165. /* pause(1) */
15166. 
15167. /* NOTE: Can't round or truncate to integer precision. */
15168. 
15169. AppendLogfile("!LogFileName!", "!Title!")
15170. 
15171. 
15172. 
15173. pause(1)
15174. 
15175. 
15176. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
15177. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
15178. 
15179. SetVariable(ZoneStepNoCurrent, 0)
15180. 
15181. 
15182. # Zone Do Current Clear
15183. 
15184. SetVariable(ZoneTypeSelectCurrent, 		"")
15185. 
15186. SetVariable(ZoneBeginCurrent, 			0)
15187. SetVariable(ZoneBeginPerCurrent, 		0)
15188. SetVariable(ZoneEndCurrent, 			0)
15189. SetVariable(ZoneEndPerCurrent, 			0)
15190. 
15191. SetVariable(ZoneSizeCurrent,			0)
15192. SetVariable(ZoneSizePerCurrent,			0)
15193. 
15194. SetVariable(ZoneGapRequestedCurrent,	0)
15195. SetVariable(ZoneGapRoundedCurrent, 		0)
15196. SetVariable(ZoneGapAdjustedCurrent, 	0)
15197. SetVariable(ZoneGapAvailableCurrent, 	0)
15198. SetVariable(ZoneGapCurrent,				0)
15199. SetVariable(ZoneGapUsedCurrent, 		0)
15200. 
15201. SetVariable(ZoneGapActualCurrent, 		0)
15202. SetVariable(ZoneGapActualPerCurrent, 	0)
15203. 
15204. SetVariable(ZoneSizeActual, 			0)
15205. SetVariable(ZoneSizeActualCurrent,		0)
15206. 
15207. SetVariable(ZoneEndActual, 				0)
15208. SetVariable(ZoneEndActualCurrent,		0)			
15209. SetVariable(ZoneSizeActualPerCurrent, 	0)
15210.       
15211. SetVariable(ZoneFilesFolders,			0)
15212. SetVariable(ZoneFilesFoldersPer,		0) 
15213. 
15214. SetVariable(ZoneFragments,				0)
15215. SetVariable(ZoneFragmentsPer,			0) 
15216. 		
15217. SetVariable(ZoneEndActualCurrent, 		0)
15218. SetVariable(ZoneEndActualPerCurrent, 	0)
15219. 
15220. # Gap Calculation Methodology:
15221. 	# Requested
15222. 	SetVariable(GapRequested, 			0) 
15223. 	SetVariable(GapRequestedStd, 		0) 
15224. 	SetVariable(GapRequestedMft, 		0) 
15225. 	SetVariable(GapRequestedOs, 		0) 
15226. 	SetVariable(GapRequestedOriginal, 	0) 
15227. 	
15228. 	# Gap Adjustments
15229. 	SetVariable(GapRounded, 			0)
15230. 	# SetVariable(GapAdjusted, 			0)
15231. 	SetVariable(GapAvailable, 			0)
15232. 	SetVariable(GapCurrent, 			0)
15233. 	SetVariable(GapActual, 				0)
15234. 	SetVariable(GapUsed, 				0)
15235. 	
15236. 	# Gap Adjustments
15237. 	SetVariable(GapRoundedLoc, 			0)
15238. 	# SetVariable(GapAdjustedLoc, 		0)
15239. 	SetVariable(GapAvailableLoc, 		0)
15240. 	SetVariable(GapCurrentLoc, 			0)
15241. 	SetVariable(GapActualLoc,			0)
15242. 	SetVariable(GapUsedLoc,				0)
15243. 	
15244. 	# Space usage
15245. 	SetVariable(ZoneFreePerRequested, 	0)
15246. 	SetVariable(ZoneFreePerUsed, 		0)
15247. 
15248. # Gap Size & Rounding
15249. 	SetVariable(ZoneGapSizePer, 		0)
15250. 	SetVariable(ZoneVolRoundUpPer, 		0)
15251. 	
15252. 	# Free Space
15253. 	SetVariable(ZoneFreeUsedPer, 		0)
15254. 	SetVariable(ZoneFreeRequestedPer, 	0)
15255. 
15256. 
15257. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
15258. 
15259. # Footer:
15260. SetVariable(ZoneFooter, "----------------------------------------------------------
15261. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:17
15262. 
15263. Statistics Report:
15264. ------------------
15265.    Size:  
15266.    ------------------------
15267.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15268.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15269.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15270. 
15271.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15272.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15273. 
15274.    Location:
15275.    ------------------------
15276.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15277.              Files End: !ZoneEndCurrent!
15278.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15279.       
15280.    Gap Settings:
15281.    ------------------------
15282.          Gap Requested: !ZoneGapSizePer!%
15283.       Volume Rounding: !ZoneVolRoundUpPer!%
15284.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15285.                  
15286.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15287.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15288.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15289.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15290.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15291.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15292.      
15293.    Free Space after Zone:
15294.    ------------------------
15295.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15296.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15297.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15298. 
15299. Directory and Files Select:
15300. ---------------------------
15301. !ZoneTypeSelectCurrent!               
15302. ---------------------------
15303. ----------------------------------------------------------
15304. ")
15305. 
15306. # BANNER SET
15307. 
15308. # DATE TIME RUN ELP
15309. 
15310. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
15311. /* Xinclude "..\BannerSet.MyDc"X */
15312. /* pause(1) */
15313. 
15314. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15315. 
15316. Title('!Heading!')
15317. /* pause(1) */
15318. 
15319. /* NOTE: Can't round or truncate to integer precision. */
15320. 
15321. AppendLogfile("!LogFileName!", "!Title!")
15322. 
15323. 
15324. 
15325. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
15326. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
15327. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:17")
15328. 
15329. SetVariable(ZoneListByLine, "!ZoneListByLine!
15330. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
15331. 
15332. 
15333. /* Fixed Zone Position Handling */
15334. /* Literal number: */
15335. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
15336. /* Percentage of disk: */
15337. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
15338. /* Gap */
15339. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
15340. 
15341. /* ---------------------------------------------------------- */
15342. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
15343. # FILE STEP
15344. 
15345. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15346. 
15347. /* add message and move to a new line. */
15348. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15349. ")
15350. 
15351. /* display the line. (hopefully.) */
15352. # Zone Footer Set Statistics Window Text
15353. 
15354. SetStatisticsWindowText("----------------------------------------------------------
15355. Zones Processed: 
15356. ----------------------------------------------------------
15357. !ZoneListByLine!
15358. ----------------------------------------------------------
15359. Zone Processing Step:
15360. !ZoneStepByLine!    
15361. ----------------------------------------------------------
15362. Current Zone:
15363. !ZoneFooter!
15364. ----------------------------------------------------------
15365. Volume Statistics:
15366. !VolumeStatisticsDetail!
15367. ----------------------------------------------------------
15368. Zone Detailed Report:
15369. ----------------------------------------------------------
15370. !ZoneStatisticsDetail!
15371. ----------------------------------------------------------
15372. ")
15373. 
15374. 
15375. 
15376. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15377. 
15378. # BANNER SET
15379. 
15380. # DATE TIME RUN ELP
15381. 
15382. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
15383. /* Xinclude "..\BannerSet.MyDc"X */
15384. /* pause(1) */
15385. 
15386. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15387. 
15388. Title('!Heading!')
15389. /* pause(1) */
15390. 
15391. /* NOTE: Can't round or truncate to integer precision. */
15392. 
15393. pause(1)
15394. 
15395. # your stuff HERE (X)... pre file select code.
15396. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
15397. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
15398. 	# (X)
15399. 
15400. FileSelect
15401. 
15402. 	# your stuff can't really go here (errors.)
15403. 	# maybe for some reason I don't know of...
15404. 	
15405. 	# Actions next...
15406. 	# People start.
15407. # NotBlobsArchivesBu start.
15408. (not (
15409. # Blobs start.
15410. (
15411. # BlobsAndExceptions start.
15412. ( not(
15413.   FileName("*.bat")
15414.   or FileName("*.css")
15415.   or FileName("*.dll")
15416.   or FileName("*.exe")
15417.   or FileName("*.htm*")
15418.   or FileName("*.jar")
15419.   or FileName("*.js")
15420.   or FileName("*.script")
15421.   or FileName("*.wsf")
15422.   or (
15423. # Databases start.
15424. (
15425.   FileName("*.crypt*")
15426.   or FileName("*.db*")
15427.   or FileName("*.rdb*")
15428.   or FileName("*.dc*")
15429.   or FileName("*.dict*")
15430.   or FileName("*.?db*")
15431.   or FileName("*.?rdb*")
15432.   or FileName("*.md*")
15433.   or FileName("*.myd")
15434.   or FileName("*.ndf")
15435.   or FileName("*.ns?")
15436.   or FileName("*.pab")
15437.   or FileName("*.pst")
15438.   or FileName("*.sd?*")
15439.   or FileName("*.sq**")
15440.   or FileName("*.tmd")
15441.   or FileName("*.tps")
15442.   or FileName("*.tr*")
15443. )
15444. # Databases end.
15445. 
15446.     # BlobsAndExceptions
15447.     or 
15448. # Data start.
15449. (
15450.   DirectoryName("Data*")
15451.   or DirectoryName("Device*")
15452.   or DirectoryName("Export*")
15453.   or DirectoryName("Import*")
15454.   or DirectoryName("Log*")
15455.   or DirectoryName("*Log")
15456.   or DirectoryName("Maintenance*")
15457.   or DirectoryName("Rec*")
15458.   or DirectoryName("Sales*")
15459.   or DirectoryName("Search*")
15460.   or DirectoryName("User*")
15461. )
15462. # Data end.
15463. 
15464.     # BlobsAndExceptions
15465.   )
15466. ) )
15467. # BlobsAndExceptions end.
15468. 
15469. # Blobs
15470. ) and (
15471.   Size(BlobFileSize,0)
15472.   or (
15473.     FileName("*.arj")
15474.     or FileName("*.bup")
15475.     or FileName("*.bz2")
15476.     or FileName("*.chm")
15477.     or FileName("*.dvr-ms")
15478.     or FileName("*.gz")
15479.     or FileName("*.ifo")
15480.     or FileName("*.lzh")
15481.     or FileName("*.pdf")
15482.     or FileName("*.rpm")
15483.     or FileName("*.wmv")
15484.     or FileName("*.vob")
15485.     or FileName("*.z")
15486.   ) 
15487. )
15488. # Blobs end.
15489. 
15490. # NotBlobsArchivesBu
15491. or 
15492. # Archives start.
15493. (
15494.   DirectoryName("*Archive*")
15495.   or DirectoryName("*History*")
15496.   or DirectoryName("*Old")
15497.   or DirectoryName("* Old *")
15498.   or DirectoryName("Old *")
15499. 
15500.   or FileName("*.7z")
15501.   or FileName("*.cab")
15502.   or FileName("*.iso")
15503.   or FileName("*.msi")
15504.   or FileName("*.old")
15505.   or FileName("*.rar")
15506.   or FileName("*.tar")
15507.   or FileName("*.zip")
15508.   or
15509. # WinSysLow start.
15510. (
15511.   DirectoryName("$*")
15512.   or DirectoryName("0*")
15513.   or DirectoryName("1*")
15514.   or DirectoryName("2*")
15515.   or DirectoryName("3*")
15516.   or DirectoryName("4*")
15517.   or DirectoryName("5*")
15518.   or DirectoryName("6*")
15519.   or DirectoryName("7*")
15520.   or DirectoryName("8*")
15521.   or DirectoryName("9*")
15522. 
15523.   or DirectoryName("dllcache")
15524.   or DirectoryName("Downloaded Installations")
15525.   or DirectoryName("Ehome")
15526.   or DirectoryName("Fonts")
15527.   or DirectoryName("Help")
15528.   or DirectoryName("I386")
15529.   or DirectoryName("ie?updates")
15530.   or DirectoryName("Installer")
15531.   or DirectoryName("Installshield Installation Information")
15532.   or DirectoryName("IME")
15533.   or DirectoryName("*RECYCLE*")
15534.   or DirectoryName("ServicePackFiles")
15535.   or DirectoryName("SoftwareDistribution")
15536.   or DirectoryName("Speech")
15537.   or DirectoryName("Symbols")
15538.   or DirectoryName("System Volume Information")
15539.   or DirectoryName("windows.old")
15540. )
15541. # WinSysLow end.
15542. 
15543.   # Archives
15544. )
15545. # Archives end.
15546. 
15547. # NotBlobsArchivesBu
15548. or
15549. # Backups start.
15550. (
15551.   DirectoryName("*Backup*")
15552.   or DirectoryName("*Bu")
15553.   or DirectoryName("* Bu *")
15554.   or DirectoryName("Bu *")
15555. 
15556.   or FileName("*.bak")
15557.   or FileName("* - Copy*")
15558. )
15559. # Backups end.
15560. 
15561. # NotBlobsArchivesBu
15562. ) )
15563. # NotBlobsArchivesBu end.
15564. 
15565. # People
15566. and (
15567. # People start.
15568. (
15569.   DirectoryName("*Capture*")
15570.   or DirectoryName("*Document*")
15571.   or DirectoryName("*Download*")
15572.   or DirectoryName("*Kids*")
15573.   or DirectoryName("Mail*")
15574.   or DirectoryName("*Mail")
15575.   or DirectoryName("My*")
15576.   or DirectoryName("*Person*")
15577.   or DirectoryName("Private*")
15578.   or DirectoryName("Users")
15579.   
15580.   # Individual People HERE:
15581.   or DirectoryName("Dgh*")
15582. )
15583. # People end.
15584. 
15585. # People
15586. )
15587. # People end.
15588. 
15589. 	# Zone
15590. # File Select
15591. 	# File Booleans
15592. 	# Resume...
15593. # File Action - SortByName.
15594. 
15595. FileActions
15596. 
15597. 		/* ---------------------------------------------------------- */
15598. 	# Gap
15599. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
15600. 		# FILE STEP
15601. 
15602. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
15603. 
15604. /* add message and move to a new line. */
15605. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
15606. ")
15607. 
15608. /* display the line. (hopefully.) */
15609. # Zone Footer Set Statistics Window Text
15610. 
15611. SetStatisticsWindowText("----------------------------------------------------------
15612. Zones Processed: 
15613. ----------------------------------------------------------
15614. !ZoneListByLine!
15615. ----------------------------------------------------------
15616. Zone Processing Step:
15617. !ZoneStepByLine!    
15618. ----------------------------------------------------------
15619. Current Zone:
15620. !ZoneFooter!
15621. ----------------------------------------------------------
15622. Volume Statistics:
15623. !VolumeStatisticsDetail!
15624. ----------------------------------------------------------
15625. Zone Detailed Report:
15626. ----------------------------------------------------------
15627. !ZoneStatisticsDetail!
15628. ----------------------------------------------------------
15629. ")
15630. 
15631. 
15632. 
15633. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
15634. 
15635. # BANNER SET
15636. 
15637. # DATE TIME RUN ELP
15638. 
15639. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
15640. /* Xinclude "..\BannerSet.MyDc"X */
15641. /* pause(1) */
15642. 
15643. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
15644. 
15645. Title('!Heading!')
15646. /* pause(1) */
15647. 
15648. /* NOTE: Can't round or truncate to integer precision. */
15649. 
15650. pause(1)
15651. 	
15652. 	# ACTUAL GAP
15653. 		/* AddGap Variant. */
15654. 	  	# Zone Do Gap
15655. # Gap Calculation Methods:
15656. 
15657. /* 1) Anything you need to add first. */
15658. /* empty */
15659. 
15660. /* ---------------------------------------------------------- */
15661. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
15662. 	# GapRequestedStd.
15663. 
15664. 		/* ---------------------------------------------------------- */
15665. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
15666. 
15667. 		# Gap Calculation Methods:
15668. 
15669. /* AddGap Variants */
15670. 
15671. 	/* Standard */
15672. 		# Gap Calculation Methods:
15673. 	/* AddGap Variants */
15674. 	/* Standard */
15675. 
15676. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
15677. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
15678. 
15679. 	SetVariable(GapRequested, GapRequestedStd)
15680. 	
15681. 
15682. 	/* MFT Low High Method */
15683. 		# Gap Calculation Methods:
15684. 	/* AddGap Variants */
15685. 	/* MFT Low High Method */
15686. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
15687. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
15688. 	SetVariable(GapRequested, GapRequestedMft)
15689. 	
15690. 
15691. 	/* OS Volume Type Method */
15692. 		# Gap Calculation Methods:
15693. 	/* AddGap Variants */
15694. 	/* OS Volume Type Method */
15695. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
15696. 	SetVariable(GapRequested, GapRequestedOs)
15697. 
15698. 
15699. 
15700. /* MakeGap Variants */
15701. 
15702. 	/* Original Os 1-3 + MFT 2 */
15703. 		# Gap Calculation Methods:
15704. 	/* MakeGap Variants */
15705. 	/* Original Os 1-3 + MFT 2 */
15706. 	/* plus MFT gap placed inline at the dividing zone. */
15707. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
15708. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
15709. 	SetVariable(GapRequested, GapRequestedOrig)
15710. 	
15711. 	
15712. /* Note: You could comment out the ones not in use */
15713. /* However having the data in the log is useful. */
15714. /* Therefore the following line is otherwise needed. */
15715. 
15716. /* Standard used */
15717. 
15718. SetVariable(GapRequested, GapRequestedStd)
15719. 
15720. # Gap Calculation Methods:
15721. 
15722. /* AddGap Variants */
15723. 	/* Standard */
15724. 	/* MFT Low High Method */
15725. 	/* OS Volume Type Method */
15726. 
15727. /* MakeGap Variants */
15728. 	/* Original Os 1-3 + MFT 2 */
15729. 
15730. /* Note: You could comment out the ones not in use */
15731. /* However having the data in the log is useful. */
15732. /* Therefore the following line is otherwise needed. */
15733. 
15734. /* Standard is used currently */
15735. 
15736. 
15737. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
15738. 
15739. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
15740. 
15741. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
15742. 
15743. /* ---------------------------------------------------------- */
15744. /* 3) SMALL ZONE ADJUSTMENT. */
15745. /* Gab cant be larger than half the Zone Size. */
15746. 
15747. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
15748. 	
15749. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
15750. 
15751. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
15752. 
15753. /* ---------------------------------------------------------- */
15754. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
15755. # Gap Adjustments.
15756. 
15757. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
15758. 	
15759. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
15760. 
15761. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
15762. 
15763. /* ---------------------------------------------------------- */
15764. # BYPASS THIS.
15765. 	/* This is definitely wrong. */
15766. 	/* The question is can we steal gap from the next zone */
15767. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
15768. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
15769. 		# Zone Overflow.
15770. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
15771. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
15772. 
15773. /* ---------------------------------------------------------- */
15774. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
15775. # Remaining free space available.
15776. 
15777. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
15778. 	
15779. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
15780. 
15781. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
15782. 
15783. /* ---------------------------------------------------------- */
15784. # CURRENT gap to use.
15785. 
15786. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
15787. 
15788. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
15789. 
15790. /* ---------------------------------------------------------- */
15791. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
15792. # Debugging.
15793. 
15794. 	SetVariable(GapUsed, GapCurrent) // for debugging
15795. 
15796. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
15797. 
15798. 		# Your code HERE
15799. 
15800. /* ---------------------------------------------------------- */
15801. /* 7) YOUR CODE. */
15802. # YOUR CODE HERE:
15803. 	# INPUT: GapCurrent or GapCurrentLoc
15804. 	# OUTPUT: GapUsed...
15805. 
15806. /* ---------------------------------------------------------- */
15807. # Gap Size.
15808. # Actual Size of Gap.
15809. 
15810. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
15811. 
15812. /* ---------------------------------------------------------- */
15813. /* xxxxxxxxxxxxxxxxxxxxxx */
15814. # ADD THE GAP
15815. 	/* Xinclude "..\GapCommandDo.MyDc"X */
15816. /* xxxxxxxxxxxxxxxxxxxxxx */
15817. 
15818. 	
15819. 	# Zone Statistics	
15820. 	# Zone / Volume Statistics and Display
15821. 		
15822. 	# Accumulate Totals
15823.   	# Volume totals
15824. 
15825. /* Current total space used (by Zones and Gaps) */
15826. 
15827. SetVariable(VolumeZoneUsed, GapUsed)
15828. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
15829. /* Percentage */
15830. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
15831. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
15832. 
15833. /* Current total of free space requested */
15834. 
15835. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
15836. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
15837. /* Percent. */
15838. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
15839. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
15840. 
15841. /* Current total of free space used */
15842. 
15843. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
15844. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
15845. /* Percent */
15846. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
15847. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
15848. 
15849. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
15850. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
15851. /* Xinclude "..\DebugDisplayPause.MyDc"X */
15852. 
15853. 
15854. 	# Current Values
15855. 	# Cluster, Sector, Block adjust for display.
15856. 	# Bytes per cluster is volume specific.
15857. 
15858. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
15859. 
15860. # Current Zone values.
15861. 	# Begin, end and size.
15862. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
15863. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
15864. 
15865. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
15866. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
15867. 
15868. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
15869. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
15870. 
15871. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
15872. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
15873. 
15874. 	SetVariable(ZoneFragments,				"!ZONE210N!")
15875. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
15876. 		
15877. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
15878. /* identical code to here: (separation not needed. TEST.) */	
15879. 
15880. # Current Gap, Actual and Free Values
15881. 	# Gap
15882. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
15883. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
15884. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
15885. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
15886. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
15887. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
15888. 	
15889. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
15890. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
15891. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
15892. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
15893. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
15894. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
15895. 	
15896. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
15897. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
15898. 	
15899. 	# Actual Size and End
15900. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
15901. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
15902. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
15903. 	
15904. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
15905. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
15906. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
15907. 
15908. # Gap Size & Rounding
15909. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
15910. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
15911. 	
15912. 	# Free Space
15913. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
15914. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
15915. 
15916. 	# Footer:
15917. SetVariable(ZoneFooter, "----------------------------------------------------------
15918. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:17
15919. 
15920. Statistics Report:
15921. ------------------
15922.    Size:  
15923.    ------------------------
15924.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
15925.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
15926.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
15927. 
15928.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
15929.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
15930. 
15931.    Location:
15932.    ------------------------
15933.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
15934.              Files End: !ZoneEndCurrent!
15935.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
15936.       
15937.    Gap Settings:
15938.    ------------------------
15939.          Gap Requested: !ZoneGapSizePer!%
15940.       Volume Rounding: !ZoneVolRoundUpPer!%
15941.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
15942.                  
15943.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
15944.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
15945.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
15946.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
15947.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
15948.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
15949.      
15950.    Free Space after Zone:
15951.    ------------------------
15952.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
15953.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
15954.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
15955. 
15956. Directory and Files Select:
15957. ---------------------------
15958. !ZoneTypeSelectCurrent!               
15959. ---------------------------
15960. ----------------------------------------------------------
15961. ")
15962. 	# Zone Footer Set Statistics Window Text
15963. 
15964. SetStatisticsWindowText("----------------------------------------------------------
15965. Zones Processed: 
15966. ----------------------------------------------------------
15967. !ZoneListByLine!
15968. ----------------------------------------------------------
15969. Zone Processing Step:
15970. !ZoneStepByLine!    
15971. ----------------------------------------------------------
15972. Current Zone:
15973. !ZoneFooter!
15974. ----------------------------------------------------------
15975. Volume Statistics:
15976. !VolumeStatisticsDetail!
15977. ----------------------------------------------------------
15978. Zone Detailed Report:
15979. ----------------------------------------------------------
15980. !ZoneStatisticsDetail!
15981. ----------------------------------------------------------
15982. ")
15983. 
15984. 
15985. 	
15986.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
15987. 
15988. 	# Add Zone to list of zones for display.
15989. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
15990. 
15991. 	# Footer:
15992. SetVariable(ZoneFooter, "----------------------------------------------------------
15993. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:17
15994. 
15995. Statistics Report:
15996. ------------------
15997.    Size:  
15998.    ------------------------
15999.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16000.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16001.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16002. 
16003.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16004.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16005. 
16006.    Location:
16007.    ------------------------
16008.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16009.              Files End: !ZoneEndCurrent!
16010.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16011.       
16012.    Gap Settings:
16013.    ------------------------
16014.          Gap Requested: !ZoneGapSizePer!%
16015.       Volume Rounding: !ZoneVolRoundUpPer!%
16016.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16017.                  
16018.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16019.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16020.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16021.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16022.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16023.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16024.      
16025.    Free Space after Zone:
16026.    ------------------------
16027.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16028.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16029.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16030. 
16031. Directory and Files Select:
16032. ---------------------------
16033. !ZoneTypeSelectCurrent!               
16034. ---------------------------
16035. ----------------------------------------------------------
16036. ")
16037. 
16038. 	# Add Zone Details to Report.	
16039. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
16040. !ZoneFooter!")
16041. 
16042. 
16043. 
16044. 	# DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
16045. 		/* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
16046. 		/* Xinclude "..\DebugDisplayPause.MyDc"X */
16047. 
16048.   	# Zone Statistics	
16049.   	/* Xinclude "..\ZoneDoStatistics.MyDc"X */
16050. 
16051. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
16052. 	# FILE STEP
16053. 
16054. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16055. 
16056. /* add message and move to a new line. */
16057. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16058. ")
16059. 
16060. /* display the line. (hopefully.) */
16061. # Zone Footer Set Statistics Window Text
16062. 
16063. SetStatisticsWindowText("----------------------------------------------------------
16064. Zones Processed: 
16065. ----------------------------------------------------------
16066. !ZoneListByLine!
16067. ----------------------------------------------------------
16068. Zone Processing Step:
16069. !ZoneStepByLine!    
16070. ----------------------------------------------------------
16071. Current Zone:
16072. !ZoneFooter!
16073. ----------------------------------------------------------
16074. Volume Statistics:
16075. !VolumeStatisticsDetail!
16076. ----------------------------------------------------------
16077. Zone Detailed Report:
16078. ----------------------------------------------------------
16079. !ZoneStatisticsDetail!
16080. ----------------------------------------------------------
16081. ")
16082. 
16083. 
16084. 
16085. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16086. 
16087. # BANNER SET
16088. 
16089. # DATE TIME RUN ELP
16090. 
16091. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
16092. /* Xinclude "..\BannerSet.MyDc"X */
16093. /* pause(1) */
16094. 
16095. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16096. 
16097. Title('!Heading!')
16098. /* pause(1) */
16099. 
16100. /* NOTE: Can't round or truncate to integer precision. */
16101. 
16102. pause(1)
16103. 
16104. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
16105. 	
16106. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
16107. 	# FILE STEP
16108. 
16109. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16110. 
16111. /* add message and move to a new line. */
16112. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16113. ")
16114. 
16115. /* display the line. (hopefully.) */
16116. # Zone Footer Set Statistics Window Text
16117. 
16118. SetStatisticsWindowText("----------------------------------------------------------
16119. Zones Processed: 
16120. ----------------------------------------------------------
16121. !ZoneListByLine!
16122. ----------------------------------------------------------
16123. Zone Processing Step:
16124. !ZoneStepByLine!    
16125. ----------------------------------------------------------
16126. Current Zone:
16127. !ZoneFooter!
16128. ----------------------------------------------------------
16129. Volume Statistics:
16130. !VolumeStatisticsDetail!
16131. ----------------------------------------------------------
16132. Zone Detailed Report:
16133. ----------------------------------------------------------
16134. !ZoneStatisticsDetail!
16135. ----------------------------------------------------------
16136. ")
16137. 
16138. 
16139. 
16140. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16141. 
16142. # BANNER SET
16143. 
16144. # DATE TIME RUN ELP
16145. 
16146. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
16147. /* Xinclude "..\BannerSet.MyDc"X */
16148. /* pause(1) */
16149. 
16150. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16151. 
16152. Title('!Heading!')
16153. /* pause(1) */
16154. 
16155. /* NOTE: Can't round or truncate to integer precision. */
16156. 
16157. pause(1)
16158. 
16159. 	# Footer next...
16160. 	
16161. 	# Zone Do Footer
16162. 
16163. /* ---------------------------------------------------------- */
16164. # File Select
16165. 	# Select Statments
16166. # File Actions 
16167. 	# Standard or OS File Actions.
16168. 	# Resume...
16169. 	
16170. 	# your stuff HERE (X)... post zone (file) file actions code.
16171. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
16172. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
16173. 		# (X)
16174. 		
16175. 		/* ??? Set window? */
16176. 	
16177. 	# ADD THE GAP
16178. 		
16179. # Vacate (good for diagnostics)
16180. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
16181. 
16182. # DoNotVacate - DO NOT Vacate (recommended)
16183. 
16184. # Vacate
16185. /* AddGap(GapUsedLoc) */
16186. 
16187. # DO Not Vacate
16188. AddGap(GapUsedLoc, DoNotVacate) 
16189. 	
16190. 	
16191. /* ---------------------------------------------------------- */
16192. # (failed) TEST for boolean logic.
16193. 
16194. /* It should work in the gap calculations for turning options */
16195. /* on and off but it will NOT work here. */
16196. 
16197. /* Boolean setting X or FlagX. */
16198. /* Where X will be on or off: */
16199. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
16200. /*      For ON:  (X  *  FlagAny) */
16201. 
16202. /* 1) Failed, zero gap overrode the previous one. */
16203. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
16204. /* AddGap(GapUsedTemp) */ 
16205. 
16206. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
16207. /* AddGap(GapUsedTemp, DoNotVacate) */ 
16208. 
16209. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
16210. 
16211. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
16212. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
16213. /* AddGap(GapUsedTemp) */ 
16214. 
16215. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
16216. /* AddGap(GapUsedTemp, DoNotVacate) */ 
16217. 
16218. /* ---------------------------------------------------------- */
16219. 
16220. # Vacate
16221. /* AddGap(GapUsed) */
16222. 
16223. # DO NOT Vacate (recommended)
16224. /* AddGap(GapUsed, DoNotVacate) */ 
16225. 	
16226. 
16227. 		
16228. # 
16229. FileEnd
16230. /* ---------------------------------------------------------- */
16231. 
16232. # your stuff HERE (X)... post zone (file) code.
16233. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
16234. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
16235. 	# (X)
16236. 
16237. SetVariable(FileStepDescription,"Zone finished, reporting.")
16238. # FILE STEP
16239. 
16240. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16241. 
16242. /* add message and move to a new line. */
16243. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16244. ")
16245. 
16246. /* display the line. (hopefully.) */
16247. # Zone Footer Set Statistics Window Text
16248. 
16249. SetStatisticsWindowText("----------------------------------------------------------
16250. Zones Processed: 
16251. ----------------------------------------------------------
16252. !ZoneListByLine!
16253. ----------------------------------------------------------
16254. Zone Processing Step:
16255. !ZoneStepByLine!    
16256. ----------------------------------------------------------
16257. Current Zone:
16258. !ZoneFooter!
16259. ----------------------------------------------------------
16260. Volume Statistics:
16261. !VolumeStatisticsDetail!
16262. ----------------------------------------------------------
16263. Zone Detailed Report:
16264. ----------------------------------------------------------
16265. !ZoneStatisticsDetail!
16266. ----------------------------------------------------------
16267. ")
16268. 
16269. 
16270. 
16271. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16272. 
16273. # BANNER SET
16274. 
16275. # DATE TIME RUN ELP
16276. 
16277. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
16278. /* Xinclude "..\BannerSet.MyDc"X */
16279. /* pause(1) */
16280. 
16281. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16282. 
16283. Title('!Heading!')
16284. /* pause(1) */
16285. 
16286. /* NOTE: Can't round or truncate to integer precision. */
16287. 
16288. pause(1)
16289. 
16290. # Zone When Finished
16291. 
16292. # BANNER SET
16293. 
16294. # DATE TIME RUN ELP
16295. 
16296. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
16297. /* Xinclude "..\BannerSet.MyDc"X */
16298. /* pause(1) */
16299. 
16300. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16301. 
16302. Title('!Heading!')
16303. /* pause(1) */
16304. 
16305. /* NOTE: Can't round or truncate to integer precision. */
16306. 
16307. AppendLogfile("!LogFileName!", "!Title!")
16308. 
16309. 
16310. 
16311. # Zone Statistics	
16312. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
16313. 
16314. # Footer:
16315. SetVariable(ZoneFooter, "----------------------------------------------------------
16316. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:17
16317. 
16318. Statistics Report:
16319. ------------------
16320.    Size:  
16321.    ------------------------
16322.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16323.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16324.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16325. 
16326.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16327.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16328. 
16329.    Location:
16330.    ------------------------
16331.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16332.              Files End: !ZoneEndCurrent!
16333.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16334.       
16335.    Gap Settings:
16336.    ------------------------
16337.          Gap Requested: !ZoneGapSizePer!%
16338.       Volume Rounding: !ZoneVolRoundUpPer!%
16339.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16340.                  
16341.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16342.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16343.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16344.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16345.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16346.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16347.      
16348.    Free Space after Zone:
16349.    ------------------------
16350.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16351.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16352.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16353. 
16354. Directory and Files Select:
16355. ---------------------------
16356. !ZoneTypeSelectCurrent!               
16357. ---------------------------
16358. ----------------------------------------------------------
16359. ")
16360. 
16361. AppendLogfile("!LogFileName!", ".")
16362. AppendLogfile("!LogFileName!", "!ZoneFooter!")
16363. AppendLogfile("!LogFileName!", ".")
16364. 
16365. # Zone Footer Set Statistics Window Text
16366. 
16367. SetStatisticsWindowText("----------------------------------------------------------
16368. Zones Processed: 
16369. ----------------------------------------------------------
16370. !ZoneListByLine!
16371. ----------------------------------------------------------
16372. Zone Processing Step:
16373. !ZoneStepByLine!    
16374. ----------------------------------------------------------
16375. Current Zone:
16376. !ZoneFooter!
16377. ----------------------------------------------------------
16378. Volume Statistics:
16379. !VolumeStatisticsDetail!
16380. ----------------------------------------------------------
16381. Zone Detailed Report:
16382. ----------------------------------------------------------
16383. !ZoneStatisticsDetail!
16384. ----------------------------------------------------------
16385. ")
16386. 
16387. 
16388. 
16389. /* pause() */
16390. /* pause() */
16391. 
16392. 
16393. 
16394. 
16395. /* ---------------------------------------------------------- */
16396. 
16397. 
16398. /* ---------------------------------------------------------- */
16399. // "4" & "5" now 8 & 9
16400. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
16401. /* Process MFT & Dir's HERE. */
16402. 	SetVariable(FileStepDescription,"Calculating Gap for MFT and DIR.")
16403. # BANNER SET
16404. 
16405. # DATE TIME RUN ELP
16406. 
16407. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
16408. /* Xinclude "..\BannerSet.MyDc"X */
16409. /* pause(1) */
16410. 
16411. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16412. 
16413. Title('!Heading!')
16414. /* pause(1) */
16415. 
16416. /* NOTE: Can't round or truncate to integer precision. */
16417. 
16418. AppendLogfile("!LogFileName!", "!Title!")
16419. 
16420. 
16421. 
16422. 
16423. AppendLogfile("!LogFileName!", "MftLocation: !MftLocation! DoNotVacate 2021-10-24 14:34:17")
16424. 
16425. SetVariable(MftGapSlack, MftLocation - VolumeUsedTotal)
16426. AppendLogfile("!LogFileName!", "MftGapSlack: !MftGapSlack!")
16427. 
16428. SetVariable(MftGapSlackPerUsed, MftGapSlack / VolumeFreeAdj)
16429. AppendLogfile("!LogFileName!", "MftGapSlackPerUsed: !MftGapSlackPerUsed!")
16430. 
16431. AppendLogfile("!LogFileName!", "VolumeUsed before: !VolumeUsedTotal!")
16432. SetVariable(VolumeUsedTotal, MftLocation)
16433. AppendLogfile("!LogFileName!", "VolumeUsed at location: !VolumeUsedTotal!")
16434. 
16435. SetVariable(VolumeFreePerUsed, VolumeFreePerUsed + (MftGapSlack / VolumeFree))
16436. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!")
16437. 
16438. /* ---------------------------------------------------------- */
16439. #  MFT
16440. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
16441. 
16442. /* ---------------------------------------------------------- */
16443. /* Mft Method: MakeGap(MftLocation, DoNotVacate) */ 
16444.   
16445. SetVariable(ZoneLabel,				"MFT") // "4" 
16446. SetVariable(ZoneDescription, 		"MFT - Master File Table")
16447. SetVariable(ZoneCurrentAjust, 		1)
16448. /* and some other special NTFS files. */
16449. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpMft!")
16450. SetVariable(ZoneGapSize, 			"!ZoneGapSizeMft!")
16451. SetVariable(ZoneTypeSelect,'# MFT start.
16452. SelectNtfsSystemFiles(yes)
16453. # MFT end.')
16454. 
16455. 	# Zone Do Header
16456. 
16457. # Zone When Started
16458. 
16459. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
16460. # Display Set Zone
16461. 
16462. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
16463. SetVariable(FileStepDescription,	"")
16464. 
16465. SetVariable(ZoneStepByLine, 			"Zone started.
16466. ")
16467. 
16468. # BANNER SET
16469. 
16470. # DATE TIME RUN ELP
16471. 
16472. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:17 0:00:03")
16473. /* Xinclude "..\BannerSet.MyDc"X */
16474. /* pause(1) */
16475. 
16476. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16477. 
16478. Title('!Heading!')
16479. /* pause(1) */
16480. 
16481. /* NOTE: Can't round or truncate to integer precision. */
16482. 
16483. AppendLogfile("!LogFileName!", "!Title!")
16484. 
16485. 
16486. 
16487. pause(1)
16488. 
16489. 
16490. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
16491. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
16492. 
16493. SetVariable(ZoneStepNoCurrent, 0)
16494. 
16495. 
16496. # Zone Do Current Clear
16497. 
16498. SetVariable(ZoneTypeSelectCurrent, 		"")
16499. 
16500. SetVariable(ZoneBeginCurrent, 			0)
16501. SetVariable(ZoneBeginPerCurrent, 		0)
16502. SetVariable(ZoneEndCurrent, 			0)
16503. SetVariable(ZoneEndPerCurrent, 			0)
16504. 
16505. SetVariable(ZoneSizeCurrent,			0)
16506. SetVariable(ZoneSizePerCurrent,			0)
16507. 
16508. SetVariable(ZoneGapRequestedCurrent,	0)
16509. SetVariable(ZoneGapRoundedCurrent, 		0)
16510. SetVariable(ZoneGapAdjustedCurrent, 	0)
16511. SetVariable(ZoneGapAvailableCurrent, 	0)
16512. SetVariable(ZoneGapCurrent,				0)
16513. SetVariable(ZoneGapUsedCurrent, 		0)
16514. 
16515. SetVariable(ZoneGapActualCurrent, 		0)
16516. SetVariable(ZoneGapActualPerCurrent, 	0)
16517. 
16518. SetVariable(ZoneSizeActual, 			0)
16519. SetVariable(ZoneSizeActualCurrent,		0)
16520. 
16521. SetVariable(ZoneEndActual, 				0)
16522. SetVariable(ZoneEndActualCurrent,		0)			
16523. SetVariable(ZoneSizeActualPerCurrent, 	0)
16524.       
16525. SetVariable(ZoneFilesFolders,			0)
16526. SetVariable(ZoneFilesFoldersPer,		0) 
16527. 
16528. SetVariable(ZoneFragments,				0)
16529. SetVariable(ZoneFragmentsPer,			0) 
16530. 		
16531. SetVariable(ZoneEndActualCurrent, 		0)
16532. SetVariable(ZoneEndActualPerCurrent, 	0)
16533. 
16534. # Gap Calculation Methodology:
16535. 	# Requested
16536. 	SetVariable(GapRequested, 			0) 
16537. 	SetVariable(GapRequestedStd, 		0) 
16538. 	SetVariable(GapRequestedMft, 		0) 
16539. 	SetVariable(GapRequestedOs, 		0) 
16540. 	SetVariable(GapRequestedOriginal, 	0) 
16541. 	
16542. 	# Gap Adjustments
16543. 	SetVariable(GapRounded, 			0)
16544. 	# SetVariable(GapAdjusted, 			0)
16545. 	SetVariable(GapAvailable, 			0)
16546. 	SetVariable(GapCurrent, 			0)
16547. 	SetVariable(GapActual, 				0)
16548. 	SetVariable(GapUsed, 				0)
16549. 	
16550. 	# Gap Adjustments
16551. 	SetVariable(GapRoundedLoc, 			0)
16552. 	# SetVariable(GapAdjustedLoc, 		0)
16553. 	SetVariable(GapAvailableLoc, 		0)
16554. 	SetVariable(GapCurrentLoc, 			0)
16555. 	SetVariable(GapActualLoc,			0)
16556. 	SetVariable(GapUsedLoc,				0)
16557. 	
16558. 	# Space usage
16559. 	SetVariable(ZoneFreePerRequested, 	0)
16560. 	SetVariable(ZoneFreePerUsed, 		0)
16561. 
16562. # Gap Size & Rounding
16563. 	SetVariable(ZoneGapSizePer, 		0)
16564. 	SetVariable(ZoneVolRoundUpPer, 		0)
16565. 	
16566. 	# Free Space
16567. 	SetVariable(ZoneFreeUsedPer, 		0)
16568. 	SetVariable(ZoneFreeRequestedPer, 	0)
16569. 
16570. 
16571. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
16572. 
16573. # Footer:
16574. SetVariable(ZoneFooter, "----------------------------------------------------------
16575. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
16576. 
16577. Statistics Report:
16578. ------------------
16579.    Size:  
16580.    ------------------------
16581.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
16582.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
16583.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
16584. 
16585.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
16586.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
16587. 
16588.    Location:
16589.    ------------------------
16590.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
16591.              Files End: !ZoneEndCurrent!
16592.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
16593.       
16594.    Gap Settings:
16595.    ------------------------
16596.          Gap Requested: !ZoneGapSizePer!%
16597.       Volume Rounding: !ZoneVolRoundUpPer!%
16598.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
16599.                  
16600.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
16601.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
16602.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
16603.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
16604.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
16605.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
16606.      
16607.    Free Space after Zone:
16608.    ------------------------
16609.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
16610.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
16611.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
16612. 
16613. Directory and Files Select:
16614. ---------------------------
16615. !ZoneTypeSelectCurrent!               
16616. ---------------------------
16617. ----------------------------------------------------------
16618. ")
16619. 
16620. # BANNER SET
16621. 
16622. # DATE TIME RUN ELP
16623. 
16624. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
16625. /* Xinclude "..\BannerSet.MyDc"X */
16626. /* pause(1) */
16627. 
16628. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16629. 
16630. Title('!Heading!')
16631. /* pause(1) */
16632. 
16633. /* NOTE: Can't round or truncate to integer precision. */
16634. 
16635. AppendLogfile("!LogFileName!", "!Title!")
16636. 
16637. 
16638. 
16639. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
16640. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
16641. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:17")
16642. 
16643. SetVariable(ZoneListByLine, "!ZoneListByLine!
16644. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
16645. 
16646. 
16647. /* Fixed Zone Position Handling */
16648. /* Literal number: */
16649. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
16650. /* Percentage of disk: */
16651. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
16652. /* Gap */
16653. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
16654. 
16655. /* ---------------------------------------------------------- */
16656. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
16657. # FILE STEP
16658. 
16659. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16660. 
16661. /* add message and move to a new line. */
16662. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16663. ")
16664. 
16665. /* display the line. (hopefully.) */
16666. # Zone Footer Set Statistics Window Text
16667. 
16668. SetStatisticsWindowText("----------------------------------------------------------
16669. Zones Processed: 
16670. ----------------------------------------------------------
16671. !ZoneListByLine!
16672. ----------------------------------------------------------
16673. Zone Processing Step:
16674. !ZoneStepByLine!    
16675. ----------------------------------------------------------
16676. Current Zone:
16677. !ZoneFooter!
16678. ----------------------------------------------------------
16679. Volume Statistics:
16680. !VolumeStatisticsDetail!
16681. ----------------------------------------------------------
16682. Zone Detailed Report:
16683. ----------------------------------------------------------
16684. !ZoneStatisticsDetail!
16685. ----------------------------------------------------------
16686. ")
16687. 
16688. 
16689. 
16690. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16691. 
16692. # BANNER SET
16693. 
16694. # DATE TIME RUN ELP
16695. 
16696. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
16697. /* Xinclude "..\BannerSet.MyDc"X */
16698. /* pause(1) */
16699. 
16700. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16701. 
16702. Title('!Heading!')
16703. /* pause(1) */
16704. 
16705. /* NOTE: Can't round or truncate to integer precision. */
16706. 
16707. pause(1)
16708. 
16709. # your stuff HERE (X)... pre file select code.
16710. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
16711. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
16712. 	# (X)
16713. 
16714. FileSelect
16715. 
16716. 	# your stuff can't really go here (errors.)
16717. 	# maybe for some reason I don't know of...
16718. 	
16719. 	# Actions next...
16720. 	# MFT start.
16721. SelectNtfsSystemFiles(yes)
16722. # MFT end.
16723. 	FileActions
16724. 	  		/* ---------------------------------------------------------- */
16725. 	# Gap
16726. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
16727. 		# FILE STEP
16728. 
16729. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
16730. 
16731. /* add message and move to a new line. */
16732. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
16733. ")
16734. 
16735. /* display the line. (hopefully.) */
16736. # Zone Footer Set Statistics Window Text
16737. 
16738. SetStatisticsWindowText("----------------------------------------------------------
16739. Zones Processed: 
16740. ----------------------------------------------------------
16741. !ZoneListByLine!
16742. ----------------------------------------------------------
16743. Zone Processing Step:
16744. !ZoneStepByLine!    
16745. ----------------------------------------------------------
16746. Current Zone:
16747. !ZoneFooter!
16748. ----------------------------------------------------------
16749. Volume Statistics:
16750. !VolumeStatisticsDetail!
16751. ----------------------------------------------------------
16752. Zone Detailed Report:
16753. ----------------------------------------------------------
16754. !ZoneStatisticsDetail!
16755. ----------------------------------------------------------
16756. ")
16757. 
16758. 
16759. 
16760. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
16761. 
16762. # BANNER SET
16763. 
16764. # DATE TIME RUN ELP
16765. 
16766. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
16767. /* Xinclude "..\BannerSet.MyDc"X */
16768. /* pause(1) */
16769. 
16770. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
16771. 
16772. Title('!Heading!')
16773. /* pause(1) */
16774. 
16775. /* NOTE: Can't round or truncate to integer precision. */
16776. 
16777. pause(1)
16778. 	
16779. 	# ACTUAL GAP
16780. 		/* AddGap Variant. */
16781. 	  	# Zone Do Gap
16782. # Gap Calculation Methods:
16783. 
16784. /* 1) Anything you need to add first. */
16785. /* empty */
16786. 
16787. /* ---------------------------------------------------------- */
16788. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
16789. 	# GapRequestedStd.
16790. 
16791. 		/* ---------------------------------------------------------- */
16792. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
16793. 
16794. 		# Gap Calculation Methods:
16795. 
16796. /* AddGap Variants */
16797. 
16798. 	/* Standard */
16799. 		# Gap Calculation Methods:
16800. 	/* AddGap Variants */
16801. 	/* Standard */
16802. 
16803. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
16804. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
16805. 
16806. 	SetVariable(GapRequested, GapRequestedStd)
16807. 	
16808. 
16809. 	/* MFT Low High Method */
16810. 		# Gap Calculation Methods:
16811. 	/* AddGap Variants */
16812. 	/* MFT Low High Method */
16813. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
16814. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
16815. 	SetVariable(GapRequested, GapRequestedMft)
16816. 	
16817. 
16818. 	/* OS Volume Type Method */
16819. 		# Gap Calculation Methods:
16820. 	/* AddGap Variants */
16821. 	/* OS Volume Type Method */
16822. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
16823. 	SetVariable(GapRequested, GapRequestedOs)
16824. 
16825. 
16826. 
16827. /* MakeGap Variants */
16828. 
16829. 	/* Original Os 1-3 + MFT 2 */
16830. 		# Gap Calculation Methods:
16831. 	/* MakeGap Variants */
16832. 	/* Original Os 1-3 + MFT 2 */
16833. 	/* plus MFT gap placed inline at the dividing zone. */
16834. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
16835. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
16836. 	SetVariable(GapRequested, GapRequestedOrig)
16837. 	
16838. 	
16839. /* Note: You could comment out the ones not in use */
16840. /* However having the data in the log is useful. */
16841. /* Therefore the following line is otherwise needed. */
16842. 
16843. /* Standard used */
16844. 
16845. SetVariable(GapRequested, GapRequestedStd)
16846. 
16847. # Gap Calculation Methods:
16848. 
16849. /* AddGap Variants */
16850. 	/* Standard */
16851. 	/* MFT Low High Method */
16852. 	/* OS Volume Type Method */
16853. 
16854. /* MakeGap Variants */
16855. 	/* Original Os 1-3 + MFT 2 */
16856. 
16857. /* Note: You could comment out the ones not in use */
16858. /* However having the data in the log is useful. */
16859. /* Therefore the following line is otherwise needed. */
16860. 
16861. /* Standard is used currently */
16862. 
16863. 
16864. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
16865. 
16866. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
16867. 
16868. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
16869. 
16870. /* ---------------------------------------------------------- */
16871. /* 3) SMALL ZONE ADJUSTMENT. */
16872. /* Gab cant be larger than half the Zone Size. */
16873. 
16874. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
16875. 	
16876. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
16877. 
16878. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
16879. 
16880. /* ---------------------------------------------------------- */
16881. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
16882. # Gap Adjustments.
16883. 
16884. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
16885. 	
16886. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
16887. 
16888. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
16889. 
16890. /* ---------------------------------------------------------- */
16891. # BYPASS THIS.
16892. 	/* This is definitely wrong. */
16893. 	/* The question is can we steal gap from the next zone */
16894. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
16895. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
16896. 		# Zone Overflow.
16897. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
16898. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
16899. 
16900. /* ---------------------------------------------------------- */
16901. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
16902. # Remaining free space available.
16903. 
16904. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
16905. 	
16906. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
16907. 
16908. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
16909. 
16910. /* ---------------------------------------------------------- */
16911. # CURRENT gap to use.
16912. 
16913. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
16914. 
16915. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
16916. 
16917. /* ---------------------------------------------------------- */
16918. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
16919. # Debugging.
16920. 
16921. 	SetVariable(GapUsed, GapCurrent) // for debugging
16922. 
16923. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
16924. 
16925. 		# Your code HERE
16926. 
16927. /* ---------------------------------------------------------- */
16928. /* 7) YOUR CODE. */
16929. # YOUR CODE HERE:
16930. 	# INPUT: GapCurrent or GapCurrentLoc
16931. 	# OUTPUT: GapUsed...
16932. 
16933. /* ---------------------------------------------------------- */
16934. # Gap Size.
16935. # Actual Size of Gap.
16936. 
16937. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
16938. 
16939. /* ---------------------------------------------------------- */
16940. /* xxxxxxxxxxxxxxxxxxxxxx */
16941. # ADD THE GAP
16942. 	/* Xinclude "..\GapCommandDo.MyDc"X */
16943. /* xxxxxxxxxxxxxxxxxxxxxx */
16944. 
16945. 	
16946. 	# Zone Statistics	
16947. 	# Zone / Volume Statistics and Display
16948. 		
16949. 	# Accumulate Totals
16950.   	# Volume totals
16951. 
16952. /* Current total space used (by Zones and Gaps) */
16953. 
16954. SetVariable(VolumeZoneUsed, GapUsed)
16955. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
16956. /* Percentage */
16957. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
16958. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
16959. 
16960. /* Current total of free space requested */
16961. 
16962. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
16963. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16964. /* Percent. */
16965. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
16966. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
16967. 
16968. /* Current total of free space used */
16969. 
16970. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
16971. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
16972. /* Percent */
16973. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
16974. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
16975. 
16976. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
16977. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
16978. /* Xinclude "..\DebugDisplayPause.MyDc"X */
16979. 
16980. 
16981. 	# Current Values
16982. 	# Cluster, Sector, Block adjust for display.
16983. 	# Bytes per cluster is volume specific.
16984. 
16985. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
16986. 
16987. # Current Zone values.
16988. 	# Begin, end and size.
16989. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
16990. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
16991. 
16992. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
16993. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
16994. 
16995. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
16996. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
16997. 
16998. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
16999. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
17000. 
17001. 	SetVariable(ZoneFragments,				"!ZONE210N!")
17002. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
17003. 		
17004. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
17005. /* identical code to here: (separation not needed. TEST.) */	
17006. 
17007. # Current Gap, Actual and Free Values
17008. 	# Gap
17009. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
17010. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
17011. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
17012. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
17013. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
17014. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
17015. 	
17016. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
17017. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
17018. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
17019. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
17020. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
17021. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
17022. 	
17023. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
17024. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
17025. 	
17026. 	# Actual Size and End
17027. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
17028. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
17029. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
17030. 	
17031. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
17032. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
17033. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
17034. 
17035. # Gap Size & Rounding
17036. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
17037. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
17038. 	
17039. 	# Free Space
17040. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
17041. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
17042. 
17043. 	# Footer:
17044. SetVariable(ZoneFooter, "----------------------------------------------------------
17045. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
17046. 
17047. Statistics Report:
17048. ------------------
17049.    Size:  
17050.    ------------------------
17051.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17052.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17053.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17054. 
17055.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17056.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17057. 
17058.    Location:
17059.    ------------------------
17060.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17061.              Files End: !ZoneEndCurrent!
17062.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17063.       
17064.    Gap Settings:
17065.    ------------------------
17066.          Gap Requested: !ZoneGapSizePer!%
17067.       Volume Rounding: !ZoneVolRoundUpPer!%
17068.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17069.                  
17070.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17071.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17072.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17073.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17074.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17075.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17076.      
17077.    Free Space after Zone:
17078.    ------------------------
17079.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17080.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17081.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17082. 
17083. Directory and Files Select:
17084. ---------------------------
17085. !ZoneTypeSelectCurrent!               
17086. ---------------------------
17087. ----------------------------------------------------------
17088. ")
17089. 	# Zone Footer Set Statistics Window Text
17090. 
17091. SetStatisticsWindowText("----------------------------------------------------------
17092. Zones Processed: 
17093. ----------------------------------------------------------
17094. !ZoneListByLine!
17095. ----------------------------------------------------------
17096. Zone Processing Step:
17097. !ZoneStepByLine!    
17098. ----------------------------------------------------------
17099. Current Zone:
17100. !ZoneFooter!
17101. ----------------------------------------------------------
17102. Volume Statistics:
17103. !VolumeStatisticsDetail!
17104. ----------------------------------------------------------
17105. Zone Detailed Report:
17106. ----------------------------------------------------------
17107. !ZoneStatisticsDetail!
17108. ----------------------------------------------------------
17109. ")
17110. 
17111. 
17112. 	
17113.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
17114. 
17115. 	# Add Zone to list of zones for display.
17116. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
17117. 
17118. 	# Footer:
17119. SetVariable(ZoneFooter, "----------------------------------------------------------
17120. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
17121. 
17122. Statistics Report:
17123. ------------------
17124.    Size:  
17125.    ------------------------
17126.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17127.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17128.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17129. 
17130.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17131.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17132. 
17133.    Location:
17134.    ------------------------
17135.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17136.              Files End: !ZoneEndCurrent!
17137.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17138.       
17139.    Gap Settings:
17140.    ------------------------
17141.          Gap Requested: !ZoneGapSizePer!%
17142.       Volume Rounding: !ZoneVolRoundUpPer!%
17143.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17144.                  
17145.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17146.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17147.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17148.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17149.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17150.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17151.      
17152.    Free Space after Zone:
17153.    ------------------------
17154.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17155.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17156.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17157. 
17158. Directory and Files Select:
17159. ---------------------------
17160. !ZoneTypeSelectCurrent!               
17161. ---------------------------
17162. ----------------------------------------------------------
17163. ")
17164. 
17165. 	# Add Zone Details to Report.	
17166. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
17167. !ZoneFooter!")
17168. 
17169. 
17170. 	
17171. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
17172. 		# FILE STEP
17173. 
17174. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17175. 
17176. /* add message and move to a new line. */
17177. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17178. ")
17179. 
17180. /* display the line. (hopefully.) */
17181. # Zone Footer Set Statistics Window Text
17182. 
17183. SetStatisticsWindowText("----------------------------------------------------------
17184. Zones Processed: 
17185. ----------------------------------------------------------
17186. !ZoneListByLine!
17187. ----------------------------------------------------------
17188. Zone Processing Step:
17189. !ZoneStepByLine!    
17190. ----------------------------------------------------------
17191. Current Zone:
17192. !ZoneFooter!
17193. ----------------------------------------------------------
17194. Volume Statistics:
17195. !VolumeStatisticsDetail!
17196. ----------------------------------------------------------
17197. Zone Detailed Report:
17198. ----------------------------------------------------------
17199. !ZoneStatisticsDetail!
17200. ----------------------------------------------------------
17201. ")
17202. 
17203. 
17204. 
17205. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17206. 
17207. # BANNER SET
17208. 
17209. # DATE TIME RUN ELP
17210. 
17211. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
17212. /* Xinclude "..\BannerSet.MyDc"X */
17213. /* pause(1) */
17214. 
17215. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17216. 
17217. Title('!Heading!')
17218. /* pause(1) */
17219. 
17220. /* NOTE: Can't round or truncate to integer precision. */
17221. 
17222. pause(1)
17223. 	
17224. 		SetVariable(MftZone, ZoneCurrent) 
17225. 
17226. 	    PlaceNtfsSystemFiles(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes), MftSize * 0.1)
17227. 
17228.   		SetVariable(MftSize,ZoneSize) 
17229. 
17230. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
17231. 		# FILE STEP
17232. 
17233. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17234. 
17235. /* add message and move to a new line. */
17236. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17237. ")
17238. 
17239. /* display the line. (hopefully.) */
17240. # Zone Footer Set Statistics Window Text
17241. 
17242. SetStatisticsWindowText("----------------------------------------------------------
17243. Zones Processed: 
17244. ----------------------------------------------------------
17245. !ZoneListByLine!
17246. ----------------------------------------------------------
17247. Zone Processing Step:
17248. !ZoneStepByLine!    
17249. ----------------------------------------------------------
17250. Current Zone:
17251. !ZoneFooter!
17252. ----------------------------------------------------------
17253. Volume Statistics:
17254. !VolumeStatisticsDetail!
17255. ----------------------------------------------------------
17256. Zone Detailed Report:
17257. ----------------------------------------------------------
17258. !ZoneStatisticsDetail!
17259. ----------------------------------------------------------
17260. ")
17261. 
17262. 
17263. 
17264. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17265. 
17266. # BANNER SET
17267. 
17268. # DATE TIME RUN ELP
17269. 
17270. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
17271. /* Xinclude "..\BannerSet.MyDc"X */
17272. /* pause(1) */
17273. 
17274. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17275. 
17276. Title('!Heading!')
17277. /* pause(1) */
17278. 
17279. /* NOTE: Can't round or truncate to integer precision. */
17280. 
17281. pause(1)
17282.   	# Zone Do Footer
17283. 
17284. /* ---------------------------------------------------------- */
17285. # File Select
17286. 	# Select Statments
17287. # File Actions 
17288. 	# Standard or OS File Actions.
17289. 	# Resume...
17290. 	
17291. 	# your stuff HERE (X)... post zone (file) file actions code.
17292. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
17293. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
17294. 		# (X)
17295. 		
17296. 		/* ??? Set window? */
17297. 	
17298. 	# ADD THE GAP
17299. 		
17300. # Vacate (good for diagnostics)
17301. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
17302. 
17303. # DoNotVacate - DO NOT Vacate (recommended)
17304. 
17305. # Vacate
17306. /* AddGap(GapUsedLoc) */
17307. 
17308. # DO Not Vacate
17309. AddGap(GapUsedLoc, DoNotVacate) 
17310. 	
17311. 	
17312. /* ---------------------------------------------------------- */
17313. # (failed) TEST for boolean logic.
17314. 
17315. /* It should work in the gap calculations for turning options */
17316. /* on and off but it will NOT work here. */
17317. 
17318. /* Boolean setting X or FlagX. */
17319. /* Where X will be on or off: */
17320. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
17321. /*      For ON:  (X  *  FlagAny) */
17322. 
17323. /* 1) Failed, zero gap overrode the previous one. */
17324. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
17325. /* AddGap(GapUsedTemp) */ 
17326. 
17327. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
17328. /* AddGap(GapUsedTemp, DoNotVacate) */ 
17329. 
17330. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
17331. 
17332. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
17333. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
17334. /* AddGap(GapUsedTemp) */ 
17335. 
17336. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
17337. /* AddGap(GapUsedTemp, DoNotVacate) */ 
17338. 
17339. /* ---------------------------------------------------------- */
17340. 
17341. # Vacate
17342. /* AddGap(GapUsed) */
17343. 
17344. # DO NOT Vacate (recommended)
17345. /* AddGap(GapUsed, DoNotVacate) */ 
17346. 	
17347. 
17348. 		
17349. # 
17350. FileEnd
17351. /* ---------------------------------------------------------- */
17352. 
17353. # your stuff HERE (X)... post zone (file) code.
17354. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
17355. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
17356. 	# (X)
17357. 
17358. SetVariable(FileStepDescription,"Zone finished, reporting.")
17359. # FILE STEP
17360. 
17361. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17362. 
17363. /* add message and move to a new line. */
17364. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17365. ")
17366. 
17367. /* display the line. (hopefully.) */
17368. # Zone Footer Set Statistics Window Text
17369. 
17370. SetStatisticsWindowText("----------------------------------------------------------
17371. Zones Processed: 
17372. ----------------------------------------------------------
17373. !ZoneListByLine!
17374. ----------------------------------------------------------
17375. Zone Processing Step:
17376. !ZoneStepByLine!    
17377. ----------------------------------------------------------
17378. Current Zone:
17379. !ZoneFooter!
17380. ----------------------------------------------------------
17381. Volume Statistics:
17382. !VolumeStatisticsDetail!
17383. ----------------------------------------------------------
17384. Zone Detailed Report:
17385. ----------------------------------------------------------
17386. !ZoneStatisticsDetail!
17387. ----------------------------------------------------------
17388. ")
17389. 
17390. 
17391. 
17392. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17393. 
17394. # BANNER SET
17395. 
17396. # DATE TIME RUN ELP
17397. 
17398. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
17399. /* Xinclude "..\BannerSet.MyDc"X */
17400. /* pause(1) */
17401. 
17402. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17403. 
17404. Title('!Heading!')
17405. /* pause(1) */
17406. 
17407. /* NOTE: Can't round or truncate to integer precision. */
17408. 
17409. pause(1)
17410. 
17411. # Zone When Finished
17412. 
17413. # BANNER SET
17414. 
17415. # DATE TIME RUN ELP
17416. 
17417. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
17418. /* Xinclude "..\BannerSet.MyDc"X */
17419. /* pause(1) */
17420. 
17421. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17422. 
17423. Title('!Heading!')
17424. /* pause(1) */
17425. 
17426. /* NOTE: Can't round or truncate to integer precision. */
17427. 
17428. AppendLogfile("!LogFileName!", "!Title!")
17429. 
17430. 
17431. 
17432. # Zone Statistics	
17433. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
17434. 
17435. # Footer:
17436. SetVariable(ZoneFooter, "----------------------------------------------------------
17437. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
17438. 
17439. Statistics Report:
17440. ------------------
17441.    Size:  
17442.    ------------------------
17443.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17444.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17445.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17446. 
17447.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17448.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17449. 
17450.    Location:
17451.    ------------------------
17452.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17453.              Files End: !ZoneEndCurrent!
17454.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17455.       
17456.    Gap Settings:
17457.    ------------------------
17458.          Gap Requested: !ZoneGapSizePer!%
17459.       Volume Rounding: !ZoneVolRoundUpPer!%
17460.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17461.                  
17462.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17463.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17464.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17465.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17466.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17467.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17468.      
17469.    Free Space after Zone:
17470.    ------------------------
17471.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17472.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17473.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17474. 
17475. Directory and Files Select:
17476. ---------------------------
17477. !ZoneTypeSelectCurrent!               
17478. ---------------------------
17479. ----------------------------------------------------------
17480. ")
17481. 
17482. AppendLogfile("!LogFileName!", ".")
17483. AppendLogfile("!LogFileName!", "!ZoneFooter!")
17484. AppendLogfile("!LogFileName!", ".")
17485. 
17486. # Zone Footer Set Statistics Window Text
17487. 
17488. SetStatisticsWindowText("----------------------------------------------------------
17489. Zones Processed: 
17490. ----------------------------------------------------------
17491. !ZoneListByLine!
17492. ----------------------------------------------------------
17493. Zone Processing Step:
17494. !ZoneStepByLine!    
17495. ----------------------------------------------------------
17496. Current Zone:
17497. !ZoneFooter!
17498. ----------------------------------------------------------
17499. Volume Statistics:
17500. !VolumeStatisticsDetail!
17501. ----------------------------------------------------------
17502. Zone Detailed Report:
17503. ----------------------------------------------------------
17504. !ZoneStatisticsDetail!
17505. ----------------------------------------------------------
17506. ")
17507. 
17508. 
17509. 
17510. /* pause() */
17511. /* pause() */
17512. 
17513. 
17514. 
17515. /* ---------------------------------------------------------- */
17516. 
17517.   
17518. /* ---------------------------------------------------------- */
17519. # DIR
17520. 
17521. /* ---------------------------------------------------------- */
17522. SetVariable(ZoneLabel,				"DIR") // "5"
17523. SetVariable(ZoneDescription, 		"Directories.")
17524. SetVariable(ZoneCurrentAjust, 		2)
17525. SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpDir!")
17526. SetVariable(ZoneGapSize, 			"!ZoneGapSizeDir!")
17527. SetVariable(ZoneTypeSelect,'# DIR start.
17528. Directory(yes)
17529. # DIR end.
17530. ')
17531. 
17532. 	# Zone Do Header
17533. 
17534. # Zone When Started
17535. 
17536. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
17537. # Display Set Zone
17538. 
17539. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
17540. SetVariable(FileStepDescription,	"")
17541. 
17542. SetVariable(ZoneStepByLine, 			"Zone started.
17543. ")
17544. 
17545. # BANNER SET
17546. 
17547. # DATE TIME RUN ELP
17548. 
17549. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
17550. /* Xinclude "..\BannerSet.MyDc"X */
17551. /* pause(1) */
17552. 
17553. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17554. 
17555. Title('!Heading!')
17556. /* pause(1) */
17557. 
17558. /* NOTE: Can't round or truncate to integer precision. */
17559. 
17560. AppendLogfile("!LogFileName!", "!Title!")
17561. 
17562. 
17563. 
17564. pause(1)
17565. 
17566. 
17567. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
17568. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
17569. 
17570. SetVariable(ZoneStepNoCurrent, 0)
17571. 
17572. 
17573. # Zone Do Current Clear
17574. 
17575. SetVariable(ZoneTypeSelectCurrent, 		"")
17576. 
17577. SetVariable(ZoneBeginCurrent, 			0)
17578. SetVariable(ZoneBeginPerCurrent, 		0)
17579. SetVariable(ZoneEndCurrent, 			0)
17580. SetVariable(ZoneEndPerCurrent, 			0)
17581. 
17582. SetVariable(ZoneSizeCurrent,			0)
17583. SetVariable(ZoneSizePerCurrent,			0)
17584. 
17585. SetVariable(ZoneGapRequestedCurrent,	0)
17586. SetVariable(ZoneGapRoundedCurrent, 		0)
17587. SetVariable(ZoneGapAdjustedCurrent, 	0)
17588. SetVariable(ZoneGapAvailableCurrent, 	0)
17589. SetVariable(ZoneGapCurrent,				0)
17590. SetVariable(ZoneGapUsedCurrent, 		0)
17591. 
17592. SetVariable(ZoneGapActualCurrent, 		0)
17593. SetVariable(ZoneGapActualPerCurrent, 	0)
17594. 
17595. SetVariable(ZoneSizeActual, 			0)
17596. SetVariable(ZoneSizeActualCurrent,		0)
17597. 
17598. SetVariable(ZoneEndActual, 				0)
17599. SetVariable(ZoneEndActualCurrent,		0)			
17600. SetVariable(ZoneSizeActualPerCurrent, 	0)
17601.       
17602. SetVariable(ZoneFilesFolders,			0)
17603. SetVariable(ZoneFilesFoldersPer,		0) 
17604. 
17605. SetVariable(ZoneFragments,				0)
17606. SetVariable(ZoneFragmentsPer,			0) 
17607. 		
17608. SetVariable(ZoneEndActualCurrent, 		0)
17609. SetVariable(ZoneEndActualPerCurrent, 	0)
17610. 
17611. # Gap Calculation Methodology:
17612. 	# Requested
17613. 	SetVariable(GapRequested, 			0) 
17614. 	SetVariable(GapRequestedStd, 		0) 
17615. 	SetVariable(GapRequestedMft, 		0) 
17616. 	SetVariable(GapRequestedOs, 		0) 
17617. 	SetVariable(GapRequestedOriginal, 	0) 
17618. 	
17619. 	# Gap Adjustments
17620. 	SetVariable(GapRounded, 			0)
17621. 	# SetVariable(GapAdjusted, 			0)
17622. 	SetVariable(GapAvailable, 			0)
17623. 	SetVariable(GapCurrent, 			0)
17624. 	SetVariable(GapActual, 				0)
17625. 	SetVariable(GapUsed, 				0)
17626. 	
17627. 	# Gap Adjustments
17628. 	SetVariable(GapRoundedLoc, 			0)
17629. 	# SetVariable(GapAdjustedLoc, 		0)
17630. 	SetVariable(GapAvailableLoc, 		0)
17631. 	SetVariable(GapCurrentLoc, 			0)
17632. 	SetVariable(GapActualLoc,			0)
17633. 	SetVariable(GapUsedLoc,				0)
17634. 	
17635. 	# Space usage
17636. 	SetVariable(ZoneFreePerRequested, 	0)
17637. 	SetVariable(ZoneFreePerUsed, 		0)
17638. 
17639. # Gap Size & Rounding
17640. 	SetVariable(ZoneGapSizePer, 		0)
17641. 	SetVariable(ZoneVolRoundUpPer, 		0)
17642. 	
17643. 	# Free Space
17644. 	SetVariable(ZoneFreeUsedPer, 		0)
17645. 	SetVariable(ZoneFreeRequestedPer, 	0)
17646. 
17647. 
17648. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
17649. 
17650. # Footer:
17651. SetVariable(ZoneFooter, "----------------------------------------------------------
17652. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
17653. 
17654. Statistics Report:
17655. ------------------
17656.    Size:  
17657.    ------------------------
17658.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
17659.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
17660.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
17661. 
17662.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
17663.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
17664. 
17665.    Location:
17666.    ------------------------
17667.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
17668.              Files End: !ZoneEndCurrent!
17669.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
17670.       
17671.    Gap Settings:
17672.    ------------------------
17673.          Gap Requested: !ZoneGapSizePer!%
17674.       Volume Rounding: !ZoneVolRoundUpPer!%
17675.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
17676.                  
17677.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
17678.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
17679.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
17680.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
17681.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
17682.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
17683.      
17684.    Free Space after Zone:
17685.    ------------------------
17686.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
17687.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
17688.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
17689. 
17690. Directory and Files Select:
17691. ---------------------------
17692. !ZoneTypeSelectCurrent!               
17693. ---------------------------
17694. ----------------------------------------------------------
17695. ")
17696. 
17697. # BANNER SET
17698. 
17699. # DATE TIME RUN ELP
17700. 
17701. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
17702. /* Xinclude "..\BannerSet.MyDc"X */
17703. /* pause(1) */
17704. 
17705. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17706. 
17707. Title('!Heading!')
17708. /* pause(1) */
17709. 
17710. /* NOTE: Can't round or truncate to integer precision. */
17711. 
17712. AppendLogfile("!LogFileName!", "!Title!")
17713. 
17714. 
17715. 
17716. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
17717. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
17718. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:18")
17719. 
17720. SetVariable(ZoneListByLine, "!ZoneListByLine!
17721. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
17722. 
17723. 
17724. /* Fixed Zone Position Handling */
17725. /* Literal number: */
17726. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
17727. /* Percentage of disk: */
17728. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
17729. /* Gap */
17730. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
17731. 
17732. /* ---------------------------------------------------------- */
17733. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
17734. # FILE STEP
17735. 
17736. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17737. 
17738. /* add message and move to a new line. */
17739. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17740. ")
17741. 
17742. /* display the line. (hopefully.) */
17743. # Zone Footer Set Statistics Window Text
17744. 
17745. SetStatisticsWindowText("----------------------------------------------------------
17746. Zones Processed: 
17747. ----------------------------------------------------------
17748. !ZoneListByLine!
17749. ----------------------------------------------------------
17750. Zone Processing Step:
17751. !ZoneStepByLine!    
17752. ----------------------------------------------------------
17753. Current Zone:
17754. !ZoneFooter!
17755. ----------------------------------------------------------
17756. Volume Statistics:
17757. !VolumeStatisticsDetail!
17758. ----------------------------------------------------------
17759. Zone Detailed Report:
17760. ----------------------------------------------------------
17761. !ZoneStatisticsDetail!
17762. ----------------------------------------------------------
17763. ")
17764. 
17765. 
17766. 
17767. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17768. 
17769. # BANNER SET
17770. 
17771. # DATE TIME RUN ELP
17772. 
17773. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
17774. /* Xinclude "..\BannerSet.MyDc"X */
17775. /* pause(1) */
17776. 
17777. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17778. 
17779. Title('!Heading!')
17780. /* pause(1) */
17781. 
17782. /* NOTE: Can't round or truncate to integer precision. */
17783. 
17784. pause(1)
17785. 
17786. # your stuff HERE (X)... pre file select code.
17787. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
17788. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
17789. 	# (X)
17790. 
17791. FileSelect
17792. 
17793. 	# your stuff can't really go here (errors.)
17794. 	# maybe for some reason I don't know of...
17795. 	
17796. 	# Actions next...
17797. 	# DIR start.
17798. Directory(yes)
17799. # DIR end.
17800. 
17801. 	FileActions
17802. 	  		/* ---------------------------------------------------------- */
17803. 	# Gap
17804. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
17805. 		# FILE STEP
17806. 
17807. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
17808. 
17809. /* add message and move to a new line. */
17810. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
17811. ")
17812. 
17813. /* display the line. (hopefully.) */
17814. # Zone Footer Set Statistics Window Text
17815. 
17816. SetStatisticsWindowText("----------------------------------------------------------
17817. Zones Processed: 
17818. ----------------------------------------------------------
17819. !ZoneListByLine!
17820. ----------------------------------------------------------
17821. Zone Processing Step:
17822. !ZoneStepByLine!    
17823. ----------------------------------------------------------
17824. Current Zone:
17825. !ZoneFooter!
17826. ----------------------------------------------------------
17827. Volume Statistics:
17828. !VolumeStatisticsDetail!
17829. ----------------------------------------------------------
17830. Zone Detailed Report:
17831. ----------------------------------------------------------
17832. !ZoneStatisticsDetail!
17833. ----------------------------------------------------------
17834. ")
17835. 
17836. 
17837. 
17838. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
17839. 
17840. # BANNER SET
17841. 
17842. # DATE TIME RUN ELP
17843. 
17844. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
17845. /* Xinclude "..\BannerSet.MyDc"X */
17846. /* pause(1) */
17847. 
17848. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
17849. 
17850. Title('!Heading!')
17851. /* pause(1) */
17852. 
17853. /* NOTE: Can't round or truncate to integer precision. */
17854. 
17855. pause(1)
17856. 	
17857. 	# ACTUAL GAP
17858. 		/* AddGap Variant. */
17859. 	  	# Zone Do Gap
17860. # Gap Calculation Methods:
17861. 
17862. /* 1) Anything you need to add first. */
17863. /* empty */
17864. 
17865. /* ---------------------------------------------------------- */
17866. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
17867. 	# GapRequestedStd.
17868. 
17869. 		/* ---------------------------------------------------------- */
17870. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
17871. 
17872. 		# Gap Calculation Methods:
17873. 
17874. /* AddGap Variants */
17875. 
17876. 	/* Standard */
17877. 		# Gap Calculation Methods:
17878. 	/* AddGap Variants */
17879. 	/* Standard */
17880. 
17881. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
17882. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
17883. 
17884. 	SetVariable(GapRequested, GapRequestedStd)
17885. 	
17886. 
17887. 	/* MFT Low High Method */
17888. 		# Gap Calculation Methods:
17889. 	/* AddGap Variants */
17890. 	/* MFT Low High Method */
17891. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
17892. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
17893. 	SetVariable(GapRequested, GapRequestedMft)
17894. 	
17895. 
17896. 	/* OS Volume Type Method */
17897. 		# Gap Calculation Methods:
17898. 	/* AddGap Variants */
17899. 	/* OS Volume Type Method */
17900. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
17901. 	SetVariable(GapRequested, GapRequestedOs)
17902. 
17903. 
17904. 
17905. /* MakeGap Variants */
17906. 
17907. 	/* Original Os 1-3 + MFT 2 */
17908. 		# Gap Calculation Methods:
17909. 	/* MakeGap Variants */
17910. 	/* Original Os 1-3 + MFT 2 */
17911. 	/* plus MFT gap placed inline at the dividing zone. */
17912. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
17913. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
17914. 	SetVariable(GapRequested, GapRequestedOrig)
17915. 	
17916. 	
17917. /* Note: You could comment out the ones not in use */
17918. /* However having the data in the log is useful. */
17919. /* Therefore the following line is otherwise needed. */
17920. 
17921. /* Standard used */
17922. 
17923. SetVariable(GapRequested, GapRequestedStd)
17924. 
17925. # Gap Calculation Methods:
17926. 
17927. /* AddGap Variants */
17928. 	/* Standard */
17929. 	/* MFT Low High Method */
17930. 	/* OS Volume Type Method */
17931. 
17932. /* MakeGap Variants */
17933. 	/* Original Os 1-3 + MFT 2 */
17934. 
17935. /* Note: You could comment out the ones not in use */
17936. /* However having the data in the log is useful. */
17937. /* Therefore the following line is otherwise needed. */
17938. 
17939. /* Standard is used currently */
17940. 
17941. 
17942. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
17943. 
17944. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
17945. 
17946. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
17947. 
17948. /* ---------------------------------------------------------- */
17949. /* 3) SMALL ZONE ADJUSTMENT. */
17950. /* Gab cant be larger than half the Zone Size. */
17951. 
17952. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
17953. 	
17954. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
17955. 
17956. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
17957. 
17958. /* ---------------------------------------------------------- */
17959. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
17960. # Gap Adjustments.
17961. 
17962. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
17963. 	
17964. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
17965. 
17966. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
17967. 
17968. /* ---------------------------------------------------------- */
17969. # BYPASS THIS.
17970. 	/* This is definitely wrong. */
17971. 	/* The question is can we steal gap from the next zone */
17972. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
17973. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
17974. 		# Zone Overflow.
17975. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
17976. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
17977. 
17978. /* ---------------------------------------------------------- */
17979. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
17980. # Remaining free space available.
17981. 
17982. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
17983. 	
17984. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
17985. 
17986. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
17987. 
17988. /* ---------------------------------------------------------- */
17989. # CURRENT gap to use.
17990. 
17991. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
17992. 
17993. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
17994. 
17995. /* ---------------------------------------------------------- */
17996. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
17997. # Debugging.
17998. 
17999. 	SetVariable(GapUsed, GapCurrent) // for debugging
18000. 
18001. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
18002. 
18003. 		# Your code HERE
18004. 
18005. /* ---------------------------------------------------------- */
18006. /* 7) YOUR CODE. */
18007. # YOUR CODE HERE:
18008. 	# INPUT: GapCurrent or GapCurrentLoc
18009. 	# OUTPUT: GapUsed...
18010. 
18011. /* ---------------------------------------------------------- */
18012. # Gap Size.
18013. # Actual Size of Gap.
18014. 
18015. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
18016. 
18017. /* ---------------------------------------------------------- */
18018. /* xxxxxxxxxxxxxxxxxxxxxx */
18019. # ADD THE GAP
18020. 	/* Xinclude "..\GapCommandDo.MyDc"X */
18021. /* xxxxxxxxxxxxxxxxxxxxxx */
18022. 
18023. 	
18024. 	# Zone Statistics	
18025. 	# Zone / Volume Statistics and Display
18026. 		
18027. 	# Accumulate Totals
18028.   	# Volume totals
18029. 
18030. /* Current total space used (by Zones and Gaps) */
18031. 
18032. SetVariable(VolumeZoneUsed, GapUsed)
18033. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
18034. /* Percentage */
18035. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
18036. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
18037. 
18038. /* Current total of free space requested */
18039. 
18040. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
18041. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18042. /* Percent. */
18043. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
18044. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
18045. 
18046. /* Current total of free space used */
18047. 
18048. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
18049. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
18050. /* Percent */
18051. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
18052. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
18053. 
18054. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
18055. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
18056. /* Xinclude "..\DebugDisplayPause.MyDc"X */
18057. 
18058. 
18059. 	# Current Values
18060. 	# Cluster, Sector, Block adjust for display.
18061. 	# Bytes per cluster is volume specific.
18062. 
18063. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
18064. 
18065. # Current Zone values.
18066. 	# Begin, end and size.
18067. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
18068. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
18069. 
18070. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
18071. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
18072. 
18073. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
18074. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
18075. 
18076. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
18077. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
18078. 
18079. 	SetVariable(ZoneFragments,				"!ZONE210N!")
18080. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
18081. 		
18082. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
18083. /* identical code to here: (separation not needed. TEST.) */	
18084. 
18085. # Current Gap, Actual and Free Values
18086. 	# Gap
18087. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
18088. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
18089. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
18090. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
18091. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
18092. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
18093. 	
18094. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
18095. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
18096. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
18097. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
18098. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
18099. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
18100. 	
18101. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
18102. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
18103. 	
18104. 	# Actual Size and End
18105. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
18106. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
18107. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
18108. 	
18109. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
18110. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
18111. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
18112. 
18113. # Gap Size & Rounding
18114. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
18115. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
18116. 	
18117. 	# Free Space
18118. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
18119. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
18120. 
18121. 	# Footer:
18122. SetVariable(ZoneFooter, "----------------------------------------------------------
18123. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
18124. 
18125. Statistics Report:
18126. ------------------
18127.    Size:  
18128.    ------------------------
18129.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18130.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18131.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18132. 
18133.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18134.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18135. 
18136.    Location:
18137.    ------------------------
18138.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18139.              Files End: !ZoneEndCurrent!
18140.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18141.       
18142.    Gap Settings:
18143.    ------------------------
18144.          Gap Requested: !ZoneGapSizePer!%
18145.       Volume Rounding: !ZoneVolRoundUpPer!%
18146.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18147.                  
18148.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18149.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18150.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18151.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18152.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18153.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18154.      
18155.    Free Space after Zone:
18156.    ------------------------
18157.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18158.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18159.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18160. 
18161. Directory and Files Select:
18162. ---------------------------
18163. !ZoneTypeSelectCurrent!               
18164. ---------------------------
18165. ----------------------------------------------------------
18166. ")
18167. 	# Zone Footer Set Statistics Window Text
18168. 
18169. SetStatisticsWindowText("----------------------------------------------------------
18170. Zones Processed: 
18171. ----------------------------------------------------------
18172. !ZoneListByLine!
18173. ----------------------------------------------------------
18174. Zone Processing Step:
18175. !ZoneStepByLine!    
18176. ----------------------------------------------------------
18177. Current Zone:
18178. !ZoneFooter!
18179. ----------------------------------------------------------
18180. Volume Statistics:
18181. !VolumeStatisticsDetail!
18182. ----------------------------------------------------------
18183. Zone Detailed Report:
18184. ----------------------------------------------------------
18185. !ZoneStatisticsDetail!
18186. ----------------------------------------------------------
18187. ")
18188. 
18189. 
18190. 	
18191.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
18192. 
18193. 	# Add Zone to list of zones for display.
18194. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
18195. 
18196. 	# Footer:
18197. SetVariable(ZoneFooter, "----------------------------------------------------------
18198. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
18199. 
18200. Statistics Report:
18201. ------------------
18202.    Size:  
18203.    ------------------------
18204.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18205.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18206.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18207. 
18208.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18209.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18210. 
18211.    Location:
18212.    ------------------------
18213.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18214.              Files End: !ZoneEndCurrent!
18215.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18216.       
18217.    Gap Settings:
18218.    ------------------------
18219.          Gap Requested: !ZoneGapSizePer!%
18220.       Volume Rounding: !ZoneVolRoundUpPer!%
18221.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18222.                  
18223.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18224.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18225.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18226.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18227.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18228.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18229.      
18230.    Free Space after Zone:
18231.    ------------------------
18232.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18233.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18234.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18235. 
18236. Directory and Files Select:
18237. ---------------------------
18238. !ZoneTypeSelectCurrent!               
18239. ---------------------------
18240. ----------------------------------------------------------
18241. ")
18242. 
18243. 	# Add Zone Details to Report.	
18244. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
18245. !ZoneFooter!")
18246. 
18247. 
18248. 	
18249. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
18250. 		# FILE STEP
18251. 
18252. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18253. 
18254. /* add message and move to a new line. */
18255. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18256. ")
18257. 
18258. /* display the line. (hopefully.) */
18259. # Zone Footer Set Statistics Window Text
18260. 
18261. SetStatisticsWindowText("----------------------------------------------------------
18262. Zones Processed: 
18263. ----------------------------------------------------------
18264. !ZoneListByLine!
18265. ----------------------------------------------------------
18266. Zone Processing Step:
18267. !ZoneStepByLine!    
18268. ----------------------------------------------------------
18269. Current Zone:
18270. !ZoneFooter!
18271. ----------------------------------------------------------
18272. Volume Statistics:
18273. !VolumeStatisticsDetail!
18274. ----------------------------------------------------------
18275. Zone Detailed Report:
18276. ----------------------------------------------------------
18277. !ZoneStatisticsDetail!
18278. ----------------------------------------------------------
18279. ")
18280. 
18281. 
18282. 
18283. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18284. 
18285. # BANNER SET
18286. 
18287. # DATE TIME RUN ELP
18288. 
18289. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
18290. /* Xinclude "..\BannerSet.MyDc"X */
18291. /* pause(1) */
18292. 
18293. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18294. 
18295. Title('!Heading!')
18296. /* pause(1) */
18297. 
18298. /* NOTE: Can't round or truncate to integer precision. */
18299. 
18300. pause(1)
18301. 	
18302. 		SortByName(Ascending SkipBlock(SkipBlockFiles,(SkipBlockBytes / 10)))
18303. 
18304. 		SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
18305. 		# FILE STEP
18306. 
18307. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18308. 
18309. /* add message and move to a new line. */
18310. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18311. ")
18312. 
18313. /* display the line. (hopefully.) */
18314. # Zone Footer Set Statistics Window Text
18315. 
18316. SetStatisticsWindowText("----------------------------------------------------------
18317. Zones Processed: 
18318. ----------------------------------------------------------
18319. !ZoneListByLine!
18320. ----------------------------------------------------------
18321. Zone Processing Step:
18322. !ZoneStepByLine!    
18323. ----------------------------------------------------------
18324. Current Zone:
18325. !ZoneFooter!
18326. ----------------------------------------------------------
18327. Volume Statistics:
18328. !VolumeStatisticsDetail!
18329. ----------------------------------------------------------
18330. Zone Detailed Report:
18331. ----------------------------------------------------------
18332. !ZoneStatisticsDetail!
18333. ----------------------------------------------------------
18334. ")
18335. 
18336. 
18337. 
18338. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18339. 
18340. # BANNER SET
18341. 
18342. # DATE TIME RUN ELP
18343. 
18344. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
18345. /* Xinclude "..\BannerSet.MyDc"X */
18346. /* pause(1) */
18347. 
18348. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18349. 
18350. Title('!Heading!')
18351. /* pause(1) */
18352. 
18353. /* NOTE: Can't round or truncate to integer precision. */
18354. 
18355. pause(1)
18356. 	# Zone Do Footer
18357. 
18358. /* ---------------------------------------------------------- */
18359. # File Select
18360. 	# Select Statments
18361. # File Actions 
18362. 	# Standard or OS File Actions.
18363. 	# Resume...
18364. 	
18365. 	# your stuff HERE (X)... post zone (file) file actions code.
18366. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
18367. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
18368. 		# (X)
18369. 		
18370. 		/* ??? Set window? */
18371. 	
18372. 	# ADD THE GAP
18373. 		
18374. # Vacate (good for diagnostics)
18375. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
18376. 
18377. # DoNotVacate - DO NOT Vacate (recommended)
18378. 
18379. # Vacate
18380. /* AddGap(GapUsedLoc) */
18381. 
18382. # DO Not Vacate
18383. AddGap(GapUsedLoc, DoNotVacate) 
18384. 	
18385. 	
18386. /* ---------------------------------------------------------- */
18387. # (failed) TEST for boolean logic.
18388. 
18389. /* It should work in the gap calculations for turning options */
18390. /* on and off but it will NOT work here. */
18391. 
18392. /* Boolean setting X or FlagX. */
18393. /* Where X will be on or off: */
18394. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
18395. /*      For ON:  (X  *  FlagAny) */
18396. 
18397. /* 1) Failed, zero gap overrode the previous one. */
18398. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
18399. /* AddGap(GapUsedTemp) */ 
18400. 
18401. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
18402. /* AddGap(GapUsedTemp, DoNotVacate) */ 
18403. 
18404. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
18405. 
18406. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
18407. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
18408. /* AddGap(GapUsedTemp) */ 
18409. 
18410. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
18411. /* AddGap(GapUsedTemp, DoNotVacate) */ 
18412. 
18413. /* ---------------------------------------------------------- */
18414. 
18415. # Vacate
18416. /* AddGap(GapUsed) */
18417. 
18418. # DO NOT Vacate (recommended)
18419. /* AddGap(GapUsed, DoNotVacate) */ 
18420. 	
18421. 
18422. 		
18423. # 
18424. FileEnd
18425. /* ---------------------------------------------------------- */
18426. 
18427. # your stuff HERE (X)... post zone (file) code.
18428. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
18429. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
18430. 	# (X)
18431. 
18432. SetVariable(FileStepDescription,"Zone finished, reporting.")
18433. # FILE STEP
18434. 
18435. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18436. 
18437. /* add message and move to a new line. */
18438. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18439. ")
18440. 
18441. /* display the line. (hopefully.) */
18442. # Zone Footer Set Statistics Window Text
18443. 
18444. SetStatisticsWindowText("----------------------------------------------------------
18445. Zones Processed: 
18446. ----------------------------------------------------------
18447. !ZoneListByLine!
18448. ----------------------------------------------------------
18449. Zone Processing Step:
18450. !ZoneStepByLine!    
18451. ----------------------------------------------------------
18452. Current Zone:
18453. !ZoneFooter!
18454. ----------------------------------------------------------
18455. Volume Statistics:
18456. !VolumeStatisticsDetail!
18457. ----------------------------------------------------------
18458. Zone Detailed Report:
18459. ----------------------------------------------------------
18460. !ZoneStatisticsDetail!
18461. ----------------------------------------------------------
18462. ")
18463. 
18464. 
18465. 
18466. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18467. 
18468. # BANNER SET
18469. 
18470. # DATE TIME RUN ELP
18471. 
18472. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
18473. /* Xinclude "..\BannerSet.MyDc"X */
18474. /* pause(1) */
18475. 
18476. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18477. 
18478. Title('!Heading!')
18479. /* pause(1) */
18480. 
18481. /* NOTE: Can't round or truncate to integer precision. */
18482. 
18483. pause(1)
18484. 
18485. # Zone When Finished
18486. 
18487. # BANNER SET
18488. 
18489. # DATE TIME RUN ELP
18490. 
18491. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
18492. /* Xinclude "..\BannerSet.MyDc"X */
18493. /* pause(1) */
18494. 
18495. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18496. 
18497. Title('!Heading!')
18498. /* pause(1) */
18499. 
18500. /* NOTE: Can't round or truncate to integer precision. */
18501. 
18502. AppendLogfile("!LogFileName!", "!Title!")
18503. 
18504. 
18505. 
18506. # Zone Statistics	
18507. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
18508. 
18509. # Footer:
18510. SetVariable(ZoneFooter, "----------------------------------------------------------
18511. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
18512. 
18513. Statistics Report:
18514. ------------------
18515.    Size:  
18516.    ------------------------
18517.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18518.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18519.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18520. 
18521.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18522.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18523. 
18524.    Location:
18525.    ------------------------
18526.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18527.              Files End: !ZoneEndCurrent!
18528.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18529.       
18530.    Gap Settings:
18531.    ------------------------
18532.          Gap Requested: !ZoneGapSizePer!%
18533.       Volume Rounding: !ZoneVolRoundUpPer!%
18534.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18535.                  
18536.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18537.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18538.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18539.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18540.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18541.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18542.      
18543.    Free Space after Zone:
18544.    ------------------------
18545.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18546.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18547.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18548. 
18549. Directory and Files Select:
18550. ---------------------------
18551. !ZoneTypeSelectCurrent!               
18552. ---------------------------
18553. ----------------------------------------------------------
18554. ")
18555. 
18556. AppendLogfile("!LogFileName!", ".")
18557. AppendLogfile("!LogFileName!", "!ZoneFooter!")
18558. AppendLogfile("!LogFileName!", ".")
18559. 
18560. # Zone Footer Set Statistics Window Text
18561. 
18562. SetStatisticsWindowText("----------------------------------------------------------
18563. Zones Processed: 
18564. ----------------------------------------------------------
18565. !ZoneListByLine!
18566. ----------------------------------------------------------
18567. Zone Processing Step:
18568. !ZoneStepByLine!    
18569. ----------------------------------------------------------
18570. Current Zone:
18571. !ZoneFooter!
18572. ----------------------------------------------------------
18573. Volume Statistics:
18574. !VolumeStatisticsDetail!
18575. ----------------------------------------------------------
18576. Zone Detailed Report:
18577. ----------------------------------------------------------
18578. !ZoneStatisticsDetail!
18579. ----------------------------------------------------------
18580. ")
18581. 
18582. 
18583. 
18584. /* pause() */
18585. /* pause() */
18586. 
18587. 
18588. 
18589. 
18590. /* Mft Method: MFT GAP HERE. */
18591. /* For fixed zone locations */
18592. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-10-24 14:34:18")
18593. /* MakeGap(MftGap, DoNotVacate) */
18594. /* ---------------------------------------------------------- */
18595. 
18596. 
18597. /* ---------------------------------------------------------- */
18598. /* Mft Method: MFT GAP HERE. */
18599. /* For fixed zone locations */
18600. AppendLogfile("!LogFileName!", "Mft Zone: !MftZone! Location: !MftLocation! Gap: !MftGap! 2021-10-24 14:34:17")
18601. /* MakeGap(MftGap, DoNotVacate) */
18602.   
18603. /* ---------------------------------------------------------- */
18604. # PageHiberDump
18605. 
18606. # You cannot move Pagefile or Hiberfil generally speaking.
18607. # This might work in safe mode with preparation.
18608. # Zone PageHiberDump.
18609. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
18610. 
18611. /* ---------------------------------------------------------- */
18612. # PageHiberDump
18613. # You cannot move Pagefile or Hiberfil generally speaking.
18614. # This might work in safe mode with preparation.
18615. # Zone PageHiberDump.
18616. # Possibly a Gap should be vacated so there is a space available upon recreation of the files.
18617. 
18618. 	SetVariable(ZoneLabel, 			"!ZoneLabelPageHiberDump!")
18619. 	SetVariable(ZoneDescription, 		"!ZoneDescriptionPageHiberDump!")
18620. 	SetVariable(ZoneVolRoundUp, 		"!ZoneVolRoundUpPageHiberDump!")
18621. 	SetVariable(ZoneGapSize, 		"!ZoneGapSizePageHiberDump!")
18622. 	SetVariable(ZoneTypeSelect,'# PageHiberDump start.
18623. (
18624. # Os PageHiberDump start.
18625. (
18626.   FileName("DataStore.edb")
18627.   or FileName("DUMP*.*")
18628.   or FileName("Hiberfil.sys")
18629.   or FileName("MEMORY.DMP")
18630.   or FileName("Pagefile.sys")
18631. )
18632. # Os PageHiberDump end.
18633. 
18634. )
18635. # PageHiberDump end.
18636. ')
18637. 
18638. 		# Zone Do Header
18639. 
18640. # Zone When Started
18641. 
18642. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
18643. # Display Set Zone
18644. 
18645. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
18646. SetVariable(FileStepDescription,	"")
18647. 
18648. SetVariable(ZoneStepByLine, 			"Zone started.
18649. ")
18650. 
18651. # BANNER SET
18652. 
18653. # DATE TIME RUN ELP
18654. 
18655. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
18656. /* Xinclude "..\BannerSet.MyDc"X */
18657. /* pause(1) */
18658. 
18659. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18660. 
18661. Title('!Heading!')
18662. /* pause(1) */
18663. 
18664. /* NOTE: Can't round or truncate to integer precision. */
18665. 
18666. AppendLogfile("!LogFileName!", "!Title!")
18667. 
18668. 
18669. 
18670. pause(1)
18671. 
18672. 
18673. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
18674. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
18675. 
18676. SetVariable(ZoneStepNoCurrent, 0)
18677. 
18678. 
18679. # Zone Do Current Clear
18680. 
18681. SetVariable(ZoneTypeSelectCurrent, 		"")
18682. 
18683. SetVariable(ZoneBeginCurrent, 			0)
18684. SetVariable(ZoneBeginPerCurrent, 		0)
18685. SetVariable(ZoneEndCurrent, 			0)
18686. SetVariable(ZoneEndPerCurrent, 			0)
18687. 
18688. SetVariable(ZoneSizeCurrent,			0)
18689. SetVariable(ZoneSizePerCurrent,			0)
18690. 
18691. SetVariable(ZoneGapRequestedCurrent,	0)
18692. SetVariable(ZoneGapRoundedCurrent, 		0)
18693. SetVariable(ZoneGapAdjustedCurrent, 	0)
18694. SetVariable(ZoneGapAvailableCurrent, 	0)
18695. SetVariable(ZoneGapCurrent,				0)
18696. SetVariable(ZoneGapUsedCurrent, 		0)
18697. 
18698. SetVariable(ZoneGapActualCurrent, 		0)
18699. SetVariable(ZoneGapActualPerCurrent, 	0)
18700. 
18701. SetVariable(ZoneSizeActual, 			0)
18702. SetVariable(ZoneSizeActualCurrent,		0)
18703. 
18704. SetVariable(ZoneEndActual, 				0)
18705. SetVariable(ZoneEndActualCurrent,		0)			
18706. SetVariable(ZoneSizeActualPerCurrent, 	0)
18707.       
18708. SetVariable(ZoneFilesFolders,			0)
18709. SetVariable(ZoneFilesFoldersPer,		0) 
18710. 
18711. SetVariable(ZoneFragments,				0)
18712. SetVariable(ZoneFragmentsPer,			0) 
18713. 		
18714. SetVariable(ZoneEndActualCurrent, 		0)
18715. SetVariable(ZoneEndActualPerCurrent, 	0)
18716. 
18717. # Gap Calculation Methodology:
18718. 	# Requested
18719. 	SetVariable(GapRequested, 			0) 
18720. 	SetVariable(GapRequestedStd, 		0) 
18721. 	SetVariable(GapRequestedMft, 		0) 
18722. 	SetVariable(GapRequestedOs, 		0) 
18723. 	SetVariable(GapRequestedOriginal, 	0) 
18724. 	
18725. 	# Gap Adjustments
18726. 	SetVariable(GapRounded, 			0)
18727. 	# SetVariable(GapAdjusted, 			0)
18728. 	SetVariable(GapAvailable, 			0)
18729. 	SetVariable(GapCurrent, 			0)
18730. 	SetVariable(GapActual, 				0)
18731. 	SetVariable(GapUsed, 				0)
18732. 	
18733. 	# Gap Adjustments
18734. 	SetVariable(GapRoundedLoc, 			0)
18735. 	# SetVariable(GapAdjustedLoc, 		0)
18736. 	SetVariable(GapAvailableLoc, 		0)
18737. 	SetVariable(GapCurrentLoc, 			0)
18738. 	SetVariable(GapActualLoc,			0)
18739. 	SetVariable(GapUsedLoc,				0)
18740. 	
18741. 	# Space usage
18742. 	SetVariable(ZoneFreePerRequested, 	0)
18743. 	SetVariable(ZoneFreePerUsed, 		0)
18744. 
18745. # Gap Size & Rounding
18746. 	SetVariable(ZoneGapSizePer, 		0)
18747. 	SetVariable(ZoneVolRoundUpPer, 		0)
18748. 	
18749. 	# Free Space
18750. 	SetVariable(ZoneFreeUsedPer, 		0)
18751. 	SetVariable(ZoneFreeRequestedPer, 	0)
18752. 
18753. 
18754. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
18755. 
18756. # Footer:
18757. SetVariable(ZoneFooter, "----------------------------------------------------------
18758. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
18759. 
18760. Statistics Report:
18761. ------------------
18762.    Size:  
18763.    ------------------------
18764.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
18765.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
18766.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
18767. 
18768.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
18769.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
18770. 
18771.    Location:
18772.    ------------------------
18773.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
18774.              Files End: !ZoneEndCurrent!
18775.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
18776.       
18777.    Gap Settings:
18778.    ------------------------
18779.          Gap Requested: !ZoneGapSizePer!%
18780.       Volume Rounding: !ZoneVolRoundUpPer!%
18781.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
18782.                  
18783.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
18784.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
18785.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
18786.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
18787.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
18788.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
18789.      
18790.    Free Space after Zone:
18791.    ------------------------
18792.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
18793.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
18794.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
18795. 
18796. Directory and Files Select:
18797. ---------------------------
18798. !ZoneTypeSelectCurrent!               
18799. ---------------------------
18800. ----------------------------------------------------------
18801. ")
18802. 
18803. # BANNER SET
18804. 
18805. # DATE TIME RUN ELP
18806. 
18807. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
18808. /* Xinclude "..\BannerSet.MyDc"X */
18809. /* pause(1) */
18810. 
18811. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18812. 
18813. Title('!Heading!')
18814. /* pause(1) */
18815. 
18816. /* NOTE: Can't round or truncate to integer precision. */
18817. 
18818. AppendLogfile("!LogFileName!", "!Title!")
18819. 
18820. 
18821. 
18822. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
18823. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
18824. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:18")
18825. 
18826. SetVariable(ZoneListByLine, "!ZoneListByLine!
18827. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
18828. 
18829. 
18830. /* Fixed Zone Position Handling */
18831. /* Literal number: */
18832. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
18833. /* Percentage of disk: */
18834. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
18835. /* Gap */
18836. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
18837. 
18838. /* ---------------------------------------------------------- */
18839. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
18840. # FILE STEP
18841. 
18842. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18843. 
18844. /* add message and move to a new line. */
18845. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18846. ")
18847. 
18848. /* display the line. (hopefully.) */
18849. # Zone Footer Set Statistics Window Text
18850. 
18851. SetStatisticsWindowText("----------------------------------------------------------
18852. Zones Processed: 
18853. ----------------------------------------------------------
18854. !ZoneListByLine!
18855. ----------------------------------------------------------
18856. Zone Processing Step:
18857. !ZoneStepByLine!    
18858. ----------------------------------------------------------
18859. Current Zone:
18860. !ZoneFooter!
18861. ----------------------------------------------------------
18862. Volume Statistics:
18863. !VolumeStatisticsDetail!
18864. ----------------------------------------------------------
18865. Zone Detailed Report:
18866. ----------------------------------------------------------
18867. !ZoneStatisticsDetail!
18868. ----------------------------------------------------------
18869. ")
18870. 
18871. 
18872. 
18873. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18874. 
18875. # BANNER SET
18876. 
18877. # DATE TIME RUN ELP
18878. 
18879. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
18880. /* Xinclude "..\BannerSet.MyDc"X */
18881. /* pause(1) */
18882. 
18883. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18884. 
18885. Title('!Heading!')
18886. /* pause(1) */
18887. 
18888. /* NOTE: Can't round or truncate to integer precision. */
18889. 
18890. pause(1)
18891. 
18892. # your stuff HERE (X)... pre file select code.
18893. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
18894. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
18895. 	# (X)
18896. 
18897. FileSelect
18898. 
18899. 	# your stuff can't really go here (errors.)
18900. 	# maybe for some reason I don't know of...
18901. 	
18902. 	# Actions next...
18903. 		# PageHiberDump start.
18904. (
18905. # Os PageHiberDump start.
18906. (
18907.   FileName("DataStore.edb")
18908.   or FileName("DUMP*.*")
18909.   or FileName("Hiberfil.sys")
18910.   or FileName("MEMORY.DMP")
18911.   or FileName("Pagefile.sys")
18912. )
18913. # Os PageHiberDump end.
18914. 
18915. )
18916. # PageHiberDump end.
18917. 
18918. 		FileActions
18919. 		  		/* ---------------------------------------------------------- */
18920. 	# Gap
18921. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
18922. 		# FILE STEP
18923. 
18924. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
18925. 
18926. /* add message and move to a new line. */
18927. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
18928. ")
18929. 
18930. /* display the line. (hopefully.) */
18931. # Zone Footer Set Statistics Window Text
18932. 
18933. SetStatisticsWindowText("----------------------------------------------------------
18934. Zones Processed: 
18935. ----------------------------------------------------------
18936. !ZoneListByLine!
18937. ----------------------------------------------------------
18938. Zone Processing Step:
18939. !ZoneStepByLine!    
18940. ----------------------------------------------------------
18941. Current Zone:
18942. !ZoneFooter!
18943. ----------------------------------------------------------
18944. Volume Statistics:
18945. !VolumeStatisticsDetail!
18946. ----------------------------------------------------------
18947. Zone Detailed Report:
18948. ----------------------------------------------------------
18949. !ZoneStatisticsDetail!
18950. ----------------------------------------------------------
18951. ")
18952. 
18953. 
18954. 
18955. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
18956. 
18957. # BANNER SET
18958. 
18959. # DATE TIME RUN ELP
18960. 
18961. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
18962. /* Xinclude "..\BannerSet.MyDc"X */
18963. /* pause(1) */
18964. 
18965. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
18966. 
18967. Title('!Heading!')
18968. /* pause(1) */
18969. 
18970. /* NOTE: Can't round or truncate to integer precision. */
18971. 
18972. pause(1)
18973. 	
18974. 	# ACTUAL GAP
18975. 		/* AddGap Variant. */
18976. 	  	# Zone Do Gap
18977. # Gap Calculation Methods:
18978. 
18979. /* 1) Anything you need to add first. */
18980. /* empty */
18981. 
18982. /* ---------------------------------------------------------- */
18983. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
18984. 	# GapRequestedStd.
18985. 
18986. 		/* ---------------------------------------------------------- */
18987. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
18988. 
18989. 		# Gap Calculation Methods:
18990. 
18991. /* AddGap Variants */
18992. 
18993. 	/* Standard */
18994. 		# Gap Calculation Methods:
18995. 	/* AddGap Variants */
18996. 	/* Standard */
18997. 
18998. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
18999. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
19000. 
19001. 	SetVariable(GapRequested, GapRequestedStd)
19002. 	
19003. 
19004. 	/* MFT Low High Method */
19005. 		# Gap Calculation Methods:
19006. 	/* AddGap Variants */
19007. 	/* MFT Low High Method */
19008. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
19009. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
19010. 	SetVariable(GapRequested, GapRequestedMft)
19011. 	
19012. 
19013. 	/* OS Volume Type Method */
19014. 		# Gap Calculation Methods:
19015. 	/* AddGap Variants */
19016. 	/* OS Volume Type Method */
19017. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
19018. 	SetVariable(GapRequested, GapRequestedOs)
19019. 
19020. 
19021. 
19022. /* MakeGap Variants */
19023. 
19024. 	/* Original Os 1-3 + MFT 2 */
19025. 		# Gap Calculation Methods:
19026. 	/* MakeGap Variants */
19027. 	/* Original Os 1-3 + MFT 2 */
19028. 	/* plus MFT gap placed inline at the dividing zone. */
19029. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
19030. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
19031. 	SetVariable(GapRequested, GapRequestedOrig)
19032. 	
19033. 	
19034. /* Note: You could comment out the ones not in use */
19035. /* However having the data in the log is useful. */
19036. /* Therefore the following line is otherwise needed. */
19037. 
19038. /* Standard used */
19039. 
19040. SetVariable(GapRequested, GapRequestedStd)
19041. 
19042. # Gap Calculation Methods:
19043. 
19044. /* AddGap Variants */
19045. 	/* Standard */
19046. 	/* MFT Low High Method */
19047. 	/* OS Volume Type Method */
19048. 
19049. /* MakeGap Variants */
19050. 	/* Original Os 1-3 + MFT 2 */
19051. 
19052. /* Note: You could comment out the ones not in use */
19053. /* However having the data in the log is useful. */
19054. /* Therefore the following line is otherwise needed. */
19055. 
19056. /* Standard is used currently */
19057. 
19058. 
19059. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
19060. 
19061. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
19062. 
19063. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
19064. 
19065. /* ---------------------------------------------------------- */
19066. /* 3) SMALL ZONE ADJUSTMENT. */
19067. /* Gab cant be larger than half the Zone Size. */
19068. 
19069. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
19070. 	
19071. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
19072. 
19073. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
19074. 
19075. /* ---------------------------------------------------------- */
19076. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
19077. # Gap Adjustments.
19078. 
19079. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
19080. 	
19081. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
19082. 
19083. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
19084. 
19085. /* ---------------------------------------------------------- */
19086. # BYPASS THIS.
19087. 	/* This is definitely wrong. */
19088. 	/* The question is can we steal gap from the next zone */
19089. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
19090. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
19091. 		# Zone Overflow.
19092. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
19093. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
19094. 
19095. /* ---------------------------------------------------------- */
19096. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
19097. # Remaining free space available.
19098. 
19099. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
19100. 	
19101. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
19102. 
19103. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
19104. 
19105. /* ---------------------------------------------------------- */
19106. # CURRENT gap to use.
19107. 
19108. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
19109. 
19110. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
19111. 
19112. /* ---------------------------------------------------------- */
19113. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
19114. # Debugging.
19115. 
19116. 	SetVariable(GapUsed, GapCurrent) // for debugging
19117. 
19118. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
19119. 
19120. 		# Your code HERE
19121. 
19122. /* ---------------------------------------------------------- */
19123. /* 7) YOUR CODE. */
19124. # YOUR CODE HERE:
19125. 	# INPUT: GapCurrent or GapCurrentLoc
19126. 	# OUTPUT: GapUsed...
19127. 
19128. /* ---------------------------------------------------------- */
19129. # Gap Size.
19130. # Actual Size of Gap.
19131. 
19132. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
19133. 
19134. /* ---------------------------------------------------------- */
19135. /* xxxxxxxxxxxxxxxxxxxxxx */
19136. # ADD THE GAP
19137. 	/* Xinclude "..\GapCommandDo.MyDc"X */
19138. /* xxxxxxxxxxxxxxxxxxxxxx */
19139. 
19140. 	
19141. 	# Zone Statistics	
19142. 	# Zone / Volume Statistics and Display
19143. 		
19144. 	# Accumulate Totals
19145.   	# Volume totals
19146. 
19147. /* Current total space used (by Zones and Gaps) */
19148. 
19149. SetVariable(VolumeZoneUsed, GapUsed)
19150. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
19151. /* Percentage */
19152. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
19153. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
19154. 
19155. /* Current total of free space requested */
19156. 
19157. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
19158. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
19159. /* Percent. */
19160. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
19161. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
19162. 
19163. /* Current total of free space used */
19164. 
19165. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
19166. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
19167. /* Percent */
19168. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
19169. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
19170. 
19171. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
19172. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
19173. /* Xinclude "..\DebugDisplayPause.MyDc"X */
19174. 
19175. 
19176. 	# Current Values
19177. 	# Cluster, Sector, Block adjust for display.
19178. 	# Bytes per cluster is volume specific.
19179. 
19180. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
19181. 
19182. # Current Zone values.
19183. 	# Begin, end and size.
19184. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
19185. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
19186. 
19187. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
19188. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
19189. 
19190. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
19191. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
19192. 
19193. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
19194. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
19195. 
19196. 	SetVariable(ZoneFragments,				"!ZONE210N!")
19197. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
19198. 		
19199. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
19200. /* identical code to here: (separation not needed. TEST.) */	
19201. 
19202. # Current Gap, Actual and Free Values
19203. 	# Gap
19204. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
19205. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
19206. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
19207. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
19208. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
19209. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
19210. 	
19211. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
19212. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
19213. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
19214. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
19215. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
19216. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
19217. 	
19218. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
19219. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
19220. 	
19221. 	# Actual Size and End
19222. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
19223. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
19224. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
19225. 	
19226. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
19227. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
19228. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
19229. 
19230. # Gap Size & Rounding
19231. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
19232. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
19233. 	
19234. 	# Free Space
19235. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
19236. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
19237. 
19238. 	# Footer:
19239. SetVariable(ZoneFooter, "----------------------------------------------------------
19240. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
19241. 
19242. Statistics Report:
19243. ------------------
19244.    Size:  
19245.    ------------------------
19246.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19247.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19248.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19249. 
19250.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19251.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19252. 
19253.    Location:
19254.    ------------------------
19255.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19256.              Files End: !ZoneEndCurrent!
19257.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19258.       
19259.    Gap Settings:
19260.    ------------------------
19261.          Gap Requested: !ZoneGapSizePer!%
19262.       Volume Rounding: !ZoneVolRoundUpPer!%
19263.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19264.                  
19265.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
19266.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
19267.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
19268.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
19269.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
19270.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
19271.      
19272.    Free Space after Zone:
19273.    ------------------------
19274.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19275.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19276.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19277. 
19278. Directory and Files Select:
19279. ---------------------------
19280. !ZoneTypeSelectCurrent!               
19281. ---------------------------
19282. ----------------------------------------------------------
19283. ")
19284. 	# Zone Footer Set Statistics Window Text
19285. 
19286. SetStatisticsWindowText("----------------------------------------------------------
19287. Zones Processed: 
19288. ----------------------------------------------------------
19289. !ZoneListByLine!
19290. ----------------------------------------------------------
19291. Zone Processing Step:
19292. !ZoneStepByLine!    
19293. ----------------------------------------------------------
19294. Current Zone:
19295. !ZoneFooter!
19296. ----------------------------------------------------------
19297. Volume Statistics:
19298. !VolumeStatisticsDetail!
19299. ----------------------------------------------------------
19300. Zone Detailed Report:
19301. ----------------------------------------------------------
19302. !ZoneStatisticsDetail!
19303. ----------------------------------------------------------
19304. ")
19305. 
19306. 
19307. 	
19308.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
19309. 
19310. 	# Add Zone to list of zones for display.
19311. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
19312. 
19313. 	# Footer:
19314. SetVariable(ZoneFooter, "----------------------------------------------------------
19315. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
19316. 
19317. Statistics Report:
19318. ------------------
19319.    Size:  
19320.    ------------------------
19321.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19322.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19323.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19324. 
19325.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19326.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19327. 
19328.    Location:
19329.    ------------------------
19330.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19331.              Files End: !ZoneEndCurrent!
19332.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19333.       
19334.    Gap Settings:
19335.    ------------------------
19336.          Gap Requested: !ZoneGapSizePer!%
19337.       Volume Rounding: !ZoneVolRoundUpPer!%
19338.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19339.                  
19340.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
19341.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
19342.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
19343.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
19344.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
19345.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
19346.      
19347.    Free Space after Zone:
19348.    ------------------------
19349.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19350.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19351.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19352. 
19353. Directory and Files Select:
19354. ---------------------------
19355. !ZoneTypeSelectCurrent!               
19356. ---------------------------
19357. ----------------------------------------------------------
19358. ")
19359. 
19360. 	# Add Zone Details to Report.	
19361. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
19362. !ZoneFooter!")
19363. 
19364. 
19365. 	
19366. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
19367. 			# FILE STEP
19368. 
19369. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19370. 
19371. /* add message and move to a new line. */
19372. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19373. ")
19374. 
19375. /* display the line. (hopefully.) */
19376. # Zone Footer Set Statistics Window Text
19377. 
19378. SetStatisticsWindowText("----------------------------------------------------------
19379. Zones Processed: 
19380. ----------------------------------------------------------
19381. !ZoneListByLine!
19382. ----------------------------------------------------------
19383. Zone Processing Step:
19384. !ZoneStepByLine!    
19385. ----------------------------------------------------------
19386. Current Zone:
19387. !ZoneFooter!
19388. ----------------------------------------------------------
19389. Volume Statistics:
19390. !VolumeStatisticsDetail!
19391. ----------------------------------------------------------
19392. Zone Detailed Report:
19393. ----------------------------------------------------------
19394. !ZoneStatisticsDetail!
19395. ----------------------------------------------------------
19396. ")
19397. 
19398. 
19399. 
19400. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19401. 
19402. # BANNER SET
19403. 
19404. # DATE TIME RUN ELP
19405. 
19406. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
19407. /* Xinclude "..\BannerSet.MyDc"X */
19408. /* pause(1) */
19409. 
19410. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19411. 
19412. Title('!Heading!')
19413. /* pause(1) */
19414. 
19415. /* NOTE: Can't round or truncate to integer precision. */
19416. 
19417. pause(1)
19418. 
19419. 			SortByImportSequence(Descending SkipBlock(SkipBlockFiles,SkipBlockBytes)) 
19420. 
19421. 			SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
19422. 		# FILE STEP
19423. 
19424. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19425. 
19426. /* add message and move to a new line. */
19427. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19428. ")
19429. 
19430. /* display the line. (hopefully.) */
19431. # Zone Footer Set Statistics Window Text
19432. 
19433. SetStatisticsWindowText("----------------------------------------------------------
19434. Zones Processed: 
19435. ----------------------------------------------------------
19436. !ZoneListByLine!
19437. ----------------------------------------------------------
19438. Zone Processing Step:
19439. !ZoneStepByLine!    
19440. ----------------------------------------------------------
19441. Current Zone:
19442. !ZoneFooter!
19443. ----------------------------------------------------------
19444. Volume Statistics:
19445. !VolumeStatisticsDetail!
19446. ----------------------------------------------------------
19447. Zone Detailed Report:
19448. ----------------------------------------------------------
19449. !ZoneStatisticsDetail!
19450. ----------------------------------------------------------
19451. ")
19452. 
19453. 
19454. 
19455. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19456. 
19457. # BANNER SET
19458. 
19459. # DATE TIME RUN ELP
19460. 
19461. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
19462. /* Xinclude "..\BannerSet.MyDc"X */
19463. /* pause(1) */
19464. 
19465. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19466. 
19467. Title('!Heading!')
19468. /* pause(1) */
19469. 
19470. /* NOTE: Can't round or truncate to integer precision. */
19471. 
19472. pause(1)
19473. 
19474. 		# Zone Do Footer
19475. 
19476. /* ---------------------------------------------------------- */
19477. # File Select
19478. 	# Select Statments
19479. # File Actions 
19480. 	# Standard or OS File Actions.
19481. 	# Resume...
19482. 	
19483. 	# your stuff HERE (X)... post zone (file) file actions code.
19484. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
19485. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
19486. 		# (X)
19487. 		
19488. 		/* ??? Set window? */
19489. 	
19490. 	# ADD THE GAP
19491. 		
19492. # Vacate (good for diagnostics)
19493. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
19494. 
19495. # DoNotVacate - DO NOT Vacate (recommended)
19496. 
19497. # Vacate
19498. /* AddGap(GapUsedLoc) */
19499. 
19500. # DO Not Vacate
19501. AddGap(GapUsedLoc, DoNotVacate) 
19502. 	
19503. 	
19504. /* ---------------------------------------------------------- */
19505. # (failed) TEST for boolean logic.
19506. 
19507. /* It should work in the gap calculations for turning options */
19508. /* on and off but it will NOT work here. */
19509. 
19510. /* Boolean setting X or FlagX. */
19511. /* Where X will be on or off: */
19512. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
19513. /*      For ON:  (X  *  FlagAny) */
19514. 
19515. /* 1) Failed, zero gap overrode the previous one. */
19516. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
19517. /* AddGap(GapUsedTemp) */ 
19518. 
19519. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
19520. /* AddGap(GapUsedTemp, DoNotVacate) */ 
19521. 
19522. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
19523. 
19524. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
19525. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
19526. /* AddGap(GapUsedTemp) */ 
19527. 
19528. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
19529. /* AddGap(GapUsedTemp, DoNotVacate) */ 
19530. 
19531. /* ---------------------------------------------------------- */
19532. 
19533. # Vacate
19534. /* AddGap(GapUsed) */
19535. 
19536. # DO NOT Vacate (recommended)
19537. /* AddGap(GapUsed, DoNotVacate) */ 
19538. 	
19539. 
19540. 		
19541. # 
19542. FileEnd
19543. /* ---------------------------------------------------------- */
19544. 
19545. # your stuff HERE (X)... post zone (file) code.
19546. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
19547. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
19548. 	# (X)
19549. 
19550. SetVariable(FileStepDescription,"Zone finished, reporting.")
19551. # FILE STEP
19552. 
19553. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
19554. 
19555. /* add message and move to a new line. */
19556. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
19557. ")
19558. 
19559. /* display the line. (hopefully.) */
19560. # Zone Footer Set Statistics Window Text
19561. 
19562. SetStatisticsWindowText("----------------------------------------------------------
19563. Zones Processed: 
19564. ----------------------------------------------------------
19565. !ZoneListByLine!
19566. ----------------------------------------------------------
19567. Zone Processing Step:
19568. !ZoneStepByLine!    
19569. ----------------------------------------------------------
19570. Current Zone:
19571. !ZoneFooter!
19572. ----------------------------------------------------------
19573. Volume Statistics:
19574. !VolumeStatisticsDetail!
19575. ----------------------------------------------------------
19576. Zone Detailed Report:
19577. ----------------------------------------------------------
19578. !ZoneStatisticsDetail!
19579. ----------------------------------------------------------
19580. ")
19581. 
19582. 
19583. 
19584. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
19585. 
19586. # BANNER SET
19587. 
19588. # DATE TIME RUN ELP
19589. 
19590. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
19591. /* Xinclude "..\BannerSet.MyDc"X */
19592. /* pause(1) */
19593. 
19594. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19595. 
19596. Title('!Heading!')
19597. /* pause(1) */
19598. 
19599. /* NOTE: Can't round or truncate to integer precision. */
19600. 
19601. pause(1)
19602. 
19603. # Zone When Finished
19604. 
19605. # BANNER SET
19606. 
19607. # DATE TIME RUN ELP
19608. 
19609. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
19610. /* Xinclude "..\BannerSet.MyDc"X */
19611. /* pause(1) */
19612. 
19613. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19614. 
19615. Title('!Heading!')
19616. /* pause(1) */
19617. 
19618. /* NOTE: Can't round or truncate to integer precision. */
19619. 
19620. AppendLogfile("!LogFileName!", "!Title!")
19621. 
19622. 
19623. 
19624. # Zone Statistics	
19625. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
19626. 
19627. # Footer:
19628. SetVariable(ZoneFooter, "----------------------------------------------------------
19629. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
19630. 
19631. Statistics Report:
19632. ------------------
19633.    Size:  
19634.    ------------------------
19635.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
19636.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
19637.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
19638. 
19639.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
19640.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
19641. 
19642.    Location:
19643.    ------------------------
19644.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
19645.              Files End: !ZoneEndCurrent!
19646.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
19647.       
19648.    Gap Settings:
19649.    ------------------------
19650.          Gap Requested: !ZoneGapSizePer!%
19651.       Volume Rounding: !ZoneVolRoundUpPer!%
19652.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
19653.                  
19654.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
19655.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
19656.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
19657.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
19658.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
19659.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
19660.      
19661.    Free Space after Zone:
19662.    ------------------------
19663.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
19664.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
19665.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
19666. 
19667. Directory and Files Select:
19668. ---------------------------
19669. !ZoneTypeSelectCurrent!               
19670. ---------------------------
19671. ----------------------------------------------------------
19672. ")
19673. 
19674. AppendLogfile("!LogFileName!", ".")
19675. AppendLogfile("!LogFileName!", "!ZoneFooter!")
19676. AppendLogfile("!LogFileName!", ".")
19677. 
19678. # Zone Footer Set Statistics Window Text
19679. 
19680. SetStatisticsWindowText("----------------------------------------------------------
19681. Zones Processed: 
19682. ----------------------------------------------------------
19683. !ZoneListByLine!
19684. ----------------------------------------------------------
19685. Zone Processing Step:
19686. !ZoneStepByLine!    
19687. ----------------------------------------------------------
19688. Current Zone:
19689. !ZoneFooter!
19690. ----------------------------------------------------------
19691. Volume Statistics:
19692. !VolumeStatisticsDetail!
19693. ----------------------------------------------------------
19694. Zone Detailed Report:
19695. ----------------------------------------------------------
19696. !ZoneStatisticsDetail!
19697. ----------------------------------------------------------
19698. ")
19699. 
19700. 
19701. 
19702. /* pause() */
19703. /* pause() */
19704. 
19705. 
19706. 
19707. /* ---------------------------------------------------------- */
19708.   
19709. 
19710. /* ---------------------------------------------------------- */
19711. 
19712. /* XXXXXXXXXXXXXXXXXXXXXXXXX */
19713. 
19714. /* ---------------------------------------------------------- */
19715. /* Zone Games */
19716. /* ---------------------------------------------------------- */
19717. /* Zone Games */
19718. SetVariable(ZoneLabel, "!ZoneLabelGames!")
19719. SetVariable(ZoneDescription, "!ZoneDescriptionGames!")
19720. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpGames!")
19721. SetVariable(ZoneGapSize, "!ZoneGapSizeGames!")
19722. SetVariable(ZoneTypeSelect,'# Games start.
19723. # NotBlobsArchivesBu start.
19724. (not (
19725. # Blobs start.
19726. (
19727. # BlobsAndExceptions start.
19728. ( not(
19729.   FileName("*.bat")
19730.   or FileName("*.css")
19731.   or FileName("*.dll")
19732.   or FileName("*.exe")
19733.   or FileName("*.htm*")
19734.   or FileName("*.jar")
19735.   or FileName("*.js")
19736.   or FileName("*.script")
19737.   or FileName("*.wsf")
19738.   or (
19739. # Databases start.
19740. (
19741.   FileName("*.crypt*")
19742.   or FileName("*.db*")
19743.   or FileName("*.rdb*")
19744.   or FileName("*.dc*")
19745.   or FileName("*.dict*")
19746.   or FileName("*.?db*")
19747.   or FileName("*.?rdb*")
19748.   or FileName("*.md*")
19749.   or FileName("*.myd")
19750.   or FileName("*.ndf")
19751.   or FileName("*.ns?")
19752.   or FileName("*.pab")
19753.   or FileName("*.pst")
19754.   or FileName("*.sd?*")
19755.   or FileName("*.sq**")
19756.   or FileName("*.tmd")
19757.   or FileName("*.tps")
19758.   or FileName("*.tr*")
19759. )
19760. # Databases end.
19761. 
19762.     # BlobsAndExceptions
19763.     or 
19764. # Data start.
19765. (
19766.   DirectoryName("Data*")
19767.   or DirectoryName("Device*")
19768.   or DirectoryName("Export*")
19769.   or DirectoryName("Import*")
19770.   or DirectoryName("Log*")
19771.   or DirectoryName("*Log")
19772.   or DirectoryName("Maintenance*")
19773.   or DirectoryName("Rec*")
19774.   or DirectoryName("Sales*")
19775.   or DirectoryName("Search*")
19776.   or DirectoryName("User*")
19777. )
19778. # Data end.
19779. 
19780.     # BlobsAndExceptions
19781.   )
19782. ) )
19783. # BlobsAndExceptions end.
19784. 
19785. # Blobs
19786. ) and (
19787.   Size(BlobFileSize,0)
19788.   or (
19789.     FileName("*.arj")
19790.     or FileName("*.bup")
19791.     or FileName("*.bz2")
19792.     or FileName("*.chm")
19793.     or FileName("*.dvr-ms")
19794.     or FileName("*.gz")
19795.     or FileName("*.ifo")
19796.     or FileName("*.lzh")
19797.     or FileName("*.pdf")
19798.     or FileName("*.rpm")
19799.     or FileName("*.wmv")
19800.     or FileName("*.vob")
19801.     or FileName("*.z")
19802.   ) 
19803. )
19804. # Blobs end.
19805. 
19806. # NotBlobsArchivesBu
19807. or 
19808. # Archives start.
19809. (
19810.   DirectoryName("*Archive*")
19811.   or DirectoryName("*History*")
19812.   or DirectoryName("*Old")
19813.   or DirectoryName("* Old *")
19814.   or DirectoryName("Old *")
19815. 
19816.   or FileName("*.7z")
19817.   or FileName("*.cab")
19818.   or FileName("*.iso")
19819.   or FileName("*.msi")
19820.   or FileName("*.old")
19821.   or FileName("*.rar")
19822.   or FileName("*.tar")
19823.   or FileName("*.zip")
19824.   or
19825. # WinSysLow start.
19826. (
19827.   DirectoryName("$*")
19828.   or DirectoryName("0*")
19829.   or DirectoryName("1*")
19830.   or DirectoryName("2*")
19831.   or DirectoryName("3*")
19832.   or DirectoryName("4*")
19833.   or DirectoryName("5*")
19834.   or DirectoryName("6*")
19835.   or DirectoryName("7*")
19836.   or DirectoryName("8*")
19837.   or DirectoryName("9*")
19838. 
19839.   or DirectoryName("dllcache")
19840.   or DirectoryName("Downloaded Installations")
19841.   or DirectoryName("Ehome")
19842.   or DirectoryName("Fonts")
19843.   or DirectoryName("Help")
19844.   or DirectoryName("I386")
19845.   or DirectoryName("ie?updates")
19846.   or DirectoryName("Installer")
19847.   or DirectoryName("Installshield Installation Information")
19848.   or DirectoryName("IME")
19849.   or DirectoryName("*RECYCLE*")
19850.   or DirectoryName("ServicePackFiles")
19851.   or DirectoryName("SoftwareDistribution")
19852.   or DirectoryName("Speech")
19853.   or DirectoryName("Symbols")
19854.   or DirectoryName("System Volume Information")
19855.   or DirectoryName("windows.old")
19856. )
19857. # WinSysLow end.
19858. 
19859.   # Archives
19860. )
19861. # Archives end.
19862. 
19863. # NotBlobsArchivesBu
19864. or
19865. # Backups start.
19866. (
19867.   DirectoryName("*Backup*")
19868.   or DirectoryName("*Bu")
19869.   or DirectoryName("* Bu *")
19870.   or DirectoryName("Bu *")
19871. 
19872.   or FileName("*.bak")
19873.   or FileName("* - Copy*")
19874. )
19875. # Backups end.
19876. 
19877. # NotBlobsArchivesBu
19878. ) )
19879. # NotBlobsArchivesBu end.
19880. 
19881. # People
19882. and (
19883. # Games start.
19884. (
19885.   DirectoryName("Game*")
19886.   or DirectoryName("Epic*")
19887.   or DirectoryName("*XBox*")
19888.   or DirectoryName("*PS2*")
19889. )
19890. # Games end.
19891. 
19892. # People
19893. )
19894. # People end.
19895. ')
19896. 
19897. 	# Zone Do Header
19898. 
19899. # Zone When Started
19900. 
19901. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
19902. # Display Set Zone
19903. 
19904. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
19905. SetVariable(FileStepDescription,	"")
19906. 
19907. SetVariable(ZoneStepByLine, 			"Zone started.
19908. ")
19909. 
19910. # BANNER SET
19911. 
19912. # DATE TIME RUN ELP
19913. 
19914. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
19915. /* Xinclude "..\BannerSet.MyDc"X */
19916. /* pause(1) */
19917. 
19918. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
19919. 
19920. Title('!Heading!')
19921. /* pause(1) */
19922. 
19923. /* NOTE: Can't round or truncate to integer precision. */
19924. 
19925. AppendLogfile("!LogFileName!", "!Title!")
19926. 
19927. 
19928. 
19929. pause(1)
19930. 
19931. 
19932. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
19933. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
19934. 
19935. SetVariable(ZoneStepNoCurrent, 0)
19936. 
19937. 
19938. # Zone Do Current Clear
19939. 
19940. SetVariable(ZoneTypeSelectCurrent, 		"")
19941. 
19942. SetVariable(ZoneBeginCurrent, 			0)
19943. SetVariable(ZoneBeginPerCurrent, 		0)
19944. SetVariable(ZoneEndCurrent, 			0)
19945. SetVariable(ZoneEndPerCurrent, 			0)
19946. 
19947. SetVariable(ZoneSizeCurrent,			0)
19948. SetVariable(ZoneSizePerCurrent,			0)
19949. 
19950. SetVariable(ZoneGapRequestedCurrent,	0)
19951. SetVariable(ZoneGapRoundedCurrent, 		0)
19952. SetVariable(ZoneGapAdjustedCurrent, 	0)
19953. SetVariable(ZoneGapAvailableCurrent, 	0)
19954. SetVariable(ZoneGapCurrent,				0)
19955. SetVariable(ZoneGapUsedCurrent, 		0)
19956. 
19957. SetVariable(ZoneGapActualCurrent, 		0)
19958. SetVariable(ZoneGapActualPerCurrent, 	0)
19959. 
19960. SetVariable(ZoneSizeActual, 			0)
19961. SetVariable(ZoneSizeActualCurrent,		0)
19962. 
19963. SetVariable(ZoneEndActual, 				0)
19964. SetVariable(ZoneEndActualCurrent,		0)			
19965. SetVariable(ZoneSizeActualPerCurrent, 	0)
19966.       
19967. SetVariable(ZoneFilesFolders,			0)
19968. SetVariable(ZoneFilesFoldersPer,		0) 
19969. 
19970. SetVariable(ZoneFragments,				0)
19971. SetVariable(ZoneFragmentsPer,			0) 
19972. 		
19973. SetVariable(ZoneEndActualCurrent, 		0)
19974. SetVariable(ZoneEndActualPerCurrent, 	0)
19975. 
19976. # Gap Calculation Methodology:
19977. 	# Requested
19978. 	SetVariable(GapRequested, 			0) 
19979. 	SetVariable(GapRequestedStd, 		0) 
19980. 	SetVariable(GapRequestedMft, 		0) 
19981. 	SetVariable(GapRequestedOs, 		0) 
19982. 	SetVariable(GapRequestedOriginal, 	0) 
19983. 	
19984. 	# Gap Adjustments
19985. 	SetVariable(GapRounded, 			0)
19986. 	# SetVariable(GapAdjusted, 			0)
19987. 	SetVariable(GapAvailable, 			0)
19988. 	SetVariable(GapCurrent, 			0)
19989. 	SetVariable(GapActual, 				0)
19990. 	SetVariable(GapUsed, 				0)
19991. 	
19992. 	# Gap Adjustments
19993. 	SetVariable(GapRoundedLoc, 			0)
19994. 	# SetVariable(GapAdjustedLoc, 		0)
19995. 	SetVariable(GapAvailableLoc, 		0)
19996. 	SetVariable(GapCurrentLoc, 			0)
19997. 	SetVariable(GapActualLoc,			0)
19998. 	SetVariable(GapUsedLoc,				0)
19999. 	
20000. 	# Space usage
20001. 	SetVariable(ZoneFreePerRequested, 	0)
20002. 	SetVariable(ZoneFreePerUsed, 		0)
20003. 
20004. # Gap Size & Rounding
20005. 	SetVariable(ZoneGapSizePer, 		0)
20006. 	SetVariable(ZoneVolRoundUpPer, 		0)
20007. 	
20008. 	# Free Space
20009. 	SetVariable(ZoneFreeUsedPer, 		0)
20010. 	SetVariable(ZoneFreeRequestedPer, 	0)
20011. 
20012. 
20013. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
20014. 
20015. # Footer:
20016. SetVariable(ZoneFooter, "----------------------------------------------------------
20017. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
20018. 
20019. Statistics Report:
20020. ------------------
20021.    Size:  
20022.    ------------------------
20023.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20024.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20025.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20026. 
20027.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20028.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20029. 
20030.    Location:
20031.    ------------------------
20032.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20033.              Files End: !ZoneEndCurrent!
20034.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20035.       
20036.    Gap Settings:
20037.    ------------------------
20038.          Gap Requested: !ZoneGapSizePer!%
20039.       Volume Rounding: !ZoneVolRoundUpPer!%
20040.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20041.                  
20042.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
20043.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
20044.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
20045.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
20046.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
20047.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
20048.      
20049.    Free Space after Zone:
20050.    ------------------------
20051.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20052.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20053.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20054. 
20055. Directory and Files Select:
20056. ---------------------------
20057. !ZoneTypeSelectCurrent!               
20058. ---------------------------
20059. ----------------------------------------------------------
20060. ")
20061. 
20062. # BANNER SET
20063. 
20064. # DATE TIME RUN ELP
20065. 
20066. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
20067. /* Xinclude "..\BannerSet.MyDc"X */
20068. /* pause(1) */
20069. 
20070. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20071. 
20072. Title('!Heading!')
20073. /* pause(1) */
20074. 
20075. /* NOTE: Can't round or truncate to integer precision. */
20076. 
20077. AppendLogfile("!LogFileName!", "!Title!")
20078. 
20079. 
20080. 
20081. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
20082. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
20083. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:18")
20084. 
20085. SetVariable(ZoneListByLine, "!ZoneListByLine!
20086. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
20087. 
20088. 
20089. /* Fixed Zone Position Handling */
20090. /* Literal number: */
20091. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
20092. /* Percentage of disk: */
20093. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
20094. /* Gap */
20095. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
20096. 
20097. /* ---------------------------------------------------------- */
20098. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
20099. # FILE STEP
20100. 
20101. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20102. 
20103. /* add message and move to a new line. */
20104. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20105. ")
20106. 
20107. /* display the line. (hopefully.) */
20108. # Zone Footer Set Statistics Window Text
20109. 
20110. SetStatisticsWindowText("----------------------------------------------------------
20111. Zones Processed: 
20112. ----------------------------------------------------------
20113. !ZoneListByLine!
20114. ----------------------------------------------------------
20115. Zone Processing Step:
20116. !ZoneStepByLine!    
20117. ----------------------------------------------------------
20118. Current Zone:
20119. !ZoneFooter!
20120. ----------------------------------------------------------
20121. Volume Statistics:
20122. !VolumeStatisticsDetail!
20123. ----------------------------------------------------------
20124. Zone Detailed Report:
20125. ----------------------------------------------------------
20126. !ZoneStatisticsDetail!
20127. ----------------------------------------------------------
20128. ")
20129. 
20130. 
20131. 
20132. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20133. 
20134. # BANNER SET
20135. 
20136. # DATE TIME RUN ELP
20137. 
20138. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
20139. /* Xinclude "..\BannerSet.MyDc"X */
20140. /* pause(1) */
20141. 
20142. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20143. 
20144. Title('!Heading!')
20145. /* pause(1) */
20146. 
20147. /* NOTE: Can't round or truncate to integer precision. */
20148. 
20149. pause(1)
20150. 
20151. # your stuff HERE (X)... pre file select code.
20152. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
20153. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
20154. 	# (X)
20155. 
20156. FileSelect
20157. 
20158. 	# your stuff can't really go here (errors.)
20159. 	# maybe for some reason I don't know of...
20160. 	
20161. 	# Actions next...
20162. 	# Games start.
20163. # NotBlobsArchivesBu start.
20164. (not (
20165. # Blobs start.
20166. (
20167. # BlobsAndExceptions start.
20168. ( not(
20169.   FileName("*.bat")
20170.   or FileName("*.css")
20171.   or FileName("*.dll")
20172.   or FileName("*.exe")
20173.   or FileName("*.htm*")
20174.   or FileName("*.jar")
20175.   or FileName("*.js")
20176.   or FileName("*.script")
20177.   or FileName("*.wsf")
20178.   or (
20179. # Databases start.
20180. (
20181.   FileName("*.crypt*")
20182.   or FileName("*.db*")
20183.   or FileName("*.rdb*")
20184.   or FileName("*.dc*")
20185.   or FileName("*.dict*")
20186.   or FileName("*.?db*")
20187.   or FileName("*.?rdb*")
20188.   or FileName("*.md*")
20189.   or FileName("*.myd")
20190.   or FileName("*.ndf")
20191.   or FileName("*.ns?")
20192.   or FileName("*.pab")
20193.   or FileName("*.pst")
20194.   or FileName("*.sd?*")
20195.   or FileName("*.sq**")
20196.   or FileName("*.tmd")
20197.   or FileName("*.tps")
20198.   or FileName("*.tr*")
20199. )
20200. # Databases end.
20201. 
20202.     # BlobsAndExceptions
20203.     or 
20204. # Data start.
20205. (
20206.   DirectoryName("Data*")
20207.   or DirectoryName("Device*")
20208.   or DirectoryName("Export*")
20209.   or DirectoryName("Import*")
20210.   or DirectoryName("Log*")
20211.   or DirectoryName("*Log")
20212.   or DirectoryName("Maintenance*")
20213.   or DirectoryName("Rec*")
20214.   or DirectoryName("Sales*")
20215.   or DirectoryName("Search*")
20216.   or DirectoryName("User*")
20217. )
20218. # Data end.
20219. 
20220.     # BlobsAndExceptions
20221.   )
20222. ) )
20223. # BlobsAndExceptions end.
20224. 
20225. # Blobs
20226. ) and (
20227.   Size(BlobFileSize,0)
20228.   or (
20229.     FileName("*.arj")
20230.     or FileName("*.bup")
20231.     or FileName("*.bz2")
20232.     or FileName("*.chm")
20233.     or FileName("*.dvr-ms")
20234.     or FileName("*.gz")
20235.     or FileName("*.ifo")
20236.     or FileName("*.lzh")
20237.     or FileName("*.pdf")
20238.     or FileName("*.rpm")
20239.     or FileName("*.wmv")
20240.     or FileName("*.vob")
20241.     or FileName("*.z")
20242.   ) 
20243. )
20244. # Blobs end.
20245. 
20246. # NotBlobsArchivesBu
20247. or 
20248. # Archives start.
20249. (
20250.   DirectoryName("*Archive*")
20251.   or DirectoryName("*History*")
20252.   or DirectoryName("*Old")
20253.   or DirectoryName("* Old *")
20254.   or DirectoryName("Old *")
20255. 
20256.   or FileName("*.7z")
20257.   or FileName("*.cab")
20258.   or FileName("*.iso")
20259.   or FileName("*.msi")
20260.   or FileName("*.old")
20261.   or FileName("*.rar")
20262.   or FileName("*.tar")
20263.   or FileName("*.zip")
20264.   or
20265. # WinSysLow start.
20266. (
20267.   DirectoryName("$*")
20268.   or DirectoryName("0*")
20269.   or DirectoryName("1*")
20270.   or DirectoryName("2*")
20271.   or DirectoryName("3*")
20272.   or DirectoryName("4*")
20273.   or DirectoryName("5*")
20274.   or DirectoryName("6*")
20275.   or DirectoryName("7*")
20276.   or DirectoryName("8*")
20277.   or DirectoryName("9*")
20278. 
20279.   or DirectoryName("dllcache")
20280.   or DirectoryName("Downloaded Installations")
20281.   or DirectoryName("Ehome")
20282.   or DirectoryName("Fonts")
20283.   or DirectoryName("Help")
20284.   or DirectoryName("I386")
20285.   or DirectoryName("ie?updates")
20286.   or DirectoryName("Installer")
20287.   or DirectoryName("Installshield Installation Information")
20288.   or DirectoryName("IME")
20289.   or DirectoryName("*RECYCLE*")
20290.   or DirectoryName("ServicePackFiles")
20291.   or DirectoryName("SoftwareDistribution")
20292.   or DirectoryName("Speech")
20293.   or DirectoryName("Symbols")
20294.   or DirectoryName("System Volume Information")
20295.   or DirectoryName("windows.old")
20296. )
20297. # WinSysLow end.
20298. 
20299.   # Archives
20300. )
20301. # Archives end.
20302. 
20303. # NotBlobsArchivesBu
20304. or
20305. # Backups start.
20306. (
20307.   DirectoryName("*Backup*")
20308.   or DirectoryName("*Bu")
20309.   or DirectoryName("* Bu *")
20310.   or DirectoryName("Bu *")
20311. 
20312.   or FileName("*.bak")
20313.   or FileName("* - Copy*")
20314. )
20315. # Backups end.
20316. 
20317. # NotBlobsArchivesBu
20318. ) )
20319. # NotBlobsArchivesBu end.
20320. 
20321. # People
20322. and (
20323. # Games start.
20324. (
20325.   DirectoryName("Game*")
20326.   or DirectoryName("Epic*")
20327.   or DirectoryName("*XBox*")
20328.   or DirectoryName("*PS2*")
20329. )
20330. # Games end.
20331. 
20332. # People
20333. )
20334. # People end.
20335. 
20336. 	# Zone
20337. # File Select
20338. 	# File Booleans
20339. 	# Resume...
20340. # File Action - SortByName.
20341. 
20342. FileActions
20343. 
20344. 		/* ---------------------------------------------------------- */
20345. 	# Gap
20346. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
20347. 		# FILE STEP
20348. 
20349. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20350. 
20351. /* add message and move to a new line. */
20352. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20353. ")
20354. 
20355. /* display the line. (hopefully.) */
20356. # Zone Footer Set Statistics Window Text
20357. 
20358. SetStatisticsWindowText("----------------------------------------------------------
20359. Zones Processed: 
20360. ----------------------------------------------------------
20361. !ZoneListByLine!
20362. ----------------------------------------------------------
20363. Zone Processing Step:
20364. !ZoneStepByLine!    
20365. ----------------------------------------------------------
20366. Current Zone:
20367. !ZoneFooter!
20368. ----------------------------------------------------------
20369. Volume Statistics:
20370. !VolumeStatisticsDetail!
20371. ----------------------------------------------------------
20372. Zone Detailed Report:
20373. ----------------------------------------------------------
20374. !ZoneStatisticsDetail!
20375. ----------------------------------------------------------
20376. ")
20377. 
20378. 
20379. 
20380. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20381. 
20382. # BANNER SET
20383. 
20384. # DATE TIME RUN ELP
20385. 
20386. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
20387. /* Xinclude "..\BannerSet.MyDc"X */
20388. /* pause(1) */
20389. 
20390. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20391. 
20392. Title('!Heading!')
20393. /* pause(1) */
20394. 
20395. /* NOTE: Can't round or truncate to integer precision. */
20396. 
20397. pause(1)
20398. 	
20399. 	# ACTUAL GAP
20400. 		/* AddGap Variant. */
20401. 	  	# Zone Do Gap
20402. # Gap Calculation Methods:
20403. 
20404. /* 1) Anything you need to add first. */
20405. /* empty */
20406. 
20407. /* ---------------------------------------------------------- */
20408. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
20409. 	# GapRequestedStd.
20410. 
20411. 		/* ---------------------------------------------------------- */
20412. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
20413. 
20414. 		# Gap Calculation Methods:
20415. 
20416. /* AddGap Variants */
20417. 
20418. 	/* Standard */
20419. 		# Gap Calculation Methods:
20420. 	/* AddGap Variants */
20421. 	/* Standard */
20422. 
20423. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
20424. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
20425. 
20426. 	SetVariable(GapRequested, GapRequestedStd)
20427. 	
20428. 
20429. 	/* MFT Low High Method */
20430. 		# Gap Calculation Methods:
20431. 	/* AddGap Variants */
20432. 	/* MFT Low High Method */
20433. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
20434. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
20435. 	SetVariable(GapRequested, GapRequestedMft)
20436. 	
20437. 
20438. 	/* OS Volume Type Method */
20439. 		# Gap Calculation Methods:
20440. 	/* AddGap Variants */
20441. 	/* OS Volume Type Method */
20442. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
20443. 	SetVariable(GapRequested, GapRequestedOs)
20444. 
20445. 
20446. 
20447. /* MakeGap Variants */
20448. 
20449. 	/* Original Os 1-3 + MFT 2 */
20450. 		# Gap Calculation Methods:
20451. 	/* MakeGap Variants */
20452. 	/* Original Os 1-3 + MFT 2 */
20453. 	/* plus MFT gap placed inline at the dividing zone. */
20454. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
20455. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
20456. 	SetVariable(GapRequested, GapRequestedOrig)
20457. 	
20458. 	
20459. /* Note: You could comment out the ones not in use */
20460. /* However having the data in the log is useful. */
20461. /* Therefore the following line is otherwise needed. */
20462. 
20463. /* Standard used */
20464. 
20465. SetVariable(GapRequested, GapRequestedStd)
20466. 
20467. # Gap Calculation Methods:
20468. 
20469. /* AddGap Variants */
20470. 	/* Standard */
20471. 	/* MFT Low High Method */
20472. 	/* OS Volume Type Method */
20473. 
20474. /* MakeGap Variants */
20475. 	/* Original Os 1-3 + MFT 2 */
20476. 
20477. /* Note: You could comment out the ones not in use */
20478. /* However having the data in the log is useful. */
20479. /* Therefore the following line is otherwise needed. */
20480. 
20481. /* Standard is used currently */
20482. 
20483. 
20484. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
20485. 
20486. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
20487. 
20488. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
20489. 
20490. /* ---------------------------------------------------------- */
20491. /* 3) SMALL ZONE ADJUSTMENT. */
20492. /* Gab cant be larger than half the Zone Size. */
20493. 
20494. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
20495. 	
20496. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
20497. 
20498. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
20499. 
20500. /* ---------------------------------------------------------- */
20501. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
20502. # Gap Adjustments.
20503. 
20504. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
20505. 	
20506. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
20507. 
20508. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
20509. 
20510. /* ---------------------------------------------------------- */
20511. # BYPASS THIS.
20512. 	/* This is definitely wrong. */
20513. 	/* The question is can we steal gap from the next zone */
20514. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
20515. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
20516. 		# Zone Overflow.
20517. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
20518. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
20519. 
20520. /* ---------------------------------------------------------- */
20521. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
20522. # Remaining free space available.
20523. 
20524. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
20525. 	
20526. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
20527. 
20528. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
20529. 
20530. /* ---------------------------------------------------------- */
20531. # CURRENT gap to use.
20532. 
20533. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
20534. 
20535. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
20536. 
20537. /* ---------------------------------------------------------- */
20538. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
20539. # Debugging.
20540. 
20541. 	SetVariable(GapUsed, GapCurrent) // for debugging
20542. 
20543. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
20544. 
20545. 		# Your code HERE
20546. 
20547. /* ---------------------------------------------------------- */
20548. /* 7) YOUR CODE. */
20549. # YOUR CODE HERE:
20550. 	# INPUT: GapCurrent or GapCurrentLoc
20551. 	# OUTPUT: GapUsed...
20552. 
20553. /* ---------------------------------------------------------- */
20554. # Gap Size.
20555. # Actual Size of Gap.
20556. 
20557. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
20558. 
20559. /* ---------------------------------------------------------- */
20560. /* xxxxxxxxxxxxxxxxxxxxxx */
20561. # ADD THE GAP
20562. 	/* Xinclude "..\GapCommandDo.MyDc"X */
20563. /* xxxxxxxxxxxxxxxxxxxxxx */
20564. 
20565. 	
20566. 	# Zone Statistics	
20567. 	# Zone / Volume Statistics and Display
20568. 		
20569. 	# Accumulate Totals
20570.   	# Volume totals
20571. 
20572. /* Current total space used (by Zones and Gaps) */
20573. 
20574. SetVariable(VolumeZoneUsed, GapUsed)
20575. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
20576. /* Percentage */
20577. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
20578. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
20579. 
20580. /* Current total of free space requested */
20581. 
20582. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
20583. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
20584. /* Percent. */
20585. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
20586. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
20587. 
20588. /* Current total of free space used */
20589. 
20590. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
20591. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
20592. /* Percent */
20593. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
20594. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
20595. 
20596. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
20597. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
20598. /* Xinclude "..\DebugDisplayPause.MyDc"X */
20599. 
20600. 
20601. 	# Current Values
20602. 	# Cluster, Sector, Block adjust for display.
20603. 	# Bytes per cluster is volume specific.
20604. 
20605. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
20606. 
20607. # Current Zone values.
20608. 	# Begin, end and size.
20609. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
20610. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
20611. 
20612. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
20613. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
20614. 
20615. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
20616. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
20617. 
20618. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
20619. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
20620. 
20621. 	SetVariable(ZoneFragments,				"!ZONE210N!")
20622. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
20623. 		
20624. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
20625. /* identical code to here: (separation not needed. TEST.) */	
20626. 
20627. # Current Gap, Actual and Free Values
20628. 	# Gap
20629. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
20630. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
20631. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
20632. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
20633. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
20634. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
20635. 	
20636. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
20637. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
20638. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
20639. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
20640. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
20641. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
20642. 	
20643. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
20644. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
20645. 	
20646. 	# Actual Size and End
20647. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
20648. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
20649. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
20650. 	
20651. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
20652. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
20653. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
20654. 
20655. # Gap Size & Rounding
20656. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
20657. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
20658. 	
20659. 	# Free Space
20660. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
20661. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
20662. 
20663. 	# Footer:
20664. SetVariable(ZoneFooter, "----------------------------------------------------------
20665. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
20666. 
20667. Statistics Report:
20668. ------------------
20669.    Size:  
20670.    ------------------------
20671.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20672.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20673.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20674. 
20675.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20676.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20677. 
20678.    Location:
20679.    ------------------------
20680.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20681.              Files End: !ZoneEndCurrent!
20682.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20683.       
20684.    Gap Settings:
20685.    ------------------------
20686.          Gap Requested: !ZoneGapSizePer!%
20687.       Volume Rounding: !ZoneVolRoundUpPer!%
20688.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20689.                  
20690.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
20691.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
20692.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
20693.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
20694.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
20695.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
20696.      
20697.    Free Space after Zone:
20698.    ------------------------
20699.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20700.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20701.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20702. 
20703. Directory and Files Select:
20704. ---------------------------
20705. !ZoneTypeSelectCurrent!               
20706. ---------------------------
20707. ----------------------------------------------------------
20708. ")
20709. 	# Zone Footer Set Statistics Window Text
20710. 
20711. SetStatisticsWindowText("----------------------------------------------------------
20712. Zones Processed: 
20713. ----------------------------------------------------------
20714. !ZoneListByLine!
20715. ----------------------------------------------------------
20716. Zone Processing Step:
20717. !ZoneStepByLine!    
20718. ----------------------------------------------------------
20719. Current Zone:
20720. !ZoneFooter!
20721. ----------------------------------------------------------
20722. Volume Statistics:
20723. !VolumeStatisticsDetail!
20724. ----------------------------------------------------------
20725. Zone Detailed Report:
20726. ----------------------------------------------------------
20727. !ZoneStatisticsDetail!
20728. ----------------------------------------------------------
20729. ")
20730. 
20731. 
20732. 	
20733.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
20734. 
20735. 	# Add Zone to list of zones for display.
20736. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
20737. 
20738. 	# Footer:
20739. SetVariable(ZoneFooter, "----------------------------------------------------------
20740. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
20741. 
20742. Statistics Report:
20743. ------------------
20744.    Size:  
20745.    ------------------------
20746.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
20747.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
20748.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
20749. 
20750.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
20751.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
20752. 
20753.    Location:
20754.    ------------------------
20755.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
20756.              Files End: !ZoneEndCurrent!
20757.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
20758.       
20759.    Gap Settings:
20760.    ------------------------
20761.          Gap Requested: !ZoneGapSizePer!%
20762.       Volume Rounding: !ZoneVolRoundUpPer!%
20763.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
20764.                  
20765.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
20766.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
20767.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
20768.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
20769.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
20770.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
20771.      
20772.    Free Space after Zone:
20773.    ------------------------
20774.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
20775.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
20776.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
20777. 
20778. Directory and Files Select:
20779. ---------------------------
20780. !ZoneTypeSelectCurrent!               
20781. ---------------------------
20782. ----------------------------------------------------------
20783. ")
20784. 
20785. 	# Add Zone Details to Report.	
20786. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
20787. !ZoneFooter!")
20788. 
20789. 
20790. 
20791. 	# DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
20792. 		/* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
20793. 		/* Xinclude "..\DebugDisplayPause.MyDc"X */
20794. 
20795.   	# Zone Statistics	
20796.   	/* Xinclude "..\ZoneDoStatistics.MyDc"X */
20797. 
20798. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
20799. 	# FILE STEP
20800. 
20801. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20802. 
20803. /* add message and move to a new line. */
20804. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20805. ")
20806. 
20807. /* display the line. (hopefully.) */
20808. # Zone Footer Set Statistics Window Text
20809. 
20810. SetStatisticsWindowText("----------------------------------------------------------
20811. Zones Processed: 
20812. ----------------------------------------------------------
20813. !ZoneListByLine!
20814. ----------------------------------------------------------
20815. Zone Processing Step:
20816. !ZoneStepByLine!    
20817. ----------------------------------------------------------
20818. Current Zone:
20819. !ZoneFooter!
20820. ----------------------------------------------------------
20821. Volume Statistics:
20822. !VolumeStatisticsDetail!
20823. ----------------------------------------------------------
20824. Zone Detailed Report:
20825. ----------------------------------------------------------
20826. !ZoneStatisticsDetail!
20827. ----------------------------------------------------------
20828. ")
20829. 
20830. 
20831. 
20832. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20833. 
20834. # BANNER SET
20835. 
20836. # DATE TIME RUN ELP
20837. 
20838. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
20839. /* Xinclude "..\BannerSet.MyDc"X */
20840. /* pause(1) */
20841. 
20842. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20843. 
20844. Title('!Heading!')
20845. /* pause(1) */
20846. 
20847. /* NOTE: Can't round or truncate to integer precision. */
20848. 
20849. pause(1)
20850. 
20851. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
20852. 	
20853. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
20854. 	# FILE STEP
20855. 
20856. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20857. 
20858. /* add message and move to a new line. */
20859. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20860. ")
20861. 
20862. /* display the line. (hopefully.) */
20863. # Zone Footer Set Statistics Window Text
20864. 
20865. SetStatisticsWindowText("----------------------------------------------------------
20866. Zones Processed: 
20867. ----------------------------------------------------------
20868. !ZoneListByLine!
20869. ----------------------------------------------------------
20870. Zone Processing Step:
20871. !ZoneStepByLine!    
20872. ----------------------------------------------------------
20873. Current Zone:
20874. !ZoneFooter!
20875. ----------------------------------------------------------
20876. Volume Statistics:
20877. !VolumeStatisticsDetail!
20878. ----------------------------------------------------------
20879. Zone Detailed Report:
20880. ----------------------------------------------------------
20881. !ZoneStatisticsDetail!
20882. ----------------------------------------------------------
20883. ")
20884. 
20885. 
20886. 
20887. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
20888. 
20889. # BANNER SET
20890. 
20891. # DATE TIME RUN ELP
20892. 
20893. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
20894. /* Xinclude "..\BannerSet.MyDc"X */
20895. /* pause(1) */
20896. 
20897. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
20898. 
20899. Title('!Heading!')
20900. /* pause(1) */
20901. 
20902. /* NOTE: Can't round or truncate to integer precision. */
20903. 
20904. pause(1)
20905. 
20906. 	# Footer next...
20907. 	
20908. 	# Zone Do Footer
20909. 
20910. /* ---------------------------------------------------------- */
20911. # File Select
20912. 	# Select Statments
20913. # File Actions 
20914. 	# Standard or OS File Actions.
20915. 	# Resume...
20916. 	
20917. 	# your stuff HERE (X)... post zone (file) file actions code.
20918. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
20919. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
20920. 		# (X)
20921. 		
20922. 		/* ??? Set window? */
20923. 	
20924. 	# ADD THE GAP
20925. 		
20926. # Vacate (good for diagnostics)
20927. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
20928. 
20929. # DoNotVacate - DO NOT Vacate (recommended)
20930. 
20931. # Vacate
20932. /* AddGap(GapUsedLoc) */
20933. 
20934. # DO Not Vacate
20935. AddGap(GapUsedLoc, DoNotVacate) 
20936. 	
20937. 	
20938. /* ---------------------------------------------------------- */
20939. # (failed) TEST for boolean logic.
20940. 
20941. /* It should work in the gap calculations for turning options */
20942. /* on and off but it will NOT work here. */
20943. 
20944. /* Boolean setting X or FlagX. */
20945. /* Where X will be on or off: */
20946. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
20947. /*      For ON:  (X  *  FlagAny) */
20948. 
20949. /* 1) Failed, zero gap overrode the previous one. */
20950. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
20951. /* AddGap(GapUsedTemp) */ 
20952. 
20953. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
20954. /* AddGap(GapUsedTemp, DoNotVacate) */ 
20955. 
20956. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
20957. 
20958. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
20959. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
20960. /* AddGap(GapUsedTemp) */ 
20961. 
20962. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
20963. /* AddGap(GapUsedTemp, DoNotVacate) */ 
20964. 
20965. /* ---------------------------------------------------------- */
20966. 
20967. # Vacate
20968. /* AddGap(GapUsed) */
20969. 
20970. # DO NOT Vacate (recommended)
20971. /* AddGap(GapUsed, DoNotVacate) */ 
20972. 	
20973. 
20974. 		
20975. # 
20976. FileEnd
20977. /* ---------------------------------------------------------- */
20978. 
20979. # your stuff HERE (X)... post zone (file) code.
20980. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
20981. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
20982. 	# (X)
20983. 
20984. SetVariable(FileStepDescription,"Zone finished, reporting.")
20985. # FILE STEP
20986. 
20987. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
20988. 
20989. /* add message and move to a new line. */
20990. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
20991. ")
20992. 
20993. /* display the line. (hopefully.) */
20994. # Zone Footer Set Statistics Window Text
20995. 
20996. SetStatisticsWindowText("----------------------------------------------------------
20997. Zones Processed: 
20998. ----------------------------------------------------------
20999. !ZoneListByLine!
21000. ----------------------------------------------------------
21001. Zone Processing Step:
21002. !ZoneStepByLine!    
21003. ----------------------------------------------------------
21004. Current Zone:
21005. !ZoneFooter!
21006. ----------------------------------------------------------
21007. Volume Statistics:
21008. !VolumeStatisticsDetail!
21009. ----------------------------------------------------------
21010. Zone Detailed Report:
21011. ----------------------------------------------------------
21012. !ZoneStatisticsDetail!
21013. ----------------------------------------------------------
21014. ")
21015. 
21016. 
21017. 
21018. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21019. 
21020. # BANNER SET
21021. 
21022. # DATE TIME RUN ELP
21023. 
21024. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
21025. /* Xinclude "..\BannerSet.MyDc"X */
21026. /* pause(1) */
21027. 
21028. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21029. 
21030. Title('!Heading!')
21031. /* pause(1) */
21032. 
21033. /* NOTE: Can't round or truncate to integer precision. */
21034. 
21035. pause(1)
21036. 
21037. # Zone When Finished
21038. 
21039. # BANNER SET
21040. 
21041. # DATE TIME RUN ELP
21042. 
21043. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
21044. /* Xinclude "..\BannerSet.MyDc"X */
21045. /* pause(1) */
21046. 
21047. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21048. 
21049. Title('!Heading!')
21050. /* pause(1) */
21051. 
21052. /* NOTE: Can't round or truncate to integer precision. */
21053. 
21054. AppendLogfile("!LogFileName!", "!Title!")
21055. 
21056. 
21057. 
21058. # Zone Statistics	
21059. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
21060. 
21061. # Footer:
21062. SetVariable(ZoneFooter, "----------------------------------------------------------
21063. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
21064. 
21065. Statistics Report:
21066. ------------------
21067.    Size:  
21068.    ------------------------
21069.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21070.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21071.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21072. 
21073.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21074.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21075. 
21076.    Location:
21077.    ------------------------
21078.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21079.              Files End: !ZoneEndCurrent!
21080.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21081.       
21082.    Gap Settings:
21083.    ------------------------
21084.          Gap Requested: !ZoneGapSizePer!%
21085.       Volume Rounding: !ZoneVolRoundUpPer!%
21086.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21087.                  
21088.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
21089.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
21090.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
21091.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
21092.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
21093.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
21094.      
21095.    Free Space after Zone:
21096.    ------------------------
21097.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21098.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21099.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21100. 
21101. Directory and Files Select:
21102. ---------------------------
21103. !ZoneTypeSelectCurrent!               
21104. ---------------------------
21105. ----------------------------------------------------------
21106. ")
21107. 
21108. AppendLogfile("!LogFileName!", ".")
21109. AppendLogfile("!LogFileName!", "!ZoneFooter!")
21110. AppendLogfile("!LogFileName!", ".")
21111. 
21112. # Zone Footer Set Statistics Window Text
21113. 
21114. SetStatisticsWindowText("----------------------------------------------------------
21115. Zones Processed: 
21116. ----------------------------------------------------------
21117. !ZoneListByLine!
21118. ----------------------------------------------------------
21119. Zone Processing Step:
21120. !ZoneStepByLine!    
21121. ----------------------------------------------------------
21122. Current Zone:
21123. !ZoneFooter!
21124. ----------------------------------------------------------
21125. Volume Statistics:
21126. !VolumeStatisticsDetail!
21127. ----------------------------------------------------------
21128. Zone Detailed Report:
21129. ----------------------------------------------------------
21130. !ZoneStatisticsDetail!
21131. ----------------------------------------------------------
21132. ")
21133. 
21134. 
21135. 
21136. /* pause() */
21137. /* pause() */
21138. 
21139. 
21140. 
21141. 
21142. /* ---------------------------------------------------------- */
21143. 
21144. 
21145. /* ---------------------------------------------------------- */
21146. /* Zone Shares */
21147. /* ---------------------------------------------------------- */
21148. /* Zone Shares */
21149. SetVariable(ZoneLabel, "!ZoneLabelShares!")
21150. SetVariable(ZoneDescription, "!ZoneDescriptionShares!")
21151. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpShares!")
21152. SetVariable(ZoneGapSize, "!ZoneGapSizeShares!")
21153. SetVariable(ZoneTypeSelect,'# Shares start.
21154. # NotBlobsArchivesBu start.
21155. (not (
21156. # Blobs start.
21157. (
21158. # BlobsAndExceptions start.
21159. ( not(
21160.   FileName("*.bat")
21161.   or FileName("*.css")
21162.   or FileName("*.dll")
21163.   or FileName("*.exe")
21164.   or FileName("*.htm*")
21165.   or FileName("*.jar")
21166.   or FileName("*.js")
21167.   or FileName("*.script")
21168.   or FileName("*.wsf")
21169.   or (
21170. # Databases start.
21171. (
21172.   FileName("*.crypt*")
21173.   or FileName("*.db*")
21174.   or FileName("*.rdb*")
21175.   or FileName("*.dc*")
21176.   or FileName("*.dict*")
21177.   or FileName("*.?db*")
21178.   or FileName("*.?rdb*")
21179.   or FileName("*.md*")
21180.   or FileName("*.myd")
21181.   or FileName("*.ndf")
21182.   or FileName("*.ns?")
21183.   or FileName("*.pab")
21184.   or FileName("*.pst")
21185.   or FileName("*.sd?*")
21186.   or FileName("*.sq**")
21187.   or FileName("*.tmd")
21188.   or FileName("*.tps")
21189.   or FileName("*.tr*")
21190. )
21191. # Databases end.
21192. 
21193.     # BlobsAndExceptions
21194.     or 
21195. # Data start.
21196. (
21197.   DirectoryName("Data*")
21198.   or DirectoryName("Device*")
21199.   or DirectoryName("Export*")
21200.   or DirectoryName("Import*")
21201.   or DirectoryName("Log*")
21202.   or DirectoryName("*Log")
21203.   or DirectoryName("Maintenance*")
21204.   or DirectoryName("Rec*")
21205.   or DirectoryName("Sales*")
21206.   or DirectoryName("Search*")
21207.   or DirectoryName("User*")
21208. )
21209. # Data end.
21210. 
21211.     # BlobsAndExceptions
21212.   )
21213. ) )
21214. # BlobsAndExceptions end.
21215. 
21216. # Blobs
21217. ) and (
21218.   Size(BlobFileSize,0)
21219.   or (
21220.     FileName("*.arj")
21221.     or FileName("*.bup")
21222.     or FileName("*.bz2")
21223.     or FileName("*.chm")
21224.     or FileName("*.dvr-ms")
21225.     or FileName("*.gz")
21226.     or FileName("*.ifo")
21227.     or FileName("*.lzh")
21228.     or FileName("*.pdf")
21229.     or FileName("*.rpm")
21230.     or FileName("*.wmv")
21231.     or FileName("*.vob")
21232.     or FileName("*.z")
21233.   ) 
21234. )
21235. # Blobs end.
21236. 
21237. # NotBlobsArchivesBu
21238. or 
21239. # Archives start.
21240. (
21241.   DirectoryName("*Archive*")
21242.   or DirectoryName("*History*")
21243.   or DirectoryName("*Old")
21244.   or DirectoryName("* Old *")
21245.   or DirectoryName("Old *")
21246. 
21247.   or FileName("*.7z")
21248.   or FileName("*.cab")
21249.   or FileName("*.iso")
21250.   or FileName("*.msi")
21251.   or FileName("*.old")
21252.   or FileName("*.rar")
21253.   or FileName("*.tar")
21254.   or FileName("*.zip")
21255.   or
21256. # WinSysLow start.
21257. (
21258.   DirectoryName("$*")
21259.   or DirectoryName("0*")
21260.   or DirectoryName("1*")
21261.   or DirectoryName("2*")
21262.   or DirectoryName("3*")
21263.   or DirectoryName("4*")
21264.   or DirectoryName("5*")
21265.   or DirectoryName("6*")
21266.   or DirectoryName("7*")
21267.   or DirectoryName("8*")
21268.   or DirectoryName("9*")
21269. 
21270.   or DirectoryName("dllcache")
21271.   or DirectoryName("Downloaded Installations")
21272.   or DirectoryName("Ehome")
21273.   or DirectoryName("Fonts")
21274.   or DirectoryName("Help")
21275.   or DirectoryName("I386")
21276.   or DirectoryName("ie?updates")
21277.   or DirectoryName("Installer")
21278.   or DirectoryName("Installshield Installation Information")
21279.   or DirectoryName("IME")
21280.   or DirectoryName("*RECYCLE*")
21281.   or DirectoryName("ServicePackFiles")
21282.   or DirectoryName("SoftwareDistribution")
21283.   or DirectoryName("Speech")
21284.   or DirectoryName("Symbols")
21285.   or DirectoryName("System Volume Information")
21286.   or DirectoryName("windows.old")
21287. )
21288. # WinSysLow end.
21289. 
21290.   # Archives
21291. )
21292. # Archives end.
21293. 
21294. # NotBlobsArchivesBu
21295. or
21296. # Backups start.
21297. (
21298.   DirectoryName("*Backup*")
21299.   or DirectoryName("*Bu")
21300.   or DirectoryName("* Bu *")
21301.   or DirectoryName("Bu *")
21302. 
21303.   or FileName("*.bak")
21304.   or FileName("* - Copy*")
21305. )
21306. # Backups end.
21307. 
21308. # NotBlobsArchivesBu
21309. ) )
21310. # NotBlobsArchivesBu end.
21311. 
21312. # Shares
21313. and (
21314. # Share start.
21315. (
21316.   DirectoryName("*Common*")
21317.   or DirectoryName("Media*")
21318.   or DirectoryName("Multimedia*")
21319.   or DirectoryName("*Public*")
21320.   or DirectoryName("*Share*")
21321. )
21322. # Share end.
21323. 
21324. # Shares
21325. or 
21326. # Family start.
21327. (
21328.     DirectoryName("*Family*")
21329. )
21330. # Family end.
21331. 
21332. # Shares
21333. )
21334. # Shares end.
21335. ')
21336. 
21337. 	# Zone Do Header
21338. 
21339. # Zone When Started
21340. 
21341. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
21342. # Display Set Zone
21343. 
21344. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
21345. SetVariable(FileStepDescription,	"")
21346. 
21347. SetVariable(ZoneStepByLine, 			"Zone started.
21348. ")
21349. 
21350. # BANNER SET
21351. 
21352. # DATE TIME RUN ELP
21353. 
21354. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
21355. /* Xinclude "..\BannerSet.MyDc"X */
21356. /* pause(1) */
21357. 
21358. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21359. 
21360. Title('!Heading!')
21361. /* pause(1) */
21362. 
21363. /* NOTE: Can't round or truncate to integer precision. */
21364. 
21365. AppendLogfile("!LogFileName!", "!Title!")
21366. 
21367. 
21368. 
21369. pause(1)
21370. 
21371. 
21372. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
21373. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
21374. 
21375. SetVariable(ZoneStepNoCurrent, 0)
21376. 
21377. 
21378. # Zone Do Current Clear
21379. 
21380. SetVariable(ZoneTypeSelectCurrent, 		"")
21381. 
21382. SetVariable(ZoneBeginCurrent, 			0)
21383. SetVariable(ZoneBeginPerCurrent, 		0)
21384. SetVariable(ZoneEndCurrent, 			0)
21385. SetVariable(ZoneEndPerCurrent, 			0)
21386. 
21387. SetVariable(ZoneSizeCurrent,			0)
21388. SetVariable(ZoneSizePerCurrent,			0)
21389. 
21390. SetVariable(ZoneGapRequestedCurrent,	0)
21391. SetVariable(ZoneGapRoundedCurrent, 		0)
21392. SetVariable(ZoneGapAdjustedCurrent, 	0)
21393. SetVariable(ZoneGapAvailableCurrent, 	0)
21394. SetVariable(ZoneGapCurrent,				0)
21395. SetVariable(ZoneGapUsedCurrent, 		0)
21396. 
21397. SetVariable(ZoneGapActualCurrent, 		0)
21398. SetVariable(ZoneGapActualPerCurrent, 	0)
21399. 
21400. SetVariable(ZoneSizeActual, 			0)
21401. SetVariable(ZoneSizeActualCurrent,		0)
21402. 
21403. SetVariable(ZoneEndActual, 				0)
21404. SetVariable(ZoneEndActualCurrent,		0)			
21405. SetVariable(ZoneSizeActualPerCurrent, 	0)
21406.       
21407. SetVariable(ZoneFilesFolders,			0)
21408. SetVariable(ZoneFilesFoldersPer,		0) 
21409. 
21410. SetVariable(ZoneFragments,				0)
21411. SetVariable(ZoneFragmentsPer,			0) 
21412. 		
21413. SetVariable(ZoneEndActualCurrent, 		0)
21414. SetVariable(ZoneEndActualPerCurrent, 	0)
21415. 
21416. # Gap Calculation Methodology:
21417. 	# Requested
21418. 	SetVariable(GapRequested, 			0) 
21419. 	SetVariable(GapRequestedStd, 		0) 
21420. 	SetVariable(GapRequestedMft, 		0) 
21421. 	SetVariable(GapRequestedOs, 		0) 
21422. 	SetVariable(GapRequestedOriginal, 	0) 
21423. 	
21424. 	# Gap Adjustments
21425. 	SetVariable(GapRounded, 			0)
21426. 	# SetVariable(GapAdjusted, 			0)
21427. 	SetVariable(GapAvailable, 			0)
21428. 	SetVariable(GapCurrent, 			0)
21429. 	SetVariable(GapActual, 				0)
21430. 	SetVariable(GapUsed, 				0)
21431. 	
21432. 	# Gap Adjustments
21433. 	SetVariable(GapRoundedLoc, 			0)
21434. 	# SetVariable(GapAdjustedLoc, 		0)
21435. 	SetVariable(GapAvailableLoc, 		0)
21436. 	SetVariable(GapCurrentLoc, 			0)
21437. 	SetVariable(GapActualLoc,			0)
21438. 	SetVariable(GapUsedLoc,				0)
21439. 	
21440. 	# Space usage
21441. 	SetVariable(ZoneFreePerRequested, 	0)
21442. 	SetVariable(ZoneFreePerUsed, 		0)
21443. 
21444. # Gap Size & Rounding
21445. 	SetVariable(ZoneGapSizePer, 		0)
21446. 	SetVariable(ZoneVolRoundUpPer, 		0)
21447. 	
21448. 	# Free Space
21449. 	SetVariable(ZoneFreeUsedPer, 		0)
21450. 	SetVariable(ZoneFreeRequestedPer, 	0)
21451. 
21452. 
21453. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
21454. 
21455. # Footer:
21456. SetVariable(ZoneFooter, "----------------------------------------------------------
21457. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
21458. 
21459. Statistics Report:
21460. ------------------
21461.    Size:  
21462.    ------------------------
21463.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
21464.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
21465.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
21466. 
21467.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
21468.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
21469. 
21470.    Location:
21471.    ------------------------
21472.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
21473.              Files End: !ZoneEndCurrent!
21474.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
21475.       
21476.    Gap Settings:
21477.    ------------------------
21478.          Gap Requested: !ZoneGapSizePer!%
21479.       Volume Rounding: !ZoneVolRoundUpPer!%
21480.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
21481.                  
21482.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
21483.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
21484.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
21485.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
21486.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
21487.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
21488.      
21489.    Free Space after Zone:
21490.    ------------------------
21491.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
21492.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
21493.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
21494. 
21495. Directory and Files Select:
21496. ---------------------------
21497. !ZoneTypeSelectCurrent!               
21498. ---------------------------
21499. ----------------------------------------------------------
21500. ")
21501. 
21502. # BANNER SET
21503. 
21504. # DATE TIME RUN ELP
21505. 
21506. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
21507. /* Xinclude "..\BannerSet.MyDc"X */
21508. /* pause(1) */
21509. 
21510. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21511. 
21512. Title('!Heading!')
21513. /* pause(1) */
21514. 
21515. /* NOTE: Can't round or truncate to integer precision. */
21516. 
21517. AppendLogfile("!LogFileName!", "!Title!")
21518. 
21519. 
21520. 
21521. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
21522. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
21523. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:18")
21524. 
21525. SetVariable(ZoneListByLine, "!ZoneListByLine!
21526. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
21527. 
21528. 
21529. /* Fixed Zone Position Handling */
21530. /* Literal number: */
21531. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
21532. /* Percentage of disk: */
21533. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
21534. /* Gap */
21535. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
21536. 
21537. /* ---------------------------------------------------------- */
21538. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
21539. # FILE STEP
21540. 
21541. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21542. 
21543. /* add message and move to a new line. */
21544. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21545. ")
21546. 
21547. /* display the line. (hopefully.) */
21548. # Zone Footer Set Statistics Window Text
21549. 
21550. SetStatisticsWindowText("----------------------------------------------------------
21551. Zones Processed: 
21552. ----------------------------------------------------------
21553. !ZoneListByLine!
21554. ----------------------------------------------------------
21555. Zone Processing Step:
21556. !ZoneStepByLine!    
21557. ----------------------------------------------------------
21558. Current Zone:
21559. !ZoneFooter!
21560. ----------------------------------------------------------
21561. Volume Statistics:
21562. !VolumeStatisticsDetail!
21563. ----------------------------------------------------------
21564. Zone Detailed Report:
21565. ----------------------------------------------------------
21566. !ZoneStatisticsDetail!
21567. ----------------------------------------------------------
21568. ")
21569. 
21570. 
21571. 
21572. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21573. 
21574. # BANNER SET
21575. 
21576. # DATE TIME RUN ELP
21577. 
21578. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
21579. /* Xinclude "..\BannerSet.MyDc"X */
21580. /* pause(1) */
21581. 
21582. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21583. 
21584. Title('!Heading!')
21585. /* pause(1) */
21586. 
21587. /* NOTE: Can't round or truncate to integer precision. */
21588. 
21589. pause(1)
21590. 
21591. # your stuff HERE (X)... pre file select code.
21592. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
21593. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
21594. 	# (X)
21595. 
21596. FileSelect
21597. 
21598. 	# your stuff can't really go here (errors.)
21599. 	# maybe for some reason I don't know of...
21600. 	
21601. 	# Actions next...
21602. 	# Shares start.
21603. # NotBlobsArchivesBu start.
21604. (not (
21605. # Blobs start.
21606. (
21607. # BlobsAndExceptions start.
21608. ( not(
21609.   FileName("*.bat")
21610.   or FileName("*.css")
21611.   or FileName("*.dll")
21612.   or FileName("*.exe")
21613.   or FileName("*.htm*")
21614.   or FileName("*.jar")
21615.   or FileName("*.js")
21616.   or FileName("*.script")
21617.   or FileName("*.wsf")
21618.   or (
21619. # Databases start.
21620. (
21621.   FileName("*.crypt*")
21622.   or FileName("*.db*")
21623.   or FileName("*.rdb*")
21624.   or FileName("*.dc*")
21625.   or FileName("*.dict*")
21626.   or FileName("*.?db*")
21627.   or FileName("*.?rdb*")
21628.   or FileName("*.md*")
21629.   or FileName("*.myd")
21630.   or FileName("*.ndf")
21631.   or FileName("*.ns?")
21632.   or FileName("*.pab")
21633.   or FileName("*.pst")
21634.   or FileName("*.sd?*")
21635.   or FileName("*.sq**")
21636.   or FileName("*.tmd")
21637.   or FileName("*.tps")
21638.   or FileName("*.tr*")
21639. )
21640. # Databases end.
21641. 
21642.     # BlobsAndExceptions
21643.     or 
21644. # Data start.
21645. (
21646.   DirectoryName("Data*")
21647.   or DirectoryName("Device*")
21648.   or DirectoryName("Export*")
21649.   or DirectoryName("Import*")
21650.   or DirectoryName("Log*")
21651.   or DirectoryName("*Log")
21652.   or DirectoryName("Maintenance*")
21653.   or DirectoryName("Rec*")
21654.   or DirectoryName("Sales*")
21655.   or DirectoryName("Search*")
21656.   or DirectoryName("User*")
21657. )
21658. # Data end.
21659. 
21660.     # BlobsAndExceptions
21661.   )
21662. ) )
21663. # BlobsAndExceptions end.
21664. 
21665. # Blobs
21666. ) and (
21667.   Size(BlobFileSize,0)
21668.   or (
21669.     FileName("*.arj")
21670.     or FileName("*.bup")
21671.     or FileName("*.bz2")
21672.     or FileName("*.chm")
21673.     or FileName("*.dvr-ms")
21674.     or FileName("*.gz")
21675.     or FileName("*.ifo")
21676.     or FileName("*.lzh")
21677.     or FileName("*.pdf")
21678.     or FileName("*.rpm")
21679.     or FileName("*.wmv")
21680.     or FileName("*.vob")
21681.     or FileName("*.z")
21682.   ) 
21683. )
21684. # Blobs end.
21685. 
21686. # NotBlobsArchivesBu
21687. or 
21688. # Archives start.
21689. (
21690.   DirectoryName("*Archive*")
21691.   or DirectoryName("*History*")
21692.   or DirectoryName("*Old")
21693.   or DirectoryName("* Old *")
21694.   or DirectoryName("Old *")
21695. 
21696.   or FileName("*.7z")
21697.   or FileName("*.cab")
21698.   or FileName("*.iso")
21699.   or FileName("*.msi")
21700.   or FileName("*.old")
21701.   or FileName("*.rar")
21702.   or FileName("*.tar")
21703.   or FileName("*.zip")
21704.   or
21705. # WinSysLow start.
21706. (
21707.   DirectoryName("$*")
21708.   or DirectoryName("0*")
21709.   or DirectoryName("1*")
21710.   or DirectoryName("2*")
21711.   or DirectoryName("3*")
21712.   or DirectoryName("4*")
21713.   or DirectoryName("5*")
21714.   or DirectoryName("6*")
21715.   or DirectoryName("7*")
21716.   or DirectoryName("8*")
21717.   or DirectoryName("9*")
21718. 
21719.   or DirectoryName("dllcache")
21720.   or DirectoryName("Downloaded Installations")
21721.   or DirectoryName("Ehome")
21722.   or DirectoryName("Fonts")
21723.   or DirectoryName("Help")
21724.   or DirectoryName("I386")
21725.   or DirectoryName("ie?updates")
21726.   or DirectoryName("Installer")
21727.   or DirectoryName("Installshield Installation Information")
21728.   or DirectoryName("IME")
21729.   or DirectoryName("*RECYCLE*")
21730.   or DirectoryName("ServicePackFiles")
21731.   or DirectoryName("SoftwareDistribution")
21732.   or DirectoryName("Speech")
21733.   or DirectoryName("Symbols")
21734.   or DirectoryName("System Volume Information")
21735.   or DirectoryName("windows.old")
21736. )
21737. # WinSysLow end.
21738. 
21739.   # Archives
21740. )
21741. # Archives end.
21742. 
21743. # NotBlobsArchivesBu
21744. or
21745. # Backups start.
21746. (
21747.   DirectoryName("*Backup*")
21748.   or DirectoryName("*Bu")
21749.   or DirectoryName("* Bu *")
21750.   or DirectoryName("Bu *")
21751. 
21752.   or FileName("*.bak")
21753.   or FileName("* - Copy*")
21754. )
21755. # Backups end.
21756. 
21757. # NotBlobsArchivesBu
21758. ) )
21759. # NotBlobsArchivesBu end.
21760. 
21761. # Shares
21762. and (
21763. # Share start.
21764. (
21765.   DirectoryName("*Common*")
21766.   or DirectoryName("Media*")
21767.   or DirectoryName("Multimedia*")
21768.   or DirectoryName("*Public*")
21769.   or DirectoryName("*Share*")
21770. )
21771. # Share end.
21772. 
21773. # Shares
21774. or 
21775. # Family start.
21776. (
21777.     DirectoryName("*Family*")
21778. )
21779. # Family end.
21780. 
21781. # Shares
21782. )
21783. # Shares end.
21784. 
21785. 	# Zone
21786. # File Select
21787. 	# File Booleans
21788. 	# Resume...
21789. # File Action - SortByName.
21790. 
21791. FileActions
21792. 
21793. 		/* ---------------------------------------------------------- */
21794. 	# Gap
21795. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
21796. 		# FILE STEP
21797. 
21798. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
21799. 
21800. /* add message and move to a new line. */
21801. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
21802. ")
21803. 
21804. /* display the line. (hopefully.) */
21805. # Zone Footer Set Statistics Window Text
21806. 
21807. SetStatisticsWindowText("----------------------------------------------------------
21808. Zones Processed: 
21809. ----------------------------------------------------------
21810. !ZoneListByLine!
21811. ----------------------------------------------------------
21812. Zone Processing Step:
21813. !ZoneStepByLine!    
21814. ----------------------------------------------------------
21815. Current Zone:
21816. !ZoneFooter!
21817. ----------------------------------------------------------
21818. Volume Statistics:
21819. !VolumeStatisticsDetail!
21820. ----------------------------------------------------------
21821. Zone Detailed Report:
21822. ----------------------------------------------------------
21823. !ZoneStatisticsDetail!
21824. ----------------------------------------------------------
21825. ")
21826. 
21827. 
21828. 
21829. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
21830. 
21831. # BANNER SET
21832. 
21833. # DATE TIME RUN ELP
21834. 
21835. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
21836. /* Xinclude "..\BannerSet.MyDc"X */
21837. /* pause(1) */
21838. 
21839. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
21840. 
21841. Title('!Heading!')
21842. /* pause(1) */
21843. 
21844. /* NOTE: Can't round or truncate to integer precision. */
21845. 
21846. pause(1)
21847. 	
21848. 	# ACTUAL GAP
21849. 		/* AddGap Variant. */
21850. 	  	# Zone Do Gap
21851. # Gap Calculation Methods:
21852. 
21853. /* 1) Anything you need to add first. */
21854. /* empty */
21855. 
21856. /* ---------------------------------------------------------- */
21857. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
21858. 	# GapRequestedStd.
21859. 
21860. 		/* ---------------------------------------------------------- */
21861. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
21862. 
21863. 		# Gap Calculation Methods:
21864. 
21865. /* AddGap Variants */
21866. 
21867. 	/* Standard */
21868. 		# Gap Calculation Methods:
21869. 	/* AddGap Variants */
21870. 	/* Standard */
21871. 
21872. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
21873. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
21874. 
21875. 	SetVariable(GapRequested, GapRequestedStd)
21876. 	
21877. 
21878. 	/* MFT Low High Method */
21879. 		# Gap Calculation Methods:
21880. 	/* AddGap Variants */
21881. 	/* MFT Low High Method */
21882. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
21883. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
21884. 	SetVariable(GapRequested, GapRequestedMft)
21885. 	
21886. 
21887. 	/* OS Volume Type Method */
21888. 		# Gap Calculation Methods:
21889. 	/* AddGap Variants */
21890. 	/* OS Volume Type Method */
21891. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
21892. 	SetVariable(GapRequested, GapRequestedOs)
21893. 
21894. 
21895. 
21896. /* MakeGap Variants */
21897. 
21898. 	/* Original Os 1-3 + MFT 2 */
21899. 		# Gap Calculation Methods:
21900. 	/* MakeGap Variants */
21901. 	/* Original Os 1-3 + MFT 2 */
21902. 	/* plus MFT gap placed inline at the dividing zone. */
21903. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
21904. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
21905. 	SetVariable(GapRequested, GapRequestedOrig)
21906. 	
21907. 	
21908. /* Note: You could comment out the ones not in use */
21909. /* However having the data in the log is useful. */
21910. /* Therefore the following line is otherwise needed. */
21911. 
21912. /* Standard used */
21913. 
21914. SetVariable(GapRequested, GapRequestedStd)
21915. 
21916. # Gap Calculation Methods:
21917. 
21918. /* AddGap Variants */
21919. 	/* Standard */
21920. 	/* MFT Low High Method */
21921. 	/* OS Volume Type Method */
21922. 
21923. /* MakeGap Variants */
21924. 	/* Original Os 1-3 + MFT 2 */
21925. 
21926. /* Note: You could comment out the ones not in use */
21927. /* However having the data in the log is useful. */
21928. /* Therefore the following line is otherwise needed. */
21929. 
21930. /* Standard is used currently */
21931. 
21932. 
21933. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
21934. 
21935. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
21936. 
21937. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
21938. 
21939. /* ---------------------------------------------------------- */
21940. /* 3) SMALL ZONE ADJUSTMENT. */
21941. /* Gab cant be larger than half the Zone Size. */
21942. 
21943. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
21944. 	
21945. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
21946. 
21947. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
21948. 
21949. /* ---------------------------------------------------------- */
21950. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
21951. # Gap Adjustments.
21952. 
21953. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
21954. 	
21955. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
21956. 
21957. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
21958. 
21959. /* ---------------------------------------------------------- */
21960. # BYPASS THIS.
21961. 	/* This is definitely wrong. */
21962. 	/* The question is can we steal gap from the next zone */
21963. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
21964. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
21965. 		# Zone Overflow.
21966. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
21967. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
21968. 
21969. /* ---------------------------------------------------------- */
21970. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
21971. # Remaining free space available.
21972. 
21973. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
21974. 	
21975. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
21976. 
21977. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
21978. 
21979. /* ---------------------------------------------------------- */
21980. # CURRENT gap to use.
21981. 
21982. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
21983. 
21984. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
21985. 
21986. /* ---------------------------------------------------------- */
21987. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
21988. # Debugging.
21989. 
21990. 	SetVariable(GapUsed, GapCurrent) // for debugging
21991. 
21992. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
21993. 
21994. 		# Your code HERE
21995. 
21996. /* ---------------------------------------------------------- */
21997. /* 7) YOUR CODE. */
21998. # YOUR CODE HERE:
21999. 	# INPUT: GapCurrent or GapCurrentLoc
22000. 	# OUTPUT: GapUsed...
22001. 
22002. /* ---------------------------------------------------------- */
22003. # Gap Size.
22004. # Actual Size of Gap.
22005. 
22006. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
22007. 
22008. /* ---------------------------------------------------------- */
22009. /* xxxxxxxxxxxxxxxxxxxxxx */
22010. # ADD THE GAP
22011. 	/* Xinclude "..\GapCommandDo.MyDc"X */
22012. /* xxxxxxxxxxxxxxxxxxxxxx */
22013. 
22014. 	
22015. 	# Zone Statistics	
22016. 	# Zone / Volume Statistics and Display
22017. 		
22018. 	# Accumulate Totals
22019.   	# Volume totals
22020. 
22021. /* Current total space used (by Zones and Gaps) */
22022. 
22023. SetVariable(VolumeZoneUsed, GapUsed)
22024. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
22025. /* Percentage */
22026. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
22027. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
22028. 
22029. /* Current total of free space requested */
22030. 
22031. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
22032. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
22033. /* Percent. */
22034. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
22035. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
22036. 
22037. /* Current total of free space used */
22038. 
22039. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
22040. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
22041. /* Percent */
22042. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
22043. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
22044. 
22045. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
22046. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
22047. /* Xinclude "..\DebugDisplayPause.MyDc"X */
22048. 
22049. 
22050. 	# Current Values
22051. 	# Cluster, Sector, Block adjust for display.
22052. 	# Bytes per cluster is volume specific.
22053. 
22054. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
22055. 
22056. # Current Zone values.
22057. 	# Begin, end and size.
22058. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
22059. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
22060. 
22061. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
22062. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
22063. 
22064. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
22065. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
22066. 
22067. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
22068. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
22069. 
22070. 	SetVariable(ZoneFragments,				"!ZONE210N!")
22071. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
22072. 		
22073. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
22074. /* identical code to here: (separation not needed. TEST.) */	
22075. 
22076. # Current Gap, Actual and Free Values
22077. 	# Gap
22078. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
22079. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
22080. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
22081. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
22082. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
22083. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
22084. 	
22085. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
22086. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
22087. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
22088. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
22089. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
22090. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
22091. 	
22092. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
22093. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
22094. 	
22095. 	# Actual Size and End
22096. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
22097. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
22098. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
22099. 	
22100. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
22101. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
22102. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
22103. 
22104. # Gap Size & Rounding
22105. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
22106. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
22107. 	
22108. 	# Free Space
22109. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
22110. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
22111. 
22112. 	# Footer:
22113. SetVariable(ZoneFooter, "----------------------------------------------------------
22114. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
22115. 
22116. Statistics Report:
22117. ------------------
22118.    Size:  
22119.    ------------------------
22120.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22121.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22122.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22123. 
22124.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22125.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22126. 
22127.    Location:
22128.    ------------------------
22129.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22130.              Files End: !ZoneEndCurrent!
22131.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22132.       
22133.    Gap Settings:
22134.    ------------------------
22135.          Gap Requested: !ZoneGapSizePer!%
22136.       Volume Rounding: !ZoneVolRoundUpPer!%
22137.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22138.                  
22139.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22140.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22141.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22142.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22143.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22144.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22145.      
22146.    Free Space after Zone:
22147.    ------------------------
22148.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22149.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22150.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22151. 
22152. Directory and Files Select:
22153. ---------------------------
22154. !ZoneTypeSelectCurrent!               
22155. ---------------------------
22156. ----------------------------------------------------------
22157. ")
22158. 	# Zone Footer Set Statistics Window Text
22159. 
22160. SetStatisticsWindowText("----------------------------------------------------------
22161. Zones Processed: 
22162. ----------------------------------------------------------
22163. !ZoneListByLine!
22164. ----------------------------------------------------------
22165. Zone Processing Step:
22166. !ZoneStepByLine!    
22167. ----------------------------------------------------------
22168. Current Zone:
22169. !ZoneFooter!
22170. ----------------------------------------------------------
22171. Volume Statistics:
22172. !VolumeStatisticsDetail!
22173. ----------------------------------------------------------
22174. Zone Detailed Report:
22175. ----------------------------------------------------------
22176. !ZoneStatisticsDetail!
22177. ----------------------------------------------------------
22178. ")
22179. 
22180. 
22181. 	
22182.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
22183. 
22184. 	# Add Zone to list of zones for display.
22185. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
22186. 
22187. 	# Footer:
22188. SetVariable(ZoneFooter, "----------------------------------------------------------
22189. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
22190. 
22191. Statistics Report:
22192. ------------------
22193.    Size:  
22194.    ------------------------
22195.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22196.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22197.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22198. 
22199.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22200.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22201. 
22202.    Location:
22203.    ------------------------
22204.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22205.              Files End: !ZoneEndCurrent!
22206.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22207.       
22208.    Gap Settings:
22209.    ------------------------
22210.          Gap Requested: !ZoneGapSizePer!%
22211.       Volume Rounding: !ZoneVolRoundUpPer!%
22212.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22213.                  
22214.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22215.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22216.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22217.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22218.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22219.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22220.      
22221.    Free Space after Zone:
22222.    ------------------------
22223.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22224.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22225.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22226. 
22227. Directory and Files Select:
22228. ---------------------------
22229. !ZoneTypeSelectCurrent!               
22230. ---------------------------
22231. ----------------------------------------------------------
22232. ")
22233. 
22234. 	# Add Zone Details to Report.	
22235. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
22236. !ZoneFooter!")
22237. 
22238. 
22239. 
22240. 	# DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
22241. 		/* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
22242. 		/* Xinclude "..\DebugDisplayPause.MyDc"X */
22243. 
22244.   	# Zone Statistics	
22245.   	/* Xinclude "..\ZoneDoStatistics.MyDc"X */
22246. 
22247. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
22248. 	# FILE STEP
22249. 
22250. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22251. 
22252. /* add message and move to a new line. */
22253. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22254. ")
22255. 
22256. /* display the line. (hopefully.) */
22257. # Zone Footer Set Statistics Window Text
22258. 
22259. SetStatisticsWindowText("----------------------------------------------------------
22260. Zones Processed: 
22261. ----------------------------------------------------------
22262. !ZoneListByLine!
22263. ----------------------------------------------------------
22264. Zone Processing Step:
22265. !ZoneStepByLine!    
22266. ----------------------------------------------------------
22267. Current Zone:
22268. !ZoneFooter!
22269. ----------------------------------------------------------
22270. Volume Statistics:
22271. !VolumeStatisticsDetail!
22272. ----------------------------------------------------------
22273. Zone Detailed Report:
22274. ----------------------------------------------------------
22275. !ZoneStatisticsDetail!
22276. ----------------------------------------------------------
22277. ")
22278. 
22279. 
22280. 
22281. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22282. 
22283. # BANNER SET
22284. 
22285. # DATE TIME RUN ELP
22286. 
22287. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
22288. /* Xinclude "..\BannerSet.MyDc"X */
22289. /* pause(1) */
22290. 
22291. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22292. 
22293. Title('!Heading!')
22294. /* pause(1) */
22295. 
22296. /* NOTE: Can't round or truncate to integer precision. */
22297. 
22298. pause(1)
22299. 
22300. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
22301. 	
22302. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
22303. 	# FILE STEP
22304. 
22305. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22306. 
22307. /* add message and move to a new line. */
22308. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22309. ")
22310. 
22311. /* display the line. (hopefully.) */
22312. # Zone Footer Set Statistics Window Text
22313. 
22314. SetStatisticsWindowText("----------------------------------------------------------
22315. Zones Processed: 
22316. ----------------------------------------------------------
22317. !ZoneListByLine!
22318. ----------------------------------------------------------
22319. Zone Processing Step:
22320. !ZoneStepByLine!    
22321. ----------------------------------------------------------
22322. Current Zone:
22323. !ZoneFooter!
22324. ----------------------------------------------------------
22325. Volume Statistics:
22326. !VolumeStatisticsDetail!
22327. ----------------------------------------------------------
22328. Zone Detailed Report:
22329. ----------------------------------------------------------
22330. !ZoneStatisticsDetail!
22331. ----------------------------------------------------------
22332. ")
22333. 
22334. 
22335. 
22336. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22337. 
22338. # BANNER SET
22339. 
22340. # DATE TIME RUN ELP
22341. 
22342. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
22343. /* Xinclude "..\BannerSet.MyDc"X */
22344. /* pause(1) */
22345. 
22346. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22347. 
22348. Title('!Heading!')
22349. /* pause(1) */
22350. 
22351. /* NOTE: Can't round or truncate to integer precision. */
22352. 
22353. pause(1)
22354. 
22355. 	# Footer next...
22356. 	
22357. 	# Zone Do Footer
22358. 
22359. /* ---------------------------------------------------------- */
22360. # File Select
22361. 	# Select Statments
22362. # File Actions 
22363. 	# Standard or OS File Actions.
22364. 	# Resume...
22365. 	
22366. 	# your stuff HERE (X)... post zone (file) file actions code.
22367. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
22368. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
22369. 		# (X)
22370. 		
22371. 		/* ??? Set window? */
22372. 	
22373. 	# ADD THE GAP
22374. 		
22375. # Vacate (good for diagnostics)
22376. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
22377. 
22378. # DoNotVacate - DO NOT Vacate (recommended)
22379. 
22380. # Vacate
22381. /* AddGap(GapUsedLoc) */
22382. 
22383. # DO Not Vacate
22384. AddGap(GapUsedLoc, DoNotVacate) 
22385. 	
22386. 	
22387. /* ---------------------------------------------------------- */
22388. # (failed) TEST for boolean logic.
22389. 
22390. /* It should work in the gap calculations for turning options */
22391. /* on and off but it will NOT work here. */
22392. 
22393. /* Boolean setting X or FlagX. */
22394. /* Where X will be on or off: */
22395. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
22396. /*      For ON:  (X  *  FlagAny) */
22397. 
22398. /* 1) Failed, zero gap overrode the previous one. */
22399. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
22400. /* AddGap(GapUsedTemp) */ 
22401. 
22402. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
22403. /* AddGap(GapUsedTemp, DoNotVacate) */ 
22404. 
22405. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
22406. 
22407. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
22408. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
22409. /* AddGap(GapUsedTemp) */ 
22410. 
22411. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
22412. /* AddGap(GapUsedTemp, DoNotVacate) */ 
22413. 
22414. /* ---------------------------------------------------------- */
22415. 
22416. # Vacate
22417. /* AddGap(GapUsed) */
22418. 
22419. # DO NOT Vacate (recommended)
22420. /* AddGap(GapUsed, DoNotVacate) */ 
22421. 	
22422. 
22423. 		
22424. # 
22425. FileEnd
22426. /* ---------------------------------------------------------- */
22427. 
22428. # your stuff HERE (X)... post zone (file) code.
22429. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
22430. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
22431. 	# (X)
22432. 
22433. SetVariable(FileStepDescription,"Zone finished, reporting.")
22434. # FILE STEP
22435. 
22436. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
22437. 
22438. /* add message and move to a new line. */
22439. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
22440. ")
22441. 
22442. /* display the line. (hopefully.) */
22443. # Zone Footer Set Statistics Window Text
22444. 
22445. SetStatisticsWindowText("----------------------------------------------------------
22446. Zones Processed: 
22447. ----------------------------------------------------------
22448. !ZoneListByLine!
22449. ----------------------------------------------------------
22450. Zone Processing Step:
22451. !ZoneStepByLine!    
22452. ----------------------------------------------------------
22453. Current Zone:
22454. !ZoneFooter!
22455. ----------------------------------------------------------
22456. Volume Statistics:
22457. !VolumeStatisticsDetail!
22458. ----------------------------------------------------------
22459. Zone Detailed Report:
22460. ----------------------------------------------------------
22461. !ZoneStatisticsDetail!
22462. ----------------------------------------------------------
22463. ")
22464. 
22465. 
22466. 
22467. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
22468. 
22469. # BANNER SET
22470. 
22471. # DATE TIME RUN ELP
22472. 
22473. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
22474. /* Xinclude "..\BannerSet.MyDc"X */
22475. /* pause(1) */
22476. 
22477. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22478. 
22479. Title('!Heading!')
22480. /* pause(1) */
22481. 
22482. /* NOTE: Can't round or truncate to integer precision. */
22483. 
22484. pause(1)
22485. 
22486. # Zone When Finished
22487. 
22488. # BANNER SET
22489. 
22490. # DATE TIME RUN ELP
22491. 
22492. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
22493. /* Xinclude "..\BannerSet.MyDc"X */
22494. /* pause(1) */
22495. 
22496. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22497. 
22498. Title('!Heading!')
22499. /* pause(1) */
22500. 
22501. /* NOTE: Can't round or truncate to integer precision. */
22502. 
22503. AppendLogfile("!LogFileName!", "!Title!")
22504. 
22505. 
22506. 
22507. # Zone Statistics	
22508. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
22509. 
22510. # Footer:
22511. SetVariable(ZoneFooter, "----------------------------------------------------------
22512. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
22513. 
22514. Statistics Report:
22515. ------------------
22516.    Size:  
22517.    ------------------------
22518.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22519.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22520.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22521. 
22522.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22523.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22524. 
22525.    Location:
22526.    ------------------------
22527.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22528.              Files End: !ZoneEndCurrent!
22529.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22530.       
22531.    Gap Settings:
22532.    ------------------------
22533.          Gap Requested: !ZoneGapSizePer!%
22534.       Volume Rounding: !ZoneVolRoundUpPer!%
22535.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22536.                  
22537.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22538.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22539.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22540.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22541.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22542.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22543.      
22544.    Free Space after Zone:
22545.    ------------------------
22546.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22547.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22548.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22549. 
22550. Directory and Files Select:
22551. ---------------------------
22552. !ZoneTypeSelectCurrent!               
22553. ---------------------------
22554. ----------------------------------------------------------
22555. ")
22556. 
22557. AppendLogfile("!LogFileName!", ".")
22558. AppendLogfile("!LogFileName!", "!ZoneFooter!")
22559. AppendLogfile("!LogFileName!", ".")
22560. 
22561. # Zone Footer Set Statistics Window Text
22562. 
22563. SetStatisticsWindowText("----------------------------------------------------------
22564. Zones Processed: 
22565. ----------------------------------------------------------
22566. !ZoneListByLine!
22567. ----------------------------------------------------------
22568. Zone Processing Step:
22569. !ZoneStepByLine!    
22570. ----------------------------------------------------------
22571. Current Zone:
22572. !ZoneFooter!
22573. ----------------------------------------------------------
22574. Volume Statistics:
22575. !VolumeStatisticsDetail!
22576. ----------------------------------------------------------
22577. Zone Detailed Report:
22578. ----------------------------------------------------------
22579. !ZoneStatisticsDetail!
22580. ----------------------------------------------------------
22581. ")
22582. 
22583. 
22584. 
22585. /* pause() */
22586. /* pause() */
22587. 
22588. 
22589. 
22590. 
22591. /* ---------------------------------------------------------- */
22592. 
22593. 
22594. /* ---------------------------------------------------------- */
22595. /* Zone SystemOtherData System Other and Data */
22596. /* ---------------------------------------------------------- */
22597. /* Zone SystemOtherData System Other and Data */
22598. SetVariable(ZoneLabel, "!ZoneLabelSystemOtherData!")
22599. SetVariable(ZoneDescription, "!ZoneDescriptionSystemOtherData!")
22600. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSystemOtherData!")
22601. SetVariable(ZoneGapSize, "!ZoneGapSizeSystemOtherData!")
22602. SetVariable(ZoneTypeSelect,'# SystemOtherData start.
22603. # NotBlobsArchivesBu start.
22604. (not (
22605. # Blobs start.
22606. (
22607. # BlobsAndExceptions start.
22608. ( not(
22609.   FileName("*.bat")
22610.   or FileName("*.css")
22611.   or FileName("*.dll")
22612.   or FileName("*.exe")
22613.   or FileName("*.htm*")
22614.   or FileName("*.jar")
22615.   or FileName("*.js")
22616.   or FileName("*.script")
22617.   or FileName("*.wsf")
22618.   or (
22619. # Databases start.
22620. (
22621.   FileName("*.crypt*")
22622.   or FileName("*.db*")
22623.   or FileName("*.rdb*")
22624.   or FileName("*.dc*")
22625.   or FileName("*.dict*")
22626.   or FileName("*.?db*")
22627.   or FileName("*.?rdb*")
22628.   or FileName("*.md*")
22629.   or FileName("*.myd")
22630.   or FileName("*.ndf")
22631.   or FileName("*.ns?")
22632.   or FileName("*.pab")
22633.   or FileName("*.pst")
22634.   or FileName("*.sd?*")
22635.   or FileName("*.sq**")
22636.   or FileName("*.tmd")
22637.   or FileName("*.tps")
22638.   or FileName("*.tr*")
22639. )
22640. # Databases end.
22641. 
22642.     # BlobsAndExceptions
22643.     or 
22644. # Data start.
22645. (
22646.   DirectoryName("Data*")
22647.   or DirectoryName("Device*")
22648.   or DirectoryName("Export*")
22649.   or DirectoryName("Import*")
22650.   or DirectoryName("Log*")
22651.   or DirectoryName("*Log")
22652.   or DirectoryName("Maintenance*")
22653.   or DirectoryName("Rec*")
22654.   or DirectoryName("Sales*")
22655.   or DirectoryName("Search*")
22656.   or DirectoryName("User*")
22657. )
22658. # Data end.
22659. 
22660.     # BlobsAndExceptions
22661.   )
22662. ) )
22663. # BlobsAndExceptions end.
22664. 
22665. # Blobs
22666. ) and (
22667.   Size(BlobFileSize,0)
22668.   or (
22669.     FileName("*.arj")
22670.     or FileName("*.bup")
22671.     or FileName("*.bz2")
22672.     or FileName("*.chm")
22673.     or FileName("*.dvr-ms")
22674.     or FileName("*.gz")
22675.     or FileName("*.ifo")
22676.     or FileName("*.lzh")
22677.     or FileName("*.pdf")
22678.     or FileName("*.rpm")
22679.     or FileName("*.wmv")
22680.     or FileName("*.vob")
22681.     or FileName("*.z")
22682.   ) 
22683. )
22684. # Blobs end.
22685. 
22686. # NotBlobsArchivesBu
22687. or 
22688. # Archives start.
22689. (
22690.   DirectoryName("*Archive*")
22691.   or DirectoryName("*History*")
22692.   or DirectoryName("*Old")
22693.   or DirectoryName("* Old *")
22694.   or DirectoryName("Old *")
22695. 
22696.   or FileName("*.7z")
22697.   or FileName("*.cab")
22698.   or FileName("*.iso")
22699.   or FileName("*.msi")
22700.   or FileName("*.old")
22701.   or FileName("*.rar")
22702.   or FileName("*.tar")
22703.   or FileName("*.zip")
22704.   or
22705. # WinSysLow start.
22706. (
22707.   DirectoryName("$*")
22708.   or DirectoryName("0*")
22709.   or DirectoryName("1*")
22710.   or DirectoryName("2*")
22711.   or DirectoryName("3*")
22712.   or DirectoryName("4*")
22713.   or DirectoryName("5*")
22714.   or DirectoryName("6*")
22715.   or DirectoryName("7*")
22716.   or DirectoryName("8*")
22717.   or DirectoryName("9*")
22718. 
22719.   or DirectoryName("dllcache")
22720.   or DirectoryName("Downloaded Installations")
22721.   or DirectoryName("Ehome")
22722.   or DirectoryName("Fonts")
22723.   or DirectoryName("Help")
22724.   or DirectoryName("I386")
22725.   or DirectoryName("ie?updates")
22726.   or DirectoryName("Installer")
22727.   or DirectoryName("Installshield Installation Information")
22728.   or DirectoryName("IME")
22729.   or DirectoryName("*RECYCLE*")
22730.   or DirectoryName("ServicePackFiles")
22731.   or DirectoryName("SoftwareDistribution")
22732.   or DirectoryName("Speech")
22733.   or DirectoryName("Symbols")
22734.   or DirectoryName("System Volume Information")
22735.   or DirectoryName("windows.old")
22736. )
22737. # WinSysLow end.
22738. 
22739.   # Archives
22740. )
22741. # Archives end.
22742. 
22743. # NotBlobsArchivesBu
22744. or
22745. # Backups start.
22746. (
22747.   DirectoryName("*Backup*")
22748.   or DirectoryName("*Bu")
22749.   or DirectoryName("* Bu *")
22750.   or DirectoryName("Bu *")
22751. 
22752.   or FileName("*.bak")
22753.   or FileName("* - Copy*")
22754. )
22755. # Backups end.
22756. 
22757. # NotBlobsArchivesBu
22758. ) )
22759. # NotBlobsArchivesBu end.
22760. 
22761. # SystemOtherData
22762. and ( 
22763. # Data start.
22764. (
22765.   DirectoryName("Data*")
22766.   or DirectoryName("Device*")
22767.   or DirectoryName("Export*")
22768.   or DirectoryName("Import*")
22769.   or DirectoryName("Log*")
22770.   or DirectoryName("*Log")
22771.   or DirectoryName("Maintenance*")
22772.   or DirectoryName("Rec*")
22773.   or DirectoryName("Sales*")
22774.   or DirectoryName("Search*")
22775.   or DirectoryName("User*")
22776. )
22777. # Data end.
22778.  
22779. # SystemOtherData
22780. or  
22781. # Databases start.
22782. (
22783.   FileName("*.crypt*")
22784.   or FileName("*.db*")
22785.   or FileName("*.rdb*")
22786.   or FileName("*.dc*")
22787.   or FileName("*.dict*")
22788.   or FileName("*.?db*")
22789.   or FileName("*.?rdb*")
22790.   or FileName("*.md*")
22791.   or FileName("*.myd")
22792.   or FileName("*.ndf")
22793.   or FileName("*.ns?")
22794.   or FileName("*.pab")
22795.   or FileName("*.pst")
22796.   or FileName("*.sd?*")
22797.   or FileName("*.sq**")
22798.   or FileName("*.tmd")
22799.   or FileName("*.tps")
22800.   or FileName("*.tr*")
22801. )
22802. # Databases end.
22803. 
22804. # SystemOtherData
22805. )
22806. # SystemOtherData end.
22807. ')
22808. 
22809. 	# Zone Do Header
22810. 
22811. # Zone When Started
22812. 
22813. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
22814. # Display Set Zone
22815. 
22816. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
22817. SetVariable(FileStepDescription,	"")
22818. 
22819. SetVariable(ZoneStepByLine, 			"Zone started.
22820. ")
22821. 
22822. # BANNER SET
22823. 
22824. # DATE TIME RUN ELP
22825. 
22826. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
22827. /* Xinclude "..\BannerSet.MyDc"X */
22828. /* pause(1) */
22829. 
22830. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22831. 
22832. Title('!Heading!')
22833. /* pause(1) */
22834. 
22835. /* NOTE: Can't round or truncate to integer precision. */
22836. 
22837. AppendLogfile("!LogFileName!", "!Title!")
22838. 
22839. 
22840. 
22841. pause(1)
22842. 
22843. 
22844. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
22845. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
22846. 
22847. SetVariable(ZoneStepNoCurrent, 0)
22848. 
22849. 
22850. # Zone Do Current Clear
22851. 
22852. SetVariable(ZoneTypeSelectCurrent, 		"")
22853. 
22854. SetVariable(ZoneBeginCurrent, 			0)
22855. SetVariable(ZoneBeginPerCurrent, 		0)
22856. SetVariable(ZoneEndCurrent, 			0)
22857. SetVariable(ZoneEndPerCurrent, 			0)
22858. 
22859. SetVariable(ZoneSizeCurrent,			0)
22860. SetVariable(ZoneSizePerCurrent,			0)
22861. 
22862. SetVariable(ZoneGapRequestedCurrent,	0)
22863. SetVariable(ZoneGapRoundedCurrent, 		0)
22864. SetVariable(ZoneGapAdjustedCurrent, 	0)
22865. SetVariable(ZoneGapAvailableCurrent, 	0)
22866. SetVariable(ZoneGapCurrent,				0)
22867. SetVariable(ZoneGapUsedCurrent, 		0)
22868. 
22869. SetVariable(ZoneGapActualCurrent, 		0)
22870. SetVariable(ZoneGapActualPerCurrent, 	0)
22871. 
22872. SetVariable(ZoneSizeActual, 			0)
22873. SetVariable(ZoneSizeActualCurrent,		0)
22874. 
22875. SetVariable(ZoneEndActual, 				0)
22876. SetVariable(ZoneEndActualCurrent,		0)			
22877. SetVariable(ZoneSizeActualPerCurrent, 	0)
22878.       
22879. SetVariable(ZoneFilesFolders,			0)
22880. SetVariable(ZoneFilesFoldersPer,		0) 
22881. 
22882. SetVariable(ZoneFragments,				0)
22883. SetVariable(ZoneFragmentsPer,			0) 
22884. 		
22885. SetVariable(ZoneEndActualCurrent, 		0)
22886. SetVariable(ZoneEndActualPerCurrent, 	0)
22887. 
22888. # Gap Calculation Methodology:
22889. 	# Requested
22890. 	SetVariable(GapRequested, 			0) 
22891. 	SetVariable(GapRequestedStd, 		0) 
22892. 	SetVariable(GapRequestedMft, 		0) 
22893. 	SetVariable(GapRequestedOs, 		0) 
22894. 	SetVariable(GapRequestedOriginal, 	0) 
22895. 	
22896. 	# Gap Adjustments
22897. 	SetVariable(GapRounded, 			0)
22898. 	# SetVariable(GapAdjusted, 			0)
22899. 	SetVariable(GapAvailable, 			0)
22900. 	SetVariable(GapCurrent, 			0)
22901. 	SetVariable(GapActual, 				0)
22902. 	SetVariable(GapUsed, 				0)
22903. 	
22904. 	# Gap Adjustments
22905. 	SetVariable(GapRoundedLoc, 			0)
22906. 	# SetVariable(GapAdjustedLoc, 		0)
22907. 	SetVariable(GapAvailableLoc, 		0)
22908. 	SetVariable(GapCurrentLoc, 			0)
22909. 	SetVariable(GapActualLoc,			0)
22910. 	SetVariable(GapUsedLoc,				0)
22911. 	
22912. 	# Space usage
22913. 	SetVariable(ZoneFreePerRequested, 	0)
22914. 	SetVariable(ZoneFreePerUsed, 		0)
22915. 
22916. # Gap Size & Rounding
22917. 	SetVariable(ZoneGapSizePer, 		0)
22918. 	SetVariable(ZoneVolRoundUpPer, 		0)
22919. 	
22920. 	# Free Space
22921. 	SetVariable(ZoneFreeUsedPer, 		0)
22922. 	SetVariable(ZoneFreeRequestedPer, 	0)
22923. 
22924. 
22925. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
22926. 
22927. # Footer:
22928. SetVariable(ZoneFooter, "----------------------------------------------------------
22929. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
22930. 
22931. Statistics Report:
22932. ------------------
22933.    Size:  
22934.    ------------------------
22935.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
22936.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
22937.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
22938. 
22939.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
22940.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
22941. 
22942.    Location:
22943.    ------------------------
22944.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
22945.              Files End: !ZoneEndCurrent!
22946.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
22947.       
22948.    Gap Settings:
22949.    ------------------------
22950.          Gap Requested: !ZoneGapSizePer!%
22951.       Volume Rounding: !ZoneVolRoundUpPer!%
22952.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
22953.                  
22954.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
22955.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
22956.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
22957.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
22958.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
22959.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
22960.      
22961.    Free Space after Zone:
22962.    ------------------------
22963.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
22964.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
22965.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
22966. 
22967. Directory and Files Select:
22968. ---------------------------
22969. !ZoneTypeSelectCurrent!               
22970. ---------------------------
22971. ----------------------------------------------------------
22972. ")
22973. 
22974. # BANNER SET
22975. 
22976. # DATE TIME RUN ELP
22977. 
22978. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
22979. /* Xinclude "..\BannerSet.MyDc"X */
22980. /* pause(1) */
22981. 
22982. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
22983. 
22984. Title('!Heading!')
22985. /* pause(1) */
22986. 
22987. /* NOTE: Can't round or truncate to integer precision. */
22988. 
22989. AppendLogfile("!LogFileName!", "!Title!")
22990. 
22991. 
22992. 
22993. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
22994. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
22995. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:18")
22996. 
22997. SetVariable(ZoneListByLine, "!ZoneListByLine!
22998. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
22999. 
23000. 
23001. /* Fixed Zone Position Handling */
23002. /* Literal number: */
23003. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
23004. /* Percentage of disk: */
23005. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
23006. /* Gap */
23007. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
23008. 
23009. /* ---------------------------------------------------------- */
23010. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
23011. # FILE STEP
23012. 
23013. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23014. 
23015. /* add message and move to a new line. */
23016. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23017. ")
23018. 
23019. /* display the line. (hopefully.) */
23020. # Zone Footer Set Statistics Window Text
23021. 
23022. SetStatisticsWindowText("----------------------------------------------------------
23023. Zones Processed: 
23024. ----------------------------------------------------------
23025. !ZoneListByLine!
23026. ----------------------------------------------------------
23027. Zone Processing Step:
23028. !ZoneStepByLine!    
23029. ----------------------------------------------------------
23030. Current Zone:
23031. !ZoneFooter!
23032. ----------------------------------------------------------
23033. Volume Statistics:
23034. !VolumeStatisticsDetail!
23035. ----------------------------------------------------------
23036. Zone Detailed Report:
23037. ----------------------------------------------------------
23038. !ZoneStatisticsDetail!
23039. ----------------------------------------------------------
23040. ")
23041. 
23042. 
23043. 
23044. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23045. 
23046. # BANNER SET
23047. 
23048. # DATE TIME RUN ELP
23049. 
23050. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
23051. /* Xinclude "..\BannerSet.MyDc"X */
23052. /* pause(1) */
23053. 
23054. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23055. 
23056. Title('!Heading!')
23057. /* pause(1) */
23058. 
23059. /* NOTE: Can't round or truncate to integer precision. */
23060. 
23061. pause(1)
23062. 
23063. # your stuff HERE (X)... pre file select code.
23064. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
23065. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
23066. 	# (X)
23067. 
23068. FileSelect
23069. 
23070. 	# your stuff can't really go here (errors.)
23071. 	# maybe for some reason I don't know of...
23072. 	
23073. 	# Actions next...
23074. 	# SystemOtherData start.
23075. # NotBlobsArchivesBu start.
23076. (not (
23077. # Blobs start.
23078. (
23079. # BlobsAndExceptions start.
23080. ( not(
23081.   FileName("*.bat")
23082.   or FileName("*.css")
23083.   or FileName("*.dll")
23084.   or FileName("*.exe")
23085.   or FileName("*.htm*")
23086.   or FileName("*.jar")
23087.   or FileName("*.js")
23088.   or FileName("*.script")
23089.   or FileName("*.wsf")
23090.   or (
23091. # Databases start.
23092. (
23093.   FileName("*.crypt*")
23094.   or FileName("*.db*")
23095.   or FileName("*.rdb*")
23096.   or FileName("*.dc*")
23097.   or FileName("*.dict*")
23098.   or FileName("*.?db*")
23099.   or FileName("*.?rdb*")
23100.   or FileName("*.md*")
23101.   or FileName("*.myd")
23102.   or FileName("*.ndf")
23103.   or FileName("*.ns?")
23104.   or FileName("*.pab")
23105.   or FileName("*.pst")
23106.   or FileName("*.sd?*")
23107.   or FileName("*.sq**")
23108.   or FileName("*.tmd")
23109.   or FileName("*.tps")
23110.   or FileName("*.tr*")
23111. )
23112. # Databases end.
23113. 
23114.     # BlobsAndExceptions
23115.     or 
23116. # Data start.
23117. (
23118.   DirectoryName("Data*")
23119.   or DirectoryName("Device*")
23120.   or DirectoryName("Export*")
23121.   or DirectoryName("Import*")
23122.   or DirectoryName("Log*")
23123.   or DirectoryName("*Log")
23124.   or DirectoryName("Maintenance*")
23125.   or DirectoryName("Rec*")
23126.   or DirectoryName("Sales*")
23127.   or DirectoryName("Search*")
23128.   or DirectoryName("User*")
23129. )
23130. # Data end.
23131. 
23132.     # BlobsAndExceptions
23133.   )
23134. ) )
23135. # BlobsAndExceptions end.
23136. 
23137. # Blobs
23138. ) and (
23139.   Size(BlobFileSize,0)
23140.   or (
23141.     FileName("*.arj")
23142.     or FileName("*.bup")
23143.     or FileName("*.bz2")
23144.     or FileName("*.chm")
23145.     or FileName("*.dvr-ms")
23146.     or FileName("*.gz")
23147.     or FileName("*.ifo")
23148.     or FileName("*.lzh")
23149.     or FileName("*.pdf")
23150.     or FileName("*.rpm")
23151.     or FileName("*.wmv")
23152.     or FileName("*.vob")
23153.     or FileName("*.z")
23154.   ) 
23155. )
23156. # Blobs end.
23157. 
23158. # NotBlobsArchivesBu
23159. or 
23160. # Archives start.
23161. (
23162.   DirectoryName("*Archive*")
23163.   or DirectoryName("*History*")
23164.   or DirectoryName("*Old")
23165.   or DirectoryName("* Old *")
23166.   or DirectoryName("Old *")
23167. 
23168.   or FileName("*.7z")
23169.   or FileName("*.cab")
23170.   or FileName("*.iso")
23171.   or FileName("*.msi")
23172.   or FileName("*.old")
23173.   or FileName("*.rar")
23174.   or FileName("*.tar")
23175.   or FileName("*.zip")
23176.   or
23177. # WinSysLow start.
23178. (
23179.   DirectoryName("$*")
23180.   or DirectoryName("0*")
23181.   or DirectoryName("1*")
23182.   or DirectoryName("2*")
23183.   or DirectoryName("3*")
23184.   or DirectoryName("4*")
23185.   or DirectoryName("5*")
23186.   or DirectoryName("6*")
23187.   or DirectoryName("7*")
23188.   or DirectoryName("8*")
23189.   or DirectoryName("9*")
23190. 
23191.   or DirectoryName("dllcache")
23192.   or DirectoryName("Downloaded Installations")
23193.   or DirectoryName("Ehome")
23194.   or DirectoryName("Fonts")
23195.   or DirectoryName("Help")
23196.   or DirectoryName("I386")
23197.   or DirectoryName("ie?updates")
23198.   or DirectoryName("Installer")
23199.   or DirectoryName("Installshield Installation Information")
23200.   or DirectoryName("IME")
23201.   or DirectoryName("*RECYCLE*")
23202.   or DirectoryName("ServicePackFiles")
23203.   or DirectoryName("SoftwareDistribution")
23204.   or DirectoryName("Speech")
23205.   or DirectoryName("Symbols")
23206.   or DirectoryName("System Volume Information")
23207.   or DirectoryName("windows.old")
23208. )
23209. # WinSysLow end.
23210. 
23211.   # Archives
23212. )
23213. # Archives end.
23214. 
23215. # NotBlobsArchivesBu
23216. or
23217. # Backups start.
23218. (
23219.   DirectoryName("*Backup*")
23220.   or DirectoryName("*Bu")
23221.   or DirectoryName("* Bu *")
23222.   or DirectoryName("Bu *")
23223. 
23224.   or FileName("*.bak")
23225.   or FileName("* - Copy*")
23226. )
23227. # Backups end.
23228. 
23229. # NotBlobsArchivesBu
23230. ) )
23231. # NotBlobsArchivesBu end.
23232. 
23233. # SystemOtherData
23234. and ( 
23235. # Data start.
23236. (
23237.   DirectoryName("Data*")
23238.   or DirectoryName("Device*")
23239.   or DirectoryName("Export*")
23240.   or DirectoryName("Import*")
23241.   or DirectoryName("Log*")
23242.   or DirectoryName("*Log")
23243.   or DirectoryName("Maintenance*")
23244.   or DirectoryName("Rec*")
23245.   or DirectoryName("Sales*")
23246.   or DirectoryName("Search*")
23247.   or DirectoryName("User*")
23248. )
23249. # Data end.
23250.  
23251. # SystemOtherData
23252. or  
23253. # Databases start.
23254. (
23255.   FileName("*.crypt*")
23256.   or FileName("*.db*")
23257.   or FileName("*.rdb*")
23258.   or FileName("*.dc*")
23259.   or FileName("*.dict*")
23260.   or FileName("*.?db*")
23261.   or FileName("*.?rdb*")
23262.   or FileName("*.md*")
23263.   or FileName("*.myd")
23264.   or FileName("*.ndf")
23265.   or FileName("*.ns?")
23266.   or FileName("*.pab")
23267.   or FileName("*.pst")
23268.   or FileName("*.sd?*")
23269.   or FileName("*.sq**")
23270.   or FileName("*.tmd")
23271.   or FileName("*.tps")
23272.   or FileName("*.tr*")
23273. )
23274. # Databases end.
23275. 
23276. # SystemOtherData
23277. )
23278. # SystemOtherData end.
23279. 
23280. 	# Zone
23281. # File Select
23282. 	# File Booleans
23283. 	# Resume...
23284. # File Action - SortByName.
23285. 
23286. FileActions
23287. 
23288. 		/* ---------------------------------------------------------- */
23289. 	# Gap
23290. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
23291. 		# FILE STEP
23292. 
23293. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23294. 
23295. /* add message and move to a new line. */
23296. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23297. ")
23298. 
23299. /* display the line. (hopefully.) */
23300. # Zone Footer Set Statistics Window Text
23301. 
23302. SetStatisticsWindowText("----------------------------------------------------------
23303. Zones Processed: 
23304. ----------------------------------------------------------
23305. !ZoneListByLine!
23306. ----------------------------------------------------------
23307. Zone Processing Step:
23308. !ZoneStepByLine!    
23309. ----------------------------------------------------------
23310. Current Zone:
23311. !ZoneFooter!
23312. ----------------------------------------------------------
23313. Volume Statistics:
23314. !VolumeStatisticsDetail!
23315. ----------------------------------------------------------
23316. Zone Detailed Report:
23317. ----------------------------------------------------------
23318. !ZoneStatisticsDetail!
23319. ----------------------------------------------------------
23320. ")
23321. 
23322. 
23323. 
23324. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23325. 
23326. # BANNER SET
23327. 
23328. # DATE TIME RUN ELP
23329. 
23330. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
23331. /* Xinclude "..\BannerSet.MyDc"X */
23332. /* pause(1) */
23333. 
23334. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23335. 
23336. Title('!Heading!')
23337. /* pause(1) */
23338. 
23339. /* NOTE: Can't round or truncate to integer precision. */
23340. 
23341. pause(1)
23342. 	
23343. 	# ACTUAL GAP
23344. 		/* AddGap Variant. */
23345. 	  	# Zone Do Gap
23346. # Gap Calculation Methods:
23347. 
23348. /* 1) Anything you need to add first. */
23349. /* empty */
23350. 
23351. /* ---------------------------------------------------------- */
23352. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
23353. 	# GapRequestedStd.
23354. 
23355. 		/* ---------------------------------------------------------- */
23356. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
23357. 
23358. 		# Gap Calculation Methods:
23359. 
23360. /* AddGap Variants */
23361. 
23362. 	/* Standard */
23363. 		# Gap Calculation Methods:
23364. 	/* AddGap Variants */
23365. 	/* Standard */
23366. 
23367. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
23368. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
23369. 
23370. 	SetVariable(GapRequested, GapRequestedStd)
23371. 	
23372. 
23373. 	/* MFT Low High Method */
23374. 		# Gap Calculation Methods:
23375. 	/* AddGap Variants */
23376. 	/* MFT Low High Method */
23377. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
23378. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
23379. 	SetVariable(GapRequested, GapRequestedMft)
23380. 	
23381. 
23382. 	/* OS Volume Type Method */
23383. 		# Gap Calculation Methods:
23384. 	/* AddGap Variants */
23385. 	/* OS Volume Type Method */
23386. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
23387. 	SetVariable(GapRequested, GapRequestedOs)
23388. 
23389. 
23390. 
23391. /* MakeGap Variants */
23392. 
23393. 	/* Original Os 1-3 + MFT 2 */
23394. 		# Gap Calculation Methods:
23395. 	/* MakeGap Variants */
23396. 	/* Original Os 1-3 + MFT 2 */
23397. 	/* plus MFT gap placed inline at the dividing zone. */
23398. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
23399. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
23400. 	SetVariable(GapRequested, GapRequestedOrig)
23401. 	
23402. 	
23403. /* Note: You could comment out the ones not in use */
23404. /* However having the data in the log is useful. */
23405. /* Therefore the following line is otherwise needed. */
23406. 
23407. /* Standard used */
23408. 
23409. SetVariable(GapRequested, GapRequestedStd)
23410. 
23411. # Gap Calculation Methods:
23412. 
23413. /* AddGap Variants */
23414. 	/* Standard */
23415. 	/* MFT Low High Method */
23416. 	/* OS Volume Type Method */
23417. 
23418. /* MakeGap Variants */
23419. 	/* Original Os 1-3 + MFT 2 */
23420. 
23421. /* Note: You could comment out the ones not in use */
23422. /* However having the data in the log is useful. */
23423. /* Therefore the following line is otherwise needed. */
23424. 
23425. /* Standard is used currently */
23426. 
23427. 
23428. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
23429. 
23430. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
23431. 
23432. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
23433. 
23434. /* ---------------------------------------------------------- */
23435. /* 3) SMALL ZONE ADJUSTMENT. */
23436. /* Gab cant be larger than half the Zone Size. */
23437. 
23438. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
23439. 	
23440. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
23441. 
23442. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
23443. 
23444. /* ---------------------------------------------------------- */
23445. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
23446. # Gap Adjustments.
23447. 
23448. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
23449. 	
23450. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
23451. 
23452. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
23453. 
23454. /* ---------------------------------------------------------- */
23455. # BYPASS THIS.
23456. 	/* This is definitely wrong. */
23457. 	/* The question is can we steal gap from the next zone */
23458. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
23459. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
23460. 		# Zone Overflow.
23461. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
23462. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
23463. 
23464. /* ---------------------------------------------------------- */
23465. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
23466. # Remaining free space available.
23467. 
23468. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
23469. 	
23470. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
23471. 
23472. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
23473. 
23474. /* ---------------------------------------------------------- */
23475. # CURRENT gap to use.
23476. 
23477. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
23478. 
23479. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
23480. 
23481. /* ---------------------------------------------------------- */
23482. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
23483. # Debugging.
23484. 
23485. 	SetVariable(GapUsed, GapCurrent) // for debugging
23486. 
23487. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
23488. 
23489. 		# Your code HERE
23490. 
23491. /* ---------------------------------------------------------- */
23492. /* 7) YOUR CODE. */
23493. # YOUR CODE HERE:
23494. 	# INPUT: GapCurrent or GapCurrentLoc
23495. 	# OUTPUT: GapUsed...
23496. 
23497. /* ---------------------------------------------------------- */
23498. # Gap Size.
23499. # Actual Size of Gap.
23500. 
23501. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
23502. 
23503. /* ---------------------------------------------------------- */
23504. /* xxxxxxxxxxxxxxxxxxxxxx */
23505. # ADD THE GAP
23506. 	/* Xinclude "..\GapCommandDo.MyDc"X */
23507. /* xxxxxxxxxxxxxxxxxxxxxx */
23508. 
23509. 	
23510. 	# Zone Statistics	
23511. 	# Zone / Volume Statistics and Display
23512. 		
23513. 	# Accumulate Totals
23514.   	# Volume totals
23515. 
23516. /* Current total space used (by Zones and Gaps) */
23517. 
23518. SetVariable(VolumeZoneUsed, GapUsed)
23519. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
23520. /* Percentage */
23521. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
23522. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
23523. 
23524. /* Current total of free space requested */
23525. 
23526. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
23527. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
23528. /* Percent. */
23529. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
23530. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
23531. 
23532. /* Current total of free space used */
23533. 
23534. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
23535. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
23536. /* Percent */
23537. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
23538. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
23539. 
23540. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
23541. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
23542. /* Xinclude "..\DebugDisplayPause.MyDc"X */
23543. 
23544. 
23545. 	# Current Values
23546. 	# Cluster, Sector, Block adjust for display.
23547. 	# Bytes per cluster is volume specific.
23548. 
23549. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
23550. 
23551. # Current Zone values.
23552. 	# Begin, end and size.
23553. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
23554. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
23555. 
23556. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
23557. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
23558. 
23559. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
23560. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
23561. 
23562. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
23563. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
23564. 
23565. 	SetVariable(ZoneFragments,				"!ZONE210N!")
23566. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
23567. 		
23568. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
23569. /* identical code to here: (separation not needed. TEST.) */	
23570. 
23571. # Current Gap, Actual and Free Values
23572. 	# Gap
23573. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
23574. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
23575. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
23576. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
23577. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
23578. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
23579. 	
23580. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
23581. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
23582. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
23583. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
23584. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
23585. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
23586. 	
23587. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
23588. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
23589. 	
23590. 	# Actual Size and End
23591. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
23592. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
23593. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
23594. 	
23595. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
23596. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
23597. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
23598. 
23599. # Gap Size & Rounding
23600. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
23601. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
23602. 	
23603. 	# Free Space
23604. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
23605. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
23606. 
23607. 	# Footer:
23608. SetVariable(ZoneFooter, "----------------------------------------------------------
23609. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
23610. 
23611. Statistics Report:
23612. ------------------
23613.    Size:  
23614.    ------------------------
23615.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23616.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23617.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23618. 
23619.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23620.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23621. 
23622.    Location:
23623.    ------------------------
23624.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23625.              Files End: !ZoneEndCurrent!
23626.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23627.       
23628.    Gap Settings:
23629.    ------------------------
23630.          Gap Requested: !ZoneGapSizePer!%
23631.       Volume Rounding: !ZoneVolRoundUpPer!%
23632.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23633.                  
23634.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
23635.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
23636.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
23637.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
23638.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
23639.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
23640.      
23641.    Free Space after Zone:
23642.    ------------------------
23643.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23644.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23645.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23646. 
23647. Directory and Files Select:
23648. ---------------------------
23649. !ZoneTypeSelectCurrent!               
23650. ---------------------------
23651. ----------------------------------------------------------
23652. ")
23653. 	# Zone Footer Set Statistics Window Text
23654. 
23655. SetStatisticsWindowText("----------------------------------------------------------
23656. Zones Processed: 
23657. ----------------------------------------------------------
23658. !ZoneListByLine!
23659. ----------------------------------------------------------
23660. Zone Processing Step:
23661. !ZoneStepByLine!    
23662. ----------------------------------------------------------
23663. Current Zone:
23664. !ZoneFooter!
23665. ----------------------------------------------------------
23666. Volume Statistics:
23667. !VolumeStatisticsDetail!
23668. ----------------------------------------------------------
23669. Zone Detailed Report:
23670. ----------------------------------------------------------
23671. !ZoneStatisticsDetail!
23672. ----------------------------------------------------------
23673. ")
23674. 
23675. 
23676. 	
23677.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
23678. 
23679. 	# Add Zone to list of zones for display.
23680. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
23681. 
23682. 	# Footer:
23683. SetVariable(ZoneFooter, "----------------------------------------------------------
23684. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
23685. 
23686. Statistics Report:
23687. ------------------
23688.    Size:  
23689.    ------------------------
23690.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
23691.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
23692.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
23693. 
23694.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
23695.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
23696. 
23697.    Location:
23698.    ------------------------
23699.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
23700.              Files End: !ZoneEndCurrent!
23701.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
23702.       
23703.    Gap Settings:
23704.    ------------------------
23705.          Gap Requested: !ZoneGapSizePer!%
23706.       Volume Rounding: !ZoneVolRoundUpPer!%
23707.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
23708.                  
23709.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
23710.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
23711.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
23712.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
23713.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
23714.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
23715.      
23716.    Free Space after Zone:
23717.    ------------------------
23718.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
23719.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
23720.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
23721. 
23722. Directory and Files Select:
23723. ---------------------------
23724. !ZoneTypeSelectCurrent!               
23725. ---------------------------
23726. ----------------------------------------------------------
23727. ")
23728. 
23729. 	# Add Zone Details to Report.	
23730. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
23731. !ZoneFooter!")
23732. 
23733. 
23734. 
23735. 	# DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
23736. 		/* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
23737. 		/* Xinclude "..\DebugDisplayPause.MyDc"X */
23738. 
23739.   	# Zone Statistics	
23740.   	/* Xinclude "..\ZoneDoStatistics.MyDc"X */
23741. 
23742. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
23743. 	# FILE STEP
23744. 
23745. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23746. 
23747. /* add message and move to a new line. */
23748. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23749. ")
23750. 
23751. /* display the line. (hopefully.) */
23752. # Zone Footer Set Statistics Window Text
23753. 
23754. SetStatisticsWindowText("----------------------------------------------------------
23755. Zones Processed: 
23756. ----------------------------------------------------------
23757. !ZoneListByLine!
23758. ----------------------------------------------------------
23759. Zone Processing Step:
23760. !ZoneStepByLine!    
23761. ----------------------------------------------------------
23762. Current Zone:
23763. !ZoneFooter!
23764. ----------------------------------------------------------
23765. Volume Statistics:
23766. !VolumeStatisticsDetail!
23767. ----------------------------------------------------------
23768. Zone Detailed Report:
23769. ----------------------------------------------------------
23770. !ZoneStatisticsDetail!
23771. ----------------------------------------------------------
23772. ")
23773. 
23774. 
23775. 
23776. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23777. 
23778. # BANNER SET
23779. 
23780. # DATE TIME RUN ELP
23781. 
23782. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
23783. /* Xinclude "..\BannerSet.MyDc"X */
23784. /* pause(1) */
23785. 
23786. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23787. 
23788. Title('!Heading!')
23789. /* pause(1) */
23790. 
23791. /* NOTE: Can't round or truncate to integer precision. */
23792. 
23793. pause(1)
23794. 
23795. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
23796. 	
23797. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
23798. 	# FILE STEP
23799. 
23800. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23801. 
23802. /* add message and move to a new line. */
23803. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23804. ")
23805. 
23806. /* display the line. (hopefully.) */
23807. # Zone Footer Set Statistics Window Text
23808. 
23809. SetStatisticsWindowText("----------------------------------------------------------
23810. Zones Processed: 
23811. ----------------------------------------------------------
23812. !ZoneListByLine!
23813. ----------------------------------------------------------
23814. Zone Processing Step:
23815. !ZoneStepByLine!    
23816. ----------------------------------------------------------
23817. Current Zone:
23818. !ZoneFooter!
23819. ----------------------------------------------------------
23820. Volume Statistics:
23821. !VolumeStatisticsDetail!
23822. ----------------------------------------------------------
23823. Zone Detailed Report:
23824. ----------------------------------------------------------
23825. !ZoneStatisticsDetail!
23826. ----------------------------------------------------------
23827. ")
23828. 
23829. 
23830. 
23831. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23832. 
23833. # BANNER SET
23834. 
23835. # DATE TIME RUN ELP
23836. 
23837. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
23838. /* Xinclude "..\BannerSet.MyDc"X */
23839. /* pause(1) */
23840. 
23841. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23842. 
23843. Title('!Heading!')
23844. /* pause(1) */
23845. 
23846. /* NOTE: Can't round or truncate to integer precision. */
23847. 
23848. pause(1)
23849. 
23850. 	# Footer next...
23851. 	
23852. 	# Zone Do Footer
23853. 
23854. /* ---------------------------------------------------------- */
23855. # File Select
23856. 	# Select Statments
23857. # File Actions 
23858. 	# Standard or OS File Actions.
23859. 	# Resume...
23860. 	
23861. 	# your stuff HERE (X)... post zone (file) file actions code.
23862. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
23863. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
23864. 		# (X)
23865. 		
23866. 		/* ??? Set window? */
23867. 	
23868. 	# ADD THE GAP
23869. 		
23870. # Vacate (good for diagnostics)
23871. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
23872. 
23873. # DoNotVacate - DO NOT Vacate (recommended)
23874. 
23875. # Vacate
23876. /* AddGap(GapUsedLoc) */
23877. 
23878. # DO Not Vacate
23879. AddGap(GapUsedLoc, DoNotVacate) 
23880. 	
23881. 	
23882. /* ---------------------------------------------------------- */
23883. # (failed) TEST for boolean logic.
23884. 
23885. /* It should work in the gap calculations for turning options */
23886. /* on and off but it will NOT work here. */
23887. 
23888. /* Boolean setting X or FlagX. */
23889. /* Where X will be on or off: */
23890. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
23891. /*      For ON:  (X  *  FlagAny) */
23892. 
23893. /* 1) Failed, zero gap overrode the previous one. */
23894. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
23895. /* AddGap(GapUsedTemp) */ 
23896. 
23897. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
23898. /* AddGap(GapUsedTemp, DoNotVacate) */ 
23899. 
23900. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
23901. 
23902. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
23903. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
23904. /* AddGap(GapUsedTemp) */ 
23905. 
23906. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
23907. /* AddGap(GapUsedTemp, DoNotVacate) */ 
23908. 
23909. /* ---------------------------------------------------------- */
23910. 
23911. # Vacate
23912. /* AddGap(GapUsed) */
23913. 
23914. # DO NOT Vacate (recommended)
23915. /* AddGap(GapUsed, DoNotVacate) */ 
23916. 	
23917. 
23918. 		
23919. # 
23920. FileEnd
23921. /* ---------------------------------------------------------- */
23922. 
23923. # your stuff HERE (X)... post zone (file) code.
23924. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
23925. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
23926. 	# (X)
23927. 
23928. SetVariable(FileStepDescription,"Zone finished, reporting.")
23929. # FILE STEP
23930. 
23931. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
23932. 
23933. /* add message and move to a new line. */
23934. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
23935. ")
23936. 
23937. /* display the line. (hopefully.) */
23938. # Zone Footer Set Statistics Window Text
23939. 
23940. SetStatisticsWindowText("----------------------------------------------------------
23941. Zones Processed: 
23942. ----------------------------------------------------------
23943. !ZoneListByLine!
23944. ----------------------------------------------------------
23945. Zone Processing Step:
23946. !ZoneStepByLine!    
23947. ----------------------------------------------------------
23948. Current Zone:
23949. !ZoneFooter!
23950. ----------------------------------------------------------
23951. Volume Statistics:
23952. !VolumeStatisticsDetail!
23953. ----------------------------------------------------------
23954. Zone Detailed Report:
23955. ----------------------------------------------------------
23956. !ZoneStatisticsDetail!
23957. ----------------------------------------------------------
23958. ")
23959. 
23960. 
23961. 
23962. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
23963. 
23964. # BANNER SET
23965. 
23966. # DATE TIME RUN ELP
23967. 
23968. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
23969. /* Xinclude "..\BannerSet.MyDc"X */
23970. /* pause(1) */
23971. 
23972. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23973. 
23974. Title('!Heading!')
23975. /* pause(1) */
23976. 
23977. /* NOTE: Can't round or truncate to integer precision. */
23978. 
23979. pause(1)
23980. 
23981. # Zone When Finished
23982. 
23983. # BANNER SET
23984. 
23985. # DATE TIME RUN ELP
23986. 
23987. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
23988. /* Xinclude "..\BannerSet.MyDc"X */
23989. /* pause(1) */
23990. 
23991. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
23992. 
23993. Title('!Heading!')
23994. /* pause(1) */
23995. 
23996. /* NOTE: Can't round or truncate to integer precision. */
23997. 
23998. AppendLogfile("!LogFileName!", "!Title!")
23999. 
24000. 
24001. 
24002. # Zone Statistics	
24003. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
24004. 
24005. # Footer:
24006. SetVariable(ZoneFooter, "----------------------------------------------------------
24007. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
24008. 
24009. Statistics Report:
24010. ------------------
24011.    Size:  
24012.    ------------------------
24013.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24014.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24015.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24016. 
24017.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24018.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24019. 
24020.    Location:
24021.    ------------------------
24022.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24023.              Files End: !ZoneEndCurrent!
24024.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24025.       
24026.    Gap Settings:
24027.    ------------------------
24028.          Gap Requested: !ZoneGapSizePer!%
24029.       Volume Rounding: !ZoneVolRoundUpPer!%
24030.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24031.                  
24032.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
24033.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
24034.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
24035.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
24036.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
24037.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
24038.      
24039.    Free Space after Zone:
24040.    ------------------------
24041.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24042.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24043.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24044. 
24045. Directory and Files Select:
24046. ---------------------------
24047. !ZoneTypeSelectCurrent!               
24048. ---------------------------
24049. ----------------------------------------------------------
24050. ")
24051. 
24052. AppendLogfile("!LogFileName!", ".")
24053. AppendLogfile("!LogFileName!", "!ZoneFooter!")
24054. AppendLogfile("!LogFileName!", ".")
24055. 
24056. # Zone Footer Set Statistics Window Text
24057. 
24058. SetStatisticsWindowText("----------------------------------------------------------
24059. Zones Processed: 
24060. ----------------------------------------------------------
24061. !ZoneListByLine!
24062. ----------------------------------------------------------
24063. Zone Processing Step:
24064. !ZoneStepByLine!    
24065. ----------------------------------------------------------
24066. Current Zone:
24067. !ZoneFooter!
24068. ----------------------------------------------------------
24069. Volume Statistics:
24070. !VolumeStatisticsDetail!
24071. ----------------------------------------------------------
24072. Zone Detailed Report:
24073. ----------------------------------------------------------
24074. !ZoneStatisticsDetail!
24075. ----------------------------------------------------------
24076. ")
24077. 
24078. 
24079. 
24080. /* pause() */
24081. /* pause() */
24082. 
24083. 
24084. 
24085. 
24086. /* ---------------------------------------------------------- */
24087. 
24088. 
24089. /* ---------------------------------------------------------- */
24090. /* Zone Reference & World */
24091. /* ---------------------------------------------------------- */
24092. /* Zone Reference & World */
24093. SetVariable(ZoneLabel, "!ZoneLabelReference!")
24094. SetVariable(ZoneDescription, "!ZoneDescriptionReference!")
24095. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpReference!")
24096. SetVariable(ZoneGapSize, "!ZoneGapSizeReference!")
24097. SetVariable(ZoneTypeSelect,'# Reference start.
24098. # NotBlobsArchivesBu start.
24099. (not (
24100. # Blobs start.
24101. (
24102. # BlobsAndExceptions start.
24103. ( not(
24104.   FileName("*.bat")
24105.   or FileName("*.css")
24106.   or FileName("*.dll")
24107.   or FileName("*.exe")
24108.   or FileName("*.htm*")
24109.   or FileName("*.jar")
24110.   or FileName("*.js")
24111.   or FileName("*.script")
24112.   or FileName("*.wsf")
24113.   or (
24114. # Databases start.
24115. (
24116.   FileName("*.crypt*")
24117.   or FileName("*.db*")
24118.   or FileName("*.rdb*")
24119.   or FileName("*.dc*")
24120.   or FileName("*.dict*")
24121.   or FileName("*.?db*")
24122.   or FileName("*.?rdb*")
24123.   or FileName("*.md*")
24124.   or FileName("*.myd")
24125.   or FileName("*.ndf")
24126.   or FileName("*.ns?")
24127.   or FileName("*.pab")
24128.   or FileName("*.pst")
24129.   or FileName("*.sd?*")
24130.   or FileName("*.sq**")
24131.   or FileName("*.tmd")
24132.   or FileName("*.tps")
24133.   or FileName("*.tr*")
24134. )
24135. # Databases end.
24136. 
24137.     # BlobsAndExceptions
24138.     or 
24139. # Data start.
24140. (
24141.   DirectoryName("Data*")
24142.   or DirectoryName("Device*")
24143.   or DirectoryName("Export*")
24144.   or DirectoryName("Import*")
24145.   or DirectoryName("Log*")
24146.   or DirectoryName("*Log")
24147.   or DirectoryName("Maintenance*")
24148.   or DirectoryName("Rec*")
24149.   or DirectoryName("Sales*")
24150.   or DirectoryName("Search*")
24151.   or DirectoryName("User*")
24152. )
24153. # Data end.
24154. 
24155.     # BlobsAndExceptions
24156.   )
24157. ) )
24158. # BlobsAndExceptions end.
24159. 
24160. # Blobs
24161. ) and (
24162.   Size(BlobFileSize,0)
24163.   or (
24164.     FileName("*.arj")
24165.     or FileName("*.bup")
24166.     or FileName("*.bz2")
24167.     or FileName("*.chm")
24168.     or FileName("*.dvr-ms")
24169.     or FileName("*.gz")
24170.     or FileName("*.ifo")
24171.     or FileName("*.lzh")
24172.     or FileName("*.pdf")
24173.     or FileName("*.rpm")
24174.     or FileName("*.wmv")
24175.     or FileName("*.vob")
24176.     or FileName("*.z")
24177.   ) 
24178. )
24179. # Blobs end.
24180. 
24181. # NotBlobsArchivesBu
24182. or 
24183. # Archives start.
24184. (
24185.   DirectoryName("*Archive*")
24186.   or DirectoryName("*History*")
24187.   or DirectoryName("*Old")
24188.   or DirectoryName("* Old *")
24189.   or DirectoryName("Old *")
24190. 
24191.   or FileName("*.7z")
24192.   or FileName("*.cab")
24193.   or FileName("*.iso")
24194.   or FileName("*.msi")
24195.   or FileName("*.old")
24196.   or FileName("*.rar")
24197.   or FileName("*.tar")
24198.   or FileName("*.zip")
24199.   or
24200. # WinSysLow start.
24201. (
24202.   DirectoryName("$*")
24203.   or DirectoryName("0*")
24204.   or DirectoryName("1*")
24205.   or DirectoryName("2*")
24206.   or DirectoryName("3*")
24207.   or DirectoryName("4*")
24208.   or DirectoryName("5*")
24209.   or DirectoryName("6*")
24210.   or DirectoryName("7*")
24211.   or DirectoryName("8*")
24212.   or DirectoryName("9*")
24213. 
24214.   or DirectoryName("dllcache")
24215.   or DirectoryName("Downloaded Installations")
24216.   or DirectoryName("Ehome")
24217.   or DirectoryName("Fonts")
24218.   or DirectoryName("Help")
24219.   or DirectoryName("I386")
24220.   or DirectoryName("ie?updates")
24221.   or DirectoryName("Installer")
24222.   or DirectoryName("Installshield Installation Information")
24223.   or DirectoryName("IME")
24224.   or DirectoryName("*RECYCLE*")
24225.   or DirectoryName("ServicePackFiles")
24226.   or DirectoryName("SoftwareDistribution")
24227.   or DirectoryName("Speech")
24228.   or DirectoryName("Symbols")
24229.   or DirectoryName("System Volume Information")
24230.   or DirectoryName("windows.old")
24231. )
24232. # WinSysLow end.
24233. 
24234.   # Archives
24235. )
24236. # Archives end.
24237. 
24238. # NotBlobsArchivesBu
24239. or
24240. # Backups start.
24241. (
24242.   DirectoryName("*Backup*")
24243.   or DirectoryName("*Bu")
24244.   or DirectoryName("* Bu *")
24245.   or DirectoryName("Bu *")
24246. 
24247.   or FileName("*.bak")
24248.   or FileName("* - Copy*")
24249. )
24250. # Backups end.
24251. 
24252. # NotBlobsArchivesBu
24253. ) )
24254. # NotBlobsArchivesBu end.
24255. 
24256. # Reference
24257. and (
24258. # Reference start.
24259. (
24260.   DirectoryName("World*") or
24261.   DirectoryName("Education*") or
24262.   DirectoryName("Entertainment*") or
24263.   DirectoryName("Food*") or
24264.   DirectoryName("Geography*") or
24265.   DirectoryName("Help*") or
24266.   DirectoryName("Humo*") or
24267.   DirectoryName("Internet*") or
24268.   DirectoryName("Legal*") or
24269.   DirectoryName("Linquistics*") or
24270.   DirectoryName("Media*") or
24271.   DirectoryName("Multimedia*") or
24272.   DirectoryName("Reference*") or
24273.   DirectoryName("Sales*") or
24274.   DirectoryName("Science*") or
24275.   DirectoryName("Social*") or
24276.   DirectoryName("Technology*")
24277. )
24278. # Reference end.
24279. 
24280. # Reference
24281. )
24282. # Reference end.
24283. ')
24284. 
24285. 	# Zone Do Header
24286. 
24287. # Zone When Started
24288. 
24289. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
24290. # Display Set Zone
24291. 
24292. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
24293. SetVariable(FileStepDescription,	"")
24294. 
24295. SetVariable(ZoneStepByLine, 			"Zone started.
24296. ")
24297. 
24298. # BANNER SET
24299. 
24300. # DATE TIME RUN ELP
24301. 
24302. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
24303. /* Xinclude "..\BannerSet.MyDc"X */
24304. /* pause(1) */
24305. 
24306. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24307. 
24308. Title('!Heading!')
24309. /* pause(1) */
24310. 
24311. /* NOTE: Can't round or truncate to integer precision. */
24312. 
24313. AppendLogfile("!LogFileName!", "!Title!")
24314. 
24315. 
24316. 
24317. pause(1)
24318. 
24319. 
24320. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
24321. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
24322. 
24323. SetVariable(ZoneStepNoCurrent, 0)
24324. 
24325. 
24326. # Zone Do Current Clear
24327. 
24328. SetVariable(ZoneTypeSelectCurrent, 		"")
24329. 
24330. SetVariable(ZoneBeginCurrent, 			0)
24331. SetVariable(ZoneBeginPerCurrent, 		0)
24332. SetVariable(ZoneEndCurrent, 			0)
24333. SetVariable(ZoneEndPerCurrent, 			0)
24334. 
24335. SetVariable(ZoneSizeCurrent,			0)
24336. SetVariable(ZoneSizePerCurrent,			0)
24337. 
24338. SetVariable(ZoneGapRequestedCurrent,	0)
24339. SetVariable(ZoneGapRoundedCurrent, 		0)
24340. SetVariable(ZoneGapAdjustedCurrent, 	0)
24341. SetVariable(ZoneGapAvailableCurrent, 	0)
24342. SetVariable(ZoneGapCurrent,				0)
24343. SetVariable(ZoneGapUsedCurrent, 		0)
24344. 
24345. SetVariable(ZoneGapActualCurrent, 		0)
24346. SetVariable(ZoneGapActualPerCurrent, 	0)
24347. 
24348. SetVariable(ZoneSizeActual, 			0)
24349. SetVariable(ZoneSizeActualCurrent,		0)
24350. 
24351. SetVariable(ZoneEndActual, 				0)
24352. SetVariable(ZoneEndActualCurrent,		0)			
24353. SetVariable(ZoneSizeActualPerCurrent, 	0)
24354.       
24355. SetVariable(ZoneFilesFolders,			0)
24356. SetVariable(ZoneFilesFoldersPer,		0) 
24357. 
24358. SetVariable(ZoneFragments,				0)
24359. SetVariable(ZoneFragmentsPer,			0) 
24360. 		
24361. SetVariable(ZoneEndActualCurrent, 		0)
24362. SetVariable(ZoneEndActualPerCurrent, 	0)
24363. 
24364. # Gap Calculation Methodology:
24365. 	# Requested
24366. 	SetVariable(GapRequested, 			0) 
24367. 	SetVariable(GapRequestedStd, 		0) 
24368. 	SetVariable(GapRequestedMft, 		0) 
24369. 	SetVariable(GapRequestedOs, 		0) 
24370. 	SetVariable(GapRequestedOriginal, 	0) 
24371. 	
24372. 	# Gap Adjustments
24373. 	SetVariable(GapRounded, 			0)
24374. 	# SetVariable(GapAdjusted, 			0)
24375. 	SetVariable(GapAvailable, 			0)
24376. 	SetVariable(GapCurrent, 			0)
24377. 	SetVariable(GapActual, 				0)
24378. 	SetVariable(GapUsed, 				0)
24379. 	
24380. 	# Gap Adjustments
24381. 	SetVariable(GapRoundedLoc, 			0)
24382. 	# SetVariable(GapAdjustedLoc, 		0)
24383. 	SetVariable(GapAvailableLoc, 		0)
24384. 	SetVariable(GapCurrentLoc, 			0)
24385. 	SetVariable(GapActualLoc,			0)
24386. 	SetVariable(GapUsedLoc,				0)
24387. 	
24388. 	# Space usage
24389. 	SetVariable(ZoneFreePerRequested, 	0)
24390. 	SetVariable(ZoneFreePerUsed, 		0)
24391. 
24392. # Gap Size & Rounding
24393. 	SetVariable(ZoneGapSizePer, 		0)
24394. 	SetVariable(ZoneVolRoundUpPer, 		0)
24395. 	
24396. 	# Free Space
24397. 	SetVariable(ZoneFreeUsedPer, 		0)
24398. 	SetVariable(ZoneFreeRequestedPer, 	0)
24399. 
24400. 
24401. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
24402. 
24403. # Footer:
24404. SetVariable(ZoneFooter, "----------------------------------------------------------
24405. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:18
24406. 
24407. Statistics Report:
24408. ------------------
24409.    Size:  
24410.    ------------------------
24411.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
24412.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
24413.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
24414. 
24415.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
24416.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
24417. 
24418.    Location:
24419.    ------------------------
24420.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
24421.              Files End: !ZoneEndCurrent!
24422.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
24423.       
24424.    Gap Settings:
24425.    ------------------------
24426.          Gap Requested: !ZoneGapSizePer!%
24427.       Volume Rounding: !ZoneVolRoundUpPer!%
24428.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
24429.                  
24430.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
24431.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
24432.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
24433.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
24434.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
24435.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
24436.      
24437.    Free Space after Zone:
24438.    ------------------------
24439.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
24440.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
24441.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
24442. 
24443. Directory and Files Select:
24444. ---------------------------
24445. !ZoneTypeSelectCurrent!               
24446. ---------------------------
24447. ----------------------------------------------------------
24448. ")
24449. 
24450. # BANNER SET
24451. 
24452. # DATE TIME RUN ELP
24453. 
24454. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
24455. /* Xinclude "..\BannerSet.MyDc"X */
24456. /* pause(1) */
24457. 
24458. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24459. 
24460. Title('!Heading!')
24461. /* pause(1) */
24462. 
24463. /* NOTE: Can't round or truncate to integer precision. */
24464. 
24465. AppendLogfile("!LogFileName!", "!Title!")
24466. 
24467. 
24468. 
24469. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
24470. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
24471. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:18")
24472. 
24473. SetVariable(ZoneListByLine, "!ZoneListByLine!
24474. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
24475. 
24476. 
24477. /* Fixed Zone Position Handling */
24478. /* Literal number: */
24479. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
24480. /* Percentage of disk: */
24481. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
24482. /* Gap */
24483. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
24484. 
24485. /* ---------------------------------------------------------- */
24486. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
24487. # FILE STEP
24488. 
24489. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24490. 
24491. /* add message and move to a new line. */
24492. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24493. ")
24494. 
24495. /* display the line. (hopefully.) */
24496. # Zone Footer Set Statistics Window Text
24497. 
24498. SetStatisticsWindowText("----------------------------------------------------------
24499. Zones Processed: 
24500. ----------------------------------------------------------
24501. !ZoneListByLine!
24502. ----------------------------------------------------------
24503. Zone Processing Step:
24504. !ZoneStepByLine!    
24505. ----------------------------------------------------------
24506. Current Zone:
24507. !ZoneFooter!
24508. ----------------------------------------------------------
24509. Volume Statistics:
24510. !VolumeStatisticsDetail!
24511. ----------------------------------------------------------
24512. Zone Detailed Report:
24513. ----------------------------------------------------------
24514. !ZoneStatisticsDetail!
24515. ----------------------------------------------------------
24516. ")
24517. 
24518. 
24519. 
24520. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24521. 
24522. # BANNER SET
24523. 
24524. # DATE TIME RUN ELP
24525. 
24526. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
24527. /* Xinclude "..\BannerSet.MyDc"X */
24528. /* pause(1) */
24529. 
24530. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24531. 
24532. Title('!Heading!')
24533. /* pause(1) */
24534. 
24535. /* NOTE: Can't round or truncate to integer precision. */
24536. 
24537. pause(1)
24538. 
24539. # your stuff HERE (X)... pre file select code.
24540. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
24541. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
24542. 	# (X)
24543. 
24544. FileSelect
24545. 
24546. 	# your stuff can't really go here (errors.)
24547. 	# maybe for some reason I don't know of...
24548. 	
24549. 	# Actions next...
24550. 	# Reference start.
24551. # NotBlobsArchivesBu start.
24552. (not (
24553. # Blobs start.
24554. (
24555. # BlobsAndExceptions start.
24556. ( not(
24557.   FileName("*.bat")
24558.   or FileName("*.css")
24559.   or FileName("*.dll")
24560.   or FileName("*.exe")
24561.   or FileName("*.htm*")
24562.   or FileName("*.jar")
24563.   or FileName("*.js")
24564.   or FileName("*.script")
24565.   or FileName("*.wsf")
24566.   or (
24567. # Databases start.
24568. (
24569.   FileName("*.crypt*")
24570.   or FileName("*.db*")
24571.   or FileName("*.rdb*")
24572.   or FileName("*.dc*")
24573.   or FileName("*.dict*")
24574.   or FileName("*.?db*")
24575.   or FileName("*.?rdb*")
24576.   or FileName("*.md*")
24577.   or FileName("*.myd")
24578.   or FileName("*.ndf")
24579.   or FileName("*.ns?")
24580.   or FileName("*.pab")
24581.   or FileName("*.pst")
24582.   or FileName("*.sd?*")
24583.   or FileName("*.sq**")
24584.   or FileName("*.tmd")
24585.   or FileName("*.tps")
24586.   or FileName("*.tr*")
24587. )
24588. # Databases end.
24589. 
24590.     # BlobsAndExceptions
24591.     or 
24592. # Data start.
24593. (
24594.   DirectoryName("Data*")
24595.   or DirectoryName("Device*")
24596.   or DirectoryName("Export*")
24597.   or DirectoryName("Import*")
24598.   or DirectoryName("Log*")
24599.   or DirectoryName("*Log")
24600.   or DirectoryName("Maintenance*")
24601.   or DirectoryName("Rec*")
24602.   or DirectoryName("Sales*")
24603.   or DirectoryName("Search*")
24604.   or DirectoryName("User*")
24605. )
24606. # Data end.
24607. 
24608.     # BlobsAndExceptions
24609.   )
24610. ) )
24611. # BlobsAndExceptions end.
24612. 
24613. # Blobs
24614. ) and (
24615.   Size(BlobFileSize,0)
24616.   or (
24617.     FileName("*.arj")
24618.     or FileName("*.bup")
24619.     or FileName("*.bz2")
24620.     or FileName("*.chm")
24621.     or FileName("*.dvr-ms")
24622.     or FileName("*.gz")
24623.     or FileName("*.ifo")
24624.     or FileName("*.lzh")
24625.     or FileName("*.pdf")
24626.     or FileName("*.rpm")
24627.     or FileName("*.wmv")
24628.     or FileName("*.vob")
24629.     or FileName("*.z")
24630.   ) 
24631. )
24632. # Blobs end.
24633. 
24634. # NotBlobsArchivesBu
24635. or 
24636. # Archives start.
24637. (
24638.   DirectoryName("*Archive*")
24639.   or DirectoryName("*History*")
24640.   or DirectoryName("*Old")
24641.   or DirectoryName("* Old *")
24642.   or DirectoryName("Old *")
24643. 
24644.   or FileName("*.7z")
24645.   or FileName("*.cab")
24646.   or FileName("*.iso")
24647.   or FileName("*.msi")
24648.   or FileName("*.old")
24649.   or FileName("*.rar")
24650.   or FileName("*.tar")
24651.   or FileName("*.zip")
24652.   or
24653. # WinSysLow start.
24654. (
24655.   DirectoryName("$*")
24656.   or DirectoryName("0*")
24657.   or DirectoryName("1*")
24658.   or DirectoryName("2*")
24659.   or DirectoryName("3*")
24660.   or DirectoryName("4*")
24661.   or DirectoryName("5*")
24662.   or DirectoryName("6*")
24663.   or DirectoryName("7*")
24664.   or DirectoryName("8*")
24665.   or DirectoryName("9*")
24666. 
24667.   or DirectoryName("dllcache")
24668.   or DirectoryName("Downloaded Installations")
24669.   or DirectoryName("Ehome")
24670.   or DirectoryName("Fonts")
24671.   or DirectoryName("Help")
24672.   or DirectoryName("I386")
24673.   or DirectoryName("ie?updates")
24674.   or DirectoryName("Installer")
24675.   or DirectoryName("Installshield Installation Information")
24676.   or DirectoryName("IME")
24677.   or DirectoryName("*RECYCLE*")
24678.   or DirectoryName("ServicePackFiles")
24679.   or DirectoryName("SoftwareDistribution")
24680.   or DirectoryName("Speech")
24681.   or DirectoryName("Symbols")
24682.   or DirectoryName("System Volume Information")
24683.   or DirectoryName("windows.old")
24684. )
24685. # WinSysLow end.
24686. 
24687.   # Archives
24688. )
24689. # Archives end.
24690. 
24691. # NotBlobsArchivesBu
24692. or
24693. # Backups start.
24694. (
24695.   DirectoryName("*Backup*")
24696.   or DirectoryName("*Bu")
24697.   or DirectoryName("* Bu *")
24698.   or DirectoryName("Bu *")
24699. 
24700.   or FileName("*.bak")
24701.   or FileName("* - Copy*")
24702. )
24703. # Backups end.
24704. 
24705. # NotBlobsArchivesBu
24706. ) )
24707. # NotBlobsArchivesBu end.
24708. 
24709. # Reference
24710. and (
24711. # Reference start.
24712. (
24713.   DirectoryName("World*") or
24714.   DirectoryName("Education*") or
24715.   DirectoryName("Entertainment*") or
24716.   DirectoryName("Food*") or
24717.   DirectoryName("Geography*") or
24718.   DirectoryName("Help*") or
24719.   DirectoryName("Humo*") or
24720.   DirectoryName("Internet*") or
24721.   DirectoryName("Legal*") or
24722.   DirectoryName("Linquistics*") or
24723.   DirectoryName("Media*") or
24724.   DirectoryName("Multimedia*") or
24725.   DirectoryName("Reference*") or
24726.   DirectoryName("Sales*") or
24727.   DirectoryName("Science*") or
24728.   DirectoryName("Social*") or
24729.   DirectoryName("Technology*")
24730. )
24731. # Reference end.
24732. 
24733. # Reference
24734. )
24735. # Reference end.
24736. 
24737. 	# Zone
24738. # File Select
24739. 	# File Booleans
24740. 	# Resume...
24741. # File Action - SortByName.
24742. 
24743. FileActions
24744. 
24745. 		/* ---------------------------------------------------------- */
24746. 	# Gap
24747. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
24748. 		# FILE STEP
24749. 
24750. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
24751. 
24752. /* add message and move to a new line. */
24753. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
24754. ")
24755. 
24756. /* display the line. (hopefully.) */
24757. # Zone Footer Set Statistics Window Text
24758. 
24759. SetStatisticsWindowText("----------------------------------------------------------
24760. Zones Processed: 
24761. ----------------------------------------------------------
24762. !ZoneListByLine!
24763. ----------------------------------------------------------
24764. Zone Processing Step:
24765. !ZoneStepByLine!    
24766. ----------------------------------------------------------
24767. Current Zone:
24768. !ZoneFooter!
24769. ----------------------------------------------------------
24770. Volume Statistics:
24771. !VolumeStatisticsDetail!
24772. ----------------------------------------------------------
24773. Zone Detailed Report:
24774. ----------------------------------------------------------
24775. !ZoneStatisticsDetail!
24776. ----------------------------------------------------------
24777. ")
24778. 
24779. 
24780. 
24781. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
24782. 
24783. # BANNER SET
24784. 
24785. # DATE TIME RUN ELP
24786. 
24787. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:18 0:00:04")
24788. /* Xinclude "..\BannerSet.MyDc"X */
24789. /* pause(1) */
24790. 
24791. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
24792. 
24793. Title('!Heading!')
24794. /* pause(1) */
24795. 
24796. /* NOTE: Can't round or truncate to integer precision. */
24797. 
24798. pause(1)
24799. 	
24800. 	# ACTUAL GAP
24801. 		/* AddGap Variant. */
24802. 	  	# Zone Do Gap
24803. # Gap Calculation Methods:
24804. 
24805. /* 1) Anything you need to add first. */
24806. /* empty */
24807. 
24808. /* ---------------------------------------------------------- */
24809. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
24810. 	# GapRequestedStd.
24811. 
24812. 		/* ---------------------------------------------------------- */
24813. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
24814. 
24815. 		# Gap Calculation Methods:
24816. 
24817. /* AddGap Variants */
24818. 
24819. 	/* Standard */
24820. 		# Gap Calculation Methods:
24821. 	/* AddGap Variants */
24822. 	/* Standard */
24823. 
24824. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
24825. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
24826. 
24827. 	SetVariable(GapRequested, GapRequestedStd)
24828. 	
24829. 
24830. 	/* MFT Low High Method */
24831. 		# Gap Calculation Methods:
24832. 	/* AddGap Variants */
24833. 	/* MFT Low High Method */
24834. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
24835. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
24836. 	SetVariable(GapRequested, GapRequestedMft)
24837. 	
24838. 
24839. 	/* OS Volume Type Method */
24840. 		# Gap Calculation Methods:
24841. 	/* AddGap Variants */
24842. 	/* OS Volume Type Method */
24843. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
24844. 	SetVariable(GapRequested, GapRequestedOs)
24845. 
24846. 
24847. 
24848. /* MakeGap Variants */
24849. 
24850. 	/* Original Os 1-3 + MFT 2 */
24851. 		# Gap Calculation Methods:
24852. 	/* MakeGap Variants */
24853. 	/* Original Os 1-3 + MFT 2 */
24854. 	/* plus MFT gap placed inline at the dividing zone. */
24855. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
24856. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
24857. 	SetVariable(GapRequested, GapRequestedOrig)
24858. 	
24859. 	
24860. /* Note: You could comment out the ones not in use */
24861. /* However having the data in the log is useful. */
24862. /* Therefore the following line is otherwise needed. */
24863. 
24864. /* Standard used */
24865. 
24866. SetVariable(GapRequested, GapRequestedStd)
24867. 
24868. # Gap Calculation Methods:
24869. 
24870. /* AddGap Variants */
24871. 	/* Standard */
24872. 	/* MFT Low High Method */
24873. 	/* OS Volume Type Method */
24874. 
24875. /* MakeGap Variants */
24876. 	/* Original Os 1-3 + MFT 2 */
24877. 
24878. /* Note: You could comment out the ones not in use */
24879. /* However having the data in the log is useful. */
24880. /* Therefore the following line is otherwise needed. */
24881. 
24882. /* Standard is used currently */
24883. 
24884. 
24885. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
24886. 
24887. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
24888. 
24889. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
24890. 
24891. /* ---------------------------------------------------------- */
24892. /* 3) SMALL ZONE ADJUSTMENT. */
24893. /* Gab cant be larger than half the Zone Size. */
24894. 
24895. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
24896. 	
24897. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
24898. 
24899. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
24900. 
24901. /* ---------------------------------------------------------- */
24902. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
24903. # Gap Adjustments.
24904. 
24905. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
24906. 	
24907. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
24908. 
24909. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
24910. 
24911. /* ---------------------------------------------------------- */
24912. # BYPASS THIS.
24913. 	/* This is definitely wrong. */
24914. 	/* The question is can we steal gap from the next zone */
24915. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
24916. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
24917. 		# Zone Overflow.
24918. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
24919. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
24920. 
24921. /* ---------------------------------------------------------- */
24922. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
24923. # Remaining free space available.
24924. 
24925. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
24926. 	
24927. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
24928. 
24929. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
24930. 
24931. /* ---------------------------------------------------------- */
24932. # CURRENT gap to use.
24933. 
24934. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
24935. 
24936. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
24937. 
24938. /* ---------------------------------------------------------- */
24939. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
24940. # Debugging.
24941. 
24942. 	SetVariable(GapUsed, GapCurrent) // for debugging
24943. 
24944. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
24945. 
24946. 		# Your code HERE
24947. 
24948. /* ---------------------------------------------------------- */
24949. /* 7) YOUR CODE. */
24950. # YOUR CODE HERE:
24951. 	# INPUT: GapCurrent or GapCurrentLoc
24952. 	# OUTPUT: GapUsed...
24953. 
24954. /* ---------------------------------------------------------- */
24955. # Gap Size.
24956. # Actual Size of Gap.
24957. 
24958. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
24959. 
24960. /* ---------------------------------------------------------- */
24961. /* xxxxxxxxxxxxxxxxxxxxxx */
24962. # ADD THE GAP
24963. 	/* Xinclude "..\GapCommandDo.MyDc"X */
24964. /* xxxxxxxxxxxxxxxxxxxxxx */
24965. 
24966. 	
24967. 	# Zone Statistics	
24968. 	# Zone / Volume Statistics and Display
24969. 		
24970. 	# Accumulate Totals
24971.   	# Volume totals
24972. 
24973. /* Current total space used (by Zones and Gaps) */
24974. 
24975. SetVariable(VolumeZoneUsed, GapUsed)
24976. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
24977. /* Percentage */
24978. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
24979. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
24980. 
24981. /* Current total of free space requested */
24982. 
24983. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
24984. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
24985. /* Percent. */
24986. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
24987. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
24988. 
24989. /* Current total of free space used */
24990. 
24991. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
24992. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
24993. /* Percent */
24994. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
24995. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
24996. 
24997. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
24998. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
24999. /* Xinclude "..\DebugDisplayPause.MyDc"X */
25000. 
25001. 
25002. 	# Current Values
25003. 	# Cluster, Sector, Block adjust for display.
25004. 	# Bytes per cluster is volume specific.
25005. 
25006. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
25007. 
25008. # Current Zone values.
25009. 	# Begin, end and size.
25010. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
25011. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
25012. 
25013. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
25014. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
25015. 
25016. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
25017. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
25018. 
25019. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
25020. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
25021. 
25022. 	SetVariable(ZoneFragments,				"!ZONE210N!")
25023. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
25024. 		
25025. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
25026. /* identical code to here: (separation not needed. TEST.) */	
25027. 
25028. # Current Gap, Actual and Free Values
25029. 	# Gap
25030. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
25031. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
25032. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
25033. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
25034. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
25035. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
25036. 	
25037. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
25038. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
25039. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
25040. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
25041. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
25042. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
25043. 	
25044. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
25045. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
25046. 	
25047. 	# Actual Size and End
25048. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
25049. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
25050. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
25051. 	
25052. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
25053. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
25054. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
25055. 
25056. # Gap Size & Rounding
25057. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
25058. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
25059. 	
25060. 	# Free Space
25061. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
25062. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
25063. 
25064. 	# Footer:
25065. SetVariable(ZoneFooter, "----------------------------------------------------------
25066. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:19
25067. 
25068. Statistics Report:
25069. ------------------
25070.    Size:  
25071.    ------------------------
25072.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
25073.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
25074.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
25075. 
25076.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
25077.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
25078. 
25079.    Location:
25080.    ------------------------
25081.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
25082.              Files End: !ZoneEndCurrent!
25083.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
25084.       
25085.    Gap Settings:
25086.    ------------------------
25087.          Gap Requested: !ZoneGapSizePer!%
25088.       Volume Rounding: !ZoneVolRoundUpPer!%
25089.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
25090.                  
25091.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
25092.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
25093.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
25094.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
25095.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
25096.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
25097.      
25098.    Free Space after Zone:
25099.    ------------------------
25100.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
25101.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
25102.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
25103. 
25104. Directory and Files Select:
25105. ---------------------------
25106. !ZoneTypeSelectCurrent!               
25107. ---------------------------
25108. ----------------------------------------------------------
25109. ")
25110. 	# Zone Footer Set Statistics Window Text
25111. 
25112. SetStatisticsWindowText("----------------------------------------------------------
25113. Zones Processed: 
25114. ----------------------------------------------------------
25115. !ZoneListByLine!
25116. ----------------------------------------------------------
25117. Zone Processing Step:
25118. !ZoneStepByLine!    
25119. ----------------------------------------------------------
25120. Current Zone:
25121. !ZoneFooter!
25122. ----------------------------------------------------------
25123. Volume Statistics:
25124. !VolumeStatisticsDetail!
25125. ----------------------------------------------------------
25126. Zone Detailed Report:
25127. ----------------------------------------------------------
25128. !ZoneStatisticsDetail!
25129. ----------------------------------------------------------
25130. ")
25131. 
25132. 
25133. 	
25134.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
25135. 
25136. 	# Add Zone to list of zones for display.
25137. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
25138. 
25139. 	# Footer:
25140. SetVariable(ZoneFooter, "----------------------------------------------------------
25141. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:19
25142. 
25143. Statistics Report:
25144. ------------------
25145.    Size:  
25146.    ------------------------
25147.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
25148.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
25149.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
25150. 
25151.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
25152.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
25153. 
25154.    Location:
25155.    ------------------------
25156.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
25157.              Files End: !ZoneEndCurrent!
25158.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
25159.       
25160.    Gap Settings:
25161.    ------------------------
25162.          Gap Requested: !ZoneGapSizePer!%
25163.       Volume Rounding: !ZoneVolRoundUpPer!%
25164.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
25165.                  
25166.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
25167.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
25168.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
25169.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
25170.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
25171.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
25172.      
25173.    Free Space after Zone:
25174.    ------------------------
25175.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
25176.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
25177.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
25178. 
25179. Directory and Files Select:
25180. ---------------------------
25181. !ZoneTypeSelectCurrent!               
25182. ---------------------------
25183. ----------------------------------------------------------
25184. ")
25185. 
25186. 	# Add Zone Details to Report.	
25187. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
25188. !ZoneFooter!")
25189. 
25190. 
25191. 
25192. 	# DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
25193. 		/* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
25194. 		/* Xinclude "..\DebugDisplayPause.MyDc"X */
25195. 
25196.   	# Zone Statistics	
25197.   	/* Xinclude "..\ZoneDoStatistics.MyDc"X */
25198. 
25199. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
25200. 	# FILE STEP
25201. 
25202. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25203. 
25204. /* add message and move to a new line. */
25205. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
25206. ")
25207. 
25208. /* display the line. (hopefully.) */
25209. # Zone Footer Set Statistics Window Text
25210. 
25211. SetStatisticsWindowText("----------------------------------------------------------
25212. Zones Processed: 
25213. ----------------------------------------------------------
25214. !ZoneListByLine!
25215. ----------------------------------------------------------
25216. Zone Processing Step:
25217. !ZoneStepByLine!    
25218. ----------------------------------------------------------
25219. Current Zone:
25220. !ZoneFooter!
25221. ----------------------------------------------------------
25222. Volume Statistics:
25223. !VolumeStatisticsDetail!
25224. ----------------------------------------------------------
25225. Zone Detailed Report:
25226. ----------------------------------------------------------
25227. !ZoneStatisticsDetail!
25228. ----------------------------------------------------------
25229. ")
25230. 
25231. 
25232. 
25233. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
25234. 
25235. # BANNER SET
25236. 
25237. # DATE TIME RUN ELP
25238. 
25239. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
25240. /* Xinclude "..\BannerSet.MyDc"X */
25241. /* pause(1) */
25242. 
25243. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
25244. 
25245. Title('!Heading!')
25246. /* pause(1) */
25247. 
25248. /* NOTE: Can't round or truncate to integer precision. */
25249. 
25250. pause(1)
25251. 
25252. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
25253. 	
25254. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
25255. 	# FILE STEP
25256. 
25257. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25258. 
25259. /* add message and move to a new line. */
25260. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
25261. ")
25262. 
25263. /* display the line. (hopefully.) */
25264. # Zone Footer Set Statistics Window Text
25265. 
25266. SetStatisticsWindowText("----------------------------------------------------------
25267. Zones Processed: 
25268. ----------------------------------------------------------
25269. !ZoneListByLine!
25270. ----------------------------------------------------------
25271. Zone Processing Step:
25272. !ZoneStepByLine!    
25273. ----------------------------------------------------------
25274. Current Zone:
25275. !ZoneFooter!
25276. ----------------------------------------------------------
25277. Volume Statistics:
25278. !VolumeStatisticsDetail!
25279. ----------------------------------------------------------
25280. Zone Detailed Report:
25281. ----------------------------------------------------------
25282. !ZoneStatisticsDetail!
25283. ----------------------------------------------------------
25284. ")
25285. 
25286. 
25287. 
25288. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
25289. 
25290. # BANNER SET
25291. 
25292. # DATE TIME RUN ELP
25293. 
25294. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
25295. /* Xinclude "..\BannerSet.MyDc"X */
25296. /* pause(1) */
25297. 
25298. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
25299. 
25300. Title('!Heading!')
25301. /* pause(1) */
25302. 
25303. /* NOTE: Can't round or truncate to integer precision. */
25304. 
25305. pause(1)
25306. 
25307. 	# Footer next...
25308. 	
25309. 	# Zone Do Footer
25310. 
25311. /* ---------------------------------------------------------- */
25312. # File Select
25313. 	# Select Statments
25314. # File Actions 
25315. 	# Standard or OS File Actions.
25316. 	# Resume...
25317. 	
25318. 	# your stuff HERE (X)... post zone (file) file actions code.
25319. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
25320. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
25321. 		# (X)
25322. 		
25323. 		/* ??? Set window? */
25324. 	
25325. 	# ADD THE GAP
25326. 		
25327. # Vacate (good for diagnostics)
25328. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
25329. 
25330. # DoNotVacate - DO NOT Vacate (recommended)
25331. 
25332. # Vacate
25333. /* AddGap(GapUsedLoc) */
25334. 
25335. # DO Not Vacate
25336. AddGap(GapUsedLoc, DoNotVacate) 
25337. 	
25338. 	
25339. /* ---------------------------------------------------------- */
25340. # (failed) TEST for boolean logic.
25341. 
25342. /* It should work in the gap calculations for turning options */
25343. /* on and off but it will NOT work here. */
25344. 
25345. /* Boolean setting X or FlagX. */
25346. /* Where X will be on or off: */
25347. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
25348. /*      For ON:  (X  *  FlagAny) */
25349. 
25350. /* 1) Failed, zero gap overrode the previous one. */
25351. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
25352. /* AddGap(GapUsedTemp) */ 
25353. 
25354. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
25355. /* AddGap(GapUsedTemp, DoNotVacate) */ 
25356. 
25357. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
25358. 
25359. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
25360. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
25361. /* AddGap(GapUsedTemp) */ 
25362. 
25363. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
25364. /* AddGap(GapUsedTemp, DoNotVacate) */ 
25365. 
25366. /* ---------------------------------------------------------- */
25367. 
25368. # Vacate
25369. /* AddGap(GapUsed) */
25370. 
25371. # DO NOT Vacate (recommended)
25372. /* AddGap(GapUsed, DoNotVacate) */ 
25373. 	
25374. 
25375. 		
25376. # 
25377. FileEnd
25378. /* ---------------------------------------------------------- */
25379. 
25380. # your stuff HERE (X)... post zone (file) code.
25381. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
25382. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
25383. 	# (X)
25384. 
25385. SetVariable(FileStepDescription,"Zone finished, reporting.")
25386. # FILE STEP
25387. 
25388. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25389. 
25390. /* add message and move to a new line. */
25391. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
25392. ")
25393. 
25394. /* display the line. (hopefully.) */
25395. # Zone Footer Set Statistics Window Text
25396. 
25397. SetStatisticsWindowText("----------------------------------------------------------
25398. Zones Processed: 
25399. ----------------------------------------------------------
25400. !ZoneListByLine!
25401. ----------------------------------------------------------
25402. Zone Processing Step:
25403. !ZoneStepByLine!    
25404. ----------------------------------------------------------
25405. Current Zone:
25406. !ZoneFooter!
25407. ----------------------------------------------------------
25408. Volume Statistics:
25409. !VolumeStatisticsDetail!
25410. ----------------------------------------------------------
25411. Zone Detailed Report:
25412. ----------------------------------------------------------
25413. !ZoneStatisticsDetail!
25414. ----------------------------------------------------------
25415. ")
25416. 
25417. 
25418. 
25419. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
25420. 
25421. # BANNER SET
25422. 
25423. # DATE TIME RUN ELP
25424. 
25425. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
25426. /* Xinclude "..\BannerSet.MyDc"X */
25427. /* pause(1) */
25428. 
25429. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
25430. 
25431. Title('!Heading!')
25432. /* pause(1) */
25433. 
25434. /* NOTE: Can't round or truncate to integer precision. */
25435. 
25436. pause(1)
25437. 
25438. # Zone When Finished
25439. 
25440. # BANNER SET
25441. 
25442. # DATE TIME RUN ELP
25443. 
25444. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
25445. /* Xinclude "..\BannerSet.MyDc"X */
25446. /* pause(1) */
25447. 
25448. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
25449. 
25450. Title('!Heading!')
25451. /* pause(1) */
25452. 
25453. /* NOTE: Can't round or truncate to integer precision. */
25454. 
25455. AppendLogfile("!LogFileName!", "!Title!")
25456. 
25457. 
25458. 
25459. # Zone Statistics	
25460. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
25461. 
25462. # Footer:
25463. SetVariable(ZoneFooter, "----------------------------------------------------------
25464. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:19
25465. 
25466. Statistics Report:
25467. ------------------
25468.    Size:  
25469.    ------------------------
25470.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
25471.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
25472.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
25473. 
25474.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
25475.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
25476. 
25477.    Location:
25478.    ------------------------
25479.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
25480.              Files End: !ZoneEndCurrent!
25481.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
25482.       
25483.    Gap Settings:
25484.    ------------------------
25485.          Gap Requested: !ZoneGapSizePer!%
25486.       Volume Rounding: !ZoneVolRoundUpPer!%
25487.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
25488.                  
25489.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
25490.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
25491.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
25492.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
25493.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
25494.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
25495.      
25496.    Free Space after Zone:
25497.    ------------------------
25498.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
25499.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
25500.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
25501. 
25502. Directory and Files Select:
25503. ---------------------------
25504. !ZoneTypeSelectCurrent!               
25505. ---------------------------
25506. ----------------------------------------------------------
25507. ")
25508. 
25509. AppendLogfile("!LogFileName!", ".")
25510. AppendLogfile("!LogFileName!", "!ZoneFooter!")
25511. AppendLogfile("!LogFileName!", ".")
25512. 
25513. # Zone Footer Set Statistics Window Text
25514. 
25515. SetStatisticsWindowText("----------------------------------------------------------
25516. Zones Processed: 
25517. ----------------------------------------------------------
25518. !ZoneListByLine!
25519. ----------------------------------------------------------
25520. Zone Processing Step:
25521. !ZoneStepByLine!    
25522. ----------------------------------------------------------
25523. Current Zone:
25524. !ZoneFooter!
25525. ----------------------------------------------------------
25526. Volume Statistics:
25527. !VolumeStatisticsDetail!
25528. ----------------------------------------------------------
25529. Zone Detailed Report:
25530. ----------------------------------------------------------
25531. !ZoneStatisticsDetail!
25532. ----------------------------------------------------------
25533. ")
25534. 
25535. 
25536. 
25537. /* pause() */
25538. /* pause() */
25539. 
25540. 
25541. 
25542. 
25543. /* ---------------------------------------------------------- */
25544. 
25545. 
25546. /* ---------------------------------------------------------- */
25547. /* Zone SpaceHogs (BLOBS) */
25548. /* ---------------------------------------------------------- */
25549. /* Zone SpaceHogs (BLOBS) */
25550. SetVariable(ZoneLabel, "!ZoneLabelSpaceHogs!")
25551. SetVariable(ZoneDescription, "!ZoneDescriptionSpaceHogs!")
25552. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpSpaceHogs!")
25553. SetVariable(ZoneGapSize, "!ZoneGapSizeSpaceHogs!")
25554. SetVariable(ZoneTypeSelect,'# SpaceHogs start.
25555. not(
25556. # Archives start.
25557. (
25558.   DirectoryName("*Archive*")
25559.   or DirectoryName("*History*")
25560.   or DirectoryName("*Old")
25561.   or DirectoryName("* Old *")
25562.   or DirectoryName("Old *")
25563. 
25564.   or FileName("*.7z")
25565.   or FileName("*.cab")
25566.   or FileName("*.iso")
25567.   or FileName("*.msi")
25568.   or FileName("*.old")
25569.   or FileName("*.rar")
25570.   or FileName("*.tar")
25571.   or FileName("*.zip")
25572.   or
25573. # WinSysLow start.
25574. (
25575.   DirectoryName("$*")
25576.   or DirectoryName("0*")
25577.   or DirectoryName("1*")
25578.   or DirectoryName("2*")
25579.   or DirectoryName("3*")
25580.   or DirectoryName("4*")
25581.   or DirectoryName("5*")
25582.   or DirectoryName("6*")
25583.   or DirectoryName("7*")
25584.   or DirectoryName("8*")
25585.   or DirectoryName("9*")
25586. 
25587.   or DirectoryName("dllcache")
25588.   or DirectoryName("Downloaded Installations")
25589.   or DirectoryName("Ehome")
25590.   or DirectoryName("Fonts")
25591.   or DirectoryName("Help")
25592.   or DirectoryName("I386")
25593.   or DirectoryName("ie?updates")
25594.   or DirectoryName("Installer")
25595.   or DirectoryName("Installshield Installation Information")
25596.   or DirectoryName("IME")
25597.   or DirectoryName("*RECYCLE*")
25598.   or DirectoryName("ServicePackFiles")
25599.   or DirectoryName("SoftwareDistribution")
25600.   or DirectoryName("Speech")
25601.   or DirectoryName("Symbols")
25602.   or DirectoryName("System Volume Information")
25603.   or DirectoryName("windows.old")
25604. )
25605. # WinSysLow end.
25606. 
25607.   # Archives
25608. )
25609. # Archives end.
25610. 
25611. or 
25612. # Backups start.
25613. (
25614.   DirectoryName("*Backup*")
25615.   or DirectoryName("*Bu")
25616.   or DirectoryName("* Bu *")
25617.   or DirectoryName("Bu *")
25618. 
25619.   or FileName("*.bak")
25620.   or FileName("* - Copy*")
25621. )
25622. # Backups end.
25623. 
25624. # SpaceHogs
25625. ) and (
25626. # Blobs start.
25627. (
25628. # BlobsAndExceptions start.
25629. ( not(
25630.   FileName("*.bat")
25631.   or FileName("*.css")
25632.   or FileName("*.dll")
25633.   or FileName("*.exe")
25634.   or FileName("*.htm*")
25635.   or FileName("*.jar")
25636.   or FileName("*.js")
25637.   or FileName("*.script")
25638.   or FileName("*.wsf")
25639.   or (
25640. # Databases start.
25641. (
25642.   FileName("*.crypt*")
25643.   or FileName("*.db*")
25644.   or FileName("*.rdb*")
25645.   or FileName("*.dc*")
25646.   or FileName("*.dict*")
25647.   or FileName("*.?db*")
25648.   or FileName("*.?rdb*")
25649.   or FileName("*.md*")
25650.   or FileName("*.myd")
25651.   or FileName("*.ndf")
25652.   or FileName("*.ns?")
25653.   or FileName("*.pab")
25654.   or FileName("*.pst")
25655.   or FileName("*.sd?*")
25656.   or FileName("*.sq**")
25657.   or FileName("*.tmd")
25658.   or FileName("*.tps")
25659.   or FileName("*.tr*")
25660. )
25661. # Databases end.
25662. 
25663.     # BlobsAndExceptions
25664.     or 
25665. # Data start.
25666. (
25667.   DirectoryName("Data*")
25668.   or DirectoryName("Device*")
25669.   or DirectoryName("Export*")
25670.   or DirectoryName("Import*")
25671.   or DirectoryName("Log*")
25672.   or DirectoryName("*Log")
25673.   or DirectoryName("Maintenance*")
25674.   or DirectoryName("Rec*")
25675.   or DirectoryName("Sales*")
25676.   or DirectoryName("Search*")
25677.   or DirectoryName("User*")
25678. )
25679. # Data end.
25680. 
25681.     # BlobsAndExceptions
25682.   )
25683. ) )
25684. # BlobsAndExceptions end.
25685. 
25686. # Blobs
25687. ) and (
25688.   Size(BlobFileSize,0)
25689.   or (
25690.     FileName("*.arj")
25691.     or FileName("*.bup")
25692.     or FileName("*.bz2")
25693.     or FileName("*.chm")
25694.     or FileName("*.dvr-ms")
25695.     or FileName("*.gz")
25696.     or FileName("*.ifo")
25697.     or FileName("*.lzh")
25698.     or FileName("*.pdf")
25699.     or FileName("*.rpm")
25700.     or FileName("*.wmv")
25701.     or FileName("*.vob")
25702.     or FileName("*.z")
25703.   ) 
25704. )
25705. # Blobs end.
25706. 
25707. # SpaceHogs
25708. ) 
25709. # SpaceHogs end.
25710. ')
25711. 
25712. /* Note: This should be all Blob Files but not archives and backups */
25713. /* It does not matter in my case because given the sorting the */
25714. /* "z Archive", "z Bu" and "z Backup" directories sort to the end. */
25715. 
25716. 	# Zone Do Header
25717. 
25718. # Zone When Started
25719. 
25720. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
25721. # Display Set Zone
25722. 
25723. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
25724. SetVariable(FileStepDescription,	"")
25725. 
25726. SetVariable(ZoneStepByLine, 			"Zone started.
25727. ")
25728. 
25729. # BANNER SET
25730. 
25731. # DATE TIME RUN ELP
25732. 
25733. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
25734. /* Xinclude "..\BannerSet.MyDc"X */
25735. /* pause(1) */
25736. 
25737. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
25738. 
25739. Title('!Heading!')
25740. /* pause(1) */
25741. 
25742. /* NOTE: Can't round or truncate to integer precision. */
25743. 
25744. AppendLogfile("!LogFileName!", "!Title!")
25745. 
25746. 
25747. 
25748. pause(1)
25749. 
25750. 
25751. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
25752. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
25753. 
25754. SetVariable(ZoneStepNoCurrent, 0)
25755. 
25756. 
25757. # Zone Do Current Clear
25758. 
25759. SetVariable(ZoneTypeSelectCurrent, 		"")
25760. 
25761. SetVariable(ZoneBeginCurrent, 			0)
25762. SetVariable(ZoneBeginPerCurrent, 		0)
25763. SetVariable(ZoneEndCurrent, 			0)
25764. SetVariable(ZoneEndPerCurrent, 			0)
25765. 
25766. SetVariable(ZoneSizeCurrent,			0)
25767. SetVariable(ZoneSizePerCurrent,			0)
25768. 
25769. SetVariable(ZoneGapRequestedCurrent,	0)
25770. SetVariable(ZoneGapRoundedCurrent, 		0)
25771. SetVariable(ZoneGapAdjustedCurrent, 	0)
25772. SetVariable(ZoneGapAvailableCurrent, 	0)
25773. SetVariable(ZoneGapCurrent,				0)
25774. SetVariable(ZoneGapUsedCurrent, 		0)
25775. 
25776. SetVariable(ZoneGapActualCurrent, 		0)
25777. SetVariable(ZoneGapActualPerCurrent, 	0)
25778. 
25779. SetVariable(ZoneSizeActual, 			0)
25780. SetVariable(ZoneSizeActualCurrent,		0)
25781. 
25782. SetVariable(ZoneEndActual, 				0)
25783. SetVariable(ZoneEndActualCurrent,		0)			
25784. SetVariable(ZoneSizeActualPerCurrent, 	0)
25785.       
25786. SetVariable(ZoneFilesFolders,			0)
25787. SetVariable(ZoneFilesFoldersPer,		0) 
25788. 
25789. SetVariable(ZoneFragments,				0)
25790. SetVariable(ZoneFragmentsPer,			0) 
25791. 		
25792. SetVariable(ZoneEndActualCurrent, 		0)
25793. SetVariable(ZoneEndActualPerCurrent, 	0)
25794. 
25795. # Gap Calculation Methodology:
25796. 	# Requested
25797. 	SetVariable(GapRequested, 			0) 
25798. 	SetVariable(GapRequestedStd, 		0) 
25799. 	SetVariable(GapRequestedMft, 		0) 
25800. 	SetVariable(GapRequestedOs, 		0) 
25801. 	SetVariable(GapRequestedOriginal, 	0) 
25802. 	
25803. 	# Gap Adjustments
25804. 	SetVariable(GapRounded, 			0)
25805. 	# SetVariable(GapAdjusted, 			0)
25806. 	SetVariable(GapAvailable, 			0)
25807. 	SetVariable(GapCurrent, 			0)
25808. 	SetVariable(GapActual, 				0)
25809. 	SetVariable(GapUsed, 				0)
25810. 	
25811. 	# Gap Adjustments
25812. 	SetVariable(GapRoundedLoc, 			0)
25813. 	# SetVariable(GapAdjustedLoc, 		0)
25814. 	SetVariable(GapAvailableLoc, 		0)
25815. 	SetVariable(GapCurrentLoc, 			0)
25816. 	SetVariable(GapActualLoc,			0)
25817. 	SetVariable(GapUsedLoc,				0)
25818. 	
25819. 	# Space usage
25820. 	SetVariable(ZoneFreePerRequested, 	0)
25821. 	SetVariable(ZoneFreePerUsed, 		0)
25822. 
25823. # Gap Size & Rounding
25824. 	SetVariable(ZoneGapSizePer, 		0)
25825. 	SetVariable(ZoneVolRoundUpPer, 		0)
25826. 	
25827. 	# Free Space
25828. 	SetVariable(ZoneFreeUsedPer, 		0)
25829. 	SetVariable(ZoneFreeRequestedPer, 	0)
25830. 
25831. 
25832. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
25833. 
25834. # Footer:
25835. SetVariable(ZoneFooter, "----------------------------------------------------------
25836. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:19
25837. 
25838. Statistics Report:
25839. ------------------
25840.    Size:  
25841.    ------------------------
25842.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
25843.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
25844.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
25845. 
25846.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
25847.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
25848. 
25849.    Location:
25850.    ------------------------
25851.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
25852.              Files End: !ZoneEndCurrent!
25853.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
25854.       
25855.    Gap Settings:
25856.    ------------------------
25857.          Gap Requested: !ZoneGapSizePer!%
25858.       Volume Rounding: !ZoneVolRoundUpPer!%
25859.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
25860.                  
25861.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
25862.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
25863.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
25864.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
25865.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
25866.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
25867.      
25868.    Free Space after Zone:
25869.    ------------------------
25870.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
25871.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
25872.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
25873. 
25874. Directory and Files Select:
25875. ---------------------------
25876. !ZoneTypeSelectCurrent!               
25877. ---------------------------
25878. ----------------------------------------------------------
25879. ")
25880. 
25881. # BANNER SET
25882. 
25883. # DATE TIME RUN ELP
25884. 
25885. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
25886. /* Xinclude "..\BannerSet.MyDc"X */
25887. /* pause(1) */
25888. 
25889. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
25890. 
25891. Title('!Heading!')
25892. /* pause(1) */
25893. 
25894. /* NOTE: Can't round or truncate to integer precision. */
25895. 
25896. AppendLogfile("!LogFileName!", "!Title!")
25897. 
25898. 
25899. 
25900. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
25901. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
25902. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:19")
25903. 
25904. SetVariable(ZoneListByLine, "!ZoneListByLine!
25905. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
25906. 
25907. 
25908. /* Fixed Zone Position Handling */
25909. /* Literal number: */
25910. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
25911. /* Percentage of disk: */
25912. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
25913. /* Gap */
25914. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
25915. 
25916. /* ---------------------------------------------------------- */
25917. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
25918. # FILE STEP
25919. 
25920. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
25921. 
25922. /* add message and move to a new line. */
25923. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
25924. ")
25925. 
25926. /* display the line. (hopefully.) */
25927. # Zone Footer Set Statistics Window Text
25928. 
25929. SetStatisticsWindowText("----------------------------------------------------------
25930. Zones Processed: 
25931. ----------------------------------------------------------
25932. !ZoneListByLine!
25933. ----------------------------------------------------------
25934. Zone Processing Step:
25935. !ZoneStepByLine!    
25936. ----------------------------------------------------------
25937. Current Zone:
25938. !ZoneFooter!
25939. ----------------------------------------------------------
25940. Volume Statistics:
25941. !VolumeStatisticsDetail!
25942. ----------------------------------------------------------
25943. Zone Detailed Report:
25944. ----------------------------------------------------------
25945. !ZoneStatisticsDetail!
25946. ----------------------------------------------------------
25947. ")
25948. 
25949. 
25950. 
25951. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
25952. 
25953. # BANNER SET
25954. 
25955. # DATE TIME RUN ELP
25956. 
25957. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
25958. /* Xinclude "..\BannerSet.MyDc"X */
25959. /* pause(1) */
25960. 
25961. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
25962. 
25963. Title('!Heading!')
25964. /* pause(1) */
25965. 
25966. /* NOTE: Can't round or truncate to integer precision. */
25967. 
25968. pause(1)
25969. 
25970. # your stuff HERE (X)... pre file select code.
25971. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
25972. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
25973. 	# (X)
25974. 
25975. FileSelect
25976. 
25977. 	# your stuff can't really go here (errors.)
25978. 	# maybe for some reason I don't know of...
25979. 	
25980. 	# Actions next...
25981. 	# SpaceHogs start.
25982. not(
25983. # Archives start.
25984. (
25985.   DirectoryName("*Archive*")
25986.   or DirectoryName("*History*")
25987.   or DirectoryName("*Old")
25988.   or DirectoryName("* Old *")
25989.   or DirectoryName("Old *")
25990. 
25991.   or FileName("*.7z")
25992.   or FileName("*.cab")
25993.   or FileName("*.iso")
25994.   or FileName("*.msi")
25995.   or FileName("*.old")
25996.   or FileName("*.rar")
25997.   or FileName("*.tar")
25998.   or FileName("*.zip")
25999.   or
26000. # WinSysLow start.
26001. (
26002.   DirectoryName("$*")
26003.   or DirectoryName("0*")
26004.   or DirectoryName("1*")
26005.   or DirectoryName("2*")
26006.   or DirectoryName("3*")
26007.   or DirectoryName("4*")
26008.   or DirectoryName("5*")
26009.   or DirectoryName("6*")
26010.   or DirectoryName("7*")
26011.   or DirectoryName("8*")
26012.   or DirectoryName("9*")
26013. 
26014.   or DirectoryName("dllcache")
26015.   or DirectoryName("Downloaded Installations")
26016.   or DirectoryName("Ehome")
26017.   or DirectoryName("Fonts")
26018.   or DirectoryName("Help")
26019.   or DirectoryName("I386")
26020.   or DirectoryName("ie?updates")
26021.   or DirectoryName("Installer")
26022.   or DirectoryName("Installshield Installation Information")
26023.   or DirectoryName("IME")
26024.   or DirectoryName("*RECYCLE*")
26025.   or DirectoryName("ServicePackFiles")
26026.   or DirectoryName("SoftwareDistribution")
26027.   or DirectoryName("Speech")
26028.   or DirectoryName("Symbols")
26029.   or DirectoryName("System Volume Information")
26030.   or DirectoryName("windows.old")
26031. )
26032. # WinSysLow end.
26033. 
26034.   # Archives
26035. )
26036. # Archives end.
26037. 
26038. or 
26039. # Backups start.
26040. (
26041.   DirectoryName("*Backup*")
26042.   or DirectoryName("*Bu")
26043.   or DirectoryName("* Bu *")
26044.   or DirectoryName("Bu *")
26045. 
26046.   or FileName("*.bak")
26047.   or FileName("* - Copy*")
26048. )
26049. # Backups end.
26050. 
26051. # SpaceHogs
26052. ) and (
26053. # Blobs start.
26054. (
26055. # BlobsAndExceptions start.
26056. ( not(
26057.   FileName("*.bat")
26058.   or FileName("*.css")
26059.   or FileName("*.dll")
26060.   or FileName("*.exe")
26061.   or FileName("*.htm*")
26062.   or FileName("*.jar")
26063.   or FileName("*.js")
26064.   or FileName("*.script")
26065.   or FileName("*.wsf")
26066.   or (
26067. # Databases start.
26068. (
26069.   FileName("*.crypt*")
26070.   or FileName("*.db*")
26071.   or FileName("*.rdb*")
26072.   or FileName("*.dc*")
26073.   or FileName("*.dict*")
26074.   or FileName("*.?db*")
26075.   or FileName("*.?rdb*")
26076.   or FileName("*.md*")
26077.   or FileName("*.myd")
26078.   or FileName("*.ndf")
26079.   or FileName("*.ns?")
26080.   or FileName("*.pab")
26081.   or FileName("*.pst")
26082.   or FileName("*.sd?*")
26083.   or FileName("*.sq**")
26084.   or FileName("*.tmd")
26085.   or FileName("*.tps")
26086.   or FileName("*.tr*")
26087. )
26088. # Databases end.
26089. 
26090.     # BlobsAndExceptions
26091.     or 
26092. # Data start.
26093. (
26094.   DirectoryName("Data*")
26095.   or DirectoryName("Device*")
26096.   or DirectoryName("Export*")
26097.   or DirectoryName("Import*")
26098.   or DirectoryName("Log*")
26099.   or DirectoryName("*Log")
26100.   or DirectoryName("Maintenance*")
26101.   or DirectoryName("Rec*")
26102.   or DirectoryName("Sales*")
26103.   or DirectoryName("Search*")
26104.   or DirectoryName("User*")
26105. )
26106. # Data end.
26107. 
26108.     # BlobsAndExceptions
26109.   )
26110. ) )
26111. # BlobsAndExceptions end.
26112. 
26113. # Blobs
26114. ) and (
26115.   Size(BlobFileSize,0)
26116.   or (
26117.     FileName("*.arj")
26118.     or FileName("*.bup")
26119.     or FileName("*.bz2")
26120.     or FileName("*.chm")
26121.     or FileName("*.dvr-ms")
26122.     or FileName("*.gz")
26123.     or FileName("*.ifo")
26124.     or FileName("*.lzh")
26125.     or FileName("*.pdf")
26126.     or FileName("*.rpm")
26127.     or FileName("*.wmv")
26128.     or FileName("*.vob")
26129.     or FileName("*.z")
26130.   ) 
26131. )
26132. # Blobs end.
26133. 
26134. # SpaceHogs
26135. ) 
26136. # SpaceHogs end.
26137. 
26138. 	# Zone
26139. # File Select
26140. 	# File Booleans
26141. 	# Resume...
26142. # File Action - SortByName.
26143. 
26144. FileActions
26145. 
26146. 		/* ---------------------------------------------------------- */
26147. 	# Gap
26148. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
26149. 		# FILE STEP
26150. 
26151. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26152. 
26153. /* add message and move to a new line. */
26154. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
26155. ")
26156. 
26157. /* display the line. (hopefully.) */
26158. # Zone Footer Set Statistics Window Text
26159. 
26160. SetStatisticsWindowText("----------------------------------------------------------
26161. Zones Processed: 
26162. ----------------------------------------------------------
26163. !ZoneListByLine!
26164. ----------------------------------------------------------
26165. Zone Processing Step:
26166. !ZoneStepByLine!    
26167. ----------------------------------------------------------
26168. Current Zone:
26169. !ZoneFooter!
26170. ----------------------------------------------------------
26171. Volume Statistics:
26172. !VolumeStatisticsDetail!
26173. ----------------------------------------------------------
26174. Zone Detailed Report:
26175. ----------------------------------------------------------
26176. !ZoneStatisticsDetail!
26177. ----------------------------------------------------------
26178. ")
26179. 
26180. 
26181. 
26182. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
26183. 
26184. # BANNER SET
26185. 
26186. # DATE TIME RUN ELP
26187. 
26188. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
26189. /* Xinclude "..\BannerSet.MyDc"X */
26190. /* pause(1) */
26191. 
26192. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
26193. 
26194. Title('!Heading!')
26195. /* pause(1) */
26196. 
26197. /* NOTE: Can't round or truncate to integer precision. */
26198. 
26199. pause(1)
26200. 	
26201. 	# ACTUAL GAP
26202. 		/* AddGap Variant. */
26203. 	  	# Zone Do Gap
26204. # Gap Calculation Methods:
26205. 
26206. /* 1) Anything you need to add first. */
26207. /* empty */
26208. 
26209. /* ---------------------------------------------------------- */
26210. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
26211. 	# GapRequestedStd.
26212. 
26213. 		/* ---------------------------------------------------------- */
26214. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
26215. 
26216. 		# Gap Calculation Methods:
26217. 
26218. /* AddGap Variants */
26219. 
26220. 	/* Standard */
26221. 		# Gap Calculation Methods:
26222. 	/* AddGap Variants */
26223. 	/* Standard */
26224. 
26225. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
26226. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
26227. 
26228. 	SetVariable(GapRequested, GapRequestedStd)
26229. 	
26230. 
26231. 	/* MFT Low High Method */
26232. 		# Gap Calculation Methods:
26233. 	/* AddGap Variants */
26234. 	/* MFT Low High Method */
26235. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
26236. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
26237. 	SetVariable(GapRequested, GapRequestedMft)
26238. 	
26239. 
26240. 	/* OS Volume Type Method */
26241. 		# Gap Calculation Methods:
26242. 	/* AddGap Variants */
26243. 	/* OS Volume Type Method */
26244. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
26245. 	SetVariable(GapRequested, GapRequestedOs)
26246. 
26247. 
26248. 
26249. /* MakeGap Variants */
26250. 
26251. 	/* Original Os 1-3 + MFT 2 */
26252. 		# Gap Calculation Methods:
26253. 	/* MakeGap Variants */
26254. 	/* Original Os 1-3 + MFT 2 */
26255. 	/* plus MFT gap placed inline at the dividing zone. */
26256. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
26257. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
26258. 	SetVariable(GapRequested, GapRequestedOrig)
26259. 	
26260. 	
26261. /* Note: You could comment out the ones not in use */
26262. /* However having the data in the log is useful. */
26263. /* Therefore the following line is otherwise needed. */
26264. 
26265. /* Standard used */
26266. 
26267. SetVariable(GapRequested, GapRequestedStd)
26268. 
26269. # Gap Calculation Methods:
26270. 
26271. /* AddGap Variants */
26272. 	/* Standard */
26273. 	/* MFT Low High Method */
26274. 	/* OS Volume Type Method */
26275. 
26276. /* MakeGap Variants */
26277. 	/* Original Os 1-3 + MFT 2 */
26278. 
26279. /* Note: You could comment out the ones not in use */
26280. /* However having the data in the log is useful. */
26281. /* Therefore the following line is otherwise needed. */
26282. 
26283. /* Standard is used currently */
26284. 
26285. 
26286. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
26287. 
26288. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
26289. 
26290. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
26291. 
26292. /* ---------------------------------------------------------- */
26293. /* 3) SMALL ZONE ADJUSTMENT. */
26294. /* Gab cant be larger than half the Zone Size. */
26295. 
26296. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
26297. 	
26298. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
26299. 
26300. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
26301. 
26302. /* ---------------------------------------------------------- */
26303. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
26304. # Gap Adjustments.
26305. 
26306. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
26307. 	
26308. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
26309. 
26310. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
26311. 
26312. /* ---------------------------------------------------------- */
26313. # BYPASS THIS.
26314. 	/* This is definitely wrong. */
26315. 	/* The question is can we steal gap from the next zone */
26316. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
26317. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
26318. 		# Zone Overflow.
26319. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
26320. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
26321. 
26322. /* ---------------------------------------------------------- */
26323. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
26324. # Remaining free space available.
26325. 
26326. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
26327. 	
26328. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
26329. 
26330. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
26331. 
26332. /* ---------------------------------------------------------- */
26333. # CURRENT gap to use.
26334. 
26335. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
26336. 
26337. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
26338. 
26339. /* ---------------------------------------------------------- */
26340. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
26341. # Debugging.
26342. 
26343. 	SetVariable(GapUsed, GapCurrent) // for debugging
26344. 
26345. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
26346. 
26347. 		# Your code HERE
26348. 
26349. /* ---------------------------------------------------------- */
26350. /* 7) YOUR CODE. */
26351. # YOUR CODE HERE:
26352. 	# INPUT: GapCurrent or GapCurrentLoc
26353. 	# OUTPUT: GapUsed...
26354. 
26355. /* ---------------------------------------------------------- */
26356. # Gap Size.
26357. # Actual Size of Gap.
26358. 
26359. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
26360. 
26361. /* ---------------------------------------------------------- */
26362. /* xxxxxxxxxxxxxxxxxxxxxx */
26363. # ADD THE GAP
26364. 	/* Xinclude "..\GapCommandDo.MyDc"X */
26365. /* xxxxxxxxxxxxxxxxxxxxxx */
26366. 
26367. 	
26368. 	# Zone Statistics	
26369. 	# Zone / Volume Statistics and Display
26370. 		
26371. 	# Accumulate Totals
26372.   	# Volume totals
26373. 
26374. /* Current total space used (by Zones and Gaps) */
26375. 
26376. SetVariable(VolumeZoneUsed, GapUsed)
26377. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
26378. /* Percentage */
26379. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
26380. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
26381. 
26382. /* Current total of free space requested */
26383. 
26384. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
26385. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
26386. /* Percent. */
26387. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
26388. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
26389. 
26390. /* Current total of free space used */
26391. 
26392. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
26393. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
26394. /* Percent */
26395. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
26396. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
26397. 
26398. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
26399. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
26400. /* Xinclude "..\DebugDisplayPause.MyDc"X */
26401. 
26402. 
26403. 	# Current Values
26404. 	# Cluster, Sector, Block adjust for display.
26405. 	# Bytes per cluster is volume specific.
26406. 
26407. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
26408. 
26409. # Current Zone values.
26410. 	# Begin, end and size.
26411. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
26412. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
26413. 
26414. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
26415. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
26416. 
26417. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
26418. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
26419. 
26420. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
26421. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
26422. 
26423. 	SetVariable(ZoneFragments,				"!ZONE210N!")
26424. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
26425. 		
26426. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
26427. /* identical code to here: (separation not needed. TEST.) */	
26428. 
26429. # Current Gap, Actual and Free Values
26430. 	# Gap
26431. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
26432. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
26433. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
26434. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
26435. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
26436. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
26437. 	
26438. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
26439. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
26440. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
26441. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
26442. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
26443. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
26444. 	
26445. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
26446. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
26447. 	
26448. 	# Actual Size and End
26449. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
26450. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
26451. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
26452. 	
26453. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
26454. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
26455. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
26456. 
26457. # Gap Size & Rounding
26458. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
26459. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
26460. 	
26461. 	# Free Space
26462. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
26463. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
26464. 
26465. 	# Footer:
26466. SetVariable(ZoneFooter, "----------------------------------------------------------
26467. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:19
26468. 
26469. Statistics Report:
26470. ------------------
26471.    Size:  
26472.    ------------------------
26473.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
26474.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
26475.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
26476. 
26477.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
26478.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
26479. 
26480.    Location:
26481.    ------------------------
26482.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
26483.              Files End: !ZoneEndCurrent!
26484.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
26485.       
26486.    Gap Settings:
26487.    ------------------------
26488.          Gap Requested: !ZoneGapSizePer!%
26489.       Volume Rounding: !ZoneVolRoundUpPer!%
26490.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
26491.                  
26492.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
26493.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
26494.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
26495.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
26496.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
26497.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
26498.      
26499.    Free Space after Zone:
26500.    ------------------------
26501.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
26502.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
26503.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
26504. 
26505. Directory and Files Select:
26506. ---------------------------
26507. !ZoneTypeSelectCurrent!               
26508. ---------------------------
26509. ----------------------------------------------------------
26510. ")
26511. 	# Zone Footer Set Statistics Window Text
26512. 
26513. SetStatisticsWindowText("----------------------------------------------------------
26514. Zones Processed: 
26515. ----------------------------------------------------------
26516. !ZoneListByLine!
26517. ----------------------------------------------------------
26518. Zone Processing Step:
26519. !ZoneStepByLine!    
26520. ----------------------------------------------------------
26521. Current Zone:
26522. !ZoneFooter!
26523. ----------------------------------------------------------
26524. Volume Statistics:
26525. !VolumeStatisticsDetail!
26526. ----------------------------------------------------------
26527. Zone Detailed Report:
26528. ----------------------------------------------------------
26529. !ZoneStatisticsDetail!
26530. ----------------------------------------------------------
26531. ")
26532. 
26533. 
26534. 	
26535.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
26536. 
26537. 	# Add Zone to list of zones for display.
26538. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
26539. 
26540. 	# Footer:
26541. SetVariable(ZoneFooter, "----------------------------------------------------------
26542. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:19
26543. 
26544. Statistics Report:
26545. ------------------
26546.    Size:  
26547.    ------------------------
26548.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
26549.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
26550.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
26551. 
26552.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
26553.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
26554. 
26555.    Location:
26556.    ------------------------
26557.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
26558.              Files End: !ZoneEndCurrent!
26559.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
26560.       
26561.    Gap Settings:
26562.    ------------------------
26563.          Gap Requested: !ZoneGapSizePer!%
26564.       Volume Rounding: !ZoneVolRoundUpPer!%
26565.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
26566.                  
26567.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
26568.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
26569.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
26570.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
26571.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
26572.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
26573.      
26574.    Free Space after Zone:
26575.    ------------------------
26576.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
26577.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
26578.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
26579. 
26580. Directory and Files Select:
26581. ---------------------------
26582. !ZoneTypeSelectCurrent!               
26583. ---------------------------
26584. ----------------------------------------------------------
26585. ")
26586. 
26587. 	# Add Zone Details to Report.	
26588. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
26589. !ZoneFooter!")
26590. 
26591. 
26592. 
26593. 	# DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
26594. 		/* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
26595. 		/* Xinclude "..\DebugDisplayPause.MyDc"X */
26596. 
26597.   	# Zone Statistics	
26598.   	/* Xinclude "..\ZoneDoStatistics.MyDc"X */
26599. 
26600. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
26601. 	# FILE STEP
26602. 
26603. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26604. 
26605. /* add message and move to a new line. */
26606. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
26607. ")
26608. 
26609. /* display the line. (hopefully.) */
26610. # Zone Footer Set Statistics Window Text
26611. 
26612. SetStatisticsWindowText("----------------------------------------------------------
26613. Zones Processed: 
26614. ----------------------------------------------------------
26615. !ZoneListByLine!
26616. ----------------------------------------------------------
26617. Zone Processing Step:
26618. !ZoneStepByLine!    
26619. ----------------------------------------------------------
26620. Current Zone:
26621. !ZoneFooter!
26622. ----------------------------------------------------------
26623. Volume Statistics:
26624. !VolumeStatisticsDetail!
26625. ----------------------------------------------------------
26626. Zone Detailed Report:
26627. ----------------------------------------------------------
26628. !ZoneStatisticsDetail!
26629. ----------------------------------------------------------
26630. ")
26631. 
26632. 
26633. 
26634. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
26635. 
26636. # BANNER SET
26637. 
26638. # DATE TIME RUN ELP
26639. 
26640. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
26641. /* Xinclude "..\BannerSet.MyDc"X */
26642. /* pause(1) */
26643. 
26644. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
26645. 
26646. Title('!Heading!')
26647. /* pause(1) */
26648. 
26649. /* NOTE: Can't round or truncate to integer precision. */
26650. 
26651. pause(1)
26652. 
26653. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
26654. 	
26655. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
26656. 	# FILE STEP
26657. 
26658. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26659. 
26660. /* add message and move to a new line. */
26661. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
26662. ")
26663. 
26664. /* display the line. (hopefully.) */
26665. # Zone Footer Set Statistics Window Text
26666. 
26667. SetStatisticsWindowText("----------------------------------------------------------
26668. Zones Processed: 
26669. ----------------------------------------------------------
26670. !ZoneListByLine!
26671. ----------------------------------------------------------
26672. Zone Processing Step:
26673. !ZoneStepByLine!    
26674. ----------------------------------------------------------
26675. Current Zone:
26676. !ZoneFooter!
26677. ----------------------------------------------------------
26678. Volume Statistics:
26679. !VolumeStatisticsDetail!
26680. ----------------------------------------------------------
26681. Zone Detailed Report:
26682. ----------------------------------------------------------
26683. !ZoneStatisticsDetail!
26684. ----------------------------------------------------------
26685. ")
26686. 
26687. 
26688. 
26689. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
26690. 
26691. # BANNER SET
26692. 
26693. # DATE TIME RUN ELP
26694. 
26695. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
26696. /* Xinclude "..\BannerSet.MyDc"X */
26697. /* pause(1) */
26698. 
26699. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
26700. 
26701. Title('!Heading!')
26702. /* pause(1) */
26703. 
26704. /* NOTE: Can't round or truncate to integer precision. */
26705. 
26706. pause(1)
26707. 
26708. 	# Footer next...
26709. 	
26710. 	# Zone Do Footer
26711. 
26712. /* ---------------------------------------------------------- */
26713. # File Select
26714. 	# Select Statments
26715. # File Actions 
26716. 	# Standard or OS File Actions.
26717. 	# Resume...
26718. 	
26719. 	# your stuff HERE (X)... post zone (file) file actions code.
26720. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
26721. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
26722. 		# (X)
26723. 		
26724. 		/* ??? Set window? */
26725. 	
26726. 	# ADD THE GAP
26727. 		
26728. # Vacate (good for diagnostics)
26729. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
26730. 
26731. # DoNotVacate - DO NOT Vacate (recommended)
26732. 
26733. # Vacate
26734. /* AddGap(GapUsedLoc) */
26735. 
26736. # DO Not Vacate
26737. AddGap(GapUsedLoc, DoNotVacate) 
26738. 	
26739. 	
26740. /* ---------------------------------------------------------- */
26741. # (failed) TEST for boolean logic.
26742. 
26743. /* It should work in the gap calculations for turning options */
26744. /* on and off but it will NOT work here. */
26745. 
26746. /* Boolean setting X or FlagX. */
26747. /* Where X will be on or off: */
26748. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
26749. /*      For ON:  (X  *  FlagAny) */
26750. 
26751. /* 1) Failed, zero gap overrode the previous one. */
26752. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
26753. /* AddGap(GapUsedTemp) */ 
26754. 
26755. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
26756. /* AddGap(GapUsedTemp, DoNotVacate) */ 
26757. 
26758. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
26759. 
26760. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
26761. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
26762. /* AddGap(GapUsedTemp) */ 
26763. 
26764. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
26765. /* AddGap(GapUsedTemp, DoNotVacate) */ 
26766. 
26767. /* ---------------------------------------------------------- */
26768. 
26769. # Vacate
26770. /* AddGap(GapUsed) */
26771. 
26772. # DO NOT Vacate (recommended)
26773. /* AddGap(GapUsed, DoNotVacate) */ 
26774. 	
26775. 
26776. 		
26777. # 
26778. FileEnd
26779. /* ---------------------------------------------------------- */
26780. 
26781. # your stuff HERE (X)... post zone (file) code.
26782. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
26783. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
26784. 	# (X)
26785. 
26786. SetVariable(FileStepDescription,"Zone finished, reporting.")
26787. # FILE STEP
26788. 
26789. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
26790. 
26791. /* add message and move to a new line. */
26792. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
26793. ")
26794. 
26795. /* display the line. (hopefully.) */
26796. # Zone Footer Set Statistics Window Text
26797. 
26798. SetStatisticsWindowText("----------------------------------------------------------
26799. Zones Processed: 
26800. ----------------------------------------------------------
26801. !ZoneListByLine!
26802. ----------------------------------------------------------
26803. Zone Processing Step:
26804. !ZoneStepByLine!    
26805. ----------------------------------------------------------
26806. Current Zone:
26807. !ZoneFooter!
26808. ----------------------------------------------------------
26809. Volume Statistics:
26810. !VolumeStatisticsDetail!
26811. ----------------------------------------------------------
26812. Zone Detailed Report:
26813. ----------------------------------------------------------
26814. !ZoneStatisticsDetail!
26815. ----------------------------------------------------------
26816. ")
26817. 
26818. 
26819. 
26820. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
26821. 
26822. # BANNER SET
26823. 
26824. # DATE TIME RUN ELP
26825. 
26826. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
26827. /* Xinclude "..\BannerSet.MyDc"X */
26828. /* pause(1) */
26829. 
26830. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
26831. 
26832. Title('!Heading!')
26833. /* pause(1) */
26834. 
26835. /* NOTE: Can't round or truncate to integer precision. */
26836. 
26837. pause(1)
26838. 
26839. # Zone When Finished
26840. 
26841. # BANNER SET
26842. 
26843. # DATE TIME RUN ELP
26844. 
26845. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
26846. /* Xinclude "..\BannerSet.MyDc"X */
26847. /* pause(1) */
26848. 
26849. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
26850. 
26851. Title('!Heading!')
26852. /* pause(1) */
26853. 
26854. /* NOTE: Can't round or truncate to integer precision. */
26855. 
26856. AppendLogfile("!LogFileName!", "!Title!")
26857. 
26858. 
26859. 
26860. # Zone Statistics	
26861. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
26862. 
26863. # Footer:
26864. SetVariable(ZoneFooter, "----------------------------------------------------------
26865. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:19
26866. 
26867. Statistics Report:
26868. ------------------
26869.    Size:  
26870.    ------------------------
26871.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
26872.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
26873.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
26874. 
26875.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
26876.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
26877. 
26878.    Location:
26879.    ------------------------
26880.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
26881.              Files End: !ZoneEndCurrent!
26882.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
26883.       
26884.    Gap Settings:
26885.    ------------------------
26886.          Gap Requested: !ZoneGapSizePer!%
26887.       Volume Rounding: !ZoneVolRoundUpPer!%
26888.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
26889.                  
26890.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
26891.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
26892.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
26893.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
26894.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
26895.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
26896.      
26897.    Free Space after Zone:
26898.    ------------------------
26899.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
26900.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
26901.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
26902. 
26903. Directory and Files Select:
26904. ---------------------------
26905. !ZoneTypeSelectCurrent!               
26906. ---------------------------
26907. ----------------------------------------------------------
26908. ")
26909. 
26910. AppendLogfile("!LogFileName!", ".")
26911. AppendLogfile("!LogFileName!", "!ZoneFooter!")
26912. AppendLogfile("!LogFileName!", ".")
26913. 
26914. # Zone Footer Set Statistics Window Text
26915. 
26916. SetStatisticsWindowText("----------------------------------------------------------
26917. Zones Processed: 
26918. ----------------------------------------------------------
26919. !ZoneListByLine!
26920. ----------------------------------------------------------
26921. Zone Processing Step:
26922. !ZoneStepByLine!    
26923. ----------------------------------------------------------
26924. Current Zone:
26925. !ZoneFooter!
26926. ----------------------------------------------------------
26927. Volume Statistics:
26928. !VolumeStatisticsDetail!
26929. ----------------------------------------------------------
26930. Zone Detailed Report:
26931. ----------------------------------------------------------
26932. !ZoneStatisticsDetail!
26933. ----------------------------------------------------------
26934. ")
26935. 
26936. 
26937. 
26938. /* pause() */
26939. /* pause() */
26940. 
26941. 
26942. 
26943. 
26944. /* ---------------------------------------------------------- */
26945. 
26946. 
26947. /* ---------------------------------------------------------- */
26948. /* Zone ArchivesBu (All) Archives and Backups*/
26949. /* ---------------------------------------------------------- */
26950. /* Zone ArchivesBu (All) Archives and Backups*/
26951. 
26952. SetVariable(ZoneLabel, "!ZoneLabelArchivesBu!")
26953. SetVariable(ZoneDescription, "!ZoneDescriptionArchivesBu!")
26954. SetVariable(ZoneVolRoundUp, "!ZoneVolRoundUpArchivesBu!")
26955. SetVariable(ZoneGapSize, "!ZoneGapSizeArchivesBu!")
26956. SetVariable(ZoneTypeSelect,'# ArchivesBu start.
26957. all
26958. # ArchivesBu end.
26959. ')
26960. 
26961. /* Note: This should be all Blob archives and backups */
26962. /* The sorting the "z Archive", "z Bu" and "z Backup" directories */
26963. /* sort to the very end of the Volume. */
26964. 
26965. 	# Zone Do Header
26966. 
26967. # Zone When Started
26968. 
26969. SetVariable(FileStepDescription, "!FileStepDescriptionZoneStart!")
26970. # Display Set Zone
26971. 
26972. SetVariable(ZoneStepDescription,	"!ZoneLabel! - !ZoneDescription!")
26973. SetVariable(FileStepDescription,	"")
26974. 
26975. SetVariable(ZoneStepByLine, 			"Zone started.
26976. ")
26977. 
26978. # BANNER SET
26979. 
26980. # DATE TIME RUN ELP
26981. 
26982. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
26983. /* Xinclude "..\BannerSet.MyDc"X */
26984. /* pause(1) */
26985. 
26986. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
26987. 
26988. Title('!Heading!')
26989. /* pause(1) */
26990. 
26991. /* NOTE: Can't round or truncate to integer precision. */
26992. 
26993. AppendLogfile("!LogFileName!", "!Title!")
26994. 
26995. 
26996. 
26997. pause(1)
26998. 
26999. 
27000. SetVariable(ZoneNoCurrent, ZoneNoCurrent + 1)
27001. SetVariable(ZoneNoAdjCurrent, ZoneNoCurrent + ZoneCurrentAjust)
27002. 
27003. SetVariable(ZoneStepNoCurrent, 0)
27004. 
27005. 
27006. # Zone Do Current Clear
27007. 
27008. SetVariable(ZoneTypeSelectCurrent, 		"")
27009. 
27010. SetVariable(ZoneBeginCurrent, 			0)
27011. SetVariable(ZoneBeginPerCurrent, 		0)
27012. SetVariable(ZoneEndCurrent, 			0)
27013. SetVariable(ZoneEndPerCurrent, 			0)
27014. 
27015. SetVariable(ZoneSizeCurrent,			0)
27016. SetVariable(ZoneSizePerCurrent,			0)
27017. 
27018. SetVariable(ZoneGapRequestedCurrent,	0)
27019. SetVariable(ZoneGapRoundedCurrent, 		0)
27020. SetVariable(ZoneGapAdjustedCurrent, 	0)
27021. SetVariable(ZoneGapAvailableCurrent, 	0)
27022. SetVariable(ZoneGapCurrent,				0)
27023. SetVariable(ZoneGapUsedCurrent, 		0)
27024. 
27025. SetVariable(ZoneGapActualCurrent, 		0)
27026. SetVariable(ZoneGapActualPerCurrent, 	0)
27027. 
27028. SetVariable(ZoneSizeActual, 			0)
27029. SetVariable(ZoneSizeActualCurrent,		0)
27030. 
27031. SetVariable(ZoneEndActual, 				0)
27032. SetVariable(ZoneEndActualCurrent,		0)			
27033. SetVariable(ZoneSizeActualPerCurrent, 	0)
27034.       
27035. SetVariable(ZoneFilesFolders,			0)
27036. SetVariable(ZoneFilesFoldersPer,		0) 
27037. 
27038. SetVariable(ZoneFragments,				0)
27039. SetVariable(ZoneFragmentsPer,			0) 
27040. 		
27041. SetVariable(ZoneEndActualCurrent, 		0)
27042. SetVariable(ZoneEndActualPerCurrent, 	0)
27043. 
27044. # Gap Calculation Methodology:
27045. 	# Requested
27046. 	SetVariable(GapRequested, 			0) 
27047. 	SetVariable(GapRequestedStd, 		0) 
27048. 	SetVariable(GapRequestedMft, 		0) 
27049. 	SetVariable(GapRequestedOs, 		0) 
27050. 	SetVariable(GapRequestedOriginal, 	0) 
27051. 	
27052. 	# Gap Adjustments
27053. 	SetVariable(GapRounded, 			0)
27054. 	# SetVariable(GapAdjusted, 			0)
27055. 	SetVariable(GapAvailable, 			0)
27056. 	SetVariable(GapCurrent, 			0)
27057. 	SetVariable(GapActual, 				0)
27058. 	SetVariable(GapUsed, 				0)
27059. 	
27060. 	# Gap Adjustments
27061. 	SetVariable(GapRoundedLoc, 			0)
27062. 	# SetVariable(GapAdjustedLoc, 		0)
27063. 	SetVariable(GapAvailableLoc, 		0)
27064. 	SetVariable(GapCurrentLoc, 			0)
27065. 	SetVariable(GapActualLoc,			0)
27066. 	SetVariable(GapUsedLoc,				0)
27067. 	
27068. 	# Space usage
27069. 	SetVariable(ZoneFreePerRequested, 	0)
27070. 	SetVariable(ZoneFreePerUsed, 		0)
27071. 
27072. # Gap Size & Rounding
27073. 	SetVariable(ZoneGapSizePer, 		0)
27074. 	SetVariable(ZoneVolRoundUpPer, 		0)
27075. 	
27076. 	# Free Space
27077. 	SetVariable(ZoneFreeUsedPer, 		0)
27078. 	SetVariable(ZoneFreeRequestedPer, 	0)
27079. 
27080. 
27081. SetVariable(ZoneTypeSelectCurrent, "!ZoneTypeSelect!")
27082. 
27083. # Footer:
27084. SetVariable(ZoneFooter, "----------------------------------------------------------
27085. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:19
27086. 
27087. Statistics Report:
27088. ------------------
27089.    Size:  
27090.    ------------------------
27091.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27092.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27093.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27094. 
27095.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27096.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27097. 
27098.    Location:
27099.    ------------------------
27100.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27101.              Files End: !ZoneEndCurrent!
27102.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27103.       
27104.    Gap Settings:
27105.    ------------------------
27106.          Gap Requested: !ZoneGapSizePer!%
27107.       Volume Rounding: !ZoneVolRoundUpPer!%
27108.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27109.                  
27110.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
27111.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
27112.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
27113.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
27114.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
27115.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
27116.      
27117.    Free Space after Zone:
27118.    ------------------------
27119.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27120.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27121.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27122. 
27123. Directory and Files Select:
27124. ---------------------------
27125. !ZoneTypeSelectCurrent!               
27126. ---------------------------
27127. ----------------------------------------------------------
27128. ")
27129. 
27130. # BANNER SET
27131. 
27132. # DATE TIME RUN ELP
27133. 
27134. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
27135. /* Xinclude "..\BannerSet.MyDc"X */
27136. /* pause(1) */
27137. 
27138. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
27139. 
27140. Title('!Heading!')
27141. /* pause(1) */
27142. 
27143. /* NOTE: Can't round or truncate to integer precision. */
27144. 
27145. AppendLogfile("!LogFileName!", "!Title!")
27146. 
27147. 
27148. 
27149. AppendLogfile("!LogFileName!", "Zone !ZoneNoCurrent! (!ZoneNoCurrent! + !ZoneCurrentAdjust!) of !ZoneCount!.")
27150. AppendLogfile("!LogFileName!", "Zone !ZoneCurrentDescription!:")
27151. AppendLogfile("!LogFileName!", "Time: 2021-10-24 14:34:19")
27152. 
27153. SetVariable(ZoneListByLine, "!ZoneListByLine!
27154. Zone: !ZoneNoCurrent!  !ZoneLabel! !ZoneDescription!")
27155. 
27156. 
27157. /* Fixed Zone Position Handling */
27158. /* Literal number: */
27159. /* SetVariable(Temp, RoundUp( (ZoneBegin * ZoneFixedToggle * (0-1)), (ZoneLocationCurrent * ZoneFixedToggle) ) */
27160. /* Percentage of disk: */
27161. # XXX SetVariable(Temp, RoundUp(ZoneBegin * ZoneFixedToggle * (0-1), ZoneLocationCurrent * ZoneFixedToggle * VolumeSize))
27162. /* Gap */
27163. /* XXXXXXXXXXXXXXXXXXXXXXX MakeGap(Temp, DoNotVacate) // will move if toggle is on (1). xxx method Mft */
27164. 
27165. /* ---------------------------------------------------------- */
27166. SetVariable(FileStepDescription, "!FileStepDescriptionFileSelect!")
27167. # FILE STEP
27168. 
27169. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27170. 
27171. /* add message and move to a new line. */
27172. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27173. ")
27174. 
27175. /* display the line. (hopefully.) */
27176. # Zone Footer Set Statistics Window Text
27177. 
27178. SetStatisticsWindowText("----------------------------------------------------------
27179. Zones Processed: 
27180. ----------------------------------------------------------
27181. !ZoneListByLine!
27182. ----------------------------------------------------------
27183. Zone Processing Step:
27184. !ZoneStepByLine!    
27185. ----------------------------------------------------------
27186. Current Zone:
27187. !ZoneFooter!
27188. ----------------------------------------------------------
27189. Volume Statistics:
27190. !VolumeStatisticsDetail!
27191. ----------------------------------------------------------
27192. Zone Detailed Report:
27193. ----------------------------------------------------------
27194. !ZoneStatisticsDetail!
27195. ----------------------------------------------------------
27196. ")
27197. 
27198. 
27199. 
27200. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27201. 
27202. # BANNER SET
27203. 
27204. # DATE TIME RUN ELP
27205. 
27206. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
27207. /* Xinclude "..\BannerSet.MyDc"X */
27208. /* pause(1) */
27209. 
27210. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
27211. 
27212. Title('!Heading!')
27213. /* pause(1) */
27214. 
27215. /* NOTE: Can't round or truncate to integer precision. */
27216. 
27217. pause(1)
27218. 
27219. # your stuff HERE (X)... pre file select code.
27220. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePre!")
27221. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
27222. 	# (X)
27223. 
27224. FileSelect
27225. 
27226. 	# your stuff can't really go here (errors.)
27227. 	# maybe for some reason I don't know of...
27228. 	
27229. 	# Actions next...
27230. 	# ArchivesBu start.
27231. all
27232. # ArchivesBu end.
27233. 
27234. 	# Zone
27235. # File Select
27236. 	# File Booleans
27237. 	# Resume...
27238. # File Action - SortByName.
27239. 
27240. FileActions
27241. 
27242. 		/* ---------------------------------------------------------- */
27243. 	# Gap
27244. 		SetVariable(FileStepDescription,"!FileStepDescriptionFileActionGap!")
27245. 		# FILE STEP
27246. 
27247. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27248. 
27249. /* add message and move to a new line. */
27250. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27251. ")
27252. 
27253. /* display the line. (hopefully.) */
27254. # Zone Footer Set Statistics Window Text
27255. 
27256. SetStatisticsWindowText("----------------------------------------------------------
27257. Zones Processed: 
27258. ----------------------------------------------------------
27259. !ZoneListByLine!
27260. ----------------------------------------------------------
27261. Zone Processing Step:
27262. !ZoneStepByLine!    
27263. ----------------------------------------------------------
27264. Current Zone:
27265. !ZoneFooter!
27266. ----------------------------------------------------------
27267. Volume Statistics:
27268. !VolumeStatisticsDetail!
27269. ----------------------------------------------------------
27270. Zone Detailed Report:
27271. ----------------------------------------------------------
27272. !ZoneStatisticsDetail!
27273. ----------------------------------------------------------
27274. ")
27275. 
27276. 
27277. 
27278. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27279. 
27280. # BANNER SET
27281. 
27282. # DATE TIME RUN ELP
27283. 
27284. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
27285. /* Xinclude "..\BannerSet.MyDc"X */
27286. /* pause(1) */
27287. 
27288. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
27289. 
27290. Title('!Heading!')
27291. /* pause(1) */
27292. 
27293. /* NOTE: Can't round or truncate to integer precision. */
27294. 
27295. pause(1)
27296. 	
27297. 	# ACTUAL GAP
27298. 		/* AddGap Variant. */
27299. 	  	# Zone Do Gap
27300. # Gap Calculation Methods:
27301. 
27302. /* 1) Anything you need to add first. */
27303. /* empty */
27304. 
27305. /* ---------------------------------------------------------- */
27306. /* 2) REQUESTED: Get the GapRequested using the Method from Settings. */
27307. 	# GapRequestedStd.
27308. 
27309. 		/* ---------------------------------------------------------- */
27310. 		# GAP CALCULATION METHOD (CURRENTLY STANDARD)
27311. 
27312. 		# Gap Calculation Methods:
27313. 
27314. /* AddGap Variants */
27315. 
27316. 	/* Standard */
27317. 		# Gap Calculation Methods:
27318. 	/* AddGap Variants */
27319. 	/* Standard */
27320. 
27321. 	SetVariable(GapRequestedStd, VolumeFreeAdj * ZoneGapSize)
27322. 	AppendLogfile("!LogFileName!", " Std Gap size: !GapRequestedStd!")
27323. 
27324. 	SetVariable(GapRequested, GapRequestedStd)
27325. 	
27326. 
27327. 	/* MFT Low High Method */
27328. 		# Gap Calculation Methods:
27329. 	/* AddGap Variants */
27330. 	/* MFT Low High Method */
27331. 	SetVariable(GapRequestedMft, (100 - MftPer) * (VolumeFreeAdj * ZoneGapSize) )
27332. 	AppendLogfile("!LogFileName!", " Mft Gap size: !GapRequestedMft!")
27333. 	SetVariable(GapRequested, GapRequestedMft)
27334. 	
27335. 
27336. 	/* OS Volume Type Method */
27337. 		# Gap Calculation Methods:
27338. 	/* AddGap Variants */
27339. 	/* OS Volume Type Method */
27340. 	AppendLogfile("!LogFileName!", "  OS Gap size: !GapRequestedOs!")
27341. 	SetVariable(GapRequested, GapRequestedOs)
27342. 
27343. 
27344. 
27345. /* MakeGap Variants */
27346. 
27347. 	/* Original Os 1-3 + MFT 2 */
27348. 		# Gap Calculation Methods:
27349. 	/* MakeGap Variants */
27350. 	/* Original Os 1-3 + MFT 2 */
27351. 	/* plus MFT gap placed inline at the dividing zone. */
27352. 	SetVariable(GapRequestedOrig, VolumeFreeAdj * ZoneGapSize)
27353. 	AppendLogfile("!LogFileName!", "Orig Gap size: !GapRequestedOrig!")
27354. 	SetVariable(GapRequested, GapRequestedOrig)
27355. 	
27356. 	
27357. /* Note: You could comment out the ones not in use */
27358. /* However having the data in the log is useful. */
27359. /* Therefore the following line is otherwise needed. */
27360. 
27361. /* Standard used */
27362. 
27363. SetVariable(GapRequested, GapRequestedStd)
27364. 
27365. # Gap Calculation Methods:
27366. 
27367. /* AddGap Variants */
27368. 	/* Standard */
27369. 	/* MFT Low High Method */
27370. 	/* OS Volume Type Method */
27371. 
27372. /* MakeGap Variants */
27373. 	/* Original Os 1-3 + MFT 2 */
27374. 
27375. /* Note: You could comment out the ones not in use */
27376. /* However having the data in the log is useful. */
27377. /* Therefore the following line is otherwise needed. */
27378. 
27379. /* Standard is used currently */
27380. 
27381. 
27382. 	# SetVariable(GapRequested, GapRequested[Std, Mft, Os...] )
27383. 
27384. 	SetVariable(GapRequestedLoc, ZoneEnd + GapRequested)
27385. 
27386. 	AppendLogfile("!LogFileName!", "  Gap requested: !GapRequested! at !GapRequestedLoc!")
27387. 
27388. /* ---------------------------------------------------------- */
27389. /* 3) SMALL ZONE ADJUSTMENT. */
27390. /* Gab cant be larger than half the Zone Size. */
27391. 
27392. 	SetVariable(GapAdjusted, Minimum(GapRequested, ZoneSize * 2 ) )
27393. 	
27394. 	SetVariable(GapAdjustedLoc, ZoneEnd + GapAdjusted)
27395. 
27396. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! at !GapAdjustedLoc!")
27397. 
27398. /* ---------------------------------------------------------- */
27399. /* 4) VOLUME ROUND UP: to round Volume even numbers to prevent constant zone moves. */
27400. # Gap Adjustments.
27401. 
27402. 	SetVariable(GapRoundedLoc, RoundUp(GapAdjustedLoc, ZoneVolRoundUp * VolumeSize) )
27403. 	
27404. 	SetVariable(GapRounded, GapRoundedLoc - ZoneEnd)
27405. 
27406. 	AppendLogfile("!LogFileName!", "  Gap rounded: !GapRounded! at !GapRoundedLoc!")
27407. 
27408. /* ---------------------------------------------------------- */
27409. # BYPASS THIS.
27410. 	/* This is definitely wrong. */
27411. 	/* The question is can we steal gap from the next zone */
27412. 	/* More... Can we put the gap on the bottom of the zone and pack upward. */
27413. 	/* X) OVERFLOW: Adjust for previous zone overflow. */
27414. 		# Zone Overflow.
27415. 		# SetVariable(GapAdjusted, GapRounded + VolumeFreeRequested - VolumeFreeUsed)
27416. 			# AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAdjusted! (VolumeFreeRequested # !VolumeFreeRequested! 			        # VolumeFreeUsed !				# VolumeFreeUsed!)")
27417. 
27418. /* ---------------------------------------------------------- */
27419. /* 5) END OF VOLUME: Adjust for total remaining volume space available. */
27420. # Remaining free space available.
27421. 
27422. 	SetVariable(GapAvailableLoc, MaxNextZoneBegin - VolumeRoundUpTiny)
27423. 	
27424. 	SetVariable(GapAvailable, GapAvailableLoc - ZoneEnd)
27425. 
27426. 	AppendLogfile("!LogFileName!", "  Gap adjusted: !GapAvailable! at !GapAvailableLoc!")
27427. 
27428. /* ---------------------------------------------------------- */
27429. # CURRENT gap to use.
27430. 
27431. 	SetVariable(GapCurrentLoc, Minimum(GapRoundedLoc, GapAvailableLoc) )
27432. 
27433. 	SetVariable(GapCurrent, GapCurrentLoc - ZoneEnd)
27434. 
27435. /* ---------------------------------------------------------- */
27436. /* 6) GAP USED DEBUG: An access point to add debugging or other code of yours. */
27437. # Debugging.
27438. 
27439. 	SetVariable(GapUsed, GapCurrent) // for debugging
27440. 
27441. 	SetVariable(GapUsedLoc, GapCurrentLoc) // for debugging
27442. 
27443. 		# Your code HERE
27444. 
27445. /* ---------------------------------------------------------- */
27446. /* 7) YOUR CODE. */
27447. # YOUR CODE HERE:
27448. 	# INPUT: GapCurrent or GapCurrentLoc
27449. 	# OUTPUT: GapUsed...
27450. 
27451. /* ---------------------------------------------------------- */
27452. # Gap Size.
27453. # Actual Size of Gap.
27454. 
27455. 	SetVariable(GapActual, GapUsedLoc - ZoneEnd)
27456. 
27457. /* ---------------------------------------------------------- */
27458. /* xxxxxxxxxxxxxxxxxxxxxx */
27459. # ADD THE GAP
27460. 	/* Xinclude "..\GapCommandDo.MyDc"X */
27461. /* xxxxxxxxxxxxxxxxxxxxxx */
27462. 
27463. 	
27464. 	# Zone Statistics	
27465. 	# Zone / Volume Statistics and Display
27466. 		
27467. 	# Accumulate Totals
27468.   	# Volume totals
27469. 
27470. /* Current total space used (by Zones and Gaps) */
27471. 
27472. SetVariable(VolumeZoneUsed, GapUsed)
27473. AppendLogfile("!LogFileName!", "VolumeUsed: !VolumeZoneUsed! of !VolumeSize!")
27474. /* Percentage */
27475. SetVariable(VolumeZoneUsedPer, VolumeZoneUsed / VolumeSize * 100)
27476. AppendLogfile("!LogFileName!", "VolumeZoneUsedPer: !VolumeZoneUsedPer!")
27477. 
27478. /* Current total of free space requested */
27479. 
27480. SetVariable(VolumeFreeRequested, VolumeFreeRequested + GapRequested)
27481. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
27482. /* Percent. */
27483. SetVariable(VolumeFreeRequestedPer, VolumeFreeRequested / VolumeSize * 100)
27484. AppendLogfile("!LogFileName!", "VolumeFreeRequested: !VolumeFreeRequested!")
27485. 
27486. /* Current total of free space used */
27487. 
27488. SetVariable(VolumeFreeUsed, VolumeFreeUsed + GapActual)
27489. AppendLogfile("!LogFileName!", "VolumeFreeUsed: !ZoneFreeUsed!")
27490. /* Percent */
27491. SetVariable(VolumeFreeUsedPer, VolumeFreeUsed  / VolumeFree * 100)
27492. AppendLogfile("!LogFileName!", "VolumeFreePerUsed: !VolumeFreePerUsed!%")
27493. 
27494. # DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
27495. /* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
27496. /* Xinclude "..\DebugDisplayPause.MyDc"X */
27497. 
27498. 
27499. 	# Current Values
27500. 	# Cluster, Sector, Block adjust for display.
27501. 	# Bytes per cluster is volume specific.
27502. 
27503. 	SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
27504. 
27505. # Current Zone values.
27506. 	# Begin, end and size.
27507. 	SetVariable(ZoneBeginCurrent, 			ZoneBegin / DisplayUnitDivisorCurrent)
27508. 	SetVariable(ZoneBeginPerCurrent, 		ZoneBeginCurrent / VolumeSize * 100)
27509. 
27510. 	SetVariable(ZoneEndCurrent, 			ZoneEnd / DisplayUnitDivisorCurrent)
27511. 	SetVariable(ZoneEndPerCurrent, 			ZoneEndCurrentPer / VolumeSize * 100)
27512. 
27513. 	SetVariable(ZoneSizeCurrent, 			ZoneSize / DisplayUnitDivisorCurrent)
27514. 	SetVariable(ZoneSizePerCurrent,			ZoneSize / VolumeSize * 100)
27515. 
27516. 	SetVariable(ZoneFilesFolders,			"!ZONE220N!")
27517. 	SetVariable(ZoneFilesFoldersPer,		ZoneFilesFolders / FILES220N * 100) 
27518. 
27519. 	SetVariable(ZoneFragments,				"!ZONE210N!")
27520. 	SetVariable(ZoneFragmentsPer,			ZoneFragments / FILES210N * 100) 
27521. 		
27522. /* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
27523. /* identical code to here: (separation not needed. TEST.) */	
27524. 
27525. # Current Gap, Actual and Free Values
27526. 	# Gap
27527. 	SetVariable(ZoneGapRequestedCurrent,	GapRequested / DisplayUnitDivisorCurrent)
27528. 	SetVariable(ZoneGapAdjustedCurrent, 	GapAdjusted / DisplayUnitDivisorCurrent)
27529. 	SetVariable(ZoneGapRoundedCurrent, 		GapRounded / DisplayUnitDivisorCurrent)
27530. 	SetVariable(ZoneGapAvailableCurrent, 	GapAvailable / DisplayUnitDivisorCurrent)
27531. 	SetVariable(ZoneGapCurrent, 			GapCurrent / DisplayUnitDivisorCurrent)
27532. 	SetVariable(ZoneGapUsedCurrent, 		GapUsed / DisplayUnitDivisorCurrent)
27533. 	
27534. 	SetVariable(ZoneGapRequestedLocCurrent,	GapRequestedLoc / DisplayUnitDivisorCurrent)
27535. 	SetVariable(ZoneGapAdjustedLocCurrent,GapAdjustedLoc / DisplayUnitDivisorCurrent)
27536. 	SetVariable(ZoneGapRoundedLocCurrent, 	GapRoundedLoc / DisplayUnitDivisorCurrent)
27537. 	SetVariable(ZoneGapAvailableLocCurrent, GapAvailableLoc / DisplayUnitDivisorCurrent)
27538. 	SetVariable(ZoneGapLocCurrent, 			GapCurrentLoc / DisplayUnitDivisorCurrent)
27539. 	SetVariable(ZoneGapUsedLocCurrent, 		GapUsedLoc / DisplayUnitDivisorCurrent)
27540. 	
27541. 	SetVariable(ZoneGapActualCurrent, 		GapActual / DisplayUnitDivisorCurrent)
27542. 	SetVariable(ZoneGapActualPerCurrent, 	GapActual / VolumeSize * 100)
27543. 	
27544. 	# Actual Size and End
27545. 	SetVariable(ZoneSizeActual, 			ZoneSize + GapActual)
27546. 	SetVariable(ZoneSizeActualCurrent, 		ZoneSizeActual / DisplayUnitDivisorCurrent)
27547. 	SetVariable(ZoneSizeActualPerCurrent, 	ZoneSizeActual / VolumeSize * 100)
27548. 	
27549. 	SetVariable(ZoneEndActual, 				ZoneEnd + GapActual)
27550. 	SetVariable(ZoneEndActualCurrent, 		ZoneEndActual / DisplayUnitDivisorCurrent)
27551. 	SetVariable(ZoneEndActualPerCurrent, 	ZoneEndActual / VolumeSize * 100)
27552. 
27553. # Gap Size & Rounding
27554. 	SetVariable(ZoneGapSizePer, 			ZoneGapSize * 100)
27555. 	SetVariable(ZoneVolRoundUpPer, 			ZoneVolRoundUp * 100)
27556. 	
27557. 	# Free Space
27558. 	SetVariable(ZoneFreeUsedPer, 			GapActual / VolumeFreeUsed * 100)
27559. 	SetVariable(ZoneFreeRequestedPer, 		ZoneGapRequested / VolumeFreeRequested * 100)
27560. 
27561. 	# Footer:
27562. SetVariable(ZoneFooter, "----------------------------------------------------------
27563. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:19
27564. 
27565. Statistics Report:
27566. ------------------
27567.    Size:  
27568.    ------------------------
27569.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27570.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27571.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27572. 
27573.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27574.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27575. 
27576.    Location:
27577.    ------------------------
27578.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27579.              Files End: !ZoneEndCurrent!
27580.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27581.       
27582.    Gap Settings:
27583.    ------------------------
27584.          Gap Requested: !ZoneGapSizePer!%
27585.       Volume Rounding: !ZoneVolRoundUpPer!%
27586.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27587.                  
27588.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
27589.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
27590.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
27591.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
27592.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
27593.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
27594.      
27595.    Free Space after Zone:
27596.    ------------------------
27597.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27598.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27599.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27600. 
27601. Directory and Files Select:
27602. ---------------------------
27603. !ZoneTypeSelectCurrent!               
27604. ---------------------------
27605. ----------------------------------------------------------
27606. ")
27607. 	# Zone Footer Set Statistics Window Text
27608. 
27609. SetStatisticsWindowText("----------------------------------------------------------
27610. Zones Processed: 
27611. ----------------------------------------------------------
27612. !ZoneListByLine!
27613. ----------------------------------------------------------
27614. Zone Processing Step:
27615. !ZoneStepByLine!    
27616. ----------------------------------------------------------
27617. Current Zone:
27618. !ZoneFooter!
27619. ----------------------------------------------------------
27620. Volume Statistics:
27621. !VolumeStatisticsDetail!
27622. ----------------------------------------------------------
27623. Zone Detailed Report:
27624. ----------------------------------------------------------
27625. !ZoneStatisticsDetail!
27626. ----------------------------------------------------------
27627. ")
27628. 
27629. 
27630. 	
27631.   	/* Xinclude "..\GapZoneActualFreeSetCurrent.MyDc"X */
27632. 
27633. 	# Add Zone to list of zones for display.
27634. 	SetVariable(ZoneListByLine, "!ZoneListByLine! - (s!ZoneSizeCurrent! / g!ZoneGapActualCurrent! / a!ZoneSizeActualCurrent!) - [b!ZoneBeginCurrent! / e!ZoneEndCurrent! / z!ZoneGapUsedCurrent! / v!ZoneVolRoundUp!]")
27635. 
27636. 	# Footer:
27637. SetVariable(ZoneFooter, "----------------------------------------------------------
27638. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:19
27639. 
27640. Statistics Report:
27641. ------------------
27642.    Size:  
27643.    ------------------------
27644.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27645.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27646.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27647. 
27648.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27649.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27650. 
27651.    Location:
27652.    ------------------------
27653.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27654.              Files End: !ZoneEndCurrent!
27655.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27656.       
27657.    Gap Settings:
27658.    ------------------------
27659.          Gap Requested: !ZoneGapSizePer!%
27660.       Volume Rounding: !ZoneVolRoundUpPer!%
27661.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27662.                  
27663.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
27664.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
27665.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
27666.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
27667.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
27668.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
27669.      
27670.    Free Space after Zone:
27671.    ------------------------
27672.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27673.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27674.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27675. 
27676. Directory and Files Select:
27677. ---------------------------
27678. !ZoneTypeSelectCurrent!               
27679. ---------------------------
27680. ----------------------------------------------------------
27681. ")
27682. 
27683. 	# Add Zone Details to Report.	
27684. 	SetVariable(ZoneStatisticsDetail, 	"!ZoneStatisticsDetail!
27685. !ZoneFooter!")
27686. 
27687. 
27688. 
27689. 	# DEBUG EXAMPLE: Debugging. Use of DebugMessage to troubleshoot Gap Calculation.
27690. 		/* SetVariable(DebugMessage, "GAP:Req !GapRequested!Rnd !GapRounded!Adj !GapAdjusted!Ava !GapAvailable!Cur !GapCurrent!Act !GapActual!") */
27691. 		/* Xinclude "..\DebugDisplayPause.MyDc"X */
27692. 
27693.   	# Zone Statistics	
27694.   	/* Xinclude "..\ZoneDoStatistics.MyDc"X */
27695. 
27696. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionStart!")
27697. 	# FILE STEP
27698. 
27699. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27700. 
27701. /* add message and move to a new line. */
27702. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27703. ")
27704. 
27705. /* display the line. (hopefully.) */
27706. # Zone Footer Set Statistics Window Text
27707. 
27708. SetStatisticsWindowText("----------------------------------------------------------
27709. Zones Processed: 
27710. ----------------------------------------------------------
27711. !ZoneListByLine!
27712. ----------------------------------------------------------
27713. Zone Processing Step:
27714. !ZoneStepByLine!    
27715. ----------------------------------------------------------
27716. Current Zone:
27717. !ZoneFooter!
27718. ----------------------------------------------------------
27719. Volume Statistics:
27720. !VolumeStatisticsDetail!
27721. ----------------------------------------------------------
27722. Zone Detailed Report:
27723. ----------------------------------------------------------
27724. !ZoneStatisticsDetail!
27725. ----------------------------------------------------------
27726. ")
27727. 
27728. 
27729. 
27730. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27731. 
27732. # BANNER SET
27733. 
27734. # DATE TIME RUN ELP
27735. 
27736. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
27737. /* Xinclude "..\BannerSet.MyDc"X */
27738. /* pause(1) */
27739. 
27740. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
27741. 
27742. Title('!Heading!')
27743. /* pause(1) */
27744. 
27745. /* NOTE: Can't round or truncate to integer precision. */
27746. 
27747. pause(1)
27748. 
27749. 	SortByName(Ascending SkipBlock(SkipBlockFiles,SkipBlockBytes))
27750. 	
27751. 	SetVariable(FileStepDescription, "!FileStepDescriptionFileActionEnd!")
27752. 	# FILE STEP
27753. 
27754. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27755. 
27756. /* add message and move to a new line. */
27757. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27758. ")
27759. 
27760. /* display the line. (hopefully.) */
27761. # Zone Footer Set Statistics Window Text
27762. 
27763. SetStatisticsWindowText("----------------------------------------------------------
27764. Zones Processed: 
27765. ----------------------------------------------------------
27766. !ZoneListByLine!
27767. ----------------------------------------------------------
27768. Zone Processing Step:
27769. !ZoneStepByLine!    
27770. ----------------------------------------------------------
27771. Current Zone:
27772. !ZoneFooter!
27773. ----------------------------------------------------------
27774. Volume Statistics:
27775. !VolumeStatisticsDetail!
27776. ----------------------------------------------------------
27777. Zone Detailed Report:
27778. ----------------------------------------------------------
27779. !ZoneStatisticsDetail!
27780. ----------------------------------------------------------
27781. ")
27782. 
27783. 
27784. 
27785. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27786. 
27787. # BANNER SET
27788. 
27789. # DATE TIME RUN ELP
27790. 
27791. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
27792. /* Xinclude "..\BannerSet.MyDc"X */
27793. /* pause(1) */
27794. 
27795. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
27796. 
27797. Title('!Heading!')
27798. /* pause(1) */
27799. 
27800. /* NOTE: Can't round or truncate to integer precision. */
27801. 
27802. pause(1)
27803. 
27804. 	# Footer next...
27805. 	
27806. 	# Zone Do Footer
27807. 
27808. /* ---------------------------------------------------------- */
27809. # File Select
27810. 	# Select Statments
27811. # File Actions 
27812. 	# Standard or OS File Actions.
27813. 	# Resume...
27814. 	
27815. 	# your stuff HERE (X)... post zone (file) file actions code.
27816. 		# SetVariable(FileStepDescription, "!FileStepDescriptionYourFileActionsPre!")
27817. 		# Xinclude "..\DisplaySetFileStep.MyDc"X
27818. 		# (X)
27819. 		
27820. 		/* ??? Set window? */
27821. 	
27822. 	# ADD THE GAP
27823. 		
27824. # Vacate (good for diagnostics)
27825. /* Xinclude "..\GapCommandDoVacate.MyDc"X */
27826. 
27827. # DoNotVacate - DO NOT Vacate (recommended)
27828. 
27829. # Vacate
27830. /* AddGap(GapUsedLoc) */
27831. 
27832. # DO Not Vacate
27833. AddGap(GapUsedLoc, DoNotVacate) 
27834. 	
27835. 	
27836. /* ---------------------------------------------------------- */
27837. # (failed) TEST for boolean logic.
27838. 
27839. /* It should work in the gap calculations for turning options */
27840. /* on and off but it will NOT work here. */
27841. 
27842. /* Boolean setting X or FlagX. */
27843. /* Where X will be on or off: */
27844. /*     For OFF:  (X  * (FlagAny - 1) * (0-1)) */
27845. /*      For ON:  (X  *  FlagAny) */
27846. 
27847. /* 1) Failed, zero gap overrode the previous one. */
27848. /* SetVariable(GapUsedTemp, GapUsed * ((FlagDoNotVacate - 1) * (0-1))) */
27849. /* AddGap(GapUsedTemp) */ 
27850. 
27851. /* SetVariable(GapUsedTemp, GapUsed * FlagDoNotVacate) */
27852. /* AddGap(GapUsedTemp, DoNotVacate) */ 
27853. 
27854. /* 2) Also Failed: AddGap(GapUsedTemp, FlagDoNotVacate) */ 
27855. 
27856. /* 3) Try? (no, won't work, you get zero for DoNotVacate GapUsed one way or the other.) */
27857. /* SetVariable(GapUsedTemp, GapUsed * FlagVacate) */
27858. /* AddGap(GapUsedTemp) */ 
27859. 
27860. /* SetVariable(GapUsedTemp, GapUsed * ((FlagVacate - 1) * (0-1))) */
27861. /* AddGap(GapUsedTemp, DoNotVacate) */ 
27862. 
27863. /* ---------------------------------------------------------- */
27864. 
27865. # Vacate
27866. /* AddGap(GapUsed) */
27867. 
27868. # DO NOT Vacate (recommended)
27869. /* AddGap(GapUsed, DoNotVacate) */ 
27870. 	
27871. 
27872. 		
27873. # 
27874. FileEnd
27875. /* ---------------------------------------------------------- */
27876. 
27877. # your stuff HERE (X)... post zone (file) code.
27878. 	# SetVariable(FileStepDescription, "!FileStepDescriptionYourZonePost!")
27879. 	# Xinclude "..\DisplaySetFileStep.MyDc"X
27880. 	# (X)
27881. 
27882. SetVariable(FileStepDescription,"Zone finished, reporting.")
27883. # FILE STEP
27884. 
27885. SetVariable(ZoneStepNoCurrent, ZoneStepNoCurrent + 1)
27886. 
27887. /* add message and move to a new line. */
27888. SetVariable(ZoneStepByLine, 	"!ZoneStepByLine!!ZoneStepNoCurrent! !FileStepDescription!
27889. ")
27890. 
27891. /* display the line. (hopefully.) */
27892. # Zone Footer Set Statistics Window Text
27893. 
27894. SetStatisticsWindowText("----------------------------------------------------------
27895. Zones Processed: 
27896. ----------------------------------------------------------
27897. !ZoneListByLine!
27898. ----------------------------------------------------------
27899. Zone Processing Step:
27900. !ZoneStepByLine!    
27901. ----------------------------------------------------------
27902. Current Zone:
27903. !ZoneFooter!
27904. ----------------------------------------------------------
27905. Volume Statistics:
27906. !VolumeStatisticsDetail!
27907. ----------------------------------------------------------
27908. Zone Detailed Report:
27909. ----------------------------------------------------------
27910. !ZoneStatisticsDetail!
27911. ----------------------------------------------------------
27912. ")
27913. 
27914. 
27915. 
27916. /* SetVariable(FileStepDescription, "!FileStepDescription!") */
27917. 
27918. # BANNER SET
27919. 
27920. # DATE TIME RUN ELP
27921. 
27922. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
27923. /* Xinclude "..\BannerSet.MyDc"X */
27924. /* pause(1) */
27925. 
27926. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
27927. 
27928. Title('!Heading!')
27929. /* pause(1) */
27930. 
27931. /* NOTE: Can't round or truncate to integer precision. */
27932. 
27933. pause(1)
27934. 
27935. # Zone When Finished
27936. 
27937. # BANNER SET
27938. 
27939. # DATE TIME RUN ELP
27940. 
27941. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
27942. /* Xinclude "..\BannerSet.MyDc"X */
27943. /* pause(1) */
27944. 
27945. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
27946. 
27947. Title('!Heading!')
27948. /* pause(1) */
27949. 
27950. /* NOTE: Can't round or truncate to integer precision. */
27951. 
27952. AppendLogfile("!LogFileName!", "!Title!")
27953. 
27954. 
27955. 
27956. # Zone Statistics	
27957. /* Xinclude "..\ZoneDoStatistics.MyDc"X */
27958. 
27959. # Footer:
27960. SetVariable(ZoneFooter, "----------------------------------------------------------
27961. Zone: !ZoneNoCurrent! !ZoneLabel! !ZoneDescription! 2021-10-24 14:34:19
27962. 
27963. Statistics Report:
27964. ------------------
27965.    Size:  
27966.    ------------------------
27967.                  Files: !ZoneSizeCurrent! (!ZoneSizePerCurrent!%)
27968.                   Gap: !ZoneGapActualCurrent! (!ZoneGapActualPerCurrent!%)
27969.                 Total: !ZoneSizeActualCurrent! (!ZoneEndActualPerCurrent!%)
27970. 
27971.         Files/folders: !ZoneFilesFolders! (!ZoneFilesFoldersPer!%) 
27972.             Fragments: !ZoneFragments! (!ZoneFragmentsPer!%) 
27973. 
27974.    Location:
27975.    ------------------------
27976.            Zone Start: !ZoneBeginCurrent! (!ZoneBeginPerCurrent!%)
27977.              Files End: !ZoneEndCurrent!
27978.              Zone End: !ZoneEndActualCurrent! (!ZoneEndActualPerCurrent!%)
27979.       
27980.    Gap Settings:
27981.    ------------------------
27982.          Gap Requested: !ZoneGapSizePer!%
27983.       Volume Rounding: !ZoneVolRoundUpPer!%
27984.            Actual Gap: !ZoneGapActualPerCurrent!% (!ZoneGapActualCurrent!)
27985.                  
27986.                The desired min gap size. (GapRequested): !ZoneGapRequestedCurrent!  !ZoneGapRequestedLocCurrent!
27987.               Must be half the zone size. (GapAdjusted): !ZoneGapAdjustedCurrent!  !ZoneGapAdjustedLocCurrent!
27988.                Align to the volume evenly. (GapRounded): !ZoneGapRoundedCurrent! !ZoneGapRoundedLocCurrent!
27989.           The remaining space available. (GapAvailable): !ZoneGapAvailableCurrent! !ZoneGapAvailableLocCurrent!
27990.       The lower of adjusted and available. (GapCurrent): !ZoneGapCurrent! !ZoneGapLocCurrent!
27991.     (GapCurrent) after any code you inserted. (GapUsed): !ZoneGapUsedCurrent! !ZoneGapUsedLocCurrent!
27992.      
27993.    Free Space after Zone:
27994.    ------------------------
27995.               Total Requested: !VolumeFreeRequested! (!VolumeFreeRequestedPer!%)
27996.                    Total Used: !VolumeFreeUsed! (!VolumeFreeUsedPer!%)
27997.          Volume Used by Zones: !VolumeZoneUsed! (!VolumeZoneUsedPer!%)
27998. 
27999. Directory and Files Select:
28000. ---------------------------
28001. !ZoneTypeSelectCurrent!               
28002. ---------------------------
28003. ----------------------------------------------------------
28004. ")
28005. 
28006. AppendLogfile("!LogFileName!", ".")
28007. AppendLogfile("!LogFileName!", "!ZoneFooter!")
28008. AppendLogfile("!LogFileName!", ".")
28009. 
28010. # Zone Footer Set Statistics Window Text
28011. 
28012. SetStatisticsWindowText("----------------------------------------------------------
28013. Zones Processed: 
28014. ----------------------------------------------------------
28015. !ZoneListByLine!
28016. ----------------------------------------------------------
28017. Zone Processing Step:
28018. !ZoneStepByLine!    
28019. ----------------------------------------------------------
28020. Current Zone:
28021. !ZoneFooter!
28022. ----------------------------------------------------------
28023. Volume Statistics:
28024. !VolumeStatisticsDetail!
28025. ----------------------------------------------------------
28026. Zone Detailed Report:
28027. ----------------------------------------------------------
28028. !ZoneStatisticsDetail!
28029. ----------------------------------------------------------
28030. ")
28031. 
28032. 
28033. 
28034. /* pause() */
28035. /* pause() */
28036. 
28037. 
28038. 
28039. 
28040. /* ---------------------------------------------------------- */
28041. 
28042. 
28043. /* ---------------------------------------------------------- */
28044. /* Volume End */
28045. # Volume When Finished
28046. 
28047. /* Write the "after" statistics to the logfile. */
28048. 
28049. # BANNER SET
28050. 
28051. # DATE TIME RUN ELP
28052. 
28053. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
28054. /* Xinclude "..\BannerSet.MyDc"X */
28055. /* pause(1) */
28056. 
28057. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
28058. 
28059. Title('!Heading!')
28060. /* pause(1) */
28061. 
28062. /* NOTE: Can't round or truncate to integer precision. */
28063. 
28064. AppendLogfile("!LogFileName!", "!Title!")
28065. 
28066. 
28067. 
28068. # Set Volume summary stats:
28069. 
28070. # Cluster, Sector, Block adjust for display.
28071. # Bytes per cluster is volume specific.
28072. 
28073. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
28074. 
28075. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
28076. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
28077. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
28078. 
28079. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
28080. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
28081. 
28082. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
28083. SUMMARY: !VolumeLabel! !VolumeDescription!
28084.   
28085.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
28086.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
28087.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
28088.          
28089.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
28090.       Volume Free Adj:       !VolumeFreeAdj!
28091.     Bytes per cluster:       !BytesPerCluster! bytes
28092. 
28093.    Unfragmented Items:       !FILES200N!
28094.      Fragmented Items:       !FILES210N!
28095. 
28096.     Unfragmented Data:       !FILES202N! bytes
28097.       Fragmented Data:       !FILES212N! bytes
28098. 
28099.              All Gaps:       !GAP00N!
28100.              All gaps:       !GAP10N! bytes
28101.           Average gap:       !GAP13N! bytes
28102.            Median gap:       !GAP14N! bytes
28103.           Biggest gap:       !GAP15N! bytes
28104. ----------------------------------------------------------
28105. ") 
28106. 
28107. SetVariable(VolumeFooter, "!VolumeStatisticsSummary!")
28108. 
28109. 
28110. AppendLogfile("!LogFileName!", ".")
28111. AppendLogfile("!LogFileName!", "      Volume Size: !VolumeSize!")
28112. AppendLogfile("!LogFileName!", "      Volume Used: !VolumeUsed!")
28113. AppendLogfile("!LogFileName!", "Volume Used Total: !VolumeUsedTotal!")
28114. AppendLogfile("!LogFileName!", "      Volume Free: !VolumeFree!")
28115. AppendLogfile("!LogFileName!", "  Volume Free Adj: !VolumeFreeAdj!")
28116. AppendLogfile("!LogFileName!", ".")
28117. AppendLogfile("!LogFileName!", "MFT Zone: !MftZone! Location: !MftLocation! Gap: !MftGap!")
28118. AppendLogfile("!LogFileName!", ".")
28119. 
28120. 
28121. /* Write/display stats: */
28122. 
28123. # Log:  
28124. 
28125. # Set Volume Detailed Statistics:
28126. 
28127. # Set Volume summary stats:
28128. 
28129. # Cluster, Sector, Block adjust for display.
28130. # Bytes per cluster is volume specific.
28131. 
28132. SetVariable(DisplayUnitDivisorCurrent,   DisplayUnitDivisor * BytesPerCluster)	
28133. 
28134. SetVariable(VolumeSizeTemp, VolumeSize / DisplayUnitDivisorCurrent)
28135. SetVariable(VolumeUsedTemp, VolumeUsed / DisplayUnitDivisorCurrent)
28136. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
28137. 
28138. SetVariable(VolumeUsedTotalTemp, VolumeFree / DisplayUnitDivisorCurrent)
28139. SetVariable(VolumeFreeTemp, VolumeFree / DisplayUnitDivisorCurrent)
28140. 
28141. SetVariable(VolumeStatisticsSummary,"----------------------------------------------------------
28142. SUMMARY: !VolumeLabel! !VolumeDescription!
28143.   
28144.           Volume Size:       !VolumeSize! (!VolumeSizeTemp!)
28145.           Volume Used:       !VolumeUsed! (!VolumeUsedTemp!)
28146.           Volume Free:       !VolumeFree!, (!VolumeFreeTemp!)
28147.          
28148.      Volume Used Calc:       !VolumeUsedTotal! (!VolumeUsedTotalTemp!)
28149.       Volume Free Adj:       !VolumeFreeAdj!
28150.     Bytes per cluster:       !BytesPerCluster! bytes
28151. 
28152.    Unfragmented Items:       !FILES200N!
28153.      Fragmented Items:       !FILES210N!
28154. 
28155.     Unfragmented Data:       !FILES202N! bytes
28156.       Fragmented Data:       !FILES212N! bytes
28157. 
28158.              All Gaps:       !GAP00N!
28159.              All gaps:       !GAP10N! bytes
28160.           Average gap:       !GAP13N! bytes
28161.            Median gap:       !GAP14N! bytes
28162.           Biggest gap:       !GAP15N! bytes
28163. ----------------------------------------------------------
28164. ") 
28165. 
28166. 
28167. SetVariable(VolumeStatisticsDetail,"----------------------------------------------------------
28168. VOLUME: !VolumeLabel! !VolumeDescription!
28169. ----------------------------------------------------------
28170. !VolumeStatisticsSummary!
28171. ----------------------------------------------------------
28172. DETAILS: !VolumeLabel! !VolumeDescription!
28173. ----------------------------------------------------------
28174. 
28175. SUMMARY:
28176. 
28177. Volume label/name:          !VolumeLabel!
28178. Volume mountpoint:          !MountPoint!
28179. Volume name:                !VolumeName!
28180. Volume type:                !VolumeType!
28181. 
28182. Total disk space:           !VolumeSize! bytes
28183.                             !VolumeSizeG! gigabytes
28184. 
28185. Bytes per cluster:          !BytesPerCluster! bytes
28186. Average end-begin distance: !AverageBeginEndDistance! clusters
28187.                             !AverageBeginEndDistanceP!% of volume size
28188. 
28189. ----------------------------------------------------------
28190. FRAGMENTS:
28191. 
28192. Unfragmented Items: !FILES200N!
28193.   Fragmented Items: !FILES210N!
28194.  Unfragmented Data: !FILES202N! bytes
28195.    Fragmented Data: !FILES212N! bytes
28196. Gaps:
28197.           All Gaps: !GAP00N!
28198.           All gaps: !GAP10N! bytes
28199.        Average gap: !GAP13N! bytes
28200.         Median gap: !GAP14N! bytes
28201.        Biggest gap: !GAP15N! bytes
28202. 
28203. ----------------------------------------------------------
28204. GAPS:
28205. 
28206.    ----------------------------------------------------------
28207.    Counts:
28208.                        Count      Percentage of all
28209.                 ----------------- -----------------
28210.    Small gaps   !GAP01N! !GAP01P!%
28211.    Big gaps     !GAP02N! !GAP02P!%
28212.                 ----------------- -----------------
28213.    All gaps     !GAP00N! !GAP00P!
28214. 
28215.    ----------------------------------------------------------
28216.    By size:
28217.                       Bytes          Gigabytes      Percentage of all
28218.                 ----------------- ----------------- -----------------
28219.    Small gaps   !GAP11N! !GAP11G! !GAP11P!%
28220.    Big gaps     !GAP12N! !GAP12G! !GAP12P!%
28221.                 ----------------- ----------------- -----------------
28222.    All gaps     !GAP10N! !GAP10G! !GAP10P!%
28223. 
28224.    Average gap  !GAP13N! !GAP13G! !GAP13P!%
28225.    Median gap   !GAP14N! !GAP14G! !GAP14P!%
28226.    Biggest gap  !GAP15N! !GAP15G! !GAP15P!%
28227.    ----------------------------------------------------------
28228. 
28229. ----------------------------------------------------------
28230. FILE STATISTICS:
28231. ----------------------------------------------------------
28232. 
28233. ----------------------------------------------------------
28234. ITEM COUNT:
28235. ----------------------------------------------------------
28236. Number of files and folders:
28237. 
28238.               Unfragmented       Fragmented            All
28239.    ------- ----------------- ----------------- -----------------
28240.    Files   !FILES000N! !FILES010N! !FILES020N!
28241.    Folders !FILES100N! !FILES110N! !FILES120N!
28242.    ------- ----------------- ----------------- -----------------
28243.    All     !FILES200N! !FILES210N! !FILES220N!
28244. 
28245. ----------------------------------------------------------
28246. Percentage of total:
28247. 
28248.               Unfragmented       Fragmented            All
28249.    ------- ----------------- ----------------- -----------------
28250.    Files   !FILES000P!%!FILES010P!%!FILES020P!%
28251.    Folders !FILES100P!%!FILES110P!%!FILES120P!%
28252.    ------- ----------------- ----------------- -----------------
28253.    All     !FILES200P!%!FILES210P!%!FILES220P!%
28254. 
28255. ----------------------------------------------------------
28256. OCCUPIED SIZE on disk:
28257. ----------------------------------------------------------
28258. Bytes:
28259.               Unfragmented       Fragmented            All
28260.    ------- ----------------- ----------------- -----------------
28261.    Files   !FILES002N! !FILES012N! !FILES022N!
28262.    Folders !FILES102N! !FILES112N! !FILES122N!
28263.    ------- ----------------- ----------------- -----------------
28264.    All     !FILES202N! !FILES212N! !FILES222N!
28265. 
28266. ----------------------------------------------------------
28267. Gigabytes:
28268.               Unfragmented       Fragmented            All
28269.    ------- ----------------- ----------------- -----------------
28270.    Files   !FILES002G! !FILES012G! !FILES022G!
28271.    Folders !FILES102G! !FILES112G! !FILES122G!
28272.    ------- ----------------- ----------------- -----------------
28273.    All     !FILES202G! !FILES212G! !FILES222G!
28274. 
28275. ----------------------------------------------------------
28276. Percentage:
28277.               Unfragmented       Fragmented            All
28278.    ------- ----------------- ----------------- -----------------
28279.    Files   !FILES002P!%!FILES012P!%!FILES022P!%
28280.    Folders !FILES102P!%!FILES112P!%!FILES122P!%
28281.    ------- ----------------- ----------------- -----------------
28282.    All     !FILES202P!%!FILES212P!%!FILES222P!%
28283. 
28284. ----------------------------------------------------------
28285. USED SIZE:
28286. ----------------------------------------------------------
28287. Bytes:
28288.               Unfragmented       Fragmented            All
28289.    ------- ----------------- ----------------- -----------------
28290.    Files   !FILES001N! !FILES011N! !FILES021N!
28291.    Folders !FILES101N! !FILES111N! !FILES121N!
28292.    ------- ----------------- ----------------- -----------------
28293.    All     !FILES201N! !FILES211N! !FILES221N!
28294. 
28295. ----------------------------------------------------------
28296. Gigabytes:
28297.               Unfragmented       Fragmented            All
28298.    ------- ----------------- ----------------- -----------------
28299.    Files   !FILES001G! !FILES011G! !FILES021G!
28300.    Folders !FILES101G! !FILES111G! !FILES121G!
28301.    ------- ----------------- ----------------- -----------------
28302.    All     !FILES201G! !FILES211G! !FILES221G!
28303. 
28304. ----------------------------------------------------------
28305. Percentage:
28306.               Unfragmented       Fragmented            All
28307.    ------- ----------------- ----------------- -----------------
28308.    Files   !FILES001P!%!FILES011P!%!FILES021P!%
28309.    Folders !FILES101P!%!FILES111P!%!FILES121P!%
28310.    ------- ----------------- ----------------- -----------------
28311.    All     !FILES201P!%!FILES211P!%!FILES221P!%
28312. 
28313. ----------------------------------------------------------
28314. Volume Detailed Statistics end.
28315. ----------------------------------------------------------
28316. ") 
28317. 
28318. 
28319. AppendLogfile("!LogFileName!", ".")
28320. AppendLogfile("!LogFileName!", "!VolumeStatisticsDetail!")
28321. AppendLogfile("!LogFileName!", ".")
28322. AppendLogfile("!LogFileName!", "Volume End.")	
28323. 
28324. # SetStatisticsWindowText("!VolumeStatisticsDetail!")
28325. 
28326. /* pause() */
28327. /* pause() */
28328. 
28329.   
28330. 
28331. VolumeEnd
28332. 
28333. /* ---------------------------------------------------------- */
28334. 
28335. AppendLogfile("!LogFileName!",".")
28336. SetVariable(FileStepDescription,"!Description! Complex Volume end: 2021-10-24 14:34:15.")
28337. # BANNER SET
28338. 
28339. # DATE TIME RUN ELP
28340. 
28341. SetVariable(DateTimeRunDescription,		"2021-10-24 14:34:19 0:00:05")
28342. /* Xinclude "..\BannerSet.MyDc"X */
28343. /* pause(1) */
28344. 
28345. SetVariable(Heading, 'Vol: !VolumeStepDescription! ||Zone: !ZoneStepDescription! ||Step: !FileStepDescription! ||!SeverStepDescription! - !RunStepDescription! on !DateTimeRunDescription!')
28346. 
28347. Title('!Heading!')
28348. /* pause(1) */
28349. 
28350. /* NOTE: Can't round or truncate to integer precision. */
28351. 
28352. AppendLogfile("!LogFileName!", "!Title!")
28353. 
28354. 
28355. 
28356. AppendLogfile("!LogFileName!",".")
28357. 
28358. /* ---------------------------------------------------------- */
28359. # End. ;-) (Return to caller lovely nubes, only MyD's get executed.)
28360. 
28361. 
